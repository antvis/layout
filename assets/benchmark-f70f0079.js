var du=Object.defineProperty;var lu=(U,ft,x)=>ft in U?du(U,ft,{enumerable:!0,configurable:!0,writable:!0,value:x}):U[ft]=x;var Nn=(U,ft,x)=>(lu(U,typeof ft!="symbol"?ft+"":ft,x),x);import{i as hu,u as fu,C as Oe,F as gu,h as pu,a as vu,d as mu,b as yu,T as An,l as wu,c as Gs}from"./datasets-7baa990c.js";function Eu(U,ft,x,Mt){U.resetTransform(),U.clearRect(0,0,U.canvas.width,U.canvas.height);const Ft=new DOMMatrix;U.setTransform(Ft.translate(U.canvas.width/2,U.canvas.height/2,0).scale(Mt,Mt).translate(-U.canvas.width/2,-U.canvas.height/2,0));for(let K=0;K<x.length;K+=4)U.moveTo(x[K],x[K+1]),U.lineTo(x[K+2],x[K+3]),U.strokeStyle="grey",U.lineWidth=1,U.stroke();for(let K=0;K<ft.length;K+=2)U.beginPath(),U.arc(ft[K],ft[K+1],5,0,2*Math.PI,!1),U.fillStyle="red",U.fill(),U.stroke()}var es={};function xu(U){return typeof U!="number"||isNaN(U)?1:U}function bu(U,ft){var x={},Mt=function(F){return typeof F>"u"?ft:F};typeof ft=="function"&&(Mt=ft);var Ft=function(F){return Mt(F[U])},K=function(){return Mt(void 0)};return typeof U=="string"?(x.fromAttributes=Ft,x.fromGraph=function(F,Rt){return Ft(F.getNodeAttributes(Rt))},x.fromEntry=function(F,Rt){return Ft(Rt)}):typeof U=="function"?(x.fromAttributes=function(){throw new Error("graphology-utils/getters/createNodeValueGetter: irrelevant usage.")},x.fromGraph=function(F,Rt){return Mt(U(Rt,F.getNodeAttributes(Rt)))},x.fromEntry=function(F,Rt){return Mt(U(F,Rt))}):(x.fromAttributes=K,x.fromGraph=K,x.fromEntry=K),x}function Ys(U,ft){var x={},Mt=function(F){return typeof F>"u"?ft:F};typeof ft=="function"&&(Mt=ft);var Ft=function(F){return Mt(F[U])},K=function(){return Mt(void 0)};return typeof U=="string"?(x.fromAttributes=Ft,x.fromGraph=function(F,Rt){return Ft(F.getEdgeAttributes(Rt))},x.fromEntry=function(F,Rt){return Ft(Rt)},x.fromPartialEntry=x.fromEntry,x.fromMinimalEntry=x.fromEntry):typeof U=="function"?(x.fromAttributes=function(){throw new Error("graphology-utils/getters/createEdgeValueGetter: irrelevant usage.")},x.fromGraph=function(F,Rt){var Bt=F.extremities(Rt);return Mt(U(Rt,F.getEdgeAttributes(Rt),Bt[0],Bt[1],F.getNodeAttributes(Bt[0]),F.getNodeAttributes(Bt[1]),F.isUndirected(Rt)))},x.fromEntry=function(F,Rt,Bt,ye,Ae,de,re){return Mt(U(F,Rt,Bt,ye,Ae,de,re))},x.fromPartialEntry=function(F,Rt,Bt,ye){return Mt(U(F,Rt,Bt,ye))},x.fromMinimalEntry=function(F,Rt){return Mt(U(F,Rt))}):(x.fromAttributes=K,x.fromGraph=K,x.fromEntry=K,x.fromMinimalEntry=K),x}es.createNodeValueGetter=bu;es.createEdgeValueGetter=Ys;es.createEdgeWeightGetter=function(U){return Ys(U,xu)};var yr=0,ar=1,ze=2,Pe=3,Zn=4,Qn=5,Ve=6,Fs=7,ts=8,js=9,Nu=0,_u=1,Au=2,Rr=0,mn=1,Hr=2,$o=3,Eo=4,lr=5,Jr=6,Ln=7,zn=8,Us=3,_n=10,Su=3,Ur=9,Is=10,Mu=function(ft,x,Mt){var Ft,K,F,Rt,Bt,ye,Ae,de,re,Dt,we=x.length,$e=Mt.length,le=ft.adjustSizes,At=ft.barnesHutTheta*ft.barnesHutTheta,We,fe,ve,be,Ge,Qt,ee,bt=[];for(F=0;F<we;F+=_n)x[F+Zn]=x[F+ze],x[F+Qn]=x[F+Pe],x[F+ze]=0,x[F+Pe]=0;if(ft.outboundAttractionDistribution){for(We=0,F=0;F<we;F+=_n)We+=x[F+Ve];We/=we/_n}if(ft.barnesHutOptimize){var wr=1/0,Or=-1/0,O=1/0,Br=-1/0,Le,Er,tn;for(F=0;F<we;F+=_n)wr=Math.min(wr,x[F+yr]),Or=Math.max(Or,x[F+yr]),O=Math.min(O,x[F+ar]),Br=Math.max(Br,x[F+ar]);var Vt=Or-wr,Lt=Br-O;for(Vt>Lt?(O-=(Vt-Lt)/2,Br=O+Vt):(wr-=(Lt-Vt)/2,Or=wr+Lt),bt[0+Rr]=-1,bt[0+mn]=(wr+Or)/2,bt[0+Hr]=(O+Br)/2,bt[0+$o]=Math.max(Or-wr,Br-O),bt[0+Eo]=-1,bt[0+lr]=-1,bt[0+Jr]=0,bt[0+Ln]=0,bt[0+zn]=0,Ft=1,F=0;F<we;F+=_n)for(K=0,tn=Us;;)if(bt[K+lr]>=0){x[F+yr]<bt[K+mn]?x[F+ar]<bt[K+Hr]?Le=bt[K+lr]:Le=bt[K+lr]+Ur:x[F+ar]<bt[K+Hr]?Le=bt[K+lr]+Ur*2:Le=bt[K+lr]+Ur*3,bt[K+Ln]=(bt[K+Ln]*bt[K+Jr]+x[F+yr]*x[F+Ve])/(bt[K+Jr]+x[F+Ve]),bt[K+zn]=(bt[K+zn]*bt[K+Jr]+x[F+ar]*x[F+Ve])/(bt[K+Jr]+x[F+Ve]),bt[K+Jr]+=x[F+Ve],K=Le;continue}else if(bt[K+Rr]<0){bt[K+Rr]=F;break}else{if(bt[K+lr]=Ft*Ur,de=bt[K+$o]/2,re=bt[K+lr],bt[re+Rr]=-1,bt[re+mn]=bt[K+mn]-de,bt[re+Hr]=bt[K+Hr]-de,bt[re+$o]=de,bt[re+Eo]=re+Ur,bt[re+lr]=-1,bt[re+Jr]=0,bt[re+Ln]=0,bt[re+zn]=0,re+=Ur,bt[re+Rr]=-1,bt[re+mn]=bt[K+mn]-de,bt[re+Hr]=bt[K+Hr]+de,bt[re+$o]=de,bt[re+Eo]=re+Ur,bt[re+lr]=-1,bt[re+Jr]=0,bt[re+Ln]=0,bt[re+zn]=0,re+=Ur,bt[re+Rr]=-1,bt[re+mn]=bt[K+mn]+de,bt[re+Hr]=bt[K+Hr]-de,bt[re+$o]=de,bt[re+Eo]=re+Ur,bt[re+lr]=-1,bt[re+Jr]=0,bt[re+Ln]=0,bt[re+zn]=0,re+=Ur,bt[re+Rr]=-1,bt[re+mn]=bt[K+mn]+de,bt[re+Hr]=bt[K+Hr]+de,bt[re+$o]=de,bt[re+Eo]=bt[K+Eo],bt[re+lr]=-1,bt[re+Jr]=0,bt[re+Ln]=0,bt[re+zn]=0,Ft+=4,x[bt[K+Rr]+yr]<bt[K+mn]?x[bt[K+Rr]+ar]<bt[K+Hr]?Le=bt[K+lr]:Le=bt[K+lr]+Ur:x[bt[K+Rr]+ar]<bt[K+Hr]?Le=bt[K+lr]+Ur*2:Le=bt[K+lr]+Ur*3,bt[K+Jr]=x[bt[K+Rr]+Ve],bt[K+Ln]=x[bt[K+Rr]+yr],bt[K+zn]=x[bt[K+Rr]+ar],bt[Le+Rr]=bt[K+Rr],bt[K+Rr]=-1,x[F+yr]<bt[K+mn]?x[F+ar]<bt[K+Hr]?Er=bt[K+lr]:Er=bt[K+lr]+Ur:x[F+ar]<bt[K+Hr]?Er=bt[K+lr]+Ur*2:Er=bt[K+lr]+Ur*3,Le===Er)if(tn--){K=Le;continue}else{tn=Us;break}bt[Er+Rr]=F;break}}if(ft.barnesHutOptimize)for(fe=ft.scalingRatio,F=0;F<we;F+=_n)for(K=0;;)if(bt[K+lr]>=0)if(Qt=Math.pow(x[F+yr]-bt[K+Ln],2)+Math.pow(x[F+ar]-bt[K+zn],2),Dt=bt[K+$o],4*Dt*Dt/Qt<At){if(ve=x[F+yr]-bt[K+Ln],be=x[F+ar]-bt[K+zn],le===!0?Qt>0?(ee=fe*x[F+Ve]*bt[K+Jr]/Qt,x[F+ze]+=ve*ee,x[F+Pe]+=be*ee):Qt<0&&(ee=-fe*x[F+Ve]*bt[K+Jr]/Math.sqrt(Qt),x[F+ze]+=ve*ee,x[F+Pe]+=be*ee):Qt>0&&(ee=fe*x[F+Ve]*bt[K+Jr]/Qt,x[F+ze]+=ve*ee,x[F+Pe]+=be*ee),K=bt[K+Eo],K<0)break;continue}else{K=bt[K+lr];continue}else{if(ye=bt[K+Rr],ye>=0&&ye!==F&&(ve=x[F+yr]-x[ye+yr],be=x[F+ar]-x[ye+ar],Qt=ve*ve+be*be,le===!0?Qt>0?(ee=fe*x[F+Ve]*x[ye+Ve]/Qt,x[F+ze]+=ve*ee,x[F+Pe]+=be*ee):Qt<0&&(ee=-fe*x[F+Ve]*x[ye+Ve]/Math.sqrt(Qt),x[F+ze]+=ve*ee,x[F+Pe]+=be*ee):Qt>0&&(ee=fe*x[F+Ve]*x[ye+Ve]/Qt,x[F+ze]+=ve*ee,x[F+Pe]+=be*ee)),K=bt[K+Eo],K<0)break;continue}else for(fe=ft.scalingRatio,Rt=0;Rt<we;Rt+=_n)for(Bt=0;Bt<Rt;Bt+=_n)ve=x[Rt+yr]-x[Bt+yr],be=x[Rt+ar]-x[Bt+ar],le===!0?(Qt=Math.sqrt(ve*ve+be*be)-x[Rt+ts]-x[Bt+ts],Qt>0?(ee=fe*x[Rt+Ve]*x[Bt+Ve]/Qt/Qt,x[Rt+ze]+=ve*ee,x[Rt+Pe]+=be*ee,x[Bt+ze]-=ve*ee,x[Bt+Pe]-=be*ee):Qt<0&&(ee=100*fe*x[Rt+Ve]*x[Bt+Ve],x[Rt+ze]+=ve*ee,x[Rt+Pe]+=be*ee,x[Bt+ze]-=ve*ee,x[Bt+Pe]-=be*ee)):(Qt=Math.sqrt(ve*ve+be*be),Qt>0&&(ee=fe*x[Rt+Ve]*x[Bt+Ve]/Qt/Qt,x[Rt+ze]+=ve*ee,x[Rt+Pe]+=be*ee,x[Bt+ze]-=ve*ee,x[Bt+Pe]-=be*ee));for(re=ft.gravity/ft.scalingRatio,fe=ft.scalingRatio,F=0;F<we;F+=_n)ee=0,ve=x[F+yr],be=x[F+ar],Qt=Math.sqrt(Math.pow(ve,2)+Math.pow(be,2)),ft.strongGravityMode?Qt>0&&(ee=fe*x[F+Ve]*re):Qt>0&&(ee=fe*x[F+Ve]*re/Qt),x[F+ze]-=ve*ee,x[F+Pe]-=be*ee;for(fe=1*(ft.outboundAttractionDistribution?We:1),Ae=0;Ae<$e;Ae+=Su)Rt=Mt[Ae+Nu],Bt=Mt[Ae+_u],de=Mt[Ae+Au],Ge=Math.pow(de,ft.edgeWeightInfluence),ve=x[Rt+yr]-x[Bt+yr],be=x[Rt+ar]-x[Bt+ar],le===!0?(Qt=Math.sqrt(ve*ve+be*be)-x[Rt+ts]-x[Bt+ts],ft.linLogMode?ft.outboundAttractionDistribution?Qt>0&&(ee=-fe*Ge*Math.log(1+Qt)/Qt/x[Rt+Ve]):Qt>0&&(ee=-fe*Ge*Math.log(1+Qt)/Qt):ft.outboundAttractionDistribution?Qt>0&&(ee=-fe*Ge/x[Rt+Ve]):Qt>0&&(ee=-fe*Ge)):(Qt=Math.sqrt(Math.pow(ve,2)+Math.pow(be,2)),ft.linLogMode?ft.outboundAttractionDistribution?Qt>0&&(ee=-fe*Ge*Math.log(1+Qt)/Qt/x[Rt+Ve]):Qt>0&&(ee=-fe*Ge*Math.log(1+Qt)/Qt):ft.outboundAttractionDistribution?(Qt=1,ee=-fe*Ge/x[Rt+Ve]):(Qt=1,ee=-fe*Ge)),Qt>0&&(x[Rt+ze]+=ve*ee,x[Rt+Pe]+=be*ee,x[Bt+ze]-=ve*ee,x[Bt+Pe]-=be*ee);var Ht,ue,ie,Ne,Me,Te;if(le===!0)for(F=0;F<we;F+=_n)x[F+js]!==1&&(Ht=Math.sqrt(Math.pow(x[F+ze],2)+Math.pow(x[F+Pe],2)),Ht>Is&&(x[F+ze]=x[F+ze]*Is/Ht,x[F+Pe]=x[F+Pe]*Is/Ht),ue=x[F+Ve]*Math.sqrt((x[F+Zn]-x[F+ze])*(x[F+Zn]-x[F+ze])+(x[F+Qn]-x[F+Pe])*(x[F+Qn]-x[F+Pe])),ie=Math.sqrt((x[F+Zn]+x[F+ze])*(x[F+Zn]+x[F+ze])+(x[F+Qn]+x[F+Pe])*(x[F+Qn]+x[F+Pe]))/2,Ne=.1*Math.log(1+ie)/(1+Math.sqrt(ue)),Me=x[F+yr]+x[F+ze]*(Ne/ft.slowDown),x[F+yr]=Me,Te=x[F+ar]+x[F+Pe]*(Ne/ft.slowDown),x[F+ar]=Te);else for(F=0;F<we;F+=_n)x[F+js]!==1&&(ue=x[F+Ve]*Math.sqrt((x[F+Zn]-x[F+ze])*(x[F+Zn]-x[F+ze])+(x[F+Qn]-x[F+Pe])*(x[F+Qn]-x[F+Pe])),ie=Math.sqrt((x[F+Zn]+x[F+ze])*(x[F+Zn]+x[F+ze])+(x[F+Qn]+x[F+Pe])*(x[F+Qn]+x[F+Pe]))/2,Ne=x[F+Fs]*Math.log(1+ie)/(1+Math.sqrt(ue)),x[F+Fs]=Math.min(1,Math.sqrt(Ne*(Math.pow(x[F+ze],2)+Math.pow(x[F+Pe],2))/(1+Math.sqrt(ue)))),Me=x[F+yr]+x[F+ze]*(Ne/ft.slowDown),x[F+yr]=Me,Te=x[F+ar]+x[F+Pe]*(Ne/ft.slowDown),x[F+ar]=Te);return{}},xo={},ca=10,Bs=3;xo.assign=function(U){U=U||{};var ft=Array.prototype.slice.call(arguments).slice(1),x,Mt,Ft;for(x=0,Ft=ft.length;x<Ft;x++)if(ft[x])for(Mt in ft[x])U[Mt]=ft[x][Mt];return U};xo.validateSettings=function(U){return"linLogMode"in U&&typeof U.linLogMode!="boolean"?{message:"the `linLogMode` setting should be a boolean."}:"outboundAttractionDistribution"in U&&typeof U.outboundAttractionDistribution!="boolean"?{message:"the `outboundAttractionDistribution` setting should be a boolean."}:"adjustSizes"in U&&typeof U.adjustSizes!="boolean"?{message:"the `adjustSizes` setting should be a boolean."}:"edgeWeightInfluence"in U&&typeof U.edgeWeightInfluence!="number"?{message:"the `edgeWeightInfluence` setting should be a number."}:"scalingRatio"in U&&!(typeof U.scalingRatio=="number"&&U.scalingRatio>=0)?{message:"the `scalingRatio` setting should be a number >= 0."}:"strongGravityMode"in U&&typeof U.strongGravityMode!="boolean"?{message:"the `strongGravityMode` setting should be a boolean."}:"gravity"in U&&!(typeof U.gravity=="number"&&U.gravity>=0)?{message:"the `gravity` setting should be a number >= 0."}:"slowDown"in U&&!(typeof U.slowDown=="number"||U.slowDown>=0)?{message:"the `slowDown` setting should be a number >= 0."}:"barnesHutOptimize"in U&&typeof U.barnesHutOptimize!="boolean"?{message:"the `barnesHutOptimize` setting should be a boolean."}:"barnesHutTheta"in U&&!(typeof U.barnesHutTheta=="number"&&U.barnesHutTheta>=0)?{message:"the `barnesHutTheta` setting should be a number >= 0."}:null};xo.graphToByteArrays=function(U,ft){var x=U.order,Mt=U.size,Ft={},K,F=new Float32Array(x*ca),Rt=new Float32Array(Mt*Bs);return K=0,U.forEachNode(function(Bt,ye){Ft[Bt]=K,F[K]=ye.x,F[K+1]=ye.y,F[K+2]=0,F[K+3]=0,F[K+4]=0,F[K+5]=0,F[K+6]=1,F[K+7]=1,F[K+8]=ye.size||1,F[K+9]=ye.fixed?1:0,K+=ca}),K=0,U.forEachEdge(function(Bt,ye,Ae,de,re,Dt,we){var $e=Ft[Ae],le=Ft[de],At=ft(Bt,ye,Ae,de,re,Dt,we);F[$e+6]+=At,F[le+6]+=At,Rt[K]=$e,Rt[K+1]=le,Rt[K+2]=At,K+=Bs}),{nodes:F,edges:Rt}};xo.assignLayoutChanges=function(U,ft,x){var Mt=0;U.updateEachNodeAttributes(function(Ft,K){return K.x=ft[Mt],K.y=ft[Mt+1],Mt+=ca,x?x(Ft,K):K})};xo.readGraphPositions=function(U,ft){var x=0;U.forEachNode(function(Mt,Ft){ft[x]=Ft.x,ft[x+1]=Ft.y,x+=ca})};xo.collectLayoutChanges=function(U,ft,x){for(var Mt=U.nodes(),Ft={},K=0,F=0,Rt=ft.length;K<Rt;K+=ca){if(x){var Bt=Object.assign({},U.getNodeAttributes(Mt[F]));Bt.x=ft[K],Bt.y=ft[K+1],Bt=x(Mt[F],Bt),Ft[Mt[F]]={x:Bt.x,y:Bt.y}}else Ft[Mt[F]]={x:ft[K],y:ft[K+1]};F++}return Ft};xo.createWorker=function(ft){var x=window.URL||window.webkitURL,Mt=ft.toString(),Ft=x.createObjectURL(new Blob(["("+Mt+").call(this);"],{type:"text/javascript"})),K=new Worker(Ft);return x.revokeObjectURL(Ft),K};var Tu={linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:1,scalingRatio:1,strongGravityMode:!1,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5},Iu=hu,ku=es.createEdgeWeightGetter,Du=Mu,sa=xo,Ru=Tu;function Ks(U,ft,x){if(!Iu(ft))throw new Error("graphology-layout-forceatlas2: the given graph is not a valid graphology instance.");typeof x=="number"&&(x={iterations:x});var Mt=x.iterations;if(typeof Mt!="number")throw new Error("graphology-layout-forceatlas2: invalid number of iterations.");if(Mt<=0)throw new Error("graphology-layout-forceatlas2: you should provide a positive number of iterations.");var Ft=ku("getEdgeWeight"in x?x.getEdgeWeight:"weight").fromEntry,K=typeof x.outputReducer=="function"?x.outputReducer:null,F=sa.assign({},Ru,x.settings),Rt=sa.validateSettings(F);if(Rt)throw new Error("graphology-layout-forceatlas2: "+Rt.message);var Bt=sa.graphToByteArrays(ft,Ft),ye;for(ye=0;ye<Mt;ye++)Du(F,Bt.nodes,Bt.edges);if(U){sa.assignLayoutChanges(ft,Bt.nodes,K);return}return sa.collectLayoutChanges(ft,Bt.nodes)}function Ou(U){var ft=typeof U=="number"?U:U.order;return{barnesHutOptimize:ft>2e3,strongGravityMode:!0,gravity:.05,scalingRatio:10,slowDown:1+Math.log(ft)}}var Ds=Ks.bind(null,!1);Ds.assign=Ks.bind(null,!0);Ds.inferSettings=Ou;var Cu=Ds;function Zs(U,ft,x){const Mt=[],Ft=[];return Object.keys(ft).forEach(K=>{x&&x(ft[K]),Mt.push(ft[K].x,ft[K].y)}),U.edges().forEach(K=>{const F=U.source(K),Rt=U.target(K);Ft.push(ft[F].x,ft[F].y,ft[Rt].x,ft[Rt].y)}),{nodes:Mt,edges:Ft}}function Yo(U){const ft=[],x=[],Mt={};return U.nodes.forEach(({id:Ft,data:{x:K,y:F}})=>{Mt[Ft]={x:K,y:F},ft.push(K,F)}),U.edges.forEach(({source:Ft,target:K})=>{const F=Mt[Ft].x,Rt=Mt[Ft].y,Bt=Mt[K].x,ye=Mt[K].y;x.push(F,Rt,Bt,ye)}),{nodes:ft,edges:x}}const Rs=100,Os=1,Cs=1;async function Lu(U,{iterations:ft}){const x=Cu(U,{settings:{barnesHutOptimize:!1,strongGravityMode:!1,gravity:Os,scalingRatio:Cs,slowDown:1},iterations:ft||Rs,getEdgeWeight:"weight"});return Zs(U,x,Mt=>{Mt.x=Mt.x+Oe/2,Mt.y=Mt.y+Oe/2})}async function zu(U,{iterations:ft}){const Mt=await new fu({kr:Cs,kg:Os,ks:.1,maxIteration:ft||Rs,width:Oe,height:Oe,center:[Oe/2,Oe/2]}).execute(U);return Yo(Mt)}async function Vs(U,{iterations:ft,min_movement:x,distance_threshold_mode:Mt},Ft){const F=await new gu({threads:Ft,maxIteration:ft||Rs,minMovement:x,distanceThresholdMode:Mt,height:Oe,width:Oe,center:[Oe/2,Oe/2],kg:Os,kr:Cs,ks:.1}).execute(U);return Yo(F)}const Qs=100,Js=10,tu=200,eu=200,ru=1e3,nu=1e3,ou=.9,iu=1,au=.005,su=.02;async function Pu(U,{iterations:ft,min_movement:x,distance_threshold_mode:Mt}){const K=await new pu({factor:iu,gravity:Js,linkDistance:tu,edgeStrength:eu,nodeStrength:ru,coulombDisScale:au,damping:ou,maxSpeed:nu,minMovement:x,interval:su,preventOverlap:!0,distanceThresholdMode:Mt,maxIteration:ft||Qs,width:Oe,height:Oe,center:[Oe/2,Oe/2]}).execute(U);return Yo(K)}async function Ws(U,{iterations:ft,min_movement:x,distance_threshold_mode:Mt},Ft){const F=await new vu({threads:Ft,maxIteration:ft||Qs,minMovement:x,distanceThresholdMode:Mt,height:Oe,width:Oe,center:[Oe/2,Oe/2],factor:iu,gravity:Js,linkDistance:tu,edgeStrength:eu,nodeStrength:ru,coulombDisScale:au,damping:ou,maxSpeed:nu,interval:su}).execute(U);return Yo(F)}/*! For license information please see index.esm.js.LICENSE.txt */var Gu={737:(U,ft,x)=>{var Mt=x(68).default;function Ft(){U.exports=Ft=function(){return K},U.exports.__esModule=!0,U.exports.default=U.exports;var K={},F=Object.prototype,Rt=F.hasOwnProperty,Bt=Object.defineProperty||function(Vt,Lt,Ht){Vt[Lt]=Ht.value},ye=typeof Symbol=="function"?Symbol:{},Ae=ye.iterator||"@@iterator",de=ye.asyncIterator||"@@asyncIterator",re=ye.toStringTag||"@@toStringTag";function Dt(Vt,Lt,Ht){return Object.defineProperty(Vt,Lt,{value:Ht,enumerable:!0,configurable:!0,writable:!0}),Vt[Lt]}try{Dt({},"")}catch{Dt=function(Lt,Ht,ue){return Lt[Ht]=ue}}function we(Vt,Lt,Ht,ue){var ie=Lt&&Lt.prototype instanceof At?Lt:At,Ne=Object.create(ie.prototype),Me=new Le(ue||[]);return Bt(Ne,"_invoke",{value:wr(Vt,Ht,Me)}),Ne}function $e(Vt,Lt,Ht){try{return{type:"normal",arg:Vt.call(Lt,Ht)}}catch(ue){return{type:"throw",arg:ue}}}K.wrap=we;var le={};function At(){}function We(){}function fe(){}var ve={};Dt(ve,Ae,function(){return this});var be=Object.getPrototypeOf,Ge=be&&be(be(Er([])));Ge&&Ge!==F&&Rt.call(Ge,Ae)&&(ve=Ge);var Qt=fe.prototype=At.prototype=Object.create(ve);function ee(Vt){["next","throw","return"].forEach(function(Lt){Dt(Vt,Lt,function(Ht){return this._invoke(Lt,Ht)})})}function bt(Vt,Lt){function Ht(ie,Ne,Me,Te){var er=$e(Vt[ie],Vt,Ne);if(er.type!=="throw"){var Xr=er.arg,Ce=Xr.value;return Ce&&Mt(Ce)=="object"&&Rt.call(Ce,"__await")?Lt.resolve(Ce.__await).then(function(sr){Ht("next",sr,Me,Te)},function(sr){Ht("throw",sr,Me,Te)}):Lt.resolve(Ce).then(function(sr){Xr.value=sr,Me(Xr)},function(sr){return Ht("throw",sr,Me,Te)})}Te(er.arg)}var ue;Bt(this,"_invoke",{value:function(ie,Ne){function Me(){return new Lt(function(Te,er){Ht(ie,Ne,Te,er)})}return ue=ue?ue.then(Me,Me):Me()}})}function wr(Vt,Lt,Ht){var ue="suspendedStart";return function(ie,Ne){if(ue==="executing")throw new Error("Generator is already running");if(ue==="completed"){if(ie==="throw")throw Ne;return{value:void 0,done:!0}}for(Ht.method=ie,Ht.arg=Ne;;){var Me=Ht.delegate;if(Me){var Te=Or(Me,Ht);if(Te){if(Te===le)continue;return Te}}if(Ht.method==="next")Ht.sent=Ht._sent=Ht.arg;else if(Ht.method==="throw"){if(ue==="suspendedStart")throw ue="completed",Ht.arg;Ht.dispatchException(Ht.arg)}else Ht.method==="return"&&Ht.abrupt("return",Ht.arg);ue="executing";var er=$e(Vt,Lt,Ht);if(er.type==="normal"){if(ue=Ht.done?"completed":"suspendedYield",er.arg===le)continue;return{value:er.arg,done:Ht.done}}er.type==="throw"&&(ue="completed",Ht.method="throw",Ht.arg=er.arg)}}}function Or(Vt,Lt){var Ht=Lt.method,ue=Vt.iterator[Ht];if(ue===void 0)return Lt.delegate=null,Ht==="throw"&&Vt.iterator.return&&(Lt.method="return",Lt.arg=void 0,Or(Vt,Lt),Lt.method==="throw")||Ht!=="return"&&(Lt.method="throw",Lt.arg=new TypeError("The iterator does not provide a '"+Ht+"' method")),le;var ie=$e(ue,Vt.iterator,Lt.arg);if(ie.type==="throw")return Lt.method="throw",Lt.arg=ie.arg,Lt.delegate=null,le;var Ne=ie.arg;return Ne?Ne.done?(Lt[Vt.resultName]=Ne.value,Lt.next=Vt.nextLoc,Lt.method!=="return"&&(Lt.method="next",Lt.arg=void 0),Lt.delegate=null,le):Ne:(Lt.method="throw",Lt.arg=new TypeError("iterator result is not an object"),Lt.delegate=null,le)}function O(Vt){var Lt={tryLoc:Vt[0]};1 in Vt&&(Lt.catchLoc=Vt[1]),2 in Vt&&(Lt.finallyLoc=Vt[2],Lt.afterLoc=Vt[3]),this.tryEntries.push(Lt)}function Br(Vt){var Lt=Vt.completion||{};Lt.type="normal",delete Lt.arg,Vt.completion=Lt}function Le(Vt){this.tryEntries=[{tryLoc:"root"}],Vt.forEach(O,this),this.reset(!0)}function Er(Vt){if(Vt){var Lt=Vt[Ae];if(Lt)return Lt.call(Vt);if(typeof Vt.next=="function")return Vt;if(!isNaN(Vt.length)){var Ht=-1,ue=function ie(){for(;++Ht<Vt.length;)if(Rt.call(Vt,Ht))return ie.value=Vt[Ht],ie.done=!1,ie;return ie.value=void 0,ie.done=!0,ie};return ue.next=ue}}return{next:tn}}function tn(){return{value:void 0,done:!0}}return We.prototype=fe,Bt(Qt,"constructor",{value:fe,configurable:!0}),Bt(fe,"constructor",{value:We,configurable:!0}),We.displayName=Dt(fe,re,"GeneratorFunction"),K.isGeneratorFunction=function(Vt){var Lt=typeof Vt=="function"&&Vt.constructor;return!!Lt&&(Lt===We||(Lt.displayName||Lt.name)==="GeneratorFunction")},K.mark=function(Vt){return Object.setPrototypeOf?Object.setPrototypeOf(Vt,fe):(Vt.__proto__=fe,Dt(Vt,re,"GeneratorFunction")),Vt.prototype=Object.create(Qt),Vt},K.awrap=function(Vt){return{__await:Vt}},ee(bt.prototype),Dt(bt.prototype,de,function(){return this}),K.AsyncIterator=bt,K.async=function(Vt,Lt,Ht,ue,ie){ie===void 0&&(ie=Promise);var Ne=new bt(we(Vt,Lt,Ht,ue),ie);return K.isGeneratorFunction(Lt)?Ne:Ne.next().then(function(Me){return Me.done?Me.value:Ne.next()})},ee(Qt),Dt(Qt,re,"Generator"),Dt(Qt,Ae,function(){return this}),Dt(Qt,"toString",function(){return"[object Generator]"}),K.keys=function(Vt){var Lt=Object(Vt),Ht=[];for(var ue in Lt)Ht.push(ue);return Ht.reverse(),function ie(){for(;Ht.length;){var Ne=Ht.pop();if(Ne in Lt)return ie.value=Ne,ie.done=!1,ie}return ie.done=!0,ie}},K.values=Er,Le.prototype={constructor:Le,reset:function(Vt){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Br),!Vt)for(var Lt in this)Lt.charAt(0)==="t"&&Rt.call(this,Lt)&&!isNaN(+Lt.slice(1))&&(this[Lt]=void 0)},stop:function(){this.done=!0;var Vt=this.tryEntries[0].completion;if(Vt.type==="throw")throw Vt.arg;return this.rval},dispatchException:function(Vt){if(this.done)throw Vt;var Lt=this;function Ht(er,Xr){return Ne.type="throw",Ne.arg=Vt,Lt.next=er,Xr&&(Lt.method="next",Lt.arg=void 0),!!Xr}for(var ue=this.tryEntries.length-1;ue>=0;--ue){var ie=this.tryEntries[ue],Ne=ie.completion;if(ie.tryLoc==="root")return Ht("end");if(ie.tryLoc<=this.prev){var Me=Rt.call(ie,"catchLoc"),Te=Rt.call(ie,"finallyLoc");if(Me&&Te){if(this.prev<ie.catchLoc)return Ht(ie.catchLoc,!0);if(this.prev<ie.finallyLoc)return Ht(ie.finallyLoc)}else if(Me){if(this.prev<ie.catchLoc)return Ht(ie.catchLoc,!0)}else{if(!Te)throw new Error("try statement without catch or finally");if(this.prev<ie.finallyLoc)return Ht(ie.finallyLoc)}}}},abrupt:function(Vt,Lt){for(var Ht=this.tryEntries.length-1;Ht>=0;--Ht){var ue=this.tryEntries[Ht];if(ue.tryLoc<=this.prev&&Rt.call(ue,"finallyLoc")&&this.prev<ue.finallyLoc){var ie=ue;break}}ie&&(Vt==="break"||Vt==="continue")&&ie.tryLoc<=Lt&&Lt<=ie.finallyLoc&&(ie=null);var Ne=ie?ie.completion:{};return Ne.type=Vt,Ne.arg=Lt,ie?(this.method="next",this.next=ie.finallyLoc,le):this.complete(Ne)},complete:function(Vt,Lt){if(Vt.type==="throw")throw Vt.arg;return Vt.type==="break"||Vt.type==="continue"?this.next=Vt.arg:Vt.type==="return"?(this.rval=this.arg=Vt.arg,this.method="return",this.next="end"):Vt.type==="normal"&&Lt&&(this.next=Lt),le},finish:function(Vt){for(var Lt=this.tryEntries.length-1;Lt>=0;--Lt){var Ht=this.tryEntries[Lt];if(Ht.finallyLoc===Vt)return this.complete(Ht.completion,Ht.afterLoc),Br(Ht),le}},catch:function(Vt){for(var Lt=this.tryEntries.length-1;Lt>=0;--Lt){var Ht=this.tryEntries[Lt];if(Ht.tryLoc===Vt){var ue=Ht.completion;if(ue.type==="throw"){var ie=ue.arg;Br(Ht)}return ie}}throw new Error("illegal catch attempt")},delegateYield:function(Vt,Lt,Ht){return this.delegate={iterator:Er(Vt),resultName:Lt,nextLoc:Ht},this.method==="next"&&(this.arg=void 0),le}},K}U.exports=Ft,U.exports.__esModule=!0,U.exports.default=U.exports},68:U=>{function ft(x){return U.exports=ft=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Mt){return typeof Mt}:function(Mt){return Mt&&typeof Symbol=="function"&&Mt.constructor===Symbol&&Mt!==Symbol.prototype?"symbol":typeof Mt},U.exports.__esModule=!0,U.exports.default=U.exports,ft(x)}U.exports=ft,U.exports.__esModule=!0,U.exports.default=U.exports},279:(U,ft,x)=>{var Mt=x(737)();U.exports=Mt;try{regeneratorRuntime=Mt}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=Mt:Function("r","regeneratorRuntime = r")(Mt)}},861:(U,ft,x)=>{var Mt=x(250).Symbol;U.exports=Mt},823:(U,ft,x)=>{var Mt=x(861),Ft=x(339),K=x(151),F=Mt?Mt.toStringTag:void 0;U.exports=function(Rt){return Rt==null?Rt===void 0?"[object Undefined]":"[object Null]":F&&F in Object(Rt)?Ft(Rt):K(Rt)}},448:(U,ft,x)=>{var Mt=x(823),Ft=x(52),K=x(440),F={};F["[object Float32Array]"]=F["[object Float64Array]"]=F["[object Int8Array]"]=F["[object Int16Array]"]=F["[object Int32Array]"]=F["[object Uint8Array]"]=F["[object Uint8ClampedArray]"]=F["[object Uint16Array]"]=F["[object Uint32Array]"]=!0,F["[object Arguments]"]=F["[object Array]"]=F["[object ArrayBuffer]"]=F["[object Boolean]"]=F["[object DataView]"]=F["[object Date]"]=F["[object Error]"]=F["[object Function]"]=F["[object Map]"]=F["[object Number]"]=F["[object Object]"]=F["[object RegExp]"]=F["[object Set]"]=F["[object String]"]=F["[object WeakMap]"]=!1,U.exports=function(Rt){return K(Rt)&&Ft(Rt.length)&&!!F[Mt(Rt)]}},525:U=>{U.exports=function(ft){return function(x){return ft(x)}}},302:(U,ft,x)=>{var Mt=typeof x.g=="object"&&x.g&&x.g.Object===Object&&x.g;U.exports=Mt},490:(U,ft,x)=>{var Mt=x(540)(Object.getPrototypeOf,Object);U.exports=Mt},339:(U,ft,x)=>{var Mt=x(861),Ft=Object.prototype,K=Ft.hasOwnProperty,F=Ft.toString,Rt=Mt?Mt.toStringTag:void 0;U.exports=function(Bt){var ye=K.call(Bt,Rt),Ae=Bt[Rt];try{Bt[Rt]=void 0;var de=!0}catch{}var re=F.call(Bt);return de&&(ye?Bt[Rt]=Ae:delete Bt[Rt]),re}},690:(U,ft,x)=>{U=x.nmd(U);var Mt=x(302),Ft=ft&&!ft.nodeType&&ft,K=Ft&&U&&!U.nodeType&&U,F=K&&K.exports===Ft&&Mt.process,Rt=function(){try{return K&&K.require&&K.require("util").types||F&&F.binding&&F.binding("util")}catch{}}();U.exports=Rt},151:U=>{var ft=Object.prototype.toString;U.exports=function(x){return ft.call(x)}},540:U=>{U.exports=function(ft,x){return function(Mt){return ft(x(Mt))}}},250:(U,ft,x)=>{var Mt=x(302),Ft=typeof self=="object"&&self&&self.Object===Object&&self,K=Mt||Ft||Function("return this")();U.exports=K},589:U=>{var ft=Array.isArray;U.exports=ft},52:U=>{U.exports=function(ft){return typeof ft=="number"&&ft>-1&&ft%1==0&&ft<=9007199254740991}},224:(U,ft,x)=>{var Mt=x(823),Ft=x(440);U.exports=function(K){return typeof K=="number"||Ft(K)&&Mt(K)=="[object Number]"}},440:U=>{U.exports=function(ft){return ft!=null&&typeof ft=="object"}},256:(U,ft,x)=>{var Mt=x(823),Ft=x(490),K=x(440),F=Function.prototype,Rt=Object.prototype,Bt=F.toString,ye=Rt.hasOwnProperty,Ae=Bt.call(Object);U.exports=function(de){if(!K(de)||Mt(de)!="[object Object]")return!1;var re=Ft(de);if(re===null)return!0;var Dt=ye.call(re,"constructor")&&re.constructor;return typeof Dt=="function"&&Dt instanceof Dt&&Bt.call(Dt)==Ae}},922:(U,ft,x)=>{var Mt=x(448),Ft=x(525),K=x(690),F=K&&K.isTypedArray,Rt=F?Ft(F):Mt;U.exports=Rt},919:function(U){U.exports=function(){var ft=function(N){return N instanceof Uint8Array||N instanceof Uint16Array||N instanceof Uint32Array||N instanceof Int8Array||N instanceof Int16Array||N instanceof Int32Array||N instanceof Float32Array||N instanceof Float64Array||N instanceof Uint8ClampedArray},x=function(N,et){for(var mt=Object.keys(et),Ot=0;Ot<mt.length;++Ot)N[mt[Ot]]=et[mt[Ot]];return N},Mt=`
`;function Ft(N){var et=new Error("(regl) "+N);throw console.error(et),et}function K(N,et){N||Ft(et)}function F(N){return N?": "+N:""}function Rt(N,et){switch(et){case"number":return typeof N=="number";case"object":return typeof N=="object";case"string":return typeof N=="string";case"boolean":return typeof N=="boolean";case"function":return typeof N=="function";case"undefined":return N===void 0;case"symbol":return typeof N=="symbol"}}function Bt(N,et,mt){et.indexOf(N)<0&&Ft("invalid value"+F(mt)+". must be one of: "+et)}var ye=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Ae(N,et){for(N+="";N.length<et;)N=" "+N;return N}function de(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function re(N,et){this.number=N,this.line=et,this.errors=[]}function Dt(N,et,mt){this.file=N,this.line=et,this.message=mt}function we(){var N=new Error,et=(N.stack||N).toString(),mt=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(et);if(mt)return mt[1];var Ot=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(et);return Ot?Ot[1]:"unknown"}function $e(){var N=new Error,et=(N.stack||N).toString(),mt=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(et);if(mt)return mt[1];var Ot=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(et);return Ot?Ot[1]:"unknown"}function le(N,et){var mt,Ot=N.split(`
`),Ct=1,Ut=0,zt={unknown:new de,0:new de};zt.unknown.name=zt[0].name=et||we(),zt.unknown.lines.push(new re(0,""));for(var Zt=0;Zt<Ot.length;++Zt){var $t=Ot[Zt],qt=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec($t);if(qt)switch(qt[1]){case"line":var Wt=/(\d+)(\s+\d+)?/.exec(qt[2]);Wt&&(Ct=0|Wt[1],Wt[2]&&((Ut=0|Wt[2])in zt||(zt[Ut]=new de)));break;case"define":var Yt=/SHADER_NAME(_B64)?\s+(.*)$/.exec(qt[2]);Yt&&(zt[Ut].name=Yt[1]?(mt=Yt[2],typeof atob<"u"?atob(mt):"base64:"+mt):Yt[2])}zt[Ut].lines.push(new re(Ct++,$t))}return Object.keys(zt).forEach(function(ne){var oe=zt[ne];oe.lines.forEach(function(he){oe.index[he.number]=he})}),zt}function At(N){N._commandRef=we()}function We(N,et){var mt=$e();Ft(N+" in command "+(et||we())+(mt==="unknown"?"":" called from "+mt))}function fe(N,et,mt,Ot){Rt(N,et)||We("invalid parameter type"+F(mt)+". expected "+et+", got "+typeof N,Ot||we())}var ve=33071,be=32819,Ge=32820,Qt=33635,ee=34042,bt={};function wr(N,et){return N===Ge||N===be||N===Qt?2:N===ee?4:bt[N]*et}function Or(N){return!(N&N-1||!N)}bt[5120]=bt[5121]=1,bt[5122]=bt[5123]=bt[36193]=bt[Qt]=bt[be]=bt[Ge]=2,bt[5124]=bt[5125]=bt[5126]=bt[ee]=4;var O=x(K,{optional:function(N){N()},raise:Ft,commandRaise:We,command:function(N,et,mt){N||We(et,mt||we())},parameter:function(N,et,mt){N in et||Ft("unknown parameter ("+N+")"+F(mt)+". possible values: "+Object.keys(et).join())},commandParameter:function(N,et,mt,Ot){N in et||We("unknown parameter ("+N+")"+F(mt)+". possible values: "+Object.keys(et).join(),Ot||we())},constructor:function(N){Object.keys(N).forEach(function(et){ye.indexOf(et)<0&&Ft('invalid regl constructor argument "'+et+'". must be one of '+ye)})},type:function(N,et,mt){Rt(N,et)||Ft("invalid parameter type"+F(mt)+". expected "+et+", got "+typeof N)},commandType:fe,isTypedArray:function(N,et){ft(N)||Ft("invalid parameter type"+F(et)+". must be a typed array")},nni:function(N,et){N>=0&&(0|N)===N||Ft("invalid parameter type, ("+N+")"+F(et)+". must be a nonnegative integer")},oneOf:Bt,shaderError:function(N,et,mt,Ot,Ct){if(!N.getShaderParameter(et,N.COMPILE_STATUS)){var Ut=N.getShaderInfoLog(et),zt=Ot===N.FRAGMENT_SHADER?"fragment":"vertex";fe(mt,"string",zt+" shader source must be a string",Ct);var Zt=le(mt,Ct),$t=function(qt){var Wt=[];return qt.split(`
`).forEach(function(Yt){if(!(Yt.length<5)){var ne=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Yt);ne?Wt.push(new Dt(0|ne[1],0|ne[2],ne[3].trim())):Yt.length>0&&Wt.push(new Dt("unknown",0,Yt))}}),Wt}(Ut);(function(qt,Wt){Wt.forEach(function(Yt){var ne=qt[Yt.file];if(ne){var oe=ne.index[Yt.line];if(oe)return oe.errors.push(Yt),void(ne.hasErrors=!0)}qt.unknown.hasErrors=!0,qt.unknown.lines[0].errors.push(Yt)})})(Zt,$t),Object.keys(Zt).forEach(function(qt){var Wt=Zt[qt];if(Wt.hasErrors){var Yt=[""],ne=[""];oe("file number "+qt+": "+Wt.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Wt.lines.forEach(function(he){if(he.errors.length>0){oe(Ae(he.number,4)+"|  ","background-color:yellow; font-weight:bold"),oe(he.line+Mt,"color:red; background-color:yellow; font-weight:bold");var o=0;he.errors.forEach(function(r){var t=r.message,e=/^\s*'(.*)'\s*:\s*(.*)$/.exec(t);if(e){var n=e[1];t=e[2],n==="assign"&&(n="="),o=Math.max(he.line.indexOf(n,o),0)}else o=0;oe(Ae("| ",6)),oe(Ae("^^^",o+3)+Mt,"font-weight:bold"),oe(Ae("| ",6)),oe(t+Mt,"font-weight:bold")}),oe(Ae("| ",6)+Mt)}else oe(Ae(he.number,4)+"|  "),oe(he.line+Mt,"color:red")}),typeof document>"u"||window.chrome?console.log(Yt.join("")):(ne[0]=Yt.join("%c"),console.log.apply(console,ne))}function oe(he,o){Yt.push(he),ne.push(o||"")}}),K.raise("Error compiling "+zt+" shader, "+Zt[0].name)}},linkError:function(N,et,mt,Ot,Ct){if(!N.getProgramParameter(et,N.LINK_STATUS)){var Ut=N.getProgramInfoLog(et),zt=le(mt,Ct),Zt='Error linking program with vertex shader, "'+le(Ot,Ct)[0].name+'", and fragment shader "'+zt[0].name+'"';typeof document<"u"?console.log("%c"+Zt+`
%c`+Ut,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Zt+Mt+Ut),K.raise(Zt)}},callSite:$e,saveCommandRef:At,saveDrawInfo:function(N,et,mt,Ot){function Ct($t){return $t?Ot.id($t):0}function Ut($t,qt){Object.keys(qt).forEach(function(Wt){$t[Ot.id(Wt)]=!0})}At(N),N._fragId=Ct(N.static.frag),N._vertId=Ct(N.static.vert);var zt=N._uniformSet={};Ut(zt,et.static),Ut(zt,et.dynamic);var Zt=N._attributeSet={};Ut(Zt,mt.static),Ut(Zt,mt.dynamic),N._hasCount="count"in N.static||"count"in N.dynamic||"elements"in N.static||"elements"in N.dynamic},framebufferFormat:function(N,et,mt){N.texture?Bt(N.texture._texture.internalformat,et,"unsupported texture format for attachment"):Bt(N.renderbuffer._renderbuffer.format,mt,"unsupported renderbuffer format for attachment")},guessCommand:we,texture2D:function(N,et,mt){var Ot,Ct=et.width,Ut=et.height,zt=et.channels;K(Ct>0&&Ct<=mt.maxTextureSize&&Ut>0&&Ut<=mt.maxTextureSize,"invalid texture shape"),N.wrapS===ve&&N.wrapT===ve||K(Or(Ct)&&Or(Ut),"incompatible wrap mode for texture, both width and height must be power of 2"),et.mipmask===1?Ct!==1&&Ut!==1&&K(N.minFilter!==9984&&N.minFilter!==9986&&N.minFilter!==9985&&N.minFilter!==9987,"min filter requires mipmap"):(K(Or(Ct)&&Or(Ut),"texture must be a square power of 2 to support mipmapping"),K(et.mipmask===(Ct<<1)-1,"missing or incomplete mipmap data")),et.type===5126&&(mt.extensions.indexOf("oes_texture_float_linear")<0&&K(N.minFilter===9728&&N.magFilter===9728,"filter not supported, must enable oes_texture_float_linear"),K(!N.genMipmaps,"mipmap generation not supported with float textures"));var Zt=et.images;for(Ot=0;Ot<16;++Ot)if(Zt[Ot]){var $t=Ct>>Ot,qt=Ut>>Ot;K(et.mipmask&1<<Ot,"missing mipmap data");var Wt=Zt[Ot];if(K(Wt.width===$t&&Wt.height===qt,"invalid shape for mip images"),K(Wt.format===et.format&&Wt.internalformat===et.internalformat&&Wt.type===et.type,"incompatible type for mip image"),!Wt.compressed)if(Wt.data){var Yt=Math.ceil(wr(Wt.type,zt)*$t/Wt.unpackAlignment)*Wt.unpackAlignment;K(Wt.data.byteLength===Yt*qt,"invalid data for image, buffer size is inconsistent with image format")}else Wt.element||Wt.copy}else N.genMipmaps||K((et.mipmask&1<<Ot)==0,"extra mipmap data");et.compressed&&K(!N.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(N,et,mt,Ot){var Ct=N.width,Ut=N.height,zt=N.channels;K(Ct>0&&Ct<=Ot.maxTextureSize&&Ut>0&&Ut<=Ot.maxTextureSize,"invalid texture shape"),K(Ct===Ut,"cube map must be square"),K(et.wrapS===ve&&et.wrapT===ve,"wrap mode not supported by cube map");for(var Zt=0;Zt<mt.length;++Zt){var $t=mt[Zt];K($t.width===Ct&&$t.height===Ut,"inconsistent cube map face shape"),et.genMipmaps&&(K(!$t.compressed,"can not generate mipmap for compressed textures"),K($t.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var qt=$t.images,Wt=0;Wt<16;++Wt){var Yt=qt[Wt];if(Yt){var ne=Ct>>Wt,oe=Ut>>Wt;K($t.mipmask&1<<Wt,"missing mipmap data"),K(Yt.width===ne&&Yt.height===oe,"invalid shape for mip images"),K(Yt.format===N.format&&Yt.internalformat===N.internalformat&&Yt.type===N.type,"incompatible type for mip image"),Yt.compressed||(Yt.data?K(Yt.data.byteLength===ne*oe*Math.max(wr(Yt.type,zt),Yt.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Yt.element||Yt.copy)}}}}}),Br=0;function Le(N,et){this.id=Br++,this.type=N,this.data=et}function Er(N){return N.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function tn(N){if(N.length===0)return[];var et=N.charAt(0),mt=N.charAt(N.length-1);if(N.length>1&&et===mt&&(et==='"'||et==="'"))return['"'+Er(N.substr(1,N.length-2))+'"'];var Ot=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(N);if(Ot)return tn(N.substr(0,Ot.index)).concat(tn(Ot[1])).concat(tn(N.substr(Ot.index+Ot[0].length)));var Ct=N.split(".");if(Ct.length===1)return['"'+Er(N)+'"'];for(var Ut=[],zt=0;zt<Ct.length;++zt)Ut=Ut.concat(tn(Ct[zt]));return Ut}function Vt(N){return"["+tn(N).join("][")+"]"}var Lt={DynamicVariable:Le,define:function(N,et){return new Le(N,Vt(et+""))},isDynamic:function(N){return typeof N=="function"&&!N._reglType||N instanceof Le},unbox:function N(et,mt){return typeof et=="function"?new Le(0,et):typeof et=="number"||typeof et=="boolean"?new Le(5,et):Array.isArray(et)?new Le(6,et.map((Ot,Ct)=>N(Ot,mt+"["+Ct+"]"))):et instanceof Le?et:void O(!1,"invalid option type in uniform "+mt)},accessor:Vt},Ht={next:typeof requestAnimationFrame=="function"?function(N){return requestAnimationFrame(N)}:function(N){return setTimeout(N,16)},cancel:typeof cancelAnimationFrame=="function"?function(N){return cancelAnimationFrame(N)}:clearTimeout},ue=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function ie(N){return typeof N=="string"?N.split():(O(Array.isArray(N),"invalid extension array"),N)}function Ne(N){return typeof N=="string"?(O(typeof document<"u","not supported outside of DOM"),document.querySelector(N)):N}function Me(N){var et,mt,Ot,Ct,Ut,zt=N||{},Zt={},$t=[],qt=[],Wt=typeof window>"u"?1:window.devicePixelRatio,Yt=!1,ne=function(o){o&&O.raise(o)},oe=function(){};if(typeof zt=="string"?(O(typeof document<"u","selector queries only supported in DOM enviroments"),et=document.querySelector(zt),O(et,"invalid query string for element")):typeof zt=="object"?typeof(Ut=zt).nodeName=="string"&&typeof Ut.appendChild=="function"&&typeof Ut.getBoundingClientRect=="function"?et=zt:function(o){return typeof o.drawArrays=="function"||typeof o.drawElements=="function"}(zt)?Ot=(Ct=zt).canvas:(O.constructor(zt),"gl"in zt?Ct=zt.gl:"canvas"in zt?Ot=Ne(zt.canvas):"container"in zt&&(mt=Ne(zt.container)),"attributes"in zt&&(Zt=zt.attributes,O.type(Zt,"object","invalid context attributes")),"extensions"in zt&&($t=ie(zt.extensions)),"optionalExtensions"in zt&&(qt=ie(zt.optionalExtensions)),"onDone"in zt&&(O.type(zt.onDone,"function","invalid or missing onDone callback"),ne=zt.onDone),"profile"in zt&&(Yt=!!zt.profile),"pixelRatio"in zt&&(Wt=+zt.pixelRatio,O(Wt>0,"invalid pixel ratio"))):O.raise("invalid arguments to regl"),et&&(et.nodeName.toLowerCase()==="canvas"?Ot=et:mt=et),!Ct){if(!Ot){O(typeof document<"u","must manually specify webgl context outside of DOM environments");var he=function(o,r,t){var e,n=document.createElement("canvas");function i(){var s=window.innerWidth,u=window.innerHeight;if(o!==document.body){var c=o.getBoundingClientRect();s=c.right-c.left,u=c.bottom-c.top}n.width=t*s,n.height=t*u,x(n.style,{width:s+"px",height:u+"px"})}return x(n.style,{border:0,margin:0,padding:0,top:0,left:0}),o.appendChild(n),o===document.body&&(n.style.position="absolute",x(o.style,{margin:0,padding:0})),o!==document.body&&typeof ResizeObserver=="function"?(e=new ResizeObserver(function(){setTimeout(i)})).observe(o):window.addEventListener("resize",i,!1),i(),{canvas:n,onDestroy:function(){e?e.disconnect():window.removeEventListener("resize",i),o.removeChild(n)}}}(mt||document.body,0,Wt);if(!he)return null;Ot=he.canvas,oe=he.onDestroy}Zt.premultipliedAlpha===void 0&&(Zt.premultipliedAlpha=!0),Ct=function(o,r){function t(e){try{return o.getContext(e,r)}catch{return null}}return t("webgl")||t("experimental-webgl")||t("webgl-experimental")}(Ot,Zt)}return Ct?{gl:Ct,canvas:Ot,container:mt,extensions:$t,optionalExtensions:qt,pixelRatio:Wt,profile:Yt,onDone:ne,onDestroy:oe}:(oe(),ne("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Te(N,et){for(var mt=Array(N),Ot=0;Ot<N;++Ot)mt[Ot]=et(Ot);return mt}function er(N){var et,mt;return et=(N>65535)<<4,et|=mt=((N>>>=et)>255)<<3,et|=mt=((N>>>=mt)>15)<<2,(et|=mt=((N>>>=mt)>3)<<1)|(N>>>=mt)>>1}function Xr(){var N=Te(8,function(){return[]});function et(Ot){var Ct=function(zt){for(var Zt=16;Zt<=268435456;Zt*=16)if(zt<=Zt)return Zt;return 0}(Ot),Ut=N[er(Ct)>>2];return Ut.length>0?Ut.pop():new ArrayBuffer(Ct)}function mt(Ot){N[er(Ot.byteLength)>>2].push(Ot)}return{alloc:et,free:mt,allocType:function(Ot,Ct){var Ut=null;switch(Ot){case 5120:Ut=new Int8Array(et(Ct),0,Ct);break;case 5121:Ut=new Uint8Array(et(Ct),0,Ct);break;case 5122:Ut=new Int16Array(et(2*Ct),0,Ct);break;case 5123:Ut=new Uint16Array(et(2*Ct),0,Ct);break;case 5124:Ut=new Int32Array(et(4*Ct),0,Ct);break;case 5125:Ut=new Uint32Array(et(4*Ct),0,Ct);break;case 5126:Ut=new Float32Array(et(4*Ct),0,Ct);break;default:return null}return Ut.length!==Ct?Ut.subarray(0,Ct):Ut},freeType:function(Ot){mt(Ot.buffer)}}}var Ce=Xr();Ce.zero=Xr();var sr=3553,ln=6408,vr=5126,en=36160;function fr(N){return!!N&&typeof N=="object"&&Array.isArray(N.shape)&&Array.isArray(N.stride)&&typeof N.offset=="number"&&N.shape.length===N.stride.length&&(Array.isArray(N.data)||ft(N.data))}var Cr=function(N){return Object.keys(N).map(function(et){return N[et]})},Ko={shape:function(N){for(var et=[],mt=N;mt.length;mt=mt[0])et.push(mt.length);return et},flatten:function(N,et,mt,Ot){var Ct=1;if(et.length)for(var Ut=0;Ut<et.length;++Ut)Ct*=et[Ut];else Ct=0;var zt=Ot||Ce.allocType(mt,Ct);switch(et.length){case 0:break;case 1:(function(Zt,$t,qt){for(var Wt=0;Wt<$t;++Wt)qt[Wt]=Zt[Wt]})(N,et[0],zt);break;case 2:(function(Zt,$t,qt,Wt){for(var Yt=0,ne=0;ne<$t;++ne)for(var oe=Zt[ne],he=0;he<qt;++he)Wt[Yt++]=oe[he]})(N,et[0],et[1],zt);break;case 3:da(N,et[0],et[1],et[2],zt,0);break;default:la(N,et,0,zt,0)}return zt}};function da(N,et,mt,Ot,Ct,Ut){for(var zt=Ut,Zt=0;Zt<et;++Zt)for(var $t=N[Zt],qt=0;qt<mt;++qt)for(var Wt=$t[qt],Yt=0;Yt<Ot;++Yt)Ct[zt++]=Wt[Yt]}function la(N,et,mt,Ot,Ct){for(var Ut=1,zt=mt+1;zt<et.length;++zt)Ut*=et[zt];var Zt=et[mt];if(et.length-mt==4){var $t=et[mt+1],qt=et[mt+2],Wt=et[mt+3];for(zt=0;zt<Zt;++zt)da(N[zt],$t,qt,Wt,Ot,Ct),Ct+=Ut}else for(zt=0;zt<Zt;++zt)la(N[zt],et,mt+1,Ot,Ct),Ct+=Ut}var Ei={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Pn={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},bo={dynamic:35048,stream:35040,static:35044},No=Ko.flatten,ha=Ko.shape,fa=35044,ga=35040,Zo=5121,xi=5126,Sn=[];function _o(N){return 0|Ei[Object.prototype.toString.call(N)]}function Ao(N,et){for(var mt=0;mt<et.length;++mt)N[mt]=et[mt]}function pa(N,et,mt,Ot,Ct,Ut,zt){for(var Zt=0,$t=0;$t<mt;++$t)for(var qt=0;qt<Ot;++qt)N[Zt++]=et[Ct*$t+Ut*qt+zt]}Sn[5120]=1,Sn[5122]=2,Sn[5124]=4,Sn[5121]=1,Sn[5123]=2,Sn[5125]=4,Sn[5126]=4;var rn={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},is=0,as=1,Gn=4,va=5120,Fn=5121,bi=5122,Jn=5123,ma=5124,jn=5125,Ni=34963,ss=35040,_i=35044,Qo=new Float32Array(1),ya=new Uint32Array(Qo.buffer),to=5123;function wa(N){for(var et=Ce.allocType(to,N.length),mt=0;mt<N.length;++mt)if(isNaN(N[mt]))et[mt]=65535;else if(N[mt]===1/0)et[mt]=31744;else if(N[mt]===-1/0)et[mt]=64512;else{Qo[0]=N[mt];var Ot=ya[0],Ct=Ot>>>31<<15,Ut=(Ot<<1>>>24)-127,zt=Ot>>13&1023;if(Ut<-24)et[mt]=Ct;else if(Ut<-14){var Zt=-14-Ut;et[mt]=Ct+(zt+1024>>Zt)}else et[mt]=Ut>15?Ct+31744:Ct+(Ut+15<<10)+zt}return et}function ur(N){return Array.isArray(N)||ft(N)}var Ea=function(N){return!(N&N-1||!N)},xa=34467,nn=3553,Ai=34067,Vr=34069,Un=6408,Si=6406,Jo=6407,So=6409,a=6410,lt=32854,y=32855,at=36194,Y=32819,yt=32820,_t=33635,St=34042,It=6402,kt=34041,Tt=35904,ae=35906,te=36193,_e=33776,ce=33777,Se=33778,jt=33779,me=35986,He=35987,rr=34798,xr=35840,Fe=35841,Ze=35842,mr=35843,Sr=36196,br=5121,$r=5123,Mr=5125,gr=5126,qe=10242,Qe=10243,Tr=10497,nr=33071,Yr=33648,Ir=10240,Wr=10241,Kr=9728,Mn=9729,Lr=9984,je=9985,Je=9986,Ue=9987,Nr=33170,zr=4352,ir=4353,kr=4354,ke=34046,_r=3317,Ar=37440,Be=37441,Pr=37443,Dr=37444,Ye=33984,tr=[Lr,Je,je,Ue],on=[0,So,a,Jo,Un],De={};function Xe(N){return"[object "+N+"]"}De[So]=De[Si]=De[It]=1,De[kt]=De[a]=2,De[Jo]=De[Tt]=3,De[Un]=De[ae]=4;var Gr=Xe("HTMLCanvasElement"),eo=Xe("OffscreenCanvas"),Mo=Xe("CanvasRenderingContext2D"),Tn=Xe("ImageBitmap"),ro=Xe("HTMLImageElement"),Bn=Xe("HTMLVideoElement"),Mi=Object.keys(Ei).concat([Gr,eo,Mo,Tn,ro,Bn]),yn=[];yn[br]=1,yn[gr]=4,yn[te]=2,yn[$r]=2,yn[Mr]=4;var or=[];function Vn(N){return Array.isArray(N)&&(N.length===0||typeof N[0]=="number")}function no(N){return!!Array.isArray(N)&&!(N.length===0||!ur(N[0]))}function an(N){return Object.prototype.toString.call(N)}function Ti(N){return an(N)===Gr}function To(N){return an(N)===eo}function wn(N){if(!N)return!1;var et=an(N);return Mi.indexOf(et)>=0||Vn(N)||no(N)||fr(N)}function Io(N){return 0|Ei[Object.prototype.toString.call(N)]}function oo(N,et){return Ce.allocType(N.type===te?gr:N.type,et)}function Ii(N,et){N.type===te?(N.data=wa(et),Ce.freeType(et)):N.data=et}function ko(N,et,mt,Ot,Ct,Ut){var zt;if(zt=or[N]!==void 0?or[N]:De[N]*yn[et],Ut&&(zt*=6),Ct){for(var Zt=0,$t=mt;$t>=1;)Zt+=zt*$t*$t,$t/=2;return Zt}return zt*mt*Ot}function us(N,et,mt,Ot,Ct,Ut,zt){var Zt={"don't care":zr,"dont care":zr,nice:kr,fast:ir},$t={repeat:Tr,clamp:nr,mirror:Yr},qt={nearest:Kr,linear:Mn},Wt=x({mipmap:Ue,"nearest mipmap nearest":Lr,"linear mipmap nearest":je,"nearest mipmap linear":Je,"linear mipmap linear":Ue},qt),Yt={none:0,browser:Dr},ne={uint8:br,rgba4:Y,rgb565:_t,"rgb5 a1":yt},oe={alpha:Si,luminance:So,"luminance alpha":a,rgb:Jo,rgba:Un,rgba4:lt,"rgb5 a1":y,rgb565:at},he={};et.ext_srgb&&(oe.srgb=Tt,oe.srgba=ae),et.oes_texture_float&&(ne.float32=ne.float=gr),et.oes_texture_half_float&&(ne.float16=ne["half float"]=te),et.webgl_depth_texture&&(x(oe,{depth:It,"depth stencil":kt}),x(ne,{uint16:$r,uint32:Mr,"depth stencil":St})),et.webgl_compressed_texture_s3tc&&x(he,{"rgb s3tc dxt1":_e,"rgba s3tc dxt1":ce,"rgba s3tc dxt3":Se,"rgba s3tc dxt5":jt}),et.webgl_compressed_texture_atc&&x(he,{"rgb atc":me,"rgba atc explicit alpha":He,"rgba atc interpolated alpha":rr}),et.webgl_compressed_texture_pvrtc&&x(he,{"rgb pvrtc 4bppv1":xr,"rgb pvrtc 2bppv1":Fe,"rgba pvrtc 4bppv1":Ze,"rgba pvrtc 2bppv1":mr}),et.webgl_compressed_texture_etc1&&(he["rgb etc1"]=Sr);var o=Array.prototype.slice.call(N.getParameter(xa));Object.keys(he).forEach(function(g){var v=he[g];o.indexOf(v)>=0&&(oe[g]=v)});var r=Object.keys(oe);mt.textureFormats=r;var t=[];Object.keys(oe).forEach(function(g){var v=oe[g];t[v]=g});var e=[];Object.keys(ne).forEach(function(g){var v=ne[g];e[v]=g});var n=[];Object.keys(qt).forEach(function(g){var v=qt[g];n[v]=g});var i=[];Object.keys(Wt).forEach(function(g){var v=Wt[g];i[v]=g});var s=[];Object.keys($t).forEach(function(g){var v=$t[g];s[v]=g});var u=r.reduce(function(g,v){var f=oe[v];return f===So||f===Si||f===So||f===a||f===It||f===kt||et.ext_srgb&&(f===Tt||f===ae)?g[f]=f:f===y||v.indexOf("rgba")>=0?g[f]=Un:g[f]=Jo,g},{});function c(){this.internalformat=Un,this.format=Un,this.type=br,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Dr,this.width=0,this.height=0,this.channels=0}function h(g,v){g.internalformat=v.internalformat,g.format=v.format,g.type=v.type,g.compressed=v.compressed,g.premultiplyAlpha=v.premultiplyAlpha,g.flipY=v.flipY,g.unpackAlignment=v.unpackAlignment,g.colorSpace=v.colorSpace,g.width=v.width,g.height=v.height,g.channels=v.channels}function l(g,v){if(typeof v=="object"&&v){if("premultiplyAlpha"in v&&(O.type(v.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),g.premultiplyAlpha=v.premultiplyAlpha),"flipY"in v&&(O.type(v.flipY,"boolean","invalid texture flip"),g.flipY=v.flipY),"alignment"in v&&(O.oneOf(v.alignment,[1,2,4,8],"invalid texture unpack alignment"),g.unpackAlignment=v.alignment),"colorSpace"in v&&(O.parameter(v.colorSpace,Yt,"invalid colorSpace"),g.colorSpace=Yt[v.colorSpace]),"type"in v){var f=v.type;O(et.oes_texture_float||!(f==="float"||f==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),O(et.oes_texture_half_float||!(f==="half float"||f==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),O(et.webgl_depth_texture||!(f==="uint16"||f==="uint32"||f==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),O.parameter(f,ne,"invalid texture type"),g.type=ne[f]}var m=g.width,j=g.height,H=g.channels,p=!1;"shape"in v?(O(Array.isArray(v.shape)&&v.shape.length>=2,"shape must be an array"),m=v.shape[0],j=v.shape[1],v.shape.length===3&&(H=v.shape[2],O(H>0&&H<=4,"invalid number of channels"),p=!0),O(m>=0&&m<=mt.maxTextureSize,"invalid width"),O(j>=0&&j<=mt.maxTextureSize,"invalid height")):("radius"in v&&(m=j=v.radius,O(m>=0&&m<=mt.maxTextureSize,"invalid radius")),"width"in v&&(m=v.width,O(m>=0&&m<=mt.maxTextureSize,"invalid width")),"height"in v&&(j=v.height,O(j>=0&&j<=mt.maxTextureSize,"invalid height")),"channels"in v&&(H=v.channels,O(H>0&&H<=4,"invalid number of channels"),p=!0)),g.width=0|m,g.height=0|j,g.channels=0|H;var D=!1;if("format"in v){var B=v.format;O(et.webgl_depth_texture||!(B==="depth"||B==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),O.parameter(B,oe,"invalid texture format");var I=g.internalformat=oe[B];g.format=u[I],B in ne&&("type"in v||(g.type=ne[B])),B in he&&(g.compressed=!0),D=!0}!p&&D?g.channels=De[g.format]:p&&!D?g.channels!==on[g.format]&&(g.format=g.internalformat=on[g.channels]):D&&p&&O(g.channels===De[g.format],"number of channels inconsistent with specified format")}}function E(g){N.pixelStorei(Ar,g.flipY),N.pixelStorei(Be,g.premultiplyAlpha),N.pixelStorei(Pr,g.colorSpace),N.pixelStorei(_r,g.unpackAlignment)}function R(){c.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function _(g,v){var f=null;if(wn(v)?f=v:v&&(O.type(v,"object","invalid pixel data type"),l(g,v),"x"in v&&(g.xOffset=0|v.x),"y"in v&&(g.yOffset=0|v.y),wn(v.data)&&(f=v.data)),O(!g.compressed||f instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),v.copy){O(!f,"can not specify copy and data field for the same texture");var m=Ct.viewportWidth,j=Ct.viewportHeight;g.width=g.width||m-g.xOffset,g.height=g.height||j-g.yOffset,g.needsCopy=!0,O(g.xOffset>=0&&g.xOffset<m&&g.yOffset>=0&&g.yOffset<j&&g.width>0&&g.width<=m&&g.height>0&&g.height<=j,"copy texture read out of bounds")}else if(f){if(ft(f))g.channels=g.channels||4,g.data=f,"type"in v||g.type!==br||(g.type=Io(f));else if(Vn(f))g.channels=g.channels||4,function(T,V){var J=V.length;switch(T.type){case br:case $r:case Mr:case gr:var Et=Ce.allocType(T.type,J);Et.set(V),T.data=Et;break;case te:T.data=wa(V);break;default:O.raise("unsupported texture type, must specify a typed array")}}(g,f),g.alignment=1,g.needsFree=!0;else if(fr(f)){var H=f.data;Array.isArray(H)||g.type!==br||(g.type=Io(H));var p,D,B,I,q,Q,tt=f.shape,z=f.stride;tt.length===3?(B=tt[2],Q=z[2]):(O(tt.length===2,"invalid ndarray pixel data, must be 2 or 3D"),B=1,Q=1),p=tt[0],D=tt[1],I=z[0],q=z[1],g.alignment=1,g.width=p,g.height=D,g.channels=B,g.format=g.internalformat=on[B],g.needsFree=!0,function(T,V,J,Et,Pt,Gt){for(var Xt=T.width,se=T.height,pe=T.channels,Ee=oo(T,Xt*se*pe),xe=0,Jt=0;Jt<se;++Jt)for(var Re=0;Re<Xt;++Re)for(var Ke=0;Ke<pe;++Ke)Ee[xe++]=V[J*Re+Et*Jt+Pt*Ke+Gt];Ii(T,Ee)}(g,H,I,q,Q,f.offset)}else if(Ti(f)||To(f)||an(f)===Mo)Ti(f)||To(f)?g.element=f:g.element=f.canvas,g.width=g.element.width,g.height=g.element.height,g.channels=4;else if(function(T){return an(T)===Tn}(f))g.element=f,g.width=f.width,g.height=f.height,g.channels=4;else if(function(T){return an(T)===ro}(f))g.element=f,g.width=f.naturalWidth,g.height=f.naturalHeight,g.channels=4;else if(function(T){return an(T)===Bn}(f))g.element=f,g.width=f.videoWidth,g.height=f.videoHeight,g.channels=4;else if(no(f)){var $=g.width||f[0].length,st=g.height||f.length,pt=g.channels;pt=ur(f[0][0])?pt||f[0][0].length:pt||1;for(var ct=Ko.shape(f),vt=1,Nt=0;Nt<ct.length;++Nt)vt*=ct[Nt];var ut=oo(g,vt);Ko.flatten(f,ct,"",ut),Ii(g,ut),g.alignment=1,g.width=$,g.height=st,g.channels=pt,g.format=g.internalformat=on[pt],g.needsFree=!0}}else g.width=g.width||1,g.height=g.height||1,g.channels=g.channels||4;g.type===gr?O(mt.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):g.type===te&&O(mt.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function M(g,v,f){var m=g.element,j=g.data,H=g.internalformat,p=g.format,D=g.type,B=g.width,I=g.height;E(g),m?N.texImage2D(v,f,p,p,D,m):g.compressed?N.compressedTexImage2D(v,f,H,B,I,0,j):g.needsCopy?(Ot(),N.copyTexImage2D(v,f,p,g.xOffset,g.yOffset,B,I,0)):N.texImage2D(v,f,p,B,I,0,p,D,j||null)}function w(g,v,f,m,j){var H=g.element,p=g.data,D=g.internalformat,B=g.format,I=g.type,q=g.width,Q=g.height;E(g),H?N.texSubImage2D(v,j,f,m,B,I,H):g.compressed?N.compressedTexSubImage2D(v,j,f,m,D,q,Q,p):g.needsCopy?(Ot(),N.copyTexSubImage2D(v,j,f,m,g.xOffset,g.yOffset,q,Q)):N.texSubImage2D(v,j,f,m,q,Q,B,I,p)}var L=[];function k(){return L.pop()||new R}function P(g){g.needsFree&&Ce.freeType(g.data),R.call(g),L.push(g)}function wt(){c.call(this),this.genMipmaps=!1,this.mipmapHint=zr,this.mipmask=0,this.images=Array(16)}function gt(g,v,f){var m=g.images[0]=k();g.mipmask=1,m.width=g.width=v,m.height=g.height=f,m.channels=g.channels=4}function dt(g,v){var f=null;if(wn(v))h(f=g.images[0]=k(),g),_(f,v),g.mipmask=1;else if(l(g,v),Array.isArray(v.mipmap))for(var m=v.mipmap,j=0;j<m.length;++j)h(f=g.images[j]=k(),g),f.width>>=j,f.height>>=j,_(f,m[j]),g.mipmask|=1<<j;else h(f=g.images[0]=k(),g),_(f,v),g.mipmask=1;h(g,g.images[0]),!g.compressed||g.internalformat!==_e&&g.internalformat!==ce&&g.internalformat!==Se&&g.internalformat!==jt||O(g.width%4==0&&g.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function X(g,v){for(var f=g.images,m=0;m<f.length;++m){if(!f[m])return;M(f[m],v,m)}}var ot=[];function ht(){var g=ot.pop()||new wt;c.call(g),g.mipmask=0;for(var v=0;v<16;++v)g.images[v]=null;return g}function nt(g){for(var v=g.images,f=0;f<v.length;++f)v[f]&&P(v[f]),v[f]=null;ot.push(g)}function b(){this.minFilter=Kr,this.magFilter=Kr,this.wrapS=nr,this.wrapT=nr,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=zr}function C(g,v){if("min"in v){var f=v.min;O.parameter(f,Wt),g.minFilter=Wt[f],tr.indexOf(g.minFilter)>=0&&!("faces"in v)&&(g.genMipmaps=!0)}if("mag"in v){var m=v.mag;O.parameter(m,qt),g.magFilter=qt[m]}var j=g.wrapS,H=g.wrapT;if("wrap"in v){var p=v.wrap;typeof p=="string"?(O.parameter(p,$t),j=H=$t[p]):Array.isArray(p)&&(O.parameter(p[0],$t),O.parameter(p[1],$t),j=$t[p[0]],H=$t[p[1]])}else{if("wrapS"in v){var D=v.wrapS;O.parameter(D,$t),j=$t[D]}if("wrapT"in v){var B=v.wrapT;O.parameter(B,$t),H=$t[B]}}if(g.wrapS=j,g.wrapT=H,"anisotropic"in v){var I=v.anisotropic;O(typeof I=="number"&&I>=1&&I<=mt.maxAnisotropic,"aniso samples must be between 1 and "),g.anisotropic=v.anisotropic}if("mipmap"in v){var q=!1;switch(typeof v.mipmap){case"string":O.parameter(v.mipmap,Zt,"invalid mipmap hint"),g.mipmapHint=Zt[v.mipmap],g.genMipmaps=!0,q=!0;break;case"boolean":q=g.genMipmaps=v.mipmap;break;case"object":O(Array.isArray(v.mipmap),"invalid mipmap type"),g.genMipmaps=!1,q=!0;break;default:O.raise("invalid mipmap type")}q&&!("min"in v)&&(g.minFilter=Lr)}}function Z(g,v){N.texParameteri(v,Wr,g.minFilter),N.texParameteri(v,Ir,g.magFilter),N.texParameteri(v,qe,g.wrapS),N.texParameteri(v,Qe,g.wrapT),et.ext_texture_filter_anisotropic&&N.texParameteri(v,ke,g.anisotropic),g.genMipmaps&&(N.hint(Nr,g.mipmapHint),N.generateMipmap(v))}var W=0,xt={},A=mt.maxTextureUnits,d=Array(A).map(function(){return null});function S(g){c.call(this),this.mipmask=0,this.internalformat=Un,this.id=W++,this.refCount=1,this.target=g,this.texture=N.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new b,zt.profile&&(this.stats={size:0})}function G(g){N.activeTexture(Ye),N.bindTexture(g.target,g.texture)}function rt(){var g=d[0];g?N.bindTexture(g.target,g.texture):N.bindTexture(nn,null)}function it(g){var v=g.texture;O(v,"must not double destroy texture");var f=g.unit,m=g.target;f>=0&&(N.activeTexture(Ye+f),N.bindTexture(m,null),d[f]=null),N.deleteTexture(v),g.texture=null,g.params=null,g.pixels=null,g.refCount=0,delete xt[g.id],Ut.textureCount--}return x(S.prototype,{bind:function(){var g=this;g.bindCount+=1;var v=g.unit;if(v<0){for(var f=0;f<A;++f){var m=d[f];if(m){if(m.bindCount>0)continue;m.unit=-1}d[f]=g,v=f;break}v>=A&&O.raise("insufficient number of texture units"),zt.profile&&Ut.maxTextureUnits<v+1&&(Ut.maxTextureUnits=v+1),g.unit=v,N.activeTexture(Ye+v),N.bindTexture(g.target,g.texture)}return v},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&it(this)}}),zt.profile&&(Ut.getTotalTextureSize=function(){var g=0;return Object.keys(xt).forEach(function(v){g+=xt[v].stats.size}),g}),{create2D:function(g,v){var f=new S(nn);function m(j,H){var p=f.texInfo;b.call(p);var D=ht();return typeof j=="number"?gt(D,0|j,typeof H=="number"?0|H:0|j):j?(O.type(j,"object","invalid arguments to regl.texture"),C(p,j),dt(D,j)):gt(D,1,1),p.genMipmaps&&(D.mipmask=(D.width<<1)-1),f.mipmask=D.mipmask,h(f,D),O.texture2D(p,D,mt),f.internalformat=D.internalformat,m.width=D.width,m.height=D.height,G(f),X(D,nn),Z(p,nn),rt(),nt(D),zt.profile&&(f.stats.size=ko(f.internalformat,f.type,D.width,D.height,p.genMipmaps,!1)),m.format=t[f.internalformat],m.type=e[f.type],m.mag=n[p.magFilter],m.min=i[p.minFilter],m.wrapS=s[p.wrapS],m.wrapT=s[p.wrapT],m}return xt[f.id]=f,Ut.textureCount++,m(g,v),m.subimage=function(j,H,p,D){O(!!j,"must specify image data");var B=0|H,I=0|p,q=0|D,Q=k();return h(Q,f),Q.width=0,Q.height=0,_(Q,j),Q.width=Q.width||(f.width>>q)-B,Q.height=Q.height||(f.height>>q)-I,O(f.type===Q.type&&f.format===Q.format&&f.internalformat===Q.internalformat,"incompatible format for texture.subimage"),O(B>=0&&I>=0&&B+Q.width<=f.width&&I+Q.height<=f.height,"texture.subimage write out of bounds"),O(f.mipmask&1<<q,"missing mipmap data"),O(Q.data||Q.element||Q.needsCopy,"missing image data"),G(f),w(Q,nn,B,I,q),rt(),P(Q),m},m.resize=function(j,H){var p=0|j,D=0|H||p;if(p===f.width&&D===f.height)return m;m.width=f.width=p,m.height=f.height=D,G(f);for(var B=0;f.mipmask>>B;++B){var I=p>>B,q=D>>B;if(!I||!q)break;N.texImage2D(nn,B,f.format,I,q,0,f.format,f.type,null)}return rt(),zt.profile&&(f.stats.size=ko(f.internalformat,f.type,p,D,!1,!1)),m},m._reglType="texture2d",m._texture=f,zt.profile&&(m.stats=f.stats),m.destroy=function(){f.decRef()},m},createCube:function(g,v,f,m,j,H){var p=new S(Ai);xt[p.id]=p,Ut.cubeCount++;var D=new Array(6);function B(I,q,Q,tt,z,$){var st,pt=p.texInfo;for(b.call(pt),st=0;st<6;++st)D[st]=ht();if(typeof I!="number"&&I)if(typeof I=="object")if(q)dt(D[0],I),dt(D[1],q),dt(D[2],Q),dt(D[3],tt),dt(D[4],z),dt(D[5],$);else if(C(pt,I),l(p,I),"faces"in I){var ct=I.faces;for(O(Array.isArray(ct)&&ct.length===6,"cube faces must be a length 6 array"),st=0;st<6;++st)O(typeof ct[st]=="object"&&!!ct[st],"invalid input for cube map face"),h(D[st],p),dt(D[st],ct[st])}else for(st=0;st<6;++st)dt(D[st],I);else O.raise("invalid arguments to cube map");else{var vt=0|I||1;for(st=0;st<6;++st)gt(D[st],vt,vt)}for(h(p,D[0]),mt.npotTextureCube||O(Ea(p.width)&&Ea(p.height),"your browser does not support non power or two texture dimensions"),pt.genMipmaps?p.mipmask=(D[0].width<<1)-1:p.mipmask=D[0].mipmask,O.textureCube(p,pt,D,mt),p.internalformat=D[0].internalformat,B.width=D[0].width,B.height=D[0].height,G(p),st=0;st<6;++st)X(D[st],Vr+st);for(Z(pt,Ai),rt(),zt.profile&&(p.stats.size=ko(p.internalformat,p.type,B.width,B.height,pt.genMipmaps,!0)),B.format=t[p.internalformat],B.type=e[p.type],B.mag=n[pt.magFilter],B.min=i[pt.minFilter],B.wrapS=s[pt.wrapS],B.wrapT=s[pt.wrapT],st=0;st<6;++st)nt(D[st]);return B}return B(g,v,f,m,j,H),B.subimage=function(I,q,Q,tt,z){O(!!q,"must specify image data"),O(typeof I=="number"&&I===(0|I)&&I>=0&&I<6,"invalid face");var $=0|Q,st=0|tt,pt=0|z,ct=k();return h(ct,p),ct.width=0,ct.height=0,_(ct,q),ct.width=ct.width||(p.width>>pt)-$,ct.height=ct.height||(p.height>>pt)-st,O(p.type===ct.type&&p.format===ct.format&&p.internalformat===ct.internalformat,"incompatible format for texture.subimage"),O($>=0&&st>=0&&$+ct.width<=p.width&&st+ct.height<=p.height,"texture.subimage write out of bounds"),O(p.mipmask&1<<pt,"missing mipmap data"),O(ct.data||ct.element||ct.needsCopy,"missing image data"),G(p),w(ct,Vr+I,$,st,pt),rt(),P(ct),B},B.resize=function(I){var q=0|I;if(q!==p.width){B.width=p.width=q,B.height=p.height=q,G(p);for(var Q=0;Q<6;++Q)for(var tt=0;p.mipmask>>tt;++tt)N.texImage2D(Vr+Q,tt,p.format,q>>tt,q>>tt,0,p.format,p.type,null);return rt(),zt.profile&&(p.stats.size=ko(p.internalformat,p.type,B.width,B.height,!1,!0)),B}},B._reglType="textureCube",B._texture=p,zt.profile&&(B.stats=p.stats),B.destroy=function(){p.decRef()},B},clear:function(){for(var g=0;g<A;++g)N.activeTexture(Ye+g),N.bindTexture(nn,null),d[g]=null;Cr(xt).forEach(it),Ut.cubeCount=0,Ut.textureCount=0},getTexture:function(g){return null},restore:function(){for(var g=0;g<A;++g){var v=d[g];v&&(v.bindCount=0,v.unit=-1,d[g]=null)}Cr(xt).forEach(function(f){f.texture=N.createTexture(),N.bindTexture(f.target,f.texture);for(var m=0;m<32;++m)if(f.mipmask&1<<m)if(f.target===nn)N.texImage2D(nn,m,f.internalformat,f.width>>m,f.height>>m,0,f.internalformat,f.type,null);else for(var j=0;j<6;++j)N.texImage2D(Vr+j,m,f.internalformat,f.width>>m,f.height>>m,0,f.internalformat,f.type,null);Z(f.texInfo,f.target)})},refresh:function(){for(var g=0;g<A;++g){var v=d[g];v&&(v.bindCount=0,v.unit=-1,d[g]=null),N.activeTexture(Ye+g),N.bindTexture(nn,null),N.bindTexture(Ai,null)}}}}or[lt]=2,or[y]=2,or[at]=2,or[kt]=4,or[_e]=.5,or[ce]=.5,or[Se]=1,or[jt]=1,or[me]=.5,or[He]=1,or[rr]=1,or[xr]=.5,or[Fe]=.25,or[Ze]=.5,or[mr]=.25,or[Sr]=.5;var hn=36161,ti=32854,Zr=[];function ba(N,et,mt){return Zr[N]*et*mt}Zr[32854]=2,Zr[32855]=2,Zr[36194]=2,Zr[33189]=2,Zr[36168]=1,Zr[34041]=4,Zr[35907]=4,Zr[34836]=16,Zr[34842]=8,Zr[34843]=6;var sn=36160,ki=36161,Wn=3553,Do=34069,Na=36064,_a=36096,Aa=36128,Sa=33306,Di=36053,Ma=6402,cs=[6407,6408],ei=[];ei[6408]=4,ei[6407]=3;var io=[];io[5121]=1,io[5126]=4,io[36193]=2;var ds=33189,ls=36168,Ri=34041,Ta=[32854,32855,36194,35907,34842,34843,34836],ao={};ao[Di]="complete",ao[36054]="incomplete attachment",ao[36057]="incomplete dimensions",ao[36055]="incomplete, missing attachment",ao[36061]="unsupported";var Ia=5126,Ro=34962;function so(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Ia,this.offset=0,this.stride=0,this.divisor=0}var ka=35632,Da=35633,Oi=35718,Fr=35721,hs=6408,uo=5121,fs=3333,Ci=5126;function Li(N,et,mt,Ot,Ct,Ut,zt){function Zt($t){var qt;et.next===null?(O(Ct.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),qt=uo):(O(et.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),qt=et.next.colorAttachments[0].texture._texture.type,Ut.oes_texture_float?(O(qt===uo||qt===Ci,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),qt===Ci&&O(zt.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):O(qt===uo,"Reading from a framebuffer is only allowed for the type 'uint8'"));var Wt=0,Yt=0,ne=Ot.framebufferWidth,oe=Ot.framebufferHeight,he=null;ft($t)?he=$t:$t&&(O.type($t,"object","invalid arguments to regl.read()"),Wt=0|$t.x,Yt=0|$t.y,O(Wt>=0&&Wt<Ot.framebufferWidth,"invalid x offset for regl.read"),O(Yt>=0&&Yt<Ot.framebufferHeight,"invalid y offset for regl.read"),ne=0|($t.width||Ot.framebufferWidth-Wt),oe=0|($t.height||Ot.framebufferHeight-Yt),he=$t.data||null),he&&(qt===uo?O(he instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):qt===Ci&&O(he instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),O(ne>0&&ne+Wt<=Ot.framebufferWidth,"invalid width for read pixels"),O(oe>0&&oe+Yt<=Ot.framebufferHeight,"invalid height for read pixels"),mt();var o=ne*oe*4;return he||(qt===uo?he=new Uint8Array(o):qt===Ci&&(he=he||new Float32Array(o))),O.isTypedArray(he,"data buffer for regl.read() must be a typedarray"),O(he.byteLength>=o,"data buffer for regl.read() too small"),N.pixelStorei(fs,4),N.readPixels(Wt,Yt,ne,oe,hs,qt,he),he}return function($t){return $t&&"framebuffer"in $t?function(qt){var Wt;return et.setFBO({framebuffer:qt.framebuffer},function(){Wt=Zt(qt)}),Wt}($t):Zt($t)}}function In(N){return Array.prototype.slice.call(N)}function un(N){return In(N).join("")}var qn="xyzw".split(""),zi=5121,fn=1,ri=2,ni=0,Oo=1,oi=2,ii=3,Co=4,Pi=5,En=6,Ra="dither",Oa="blend.enable",Gi="blend.color",ai="blend.equation",si="blend.func",Ca="depth.enable",La="depth.func",Fi="depth.range",ji="depth.mask",Ui="colorMask",za="cull.enable",Pa="cull.face",Bi="frontFace",Vi="lineWidth",Wi="polygonOffset.enable",qi="polygonOffset.offset",Hi="sample.alpha",Xi="sample.enable",ui="sample.coverage",$i="stencil.enable",ci="stencil.mask",Lo="stencil.func",di="stencil.opFront",zo="stencil.opBack",Yi="scissor.enable",Po="scissor.box",gn="viewport",Go="profile",Hn="framebuffer",Xn="vert",co="frag",kn="elements",Dn="primitive",xn="count",Fo="offset",li="instances",jo="vao",Ki="Width",Zi="Height",lo=Hn+Ki,ho=Hn+Zi,gs=gn+Ki,ps=gn+Zi,Qi="drawingBuffer",Ga=Qi+Ki,Fa=Qi+Zi,vs=[si,ai,Lo,di,zo,ui,gn,Po,qi],fo=34962,ms=34963,ja=3553,ys=34067,ws=2884,Es=3042,xs=3024,bs=2960,Ua=2929,Ba=3089,Ns=32823,Va=32926,_s=32928,Ji=5126,hi=35664,Uo=35665,Bo=35666,ta=5124,fi=35667,Vo=35668,go=35669,ea=35670,gi=35671,pi=35672,vi=35673,Wo=35674,po=35675,qo=35676,vo=35678,Ho=35680,ra=4,Rn=1028,pn=1029,mi=2304,yi=2305,Wa=32775,As=32776,Ss=519,cr=7680,na=0,Xo=1,oa=32774,qa=513,Ha=36160,Xa=36064,dr={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Qr=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],cn={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},qr={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},ia={frag:35632,vert:35633},mo={cw:mi,ccw:yi};function $n(N){return Array.isArray(N)||ft(N)||fr(N)}function Yn(N){return N.sort(function(et,mt){return et===gn?-1:mt===gn?1:et<mt?-1:1})}function ge(N,et,mt,Ot){this.thisDep=N,this.contextDep=et,this.propDep=mt,this.append=Ot}function bn(N){return N&&!(N.thisDep||N.contextDep||N.propDep)}function Kt(N){return new ge(!1,!1,!1,N)}function jr(N,et){var mt=N.type;if(mt===ni){var Ot=N.data.length;return new ge(!0,Ot>=1,Ot>=2,et)}if(mt===Co){var Ct=N.data;return new ge(Ct.thisDep,Ct.contextDep,Ct.propDep,et)}if(mt===Pi)return new ge(!1,!1,!1,et);if(mt===En){for(var Ut=!1,zt=!1,Zt=!1,$t=0;$t<N.data.length;++$t){var qt=N.data[$t];if(qt.type===Oo)Zt=!0;else if(qt.type===oi)zt=!0;else if(qt.type===ii)Ut=!0;else if(qt.type===ni){Ut=!0;var Wt=qt.data;Wt>=1&&(zt=!0),Wt>=2&&(Zt=!0)}else qt.type===Co&&(Ut=Ut||qt.data.thisDep,zt=zt||qt.data.contextDep,Zt=Zt||qt.data.propDep)}return new ge(Ut,zt,Zt,et)}return new ge(mt===ii,mt===oi,mt===Oo,et)}var Kn=new ge(!1,!1,!1,function(){});function $a(N,et,mt,Ot,Ct,Ut,zt,Zt,$t,qt,Wt,Yt,ne,oe,he){var o=qt.Record,r={add:32774,subtract:32778,"reverse subtract":32779};mt.ext_blend_minmax&&(r.min=Wa,r.max=As);var t=mt.angle_instanced_arrays,e=mt.webgl_draw_buffers,n={dirty:!0,profile:he.profile},i={},s=[],u={},c={};function h(A){return A.replace(".","_")}function l(A,d,S){var G=h(A);s.push(A),i[G]=n[G]=!!S,u[G]=d}function E(A,d,S){var G=h(A);s.push(A),Array.isArray(S)?(n[G]=S.slice(),i[G]=S.slice()):n[G]=i[G]=S,c[G]=d}l(Ra,xs),l(Oa,Es),E(Gi,"blendColor",[0,0,0,0]),E(ai,"blendEquationSeparate",[oa,oa]),E(si,"blendFuncSeparate",[Xo,na,Xo,na]),l(Ca,Ua,!0),E(La,"depthFunc",qa),E(Fi,"depthRange",[0,1]),E(ji,"depthMask",!0),E(Ui,Ui,[!0,!0,!0,!0]),l(za,ws),E(Pa,"cullFace",pn),E(Bi,Bi,yi),E(Vi,Vi,1),l(Wi,Ns),E(qi,"polygonOffset",[0,0]),l(Hi,Va),l(Xi,_s),E(ui,"sampleCoverage",[1,!1]),l($i,bs),E(ci,"stencilMask",-1),E(Lo,"stencilFunc",[Ss,0,-1]),E(di,"stencilOpSeparate",[Rn,cr,cr,cr]),E(zo,"stencilOpSeparate",[pn,cr,cr,cr]),l(Yi,Ba),E(Po,"scissor",[0,0,N.drawingBufferWidth,N.drawingBufferHeight]),E(gn,gn,[0,0,N.drawingBufferWidth,N.drawingBufferHeight]);var R={gl:N,context:ne,strings:et,next:i,current:n,draw:Yt,elements:Ut,buffer:Ct,shader:Wt,attributes:qt.state,vao:qt,uniforms:$t,framebuffer:Zt,extensions:mt,timer:oe,isBufferArgs:$n},_={primTypes:rn,compareFuncs:cn,blendFuncs:dr,blendEquations:r,stencilOps:qr,glTypes:Pn,orientationType:mo};O.optional(function(){R.isArrayLike=ur}),e&&(_.backBuffer=[pn],_.drawBuffer=Te(Ot.maxDrawbuffers,function(A){return A===0?[0]:Te(A,function(d){return Xa+d})}));var M=0;function w(){var A=function(){var m=0,j=[],H=[];function p(){var q=[],Q=[];return x(function(){q.push.apply(q,In(arguments))},{def:function(){var tt="v"+m++;return Q.push(tt),arguments.length>0&&(q.push(tt,"="),q.push.apply(q,In(arguments)),q.push(";")),tt},toString:function(){return un([Q.length>0?"var "+Q.join(",")+";":"",un(q)])}})}function D(){var q=p(),Q=p(),tt=q.toString,z=Q.toString;function $(st,pt){Q(st,pt,"=",q.def(st,pt),";")}return x(function(){q.apply(q,In(arguments))},{def:q.def,entry:q,exit:Q,save:$,set:function(st,pt,ct){$(st,pt),q(st,pt,"=",ct,";")},toString:function(){return tt()+z()}})}var B=p(),I={};return{global:B,link:function(q){for(var Q=0;Q<H.length;++Q)if(H[Q]===q)return j[Q];var tt="g"+m++;return j.push(tt),H.push(q),tt},block:p,proc:function(q,Q){var tt=[];function z(){var ct="a"+tt.length;return tt.push(ct),ct}Q=Q||0;for(var $=0;$<Q;++$)z();var st=D(),pt=st.toString;return I[q]=x(st,{arg:z,toString:function(){return un(["function(",tt.join(),"){",pt(),"}"])}})},scope:D,cond:function(){var q=un(arguments),Q=D(),tt=D(),z=Q.toString,$=tt.toString;return x(Q,{then:function(){return Q.apply(Q,In(arguments)),this},else:function(){return tt.apply(tt,In(arguments)),this},toString:function(){var st=$();return st&&(st="else{"+st+"}"),un(["if(",q,"){",z(),"}",st])}})},compile:function(){var q=['"use strict";',B,"return {"];Object.keys(I).forEach(function(tt){q.push('"',tt,'":',I[tt].toString(),",")}),q.push("}");var Q=un(q).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`);return Function.apply(null,j.concat(Q)).apply(null,H)}}}(),d=A.link,S=A.global;A.id=M++,A.batchId="0";var G=d(R),rt=A.shared={props:"a0"};Object.keys(R).forEach(function(m){rt[m]=S.def(G,".",m)}),O.optional(function(){A.CHECK=d(O),A.commandStr=O.guessCommand(),A.command=d(A.commandStr),A.assert=function(m,j,H){m("if(!(",j,"))",this.CHECK,".commandRaise(",d(H),",",this.command,");")},_.invalidBlendCombinations=Qr});var it=A.next={},g=A.current={};Object.keys(c).forEach(function(m){Array.isArray(n[m])&&(it[m]=S.def(rt.next,".",m),g[m]=S.def(rt.current,".",m))});var v=A.constants={};Object.keys(_).forEach(function(m){v[m]=S.def(JSON.stringify(_[m]))}),A.invoke=function(m,j){switch(j.type){case ni:var H=["this",rt.context,rt.props,A.batchId];return m.def(d(j.data),".call(",H.slice(0,Math.max(j.data.length+1,4)),")");case Oo:return m.def(rt.props,j.data);case oi:return m.def(rt.context,j.data);case ii:return m.def("this",j.data);case Co:return j.data.append(A,m),j.data.ref;case Pi:return j.data.toString();case En:return j.data.map(function(p){return A.invoke(m,p)})}},A.attribCache={};var f={};return A.scopeAttrib=function(m){var j=et.id(m);if(j in f)return f[j];var H=qt.scope[j];return H||(H=qt.scope[j]=new o),f[j]=d(H)},A}function L(A,d,S,G,rt){var it=A.static,g=A.dynamic;O.optional(function(){var z=[Hn,Xn,co,kn,Dn,Fo,xn,li,Go,jo].concat(s);function $(st){Object.keys(st).forEach(function(pt){O.command(z.indexOf(pt)>=0,'unknown parameter "'+pt+'"',rt.commandStr)})}$(it),$(g)});var v=function(z,$){var st=z.static;if(typeof st[co]=="string"&&typeof st[Xn]=="string"){if(Object.keys($.dynamic).length>0)return null;var pt=$.static,ct=Object.keys(pt);if(ct.length>0&&typeof pt[ct[0]]=="number"){for(var vt=[],Nt=0;Nt<ct.length;++Nt)O(typeof pt[ct[Nt]]=="number","must specify all vertex attribute locations when using vaos"),vt.push([0|pt[ct[Nt]],ct[Nt]]);return vt}}return null}(A,d),f=function(z,$){var st=z.static,pt=z.dynamic;if(Hn in st){var ct=st[Hn];return ct?(ct=Zt.getFramebuffer(ct),O.command(ct,"invalid framebuffer object"),Kt(function(Nt,ut){var T=Nt.link(ct),V=Nt.shared;ut.set(V.framebuffer,".next",T);var J=V.context;return ut.set(J,"."+lo,T+".width"),ut.set(J,"."+ho,T+".height"),T})):Kt(function(Nt,ut){var T=Nt.shared;ut.set(T.framebuffer,".next","null");var V=T.context;return ut.set(V,"."+lo,V+"."+Ga),ut.set(V,"."+ho,V+"."+Fa),"null"})}if(Hn in pt){var vt=pt[Hn];return jr(vt,function(Nt,ut){var T=Nt.invoke(ut,vt),V=Nt.shared,J=V.framebuffer,Et=ut.def(J,".getFramebuffer(",T,")");O.optional(function(){Nt.assert(ut,"!"+T+"||"+Et,"invalid framebuffer object")}),ut.set(J,".next",Et);var Pt=V.context;return ut.set(Pt,"."+lo,Et+"?"+Et+".width:"+Pt+"."+Ga),ut.set(Pt,"."+ho,Et+"?"+Et+".height:"+Pt+"."+Fa),Et})}return null}(A),m=function(z,$,st){var pt=z.static,ct=z.dynamic;function vt(T){if(T in pt){var V=pt[T];O.commandType(V,"object","invalid "+T,st.commandStr);var J,Et,Pt=!0,Gt=0|V.x,Xt=0|V.y;return"width"in V?(J=0|V.width,O.command(J>=0,"invalid "+T,st.commandStr)):Pt=!1,"height"in V?(Et=0|V.height,O.command(Et>=0,"invalid "+T,st.commandStr)):Pt=!1,new ge(!Pt&&$&&$.thisDep,!Pt&&$&&$.contextDep,!Pt&&$&&$.propDep,function(Ee,xe){var Jt=Ee.shared.context,Re=J;"width"in V||(Re=xe.def(Jt,".",lo,"-",Gt));var Ke=Et;return"height"in V||(Ke=xe.def(Jt,".",ho,"-",Xt)),[Gt,Xt,Re,Ke]})}if(T in ct){var se=ct[T],pe=jr(se,function(Ee,xe){var Jt=Ee.invoke(xe,se);O.optional(function(){Ee.assert(xe,Jt+"&&typeof "+Jt+'==="object"',"invalid "+T)});var Re=Ee.shared.context,Ke=xe.def(Jt,".x|0"),dn=xe.def(Jt,".y|0"),vn=xe.def('"width" in ',Jt,"?",Jt,".width|0:","(",Re,".",lo,"-",Ke,")"),yo=xe.def('"height" in ',Jt,"?",Jt,".height|0:","(",Re,".",ho,"-",dn,")");return O.optional(function(){Ee.assert(xe,vn+">=0&&"+yo+">=0","invalid "+T)}),[Ke,dn,vn,yo]});return $&&(pe.thisDep=pe.thisDep||$.thisDep,pe.contextDep=pe.contextDep||$.contextDep,pe.propDep=pe.propDep||$.propDep),pe}return $?new ge($.thisDep,$.contextDep,$.propDep,function(Ee,xe){var Jt=Ee.shared.context;return[0,0,xe.def(Jt,".",lo),xe.def(Jt,".",ho)]}):null}var Nt=vt(gn);if(Nt){var ut=Nt;Nt=new ge(Nt.thisDep,Nt.contextDep,Nt.propDep,function(T,V){var J=ut.append(T,V),Et=T.shared.context;return V.set(Et,"."+gs,J[2]),V.set(Et,"."+ps,J[3]),J})}return{viewport:Nt,scissor_box:vt(Po)}}(A,f,rt),j=function(z,$){var st=z.static,pt=z.dynamic,ct=function(){if(kn in st){var ut=st[kn];$n(ut)?ut=Ut.getElements(Ut.create(ut,!0)):ut&&(ut=Ut.getElements(ut),O.command(ut,"invalid elements",$.commandStr));var T=Kt(function(J,Et){if(ut){var Pt=J.link(ut);return J.ELEMENTS=Pt,Pt}return J.ELEMENTS=null,null});return T.value=ut,T}if(kn in pt){var V=pt[kn];return jr(V,function(J,Et){var Pt=J.shared,Gt=Pt.isBufferArgs,Xt=Pt.elements,se=J.invoke(Et,V),pe=Et.def("null"),Ee=Et.def(Gt,"(",se,")"),xe=J.cond(Ee).then(pe,"=",Xt,".createStream(",se,");").else(pe,"=",Xt,".getElements(",se,");");return O.optional(function(){J.assert(xe.else,"!"+se+"||"+pe,"invalid elements")}),Et.entry(xe),Et.exit(J.cond(Ee).then(Xt,".destroyStream(",pe,");")),J.ELEMENTS=pe,pe})}return null}();function vt(ut,T){if(ut in st){var V=0|st[ut];return O.command(!T||V>=0,"invalid "+ut,$.commandStr),Kt(function(Et,Pt){return T&&(Et.OFFSET=V),V})}if(ut in pt){var J=pt[ut];return jr(J,function(Et,Pt){var Gt=Et.invoke(Pt,J);return T&&(Et.OFFSET=Gt,O.optional(function(){Et.assert(Pt,Gt+">=0","invalid "+ut)})),Gt})}return T&&ct?Kt(function(Et,Pt){return Et.OFFSET="0",0}):null}var Nt=vt(Fo,!0);return{elements:ct,primitive:function(){if(Dn in st){var ut=st[Dn];return O.commandParameter(ut,rn,"invalid primitve",$.commandStr),Kt(function(V,J){return rn[ut]})}if(Dn in pt){var T=pt[Dn];return jr(T,function(V,J){var Et=V.constants.primTypes,Pt=V.invoke(J,T);return O.optional(function(){V.assert(J,Pt+" in "+Et,"invalid primitive, must be one of "+Object.keys(rn))}),J.def(Et,"[",Pt,"]")})}return ct?bn(ct)?ct.value?Kt(function(V,J){return J.def(V.ELEMENTS,".primType")}):Kt(function(){return ra}):new ge(ct.thisDep,ct.contextDep,ct.propDep,function(V,J){var Et=V.ELEMENTS;return J.def(Et,"?",Et,".primType:",ra)}):null}(),count:function(){if(xn in st){var ut=0|st[xn];return O.command(typeof ut=="number"&&ut>=0,"invalid vertex count",$.commandStr),Kt(function(){return ut})}if(xn in pt){var T=pt[xn];return jr(T,function(Et,Pt){var Gt=Et.invoke(Pt,T);return O.optional(function(){Et.assert(Pt,"typeof "+Gt+'==="number"&&'+Gt+">=0&&"+Gt+"===("+Gt+"|0)","invalid vertex count")}),Gt})}if(ct){if(bn(ct)){if(ct)return Nt?new ge(Nt.thisDep,Nt.contextDep,Nt.propDep,function(Et,Pt){var Gt=Pt.def(Et.ELEMENTS,".vertCount-",Et.OFFSET);return O.optional(function(){Et.assert(Pt,Gt+">=0","invalid vertex offset/element buffer too small")}),Gt}):Kt(function(Et,Pt){return Pt.def(Et.ELEMENTS,".vertCount")});var V=Kt(function(){return-1});return O.optional(function(){V.MISSING=!0}),V}var J=new ge(ct.thisDep||Nt.thisDep,ct.contextDep||Nt.contextDep,ct.propDep||Nt.propDep,function(Et,Pt){var Gt=Et.ELEMENTS;return Et.OFFSET?Pt.def(Gt,"?",Gt,".vertCount-",Et.OFFSET,":-1"):Pt.def(Gt,"?",Gt,".vertCount:-1")});return O.optional(function(){J.DYNAMIC=!0}),J}return null}(),instances:vt(li,!1),offset:Nt}}(A,rt),H=function(z,$){var st=z.static,pt=z.dynamic,ct={};return s.forEach(function(vt){var Nt=h(vt);function ut(T,V){if(vt in st){var J=T(st[vt]);ct[Nt]=Kt(function(){return J})}else if(vt in pt){var Et=pt[vt];ct[Nt]=jr(Et,function(Pt,Gt){return V(Pt,Gt,Pt.invoke(Gt,Et))})}}switch(vt){case za:case Oa:case Ra:case $i:case Ca:case Yi:case Wi:case Hi:case Xi:case ji:return ut(function(T){return O.commandType(T,"boolean",vt,$.commandStr),T},function(T,V,J){return O.optional(function(){T.assert(V,"typeof "+J+'==="boolean"',"invalid flag "+vt,T.commandStr)}),J});case La:return ut(function(T){return O.commandParameter(T,cn,"invalid "+vt,$.commandStr),cn[T]},function(T,V,J){var Et=T.constants.compareFuncs;return O.optional(function(){T.assert(V,J+" in "+Et,"invalid "+vt+", must be one of "+Object.keys(cn))}),V.def(Et,"[",J,"]")});case Fi:return ut(function(T){return O.command(ur(T)&&T.length===2&&typeof T[0]=="number"&&typeof T[1]=="number"&&T[0]<=T[1],"depth range is 2d array",$.commandStr),T},function(T,V,J){return O.optional(function(){T.assert(V,T.shared.isArrayLike+"("+J+")&&"+J+".length===2&&typeof "+J+'[0]==="number"&&typeof '+J+'[1]==="number"&&'+J+"[0]<="+J+"[1]","depth range must be a 2d array")}),[V.def("+",J,"[0]"),V.def("+",J,"[1]")]});case si:return ut(function(T){O.commandType(T,"object","blend.func",$.commandStr);var V="srcRGB"in T?T.srcRGB:T.src,J="srcAlpha"in T?T.srcAlpha:T.src,Et="dstRGB"in T?T.dstRGB:T.dst,Pt="dstAlpha"in T?T.dstAlpha:T.dst;return O.commandParameter(V,dr,Nt+".srcRGB",$.commandStr),O.commandParameter(J,dr,Nt+".srcAlpha",$.commandStr),O.commandParameter(Et,dr,Nt+".dstRGB",$.commandStr),O.commandParameter(Pt,dr,Nt+".dstAlpha",$.commandStr),O.command(Qr.indexOf(V+", "+Et)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+V+", "+Et+")",$.commandStr),[dr[V],dr[Et],dr[J],dr[Pt]]},function(T,V,J){var Et=T.constants.blendFuncs;function Pt(Ee,xe){var Jt=V.def('"',Ee,xe,'" in ',J,"?",J,".",Ee,xe,":",J,".",Ee);return O.optional(function(){T.assert(V,Jt+" in "+Et,"invalid "+vt+"."+Ee+xe+", must be one of "+Object.keys(dr))}),Jt}O.optional(function(){T.assert(V,J+"&&typeof "+J+'==="object"',"invalid blend func, must be an object")});var Gt=Pt("src","RGB"),Xt=Pt("dst","RGB");O.optional(function(){var Ee=T.constants.invalidBlendCombinations;T.assert(V,Ee+".indexOf("+Gt+'+", "+'+Xt+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var se=V.def(Et,"[",Gt,"]"),pe=V.def(Et,"[",Pt("src","Alpha"),"]");return[se,V.def(Et,"[",Xt,"]"),pe,V.def(Et,"[",Pt("dst","Alpha"),"]")]});case ai:return ut(function(T){return typeof T=="string"?(O.commandParameter(T,r,"invalid "+vt,$.commandStr),[r[T],r[T]]):typeof T=="object"?(O.commandParameter(T.rgb,r,vt+".rgb",$.commandStr),O.commandParameter(T.alpha,r,vt+".alpha",$.commandStr),[r[T.rgb],r[T.alpha]]):void O.commandRaise("invalid blend.equation",$.commandStr)},function(T,V,J){var Et=T.constants.blendEquations,Pt=V.def(),Gt=V.def(),Xt=T.cond("typeof ",J,'==="string"');return O.optional(function(){function se(pe,Ee,xe){T.assert(pe,xe+" in "+Et,"invalid "+Ee+", must be one of "+Object.keys(r))}se(Xt.then,vt,J),T.assert(Xt.else,J+"&&typeof "+J+'==="object"',"invalid "+vt),se(Xt.else,vt+".rgb",J+".rgb"),se(Xt.else,vt+".alpha",J+".alpha")}),Xt.then(Pt,"=",Gt,"=",Et,"[",J,"];"),Xt.else(Pt,"=",Et,"[",J,".rgb];",Gt,"=",Et,"[",J,".alpha];"),V(Xt),[Pt,Gt]});case Gi:return ut(function(T){return O.command(ur(T)&&T.length===4,"blend.color must be a 4d array",$.commandStr),Te(4,function(V){return+T[V]})},function(T,V,J){return O.optional(function(){T.assert(V,T.shared.isArrayLike+"("+J+")&&"+J+".length===4","blend.color must be a 4d array")}),Te(4,function(Et){return V.def("+",J,"[",Et,"]")})});case ci:return ut(function(T){return O.commandType(T,"number",Nt,$.commandStr),0|T},function(T,V,J){return O.optional(function(){T.assert(V,"typeof "+J+'==="number"',"invalid stencil.mask")}),V.def(J,"|0")});case Lo:return ut(function(T){O.commandType(T,"object",Nt,$.commandStr);var V=T.cmp||"keep",J=T.ref||0,Et="mask"in T?T.mask:-1;return O.commandParameter(V,cn,vt+".cmp",$.commandStr),O.commandType(J,"number",vt+".ref",$.commandStr),O.commandType(Et,"number",vt+".mask",$.commandStr),[cn[V],J,Et]},function(T,V,J){var Et=T.constants.compareFuncs;return O.optional(function(){function Pt(){T.assert(V,Array.prototype.join.call(arguments,""),"invalid stencil.func")}Pt(J+"&&typeof ",J,'==="object"'),Pt('!("cmp" in ',J,")||(",J,".cmp in ",Et,")")}),[V.def('"cmp" in ',J,"?",Et,"[",J,".cmp]",":",cr),V.def(J,".ref|0"),V.def('"mask" in ',J,"?",J,".mask|0:-1")]});case di:case zo:return ut(function(T){O.commandType(T,"object",Nt,$.commandStr);var V=T.fail||"keep",J=T.zfail||"keep",Et=T.zpass||"keep";return O.commandParameter(V,qr,vt+".fail",$.commandStr),O.commandParameter(J,qr,vt+".zfail",$.commandStr),O.commandParameter(Et,qr,vt+".zpass",$.commandStr),[vt===zo?pn:Rn,qr[V],qr[J],qr[Et]]},function(T,V,J){var Et=T.constants.stencilOps;function Pt(Gt){return O.optional(function(){T.assert(V,'!("'+Gt+'" in '+J+")||("+J+"."+Gt+" in "+Et+")","invalid "+vt+"."+Gt+", must be one of "+Object.keys(qr))}),V.def('"',Gt,'" in ',J,"?",Et,"[",J,".",Gt,"]:",cr)}return O.optional(function(){T.assert(V,J+"&&typeof "+J+'==="object"',"invalid "+vt)}),[vt===zo?pn:Rn,Pt("fail"),Pt("zfail"),Pt("zpass")]});case qi:return ut(function(T){O.commandType(T,"object",Nt,$.commandStr);var V=0|T.factor,J=0|T.units;return O.commandType(V,"number",Nt+".factor",$.commandStr),O.commandType(J,"number",Nt+".units",$.commandStr),[V,J]},function(T,V,J){return O.optional(function(){T.assert(V,J+"&&typeof "+J+'==="object"',"invalid "+vt)}),[V.def(J,".factor|0"),V.def(J,".units|0")]});case Pa:return ut(function(T){var V=0;return T==="front"?V=Rn:T==="back"&&(V=pn),O.command(!!V,Nt,$.commandStr),V},function(T,V,J){return O.optional(function(){T.assert(V,J+'==="front"||'+J+'==="back"',"invalid cull.face")}),V.def(J,'==="front"?',Rn,":",pn)});case Vi:return ut(function(T){return O.command(typeof T=="number"&&T>=Ot.lineWidthDims[0]&&T<=Ot.lineWidthDims[1],"invalid line width, must be a positive number between "+Ot.lineWidthDims[0]+" and "+Ot.lineWidthDims[1],$.commandStr),T},function(T,V,J){return O.optional(function(){T.assert(V,"typeof "+J+'==="number"&&'+J+">="+Ot.lineWidthDims[0]+"&&"+J+"<="+Ot.lineWidthDims[1],"invalid line width")}),J});case Bi:return ut(function(T){return O.commandParameter(T,mo,Nt,$.commandStr),mo[T]},function(T,V,J){return O.optional(function(){T.assert(V,J+'==="cw"||'+J+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),V.def(J+'==="cw"?'+mi+":"+yi)});case Ui:return ut(function(T){return O.command(ur(T)&&T.length===4,"color.mask must be length 4 array",$.commandStr),T.map(function(V){return!!V})},function(T,V,J){return O.optional(function(){T.assert(V,T.shared.isArrayLike+"("+J+")&&"+J+".length===4","invalid color.mask")}),Te(4,function(Et){return"!!"+J+"["+Et+"]"})});case ui:return ut(function(T){O.command(typeof T=="object"&&T,Nt,$.commandStr);var V="value"in T?T.value:1,J=!!T.invert;return O.command(typeof V=="number"&&V>=0&&V<=1,"sample.coverage.value must be a number between 0 and 1",$.commandStr),[V,J]},function(T,V,J){return O.optional(function(){T.assert(V,J+"&&typeof "+J+'==="object"',"invalid sample.coverage")}),[V.def('"value" in ',J,"?+",J,".value:1"),V.def("!!",J,".invert")]})}}),ct}(A,rt),p=function(z,$,st){var pt=z.static,ct=z.dynamic;function vt(J){if(J in pt){var Et=et.id(pt[J]);O.optional(function(){Wt.shader(ia[J],Et,O.guessCommand())});var Pt=Kt(function(){return Et});return Pt.id=Et,Pt}if(J in ct){var Gt=ct[J];return jr(Gt,function(Xt,se){var pe=Xt.invoke(se,Gt),Ee=se.def(Xt.shared.strings,".id(",pe,")");return O.optional(function(){se(Xt.shared.shader,".shader(",ia[J],",",Ee,",",Xt.command,");")}),Ee})}return null}var Nt,ut=vt(co),T=vt(Xn),V=null;return bn(ut)&&bn(T)?(V=Wt.program(T.id,ut.id,null,st),Nt=Kt(function(J,Et){return J.link(V)})):Nt=new ge(ut&&ut.thisDep||T&&T.thisDep,ut&&ut.contextDep||T&&T.contextDep,ut&&ut.propDep||T&&T.propDep,function(J,Et){var Pt,Gt=J.shared.shader;Pt=ut?ut.append(J,Et):Et.def(Gt,".",co);var Xt=Gt+".program("+(T?T.append(J,Et):Et.def(Gt,".",Xn))+","+Pt;return O.optional(function(){Xt+=","+J.command}),Et.def(Xt+")")}),{frag:ut,vert:T,progVar:Nt,program:V}}(A,0,v);function D(z){var $=m[z];$&&(H[z]=$)}D(gn),D(h(Po));var B=Object.keys(H).length>0,I={framebuffer:f,draw:j,shader:p,state:H,dirty:B,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(I.profile=function(z){var $,st=z.static,pt=z.dynamic;if(Go in st){var ct=!!st[Go];($=Kt(function(Nt,ut){return ct})).enable=ct}else if(Go in pt){var vt=pt[Go];$=jr(vt,function(Nt,ut){return Nt.invoke(ut,vt)})}return $}(A),I.uniforms=function(z,$){var st=z.static,pt=z.dynamic,ct={};return Object.keys(st).forEach(function(vt){var Nt,ut=st[vt];if(typeof ut=="number"||typeof ut=="boolean")Nt=Kt(function(){return ut});else if(typeof ut=="function"){var T=ut._reglType;T==="texture2d"||T==="textureCube"?Nt=Kt(function(V){return V.link(ut)}):T==="framebuffer"||T==="framebufferCube"?(O.command(ut.color.length>0,'missing color attachment for framebuffer sent to uniform "'+vt+'"',$.commandStr),Nt=Kt(function(V){return V.link(ut.color[0])})):O.commandRaise('invalid data for uniform "'+vt+'"',$.commandStr)}else ur(ut)?Nt=Kt(function(V){return V.global.def("[",Te(ut.length,function(J){return O.command(typeof ut[J]=="number"||typeof ut[J]=="boolean","invalid uniform "+vt,V.commandStr),ut[J]}),"]")}):O.commandRaise('invalid or missing data for uniform "'+vt+'"',$.commandStr);Nt.value=ut,ct[vt]=Nt}),Object.keys(pt).forEach(function(vt){var Nt=pt[vt];ct[vt]=jr(Nt,function(ut,T){return ut.invoke(T,Nt)})}),ct}(S,rt),I.drawVAO=I.scopeVAO=function(z,$){var st=z.static,pt=z.dynamic;if(jo in st){var ct=st[jo];return ct!==null&&qt.getVAO(ct)===null&&(ct=qt.createVAO(ct)),Kt(function(Nt){return Nt.link(qt.getVAO(ct))})}if(jo in pt){var vt=pt[jo];return jr(vt,function(Nt,ut){var T=Nt.invoke(ut,vt);return ut.def(Nt.shared.vao+".getVAO("+T+")")})}return null}(A),!I.drawVAO&&p.program&&!v&&mt.angle_instanced_arrays){var q=!0,Q=p.program.attributes.map(function(z){var $=d.static[z];return q=q&&!!$,$});if(q&&Q.length>0){var tt=qt.getVAO(qt.createVAO(Q));I.drawVAO=new ge(null,null,null,function(z,$){return z.link(tt)}),I.useVAO=!0}}return v?I.useVAO=!0:I.attributes=function(z,$){var st=z.static,pt=z.dynamic,ct={};return Object.keys(st).forEach(function(vt){var Nt=st[vt],ut=et.id(vt),T=new o;if($n(Nt))T.state=fn,T.buffer=Ct.getBuffer(Ct.create(Nt,fo,!1,!0)),T.type=0;else{var V=Ct.getBuffer(Nt);if(V)T.state=fn,T.buffer=V,T.type=0;else if(O.command(typeof Nt=="object"&&Nt,"invalid data for attribute "+vt,$.commandStr),"constant"in Nt){var J=Nt.constant;T.buffer="null",T.state=ri,typeof J=="number"?T.x=J:(O.command(ur(J)&&J.length>0&&J.length<=4,"invalid constant for attribute "+vt,$.commandStr),qn.forEach(function(Ee,xe){xe<J.length&&(T[Ee]=J[xe])}))}else{V=$n(Nt.buffer)?Ct.getBuffer(Ct.create(Nt.buffer,fo,!1,!0)):Ct.getBuffer(Nt.buffer),O.command(!!V,'missing buffer for attribute "'+vt+'"',$.commandStr);var Et=0|Nt.offset;O.command(Et>=0,'invalid offset for attribute "'+vt+'"',$.commandStr);var Pt=0|Nt.stride;O.command(Pt>=0&&Pt<256,'invalid stride for attribute "'+vt+'", must be integer betweeen [0, 255]',$.commandStr);var Gt=0|Nt.size;O.command(!("size"in Nt)||Gt>0&&Gt<=4,'invalid size for attribute "'+vt+'", must be 1,2,3,4',$.commandStr);var Xt=!!Nt.normalized,se=0;"type"in Nt&&(O.commandParameter(Nt.type,Pn,"invalid type for attribute "+vt,$.commandStr),se=Pn[Nt.type]);var pe=0|Nt.divisor;"divisor"in Nt&&(O.command(pe===0||t,'cannot specify divisor for attribute "'+vt+'", instancing not supported',$.commandStr),O.command(pe>=0,'invalid divisor for attribute "'+vt+'"',$.commandStr)),O.optional(function(){var Ee=$.commandStr,xe=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Nt).forEach(function(Jt){O.command(xe.indexOf(Jt)>=0,'unknown parameter "'+Jt+'" for attribute pointer "'+vt+'" (valid parameters are '+xe+")",Ee)})}),T.buffer=V,T.state=fn,T.size=Gt,T.normalized=Xt,T.type=se||V.dtype,T.offset=Et,T.stride=Pt,T.divisor=pe}}ct[vt]=Kt(function(Ee,xe){var Jt=Ee.attribCache;if(ut in Jt)return Jt[ut];var Re={isStream:!1};return Object.keys(T).forEach(function(Ke){Re[Ke]=T[Ke]}),T.buffer&&(Re.buffer=Ee.link(T.buffer),Re.type=Re.type||Re.buffer+".dtype"),Jt[ut]=Re,Re})}),Object.keys(pt).forEach(function(vt){var Nt=pt[vt];ct[vt]=jr(Nt,function(ut,T){var V=ut.invoke(T,Nt),J=ut.shared,Et=ut.constants,Pt=J.isBufferArgs,Gt=J.buffer;O.optional(function(){ut.assert(T,V+"&&(typeof "+V+'==="object"||typeof '+V+'==="function")&&('+Pt+"("+V+")||"+Gt+".getBuffer("+V+")||"+Gt+".getBuffer("+V+".buffer)||"+Pt+"("+V+'.buffer)||("constant" in '+V+"&&(typeof "+V+'.constant==="number"||'+J.isArrayLike+"("+V+".constant))))",'invalid dynamic attribute "'+vt+'"')});var Xt={isStream:T.def(!1)},se=new o;se.state=fn,Object.keys(se).forEach(function(Jt){Xt[Jt]=T.def(""+se[Jt])});var pe=Xt.buffer,Ee=Xt.type;function xe(Jt){T(Xt[Jt],"=",V,".",Jt,"|0;")}return T("if(",Pt,"(",V,")){",Xt.isStream,"=true;",pe,"=",Gt,".createStream(",fo,",",V,");",Ee,"=",pe,".dtype;","}else{",pe,"=",Gt,".getBuffer(",V,");","if(",pe,"){",Ee,"=",pe,".dtype;",'}else if("constant" in ',V,"){",Xt.state,"=",ri,";","if(typeof "+V+'.constant === "number"){',Xt[qn[0]],"=",V,".constant;",qn.slice(1).map(function(Jt){return Xt[Jt]}).join("="),"=0;","}else{",qn.map(function(Jt,Re){return Xt[Jt]+"="+V+".constant.length>"+Re+"?"+V+".constant["+Re+"]:0;"}).join(""),"}}else{","if(",Pt,"(",V,".buffer)){",pe,"=",Gt,".createStream(",fo,",",V,".buffer);","}else{",pe,"=",Gt,".getBuffer(",V,".buffer);","}",Ee,'="type" in ',V,"?",Et.glTypes,"[",V,".type]:",pe,".dtype;",Xt.normalized,"=!!",V,".normalized;"),xe("size"),xe("offset"),xe("stride"),xe("divisor"),T("}}"),T.exit("if(",Xt.isStream,"){",Gt,".destroyStream(",pe,");","}"),Xt})}),ct}(d,rt),I.context=function(z){var $=z.static,st=z.dynamic,pt={};return Object.keys($).forEach(function(ct){var vt=$[ct];pt[ct]=Kt(function(Nt,ut){return typeof vt=="number"||typeof vt=="boolean"?""+vt:Nt.link(vt)})}),Object.keys(st).forEach(function(ct){var vt=st[ct];pt[ct]=jr(vt,function(Nt,ut){return Nt.invoke(ut,vt)})}),pt}(G),I}function k(A,d,S){var G=A.shared.context,rt=A.scope();Object.keys(S).forEach(function(it){d.save(G,"."+it);var g=S[it].append(A,d);Array.isArray(g)?rt(G,".",it,"=[",g.join(),"];"):rt(G,".",it,"=",g,";")}),d(rt)}function P(A,d,S,G){var rt,it=A.shared,g=it.gl,v=it.framebuffer;e&&(rt=d.def(it.extensions,".webgl_draw_buffers"));var f,m=A.constants,j=m.drawBuffer,H=m.backBuffer;f=S?S.append(A,d):d.def(v,".next"),G||d("if(",f,"!==",v,".cur){"),d("if(",f,"){",g,".bindFramebuffer(",Ha,",",f,".framebuffer);"),e&&d(rt,".drawBuffersWEBGL(",j,"[",f,".colorAttachments.length]);"),d("}else{",g,".bindFramebuffer(",Ha,",null);"),e&&d(rt,".drawBuffersWEBGL(",H,");"),d("}",v,".cur=",f,";"),G||d("}")}function wt(A,d,S){var G=A.shared,rt=G.gl,it=A.current,g=A.next,v=G.current,f=G.next,m=A.cond(v,".dirty");s.forEach(function(j){var H,p,D=h(j);if(!(D in S.state))if(D in g){H=g[D],p=it[D];var B=Te(n[D].length,function(q){return m.def(H,"[",q,"]")});m(A.cond(B.map(function(q,Q){return q+"!=="+p+"["+Q+"]"}).join("||")).then(rt,".",c[D],"(",B,");",B.map(function(q,Q){return p+"["+Q+"]="+q}).join(";"),";"))}else{H=m.def(f,".",D);var I=A.cond(H,"!==",v,".",D);m(I),D in u?I(A.cond(H).then(rt,".enable(",u[D],");").else(rt,".disable(",u[D],");"),v,".",D,"=",H,";"):I(rt,".",c[D],"(",H,");",v,".",D,"=",H,";")}}),Object.keys(S.state).length===0&&m(v,".dirty=false;"),d(m)}function gt(A,d,S,G){var rt=A.shared,it=A.current,g=rt.current,v=rt.gl;Yn(Object.keys(S)).forEach(function(f){var m=S[f];if(!G||G(m)){var j=m.append(A,d);if(u[f]){var H=u[f];bn(m)?d(v,j?".enable(":".disable(",H,");"):d(A.cond(j).then(v,".enable(",H,");").else(v,".disable(",H,");")),d(g,".",f,"=",j,";")}else if(ur(j)){var p=it[f];d(v,".",c[f],"(",j,");",j.map(function(D,B){return p+"["+B+"]="+D}).join(";"),";")}else d(v,".",c[f],"(",j,");",g,".",f,"=",j,";")}})}function dt(A,d){t&&(A.instancing=d.def(A.shared.extensions,".angle_instanced_arrays"))}function X(A,d,S,G,rt){var it,g,v,f=A.shared,m=A.stats,j=f.current,H=f.timer,p=S.profile;function D(){return typeof performance>"u"?"Date.now()":"performance.now()"}function B(z){z(it=d.def(),"=",D(),";"),typeof rt=="string"?z(m,".count+=",rt,";"):z(m,".count++;"),oe&&(G?z(g=d.def(),"=",H,".getNumPendingQueries();"):z(H,".beginQuery(",m,");"))}function I(z){z(m,".cpuTime+=",D(),"-",it,";"),oe&&(G?z(H,".pushScopeStats(",g,",",H,".getNumPendingQueries(),",m,");"):z(H,".endQuery();"))}function q(z){var $=d.def(j,".profile");d(j,".profile=",z,";"),d.exit(j,".profile=",$,";")}if(p){if(bn(p))return void(p.enable?(B(d),I(d.exit),q("true")):q("false"));q(v=p.append(A,d))}else v=d.def(j,".profile");var Q=A.block();B(Q),d("if(",v,"){",Q,"}");var tt=A.block();I(tt),d.exit("if(",v,"){",tt,"}")}function ot(A,d,S,G,rt){var it=A.shared;G.forEach(function(g){var v,f=g.name,m=S.attributes[f];if(m){if(!rt(m))return;v=m.append(A,d)}else{if(!rt(Kn))return;var j=A.scopeAttrib(f);O.optional(function(){A.assert(d,j+".state","missing attribute "+f)}),v={},Object.keys(new o).forEach(function(H){v[H]=d.def(j,".",H)})}(function(H,p,D){var B=it.gl,I=d.def(H,".location"),q=d.def(it.attributes,"[",I,"]"),Q=D.state,tt=D.buffer,z=[D.x,D.y,D.z,D.w],$=["buffer","normalized","offset","stride"];function st(){d("if(!",q,".buffer){",B,".enableVertexAttribArray(",I,");}");var ct,vt=D.type;if(ct=D.size?d.def(D.size,"||",p):p,d("if(",q,".type!==",vt,"||",q,".size!==",ct,"||",$.map(function(ut){return q+"."+ut+"!=="+D[ut]}).join("||"),"){",B,".bindBuffer(",fo,",",tt,".buffer);",B,".vertexAttribPointer(",[I,ct,vt,D.normalized,D.stride,D.offset],");",q,".type=",vt,";",q,".size=",ct,";",$.map(function(ut){return q+"."+ut+"="+D[ut]+";"}).join(""),"}"),t){var Nt=D.divisor;d("if(",q,".divisor!==",Nt,"){",A.instancing,".vertexAttribDivisorANGLE(",[I,Nt],");",q,".divisor=",Nt,";}")}}function pt(){d("if(",q,".buffer){",B,".disableVertexAttribArray(",I,");",q,".buffer=null;","}if(",qn.map(function(ct,vt){return q+"."+ct+"!=="+z[vt]}).join("||"),"){",B,".vertexAttrib4f(",I,",",z,");",qn.map(function(ct,vt){return q+"."+ct+"="+z[vt]+";"}).join(""),"}")}Q===fn?st():Q===ri?pt():(d("if(",Q,"===",fn,"){"),st(),d("}else{"),pt(),d("}"))})(A.link(g),function(H){switch(H){case hi:case fi:case gi:return 2;case Uo:case Vo:case pi:return 3;case Bo:case go:case vi:return 4;default:return 1}}(g.info.type),v)})}function ht(A,d,S,G,rt){for(var it,g=A.shared,v=g.gl,f=0;f<G.length;++f){var m,j=G[f],H=j.name,p=j.info.type,D=S.uniforms[H],B=A.link(j)+".location";if(D){if(!rt(D))continue;if(bn(D)){var I=D.value;if(O.command(I!=null,'missing uniform "'+H+'"',A.commandStr),p===vo||p===Ho){O.command(typeof I=="function"&&(p===vo&&(I._reglType==="texture2d"||I._reglType==="framebuffer")||p===Ho&&(I._reglType==="textureCube"||I._reglType==="framebufferCube")),"invalid texture for uniform "+H,A.commandStr);var q=A.link(I._texture||I.color[0]._texture);d(v,".uniform1i(",B,",",q+".bind());"),d.exit(q,".unbind();")}else if(p===Wo||p===po||p===qo){O.optional(function(){O.command(ur(I),"invalid matrix for uniform "+H,A.commandStr),O.command(p===Wo&&I.length===4||p===po&&I.length===9||p===qo&&I.length===16,"invalid length for matrix uniform "+H,A.commandStr)});var Q=A.global.def("new Float32Array(["+Array.prototype.slice.call(I)+"])"),tt=2;p===po?tt=3:p===qo&&(tt=4),d(v,".uniformMatrix",tt,"fv(",B,",false,",Q,");")}else{switch(p){case Ji:O.commandType(I,"number","uniform "+H,A.commandStr),it="1f";break;case hi:O.command(ur(I)&&I.length===2,"uniform "+H,A.commandStr),it="2f";break;case Uo:O.command(ur(I)&&I.length===3,"uniform "+H,A.commandStr),it="3f";break;case Bo:O.command(ur(I)&&I.length===4,"uniform "+H,A.commandStr),it="4f";break;case ea:O.commandType(I,"boolean","uniform "+H,A.commandStr),it="1i";break;case ta:O.commandType(I,"number","uniform "+H,A.commandStr),it="1i";break;case gi:case fi:O.command(ur(I)&&I.length===2,"uniform "+H,A.commandStr),it="2i";break;case pi:case Vo:O.command(ur(I)&&I.length===3,"uniform "+H,A.commandStr),it="3i";break;case vi:case go:O.command(ur(I)&&I.length===4,"uniform "+H,A.commandStr),it="4i"}d(v,".uniform",it,"(",B,",",ur(I)?Array.prototype.slice.call(I):I,");")}continue}m=D.append(A,d)}else{if(!rt(Kn))continue;m=d.def(g.uniforms,"[",et.id(H),"]")}p===vo?(O(!Array.isArray(m),"must specify a scalar prop for textures"),d("if(",m,"&&",m,'._reglType==="framebuffer"){',m,"=",m,".color[0];","}")):p===Ho&&(O(!Array.isArray(m),"must specify a scalar prop for cube maps"),d("if(",m,"&&",m,'._reglType==="framebufferCube"){',m,"=",m,".color[0];","}")),O.optional(function(){function ct(T,V){A.assert(d,T,'bad data or missing for uniform "'+H+'".  '+V)}function vt(T){O(!Array.isArray(m),"must not specify an array type for uniform"),ct("typeof "+m+'==="'+T+'"',"invalid type, expected "+T)}function Nt(T,V){Array.isArray(m)?O(m.length===T,"must have length "+T):ct(g.isArrayLike+"("+m+")&&"+m+".length==="+T,"invalid vector, should have length "+T,A.commandStr)}function ut(T){O(!Array.isArray(m),"must not specify a value type"),ct("typeof "+m+'==="function"&&'+m+'._reglType==="texture'+(T===ja?"2d":"Cube")+'"',"invalid texture type",A.commandStr)}switch(p){case ta:vt("number");break;case fi:Nt(2);break;case Vo:Nt(3);break;case go:Nt(4);break;case Ji:vt("number");break;case hi:Nt(2);break;case Uo:Nt(3);break;case Bo:Nt(4);break;case ea:vt("boolean");break;case gi:Nt(2);break;case pi:Nt(3);break;case vi:case Wo:Nt(4);break;case po:Nt(9);break;case qo:Nt(16);break;case vo:ut(ja);break;case Ho:ut(ys)}});var z=1;switch(p){case vo:case Ho:var $=d.def(m,"._texture");d(v,".uniform1i(",B,",",$,".bind());"),d.exit($,".unbind();");continue;case ta:case ea:it="1i";break;case fi:case gi:it="2i",z=2;break;case Vo:case pi:it="3i",z=3;break;case go:case vi:it="4i",z=4;break;case Ji:it="1f";break;case hi:it="2f",z=2;break;case Uo:it="3f",z=3;break;case Bo:it="4f",z=4;break;case Wo:it="Matrix2fv";break;case po:it="Matrix3fv";break;case qo:it="Matrix4fv"}if(d(v,".uniform",it,"(",B,","),it.charAt(0)==="M"){var st=Math.pow(p-Wo+2,2),pt=A.global.def("new Float32Array(",st,")");Array.isArray(m)?d("false,(",Te(st,function(ct){return pt+"["+ct+"]="+m[ct]}),",",pt,")"):d("false,(Array.isArray(",m,")||",m," instanceof Float32Array)?",m,":(",Te(st,function(ct){return pt+"["+ct+"]="+m+"["+ct+"]"}),",",pt,")")}else z>1?d(Te(z,function(ct){return Array.isArray(m)?m[ct]:m+"["+ct+"]"})):(O(!Array.isArray(m),"uniform value must not be an array"),d(m));d(");")}}function nt(A,d,S,G){var rt=A.shared,it=rt.gl,g=rt.draw,v=G.draw,f=function(){var z,$=v.elements,st=d;return $?(($.contextDep&&G.contextDynamic||$.propDep)&&(st=S),z=$.append(A,st)):z=st.def(g,".",kn),z&&st("if("+z+")"+it+".bindBuffer("+ms+","+z+".buffer.buffer);"),z}();function m(z){var $=v[z];return $?$.contextDep&&G.contextDynamic||$.propDep?$.append(A,S):$.append(A,d):d.def(g,".",z)}var j,H,p=m(Dn),D=m(Fo),B=function(){var z,$=v.count,st=d;return $?(($.contextDep&&G.contextDynamic||$.propDep)&&(st=S),z=$.append(A,st),O.optional(function(){$.MISSING&&A.assert(d,"false","missing vertex count"),$.DYNAMIC&&A.assert(st,z+">=0","missing vertex count")})):(z=st.def(g,".",xn),O.optional(function(){A.assert(st,z+">=0","missing vertex count")})),z}();if(typeof B=="number"){if(B===0)return}else S("if(",B,"){"),S.exit("}");t&&(j=m(li),H=A.instancing);var I=f+".type",q=v.elements&&bn(v.elements);function Q(){function z(){S(H,".drawElementsInstancedANGLE(",[p,B,I,D+"<<(("+I+"-"+zi+")>>1)",j],");")}function $(){S(H,".drawArraysInstancedANGLE(",[p,D,B,j],");")}f?q?z():(S("if(",f,"){"),z(),S("}else{"),$(),S("}")):$()}function tt(){function z(){S(it+".drawElements("+[p,B,I,D+"<<(("+I+"-"+zi+")>>1)"]+");")}function $(){S(it+".drawArrays("+[p,D,B]+");")}f?q?z():(S("if(",f,"){"),z(),S("}else{"),$(),S("}")):$()}t&&(typeof j!="number"||j>=0)?typeof j=="string"?(S("if(",j,">0){"),Q(),S("}else if(",j,"<0){"),tt(),S("}")):Q():tt()}function b(A,d,S,G,rt){var it=w(),g=it.proc("body",rt);return O.optional(function(){it.commandStr=d.commandStr,it.command=it.link(d.commandStr)}),t&&(it.instancing=g.def(it.shared.extensions,".angle_instanced_arrays")),A(it,g,S,G),it.compile().body}function C(A,d,S,G){dt(A,d),S.useVAO?S.drawVAO?d(A.shared.vao,".setVAO(",S.drawVAO.append(A,d),");"):d(A.shared.vao,".setVAO(",A.shared.vao,".targetVAO);"):(d(A.shared.vao,".setVAO(null);"),ot(A,d,S,G.attributes,function(){return!0})),ht(A,d,S,G.uniforms,function(){return!0}),nt(A,d,d,S)}function Z(A,d,S,G){function rt(){return!0}A.batchId="a1",dt(A,d),ot(A,d,S,G.attributes,rt),ht(A,d,S,G.uniforms,rt),nt(A,d,d,S)}function W(A,d,S,G){dt(A,d);var rt=S.contextDep,it=d.def(),g=d.def();A.shared.props=g,A.batchId=it;var v=A.scope(),f=A.scope();function m(I){return I.contextDep&&rt||I.propDep}function j(I){return!m(I)}if(d(v.entry,"for(",it,"=0;",it,"<","a1",";++",it,"){",g,"=","a0","[",it,"];",f,"}",v.exit),S.needsContext&&k(A,f,S.context),S.needsFramebuffer&&P(A,f,S.framebuffer),gt(A,f,S.state,m),S.profile&&m(S.profile)&&X(A,f,S,!1,!0),G)S.useVAO?S.drawVAO?m(S.drawVAO)?f(A.shared.vao,".setVAO(",S.drawVAO.append(A,f),");"):v(A.shared.vao,".setVAO(",S.drawVAO.append(A,v),");"):v(A.shared.vao,".setVAO(",A.shared.vao,".targetVAO);"):(v(A.shared.vao,".setVAO(null);"),ot(A,v,S,G.attributes,j),ot(A,f,S,G.attributes,m)),ht(A,v,S,G.uniforms,j),ht(A,f,S,G.uniforms,m),nt(A,v,f,S);else{var H=A.global.def("{}"),p=S.shader.progVar.append(A,f),D=f.def(p,".id"),B=f.def(H,"[",D,"]");f(A.shared.gl,".useProgram(",p,".program);","if(!",B,"){",B,"=",H,"[",D,"]=",A.link(function(I){return b(Z,A,S,I,2)}),"(",p,");}",B,".call(this,a0[",it,"],",it,");")}}function xt(A,d,S){var G=d.static[S];if(G&&function(j){if(typeof j=="object"&&!ur(j)){for(var H=Object.keys(j),p=0;p<H.length;++p)if(Lt.isDynamic(j[H[p]]))return!0;return!1}}(G)){var rt=A.global,it=Object.keys(G),g=!1,v=!1,f=!1,m=A.global.def("{}");it.forEach(function(j){var H=G[j];if(Lt.isDynamic(H)){typeof H=="function"&&(H=G[j]=Lt.unbox(H));var p=jr(H,null);g=g||p.thisDep,f=f||p.propDep,v=v||p.contextDep}else{switch(rt(m,".",j,"="),typeof H){case"number":rt(H);break;case"string":rt('"',H,'"');break;case"object":Array.isArray(H)&&rt("[",H.join(),"]");break;default:rt(A.link(H))}rt(";")}}),d.dynamic[S]=new Lt.DynamicVariable(Co,{thisDep:g,contextDep:v,propDep:f,ref:m,append:function(j,H){it.forEach(function(p){var D=G[p];if(Lt.isDynamic(D)){var B=j.invoke(H,D);H(m,".",p,"=",B,";")}})}}),delete d.static[S]}}return{next:i,current:n,procs:function(){var A=w(),d=A.proc("poll"),S=A.proc("refresh"),G=A.block();d(G),S(G);var rt,it=A.shared,g=it.gl,v=it.next,f=it.current;G(f,".dirty=false;"),P(A,d),P(A,S,null,!0),t&&(rt=A.link(t)),mt.oes_vertex_array_object&&S(A.link(mt.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var m=0;m<Ot.maxAttributes;++m){var j=S.def(it.attributes,"[",m,"]"),H=A.cond(j,".buffer");H.then(g,".enableVertexAttribArray(",m,");",g,".bindBuffer(",fo,",",j,".buffer.buffer);",g,".vertexAttribPointer(",m,",",j,".size,",j,".type,",j,".normalized,",j,".stride,",j,".offset);").else(g,".disableVertexAttribArray(",m,");",g,".vertexAttrib4f(",m,",",j,".x,",j,".y,",j,".z,",j,".w);",j,".buffer=null;"),S(H),t&&S(rt,".vertexAttribDivisorANGLE(",m,",",j,".divisor);")}return S(A.shared.vao,".currentVAO=null;",A.shared.vao,".setVAO(",A.shared.vao,".targetVAO);"),Object.keys(u).forEach(function(p){var D=u[p],B=G.def(v,".",p),I=A.block();I("if(",B,"){",g,".enable(",D,")}else{",g,".disable(",D,")}",f,".",p,"=",B,";"),S(I),d("if(",B,"!==",f,".",p,"){",I,"}")}),Object.keys(c).forEach(function(p){var D,B,I=c[p],q=n[p],Q=A.block();if(Q(g,".",I,"("),ur(q)){var tt=q.length;D=A.global.def(v,".",p),B=A.global.def(f,".",p),Q(Te(tt,function(z){return D+"["+z+"]"}),");",Te(tt,function(z){return B+"["+z+"]="+D+"["+z+"];"}).join("")),d("if(",Te(tt,function(z){return D+"["+z+"]!=="+B+"["+z+"]"}).join("||"),"){",Q,"}")}else D=G.def(v,".",p),B=G.def(f,".",p),Q(D,");",f,".",p,"=",D,";"),d("if(",D,"!==",B,"){",Q,"}");S(Q)}),A.compile()}(),compile:function(A,d,S,G,rt){var it=w();it.stats=it.link(rt),Object.keys(d.static).forEach(function(v){xt(it,d,v)}),vs.forEach(function(v){xt(it,A,v)});var g=L(A,d,S,G,it);return function(v,f){var m=v.proc("draw",1);dt(v,m),k(v,m,f.context),P(v,m,f.framebuffer),wt(v,m,f),gt(v,m,f.state),X(v,m,f,!1,!0);var j=f.shader.progVar.append(v,m);if(m(v.shared.gl,".useProgram(",j,".program);"),f.shader.program)C(v,m,f,f.shader.program);else{m(v.shared.vao,".setVAO(null);");var H=v.global.def("{}"),p=m.def(j,".id"),D=m.def(H,"[",p,"]");m(v.cond(D).then(D,".call(this,a0);").else(D,"=",H,"[",p,"]=",v.link(function(B){return b(C,v,f,B,1)}),"(",j,");",D,".call(this,a0);"))}Object.keys(f.state).length>0&&m(v.shared.current,".dirty=true;")}(it,g),function(v,f){var m=v.proc("scope",3);v.batchId="a2";var j=v.shared,H=j.current;function p(D){var B=f.shader[D];B&&m.set(j.shader,"."+D,B.append(v,m))}k(v,m,f.context),f.framebuffer&&f.framebuffer.append(v,m),Yn(Object.keys(f.state)).forEach(function(D){var B=f.state[D].append(v,m);ur(B)?B.forEach(function(I,q){m.set(v.next[D],"["+q+"]",I)}):m.set(j.next,"."+D,B)}),X(v,m,f,!0,!0),[kn,Fo,xn,li,Dn].forEach(function(D){var B=f.draw[D];B&&m.set(j.draw,"."+D,""+B.append(v,m))}),Object.keys(f.uniforms).forEach(function(D){var B=f.uniforms[D].append(v,m);Array.isArray(B)&&(B="["+B.join()+"]"),m.set(j.uniforms,"["+et.id(D)+"]",B)}),Object.keys(f.attributes).forEach(function(D){var B=f.attributes[D].append(v,m),I=v.scopeAttrib(D);Object.keys(new o).forEach(function(q){m.set(I,"."+q,B[q])})}),f.scopeVAO&&m.set(j.vao,".targetVAO",f.scopeVAO.append(v,m)),p(Xn),p(co),Object.keys(f.state).length>0&&(m(H,".dirty=true;"),m.exit(H,".dirty=true;")),m("a1(",v.shared.context,",a0,",v.batchId,");")}(it,g),function(v,f){var m=v.proc("batch",2);v.batchId="0",dt(v,m);var j=!1,H=!0;Object.keys(f.context).forEach(function($){j=j||f.context[$].propDep}),j||(k(v,m,f.context),H=!1);var p=f.framebuffer,D=!1;function B($){return $.contextDep&&j||$.propDep}p?(p.propDep?j=D=!0:p.contextDep&&j&&(D=!0),D||P(v,m,p)):P(v,m,null),f.state.viewport&&f.state.viewport.propDep&&(j=!0),wt(v,m,f),gt(v,m,f.state,function($){return!B($)}),f.profile&&B(f.profile)||X(v,m,f,!1,"a1"),f.contextDep=j,f.needsContext=H,f.needsFramebuffer=D;var I=f.shader.progVar;if(I.contextDep&&j||I.propDep)W(v,m,f,null);else{var q=I.append(v,m);if(m(v.shared.gl,".useProgram(",q,".program);"),f.shader.program)W(v,m,f,f.shader.program);else{m(v.shared.vao,".setVAO(null);");var Q=v.global.def("{}"),tt=m.def(q,".id"),z=m.def(Q,"[",tt,"]");m(v.cond(z).then(z,".call(this,a0,a1);").else(z,"=",Q,"[",tt,"]=",v.link(function($){return b(W,v,f,$,2)}),"(",q,");",z,".call(this,a0,a1);"))}}Object.keys(f.state).length>0&&m(v.shared.current,".dirty=true;")}(it,g),x(it.compile(),{destroy:function(){g.shader.program.destroy()}})}}}var Ms=function(N,et){if(!et.ext_disjoint_timer_query)return null;var mt=[];function Ot(ne){mt.push(ne)}var Ct=[];function Ut(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var zt=[];function Zt(ne){zt.push(ne)}var $t=[];function qt(ne,oe,he){var o=zt.pop()||new Ut;o.startQueryIndex=ne,o.endQueryIndex=oe,o.sum=0,o.stats=he,$t.push(o)}var Wt=[],Yt=[];return{beginQuery:function(ne){var oe=mt.pop()||et.ext_disjoint_timer_query.createQueryEXT();et.ext_disjoint_timer_query.beginQueryEXT(35007,oe),Ct.push(oe),qt(Ct.length-1,Ct.length,ne)},endQuery:function(){et.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:qt,update:function(){var ne,oe,he=Ct.length;if(he!==0){Yt.length=Math.max(Yt.length,he+1),Wt.length=Math.max(Wt.length,he+1),Wt[0]=0,Yt[0]=0;var o=0;for(ne=0,oe=0;oe<Ct.length;++oe){var r=Ct[oe];et.ext_disjoint_timer_query.getQueryObjectEXT(r,34919)?(o+=et.ext_disjoint_timer_query.getQueryObjectEXT(r,34918),Ot(r)):Ct[ne++]=r,Wt[oe+1]=o,Yt[oe+1]=ne}for(Ct.length=ne,ne=0,oe=0;oe<$t.length;++oe){var t=$t[oe],e=t.startQueryIndex,n=t.endQueryIndex;t.sum+=Wt[n]-Wt[e];var i=Yt[e],s=Yt[n];s===i?(t.stats.gpuTime+=t.sum/1e6,Zt(t)):(t.startQueryIndex=i,t.endQueryIndex=s,$t[ne++]=t)}$t.length=ne}},getNumPendingQueries:function(){return Ct.length},clear:function(){mt.push.apply(mt,Ct);for(var ne=0;ne<mt.length;ne++)et.ext_disjoint_timer_query.deleteQueryEXT(mt[ne]);Ct.length=0,mt.length=0},restore:function(){Ct.length=0,mt.length=0}}},aa="webglcontextlost",Ya="webglcontextrestored";function Ka(N,et){for(var mt=0;mt<N.length;++mt)if(N[mt]===et)return mt;return-1}return function(N){var et=Me(N);if(!et)return null;var mt=et.gl,Ot=mt.getContextAttributes(),Ct=mt.isContextLost(),Ut=function(d,S){var G={};function rt(v){O.type(v,"string","extension name must be string");var f,m=v.toLowerCase();try{f=G[m]=d.getExtension(m)}catch{}return!!f}for(var it=0;it<S.extensions.length;++it){var g=S.extensions[it];if(!rt(g))return S.onDestroy(),S.onDone('"'+g+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return S.optionalExtensions.forEach(rt),{extensions:G,restore:function(){Object.keys(G).forEach(function(v){if(G[v]&&!rt(v))throw new Error("(regl): error restoring extension "+v)})}}}(mt,et);if(!Ut)return null;var zt,Zt,$t=(zt={"":0},Zt=[""],{id:function(d){var S=zt[d];return S||(S=zt[d]=Zt.length,Zt.push(d),S)},str:function(d){return Zt[d]}}),qt={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},Wt=Ut.extensions,Yt=Ms(0,Wt),ne=ue(),oe=mt.drawingBufferWidth,he=mt.drawingBufferHeight,o={tick:0,time:0,viewportWidth:oe,viewportHeight:he,framebufferWidth:oe,framebufferHeight:he,drawingBufferWidth:oe,drawingBufferHeight:he,pixelRatio:et.pixelRatio},r=function(d,S){var G=1;S.ext_texture_filter_anisotropic&&(G=d.getParameter(34047));var rt=1,it=1;S.webgl_draw_buffers&&(rt=d.getParameter(34852),it=d.getParameter(36063));var g=!!S.oes_texture_float;if(g){var v=d.createTexture();d.bindTexture(sr,v),d.texImage2D(sr,0,ln,1,1,0,ln,vr,null);var f=d.createFramebuffer();if(d.bindFramebuffer(en,f),d.framebufferTexture2D(en,36064,sr,v,0),d.bindTexture(sr,null),d.checkFramebufferStatus(en)!==36053)g=!1;else{d.viewport(0,0,1,1),d.clearColor(1,0,0,1),d.clear(16384);var m=Ce.allocType(vr,4);d.readPixels(0,0,1,1,ln,vr,m),d.getError()?g=!1:(d.deleteFramebuffer(f),d.deleteTexture(v),g=m[0]===1),Ce.freeType(m)}}var j=!0;if(typeof navigator>"u"||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var H=d.createTexture(),p=Ce.allocType(5121,36);d.activeTexture(33984),d.bindTexture(34067,H),d.texImage2D(34069,0,ln,3,3,0,ln,5121,p),Ce.freeType(p),d.bindTexture(34067,null),d.deleteTexture(H),j=!d.getError()}return{colorBits:[d.getParameter(3410),d.getParameter(3411),d.getParameter(3412),d.getParameter(3413)],depthBits:d.getParameter(3414),stencilBits:d.getParameter(3415),subpixelBits:d.getParameter(3408),extensions:Object.keys(S).filter(function(D){return!!S[D]}),maxAnisotropic:G,maxDrawbuffers:rt,maxColorAttachments:it,pointSizeDims:d.getParameter(33901),lineWidthDims:d.getParameter(33902),maxViewportDims:d.getParameter(3386),maxCombinedTextureUnits:d.getParameter(35661),maxCubeMapSize:d.getParameter(34076),maxRenderbufferSize:d.getParameter(34024),maxTextureUnits:d.getParameter(34930),maxTextureSize:d.getParameter(3379),maxAttributes:d.getParameter(34921),maxVertexUniforms:d.getParameter(36347),maxVertexTextureUnits:d.getParameter(35660),maxVaryingVectors:d.getParameter(36348),maxFragmentUniforms:d.getParameter(36349),glsl:d.getParameter(35724),renderer:d.getParameter(7937),vendor:d.getParameter(7936),version:d.getParameter(7938),readFloat:g,npotTextureCube:j}}(mt,Wt),t=function(d,S,G,rt){var it=0,g={};function v(p){this.id=it++,this.buffer=d.createBuffer(),this.type=p,this.usage=fa,this.byteLength=0,this.dimension=1,this.dtype=Zo,this.persistentData=null,G.profile&&(this.stats={size:0})}v.prototype.bind=function(){d.bindBuffer(this.type,this.buffer)},v.prototype.destroy=function(){H(this)};var f=[];function m(p,D,B){p.byteLength=D.byteLength,d.bufferData(p.type,D,B)}function j(p,D,B,I,q,Q){var tt,z;if(p.usage=B,Array.isArray(D)){if(p.dtype=I||xi,D.length>0)if(Array.isArray(D[0])){tt=ha(D);for(var $=1,st=1;st<tt.length;++st)$*=tt[st];p.dimension=$,m(p,z=No(D,tt,p.dtype),B),Q?p.persistentData=z:Ce.freeType(z)}else if(typeof D[0]=="number"){p.dimension=q;var pt=Ce.allocType(p.dtype,D.length);Ao(pt,D),m(p,pt,B),Q?p.persistentData=pt:Ce.freeType(pt)}else ft(D[0])?(p.dimension=D[0].length,p.dtype=I||_o(D[0])||xi,m(p,z=No(D,[D.length,D[0].length],p.dtype),B),Q?p.persistentData=z:Ce.freeType(z)):O.raise("invalid buffer data")}else if(ft(D))p.dtype=I||_o(D),p.dimension=q,m(p,D,B),Q&&(p.persistentData=new Uint8Array(new Uint8Array(D.buffer)));else if(fr(D)){tt=D.shape;var ct=D.stride,vt=D.offset,Nt=0,ut=0,T=0,V=0;tt.length===1?(Nt=tt[0],ut=1,T=ct[0],V=0):tt.length===2?(Nt=tt[0],ut=tt[1],T=ct[0],V=ct[1]):O.raise("invalid shape"),p.dtype=I||_o(D.data)||xi,p.dimension=ut;var J=Ce.allocType(p.dtype,Nt*ut);pa(J,D.data,Nt,ut,T,V,vt),m(p,J,B),Q?p.persistentData=J:Ce.freeType(J)}else D instanceof ArrayBuffer?(p.dtype=Zo,p.dimension=q,m(p,D,B),Q&&(p.persistentData=new Uint8Array(new Uint8Array(D)))):O.raise("invalid buffer data")}function H(p){S.bufferCount--,rt(p);var D=p.buffer;O(D,"buffer must not be deleted already"),d.deleteBuffer(D),p.buffer=null,delete g[p.id]}return G.profile&&(S.getTotalBufferSize=function(){var p=0;return Object.keys(g).forEach(function(D){p+=g[D].stats.size}),p}),{create:function(p,D,B,I){S.bufferCount++;var q=new v(D);function Q(z){var $=fa,st=null,pt=0,ct=0,vt=1;return Array.isArray(z)||ft(z)||fr(z)||z instanceof ArrayBuffer?st=z:typeof z=="number"?pt=0|z:z&&(O.type(z,"object","buffer arguments must be an object, a number or an array"),"data"in z&&(O(st===null||Array.isArray(st)||ft(st)||fr(st),"invalid data for buffer"),st=z.data),"usage"in z&&(O.parameter(z.usage,bo,"invalid buffer usage"),$=bo[z.usage]),"type"in z&&(O.parameter(z.type,Pn,"invalid buffer type"),ct=Pn[z.type]),"dimension"in z&&(O.type(z.dimension,"number","invalid dimension"),vt=0|z.dimension),"length"in z&&(O.nni(pt,"buffer length must be a nonnegative integer"),pt=0|z.length)),q.bind(),st?j(q,st,$,ct,vt,I):(pt&&d.bufferData(q.type,pt,$),q.dtype=ct||Zo,q.usage=$,q.dimension=vt,q.byteLength=pt),G.profile&&(q.stats.size=q.byteLength*Sn[q.dtype]),Q}function tt(z,$){O($+z.byteLength<=q.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+z.byteLength+" starting from offset "+$+" to a buffer of size "+q.byteLength),d.bufferSubData(q.type,$,z)}return g[q.id]=q,B||Q(p),Q._reglType="buffer",Q._buffer=q,Q.subdata=function(z,$){var st,pt=0|($||0);if(q.bind(),ft(z)||z instanceof ArrayBuffer)tt(z,pt);else if(Array.isArray(z)){if(z.length>0)if(typeof z[0]=="number"){var ct=Ce.allocType(q.dtype,z.length);Ao(ct,z),tt(ct,pt),Ce.freeType(ct)}else if(Array.isArray(z[0])||ft(z[0])){st=ha(z);var vt=No(z,st,q.dtype);tt(vt,pt),Ce.freeType(vt)}else O.raise("invalid buffer data")}else if(fr(z)){st=z.shape;var Nt=z.stride,ut=0,T=0,V=0,J=0;st.length===1?(ut=st[0],T=1,V=Nt[0],J=0):st.length===2?(ut=st[0],T=st[1],V=Nt[0],J=Nt[1]):O.raise("invalid shape");var Et=Array.isArray(z.data)?q.dtype:_o(z.data),Pt=Ce.allocType(Et,ut*T);pa(Pt,z.data,ut,T,V,J,z.offset),tt(Pt,pt),Ce.freeType(Pt)}else O.raise("invalid data for buffer subdata");return Q},G.profile&&(Q.stats=q.stats),Q.destroy=function(){H(q)},Q},createStream:function(p,D){var B=f.pop();return B||(B=new v(p)),B.bind(),j(B,D,ga,0,1,!1),B},destroyStream:function(p){f.push(p)},clear:function(){Cr(g).forEach(H),f.forEach(H)},getBuffer:function(p){return p&&p._buffer instanceof v?p._buffer:null},restore:function(){Cr(g).forEach(function(p){p.buffer=d.createBuffer(),d.bindBuffer(p.type,p.buffer),d.bufferData(p.type,p.persistentData||p.byteLength,p.usage)})},_initBuffer:j}}(mt,qt,et,function(d){return e.destroyBuffer(d)}),e=function(d,S,G,rt,it){for(var g=G.maxAttributes,v=new Array(g),f=0;f<g;++f)v[f]=new so;var m=0,j={},H={Record:so,scope:{},state:v,currentVAO:null,targetVAO:null,restore:p()?function(){p()&&Cr(j).forEach(function(I){I.refresh()})}:function(){},createVAO:function(I){var q=new B;function Q(tt){O(Array.isArray(tt),"arguments to vertex array constructor must be an array"),O(tt.length<g,"too many attributes"),O(tt.length>0,"must specify at least one attribute");var z={},$=q.attributes;$.length=tt.length;for(var st=0;st<tt.length;++st){var pt,ct=tt[st],vt=$[st]=new so,Nt=ct.data||ct;Array.isArray(Nt)||ft(Nt)||fr(Nt)?(q.buffers[st]&&(pt=q.buffers[st],ft(Nt)&&pt._buffer.byteLength>=Nt.byteLength?pt.subdata(Nt):(pt.destroy(),q.buffers[st]=null)),q.buffers[st]||(pt=q.buffers[st]=it.create(ct,Ro,!1,!0)),vt.buffer=it.getBuffer(pt),vt.size=0|vt.buffer.dimension,vt.normalized=!1,vt.type=vt.buffer.dtype,vt.offset=0,vt.stride=0,vt.divisor=0,vt.state=1,z[st]=1):it.getBuffer(ct)?(vt.buffer=it.getBuffer(ct),vt.size=0|vt.buffer.dimension,vt.normalized=!1,vt.type=vt.buffer.dtype,vt.offset=0,vt.stride=0,vt.divisor=0,vt.state=1):it.getBuffer(ct.buffer)?(vt.buffer=it.getBuffer(ct.buffer),vt.size=0|(+ct.size||vt.buffer.dimension),vt.normalized=!!ct.normalized||!1,"type"in ct?(O.parameter(ct.type,Pn,"invalid buffer type"),vt.type=Pn[ct.type]):vt.type=vt.buffer.dtype,vt.offset=0|(ct.offset||0),vt.stride=0|(ct.stride||0),vt.divisor=0|(ct.divisor||0),vt.state=1,O(vt.size>=1&&vt.size<=4,"size must be between 1 and 4"),O(vt.offset>=0,"invalid offset"),O(vt.stride>=0&&vt.stride<=255,"stride must be between 0 and 255"),O(vt.divisor>=0,"divisor must be positive"),O(!vt.divisor||!!S.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in ct?(O(st>0,"first attribute must not be a constant"),vt.x=+ct.x||0,vt.y=+ct.y||0,vt.z=+ct.z||0,vt.w=+ct.w||0,vt.state=2):O(!1,"invalid attribute spec for location "+st)}for(var ut=0;ut<q.buffers.length;++ut)!z[ut]&&q.buffers[ut]&&(q.buffers[ut].destroy(),q.buffers[ut]=null);return q.refresh(),Q}return rt.vaoCount+=1,Q.destroy=function(){for(var tt=0;tt<q.buffers.length;++tt)q.buffers[tt]&&q.buffers[tt].destroy();q.buffers.length=0,q.destroy()},Q._vao=q,Q._reglType="vao",Q(I)},getVAO:function(I){return typeof I=="function"&&I._vao?I._vao:null},destroyBuffer:function(I){for(var q=0;q<v.length;++q){var Q=v[q];Q.buffer===I&&(d.disableVertexAttribArray(q),Q.buffer=null)}},setVAO:p()?function(I){if(I!==H.currentVAO){var q=p();I?q.bindVertexArrayOES(I.vao):q.bindVertexArrayOES(null),H.currentVAO=I}}:function(I){if(I!==H.currentVAO){if(I)I.bindAttrs();else for(var q=D(),Q=0;Q<v.length;++Q){var tt=v[Q];tt.buffer?(d.enableVertexAttribArray(Q),d.vertexAttribPointer(Q,tt.size,tt.type,tt.normalized,tt.stride,tt.offfset),q&&tt.divisor&&q.vertexAttribDivisorANGLE(Q,tt.divisor)):(d.disableVertexAttribArray(Q),d.vertexAttrib4f(Q,tt.x,tt.y,tt.z,tt.w))}H.currentVAO=I}},clear:p()?function(){Cr(j).forEach(function(I){I.destroy()})}:function(){}};function p(){return S.oes_vertex_array_object}function D(){return S.angle_instanced_arrays}function B(){this.id=++m,this.attributes=[];var I=p();this.vao=I?I.createVertexArrayOES():null,j[this.id]=this,this.buffers=[]}return B.prototype.bindAttrs=function(){for(var I=D(),q=this.attributes,Q=0;Q<q.length;++Q){var tt=q[Q];tt.buffer?(d.enableVertexAttribArray(Q),d.bindBuffer(Ro,tt.buffer.buffer),d.vertexAttribPointer(Q,tt.size,tt.type,tt.normalized,tt.stride,tt.offset),I&&tt.divisor&&I.vertexAttribDivisorANGLE(Q,tt.divisor)):(d.disableVertexAttribArray(Q),d.vertexAttrib4f(Q,tt.x,tt.y,tt.z,tt.w))}for(var z=q.length;z<g;++z)d.disableVertexAttribArray(z)},B.prototype.refresh=function(){var I=p();I&&(I.bindVertexArrayOES(this.vao),this.bindAttrs(),H.currentVAO=this)},B.prototype.destroy=function(){if(this.vao){var I=p();this===H.currentVAO&&(H.currentVAO=null,I.bindVertexArrayOES(null)),I.deleteVertexArrayOES(this.vao),this.vao=null}j[this.id]&&(delete j[this.id],rt.vaoCount-=1)},H}(mt,Wt,r,qt,t),n=function(d,S,G,rt){var it={},g=0,v={uint8:Fn,uint16:Jn};function f(p){this.id=g++,it[this.id]=this,this.buffer=p,this.primType=Gn,this.vertCount=0,this.type=0}S.oes_element_index_uint&&(v.uint32=jn),f.prototype.bind=function(){this.buffer.bind()};var m=[];function j(p,D,B,I,q,Q,tt){var z;if(p.buffer.bind(),D){var $=tt;tt||ft(D)&&(!fr(D)||ft(D.data))||($=S.oes_element_index_uint?jn:Jn),G._initBuffer(p.buffer,D,B,$,3)}else d.bufferData(Ni,Q,B),p.buffer.dtype=z||Fn,p.buffer.usage=B,p.buffer.dimension=3,p.buffer.byteLength=Q;if(z=tt,!tt){switch(p.buffer.dtype){case Fn:case va:z=Fn;break;case Jn:case bi:z=Jn;break;case jn:case ma:z=jn;break;default:O.raise("unsupported type for element array")}p.buffer.dtype=z}p.type=z,O(z!==jn||!!S.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var st=q;st<0&&(st=p.buffer.byteLength,z===Jn?st>>=1:z===jn&&(st>>=2)),p.vertCount=st;var pt=I;if(I<0){pt=Gn;var ct=p.buffer.dimension;ct===1&&(pt=is),ct===2&&(pt=as),ct===3&&(pt=Gn)}p.primType=pt}function H(p){rt.elementsCount--,O(p.buffer!==null,"must not double destroy elements"),delete it[p.id],p.buffer.destroy(),p.buffer=null}return{create:function(p,D){var B=G.create(null,Ni,!0),I=new f(B._buffer);function q(Q){if(Q)if(typeof Q=="number")B(Q),I.primType=Gn,I.vertCount=0|Q,I.type=Fn;else{var tt=null,z=_i,$=-1,st=-1,pt=0,ct=0;Array.isArray(Q)||ft(Q)||fr(Q)?tt=Q:(O.type(Q,"object","invalid arguments for elements"),"data"in Q&&(tt=Q.data,O(Array.isArray(tt)||ft(tt)||fr(tt),"invalid data for element buffer")),"usage"in Q&&(O.parameter(Q.usage,bo,"invalid element buffer usage"),z=bo[Q.usage]),"primitive"in Q&&(O.parameter(Q.primitive,rn,"invalid element buffer primitive"),$=rn[Q.primitive]),"count"in Q&&(O(typeof Q.count=="number"&&Q.count>=0,"invalid vertex count for elements"),st=0|Q.count),"type"in Q&&(O.parameter(Q.type,v,"invalid buffer type"),ct=v[Q.type]),"length"in Q?pt=0|Q.length:(pt=st,ct===Jn||ct===bi?pt*=2:ct!==jn&&ct!==ma||(pt*=4))),j(I,tt,z,$,st,pt,ct)}else B(),I.primType=Gn,I.vertCount=0,I.type=Fn;return q}return rt.elementsCount++,q(p),q._reglType="elements",q._elements=I,q.subdata=function(Q,tt){return B.subdata(Q,tt),q},q.destroy=function(){H(I)},q},createStream:function(p){var D=m.pop();return D||(D=new f(G.create(null,Ni,!0,!1)._buffer)),j(D,p,ss,-1,-1,0,0),D},destroyStream:function(p){m.push(p)},getElements:function(p){return typeof p=="function"&&p._elements instanceof f?p._elements:null},clear:function(){Cr(it).forEach(H)}}}(mt,Wt,t,qt),i=function(d,S,G,rt){var it={},g={};function v(I,q,Q,tt){this.name=I,this.id=q,this.location=Q,this.info=tt}function f(I,q){for(var Q=0;Q<I.length;++Q)if(I[Q].id===q.id)return void(I[Q].location=q.location);I.push(q)}function m(I,q,Q){var tt=I===ka?it:g,z=tt[q];if(!z){var $=S.str(q);z=d.createShader(I),d.shaderSource(z,$),d.compileShader(z),O.shaderError(d,z,$,I,Q),tt[q]=z}return z}var j={},H=[],p=0;function D(I,q){this.id=p++,this.fragId=I,this.vertId=q,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,rt.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function B(I,q,Q){var tt,z,$=m(ka,I.fragId),st=m(Da,I.vertId),pt=I.program=d.createProgram();if(d.attachShader(pt,$),d.attachShader(pt,st),Q)for(tt=0;tt<Q.length;++tt){var ct=Q[tt];d.bindAttribLocation(pt,ct[0],ct[1])}d.linkProgram(pt),O.linkError(d,pt,S.str(I.fragId),S.str(I.vertId),q);var vt=d.getProgramParameter(pt,Oi);rt.profile&&(I.stats.uniformsCount=vt);var Nt=I.uniforms;for(tt=0;tt<vt;++tt)if(z=d.getActiveUniform(pt,tt))if(z.size>1)for(var ut=0;ut<z.size;++ut){var T=z.name.replace("[0]","["+ut+"]");f(Nt,new v(T,S.id(T),d.getUniformLocation(pt,T),z))}else f(Nt,new v(z.name,S.id(z.name),d.getUniformLocation(pt,z.name),z));var V=d.getProgramParameter(pt,Fr);rt.profile&&(I.stats.attributesCount=V);var J=I.attributes;for(tt=0;tt<V;++tt)(z=d.getActiveAttrib(pt,tt))&&f(J,new v(z.name,S.id(z.name),d.getAttribLocation(pt,z.name),z))}return rt.profile&&(G.getMaxUniformsCount=function(){var I=0;return H.forEach(function(q){q.stats.uniformsCount>I&&(I=q.stats.uniformsCount)}),I},G.getMaxAttributesCount=function(){var I=0;return H.forEach(function(q){q.stats.attributesCount>I&&(I=q.stats.attributesCount)}),I}),{clear:function(){var I=d.deleteShader.bind(d);Cr(it).forEach(I),it={},Cr(g).forEach(I),g={},H.forEach(function(q){d.deleteProgram(q.program)}),H.length=0,j={},G.shaderCount=0},program:function(I,q,Q,tt){O.command(I>=0,"missing vertex shader",Q),O.command(q>=0,"missing fragment shader",Q);var z=j[q];z||(z=j[q]={});var $=z[I];if($&&($.refCount++,!tt))return $;var st=new D(q,I);return G.shaderCount++,B(st,Q,tt),$||(z[I]=st),H.push(st),x(st,{destroy:function(){if(st.refCount--,st.refCount<=0){d.deleteProgram(st.program);var pt=H.indexOf(st);H.splice(pt,1),G.shaderCount--}z[st.vertId].refCount<=0&&(d.deleteShader(g[st.vertId]),delete g[st.vertId],delete j[st.fragId][st.vertId]),Object.keys(j[st.fragId]).length||(d.deleteShader(it[st.fragId]),delete it[st.fragId],delete j[st.fragId])}})},restore:function(){it={},g={};for(var I=0;I<H.length;++I)B(H[I],null,H[I].attributes.map(function(q){return[q.location,q.name]}))},shader:m,frag:-1,vert:-1}}(mt,$t,qt,et),s=us(mt,Wt,r,function(){h.procs.poll()},o,qt,et),u=function(d,S,G,rt,it){var g={rgba4:ti,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};S.ext_srgb&&(g.srgba=35907),S.ext_color_buffer_half_float&&(g.rgba16f=34842,g.rgb16f=34843),S.webgl_color_buffer_float&&(g.rgba32f=34836);var v=[];Object.keys(g).forEach(function(p){var D=g[p];v[D]=p});var f=0,m={};function j(p){this.id=f++,this.refCount=1,this.renderbuffer=p,this.format=ti,this.width=0,this.height=0,it.profile&&(this.stats={size:0})}function H(p){var D=p.renderbuffer;O(D,"must not double destroy renderbuffer"),d.bindRenderbuffer(hn,null),d.deleteRenderbuffer(D),p.renderbuffer=null,p.refCount=0,delete m[p.id],rt.renderbufferCount--}return j.prototype.decRef=function(){--this.refCount<=0&&H(this)},it.profile&&(rt.getTotalRenderbufferSize=function(){var p=0;return Object.keys(m).forEach(function(D){p+=m[D].stats.size}),p}),{create:function(p,D){var B=new j(d.createRenderbuffer());function I(q,Q){var tt=0,z=0,$=ti;if(typeof q=="object"&&q){var st=q;if("shape"in st){var pt=st.shape;O(Array.isArray(pt)&&pt.length>=2,"invalid renderbuffer shape"),tt=0|pt[0],z=0|pt[1]}else"radius"in st&&(tt=z=0|st.radius),"width"in st&&(tt=0|st.width),"height"in st&&(z=0|st.height);"format"in st&&(O.parameter(st.format,g,"invalid renderbuffer format"),$=g[st.format])}else typeof q=="number"?(tt=0|q,z=typeof Q=="number"?0|Q:tt):q?O.raise("invalid arguments to renderbuffer constructor"):tt=z=1;if(O(tt>0&&z>0&&tt<=G.maxRenderbufferSize&&z<=G.maxRenderbufferSize,"invalid renderbuffer size"),tt!==B.width||z!==B.height||$!==B.format)return I.width=B.width=tt,I.height=B.height=z,B.format=$,d.bindRenderbuffer(hn,B.renderbuffer),d.renderbufferStorage(hn,$,tt,z),O(d.getError()===0,"invalid render buffer format"),it.profile&&(B.stats.size=ba(B.format,B.width,B.height)),I.format=v[B.format],I}return m[B.id]=B,rt.renderbufferCount++,I(p,D),I.resize=function(q,Q){var tt=0|q,z=0|Q||tt;return tt===B.width&&z===B.height||(O(tt>0&&z>0&&tt<=G.maxRenderbufferSize&&z<=G.maxRenderbufferSize,"invalid renderbuffer size"),I.width=B.width=tt,I.height=B.height=z,d.bindRenderbuffer(hn,B.renderbuffer),d.renderbufferStorage(hn,B.format,tt,z),O(d.getError()===0,"invalid render buffer format"),it.profile&&(B.stats.size=ba(B.format,B.width,B.height))),I},I._reglType="renderbuffer",I._renderbuffer=B,it.profile&&(I.stats=B.stats),I.destroy=function(){B.decRef()},I},clear:function(){Cr(m).forEach(H)},restore:function(){Cr(m).forEach(function(p){p.renderbuffer=d.createRenderbuffer(),d.bindRenderbuffer(hn,p.renderbuffer),d.renderbufferStorage(hn,p.format,p.width,p.height)}),d.bindRenderbuffer(hn,null)}}}(mt,Wt,r,qt,et),c=function(d,S,G,rt,it,g){var v={cur:null,next:null,dirty:!1,setFBO:null},f=["rgba"],m=["rgba4","rgb565","rgb5 a1"];S.ext_srgb&&m.push("srgba"),S.ext_color_buffer_half_float&&m.push("rgba16f","rgb16f"),S.webgl_color_buffer_float&&m.push("rgba32f");var j=["uint8"];function H(ut,T,V){this.target=ut,this.texture=T,this.renderbuffer=V;var J=0,Et=0;T?(J=T.width,Et=T.height):V&&(J=V.width,Et=V.height),this.width=J,this.height=Et}function p(ut){ut&&(ut.texture&&ut.texture._texture.decRef(),ut.renderbuffer&&ut.renderbuffer._renderbuffer.decRef())}function D(ut,T,V){if(ut)if(ut.texture){var J=ut.texture._texture,Et=Math.max(1,J.width),Pt=Math.max(1,J.height);O(Et===T&&Pt===V,"inconsistent width/height for supplied texture"),J.refCount+=1}else{var Gt=ut.renderbuffer._renderbuffer;O(Gt.width===T&&Gt.height===V,"inconsistent width/height for renderbuffer"),Gt.refCount+=1}}function B(ut,T){T&&(T.texture?d.framebufferTexture2D(sn,ut,T.target,T.texture._texture.texture,0):d.framebufferRenderbuffer(sn,ut,ki,T.renderbuffer._renderbuffer.renderbuffer))}function I(ut){var T=Wn,V=null,J=null,Et=ut;typeof ut=="object"&&(Et=ut.data,"target"in ut&&(T=0|ut.target)),O.type(Et,"function","invalid attachment data");var Pt=Et._reglType;return Pt==="texture2d"?(V=Et,O(T===Wn)):Pt==="textureCube"?(V=Et,O(T>=Do&&T<Do+6,"invalid cube map target")):Pt==="renderbuffer"?(J=Et,T=ki):O.raise("invalid regl object for attachment"),new H(T,V,J)}function q(ut,T,V,J,Et){if(V){var Pt=rt.create2D({width:ut,height:T,format:J,type:Et});return Pt._texture.refCount=0,new H(Wn,Pt,null)}var Gt=it.create({width:ut,height:T,format:J});return Gt._renderbuffer.refCount=0,new H(ki,null,Gt)}function Q(ut){return ut&&(ut.texture||ut.renderbuffer)}function tt(ut,T,V){ut&&(ut.texture?ut.texture.resize(T,V):ut.renderbuffer&&ut.renderbuffer.resize(T,V),ut.width=T,ut.height=V)}S.oes_texture_half_float&&j.push("half float","float16"),S.oes_texture_float&&j.push("float","float32");var z=0,$={};function st(){this.id=z++,$[this.id]=this,this.framebuffer=d.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function pt(ut){ut.colorAttachments.forEach(p),p(ut.depthAttachment),p(ut.stencilAttachment),p(ut.depthStencilAttachment)}function ct(ut){var T=ut.framebuffer;O(T,"must not double destroy framebuffer"),d.deleteFramebuffer(T),ut.framebuffer=null,g.framebufferCount--,delete $[ut.id]}function vt(ut){var T;d.bindFramebuffer(sn,ut.framebuffer);var V=ut.colorAttachments;for(T=0;T<V.length;++T)B(Na+T,V[T]);for(T=V.length;T<G.maxColorAttachments;++T)d.framebufferTexture2D(sn,Na+T,Wn,null,0);d.framebufferTexture2D(sn,Sa,Wn,null,0),d.framebufferTexture2D(sn,_a,Wn,null,0),d.framebufferTexture2D(sn,Aa,Wn,null,0),B(_a,ut.depthAttachment),B(Aa,ut.stencilAttachment),B(Sa,ut.depthStencilAttachment);var J=d.checkFramebufferStatus(sn);d.isContextLost()||J===Di||O.raise("framebuffer configuration not supported, status = "+ao[J]),d.bindFramebuffer(sn,v.next?v.next.framebuffer:null),v.cur=v.next,d.getError()}function Nt(ut,T){var V=new st;function J(Et,Pt){var Gt;O(v.next!==V,"can not update framebuffer which is currently in use");var Xt=0,se=0,pe=!0,Ee=!0,xe=null,Jt=!0,Re="rgba",Ke="uint8",dn=1,vn=null,yo=null,Za=null,Qa=!1;if(typeof Et=="number")Xt=0|Et,se=0|Pt||Xt;else if(Et){O.type(Et,"object","invalid arguments for framebuffer");var Ie=Et;if("shape"in Ie){var Ja=Ie.shape;O(Array.isArray(Ja)&&Ja.length>=2,"invalid shape for framebuffer"),Xt=Ja[0],se=Ja[1]}else"radius"in Ie&&(Xt=se=Ie.radius),"width"in Ie&&(Xt=Ie.width),"height"in Ie&&(se=Ie.height);("color"in Ie||"colors"in Ie)&&(xe=Ie.color||Ie.colors,Array.isArray(xe)&&O(xe.length===1||S.webgl_draw_buffers,"multiple render targets not supported")),xe||("colorCount"in Ie&&(dn=0|Ie.colorCount,O(dn>0,"invalid color buffer count")),"colorTexture"in Ie&&(Jt=!!Ie.colorTexture,Re="rgba4"),"colorType"in Ie&&(Ke=Ie.colorType,Jt?(O(S.oes_texture_float||!(Ke==="float"||Ke==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),O(S.oes_texture_half_float||!(Ke==="half float"||Ke==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Ke==="half float"||Ke==="float16"?(O(S.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Re="rgba16f"):Ke!=="float"&&Ke!=="float32"||(O(S.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Re="rgba32f"),O.oneOf(Ke,j,"invalid color type")),"colorFormat"in Ie&&(Re=Ie.colorFormat,f.indexOf(Re)>=0?Jt=!0:m.indexOf(Re)>=0?Jt=!1:Jt?O.oneOf(Ie.colorFormat,f,"invalid color format for texture"):O.oneOf(Ie.colorFormat,m,"invalid color format for renderbuffer"))),("depthTexture"in Ie||"depthStencilTexture"in Ie)&&(Qa=!(!Ie.depthTexture&&!Ie.depthStencilTexture),O(!Qa||S.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Ie&&(typeof Ie.depth=="boolean"?pe=Ie.depth:(vn=Ie.depth,Ee=!1)),"stencil"in Ie&&(typeof Ie.stencil=="boolean"?Ee=Ie.stencil:(yo=Ie.stencil,pe=!1)),"depthStencil"in Ie&&(typeof Ie.depthStencil=="boolean"?pe=Ee=Ie.depthStencil:(Za=Ie.depthStencil,pe=!1,Ee=!1))}else Xt=se=1;var pr=null,On=null,wo=null,Cn=null;if(Array.isArray(xe))pr=xe.map(I);else if(xe)pr=[I(xe)];else for(pr=new Array(dn),Gt=0;Gt<dn;++Gt)pr[Gt]=q(Xt,se,Jt,Re,Ke);O(S.webgl_draw_buffers||pr.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),O(pr.length<=G.maxColorAttachments,"too many color attachments, not supported"),Xt=Xt||pr[0].width,se=se||pr[0].height,vn?On=I(vn):pe&&!Ee&&(On=q(Xt,se,Qa,"depth","uint32")),yo?wo=I(yo):Ee&&!pe&&(wo=q(Xt,se,!1,"stencil","uint8")),Za?Cn=I(Za):!vn&&!yo&&Ee&&pe&&(Cn=q(Xt,se,Qa,"depth stencil","depth stencil")),O(!!vn+!!yo+!!Za<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Ts=null;for(Gt=0;Gt<pr.length;++Gt)if(D(pr[Gt],Xt,se),O(!pr[Gt]||pr[Gt].texture&&cs.indexOf(pr[Gt].texture._texture.format)>=0||pr[Gt].renderbuffer&&Ta.indexOf(pr[Gt].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Gt+" is invalid"),pr[Gt]&&pr[Gt].texture){var Ps=ei[pr[Gt].texture._texture.format]*io[pr[Gt].texture._texture.type];Ts===null?Ts=Ps:O(Ts===Ps,"all color attachments much have the same number of bits per pixel.")}return D(On,Xt,se),O(!On||On.texture&&On.texture._texture.format===Ma||On.renderbuffer&&On.renderbuffer._renderbuffer.format===ds,"invalid depth attachment for framebuffer object"),D(wo,Xt,se),O(!wo||wo.renderbuffer&&wo.renderbuffer._renderbuffer.format===ls,"invalid stencil attachment for framebuffer object"),D(Cn,Xt,se),O(!Cn||Cn.texture&&Cn.texture._texture.format===Ri||Cn.renderbuffer&&Cn.renderbuffer._renderbuffer.format===Ri,"invalid depth-stencil attachment for framebuffer object"),pt(V),V.width=Xt,V.height=se,V.colorAttachments=pr,V.depthAttachment=On,V.stencilAttachment=wo,V.depthStencilAttachment=Cn,J.color=pr.map(Q),J.depth=Q(On),J.stencil=Q(wo),J.depthStencil=Q(Cn),J.width=V.width,J.height=V.height,vt(V),J}return g.framebufferCount++,J(ut,T),x(J,{resize:function(Et,Pt){O(v.next!==V,"can not resize a framebuffer which is currently in use");var Gt=Math.max(0|Et,1),Xt=Math.max(0|Pt||Gt,1);if(Gt===V.width&&Xt===V.height)return J;for(var se=V.colorAttachments,pe=0;pe<se.length;++pe)tt(se[pe],Gt,Xt);return tt(V.depthAttachment,Gt,Xt),tt(V.stencilAttachment,Gt,Xt),tt(V.depthStencilAttachment,Gt,Xt),V.width=J.width=Gt,V.height=J.height=Xt,vt(V),J},_reglType:"framebuffer",_framebuffer:V,destroy:function(){ct(V),pt(V)},use:function(Et){v.setFBO({framebuffer:J},Et)}})}return x(v,{getFramebuffer:function(ut){if(typeof ut=="function"&&ut._reglType==="framebuffer"){var T=ut._framebuffer;if(T instanceof st)return T}return null},create:Nt,createCube:function(ut){var T=Array(6);function V(J){var Et;O(T.indexOf(v.next)<0,"can not update framebuffer which is currently in use");var Pt,Gt={color:null},Xt=0,se=null,pe="rgba",Ee="uint8",xe=1;if(typeof J=="number")Xt=0|J;else if(J){O.type(J,"object","invalid arguments for framebuffer");var Jt=J;if("shape"in Jt){var Re=Jt.shape;O(Array.isArray(Re)&&Re.length>=2,"invalid shape for framebuffer"),O(Re[0]===Re[1],"cube framebuffer must be square"),Xt=Re[0]}else"radius"in Jt&&(Xt=0|Jt.radius),"width"in Jt?(Xt=0|Jt.width,"height"in Jt&&O(Jt.height===Xt,"must be square")):"height"in Jt&&(Xt=0|Jt.height);("color"in Jt||"colors"in Jt)&&(se=Jt.color||Jt.colors,Array.isArray(se)&&O(se.length===1||S.webgl_draw_buffers,"multiple render targets not supported")),se||("colorCount"in Jt&&(xe=0|Jt.colorCount,O(xe>0,"invalid color buffer count")),"colorType"in Jt&&(O.oneOf(Jt.colorType,j,"invalid color type"),Ee=Jt.colorType),"colorFormat"in Jt&&(pe=Jt.colorFormat,O.oneOf(Jt.colorFormat,f,"invalid color format for texture"))),"depth"in Jt&&(Gt.depth=Jt.depth),"stencil"in Jt&&(Gt.stencil=Jt.stencil),"depthStencil"in Jt&&(Gt.depthStencil=Jt.depthStencil)}else Xt=1;if(se)if(Array.isArray(se))for(Pt=[],Et=0;Et<se.length;++Et)Pt[Et]=se[Et];else Pt=[se];else{Pt=Array(xe);var Ke={radius:Xt,format:pe,type:Ee};for(Et=0;Et<xe;++Et)Pt[Et]=rt.createCube(Ke)}for(Gt.color=Array(Pt.length),Et=0;Et<Pt.length;++Et){var dn=Pt[Et];O(typeof dn=="function"&&dn._reglType==="textureCube","invalid cube map"),Xt=Xt||dn.width,O(dn.width===Xt&&dn.height===Xt,"invalid cube map shape"),Gt.color[Et]={target:Do,data:Pt[Et]}}for(Et=0;Et<6;++Et){for(var vn=0;vn<Pt.length;++vn)Gt.color[vn].target=Do+Et;Et>0&&(Gt.depth=T[0].depth,Gt.stencil=T[0].stencil,Gt.depthStencil=T[0].depthStencil),T[Et]?T[Et](Gt):T[Et]=Nt(Gt)}return x(V,{width:Xt,height:Xt,color:Pt})}return V(ut),x(V,{faces:T,resize:function(J){var Et,Pt=0|J;if(O(Pt>0&&Pt<=G.maxCubeMapSize,"invalid radius for cube fbo"),Pt===V.width)return V;var Gt=V.color;for(Et=0;Et<Gt.length;++Et)Gt[Et].resize(Pt);for(Et=0;Et<6;++Et)T[Et].resize(Pt);return V.width=V.height=Pt,V},_reglType:"framebufferCube",destroy:function(){T.forEach(function(J){J.destroy()})}})},clear:function(){Cr($).forEach(ct)},restore:function(){v.cur=null,v.next=null,v.dirty=!0,Cr($).forEach(function(ut){ut.framebuffer=d.createFramebuffer(),vt(ut)})}})}(mt,Wt,r,s,u,qt),h=$a(mt,$t,Wt,r,t,n,0,c,{},e,i,{elements:null,primitive:4,count:-1,offset:0,instances:-1},o,Yt,et),l=Li(mt,c,h.procs.poll,o,Ot,Wt,r),E=h.next,R=mt.canvas,_=[],M=[],w=[],L=[et.onDestroy],k=null;function P(){if(_.length===0)return Yt&&Yt.update(),void(k=null);k=Ht.next(P),Z();for(var d=_.length-1;d>=0;--d){var S=_[d];S&&S(o,null,0)}mt.flush(),Yt&&Yt.update()}function wt(){!k&&_.length>0&&(k=Ht.next(P))}function gt(){k&&(Ht.cancel(P),k=null)}function dt(d){d.preventDefault(),Ct=!0,gt(),M.forEach(function(S){S()})}function X(d){mt.getError(),Ct=!1,Ut.restore(),i.restore(),t.restore(),s.restore(),u.restore(),c.restore(),e.restore(),Yt&&Yt.restore(),h.procs.refresh(),wt(),w.forEach(function(S){S()})}function ot(d){function S(D,B){var I={},q={};return Object.keys(D).forEach(function(Q){var tt=D[Q];if(Lt.isDynamic(tt))q[Q]=Lt.unbox(tt,Q);else{if(B&&Array.isArray(tt)){for(var z=0;z<tt.length;++z)if(Lt.isDynamic(tt[z]))return void(q[Q]=Lt.unbox(tt,Q))}I[Q]=tt}}),{dynamic:q,static:I}}O(!!d,"invalid args to regl({...})"),O.type(d,"object","invalid args to regl({...})");var G=S(d.context||{},!0),rt=S(d.uniforms||{},!0),it=S(d.attributes||{},!1),g=S(function(D){var B=x({},D);function I(q){if(q in B){var Q=B[q];delete B[q],Object.keys(Q).forEach(function(tt){B[q+"."+tt]=Q[tt]})}}return delete B.uniforms,delete B.attributes,delete B.context,delete B.vao,"stencil"in B&&B.stencil.op&&(B.stencil.opBack=B.stencil.opFront=B.stencil.op,delete B.stencil.op),I("blend"),I("depth"),I("cull"),I("stencil"),I("polygonOffset"),I("scissor"),I("sample"),"vao"in D&&(B.vao=D.vao),B}(d),!1),v={gpuTime:0,cpuTime:0,count:0},f=h.compile(g,it,rt,G,v),m=f.draw,j=f.batch,H=f.scope,p=[];return x(function(D,B){var I;if(Ct&&O.raise("context lost"),typeof D=="function")return H.call(this,null,D,0);if(typeof B=="function")if(typeof D=="number")for(I=0;I<D;++I)H.call(this,null,B,I);else{if(!Array.isArray(D))return H.call(this,D,B,0);for(I=0;I<D.length;++I)H.call(this,D[I],B,I)}else if(typeof D=="number"){if(D>0)return j.call(this,function(q){for(;p.length<q;)p.push(null);return p}(0|D),0|D)}else{if(!Array.isArray(D))return m.call(this,D);if(D.length)return j.call(this,D,D.length)}},{stats:v,destroy:function(){f.destroy()}})}R&&(R.addEventListener(aa,dt,!1),R.addEventListener(Ya,X,!1));var ht=c.setFBO=ot({framebuffer:Lt.define.call(null,1,"framebuffer")});function nt(d,S){var G=0;h.procs.poll();var rt=S.color;rt&&(mt.clearColor(+rt[0]||0,+rt[1]||0,+rt[2]||0,+rt[3]||0),G|=16384),"depth"in S&&(mt.clearDepth(+S.depth),G|=256),"stencil"in S&&(mt.clearStencil(0|S.stencil),G|=1024),O(!!G,"called regl.clear with no buffer specified"),mt.clear(G)}function b(d){return O.type(d,"function","regl.frame() callback must be a function"),_.push(d),wt(),{cancel:function(){var S=Ka(_,d);O(S>=0,"cannot cancel a frame twice"),_[S]=function G(){var rt=Ka(_,G);_[rt]=_[_.length-1],_.length-=1,_.length<=0&&gt()}}}}function C(){var d=E.viewport,S=E.scissor_box;d[0]=d[1]=S[0]=S[1]=0,o.viewportWidth=o.framebufferWidth=o.drawingBufferWidth=d[2]=S[2]=mt.drawingBufferWidth,o.viewportHeight=o.framebufferHeight=o.drawingBufferHeight=d[3]=S[3]=mt.drawingBufferHeight}function Z(){o.tick+=1,o.time=xt(),C(),h.procs.poll()}function W(){s.refresh(),C(),h.procs.refresh(),Yt&&Yt.update()}function xt(){return(ue()-ne)/1e3}W();var A=x(ot,{clear:function(d){if(O(typeof d=="object"&&d,"regl.clear() takes an object as input"),"framebuffer"in d)if(d.framebuffer&&d.framebuffer_reglType==="framebufferCube")for(var S=0;S<6;++S)ht(x({framebuffer:d.framebuffer.faces[S]},d),nt);else ht(d,nt);else nt(0,d)},prop:Lt.define.bind(null,1),context:Lt.define.bind(null,2),this:Lt.define.bind(null,3),draw:ot({}),buffer:function(d){return t.create(d,34962,!1,!1)},elements:function(d){return n.create(d,!1)},texture:s.create2D,cube:s.createCube,renderbuffer:u.create,framebuffer:c.create,framebufferCube:c.createCube,vao:e.createVAO,attributes:Ot,frame:b,on:function(d,S){var G;switch(O.type(S,"function","listener callback must be a function"),d){case"frame":return b(S);case"lost":G=M;break;case"restore":G=w;break;case"destroy":G=L;break;default:O.raise("invalid event, must be one of frame,lost,restore,destroy")}return G.push(S),{cancel:function(){for(var rt=0;rt<G.length;++rt)if(G[rt]===S)return G[rt]=G[G.length-1],void G.pop()}}},limits:r,hasExtension:function(d){return r.extensions.indexOf(d.toLowerCase())>=0},read:l,destroy:function(){_.length=0,gt(),R&&(R.removeEventListener(aa,dt),R.removeEventListener(Ya,X)),i.clear(),c.clear(),u.clear(),s.clear(),n.clear(),t.clear(),e.clear(),Yt&&Yt.clear(),L.forEach(function(d){d()})},_gl:mt,_refresh:W,poll:function(){Z(),Yt&&Yt.update()},now:xt,stats:qt});return et.onDone(null,A),A}}()}},qs={};function hr(U){var ft=qs[U];if(ft!==void 0)return ft.exports;var x=qs[U]={id:U,loaded:!1,exports:{}};return Gu[U].call(x.exports,x,x.exports,hr),x.loaded=!0,x.exports}hr.n=U=>{var ft=U&&U.__esModule?()=>U.default:()=>U;return hr.d(ft,{a:ft}),ft},hr.d=(U,ft)=>{for(var x in ft)hr.o(ft,x)&&!hr.o(U,x)&&Object.defineProperty(U,x,{enumerable:!0,get:ft[x]})},hr.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),hr.o=(U,ft)=>Object.prototype.hasOwnProperty.call(U,ft),hr.nmd=U=>(U.paths=[],U.children||(U.children=[]),U);var Ls={};(()=>{hr.d(Ls,{O:()=>Si,I:()=>So});var U=function(){return U=Object.assign||function(a){for(var lt,y=1,at=arguments.length;y<at;y++)for(var Y in lt=arguments[y])Object.prototype.hasOwnProperty.call(lt,Y)&&(a[Y]=lt[Y]);return a},U.apply(this,arguments)};function ft(a,lt,y,at){return new(y||(y=Promise))(function(Y,yt){function _t(kt){try{It(at.next(kt))}catch(Tt){yt(Tt)}}function St(kt){try{It(at.throw(kt))}catch(Tt){yt(Tt)}}function It(kt){var Tt;kt.done?Y(kt.value):(Tt=kt.value,Tt instanceof y?Tt:new y(function(ae){ae(Tt)})).then(_t,St)}It((at=at.apply(a,lt||[])).next())})}function x(a,lt){var y,at,Y,yt,_t={label:0,sent:function(){if(1&Y[0])throw Y[1];return Y[1]},trys:[],ops:[]};return yt={next:St(0),throw:St(1),return:St(2)},typeof Symbol=="function"&&(yt[Symbol.iterator]=function(){return this}),yt;function St(It){return function(kt){return function(Tt){if(y)throw new TypeError("Generator is already executing.");for(;yt&&(yt=0,Tt[0]&&(_t=0)),_t;)try{if(y=1,at&&(Y=2&Tt[0]?at.return:Tt[0]?at.throw||((Y=at.return)&&Y.call(at),0):at.next)&&!(Y=Y.call(at,Tt[1])).done)return Y;switch(at=0,Y&&(Tt=[2&Tt[0],Y.value]),Tt[0]){case 0:case 1:Y=Tt;break;case 4:return _t.label++,{value:Tt[1],done:!1};case 5:_t.label++,at=Tt[1],Tt=[0];continue;case 7:Tt=_t.ops.pop(),_t.trys.pop();continue;default:if(!((Y=(Y=_t.trys).length>0&&Y[Y.length-1])||Tt[0]!==6&&Tt[0]!==2)){_t=0;continue}if(Tt[0]===3&&(!Y||Tt[1]>Y[0]&&Tt[1]<Y[3])){_t.label=Tt[1];break}if(Tt[0]===6&&_t.label<Y[1]){_t.label=Y[1],Y=Tt;break}if(Y&&_t.label<Y[2]){_t.label=Y[2],_t.ops.push(Tt);break}Y[2]&&_t.ops.pop(),_t.trys.pop();continue}Tt=lt.call(a,_t)}catch(ae){Tt=[6,ae],at=0}finally{y=Y=0}if(5&Tt[0])throw Tt[1];return{value:Tt[0]?Tt[1]:void 0,done:!0}}([It,kt])}}}var Mt={913:a=>{var lt=Object.prototype.hasOwnProperty,y="~";function at(){}function Y(It,kt,Tt){this.fn=It,this.context=kt,this.once=Tt||!1}function yt(It,kt,Tt,ae,te){if(typeof Tt!="function")throw new TypeError("The listener must be a function");var _e=new Y(Tt,ae||It,te),ce=y?y+kt:kt;return It._events[ce]?It._events[ce].fn?It._events[ce]=[It._events[ce],_e]:It._events[ce].push(_e):(It._events[ce]=_e,It._eventsCount++),It}function _t(It,kt){--It._eventsCount==0?It._events=new at:delete It._events[kt]}function St(){this._events=new at,this._eventsCount=0}Object.create&&(at.prototype=Object.create(null),new at().__proto__||(y=!1)),St.prototype.eventNames=function(){var It,kt,Tt=[];if(this._eventsCount===0)return Tt;for(kt in It=this._events)lt.call(It,kt)&&Tt.push(y?kt.slice(1):kt);return Object.getOwnPropertySymbols?Tt.concat(Object.getOwnPropertySymbols(It)):Tt},St.prototype.listeners=function(It){var kt=y?y+It:It,Tt=this._events[kt];if(!Tt)return[];if(Tt.fn)return[Tt.fn];for(var ae=0,te=Tt.length,_e=new Array(te);ae<te;ae++)_e[ae]=Tt[ae].fn;return _e},St.prototype.listenerCount=function(It){var kt=y?y+It:It,Tt=this._events[kt];return Tt?Tt.fn?1:Tt.length:0},St.prototype.emit=function(It,kt,Tt,ae,te,_e){var ce=y?y+It:It;if(!this._events[ce])return!1;var Se,jt,me=this._events[ce],He=arguments.length;if(me.fn){switch(me.once&&this.removeListener(It,me.fn,void 0,!0),He){case 1:return me.fn.call(me.context),!0;case 2:return me.fn.call(me.context,kt),!0;case 3:return me.fn.call(me.context,kt,Tt),!0;case 4:return me.fn.call(me.context,kt,Tt,ae),!0;case 5:return me.fn.call(me.context,kt,Tt,ae,te),!0;case 6:return me.fn.call(me.context,kt,Tt,ae,te,_e),!0}for(jt=1,Se=new Array(He-1);jt<He;jt++)Se[jt-1]=arguments[jt];me.fn.apply(me.context,Se)}else{var rr,xr=me.length;for(jt=0;jt<xr;jt++)switch(me[jt].once&&this.removeListener(It,me[jt].fn,void 0,!0),He){case 1:me[jt].fn.call(me[jt].context);break;case 2:me[jt].fn.call(me[jt].context,kt);break;case 3:me[jt].fn.call(me[jt].context,kt,Tt);break;case 4:me[jt].fn.call(me[jt].context,kt,Tt,ae);break;default:if(!Se)for(rr=1,Se=new Array(He-1);rr<He;rr++)Se[rr-1]=arguments[rr];me[jt].fn.apply(me[jt].context,Se)}}return!0},St.prototype.on=function(It,kt,Tt){return yt(this,It,kt,Tt,!1)},St.prototype.once=function(It,kt,Tt){return yt(this,It,kt,Tt,!0)},St.prototype.removeListener=function(It,kt,Tt,ae){var te=y?y+It:It;if(!this._events[te])return this;if(!kt)return _t(this,te),this;var _e=this._events[te];if(_e.fn)_e.fn!==kt||ae&&!_e.once||Tt&&_e.context!==Tt||_t(this,te);else{for(var ce=0,Se=[],jt=_e.length;ce<jt;ce++)(_e[ce].fn!==kt||ae&&!_e[ce].once||Tt&&_e[ce].context!==Tt)&&Se.push(_e[ce]);Se.length?this._events[te]=Se.length===1?Se[0]:Se:_t(this,te)}return this},St.prototype.removeAllListeners=function(It){var kt;return It?(kt=y?y+It:It,this._events[kt]&&_t(this,kt)):(this._events=new at,this._eventsCount=0),this},St.prototype.off=St.prototype.removeListener,St.prototype.addListener=St.prototype.on,St.prefixed=y,St.EventEmitter=St,a.exports=St},617:(a,lt,y)=>{var at=y(331),Y=["stopLayout","calculateLayout"];a.exports=function(){var yt=new Worker(URL.createObjectURL(new Blob(['var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{calculateLayout:()=>_n,stopLayout:()=>In});var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function o(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function i(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function a(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function u(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}Object.create,Object.create;const d=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[],i=this._events["*"]||[],a=function(n){for(var o=n.length,i=0;i<o;i++)if(n[i]){var a=n[i],s=a.callback;a.once&&(n.splice(i,1),0===n.length&&delete e._events[t],o--,i--),s.apply(e,r)}};a(o),a(i)},t.prototype.off=function(t,e){if(t)if(e){for(var r=this._events[t]||[],n=r.length,o=0;o<n;o++)r[o].callback===e&&(r.splice(o,1),n--,o--);0===r.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function h(t,e,r,n){for(;t.length;){const o=t.shift();if(r(o))return!0;e.add(o.id),n(o.id).forEach((r=>{e.has(r.id)||(e.add(r.id),t.push(r))}))}return!1}function c(t,e,r,n){if(r(t))return!0;e.add(t.id);for(const o of n(t.id))if(!e.has(o.id)&&c(o,e,r,n))return!0;return!1}class l extends d{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const r=e.find((e=>e.type===t.type&&e.id===t.id&&e.propertyName===t.propertyName));r?r.newValue=t.newValue:e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const r=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),r=this.bothEdgesMap.get(t);r?.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((e=>{e.childrenMap.get(t)?.forEach((t=>{e.parentMap.delete(t.id)})),e.parentMap.delete(t),e.childrenMap.delete(t)})),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){const n=this.getNode(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateNodeDataProperty(t,e,r)}))}))}updateNodeData(...t){const e=t[0],r=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:o})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),o.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),o=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),o.delete(e),i.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.source,o=e;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:o})}))}updateEdgeTarget(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.target,o=e;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:o})}))}updateEdgeDataProperty(t,e,r){const n=this.getEdge(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}updateEdgeData(...t){const e=t[0],r=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:o})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateEdgeDataProperty(t,e,r)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const r=[],n=Array.isArray(t)?t:[t];for(;n.length;){const t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach((t=>{t.children?.forEach((r=>{this.setParent(r.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const r=this.treeIndices.get(e).childrenMap.get(t);return Array.from(r||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const r=[];let n,o=this.getNode(t);for(;n=this.getParent(o.id,e);)r.push(n),o=n;return r}setParent(t,e,r){this.checkTreeExistence(r);const n=this.treeIndices.get(r),o=this.getNode(t),i=n.parentMap.get(t),a=this.getNode(e);n.parentMap.set(t,a),i&&n.childrenMap.get(i.id)?.delete(o);let s=n.childrenMap.get(a.id);s||(s=new Set,n.childrenMap.set(a.id,s)),s.add(o),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:i?.id,newParentId:a.id})}))}dfsTree(t,e,r){return c(this.getNode(t),new Set,e,(t=>this.getChildren(t,r)))}bfsTree(t,e,r){return h([this.getNode(t)],new Set,e,(t=>this.getChildren(t,r)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return h([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return c(this.getNode(t),new Set,e,n)}clone(){const t=this.getAllNodes().map((t=>({...t,data:{...t.data}}))),e=this.getAllEdges().map((t=>({...t,data:{...t.data}}))),r=new l({nodes:t,edges:e});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},n)=>{const o=new Map;t.forEach(((t,e)=>{o.set(e,r.getNode(t.id))}));const i=new Map;e.forEach(((t,e)=>{i.set(e,new Set(Array.from(t).map((t=>r.getNode(t.id)))))})),r.treeIndices.set(n,{parentMap:o,childrenMap:i})})),r}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var f=/-(\\w)/g,g=(function(t){return t.replace(f,(function(t,e){return e?e.toUpperCase():""}))},Object.create(null),Array.isArray),p=function(t){for(var e=[],r=t.length,n=0;n<r;n+=1){e[n]=[];for(var o=0;o<r;o+=1)n===o?e[n][o]=0:0!==t[n][o]&&t[n][o]?e[n][o]=t[n][o]:e[n][o]=1/0}for(var i=0;i<r;i+=1)for(n=0;n<r;n+=1)for(o=0;o<r;o+=1)e[n][o]>e[n][i]+e[i][o]&&(e[n][o]=e[n][i]+e[i][o]);return e},v=function(t,e){var r=t.nodes,n=t.edges,o=[],i={};if(!r)throw new Error("invalid nodes data!");return r&&r.forEach((function(t,e){i[t.id]=e,o.push([])})),null==n||n.forEach((function(t){var r=t.source,n=t.target,a=i[r],s=i[n];void 0!==a&&void 0!==s&&(o[a][s]=1,e||(o[s][a]=1))})),o},y=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},m={}.toString;const w=function(t,e){return m.call(t)==="[object "+e+"]"},x=function(t){return w(t,"Number")};var E=function(t){if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var e=[];return t.forEach((function(t){e.push(t)})),e.map((function(t){return E(t)}))}if("object"==typeof t){var r={};return Object.keys(t).forEach((function(e){r[e]=E(t[e])})),r}return t},b=function(t,e){var r=E(t);return r.data=r.data||{},e&&(x(r.data.x)||(r.data.x=Math.random()*e[0]),x(r.data.y)||(r.data.y=Math.random()*e[1])),r};const N=function(t){return"function"==typeof t},M=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function S(t,e){return N(e)?e:x(e)?function(){return e}:function(){return t}}function k(t,e,r){return void 0===r&&(r=!0),e||0===e?N(e)?e:x(e)?function(){return e}:g(e)?function(){if(r){var n=Math.max.apply(Math,u([],s(e)));return isNaN(n)?t:n}return e}:M(e)?function(){if(r){var n=Math.max(e.width,e.height);return isNaN(n)?t:n}return[e.width,e.height]}:function(){return t}:function(e){var r=(e.data||{}).size;return r?g(r)?r[0]>r[1]?r[0]:r[1]:M(r)?r.width>r.height?r.width:r.height:r:t}}var A=function(t,e){var r;return r=x(e)?function(){return e}:N(e)?e:function(){return 0},t?g(t)?function(e){return(t[0]>t[1]?t[0]:t[1])+r(e)}:function(e){return t+r(e)}:function(t){var e,n;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return Math.max(t.data.bboxSize[0],t.data.bboxSize[1])+r(t);if(null===(n=t.data)||void 0===n?void 0:n.size){if(g(t.data.size))return Math.max(t.data.size[0],t.data.size[1])+r(t);var o=t.data.size;return M(o)?(o.width>o.height?o.width:o.height)+r(t):o+r(t)}return 10+r(t)}},R=function(t,e,r){var o=t.getAllNodes(),i=t.getAllEdges();return(null==o?void 0:o.length)?1===o.length?(e&&t.mergeNodeData(o[0].id,{x:r[0],y:r[1]}),{nodes:[n(n({},o[0]),{data:n(n({},o[0].data),{x:r[0],y:r[1]})})],edges:i}):void 0:{nodes:[],edges:i}},I={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},_=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="circular",this.options=n(n({},I),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericCircularLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericCircularLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericCircularLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,u,d,h,c,l,f,g,p,v,y,m,w,x,E,N,M,A,I,_,P,T,z,C,L,q,j,F,V,G,W,B,$,U;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,u=o.height,d=o.center,h=o.divisions,c=o.startAngle,l=void 0===c?0:c,f=o.endAngle,g=void 0===f?2*Math.PI:f,p=o.angleRatio,v=o.ordering,y=o.clockwise,m=o.nodeSpacing,w=o.nodeSize,x=e.getAllNodes(),E=e.getAllEdges(),N=s(O(i,u,d),3),M=N[0],A=N[1],I=N[2],!(_=null==x?void 0:x.length)||1===_)return[2,R(e,t,I)];for(P=(g-l)/_,T=o.radius,z=o.startRadius,C=o.endRadius,m?(L=S(10,m),q=k(10,w),j=-1/0,x.forEach((function(t){var e=q(t);j<e&&(j=e)})),F=0,x.forEach((function(t,e){F+=0===e?j||10:(L(t)||0)+(j||10)})),T=F/(2*Math.PI)):T||z||C?!z&&C?z=C:z&&!C&&(C=z):T=Math.min(A,M)/2,V=P*p,G=[],G="topology"===v?D(e,x):"topology-directed"===v?D(e,x,!0):"degree"===v?function(t,e){var r=[];return e.forEach((function(t,e){r.push(b(t))})),r.sort((function(e,r){return t.getDegree(e.id,"both")-t.getDegree(r.id,"both")})),r}(e,x):x.map((function(t){return b(t)})),W=Math.ceil(_/h),B=0;B<_;++B)($=T)||null===z||null===C||($=z+B*(C-z)/(_-1)),$||($=10+100*B/(_-1)),U=l+B%W*V+2*Math.PI/h*Math.floor(B/W),y||(U=g-B%W*V-2*Math.PI/h*Math.floor(B/W)),G[B].data.x=I[0]+Math.cos(U)*$,G[B].data.y=I[1]+Math.sin(U)*$;return t&&G.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:G,edges:E}]}))}))},t}(),D=function(t,e,r){void 0===r&&(r=!1);var n=[b(e[0])],o={},i=e.length;o[e[0].id]=!0;var a=0;return e.forEach((function(s,u){if(0!==u)if(u!==i-1&&t.getDegree(s.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(n[a].id,s.id)||o[s.id]){for(var d=r?t.getSuccessors(n[a].id):t.getNeighbors(n[a].id),h=!1,c=0;c<d.length;c++){var l=d[c];if(t.getDegree(l.id)===t.getDegree(s.id)&&!o[l.id]){n.push(b(l)),o[l.id]=!0,h=!0;break}}for(var f=0;!h&&(o[e[f].id]||(n.push(b(e[f])),o[e[f].id]=!0,h=!0),++f!==i););}else n.push(b(s)),o[s.id]=!0,a++})),n},O=function(t,e,r){var n=t,o=e,i=r;return n||"undefined"==typeof window||(n=window.innerWidth),o||"undefined"==typeof window||(o=window.innerHeight),i||(i=[n/2,o/2]),[n,o,i]};const P=function(t){return w(t,"String")};var T={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},z=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="concentric",this.options=n(n({},T),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericConcentricLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericConcentricLayout(!0,t,e),[2]}))}))},t.prototype.genericConcentricLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,p,v,y,m,w,E,S,k,A,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K,Y;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,d=o.sortBy,h=o.maxLevelDiff,c=o.sweep,l=o.clockwise,f=o.equidistant,p=o.preventOverlap,v=o.startAngle,y=void 0===v?1.5*Math.PI:v,m=o.nodeSize,w=o.nodeSpacing,E=e.getAllNodes(),S=e.getAllEdges(),k=s||"undefined"==typeof window?s:window.innerWidth,A=u||"undefined"==typeof window?u:window.innerHeight,I=i||[k/2,A/2],!(null==E?void 0:E.length)||1===E.length)return[2,R(e,t,I)];if(_=[],O=0,D=g(m)?Math.max(m[0],m[1]):m,g(w)?O=Math.max(w[0],w[1]):x(w)&&(O=w),E.forEach((function(t){var e=b(t);_.push(e);var r=D,n=e.data;g(n.size)?r=Math.max(n.size[0],n.size[1]):x(n.size)?r=n.size:M(n.size)&&(r=Math.max(n.size.width,n.size.height)),D=Math.max(D,r),N(w)&&(O=Math.max(w(t),O))})),T={},_.forEach((function(t,e){T[t.id]=e})),P(z=d)&&void 0!==_[0].data[z]||(z="degree"),"degree"===z?_.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):_.sort((function(t,e){return e.data[z]-t.data[z]})),C=_[0],L=(h||("degree"===z?e.getDegree(C.id,"both"):C.data[z]))/4,j=(q=[{nodes:[]}])[0],_.forEach((function(t){if(j.nodes.length>0){var r="degree"===z?Math.abs(e.getDegree(j.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(j.nodes[0].data[z]-t.data[z]);L&&r>=L&&(j={nodes:[]},q.push(j))}j.nodes.push(t)})),F=D+O,p||(V=q.length>0&&q[0].nodes.length>1,G=Math.min(k,A)/2-F,W=G/(q.length+(V?1:0)),F=Math.min(F,W)),B=0,q.forEach((function(t){var e=void 0===c?2*Math.PI-2*Math.PI/t.nodes.length:c;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&p){var r=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),o=Math.sqrt(F*F/(r*r+n*n));B=Math.max(o,B)}t.r=B,B+=F})),f){for($=0,U=0,H=0;H<q.length;H++)K=q[H],Y=(K.r||0)-U,$=Math.max($,Y);U=0,q.forEach((function(t,e){0===e&&(U=t.r||0),t.r=U,U+=$}))}return q.forEach((function(t){var e=t.dTheta||0,r=t.r||0;t.nodes.forEach((function(t,n){var o=y+(l?1:-1)*e*n;t.data.x=I[0]+r*Math.cos(o),t.data.y=I[1]+r*Math.sin(o)}))})),t&&_.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:_,edges:S}]}))}))},t}();function C(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i,a,s,u,d,h,c,l,f=t._root,g={data:n},p=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!f)return t._root=g,t;for(;f.length;)if((d=e>=(i=(p+y)/2))?p=i:y=i,(h=r>=(a=(v+m)/2))?v=a:m=a,o=f,!(f=f[c=h<<1|d]))return o[c]=g,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&r===u)return g.next=f,o?o[c]=g:t._root=g,t;do{o=o?o[c]=new Array(4):t._root=new Array(4),(d=e>=(i=(p+y)/2))?p=i:y=i,(h=r>=(a=(v+m)/2))?v=a:m=a}while((c=h<<1|d)==(l=(u>=a)<<1|s>=i));return o[l]=f,o[c]=g,t}function L(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function q(t){return t[0]}function j(t){return t[1]}function F(t,e,r){var n=new V(null==e?q:e,null==r?j:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function V(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function G(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var W=F.prototype=V.prototype;function B(t){return function(){return t}}function $(t){return 1e-6*(t()-.5)}W.copy=function(){var t,e,r=new V(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=G(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var o=0;o<4;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(4)}):n.target[o]=G(e));return r},W.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return C(this.cover(e,r),e,r,t)},W.addAll=function(t){var e,r,n,o,i=t.length,a=new Array(i),s=new Array(i),u=1/0,d=1/0,h=-1/0,c=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(a[r]=n,s[r]=o,n<u&&(u=n),n>h&&(h=n),o<d&&(d=o),o>c&&(c=o));if(u>h||d>c)return this;for(this.cover(u,d).cover(h,c),r=0;r<i;++r)C(this,a[r],s[r],t[r]);return this},W.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var a,s,u=o-r||1,d=this._root;r>t||t>=o||n>e||e>=i;)switch(s=(e<n)<<1|t<r,(a=new Array(4))[s]=d,d=a,u*=2,s){case 0:o=r+u,i=n+u;break;case 1:r=o-u,i=n+u;break;case 2:o=r+u,n=i-u;break;case 3:r=o-u,n=i-u}this._root&&this._root.length&&(this._root=d)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this},W.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},W.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},W.find=function(t,e,r){var n,o,i,a,s,u,d,h=this._x0,c=this._y0,l=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new L(p,h,c,l,f)),null==r?r=1/0:(h=t-r,c=e-r,l=t+r,f=e+r,r*=r);u=g.pop();)if(!(!(p=u.node)||(o=u.x0)>l||(i=u.y0)>f||(a=u.x1)<h||(s=u.y1)<c))if(p.length){var v=(o+a)/2,y=(i+s)/2;g.push(new L(p[3],v,y,a,s),new L(p[2],o,y,v,s),new L(p[1],v,i,a,y),new L(p[0],o,i,v,y)),(d=(e>=y)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-d],g[g.length-1-d]=u)}else{var m=t-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),x=m*m+w*w;if(x<r){var E=Math.sqrt(r=x);h=t-E,c=e-E,l=t+E,f=e+E,n=p.data}}return n},W.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,r,n,o,i,a,s,u,d,h,c,l,f=this._root,g=this._x0,p=this._y0,v=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((d=i>=(s=(g+v)/2))?g=s:v=s,(h=a>=(u=(p+y)/2))?p=u:y=u,e=f,!(f=f[c=h<<1|d]))return this;if(!f.length)break;(e[c+1&3]||e[c+2&3]||e[c+3&3])&&(r=e,l=c)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(o=f.next)&&delete f.next,n?(o?n.next=o:delete n.next,this):e?(o?e[c]=o:delete e[c],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[l]=f:this._root=f),this):(this._root=o,this)},W.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},W.root=function(){return this._root},W.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},W.visit=function(t){var e,r,n,o,i,a,s=[],u=this._root;for(u&&s.push(new L(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,n=e.x0,o=e.y0,i=e.x1,a=e.y1)&&u.length){var d=(n+i)/2,h=(o+a)/2;(r=u[3])&&s.push(new L(r,d,h,i,a)),(r=u[2])&&s.push(new L(r,n,h,d,a)),(r=u[1])&&s.push(new L(r,d,o,i,h)),(r=u[0])&&s.push(new L(r,n,o,d,h))}return this},W.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new L(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.x1,d=e.y1,h=(a+u)/2,c=(s+d)/2;(i=o[0])&&r.push(new L(i,a,s,h,c)),(i=o[1])&&r.push(new L(i,h,s,u,c)),(i=o[2])&&r.push(new L(i,a,c,h,d)),(i=o[3])&&r.push(new L(i,h,c,u,d))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},W.x=function(t){return arguments.length?(this._x=t,this):this._x},W.y=function(t){return arguments.length?(this._y=t,this):this._y};var U={value:()=>{}};function H(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new K(n)}function K(t){this._=t}function Y(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function J(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=U,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}K.prototype=H.prototype={constructor:K,on:function(t,e){var r,n,o=this._,i=(n=o,(t+"").trim().split(/^|\\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)o[r]=J(o[r],t.name,e);else if(null==e)for(r in o)o[r]=J(o[r],t.name,null);return this}for(;++a<s;)if((r=(t=i[a]).type)&&(r=Y(o[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new K(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};const X=H;var Q,Z,tt=0,et=0,rt=0,nt=1e3,ot=0,it=0,at=0,st="object"==typeof performance&&performance.now?performance:Date,ut="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function dt(){return it||(ut(ht),it=st.now()+at)}function ht(){it=0}function ct(){this._call=this._time=this._next=null}function lt(t,e,r){var n=new ct;return n.restart(t,e,r),n}function ft(){it=(ot=st.now())+at,tt=et=0;try{!function(){dt(),++tt;for(var t,e=Q;e;)(t=it-e._time)>=0&&e._call.call(void 0,t),e=e._next;--tt}()}finally{tt=0,function(){for(var t,e,r=Q,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:Q=e);Z=t,pt(n)}(),it=0}}function gt(){var t=st.now(),e=t-ot;e>nt&&(at-=e,ot=t)}function pt(t){tt||(et&&(et=clearTimeout(et)),t-it>24?(t<1/0&&(et=setTimeout(ft,t-st.now()-at)),rt&&(rt=clearInterval(rt))):(rt||(ot=st.now(),rt=setInterval(gt,nt)),tt=1,ut(ft)))}ct.prototype=lt.prototype={constructor:ct,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?dt():+r)+(null==e?0:+e),this._next||Z===this||(Z?Z._next=this:Q=this,Z=this),this._call=t,this._time=r,pt()},stop:function(){this._call&&(this._call=null,this._time=1/0,pt())}};const vt=1664525,yt=1013904223,mt=4294967296;function wt(t){return t.x}function xt(t){return t.y}var Et=10,bt=Math.PI*(3-Math.sqrt(5));function Nt(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,a=.6,s=new Map,u=lt(c),d=X("tick","end"),h=function(){let t=1;return()=>(t=(vt*t+yt)%mt)/mt}();function c(){l(),d.call("tick",e),r<n&&(u.stop(),d.call("end",e))}function l(n){var u,d,h=t.length;void 0===n&&(n=1);for(var c=0;c<n;++c)for(r+=(i-r)*o,s.forEach((function(t){t(r)})),u=0;u<h;++u)null==(d=t[u]).fx?d.x+=d.vx*=a:(d.x=d.fx,d.vx=0),null==d.fy?d.y+=d.vy*=a:(d.y=d.fy,d.vy=0);return e}function f(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var o=Et*Math.sqrt(.5+r),i=r*bt;e.x=o*Math.cos(i),e.y=o*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,h),e}return null==t&&(t=[]),f(),e={tick:l,restart:function(){return u.restart(c),e},stop:function(){return u.stop(),e},nodes:function(r){return arguments.length?(t=r,f(),s.forEach(g),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(h=t,s.forEach(g),e):h},force:function(t,r){return arguments.length>1?(null==r?s.delete(t):s.set(t,g(r)),e):s.get(t)},find:function(e,r,n){var o,i,a,s,u,d=0,h=t.length;for(null==n?n=1/0:n*=n,d=0;d<h;++d)(a=(o=e-(s=t[d]).x)*o+(i=r-s.y)*i)<n&&(u=s,n=a);return u},on:function(t,r){return arguments.length>1?(d.on(t,r),e):d.on(t)}}}function Mt(){var t,e,r,n,o,i=B(-30),a=1,s=1/0,u=.81;function d(r){var o,i=t.length,a=F(t,wt,xt).visitAfter(c);for(n=r,o=0;o<i;++o)e=t[o],a.visit(l)}function h(){if(t){var e,r,n=t.length;for(o=new Array(n),e=0;e<n;++e)r=t[e],o[r.index]=+i(r,e,t)}}function c(t){var e,r,n,i,a,s=0,u=0;if(t.length){for(n=i=a=0;a<4;++a)(e=t[a])&&(r=Math.abs(e.value))&&(s+=e.value,u+=r,n+=r*e.x,i+=r*e.y);t.x=n/u,t.y=i/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=o[e.data.index]}while(e=e.next)}t.value=s}function l(t,i,d,h){if(!t.value)return!0;var c=t.x-e.x,l=t.y-e.y,f=h-i,g=c*c+l*l;if(f*f/u<g)return g<s&&(0===c&&(g+=(c=$(r))*c),0===l&&(g+=(l=$(r))*l),g<a&&(g=Math.sqrt(a*g)),e.vx+=c*t.value*n/g,e.vy+=l*t.value*n/g),!0;if(!(t.length||g>=s)){(t.data!==e||t.next)&&(0===c&&(g+=(c=$(r))*c),0===l&&(g+=(l=$(r))*l),g<a&&(g=Math.sqrt(a*g)));do{t.data!==e&&(f=o[t.data.index]*n/g,e.vx+=c*f,e.vy+=l*f)}while(t=t.next)}}return d.initialize=function(e,n){t=e,r=n,h()},d.strength=function(t){return arguments.length?(i="function"==typeof t?t:B(+t),h(),d):i},d.distanceMin=function(t){return arguments.length?(a=t*t,d):Math.sqrt(a)},d.distanceMax=function(t){return arguments.length?(s=t*t,d):Math.sqrt(s)},d.theta=function(t){return arguments.length?(u=t*t,d):Math.sqrt(u)},d}function St(t){return t.index}function kt(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function At(t){var e,r,n,o,i,a,s=St,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},d=B(30),h=1;function c(n){for(var o=0,s=t.length;o<h;++o)for(var u,d,c,l,f,g,p,v=0;v<s;++v)d=(u=t[v]).source,l=(c=u.target).x+c.vx-d.x-d.vx||$(a),f=c.y+c.vy-d.y-d.vy||$(a),l*=g=((g=Math.sqrt(l*l+f*f))-r[v])/g*n*e[v],f*=g,c.vx-=l*(p=i[v]),c.vy-=f*p,d.vx+=l*(p=1-p),d.vy+=f*p}function l(){if(n){var a,u,d=n.length,h=t.length,c=new Map(n.map(((t,e)=>[s(t,e,n),t])));for(a=0,o=new Array(d);a<h;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=kt(c,u.source)),"object"!=typeof u.target&&(u.target=kt(c,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(a=0,i=new Array(h);a<h;++a)u=t[a],i[a]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);e=new Array(h),f(),r=new Array(h),g()}}function f(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+u(t[r],r,t)}function g(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+d(t[e],e,t)}return null==t&&(t=[]),c.initialize=function(t,e){n=t,a=e,l()},c.links=function(e){return arguments.length?(t=e,l(),c):t},c.id=function(t){return arguments.length?(s=t,c):s},c.iterations=function(t){return arguments.length?(h=+t,c):h},c.strength=function(t){return arguments.length?(u="function"==typeof t?t:B(+t),f(),c):u},c.distance=function(t){return arguments.length?(d="function"==typeof t?t:B(+t),g(),c):d},c}function Rt(t){return t.x+t.vx}function It(t){return t.y+t.vy}function _t(t){var e,r,n,o=1,i=1;function a(){for(var t,a,u,d,h,c,l,f=e.length,g=0;g<i;++g)for(a=F(e,Rt,It).visitAfter(s),t=0;t<f;++t)u=e[t],c=r[u.index],l=c*c,d=u.x+u.vx,h=u.y+u.vy,a.visit(p);function p(t,e,r,i,a){var s=t.data,f=t.r,g=c+f;if(!s)return e>d+g||i<d-g||r>h+g||a<h-g;if(s.index>u.index){var p=d-s.x-s.vx,v=h-s.y-s.vy,y=p*p+v*v;y<g*g&&(0===p&&(y+=(p=$(n))*p),0===v&&(y+=(v=$(n))*v),y=(g-(y=Math.sqrt(y)))/y*o,u.vx+=(p*=y)*(g=(f*=f)/(l+f)),u.vy+=(v*=y)*g,s.vx-=p*(g=1-g),s.vy-=v*g)}}}function s(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var n,o,i=e.length;for(r=new Array(i),n=0;n<i;++n)o=e[n],r[o.index]=+t(o,n,e)}}return"function"!=typeof t&&(t=B(null==t?1:+t)),a.initialize=function(t,r){e=t,n=r,u()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(o=+t,a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),u(),a):t},a}function Dt(t){var e,r,n,o=B(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=B(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:B(+t),a(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),a(),i):t},i}function Ot(t){var e,r,n,o=B(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=B(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:B(+t),a(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),a(),i):t},i}function Pt(){function t(t){return function(){return t}}var e,r=function(t){return t.cluster},n=t(1),o=t(-1),i=t(100),a=t(.1),u=[0,0],d=[],h={},c=[],l=100,f=100,g={none:{x:0,y:0}},p=[],v="force",y=!0,m=.1;function w(t){if(!y)return w;e.tick(),E();for(var n=0,o=d.length,i=void 0,a=t*m;n<o;++n)(i=d[n]).vx+=(g[r(i)].x-i.x)*a,i.vy+=(g[r(i)].y-i.y)*a}function x(){d&&function(){if(d&&d.length){if(void 0===r(d[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy(\'clusterAttr\') before calling .links()");var t,u,g,v,y,m=(t=[],u=[],g={},{},y=[],v=function(t){var e={};return t.forEach((function(t){var n=r(t);e[n]||(e[n]={count:0,sumforceNodeSize:0})})),t.forEach((function(t){var o=r(t),i=n(t),a=e[o];a.count=a.count+1,a.sumforceNodeSize=a.sumforceNodeSize+Math.PI*(i*i)*1.3,e[o]=a})),e}(d),y=function(t){var e={},n=[];return t.forEach((function(t){var n,o,i,a,s,u=(o=(n=t).source,i=n.target,(a=r(h[o]))<=(s=r(h[i]))?a+"~"+s:s+"~"+a),d=0;void 0!==e[u]&&(d=e[u]),d+=1,e[u]=d})),Object.entries(e).forEach((function(t){var e=s(t,2),r=e[0],o=e[1],i=r.split("~")[0],a=r.split("~")[1];void 0!==i&&void 0!==a&&n.push({source:i,target:a,count:o})})),n}(c),Object.keys(v).forEach((function(e,r){var n=v[e];t.push({id:e,size:n.count,r:Math.sqrt(n.sumforceNodeSize/Math.PI)}),g[e]=r})),y.forEach((function(t){var e=t.source,r=t.target,n=g[e],o=g[r];void 0!==n&&void 0!==o&&u.push({source:n,target:o,count:t.count})})),{nodes:t,links:u});e=Nt(m.nodes).force("x",Dt(l).strength(.1)).force("y",Ot(f).strength(.1)).force("collide",_t((function(t){return t.r})).iterations(4)).force("charge",Mt().strength(o)).force("links",At(m.nodes.length?m.links:[]).distance(i).strength(a)),p=e.nodes(),E()}}()}function E(){return g={none:{x:0,y:0}},p.forEach((function(t){g[t.id]={x:t.x-u[0],y:t.y-u[1]}})),g}return w.initialize=function(t){d=t,x()},w.template=function(t){return arguments.length?(v=t,x(),w):v},w.groupBy=function(t){return arguments.length?"string"==typeof t?(r=function(e){return e[t]},w):(r=t,w):r},w.enableGrouping=function(t){return arguments.length?(y=t,w):y},w.strength=function(t){return arguments.length?(m=t,w):m},w.centerX=function(t){return arguments.length?(l=t,w):l},w.centerY=function(t){return arguments.length?(f=t,w):f},w.nodes=function(t){return arguments.length?(function(t){h={},t.forEach((function(t){h[t.id]=t}))}(t||[]),d=t||[],w):d},w.links=function(t){return arguments.length?(c=t||[],x(),w):c},w.forceNodeSize=function(e){return arguments.length?(n="function"==typeof e?e:t(+e),x(),w):n},w.nodeSize=w.forceNodeSize,w.forceCharge=function(e){return arguments.length?(o="function"==typeof e?e:t(+e),x(),w):o},w.forceLinkDistance=function(e){return arguments.length?(i="function"==typeof e?e:t(+e),x(),w):i},w.forceLinkStrength=function(e){return arguments.length?(a="function"==typeof e?e:t(+e),x(),w):a},w.offset=function(t){return arguments.length?(u=t,w):u},w.getFocis=E,w}var Tt={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},zt=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="d3force",this.options=n(n({},Tt),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){var t;null===(t=this.forceSimulation)||void 0===t||t.stop()},t.prototype.tick=function(t){var e=this;void 0===t&&(t=1),this.forceSimulation.tick(t);var r={nodes:Ct(this.lastLayoutNodes),edges:Lt(this.lastLayoutEdges)};return this.lastAssign&&r.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,g,p,v,y,m,w,x,E,N,M,S,k,A,R,I,_,D,O=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=i.map((function(t){var e,r;return n(n({},b(t)),{x:null===(e=t.data)||void 0===e?void 0:e.x,y:null===(r=t.data)||void 0===r?void 0:r.y})})),d=s.map((function(t){return b(t)})),this.lastLayoutNodes=u,this.lastLayoutEdges=d,this.lastAssign=t,this.lastGraph=e,h=o.alphaMin,c=o.alphaDecay,l=o.alpha,f=o.nodeStrength,g=o.edgeStrength,p=o.linkDistance,v=o.clustering,y=o.clusterFociStrength,m=o.clusterEdgeDistance,w=o.clusterEdgeStrength,x=o.clusterNodeStrength,E=o.clusterNodeSize,N=o.collideStrength,M=void 0===N?1:N,S=o.center,k=void 0===S?[0,0]:S,A=o.preventOverlap,R=o.nodeSize,I=o.nodeSpacing,_=o.onTick,D=o.forceSimulation,[2,new Promise((function(r){if(D){v&&((i=Pt()).nodes(u),i.links(d)),D.nodes(u),d&&(s=At().id((function(t){return t.id})).links(d),g&&s.strength(g),p&&s.distance(p),D.force("link",s)),A&&O.overlapProcess(D,{nodeSize:R,nodeSpacing:I,collideStrength:M}),D.alpha(l).restart();var n=Ct(u),o=Lt(d);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:o})}else try{var i,a=Mt();if(f&&a.strength(f),D=Nt().nodes(u),v&&((i=Pt()).centerX(k[0]).centerY(k[1]).template("force").strength(y),d&&i.links(d),u&&i.nodes(u),i.forceLinkDistance(m).forceLinkStrength(w).forceCharge(x).forceNodeSize(E),D.force("group",i)),D.force("center",function(t,e){var r,n=1;function o(){var o,i,a=r.length,s=0,u=0;for(o=0;o<a;++o)s+=(i=r[o]).x,u+=i.y;for(s=(s/a-t)*n,u=(u/a-e)*n,o=0;o<a;++o)(i=r[o]).x-=s,i.y-=u}return null==t&&(t=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(n=+t,o):n},o}(k[0],k[1])).force("charge",a).alpha(l).alphaDecay(c).alphaMin(h),A&&O.overlapProcess(D,{nodeSize:R,nodeSpacing:I,collideStrength:M}),d){var s=At().id((function(t){return t.id})).links(d);g&&s.strength(g),p&&s.distance(p),D.force("link",s)}D.on("tick",(function(){var r=Ct(u);null==_||_({nodes:r,edges:Lt(d)}),t&&r.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}))})).on("end",(function(){var n=Ct(u);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:Lt(d)})}))}catch(t){console.warn(t)}O.forceSimulation=D}))]}))}))},t.prototype.overlapProcess=function(t,e){var r,n,o=e.nodeSize,i=e.nodeSpacing,a=e.collideStrength;if(n=x(i)?function(){return i}:N(i)?i:function(){return 0},o)if(N(o))r=function(t){return o(t)+n(t)};else if(g(o)){var s=(o[0]>o[1]?o[0]:o[1])/2;r=function(t){return s+n(t)}}else if(x(o)){var u=o/2;r=function(t){return u+n(t)}}else r=function(){return 10};else r=function(t){return t.size?g(t.size)?(t.size[0]>t.size[1]?t.size[0]:t.size[1])/2+n(t):M(t.size)?(t.size.width>t.size.height?t.size.width:t.size.height)/2+n(t):t.size/2+n(t):10+n(t)};t.force("collisionForce",_t(r).strength(a))},t}(),Ct=function(t){return t.map((function(t){var e=t.x,r=t.y,i=o(t,["x","y"]);return n(n({},i),{data:n(n({},i.data),{x:e,y:r})})}))},Lt=function(t){return t.map((function(t){var e=t.source,r=t.target,i=o(t,["source","target"]);return n(n({},i),{source:e.id,target:r.id})}))};var qt=function(t,e){if("next"!==t&&"prev"!==t)return e},jt=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(function(){function t(){var t={};t.prev=t,t.next=t.prev,this.shortcut=t}return t.prototype.dequeue=function(){var t=this.shortcut,e=t.prev;if(e&&e!==t)return jt(e),e},t.prototype.enqueue=function(t){var e=this.shortcut;t.prev&&t.next&&jt(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e},t.prototype.toString=function(){for(var t=[],e=this.shortcut,r=e.prev;r!==e;)t.push(JSON.stringify(r,qt)),r=null==r?void 0:r.prev;return"["+t.join(", ")+"]"},t}()),Vt=function(){return 1},Gt=function(t,e,r,o,i){var a,s,u=[];return t.hasNode(o.v)&&(null===(a=t.getRelatedEdges(o.v,"in"))||void 0===a||a.forEach((function(o){var a=o.data.weight,s=t.getNode(o.source);i&&u.push({v:o.source,w:o.target,in:0,out:0}),void 0===s.data.out&&(s.data.out=0),s.data.out-=a,Wt(e,r,n({v:s.id},s.data))})),null===(s=t.getRelatedEdges(o.v,"out"))||void 0===s||s.forEach((function(o){var i=o.data.weight,a=o.target,s=t.getNode(a);void 0===s.data.in&&(s.data.in=0),s.data.in-=i,Wt(e,r,n({v:s.id},s.data))})),t.removeNode(o.v)),i?u:void 0},Wt=function(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},Bt=function(t,e){var r="greedy"===e?function(t,e){var r;if(t.getAllNodes().length<=1)return[];var o=function(t,e){var r=new l,o=0,i=0;t.getAllNodes().forEach((function(t){r.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((function(t){var a=r.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target})),s=(null==e?void 0:e(t))||1;a?r.updateEdgeData(null==a?void 0:a.id,n(n({},a.data),{weight:a.data.weight+s})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:s}}),i=Math.max(i,r.getNode(t.source).data.out+=s),o=Math.max(o,r.getNode(t.target).data.in+=s)}));for(var a=[],s=i+o+3,u=0;u<s;u++)a.push(new Ft);var d=o+1;return r.getAllNodes().forEach((function(t){Wt(a,d,n({v:t.id},r.getNode(t.id).data))})),{buckets:a,zeroIdx:d,graph:r}}(t,function(t){return t.data.weight||1}||Vt);return null===(r=function(t,e,r){for(var n,o=[],i=e[e.length-1],a=e[0];t.getAllNodes().length;){for(;n=a.dequeue();)Gt(t,e,r,n);for(;n=i.dequeue();)Gt(t,e,r,n);if(t.getAllNodes().length)for(var s=e.length-2;s>0;--s)if(n=e[s].dequeue()){o=o.concat(Gt(t,e,r,n,!0));break}}return o}(o.graph,o.buckets,o.zeroIdx).map((function(e){return t.getRelatedEdges(e.v,"out").filter((function(t){return t.target===e.w}))})))||void 0===r?void 0:r.flat()}(t):$t(t);null==r||r.forEach((function(e){var r=e.data;t.removeEdge(e.id),r.forwardName=e.data.name,r.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:n({},r)})}))},$t=function(t){var e=[],r={},n={},o=function(i){n[i]||(n[i]=!0,r[i]=!0,t.getRelatedEdges(i,"out").forEach((function(t){r[t.target]?e.push(t):o(t.target)})),delete r[i])};return t.getAllNodes().forEach((function(t){return o(t.id)})),e},Ut=function(t,e,r,n){var o;do{o=""+n+Math.random()}while(t.hasNode(o));return r.dummy=e,t.addNode({id:o,data:r}),o},Ht=function(t){var e=new l;return t.getAllNodes().forEach((function(r){t.getChildren(r.id).length||e.addNode(n({},r))})),t.getAllEdges().forEach((function(t){e.addEdge(t)})),e},Kt=function(t,e){var r,n,o=Number(t.x),i=Number(t.y),a=Number(e.x)-o,s=Number(e.y)-i,u=Number(t.width)/2,d=Number(t.height)/2;return a||s?(Math.abs(s)*u>Math.abs(a)*d?(s<0&&(d=-d),r=d*a/s,n=d):(a<0&&(u=-u),r=u,n=u*s/a),{x:o+r,y:i+n}):{x:0,y:0}},Yt=function(t){for(var e=[],r=Xt(t)+1,n=0;n<r;n++)e.push([]);for(t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)})),n=0;n<r;n++)e[n]=e[n].sort((function(e,r){return n=t.getNode(e).data.order,o=t.getNode(r).data.order,Number(n)-Number(o);var n,o}));return e},Jt=function(t,e,r,n){var o={width:0,height:0};return x(r)&&x(n)&&(o.rank=r,o.order=n),Ut(t,"border",o,e)},Xt=function(t){var e;return t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)})),e||(e=0),e},Qt=function(t,e){return t.reduce((function(t,r){return e(t)>e(r)?r:t}))},Zt=function(t,e,r,n,o,i){n.includes(e.id)||(n.push(e.id),r||i.push(e.id),o(e.id).forEach((function(e){return Zt(t,e,r,n,o,i)})),r&&i.push(e.id))},te=function(t,e,r,n){var o=Array.isArray(e)?e:[e],i=function(e){return n?t.getSuccessors(e):t.getNeighbors(e)},a=[],s=[];return o.forEach((function(e){if(!t.hasNode(e.id))throw new Error("Graph does not have node: "+e);Zt(t,e,"post"===r,s,i,a)})),a},ee="edge-label",re=function(t){var e={},r=function(n){var o,i,a=t.getNode(n);return a?e[n]?a.data.rank:(e[n]=!0,null===(o=t.getRelatedEdges(n,"out"))||void 0===o||o.forEach((function(t){var e=r(t.target)-t.data.minlen;e&&(void 0===i||e<i)&&(i=e)})),i||(i=0),a.data.rank=i,i):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){return r(t.id)}))},ne=function(t,e){return t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen},oe=function(t,e){var r=function(n){e.getRelatedEdges(n,"both").forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ie=function(t,e){var r=function(n){var o;null===(o=e.getRelatedEdges(n,"both"))||void 0===o||o.forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||void 0===e.getNode(a).data.layer&&ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ae=function(t,e){return Qt(e.getAllEdges(),(function(r){return t.hasNode(r.source)!==t.hasNode(r.target)?ne(e,r):1/0}))},se=function(t,e,r){t.getAllNodes().forEach((function(t){var n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r}))},ue=function(t,e){var r=te(t,t.getAllNodes(),"post",!1);(r=r.slice(0,(null==r?void 0:r.length)-1)).forEach((function(r){de(t,e,r)}))},de=function(t,e,r){var n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find((function(t){return t.target===n||t.source===n})).data.cutvalue=he(t,e,r)},he=function(t,e,r){var n=t.getNode(r).data.parent,o=!0,i=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),a=0;return i||(o=!1,i=e.getRelatedEdges(n,"out").find((function(t){return t.target===r}))),a=i.data.weight,e.getRelatedEdges(r,"both").forEach((function(e){var i=e.source===r,s=i?e.target:e.source;if(s!==n){var u=i===o,d=e.data.weight;if(a+=u?d:-d,ye(t,r,s)){var h=t.getRelatedEdges(r,"both").find((function(t){return t.source===s||t.target===s})).data.cutvalue;a+=u?-h:h}}})),a},ce=function(t,e){void 0===e&&(e=t.getAllNodes()[0].id),le(t,{},1,e)},le=function(t,e,r,n,o){var i,a=r,s=r,u=t.getNode(n);return e[n]=!0,null===(i=t.getNeighbors(n))||void 0===i||i.forEach((function(r){e[r.id]||(s=le(t,e,s,r.id,n))})),u.data.low=a,u.data.lim=s++,o?u.data.parent=o:delete u.data.parent,s},fe=function(t){return t.getAllEdges().find((function(t){return t.data.cutvalue<0}))},ge=function(t,e,r){var n=r.source,o=r.target;e.getRelatedEdges(n,"out").find((function(t){return t.target===o}))||(n=r.target,o=r.source);var i=t.getNode(n),a=t.getNode(o),s=i,u=!1;i.data.lim>a.data.lim&&(s=a,u=!0);var d=e.getAllEdges().filter((function(e){return u===me(t.getNode(e.source),s)&&u!==me(t.getNode(e.target),s)}));return Qt(d,(function(t){return ne(e,t)}))},pe=function(t,e,r,n){var o=t.getRelatedEdges(r.source,"both").find((function(t){return t.source===r.target||t.target===r.target}));o&&t.removeEdge(o.id),t.addEdge({id:"e"+Math.random(),source:n.source,target:n.target,data:{}}),ce(t),ue(t,e),ve(t,e)},ve=function(t,e){var r=t.getAllNodes().find((function(t){return!t.data.parent})),n=te(t,r,"pre",!1);(n=n.slice(1)).forEach((function(r){var n=t.getNode(r).data.parent,o=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),i=!1;!o&&e.hasNode(n)&&(o=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),i=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(i?null==o?void 0:o.data.minlen:-(null==o?void 0:o.data.minlen))}))},ye=function(t,e,r){return t.getRelatedEdges(e,"both").find((function(t){return t.source===r||t.target===r}))},me=function(t,e){return e.data.low<=t.data.lim&&t.data.lim<=e.data.lim},we=re,xe=function(t){!function(t){var e=function(t){var e=new l;return t.getAllNodes().forEach((function(t){e.addNode(n({},t))})),t.getAllEdges().forEach((function(t){var r=e.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target}));r?e.updateEdgeData(null==r?void 0:r.id,n(n({},r.data),{weight:r.data.weight+t.data.weight||0,minlen:Math.max(r.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e}(t);re(e);var r,o,i=function(t){var e,r,n=new l({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);oe(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r);return n}(e);for(ce(i),ue(i,e);r=fe(i);)o=ge(i,e,r),pe(i,e,r,o)}(t)},Ee=function(t,e,r,n,o,i,a){var s=t.getChildren(a);if(null==s?void 0:s.length){var u=Jt(t,"_bt"),d=Jt(t,"_bb"),h=t.getNode(a);t.setParent(u,a),h.data.borderTop=u,t.setParent(d,a),h.data.borderBottom=d,null==s||s.forEach((function(s){Ee(t,e,r,n,o,i,s.id);var h=s.data.borderTop?s.data.borderTop:s.id,c=s.data.borderBottom?s.data.borderBottom:s.id,l=s.data.borderTop?n:2*n,f=h!==c?1:o-i[a]+1;t.addEdge({id:"e"+Math.random(),source:u,target:h,data:{minlen:f,weight:l,nestingEdge:!0}}),t.addEdge({id:"e"+Math.random(),source:c,target:d,data:{minlen:f,weight:l,nestingEdge:!0}})})),t.getParent(a)||t.addEdge({id:"e"+Math.random(),source:e,target:u,data:{weight:0,minlen:o+i[a]}})}else a!==e&&t.addEdge({id:"e"+Math.random(),source:e,target:a,data:{weight:0,minlen:r}})},be=function(t,e,r,n,o,i){var a={rank:i,borderType:e,width:0,height:0},s=o.data[e][i-1],u=Ut(t,"border",a,r);o.data[e][i]=u,t.setParent(u,n),s&&t.addEdge({id:"e"+Math.random(),source:s,target:u,data:{weight:1}})},Ne=function(t){t.getAllNodes().forEach((function(t){Me(t)})),t.getAllEdges().forEach((function(t){Me(t)}))},Me=function(t){var e=t.data.width;t.data.width=t.data.height,t.data.height=e},Se=function(t){(null==t?void 0:t.y)&&(t.y=-t.y)},ke=function(t){var e=t.x;t.x=t.y,t.y=e},Ae=function(t){for(var e={},r=t.getAllNodes(),n=r.map((function(t){var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),o=Math.max.apply(Math,u([],s(n))),i=[],a=0;a<o+1;a++)i.push([]);var d=r.sort((function(e,r){return t.getNode(e.id).data.rank-t.getNode(r.id).data.rank})),h=d.filter((function(e){return void 0!==t.getNode(e.id).data.fixorder})).sort((function(e,r){return t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder}));return null==h||h.forEach((function(r){isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0})),null==d||d.forEach((function(r){return t.dfsTree(r.id,(function(t){if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)}))})),i},Re=function(t,e,r){for(var n=function(t,e){return null==t?void 0:t.reduce((function(t,r,n){return t[r]=e[n],t}),{})}(r,r.map((function(t,e){return e}))),o=e.map((function(e){var r=t.getRelatedEdges(e,"out").map((function(t){return{pos:n[t.target]||0,weight:t.data.weight}}));return null==r?void 0:r.sort((function(t,e){return t.pos-e.pos}))})),i=o.flat().filter((function(t){return void 0!==t})),a=1;a<r.length;)a<<=1;var s=2*a-1;a-=1;var u=Array(s).fill(0,0,s),d=0;return null==i||i.forEach((function(t){if(t){var e=t.pos+a;u[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=u[e+1]),u[e=e-1>>1]+=t.weight;d+=t.weight*r}})),d},Ie=function(t,e){for(var r=0,n=1;n<(null==e?void 0:e.length);n+=1)r+=Re(t,e[n-1],e[n]);return r},_e=function(t,e){var r,n=0,o=0;t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/o,t.weight=o,t.i=Math.min(e.i,t.i),e.merged=!0};const De=function(t,e){var r,n,o,i={};return null==t||t.forEach((function(t,e){i[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};var r=i[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)})),null===(r=e.getAllEdges())||void 0===r||r.forEach((function(t){var e=i[t.source],r=i[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(i[t.target]))})),function(t){for(var e,r,n=[],o=function(){var o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach((function(t){return(e=o,function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&_e(e,t)})(t);var e})),null===(r=o.out)||void 0===r||r.forEach((function(e){return(r=o,function(e){e.in.push(r),0==--e.indegree&&t.push(e)})(e);var r}))};null==t?void 0:t.length;)o();var i=n.filter((function(t){return!t.merged})),a=["vs","i","barycenter","weight"];return i.map((function(t){var e={};return null==a||a.forEach((function(r){void 0!==t[r]&&(e[r]=t[r])})),e}))}(null===(o=(n=Object.values(i)).filter)||void 0===o?void 0:o.call(n,(function(t){return!t.indegree})))};var Oe=function(t,e,r){for(var n,o=r;e.length&&(n=e[e.length-1]).i<=o;)e.pop(),null==t||t.push(n.vs),o++;return o},Pe=function(t,e,r,n,o,i){var a,s,u,d,h=t.getChildren(e).map((function(t){return t.id})),c=t.getNode(e),l=c?c.data.borderLeft:void 0,f=c?c.data.borderRight:void 0,g={};l&&(h=null==h?void 0:h.filter((function(t){return t!==l&&t!==f})));var p=function(t,e){return e.map((function(e){var r=t.getRelatedEdges(e,"in");if(!(null==r?void 0:r.length))return{v:e};var n={sum:0,weight:0};return null==r||r.forEach((function(e){var r=t.getNode(e.source);n.sum+=e.data.weight*r.data.order,n.weight+=e.data.weight})),{v:e,barycenter:n.sum/n.weight,weight:n.weight}}))}(t,h||[]);null==p||p.forEach((function(e){var o;if(null===(o=t.getChildren(e.v))||void 0===o?void 0:o.length){var a=Pe(t,e.v,r,n,i);g[e.v]=a,a.hasOwnProperty("barycenter")&&ze(e,a)}}));var v=De(p,r);Te(v,g),null===(a=v.filter((function(t){return t.vs.length>0})))||void 0===a||a.forEach((function(e){var r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)}));var y=function(t,e,r,n){var o=function(t,e){var r={lhs:[],rhs:[]};return null==t||t.forEach((function(t){var e,o;o=(e=t).hasOwnProperty("fixorder")&&!isNaN(e.fixorder),(n?!o&&e.hasOwnProperty("barycenter"):o||e.hasOwnProperty("barycenter"))?r.lhs.push(t):r.rhs.push(t)})),r}(t),i=o.lhs,a=o.rhs.sort((function(t,e){return-t.i- -e.i})),s=[],u=0,d=0,h=0;null==i||i.sort(function(t,e){return function(r,n){if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i}}(!!e,!!r)),h=Oe(s,a,h),null==i||i.forEach((function(t){var e;h+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),u+=t.barycenter*t.weight,d+=t.weight,h=Oe(s,a,h)}));var c={vs:s.flat()};return d&&(c.barycenter=u/d,c.weight=d),c}(v,n,o,i);if(l&&(y.vs=[l,y.vs,f].flat(),null===(s=t.getPredecessors(l))||void 0===s?void 0:s.length)){var m=t.getNode((null===(u=t.getPredecessors(l))||void 0===u?void 0:u[0].id)||""),w=t.getNode((null===(d=t.getPredecessors(f))||void 0===d?void 0:d[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+w.data.order)/(y.weight+2),y.weight+=2}return y},Te=function(t,e){null==t||t.forEach((function(t){var r,n=null===(r=t.vs)||void 0===r?void 0:r.map((function(t){return e[t]?e[t].vs:t}));t.vs=n.flat()}))},ze=function(t,e){void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},Ce=function(t){if("object"!=typeof t||null===t)return t;var e,r;if(r=t,Array.isArray?Array.isArray(r):w(r,"Array")){e=[];for(var n=0,o=t.length;n<o;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=Ce(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=Ce(t[i]):e[i]=t[i];return e};const Le=Ce;var qe=function(t,e,r){return e.map((function(e){return function(t,e,r){var o=function(t){for(var e;t.hasNode(e="_root"+Math.random()););return e}(t),i=new l({tree:[{id:o,children:[],data:{}}]});return t.getAllNodes().forEach((function(a){var s=t.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(n({},a)),(null==s?void 0:s.id)&&!i.hasNode(null==s?void 0:s.id)&&i.addNode(n({},s)),i.setParent(a.id,(null==s?void 0:s.id)||o),t.getRelatedEdges(a.id,r).forEach((function(e){var r=e.source===a.id?e.target:e.source;i.hasNode(r)||i.addNode(n({},t.getNode(r)));var o=i.getRelatedEdges(r,"out").find((function(t){return t.target===a.id})),s=void 0!==o?o.data.weight:0;o?i.updateEdgeData(o.id,n(n({},o.data),{weight:e.data.weight+s})):i.addEdge({id:e.id,source:r,target:a.id,data:{weight:e.data.weight+s}})})),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,n(n({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))})),i}(t,e,r)}))},je=function(t,e,r,n){var o=new l;null==t||t.forEach((function(t){for(var i,a=t.getRoots()[0].id,s=Pe(t,a,o,e,r,n),u=0;u<(null===(i=s.vs)||void 0===i?void 0:i.length);u++){var d=t.getNode(s.vs[u]);d&&(d.data.order=u)}!function(t,e,r){var n,o={};null==r||r.forEach((function(r){for(var i,a,s=t.getParent(r);s;){if((i=t.getParent(s.id))?(a=o[i.id],o[i.id]=s.id):(a=n,n=s.id),a&&a!==s.id)return e.addNodes([{id:a,data:{}},{id:s.id,data:{}}]),void e.addEdge({id:"e"+a+"-"+s.id,source:a,target:s.id,data:{}});s=i}}))}(t,o,s.vs)}))},Fe=function(t,e){null==e||e.forEach((function(e){null==e||e.forEach((function(e,r){t.getNode(e).data.order=r}))}))},Ve=function(t,e){var r={};function n(e,n,o,i,a){for(var s,u,d,h=n;h<o;h++)d=e[h],(null===(s=t.getNode(d))||void 0===s?void 0:s.data.dummy)&&(null===(u=t.getPredecessors(d))||void 0===u||u.forEach((function(e){var n=t.getNode(e.id);n.data.dummy&&(n.data.order<i||n.data.order>a)&&We(r,e.id,d)})))}function o(t,e){var r=function(t){return JSON.stringify(t.slice(1))}(t);e.get(r)||(n.apply(void 0,u([],s(t))),e.set(r,!0))}return(null==e?void 0:e.length)&&e.reduce((function(e,r){var n,i=-1,a=0,s=new Map;return null==r||r.forEach((function(u,d){var h;if("border"===(null===(h=t.getNode(u))||void 0===h?void 0:h.data.dummy)){var c=t.getPredecessors(u)||[];c.length&&(n=t.getNode(c[0].id).data.order,o([r,a,d,i,n],s),a=d,i=n)}o([r,a,r.length,n,e.length],s)})),r})),r},Ge=function(t,e){var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find((function(e){return t.getNode(e.id).data.dummy}))},We=function(t,e,r){var n=e,o=r;if(n>o){var i=n;n=o,o=i}var a=t[n];a||(t[n]=a={}),a[o]=!0},Be=function(t,e,r){var n=e;return n>r&&(n=r),!!t[n]},$e=function(t,e,r,o,i,a){var s=new l,u=Ue(o,i,a);return null==e||e.forEach((function(e){var o;null==e||e.forEach((function(e){var i=r[e];if(s.hasNode(i)||s.addNode({id:i,data:{}}),o){var a=r[o],d=s.getRelatedEdges(a,"out").find((function(t){return t.target===i}));d?s.updateEdgeData(d.id,n(n({},d.data),{weight:Math.max(u(t,e,o),d.data.weight||0)})):s.addEdge({id:"e"+Math.random(),source:a,target:i,data:{weight:Math.max(u(t,e,o),0)}})}o=e}))})),s};var Ue=function(t,e,r){return function(n,o,i){var a=n.getNode(o),s=n.getNode(i),u=0,d=0;if(u+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":d=-a.data.width/2;break;case"r":d=a.data.width/2}if(d&&(u+=r?d:-d),d=0,u+=(a.data.dummy?e:t)/2,u+=(s.data.dummy?e:t)/2,u+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":d=s.data.width/2;break;case"r":d=-s.data.width/2}return d&&(u+=r?d:-d),d=0,u}},He=function(t,e){return t.getNode(e).data.width||0},Ke=function(t,e){var r,n=Ht(t);!function(t,e){var r=(e||{}).ranksep,n=void 0===r?0:r,o=Yt(t),i=0;null==o||o.forEach((function(e){var r=e.map((function(e){return t.getNode(e).data.height})),o=Math.max.apply(Math,u(u([],s(r)),[0]));null==e||e.forEach((function(e){t.getNode(e).data.y=i+o/2})),i+=o+n}))}(n,e);var o=function(t,e){var r=e||{},n=r.align,o=r.nodesep,i=void 0===o?0:o,a=r.edgesep,d=void 0===a?0:a,h=Yt(t),c=Object.assign(function(t,e){var r={};return(null==e?void 0:e.length)&&e.reduce((function(e,n){var o=0,i=0,a=e.length,s=null==n?void 0:n[(null==n?void 0:n.length)-1];return null==n||n.forEach((function(e,u){var d,h=Ge(t,e),c=h?t.getNode(h.id).data.order:a;(h||e===s)&&(null===(d=n.slice(i,u+1))||void 0===d||d.forEach((function(e){var n;null===(n=t.getPredecessors(e))||void 0===n||n.forEach((function(n){var i,a=t.getNode(n.id),s=a.data.order;!(s<o||c<s)||a.data.dummy&&(null===(i=t.getNode(e))||void 0===i?void 0:i.data.dummy)||We(r,n.id,e)}))})),i=u+1,o=c)})),n})),r}(t,h),Ve(t,h)),l={},f=[];["u","d"].forEach((function(e){f="u"===e?h:Object.values(h).reverse(),["l","r"].forEach((function(r){"r"===r&&(f=f.map((function(t){return Object.values(t).reverse()})));var n=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),o=function(t,e,r,n){var o={},i={},a={};return null==e||e.forEach((function(t){null==t||t.forEach((function(t,e){o[t]=t,i[t]=t,a[t]=e}))})),null==e||e.forEach((function(t){var e=-1;null==t||t.forEach((function(t){var s=n(t).map((function(t){return t.id}));if(s.length){s=s.sort((function(t,e){return a[t]-a[e]}));for(var u=(s.length-1)/2,d=Math.floor(u),h=Math.ceil(u);d<=h;++d){var c=s[d];i[t]===t&&e<a[c]&&!Be(r,t,c)&&(i[c]=t,i[t]=o[t]=o[c],e=a[c])}}}))})),{root:o,align:i}}(0,f,c,n),a=function(t,e,r,n,o,i,a){var s,u={},d=$e(t,e,r,o,i,a),h=a?"borderLeft":"borderRight",c=function(t,e){for(var r=d.getAllNodes(),n=r.pop(),o={};n;)o[n.id]?t(n.id):(o[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return c((function(t){u[t]=(d.getRelatedEdges(t,"in")||[]).reduce((function(t,e){return Math.max(t,(u[e.source]||0)+e.data.weight)}),0)}),d.getPredecessors.bind(d)),c((function(e){var r=(d.getRelatedEdges(e,"out")||[]).reduce((function(t,e){return Math.min(t,(u[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==h&&(u[e]=Math.max(u[e],r))}),d.getSuccessors.bind(d)),null===(s=Object.values(n))||void 0===s||s.forEach((function(t){u[t]=u[r[t]]})),u}(t,f,o.root,o.align,i,d,"r"===r);"r"===r&&Object.keys(a).forEach((function(t){return a[t]=-a[t]})),l[e+r]=a}))}));var g=function(t,e){return Qt(Object.values(e),(function(e){var r,n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach((function(r){var i=e[r],a=He(t,r)/2;n=Math.max(i+a,n),o=Math.min(i-a,o)})),n-o}))}(t,l);return g&&function(t,e){var r=Object.values(e),n=Math.min.apply(Math,u([],s(r))),o=Math.max.apply(Math,u([],s(r)));["u","d"].forEach((function(r){["l","r"].forEach((function(i){var a,d=r+i,h=t[d];if(h!==e){var c=Object.values(h);(a="l"===i?n-Math.min.apply(Math,u([],s(c))):o-Math.max.apply(Math,u([],s(c))))&&(t[d]={},Object.keys(h).forEach((function(e){t[d][e]=h[e]+a})))}}))}))}(l,g),function(t,e){var r={};return Object.keys(t.ul).forEach((function(n){if(e)r[n]=t[e.toLowerCase()][n];else{var o=Object.values(t).map((function(t){return t[n]}));r[n]=(o[0]+o[1])/2}})),r}(l,n)}(n,e);null===(r=Object.keys(o))||void 0===r||r.forEach((function(t){n.getNode(t).data.x=o[t]}))},Ye=function(t,e){var r=e.acyclicer,o=e.ranker,i=e.rankdir,a=void 0===i?"tb":i,d=e.nodeOrder,h=e.keepNodeOrder,c=e.align,f=e.nodesep,g=void 0===f?50:f,p=e.edgesep,v=void 0===p?20:p,y=e.ranksep,m=void 0===y?50:y;dr(t),Bt(t,r);var w=function(t){var e=Ut(t,"root",{},"_root"),r=function(t){var e={},r=function(n,o){var i=t.getChildren(n);null==i||i.forEach((function(t){return r(t.id,o+1)})),e[n]=o};return t.getRoots().forEach((function(t){return r(t.id,1)})),e}(t),n=Math.max.apply(Math,u([],s(Object.values(r))));Math.abs(n)===1/0&&(n=1);var o=n-1,i=2*o+1;t.getAllEdges().forEach((function(t){t.data.minlen*=i}));var a=function(t){var e=0;return t.getAllEdges().forEach((function(t){e+=t.data.weight})),e}(t)+1;return t.getRoots().forEach((function(n){Ee(t,e,i,a,o,r,n.id)})),{nestingRoot:e,nodeRankFactor:i}}(t),x=w.nestingRoot,E=w.nodeRankFactor;!function(t,e){switch(e){case"network-simplex":xe(t);break;case"tight-tree":default:!function(t){!function(t){var e,r={},n=function(o){var i,a,s=t.getNode(o);return s?r[o]?s.data.rank:(r[o]=!0,null===(i=t.getRelatedEdges(o,"out"))||void 0===i||i.forEach((function(t){var e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),(void 0===e||a<e)&&(e=a),s.data.rank=a,a):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){t&&n(t.id)})),void 0===e&&(e=0);var o={},i=function(e,r){var n,a=t.getNode(e),s=isNaN(a.data.layer)?r:a.data.layer;(void 0===a.data.rank||a.data.rank<s)&&(a.data.rank=s),o[e]||(o[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach((function(t){i(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((function(t){var r=t.data;r&&(isNaN(r.layer)?r.rank-=e:i(t.id,r.layer))}))}(t),function(t){var e,r,n=new l({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);ie(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r)}(t)}(t);break;case"longest-path":we(t)}}(Ht(t),o),er(t),function(t,e){void 0===e&&(e=0);var r=t.getAllNodes(),n=r.filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),o=Math.min.apply(Math,u([],s(n))),i=[];r.forEach((function(t){var e=(t.data.rank||0)-o;i[e]||(i[e]=[]),i[e].push(t.id)}));for(var a=0,d=0;d<i.length;d++){var h=i[d];void 0===h?d%e!=0&&(a-=1):a&&(null==h||h.forEach((function(e){var r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=a)})))}}(t,E),function(t,e){e&&t.removeNode(e),t.getAllEdges().forEach((function(e){e.data.nestingEdge&&t.removeEdge(e.id)}))}(t,x),function(t){var e=t.getAllNodes().filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),r=Math.min.apply(Math,u([],s(e)));t.getAllNodes().forEach((function(t){t.data.hasOwnProperty("rank")&&r!==1/0&&(t.data.rank-=r)}))}(t),rr(t),nr(t);var b=[];!function(t,e){t.getAllEdges().forEach((function(r){return function(t,e,r){var n=e.source,o=t.getNode(n).data.rank,i=e.target,a=t.getNode(i).data.rank,s=e.data.labelRank;if(a!==o+1){var u,d,h;for(t.removeEdge(e.id),h=0,++o;o<a;++h,++o)e.data.points=[],u=Ut(t,"edge",d={originalEdge:e,width:0,height:0,rank:o},"_d"),o===s&&(d.width=e.data.width,d.height=e.data.height,d.dummy=ee,d.labelpos=e.data.labelpos),t.addEdge({id:"e"+Math.random(),source:n,target:u,data:{weight:e.data.weight}}),0===h&&r.push(u),n=u;t.addEdge({id:"e"+Math.random(),source:n,target:i,data:{weight:e.data.weight}})}}(t,r,e)}))}(t,b),function(t,e){var r=function(t){var e={},r=0,n=function(o){var i=r;t.getChildren(o).forEach((function(t){return n(t.id)})),e[o]={low:i,lim:r++}};return t.getRoots().forEach((function(t){return n(t.id)})),e}(t);e.forEach((function(e){var n,o,i=e,a=t.getNode(i),s=a.data.originalEdge;if(s)for(var u=function(t,e,r,n){var o,i,a,s,u=[],d=[],h=Math.min(e[r].low,e[n].low),c=Math.max(e[r].lim,e[n].lim);a=r;do{a=null===(o=t.getParent(a))||void 0===o?void 0:o.id,u.push(a)}while(a&&(e[a].low>h||c>e[a].lim));for(s=a,a=n;a&&a!==s;)d.push(a),a=null===(i=t.getParent(a))||void 0===i?void 0:i.id;return{lca:s,path:u.concat(d.reverse())}}(t,r,s.source,s.target),d=u.path,h=u.lca,c=0,l=d[c],f=!0;i!==s.target;){if(a=t.getNode(i),f){for(;l!==h&&(null===(n=t.getNode(l))||void 0===n?void 0:n.data.maxRank)<a.data.rank;)l=d[++c];l===h&&(f=!1)}if(!f){for(;c<d.length-1&&(null===(o=t.getNode(d[c+1]))||void 0===o?void 0:o.data.minRank)<=a.data.rank;)c++;l=d[c]}t.hasNode(l)&&t.setParent(i,l),i=t.getSuccessors(i)[0].id}}))}(t,b),function(t){var e=function(r){var n=t.getChildren(r),o=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach((function(t){return e(t.id)})),o.data.hasOwnProperty("minRank")){o.data.borderLeft=[],o.data.borderRight=[];for(var i=o.data.minRank,a=o.data.maxRank+1;i<a;i+=1)be(t,"borderLeft","_bl",r,o,i),be(t,"borderRight","_br",r,o,i)}};t.getRoots().forEach((function(t){return e(t.id)}))}(t),h&&function(t,e){for(var r=t.getAllNodes().filter((function(e){var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)})).map((function(t){return t.data.rank})),n=Math.max.apply(Math,u([],s(r))),o=[],i=0;i<n+1;i++)o[i]=[];null==e||e.forEach((function(e){var r=t.getNode(e);r&&!r.data.dummy&&(isNaN(r.data.rank)||(r.data.fixorder=o[r.data.rank].length,o[r.data.rank].push(e)))}))}(t,d),function(t,e){for(var r=Xt(t),n=[],o=[],i=1;i<r+1;i++)n.push(i);for(i=r-1;i>-1;i--)o.push(i);var a=qe(t,n,"in"),s=qe(t,o,"out"),u=Ae(t);Fe(t,u);for(var d,h=Number.POSITIVE_INFINITY,c=(i=0,0);c<4;++i,++c)je(i%2?a:s,i%4>=2,!1,e),u=Yt(t),(l=Ie(t,u))<h&&(c=0,d=Le(u),h=l);for(u=Ae(t),Fe(t,u),i=0,c=0;c<4;++i,++c){var l;je(i%2?a:s,i%4>=2,!0,e),u=Yt(t),(l=Ie(t,u))<h&&(c=0,d=Le(u),h=l)}Fe(t,d)}(t,h),hr(t),function(t,e){var r=e.toLowerCase();"lr"!==r&&"rl"!==r||Ne(t)}(t,a),Ke(t,{align:c,nodesep:g,edgesep:v,ranksep:m}),cr(t),ur(t),function(t,e){e.forEach((function(e){var r,n=t.getNode(e),o=n.data.originalEdge;o&&t.addEdge(o);for(var i=e;n.data.dummy;)r=t.getSuccessors(i)[0],t.removeNode(i),o.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===ee&&(o.data.x=n.data.x,o.data.y=n.data.y,o.data.width=n.data.width,o.data.height=n.data.height),i=r.id,n=t.getNode(i)}))}(t,b),ar(t),function(t,e){var r=e.toLowerCase();"bt"!==r&&"rl"!==r||function(t){t.getAllNodes().forEach((function(t){Se(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return Se(t)})),t.data.hasOwnProperty("y")&&Se(t.data)}))}(t),"lr"!==r&&"rl"!==r||(function(t){t.getAllNodes().forEach((function(t){ke(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return ke(t)})),t.data.hasOwnProperty("x")&&ke(t.data)}))}(t),Ne(t))}(t,a);var N=or(t),M=N.width,S=N.height;return ir(t),sr(t),function(t){t.getAllEdges().forEach((function(e){var r=e.data;if(r.reversed){t.removeEdge(e.id);var o=r.forwardName;delete r.reversed,delete r.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:n(n({},r),{forwardName:o})})}}))}(t),{width:M,height:S}},Je=["width","height","layer","fixorder"],Xe={width:0,height:0},Qe=["minlen","weight","width","height","labeloffset"],Ze={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},tr=["labelpos"],er=function(t){t.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var r=t.getNode(e.source),n={e,rank:(t.getNode(e.target).data.rank-r.data.rank)/2+r.data.rank};Ut(t,"edge-proxy",n,"_ep")}}))},rr=function(t){var e=0;return t.getAllNodes().forEach((function(r){var n,o;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(o=t.getNode(r.data.borderBottom))||void 0===o?void 0:o.data.rank,e=Math.max(e,r.data.maxRank||-1/0))})),e},nr=function(t){t.getAllNodes().forEach((function(e){"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},or=function(t,e){var r,n,o=0,i=0,a=e||{},s=a.marginx,u=void 0===s?0:s,d=a.marginy,h=void 0===d?0:d,c=function(t){if(t.data){var e=t.data.x,a=t.data.y,s=t.data.width,u=t.data.height;isNaN(e)||isNaN(s)||(void 0===r&&(r=e-s/2),r=Math.min(r,e-s/2),o=Math.max(o,e+s/2)),isNaN(a)||isNaN(u)||(void 0===n&&(n=a-u/2),n=Math.min(n,a-u/2),i=Math.max(i,a+u/2))}};return t.getAllNodes().forEach((function(t){c(t)})),t.getAllEdges().forEach((function(t){(null==t?void 0:t.data.hasOwnProperty("x"))&&c(t)})),r-=u,n-=h,t.getAllNodes().forEach((function(t){t.data.x-=r,t.data.y-=n})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){t.x-=r,t.y-=n})),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)})),{width:o-r+u,height:i-n+h}},ir=function(t){t.getAllEdges().forEach((function(e){var r,n,o=t.getNode(e.source),i=t.getNode(e.target);e.data.points?(r=e.data.points[0],n=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:i.data.x,y:i.data.y},n={x:o.data.x,y:o.data.y}),e.data.points.unshift(Kt(o.data,r)),e.data.points.push(Kt(i.data,n))}))},ar=function(t){t.getAllEdges().forEach((function(t){if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},sr=function(t){t.getAllEdges().forEach((function(t){var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},ur=function(t){t.getAllNodes().forEach((function(e){var r,n,o;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){var i=t.getNode(e.id),a=t.getNode(i.data.borderTop),s=t.getNode(i.data.borderBottom),u=t.getNode(i.data.borderLeft[(null===(n=i.data.borderLeft)||void 0===n?void 0:n.length)-1]),d=t.getNode(i.data.borderRight[(null===(o=i.data.borderRight)||void 0===o?void 0:o.length)-1]);i.data.width=Math.abs((null==d?void 0:d.data.x)-(null==u?void 0:u.data.x))||10,i.data.height=Math.abs((null==s?void 0:s.data.y)-(null==a?void 0:a.data.y))||10,i.data.x=((null==u?void 0:u.data.x)||0)+i.data.width/2,i.data.y=((null==a?void 0:a.data.y)||0)+i.data.height/2}})),t.getAllNodes().forEach((function(e){"border"===e.data.dummy&&t.removeNode(e.id)}))},dr=function(t){t.getAllEdges().forEach((function(e){if(e.source===e.target){var r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}}))},hr=function(t){var e=Yt(t);null==e||e.forEach((function(e){var r=0;null==e||e.forEach((function(e,n){var o,i=t.getNode(e);i.data.order=n+r,null===(o=i.data.selfEdges)||void 0===o||o.forEach((function(e){Ut(t,"selfedge",{width:e.data.width,height:e.data.height,rank:i.data.rank,order:n+ ++r,e},"_se")})),delete i.data.selfEdges}))}))},cr=function(t){t.getAllNodes().forEach((function(e){var r=t.getNode(e.id);if("selfedge"===r.data.dummy){var n=t.getNode(r.data.e.source),o=n.data.x+n.data.width/2,i=n.data.y,a=r.data.x-o,s=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}}))},lr=function(t,e){var r={};return null==e||e.forEach((function(e){void 0!==t[e]&&(r[e]=+t[e])})),r},fr=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(r){e[r.toLowerCase()]=t[r]})),e},gr={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="dagre",this.layoutNode=function(t){return t.data.layout},this.options=n(n({},gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericDagreLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericDagreLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericDagreLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,E,N,M,k,R,I,_,D,O,P,T,z,C,L,q,j,F,V,G,W=this;return a(this,(function(a){return o=n(n({},this.options),r),i=o.nodeSize,s=o.align,u=o.rankdir,d=void 0===u?"TB":u,h=o.ranksep,c=o.nodesep,f=o.ranksepFunc,g=o.nodesepFunc,p=o.edgeLabelSpace,v=o.nodeOrder,y=o.begin,m=o.controlPoints,w=o.radial,E=new l({tree:[]}),N=S(h||50,f),M=S(c||50,g),k=M,R=N,"LR"!==d&&"RL"!==d||(k=N,R=M),I=A(i,void 0),_=e.getAllNodes(),D=e.getAllEdges(),_.filter((function(t){return t.data.layout})).forEach((function(t){var e=I(t),r=R(t),n=e+2*k(t),o=e+2*r,i=t.data.layer;x(i)?E.addNode({id:t.id,data:{width:n,height:o,layer:i}}):E.addNode({id:t.id,data:{width:n,height:o}})})),D.forEach((function(t){W.layoutNode(E.getNode(t.source))&&W.layoutNode(E.getNode(t.target))&&E.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),function(t,e){var r,o,i=e.edgeLabelSpace,a=e.keepNodeOrder,s=e.prevGraph,u=e.rankdir,d=e.ranksep;!a&&s&&(o=s,(r=t).getAllNodes().forEach((function(t){var e=r.getNode(t.id),n=o.getNode(t.id);void 0!==n?(e.data.fixorder=n.data._order,delete n.data._order):delete e.data.fixorder})));var h=function(t){var e=new l({tree:[]});return t.getAllNodes().forEach((function(r){var o=fr(t.getNode(r.id).data),i=n(n({},Xe),o),a=lr(i,Je);e.hasNode(r.id)||e.addNode({id:r.id,data:n({},a)});var s=t.getParent(r.id);null==s||(e.hasNode(s.id)||e.addNode(n({},s)),e.setParent(r.id,s.id))})),t.getAllEdges().forEach((function(r){var n=fr(t.getEdge(r.id).data),o={};null==tr||tr.forEach((function(t){void 0!==n[t]&&(o[t]=n[t])})),e.addEdge({id:r.id,source:r.source,target:r.target,data:Object.assign({},Ze,lr(n,Qe),o)})})),e}(t);i&&(e.ranksep=function(t,e){var r=e.ranksep,n=void 0===r?0:r,o=e.rankdir;return t.getAllNodes().forEach((function(t){isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((function(t){var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===o||"BT"===o?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2}(h,{rankdir:u,ranksep:d}));try{Ye(h,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph\'s structure:\\n",t);throw t}!function(t,e){t.getAllNodes().forEach((function(r){var n,o=t.getNode(r.id);if(o){var i=e.getNode(r.id);o.data.x=i.data.x,o.data.y=i.data.y,o.data._order=i.data.order,o.data._rank=i.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(o.data.width=i.data.width,o.data.height=i.data.height)}})),t.getAllEdges().forEach((function(r){var n=t.getEdge(r.id),o=e.getEdge(r.id);n.data.points=o?o.data.points:[],o&&o.data.hasOwnProperty("x")&&(n.data.x=o.data.x,n.data.y=o.data.y)}))}(t,h)}(E,{prevGraph:null,edgeLabelSpace:p,keepNodeOrder:!!v,nodeOrder:v||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:d,nodesep:c,align:s}),O=[0,0],y&&(P=1/0,T=1/0,E.getAllNodes().forEach((function(t){P>t.data.x&&(P=t.data.x),T>t.data.y&&(T=t.data.y)})),E.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){P>t.x&&(P=t.x),T>t.y&&(T=t.y)}))})),O[0]=y[0]-P,O[1]=y[1]-T),z="LR"===d||"RL"===d,w||(C=new Set,L="BT"===d||"RL"===d?function(t,e){return e-t}:function(t,e){return t-e},E.getAllNodes().forEach((function(t){t.data.x=t.data.x+O[0],t.data.y=t.data.y+O[1],C.add(z?t.data.x:t.data.y)})),q=Array.from(C).sort(L),j=z?function(t,e){return t.x!==e.x}:function(t,e){return t.y!==e.y},F=z?function(t,e,r){var n=Math.max(e.y,r.y),o=Math.min(e.y,r.y);return t.filter((function(t){return t.y<=n&&t.y>=o}))}:function(t,e,r){var n=Math.max(e.x,r.x),o=Math.min(e.x,r.x);return t.filter((function(t){return t.x<=n&&t.x>=o}))},E.getAllEdges().forEach((function(t,e){var r;p&&m&&"loop"!==t.data.type&&(t.data.controlPoints=vr(null===(r=t.data.points)||void 0===r?void 0:r.map((function(t){var e=t.x,r=t.y;return{x:e+O[0],y:r+O[1]}})),E.getNode(t.source),E.getNode(t.target),q,z,j,F))}))),V=[],V=E.getAllNodes().map((function(t){return b(t)})),G=E.getAllEdges(),t&&(V.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),G.forEach((function(t){e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),[2,{nodes:V,edges:G}]}))}))},t}(),vr=function(t,e,r,n,o,i,a){var s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){var u=e.data,d=u.x,h=u.y,c=r.data,l=c.x,f=c.y;if(o&&(d=e.data.y,h=e.data.x,l=r.data.y,f=r.data.x),f!==h&&d!==l){var g=n.indexOf(h),p=n[g+1];if(p){var v=s[0],y=o?{x:(h+p)/2,y:(null==v?void 0:v.y)||l}:{x:(null==v?void 0:v.x)||l,y:(h+p)/2};v&&!i(v,y)||s.unshift(y)}var m=n.indexOf(f),w=Math.abs(m-g);if(1===w)(s=a(s,e.data,r.data)).length||s.push(o?{x:(h+f)/2,y:d}:{x:d,y:(h+f)/2});else if(w>1){var x=n[m-1];if(x){var E=s[s.length-1],b=o?{x:(f+x)/2,y:(null==E?void 0:E.y)||l}:{x:(null==E?void 0:E.x)||d,y:(f+x)/2};E&&!i(E,b)||s.push(b)}}}}return s};function yr(t){var e=0,r=0,n=0;if(t.length){for(var o=0;o<4;o++)(i=t[o])&&i.weight&&(e+=i.weight,r+=i.x*i.weight,n+=i.y*i.weight);t.x=r/e,t.y=n/e,t.weight=e}else{var i=t;t.x=i.data.x,t.y=i.data.y,t.weight=i.data.weight}}var mr=function(t,e,r,n,o,i){var a=i.x-t.x||.1,s=i.y-t.y||.1,u=n-e,d=a*a+s*s,h=Math.sqrt(d)*d;if(u*u*.81<d){var c=t.weight/h;return i.vx+=a*c,i.vy+=s*c,!0}if(t.length)return!1;t.data!==i&&(c=t.data.weight/h,i.vx+=a*c,i.vy+=s*c)},wr={maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},xr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=n(n({},wr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,E,b,N,M,S,k=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=this.formatOptions(o,e),d=u.width,h=u.height,c=u.nodeSize,f=u.getMass,g=u.nodeStrength,p=u.edgeStrength,v=u.linkDistance,y=i.map((function(t){return n(n({},t),{data:n(n({},t.data),{x:x(t.data.x)?t.data.x:Math.random()*d,y:x(t.data.y)?t.data.y:Math.random()*h,size:c(t)||30,mass:f(t),nodeStrength:g(t)})})})),m=s.map((function(t){return n(n({},t),{data:n(n({},t.data),{edgeStrength:p(t),linkDistance:v(t,e.getNode(t.source),e.getNode(t.target))})})})),(null==i?void 0:i.length)?(w={},i.forEach((function(t,e){w[t.id]={x:0,y:0}})),E=new l({nodes:y,edges:m}),this.formatCentripetal(u,E),b=u.maxIteration,N=u.minMovement,M=u.onTick,this.lastLayoutNodes=y,this.lastLayoutEdges=m,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=E,this.lastOptions=u,this.lastVelMap=w,"undefined"==typeof window?[2]:(S=0,[2,new Promise((function(r){k.timeInterval=window.setInterval((function(){i&&k.running||r({nodes:Sr(e,y),edges:s}),k.runOneStep(E,e,S,w,u),k.updatePosition(e,E,w,u),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),null==M||M({nodes:Sr(e,y),edges:s}),(++S>=b||k.judgingDistance<N)&&(window.clearInterval(k.timeInterval),r({nodes:Sr(e,y),edges:s}))}),0),k.running=!0}))])):(this.lastResult={nodes:[],edges:s},[2,{nodes:[],edges:s}])}))}))},t.prototype.formatOptions=function(t,e){var r=t,n=t.width,o=t.height,i=t.getMass;if(r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=o||"undefined"==typeof window?o:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),i||(r.getMass=function(t){var r=1;x(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);var n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),t.preventOverlap){var a=S(0,t.nodeSpacing);t.nodeSize?g(t.nodeSize)?r.nodeSize=function(e){var r=t.nodeSize;return Math.max(r[0],r[1])+a(e)}:r.nodeSize=function(e){return t.nodeSize+a(e)}:r.nodeSize=function(t){var e=((null==t?void 0:t.data)||{}).size;return e?g(e)?Math.max(e[0],e[1])+a(t):M(e)?Math.max(e.width,e.height)+a(t):e+a(t):10+a(t)}}return r.linkDistance=t.linkDistance?S(1,t.linkDistance):function(t){return 1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target))},r.nodeStrength=S(1,t.nodeStrength),r.edgeStrength=S(1,t.edgeStrength),t},t.prototype.formatCentripetal=function(t,e){var r,n=t.centripetalOptions,o=t.center,i=t.clusterNodeStrength,a=t.leafCluster,s=t.clustering,u=t.nodeClusterBy,d=e.getAllNodes(),h=n||{leaf:2,single:2,others:1,center:function(t){return{x:o[0],y:o[1]}}};"function"!=typeof i&&(t.clusterNodeStrength=function(t){return i});var c=[];if(a&&u&&(r=Er(e,u),c=Array.from(new Set(null==d?void 0:d.map((function(t){return t.data[u]}))))||[],t.centripetalOptions=Object.assign(h,{single:100,leaf:function(e){var n=r[e.id]||{},o=n.siblingLeaves,i=n.sameTypeLeaves;return(null==i?void 0:i.length)===(null==o?void 0:o.length)||1===(null==c?void 0:c.length)?1:t.clusterNodeStrength(e)},others:1,center:function(t){var n,o=e.getDegree(t.id,"both");if(!o)return{x:100,y:100};if(1===o){var i=(r[t.id]||{}).sameTypeLeaves,a=void 0===i?[]:i;1===a.length?n=void 0:a.length>1&&(n=Mr(a))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y}}})),s&&u){r||(r=Er(e,u)),c||(c=Array.from(new Set(d.map((function(t){return t.data[u]}))))),c=c.filter((function(t){return void 0!==t}));var l={};c.forEach((function(t){var r=d.filter((function(e){return e.data[u]===t})).map((function(t){return e.getNode(t.id)}));l[t]=Mr(r)})),t.centripetalOptions=Object.assign(h,{single:function(e){return t.clusterNodeStrength(e)},leaf:function(e){return t.clusterNodeStrength(e)},others:function(e){return t.clusterNodeStrength(e)},center:function(t){var e=l[t.data[u]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y}}})}var f=t.centripetalOptions||{},g=f.leaf,p=f.single,v=f.others;g&&"function"!=typeof g&&(t.centripetalOptions.leaf=function(){return g}),p&&"function"!=typeof p&&(t.centripetalOptions.single=function(){return p}),v&&"function"!=typeof v&&(t.centripetalOptions.others=function(){return v})},t.prototype.runOneStep=function(t,e,r,n,o){var i={},a=t.getAllNodes(),s=t.getAllEdges();if(null==a?void 0:a.length){var u=o.monitor;this.calRepulsive(t,i,o),s&&this.calAttractive(t,i),this.calGravity(t,e,i,o),this.updateVelocity(t,i,n,o),u&&u({energy:this.calTotalEnergy(i,a),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}},t.prototype.calTotalEnergy=function(t,e){if(!(null==e?void 0:e.length))return 0;var r=0;return e.forEach((function(e,n){var o=t[e.id].x,i=t[e.id].y,a=o*o+i*i,s=e.data.mass;r+=(void 0===s?1:s)*a*.5})),r},t.prototype.calRepulsive=function(t,e,r){var n=r.factor,o=r.coulombDisScale;!function(t,e,r,n){var o=e/r,i=t.getAllNodes(),a=i.map((function(t,e){var r=t.data,n=r.nodeStrength;return{x:r.x,y:r.y,size:r.size,index:e,vx:0,vy:0,weight:o*n}})),s=F(a,(function(t){return t.x}),(function(t){return t.y})).visitAfter(yr);a.forEach((function(t){!function(t,e){e.visit((function(e,r,n,o,i){return mr(e,r,n,o,i,t)}))}(t,s)})),a.map((function(t,e){var r=i[e],o=r.id,a=r.data.mass,s=void 0===a?1:a;n[o]={x:t.vx/s,y:t.vy/s}}))}(t,n,o*o,e)},t.prototype.calAttractive=function(t,e){t.getAllEdges().forEach((function(r,n){var o=r.source,i=r.target,a=t.getNode(o),s=t.getNode(i);if(a&&s){var u=s.data.x-a.data.x,d=s.data.y-a.data.y;u||d||(u=.01*Math.random(),d=.01*Math.random());var h=Math.sqrt(u*u+d*d),c=u/h,l=d/h,f=r.data||{},g=f.linkDistance,p=void 0===g?200:g,v=f.edgeStrength,y=(p-h)*(void 0===v?200:v),m=1/(a.data.mass||1),w=1/(s.data.mass||1),x=c*y,E=l*y;e[o].x-=x*m,e[o].y-=E*m,e[i].x+=x*w,e[i].y+=E*w}}))},t.prototype.calGravity=function(t,e,r,n){var o=n.getCenter,i=t.getAllNodes(),a=e.getAllNodes(),u=e.getAllEdges(),d=n.width,h=n.height,c=n.center,l=n.gravity,f=n.centripetalOptions;i&&i.forEach((function(n){var i=n.id,g=n.data,p=g.mass,v=g.x,y=g.y,m=e.getNode(i),w=0,E=0,b=l,N=t.getDegree(i,"in"),M=t.getDegree(i,"out"),S=t.getDegree(i,"both"),k=null==o?void 0:o(m,S);if(k){var A=s(k,3);w=v-A[0],E=y-A[1],b=A[2]}else w=v-c[0],E=y-c[1];if(b&&(r[i].x-=b*w/p,r[i].y-=b*E/p),f){var R=f.leaf,I=f.single,_=f.others,D=f.center,O=(null==D?void 0:D(m,a,u,d,h))||{x:0,y:0,centerStrength:0},P=O.x,T=O.y,z=O.centerStrength;if(!x(P)||!x(T))return;var C=(v-P)/p,L=(y-T)/p;if(z&&(r[i].x-=z*C,r[i].y-=z*L),0===S){var q=I(m);if(!q)return;return r[i].x-=q*C,void(r[i].y-=q*L)}if(0===N||0===M){var j=R(m,a,u);if(!j)return;return r[i].x-=j*C,void(r[i].y-=j*L)}var F=_(m);if(!F)return;r[i].x-=F*C,r[i].y-=F*L}}))},t.prototype.updateVelocity=function(t,e,r,n){var o=n.damping,i=n.maxSpeed,a=n.interval,s=t.getAllNodes();(null==s?void 0:s.length)&&s.forEach((function(t){var n=t.id,s=(r[n].x+e[n].x*a)*o||.01,u=(r[n].y+e[n].y*a)*o||.01,d=Math.sqrt(s*s+u*u);if(d>i){var h=i/d;s*=h,u*=h}r[n]={x:s,y:u}}))},t.prototype.updatePosition=function(t,e,r,n){var o=this,i=n.distanceThresholdMode,a=n.interval,s=e.getAllNodes();if(null==s?void 0:s.length){var u=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),s.forEach((function(n){var s=n.id,d=t.getNode(s);if(x(d.data.fx)&&x(d.data.fy))e.mergeNodeData(s,{x:d.data.fx,y:d.data.fy});else{var h=r[s].x*a,c=r[s].y*a;e.mergeNodeData(s,{x:n.data.x+h,y:n.data.y+c});var l=Math.sqrt(h*h+c*c);switch(i){case"max":o.judgingDistance<l&&(o.judgingDistance=l);break;case"min":o.judgingDistance>l&&(o.judgingDistance=l);break;default:u+=l}}})),i&&"mean"!==i||(this.judgingDistance=u/s.length)}else this.judgingDistance=0},t}(),Er=function(t,e){var r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};var n={};return r.forEach((function(r,o){1===t.getDegree(r.id,"both")&&(n[r.id]=br(t,"leaf",r,e))})),n},br=function(t,e,r,n){var o=t.getDegree(r.id,"in"),i=t.getDegree(r.id,"out"),a=r,s=[];return 0===o?(a=t.getSuccessors(r.id)[0],s=t.getNeighbors(a.id)):0===i&&(a=t.getPredecessors(r.id)[0],s=t.getNeighbors(a.id)),s=s.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")})),{coreNode:a,siblingLeaves:s,sameTypeLeaves:Nr(t,e,n,r,s)}},Nr=function(t,e,r,n,o){var i=n.data[r]||"",a=(null==o?void 0:o.filter((function(t){return t.data[r]===i})))||[];return"leaf"===e&&(a=a.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")}))),a},Mr=function(t){var e={x:0,y:0};t.forEach((function(t){var r=t.data,n=r.x,o=r.y;e.x+=n||0,e.y+=o||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},Sr=function(t,e){return e.map((function(e){var r=e.id,o=e.data,i=t.getNode(r);return n(n({},i),{data:n(n({},i.data),{x:o.x,y:o.y})})}))},kr=function(){function t(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}return t.prototype.distanceTo=function(t){var e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)},t.prototype.setPos=function(t,e){this.rx=t,this.ry=e},t.prototype.resetForce=function(){this.fx=0,this.fy=0},t.prototype.addForce=function(t){var e=t.rx-this.rx,r=t.ry-this.ry,n=Math.hypot(e,r);n=n<1e-4?1e-4:n;var o=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=o*e/n,this.fy+=o*r/n},t.prototype.in=function(t){return t.contains(this.rx,this.ry)},t.prototype.add=function(e){var r=this.mass+e.mass;return new t({rx:(this.rx*this.mass+e.rx*e.mass)/r,ry:(this.ry*this.mass+e.ry*e.mass)/r,mass:r,degree:this.degree+e.degree})},t}();const Ar=kr;const Rr=function(){function t(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}return t.prototype.getLength=function(){return this.length},t.prototype.contains=function(t,e){var r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r},t.prototype.NW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.NE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.SW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t.prototype.SE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t}(),Ir=function(){function t(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}return t.prototype.insert=function(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e},t.prototype._putBody=function(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))},t.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},t.prototype.updateForce=function(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))},t}();var _r={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Dr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2",this.options=n(n({},_r),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,x,E,N,M,S,k,A,I;return a(this,(function(a){if(o=e.getAllEdges(),i=e.getAllNodes(),s=this.formatOptions(r,i.length),u=s.width,d=s.height,h=s.prune,c=s.maxIteration,f=s.nodeSize,g=s.center,!(null==i?void 0:i.length)||1===i.length)return[2,R(e,t,g)];if(p=i.map((function(t){return b(t,[u,d])})),v=o.filter((function(t){return t.source!==t.target})),y=new l({nodes:p,edges:v}),m=this.getSizes(y,e,f),this.run(y,e,c,m,t,s),h){for(w=0;w<v.length;w+=1)x=v[w],E=x.source,N=x.target,M=y.getDegree(E),S=y.getDegree(E),M<=1?(k=y.getNode(N),y.mergeNodeData(E,{x:k.data.x,y:k.data.y})):S<=1&&(A=y.getNode(E),y.mergeNodeData(N,{x:A.data.x,y:A.data.y}));I=n(n({},s),{prune:!1,barnesHut:!1}),this.run(y,e,100,m,t,I)}return[2,{nodes:p,edges:o}]}))}))},t.prototype.getSizes=function(t,e,r){for(var n=t.getAllNodes(),o={},i=0;i<n.length;i+=1){var a=n[i],d=a.id,h=a.data;if(o[d]=10,x(h.size))o[d]=h.size;else if(g(h.size))isNaN(h.size[0])||(o[d]=Math.max(h.size[0])),isNaN(h.size[1])||(o[d]=Math.max(h.size[1]));else if(M(h.size))o[d]=Math.max(h.size.width,h.size.height);else if(N(r)){var c=r(e.getNode(d));g(c)?o[d]=Math.max.apply(Math,u([],s(c))):o[d]=c}else g(r)?o[d]=Math.max.apply(Math,u([],s(r))):x(r)&&(o[d]=r)}return o},t.prototype.formatOptions=function(t,e){void 0===t&&(t={});var r=n(n({},this.options),t),o=r.center,i=r.width,a=r.height,s=r.barnesHut,u=r.prune,d=r.maxIteration,h=r.kr,c=r.kg;return r.width=i||"undefined"==typeof window?i:window.innerWidth,r.height=a||"undefined"==typeof window?a:window.innerHeight,r.center=o||[r.width/2,r.height/2],void 0===s&&e>250&&(r.barnesHut=!0),void 0===u&&e>100&&(r.prune=!0),0!==d||u?0===d&&u&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)):(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)),h||(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),c||(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r},t.prototype.run=function(t,e,r,n,o,i){for(var a=i.kr,s=i.barnesHut,u=i.onTick,d=t.getAllNodes(),h=0,c=r,l={},f={},g={},p=0;p<d.length;p+=1){var v=d[p],y=v.data,m=v.id;if(l[m]=[0,0],s){var w={id:p,rx:y.x,ry:y.y,mass:1,g:a,degree:t.getDegree(m)};g[m]=new Ar(w)}}for(;c>0;)h=this.oneStep(t,{iter:c,preventOverlapIters:50,krPrime:100,sg:h,forces:l,preForces:f,bodies:g,sizes:n},i),c--,null==u||u({nodes:d,edges:e.getAllEdges()});return t},t.prototype.oneStep=function(t,e,r){for(var n=e.iter,o=e.preventOverlapIters,i=e.krPrime,a=e.sg,d=e.preForces,h=e.bodies,c=e.sizes,l=e.forces,f=r.preventOverlap,g=r.barnesHut,p=t.getAllNodes(),v=0;v<p.length;v+=1){var y=p[v].id;d[y]=u([],s(l[y])),l[y]=[0,0]}return l=this.getAttrForces(t,n,o,c,l,r),l=g&&(f&&n>o||!f)?this.getOptRepGraForces(t,l,h,r):this.getRepGraForces(t,n,o,l,i,c,r),this.updatePos(t,l,d,a,r)},t.prototype.getAttrForces=function(t,e,r,n,o,i){for(var a=i.preventOverlap,s=i.dissuadeHubs,u=i.mode,d=i.prune,h=t.getAllEdges(),c=0;c<h.length;c+=1){var l=h[c],f=l.source,g=l.target,p=t.getNode(f),v=t.getNode(g),y=t.getDegree(f),m=t.getDegree(g);if(!d||!(y<=1||m<=1)){var w=[v.data.x-p.data.x,v.data.y-p.data.y],x=Math.hypot(w[0],w[1]);x=x<1e-4?1e-4:x,w[0]=w[0]/x,w[1]=w[1]/x,a&&e<r&&(x=x-n[f]-n[g]);var E=x,b=E;"linlog"===u&&(b=E=Math.log(1+x)),s&&(E=x/y,b=x/m),a&&e<r&&x<=0?(E=0,b=0):a&&e<r&&x>0&&(E=x,b=x),o[f][0]+=E*w[0],o[g][0]-=b*w[0],o[f][1]+=E*w[1],o[g][1]-=b*w[1]}}return o},t.prototype.getOptRepGraForces=function(t,e,r,n){for(var o=n.kg,i=n.center,a=n.prune,s=t.getAllNodes(),u=s.length,d=9e10,h=-9e10,c=9e10,l=-9e10,f=0;f<u;f+=1){var g=s[f],p=g.id,v=g.data;a&&t.getDegree(p)<=1||(r[p].setPos(v.x,v.y),v.x>=h&&(h=v.x),v.x<=d&&(d=v.x),v.y>=l&&(l=v.y),v.y<=c&&(c=v.y))}var y=Math.max(h-d,l-c),m=new Rr({xmid:(h+d)/2,ymid:(l+c)/2,length:y,massCenter:i,mass:u}),w=new Ir(m);for(f=0;f<u;f+=1)p=s[f].id,a&&t.getDegree(p)<=1||r[p].in(m)&&w.insert(r[p]);for(f=0;f<u;f+=1){var x=s[f],E=(p=x.id,v=x.data,t.getDegree(p));if(!(a&&E<=1)){r[p].resetForce(),w.updateForce(r[p]),e[p][0]-=r[p].fx,e[p][1]-=r[p].fy;var b=[v.x-i[0],v.y-i[1]],N=Math.hypot(b[0],b[1]);N=N<1e-4?1e-4:N,b[0]=b[0]/N,b[1]=b[1]/N;var M=o*(E+1);e[p][0]-=M*b[0],e[p][1]-=M*b[1]}}return e},t.prototype.getRepGraForces=function(t,e,r,n,o,i,a){for(var s=a.preventOverlap,u=a.kr,d=a.kg,h=a.center,c=a.prune,l=t.getAllNodes(),f=l.length,g=0;g<f;g+=1){for(var p=l[g],v=t.getDegree(p.id),y=g+1;y<f;y+=1){var m=l[y],w=t.getDegree(m.id);if(!c||!(v<=1||w<=1)){var x=[m.data.x-p.data.x,m.data.y-p.data.y],E=Math.hypot(x[0],x[1]);E=E<1e-4?1e-4:E,x[0]=x[0]/E,x[1]=x[1]/E,s&&e<r&&(E=E-i[p.id]-i[m.id]);var b=u*(v+1)*(w+1)/E;s&&e<r&&E<0?b=o*(v+1)*(w+1):s&&e<r&&0===E?b=0:s&&e<r&&E>0&&(b=u*(v+1)*(w+1)/E),n[p.id][0]-=b*x[0],n[m.id][0]+=b*x[0],n[p.id][1]-=b*x[1],n[m.id][1]+=b*x[1]}}var N=[p.data.x-h[0],p.data.y-h[1]],M=Math.hypot(N[0],N[1]);N[0]=N[0]/M,N[1]=N[1]/M;var S=d*(v+1);n[p.id][0]-=S*N[0],n[p.id][1]-=S*N[1]}return n},t.prototype.updatePos=function(t,e,r,n,o){for(var i=o.ks,a=o.tao,s=o.prune,u=o.ksmax,d=t.getAllNodes(),h=d.length,c=[],l=[],f=0,g=0,p=n,v=0;v<h;v+=1){var y=d[v].id,m=t.getDegree(y);if(!(s&&m<=1)){var w=[e[y][0]-r[y][0],e[y][1]-r[y][1]],E=Math.hypot(w[0],w[1]),b=[e[y][0]+r[y][0],e[y][1]+r[y][1]],N=Math.hypot(b[0],b[1]);c[v]=E,l[v]=N/2,f+=(m+1)*c[v],g+=(m+1)*l[v]}}var M=p;for(p=a*g/f,0!==M&&(p=p>1.5*M?1.5*M:p),v=0;v<h;v+=1){var S=d[v],k=(y=S.id,S.data);if(m=t.getDegree(y),!(s&&m<=1||x(k.fx)&&x(k.fy))){var A=i*p/(1+p*Math.sqrt(c[v])),R=Math.hypot(e[y][0],e[y][1]),I=u/(R=R<1e-4?1e-4:R),_=(A=A>I?I:A)*e[y][0],D=A*e[y][1];t.mergeNodeData(y,{x:k.x+_,y:k.y+D})}}return p},t}(),Or={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=n(n({},Or),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericFruchtermanLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,x,E=this;return a(this,(function(a){return this.running?[2]:(o=this.formatOptions(r),i=o.width,s=o.height,u=o.center,d=o.clustering,h=o.nodeClusterBy,c=o.maxIteration,f=o.onTick,g=e.getAllNodes(),p=e.getAllEdges(),(null==g?void 0:g.length)?1===g.length?(t&&e.mergeNodeData(g[0].id,{x:u[0],y:u[1]}),v={nodes:[n(n({},g[0]),{data:n(n({},g[0].data),{x:u[0],y:u[1]})})],edges:p},this.lastResult=v,[2,v]):(y=g.map((function(t){return b(t,[i,s])})),m=new l({nodes:y,edges:p}),w={},d&&y.forEach((function(t){var e=t.data[h];w[e]||(w[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=y,this.lastLayoutEdges=p,this.lastAssign=t,this.lastGraph=m,this.lastOptions=o,this.lastClusterMap=w,"undefined"==typeof window?[2]:(x=0,[2,new Promise((function(r){E.timeInterval=window.setInterval((function(){E.running?(E.runOneStep(m,w,o),t&&y.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y})})),null==f||f({nodes:y,edges:p}),++x>=c&&(window.clearInterval(E.timeInterval),r({nodes:y,edges:p}))):r({nodes:y,edges:p})}),0),E.running=!0}))])):(v={nodes:[],edges:p},this.lastResult=v,[2,v]))}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=n(n({},this.options),t),r=e.clustering,o=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=r&&!!o,e},t.prototype.runOneStep=function(t,e,r){var n=r.height,o=r.width,i=r.gravity,a=r.center,s=r.speed,u=r.clustering,d=r.nodeClusterBy,h=r.clusterGravity,c=n*o,l=Math.sqrt(c)/10,f=t.getAllNodes(),g=c/(f.length+1),p=Math.sqrt(g),v={};if(this.applyCalculate(t,v,p,g),u){for(var y in e)e[y].cx=0,e[y].cy=0,e[y].count=0;for(var y in f.forEach((function(t){var r=t.data,n=e[r[d]];x(r.x)&&(n.cx+=r.x),x(r.y)&&(n.cy+=r.y),n.count++})),e)e[y].cx/=e[y].count,e[y].cy/=e[y].count;var m=h||i;f.forEach((function(t,r){var n=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=e[o[d]],a=Math.sqrt((o.x-i.cx)*(o.x-i.cx)+(o.y-i.cy)*(o.y-i.cy)),s=p*m;v[n].x-=s*(o.x-i.cx)/a,v[n].y-=s*(o.y-i.cy)/a}}))}f.forEach((function(t,e){var r=t.id,n=t.data;if(x(n.x)&&x(n.y)){var o=.01*p*i;v[r].x-=o*(n.x-a[0]),v[r].y-=o*(n.y-a[1])}})),f.forEach((function(e,r){var n=e.id,o=e.data;if(x(o.fx)&&x(o.fy))return o.x=o.fx,void(o.y=o.fy);if(x(o.x)&&x(o.y)){var i=Math.sqrt(v[n].x*v[n].x+v[n].y*v[n].y);if(i>0){var a=Math.min(l*(s/800),i);t.mergeNodeData(n,{x:o.x+v[n].x/i*a,y:o.y+v[n].y/i*a})}}}))},t.prototype.applyCalculate=function(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)},t.prototype.calRepulsive=function(t,e,r){var n=t.getAllNodes();n.forEach((function(t,o){var i=t.data,a=t.id;e[a]={x:0,y:0},n.forEach((function(t,n){var s=t.data,u=t.id;if(!(o<=n)&&x(i.x)&&x(s.x)&&x(i.y)&&x(s.y)){var d=i.x-s.x,h=i.y-s.y,c=d*d+h*h;0===c&&(c=1,d=.01,h=.01);var l=r/c,f=d*l,g=h*l;e[a].x+=f,e[a].y+=g,e[u].x-=f,e[u].y-=g}}))}))},t.prototype.calAttractive=function(t,e,r){t.getAllEdges().forEach((function(n){var o=n.source,i=n.target;if(o&&i&&o!==i){var a=t.getNode(o).data,s=t.getNode(i).data;if(x(s.x)&&x(a.x)&&x(s.y)&&x(a.y)){var u=s.x-a.x,d=s.y-a.y,h=Math.sqrt(u*u+d*d)/r,c=u*h,l=d*h;e[o].x+=c,e[o].y+=l,e[i].x-=c,e[i].y-=l}}}))},t}(),Tr={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},zr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="grid",this.options=n(n({},Tr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericGridLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericGridLayout(!0,t,e),[2]}))}))},t.prototype.genericGridLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,p,v,y,m,w,E,N,M,A,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.begin,s=void 0===i?[0,0]:i,u=o.condense,d=o.preventOverlapPadding,h=o.preventOverlap,c=o.rows,l=o.cols,f=o.nodeSpacing,p=o.nodeSize,v=o.width,y=o.height,m=o.position,w=o.sortBy,E=e.getAllNodes(),N=e.getAllEdges(),!(M=null==E?void 0:E.length)||1===M)return[2,R(e,t,s)];if(A=E.map((function(t){return b(t)})),"id"===w||P(w)&&void 0!==A[0].data[w]||(w="degree"),"degree"===w?A.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):"id"===w?A.sort((function(t,e){return x(e.id)&&x(t.id)?e.id-t.id:(""+t.id).localeCompare(""+e.id)})):A.sort((function(t,e){return e.data[w]-t.data[w]})),I=v||"undefined"==typeof window?v:window.innerWidth,_=y||"undefined"==typeof window?y:window.innerHeight,D=M,O={rows:c,cols:l},null!=c&&null!=l?(O.rows=c,O.cols=l):null!=c&&null==l?(O.rows=c,O.cols=Math.ceil(D/O.rows)):null==c&&null!=l?(O.cols=l,O.rows=Math.ceil(D/O.cols)):(T=Math.sqrt(D*_/I),O.rows=Math.round(T),O.cols=Math.round(I/_*T)),O.rows=Math.max(O.rows,1),O.cols=Math.max(O.cols,1),O.cols*O.rows>D)z=Cr(O),C=Lr(O),(z-1)*C>=D?Cr(O,z-1):(C-1)*z>=D&&Lr(O,C-1);else for(;O.cols*O.rows<D;)z=Cr(O),((C=Lr(O))+1)*z>=D?Lr(O,C+1):Cr(O,z+1);for(L=u?0:I/O.cols,q=u?0:_/O.rows,(h||f)&&(j=S(10,f),F=k(30,p,!1),A.forEach((function(t){t.data.x&&t.data.y||(t.data.x=0,t.data.y=0);var r,n,o=e.getNode(t.id),i=F(o)||30;g(i)?(r=i[0],n=i[1]):(r=i,n=i);var a=void 0!==j?j(t):d,s=r+a,u=n+a;L=Math.max(L,s),q=Math.max(q,u)}))),V={},G={row:0,col:0},W={},B=0;B<A.length;B++){if($=A[B],U=void 0,m&&(U=m(e.getNode($.id))),U&&(void 0!==U.row||void 0!==U.col)){if(void 0===(H={row:U.row,col:U.col}).col)for(H.col=0;qr(V,H);)H.col++;else if(void 0===H.row)for(H.row=0;qr(V,H);)H.row++;W[$.id]=H,jr(V,H)}Vr($,s,L,q,W,O,G,V)}return K={nodes:A,edges:N},t&&A.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,K]}))}))},t}(),Cr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.min(n,o):Math.min(n,o)===t.rows?t.rows=e:t.cols=e,r},Lr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.max(n,o):Math.max(n,o)===t.rows?t.rows=e:t.cols=e,r},qr=function(t,e){return t["c-"+e.row+"-"+e.col]||!1},jr=function(t,e){return t["c-"+e.row+"-"+e.col]=!0},Fr=function(t,e){var r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},Vr=function(t,e,r,n,o,i,a,s){var u,d,h=o[t.id];if(h)u=h.col*r+r/2+e[0],d=h.row*n+n/2+e[1];else{for(;qr(s,a);)Fr(i,a);u=a.col*r+r/2+e[0],d=a.row*n+n/2+e[1],jr(s,a),Fr(i,a)}t.data.x=u,t.data.y=d};const Gr=Object.prototype.toString;function Wr(t){return Gr.call(t).endsWith("Array]")}function Br(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!Wr(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]<a&&(a=t[s]);return a}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]>a&&(a=t[s]);return a}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,a=void 0===i?r.autoMinMax?n:0:i,s=r.max,u=void 0===s?r.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var d=(u-a)/(o-n),h=0;h<t.length;h++)e[h]=(t[h]-n)*d+a;return e}const $r=" ".repeat(2),Ur=" ".repeat(4);function Hr(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=e;return`${t.constructor.name} {\\n${$r}[\\n${Ur}${function(t,e,r,n,o){const{rows:i,columns:a}=t,s=Math.min(i,e),u=Math.min(a,r),d=[];if("auto"===o){o=!1;t:for(let e=0;e<s;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let e=0;e<s;e++){let r=[];for(let i=0;i<u;i++)r.push(Kr(t.get(e,i),n,o));d.push(`${r.join(" ")}`)}return u!==a&&(d[d.length-1]+=` ... ${a-r} more columns`),s!==i&&d.push(`... ${i-e} more rows`),d.join(`\\n${Ur}`)}(t,r,n,o,i)}\\n${$r}]\\n${$r}rows: ${t.rows}\\n${$r}columns: ${t.columns}\\n}`}function Kr(t,e,r){return(t>=0&&r?` ${Yr(t,e-1)}`:Yr(t,e)).padEnd(e)}function Yr(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function Jr(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function Xr(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function Qr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function Zr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function tn(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(rn("startRow",e),rn("endRow",r),rn("startColumn",n),rn("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function en(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function rn(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function nn(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class on{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new sn(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new sn(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new sn(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new sn(t,e)}static ones(t,e){return new sn(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new sn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)o.set(r,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let a=o-n,s=new sn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(i()*a);s.set(r,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let t=0;t<n;t++)o.set(t,t,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let e=0;e<o;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new sn(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return on.isMatrix(t)?t:new sn(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let a=o;a<e;a++){let e=t.get(r,a)-i*t.get(n,a);t.set(r,a,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new sn(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){Jr(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return sn.rowVector(this.getRow(t))}setRow(t,e){Jr(this,t),e=Qr(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){Jr(this,t),Jr(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){Xr(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return sn.columnVector(this.getColumn(t))}setColumn(t,e){Xr(this,t),e=Zr(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){Xr(this,t),Xr(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){Jr(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){Xr(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){nn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){nn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(Jr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){Jr(this,t),nn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(Jr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){Jr(this,t),nn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(Xr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){Xr(this,t),nn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(Xr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){Xr(this,t),nn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){on.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=sn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new sn(e,n),i=new Float64Array(r);for(let a=0;a<n;a++){for(let e=0;e<r;e++)i[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,a,e)}}return o}strassen2x2(t){t=sn.checkMatrix(t);let e=new sn(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),d=t.get(1,1),h=(r+u)*(n+d),c=(a+u)*n,l=r*(i-d),f=u*(s-n),g=(r+o)*d,p=h+f-g+(o-u)*(s+d),v=l+g,y=c+f,m=h-c+l+(a-r)*(n+i);return e.set(0,0,p),e.set(0,1,v),e.set(1,0,y),e.set(1,1,m),e}strassen3x3(t){t=sn.checkMatrix(t);let e=new sn(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),d=this.get(2,1),h=this.get(2,2),c=t.get(0,0),l=t.get(0,1),f=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),y=t.get(2,0),m=t.get(2,1),w=t.get(2,2),x=(r-i)*(-l+p),E=(-r+i+a)*(c-l+p),b=(i+a)*(-c+l),N=r*c,M=(-r+u+d)*(c-f+v),S=(-r+u)*(f-v),k=(u+d)*(-c+f),A=(-o+d+h)*(p+y-m),R=(o-h)*(p-m),I=o*y,_=(d+h)*(-y+m),D=(-o+a+s)*(v+y-w),O=(o-s)*(v-w),P=(a+s)*(-y+w),T=N+I+n*g,z=(r+n+o-i-a-d-h)*p+E+b+N+A+I+_,C=N+M+k+(r+n+o-a-s-u-d)*v+I+D+P,L=x+a*(-c+l+g-p-v-y+w)+E+N+I+D+O,q=x+E+b+N+s*m,j=I+D+O+P+i*f,F=N+M+S+d*(-c+f+g-p-v-y+m)+A+R+I,V=A+R+I+_+u*l,G=N+M+S+k+h*w;return e.set(0,0,T),e.set(0,1,z),e.set(0,2,C),e.set(1,0,L),e.set(1,1,q),e.set(1,2,j),e.set(2,0,F),e.set(2,1,V),e.set(2,2,G),e}mmulStrassen(t){t=sn.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function a(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=on.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${r} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let s=Math.max(r,o),u=Math.max(n,i);return e=a(e,s,u),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=a(e,n+1,o+1),r=a(r,n+1,o+1)):n%2==1?(e=a(e,n+1,o),r=a(r,n+1,o)):o%2==1&&(e=a(e,n,o+1),r=a(r,n,o+1));let i=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,s-1),d=r.subMatrix(0,i-1,0,s-1),h=e.subMatrix(0,i-1,s,e.columns-1),c=r.subMatrix(0,i-1,s,r.columns-1),l=e.subMatrix(i,e.rows-1,0,s-1),f=r.subMatrix(i,r.rows-1,0,s-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),p=r.subMatrix(i,r.rows-1,s,r.columns-1),v=t(on.add(u,g),on.add(d,p),i,s),y=t(on.add(l,g),d,i,s),m=t(u,on.sub(c,p),i,s),w=t(g,on.sub(f,d),i,s),x=t(on.add(u,h),p,i,s),E=t(on.sub(l,u),on.add(d,c),i,s),b=t(on.sub(h,g),on.add(f,p),i,s),N=on.add(v,w);N.sub(x),N.add(b);let M=on.add(m,x),S=on.add(y,w),k=on.sub(v,y);k.add(m),k.add(E);let A=on.zeros(2*N.rows,2*N.columns);return A=A.setSubMatrix(N,0,0),A=A.setSubMatrix(M,N.rows,0),A=A.setSubMatrix(S,0,N.columns),A=A.setSubMatrix(k,N.rows,N.columns),A.subMatrix(0,n-1,0,o-1)}(e,t=a(t,s,u),s,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new sn(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&Br(o,{min:e,max:r,output:o}),n.setRow(t,o)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new sn(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&Br(o,{min:e,max:r,output:o}),n.setColumn(t,o)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=sn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new sn(e*n,r*o);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<o;s++)i.set(n*a+r,o*e+s,this.get(a,e)*t.get(r,s));return i}kroneckerSum(t){if(t=sn.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(sn.eye(r,r)),o=sn.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new sn(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=an){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=an){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){tn(this,t,e,r,n);let o=new sn(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new sn(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new sn(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=sn.checkMatrix(t)).isEmpty())return this;tn(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){!function(t,e){if(!Wr(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!Wr(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new sn(t.length,e.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<e.length;t++){let i=e[t];r.set(n,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new sn(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=en(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=en(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=en(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=en(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Wr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<n;a++){let n=0,s=0,u=0;for(let e=0;e<o;e++)u=t.get(a,e)-r[a],n+=u,s+=u*u;e?i.push((s-n*n/o)/(o-1)):i.push((s-n*n/o)/o)}return i}(this,r,n);case"column":if(!Wr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<o;a++){let o=0,s=0,u=0;for(let e=0;e<n;e++)u=t.get(e,a)-r[a],o+=u,s+=u*u;e?i.push((s-o*o/n)/(n-1)):i.push((s-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let a=0,s=0,u=0;for(let e=0;e<n;e++)for(let n=0;n<o;n++)u=t.get(e,n)-r,a+=u,s+=u*u;return e?(s-a*a/i)/(i-1):(s-a*a/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Wr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!Wr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!Wr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!Wr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return Hr(this,t)}}function an(t,e){return t-e}on.prototype.klass="Matrix","undefined"!=typeof Symbol&&(on.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return Hr(this)}),on.random=on.rand,on.randomInt=on.randInt,on.diagonal=on.diag,on.prototype.diagonal=on.prototype.diag,on.identity=on.eye,on.prototype.negate=on.prototype.neg,on.prototype.tensorProduct=on.prototype.kroneckerProduct;class sn extends on{constructor(t,e){if(super(),sn.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Wr(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!r[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return Jr(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),Jr(this,t,!0),e=Float64Array.from(Qr(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){Xr(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),Xr(this,t,!0),e=Zr(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(on,sn);class un extends on{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function dn(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class hn{constructor(t,e={}){if((t=un.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=e;let s,u=Boolean(o),d=Boolean(i),h=!1;if(r<n)if(a){s=t.transpose(),r=s.rows,n=s.columns,h=!0;let e=u;u=d,d=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let c=Math.min(r,n),l=Math.min(r+1,n),f=new Float64Array(l),g=new sn(r,c),p=new sn(n,n),v=new Float64Array(n),y=new Float64Array(r),m=new Float64Array(l);for(let t=0;t<l;t++)m[t]=t;let w=Math.min(r-1,n),x=Math.max(0,Math.min(n-2,r)),E=Math.max(w,x);for(let t=0;t<E;t++){if(t<w){f[t]=0;for(let e=t;e<r;e++)f[t]=dn(f[t],s.get(e,t));if(0!==f[t]){s.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<r;e++)s.set(e,t,s.get(e,t)/f[t]);s.set(t,t,s.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<n;e++){if(t<w&&0!==f[t]){let n=0;for(let o=t;o<r;o++)n+=s.get(o,t)*s.get(o,e);n=-n/s.get(t,t);for(let o=t;o<r;o++)s.set(o,e,s.get(o,e)+n*s.get(o,t))}v[e]=s.get(t,e)}if(u&&t<w)for(let e=t;e<r;e++)g.set(e,t,s.get(e,t));if(t<x){v[t]=0;for(let e=t+1;e<n;e++)v[t]=dn(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<n;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<r&&0!==v[t]){for(let e=t+1;e<r;e++)y[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)y[e]+=v[r]*s.get(e,r);for(let e=t+1;e<n;e++){let n=-v[e]/v[t+1];for(let o=t+1;o<r;o++)s.set(o,e,s.get(o,e)+n*y[o])}}if(d)for(let e=t+1;e<n;e++)p.set(e,t,v[e])}}let b=Math.min(n,r+1);if(w<n&&(f[w]=s.get(w,w)),r<b&&(f[b-1]=0),x+1<b&&(v[x]=s.get(x,b-1)),v[b-1]=0,u){for(let t=w;t<c;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<c;e++){let n=0;for(let o=t;o<r;o++)n+=g.get(o,t)*g.get(o,e);n=-n/g.get(t,t);for(let o=t;o<r;o++)g.set(o,e,g.get(o,e)+n*g.get(o,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(d)for(let t=n-1;t>=0;t--){if(t<x&&0!==v[t])for(let e=t+1;e<n;e++){let r=0;for(let o=t+1;o<n;o++)r+=p.get(o,t)*p.get(o,e);r=-r/p.get(t+1,t);for(let o=t+1;o<n;o++)p.set(o,e,p.get(o,e)+r*p.get(o,t))}for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}let N=b-1,M=0,S=Number.EPSILON;for(;b>0;){let t,e;for(t=b-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===b-2)e=4;else{let r;for(r=b-1;r>=t&&r!==t;r--){let e=(r!==b?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(f[r])<=S*e){f[r]=0;break}}r===t?e=3:r===b-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[b-2];v[b-2]=0;for(let r=b-2;r>=t;r--){let o=dn(f[r],e),i=f[r]/o,a=e/o;if(f[r]=o,r!==t&&(e=-a*v[r-1],v[r-1]=i*v[r-1]),d)for(let t=0;t<n;t++)o=i*p.get(t,r)+a*p.get(t,b-1),p.set(t,b-1,-a*p.get(t,r)+i*p.get(t,b-1)),p.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<b;n++){let o=dn(f[n],e),i=f[n]/o,a=e/o;if(f[n]=o,e=-a*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g.get(e,n)+a*g.get(e,t-1),g.set(e,t-1,-a*g.get(e,n)+i*g.get(e,t-1)),g.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(f[b-1]),Math.abs(f[b-2]),Math.abs(v[b-2]),Math.abs(f[t]),Math.abs(v[t])),o=f[b-1]/e,i=f[b-2]/e,a=v[b-2]/e,s=f[t]/e,h=v[t]/e,c=((i+o)*(i-o)+a*a)/2,l=o*a*(o*a);let y=0;0===c&&0===l||(y=c<0?0-Math.sqrt(c*c+l):Math.sqrt(c*c+l),y=l/(c+y));let m=(s+o)*(s-o)+y,w=s*h;for(let e=t;e<b-1;e++){let o=dn(m,w);0===o&&(o=Number.MIN_VALUE);let i=m/o,a=w/o;if(e!==t&&(v[e-1]=o),m=i*f[e]+a*v[e],v[e]=i*v[e]-a*f[e],w=a*f[e+1],f[e+1]=i*f[e+1],d)for(let t=0;t<n;t++)o=i*p.get(t,e)+a*p.get(t,e+1),p.set(t,e+1,-a*p.get(t,e)+i*p.get(t,e+1)),p.set(t,e,o);if(o=dn(m,w),0===o&&(o=Number.MIN_VALUE),i=m/o,a=w/o,f[e]=o,m=i*v[e]+a*f[e+1],f[e+1]=-a*v[e]+i*f[e+1],w=a*v[e+1],v[e+1]=i*v[e+1],u&&e<r-1)for(let t=0;t<r;t++)o=i*g.get(t,e)+a*g.get(t,e+1),g.set(t,e+1,-a*g.get(t,e)+i*g.get(t,e+1)),g.set(t,e,o)}v[b-2]=m,M+=1;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,d))for(let e=0;e<=N;e++)p.set(e,t,-p.get(e,t));for(;t<N&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,d&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}M=0,b--}}if(h){let t=p;p=g,g=t}this.m=r,this.n=n,this.s=f,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,o=sn.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?o.set(t,t,0):o.set(t,t,1/this.s[t]);let i=this.U,a=this.rightSingularVectors,s=a.mmul(o),u=a.rows,d=i.rows,h=sn.zeros(u,d);for(let t=0;t<u;t++)for(let e=0;e<d;e++){let r=0;for(let o=0;o<n;o++)r+=s.get(t,o)*i.get(e,o);h.set(t,e,r)}return h.mmul(e)}solveForDiagonal(t){return this.solve(sn.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new sn(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,a=i.rows,s=i.columns,u=new sn(r,a);for(let t=0;t<r;t++)for(let e=0;e<a;e++){let r=0;for(let n=0;n<s;n++)r+=o.get(t,n)*i.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return sn.diag(this.s)}}var cn,ln={center:[0,0],linkDistance:50},fn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="mds",this.options=n(n({},ln),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericMDSLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericMDSLayout(!0,t,e),[2]}))}))},t.prototype.genericMDSLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,g,y;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=void 0===i?[0,0]:i,u=o.linkDistance,d=void 0===u?50:u,h=e.getAllNodes(),c=e.getAllEdges(),(null==h?void 0:h.length)&&1!==h.length?(l=v({nodes:h,edges:c},!1),f=p(l),gn(f),m=d,w=[],f.forEach((function(t){var e=[];t.forEach((function(t){e.push(t*m)})),w.push(e)})),g=pn(w),y=[],g.forEach((function(t,e){var r=b(h[e]);r.data.x=t[0]+s[0],r.data.y=t[1]+s[1],y.push(r)})),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:y,edges:c}]):[2,R(e,t,s)];var m,w}))}))},t}(),gn=function(t){var e=-999999;t.forEach((function(t){t.forEach((function(t){t!==1/0&&e<t&&(e=t)}))})),t.forEach((function(r,n){r.forEach((function(r,o){r===1/0&&(t[n][o]=e)}))}))},pn=function(t){var e=sn.mul(sn.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),o=e.mean();e.add(o).subRowVector(r).subColumnVector(n);var i=new hn(e),a=sn.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((function(t){return sn.mul([t],[a]).toJSON()[0].splice(0,2)}))},vn={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},yn=function(t,e,r,n,o,i){e.forEach((function(a,s){r[s]={x:0,y:0},e.forEach((function(e,u){if(s!==u&&o[s]===o[u]){var d=a.x-e.x,h=a.y-e.y,c=Math.sqrt(d*d+h*h);if(0===c){c=1;var l=s>u?1:-1;d=.01*l,h=.01*l}if(c<i(t[s])/2+i(t[u])/2){var f=n*n/c;r[s].x+=d/c*f,r[s].y+=h/c*f}}}))}))},mn=function(t,e,r,n,o,i,a,s){var u=i||a/10;return n&&e.forEach((function(e,r){var n=t[r].x-t[o].x,i=t[r].y-t[o].y,a=Math.sqrt(n*n+i*i),s=i/a,u=-n/a,d=Math.sqrt(e.x*e.x+e.y*e.y),h=Math.acos((s*e.x+u*e.y)/d);h>Math.PI/2&&(h-=Math.PI/2,s*=-1,u*=-1);var c=Math.cos(h)*d;e.x=s*c,e.y=u*c})),t.forEach((function(i,a){if(a!==o){var d=Math.sqrt(e[a].x*e[a].x+e[a].y*e[a].y);if(d>0&&a!==o){var h=Math.min(u*(r/800),d);if(i.x+=e[a].x/d*h,i.y+=e[a].y/d*h,n){var c=i.x-t[o].x,l=i.y-t[o].y,f=Math.sqrt(c*c+l*l);c=c/f*s[a],l=l/f*s[a],i.x=t[o].x+c,i.y=t[o].y+l}}}})),t},wn={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},xn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="radial",this.options=n(n({},wn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRadialLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRadialLayout(!0,t,e),[2]}))}))},t.prototype.genericRadialLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,d,h,c,l,f,g,y,m,w,x,E,N,M,S,k,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K,Y,J,X,Q,Z,tt,et;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,d=o.height,h=o.center,c=o.focusNode,l=o.unitRadius,f=o.nodeSize,g=o.nodeSpacing,y=o.strictRadial,m=o.preventOverlap,w=o.maxPreventOverlapIteration,x=o.sortBy,E=o.linkDistance,N=void 0===E?50:E,M=o.sortStrength,S=void 0===M?10:M,k=o.maxIteration,I=void 0===k?1e3:k,_=e.getAllNodes(),D=e.getAllEdges(),O=i||"undefined"==typeof window?i:window.innerWidth,T=d||"undefined"==typeof window?d:window.innerHeight,z=h||[O/2,T/2],!(null==_?void 0:_.length)||1===_.length)return[2,R(e,t,z)];if(C=_[0],P(c)){for(L=0;L<_.length;L++)if(_[L].id===c){C=_[L];break}}else C=c||_[0];return q=Nn(_,C.id),j=v({nodes:_,edges:D},!1),F=p(j),V=Sn(F,q),Mn(F,q,V+1),G=F[q],W=O-z[0]>z[0]?z[0]:O-z[0],B=T-z[1]>z[1]?z[1]:T-z[1],0===W&&(W=O/2),0===B&&(B=T/2),$=Math.min(W,B),U=Math.max.apply(Math,u([],s(G))),H=[],K=l||$/U,G.forEach((function(t,e){H[e]=t*K})),Y=En(_,F,N,H,K,x,S),J=bn(Y),X=function(t,e,r){try{var n=sn.mul(sn.pow(e,2),-.5),o=n.mean("row"),i=n.mean("column"),a=n.mean();n.add(a).subRowVector(o).subColumnVector(i);var s=new hn(n),u=sn.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((function(e){return sn.mul([e],[u]).toJSON()[0].splice(0,t)}))}catch(t){for(var d=[],h=0;h<e.length;h++){var c=Math.random()*r,l=Math.random()*r;d.push([c,l])}return d}}(N,Y,N),Q=X.map((function(t){var e=s(t,2),r=e[0],n=e[1];return{x:(isNaN(r)?Math.random()*N:r)-X[q][0],y:(isNaN(n)?Math.random()*N:n)-X[q][1]}})),this.run(I,Q,J,Y,H,q),m&&(Z=A(f,g),tt={nodes:_,nodeSizeFunc:Z,positions:Q,radii:H,height:T,width:O,strictRadial:Boolean(y),focusIdx:q,iterations:w||200,k:Q.length/4.5},Q=function(t,e){for(var r=n(n({},vn),e),o=r.positions,i=r.iterations,a=r.width,s=r.k,u=r.speed,d=void 0===u?100:u,h=r.strictRadial,c=r.focusIdx,l=r.radii,f=void 0===l?[]:l,g=r.nodeSizeFunc,p=t.getAllNodes(),v=[],y=a/10,m=0;m<i;m++)o.forEach((function(t,e){v[e]={x:0,y:0}})),yn(p,o,v,s,f,g),mn(o,v,d,h,c,y,a,f);return o}(e,tt)),et=[],Q.forEach((function(t,e){var r=b(_[e]);r.data.x=t.x+z[0],r.data.y=t.y+z[1],et.push(r)})),t&&et.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:et,edges:D}]}))}))},t.prototype.run=function(t,e,r,n,o,i){for(var a=0;a<=t;a++){var s=a/t;this.oneIteration(s,e,o,n,r,i)}},t.prototype.oneIteration=function(t,e,r,n,o,i){var a=1-t;e.forEach((function(s,u){var d=y(s,{x:0,y:0}),h=0===d?0:1/d;if(u!==i){var c=0,l=0,f=0;e.forEach((function(t,e){if(u!==e){var r=y(s,t),i=0===r?0:1/r,a=n[e][u];f+=o[u][e],c+=o[u][e]*(t.x+a*(s.x-t.x)*i),l+=o[u][e]*(t.y+a*(s.y-t.y)*i)}}));var g=0===r[u]?0:1/r[u];f*=a,f+=t*g*g,c*=a,c+=t*g*s.x*h,s.x=c/f,l*=a,l+=t*g*s.y*h,s.y=l/f}}))},t}(),En=function(t,e,r,n,o,i,a){if(!t)return[];var s=[];if(e){var u={};e.forEach((function(e,d){var h=[];e.forEach((function(e,s){var c,l;if(d===s)h.push(0);else if(n[d]===n[s])if("data"===i)h.push(e*(Math.abs(d-s)*a)/(n[d]/o));else if(i){var f=void 0,g=void 0;if(u[t[d].id])f=u[t[d].id];else{var p=("id"===i?t[d].id:null===(c=t[d].data)||void 0===c?void 0:c[i])||0;f=P(p)?p.charCodeAt(0):p,u[t[d].id]=f}u[t[s].id]?g=u[t[s].id]:(p=("id"===i?t[s].id:null===(l=t[s].data)||void 0===l?void 0:l[i])||0,g=P(p)?p.charCodeAt(0):p,u[t[s].id]=g),h.push(e*(Math.abs(f-g)*a)/(n[d]/o))}else h.push(e*r/(n[d]/o));else{var v=(r+o)/2;h.push(e*v)}})),s.push(h)}))}return s},bn=function(t){for(var e=t.length,r=t[0].length,n=[],o=0;o<e;o++){for(var i=[],a=0;a<r;a++)0!==t[o][a]?i.push(1/(t[o][a]*t[o][a])):i.push(0);n.push(i)}return n},Nn=function(t,e){var r=-1;return t.forEach((function(t,n){t.id===e&&(r=n)})),Math.max(r,0)},Mn=function(t,e,r){for(var n=t.length,o=0;o<n;o++)if(t[e][o]===1/0){t[e][o]=r,t[o][e]=r;for(var i=0;i<n;i++)t[o][i]!==1/0&&t[e][i]===1/0&&(t[e][i]=r+t[o][i],t[i][e]=r+t[o][i])}for(o=0;o<n;o++)if(o!==e)for(i=0;i<n;i++)if(t[o][i]===1/0){var a=Math.abs(t[e][o]-t[e][i]);a=0===a?1:a,t[o][i]=a}},Sn=function(t,e){for(var r=0,n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r},kn={center:[0,0],width:300,height:300},An=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="random",this.options=n(n({},kn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRandomLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRandomLayout(!0,t,e),[2]}))}))},t.prototype.genericRandomLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,d=e.getAllNodes(),h=s||"undefined"==typeof window?s:window.innerWidth,c=u||"undefined"==typeof window?u:window.innerHeight,l=i||[h/2,c/2],f=[],d&&d.forEach((function(t){f.push({id:t.id,data:{x:.9*(Math.random()-.5)*h+l[0],y:.9*(Math.random()-.5)*c+l[1]}})})),t&&f.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:f,edges:e.getAllEdges()}]}))}))},t}(),Rn={circular:_,concentric:z,mds:fn,random:An,grid:zr,radial:xn,force:xr,d3force:zt,fruchterman:Pr,forceAtlas2:Dr,dagre:pr};function In(){var t;(null===(t=cn)||void 0===t?void 0:t.stop)&&cn.stop()}function _n(t,e){return i(this,void 0,void 0,(function(){var r,n,o,i,s,u,d,h,c;return a(this,(function(a){switch(a.label){case 0:if(r=t.layout,n=r.id,o=r.options,i=r.iterations,s=t.nodes,u=t.edges,d=new l({nodes:s,edges:u}),!(h=Rn[n]))throw new Error("Unknown layout id: "+n);return[4,(cn=new h(o)).execute(d)];case 1:return c=a.sent(),!!(f=cn).tick&&!!f.stop&&(cn.stop(),c=cn.tick(i)),[2,[c,e]]}var f}))}))}addEventListener("message",(function(t){var r,n=t.data,o=n.type,i=n.method,a=n.id,s=n.params;"RPC"===o&&i&&((r=e[i])?Promise.resolve().then((function(){return r.apply(e,s)})):Promise.reject("No such method")).then((function(t){postMessage({type:"RPC",id:a,result:t})})).catch((function(t){var e={message:t};t.stack&&(e.message=t.message,e.stack=t.stack,e.name=t.name),postMessage({type:"RPC",id:a,error:e})}))})),postMessage({type:"RPC",method:"ready"});\n//# sourceMappingURL=c1c68049e416ee50a3be.worker.js.map'])),{name:"[fullhash].worker.js"});return URL.revokeObjectURL(URL.createObjectURL(new Blob(['var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{calculateLayout:()=>_n,stopLayout:()=>In});var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function o(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function i(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function a(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function u(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}Object.create,Object.create;const d=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[],i=this._events["*"]||[],a=function(n){for(var o=n.length,i=0;i<o;i++)if(n[i]){var a=n[i],s=a.callback;a.once&&(n.splice(i,1),0===n.length&&delete e._events[t],o--,i--),s.apply(e,r)}};a(o),a(i)},t.prototype.off=function(t,e){if(t)if(e){for(var r=this._events[t]||[],n=r.length,o=0;o<n;o++)r[o].callback===e&&(r.splice(o,1),n--,o--);0===r.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function h(t,e,r,n){for(;t.length;){const o=t.shift();if(r(o))return!0;e.add(o.id),n(o.id).forEach((r=>{e.has(r.id)||(e.add(r.id),t.push(r))}))}return!1}function c(t,e,r,n){if(r(t))return!0;e.add(t.id);for(const o of n(t.id))if(!e.has(o.id)&&c(o,e,r,n))return!0;return!1}class l extends d{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const r=e.find((e=>e.type===t.type&&e.id===t.id&&e.propertyName===t.propertyName));r?r.newValue=t.newValue:e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const r=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),r=this.bothEdgesMap.get(t);r?.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((e=>{e.childrenMap.get(t)?.forEach((t=>{e.parentMap.delete(t.id)})),e.parentMap.delete(t),e.childrenMap.delete(t)})),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){const n=this.getNode(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateNodeDataProperty(t,e,r)}))}))}updateNodeData(...t){const e=t[0],r=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:o})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),o.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),o=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),o.delete(e),i.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.source,o=e;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:o})}))}updateEdgeTarget(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.target,o=e;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:o})}))}updateEdgeDataProperty(t,e,r){const n=this.getEdge(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}updateEdgeData(...t){const e=t[0],r=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:o})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateEdgeDataProperty(t,e,r)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const r=[],n=Array.isArray(t)?t:[t];for(;n.length;){const t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach((t=>{t.children?.forEach((r=>{this.setParent(r.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const r=this.treeIndices.get(e).childrenMap.get(t);return Array.from(r||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const r=[];let n,o=this.getNode(t);for(;n=this.getParent(o.id,e);)r.push(n),o=n;return r}setParent(t,e,r){this.checkTreeExistence(r);const n=this.treeIndices.get(r),o=this.getNode(t),i=n.parentMap.get(t),a=this.getNode(e);n.parentMap.set(t,a),i&&n.childrenMap.get(i.id)?.delete(o);let s=n.childrenMap.get(a.id);s||(s=new Set,n.childrenMap.set(a.id,s)),s.add(o),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:i?.id,newParentId:a.id})}))}dfsTree(t,e,r){return c(this.getNode(t),new Set,e,(t=>this.getChildren(t,r)))}bfsTree(t,e,r){return h([this.getNode(t)],new Set,e,(t=>this.getChildren(t,r)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return h([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return c(this.getNode(t),new Set,e,n)}clone(){const t=this.getAllNodes().map((t=>({...t,data:{...t.data}}))),e=this.getAllEdges().map((t=>({...t,data:{...t.data}}))),r=new l({nodes:t,edges:e});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},n)=>{const o=new Map;t.forEach(((t,e)=>{o.set(e,r.getNode(t.id))}));const i=new Map;e.forEach(((t,e)=>{i.set(e,new Set(Array.from(t).map((t=>r.getNode(t.id)))))})),r.treeIndices.set(n,{parentMap:o,childrenMap:i})})),r}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var f=/-(\\w)/g,g=(function(t){return t.replace(f,(function(t,e){return e?e.toUpperCase():""}))},Object.create(null),Array.isArray),p=function(t){for(var e=[],r=t.length,n=0;n<r;n+=1){e[n]=[];for(var o=0;o<r;o+=1)n===o?e[n][o]=0:0!==t[n][o]&&t[n][o]?e[n][o]=t[n][o]:e[n][o]=1/0}for(var i=0;i<r;i+=1)for(n=0;n<r;n+=1)for(o=0;o<r;o+=1)e[n][o]>e[n][i]+e[i][o]&&(e[n][o]=e[n][i]+e[i][o]);return e},v=function(t,e){var r=t.nodes,n=t.edges,o=[],i={};if(!r)throw new Error("invalid nodes data!");return r&&r.forEach((function(t,e){i[t.id]=e,o.push([])})),null==n||n.forEach((function(t){var r=t.source,n=t.target,a=i[r],s=i[n];void 0!==a&&void 0!==s&&(o[a][s]=1,e||(o[s][a]=1))})),o},y=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},m={}.toString;const w=function(t,e){return m.call(t)==="[object "+e+"]"},x=function(t){return w(t,"Number")};var E=function(t){if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var e=[];return t.forEach((function(t){e.push(t)})),e.map((function(t){return E(t)}))}if("object"==typeof t){var r={};return Object.keys(t).forEach((function(e){r[e]=E(t[e])})),r}return t},b=function(t,e){var r=E(t);return r.data=r.data||{},e&&(x(r.data.x)||(r.data.x=Math.random()*e[0]),x(r.data.y)||(r.data.y=Math.random()*e[1])),r};const N=function(t){return"function"==typeof t},M=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function S(t,e){return N(e)?e:x(e)?function(){return e}:function(){return t}}function k(t,e,r){return void 0===r&&(r=!0),e||0===e?N(e)?e:x(e)?function(){return e}:g(e)?function(){if(r){var n=Math.max.apply(Math,u([],s(e)));return isNaN(n)?t:n}return e}:M(e)?function(){if(r){var n=Math.max(e.width,e.height);return isNaN(n)?t:n}return[e.width,e.height]}:function(){return t}:function(e){var r=(e.data||{}).size;return r?g(r)?r[0]>r[1]?r[0]:r[1]:M(r)?r.width>r.height?r.width:r.height:r:t}}var A=function(t,e){var r;return r=x(e)?function(){return e}:N(e)?e:function(){return 0},t?g(t)?function(e){return(t[0]>t[1]?t[0]:t[1])+r(e)}:function(e){return t+r(e)}:function(t){var e,n;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return Math.max(t.data.bboxSize[0],t.data.bboxSize[1])+r(t);if(null===(n=t.data)||void 0===n?void 0:n.size){if(g(t.data.size))return Math.max(t.data.size[0],t.data.size[1])+r(t);var o=t.data.size;return M(o)?(o.width>o.height?o.width:o.height)+r(t):o+r(t)}return 10+r(t)}},R=function(t,e,r){var o=t.getAllNodes(),i=t.getAllEdges();return(null==o?void 0:o.length)?1===o.length?(e&&t.mergeNodeData(o[0].id,{x:r[0],y:r[1]}),{nodes:[n(n({},o[0]),{data:n(n({},o[0].data),{x:r[0],y:r[1]})})],edges:i}):void 0:{nodes:[],edges:i}},I={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},_=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="circular",this.options=n(n({},I),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericCircularLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericCircularLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericCircularLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,u,d,h,c,l,f,g,p,v,y,m,w,x,E,N,M,A,I,_,P,T,z,C,L,q,j,F,V,G,W,B,$,U;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,u=o.height,d=o.center,h=o.divisions,c=o.startAngle,l=void 0===c?0:c,f=o.endAngle,g=void 0===f?2*Math.PI:f,p=o.angleRatio,v=o.ordering,y=o.clockwise,m=o.nodeSpacing,w=o.nodeSize,x=e.getAllNodes(),E=e.getAllEdges(),N=s(O(i,u,d),3),M=N[0],A=N[1],I=N[2],!(_=null==x?void 0:x.length)||1===_)return[2,R(e,t,I)];for(P=(g-l)/_,T=o.radius,z=o.startRadius,C=o.endRadius,m?(L=S(10,m),q=k(10,w),j=-1/0,x.forEach((function(t){var e=q(t);j<e&&(j=e)})),F=0,x.forEach((function(t,e){F+=0===e?j||10:(L(t)||0)+(j||10)})),T=F/(2*Math.PI)):T||z||C?!z&&C?z=C:z&&!C&&(C=z):T=Math.min(A,M)/2,V=P*p,G=[],G="topology"===v?D(e,x):"topology-directed"===v?D(e,x,!0):"degree"===v?function(t,e){var r=[];return e.forEach((function(t,e){r.push(b(t))})),r.sort((function(e,r){return t.getDegree(e.id,"both")-t.getDegree(r.id,"both")})),r}(e,x):x.map((function(t){return b(t)})),W=Math.ceil(_/h),B=0;B<_;++B)($=T)||null===z||null===C||($=z+B*(C-z)/(_-1)),$||($=10+100*B/(_-1)),U=l+B%W*V+2*Math.PI/h*Math.floor(B/W),y||(U=g-B%W*V-2*Math.PI/h*Math.floor(B/W)),G[B].data.x=I[0]+Math.cos(U)*$,G[B].data.y=I[1]+Math.sin(U)*$;return t&&G.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:G,edges:E}]}))}))},t}(),D=function(t,e,r){void 0===r&&(r=!1);var n=[b(e[0])],o={},i=e.length;o[e[0].id]=!0;var a=0;return e.forEach((function(s,u){if(0!==u)if(u!==i-1&&t.getDegree(s.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(n[a].id,s.id)||o[s.id]){for(var d=r?t.getSuccessors(n[a].id):t.getNeighbors(n[a].id),h=!1,c=0;c<d.length;c++){var l=d[c];if(t.getDegree(l.id)===t.getDegree(s.id)&&!o[l.id]){n.push(b(l)),o[l.id]=!0,h=!0;break}}for(var f=0;!h&&(o[e[f].id]||(n.push(b(e[f])),o[e[f].id]=!0,h=!0),++f!==i););}else n.push(b(s)),o[s.id]=!0,a++})),n},O=function(t,e,r){var n=t,o=e,i=r;return n||"undefined"==typeof window||(n=window.innerWidth),o||"undefined"==typeof window||(o=window.innerHeight),i||(i=[n/2,o/2]),[n,o,i]};const P=function(t){return w(t,"String")};var T={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},z=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="concentric",this.options=n(n({},T),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericConcentricLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericConcentricLayout(!0,t,e),[2]}))}))},t.prototype.genericConcentricLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,p,v,y,m,w,E,S,k,A,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K,Y;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,d=o.sortBy,h=o.maxLevelDiff,c=o.sweep,l=o.clockwise,f=o.equidistant,p=o.preventOverlap,v=o.startAngle,y=void 0===v?1.5*Math.PI:v,m=o.nodeSize,w=o.nodeSpacing,E=e.getAllNodes(),S=e.getAllEdges(),k=s||"undefined"==typeof window?s:window.innerWidth,A=u||"undefined"==typeof window?u:window.innerHeight,I=i||[k/2,A/2],!(null==E?void 0:E.length)||1===E.length)return[2,R(e,t,I)];if(_=[],O=0,D=g(m)?Math.max(m[0],m[1]):m,g(w)?O=Math.max(w[0],w[1]):x(w)&&(O=w),E.forEach((function(t){var e=b(t);_.push(e);var r=D,n=e.data;g(n.size)?r=Math.max(n.size[0],n.size[1]):x(n.size)?r=n.size:M(n.size)&&(r=Math.max(n.size.width,n.size.height)),D=Math.max(D,r),N(w)&&(O=Math.max(w(t),O))})),T={},_.forEach((function(t,e){T[t.id]=e})),P(z=d)&&void 0!==_[0].data[z]||(z="degree"),"degree"===z?_.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):_.sort((function(t,e){return e.data[z]-t.data[z]})),C=_[0],L=(h||("degree"===z?e.getDegree(C.id,"both"):C.data[z]))/4,j=(q=[{nodes:[]}])[0],_.forEach((function(t){if(j.nodes.length>0){var r="degree"===z?Math.abs(e.getDegree(j.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(j.nodes[0].data[z]-t.data[z]);L&&r>=L&&(j={nodes:[]},q.push(j))}j.nodes.push(t)})),F=D+O,p||(V=q.length>0&&q[0].nodes.length>1,G=Math.min(k,A)/2-F,W=G/(q.length+(V?1:0)),F=Math.min(F,W)),B=0,q.forEach((function(t){var e=void 0===c?2*Math.PI-2*Math.PI/t.nodes.length:c;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&p){var r=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),o=Math.sqrt(F*F/(r*r+n*n));B=Math.max(o,B)}t.r=B,B+=F})),f){for($=0,U=0,H=0;H<q.length;H++)K=q[H],Y=(K.r||0)-U,$=Math.max($,Y);U=0,q.forEach((function(t,e){0===e&&(U=t.r||0),t.r=U,U+=$}))}return q.forEach((function(t){var e=t.dTheta||0,r=t.r||0;t.nodes.forEach((function(t,n){var o=y+(l?1:-1)*e*n;t.data.x=I[0]+r*Math.cos(o),t.data.y=I[1]+r*Math.sin(o)}))})),t&&_.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:_,edges:S}]}))}))},t}();function C(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i,a,s,u,d,h,c,l,f=t._root,g={data:n},p=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!f)return t._root=g,t;for(;f.length;)if((d=e>=(i=(p+y)/2))?p=i:y=i,(h=r>=(a=(v+m)/2))?v=a:m=a,o=f,!(f=f[c=h<<1|d]))return o[c]=g,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&r===u)return g.next=f,o?o[c]=g:t._root=g,t;do{o=o?o[c]=new Array(4):t._root=new Array(4),(d=e>=(i=(p+y)/2))?p=i:y=i,(h=r>=(a=(v+m)/2))?v=a:m=a}while((c=h<<1|d)==(l=(u>=a)<<1|s>=i));return o[l]=f,o[c]=g,t}function L(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function q(t){return t[0]}function j(t){return t[1]}function F(t,e,r){var n=new V(null==e?q:e,null==r?j:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function V(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function G(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var W=F.prototype=V.prototype;function B(t){return function(){return t}}function $(t){return 1e-6*(t()-.5)}W.copy=function(){var t,e,r=new V(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=G(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var o=0;o<4;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(4)}):n.target[o]=G(e));return r},W.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return C(this.cover(e,r),e,r,t)},W.addAll=function(t){var e,r,n,o,i=t.length,a=new Array(i),s=new Array(i),u=1/0,d=1/0,h=-1/0,c=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(a[r]=n,s[r]=o,n<u&&(u=n),n>h&&(h=n),o<d&&(d=o),o>c&&(c=o));if(u>h||d>c)return this;for(this.cover(u,d).cover(h,c),r=0;r<i;++r)C(this,a[r],s[r],t[r]);return this},W.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var a,s,u=o-r||1,d=this._root;r>t||t>=o||n>e||e>=i;)switch(s=(e<n)<<1|t<r,(a=new Array(4))[s]=d,d=a,u*=2,s){case 0:o=r+u,i=n+u;break;case 1:r=o-u,i=n+u;break;case 2:o=r+u,n=i-u;break;case 3:r=o-u,n=i-u}this._root&&this._root.length&&(this._root=d)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this},W.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},W.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},W.find=function(t,e,r){var n,o,i,a,s,u,d,h=this._x0,c=this._y0,l=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new L(p,h,c,l,f)),null==r?r=1/0:(h=t-r,c=e-r,l=t+r,f=e+r,r*=r);u=g.pop();)if(!(!(p=u.node)||(o=u.x0)>l||(i=u.y0)>f||(a=u.x1)<h||(s=u.y1)<c))if(p.length){var v=(o+a)/2,y=(i+s)/2;g.push(new L(p[3],v,y,a,s),new L(p[2],o,y,v,s),new L(p[1],v,i,a,y),new L(p[0],o,i,v,y)),(d=(e>=y)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-d],g[g.length-1-d]=u)}else{var m=t-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),x=m*m+w*w;if(x<r){var E=Math.sqrt(r=x);h=t-E,c=e-E,l=t+E,f=e+E,n=p.data}}return n},W.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,r,n,o,i,a,s,u,d,h,c,l,f=this._root,g=this._x0,p=this._y0,v=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((d=i>=(s=(g+v)/2))?g=s:v=s,(h=a>=(u=(p+y)/2))?p=u:y=u,e=f,!(f=f[c=h<<1|d]))return this;if(!f.length)break;(e[c+1&3]||e[c+2&3]||e[c+3&3])&&(r=e,l=c)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(o=f.next)&&delete f.next,n?(o?n.next=o:delete n.next,this):e?(o?e[c]=o:delete e[c],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[l]=f:this._root=f),this):(this._root=o,this)},W.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},W.root=function(){return this._root},W.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},W.visit=function(t){var e,r,n,o,i,a,s=[],u=this._root;for(u&&s.push(new L(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,n=e.x0,o=e.y0,i=e.x1,a=e.y1)&&u.length){var d=(n+i)/2,h=(o+a)/2;(r=u[3])&&s.push(new L(r,d,h,i,a)),(r=u[2])&&s.push(new L(r,n,h,d,a)),(r=u[1])&&s.push(new L(r,d,o,i,h)),(r=u[0])&&s.push(new L(r,n,o,d,h))}return this},W.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new L(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.x1,d=e.y1,h=(a+u)/2,c=(s+d)/2;(i=o[0])&&r.push(new L(i,a,s,h,c)),(i=o[1])&&r.push(new L(i,h,s,u,c)),(i=o[2])&&r.push(new L(i,a,c,h,d)),(i=o[3])&&r.push(new L(i,h,c,u,d))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},W.x=function(t){return arguments.length?(this._x=t,this):this._x},W.y=function(t){return arguments.length?(this._y=t,this):this._y};var U={value:()=>{}};function H(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new K(n)}function K(t){this._=t}function Y(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function J(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=U,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}K.prototype=H.prototype={constructor:K,on:function(t,e){var r,n,o=this._,i=(n=o,(t+"").trim().split(/^|\\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)o[r]=J(o[r],t.name,e);else if(null==e)for(r in o)o[r]=J(o[r],t.name,null);return this}for(;++a<s;)if((r=(t=i[a]).type)&&(r=Y(o[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new K(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};const X=H;var Q,Z,tt=0,et=0,rt=0,nt=1e3,ot=0,it=0,at=0,st="object"==typeof performance&&performance.now?performance:Date,ut="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function dt(){return it||(ut(ht),it=st.now()+at)}function ht(){it=0}function ct(){this._call=this._time=this._next=null}function lt(t,e,r){var n=new ct;return n.restart(t,e,r),n}function ft(){it=(ot=st.now())+at,tt=et=0;try{!function(){dt(),++tt;for(var t,e=Q;e;)(t=it-e._time)>=0&&e._call.call(void 0,t),e=e._next;--tt}()}finally{tt=0,function(){for(var t,e,r=Q,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:Q=e);Z=t,pt(n)}(),it=0}}function gt(){var t=st.now(),e=t-ot;e>nt&&(at-=e,ot=t)}function pt(t){tt||(et&&(et=clearTimeout(et)),t-it>24?(t<1/0&&(et=setTimeout(ft,t-st.now()-at)),rt&&(rt=clearInterval(rt))):(rt||(ot=st.now(),rt=setInterval(gt,nt)),tt=1,ut(ft)))}ct.prototype=lt.prototype={constructor:ct,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?dt():+r)+(null==e?0:+e),this._next||Z===this||(Z?Z._next=this:Q=this,Z=this),this._call=t,this._time=r,pt()},stop:function(){this._call&&(this._call=null,this._time=1/0,pt())}};const vt=1664525,yt=1013904223,mt=4294967296;function wt(t){return t.x}function xt(t){return t.y}var Et=10,bt=Math.PI*(3-Math.sqrt(5));function Nt(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,a=.6,s=new Map,u=lt(c),d=X("tick","end"),h=function(){let t=1;return()=>(t=(vt*t+yt)%mt)/mt}();function c(){l(),d.call("tick",e),r<n&&(u.stop(),d.call("end",e))}function l(n){var u,d,h=t.length;void 0===n&&(n=1);for(var c=0;c<n;++c)for(r+=(i-r)*o,s.forEach((function(t){t(r)})),u=0;u<h;++u)null==(d=t[u]).fx?d.x+=d.vx*=a:(d.x=d.fx,d.vx=0),null==d.fy?d.y+=d.vy*=a:(d.y=d.fy,d.vy=0);return e}function f(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var o=Et*Math.sqrt(.5+r),i=r*bt;e.x=o*Math.cos(i),e.y=o*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,h),e}return null==t&&(t=[]),f(),e={tick:l,restart:function(){return u.restart(c),e},stop:function(){return u.stop(),e},nodes:function(r){return arguments.length?(t=r,f(),s.forEach(g),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(h=t,s.forEach(g),e):h},force:function(t,r){return arguments.length>1?(null==r?s.delete(t):s.set(t,g(r)),e):s.get(t)},find:function(e,r,n){var o,i,a,s,u,d=0,h=t.length;for(null==n?n=1/0:n*=n,d=0;d<h;++d)(a=(o=e-(s=t[d]).x)*o+(i=r-s.y)*i)<n&&(u=s,n=a);return u},on:function(t,r){return arguments.length>1?(d.on(t,r),e):d.on(t)}}}function Mt(){var t,e,r,n,o,i=B(-30),a=1,s=1/0,u=.81;function d(r){var o,i=t.length,a=F(t,wt,xt).visitAfter(c);for(n=r,o=0;o<i;++o)e=t[o],a.visit(l)}function h(){if(t){var e,r,n=t.length;for(o=new Array(n),e=0;e<n;++e)r=t[e],o[r.index]=+i(r,e,t)}}function c(t){var e,r,n,i,a,s=0,u=0;if(t.length){for(n=i=a=0;a<4;++a)(e=t[a])&&(r=Math.abs(e.value))&&(s+=e.value,u+=r,n+=r*e.x,i+=r*e.y);t.x=n/u,t.y=i/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=o[e.data.index]}while(e=e.next)}t.value=s}function l(t,i,d,h){if(!t.value)return!0;var c=t.x-e.x,l=t.y-e.y,f=h-i,g=c*c+l*l;if(f*f/u<g)return g<s&&(0===c&&(g+=(c=$(r))*c),0===l&&(g+=(l=$(r))*l),g<a&&(g=Math.sqrt(a*g)),e.vx+=c*t.value*n/g,e.vy+=l*t.value*n/g),!0;if(!(t.length||g>=s)){(t.data!==e||t.next)&&(0===c&&(g+=(c=$(r))*c),0===l&&(g+=(l=$(r))*l),g<a&&(g=Math.sqrt(a*g)));do{t.data!==e&&(f=o[t.data.index]*n/g,e.vx+=c*f,e.vy+=l*f)}while(t=t.next)}}return d.initialize=function(e,n){t=e,r=n,h()},d.strength=function(t){return arguments.length?(i="function"==typeof t?t:B(+t),h(),d):i},d.distanceMin=function(t){return arguments.length?(a=t*t,d):Math.sqrt(a)},d.distanceMax=function(t){return arguments.length?(s=t*t,d):Math.sqrt(s)},d.theta=function(t){return arguments.length?(u=t*t,d):Math.sqrt(u)},d}function St(t){return t.index}function kt(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function At(t){var e,r,n,o,i,a,s=St,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},d=B(30),h=1;function c(n){for(var o=0,s=t.length;o<h;++o)for(var u,d,c,l,f,g,p,v=0;v<s;++v)d=(u=t[v]).source,l=(c=u.target).x+c.vx-d.x-d.vx||$(a),f=c.y+c.vy-d.y-d.vy||$(a),l*=g=((g=Math.sqrt(l*l+f*f))-r[v])/g*n*e[v],f*=g,c.vx-=l*(p=i[v]),c.vy-=f*p,d.vx+=l*(p=1-p),d.vy+=f*p}function l(){if(n){var a,u,d=n.length,h=t.length,c=new Map(n.map(((t,e)=>[s(t,e,n),t])));for(a=0,o=new Array(d);a<h;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=kt(c,u.source)),"object"!=typeof u.target&&(u.target=kt(c,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(a=0,i=new Array(h);a<h;++a)u=t[a],i[a]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);e=new Array(h),f(),r=new Array(h),g()}}function f(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+u(t[r],r,t)}function g(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+d(t[e],e,t)}return null==t&&(t=[]),c.initialize=function(t,e){n=t,a=e,l()},c.links=function(e){return arguments.length?(t=e,l(),c):t},c.id=function(t){return arguments.length?(s=t,c):s},c.iterations=function(t){return arguments.length?(h=+t,c):h},c.strength=function(t){return arguments.length?(u="function"==typeof t?t:B(+t),f(),c):u},c.distance=function(t){return arguments.length?(d="function"==typeof t?t:B(+t),g(),c):d},c}function Rt(t){return t.x+t.vx}function It(t){return t.y+t.vy}function _t(t){var e,r,n,o=1,i=1;function a(){for(var t,a,u,d,h,c,l,f=e.length,g=0;g<i;++g)for(a=F(e,Rt,It).visitAfter(s),t=0;t<f;++t)u=e[t],c=r[u.index],l=c*c,d=u.x+u.vx,h=u.y+u.vy,a.visit(p);function p(t,e,r,i,a){var s=t.data,f=t.r,g=c+f;if(!s)return e>d+g||i<d-g||r>h+g||a<h-g;if(s.index>u.index){var p=d-s.x-s.vx,v=h-s.y-s.vy,y=p*p+v*v;y<g*g&&(0===p&&(y+=(p=$(n))*p),0===v&&(y+=(v=$(n))*v),y=(g-(y=Math.sqrt(y)))/y*o,u.vx+=(p*=y)*(g=(f*=f)/(l+f)),u.vy+=(v*=y)*g,s.vx-=p*(g=1-g),s.vy-=v*g)}}}function s(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var n,o,i=e.length;for(r=new Array(i),n=0;n<i;++n)o=e[n],r[o.index]=+t(o,n,e)}}return"function"!=typeof t&&(t=B(null==t?1:+t)),a.initialize=function(t,r){e=t,n=r,u()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(o=+t,a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),u(),a):t},a}function Dt(t){var e,r,n,o=B(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=B(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:B(+t),a(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),a(),i):t},i}function Ot(t){var e,r,n,o=B(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=B(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:B(+t),a(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),a(),i):t},i}function Pt(){function t(t){return function(){return t}}var e,r=function(t){return t.cluster},n=t(1),o=t(-1),i=t(100),a=t(.1),u=[0,0],d=[],h={},c=[],l=100,f=100,g={none:{x:0,y:0}},p=[],v="force",y=!0,m=.1;function w(t){if(!y)return w;e.tick(),E();for(var n=0,o=d.length,i=void 0,a=t*m;n<o;++n)(i=d[n]).vx+=(g[r(i)].x-i.x)*a,i.vy+=(g[r(i)].y-i.y)*a}function x(){d&&function(){if(d&&d.length){if(void 0===r(d[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy(\'clusterAttr\') before calling .links()");var t,u,g,v,y,m=(t=[],u=[],g={},{},y=[],v=function(t){var e={};return t.forEach((function(t){var n=r(t);e[n]||(e[n]={count:0,sumforceNodeSize:0})})),t.forEach((function(t){var o=r(t),i=n(t),a=e[o];a.count=a.count+1,a.sumforceNodeSize=a.sumforceNodeSize+Math.PI*(i*i)*1.3,e[o]=a})),e}(d),y=function(t){var e={},n=[];return t.forEach((function(t){var n,o,i,a,s,u=(o=(n=t).source,i=n.target,(a=r(h[o]))<=(s=r(h[i]))?a+"~"+s:s+"~"+a),d=0;void 0!==e[u]&&(d=e[u]),d+=1,e[u]=d})),Object.entries(e).forEach((function(t){var e=s(t,2),r=e[0],o=e[1],i=r.split("~")[0],a=r.split("~")[1];void 0!==i&&void 0!==a&&n.push({source:i,target:a,count:o})})),n}(c),Object.keys(v).forEach((function(e,r){var n=v[e];t.push({id:e,size:n.count,r:Math.sqrt(n.sumforceNodeSize/Math.PI)}),g[e]=r})),y.forEach((function(t){var e=t.source,r=t.target,n=g[e],o=g[r];void 0!==n&&void 0!==o&&u.push({source:n,target:o,count:t.count})})),{nodes:t,links:u});e=Nt(m.nodes).force("x",Dt(l).strength(.1)).force("y",Ot(f).strength(.1)).force("collide",_t((function(t){return t.r})).iterations(4)).force("charge",Mt().strength(o)).force("links",At(m.nodes.length?m.links:[]).distance(i).strength(a)),p=e.nodes(),E()}}()}function E(){return g={none:{x:0,y:0}},p.forEach((function(t){g[t.id]={x:t.x-u[0],y:t.y-u[1]}})),g}return w.initialize=function(t){d=t,x()},w.template=function(t){return arguments.length?(v=t,x(),w):v},w.groupBy=function(t){return arguments.length?"string"==typeof t?(r=function(e){return e[t]},w):(r=t,w):r},w.enableGrouping=function(t){return arguments.length?(y=t,w):y},w.strength=function(t){return arguments.length?(m=t,w):m},w.centerX=function(t){return arguments.length?(l=t,w):l},w.centerY=function(t){return arguments.length?(f=t,w):f},w.nodes=function(t){return arguments.length?(function(t){h={},t.forEach((function(t){h[t.id]=t}))}(t||[]),d=t||[],w):d},w.links=function(t){return arguments.length?(c=t||[],x(),w):c},w.forceNodeSize=function(e){return arguments.length?(n="function"==typeof e?e:t(+e),x(),w):n},w.nodeSize=w.forceNodeSize,w.forceCharge=function(e){return arguments.length?(o="function"==typeof e?e:t(+e),x(),w):o},w.forceLinkDistance=function(e){return arguments.length?(i="function"==typeof e?e:t(+e),x(),w):i},w.forceLinkStrength=function(e){return arguments.length?(a="function"==typeof e?e:t(+e),x(),w):a},w.offset=function(t){return arguments.length?(u=t,w):u},w.getFocis=E,w}var Tt={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},zt=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="d3force",this.options=n(n({},Tt),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){var t;null===(t=this.forceSimulation)||void 0===t||t.stop()},t.prototype.tick=function(t){var e=this;void 0===t&&(t=1),this.forceSimulation.tick(t);var r={nodes:Ct(this.lastLayoutNodes),edges:Lt(this.lastLayoutEdges)};return this.lastAssign&&r.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,g,p,v,y,m,w,x,E,N,M,S,k,A,R,I,_,D,O=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=i.map((function(t){var e,r;return n(n({},b(t)),{x:null===(e=t.data)||void 0===e?void 0:e.x,y:null===(r=t.data)||void 0===r?void 0:r.y})})),d=s.map((function(t){return b(t)})),this.lastLayoutNodes=u,this.lastLayoutEdges=d,this.lastAssign=t,this.lastGraph=e,h=o.alphaMin,c=o.alphaDecay,l=o.alpha,f=o.nodeStrength,g=o.edgeStrength,p=o.linkDistance,v=o.clustering,y=o.clusterFociStrength,m=o.clusterEdgeDistance,w=o.clusterEdgeStrength,x=o.clusterNodeStrength,E=o.clusterNodeSize,N=o.collideStrength,M=void 0===N?1:N,S=o.center,k=void 0===S?[0,0]:S,A=o.preventOverlap,R=o.nodeSize,I=o.nodeSpacing,_=o.onTick,D=o.forceSimulation,[2,new Promise((function(r){if(D){v&&((i=Pt()).nodes(u),i.links(d)),D.nodes(u),d&&(s=At().id((function(t){return t.id})).links(d),g&&s.strength(g),p&&s.distance(p),D.force("link",s)),A&&O.overlapProcess(D,{nodeSize:R,nodeSpacing:I,collideStrength:M}),D.alpha(l).restart();var n=Ct(u),o=Lt(d);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:o})}else try{var i,a=Mt();if(f&&a.strength(f),D=Nt().nodes(u),v&&((i=Pt()).centerX(k[0]).centerY(k[1]).template("force").strength(y),d&&i.links(d),u&&i.nodes(u),i.forceLinkDistance(m).forceLinkStrength(w).forceCharge(x).forceNodeSize(E),D.force("group",i)),D.force("center",function(t,e){var r,n=1;function o(){var o,i,a=r.length,s=0,u=0;for(o=0;o<a;++o)s+=(i=r[o]).x,u+=i.y;for(s=(s/a-t)*n,u=(u/a-e)*n,o=0;o<a;++o)(i=r[o]).x-=s,i.y-=u}return null==t&&(t=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(n=+t,o):n},o}(k[0],k[1])).force("charge",a).alpha(l).alphaDecay(c).alphaMin(h),A&&O.overlapProcess(D,{nodeSize:R,nodeSpacing:I,collideStrength:M}),d){var s=At().id((function(t){return t.id})).links(d);g&&s.strength(g),p&&s.distance(p),D.force("link",s)}D.on("tick",(function(){var r=Ct(u);null==_||_({nodes:r,edges:Lt(d)}),t&&r.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}))})).on("end",(function(){var n=Ct(u);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:Lt(d)})}))}catch(t){console.warn(t)}O.forceSimulation=D}))]}))}))},t.prototype.overlapProcess=function(t,e){var r,n,o=e.nodeSize,i=e.nodeSpacing,a=e.collideStrength;if(n=x(i)?function(){return i}:N(i)?i:function(){return 0},o)if(N(o))r=function(t){return o(t)+n(t)};else if(g(o)){var s=(o[0]>o[1]?o[0]:o[1])/2;r=function(t){return s+n(t)}}else if(x(o)){var u=o/2;r=function(t){return u+n(t)}}else r=function(){return 10};else r=function(t){return t.size?g(t.size)?(t.size[0]>t.size[1]?t.size[0]:t.size[1])/2+n(t):M(t.size)?(t.size.width>t.size.height?t.size.width:t.size.height)/2+n(t):t.size/2+n(t):10+n(t)};t.force("collisionForce",_t(r).strength(a))},t}(),Ct=function(t){return t.map((function(t){var e=t.x,r=t.y,i=o(t,["x","y"]);return n(n({},i),{data:n(n({},i.data),{x:e,y:r})})}))},Lt=function(t){return t.map((function(t){var e=t.source,r=t.target,i=o(t,["source","target"]);return n(n({},i),{source:e.id,target:r.id})}))};var qt=function(t,e){if("next"!==t&&"prev"!==t)return e},jt=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(function(){function t(){var t={};t.prev=t,t.next=t.prev,this.shortcut=t}return t.prototype.dequeue=function(){var t=this.shortcut,e=t.prev;if(e&&e!==t)return jt(e),e},t.prototype.enqueue=function(t){var e=this.shortcut;t.prev&&t.next&&jt(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e},t.prototype.toString=function(){for(var t=[],e=this.shortcut,r=e.prev;r!==e;)t.push(JSON.stringify(r,qt)),r=null==r?void 0:r.prev;return"["+t.join(", ")+"]"},t}()),Vt=function(){return 1},Gt=function(t,e,r,o,i){var a,s,u=[];return t.hasNode(o.v)&&(null===(a=t.getRelatedEdges(o.v,"in"))||void 0===a||a.forEach((function(o){var a=o.data.weight,s=t.getNode(o.source);i&&u.push({v:o.source,w:o.target,in:0,out:0}),void 0===s.data.out&&(s.data.out=0),s.data.out-=a,Wt(e,r,n({v:s.id},s.data))})),null===(s=t.getRelatedEdges(o.v,"out"))||void 0===s||s.forEach((function(o){var i=o.data.weight,a=o.target,s=t.getNode(a);void 0===s.data.in&&(s.data.in=0),s.data.in-=i,Wt(e,r,n({v:s.id},s.data))})),t.removeNode(o.v)),i?u:void 0},Wt=function(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},Bt=function(t,e){var r="greedy"===e?function(t,e){var r;if(t.getAllNodes().length<=1)return[];var o=function(t,e){var r=new l,o=0,i=0;t.getAllNodes().forEach((function(t){r.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((function(t){var a=r.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target})),s=(null==e?void 0:e(t))||1;a?r.updateEdgeData(null==a?void 0:a.id,n(n({},a.data),{weight:a.data.weight+s})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:s}}),i=Math.max(i,r.getNode(t.source).data.out+=s),o=Math.max(o,r.getNode(t.target).data.in+=s)}));for(var a=[],s=i+o+3,u=0;u<s;u++)a.push(new Ft);var d=o+1;return r.getAllNodes().forEach((function(t){Wt(a,d,n({v:t.id},r.getNode(t.id).data))})),{buckets:a,zeroIdx:d,graph:r}}(t,function(t){return t.data.weight||1}||Vt);return null===(r=function(t,e,r){for(var n,o=[],i=e[e.length-1],a=e[0];t.getAllNodes().length;){for(;n=a.dequeue();)Gt(t,e,r,n);for(;n=i.dequeue();)Gt(t,e,r,n);if(t.getAllNodes().length)for(var s=e.length-2;s>0;--s)if(n=e[s].dequeue()){o=o.concat(Gt(t,e,r,n,!0));break}}return o}(o.graph,o.buckets,o.zeroIdx).map((function(e){return t.getRelatedEdges(e.v,"out").filter((function(t){return t.target===e.w}))})))||void 0===r?void 0:r.flat()}(t):$t(t);null==r||r.forEach((function(e){var r=e.data;t.removeEdge(e.id),r.forwardName=e.data.name,r.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:n({},r)})}))},$t=function(t){var e=[],r={},n={},o=function(i){n[i]||(n[i]=!0,r[i]=!0,t.getRelatedEdges(i,"out").forEach((function(t){r[t.target]?e.push(t):o(t.target)})),delete r[i])};return t.getAllNodes().forEach((function(t){return o(t.id)})),e},Ut=function(t,e,r,n){var o;do{o=""+n+Math.random()}while(t.hasNode(o));return r.dummy=e,t.addNode({id:o,data:r}),o},Ht=function(t){var e=new l;return t.getAllNodes().forEach((function(r){t.getChildren(r.id).length||e.addNode(n({},r))})),t.getAllEdges().forEach((function(t){e.addEdge(t)})),e},Kt=function(t,e){var r,n,o=Number(t.x),i=Number(t.y),a=Number(e.x)-o,s=Number(e.y)-i,u=Number(t.width)/2,d=Number(t.height)/2;return a||s?(Math.abs(s)*u>Math.abs(a)*d?(s<0&&(d=-d),r=d*a/s,n=d):(a<0&&(u=-u),r=u,n=u*s/a),{x:o+r,y:i+n}):{x:0,y:0}},Yt=function(t){for(var e=[],r=Xt(t)+1,n=0;n<r;n++)e.push([]);for(t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)})),n=0;n<r;n++)e[n]=e[n].sort((function(e,r){return n=t.getNode(e).data.order,o=t.getNode(r).data.order,Number(n)-Number(o);var n,o}));return e},Jt=function(t,e,r,n){var o={width:0,height:0};return x(r)&&x(n)&&(o.rank=r,o.order=n),Ut(t,"border",o,e)},Xt=function(t){var e;return t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)})),e||(e=0),e},Qt=function(t,e){return t.reduce((function(t,r){return e(t)>e(r)?r:t}))},Zt=function(t,e,r,n,o,i){n.includes(e.id)||(n.push(e.id),r||i.push(e.id),o(e.id).forEach((function(e){return Zt(t,e,r,n,o,i)})),r&&i.push(e.id))},te=function(t,e,r,n){var o=Array.isArray(e)?e:[e],i=function(e){return n?t.getSuccessors(e):t.getNeighbors(e)},a=[],s=[];return o.forEach((function(e){if(!t.hasNode(e.id))throw new Error("Graph does not have node: "+e);Zt(t,e,"post"===r,s,i,a)})),a},ee="edge-label",re=function(t){var e={},r=function(n){var o,i,a=t.getNode(n);return a?e[n]?a.data.rank:(e[n]=!0,null===(o=t.getRelatedEdges(n,"out"))||void 0===o||o.forEach((function(t){var e=r(t.target)-t.data.minlen;e&&(void 0===i||e<i)&&(i=e)})),i||(i=0),a.data.rank=i,i):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){return r(t.id)}))},ne=function(t,e){return t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen},oe=function(t,e){var r=function(n){e.getRelatedEdges(n,"both").forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ie=function(t,e){var r=function(n){var o;null===(o=e.getRelatedEdges(n,"both"))||void 0===o||o.forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||void 0===e.getNode(a).data.layer&&ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ae=function(t,e){return Qt(e.getAllEdges(),(function(r){return t.hasNode(r.source)!==t.hasNode(r.target)?ne(e,r):1/0}))},se=function(t,e,r){t.getAllNodes().forEach((function(t){var n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r}))},ue=function(t,e){var r=te(t,t.getAllNodes(),"post",!1);(r=r.slice(0,(null==r?void 0:r.length)-1)).forEach((function(r){de(t,e,r)}))},de=function(t,e,r){var n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find((function(t){return t.target===n||t.source===n})).data.cutvalue=he(t,e,r)},he=function(t,e,r){var n=t.getNode(r).data.parent,o=!0,i=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),a=0;return i||(o=!1,i=e.getRelatedEdges(n,"out").find((function(t){return t.target===r}))),a=i.data.weight,e.getRelatedEdges(r,"both").forEach((function(e){var i=e.source===r,s=i?e.target:e.source;if(s!==n){var u=i===o,d=e.data.weight;if(a+=u?d:-d,ye(t,r,s)){var h=t.getRelatedEdges(r,"both").find((function(t){return t.source===s||t.target===s})).data.cutvalue;a+=u?-h:h}}})),a},ce=function(t,e){void 0===e&&(e=t.getAllNodes()[0].id),le(t,{},1,e)},le=function(t,e,r,n,o){var i,a=r,s=r,u=t.getNode(n);return e[n]=!0,null===(i=t.getNeighbors(n))||void 0===i||i.forEach((function(r){e[r.id]||(s=le(t,e,s,r.id,n))})),u.data.low=a,u.data.lim=s++,o?u.data.parent=o:delete u.data.parent,s},fe=function(t){return t.getAllEdges().find((function(t){return t.data.cutvalue<0}))},ge=function(t,e,r){var n=r.source,o=r.target;e.getRelatedEdges(n,"out").find((function(t){return t.target===o}))||(n=r.target,o=r.source);var i=t.getNode(n),a=t.getNode(o),s=i,u=!1;i.data.lim>a.data.lim&&(s=a,u=!0);var d=e.getAllEdges().filter((function(e){return u===me(t.getNode(e.source),s)&&u!==me(t.getNode(e.target),s)}));return Qt(d,(function(t){return ne(e,t)}))},pe=function(t,e,r,n){var o=t.getRelatedEdges(r.source,"both").find((function(t){return t.source===r.target||t.target===r.target}));o&&t.removeEdge(o.id),t.addEdge({id:"e"+Math.random(),source:n.source,target:n.target,data:{}}),ce(t),ue(t,e),ve(t,e)},ve=function(t,e){var r=t.getAllNodes().find((function(t){return!t.data.parent})),n=te(t,r,"pre",!1);(n=n.slice(1)).forEach((function(r){var n=t.getNode(r).data.parent,o=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),i=!1;!o&&e.hasNode(n)&&(o=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),i=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(i?null==o?void 0:o.data.minlen:-(null==o?void 0:o.data.minlen))}))},ye=function(t,e,r){return t.getRelatedEdges(e,"both").find((function(t){return t.source===r||t.target===r}))},me=function(t,e){return e.data.low<=t.data.lim&&t.data.lim<=e.data.lim},we=re,xe=function(t){!function(t){var e=function(t){var e=new l;return t.getAllNodes().forEach((function(t){e.addNode(n({},t))})),t.getAllEdges().forEach((function(t){var r=e.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target}));r?e.updateEdgeData(null==r?void 0:r.id,n(n({},r.data),{weight:r.data.weight+t.data.weight||0,minlen:Math.max(r.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e}(t);re(e);var r,o,i=function(t){var e,r,n=new l({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);oe(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r);return n}(e);for(ce(i),ue(i,e);r=fe(i);)o=ge(i,e,r),pe(i,e,r,o)}(t)},Ee=function(t,e,r,n,o,i,a){var s=t.getChildren(a);if(null==s?void 0:s.length){var u=Jt(t,"_bt"),d=Jt(t,"_bb"),h=t.getNode(a);t.setParent(u,a),h.data.borderTop=u,t.setParent(d,a),h.data.borderBottom=d,null==s||s.forEach((function(s){Ee(t,e,r,n,o,i,s.id);var h=s.data.borderTop?s.data.borderTop:s.id,c=s.data.borderBottom?s.data.borderBottom:s.id,l=s.data.borderTop?n:2*n,f=h!==c?1:o-i[a]+1;t.addEdge({id:"e"+Math.random(),source:u,target:h,data:{minlen:f,weight:l,nestingEdge:!0}}),t.addEdge({id:"e"+Math.random(),source:c,target:d,data:{minlen:f,weight:l,nestingEdge:!0}})})),t.getParent(a)||t.addEdge({id:"e"+Math.random(),source:e,target:u,data:{weight:0,minlen:o+i[a]}})}else a!==e&&t.addEdge({id:"e"+Math.random(),source:e,target:a,data:{weight:0,minlen:r}})},be=function(t,e,r,n,o,i){var a={rank:i,borderType:e,width:0,height:0},s=o.data[e][i-1],u=Ut(t,"border",a,r);o.data[e][i]=u,t.setParent(u,n),s&&t.addEdge({id:"e"+Math.random(),source:s,target:u,data:{weight:1}})},Ne=function(t){t.getAllNodes().forEach((function(t){Me(t)})),t.getAllEdges().forEach((function(t){Me(t)}))},Me=function(t){var e=t.data.width;t.data.width=t.data.height,t.data.height=e},Se=function(t){(null==t?void 0:t.y)&&(t.y=-t.y)},ke=function(t){var e=t.x;t.x=t.y,t.y=e},Ae=function(t){for(var e={},r=t.getAllNodes(),n=r.map((function(t){var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),o=Math.max.apply(Math,u([],s(n))),i=[],a=0;a<o+1;a++)i.push([]);var d=r.sort((function(e,r){return t.getNode(e.id).data.rank-t.getNode(r.id).data.rank})),h=d.filter((function(e){return void 0!==t.getNode(e.id).data.fixorder})).sort((function(e,r){return t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder}));return null==h||h.forEach((function(r){isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0})),null==d||d.forEach((function(r){return t.dfsTree(r.id,(function(t){if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)}))})),i},Re=function(t,e,r){for(var n=function(t,e){return null==t?void 0:t.reduce((function(t,r,n){return t[r]=e[n],t}),{})}(r,r.map((function(t,e){return e}))),o=e.map((function(e){var r=t.getRelatedEdges(e,"out").map((function(t){return{pos:n[t.target]||0,weight:t.data.weight}}));return null==r?void 0:r.sort((function(t,e){return t.pos-e.pos}))})),i=o.flat().filter((function(t){return void 0!==t})),a=1;a<r.length;)a<<=1;var s=2*a-1;a-=1;var u=Array(s).fill(0,0,s),d=0;return null==i||i.forEach((function(t){if(t){var e=t.pos+a;u[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=u[e+1]),u[e=e-1>>1]+=t.weight;d+=t.weight*r}})),d},Ie=function(t,e){for(var r=0,n=1;n<(null==e?void 0:e.length);n+=1)r+=Re(t,e[n-1],e[n]);return r},_e=function(t,e){var r,n=0,o=0;t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/o,t.weight=o,t.i=Math.min(e.i,t.i),e.merged=!0};const De=function(t,e){var r,n,o,i={};return null==t||t.forEach((function(t,e){i[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};var r=i[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)})),null===(r=e.getAllEdges())||void 0===r||r.forEach((function(t){var e=i[t.source],r=i[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(i[t.target]))})),function(t){for(var e,r,n=[],o=function(){var o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach((function(t){return(e=o,function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&_e(e,t)})(t);var e})),null===(r=o.out)||void 0===r||r.forEach((function(e){return(r=o,function(e){e.in.push(r),0==--e.indegree&&t.push(e)})(e);var r}))};null==t?void 0:t.length;)o();var i=n.filter((function(t){return!t.merged})),a=["vs","i","barycenter","weight"];return i.map((function(t){var e={};return null==a||a.forEach((function(r){void 0!==t[r]&&(e[r]=t[r])})),e}))}(null===(o=(n=Object.values(i)).filter)||void 0===o?void 0:o.call(n,(function(t){return!t.indegree})))};var Oe=function(t,e,r){for(var n,o=r;e.length&&(n=e[e.length-1]).i<=o;)e.pop(),null==t||t.push(n.vs),o++;return o},Pe=function(t,e,r,n,o,i){var a,s,u,d,h=t.getChildren(e).map((function(t){return t.id})),c=t.getNode(e),l=c?c.data.borderLeft:void 0,f=c?c.data.borderRight:void 0,g={};l&&(h=null==h?void 0:h.filter((function(t){return t!==l&&t!==f})));var p=function(t,e){return e.map((function(e){var r=t.getRelatedEdges(e,"in");if(!(null==r?void 0:r.length))return{v:e};var n={sum:0,weight:0};return null==r||r.forEach((function(e){var r=t.getNode(e.source);n.sum+=e.data.weight*r.data.order,n.weight+=e.data.weight})),{v:e,barycenter:n.sum/n.weight,weight:n.weight}}))}(t,h||[]);null==p||p.forEach((function(e){var o;if(null===(o=t.getChildren(e.v))||void 0===o?void 0:o.length){var a=Pe(t,e.v,r,n,i);g[e.v]=a,a.hasOwnProperty("barycenter")&&ze(e,a)}}));var v=De(p,r);Te(v,g),null===(a=v.filter((function(t){return t.vs.length>0})))||void 0===a||a.forEach((function(e){var r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)}));var y=function(t,e,r,n){var o=function(t,e){var r={lhs:[],rhs:[]};return null==t||t.forEach((function(t){var e,o;o=(e=t).hasOwnProperty("fixorder")&&!isNaN(e.fixorder),(n?!o&&e.hasOwnProperty("barycenter"):o||e.hasOwnProperty("barycenter"))?r.lhs.push(t):r.rhs.push(t)})),r}(t),i=o.lhs,a=o.rhs.sort((function(t,e){return-t.i- -e.i})),s=[],u=0,d=0,h=0;null==i||i.sort(function(t,e){return function(r,n){if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i}}(!!e,!!r)),h=Oe(s,a,h),null==i||i.forEach((function(t){var e;h+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),u+=t.barycenter*t.weight,d+=t.weight,h=Oe(s,a,h)}));var c={vs:s.flat()};return d&&(c.barycenter=u/d,c.weight=d),c}(v,n,o,i);if(l&&(y.vs=[l,y.vs,f].flat(),null===(s=t.getPredecessors(l))||void 0===s?void 0:s.length)){var m=t.getNode((null===(u=t.getPredecessors(l))||void 0===u?void 0:u[0].id)||""),w=t.getNode((null===(d=t.getPredecessors(f))||void 0===d?void 0:d[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+w.data.order)/(y.weight+2),y.weight+=2}return y},Te=function(t,e){null==t||t.forEach((function(t){var r,n=null===(r=t.vs)||void 0===r?void 0:r.map((function(t){return e[t]?e[t].vs:t}));t.vs=n.flat()}))},ze=function(t,e){void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},Ce=function(t){if("object"!=typeof t||null===t)return t;var e,r;if(r=t,Array.isArray?Array.isArray(r):w(r,"Array")){e=[];for(var n=0,o=t.length;n<o;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=Ce(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=Ce(t[i]):e[i]=t[i];return e};const Le=Ce;var qe=function(t,e,r){return e.map((function(e){return function(t,e,r){var o=function(t){for(var e;t.hasNode(e="_root"+Math.random()););return e}(t),i=new l({tree:[{id:o,children:[],data:{}}]});return t.getAllNodes().forEach((function(a){var s=t.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(n({},a)),(null==s?void 0:s.id)&&!i.hasNode(null==s?void 0:s.id)&&i.addNode(n({},s)),i.setParent(a.id,(null==s?void 0:s.id)||o),t.getRelatedEdges(a.id,r).forEach((function(e){var r=e.source===a.id?e.target:e.source;i.hasNode(r)||i.addNode(n({},t.getNode(r)));var o=i.getRelatedEdges(r,"out").find((function(t){return t.target===a.id})),s=void 0!==o?o.data.weight:0;o?i.updateEdgeData(o.id,n(n({},o.data),{weight:e.data.weight+s})):i.addEdge({id:e.id,source:r,target:a.id,data:{weight:e.data.weight+s}})})),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,n(n({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))})),i}(t,e,r)}))},je=function(t,e,r,n){var o=new l;null==t||t.forEach((function(t){for(var i,a=t.getRoots()[0].id,s=Pe(t,a,o,e,r,n),u=0;u<(null===(i=s.vs)||void 0===i?void 0:i.length);u++){var d=t.getNode(s.vs[u]);d&&(d.data.order=u)}!function(t,e,r){var n,o={};null==r||r.forEach((function(r){for(var i,a,s=t.getParent(r);s;){if((i=t.getParent(s.id))?(a=o[i.id],o[i.id]=s.id):(a=n,n=s.id),a&&a!==s.id)return e.addNodes([{id:a,data:{}},{id:s.id,data:{}}]),void e.addEdge({id:"e"+a+"-"+s.id,source:a,target:s.id,data:{}});s=i}}))}(t,o,s.vs)}))},Fe=function(t,e){null==e||e.forEach((function(e){null==e||e.forEach((function(e,r){t.getNode(e).data.order=r}))}))},Ve=function(t,e){var r={};function n(e,n,o,i,a){for(var s,u,d,h=n;h<o;h++)d=e[h],(null===(s=t.getNode(d))||void 0===s?void 0:s.data.dummy)&&(null===(u=t.getPredecessors(d))||void 0===u||u.forEach((function(e){var n=t.getNode(e.id);n.data.dummy&&(n.data.order<i||n.data.order>a)&&We(r,e.id,d)})))}function o(t,e){var r=function(t){return JSON.stringify(t.slice(1))}(t);e.get(r)||(n.apply(void 0,u([],s(t))),e.set(r,!0))}return(null==e?void 0:e.length)&&e.reduce((function(e,r){var n,i=-1,a=0,s=new Map;return null==r||r.forEach((function(u,d){var h;if("border"===(null===(h=t.getNode(u))||void 0===h?void 0:h.data.dummy)){var c=t.getPredecessors(u)||[];c.length&&(n=t.getNode(c[0].id).data.order,o([r,a,d,i,n],s),a=d,i=n)}o([r,a,r.length,n,e.length],s)})),r})),r},Ge=function(t,e){var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find((function(e){return t.getNode(e.id).data.dummy}))},We=function(t,e,r){var n=e,o=r;if(n>o){var i=n;n=o,o=i}var a=t[n];a||(t[n]=a={}),a[o]=!0},Be=function(t,e,r){var n=e;return n>r&&(n=r),!!t[n]},$e=function(t,e,r,o,i,a){var s=new l,u=Ue(o,i,a);return null==e||e.forEach((function(e){var o;null==e||e.forEach((function(e){var i=r[e];if(s.hasNode(i)||s.addNode({id:i,data:{}}),o){var a=r[o],d=s.getRelatedEdges(a,"out").find((function(t){return t.target===i}));d?s.updateEdgeData(d.id,n(n({},d.data),{weight:Math.max(u(t,e,o),d.data.weight||0)})):s.addEdge({id:"e"+Math.random(),source:a,target:i,data:{weight:Math.max(u(t,e,o),0)}})}o=e}))})),s};var Ue=function(t,e,r){return function(n,o,i){var a=n.getNode(o),s=n.getNode(i),u=0,d=0;if(u+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":d=-a.data.width/2;break;case"r":d=a.data.width/2}if(d&&(u+=r?d:-d),d=0,u+=(a.data.dummy?e:t)/2,u+=(s.data.dummy?e:t)/2,u+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":d=s.data.width/2;break;case"r":d=-s.data.width/2}return d&&(u+=r?d:-d),d=0,u}},He=function(t,e){return t.getNode(e).data.width||0},Ke=function(t,e){var r,n=Ht(t);!function(t,e){var r=(e||{}).ranksep,n=void 0===r?0:r,o=Yt(t),i=0;null==o||o.forEach((function(e){var r=e.map((function(e){return t.getNode(e).data.height})),o=Math.max.apply(Math,u(u([],s(r)),[0]));null==e||e.forEach((function(e){t.getNode(e).data.y=i+o/2})),i+=o+n}))}(n,e);var o=function(t,e){var r=e||{},n=r.align,o=r.nodesep,i=void 0===o?0:o,a=r.edgesep,d=void 0===a?0:a,h=Yt(t),c=Object.assign(function(t,e){var r={};return(null==e?void 0:e.length)&&e.reduce((function(e,n){var o=0,i=0,a=e.length,s=null==n?void 0:n[(null==n?void 0:n.length)-1];return null==n||n.forEach((function(e,u){var d,h=Ge(t,e),c=h?t.getNode(h.id).data.order:a;(h||e===s)&&(null===(d=n.slice(i,u+1))||void 0===d||d.forEach((function(e){var n;null===(n=t.getPredecessors(e))||void 0===n||n.forEach((function(n){var i,a=t.getNode(n.id),s=a.data.order;!(s<o||c<s)||a.data.dummy&&(null===(i=t.getNode(e))||void 0===i?void 0:i.data.dummy)||We(r,n.id,e)}))})),i=u+1,o=c)})),n})),r}(t,h),Ve(t,h)),l={},f=[];["u","d"].forEach((function(e){f="u"===e?h:Object.values(h).reverse(),["l","r"].forEach((function(r){"r"===r&&(f=f.map((function(t){return Object.values(t).reverse()})));var n=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),o=function(t,e,r,n){var o={},i={},a={};return null==e||e.forEach((function(t){null==t||t.forEach((function(t,e){o[t]=t,i[t]=t,a[t]=e}))})),null==e||e.forEach((function(t){var e=-1;null==t||t.forEach((function(t){var s=n(t).map((function(t){return t.id}));if(s.length){s=s.sort((function(t,e){return a[t]-a[e]}));for(var u=(s.length-1)/2,d=Math.floor(u),h=Math.ceil(u);d<=h;++d){var c=s[d];i[t]===t&&e<a[c]&&!Be(r,t,c)&&(i[c]=t,i[t]=o[t]=o[c],e=a[c])}}}))})),{root:o,align:i}}(0,f,c,n),a=function(t,e,r,n,o,i,a){var s,u={},d=$e(t,e,r,o,i,a),h=a?"borderLeft":"borderRight",c=function(t,e){for(var r=d.getAllNodes(),n=r.pop(),o={};n;)o[n.id]?t(n.id):(o[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return c((function(t){u[t]=(d.getRelatedEdges(t,"in")||[]).reduce((function(t,e){return Math.max(t,(u[e.source]||0)+e.data.weight)}),0)}),d.getPredecessors.bind(d)),c((function(e){var r=(d.getRelatedEdges(e,"out")||[]).reduce((function(t,e){return Math.min(t,(u[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==h&&(u[e]=Math.max(u[e],r))}),d.getSuccessors.bind(d)),null===(s=Object.values(n))||void 0===s||s.forEach((function(t){u[t]=u[r[t]]})),u}(t,f,o.root,o.align,i,d,"r"===r);"r"===r&&Object.keys(a).forEach((function(t){return a[t]=-a[t]})),l[e+r]=a}))}));var g=function(t,e){return Qt(Object.values(e),(function(e){var r,n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach((function(r){var i=e[r],a=He(t,r)/2;n=Math.max(i+a,n),o=Math.min(i-a,o)})),n-o}))}(t,l);return g&&function(t,e){var r=Object.values(e),n=Math.min.apply(Math,u([],s(r))),o=Math.max.apply(Math,u([],s(r)));["u","d"].forEach((function(r){["l","r"].forEach((function(i){var a,d=r+i,h=t[d];if(h!==e){var c=Object.values(h);(a="l"===i?n-Math.min.apply(Math,u([],s(c))):o-Math.max.apply(Math,u([],s(c))))&&(t[d]={},Object.keys(h).forEach((function(e){t[d][e]=h[e]+a})))}}))}))}(l,g),function(t,e){var r={};return Object.keys(t.ul).forEach((function(n){if(e)r[n]=t[e.toLowerCase()][n];else{var o=Object.values(t).map((function(t){return t[n]}));r[n]=(o[0]+o[1])/2}})),r}(l,n)}(n,e);null===(r=Object.keys(o))||void 0===r||r.forEach((function(t){n.getNode(t).data.x=o[t]}))},Ye=function(t,e){var r=e.acyclicer,o=e.ranker,i=e.rankdir,a=void 0===i?"tb":i,d=e.nodeOrder,h=e.keepNodeOrder,c=e.align,f=e.nodesep,g=void 0===f?50:f,p=e.edgesep,v=void 0===p?20:p,y=e.ranksep,m=void 0===y?50:y;dr(t),Bt(t,r);var w=function(t){var e=Ut(t,"root",{},"_root"),r=function(t){var e={},r=function(n,o){var i=t.getChildren(n);null==i||i.forEach((function(t){return r(t.id,o+1)})),e[n]=o};return t.getRoots().forEach((function(t){return r(t.id,1)})),e}(t),n=Math.max.apply(Math,u([],s(Object.values(r))));Math.abs(n)===1/0&&(n=1);var o=n-1,i=2*o+1;t.getAllEdges().forEach((function(t){t.data.minlen*=i}));var a=function(t){var e=0;return t.getAllEdges().forEach((function(t){e+=t.data.weight})),e}(t)+1;return t.getRoots().forEach((function(n){Ee(t,e,i,a,o,r,n.id)})),{nestingRoot:e,nodeRankFactor:i}}(t),x=w.nestingRoot,E=w.nodeRankFactor;!function(t,e){switch(e){case"network-simplex":xe(t);break;case"tight-tree":default:!function(t){!function(t){var e,r={},n=function(o){var i,a,s=t.getNode(o);return s?r[o]?s.data.rank:(r[o]=!0,null===(i=t.getRelatedEdges(o,"out"))||void 0===i||i.forEach((function(t){var e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),(void 0===e||a<e)&&(e=a),s.data.rank=a,a):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){t&&n(t.id)})),void 0===e&&(e=0);var o={},i=function(e,r){var n,a=t.getNode(e),s=isNaN(a.data.layer)?r:a.data.layer;(void 0===a.data.rank||a.data.rank<s)&&(a.data.rank=s),o[e]||(o[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach((function(t){i(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((function(t){var r=t.data;r&&(isNaN(r.layer)?r.rank-=e:i(t.id,r.layer))}))}(t),function(t){var e,r,n=new l({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);ie(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r)}(t)}(t);break;case"longest-path":we(t)}}(Ht(t),o),er(t),function(t,e){void 0===e&&(e=0);var r=t.getAllNodes(),n=r.filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),o=Math.min.apply(Math,u([],s(n))),i=[];r.forEach((function(t){var e=(t.data.rank||0)-o;i[e]||(i[e]=[]),i[e].push(t.id)}));for(var a=0,d=0;d<i.length;d++){var h=i[d];void 0===h?d%e!=0&&(a-=1):a&&(null==h||h.forEach((function(e){var r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=a)})))}}(t,E),function(t,e){e&&t.removeNode(e),t.getAllEdges().forEach((function(e){e.data.nestingEdge&&t.removeEdge(e.id)}))}(t,x),function(t){var e=t.getAllNodes().filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),r=Math.min.apply(Math,u([],s(e)));t.getAllNodes().forEach((function(t){t.data.hasOwnProperty("rank")&&r!==1/0&&(t.data.rank-=r)}))}(t),rr(t),nr(t);var b=[];!function(t,e){t.getAllEdges().forEach((function(r){return function(t,e,r){var n=e.source,o=t.getNode(n).data.rank,i=e.target,a=t.getNode(i).data.rank,s=e.data.labelRank;if(a!==o+1){var u,d,h;for(t.removeEdge(e.id),h=0,++o;o<a;++h,++o)e.data.points=[],u=Ut(t,"edge",d={originalEdge:e,width:0,height:0,rank:o},"_d"),o===s&&(d.width=e.data.width,d.height=e.data.height,d.dummy=ee,d.labelpos=e.data.labelpos),t.addEdge({id:"e"+Math.random(),source:n,target:u,data:{weight:e.data.weight}}),0===h&&r.push(u),n=u;t.addEdge({id:"e"+Math.random(),source:n,target:i,data:{weight:e.data.weight}})}}(t,r,e)}))}(t,b),function(t,e){var r=function(t){var e={},r=0,n=function(o){var i=r;t.getChildren(o).forEach((function(t){return n(t.id)})),e[o]={low:i,lim:r++}};return t.getRoots().forEach((function(t){return n(t.id)})),e}(t);e.forEach((function(e){var n,o,i=e,a=t.getNode(i),s=a.data.originalEdge;if(s)for(var u=function(t,e,r,n){var o,i,a,s,u=[],d=[],h=Math.min(e[r].low,e[n].low),c=Math.max(e[r].lim,e[n].lim);a=r;do{a=null===(o=t.getParent(a))||void 0===o?void 0:o.id,u.push(a)}while(a&&(e[a].low>h||c>e[a].lim));for(s=a,a=n;a&&a!==s;)d.push(a),a=null===(i=t.getParent(a))||void 0===i?void 0:i.id;return{lca:s,path:u.concat(d.reverse())}}(t,r,s.source,s.target),d=u.path,h=u.lca,c=0,l=d[c],f=!0;i!==s.target;){if(a=t.getNode(i),f){for(;l!==h&&(null===(n=t.getNode(l))||void 0===n?void 0:n.data.maxRank)<a.data.rank;)l=d[++c];l===h&&(f=!1)}if(!f){for(;c<d.length-1&&(null===(o=t.getNode(d[c+1]))||void 0===o?void 0:o.data.minRank)<=a.data.rank;)c++;l=d[c]}t.hasNode(l)&&t.setParent(i,l),i=t.getSuccessors(i)[0].id}}))}(t,b),function(t){var e=function(r){var n=t.getChildren(r),o=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach((function(t){return e(t.id)})),o.data.hasOwnProperty("minRank")){o.data.borderLeft=[],o.data.borderRight=[];for(var i=o.data.minRank,a=o.data.maxRank+1;i<a;i+=1)be(t,"borderLeft","_bl",r,o,i),be(t,"borderRight","_br",r,o,i)}};t.getRoots().forEach((function(t){return e(t.id)}))}(t),h&&function(t,e){for(var r=t.getAllNodes().filter((function(e){var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)})).map((function(t){return t.data.rank})),n=Math.max.apply(Math,u([],s(r))),o=[],i=0;i<n+1;i++)o[i]=[];null==e||e.forEach((function(e){var r=t.getNode(e);r&&!r.data.dummy&&(isNaN(r.data.rank)||(r.data.fixorder=o[r.data.rank].length,o[r.data.rank].push(e)))}))}(t,d),function(t,e){for(var r=Xt(t),n=[],o=[],i=1;i<r+1;i++)n.push(i);for(i=r-1;i>-1;i--)o.push(i);var a=qe(t,n,"in"),s=qe(t,o,"out"),u=Ae(t);Fe(t,u);for(var d,h=Number.POSITIVE_INFINITY,c=(i=0,0);c<4;++i,++c)je(i%2?a:s,i%4>=2,!1,e),u=Yt(t),(l=Ie(t,u))<h&&(c=0,d=Le(u),h=l);for(u=Ae(t),Fe(t,u),i=0,c=0;c<4;++i,++c){var l;je(i%2?a:s,i%4>=2,!0,e),u=Yt(t),(l=Ie(t,u))<h&&(c=0,d=Le(u),h=l)}Fe(t,d)}(t,h),hr(t),function(t,e){var r=e.toLowerCase();"lr"!==r&&"rl"!==r||Ne(t)}(t,a),Ke(t,{align:c,nodesep:g,edgesep:v,ranksep:m}),cr(t),ur(t),function(t,e){e.forEach((function(e){var r,n=t.getNode(e),o=n.data.originalEdge;o&&t.addEdge(o);for(var i=e;n.data.dummy;)r=t.getSuccessors(i)[0],t.removeNode(i),o.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===ee&&(o.data.x=n.data.x,o.data.y=n.data.y,o.data.width=n.data.width,o.data.height=n.data.height),i=r.id,n=t.getNode(i)}))}(t,b),ar(t),function(t,e){var r=e.toLowerCase();"bt"!==r&&"rl"!==r||function(t){t.getAllNodes().forEach((function(t){Se(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return Se(t)})),t.data.hasOwnProperty("y")&&Se(t.data)}))}(t),"lr"!==r&&"rl"!==r||(function(t){t.getAllNodes().forEach((function(t){ke(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return ke(t)})),t.data.hasOwnProperty("x")&&ke(t.data)}))}(t),Ne(t))}(t,a);var N=or(t),M=N.width,S=N.height;return ir(t),sr(t),function(t){t.getAllEdges().forEach((function(e){var r=e.data;if(r.reversed){t.removeEdge(e.id);var o=r.forwardName;delete r.reversed,delete r.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:n(n({},r),{forwardName:o})})}}))}(t),{width:M,height:S}},Je=["width","height","layer","fixorder"],Xe={width:0,height:0},Qe=["minlen","weight","width","height","labeloffset"],Ze={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},tr=["labelpos"],er=function(t){t.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var r=t.getNode(e.source),n={e,rank:(t.getNode(e.target).data.rank-r.data.rank)/2+r.data.rank};Ut(t,"edge-proxy",n,"_ep")}}))},rr=function(t){var e=0;return t.getAllNodes().forEach((function(r){var n,o;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(o=t.getNode(r.data.borderBottom))||void 0===o?void 0:o.data.rank,e=Math.max(e,r.data.maxRank||-1/0))})),e},nr=function(t){t.getAllNodes().forEach((function(e){"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},or=function(t,e){var r,n,o=0,i=0,a=e||{},s=a.marginx,u=void 0===s?0:s,d=a.marginy,h=void 0===d?0:d,c=function(t){if(t.data){var e=t.data.x,a=t.data.y,s=t.data.width,u=t.data.height;isNaN(e)||isNaN(s)||(void 0===r&&(r=e-s/2),r=Math.min(r,e-s/2),o=Math.max(o,e+s/2)),isNaN(a)||isNaN(u)||(void 0===n&&(n=a-u/2),n=Math.min(n,a-u/2),i=Math.max(i,a+u/2))}};return t.getAllNodes().forEach((function(t){c(t)})),t.getAllEdges().forEach((function(t){(null==t?void 0:t.data.hasOwnProperty("x"))&&c(t)})),r-=u,n-=h,t.getAllNodes().forEach((function(t){t.data.x-=r,t.data.y-=n})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){t.x-=r,t.y-=n})),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)})),{width:o-r+u,height:i-n+h}},ir=function(t){t.getAllEdges().forEach((function(e){var r,n,o=t.getNode(e.source),i=t.getNode(e.target);e.data.points?(r=e.data.points[0],n=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:i.data.x,y:i.data.y},n={x:o.data.x,y:o.data.y}),e.data.points.unshift(Kt(o.data,r)),e.data.points.push(Kt(i.data,n))}))},ar=function(t){t.getAllEdges().forEach((function(t){if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},sr=function(t){t.getAllEdges().forEach((function(t){var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},ur=function(t){t.getAllNodes().forEach((function(e){var r,n,o;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){var i=t.getNode(e.id),a=t.getNode(i.data.borderTop),s=t.getNode(i.data.borderBottom),u=t.getNode(i.data.borderLeft[(null===(n=i.data.borderLeft)||void 0===n?void 0:n.length)-1]),d=t.getNode(i.data.borderRight[(null===(o=i.data.borderRight)||void 0===o?void 0:o.length)-1]);i.data.width=Math.abs((null==d?void 0:d.data.x)-(null==u?void 0:u.data.x))||10,i.data.height=Math.abs((null==s?void 0:s.data.y)-(null==a?void 0:a.data.y))||10,i.data.x=((null==u?void 0:u.data.x)||0)+i.data.width/2,i.data.y=((null==a?void 0:a.data.y)||0)+i.data.height/2}})),t.getAllNodes().forEach((function(e){"border"===e.data.dummy&&t.removeNode(e.id)}))},dr=function(t){t.getAllEdges().forEach((function(e){if(e.source===e.target){var r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}}))},hr=function(t){var e=Yt(t);null==e||e.forEach((function(e){var r=0;null==e||e.forEach((function(e,n){var o,i=t.getNode(e);i.data.order=n+r,null===(o=i.data.selfEdges)||void 0===o||o.forEach((function(e){Ut(t,"selfedge",{width:e.data.width,height:e.data.height,rank:i.data.rank,order:n+ ++r,e},"_se")})),delete i.data.selfEdges}))}))},cr=function(t){t.getAllNodes().forEach((function(e){var r=t.getNode(e.id);if("selfedge"===r.data.dummy){var n=t.getNode(r.data.e.source),o=n.data.x+n.data.width/2,i=n.data.y,a=r.data.x-o,s=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}}))},lr=function(t,e){var r={};return null==e||e.forEach((function(e){void 0!==t[e]&&(r[e]=+t[e])})),r},fr=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(r){e[r.toLowerCase()]=t[r]})),e},gr={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="dagre",this.layoutNode=function(t){return t.data.layout},this.options=n(n({},gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericDagreLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericDagreLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericDagreLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,E,N,M,k,R,I,_,D,O,P,T,z,C,L,q,j,F,V,G,W=this;return a(this,(function(a){return o=n(n({},this.options),r),i=o.nodeSize,s=o.align,u=o.rankdir,d=void 0===u?"TB":u,h=o.ranksep,c=o.nodesep,f=o.ranksepFunc,g=o.nodesepFunc,p=o.edgeLabelSpace,v=o.nodeOrder,y=o.begin,m=o.controlPoints,w=o.radial,E=new l({tree:[]}),N=S(h||50,f),M=S(c||50,g),k=M,R=N,"LR"!==d&&"RL"!==d||(k=N,R=M),I=A(i,void 0),_=e.getAllNodes(),D=e.getAllEdges(),_.filter((function(t){return t.data.layout})).forEach((function(t){var e=I(t),r=R(t),n=e+2*k(t),o=e+2*r,i=t.data.layer;x(i)?E.addNode({id:t.id,data:{width:n,height:o,layer:i}}):E.addNode({id:t.id,data:{width:n,height:o}})})),D.forEach((function(t){W.layoutNode(E.getNode(t.source))&&W.layoutNode(E.getNode(t.target))&&E.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),function(t,e){var r,o,i=e.edgeLabelSpace,a=e.keepNodeOrder,s=e.prevGraph,u=e.rankdir,d=e.ranksep;!a&&s&&(o=s,(r=t).getAllNodes().forEach((function(t){var e=r.getNode(t.id),n=o.getNode(t.id);void 0!==n?(e.data.fixorder=n.data._order,delete n.data._order):delete e.data.fixorder})));var h=function(t){var e=new l({tree:[]});return t.getAllNodes().forEach((function(r){var o=fr(t.getNode(r.id).data),i=n(n({},Xe),o),a=lr(i,Je);e.hasNode(r.id)||e.addNode({id:r.id,data:n({},a)});var s=t.getParent(r.id);null==s||(e.hasNode(s.id)||e.addNode(n({},s)),e.setParent(r.id,s.id))})),t.getAllEdges().forEach((function(r){var n=fr(t.getEdge(r.id).data),o={};null==tr||tr.forEach((function(t){void 0!==n[t]&&(o[t]=n[t])})),e.addEdge({id:r.id,source:r.source,target:r.target,data:Object.assign({},Ze,lr(n,Qe),o)})})),e}(t);i&&(e.ranksep=function(t,e){var r=e.ranksep,n=void 0===r?0:r,o=e.rankdir;return t.getAllNodes().forEach((function(t){isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((function(t){var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===o||"BT"===o?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2}(h,{rankdir:u,ranksep:d}));try{Ye(h,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph\'s structure:\\n",t);throw t}!function(t,e){t.getAllNodes().forEach((function(r){var n,o=t.getNode(r.id);if(o){var i=e.getNode(r.id);o.data.x=i.data.x,o.data.y=i.data.y,o.data._order=i.data.order,o.data._rank=i.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(o.data.width=i.data.width,o.data.height=i.data.height)}})),t.getAllEdges().forEach((function(r){var n=t.getEdge(r.id),o=e.getEdge(r.id);n.data.points=o?o.data.points:[],o&&o.data.hasOwnProperty("x")&&(n.data.x=o.data.x,n.data.y=o.data.y)}))}(t,h)}(E,{prevGraph:null,edgeLabelSpace:p,keepNodeOrder:!!v,nodeOrder:v||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:d,nodesep:c,align:s}),O=[0,0],y&&(P=1/0,T=1/0,E.getAllNodes().forEach((function(t){P>t.data.x&&(P=t.data.x),T>t.data.y&&(T=t.data.y)})),E.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){P>t.x&&(P=t.x),T>t.y&&(T=t.y)}))})),O[0]=y[0]-P,O[1]=y[1]-T),z="LR"===d||"RL"===d,w||(C=new Set,L="BT"===d||"RL"===d?function(t,e){return e-t}:function(t,e){return t-e},E.getAllNodes().forEach((function(t){t.data.x=t.data.x+O[0],t.data.y=t.data.y+O[1],C.add(z?t.data.x:t.data.y)})),q=Array.from(C).sort(L),j=z?function(t,e){return t.x!==e.x}:function(t,e){return t.y!==e.y},F=z?function(t,e,r){var n=Math.max(e.y,r.y),o=Math.min(e.y,r.y);return t.filter((function(t){return t.y<=n&&t.y>=o}))}:function(t,e,r){var n=Math.max(e.x,r.x),o=Math.min(e.x,r.x);return t.filter((function(t){return t.x<=n&&t.x>=o}))},E.getAllEdges().forEach((function(t,e){var r;p&&m&&"loop"!==t.data.type&&(t.data.controlPoints=vr(null===(r=t.data.points)||void 0===r?void 0:r.map((function(t){var e=t.x,r=t.y;return{x:e+O[0],y:r+O[1]}})),E.getNode(t.source),E.getNode(t.target),q,z,j,F))}))),V=[],V=E.getAllNodes().map((function(t){return b(t)})),G=E.getAllEdges(),t&&(V.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),G.forEach((function(t){e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),[2,{nodes:V,edges:G}]}))}))},t}(),vr=function(t,e,r,n,o,i,a){var s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){var u=e.data,d=u.x,h=u.y,c=r.data,l=c.x,f=c.y;if(o&&(d=e.data.y,h=e.data.x,l=r.data.y,f=r.data.x),f!==h&&d!==l){var g=n.indexOf(h),p=n[g+1];if(p){var v=s[0],y=o?{x:(h+p)/2,y:(null==v?void 0:v.y)||l}:{x:(null==v?void 0:v.x)||l,y:(h+p)/2};v&&!i(v,y)||s.unshift(y)}var m=n.indexOf(f),w=Math.abs(m-g);if(1===w)(s=a(s,e.data,r.data)).length||s.push(o?{x:(h+f)/2,y:d}:{x:d,y:(h+f)/2});else if(w>1){var x=n[m-1];if(x){var E=s[s.length-1],b=o?{x:(f+x)/2,y:(null==E?void 0:E.y)||l}:{x:(null==E?void 0:E.x)||d,y:(f+x)/2};E&&!i(E,b)||s.push(b)}}}}return s};function yr(t){var e=0,r=0,n=0;if(t.length){for(var o=0;o<4;o++)(i=t[o])&&i.weight&&(e+=i.weight,r+=i.x*i.weight,n+=i.y*i.weight);t.x=r/e,t.y=n/e,t.weight=e}else{var i=t;t.x=i.data.x,t.y=i.data.y,t.weight=i.data.weight}}var mr=function(t,e,r,n,o,i){var a=i.x-t.x||.1,s=i.y-t.y||.1,u=n-e,d=a*a+s*s,h=Math.sqrt(d)*d;if(u*u*.81<d){var c=t.weight/h;return i.vx+=a*c,i.vy+=s*c,!0}if(t.length)return!1;t.data!==i&&(c=t.data.weight/h,i.vx+=a*c,i.vy+=s*c)},wr={maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},xr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=n(n({},wr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,E,b,N,M,S,k=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=this.formatOptions(o,e),d=u.width,h=u.height,c=u.nodeSize,f=u.getMass,g=u.nodeStrength,p=u.edgeStrength,v=u.linkDistance,y=i.map((function(t){return n(n({},t),{data:n(n({},t.data),{x:x(t.data.x)?t.data.x:Math.random()*d,y:x(t.data.y)?t.data.y:Math.random()*h,size:c(t)||30,mass:f(t),nodeStrength:g(t)})})})),m=s.map((function(t){return n(n({},t),{data:n(n({},t.data),{edgeStrength:p(t),linkDistance:v(t,e.getNode(t.source),e.getNode(t.target))})})})),(null==i?void 0:i.length)?(w={},i.forEach((function(t,e){w[t.id]={x:0,y:0}})),E=new l({nodes:y,edges:m}),this.formatCentripetal(u,E),b=u.maxIteration,N=u.minMovement,M=u.onTick,this.lastLayoutNodes=y,this.lastLayoutEdges=m,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=E,this.lastOptions=u,this.lastVelMap=w,"undefined"==typeof window?[2]:(S=0,[2,new Promise((function(r){k.timeInterval=window.setInterval((function(){i&&k.running||r({nodes:Sr(e,y),edges:s}),k.runOneStep(E,e,S,w,u),k.updatePosition(e,E,w,u),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),null==M||M({nodes:Sr(e,y),edges:s}),(++S>=b||k.judgingDistance<N)&&(window.clearInterval(k.timeInterval),r({nodes:Sr(e,y),edges:s}))}),0),k.running=!0}))])):(this.lastResult={nodes:[],edges:s},[2,{nodes:[],edges:s}])}))}))},t.prototype.formatOptions=function(t,e){var r=t,n=t.width,o=t.height,i=t.getMass;if(r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=o||"undefined"==typeof window?o:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),i||(r.getMass=function(t){var r=1;x(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);var n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),t.preventOverlap){var a=S(0,t.nodeSpacing);t.nodeSize?g(t.nodeSize)?r.nodeSize=function(e){var r=t.nodeSize;return Math.max(r[0],r[1])+a(e)}:r.nodeSize=function(e){return t.nodeSize+a(e)}:r.nodeSize=function(t){var e=((null==t?void 0:t.data)||{}).size;return e?g(e)?Math.max(e[0],e[1])+a(t):M(e)?Math.max(e.width,e.height)+a(t):e+a(t):10+a(t)}}return r.linkDistance=t.linkDistance?S(1,t.linkDistance):function(t){return 1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target))},r.nodeStrength=S(1,t.nodeStrength),r.edgeStrength=S(1,t.edgeStrength),t},t.prototype.formatCentripetal=function(t,e){var r,n=t.centripetalOptions,o=t.center,i=t.clusterNodeStrength,a=t.leafCluster,s=t.clustering,u=t.nodeClusterBy,d=e.getAllNodes(),h=n||{leaf:2,single:2,others:1,center:function(t){return{x:o[0],y:o[1]}}};"function"!=typeof i&&(t.clusterNodeStrength=function(t){return i});var c=[];if(a&&u&&(r=Er(e,u),c=Array.from(new Set(null==d?void 0:d.map((function(t){return t.data[u]}))))||[],t.centripetalOptions=Object.assign(h,{single:100,leaf:function(e){var n=r[e.id]||{},o=n.siblingLeaves,i=n.sameTypeLeaves;return(null==i?void 0:i.length)===(null==o?void 0:o.length)||1===(null==c?void 0:c.length)?1:t.clusterNodeStrength(e)},others:1,center:function(t){var n,o=e.getDegree(t.id,"both");if(!o)return{x:100,y:100};if(1===o){var i=(r[t.id]||{}).sameTypeLeaves,a=void 0===i?[]:i;1===a.length?n=void 0:a.length>1&&(n=Mr(a))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y}}})),s&&u){r||(r=Er(e,u)),c||(c=Array.from(new Set(d.map((function(t){return t.data[u]}))))),c=c.filter((function(t){return void 0!==t}));var l={};c.forEach((function(t){var r=d.filter((function(e){return e.data[u]===t})).map((function(t){return e.getNode(t.id)}));l[t]=Mr(r)})),t.centripetalOptions=Object.assign(h,{single:function(e){return t.clusterNodeStrength(e)},leaf:function(e){return t.clusterNodeStrength(e)},others:function(e){return t.clusterNodeStrength(e)},center:function(t){var e=l[t.data[u]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y}}})}var f=t.centripetalOptions||{},g=f.leaf,p=f.single,v=f.others;g&&"function"!=typeof g&&(t.centripetalOptions.leaf=function(){return g}),p&&"function"!=typeof p&&(t.centripetalOptions.single=function(){return p}),v&&"function"!=typeof v&&(t.centripetalOptions.others=function(){return v})},t.prototype.runOneStep=function(t,e,r,n,o){var i={},a=t.getAllNodes(),s=t.getAllEdges();if(null==a?void 0:a.length){var u=o.monitor;this.calRepulsive(t,i,o),s&&this.calAttractive(t,i),this.calGravity(t,e,i,o),this.updateVelocity(t,i,n,o),u&&u({energy:this.calTotalEnergy(i,a),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}},t.prototype.calTotalEnergy=function(t,e){if(!(null==e?void 0:e.length))return 0;var r=0;return e.forEach((function(e,n){var o=t[e.id].x,i=t[e.id].y,a=o*o+i*i,s=e.data.mass;r+=(void 0===s?1:s)*a*.5})),r},t.prototype.calRepulsive=function(t,e,r){var n=r.factor,o=r.coulombDisScale;!function(t,e,r,n){var o=e/r,i=t.getAllNodes(),a=i.map((function(t,e){var r=t.data,n=r.nodeStrength;return{x:r.x,y:r.y,size:r.size,index:e,vx:0,vy:0,weight:o*n}})),s=F(a,(function(t){return t.x}),(function(t){return t.y})).visitAfter(yr);a.forEach((function(t){!function(t,e){e.visit((function(e,r,n,o,i){return mr(e,r,n,o,i,t)}))}(t,s)})),a.map((function(t,e){var r=i[e],o=r.id,a=r.data.mass,s=void 0===a?1:a;n[o]={x:t.vx/s,y:t.vy/s}}))}(t,n,o*o,e)},t.prototype.calAttractive=function(t,e){t.getAllEdges().forEach((function(r,n){var o=r.source,i=r.target,a=t.getNode(o),s=t.getNode(i);if(a&&s){var u=s.data.x-a.data.x,d=s.data.y-a.data.y;u||d||(u=.01*Math.random(),d=.01*Math.random());var h=Math.sqrt(u*u+d*d),c=u/h,l=d/h,f=r.data||{},g=f.linkDistance,p=void 0===g?200:g,v=f.edgeStrength,y=(p-h)*(void 0===v?200:v),m=1/(a.data.mass||1),w=1/(s.data.mass||1),x=c*y,E=l*y;e[o].x-=x*m,e[o].y-=E*m,e[i].x+=x*w,e[i].y+=E*w}}))},t.prototype.calGravity=function(t,e,r,n){var o=n.getCenter,i=t.getAllNodes(),a=e.getAllNodes(),u=e.getAllEdges(),d=n.width,h=n.height,c=n.center,l=n.gravity,f=n.centripetalOptions;i&&i.forEach((function(n){var i=n.id,g=n.data,p=g.mass,v=g.x,y=g.y,m=e.getNode(i),w=0,E=0,b=l,N=t.getDegree(i,"in"),M=t.getDegree(i,"out"),S=t.getDegree(i,"both"),k=null==o?void 0:o(m,S);if(k){var A=s(k,3);w=v-A[0],E=y-A[1],b=A[2]}else w=v-c[0],E=y-c[1];if(b&&(r[i].x-=b*w/p,r[i].y-=b*E/p),f){var R=f.leaf,I=f.single,_=f.others,D=f.center,O=(null==D?void 0:D(m,a,u,d,h))||{x:0,y:0,centerStrength:0},P=O.x,T=O.y,z=O.centerStrength;if(!x(P)||!x(T))return;var C=(v-P)/p,L=(y-T)/p;if(z&&(r[i].x-=z*C,r[i].y-=z*L),0===S){var q=I(m);if(!q)return;return r[i].x-=q*C,void(r[i].y-=q*L)}if(0===N||0===M){var j=R(m,a,u);if(!j)return;return r[i].x-=j*C,void(r[i].y-=j*L)}var F=_(m);if(!F)return;r[i].x-=F*C,r[i].y-=F*L}}))},t.prototype.updateVelocity=function(t,e,r,n){var o=n.damping,i=n.maxSpeed,a=n.interval,s=t.getAllNodes();(null==s?void 0:s.length)&&s.forEach((function(t){var n=t.id,s=(r[n].x+e[n].x*a)*o||.01,u=(r[n].y+e[n].y*a)*o||.01,d=Math.sqrt(s*s+u*u);if(d>i){var h=i/d;s*=h,u*=h}r[n]={x:s,y:u}}))},t.prototype.updatePosition=function(t,e,r,n){var o=this,i=n.distanceThresholdMode,a=n.interval,s=e.getAllNodes();if(null==s?void 0:s.length){var u=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),s.forEach((function(n){var s=n.id,d=t.getNode(s);if(x(d.data.fx)&&x(d.data.fy))e.mergeNodeData(s,{x:d.data.fx,y:d.data.fy});else{var h=r[s].x*a,c=r[s].y*a;e.mergeNodeData(s,{x:n.data.x+h,y:n.data.y+c});var l=Math.sqrt(h*h+c*c);switch(i){case"max":o.judgingDistance<l&&(o.judgingDistance=l);break;case"min":o.judgingDistance>l&&(o.judgingDistance=l);break;default:u+=l}}})),i&&"mean"!==i||(this.judgingDistance=u/s.length)}else this.judgingDistance=0},t}(),Er=function(t,e){var r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};var n={};return r.forEach((function(r,o){1===t.getDegree(r.id,"both")&&(n[r.id]=br(t,"leaf",r,e))})),n},br=function(t,e,r,n){var o=t.getDegree(r.id,"in"),i=t.getDegree(r.id,"out"),a=r,s=[];return 0===o?(a=t.getSuccessors(r.id)[0],s=t.getNeighbors(a.id)):0===i&&(a=t.getPredecessors(r.id)[0],s=t.getNeighbors(a.id)),s=s.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")})),{coreNode:a,siblingLeaves:s,sameTypeLeaves:Nr(t,e,n,r,s)}},Nr=function(t,e,r,n,o){var i=n.data[r]||"",a=(null==o?void 0:o.filter((function(t){return t.data[r]===i})))||[];return"leaf"===e&&(a=a.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")}))),a},Mr=function(t){var e={x:0,y:0};t.forEach((function(t){var r=t.data,n=r.x,o=r.y;e.x+=n||0,e.y+=o||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},Sr=function(t,e){return e.map((function(e){var r=e.id,o=e.data,i=t.getNode(r);return n(n({},i),{data:n(n({},i.data),{x:o.x,y:o.y})})}))},kr=function(){function t(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}return t.prototype.distanceTo=function(t){var e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)},t.prototype.setPos=function(t,e){this.rx=t,this.ry=e},t.prototype.resetForce=function(){this.fx=0,this.fy=0},t.prototype.addForce=function(t){var e=t.rx-this.rx,r=t.ry-this.ry,n=Math.hypot(e,r);n=n<1e-4?1e-4:n;var o=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=o*e/n,this.fy+=o*r/n},t.prototype.in=function(t){return t.contains(this.rx,this.ry)},t.prototype.add=function(e){var r=this.mass+e.mass;return new t({rx:(this.rx*this.mass+e.rx*e.mass)/r,ry:(this.ry*this.mass+e.ry*e.mass)/r,mass:r,degree:this.degree+e.degree})},t}();const Ar=kr;const Rr=function(){function t(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}return t.prototype.getLength=function(){return this.length},t.prototype.contains=function(t,e){var r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r},t.prototype.NW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.NE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.SW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t.prototype.SE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t}(),Ir=function(){function t(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}return t.prototype.insert=function(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e},t.prototype._putBody=function(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))},t.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},t.prototype.updateForce=function(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))},t}();var _r={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Dr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2",this.options=n(n({},_r),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,x,E,N,M,S,k,A,I;return a(this,(function(a){if(o=e.getAllEdges(),i=e.getAllNodes(),s=this.formatOptions(r,i.length),u=s.width,d=s.height,h=s.prune,c=s.maxIteration,f=s.nodeSize,g=s.center,!(null==i?void 0:i.length)||1===i.length)return[2,R(e,t,g)];if(p=i.map((function(t){return b(t,[u,d])})),v=o.filter((function(t){return t.source!==t.target})),y=new l({nodes:p,edges:v}),m=this.getSizes(y,e,f),this.run(y,e,c,m,t,s),h){for(w=0;w<v.length;w+=1)x=v[w],E=x.source,N=x.target,M=y.getDegree(E),S=y.getDegree(E),M<=1?(k=y.getNode(N),y.mergeNodeData(E,{x:k.data.x,y:k.data.y})):S<=1&&(A=y.getNode(E),y.mergeNodeData(N,{x:A.data.x,y:A.data.y}));I=n(n({},s),{prune:!1,barnesHut:!1}),this.run(y,e,100,m,t,I)}return[2,{nodes:p,edges:o}]}))}))},t.prototype.getSizes=function(t,e,r){for(var n=t.getAllNodes(),o={},i=0;i<n.length;i+=1){var a=n[i],d=a.id,h=a.data;if(o[d]=10,x(h.size))o[d]=h.size;else if(g(h.size))isNaN(h.size[0])||(o[d]=Math.max(h.size[0])),isNaN(h.size[1])||(o[d]=Math.max(h.size[1]));else if(M(h.size))o[d]=Math.max(h.size.width,h.size.height);else if(N(r)){var c=r(e.getNode(d));g(c)?o[d]=Math.max.apply(Math,u([],s(c))):o[d]=c}else g(r)?o[d]=Math.max.apply(Math,u([],s(r))):x(r)&&(o[d]=r)}return o},t.prototype.formatOptions=function(t,e){void 0===t&&(t={});var r=n(n({},this.options),t),o=r.center,i=r.width,a=r.height,s=r.barnesHut,u=r.prune,d=r.maxIteration,h=r.kr,c=r.kg;return r.width=i||"undefined"==typeof window?i:window.innerWidth,r.height=a||"undefined"==typeof window?a:window.innerHeight,r.center=o||[r.width/2,r.height/2],void 0===s&&e>250&&(r.barnesHut=!0),void 0===u&&e>100&&(r.prune=!0),0!==d||u?0===d&&u&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)):(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)),h||(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),c||(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r},t.prototype.run=function(t,e,r,n,o,i){for(var a=i.kr,s=i.barnesHut,u=i.onTick,d=t.getAllNodes(),h=0,c=r,l={},f={},g={},p=0;p<d.length;p+=1){var v=d[p],y=v.data,m=v.id;if(l[m]=[0,0],s){var w={id:p,rx:y.x,ry:y.y,mass:1,g:a,degree:t.getDegree(m)};g[m]=new Ar(w)}}for(;c>0;)h=this.oneStep(t,{iter:c,preventOverlapIters:50,krPrime:100,sg:h,forces:l,preForces:f,bodies:g,sizes:n},i),c--,null==u||u({nodes:d,edges:e.getAllEdges()});return t},t.prototype.oneStep=function(t,e,r){for(var n=e.iter,o=e.preventOverlapIters,i=e.krPrime,a=e.sg,d=e.preForces,h=e.bodies,c=e.sizes,l=e.forces,f=r.preventOverlap,g=r.barnesHut,p=t.getAllNodes(),v=0;v<p.length;v+=1){var y=p[v].id;d[y]=u([],s(l[y])),l[y]=[0,0]}return l=this.getAttrForces(t,n,o,c,l,r),l=g&&(f&&n>o||!f)?this.getOptRepGraForces(t,l,h,r):this.getRepGraForces(t,n,o,l,i,c,r),this.updatePos(t,l,d,a,r)},t.prototype.getAttrForces=function(t,e,r,n,o,i){for(var a=i.preventOverlap,s=i.dissuadeHubs,u=i.mode,d=i.prune,h=t.getAllEdges(),c=0;c<h.length;c+=1){var l=h[c],f=l.source,g=l.target,p=t.getNode(f),v=t.getNode(g),y=t.getDegree(f),m=t.getDegree(g);if(!d||!(y<=1||m<=1)){var w=[v.data.x-p.data.x,v.data.y-p.data.y],x=Math.hypot(w[0],w[1]);x=x<1e-4?1e-4:x,w[0]=w[0]/x,w[1]=w[1]/x,a&&e<r&&(x=x-n[f]-n[g]);var E=x,b=E;"linlog"===u&&(b=E=Math.log(1+x)),s&&(E=x/y,b=x/m),a&&e<r&&x<=0?(E=0,b=0):a&&e<r&&x>0&&(E=x,b=x),o[f][0]+=E*w[0],o[g][0]-=b*w[0],o[f][1]+=E*w[1],o[g][1]-=b*w[1]}}return o},t.prototype.getOptRepGraForces=function(t,e,r,n){for(var o=n.kg,i=n.center,a=n.prune,s=t.getAllNodes(),u=s.length,d=9e10,h=-9e10,c=9e10,l=-9e10,f=0;f<u;f+=1){var g=s[f],p=g.id,v=g.data;a&&t.getDegree(p)<=1||(r[p].setPos(v.x,v.y),v.x>=h&&(h=v.x),v.x<=d&&(d=v.x),v.y>=l&&(l=v.y),v.y<=c&&(c=v.y))}var y=Math.max(h-d,l-c),m=new Rr({xmid:(h+d)/2,ymid:(l+c)/2,length:y,massCenter:i,mass:u}),w=new Ir(m);for(f=0;f<u;f+=1)p=s[f].id,a&&t.getDegree(p)<=1||r[p].in(m)&&w.insert(r[p]);for(f=0;f<u;f+=1){var x=s[f],E=(p=x.id,v=x.data,t.getDegree(p));if(!(a&&E<=1)){r[p].resetForce(),w.updateForce(r[p]),e[p][0]-=r[p].fx,e[p][1]-=r[p].fy;var b=[v.x-i[0],v.y-i[1]],N=Math.hypot(b[0],b[1]);N=N<1e-4?1e-4:N,b[0]=b[0]/N,b[1]=b[1]/N;var M=o*(E+1);e[p][0]-=M*b[0],e[p][1]-=M*b[1]}}return e},t.prototype.getRepGraForces=function(t,e,r,n,o,i,a){for(var s=a.preventOverlap,u=a.kr,d=a.kg,h=a.center,c=a.prune,l=t.getAllNodes(),f=l.length,g=0;g<f;g+=1){for(var p=l[g],v=t.getDegree(p.id),y=g+1;y<f;y+=1){var m=l[y],w=t.getDegree(m.id);if(!c||!(v<=1||w<=1)){var x=[m.data.x-p.data.x,m.data.y-p.data.y],E=Math.hypot(x[0],x[1]);E=E<1e-4?1e-4:E,x[0]=x[0]/E,x[1]=x[1]/E,s&&e<r&&(E=E-i[p.id]-i[m.id]);var b=u*(v+1)*(w+1)/E;s&&e<r&&E<0?b=o*(v+1)*(w+1):s&&e<r&&0===E?b=0:s&&e<r&&E>0&&(b=u*(v+1)*(w+1)/E),n[p.id][0]-=b*x[0],n[m.id][0]+=b*x[0],n[p.id][1]-=b*x[1],n[m.id][1]+=b*x[1]}}var N=[p.data.x-h[0],p.data.y-h[1]],M=Math.hypot(N[0],N[1]);N[0]=N[0]/M,N[1]=N[1]/M;var S=d*(v+1);n[p.id][0]-=S*N[0],n[p.id][1]-=S*N[1]}return n},t.prototype.updatePos=function(t,e,r,n,o){for(var i=o.ks,a=o.tao,s=o.prune,u=o.ksmax,d=t.getAllNodes(),h=d.length,c=[],l=[],f=0,g=0,p=n,v=0;v<h;v+=1){var y=d[v].id,m=t.getDegree(y);if(!(s&&m<=1)){var w=[e[y][0]-r[y][0],e[y][1]-r[y][1]],E=Math.hypot(w[0],w[1]),b=[e[y][0]+r[y][0],e[y][1]+r[y][1]],N=Math.hypot(b[0],b[1]);c[v]=E,l[v]=N/2,f+=(m+1)*c[v],g+=(m+1)*l[v]}}var M=p;for(p=a*g/f,0!==M&&(p=p>1.5*M?1.5*M:p),v=0;v<h;v+=1){var S=d[v],k=(y=S.id,S.data);if(m=t.getDegree(y),!(s&&m<=1||x(k.fx)&&x(k.fy))){var A=i*p/(1+p*Math.sqrt(c[v])),R=Math.hypot(e[y][0],e[y][1]),I=u/(R=R<1e-4?1e-4:R),_=(A=A>I?I:A)*e[y][0],D=A*e[y][1];t.mergeNodeData(y,{x:k.x+_,y:k.y+D})}}return p},t}(),Or={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=n(n({},Or),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericFruchtermanLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,x,E=this;return a(this,(function(a){return this.running?[2]:(o=this.formatOptions(r),i=o.width,s=o.height,u=o.center,d=o.clustering,h=o.nodeClusterBy,c=o.maxIteration,f=o.onTick,g=e.getAllNodes(),p=e.getAllEdges(),(null==g?void 0:g.length)?1===g.length?(t&&e.mergeNodeData(g[0].id,{x:u[0],y:u[1]}),v={nodes:[n(n({},g[0]),{data:n(n({},g[0].data),{x:u[0],y:u[1]})})],edges:p},this.lastResult=v,[2,v]):(y=g.map((function(t){return b(t,[i,s])})),m=new l({nodes:y,edges:p}),w={},d&&y.forEach((function(t){var e=t.data[h];w[e]||(w[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=y,this.lastLayoutEdges=p,this.lastAssign=t,this.lastGraph=m,this.lastOptions=o,this.lastClusterMap=w,"undefined"==typeof window?[2]:(x=0,[2,new Promise((function(r){E.timeInterval=window.setInterval((function(){E.running?(E.runOneStep(m,w,o),t&&y.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y})})),null==f||f({nodes:y,edges:p}),++x>=c&&(window.clearInterval(E.timeInterval),r({nodes:y,edges:p}))):r({nodes:y,edges:p})}),0),E.running=!0}))])):(v={nodes:[],edges:p},this.lastResult=v,[2,v]))}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=n(n({},this.options),t),r=e.clustering,o=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=r&&!!o,e},t.prototype.runOneStep=function(t,e,r){var n=r.height,o=r.width,i=r.gravity,a=r.center,s=r.speed,u=r.clustering,d=r.nodeClusterBy,h=r.clusterGravity,c=n*o,l=Math.sqrt(c)/10,f=t.getAllNodes(),g=c/(f.length+1),p=Math.sqrt(g),v={};if(this.applyCalculate(t,v,p,g),u){for(var y in e)e[y].cx=0,e[y].cy=0,e[y].count=0;for(var y in f.forEach((function(t){var r=t.data,n=e[r[d]];x(r.x)&&(n.cx+=r.x),x(r.y)&&(n.cy+=r.y),n.count++})),e)e[y].cx/=e[y].count,e[y].cy/=e[y].count;var m=h||i;f.forEach((function(t,r){var n=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=e[o[d]],a=Math.sqrt((o.x-i.cx)*(o.x-i.cx)+(o.y-i.cy)*(o.y-i.cy)),s=p*m;v[n].x-=s*(o.x-i.cx)/a,v[n].y-=s*(o.y-i.cy)/a}}))}f.forEach((function(t,e){var r=t.id,n=t.data;if(x(n.x)&&x(n.y)){var o=.01*p*i;v[r].x-=o*(n.x-a[0]),v[r].y-=o*(n.y-a[1])}})),f.forEach((function(e,r){var n=e.id,o=e.data;if(x(o.fx)&&x(o.fy))return o.x=o.fx,void(o.y=o.fy);if(x(o.x)&&x(o.y)){var i=Math.sqrt(v[n].x*v[n].x+v[n].y*v[n].y);if(i>0){var a=Math.min(l*(s/800),i);t.mergeNodeData(n,{x:o.x+v[n].x/i*a,y:o.y+v[n].y/i*a})}}}))},t.prototype.applyCalculate=function(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)},t.prototype.calRepulsive=function(t,e,r){var n=t.getAllNodes();n.forEach((function(t,o){var i=t.data,a=t.id;e[a]={x:0,y:0},n.forEach((function(t,n){var s=t.data,u=t.id;if(!(o<=n)&&x(i.x)&&x(s.x)&&x(i.y)&&x(s.y)){var d=i.x-s.x,h=i.y-s.y,c=d*d+h*h;0===c&&(c=1,d=.01,h=.01);var l=r/c,f=d*l,g=h*l;e[a].x+=f,e[a].y+=g,e[u].x-=f,e[u].y-=g}}))}))},t.prototype.calAttractive=function(t,e,r){t.getAllEdges().forEach((function(n){var o=n.source,i=n.target;if(o&&i&&o!==i){var a=t.getNode(o).data,s=t.getNode(i).data;if(x(s.x)&&x(a.x)&&x(s.y)&&x(a.y)){var u=s.x-a.x,d=s.y-a.y,h=Math.sqrt(u*u+d*d)/r,c=u*h,l=d*h;e[o].x+=c,e[o].y+=l,e[i].x-=c,e[i].y-=l}}}))},t}(),Tr={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},zr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="grid",this.options=n(n({},Tr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericGridLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericGridLayout(!0,t,e),[2]}))}))},t.prototype.genericGridLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,p,v,y,m,w,E,N,M,A,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.begin,s=void 0===i?[0,0]:i,u=o.condense,d=o.preventOverlapPadding,h=o.preventOverlap,c=o.rows,l=o.cols,f=o.nodeSpacing,p=o.nodeSize,v=o.width,y=o.height,m=o.position,w=o.sortBy,E=e.getAllNodes(),N=e.getAllEdges(),!(M=null==E?void 0:E.length)||1===M)return[2,R(e,t,s)];if(A=E.map((function(t){return b(t)})),"id"===w||P(w)&&void 0!==A[0].data[w]||(w="degree"),"degree"===w?A.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):"id"===w?A.sort((function(t,e){return x(e.id)&&x(t.id)?e.id-t.id:(""+t.id).localeCompare(""+e.id)})):A.sort((function(t,e){return e.data[w]-t.data[w]})),I=v||"undefined"==typeof window?v:window.innerWidth,_=y||"undefined"==typeof window?y:window.innerHeight,D=M,O={rows:c,cols:l},null!=c&&null!=l?(O.rows=c,O.cols=l):null!=c&&null==l?(O.rows=c,O.cols=Math.ceil(D/O.rows)):null==c&&null!=l?(O.cols=l,O.rows=Math.ceil(D/O.cols)):(T=Math.sqrt(D*_/I),O.rows=Math.round(T),O.cols=Math.round(I/_*T)),O.rows=Math.max(O.rows,1),O.cols=Math.max(O.cols,1),O.cols*O.rows>D)z=Cr(O),C=Lr(O),(z-1)*C>=D?Cr(O,z-1):(C-1)*z>=D&&Lr(O,C-1);else for(;O.cols*O.rows<D;)z=Cr(O),((C=Lr(O))+1)*z>=D?Lr(O,C+1):Cr(O,z+1);for(L=u?0:I/O.cols,q=u?0:_/O.rows,(h||f)&&(j=S(10,f),F=k(30,p,!1),A.forEach((function(t){t.data.x&&t.data.y||(t.data.x=0,t.data.y=0);var r,n,o=e.getNode(t.id),i=F(o)||30;g(i)?(r=i[0],n=i[1]):(r=i,n=i);var a=void 0!==j?j(t):d,s=r+a,u=n+a;L=Math.max(L,s),q=Math.max(q,u)}))),V={},G={row:0,col:0},W={},B=0;B<A.length;B++){if($=A[B],U=void 0,m&&(U=m(e.getNode($.id))),U&&(void 0!==U.row||void 0!==U.col)){if(void 0===(H={row:U.row,col:U.col}).col)for(H.col=0;qr(V,H);)H.col++;else if(void 0===H.row)for(H.row=0;qr(V,H);)H.row++;W[$.id]=H,jr(V,H)}Vr($,s,L,q,W,O,G,V)}return K={nodes:A,edges:N},t&&A.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,K]}))}))},t}(),Cr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.min(n,o):Math.min(n,o)===t.rows?t.rows=e:t.cols=e,r},Lr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.max(n,o):Math.max(n,o)===t.rows?t.rows=e:t.cols=e,r},qr=function(t,e){return t["c-"+e.row+"-"+e.col]||!1},jr=function(t,e){return t["c-"+e.row+"-"+e.col]=!0},Fr=function(t,e){var r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},Vr=function(t,e,r,n,o,i,a,s){var u,d,h=o[t.id];if(h)u=h.col*r+r/2+e[0],d=h.row*n+n/2+e[1];else{for(;qr(s,a);)Fr(i,a);u=a.col*r+r/2+e[0],d=a.row*n+n/2+e[1],jr(s,a),Fr(i,a)}t.data.x=u,t.data.y=d};const Gr=Object.prototype.toString;function Wr(t){return Gr.call(t).endsWith("Array]")}function Br(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!Wr(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]<a&&(a=t[s]);return a}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]>a&&(a=t[s]);return a}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,a=void 0===i?r.autoMinMax?n:0:i,s=r.max,u=void 0===s?r.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var d=(u-a)/(o-n),h=0;h<t.length;h++)e[h]=(t[h]-n)*d+a;return e}const $r=" ".repeat(2),Ur=" ".repeat(4);function Hr(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=e;return`${t.constructor.name} {\\n${$r}[\\n${Ur}${function(t,e,r,n,o){const{rows:i,columns:a}=t,s=Math.min(i,e),u=Math.min(a,r),d=[];if("auto"===o){o=!1;t:for(let e=0;e<s;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let e=0;e<s;e++){let r=[];for(let i=0;i<u;i++)r.push(Kr(t.get(e,i),n,o));d.push(`${r.join(" ")}`)}return u!==a&&(d[d.length-1]+=` ... ${a-r} more columns`),s!==i&&d.push(`... ${i-e} more rows`),d.join(`\\n${Ur}`)}(t,r,n,o,i)}\\n${$r}]\\n${$r}rows: ${t.rows}\\n${$r}columns: ${t.columns}\\n}`}function Kr(t,e,r){return(t>=0&&r?` ${Yr(t,e-1)}`:Yr(t,e)).padEnd(e)}function Yr(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function Jr(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function Xr(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function Qr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function Zr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function tn(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(rn("startRow",e),rn("endRow",r),rn("startColumn",n),rn("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function en(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function rn(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function nn(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class on{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new sn(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new sn(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new sn(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new sn(t,e)}static ones(t,e){return new sn(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new sn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)o.set(r,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let a=o-n,s=new sn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(i()*a);s.set(r,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let t=0;t<n;t++)o.set(t,t,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let e=0;e<o;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new sn(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return on.isMatrix(t)?t:new sn(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let a=o;a<e;a++){let e=t.get(r,a)-i*t.get(n,a);t.set(r,a,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new sn(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){Jr(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return sn.rowVector(this.getRow(t))}setRow(t,e){Jr(this,t),e=Qr(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){Jr(this,t),Jr(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){Xr(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return sn.columnVector(this.getColumn(t))}setColumn(t,e){Xr(this,t),e=Zr(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){Xr(this,t),Xr(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){Jr(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){Xr(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){nn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){nn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(Jr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){Jr(this,t),nn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(Jr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){Jr(this,t),nn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(Xr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){Xr(this,t),nn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(Xr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){Xr(this,t),nn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){on.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=sn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new sn(e,n),i=new Float64Array(r);for(let a=0;a<n;a++){for(let e=0;e<r;e++)i[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,a,e)}}return o}strassen2x2(t){t=sn.checkMatrix(t);let e=new sn(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),d=t.get(1,1),h=(r+u)*(n+d),c=(a+u)*n,l=r*(i-d),f=u*(s-n),g=(r+o)*d,p=h+f-g+(o-u)*(s+d),v=l+g,y=c+f,m=h-c+l+(a-r)*(n+i);return e.set(0,0,p),e.set(0,1,v),e.set(1,0,y),e.set(1,1,m),e}strassen3x3(t){t=sn.checkMatrix(t);let e=new sn(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),d=this.get(2,1),h=this.get(2,2),c=t.get(0,0),l=t.get(0,1),f=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),y=t.get(2,0),m=t.get(2,1),w=t.get(2,2),x=(r-i)*(-l+p),E=(-r+i+a)*(c-l+p),b=(i+a)*(-c+l),N=r*c,M=(-r+u+d)*(c-f+v),S=(-r+u)*(f-v),k=(u+d)*(-c+f),A=(-o+d+h)*(p+y-m),R=(o-h)*(p-m),I=o*y,_=(d+h)*(-y+m),D=(-o+a+s)*(v+y-w),O=(o-s)*(v-w),P=(a+s)*(-y+w),T=N+I+n*g,z=(r+n+o-i-a-d-h)*p+E+b+N+A+I+_,C=N+M+k+(r+n+o-a-s-u-d)*v+I+D+P,L=x+a*(-c+l+g-p-v-y+w)+E+N+I+D+O,q=x+E+b+N+s*m,j=I+D+O+P+i*f,F=N+M+S+d*(-c+f+g-p-v-y+m)+A+R+I,V=A+R+I+_+u*l,G=N+M+S+k+h*w;return e.set(0,0,T),e.set(0,1,z),e.set(0,2,C),e.set(1,0,L),e.set(1,1,q),e.set(1,2,j),e.set(2,0,F),e.set(2,1,V),e.set(2,2,G),e}mmulStrassen(t){t=sn.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function a(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=on.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${r} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let s=Math.max(r,o),u=Math.max(n,i);return e=a(e,s,u),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=a(e,n+1,o+1),r=a(r,n+1,o+1)):n%2==1?(e=a(e,n+1,o),r=a(r,n+1,o)):o%2==1&&(e=a(e,n,o+1),r=a(r,n,o+1));let i=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,s-1),d=r.subMatrix(0,i-1,0,s-1),h=e.subMatrix(0,i-1,s,e.columns-1),c=r.subMatrix(0,i-1,s,r.columns-1),l=e.subMatrix(i,e.rows-1,0,s-1),f=r.subMatrix(i,r.rows-1,0,s-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),p=r.subMatrix(i,r.rows-1,s,r.columns-1),v=t(on.add(u,g),on.add(d,p),i,s),y=t(on.add(l,g),d,i,s),m=t(u,on.sub(c,p),i,s),w=t(g,on.sub(f,d),i,s),x=t(on.add(u,h),p,i,s),E=t(on.sub(l,u),on.add(d,c),i,s),b=t(on.sub(h,g),on.add(f,p),i,s),N=on.add(v,w);N.sub(x),N.add(b);let M=on.add(m,x),S=on.add(y,w),k=on.sub(v,y);k.add(m),k.add(E);let A=on.zeros(2*N.rows,2*N.columns);return A=A.setSubMatrix(N,0,0),A=A.setSubMatrix(M,N.rows,0),A=A.setSubMatrix(S,0,N.columns),A=A.setSubMatrix(k,N.rows,N.columns),A.subMatrix(0,n-1,0,o-1)}(e,t=a(t,s,u),s,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new sn(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&Br(o,{min:e,max:r,output:o}),n.setRow(t,o)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new sn(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&Br(o,{min:e,max:r,output:o}),n.setColumn(t,o)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=sn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new sn(e*n,r*o);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<o;s++)i.set(n*a+r,o*e+s,this.get(a,e)*t.get(r,s));return i}kroneckerSum(t){if(t=sn.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(sn.eye(r,r)),o=sn.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new sn(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=an){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=an){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){tn(this,t,e,r,n);let o=new sn(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new sn(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new sn(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=sn.checkMatrix(t)).isEmpty())return this;tn(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){!function(t,e){if(!Wr(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!Wr(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new sn(t.length,e.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<e.length;t++){let i=e[t];r.set(n,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new sn(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=en(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=en(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=en(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=en(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Wr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<n;a++){let n=0,s=0,u=0;for(let e=0;e<o;e++)u=t.get(a,e)-r[a],n+=u,s+=u*u;e?i.push((s-n*n/o)/(o-1)):i.push((s-n*n/o)/o)}return i}(this,r,n);case"column":if(!Wr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<o;a++){let o=0,s=0,u=0;for(let e=0;e<n;e++)u=t.get(e,a)-r[a],o+=u,s+=u*u;e?i.push((s-o*o/n)/(n-1)):i.push((s-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let a=0,s=0,u=0;for(let e=0;e<n;e++)for(let n=0;n<o;n++)u=t.get(e,n)-r,a+=u,s+=u*u;return e?(s-a*a/i)/(i-1):(s-a*a/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Wr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!Wr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!Wr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!Wr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return Hr(this,t)}}function an(t,e){return t-e}on.prototype.klass="Matrix","undefined"!=typeof Symbol&&(on.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return Hr(this)}),on.random=on.rand,on.randomInt=on.randInt,on.diagonal=on.diag,on.prototype.diagonal=on.prototype.diag,on.identity=on.eye,on.prototype.negate=on.prototype.neg,on.prototype.tensorProduct=on.prototype.kroneckerProduct;class sn extends on{constructor(t,e){if(super(),sn.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Wr(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!r[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return Jr(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),Jr(this,t,!0),e=Float64Array.from(Qr(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){Xr(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),Xr(this,t,!0),e=Zr(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(on,sn);class un extends on{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function dn(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class hn{constructor(t,e={}){if((t=un.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=e;let s,u=Boolean(o),d=Boolean(i),h=!1;if(r<n)if(a){s=t.transpose(),r=s.rows,n=s.columns,h=!0;let e=u;u=d,d=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let c=Math.min(r,n),l=Math.min(r+1,n),f=new Float64Array(l),g=new sn(r,c),p=new sn(n,n),v=new Float64Array(n),y=new Float64Array(r),m=new Float64Array(l);for(let t=0;t<l;t++)m[t]=t;let w=Math.min(r-1,n),x=Math.max(0,Math.min(n-2,r)),E=Math.max(w,x);for(let t=0;t<E;t++){if(t<w){f[t]=0;for(let e=t;e<r;e++)f[t]=dn(f[t],s.get(e,t));if(0!==f[t]){s.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<r;e++)s.set(e,t,s.get(e,t)/f[t]);s.set(t,t,s.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<n;e++){if(t<w&&0!==f[t]){let n=0;for(let o=t;o<r;o++)n+=s.get(o,t)*s.get(o,e);n=-n/s.get(t,t);for(let o=t;o<r;o++)s.set(o,e,s.get(o,e)+n*s.get(o,t))}v[e]=s.get(t,e)}if(u&&t<w)for(let e=t;e<r;e++)g.set(e,t,s.get(e,t));if(t<x){v[t]=0;for(let e=t+1;e<n;e++)v[t]=dn(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<n;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<r&&0!==v[t]){for(let e=t+1;e<r;e++)y[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)y[e]+=v[r]*s.get(e,r);for(let e=t+1;e<n;e++){let n=-v[e]/v[t+1];for(let o=t+1;o<r;o++)s.set(o,e,s.get(o,e)+n*y[o])}}if(d)for(let e=t+1;e<n;e++)p.set(e,t,v[e])}}let b=Math.min(n,r+1);if(w<n&&(f[w]=s.get(w,w)),r<b&&(f[b-1]=0),x+1<b&&(v[x]=s.get(x,b-1)),v[b-1]=0,u){for(let t=w;t<c;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<c;e++){let n=0;for(let o=t;o<r;o++)n+=g.get(o,t)*g.get(o,e);n=-n/g.get(t,t);for(let o=t;o<r;o++)g.set(o,e,g.get(o,e)+n*g.get(o,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(d)for(let t=n-1;t>=0;t--){if(t<x&&0!==v[t])for(let e=t+1;e<n;e++){let r=0;for(let o=t+1;o<n;o++)r+=p.get(o,t)*p.get(o,e);r=-r/p.get(t+1,t);for(let o=t+1;o<n;o++)p.set(o,e,p.get(o,e)+r*p.get(o,t))}for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}let N=b-1,M=0,S=Number.EPSILON;for(;b>0;){let t,e;for(t=b-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===b-2)e=4;else{let r;for(r=b-1;r>=t&&r!==t;r--){let e=(r!==b?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(f[r])<=S*e){f[r]=0;break}}r===t?e=3:r===b-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[b-2];v[b-2]=0;for(let r=b-2;r>=t;r--){let o=dn(f[r],e),i=f[r]/o,a=e/o;if(f[r]=o,r!==t&&(e=-a*v[r-1],v[r-1]=i*v[r-1]),d)for(let t=0;t<n;t++)o=i*p.get(t,r)+a*p.get(t,b-1),p.set(t,b-1,-a*p.get(t,r)+i*p.get(t,b-1)),p.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<b;n++){let o=dn(f[n],e),i=f[n]/o,a=e/o;if(f[n]=o,e=-a*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g.get(e,n)+a*g.get(e,t-1),g.set(e,t-1,-a*g.get(e,n)+i*g.get(e,t-1)),g.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(f[b-1]),Math.abs(f[b-2]),Math.abs(v[b-2]),Math.abs(f[t]),Math.abs(v[t])),o=f[b-1]/e,i=f[b-2]/e,a=v[b-2]/e,s=f[t]/e,h=v[t]/e,c=((i+o)*(i-o)+a*a)/2,l=o*a*(o*a);let y=0;0===c&&0===l||(y=c<0?0-Math.sqrt(c*c+l):Math.sqrt(c*c+l),y=l/(c+y));let m=(s+o)*(s-o)+y,w=s*h;for(let e=t;e<b-1;e++){let o=dn(m,w);0===o&&(o=Number.MIN_VALUE);let i=m/o,a=w/o;if(e!==t&&(v[e-1]=o),m=i*f[e]+a*v[e],v[e]=i*v[e]-a*f[e],w=a*f[e+1],f[e+1]=i*f[e+1],d)for(let t=0;t<n;t++)o=i*p.get(t,e)+a*p.get(t,e+1),p.set(t,e+1,-a*p.get(t,e)+i*p.get(t,e+1)),p.set(t,e,o);if(o=dn(m,w),0===o&&(o=Number.MIN_VALUE),i=m/o,a=w/o,f[e]=o,m=i*v[e]+a*f[e+1],f[e+1]=-a*v[e]+i*f[e+1],w=a*v[e+1],v[e+1]=i*v[e+1],u&&e<r-1)for(let t=0;t<r;t++)o=i*g.get(t,e)+a*g.get(t,e+1),g.set(t,e+1,-a*g.get(t,e)+i*g.get(t,e+1)),g.set(t,e,o)}v[b-2]=m,M+=1;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,d))for(let e=0;e<=N;e++)p.set(e,t,-p.get(e,t));for(;t<N&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,d&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}M=0,b--}}if(h){let t=p;p=g,g=t}this.m=r,this.n=n,this.s=f,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,o=sn.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?o.set(t,t,0):o.set(t,t,1/this.s[t]);let i=this.U,a=this.rightSingularVectors,s=a.mmul(o),u=a.rows,d=i.rows,h=sn.zeros(u,d);for(let t=0;t<u;t++)for(let e=0;e<d;e++){let r=0;for(let o=0;o<n;o++)r+=s.get(t,o)*i.get(e,o);h.set(t,e,r)}return h.mmul(e)}solveForDiagonal(t){return this.solve(sn.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new sn(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,a=i.rows,s=i.columns,u=new sn(r,a);for(let t=0;t<r;t++)for(let e=0;e<a;e++){let r=0;for(let n=0;n<s;n++)r+=o.get(t,n)*i.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return sn.diag(this.s)}}var cn,ln={center:[0,0],linkDistance:50},fn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="mds",this.options=n(n({},ln),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericMDSLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericMDSLayout(!0,t,e),[2]}))}))},t.prototype.genericMDSLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,g,y;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=void 0===i?[0,0]:i,u=o.linkDistance,d=void 0===u?50:u,h=e.getAllNodes(),c=e.getAllEdges(),(null==h?void 0:h.length)&&1!==h.length?(l=v({nodes:h,edges:c},!1),f=p(l),gn(f),m=d,w=[],f.forEach((function(t){var e=[];t.forEach((function(t){e.push(t*m)})),w.push(e)})),g=pn(w),y=[],g.forEach((function(t,e){var r=b(h[e]);r.data.x=t[0]+s[0],r.data.y=t[1]+s[1],y.push(r)})),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:y,edges:c}]):[2,R(e,t,s)];var m,w}))}))},t}(),gn=function(t){var e=-999999;t.forEach((function(t){t.forEach((function(t){t!==1/0&&e<t&&(e=t)}))})),t.forEach((function(r,n){r.forEach((function(r,o){r===1/0&&(t[n][o]=e)}))}))},pn=function(t){var e=sn.mul(sn.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),o=e.mean();e.add(o).subRowVector(r).subColumnVector(n);var i=new hn(e),a=sn.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((function(t){return sn.mul([t],[a]).toJSON()[0].splice(0,2)}))},vn={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},yn=function(t,e,r,n,o,i){e.forEach((function(a,s){r[s]={x:0,y:0},e.forEach((function(e,u){if(s!==u&&o[s]===o[u]){var d=a.x-e.x,h=a.y-e.y,c=Math.sqrt(d*d+h*h);if(0===c){c=1;var l=s>u?1:-1;d=.01*l,h=.01*l}if(c<i(t[s])/2+i(t[u])/2){var f=n*n/c;r[s].x+=d/c*f,r[s].y+=h/c*f}}}))}))},mn=function(t,e,r,n,o,i,a,s){var u=i||a/10;return n&&e.forEach((function(e,r){var n=t[r].x-t[o].x,i=t[r].y-t[o].y,a=Math.sqrt(n*n+i*i),s=i/a,u=-n/a,d=Math.sqrt(e.x*e.x+e.y*e.y),h=Math.acos((s*e.x+u*e.y)/d);h>Math.PI/2&&(h-=Math.PI/2,s*=-1,u*=-1);var c=Math.cos(h)*d;e.x=s*c,e.y=u*c})),t.forEach((function(i,a){if(a!==o){var d=Math.sqrt(e[a].x*e[a].x+e[a].y*e[a].y);if(d>0&&a!==o){var h=Math.min(u*(r/800),d);if(i.x+=e[a].x/d*h,i.y+=e[a].y/d*h,n){var c=i.x-t[o].x,l=i.y-t[o].y,f=Math.sqrt(c*c+l*l);c=c/f*s[a],l=l/f*s[a],i.x=t[o].x+c,i.y=t[o].y+l}}}})),t},wn={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},xn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="radial",this.options=n(n({},wn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRadialLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRadialLayout(!0,t,e),[2]}))}))},t.prototype.genericRadialLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,d,h,c,l,f,g,y,m,w,x,E,N,M,S,k,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K,Y,J,X,Q,Z,tt,et;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,d=o.height,h=o.center,c=o.focusNode,l=o.unitRadius,f=o.nodeSize,g=o.nodeSpacing,y=o.strictRadial,m=o.preventOverlap,w=o.maxPreventOverlapIteration,x=o.sortBy,E=o.linkDistance,N=void 0===E?50:E,M=o.sortStrength,S=void 0===M?10:M,k=o.maxIteration,I=void 0===k?1e3:k,_=e.getAllNodes(),D=e.getAllEdges(),O=i||"undefined"==typeof window?i:window.innerWidth,T=d||"undefined"==typeof window?d:window.innerHeight,z=h||[O/2,T/2],!(null==_?void 0:_.length)||1===_.length)return[2,R(e,t,z)];if(C=_[0],P(c)){for(L=0;L<_.length;L++)if(_[L].id===c){C=_[L];break}}else C=c||_[0];return q=Nn(_,C.id),j=v({nodes:_,edges:D},!1),F=p(j),V=Sn(F,q),Mn(F,q,V+1),G=F[q],W=O-z[0]>z[0]?z[0]:O-z[0],B=T-z[1]>z[1]?z[1]:T-z[1],0===W&&(W=O/2),0===B&&(B=T/2),$=Math.min(W,B),U=Math.max.apply(Math,u([],s(G))),H=[],K=l||$/U,G.forEach((function(t,e){H[e]=t*K})),Y=En(_,F,N,H,K,x,S),J=bn(Y),X=function(t,e,r){try{var n=sn.mul(sn.pow(e,2),-.5),o=n.mean("row"),i=n.mean("column"),a=n.mean();n.add(a).subRowVector(o).subColumnVector(i);var s=new hn(n),u=sn.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((function(e){return sn.mul([e],[u]).toJSON()[0].splice(0,t)}))}catch(t){for(var d=[],h=0;h<e.length;h++){var c=Math.random()*r,l=Math.random()*r;d.push([c,l])}return d}}(N,Y,N),Q=X.map((function(t){var e=s(t,2),r=e[0],n=e[1];return{x:(isNaN(r)?Math.random()*N:r)-X[q][0],y:(isNaN(n)?Math.random()*N:n)-X[q][1]}})),this.run(I,Q,J,Y,H,q),m&&(Z=A(f,g),tt={nodes:_,nodeSizeFunc:Z,positions:Q,radii:H,height:T,width:O,strictRadial:Boolean(y),focusIdx:q,iterations:w||200,k:Q.length/4.5},Q=function(t,e){for(var r=n(n({},vn),e),o=r.positions,i=r.iterations,a=r.width,s=r.k,u=r.speed,d=void 0===u?100:u,h=r.strictRadial,c=r.focusIdx,l=r.radii,f=void 0===l?[]:l,g=r.nodeSizeFunc,p=t.getAllNodes(),v=[],y=a/10,m=0;m<i;m++)o.forEach((function(t,e){v[e]={x:0,y:0}})),yn(p,o,v,s,f,g),mn(o,v,d,h,c,y,a,f);return o}(e,tt)),et=[],Q.forEach((function(t,e){var r=b(_[e]);r.data.x=t.x+z[0],r.data.y=t.y+z[1],et.push(r)})),t&&et.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:et,edges:D}]}))}))},t.prototype.run=function(t,e,r,n,o,i){for(var a=0;a<=t;a++){var s=a/t;this.oneIteration(s,e,o,n,r,i)}},t.prototype.oneIteration=function(t,e,r,n,o,i){var a=1-t;e.forEach((function(s,u){var d=y(s,{x:0,y:0}),h=0===d?0:1/d;if(u!==i){var c=0,l=0,f=0;e.forEach((function(t,e){if(u!==e){var r=y(s,t),i=0===r?0:1/r,a=n[e][u];f+=o[u][e],c+=o[u][e]*(t.x+a*(s.x-t.x)*i),l+=o[u][e]*(t.y+a*(s.y-t.y)*i)}}));var g=0===r[u]?0:1/r[u];f*=a,f+=t*g*g,c*=a,c+=t*g*s.x*h,s.x=c/f,l*=a,l+=t*g*s.y*h,s.y=l/f}}))},t}(),En=function(t,e,r,n,o,i,a){if(!t)return[];var s=[];if(e){var u={};e.forEach((function(e,d){var h=[];e.forEach((function(e,s){var c,l;if(d===s)h.push(0);else if(n[d]===n[s])if("data"===i)h.push(e*(Math.abs(d-s)*a)/(n[d]/o));else if(i){var f=void 0,g=void 0;if(u[t[d].id])f=u[t[d].id];else{var p=("id"===i?t[d].id:null===(c=t[d].data)||void 0===c?void 0:c[i])||0;f=P(p)?p.charCodeAt(0):p,u[t[d].id]=f}u[t[s].id]?g=u[t[s].id]:(p=("id"===i?t[s].id:null===(l=t[s].data)||void 0===l?void 0:l[i])||0,g=P(p)?p.charCodeAt(0):p,u[t[s].id]=g),h.push(e*(Math.abs(f-g)*a)/(n[d]/o))}else h.push(e*r/(n[d]/o));else{var v=(r+o)/2;h.push(e*v)}})),s.push(h)}))}return s},bn=function(t){for(var e=t.length,r=t[0].length,n=[],o=0;o<e;o++){for(var i=[],a=0;a<r;a++)0!==t[o][a]?i.push(1/(t[o][a]*t[o][a])):i.push(0);n.push(i)}return n},Nn=function(t,e){var r=-1;return t.forEach((function(t,n){t.id===e&&(r=n)})),Math.max(r,0)},Mn=function(t,e,r){for(var n=t.length,o=0;o<n;o++)if(t[e][o]===1/0){t[e][o]=r,t[o][e]=r;for(var i=0;i<n;i++)t[o][i]!==1/0&&t[e][i]===1/0&&(t[e][i]=r+t[o][i],t[i][e]=r+t[o][i])}for(o=0;o<n;o++)if(o!==e)for(i=0;i<n;i++)if(t[o][i]===1/0){var a=Math.abs(t[e][o]-t[e][i]);a=0===a?1:a,t[o][i]=a}},Sn=function(t,e){for(var r=0,n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r},kn={center:[0,0],width:300,height:300},An=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="random",this.options=n(n({},kn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRandomLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRandomLayout(!0,t,e),[2]}))}))},t.prototype.genericRandomLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,d=e.getAllNodes(),h=s||"undefined"==typeof window?s:window.innerWidth,c=u||"undefined"==typeof window?u:window.innerHeight,l=i||[h/2,c/2],f=[],d&&d.forEach((function(t){f.push({id:t.id,data:{x:.9*(Math.random()-.5)*h+l[0],y:.9*(Math.random()-.5)*c+l[1]}})})),t&&f.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:f,edges:e.getAllEdges()}]}))}))},t}(),Rn={circular:_,concentric:z,mds:fn,random:An,grid:zr,radial:xn,force:xr,d3force:zt,fruchterman:Pr,forceAtlas2:Dr,dagre:pr};function In(){var t;(null===(t=cn)||void 0===t?void 0:t.stop)&&cn.stop()}function _n(t,e){return i(this,void 0,void 0,(function(){var r,n,o,i,s,u,d,h,c;return a(this,(function(a){switch(a.label){case 0:if(r=t.layout,n=r.id,o=r.options,i=r.iterations,s=t.nodes,u=t.edges,d=new l({nodes:s,edges:u}),!(h=Rn[n]))throw new Error("Unknown layout id: "+n);return[4,(cn=new h(o)).execute(d)];case 1:return c=a.sent(),!!(f=cn).tick&&!!f.stop&&(cn.stop(),c=cn.tick(i)),[2,[c,e]]}var f}))}))}addEventListener("message",(function(t){var r,n=t.data,o=n.type,i=n.method,a=n.id,s=n.params;"RPC"===o&&i&&((r=e[i])?Promise.resolve().then((function(){return r.apply(e,s)})):Promise.reject("No such method")).then((function(t){postMessage({type:"RPC",id:a,result:t})})).catch((function(t){var e={message:t};t.stack&&(e.message=t.message,e.stack=t.stack,e.name=t.name),postMessage({type:"RPC",id:a,error:e})}))})),postMessage({type:"RPC",method:"ready"});\n//# sourceMappingURL=c1c68049e416ee50a3be.worker.js.map']))),at(yt,Y),yt}},331:a=>{a.exports=function(lt,y){var at=0,Y={};lt.addEventListener("message",function(yt){var _t=yt.data;if(_t.type==="RPC")if(_t.id){var St=Y[_t.id];St&&(delete Y[_t.id],_t.error?St[1](Object.assign(Error(_t.error.message),_t.error)):St[0](_t.result))}else{var It=document.createEvent("Event");It.initEvent(_t.method,!1,!1),It.data=_t.params,lt.dispatchEvent(It)}}),y.forEach(function(yt){lt[yt]=function(){var _t=arguments;return new Promise(function(St,It){var kt=++at;Y[kt]=[St,It],lt.postMessage({type:"RPC",id:kt,method:yt,params:[].slice.call(_t)})})}})}}},Ft={};function K(a){var lt=Ft[a];if(lt!==void 0)return lt.exports;var y=Ft[a]={exports:{}};return Mt[a](y,y.exports,K),y.exports}K.n=a=>{var lt=a&&a.__esModule?()=>a.default:()=>a;return K.d(lt,{a:lt}),lt},K.d=(a,lt)=>{for(var y in lt)K.o(lt,y)&&!K.o(a,y)&&Object.defineProperty(a,y,{enumerable:!0,get:lt[y]})},K.o=(a,lt)=>Object.prototype.hasOwnProperty.call(a,lt);var F={};(()=>{K.d(F,{SB:()=>Mn,W1:()=>_r,jA:()=>Ia,Vq:()=>Va,E9:()=>po,y7:()=>Uo,O2:()=>vo,Me:()=>ra,AI:()=>aa,D4:()=>Ct,_5:()=>Yt,y9:()=>ir,_A:()=>ae,d9:()=>gr,ul:()=>qe,qs:()=>me,gl:()=>Ir,jE:()=>nr,tO:()=>Yr,zJ:()=>He,h$:()=>mr,BI:()=>$r,$y:()=>Mr,H0:()=>Ze,kJ:()=>te,hY:()=>he,qR:()=>oe,i_:()=>ne,nu:()=>rr,He:()=>_e,A3:()=>Fe});var a=function(o,r){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},a(o,r)};function lt(o,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function t(){this.constructor=o}a(o,r),o.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var y=function(){return y=Object.assign||function(o){for(var r,t=1,e=arguments.length;t<e;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(o[n]=r[n]);return o},y.apply(this,arguments)};function at(o,r){var t={};for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&r.indexOf(e)<0&&(t[e]=o[e]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function"){var n=0;for(e=Object.getOwnPropertySymbols(o);n<e.length;n++)r.indexOf(e[n])<0&&Object.prototype.propertyIsEnumerable.call(o,e[n])&&(t[e[n]]=o[e[n]])}return t}function Y(o,r,t,e){return new(t||(t=Promise))(function(n,i){function s(h){try{c(e.next(h))}catch(l){i(l)}}function u(h){try{c(e.throw(h))}catch(l){i(l)}}function c(h){var l;h.done?n(h.value):(l=h.value,l instanceof t?l:new t(function(E){E(l)})).then(s,u)}c((e=e.apply(o,r||[])).next())})}function yt(o,r){var t,e,n,i,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function u(c){return function(h){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(s=0)),s;)try{if(t=1,e&&(n=2&l[0]?e.return:l[0]?e.throw||((n=e.return)&&n.call(e),0):e.next)&&!(n=n.call(e,l[1])).done)return n;switch(e=0,n&&(l=[2&l[0],n.value]),l[0]){case 0:case 1:n=l;break;case 4:return s.label++,{value:l[1],done:!1};case 5:s.label++,e=l[1],l=[0];continue;case 7:l=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||l[0]!==6&&l[0]!==2)){s=0;continue}if(l[0]===3&&(!n||l[1]>n[0]&&l[1]<n[3])){s.label=l[1];break}if(l[0]===6&&s.label<n[1]){s.label=n[1],n=l;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(l);break}n[2]&&s.ops.pop(),s.trys.pop();continue}l=r.call(o,s)}catch(E){l=[6,E],e=0}finally{t=n=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([c,h])}}}function _t(o,r){var t=typeof Symbol=="function"&&o[Symbol.iterator];if(!t)return o;var e,n,i=t.call(o),s=[];try{for(;(r===void 0||r-- >0)&&!(e=i.next()).done;)s.push(e.value)}catch(u){n={error:u}}finally{try{e&&!e.done&&(t=i.return)&&t.call(i)}finally{if(n)throw n.error}}return s}function St(o,r,t){if(t||arguments.length===2)for(var e,n=0,i=r.length;n<i;n++)!e&&n in r||(e||(e=Array.prototype.slice.call(r,0,n)),e[n]=r[n]);return o.concat(e||Array.prototype.slice.call(r))}var It,kt,Tt=/-(\w)/g,ae=(It=function(o){return o.replace(Tt,function(r,t){return t?t.toUpperCase():""})},kt=Object.create(null),function(o){return kt[o]||(kt[o]=It(o))}),te=Array.isArray,_e=function(o){var r=parseFloat(o);return isNaN(r)?o:r},ce={}.toString;const Se=function(o,r){return ce.call(o)==="[object "+r+"]"},jt=function(o){return Se(o,"Number")};var me=function(o){for(var r=[],t=o.length,e=0;e<t;e+=1){r[e]=[];for(var n=0;n<t;n+=1)e===n?r[e][n]=0:o[e][n]!==0&&o[e][n]?r[e][n]=o[e][n]:r[e][n]=1/0}for(var i=0;i<t;i+=1)for(e=0;e<t;e+=1)for(n=0;n<t;n+=1)r[e][n]>r[e][i]+r[i][n]&&(r[e][n]=r[e][i]+r[i][n]);return r},He=function(o,r){var t=o.nodes,e=o.edges,n=[],i={};if(!t)throw new Error("invalid nodes data!");return t&&t.forEach(function(s,u){i[s.id]=u,n.push([])}),e==null||e.forEach(function(s){var u=s.source,c=s.target,h=i[u],l=i[c];h!==void 0&&l!==void 0&&(n[h][l]=1,r||(n[l][h]=1))}),n},rr=function(o,r){var t=[];return o.forEach(function(e){var n=[];e.forEach(function(i){n.push(i*r)}),t.push(n)}),t},xr=function(o,r){if(o&&o.children){for(var t=o.children.length-1;t>=0;t--)if(!xr(o.children[t],r))return}return!!r(o)},Fe=function(o,r){typeof r=="function"&&xr(o,r)},Ze=function(o){var r=1/0,t=1/0,e=-1/0,n=-1/0;return o.forEach(function(i){var s=i.data.size;te(s)?s.length===1&&(s=[s[0],s[0]]):jt(s)?s=[s,s]:(s===void 0||isNaN(s))&&(s=[30,30]);var u=[s[0]/2,s[1]/2],c=i.data.x-u[0],h=i.data.x+u[0],l=i.data.y-u[1],E=i.data.y+u[1];r>c&&(r=c),t>l&&(t=l),e<h&&(e=h),n<E&&(n=E)}),{minX:r,minY:t,maxX:e,maxY:n}},mr=function(o){var r={x:0,y:0};o.forEach(function(e){r.x+=e.data.x||0,r.y+=e.data.y||0});var t=o.length||1;return{x:r.x/t,y:r.y/t}},Sr=function(o,r,t){var e,n;return o==="source"?((e=t==null?void 0:t.find(function(i){return i.target===r.id}))===null||e===void 0?void 0:e.source)||{}:((n=t==null?void 0:t.find(function(i){return i.source===r.id}))===null||n===void 0?void 0:n.target)||{}},br=function(o,r,t){var e=[];switch(o){case"source":e=t==null?void 0:t.filter(function(i){return i.source===r.id}).map(function(i){return i.target});break;case"target":e=t==null?void 0:t.filter(function(i){return i.target===r.id}).map(function(i){return i.source});break;case"both":e=t==null?void 0:t.filter(function(i){return i.source===r.id}).map(function(i){return i.target}).concat(t==null?void 0:t.filter(function(i){return i.target===r.id}).map(function(i){return i.source}))}var n=new Set(e);return Array.from(n)},$r=function(o,r,t,e,n,i){var s=n[r.id],u=s.in,c=s.out,h=r,l=[];u===0?(h=Sr("source",r,t),l=br("both",h,t).map(function(R){return i[R]})):c===0&&(h=Sr("target",r,t),l=br("both",h,t).map(function(R){return i[R]})),l=l.filter(function(R){return n[R.id]&&(n[R.id].in===0||n[R.id].out===0)});var E=function(R,_,M,w,L){var k=M[_]||"",P=(w==null?void 0:w.filter(function(wt){return wt[_]===k}))||[];return R==="leaf"&&(P=P.filter(function(wt){var gt,dt;return((gt=L[wt.id])===null||gt===void 0?void 0:gt.in)===0||((dt=L[wt.id])===null||dt===void 0?void 0:dt.out)===0})),P}(o,e,r,l,n);return{coreNode:h,relativeLeafNodes:l,sameTypeLeafNodes:E}},Mr=function(o,r){return Math.sqrt((o.x-r.x)*(o.x-r.x)+(o.y-r.y)*(o.y-r.y))},gr=function(o){if(o===null)return o;if(o instanceof Date)return new Date(o.getTime());if(o instanceof Array){var r=[];return o.forEach(function(e){r.push(e)}),r.map(function(e){return gr(e)})}if(typeof o=="object"){var t={};return Object.keys(o).forEach(function(e){t[e]=gr(o[e])}),t}return o},qe=function(o,r){var t=gr(o);return t.data=t.data||{},r&&(jt(t.data.x)||(t.data.x=Math.random()*r[0]),jt(t.data.y)||(t.data.y=Math.random()*r[1])),t};const Qe=function(o){return typeof o=="function"},Tr=function(o){var r=typeof o;return o!==null&&r==="object"||r==="function"};function nr(o,r){return Qe(r)?r:jt(r)?function(){return r}:function(){return o}}function Yr(o,r,t){return t===void 0&&(t=!0),r||r===0?Qe(r)?r:jt(r)?function(){return r}:te(r)?function(){if(t){var e=Math.max.apply(Math,St([],_t(r)));return isNaN(e)?o:e}return r}:Tr(r)?function(){if(t){var e=Math.max(r.width,r.height);return isNaN(e)?o:e}return[r.width,r.height]}:function(){return o}:function(e){var n=(e.data||{}).size;return n?te(n)?n[0]>n[1]?n[0]:n[1]:Tr(n)?n.width>n.height?n.width:n.height:n:o}}var Ir=function(o,r){var t;return t=jt(r)?function(){return r}:Qe(r)?r:function(){return 0},o?te(o)?function(e){return(o[0]>o[1]?o[0]:o[1])+t(e)}:function(e){return o+t(e)}:function(e){var n,i;if(!((n=e.data)===null||n===void 0)&&n.bboxSize)return Math.max(e.data.bboxSize[0],e.data.bboxSize[1])+t(e);if(!((i=e.data)===null||i===void 0)&&i.size){if(te(e.data.size))return Math.max(e.data.size[0],e.data.size[1])+t(e);var s=e.data.size;return Tr(s)?(s.width>s.height?s.width:s.height)+t(e):s+t(e)}return 10+t(e)}},Wr=function(o,r,t){var e=o.getAllNodes(),n=o.getAllEdges();return e!=null&&e.length?e.length===1?(r&&o.mergeNodeData(e[0].id,{x:t[0],y:t[1]}),{nodes:[y(y({},e[0]),{data:y(y({},e[0].data),{x:t[0],y:t[1]})})],edges:n}):void 0:{nodes:[],edges:n}},Kr={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},Mn=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="circular",this.options=y(y({},Kr),r)}return o.prototype.execute=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return[2,this.genericCircularLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){switch(e.label){case 0:return[4,this.genericCircularLayout(!0,r,t)];case 1:return e.sent(),[2]}})})},o.prototype.genericCircularLayout=function(r,t,e){return Y(this,void 0,void 0,function(){var n,i,s,u,c,h,l,E,R,_,M,w,L,k,P,wt,gt,dt,X,ot,ht,nt,b,C,Z,W,xt,A,d,S,G,rt,it,g,v;return yt(this,function(f){if(n=y(y({},this.options),e),i=n.width,s=n.height,u=n.center,c=n.divisions,h=n.startAngle,l=h===void 0?0:h,E=n.endAngle,R=E===void 0?2*Math.PI:E,_=n.angleRatio,M=n.ordering,w=n.clockwise,L=n.nodeSpacing,k=n.nodeSize,P=t.getAllNodes(),wt=t.getAllEdges(),gt=_t(je(i,s,u),3),dt=gt[0],X=gt[1],ot=gt[2],!(ht=P==null?void 0:P.length)||ht===1)return[2,Wr(t,r,ot)];for(nt=(R-l)/ht,b=n.radius,C=n.startRadius,Z=n.endRadius,L?(W=nr(10,L),xt=Yr(10,k),A=-1/0,P.forEach(function(m){var j=xt(m);A<j&&(A=j)}),d=0,P.forEach(function(m,j){d+=j===0?A||10:(W(m)||0)+(A||10)}),b=d/(2*Math.PI)):b||C||Z?!C&&Z?C=Z:C&&!Z&&(Z=C):b=Math.min(X,dt)/2,S=nt*_,G=[],G=M==="topology"?Lr(t,P):M==="topology-directed"?Lr(t,P,!0):M==="degree"?function(m,j){var H=[];return j.forEach(function(p,D){H.push(qe(p))}),H.sort(function(p,D){return m.getDegree(p.id,"both")-m.getDegree(D.id,"both")}),H}(t,P):P.map(function(m){return qe(m)}),rt=Math.ceil(ht/c),it=0;it<ht;++it)(g=b)||C===null||Z===null||(g=C+it*(Z-C)/(ht-1)),g||(g=10+100*it/(ht-1)),v=l+it%rt*S+2*Math.PI/c*Math.floor(it/rt),w||(v=R-it%rt*S-2*Math.PI/c*Math.floor(it/rt)),G[it].data.x=ot[0]+Math.cos(v)*g,G[it].data.y=ot[1]+Math.sin(v)*g;return r&&G.forEach(function(m){t.mergeNodeData(m.id,{x:m.data.x,y:m.data.y})}),[2,{nodes:G,edges:wt}]})})},o}(),Lr=function(o,r,t){t===void 0&&(t=!1);var e=[qe(r[0])],n={},i=r.length;n[r[0].id]=!0;var s=0;return r.forEach(function(u,c){if(c!==0)if(c!==i-1&&o.getDegree(u.id,"both")===o.getDegree(r[c+1].id,"both")&&!o.areNeighbors(e[s].id,u.id)||n[u.id]){for(var h=t?o.getSuccessors(e[s].id):o.getNeighbors(e[s].id),l=!1,E=0;E<h.length;E++){var R=h[E];if(o.getDegree(R.id)===o.getDegree(u.id)&&!n[R.id]){e.push(qe(R)),n[R.id]=!0,l=!0;break}}for(var _=0;!l&&(n[r[_].id]||(e.push(qe(r[_])),n[r[_].id]=!0,l=!0),++_!==i););}else e.push(qe(u)),n[u.id]=!0,s++}),e},je=function(o,r,t){var e=o,n=r,i=t;return e||typeof window>"u"||(e=window.innerWidth),n||typeof window>"u"||(n=window.innerHeight),i||(i=[e/2,n/2]),[e,n,i]},Je=K(913),Ue=K.n(Je),Nr=K(617),zr=K.n(Nr),ir=function(o){function r(t,e,n){var i=o.call(this)||this;return i.graph=t,i.layout=e,i.options=n,i.spawnWorker(),i}return lt(r,o),r.prototype.spawnWorker=function(){this.worker&&this.worker.terminate(),this.worker=zr()(),this.running&&(this.running=!1,this.execute())},r.prototype.execute=function(){var t;return Y(this,void 0,void 0,function(){var e,n,i,s;return yt(this,function(u){switch(u.label){case 0:return this.running?[2,this]:(this.running=!0,(e=this.layout.options).onTick,n=at(e,["onTick"]),i={layout:{id:this.layout.id,options:n,iterations:(t=this.options)===null||t===void 0?void 0:t.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},s=new Float32Array([0]),[4,this.worker.calculateLayout(i,[s])]);case 1:return[2,_t.apply(void 0,[u.sent(),1])[0]]}})})},r.prototype.stop=function(){return this.running=!1,this.worker.stopLayout(),this},r.prototype.kill=function(){this.worker&&this.worker.terminate()},r.prototype.isRunning=function(){return this.running},r}(Ue());const kr=function(o){return Se(o,"String")};var ke={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},_r=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="concentric",this.options=y(y({},ke),r)}return o.prototype.execute=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return[2,this.genericConcentricLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return this.genericConcentricLayout(!0,r,t),[2]})})},o.prototype.genericConcentricLayout=function(r,t,e){return Y(this,void 0,void 0,function(){var n,i,s,u,c,h,l,E,R,_,M,w,L,k,P,wt,gt,dt,X,ot,ht,nt,b,C,Z,W,xt,A,d,S,G,rt,it,g,v,f,m,j;return yt(this,function(H){if(n=y(y({},this.options),e),i=n.center,s=n.width,u=n.height,c=n.sortBy,h=n.maxLevelDiff,l=n.sweep,E=n.clockwise,R=n.equidistant,_=n.preventOverlap,M=n.startAngle,w=M===void 0?1.5*Math.PI:M,L=n.nodeSize,k=n.nodeSpacing,P=t.getAllNodes(),wt=t.getAllEdges(),gt=s||typeof window>"u"?s:window.innerWidth,dt=u||typeof window>"u"?u:window.innerHeight,X=i||[gt/2,dt/2],!(P!=null&&P.length)||P.length===1)return[2,Wr(t,r,X)];if(ot=[],nt=0,ht=te(L)?Math.max(L[0],L[1]):L,te(k)?nt=Math.max(k[0],k[1]):jt(k)&&(nt=k),P.forEach(function(p){var D=qe(p);ot.push(D);var B=ht,I=D.data;te(I.size)?B=Math.max(I.size[0],I.size[1]):jt(I.size)?B=I.size:Tr(I.size)&&(B=Math.max(I.size.width,I.size.height)),ht=Math.max(ht,B),Qe(k)&&(nt=Math.max(k(p),nt))}),b={},ot.forEach(function(p,D){b[p.id]=D}),kr(C=c)&&ot[0].data[C]!==void 0||(C="degree"),C==="degree"?ot.sort(function(p,D){return t.getDegree(D.id,"both")-t.getDegree(p.id,"both")}):ot.sort(function(p,D){return D.data[C]-p.data[C]}),Z=ot[0],W=(h||(C==="degree"?t.getDegree(Z.id,"both"):Z.data[C]))/4,A=(xt=[{nodes:[]}])[0],ot.forEach(function(p){if(A.nodes.length>0){var D=Math.abs(C==="degree"?t.getDegree(A.nodes[0].id,"both")-t.getDegree(p.id,"both"):A.nodes[0].data[C]-p.data[C]);W&&D>=W&&(A={nodes:[]},xt.push(A))}A.nodes.push(p)}),d=ht+nt,_||(S=xt.length>0&&xt[0].nodes.length>1,G=Math.min(gt,dt)/2-d,rt=G/(xt.length+(S?1:0)),d=Math.min(d,rt)),it=0,xt.forEach(function(p){var D=l===void 0?2*Math.PI-2*Math.PI/p.nodes.length:l;if(p.dTheta=D/Math.max(1,p.nodes.length-1),p.nodes.length>1&&_){var B=Math.cos(p.dTheta)-Math.cos(0),I=Math.sin(p.dTheta)-Math.sin(0),q=Math.sqrt(d*d/(B*B+I*I));it=Math.max(q,it)}p.r=it,it+=d}),R){for(g=0,v=0,f=0;f<xt.length;f++)m=xt[f],j=(m.r||0)-v,g=Math.max(g,j);v=0,xt.forEach(function(p,D){D===0&&(v=p.r||0),p.r=v,v+=g})}return xt.forEach(function(p){var D=p.dTheta||0,B=p.r||0;p.nodes.forEach(function(I,q){var Q=w+(E?1:-1)*D*q;I.data.x=X[0]+B*Math.cos(Q),I.data.y=X[1]+B*Math.sin(Q)})}),r&&ot.forEach(function(p){return t.mergeNodeData(p.id,{x:p.data.x,y:p.data.y})}),[2,{nodes:ot,edges:wt}]})})},o}();function Ar(o,r,t,e){if(isNaN(r)||isNaN(t))return o;var n,i,s,u,c,h,l,E,R,_=o._root,M={data:e},w=o._x0,L=o._y0,k=o._x1,P=o._y1;if(!_)return o._root=M,o;for(;_.length;)if((h=r>=(i=(w+k)/2))?w=i:k=i,(l=t>=(s=(L+P)/2))?L=s:P=s,n=_,!(_=_[E=l<<1|h]))return n[E]=M,o;if(u=+o._x.call(null,_.data),c=+o._y.call(null,_.data),r===u&&t===c)return M.next=_,n?n[E]=M:o._root=M,o;do n=n?n[E]=new Array(4):o._root=new Array(4),(h=r>=(i=(w+k)/2))?w=i:k=i,(l=t>=(s=(L+P)/2))?L=s:P=s;while((E=l<<1|h)==(R=(c>=s)<<1|u>=i));return n[R]=_,n[E]=M,o}function Be(o,r,t,e,n){this.node=o,this.x0=r,this.y0=t,this.x1=e,this.y1=n}function Pr(o){return o[0]}function Dr(o){return o[1]}function Ye(o,r,t){var e=new tr(r??Pr,t??Dr,NaN,NaN,NaN,NaN);return o==null?e:e.addAll(o)}function tr(o,r,t,e,n,i){this._x=o,this._y=r,this._x0=t,this._y0=e,this._x1=n,this._y1=i,this._root=void 0}function on(o){for(var r={data:o.data},t=r;o=o.next;)t=t.next={data:o.data};return r}var De=Ye.prototype=tr.prototype;function Xe(o){return function(){return o}}function Gr(o){return 1e-6*(o()-.5)}De.copy=function(){var o,r,t=new tr(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root;if(!e)return t;if(!e.length)return t._root=on(e),t;for(o=[{source:e,target:t._root=new Array(4)}];e=o.pop();)for(var n=0;n<4;++n)(r=e.source[n])&&(r.length?o.push({source:r,target:e.target[n]=new Array(4)}):e.target[n]=on(r));return t},De.add=function(o){const r=+this._x.call(null,o),t=+this._y.call(null,o);return Ar(this.cover(r,t),r,t,o)},De.addAll=function(o){var r,t,e,n,i=o.length,s=new Array(i),u=new Array(i),c=1/0,h=1/0,l=-1/0,E=-1/0;for(t=0;t<i;++t)isNaN(e=+this._x.call(null,r=o[t]))||isNaN(n=+this._y.call(null,r))||(s[t]=e,u[t]=n,e<c&&(c=e),e>l&&(l=e),n<h&&(h=n),n>E&&(E=n));if(c>l||h>E)return this;for(this.cover(c,h).cover(l,E),t=0;t<i;++t)Ar(this,s[t],u[t],o[t]);return this},De.cover=function(o,r){if(isNaN(o=+o)||isNaN(r=+r))return this;var t=this._x0,e=this._y0,n=this._x1,i=this._y1;if(isNaN(t))n=(t=Math.floor(o))+1,i=(e=Math.floor(r))+1;else{for(var s,u,c=n-t||1,h=this._root;t>o||o>=n||e>r||r>=i;)switch(u=(r<e)<<1|o<t,(s=new Array(4))[u]=h,h=s,c*=2,u){case 0:n=t+c,i=e+c;break;case 1:t=n-c,i=e+c;break;case 2:n=t+c,e=i-c;break;case 3:t=n-c,e=i-c}this._root&&this._root.length&&(this._root=h)}return this._x0=t,this._y0=e,this._x1=n,this._y1=i,this},De.data=function(){var o=[];return this.visit(function(r){if(!r.length)do o.push(r.data);while(r=r.next)}),o},De.extent=function(o){return arguments.length?this.cover(+o[0][0],+o[0][1]).cover(+o[1][0],+o[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},De.find=function(o,r,t){var e,n,i,s,u,c,h,l=this._x0,E=this._y0,R=this._x1,_=this._y1,M=[],w=this._root;for(w&&M.push(new Be(w,l,E,R,_)),t==null?t=1/0:(l=o-t,E=r-t,R=o+t,_=r+t,t*=t);c=M.pop();)if(!(!(w=c.node)||(n=c.x0)>R||(i=c.y0)>_||(s=c.x1)<l||(u=c.y1)<E))if(w.length){var L=(n+s)/2,k=(i+u)/2;M.push(new Be(w[3],L,k,s,u),new Be(w[2],n,k,L,u),new Be(w[1],L,i,s,k),new Be(w[0],n,i,L,k)),(h=(r>=k)<<1|o>=L)&&(c=M[M.length-1],M[M.length-1]=M[M.length-1-h],M[M.length-1-h]=c)}else{var P=o-+this._x.call(null,w.data),wt=r-+this._y.call(null,w.data),gt=P*P+wt*wt;if(gt<t){var dt=Math.sqrt(t=gt);l=o-dt,E=r-dt,R=o+dt,_=r+dt,e=w.data}}return e},De.remove=function(o){if(isNaN(i=+this._x.call(null,o))||isNaN(s=+this._y.call(null,o)))return this;var r,t,e,n,i,s,u,c,h,l,E,R,_=this._root,M=this._x0,w=this._y0,L=this._x1,k=this._y1;if(!_)return this;if(_.length)for(;;){if((h=i>=(u=(M+L)/2))?M=u:L=u,(l=s>=(c=(w+k)/2))?w=c:k=c,r=_,!(_=_[E=l<<1|h]))return this;if(!_.length)break;(r[E+1&3]||r[E+2&3]||r[E+3&3])&&(t=r,R=E)}for(;_.data!==o;)if(e=_,!(_=_.next))return this;return(n=_.next)&&delete _.next,e?(n?e.next=n:delete e.next,this):r?(n?r[E]=n:delete r[E],(_=r[0]||r[1]||r[2]||r[3])&&_===(r[3]||r[2]||r[1]||r[0])&&!_.length&&(t?t[R]=_:this._root=_),this):(this._root=n,this)},De.removeAll=function(o){for(var r=0,t=o.length;r<t;++r)this.remove(o[r]);return this},De.root=function(){return this._root},De.size=function(){var o=0;return this.visit(function(r){if(!r.length)do++o;while(r=r.next)}),o},De.visit=function(o){var r,t,e,n,i,s,u=[],c=this._root;for(c&&u.push(new Be(c,this._x0,this._y0,this._x1,this._y1));r=u.pop();)if(!o(c=r.node,e=r.x0,n=r.y0,i=r.x1,s=r.y1)&&c.length){var h=(e+i)/2,l=(n+s)/2;(t=c[3])&&u.push(new Be(t,h,l,i,s)),(t=c[2])&&u.push(new Be(t,e,l,h,s)),(t=c[1])&&u.push(new Be(t,h,n,i,l)),(t=c[0])&&u.push(new Be(t,e,n,h,l))}return this},De.visitAfter=function(o){var r,t=[],e=[];for(this._root&&t.push(new Be(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var n=r.node;if(n.length){var i,s=r.x0,u=r.y0,c=r.x1,h=r.y1,l=(s+c)/2,E=(u+h)/2;(i=n[0])&&t.push(new Be(i,s,u,l,E)),(i=n[1])&&t.push(new Be(i,l,u,c,E)),(i=n[2])&&t.push(new Be(i,s,E,l,h)),(i=n[3])&&t.push(new Be(i,l,E,c,h))}e.push(r)}for(;r=e.pop();)o(r.node,r.x0,r.y0,r.x1,r.y1);return this},De.x=function(o){return arguments.length?(this._x=o,this):this._x},De.y=function(o){return arguments.length?(this._y=o,this):this._y};var eo={value:()=>{}};function Mo(){for(var o,r=0,t=arguments.length,e={};r<t;++r){if(!(o=arguments[r]+"")||o in e||/[\s.]/.test(o))throw new Error("illegal type: "+o);e[o]=[]}return new Tn(e)}function Tn(o){this._=o}function ro(o,r){for(var t,e=0,n=o.length;e<n;++e)if((t=o[e]).name===r)return t.value}function Bn(o,r,t){for(var e=0,n=o.length;e<n;++e)if(o[e].name===r){o[e]=eo,o=o.slice(0,e).concat(o.slice(e+1));break}return t!=null&&o.push({name:r,value:t}),o}Tn.prototype=Mo.prototype={constructor:Tn,on:function(o,r){var t,e,n=this._,i=(e=n,(o+"").trim().split(/^|\s+/).map(function(c){var h="",l=c.indexOf(".");if(l>=0&&(h=c.slice(l+1),c=c.slice(0,l)),c&&!e.hasOwnProperty(c))throw new Error("unknown type: "+c);return{type:c,name:h}})),s=-1,u=i.length;if(!(arguments.length<2)){if(r!=null&&typeof r!="function")throw new Error("invalid callback: "+r);for(;++s<u;)if(t=(o=i[s]).type)n[t]=Bn(n[t],o.name,r);else if(r==null)for(t in n)n[t]=Bn(n[t],o.name,null);return this}for(;++s<u;)if((t=(o=i[s]).type)&&(t=ro(n[t],o.name)))return t},copy:function(){var o={},r=this._;for(var t in r)o[t]=r[t].slice();return new Tn(o)},call:function(o,r){if((t=arguments.length-2)>0)for(var t,e,n=new Array(t),i=0;i<t;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(o))throw new Error("unknown type: "+o);for(i=0,t=(e=this._[o]).length;i<t;++i)e[i].value.apply(r,n)},apply:function(o,r,t){if(!this._.hasOwnProperty(o))throw new Error("unknown type: "+o);for(var e=this._[o],n=0,i=e.length;n<i;++n)e[n].value.apply(r,t)}};const Mi=Mo;var yn,or,Vn=0,no=0,an=0,Ti=1e3,To=0,wn=0,Io=0,oo=typeof performance=="object"&&performance.now?performance:Date,Ii=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(o){setTimeout(o,17)};function ko(){return wn||(Ii(us),wn=oo.now()+Io)}function us(){wn=0}function hn(){this._call=this._time=this._next=null}function ti(o,r,t){var e=new hn;return e.restart(o,r,t),e}function Zr(){wn=(To=oo.now())+Io,Vn=no=0;try{(function(){ko(),++Vn;for(var o,r=yn;r;)(o=wn-r._time)>=0&&r._call.call(void 0,o),r=r._next;--Vn})()}finally{Vn=0,function(){for(var o,r,t=yn,e=1/0;t;)t._call?(e>t._time&&(e=t._time),o=t,t=t._next):(r=t._next,t._next=null,t=o?o._next=r:yn=r);or=o,sn(e)}(),wn=0}}function ba(){var o=oo.now(),r=o-To;r>Ti&&(Io-=r,To=o)}function sn(o){Vn||(no&&(no=clearTimeout(no)),o-wn>24?(o<1/0&&(no=setTimeout(Zr,o-oo.now()-Io)),an&&(an=clearInterval(an))):(an||(To=oo.now(),an=setInterval(ba,Ti)),Vn=1,Ii(Zr)))}hn.prototype=ti.prototype={constructor:hn,restart:function(o,r,t){if(typeof o!="function")throw new TypeError("callback is not a function");t=(t==null?ko():+t)+(r==null?0:+r),this._next||or===this||(or?or._next=this:yn=this,or=this),this._call=o,this._time=t,sn()},stop:function(){this._call&&(this._call=null,this._time=1/0,sn())}};const ki=1664525,Wn=1013904223,Do=4294967296;function Na(o){return o.x}function _a(o){return o.y}var Aa=10,Sa=Math.PI*(3-Math.sqrt(5));function Di(o){var r,t=1,e=.001,n=1-Math.pow(e,1/300),i=0,s=.6,u=new Map,c=ti(E),h=Mi("tick","end"),l=function(){let w=1;return()=>(w=(ki*w+Wn)%Do)/Do}();function E(){R(),h.call("tick",r),t<e&&(c.stop(),h.call("end",r))}function R(w){var L,k,P=o.length;w===void 0&&(w=1);for(var wt=0;wt<w;++wt)for(t+=(i-t)*n,u.forEach(function(gt){gt(t)}),L=0;L<P;++L)(k=o[L]).fx==null?k.x+=k.vx*=s:(k.x=k.fx,k.vx=0),k.fy==null?k.y+=k.vy*=s:(k.y=k.fy,k.vy=0);return r}function _(){for(var w,L=0,k=o.length;L<k;++L){if((w=o[L]).index=L,w.fx!=null&&(w.x=w.fx),w.fy!=null&&(w.y=w.fy),isNaN(w.x)||isNaN(w.y)){var P=Aa*Math.sqrt(.5+L),wt=L*Sa;w.x=P*Math.cos(wt),w.y=P*Math.sin(wt)}(isNaN(w.vx)||isNaN(w.vy))&&(w.vx=w.vy=0)}}function M(w){return w.initialize&&w.initialize(o,l),w}return o==null&&(o=[]),_(),r={tick:R,restart:function(){return c.restart(E),r},stop:function(){return c.stop(),r},nodes:function(w){return arguments.length?(o=w,_(),u.forEach(M),r):o},alpha:function(w){return arguments.length?(t=+w,r):t},alphaMin:function(w){return arguments.length?(e=+w,r):e},alphaDecay:function(w){return arguments.length?(n=+w,r):+n},alphaTarget:function(w){return arguments.length?(i=+w,r):i},velocityDecay:function(w){return arguments.length?(s=1-w,r):1-s},randomSource:function(w){return arguments.length?(l=w,u.forEach(M),r):l},force:function(w,L){return arguments.length>1?(L==null?u.delete(w):u.set(w,M(L)),r):u.get(w)},find:function(w,L,k){var P,wt,gt,dt,X,ot=0,ht=o.length;for(k==null?k=1/0:k*=k,ot=0;ot<ht;++ot)(gt=(P=w-(dt=o[ot]).x)*P+(wt=L-dt.y)*wt)<k&&(X=dt,k=gt);return X},on:function(w,L){return arguments.length>1?(h.on(w,L),r):h.on(w)}}}function Ma(){var o,r,t,e,n,i=Xe(-30),s=1,u=1/0,c=.81;function h(_){var M,w=o.length,L=Ye(o,Na,_a).visitAfter(E);for(e=_,M=0;M<w;++M)r=o[M],L.visit(R)}function l(){if(o){var _,M,w=o.length;for(n=new Array(w),_=0;_<w;++_)M=o[_],n[M.index]=+i(M,_,o)}}function E(_){var M,w,L,k,P,wt=0,gt=0;if(_.length){for(L=k=P=0;P<4;++P)(M=_[P])&&(w=Math.abs(M.value))&&(wt+=M.value,gt+=w,L+=w*M.x,k+=w*M.y);_.x=L/gt,_.y=k/gt}else{(M=_).x=M.data.x,M.y=M.data.y;do wt+=n[M.data.index];while(M=M.next)}_.value=wt}function R(_,M,w,L){if(!_.value)return!0;var k=_.x-r.x,P=_.y-r.y,wt=L-M,gt=k*k+P*P;if(wt*wt/c<gt)return gt<u&&(k===0&&(gt+=(k=Gr(t))*k),P===0&&(gt+=(P=Gr(t))*P),gt<s&&(gt=Math.sqrt(s*gt)),r.vx+=k*_.value*e/gt,r.vy+=P*_.value*e/gt),!0;if(!(_.length||gt>=u)){(_.data!==r||_.next)&&(k===0&&(gt+=(k=Gr(t))*k),P===0&&(gt+=(P=Gr(t))*P),gt<s&&(gt=Math.sqrt(s*gt)));do _.data!==r&&(wt=n[_.data.index]*e/gt,r.vx+=k*wt,r.vy+=P*wt);while(_=_.next)}}return h.initialize=function(_,M){o=_,t=M,l()},h.strength=function(_){return arguments.length?(i=typeof _=="function"?_:Xe(+_),l(),h):i},h.distanceMin=function(_){return arguments.length?(s=_*_,h):Math.sqrt(s)},h.distanceMax=function(_){return arguments.length?(u=_*_,h):Math.sqrt(u)},h.theta=function(_){return arguments.length?(c=_*_,h):Math.sqrt(c)},h}function cs(o){return o.index}function ei(o,r){var t=o.get(r);if(!t)throw new Error("node not found: "+r);return t}function io(o){var r,t,e,n,i,s,u=cs,c=function(w){return 1/Math.min(n[w.source.index],n[w.target.index])},h=Xe(30),l=1;function E(w){for(var L=0,k=o.length;L<l;++L)for(var P,wt,gt,dt,X,ot,ht,nt=0;nt<k;++nt)wt=(P=o[nt]).source,dt=(gt=P.target).x+gt.vx-wt.x-wt.vx||Gr(s),X=gt.y+gt.vy-wt.y-wt.vy||Gr(s),dt*=ot=((ot=Math.sqrt(dt*dt+X*X))-t[nt])/ot*w*r[nt],X*=ot,gt.vx-=dt*(ht=i[nt]),gt.vy-=X*ht,wt.vx+=dt*(ht=1-ht),wt.vy+=X*ht}function R(){if(e){var w,L,k=e.length,P=o.length,wt=new Map(e.map((gt,dt)=>[u(gt,dt,e),gt]));for(w=0,n=new Array(k);w<P;++w)(L=o[w]).index=w,typeof L.source!="object"&&(L.source=ei(wt,L.source)),typeof L.target!="object"&&(L.target=ei(wt,L.target)),n[L.source.index]=(n[L.source.index]||0)+1,n[L.target.index]=(n[L.target.index]||0)+1;for(w=0,i=new Array(P);w<P;++w)L=o[w],i[w]=n[L.source.index]/(n[L.source.index]+n[L.target.index]);r=new Array(P),_(),t=new Array(P),M()}}function _(){if(e)for(var w=0,L=o.length;w<L;++w)r[w]=+c(o[w],w,o)}function M(){if(e)for(var w=0,L=o.length;w<L;++w)t[w]=+h(o[w],w,o)}return o==null&&(o=[]),E.initialize=function(w,L){e=w,s=L,R()},E.links=function(w){return arguments.length?(o=w,R(),E):o},E.id=function(w){return arguments.length?(u=w,E):u},E.iterations=function(w){return arguments.length?(l=+w,E):l},E.strength=function(w){return arguments.length?(c=typeof w=="function"?w:Xe(+w),_(),E):c},E.distance=function(w){return arguments.length?(h=typeof w=="function"?w:Xe(+w),M(),E):h},E}function ds(o){return o.x+o.vx}function ls(o){return o.y+o.vy}function Ri(o){var r,t,e,n=1,i=1;function s(){for(var h,l,E,R,_,M,w,L=r.length,k=0;k<i;++k)for(l=Ye(r,ds,ls).visitAfter(u),h=0;h<L;++h)E=r[h],M=t[E.index],w=M*M,R=E.x+E.vx,_=E.y+E.vy,l.visit(P);function P(wt,gt,dt,X,ot){var ht=wt.data,nt=wt.r,b=M+nt;if(!ht)return gt>R+b||X<R-b||dt>_+b||ot<_-b;if(ht.index>E.index){var C=R-ht.x-ht.vx,Z=_-ht.y-ht.vy,W=C*C+Z*Z;W<b*b&&(C===0&&(W+=(C=Gr(e))*C),Z===0&&(W+=(Z=Gr(e))*Z),W=(b-(W=Math.sqrt(W)))/W*n,E.vx+=(C*=W)*(b=(nt*=nt)/(w+nt)),E.vy+=(Z*=W)*b,ht.vx-=C*(b=1-b),ht.vy-=Z*b)}}}function u(h){if(h.data)return h.r=t[h.data.index];for(var l=h.r=0;l<4;++l)h[l]&&h[l].r>h.r&&(h.r=h[l].r)}function c(){if(r){var h,l,E=r.length;for(t=new Array(E),h=0;h<E;++h)l=r[h],t[l.index]=+o(l,h,r)}}return typeof o!="function"&&(o=Xe(o==null?1:+o)),s.initialize=function(h,l){r=h,e=l,c()},s.iterations=function(h){return arguments.length?(i=+h,s):i},s.strength=function(h){return arguments.length?(n=+h,s):n},s.radius=function(h){return arguments.length?(o=typeof h=="function"?h:Xe(+h),c(),s):o},s}function Ta(){function o(dt){return function(){return dt}}var r,t=function(dt){return dt.cluster},e=o(1),n=o(-1),i=o(100),s=o(.1),u=[0,0],c=[],h={},l=[],E=100,R=100,_={none:{x:0,y:0}},M=[],w="force",L=!0,k=.1;function P(dt){if(!L)return P;r.tick(),gt();for(var X=0,ot=c.length,ht=void 0,nt=dt*k;X<ot;++X)(ht=c[X]).vx+=(_[t(ht)].x-ht.x)*nt,ht.vy+=(_[t(ht)].y-ht.y)*nt}function wt(){c&&function(){if(c&&c.length){if(t(c[0])===void 0)throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy('clusterAttr') before calling .links()");var dt,X,ot,ht,nt,b=(dt=[],X=[],ot={},nt=[],ht=function(C){var Z={};return C.forEach(function(W){var xt=t(W);Z[xt]||(Z[xt]={count:0,sumforceNodeSize:0})}),C.forEach(function(W){var xt=t(W),A=e(W),d=Z[xt];d.count=d.count+1,d.sumforceNodeSize=d.sumforceNodeSize+Math.PI*(A*A)*1.3,Z[xt]=d}),Z}(c),nt=function(C){var Z={},W=[];return C.forEach(function(xt){var A,d,S,G,rt,it=(d=(A=xt).source,S=A.target,(G=t(h[d]))<=(rt=t(h[S]))?G+"~"+rt:rt+"~"+G),g=0;Z[it]!==void 0&&(g=Z[it]),g+=1,Z[it]=g}),Object.entries(Z).forEach(function(xt){var A=_t(xt,2),d=A[0],S=A[1],G=d.split("~")[0],rt=d.split("~")[1];G!==void 0&&rt!==void 0&&W.push({source:G,target:rt,count:S})}),W}(l),Object.keys(ht).forEach(function(C,Z){var W=ht[C];dt.push({id:C,size:W.count,r:Math.sqrt(W.sumforceNodeSize/Math.PI)}),ot[C]=Z}),nt.forEach(function(C){var Z=C.source,W=C.target,xt=ot[Z],A=ot[W];xt!==void 0&&A!==void 0&&X.push({source:xt,target:A,count:C.count})}),{nodes:dt,links:X});r=Di(b.nodes).force("x",function(C){var Z,W,xt,A=Xe(.1);function d(G){for(var rt,it=0,g=Z.length;it<g;++it)(rt=Z[it]).vx+=(xt[it]-rt.x)*W[it]*G}function S(){if(Z){var G,rt=Z.length;for(W=new Array(rt),xt=new Array(rt),G=0;G<rt;++G)W[G]=isNaN(xt[G]=+C(Z[G],G,Z))?0:+A(Z[G],G,Z)}}return typeof C!="function"&&(C=Xe(C==null?0:+C)),d.initialize=function(G){Z=G,S()},d.strength=function(G){return arguments.length?(A=typeof G=="function"?G:Xe(+G),S(),d):A},d.x=function(G){return arguments.length?(C=typeof G=="function"?G:Xe(+G),S(),d):C},d}(E).strength(.1)).force("y",function(C){var Z,W,xt,A=Xe(.1);function d(G){for(var rt,it=0,g=Z.length;it<g;++it)(rt=Z[it]).vy+=(xt[it]-rt.y)*W[it]*G}function S(){if(Z){var G,rt=Z.length;for(W=new Array(rt),xt=new Array(rt),G=0;G<rt;++G)W[G]=isNaN(xt[G]=+C(Z[G],G,Z))?0:+A(Z[G],G,Z)}}return typeof C!="function"&&(C=Xe(C==null?0:+C)),d.initialize=function(G){Z=G,S()},d.strength=function(G){return arguments.length?(A=typeof G=="function"?G:Xe(+G),S(),d):A},d.y=function(G){return arguments.length?(C=typeof G=="function"?G:Xe(+G),S(),d):C},d}(R).strength(.1)).force("collide",Ri(function(C){return C.r}).iterations(4)).force("charge",Ma().strength(n)).force("links",io(b.nodes.length?b.links:[]).distance(i).strength(s)),M=r.nodes(),gt()}}()}function gt(){return _={none:{x:0,y:0}},M.forEach(function(dt){_[dt.id]={x:dt.x-u[0],y:dt.y-u[1]}}),_}return P.initialize=function(dt){c=dt,wt()},P.template=function(dt){return arguments.length?(w=dt,wt(),P):w},P.groupBy=function(dt){return arguments.length?typeof dt=="string"?(t=function(X){return X[dt]},P):(t=dt,P):t},P.enableGrouping=function(dt){return arguments.length?(L=dt,P):L},P.strength=function(dt){return arguments.length?(k=dt,P):k},P.centerX=function(dt){return arguments.length?(E=dt,P):E},P.centerY=function(dt){return arguments.length?(R=dt,P):R},P.nodes=function(dt){return arguments.length?(function(X){h={},X.forEach(function(ot){h[ot.id]=ot})}(dt||[]),c=dt||[],P):c},P.links=function(dt){return arguments.length?(l=dt||[],wt(),P):l},P.forceNodeSize=function(dt){return arguments.length?(e=typeof dt=="function"?dt:o(+dt),wt(),P):e},P.nodeSize=P.forceNodeSize,P.forceCharge=function(dt){return arguments.length?(n=typeof dt=="function"?dt:o(+dt),wt(),P):n},P.forceLinkDistance=function(dt){return arguments.length?(i=typeof dt=="function"?dt:o(+dt),wt(),P):i},P.forceLinkStrength=function(dt){return arguments.length?(s=typeof dt=="function"?dt:o(+dt),wt(),P):s},P.offset=function(dt){return arguments.length?(u=dt,P):u},P.getFocis=gt,P}var ao={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},Ia=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="d3force",this.options=y(y({},ao),r)}return o.prototype.execute=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return[2,this.genericForceLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return this.genericForceLayout(!0,r,t),[2]})})},o.prototype.stop=function(){var r;(r=this.forceSimulation)===null||r===void 0||r.stop()},o.prototype.tick=function(r){var t=this;r===void 0&&(r=1),this.forceSimulation.tick(r);var e={nodes:Ro(this.lastLayoutNodes),edges:so(this.lastLayoutEdges)};return this.lastAssign&&e.nodes.forEach(function(n){return t.lastGraph.mergeNodeData(n.id,{x:n.data.x,y:n.data.y})}),e},o.prototype.genericForceLayout=function(r,t,e){return Y(this,void 0,void 0,function(){var n,i,s,u,c,h,l,E,R,_,M,w,L,k,P,wt,gt,dt,X,ot,ht,nt,b,C,Z,W,xt=this;return yt(this,function(A){return n=y(y({},this.options),e),i=t.getAllNodes(),s=t.getAllEdges(),u=i.map(function(d){var S,G;return y(y({},qe(d)),{x:(S=d.data)===null||S===void 0?void 0:S.x,y:(G=d.data)===null||G===void 0?void 0:G.y})}),c=s.map(function(d){return qe(d)}),this.lastLayoutNodes=u,this.lastLayoutEdges=c,this.lastAssign=r,this.lastGraph=t,h=n.alphaMin,l=n.alphaDecay,E=n.alpha,R=n.nodeStrength,_=n.edgeStrength,M=n.linkDistance,w=n.clustering,L=n.clusterFociStrength,k=n.clusterEdgeDistance,P=n.clusterEdgeStrength,wt=n.clusterNodeStrength,gt=n.clusterNodeSize,dt=n.collideStrength,X=dt===void 0?1:dt,ot=n.center,ht=ot===void 0?[0,0]:ot,nt=n.preventOverlap,b=n.nodeSize,C=n.nodeSpacing,Z=n.onTick,W=n.forceSimulation,[2,new Promise(function(d){if(W){w&&((rt=Ta()).nodes(u),rt.links(c)),W.nodes(u),c&&(g=io().id(function(v){return v.id}).links(c),_&&g.strength(_),M&&g.distance(M),W.force("link",g)),nt&&xt.overlapProcess(W,{nodeSize:b,nodeSpacing:C,collideStrength:X}),W.alpha(E).restart();var S=Ro(u),G=so(c);r&&S.forEach(function(v){return t.mergeNodeData(v.id,{x:v.data.x,y:v.data.y})}),d({nodes:S,edges:G})}else try{var rt,it=Ma();if(R&&it.strength(R),W=Di().nodes(u),w&&((rt=Ta()).centerX(ht[0]).centerY(ht[1]).template("force").strength(L),c&&rt.links(c),u&&rt.nodes(u),rt.forceLinkDistance(k).forceLinkStrength(P).forceCharge(wt).forceNodeSize(gt),W.force("group",rt)),W.force("center",function(v,f){var m,j=1;function H(){var p,D,B=m.length,I=0,q=0;for(p=0;p<B;++p)I+=(D=m[p]).x,q+=D.y;for(I=(I/B-v)*j,q=(q/B-f)*j,p=0;p<B;++p)(D=m[p]).x-=I,D.y-=q}return v==null&&(v=0),f==null&&(f=0),H.initialize=function(p){m=p},H.x=function(p){return arguments.length?(v=+p,H):v},H.y=function(p){return arguments.length?(f=+p,H):f},H.strength=function(p){return arguments.length?(j=+p,H):j},H}(ht[0],ht[1])).force("charge",it).alpha(E).alphaDecay(l).alphaMin(h),nt&&xt.overlapProcess(W,{nodeSize:b,nodeSpacing:C,collideStrength:X}),c){var g=io().id(function(v){return v.id}).links(c);_&&g.strength(_),M&&g.distance(M),W.force("link",g)}W.on("tick",function(){var v=Ro(u);Z==null||Z({nodes:v,edges:so(c)}),r&&v.forEach(function(f){return t.mergeNodeData(f.id,{x:f.data.x,y:f.data.y})})}).on("end",function(){var v=Ro(u);r&&v.forEach(function(f){return t.mergeNodeData(f.id,{x:f.data.x,y:f.data.y})}),d({nodes:v,edges:so(c)})})}catch(v){console.warn(v)}xt.forceSimulation=W})]})})},o.prototype.overlapProcess=function(r,t){var e,n,i=t.nodeSize,s=t.nodeSpacing,u=t.collideStrength;if(n=jt(s)?function(){return s}:Qe(s)?s:function(){return 0},i)if(Qe(i))e=function(l){return i(l)+n(l)};else if(te(i)){var c=(i[0]>i[1]?i[0]:i[1])/2;e=function(l){return c+n(l)}}else if(jt(i)){var h=i/2;e=function(l){return h+n(l)}}else e=function(){return 10};else e=function(l){return l.size?te(l.size)?(l.size[0]>l.size[1]?l.size[0]:l.size[1])/2+n(l):Tr(l.size)?(l.size.width>l.size.height?l.size.width:l.size.height)/2+n(l):l.size/2+n(l):10+n(l)};r.force("collisionForce",Ri(e).strength(u))},o}(),Ro=function(o){return o.map(function(r){var t=r.x,e=r.y,n=at(r,["x","y"]);return y(y({},n),{data:y(y({},n.data),{x:t,y:e})})})},so=function(o){return o.map(function(r){var t=r.source,e=r.target,n=at(r,["source","target"]);return y(y({},n),{source:t.id,target:e.id})})};const ka=function(){function o(){this._events={}}return o.prototype.on=function(r,t,e){return this._events[r]||(this._events[r]=[]),this._events[r].push({callback:t,once:!!e}),this},o.prototype.once=function(r,t){return this.on(r,t,!0)},o.prototype.emit=function(r){for(var t=this,e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=this._events[r]||[],s=this._events["*"]||[],u=function(c){for(var h=c.length,l=0;l<h;l++)if(c[l]){var E=c[l],R=E.callback;E.once&&(c.splice(l,1),c.length===0&&delete t._events[r],h--,l--),R.apply(t,e)}};u(i),u(s)},o.prototype.off=function(r,t){if(r)if(t){for(var e=this._events[r]||[],n=e.length,i=0;i<n;i++)e[i].callback===t&&(e.splice(i,1),n--,i--);e.length===0&&delete this._events[r]}else delete this._events[r];else this._events={};return this},o.prototype.getEvents=function(){return this._events},o}();function Da(o,r,t,e){for(;o.length;){const n=o.shift();if(t(n))return!0;r.add(n.id),e(n.id).forEach(i=>{r.has(i.id)||(r.add(i.id),o.push(i))})}return!1}function Oi(o,r,t,e){if(t(o))return!0;r.add(o.id);for(const n of e(o.id))if(!r.has(n.id)&&Oi(n,r,t,e))return!0;return!1}class Fr extends ka{constructor(t){super();Nn(this,"nodeMap",new Map);Nn(this,"edgeMap",new Map);Nn(this,"inEdgesMap",new Map);Nn(this,"outEdgesMap",new Map);Nn(this,"bothEdgesMap",new Map);Nn(this,"treeIndices",new Map);Nn(this,"changes",[]);Nn(this,"batchCount",0);Nn(this,"onChanged",()=>{});Nn(this,"batch",t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()});t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach(n=>{switch(n.type){case"NodeRemoved":{let i=!1;e=e.filter(s=>{if(s.type==="NodeAdded"){const u=s.value.id===n.value.id;return u&&(i=!0),!u}return s.type==="NodeDataUpdated"?s.id!==n.value.id:s.type!=="TreeStructureChanged"||s.nodeId!==n.value.id}),i||e.push(n);break}case"EdgeRemoved":{let i=!1;e=e.filter(s=>{if(s.type==="EdgeAdded"){const u=s.value.id===n.value.id;return u&&(i=!0),!u}return s.type!=="EdgeDataUpdated"&&s.type!=="EdgeUpdated"||s.id!==n.value.id}),i||e.push(n);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const i=e.find(s=>s.type===n.type&&s.id===n.id&&s.propertyName===n.propertyName);i?i.newValue=n.newValue:e.push(n);break}case"TreeStructureDetached":e=e.filter(i=>i.type==="TreeStructureAttached"?i.treeKey!==n.treeKey:i.type!=="TreeStructureChanged"||i.treeKey!==n.treeKey),e.push(n);break;case"TreeStructureChanged":{const i=e.find(s=>s.type==="TreeStructureChanged"&&s.treeKey===n.treeKey&&s.nodeId===n.nodeId);i?i.newParentId=n.newParentId:e.push(n);break}default:e.push(n)}}),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some(n=>n.id===t)}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),e==="in"){const n=this.inEdgesMap.get(t);return Array.from(n)}if(e==="out"){const n=this.outEdgesMap.get(t);return Array.from(n)}{const n=this.bothEdgesMap.get(t);return Array.from(n)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map(n=>this.getNode(n.target));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map(n=>this.getNode(n.source));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),n=this.getSuccessors(t);return Array.from(new Set([...e,...n]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach(e=>{e.childrenMap.set(t.id,new Set)}),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch(()=>{for(const e of t)this.doAddNode(e)})}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),n=this.bothEdgesMap.get(t);n==null||n.forEach(i=>this.doRemoveEdge(i.id)),this.nodeMap.delete(t),this.treeIndices.forEach(i=>{var s;(s=i.childrenMap.get(t))==null||s.forEach(u=>{i.parentMap.delete(u.id)}),i.parentMap.delete(t),i.childrenMap.delete(t)}),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch(()=>{t.forEach(e=>this.doRemoveNode(e))})}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,n){const i=this.getNode(t);this.batch(()=>{const s=i.data[e],u=n;i.data[e]=u,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:s,newValue:u})})}mergeNodeData(t,e){this.batch(()=>{Object.entries(e).forEach(([n,i])=>{this.updateNodeDataProperty(t,n,i)})})}updateNodeData(...t){const e=t[0],n=this.getNode(e);if(typeof t[1]=="string")return void this.updateNodeDataProperty(e,t[1],t[2]);let i;if(typeof t[1]=="function"){const s=t[1];i=s(n.data)}else typeof t[1]=="object"&&(i=t[1]);this.batch(()=>{const s=n.data,u=i;n.data=i,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:s,newValue:u})})}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),n=this.outEdgesMap.get(t.source),i=this.bothEdgesMap.get(t.source),s=this.bothEdgesMap.get(t.target);e.add(t),n.add(t),i.add(t),s.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch(()=>{for(const e of t)this.doAddEdge(e)})}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),n=this.outEdgesMap.get(e.source),i=this.inEdgesMap.get(e.target),s=this.bothEdgesMap.get(e.source),u=this.bothEdgesMap.get(e.target);n.delete(e),i.delete(e),s.delete(e),u.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch(()=>{t.forEach(e=>this.doRemoveEdge(e))})}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const n=this.getEdge(t);this.checkNodeExistence(e);const i=n.source,s=e;this.outEdgesMap.get(i).delete(n),this.bothEdgesMap.get(i).delete(n),this.outEdgesMap.get(s).add(n),this.bothEdgesMap.get(s).add(n),n.source=e,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:i,newValue:s})})}updateEdgeTarget(t,e){const n=this.getEdge(t);this.checkNodeExistence(e);const i=n.target,s=e;this.inEdgesMap.get(i).delete(n),this.bothEdgesMap.get(i).delete(n),this.inEdgesMap.get(s).add(n),this.bothEdgesMap.get(s).add(n),n.target=e,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:i,newValue:s})})}updateEdgeDataProperty(t,e,n){const i=this.getEdge(t);this.batch(()=>{const s=i.data[e],u=n;i.data[e]=u,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:s,newValue:u})})}updateEdgeData(...t){const e=t[0],n=this.getEdge(e);if(typeof t[1]=="string")return void this.updateEdgeDataProperty(e,t[1],t[2]);let i;if(typeof t[1]=="function"){const s=t[1];i=s(n.data)}else typeof t[1]=="object"&&(i=t[1]);this.batch(()=>{const s=n.data,u=i;n.data=i,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:s,newValue:u})})}mergeEdgeData(t,e){this.batch(()=>{Object.entries(e).forEach(([n,i])=>{this.updateEdgeDataProperty(t,n,i)})})}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch(()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})}))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch(()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})})}addTree(t,e){this.batch(()=>{this.attachTreeStructure(e);const n=[],i=Array.isArray(t)?t:[t];for(;i.length;){const s=i.shift();n.push(s),s.children&&i.push(...s.children)}this.addNodes(n),n.forEach(s=>{var u;(u=s.children)==null||u.forEach(c=>{this.setParent(c.id,s.id,e)})})})}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter(e=>!this.getParent(e.id,t))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const n=this.treeIndices.get(e).childrenMap.get(t);return Array.from(n||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const n=[];let i,s=this.getNode(t);for(;i=this.getParent(s.id,e);)n.push(i),s=i;return n}setParent(t,e,n){var l;this.checkTreeExistence(n);const i=this.treeIndices.get(n),s=this.getNode(t),u=i.parentMap.get(t),c=this.getNode(e);i.parentMap.set(t,c),u&&((l=i.childrenMap.get(u.id))==null||l.delete(s));let h=i.childrenMap.get(c.id);h||(h=new Set,i.childrenMap.set(c.id,h)),h.add(s),this.batch(()=>{this.changes.push({type:"TreeStructureChanged",treeKey:n,nodeId:t,oldParentId:u==null?void 0:u.id,newParentId:c.id})})}dfsTree(t,e,n){return Oi(this.getNode(t),new Set,e,i=>this.getChildren(i,n))}bfsTree(t,e,n){return Da([this.getNode(t)],new Set,e,i=>this.getChildren(i,n))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,n="out"){const i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];return Da([this.getNode(t)],new Set,e,i)}dfs(t,e,n="out"){const i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];return Oi(this.getNode(t),new Set,e,i)}clone(){const t=this.getAllNodes().map(i=>({...i,data:{...i.data}})),e=this.getAllEdges().map(i=>({...i,data:{...i.data}})),n=new Fr({nodes:t,edges:e});return this.treeIndices.forEach(({parentMap:i,childrenMap:s},u)=>{const c=new Map;i.forEach((l,E)=>{c.set(E,n.getNode(l.id))});const h=new Map;s.forEach((l,E)=>{h.set(E,new Set(Array.from(l).map(R=>n.getNode(R.id))))}),n.treeIndices.set(u,{parentMap:c,childrenMap:h})}),n}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var hs=function(o,r){if(o!=="next"&&o!=="prev")return r},uo=function(o){o.prev.next=o.next,o.next.prev=o.prev,delete o.next,delete o.prev},fs=function(o){function r(){return o!==null&&o.apply(this,arguments)||this}return lt(r,o),r}(function(){function o(){var r={};r.prev=r,r.next=r.prev,this.shortcut=r}return o.prototype.dequeue=function(){var r=this.shortcut,t=r.prev;if(t&&t!==r)return uo(t),t},o.prototype.enqueue=function(r){var t=this.shortcut;r.prev&&r.next&&uo(r),r.next=t.next,t.next.prev=r,t.next=r,r.prev=t},o.prototype.toString=function(){for(var r=[],t=this.shortcut,e=t.prev;e!==t;)r.push(JSON.stringify(e,hs)),e=e==null?void 0:e.prev;return"["+r.join(", ")+"]"},o}()),Ci=function(){return 1},Li=function(o,r,t,e,n){var i,s,u=[];return o.hasNode(e.v)&&((i=o.getRelatedEdges(e.v,"in"))===null||i===void 0||i.forEach(function(c){var h=c.data.weight,l=o.getNode(c.source);n&&u.push({v:c.source,w:c.target,in:0,out:0}),l.data.out===void 0&&(l.data.out=0),l.data.out-=h,In(r,t,y({v:l.id},l.data))}),(s=o.getRelatedEdges(e.v,"out"))===null||s===void 0||s.forEach(function(c){var h=c.data.weight,l=c.target,E=o.getNode(l);E.data.in===void 0&&(E.data.in=0),E.data.in-=h,In(r,t,y({v:E.id},E.data))}),o.removeNode(e.v)),n?u:void 0},In=function(o,r,t){t.out?t.in?o[t.out-t.in+r].enqueue(t):o[o.length-1].enqueue(t):o[0].enqueue(t)},un=function(o,r,t,e){var n;do n=""+e+Math.random();while(o.hasNode(n));return t.dummy=r,o.addNode({id:n,data:t}),n},qn=function(o){var r=new Fr;return o.getAllNodes().forEach(function(t){o.getChildren(t.id).length||r.addNode(y({},t))}),o.getAllEdges().forEach(function(t){r.addEdge(t)}),r},zi=function(o,r){var t,e,n=Number(o.x),i=Number(o.y),s=Number(r.x)-n,u=Number(r.y)-i,c=Number(o.width)/2,h=Number(o.height)/2;return s||u?(Math.abs(u)*c>Math.abs(s)*h?(u<0&&(h=-h),t=h*s/u,e=h):(s<0&&(c=-c),t=c,e=c*u/s),{x:n+t,y:i+e}):{x:0,y:0}},fn=function(o){for(var r=[],t=ni(o)+1,e=0;e<t;e++)r.push([]);for(o.getAllNodes().forEach(function(n){var i=n.data.rank;i!==void 0&&r[i]&&r[i].push(n.id)}),e=0;e<t;e++)r[e]=r[e].sort(function(n,i){return s=o.getNode(n).data.order,u=o.getNode(i).data.order,Number(s)-Number(u);var s,u});return r},ri=function(o,r,t,e){var n={width:0,height:0};return jt(t)&&jt(e)&&(n.rank=t,n.order=e),un(o,"border",n,r)},ni=function(o){var r;return o.getAllNodes().forEach(function(t){var e=t.data.rank;e!==void 0&&(r===void 0||e>r)&&(r=e)}),r||(r=0),r},Oo=function(o,r){return o.reduce(function(t,e){return r(t)>r(e)?e:t})},oi=function(o,r,t,e,n,i){e.includes(r.id)||(e.push(r.id),t||i.push(r.id),n(r.id).forEach(function(s){return oi(o,s,t,e,n,i)}),t&&i.push(r.id))},ii=function(o,r,t,e){var n=Array.isArray(r)?r:[r],i=function(c){return e?o.getSuccessors(c):o.getNeighbors(c)},s=[],u=[];return n.forEach(function(c){if(!o.hasNode(c.id))throw new Error("Graph does not have node: "+c);oi(o,c,t==="post",u,i,s)}),s},Co="edge-label",Pi=function(o){var r={},t=function(e){var n,i,s=o.getNode(e);return s?r[e]?s.data.rank:(r[e]=!0,(n=o.getRelatedEdges(e,"out"))===null||n===void 0||n.forEach(function(u){var c=t(u.target)-u.data.minlen;c&&(i===void 0||c<i)&&(i=c)}),i||(i=0),s.data.rank=i,i):0};o.getAllNodes().filter(function(e){return o.getRelatedEdges(e.id,"in").length===0}).forEach(function(e){return t(e.id)})},En=function(o,r){return o.getNode(r.target).data.rank-o.getNode(r.source).data.rank-r.data.minlen},Ra=function(o,r){var t=function(e){r.getRelatedEdges(e,"both").forEach(function(n){var i=n.source,s=e===i?n.target:i;o.hasNode(s)||En(r,n)||(o.addNode({id:s,data:{}}),o.addEdge({id:n.id,source:e,target:s,data:{}}),t(s))})};return o.getAllNodes().forEach(function(e){return t(e.id)}),o.getAllNodes().length},Oa=function(o,r){var t=function(e){var n;(n=r.getRelatedEdges(e,"both"))===null||n===void 0||n.forEach(function(i){var s=i.source,u=e===s?i.target:s;o.hasNode(u)||r.getNode(u).data.layer===void 0&&En(r,i)||(o.addNode({id:u,data:{}}),o.addEdge({id:i.id,source:e,target:u,data:{}}),t(u))})};return o.getAllNodes().forEach(function(e){return t(e.id)}),o.getAllNodes().length},Gi=function(o,r){return Oo(r.getAllEdges(),function(t){return o.hasNode(t.source)!==o.hasNode(t.target)?En(r,t):1/0})},ai=function(o,r,t){o.getAllNodes().forEach(function(e){var n=r.getNode(e.id);n.data.rank||(n.data.rank=0),n.data.rank+=t})},si=function(o,r){var t=ii(o,o.getAllNodes(),"post",!1);(t=t.slice(0,(t==null?void 0:t.length)-1)).forEach(function(e){Ca(o,r,e)})},Ca=function(o,r,t){var e=o.getNode(t).data.parent;o.getRelatedEdges(t,"both").find(function(n){return n.target===e||n.source===e}).data.cutvalue=La(o,r,t)},La=function(o,r,t){var e=o.getNode(t).data.parent,n=!0,i=r.getRelatedEdges(t,"out").find(function(u){return u.target===e}),s=0;return i||(n=!1,i=r.getRelatedEdges(e,"out").find(function(u){return u.target===t})),s=i.data.weight,r.getRelatedEdges(t,"both").forEach(function(u){var c=u.source===t,h=c?u.target:u.source;if(h!==e){var l=c===n,E=u.data.weight;if(s+=l?E:-E,Vi(o,t,h)){var R=o.getRelatedEdges(t,"both").find(function(_){return _.source===h||_.target===h}).data.cutvalue;s+=l?-R:R}}}),s},Fi=function(o,r){r===void 0&&(r=o.getAllNodes()[0].id),ji(o,{},1,r)},ji=function(o,r,t,e,n){var i,s=t,u=t,c=o.getNode(e);return r[e]=!0,(i=o.getNeighbors(e))===null||i===void 0||i.forEach(function(h){r[h.id]||(u=ji(o,r,u,h.id,e))}),c.data.low=s,c.data.lim=u++,n?c.data.parent=n:delete c.data.parent,u},Ui=function(o){return o.getAllEdges().find(function(r){return r.data.cutvalue<0})},za=function(o,r,t){var e=t.source,n=t.target;r.getRelatedEdges(e,"out").find(function(l){return l.target===n})||(e=t.target,n=t.source);var i=o.getNode(e),s=o.getNode(n),u=i,c=!1;i.data.lim>s.data.lim&&(u=s,c=!0);var h=r.getAllEdges().filter(function(l){return c===Wi(o.getNode(l.source),u)&&c!==Wi(o.getNode(l.target),u)});return Oo(h,function(l){return En(r,l)})},Pa=function(o,r,t,e){var n=o.getRelatedEdges(t.source,"both").find(function(i){return i.source===t.target||i.target===t.target});n&&o.removeEdge(n.id),o.addEdge({id:"e"+Math.random(),source:e.source,target:e.target,data:{}}),Fi(o),si(o,r),Bi(o,r)},Bi=function(o,r){var t=o.getAllNodes().find(function(n){return!n.data.parent}),e=ii(o,t,"pre",!1);(e=e.slice(1)).forEach(function(n){var i=o.getNode(n).data.parent,s=r.getRelatedEdges(n,"out").find(function(c){return c.target===i}),u=!1;!s&&r.hasNode(i)&&(s=r.getRelatedEdges(i,"out").find(function(c){return c.target===n}),u=!0),r.getNode(n).data.rank=(r.hasNode(i)&&r.getNode(i).data.rank||0)+(u?s==null?void 0:s.data.minlen:-(s==null?void 0:s.data.minlen))})},Vi=function(o,r,t){return o.getRelatedEdges(r,"both").find(function(e){return e.source===t||e.target===t})},Wi=function(o,r){return r.data.low<=o.data.lim&&o.data.lim<=r.data.lim},qi=Pi,Hi=function(o,r,t,e,n,i,s){var u=o.getChildren(s);if(u!=null&&u.length){var c=ri(o,"_bt"),h=ri(o,"_bb"),l=o.getNode(s);o.setParent(c,s),l.data.borderTop=c,o.setParent(h,s),l.data.borderBottom=h,u==null||u.forEach(function(E){Hi(o,r,t,e,n,i,E.id);var R=E.data.borderTop?E.data.borderTop:E.id,_=E.data.borderBottom?E.data.borderBottom:E.id,M=E.data.borderTop?e:2*e,w=R!==_?1:n-i[s]+1;o.addEdge({id:"e"+Math.random(),source:c,target:R,data:{minlen:w,weight:M,nestingEdge:!0}}),o.addEdge({id:"e"+Math.random(),source:_,target:h,data:{minlen:w,weight:M,nestingEdge:!0}})}),o.getParent(s)||o.addEdge({id:"e"+Math.random(),source:r,target:c,data:{weight:0,minlen:n+i[s]}})}else s!==r&&o.addEdge({id:"e"+Math.random(),source:r,target:s,data:{weight:0,minlen:t}})},Xi=function(o,r,t,e,n,i){var s={rank:i,borderType:r,width:0,height:0},u=n.data[r][i-1],c=un(o,"border",s,t);n.data[r][i]=c,o.setParent(c,e),u&&o.addEdge({id:"e"+Math.random(),source:u,target:c,data:{weight:1}})},ui=function(o){o.getAllNodes().forEach(function(r){$i(r)}),o.getAllEdges().forEach(function(r){$i(r)})},$i=function(o){var r=o.data.width;o.data.width=o.data.height,o.data.height=r},ci=function(o){o!=null&&o.y&&(o.y=-o.y)},Lo=function(o){var r=o.x;o.x=o.y,o.y=r},di=function(o){for(var r={},t=o.getAllNodes(),e=t.map(function(h){var l;return(l=h.data.rank)!==null&&l!==void 0?l:-1/0}),n=Math.max.apply(Math,St([],_t(e))),i=[],s=0;s<n+1;s++)i.push([]);var u=t.sort(function(h,l){return o.getNode(h.id).data.rank-o.getNode(l.id).data.rank}),c=u.filter(function(h){return o.getNode(h.id).data.fixorder!==void 0}).sort(function(h,l){return o.getNode(h.id).data.fixorder-o.getNode(l.id).data.fixorder});return c==null||c.forEach(function(h){isNaN(o.getNode(h.id).data.rank)||i[o.getNode(h.id).data.rank].push(h.id),r[h.id]=!0}),u==null||u.forEach(function(h){return o.dfsTree(h.id,function(l){if(r.hasOwnProperty(l.id))return!0;r[l.id]=!0,isNaN(l.data.rank)||i[l.data.rank].push(l.id)})}),i},zo=function(o,r,t){for(var e=function(l,E){return l==null?void 0:l.reduce(function(R,_,M){return R[_]=E[M],R},{})}(t,t.map(function(l,E){return E})),n=r.map(function(l){var E=o.getRelatedEdges(l,"out").map(function(R){return{pos:e[R.target]||0,weight:R.data.weight}});return E==null?void 0:E.sort(function(R,_){return R.pos-_.pos})}),i=n.flat().filter(function(l){return l!==void 0}),s=1;s<t.length;)s<<=1;var u=2*s-1;s-=1;var c=Array(u).fill(0,0,u),h=0;return i==null||i.forEach(function(l){if(l){var E=l.pos+s;c[E]+=l.weight;for(var R=0;E>0;)E%2&&(R+=c[E+1]),c[E=E-1>>1]+=l.weight;h+=l.weight*R}}),h},Yi=function(o,r){for(var t=0,e=1;e<(r==null?void 0:r.length);e+=1)t+=zo(o,r[e-1],r[e]);return t},Po=function(o,r,t){for(var e,n=t;r.length&&(e=r[r.length-1]).i<=n;)r.pop(),o==null||o.push(e.vs),n++;return n},gn=function(o,r,t,e,n,i){var s,u,c,h,l=o.getChildren(r).map(function(gt){return gt.id}),E=o.getNode(r),R=E?E.data.borderLeft:void 0,_=E?E.data.borderRight:void 0,M={};R&&(l=l==null?void 0:l.filter(function(gt){return gt!==R&&gt!==_}));var w=function(gt,dt){return dt.map(function(X){var ot=gt.getRelatedEdges(X,"in");if(!(ot!=null&&ot.length))return{v:X};var ht={sum:0,weight:0};return ot==null||ot.forEach(function(nt){var b=gt.getNode(nt.source);ht.sum+=nt.data.weight*b.data.order,ht.weight+=nt.data.weight}),{v:X,barycenter:ht.sum/ht.weight,weight:ht.weight}})}(o,l||[]);w==null||w.forEach(function(gt){var dt;if(!((dt=o.getChildren(gt.v))===null||dt===void 0)&&dt.length){var X=gn(o,gt.v,t,e,i);M[gt.v]=X,X.hasOwnProperty("barycenter")&&Hn(gt,X)}});var L=function(gt,dt){var X,ot,ht,nt={};return gt==null||gt.forEach(function(b,C){nt[b.v]={i:C,indegree:0,in:[],out:[],vs:[b.v]};var Z=nt[b.v];b.barycenter!==void 0&&(Z.barycenter=b.barycenter,Z.weight=b.weight)}),(X=dt.getAllEdges())===null||X===void 0||X.forEach(function(b){var C=nt[b.source],Z=nt[b.target];C!==void 0&&Z!==void 0&&(Z.indegree++,C.out.push(nt[b.target]))}),function(b){for(var C,Z,W=[],xt=function(){var S=b.pop();W.push(S),(C=S.in.reverse())===null||C===void 0||C.forEach(function(G){return(rt=S,function(it){it.merged||(it.barycenter===void 0||rt.barycenter===void 0||it.barycenter>=rt.barycenter)&&function(g,v){var f,m=0,j=0;g.weight&&(m+=g.barycenter*g.weight,j+=g.weight),v.weight&&(m+=v.barycenter*v.weight,j+=v.weight),g.vs=(f=v.vs)===null||f===void 0?void 0:f.concat(g.vs),g.barycenter=m/j,g.weight=j,g.i=Math.min(v.i,g.i),v.merged=!0}(rt,it)})(G);var rt}),(Z=S.out)===null||Z===void 0||Z.forEach(function(G){return(rt=S,function(it){it.in.push(rt),--it.indegree==0&&b.push(it)})(G);var rt})};b!=null&&b.length;)xt();var A=W.filter(function(S){return!S.merged}),d=["vs","i","barycenter","weight"];return A.map(function(S){var G={};return d==null||d.forEach(function(rt){S[rt]!==void 0&&(G[rt]=S[rt])}),G})}((ht=(ot=Object.values(nt)).filter)===null||ht===void 0?void 0:ht.call(ot,function(b){return!b.indegree}))}(w,t);Go(L,M),(s=L.filter(function(gt){return gt.vs.length>0}))===null||s===void 0||s.forEach(function(gt){var dt=o.getNode(gt.vs[0]);dt&&(gt.fixorder=dt.data.fixorder,gt.order=dt.data.order)});var k=function(gt,dt,X,ot){var ht=function(d,S){var G={lhs:[],rhs:[]};return d==null||d.forEach(function(rt){var it,g;g=(it=rt).hasOwnProperty("fixorder")&&!isNaN(it.fixorder),(ot?!g&&it.hasOwnProperty("barycenter"):g||it.hasOwnProperty("barycenter"))?G.lhs.push(rt):G.rhs.push(rt)}),G}(gt),nt=ht.lhs,b=ht.rhs.sort(function(d,S){return-d.i- -S.i}),C=[],Z=0,W=0,xt=0;nt==null||nt.sort(function(d,S){return function(G,rt){if(G.fixorder!==void 0&&rt.fixorder!==void 0)return G.fixorder-rt.fixorder;if(G.barycenter<rt.barycenter)return-1;if(G.barycenter>rt.barycenter)return 1;if(S&&G.order!==void 0&&rt.order!==void 0){if(G.order<rt.order)return-1;if(G.order>rt.order)return 1}return d?rt.i-G.i:G.i-rt.i}}(!!dt,!!X)),xt=Po(C,b,xt),nt==null||nt.forEach(function(d){var S;xt+=(S=d.vs)===null||S===void 0?void 0:S.length,C.push(d.vs),Z+=d.barycenter*d.weight,W+=d.weight,xt=Po(C,b,xt)});var A={vs:C.flat()};return W&&(A.barycenter=Z/W,A.weight=W),A}(L,e,n,i);if(R&&(k.vs=[R,k.vs,_].flat(),(u=o.getPredecessors(R))===null||u===void 0?void 0:u.length)){var P=o.getNode(((c=o.getPredecessors(R))===null||c===void 0?void 0:c[0].id)||""),wt=o.getNode(((h=o.getPredecessors(_))===null||h===void 0?void 0:h[0].id)||"");k.hasOwnProperty("barycenter")||(k.barycenter=0,k.weight=0),k.barycenter=(k.barycenter*k.weight+P.data.order+wt.data.order)/(k.weight+2),k.weight+=2}return k},Go=function(o,r){o==null||o.forEach(function(t){var e,n=(e=t.vs)===null||e===void 0?void 0:e.map(function(i){return r[i]?r[i].vs:i});t.vs=n.flat()})},Hn=function(o,r){o.barycenter!==void 0?(o.barycenter=(o.barycenter*o.weight+r.barycenter*r.weight)/(o.weight+r.weight),o.weight+=r.weight):(o.barycenter=r.barycenter,o.weight=r.weight)},Xn=function(o){if(typeof o!="object"||o===null)return o;var r,t;if(t=o,Array.isArray?Array.isArray(t):Se(t,"Array")){r=[];for(var e=0,n=o.length;e<n;e++)typeof o[e]=="object"&&o[e]!=null?r[e]=Xn(o[e]):r[e]=o[e]}else for(var i in r={},o)typeof o[i]=="object"&&o[i]!=null?r[i]=Xn(o[i]):r[i]=o[i];return r};const co=Xn;var kn=function(o,r,t){return r.map(function(e){return function(n,i,s){var u=function(h){for(var l;h.hasNode(l="_root"+Math.random()););return l}(n),c=new Fr({tree:[{id:u,children:[],data:{}}]});return n.getAllNodes().forEach(function(h){var l=n.getParent(h.id);(h.data.rank===i||h.data.minRank<=i&&i<=h.data.maxRank)&&(c.hasNode(h.id)||c.addNode(y({},h)),l!=null&&l.id&&!c.hasNode(l==null?void 0:l.id)&&c.addNode(y({},l)),c.setParent(h.id,(l==null?void 0:l.id)||u),n.getRelatedEdges(h.id,s).forEach(function(E){var R=E.source===h.id?E.target:E.source;c.hasNode(R)||c.addNode(y({},n.getNode(R)));var _=c.getRelatedEdges(R,"out").find(function(w){return w.target===h.id}),M=_!==void 0?_.data.weight:0;_?c.updateEdgeData(_.id,y(y({},_.data),{weight:E.data.weight+M})):c.addEdge({id:E.id,source:R,target:h.id,data:{weight:E.data.weight+M}})}),h.data.hasOwnProperty("minRank")&&c.updateNodeData(h.id,y(y({},h.data),{borderLeft:h.data.borderLeft[i],borderRight:h.data.borderRight[i]})))}),c}(o,e,t)})},Dn=function(o,r,t,e){var n=new Fr;o==null||o.forEach(function(i){for(var s,u=i.getRoots()[0].id,c=gn(i,u,n,r,t,e),h=0;h<((s=c.vs)===null||s===void 0?void 0:s.length);h++){var l=i.getNode(c.vs[h]);l&&(l.data.order=h)}(function(E,R,_){var M,w={};_==null||_.forEach(function(L){for(var k,P,wt=E.getParent(L);wt;){if((k=E.getParent(wt.id))?(P=w[k.id],w[k.id]=wt.id):(P=M,M=wt.id),P&&P!==wt.id)return R.addNodes([{id:P,data:{}},{id:wt.id,data:{}}]),void R.addEdge({id:"e"+P+"-"+wt.id,source:P,target:wt.id,data:{}});wt=k}})})(i,n,c.vs)})},xn=function(o,r){r==null||r.forEach(function(t){t==null||t.forEach(function(e,n){o.getNode(e).data.order=n})})},Fo=function(o,r,t){var e=r,n=t;if(e>n){var i=e;e=n,n=i}var s=o[e];s||(o[e]=s={}),s[n]=!0},li=function(o,r,t){var e=r;return e>t&&(e=t),!!o[e]},jo=function(o,r,t,e,n,i){var s=new Fr,u=Ki(e,n,i);return r==null||r.forEach(function(c){var h;c==null||c.forEach(function(l){var E=t[l];if(s.hasNode(E)||s.addNode({id:E,data:{}}),h){var R=t[h],_=s.getRelatedEdges(R,"out").find(function(M){return M.target===E});_?s.updateEdgeData(_.id,y(y({},_.data),{weight:Math.max(u(o,l,h),_.data.weight||0)})):s.addEdge({id:"e"+Math.random(),source:R,target:E,data:{weight:Math.max(u(o,l,h),0)}})}h=l})}),s},Ki=function(o,r,t){return function(e,n,i){var s=e.getNode(n),u=e.getNode(i),c=0,h=0;if(c+=s.data.width/2,s.data.hasOwnProperty("labelpos"))switch((s.data.labelpos||"").toLowerCase()){case"l":h=-s.data.width/2;break;case"r":h=s.data.width/2}if(h&&(c+=t?h:-h),h=0,c+=(s.data.dummy?r:o)/2,c+=(u.data.dummy?r:o)/2,c+=u.data.width/2,u.data.labelpos)switch((u.data.labelpos||"").toLowerCase()){case"l":h=u.data.width/2;break;case"r":h=-u.data.width/2}return h&&(c+=t?h:-h),h=0,c}},Zi=function(o,r){var t=r.acyclicer,e=r.ranker,n=r.rankdir,i=n===void 0?"tb":n,s=r.nodeOrder,u=r.keepNodeOrder,c=r.align,h=r.nodesep,l=h===void 0?50:h,E=r.edgesep,R=E===void 0?20:E,_=r.ranksep,M=_===void 0?50:_;Es(o),function(X,ot){var ht=ot==="greedy"?function(nt,b){var C;if(nt.getAllNodes().length<=1)return[];var Z=function(W,xt){var A=new Fr,d=0,S=0;W.getAllNodes().forEach(function(v){A.addNode({id:v.id,data:{v:v.id,in:0,out:0}})}),W.getAllEdges().forEach(function(v){var f=A.getRelatedEdges(v.source,"out").find(function(j){return j.target===v.target}),m=(xt==null?void 0:xt(v))||1;f?A.updateEdgeData(f==null?void 0:f.id,y(y({},f.data),{weight:f.data.weight+m})):A.addEdge({id:v.id,source:v.source,target:v.target,data:{weight:m}}),S=Math.max(S,A.getNode(v.source).data.out+=m),d=Math.max(d,A.getNode(v.target).data.in+=m)});for(var G=[],rt=S+d+3,it=0;it<rt;it++)G.push(new fs);var g=d+1;return A.getAllNodes().forEach(function(v){In(G,g,y({v:v.id},A.getNode(v.id).data))}),{buckets:G,zeroIdx:g,graph:A}}(nt,function(W){return W.data.weight||1});return(C=function(W,xt,A){for(var d,S=[],G=xt[xt.length-1],rt=xt[0];W.getAllNodes().length;){for(;d=rt.dequeue();)Li(W,xt,A,d);for(;d=G.dequeue();)Li(W,xt,A,d);if(W.getAllNodes().length){for(var it=xt.length-2;it>0;--it)if(d=xt[it].dequeue()){S=S.concat(Li(W,xt,A,d,!0));break}}}return S}(Z.graph,Z.buckets,Z.zeroIdx).map(function(W){return nt.getRelatedEdges(W.v,"out").filter(function(xt){return xt.target===W.w})}))===null||C===void 0?void 0:C.flat()}(X):function(nt){var b=[],C={},Z={},W=function(xt){Z[xt]||(Z[xt]=!0,C[xt]=!0,nt.getRelatedEdges(xt,"out").forEach(function(A){C[A.target]?b.push(A):W(A.target)}),delete C[xt])};return nt.getAllNodes().forEach(function(xt){return W(xt.id)}),b}(X);ht==null||ht.forEach(function(nt){var b=nt.data;X.removeEdge(nt.id),b.forwardName=nt.data.name,b.reversed=!0,X.addEdge({id:nt.id,source:nt.target,target:nt.source,data:y({},b)})})}(o,t);var w=function(X){var ot=un(X,"root",{},"_root"),ht=function(W){var xt={},A=function(d,S){var G=W.getChildren(d);G==null||G.forEach(function(rt){return A(rt.id,S+1)}),xt[d]=S};return W.getRoots().forEach(function(d){return A(d.id,1)}),xt}(X),nt=Math.max.apply(Math,St([],_t(Object.values(ht))));Math.abs(nt)===1/0&&(nt=1);var b=nt-1,C=2*b+1;X.getAllEdges().forEach(function(W){W.data.minlen*=C});var Z=function(W){var xt=0;return W.getAllEdges().forEach(function(A){xt+=A.data.weight}),xt}(X)+1;return X.getRoots().forEach(function(W){Hi(X,ot,C,Z,b,ht,W.id)}),{nestingRoot:ot,nodeRankFactor:C}}(o),L=w.nestingRoot,k=w.nodeRankFactor;(function(X,ot){switch(ot){case"network-simplex":(function(ht){(function(nt){var b=function(xt){var A=new Fr;return xt.getAllNodes().forEach(function(d){A.addNode(y({},d))}),xt.getAllEdges().forEach(function(d){var S=A.getRelatedEdges(d.source,"out").find(function(G){return G.target===d.target});S?A.updateEdgeData(S==null?void 0:S.id,y(y({},S.data),{weight:S.data.weight+d.data.weight||0,minlen:Math.max(S.data.minlen,d.data.minlen||1)})):A.addEdge({id:d.id,source:d.source,target:d.target,data:{weight:d.data.weight||0,minlen:d.data.minlen||1}})}),A}(nt);Pi(b);var C,Z,W=function(xt){var A,d,S=new Fr({tree:[]}),G=xt.getAllNodes()[0],rt=xt.getAllNodes().length;for(S.addNode(G);Ra(S,xt)<rt;)A=Gi(S,xt),d=S.hasNode(A.source)?En(xt,A):-En(xt,A),ai(S,xt,d);return S}(b);for(Fi(W),si(W,b);C=Ui(W);)Z=za(W,b,C),Pa(W,b,C,Z)})(ht)})(X);break;case"tight-tree":default:(function(ht){(function(nt){var b,C={},Z=function(A){var d,S,G=nt.getNode(A);return G?C[A]?G.data.rank:(C[A]=!0,(d=nt.getRelatedEdges(A,"out"))===null||d===void 0||d.forEach(function(rt){var it=Z(rt.target)-rt.data.minlen;it&&(S===void 0||it<S)&&(S=it)}),S||(S=0),(b===void 0||S<b)&&(b=S),G.data.rank=S,S):0};nt.getAllNodes().filter(function(A){return nt.getRelatedEdges(A.id,"in").length===0}).forEach(function(A){A&&Z(A.id)}),b===void 0&&(b=0);var W={},xt=function(A,d){var S,G=nt.getNode(A),rt=isNaN(G.data.layer)?d:G.data.layer;(G.data.rank===void 0||G.data.rank<rt)&&(G.data.rank=rt),W[A]||(W[A]=!0,(S=nt.getRelatedEdges(A,"out"))===null||S===void 0||S.forEach(function(it){xt(it.target,rt+it.data.minlen)}))};nt.getAllNodes().forEach(function(A){var d=A.data;d&&(isNaN(d.layer)?d.rank-=b:xt(A.id,d.layer))})})(ht),function(nt){var b,C,Z=new Fr({tree:[]}),W=nt.getAllNodes()[0],xt=nt.getAllNodes().length;for(Z.addNode(W);Oa(Z,nt)<xt;)b=Gi(Z,nt),C=Z.hasNode(b.source)?En(nt,b):-En(nt,b),ai(Z,nt,C)}(ht)})(X);break;case"longest-path":qi(X)}})(qn(o),e),Ga(o),function(X,ot){ot===void 0&&(ot=0);var ht=X.getAllNodes(),nt=ht.filter(function(A){return A.data.rank!==void 0}).map(function(A){return A.data.rank}),b=Math.min.apply(Math,St([],_t(nt))),C=[];ht.forEach(function(A){var d=(A.data.rank||0)-b;C[d]||(C[d]=[]),C[d].push(A.id)});for(var Z=0,W=0;W<C.length;W++){var xt=C[W];xt===void 0?W%ot!=0&&(Z-=1):Z&&(xt==null||xt.forEach(function(A){var d=X.getNode(A);d&&(d.data.rank=d.data.rank||0,d.data.rank+=Z)}))}}(o,k),function(X,ot){ot&&X.removeNode(ot),X.getAllEdges().forEach(function(ht){ht.data.nestingEdge&&X.removeEdge(ht.id)})}(o,L),function(X){var ot=X.getAllNodes().filter(function(nt){return nt.data.rank!==void 0}).map(function(nt){return nt.data.rank}),ht=Math.min.apply(Math,St([],_t(ot)));X.getAllNodes().forEach(function(nt){nt.data.hasOwnProperty("rank")&&ht!==1/0&&(nt.data.rank-=ht)})}(o),Fa(o),vs(o);var P=[];(function(X,ot){X.getAllEdges().forEach(function(ht){return function(nt,b,C){var Z=b.source,W=nt.getNode(Z).data.rank,xt=b.target,A=nt.getNode(xt).data.rank,d=b.data.labelRank;if(A!==W+1){var S,G,rt;for(nt.removeEdge(b.id),rt=0,++W;W<A;++rt,++W)b.data.points=[],S=un(nt,"edge",G={originalEdge:b,width:0,height:0,rank:W},"_d"),W===d&&(G.width=b.data.width,G.height=b.data.height,G.dummy=Co,G.labelpos=b.data.labelpos),nt.addEdge({id:"e"+Math.random(),source:Z,target:S,data:{weight:b.data.weight}}),rt===0&&C.push(S),Z=S;nt.addEdge({id:"e"+Math.random(),source:Z,target:xt,data:{weight:b.data.weight}})}}(X,ht,ot)})})(o,P),function(X,ot){var ht=function(nt){var b={},C=0,Z=function(W){var xt=C;nt.getChildren(W).forEach(function(A){return Z(A.id)}),b[W]={low:xt,lim:C++}};return nt.getRoots().forEach(function(W){return Z(W.id)}),b}(X);ot.forEach(function(nt){var b,C,Z=nt,W=X.getNode(Z),xt=W.data.originalEdge;if(xt)for(var A=function(g,v,f,m){var j,H,p,D,B=[],I=[],q=Math.min(v[f].low,v[m].low),Q=Math.max(v[f].lim,v[m].lim);p=f;do p=(j=g.getParent(p))===null||j===void 0?void 0:j.id,B.push(p);while(p&&(v[p].low>q||Q>v[p].lim));for(D=p,p=m;p&&p!==D;)I.push(p),p=(H=g.getParent(p))===null||H===void 0?void 0:H.id;return{lca:D,path:B.concat(I.reverse())}}(X,ht,xt.source,xt.target),d=A.path,S=A.lca,G=0,rt=d[G],it=!0;Z!==xt.target;){if(W=X.getNode(Z),it){for(;rt!==S&&((b=X.getNode(rt))===null||b===void 0?void 0:b.data.maxRank)<W.data.rank;)rt=d[++G];rt===S&&(it=!1)}if(!it){for(;G<d.length-1&&((C=X.getNode(d[G+1]))===null||C===void 0?void 0:C.data.minRank)<=W.data.rank;)G++;rt=d[G]}X.hasNode(rt)&&X.setParent(Z,rt),Z=X.getSuccessors(Z)[0].id}})}(o,P),function(X){var ot=function(ht){var nt=X.getChildren(ht),b=X.getNode(ht);if(nt!=null&&nt.length&&nt.forEach(function(W){return ot(W.id)}),b.data.hasOwnProperty("minRank")){b.data.borderLeft=[],b.data.borderRight=[];for(var C=b.data.minRank,Z=b.data.maxRank+1;C<Z;C+=1)Xi(X,"borderLeft","_bl",ht,b,C),Xi(X,"borderRight","_br",ht,b,C)}};X.getRoots().forEach(function(ht){return ot(ht.id)})}(o),u&&function(X,ot){for(var ht=X.getAllNodes().filter(function(Z){var W;return!(!((W=X.getChildren(Z.id))===null||W===void 0)&&W.length)}).map(function(Z){return Z.data.rank}),nt=Math.max.apply(Math,St([],_t(ht))),b=[],C=0;C<nt+1;C++)b[C]=[];ot==null||ot.forEach(function(Z){var W=X.getNode(Z);W&&!W.data.dummy&&(isNaN(W.data.rank)||(W.data.fixorder=b[W.data.rank].length,b[W.data.rank].push(Z)))})}(o,s),function(X,ot){for(var ht=ni(X),nt=[],b=[],C=1;C<ht+1;C++)nt.push(C);for(C=ht-1;C>-1;C--)b.push(C);var Z=kn(X,nt,"in"),W=kn(X,b,"out"),xt=di(X);xn(X,xt);for(var A,d=Number.POSITIVE_INFINITY,S=(C=0,0);S<4;++C,++S)Dn(C%2?Z:W,C%4>=2,!1,ot),xt=fn(X),(G=Yi(X,xt))<d&&(S=0,A=co(xt),d=G);for(xt=di(X),xn(X,xt),C=0,S=0;S<4;++C,++S){var G;Dn(C%2?Z:W,C%4>=2,!0,ot),xt=fn(X),(G=Yi(X,xt))<d&&(S=0,A=co(xt),d=G)}xn(X,A)}(o,u),xs(o),function(X,ot){var ht=ot.toLowerCase();ht!=="lr"&&ht!=="rl"||ui(X)}(o,i),function(X,ot){var ht,nt=qn(X);(function(C,Z){var W=(Z||{}).ranksep,xt=W===void 0?0:W,A=fn(C),d=0;A==null||A.forEach(function(S){var G=S.map(function(it){return C.getNode(it).data.height}),rt=Math.max.apply(Math,St(St([],_t(G)),[0]));S==null||S.forEach(function(it){C.getNode(it).data.y=d+rt/2}),d+=rt+xt})})(nt,ot);var b=function(C,Z){var W=Z||{},xt=W.align,A=W.nodesep,d=A===void 0?0:A,S=W.edgesep,G=S===void 0?0:S,rt=fn(C),it=Object.assign(function(m,j){var H={};return j!=null&&j.length&&j.reduce(function(p,D){var B=0,I=0,q=p.length,Q=D==null?void 0:D[(D==null?void 0:D.length)-1];return D==null||D.forEach(function(tt,z){var $,st=function(ct,vt){var Nt,ut;if(!((Nt=ct.getNode(vt))===null||Nt===void 0)&&Nt.data.dummy)return(ut=ct.getPredecessors(vt))===null||ut===void 0?void 0:ut.find(function(T){return ct.getNode(T.id).data.dummy})}(m,tt),pt=st?m.getNode(st.id).data.order:q;(st||tt===Q)&&(($=D.slice(I,z+1))===null||$===void 0||$.forEach(function(ct){var vt;(vt=m.getPredecessors(ct))===null||vt===void 0||vt.forEach(function(Nt){var ut,T=m.getNode(Nt.id),V=T.data.order;!(V<B||pt<V)||T.data.dummy&&(!((ut=m.getNode(ct))===null||ut===void 0)&&ut.data.dummy)||Fo(H,Nt.id,ct)})}),I=z+1,B=pt)}),D}),H}(C,rt),function(m,j){var H={};function p(B,I,q,Q,tt){for(var z,$,st,pt=I;pt<q;pt++)st=B[pt],!((z=m.getNode(st))===null||z===void 0)&&z.data.dummy&&(($=m.getPredecessors(st))===null||$===void 0||$.forEach(function(ct){var vt=m.getNode(ct.id);vt.data.dummy&&(vt.data.order<Q||vt.data.order>tt)&&Fo(H,ct.id,st)}))}function D(B,I){var q=function(Q){return JSON.stringify(Q.slice(1))}(B);I.get(q)||(p.apply(void 0,St([],_t(B))),I.set(q,!0))}return j!=null&&j.length&&j.reduce(function(B,I){var q,Q=-1,tt=0,z=new Map;return I==null||I.forEach(function($,st){var pt;if(((pt=m.getNode($))===null||pt===void 0?void 0:pt.data.dummy)==="border"){var ct=m.getPredecessors($)||[];ct.length&&(q=m.getNode(ct[0].id).data.order,D([I,tt,st,Q,q],z),tt=st,Q=q)}D([I,tt,I.length,q,B.length],z)}),I}),H}(C,rt)),g={},v=[];["u","d"].forEach(function(m){v=m==="u"?rt:Object.values(rt).reverse(),["l","r"].forEach(function(j){j==="r"&&(v=v.map(function(B){return Object.values(B).reverse()}));var H=(m==="u"?C.getPredecessors:C.getSuccessors).bind(C),p=function(B,I,q,Q){var tt={},z={},$={};return I==null||I.forEach(function(st){st==null||st.forEach(function(pt,ct){tt[pt]=pt,z[pt]=pt,$[pt]=ct})}),I==null||I.forEach(function(st){var pt=-1;st==null||st.forEach(function(ct){var vt=Q(ct).map(function(J){return J.id});if(vt.length){vt=vt.sort(function(J,Et){return $[J]-$[Et]});for(var Nt=(vt.length-1)/2,ut=Math.floor(Nt),T=Math.ceil(Nt);ut<=T;++ut){var V=vt[ut];z[ct]===ct&&pt<$[V]&&!li(q,ct,V)&&(z[V]=ct,z[ct]=tt[ct]=tt[V],pt=$[V])}}})}),{root:tt,align:z}}(0,v,it,H),D=function(B,I,q,Q,tt,z,$){var st,pt={},ct=jo(B,I,q,tt,z,$),vt=$?"borderLeft":"borderRight",Nt=function(ut,T){for(var V=ct.getAllNodes(),J=V.pop(),Et={};J;)Et[J.id]?ut(J.id):(Et[J.id]=!0,V.push(J),V=V.concat(T(J.id))),J=V.pop()};return Nt(function(ut){pt[ut]=(ct.getRelatedEdges(ut,"in")||[]).reduce(function(T,V){return Math.max(T,(pt[V.source]||0)+V.data.weight)},0)},ct.getPredecessors.bind(ct)),Nt(function(ut){var T=(ct.getRelatedEdges(ut,"out")||[]).reduce(function(J,Et){return Math.min(J,(pt[Et.target]||0)-Et.data.weight)},Number.POSITIVE_INFINITY),V=B.getNode(ut);T!==Number.POSITIVE_INFINITY&&V.data.borderType!==vt&&(pt[ut]=Math.max(pt[ut],T))},ct.getSuccessors.bind(ct)),(st=Object.values(Q))===null||st===void 0||st.forEach(function(ut){pt[ut]=pt[q[ut]]}),pt}(C,v,p.root,p.align,d,G,j==="r");j==="r"&&Object.keys(D).forEach(function(B){return D[B]=-D[B]}),g[m+j]=D})});var f=function(m,j){return Oo(Object.values(j),function(H){var p,D=Number.NEGATIVE_INFINITY,B=Number.POSITIVE_INFINITY;return(p=Object.keys(H))===null||p===void 0||p.forEach(function(I){var q=H[I],Q=function(tt,z){return tt.getNode(z).data.width||0}(m,I)/2;D=Math.max(q+Q,D),B=Math.min(q-Q,B)}),D-B})}(C,g);return f&&function(m,j){var H=Object.values(j),p=Math.min.apply(Math,St([],_t(H))),D=Math.max.apply(Math,St([],_t(H)));["u","d"].forEach(function(B){["l","r"].forEach(function(I){var q,Q=B+I,tt=m[Q];if(tt!==j){var z=Object.values(tt);(q=I==="l"?p-Math.min.apply(Math,St([],_t(z))):D-Math.max.apply(Math,St([],_t(z))))&&(m[Q]={},Object.keys(tt).forEach(function($){m[Q][$]=tt[$]+q}))}})})}(g,f),function(m,j){var H={};return Object.keys(m.ul).forEach(function(p){if(j)H[p]=m[j.toLowerCase()][p];else{var D=Object.values(m).map(function(B){return B[p]});H[p]=(D[0]+D[1])/2}}),H}(g,xt)}(nt,ot);(ht=Object.keys(b))===null||ht===void 0||ht.forEach(function(C){nt.getNode(C).data.x=b[C]})}(o,{align:c,nodesep:l,edgesep:R,ranksep:M}),bs(o),ws(o),function(X,ot){ot.forEach(function(ht){var nt,b=X.getNode(ht),C=b.data.originalEdge;C&&X.addEdge(C);for(var Z=ht;b.data.dummy;)nt=X.getSuccessors(Z)[0],X.removeNode(Z),C.data.points.push({x:b.data.x,y:b.data.y}),b.data.dummy===Co&&(C.data.x=b.data.x,C.data.y=b.data.y,C.data.width=b.data.width,C.data.height=b.data.height),Z=nt.id,b=X.getNode(Z)})}(o,P),ja(o),function(X,ot){var ht=ot.toLowerCase();ht!=="bt"&&ht!=="rl"||function(nt){nt.getAllNodes().forEach(function(b){ci(b.data)}),nt.getAllEdges().forEach(function(b){var C;(C=b.data.points)===null||C===void 0||C.forEach(function(Z){return ci(Z)}),b.data.hasOwnProperty("y")&&ci(b.data)})}(X),ht!=="lr"&&ht!=="rl"||(function(nt){nt.getAllNodes().forEach(function(b){Lo(b.data)}),nt.getAllEdges().forEach(function(b){var C;(C=b.data.points)===null||C===void 0||C.forEach(function(Z){return Lo(Z)}),b.data.hasOwnProperty("x")&&Lo(b.data)})}(X),ui(X))}(o,i);var wt=fo(o),gt=wt.width,dt=wt.height;return ms(o),ys(o),function(X){X.getAllEdges().forEach(function(ot){var ht=ot.data;if(ht.reversed){X.removeEdge(ot.id);var nt=ht.forwardName;delete ht.reversed,delete ht.forwardName,X.addEdge({id:ot.id,source:ot.target,target:ot.source,data:y(y({},ht),{forwardName:nt})})}})}(o),{width:gt,height:dt}},lo=["width","height","layer","fixorder"],ho={width:0,height:0},gs=["minlen","weight","width","height","labeloffset"],ps={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Qi=["labelpos"],Ga=function(o){o.getAllEdges().forEach(function(r){if(r.data.width&&r.data.height){var t=o.getNode(r.source),e={e:r,rank:(o.getNode(r.target).data.rank-t.data.rank)/2+t.data.rank};un(o,"edge-proxy",e,"_ep")}})},Fa=function(o){var r=0;return o.getAllNodes().forEach(function(t){var e,n;t.data.borderTop&&(t.data.minRank=(e=o.getNode(t.data.borderTop))===null||e===void 0?void 0:e.data.rank,t.data.maxRank=(n=o.getNode(t.data.borderBottom))===null||n===void 0?void 0:n.data.rank,r=Math.max(r,t.data.maxRank||-1/0))}),r},vs=function(o){o.getAllNodes().forEach(function(r){r.data.dummy==="edge-proxy"&&(o.getEdge(r.data.e.id).data.labelRank=r.data.rank,o.removeNode(r.id))})},fo=function(o,r){var t,e,n=0,i=0,s=r||{},u=s.marginx,c=u===void 0?0:u,h=s.marginy,l=h===void 0?0:h,E=function(R){if(R.data){var _=R.data.x,M=R.data.y,w=R.data.width,L=R.data.height;isNaN(_)||isNaN(w)||(t===void 0&&(t=_-w/2),t=Math.min(t,_-w/2),n=Math.max(n,_+w/2)),isNaN(M)||isNaN(L)||(e===void 0&&(e=M-L/2),e=Math.min(e,M-L/2),i=Math.max(i,M+L/2))}};return o.getAllNodes().forEach(function(R){E(R)}),o.getAllEdges().forEach(function(R){R!=null&&R.data.hasOwnProperty("x")&&E(R)}),t-=c,e-=l,o.getAllNodes().forEach(function(R){R.data.x-=t,R.data.y-=e}),o.getAllEdges().forEach(function(R){var _;(_=R.data.points)===null||_===void 0||_.forEach(function(M){M.x-=t,M.y-=e}),R.data.hasOwnProperty("x")&&(R.data.x-=t),R.data.hasOwnProperty("y")&&(R.data.y-=e)}),{width:n-t+c,height:i-e+l}},ms=function(o){o.getAllEdges().forEach(function(r){var t,e,n=o.getNode(r.source),i=o.getNode(r.target);r.data.points?(t=r.data.points[0],e=r.data.points[r.data.points.length-1]):(r.data.points=[],t={x:i.data.x,y:i.data.y},e={x:n.data.x,y:n.data.y}),r.data.points.unshift(zi(n.data,t)),r.data.points.push(zi(i.data,e))})},ja=function(o){o.getAllEdges().forEach(function(r){if(r.data.hasOwnProperty("x"))switch(r.data.labelpos!=="l"&&r.data.labelpos!=="r"||(r.data.width-=r.data.labeloffset),r.data.labelpos){case"l":r.data.x-=r.data.width/2+r.data.labeloffset;break;case"r":r.data.x+=r.data.width/2+r.data.labeloffset}})},ys=function(o){o.getAllEdges().forEach(function(r){var t;r.data.reversed&&((t=r.data.points)===null||t===void 0||t.reverse())})},ws=function(o){o.getAllNodes().forEach(function(r){var t,e,n;if(!((t=o.getChildren(r.id))===null||t===void 0)&&t.length){var i=o.getNode(r.id),s=o.getNode(i.data.borderTop),u=o.getNode(i.data.borderBottom),c=o.getNode(i.data.borderLeft[((e=i.data.borderLeft)===null||e===void 0?void 0:e.length)-1]),h=o.getNode(i.data.borderRight[((n=i.data.borderRight)===null||n===void 0?void 0:n.length)-1]);i.data.width=Math.abs((h==null?void 0:h.data.x)-(c==null?void 0:c.data.x))||10,i.data.height=Math.abs((u==null?void 0:u.data.y)-(s==null?void 0:s.data.y))||10,i.data.x=((c==null?void 0:c.data.x)||0)+i.data.width/2,i.data.y=((s==null?void 0:s.data.y)||0)+i.data.height/2}}),o.getAllNodes().forEach(function(r){r.data.dummy==="border"&&o.removeNode(r.id)})},Es=function(o){o.getAllEdges().forEach(function(r){if(r.source===r.target){var t=o.getNode(r.source);t.data.selfEdges||(t.data.selfEdges=[]),t.data.selfEdges.push(r),o.removeEdge(r.id)}})},xs=function(o){var r=fn(o);r==null||r.forEach(function(t){var e=0;t==null||t.forEach(function(n,i){var s,u=o.getNode(n);u.data.order=i+e,(s=u.data.selfEdges)===null||s===void 0||s.forEach(function(c){un(o,"selfedge",{width:c.data.width,height:c.data.height,rank:u.data.rank,order:i+ ++e,e:c},"_se")}),delete u.data.selfEdges})})},bs=function(o){o.getAllNodes().forEach(function(r){var t=o.getNode(r.id);if(t.data.dummy==="selfedge"){var e=o.getNode(t.data.e.source),n=e.data.x+e.data.width/2,i=e.data.y,s=t.data.x-n,u=e.data.height/2;o.hasEdge(t.data.e.id)?o.updateEdgeData(t.data.e.id,t.data.e.data):o.addEdge({id:t.data.e.id,source:t.data.e.source,target:t.data.e.target,data:t.data.e.data}),o.removeNode(r.id),t.data.e.data.points=[{x:n+2*s/3,y:i-u},{x:n+5*s/6,y:i-u},{y:i,x:n+s},{x:n+5*s/6,y:i+u},{x:n+2*s/3,y:i+u}],t.data.e.data.x=t.data.x,t.data.e.data.y=t.data.y}})},Ua=function(o,r){var t={};return r==null||r.forEach(function(e){o[e]!==void 0&&(t[e]=+o[e])}),t},Ba=function(o){o===void 0&&(o={});var r={};return Object.keys(o).forEach(function(t){r[t.toLowerCase()]=o[t]}),r},Ns={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},Va=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="dagre",this.layoutNode=function(t){return t.data.layout},this.options=y(y({},Ns),r)}return o.prototype.execute=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return[2,this.genericDagreLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){switch(e.label){case 0:return[4,this.genericDagreLayout(!0,r,t)];case 1:return e.sent(),[2]}})})},o.prototype.genericDagreLayout=function(r,t,e){return Y(this,void 0,void 0,function(){var n,i,s,u,c,h,l,E,R,_,M,w,L,k,P,wt,gt,dt,X,ot,ht,nt,b,C,Z,W,xt,A,d,S,G,rt,it,g=this;return yt(this,function(v){return n=y(y({},this.options),e),i=n.nodeSize,s=n.align,u=n.rankdir,c=u===void 0?"TB":u,h=n.ranksep,l=n.nodesep,E=n.ranksepFunc,R=n.nodesepFunc,_=n.edgeLabelSpace,M=n.nodeOrder,w=n.begin,L=n.controlPoints,k=n.radial,P=new Fr({tree:[]}),wt=nr(h||50,E),gt=nr(l||50,R),dt=gt,X=wt,c!=="LR"&&c!=="RL"||(dt=wt,X=gt),ot=Ir(i,void 0),ht=t.getAllNodes(),nt=t.getAllEdges(),ht.filter(function(f){return f.data.layout}).forEach(function(f){var m=ot(f),j=X(f),H=m+2*dt(f),p=m+2*j,D=f.data.layer;jt(D)?P.addNode({id:f.id,data:{width:H,height:p,layer:D}}):P.addNode({id:f.id,data:{width:H,height:p}})}),nt.forEach(function(f){g.layoutNode(P.getNode(f.source))&&g.layoutNode(P.getNode(f.target))&&P.addEdge({id:f.id,source:f.source,target:f.target,data:{weight:f.data.weight||1}})}),function(f,m){var j,H,p=m.edgeLabelSpace,D=m.keepNodeOrder,B=m.prevGraph,I=m.rankdir,q=m.ranksep;!D&&B&&(H=B,(j=f).getAllNodes().forEach(function(tt){var z=j.getNode(tt.id),$=H.getNode(tt.id);$!==void 0?(z.data.fixorder=$.data._order,delete $.data._order):delete z.data.fixorder}));var Q=function(tt){var z=new Fr({tree:[]});return tt.getAllNodes().forEach(function($){var st=Ba(tt.getNode($.id).data),pt=y(y({},ho),st),ct=Ua(pt,lo);z.hasNode($.id)||z.addNode({id:$.id,data:y({},ct)});var vt=tt.getParent($.id);vt==null||(z.hasNode(vt.id)||z.addNode(y({},vt)),z.setParent($.id,vt.id))}),tt.getAllEdges().forEach(function($){var st=Ba(tt.getEdge($.id).data),pt={};Qi==null||Qi.forEach(function(ct){st[ct]!==void 0&&(pt[ct]=st[ct])}),z.addEdge({id:$.id,source:$.source,target:$.target,data:Object.assign({},ps,Ua(st,gs),pt)})}),z}(f);p&&(m.ranksep=function(tt,z){var $=z.ranksep,st=$===void 0?0:$,pt=z.rankdir;return tt.getAllNodes().forEach(function(ct){isNaN(ct.data.layer)||ct.data.layer||(ct.data.layer=0)}),tt.getAllEdges().forEach(function(ct){var vt;ct.data.minlen*=2,((vt=ct.data.labelpos)===null||vt===void 0?void 0:vt.toLowerCase())!=="c"&&(pt==="TB"||pt==="BT"?ct.data.width+=ct.data.labeloffset:ct.data.height+=ct.data.labeloffset)}),st/2}(Q,{rankdir:I,ranksep:q}));try{Zi(Q,m)}catch(tt){if(tt.message==="Not possible to find intersection inside of the rectangle")return void console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,tt);throw tt}(function(tt,z){tt.getAllNodes().forEach(function($){var st,pt=tt.getNode($.id);if(pt){var ct=z.getNode($.id);pt.data.x=ct.data.x,pt.data.y=ct.data.y,pt.data._order=ct.data.order,pt.data._rank=ct.data.rank,!((st=z.getChildren($.id))===null||st===void 0)&&st.length&&(pt.data.width=ct.data.width,pt.data.height=ct.data.height)}}),tt.getAllEdges().forEach(function($){var st=tt.getEdge($.id),pt=z.getEdge($.id);st.data.points=pt?pt.data.points:[],pt&&pt.data.hasOwnProperty("x")&&(st.data.x=pt.data.x,st.data.y=pt.data.y)})})(f,Q)}(P,{prevGraph:null,edgeLabelSpace:_,keepNodeOrder:!!M,nodeOrder:M||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:c,nodesep:l,align:s}),b=[0,0],w&&(C=1/0,Z=1/0,P.getAllNodes().forEach(function(f){C>f.data.x&&(C=f.data.x),Z>f.data.y&&(Z=f.data.y)}),P.getAllEdges().forEach(function(f){var m;(m=f.data.points)===null||m===void 0||m.forEach(function(j){C>j.x&&(C=j.x),Z>j.y&&(Z=j.y)})}),b[0]=w[0]-C,b[1]=w[1]-Z),W=c==="LR"||c==="RL",k||(xt=new Set,A=c==="BT"||c==="RL"?function(f,m){return m-f}:function(f,m){return f-m},P.getAllNodes().forEach(function(f){f.data.x=f.data.x+b[0],f.data.y=f.data.y+b[1],xt.add(W?f.data.x:f.data.y)}),d=Array.from(xt).sort(A),S=W?function(f,m){return f.x!==m.x}:function(f,m){return f.y!==m.y},G=W?function(f,m,j){var H=Math.max(m.y,j.y),p=Math.min(m.y,j.y);return f.filter(function(D){return D.y<=H&&D.y>=p})}:function(f,m,j){var H=Math.max(m.x,j.x),p=Math.min(m.x,j.x);return f.filter(function(D){return D.x<=H&&D.x>=p})},P.getAllEdges().forEach(function(f,m){var j;_&&L&&f.data.type!=="loop"&&(f.data.controlPoints=_s((j=f.data.points)===null||j===void 0?void 0:j.map(function(H){var p=H.x,D=H.y;return{x:p+b[0],y:D+b[1]}}),P.getNode(f.source),P.getNode(f.target),d,W,S,G))})),rt=[],rt=P.getAllNodes().map(function(f){return qe(f)}),it=P.getAllEdges(),r&&(rt.forEach(function(f){t.mergeNodeData(f.id,{x:f.data.x,y:f.data.y})}),it.forEach(function(f){t.mergeEdgeData(f.id,{controlPoints:f.data.controlPoints})})),[2,{nodes:rt,edges:it}]})})},o}(),_s=function(o,r,t,e,n,i,s){var u=(o==null?void 0:o.slice(1,o.length-1))||[];if(r&&t){var c=r.data,h=c.x,l=c.y,E=t.data,R=E.x,_=E.y;if(n&&(h=r.data.y,l=r.data.x,R=t.data.y,_=t.data.x),_!==l&&h!==R){var M=e.indexOf(l),w=e[M+1];if(w){var L=u[0],k=n?{x:(l+w)/2,y:(L==null?void 0:L.y)||R}:{x:(L==null?void 0:L.x)||R,y:(l+w)/2};L&&!i(L,k)||u.unshift(k)}var P=e.indexOf(_),wt=Math.abs(P-M);if(wt===1)(u=s(u,r.data,t.data)).length||u.push(n?{x:(l+_)/2,y:h}:{x:h,y:(l+_)/2});else if(wt>1){var gt=e[P-1];if(gt){var dt=u[u.length-1],X=n?{x:(_+gt)/2,y:(dt==null?void 0:dt.y)||R}:{x:(dt==null?void 0:dt.x)||h,y:(_+gt)/2};dt&&!i(dt,X)||u.push(X)}}}}return u};function Ji(o){var r=0,t=0,e=0;if(o.length){for(var n=0;n<4;n++)(i=o[n])&&i.weight&&(r+=i.weight,t+=i.x*i.weight,e+=i.y*i.weight);o.x=t/r,o.y=e/r,o.weight=r}else{var i=o;o.x=i.data.x,o.y=i.data.y,o.weight=i.data.weight}}var hi={maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},Uo=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=y(y({},hi),r)}return o.prototype.execute=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return[2,this.genericForceLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return this.genericForceLayout(!0,r,t),[2]})})},o.prototype.stop=function(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1},o.prototype.tick=function(r){var t=this;if(r===void 0&&(r=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var e=0;(this.judgingDistance>this.lastOptions.minMovement||e<1)&&e<r;e++)this.runOneStep(this.lastCalcGraph,this.lastGraph,e,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach(function(i){return t.lastGraph.mergeNodeData(i.id,{x:i.data.x,y:i.data.y})}),n},o.prototype.genericForceLayout=function(r,t,e){return Y(this,void 0,void 0,function(){var n,i,s,u,c,h,l,E,R,_,M,w,L,k,P,wt,gt,dt,X,ot=this;return yt(this,function(ht){return n=y(y({},this.options),e),i=t.getAllNodes(),s=t.getAllEdges(),u=this.formatOptions(n,t),c=u.width,h=u.height,l=u.nodeSize,E=u.getMass,R=u.nodeStrength,_=u.edgeStrength,M=u.linkDistance,w=i.map(function(nt){return y(y({},nt),{data:y(y({},nt.data),{x:jt(nt.data.x)?nt.data.x:Math.random()*c,y:jt(nt.data.y)?nt.data.y:Math.random()*h,size:l(nt)||30,mass:E(nt),nodeStrength:R(nt)})})}),L=s.map(function(nt){return y(y({},nt),{data:y(y({},nt.data),{edgeStrength:_(nt),linkDistance:M(nt,t.getNode(nt.source),t.getNode(nt.target))})})}),i!=null&&i.length?(k={},i.forEach(function(nt,b){k[nt.id]={x:0,y:0}}),P=new Fr({nodes:w,edges:L}),this.formatCentripetal(u,P),wt=u.maxIteration,gt=u.minMovement,dt=u.onTick,this.lastLayoutNodes=w,this.lastLayoutEdges=L,this.lastAssign=r,this.lastGraph=t,this.lastCalcGraph=P,this.lastOptions=u,this.lastVelMap=k,typeof window>"u"?[2]:(X=0,[2,new Promise(function(nt){ot.timeInterval=window.setInterval(function(){i&&ot.running||nt({nodes:go(t,w),edges:s}),ot.runOneStep(P,t,X,k,u),ot.updatePosition(t,P,k,u),r&&w.forEach(function(b){return t.mergeNodeData(b.id,{x:b.data.x,y:b.data.y})}),dt==null||dt({nodes:go(t,w),edges:s}),(++X>=wt||ot.judgingDistance<gt)&&(window.clearInterval(ot.timeInterval),nt({nodes:go(t,w),edges:s}))},0),ot.running=!0})])):(this.lastResult={nodes:[],edges:s},[2,{nodes:[],edges:s}])})})},o.prototype.formatOptions=function(r,t){var e=r,n=r.width,i=r.height,s=r.getMass;if(e.width=n||typeof window>"u"?n:window.innerWidth,e.height=i||typeof window>"u"?i:window.innerHeight,r.center||(e.center=[e.width/2,e.height/2]),s||(e.getMass=function(c){var h=1;jt(c==null?void 0:c.data.mass)&&(h=c==null?void 0:c.data.mass);var l=t.getDegree(c.id,"both");return!l||l<5?h:5*l*h}),r.preventOverlap){var u=nr(0,r.nodeSpacing);r.nodeSize?te(r.nodeSize)?e.nodeSize=function(c){var h=r.nodeSize;return Math.max(h[0],h[1])+u(c)}:e.nodeSize=function(c){return r.nodeSize+u(c)}:e.nodeSize=function(c){var h=((c==null?void 0:c.data)||{}).size;return h?te(h)?Math.max(h[0],h[1])+u(c):Tr(h)?Math.max(h.width,h.height)+u(c):h+u(c):10+u(c)}}return e.linkDistance=r.linkDistance?nr(1,r.linkDistance):function(c){return 1+e.nodeSize(t.getNode(c.source))+e.nodeSize(t.getNode(c.target))},e.nodeStrength=nr(1,r.nodeStrength),e.edgeStrength=nr(1,r.edgeStrength),r},o.prototype.formatCentripetal=function(r,t){var e,n=r.centripetalOptions,i=r.center,s=r.clusterNodeStrength,u=r.leafCluster,c=r.clustering,h=r.nodeClusterBy,l=t.getAllNodes(),E=n||{leaf:2,single:2,others:1,center:function(P){return{x:i[0],y:i[1]}}};typeof s!="function"&&(r.clusterNodeStrength=function(P){return s});var R=[];if(u&&h&&(e=Bo(t,h),R=Array.from(new Set(l==null?void 0:l.map(function(P){return P.data[h]})))||[],r.centripetalOptions=Object.assign(E,{single:100,leaf:function(P){var wt=e[P.id]||{},gt=wt.siblingLeaves,dt=wt.sameTypeLeaves;return(dt==null?void 0:dt.length)===(gt==null?void 0:gt.length)||(R==null?void 0:R.length)===1?1:r.clusterNodeStrength(P)},others:1,center:function(P){var wt,gt=t.getDegree(P.id,"both");if(!gt)return{x:100,y:100};if(gt===1){var dt=(e[P.id]||{}).sameTypeLeaves,X=dt===void 0?[]:dt;X.length===1?wt=void 0:X.length>1&&(wt=Vo(X))}else wt=void 0;return{x:wt==null?void 0:wt.x,y:wt==null?void 0:wt.y}}})),c&&h){e||(e=Bo(t,h)),R||(R=Array.from(new Set(l.map(function(P){return P.data[h]})))),R=R.filter(function(P){return P!==void 0});var _={};R.forEach(function(P){var wt=l.filter(function(gt){return gt.data[h]===P}).map(function(gt){return t.getNode(gt.id)});_[P]=Vo(wt)}),r.centripetalOptions=Object.assign(E,{single:function(P){return r.clusterNodeStrength(P)},leaf:function(P){return r.clusterNodeStrength(P)},others:function(P){return r.clusterNodeStrength(P)},center:function(P){var wt=_[P.data[h]];return{x:wt==null?void 0:wt.x,y:wt==null?void 0:wt.y}}})}var M=r.centripetalOptions||{},w=M.leaf,L=M.single,k=M.others;w&&typeof w!="function"&&(r.centripetalOptions.leaf=function(){return w}),L&&typeof L!="function"&&(r.centripetalOptions.single=function(){return L}),k&&typeof k!="function"&&(r.centripetalOptions.others=function(){return k})},o.prototype.runOneStep=function(r,t,e,n,i){var s={},u=r.getAllNodes(),c=r.getAllEdges();if(u!=null&&u.length){var h=i.monitor;this.calRepulsive(r,s,i),c&&this.calAttractive(r,s),this.calGravity(r,t,s,i),this.updateVelocity(r,s,n,i),h&&h({energy:this.calTotalEnergy(s,u),nodes:t.getAllNodes(),edges:t.getAllEdges(),iterations:e})}},o.prototype.calTotalEnergy=function(r,t){if(!(t!=null&&t.length))return 0;var e=0;return t.forEach(function(n,i){var s=r[n.id].x,u=r[n.id].y,c=s*s+u*u,h=n.data.mass;e+=(h===void 0?1:h)*c*.5}),e},o.prototype.calRepulsive=function(r,t,e){var n=e.factor,i=e.coulombDisScale;(function(s,u,c,h){var l=u/c,E=s.getAllNodes(),R=E.map(function(M,w){var L=M.data,k=L.nodeStrength;return{x:L.x,y:L.y,size:L.size,index:w,vx:0,vy:0,weight:l*k}}),_=Ye(R,function(M){return M.x},function(M){return M.y}).visitAfter(Ji);R.forEach(function(M){(function(w,L){L.visit(function(k,P,wt,gt,dt){return function(X,ot,ht,nt,b,C){var Z=C.x-X.x||.1,W=C.y-X.y||.1,xt=nt-ot,A=Z*Z+W*W,d=Math.sqrt(A)*A;if(xt*xt*.81<A){var S=X.weight/d;return C.vx+=Z*S,C.vy+=W*S,!0}if(X.length)return!1;X.data!==C&&(S=X.data.weight/d,C.vx+=Z*S,C.vy+=W*S)}(k,P,0,gt,0,w)})})(M,_)}),R.map(function(M,w){var L=E[w],k=L.id,P=L.data.mass,wt=P===void 0?1:P;h[k]={x:M.vx/wt,y:M.vy/wt}})})(r,n,i*i,t)},o.prototype.calAttractive=function(r,t){r.getAllEdges().forEach(function(e,n){var i=e.source,s=e.target,u=r.getNode(i),c=r.getNode(s);if(u&&c){var h=c.data.x-u.data.x,l=c.data.y-u.data.y;h||l||(h=.01*Math.random(),l=.01*Math.random());var E=Math.sqrt(h*h+l*l),R=h/E,_=l/E,M=e.data||{},w=M.linkDistance,L=w===void 0?200:w,k=M.edgeStrength,P=(L-E)*(k===void 0?200:k),wt=1/(u.data.mass||1),gt=1/(c.data.mass||1),dt=R*P,X=_*P;t[i].x-=dt*wt,t[i].y-=X*wt,t[s].x+=dt*gt,t[s].y+=X*gt}})},o.prototype.calGravity=function(r,t,e,n){var i=n.getCenter,s=r.getAllNodes(),u=t.getAllNodes(),c=t.getAllEdges(),h=n.width,l=n.height,E=n.center,R=n.gravity,_=n.centripetalOptions;s&&s.forEach(function(M){var w=M.id,L=M.data,k=L.mass,P=L.x,wt=L.y,gt=t.getNode(w),dt=0,X=0,ot=R,ht=r.getDegree(w,"in"),nt=r.getDegree(w,"out"),b=r.getDegree(w,"both"),C=i==null?void 0:i(gt,b);if(C){var Z=_t(C,3);dt=P-Z[0],X=wt-Z[1],ot=Z[2]}else dt=P-E[0],X=wt-E[1];if(ot&&(e[w].x-=ot*dt/k,e[w].y-=ot*X/k),_){var W=_.leaf,xt=_.single,A=_.others,d=_.center,S=(d==null?void 0:d(gt,u,c,h,l))||{x:0,y:0,centerStrength:0},G=S.x,rt=S.y,it=S.centerStrength;if(!jt(G)||!jt(rt))return;var g=(P-G)/k,v=(wt-rt)/k;if(it&&(e[w].x-=it*g,e[w].y-=it*v),b===0){var f=xt(gt);return f?(e[w].x-=f*g,void(e[w].y-=f*v)):void 0}if(ht===0||nt===0){var m=W(gt,u,c);return m?(e[w].x-=m*g,void(e[w].y-=m*v)):void 0}var j=A(gt);if(!j)return;e[w].x-=j*g,e[w].y-=j*v}})},o.prototype.updateVelocity=function(r,t,e,n){var i=n.damping,s=n.maxSpeed,u=n.interval,c=r.getAllNodes();c!=null&&c.length&&c.forEach(function(h){var l=h.id,E=(e[l].x+t[l].x*u)*i||.01,R=(e[l].y+t[l].y*u)*i||.01,_=Math.sqrt(E*E+R*R);if(_>s){var M=s/_;E*=M,R*=M}e[l]={x:E,y:R}})},o.prototype.updatePosition=function(r,t,e,n){var i=this,s=n.distanceThresholdMode,u=n.interval,c=t.getAllNodes();if(c!=null&&c.length){var h=0;s==="max"?this.judgingDistance=-1/0:s==="min"&&(this.judgingDistance=1/0),c.forEach(function(l){var E=l.id,R=r.getNode(E);if(jt(R.data.fx)&&jt(R.data.fy))t.mergeNodeData(E,{x:R.data.fx,y:R.data.fy});else{var _=e[E].x*u,M=e[E].y*u;t.mergeNodeData(E,{x:l.data.x+_,y:l.data.y+M});var w=Math.sqrt(_*_+M*M);switch(s){case"max":i.judgingDistance<w&&(i.judgingDistance=w);break;case"min":i.judgingDistance>w&&(i.judgingDistance=w);break;default:h+=w}}}),s&&s!=="mean"||(this.judgingDistance=h/c.length)}else this.judgingDistance=0},o}(),Bo=function(o,r){var t=o.getAllNodes();if(!(t!=null&&t.length))return{};var e={};return t.forEach(function(n,i){o.getDegree(n.id,"both")===1&&(e[n.id]=ta(o,"leaf",n,r))}),e},ta=function(o,r,t,e){var n=o.getDegree(t.id,"in"),i=o.getDegree(t.id,"out"),s=t,u=[];return n===0?(s=o.getSuccessors(t.id)[0],u=o.getNeighbors(s.id)):i===0&&(s=o.getPredecessors(t.id)[0],u=o.getNeighbors(s.id)),u=u.filter(function(c){return o.getDegree(c.id,"in")===0||o.getDegree(c.id,"out")===0}),{coreNode:s,siblingLeaves:u,sameTypeLeaves:fi(o,r,e,t,u)}},fi=function(o,r,t,e,n){var i=e.data[t]||"",s=(n==null?void 0:n.filter(function(u){return u.data[t]===i}))||[];return r==="leaf"&&(s=s.filter(function(u){return o.getDegree(u.id,"in")===0||o.getDegree(u.id,"out")===0})),s},Vo=function(o){var r={x:0,y:0};o.forEach(function(e){var n=e.data,i=n.x,s=n.y;r.x+=i||0,r.y+=s||0});var t=o.length||1;return{x:r.x/t,y:r.y/t}},go=function(o,r){return r.map(function(t){var e=t.id,n=t.data,i=o.getNode(e);return y(y({},i),{data:y(y({},i.data),{x:n.x,y:n.y})})})},ea=function(){function o(r){this.id=r.id||0,this.rx=r.rx,this.ry=r.ry,this.fx=0,this.fy=0,this.mass=r.mass,this.degree=r.degree,this.g=r.g||0}return o.prototype.distanceTo=function(r){var t=this.rx-r.rx,e=this.ry-r.ry;return Math.hypot(t,e)},o.prototype.setPos=function(r,t){this.rx=r,this.ry=t},o.prototype.resetForce=function(){this.fx=0,this.fy=0},o.prototype.addForce=function(r){var t=r.rx-this.rx,e=r.ry-this.ry,n=Math.hypot(t,e);n=n<1e-4?1e-4:n;var i=this.g*(this.degree+1)*(r.degree+1)/n;this.fx+=i*t/n,this.fy+=i*e/n},o.prototype.in=function(r){return r.contains(this.rx,this.ry)},o.prototype.add=function(r){var t=this.mass+r.mass;return new o({rx:(this.rx*this.mass+r.rx*r.mass)/t,ry:(this.ry*this.mass+r.ry*r.mass)/t,mass:t,degree:this.degree+r.degree})},o}();const gi=ea,pi=function(){function o(r){this.xmid=r.xmid,this.ymid=r.ymid,this.length=r.length,this.massCenter=r.massCenter||[0,0],this.mass=r.mass||1}return o.prototype.getLength=function(){return this.length},o.prototype.contains=function(r,t){var e=this.length/2;return r<=this.xmid+e&&r>=this.xmid-e&&t<=this.ymid+e&&t>=this.ymid-e},o.prototype.NW=function(){return new o({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},o.prototype.NE=function(){return new o({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},o.prototype.SW=function(){return new o({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},o.prototype.SE=function(){return new o({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},o}(),vi=function(){function o(r){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,r!=null&&(this.quad=r)}return o.prototype.insert=function(r){this.body!=null?this._isExternal()?(this.quad&&(this.NW=new o(this.quad.NW()),this.NE=new o(this.quad.NE()),this.SW=new o(this.quad.SW()),this.SE=new o(this.quad.SE())),this._putBody(this.body),this._putBody(r),this.body=this.body.add(r)):(this.body=this.body.add(r),this._putBody(r)):this.body=r},o.prototype._putBody=function(r){this.quad&&(r.in(this.quad.NW())&&this.NW?this.NW.insert(r):r.in(this.quad.NE())&&this.NE?this.NE.insert(r):r.in(this.quad.SW())&&this.SW?this.SW.insert(r):r.in(this.quad.SE())&&this.SE&&this.SE.insert(r))},o.prototype._isExternal=function(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null},o.prototype.updateForce=function(r){this.body!=null&&r!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(r)<this.theta?r.addForce(this.body):(this.NW&&this.NW.updateForce(r),this.NE&&this.NE.updateForce(r),this.SW&&this.SW.updateForce(r),this.SE&&this.SE.updateForce(r)))},o}();var Wo={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},po=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="forceAtlas2",this.options=y(y({},Wo),r)}return o.prototype.execute=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return[2,this.genericForceAtlas2Layout(!1,r,t)]})})},o.prototype.assign=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return this.genericForceAtlas2Layout(!0,r,t),[2]})})},o.prototype.genericForceAtlas2Layout=function(r,t,e){return Y(this,void 0,void 0,function(){var n,i,s,u,c,h,l,E,R,_,M,w,L,k,P,wt,gt,dt,X,ot,ht,nt;return yt(this,function(b){if(n=t.getAllEdges(),i=t.getAllNodes(),s=this.formatOptions(e,i.length),u=s.width,c=s.height,h=s.prune,l=s.maxIteration,E=s.nodeSize,R=s.center,!(i!=null&&i.length)||i.length===1)return[2,Wr(t,r,R)];if(_=i.map(function(C){return qe(C,[u,c])}),M=n.filter(function(C){return C.source!==C.target}),w=new Fr({nodes:_,edges:M}),L=this.getSizes(w,t,E),this.run(w,t,l,L,r,s),h){for(k=0;k<M.length;k+=1)P=M[k],wt=P.source,gt=P.target,dt=w.getDegree(wt),X=w.getDegree(wt),dt<=1?(ot=w.getNode(gt),w.mergeNodeData(wt,{x:ot.data.x,y:ot.data.y})):X<=1&&(ht=w.getNode(wt),w.mergeNodeData(gt,{x:ht.data.x,y:ht.data.y}));nt=y(y({},s),{prune:!1,barnesHut:!1}),this.run(w,t,100,L,r,nt)}return[2,{nodes:_,edges:n}]})})},o.prototype.getSizes=function(r,t,e){for(var n=r.getAllNodes(),i={},s=0;s<n.length;s+=1){var u=n[s],c=u.id,h=u.data;if(i[c]=10,jt(h.size))i[c]=h.size;else if(te(h.size))isNaN(h.size[0])||(i[c]=Math.max(h.size[0])),isNaN(h.size[1])||(i[c]=Math.max(h.size[1]));else if(Tr(h.size))i[c]=Math.max(h.size.width,h.size.height);else if(Qe(e)){var l=e(t.getNode(c));te(l)?i[c]=Math.max.apply(Math,St([],_t(l))):i[c]=l}else te(e)?i[c]=Math.max.apply(Math,St([],_t(e))):jt(e)&&(i[c]=e)}return i},o.prototype.formatOptions=function(r,t){r===void 0&&(r={});var e=y(y({},this.options),r),n=e.center,i=e.width,s=e.height,u=e.barnesHut,c=e.prune,h=e.maxIteration,l=e.kr,E=e.kg;return e.width=i||typeof window>"u"?i:window.innerWidth,e.height=s||typeof window>"u"?s:window.innerHeight,e.center=n||[e.width/2,e.height/2],u===void 0&&t>250&&(e.barnesHut=!0),c===void 0&&t>100&&(e.prune=!0),h!==0||c?h===0&&c&&(e.maxIteration=100,t<=200&&t>100?e.maxIteration=500:t>200&&(e.maxIteration=950)):(e.maxIteration=250,t<=200&&t>100?e.maxIteration=1e3:t>200&&(e.maxIteration=1200)),l||(e.kr=50,t>100&&t<=500?e.kr=20:t>500&&(e.kr=1)),E||(e.kg=20,t>100&&t<=500?e.kg=10:t>500&&(e.kg=1)),e},o.prototype.run=function(r,t,e,n,i,s){for(var u=s.kr,c=s.barnesHut,h=s.onTick,l=r.getAllNodes(),E=0,R=e,_={},M={},w={},L=0;L<l.length;L+=1){var k=l[L],P=k.data,wt=k.id;if(_[wt]=[0,0],c){var gt={id:L,rx:P.x,ry:P.y,mass:1,g:u,degree:r.getDegree(wt)};w[wt]=new gi(gt)}}for(;R>0;)E=this.oneStep(r,{iter:R,preventOverlapIters:50,krPrime:100,sg:E,forces:_,preForces:M,bodies:w,sizes:n},s),R--,h==null||h({nodes:l,edges:t.getAllEdges()});return r},o.prototype.oneStep=function(r,t,e){for(var n=t.iter,i=t.preventOverlapIters,s=t.krPrime,u=t.sg,c=t.preForces,h=t.bodies,l=t.sizes,E=t.forces,R=e.preventOverlap,_=e.barnesHut,M=r.getAllNodes(),w=0;w<M.length;w+=1){var L=M[w].id;c[L]=St([],_t(E[L])),E[L]=[0,0]}return E=this.getAttrForces(r,n,i,l,E,e),E=_&&(R&&n>i||!R)?this.getOptRepGraForces(r,E,h,e):this.getRepGraForces(r,n,i,E,s,l,e),this.updatePos(r,E,c,u,e)},o.prototype.getAttrForces=function(r,t,e,n,i,s){for(var u=s.preventOverlap,c=s.dissuadeHubs,h=s.mode,l=s.prune,E=r.getAllEdges(),R=0;R<E.length;R+=1){var _=E[R],M=_.source,w=_.target,L=r.getNode(M),k=r.getNode(w),P=r.getDegree(M),wt=r.getDegree(w);if(!l||!(P<=1||wt<=1)){var gt=[k.data.x-L.data.x,k.data.y-L.data.y],dt=Math.hypot(gt[0],gt[1]);dt=dt<1e-4?1e-4:dt,gt[0]=gt[0]/dt,gt[1]=gt[1]/dt,u&&t<e&&(dt=dt-n[M]-n[w]);var X=dt,ot=X;h==="linlog"&&(ot=X=Math.log(1+dt)),c&&(X=dt/P,ot=dt/wt),u&&t<e&&dt<=0?(X=0,ot=0):u&&t<e&&dt>0&&(X=dt,ot=dt),i[M][0]+=X*gt[0],i[w][0]-=ot*gt[0],i[M][1]+=X*gt[1],i[w][1]-=ot*gt[1]}}return i},o.prototype.getOptRepGraForces=function(r,t,e,n){for(var i=n.kg,s=n.center,u=n.prune,c=r.getAllNodes(),h=c.length,l=9e10,E=-9e10,R=9e10,_=-9e10,M=0;M<h;M+=1){var w=c[M],L=w.id,k=w.data;u&&r.getDegree(L)<=1||(e[L].setPos(k.x,k.y),k.x>=E&&(E=k.x),k.x<=l&&(l=k.x),k.y>=_&&(_=k.y),k.y<=R&&(R=k.y))}var P=Math.max(E-l,_-R),wt=new pi({xmid:(E+l)/2,ymid:(_+R)/2,length:P,massCenter:s,mass:h}),gt=new vi(wt);for(M=0;M<h;M+=1)L=c[M].id,u&&r.getDegree(L)<=1||e[L].in(wt)&&gt.insert(e[L]);for(M=0;M<h;M+=1){var dt=c[M],X=(L=dt.id,k=dt.data,r.getDegree(L));if(!(u&&X<=1)){e[L].resetForce(),gt.updateForce(e[L]),t[L][0]-=e[L].fx,t[L][1]-=e[L].fy;var ot=[k.x-s[0],k.y-s[1]],ht=Math.hypot(ot[0],ot[1]);ht=ht<1e-4?1e-4:ht,ot[0]=ot[0]/ht,ot[1]=ot[1]/ht;var nt=i*(X+1);t[L][0]-=nt*ot[0],t[L][1]-=nt*ot[1]}}return t},o.prototype.getRepGraForces=function(r,t,e,n,i,s,u){for(var c=u.preventOverlap,h=u.kr,l=u.kg,E=u.center,R=u.prune,_=r.getAllNodes(),M=_.length,w=0;w<M;w+=1){for(var L=_[w],k=r.getDegree(L.id),P=w+1;P<M;P+=1){var wt=_[P],gt=r.getDegree(wt.id);if(!R||!(k<=1||gt<=1)){var dt=[wt.data.x-L.data.x,wt.data.y-L.data.y],X=Math.hypot(dt[0],dt[1]);X=X<1e-4?1e-4:X,dt[0]=dt[0]/X,dt[1]=dt[1]/X,c&&t<e&&(X=X-s[L.id]-s[wt.id]);var ot=h*(k+1)*(gt+1)/X;c&&t<e&&X<0?ot=i*(k+1)*(gt+1):c&&t<e&&X===0?ot=0:c&&t<e&&X>0&&(ot=h*(k+1)*(gt+1)/X),n[L.id][0]-=ot*dt[0],n[wt.id][0]+=ot*dt[0],n[L.id][1]-=ot*dt[1],n[wt.id][1]+=ot*dt[1]}}var ht=[L.data.x-E[0],L.data.y-E[1]],nt=Math.hypot(ht[0],ht[1]);ht[0]=ht[0]/nt,ht[1]=ht[1]/nt;var b=l*(k+1);n[L.id][0]-=b*ht[0],n[L.id][1]-=b*ht[1]}return n},o.prototype.updatePos=function(r,t,e,n,i){for(var s=i.ks,u=i.tao,c=i.prune,h=i.ksmax,l=r.getAllNodes(),E=l.length,R=[],_=[],M=0,w=0,L=n,k=0;k<E;k+=1){var P=l[k].id,wt=r.getDegree(P);if(!(c&&wt<=1)){var gt=[t[P][0]-e[P][0],t[P][1]-e[P][1]],dt=Math.hypot(gt[0],gt[1]),X=[t[P][0]+e[P][0],t[P][1]+e[P][1]],ot=Math.hypot(X[0],X[1]);R[k]=dt,_[k]=ot/2,M+=(wt+1)*R[k],w+=(wt+1)*_[k]}}var ht=L;for(L=u*w/M,ht!==0&&(L=L>1.5*ht?1.5*ht:L),k=0;k<E;k+=1){var nt=l[k],b=(P=nt.id,nt.data);if(wt=r.getDegree(P),!(c&&wt<=1||jt(b.fx)&&jt(b.fy))){var C=s*L/(1+L*Math.sqrt(R[k])),Z=Math.hypot(t[P][0],t[P][1]),W=h/(Z=Z<1e-4?1e-4:Z),xt=(C=C>W?W:C)*t[P][0],A=C*t[P][1];r.mergeNodeData(P,{x:b.x+xt,y:b.y+A})}}return L},o}(),qo={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},vo=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=y(y({},qo),r)}return o.prototype.execute=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return[2,this.genericFruchtermanLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return this.genericFruchtermanLayout(!0,r,t),[2]})})},o.prototype.stop=function(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1},o.prototype.tick=function(r){var t=this;if(r===void 0&&(r=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var e=0;e<r;e++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach(function(i){return t.lastGraph.mergeNodeData(i.id,{x:i.data.x,y:i.data.y})}),n},o.prototype.genericFruchtermanLayout=function(r,t,e){return Y(this,void 0,void 0,function(){var n,i,s,u,c,h,l,E,R,_,M,w,L,k,P,wt=this;return yt(this,function(gt){return this.running?[2]:(n=this.formatOptions(e),i=n.width,s=n.height,u=n.center,c=n.clustering,h=n.nodeClusterBy,l=n.maxIteration,E=n.onTick,R=t.getAllNodes(),_=t.getAllEdges(),R!=null&&R.length?R.length===1?(r&&t.mergeNodeData(R[0].id,{x:u[0],y:u[1]}),M={nodes:[y(y({},R[0]),{data:y(y({},R[0].data),{x:u[0],y:u[1]})})],edges:_},this.lastResult=M,[2,M]):(w=R.map(function(dt){return qe(dt,[i,s])}),L=new Fr({nodes:w,edges:_}),k={},c&&w.forEach(function(dt){var X=dt.data[h];k[X]||(k[X]={name:X,cx:0,cy:0,count:0})}),this.lastLayoutNodes=w,this.lastLayoutEdges=_,this.lastAssign=r,this.lastGraph=L,this.lastOptions=n,this.lastClusterMap=k,typeof window>"u"?[2]:(P=0,[2,new Promise(function(dt){wt.timeInterval=window.setInterval(function(){wt.running?(wt.runOneStep(L,k,n),r&&w.forEach(function(X){var ot=X.id,ht=X.data;return t.mergeNodeData(ot,{x:ht.x,y:ht.y})}),E==null||E({nodes:w,edges:_}),++P>=l&&(window.clearInterval(wt.timeInterval),dt({nodes:w,edges:_}))):dt({nodes:w,edges:_})},0),wt.running=!0})])):(M={nodes:[],edges:_},this.lastResult=M,[2,M]))})})},o.prototype.formatOptions=function(r){r===void 0&&(r={});var t=y(y({},this.options),r),e=t.clustering,n=t.nodeClusterBy,i=t.center,s=t.width,u=t.height;return t.width=s||typeof window>"u"?s:window.innerWidth,t.height=u||typeof window>"u"?u:window.innerHeight,t.center=i||[t.width/2,t.height/2],t.clustering=e&&!!n,t},o.prototype.runOneStep=function(r,t,e){var n=e.height,i=e.width,s=e.gravity,u=e.center,c=e.speed,h=e.clustering,l=e.nodeClusterBy,E=e.clusterGravity,R=n*i,_=Math.sqrt(R)/10,M=r.getAllNodes(),w=R/(M.length+1),L=Math.sqrt(w),k={};if(this.applyCalculate(r,k,L,w),h){for(var P in t)t[P].cx=0,t[P].cy=0,t[P].count=0;for(var P in M.forEach(function(dt){var X=dt.data,ot=t[X[l]];jt(X.x)&&(ot.cx+=X.x),jt(X.y)&&(ot.cy+=X.y),ot.count++}),t)t[P].cx/=t[P].count,t[P].cy/=t[P].count;var wt=E||s;M.forEach(function(gt,dt){var X=gt.id,ot=gt.data;if(jt(ot.x)&&jt(ot.y)){var ht=t[ot[l]],nt=Math.sqrt((ot.x-ht.cx)*(ot.x-ht.cx)+(ot.y-ht.cy)*(ot.y-ht.cy)),b=L*wt;k[X].x-=b*(ot.x-ht.cx)/nt,k[X].y-=b*(ot.y-ht.cy)/nt}})}M.forEach(function(gt,dt){var X=gt.id,ot=gt.data;if(jt(ot.x)&&jt(ot.y)){var ht=.01*L*s;k[X].x-=ht*(ot.x-u[0]),k[X].y-=ht*(ot.y-u[1])}}),M.forEach(function(gt,dt){var X=gt.id,ot=gt.data;if(jt(ot.fx)&&jt(ot.fy))return ot.x=ot.fx,void(ot.y=ot.fy);if(jt(ot.x)&&jt(ot.y)){var ht=Math.sqrt(k[X].x*k[X].x+k[X].y*k[X].y);if(ht>0){var nt=Math.min(_*(c/800),ht);r.mergeNodeData(X,{x:ot.x+k[X].x/ht*nt,y:ot.y+k[X].y/ht*nt})}}})},o.prototype.applyCalculate=function(r,t,e,n){this.calRepulsive(r,t,n),this.calAttractive(r,t,e)},o.prototype.calRepulsive=function(r,t,e){var n=r.getAllNodes();n.forEach(function(i,s){var u=i.data,c=i.id;t[c]={x:0,y:0},n.forEach(function(h,l){var E=h.data,R=h.id;if(!(s<=l)&&jt(u.x)&&jt(E.x)&&jt(u.y)&&jt(E.y)){var _=u.x-E.x,M=u.y-E.y,w=_*_+M*M;w===0&&(w=1,_=.01,M=.01);var L=e/w,k=_*L,P=M*L;t[c].x+=k,t[c].y+=P,t[R].x-=k,t[R].y-=P}})})},o.prototype.calAttractive=function(r,t,e){r.getAllEdges().forEach(function(n){var i=n.source,s=n.target;if(i&&s&&i!==s){var u=r.getNode(i).data,c=r.getNode(s).data;if(jt(c.x)&&jt(u.x)&&jt(c.y)&&jt(u.y)){var h=c.x-u.x,l=c.y-u.y,E=Math.sqrt(h*h+l*l)/e,R=h*E,_=l*E;t[i].x+=R,t[i].y+=_,t[s].x-=R,t[s].y-=_}}})},o}(),Ho={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},ra=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="grid",this.options=y(y({},Ho),r)}return o.prototype.execute=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return[2,this.genericGridLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return this.genericGridLayout(!0,r,t),[2]})})},o.prototype.genericGridLayout=function(r,t,e){return Y(this,void 0,void 0,function(){var n,i,s,u,c,h,l,E,R,_,M,w,L,k,P,wt,gt,dt,X,ot,ht,nt,b,C,Z,W,xt,A,d,S,G,rt,it,g,v,f,m;return yt(this,function(j){if(n=y(y({},this.options),e),i=n.begin,s=i===void 0?[0,0]:i,u=n.condense,c=n.preventOverlapPadding,h=n.preventOverlap,l=n.rows,E=n.cols,R=n.nodeSpacing,_=n.nodeSize,M=n.width,w=n.height,L=n.position,k=n.sortBy,P=t.getAllNodes(),wt=t.getAllEdges(),!(gt=P==null?void 0:P.length)||gt===1)return[2,Wr(t,r,s)];if(dt=P.map(function(H){return qe(H)}),k==="id"||kr(k)&&dt[0].data[k]!==void 0||(k="degree"),k==="degree"?dt.sort(function(H,p){return t.getDegree(p.id,"both")-t.getDegree(H.id,"both")}):k==="id"?dt.sort(function(H,p){return jt(p.id)&&jt(H.id)?p.id-H.id:(""+H.id).localeCompare(""+p.id)}):dt.sort(function(H,p){return p.data[k]-H.data[k]}),X=M||typeof window>"u"?M:window.innerWidth,ot=w||typeof window>"u"?w:window.innerHeight,ht=gt,nt={rows:l,cols:E},l!=null&&E!=null?(nt.rows=l,nt.cols=E):l!=null&&E==null?(nt.rows=l,nt.cols=Math.ceil(ht/nt.rows)):l==null&&E!=null?(nt.cols=E,nt.rows=Math.ceil(ht/nt.cols)):(b=Math.sqrt(ht*ot/X),nt.rows=Math.round(b),nt.cols=Math.round(X/ot*b)),nt.rows=Math.max(nt.rows,1),nt.cols=Math.max(nt.cols,1),nt.cols*nt.rows>ht)C=Rn(nt),Z=pn(nt),(C-1)*Z>=ht?Rn(nt,C-1):(Z-1)*C>=ht&&pn(nt,Z-1);else for(;nt.cols*nt.rows<ht;)C=Rn(nt),((Z=pn(nt))+1)*C>=ht?pn(nt,Z+1):Rn(nt,C+1);for(W=u?0:X/nt.cols,xt=u?0:ot/nt.rows,(h||R)&&(A=nr(10,R),d=Yr(30,_,!1),dt.forEach(function(H){H.data.x&&H.data.y||(H.data.x=0,H.data.y=0);var p,D,B=t.getNode(H.id),I=d(B)||30;te(I)?(p=I[0],D=I[1]):(p=I,D=I);var q=A!==void 0?A(H):c,Q=p+q,tt=D+q;W=Math.max(W,Q),xt=Math.max(xt,tt)})),S={},G={row:0,col:0},rt={},it=0;it<dt.length;it++){if(g=dt[it],v=void 0,L&&(v=L(t.getNode(g.id))),v&&(v.row!==void 0||v.col!==void 0)){if((f={row:v.row,col:v.col}).col===void 0)for(f.col=0;mi(S,f);)f.col++;else if(f.row===void 0)for(f.row=0;mi(S,f);)f.row++;rt[g.id]=f,yi(S,f)}As(g,s,W,xt,rt,nt,G,S)}return m={nodes:dt,edges:wt},r&&dt.forEach(function(H){t.mergeNodeData(H.id,{x:H.data.x,y:H.data.y})}),[2,m]})})},o}(),Rn=function(o,r){var t,e=o.rows||5,n=o.cols||5;return r==null?t=Math.min(e,n):Math.min(e,n)===o.rows?o.rows=r:o.cols=r,t},pn=function(o,r){var t,e=o.rows||5,n=o.cols||5;return r==null?t=Math.max(e,n):Math.max(e,n)===o.rows?o.rows=r:o.cols=r,t},mi=function(o,r){return o["c-"+r.row+"-"+r.col]||!1},yi=function(o,r){return o["c-"+r.row+"-"+r.col]=!0},Wa=function(o,r){var t=o.cols||5;r.col++,r.col>=t&&(r.col=0,r.row++)},As=function(o,r,t,e,n,i,s,u){var c,h,l=n[o.id];if(l)c=l.col*t+t/2+r[0],h=l.row*e+e/2+r[1];else{for(;mi(u,s);)Wa(i,s);c=s.col*t+t/2+r[0],h=s.row*e+e/2+r[1],yi(u,s),Wa(i,s)}o.data.x=c,o.data.y=h};const Ss=Object.prototype.toString;function cr(o){return Ss.call(o).endsWith("Array]")}function na(o){var r,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!cr(o))throw new TypeError("input must be an array");if(o.length===0)throw new TypeError("input must not be empty");if(t.output!==void 0){if(!cr(t.output))throw new TypeError("output option must be an array if specified");r=t.output}else r=new Array(o.length);var e=function(E){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!cr(E))throw new TypeError("input must be an array");if(E.length===0)throw new TypeError("input must not be empty");var _=R.fromIndex,M=_===void 0?0:_,w=R.toIndex,L=w===void 0?E.length:w;if(M<0||M>=E.length||!Number.isInteger(M))throw new Error("fromIndex must be a positive integer smaller than length");if(L<=M||L>E.length||!Number.isInteger(L))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var k=E[M],P=M+1;P<L;P++)E[P]<k&&(k=E[P]);return k}(o),n=function(E){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!cr(E))throw new TypeError("input must be an array");if(E.length===0)throw new TypeError("input must not be empty");var _=R.fromIndex,M=_===void 0?0:_,w=R.toIndex,L=w===void 0?E.length:w;if(M<0||M>=E.length||!Number.isInteger(M))throw new Error("fromIndex must be a positive integer smaller than length");if(L<=M||L>E.length||!Number.isInteger(L))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var k=E[M],P=M+1;P<L;P++)E[P]>k&&(k=E[P]);return k}(o);if(e===n)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=t.min,s=i===void 0?t.autoMinMax?e:0:i,u=t.max,c=u===void 0?t.autoMinMax?n:1:u;if(s>=c)throw new RangeError("min option must be smaller than max option");for(var h=(c-s)/(n-e),l=0;l<o.length;l++)r[l]=(o[l]-e)*h+s;return r}const Xo=" ".repeat(2),oa=" ".repeat(4);function qa(o,r={}){const{maxRows:t=15,maxColumns:e=10,maxNumSize:n=8,padMinus:i="auto"}=r;return`${o.constructor.name} {
${Xo}[
${oa}${function(s,u,c,h,l){const{rows:E,columns:R}=s,_=Math.min(E,u),M=Math.min(R,c),w=[];if(l==="auto"){l=!1;t:for(let L=0;L<_;L++)for(let k=0;k<M;k++)if(s.get(L,k)<0){l=!0;break t}}for(let L=0;L<_;L++){let k=[];for(let P=0;P<M;P++)k.push(Ha(s.get(L,P),h,l));w.push(`${k.join(" ")}`)}return M!==R&&(w[w.length-1]+=` ... ${R-c} more columns`),_!==E&&w.push(`... ${E-u} more rows`),w.join(`
${oa}`)}(o,t,e,n,i)}
${Xo}]
${Xo}rows: ${o.rows}
${Xo}columns: ${o.columns}
}`}function Ha(o,r,t){return(o>=0&&t?` ${Xa(o,r-1)}`:Xa(o,r)).padEnd(r)}function Xa(o,r){let t=o.toString();if(t.length<=r)return t;let e=o.toFixed(r);if(e.length>r&&(e=o.toFixed(Math.max(0,r-(e.length-r)))),e.length<=r&&!e.startsWith("0.000")&&!e.startsWith("-0.000"))return e;let n=o.toExponential(r);return n.length>r&&(n=o.toExponential(Math.max(0,r-(n.length-r)))),n.slice(0)}function dr(o,r,t){let e=t?o.rows:o.rows-1;if(r<0||r>e)throw new RangeError("Row index out of range")}function Qr(o,r,t){let e=t?o.columns:o.columns-1;if(r<0||r>e)throw new RangeError("Column index out of range")}function cn(o,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==o.columns)throw new RangeError("vector size must be the same as the number of columns");return r}function qr(o,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==o.rows)throw new RangeError("vector size must be the same as the number of rows");return r}function ia(o,r,t,e,n){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if($n("startRow",r),$n("endRow",t),$n("startColumn",e),$n("endColumn",n),r>t||e>n||r<0||r>=o.rows||t<0||t>=o.rows||e<0||e>=o.columns||n<0||n>=o.columns)throw new RangeError("Submatrix indices are out of range")}function mo(o,r=0){let t=[];for(let e=0;e<o;e++)t.push(r);return t}function $n(o,r){if(typeof r!="number")throw new TypeError(`${o} must be a number`)}function Yn(o){if(o.isEmpty())throw new Error("Empty matrix has no elements to index")}class ge{static from1DArray(r,t,e){if(r*t!==e.length)throw new RangeError("data length does not match given dimensions");let n=new Kt(r,t);for(let i=0;i<r;i++)for(let s=0;s<t;s++)n.set(i,s,e[i*t+s]);return n}static rowVector(r){let t=new Kt(1,r.length);for(let e=0;e<r.length;e++)t.set(0,e,r[e]);return t}static columnVector(r){let t=new Kt(r.length,1);for(let e=0;e<r.length;e++)t.set(e,0,r[e]);return t}static zeros(r,t){return new Kt(r,t)}static ones(r,t){return new Kt(r,t).fill(1)}static rand(r,t,e={}){if(typeof e!="object")throw new TypeError("options must be an object");const{random:n=Math.random}=e;let i=new Kt(r,t);for(let s=0;s<r;s++)for(let u=0;u<t;u++)i.set(s,u,n());return i}static randInt(r,t,e={}){if(typeof e!="object")throw new TypeError("options must be an object");const{min:n=0,max:i=1e3,random:s=Math.random}=e;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(i))throw new TypeError("max must be an integer");if(n>=i)throw new RangeError("min must be smaller than max");let u=i-n,c=new Kt(r,t);for(let h=0;h<r;h++)for(let l=0;l<t;l++){let E=n+Math.round(s()*u);c.set(h,l,E)}return c}static eye(r,t,e){t===void 0&&(t=r),e===void 0&&(e=1);let n=Math.min(r,t),i=this.zeros(r,t);for(let s=0;s<n;s++)i.set(s,s,e);return i}static diag(r,t,e){let n=r.length;t===void 0&&(t=n),e===void 0&&(e=t);let i=Math.min(n,t,e),s=this.zeros(t,e);for(let u=0;u<i;u++)s.set(u,u,r[u]);return s}static min(r,t){r=this.checkMatrix(r),t=this.checkMatrix(t);let e=r.rows,n=r.columns,i=new Kt(e,n);for(let s=0;s<e;s++)for(let u=0;u<n;u++)i.set(s,u,Math.min(r.get(s,u),t.get(s,u)));return i}static max(r,t){r=this.checkMatrix(r),t=this.checkMatrix(t);let e=r.rows,n=r.columns,i=new this(e,n);for(let s=0;s<e;s++)for(let u=0;u<n;u++)i.set(s,u,Math.max(r.get(s,u),t.get(s,u)));return i}static checkMatrix(r){return ge.isMatrix(r)?r:new Kt(r)}static isMatrix(r){return r!=null&&r.klass==="Matrix"}get size(){return this.rows*this.columns}apply(r){if(typeof r!="function")throw new TypeError("callback must be a function");for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)r.call(this,t,e);return this}to1DArray(){let r=[];for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)r.push(this.get(t,e));return r}to2DArray(){let r=[];for(let t=0;t<this.rows;t++){r.push([]);for(let e=0;e<this.columns;e++)r[t].push(this.get(t,e))}return r}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let r=0;r<this.rows;r++)for(let t=0;t<=r;t++)if(this.get(r,t)!==this.get(t,r))return!1;return!0}return!1}isEchelonForm(){let r=0,t=0,e=-1,n=!0,i=!1;for(;r<this.rows&&n;){for(t=0,i=!1;t<this.columns&&i===!1;)this.get(r,t)===0?t++:this.get(r,t)===1&&t>e?(i=!0,e=t):(n=!1,i=!0);r++}return n}isReducedEchelonForm(){let r=0,t=0,e=-1,n=!0,i=!1;for(;r<this.rows&&n;){for(t=0,i=!1;t<this.columns&&i===!1;)this.get(r,t)===0?t++:this.get(r,t)===1&&t>e?(i=!0,e=t):(n=!1,i=!0);for(let s=t+1;s<this.rows;s++)this.get(r,s)!==0&&(n=!1);r++}return n}echelonForm(){let r=this.clone(),t=0,e=0;for(;t<r.rows&&e<r.columns;){let n=t;for(let i=t;i<r.rows;i++)r.get(i,e)>r.get(n,e)&&(n=i);if(r.get(n,e)===0)e++;else{r.swapRows(t,n);let i=r.get(t,e);for(let s=e;s<r.columns;s++)r.set(t,s,r.get(t,s)/i);for(let s=t+1;s<r.rows;s++){let u=r.get(s,e)/r.get(t,e);r.set(s,e,0);for(let c=e+1;c<r.columns;c++)r.set(s,c,r.get(s,c)-r.get(t,c)*u)}t++,e++}}return r}reducedEchelonForm(){let r=this.echelonForm(),t=r.columns,e=r.rows,n=e-1;for(;n>=0;)if(r.maxRow(n)===0)n--;else{let i=0,s=!1;for(;i<e&&s===!1;)r.get(n,i)===1?s=!0:i++;for(let u=0;u<n;u++){let c=r.get(u,i);for(let h=i;h<t;h++){let l=r.get(u,h)-c*r.get(n,h);r.set(u,h,l)}}n--}return r}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{rows:t=1,columns:e=1}=r;if(!Number.isInteger(t)||t<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(e)||e<=0)throw new TypeError("columns must be a positive integer");let n=new Kt(this.rows*t,this.columns*e);for(let i=0;i<t;i++)for(let s=0;s<e;s++)n.setSubMatrix(this,this.rows*i,this.columns*s);return n}fill(r){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,r);return this}neg(){return this.mulS(-1)}getRow(r){dr(this,r);let t=[];for(let e=0;e<this.columns;e++)t.push(this.get(r,e));return t}getRowVector(r){return Kt.rowVector(this.getRow(r))}setRow(r,t){dr(this,r),t=cn(this,t);for(let e=0;e<this.columns;e++)this.set(r,e,t[e]);return this}swapRows(r,t){dr(this,r),dr(this,t);for(let e=0;e<this.columns;e++){let n=this.get(r,e);this.set(r,e,this.get(t,e)),this.set(t,e,n)}return this}getColumn(r){Qr(this,r);let t=[];for(let e=0;e<this.rows;e++)t.push(this.get(e,r));return t}getColumnVector(r){return Kt.columnVector(this.getColumn(r))}setColumn(r,t){Qr(this,r),t=qr(this,t);for(let e=0;e<this.rows;e++)this.set(e,r,t[e]);return this}swapColumns(r,t){Qr(this,r),Qr(this,t);for(let e=0;e<this.rows;e++){let n=this.get(e,r);this.set(e,r,this.get(e,t)),this.set(e,t,n)}return this}addRowVector(r){r=cn(this,r);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)+r[e]);return this}subRowVector(r){r=cn(this,r);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)-r[e]);return this}mulRowVector(r){r=cn(this,r);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)*r[e]);return this}divRowVector(r){r=cn(this,r);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)/r[e]);return this}addColumnVector(r){r=qr(this,r);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)+r[t]);return this}subColumnVector(r){r=qr(this,r);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)-r[t]);return this}mulColumnVector(r){r=qr(this,r);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)*r[t]);return this}divColumnVector(r){r=qr(this,r);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)/r[t]);return this}mulRow(r,t){dr(this,r);for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t);return this}mulColumn(r,t){Qr(this,r);for(let e=0;e<this.rows;e++)this.set(e,r,this.get(e,r)*t);return this}max(r){if(this.isEmpty())return NaN;switch(r){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t[e]&&(t[e]=this.get(e,n));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t[n]&&(t[n]=this.get(e,n));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}default:throw new Error(`invalid option: ${r}`)}}maxIndex(){Yn(this);let r=this.get(0,0),t=[0,0];for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>r&&(r=this.get(e,n),t[0]=e,t[1]=n);return t}min(r){if(this.isEmpty())return NaN;switch(r){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t[e]&&(t[e]=this.get(e,n));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t[n]&&(t[n]=this.get(e,n));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}default:throw new Error(`invalid option: ${r}`)}}minIndex(){Yn(this);let r=this.get(0,0),t=[0,0];for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<r&&(r=this.get(e,n),t[0]=e,t[1]=n);return t}maxRow(r){if(dr(this,r),this.isEmpty())return NaN;let t=this.get(r,0);for(let e=1;e<this.columns;e++)this.get(r,e)>t&&(t=this.get(r,e));return t}maxRowIndex(r){dr(this,r),Yn(this);let t=this.get(r,0),e=[r,0];for(let n=1;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[1]=n);return e}minRow(r){if(dr(this,r),this.isEmpty())return NaN;let t=this.get(r,0);for(let e=1;e<this.columns;e++)this.get(r,e)<t&&(t=this.get(r,e));return t}minRowIndex(r){dr(this,r),Yn(this);let t=this.get(r,0),e=[r,0];for(let n=1;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[1]=n);return e}maxColumn(r){if(Qr(this,r),this.isEmpty())return NaN;let t=this.get(0,r);for(let e=1;e<this.rows;e++)this.get(e,r)>t&&(t=this.get(e,r));return t}maxColumnIndex(r){Qr(this,r),Yn(this);let t=this.get(0,r),e=[0,r];for(let n=1;n<this.rows;n++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n);return e}minColumn(r){if(Qr(this,r),this.isEmpty())return NaN;let t=this.get(0,r);for(let e=1;e<this.rows;e++)this.get(e,r)<t&&(t=this.get(e,r));return t}minColumnIndex(r){Qr(this,r),Yn(this);let t=this.get(0,r),e=[0,r];for(let n=1;n<this.rows;n++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n);return e}diag(){let r=Math.min(this.rows,this.columns),t=[];for(let e=0;e<r;e++)t.push(this.get(e,e));return t}norm(r="frobenius"){let t=0;if(r==="max")return this.max();if(r==="frobenius"){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t+=this.get(e,n)*this.get(e,n);return Math.sqrt(t)}throw new RangeError(`unknown norm type: ${r}`)}cumulativeSum(){let r=0;for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)r+=this.get(t,e),this.set(t,e,r);return this}dot(r){ge.isMatrix(r)&&(r=r.to1DArray());let t=this.to1DArray();if(t.length!==r.length)throw new RangeError("vectors do not have the same size");let e=0;for(let n=0;n<t.length;n++)e+=t[n]*r[n];return e}mmul(r){r=Kt.checkMatrix(r);let t=this.rows,e=this.columns,n=r.columns,i=new Kt(t,n),s=new Float64Array(e);for(let u=0;u<n;u++){for(let c=0;c<e;c++)s[c]=r.get(c,u);for(let c=0;c<t;c++){let h=0;for(let l=0;l<e;l++)h+=this.get(c,l)*s[l];i.set(c,u,h)}}return i}strassen2x2(r){r=Kt.checkMatrix(r);let t=new Kt(2,2);const e=this.get(0,0),n=r.get(0,0),i=this.get(0,1),s=r.get(0,1),u=this.get(1,0),c=r.get(1,0),h=this.get(1,1),l=r.get(1,1),E=(e+h)*(n+l),R=(u+h)*n,_=e*(s-l),M=h*(c-n),w=(e+i)*l,L=E+M-w+(i-h)*(c+l),k=_+w,P=R+M,wt=E-R+_+(u-e)*(n+s);return t.set(0,0,L),t.set(0,1,k),t.set(1,0,P),t.set(1,1,wt),t}strassen3x3(r){r=Kt.checkMatrix(r);let t=new Kt(3,3);const e=this.get(0,0),n=this.get(0,1),i=this.get(0,2),s=this.get(1,0),u=this.get(1,1),c=this.get(1,2),h=this.get(2,0),l=this.get(2,1),E=this.get(2,2),R=r.get(0,0),_=r.get(0,1),M=r.get(0,2),w=r.get(1,0),L=r.get(1,1),k=r.get(1,2),P=r.get(2,0),wt=r.get(2,1),gt=r.get(2,2),dt=(e-s)*(-_+L),X=(-e+s+u)*(R-_+L),ot=(s+u)*(-R+_),ht=e*R,nt=(-e+h+l)*(R-M+k),b=(-e+h)*(M-k),C=(h+l)*(-R+M),Z=(-i+l+E)*(L+P-wt),W=(i-E)*(L-wt),xt=i*P,A=(l+E)*(-P+wt),d=(-i+u+c)*(k+P-gt),S=(i-c)*(k-gt),G=(u+c)*(-P+gt),rt=ht+xt+n*w,it=(e+n+i-s-u-l-E)*L+X+ot+ht+Z+xt+A,g=ht+nt+C+(e+n+i-u-c-h-l)*k+xt+d+G,v=dt+u*(-R+_+w-L-k-P+gt)+X+ht+xt+d+S,f=dt+X+ot+ht+c*wt,m=xt+d+S+G+s*M,j=ht+nt+b+l*(-R+M+w-L-k-P+wt)+Z+W+xt,H=Z+W+xt+A+h*_,p=ht+nt+b+C+E*gt;return t.set(0,0,rt),t.set(0,1,it),t.set(0,2,g),t.set(1,0,v),t.set(1,1,f),t.set(1,2,m),t.set(2,0,j),t.set(2,1,H),t.set(2,2,p),t}mmulStrassen(r){r=Kt.checkMatrix(r);let t=this.clone(),e=t.rows,n=t.columns,i=r.rows,s=r.columns;function u(l,E,R){let _=l.rows,M=l.columns;if(_===E&&M===R)return l;{let w=ge.zeros(E,R);return w=w.setSubMatrix(l,0,0),w}}n!==i&&console.warn(`Multiplying ${e} x ${n} and ${i} x ${s} matrix: dimensions do not match.`);let c=Math.max(e,i),h=Math.max(n,s);return t=u(t,c,h),function l(E,R,_,M){if(_<=512||M<=512)return E.mmul(R);_%2==1&&M%2==1?(E=u(E,_+1,M+1),R=u(R,_+1,M+1)):_%2==1?(E=u(E,_+1,M),R=u(R,_+1,M)):M%2==1&&(E=u(E,_,M+1),R=u(R,_,M+1));let w=parseInt(E.rows/2,10),L=parseInt(E.columns/2,10),k=E.subMatrix(0,w-1,0,L-1),P=R.subMatrix(0,w-1,0,L-1),wt=E.subMatrix(0,w-1,L,E.columns-1),gt=R.subMatrix(0,w-1,L,R.columns-1),dt=E.subMatrix(w,E.rows-1,0,L-1),X=R.subMatrix(w,R.rows-1,0,L-1),ot=E.subMatrix(w,E.rows-1,L,E.columns-1),ht=R.subMatrix(w,R.rows-1,L,R.columns-1),nt=l(ge.add(k,ot),ge.add(P,ht),w,L),b=l(ge.add(dt,ot),P,w,L),C=l(k,ge.sub(gt,ht),w,L),Z=l(ot,ge.sub(X,P),w,L),W=l(ge.add(k,wt),ht,w,L),xt=l(ge.sub(dt,k),ge.add(P,gt),w,L),A=l(ge.sub(wt,ot),ge.add(X,ht),w,L),d=ge.add(nt,Z);d.sub(W),d.add(A);let S=ge.add(C,W),G=ge.add(b,Z),rt=ge.sub(nt,b);rt.add(C),rt.add(xt);let it=ge.zeros(2*d.rows,2*d.columns);return it=it.setSubMatrix(d,0,0),it=it.setSubMatrix(S,d.rows,0),it=it.setSubMatrix(G,0,d.columns),it=it.setSubMatrix(rt,d.rows,d.columns),it.subMatrix(0,_-1,0,M-1)}(t,r=u(r,c,h),c,h)}scaleRows(r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{min:t=0,max:e=1}=r;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(e))throw new TypeError("max must be a number");if(t>=e)throw new RangeError("min must be smaller than max");let n=new Kt(this.rows,this.columns);for(let i=0;i<this.rows;i++){const s=this.getRow(i);s.length>0&&na(s,{min:t,max:e,output:s}),n.setRow(i,s)}return n}scaleColumns(r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{min:t=0,max:e=1}=r;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(e))throw new TypeError("max must be a number");if(t>=e)throw new RangeError("min must be smaller than max");let n=new Kt(this.rows,this.columns);for(let i=0;i<this.columns;i++){const s=this.getColumn(i);s.length&&na(s,{min:t,max:e,output:s}),n.setColumn(i,s)}return n}flipRows(){const r=Math.ceil(this.columns/2);for(let t=0;t<this.rows;t++)for(let e=0;e<r;e++){let n=this.get(t,e),i=this.get(t,this.columns-1-e);this.set(t,e,i),this.set(t,this.columns-1-e,n)}return this}flipColumns(){const r=Math.ceil(this.rows/2);for(let t=0;t<this.columns;t++)for(let e=0;e<r;e++){let n=this.get(e,t),i=this.get(this.rows-1-e,t);this.set(e,t,i),this.set(this.rows-1-e,t,n)}return this}kroneckerProduct(r){r=Kt.checkMatrix(r);let t=this.rows,e=this.columns,n=r.rows,i=r.columns,s=new Kt(t*n,e*i);for(let u=0;u<t;u++)for(let c=0;c<e;c++)for(let h=0;h<n;h++)for(let l=0;l<i;l++)s.set(n*u+h,i*c+l,this.get(u,c)*r.get(h,l));return s}kroneckerSum(r){if(r=Kt.checkMatrix(r),!this.isSquare()||!r.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let t=this.rows,e=r.rows,n=this.kroneckerProduct(Kt.eye(e,e)),i=Kt.eye(t,t).kroneckerProduct(r);return n.add(i)}transpose(){let r=new Kt(this.columns,this.rows);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)r.set(e,t,this.get(t,e));return r}sortRows(r=bn){for(let t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(r));return this}sortColumns(r=bn){for(let t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(r));return this}subMatrix(r,t,e,n){ia(this,r,t,e,n);let i=new Kt(t-r+1,n-e+1);for(let s=r;s<=t;s++)for(let u=e;u<=n;u++)i.set(s-r,u-e,this.get(s,u));return i}subMatrixRow(r,t,e){if(t===void 0&&(t=0),e===void 0&&(e=this.columns-1),t>e||t<0||t>=this.columns||e<0||e>=this.columns)throw new RangeError("Argument out of range");let n=new Kt(r.length,e-t+1);for(let i=0;i<r.length;i++)for(let s=t;s<=e;s++){if(r[i]<0||r[i]>=this.rows)throw new RangeError(`Row index out of range: ${r[i]}`);n.set(i,s-t,this.get(r[i],s))}return n}subMatrixColumn(r,t,e){if(t===void 0&&(t=0),e===void 0&&(e=this.rows-1),t>e||t<0||t>=this.rows||e<0||e>=this.rows)throw new RangeError("Argument out of range");let n=new Kt(e-t+1,r.length);for(let i=0;i<r.length;i++)for(let s=t;s<=e;s++){if(r[i]<0||r[i]>=this.columns)throw new RangeError(`Column index out of range: ${r[i]}`);n.set(s-t,i,this.get(s,r[i]))}return n}setSubMatrix(r,t,e){if((r=Kt.checkMatrix(r)).isEmpty())return this;ia(this,t,t+r.rows-1,e,e+r.columns-1);for(let n=0;n<r.rows;n++)for(let i=0;i<r.columns;i++)this.set(t+n,e+i,r.get(n,i));return this}selection(r,t){(function(n,i){if(!cr(i))throw new TypeError("row indices must be an array");for(let s=0;s<i.length;s++)if(i[s]<0||i[s]>=n.rows)throw new RangeError("row indices are out of range")})(this,r),function(n,i){if(!cr(i))throw new TypeError("column indices must be an array");for(let s=0;s<i.length;s++)if(i[s]<0||i[s]>=n.columns)throw new RangeError("column indices are out of range")}(this,t);let e=new Kt(r.length,t.length);for(let n=0;n<r.length;n++){let i=r[n];for(let s=0;s<t.length;s++){let u=t[s];e.set(n,s,this.get(i,u))}}return e}trace(){let r=Math.min(this.rows,this.columns),t=0;for(let e=0;e<r;e++)t+=this.get(e,e);return t}clone(){let r=new Kt(this.rows,this.columns);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)r.set(t,e,this.get(t,e));return r}sum(r){switch(r){case"row":return function(t){let e=mo(t.rows);for(let n=0;n<t.rows;++n)for(let i=0;i<t.columns;++i)e[n]+=t.get(n,i);return e}(this);case"column":return function(t){let e=mo(t.columns);for(let n=0;n<t.rows;++n)for(let i=0;i<t.columns;++i)e[i]+=t.get(n,i);return e}(this);case void 0:return function(t){let e=0;for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)e+=t.get(n,i);return e}(this);default:throw new Error(`invalid option: ${r}`)}}product(r){switch(r){case"row":return function(t){let e=mo(t.rows,1);for(let n=0;n<t.rows;++n)for(let i=0;i<t.columns;++i)e[n]*=t.get(n,i);return e}(this);case"column":return function(t){let e=mo(t.columns,1);for(let n=0;n<t.rows;++n)for(let i=0;i<t.columns;++i)e[i]*=t.get(n,i);return e}(this);case void 0:return function(t){let e=1;for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)e*=t.get(n,i);return e}(this);default:throw new Error(`invalid option: ${r}`)}}mean(r){const t=this.sum(r);switch(r){case"row":for(let e=0;e<this.rows;e++)t[e]/=this.columns;return t;case"column":for(let e=0;e<this.columns;e++)t[e]/=this.rows;return t;case void 0:return t/this.size;default:throw new Error(`invalid option: ${r}`)}}variance(r,t={}){if(typeof r=="object"&&(t=r,r=void 0),typeof t!="object")throw new TypeError("options must be an object");const{unbiased:e=!0,mean:n=this.mean(r)}=t;if(typeof e!="boolean")throw new TypeError("unbiased must be a boolean");switch(r){case"row":if(!cr(n))throw new TypeError("mean must be an array");return function(i,s,u){const c=i.rows,h=i.columns,l=[];for(let E=0;E<c;E++){let R=0,_=0,M=0;for(let w=0;w<h;w++)M=i.get(E,w)-u[E],R+=M,_+=M*M;s?l.push((_-R*R/h)/(h-1)):l.push((_-R*R/h)/h)}return l}(this,e,n);case"column":if(!cr(n))throw new TypeError("mean must be an array");return function(i,s,u){const c=i.rows,h=i.columns,l=[];for(let E=0;E<h;E++){let R=0,_=0,M=0;for(let w=0;w<c;w++)M=i.get(w,E)-u[E],R+=M,_+=M*M;s?l.push((_-R*R/c)/(c-1)):l.push((_-R*R/c)/c)}return l}(this,e,n);case void 0:if(typeof n!="number")throw new TypeError("mean must be a number");return function(i,s,u){const c=i.rows,h=i.columns,l=c*h;let E=0,R=0,_=0;for(let M=0;M<c;M++)for(let w=0;w<h;w++)_=i.get(M,w)-u,E+=_,R+=_*_;return s?(R-E*E/l)/(l-1):(R-E*E/l)/l}(this,e,n);default:throw new Error(`invalid option: ${r}`)}}standardDeviation(r,t){typeof r=="object"&&(t=r,r=void 0);const e=this.variance(r,t);if(r===void 0)return Math.sqrt(e);for(let n=0;n<e.length;n++)e[n]=Math.sqrt(e[n]);return e}center(r,t={}){if(typeof r=="object"&&(t=r,r=void 0),typeof t!="object")throw new TypeError("options must be an object");const{center:e=this.mean(r)}=t;switch(r){case"row":if(!cr(e))throw new TypeError("center must be an array");return function(n,i){for(let s=0;s<n.rows;s++)for(let u=0;u<n.columns;u++)n.set(s,u,n.get(s,u)-i[s])}(this,e),this;case"column":if(!cr(e))throw new TypeError("center must be an array");return function(n,i){for(let s=0;s<n.rows;s++)for(let u=0;u<n.columns;u++)n.set(s,u,n.get(s,u)-i[u])}(this,e),this;case void 0:if(typeof e!="number")throw new TypeError("center must be a number");return function(n,i){for(let s=0;s<n.rows;s++)for(let u=0;u<n.columns;u++)n.set(s,u,n.get(s,u)-i)}(this,e),this;default:throw new Error(`invalid option: ${r}`)}}scale(r,t={}){if(typeof r=="object"&&(t=r,r=void 0),typeof t!="object")throw new TypeError("options must be an object");let e=t.scale;switch(r){case"row":if(e===void 0)e=function(n){const i=[];for(let s=0;s<n.rows;s++){let u=0;for(let c=0;c<n.columns;c++)u+=Math.pow(n.get(s,c),2)/(n.columns-1);i.push(Math.sqrt(u))}return i}(this);else if(!cr(e))throw new TypeError("scale must be an array");return function(n,i){for(let s=0;s<n.rows;s++)for(let u=0;u<n.columns;u++)n.set(s,u,n.get(s,u)/i[s])}(this,e),this;case"column":if(e===void 0)e=function(n){const i=[];for(let s=0;s<n.columns;s++){let u=0;for(let c=0;c<n.rows;c++)u+=Math.pow(n.get(c,s),2)/(n.rows-1);i.push(Math.sqrt(u))}return i}(this);else if(!cr(e))throw new TypeError("scale must be an array");return function(n,i){for(let s=0;s<n.rows;s++)for(let u=0;u<n.columns;u++)n.set(s,u,n.get(s,u)/i[u])}(this,e),this;case void 0:if(e===void 0)e=function(n){const i=n.size-1;let s=0;for(let u=0;u<n.columns;u++)for(let c=0;c<n.rows;c++)s+=Math.pow(n.get(c,u),2)/i;return Math.sqrt(s)}(this);else if(typeof e!="number")throw new TypeError("scale must be a number");return function(n,i){for(let s=0;s<n.rows;s++)for(let u=0;u<n.columns;u++)n.set(s,u,n.get(s,u)/i)}(this,e),this;default:throw new Error(`invalid option: ${r}`)}}toString(r){return qa(this,r)}}function bn(o,r){return o-r}ge.prototype.klass="Matrix",typeof Symbol<"u"&&(ge.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return qa(this)}),ge.random=ge.rand,ge.randomInt=ge.randInt,ge.diagonal=ge.diag,ge.prototype.diagonal=ge.prototype.diag,ge.identity=ge.eye,ge.prototype.negate=ge.prototype.neg,ge.prototype.tensorProduct=ge.prototype.kroneckerProduct;class Kt extends ge{constructor(r,t){if(super(),Kt.isMatrix(r))return r.clone();if(Number.isInteger(r)&&r>=0){if(this.data=[],!(Number.isInteger(t)&&t>=0))throw new TypeError("nColumns must be a positive integer");for(let e=0;e<r;e++)this.data.push(new Float64Array(t))}else{if(!cr(r))throw new TypeError("First argument must be a positive number or an array");{const e=r;if(typeof(t=(r=e.length)?e[0].length:0)!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<r;n++){if(e[n].length!==t)throw new RangeError("Inconsistent array dimensions");if(!e[n].every(i=>typeof i=="number"))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(e[n]))}}}this.rows=r,this.columns=t}set(r,t,e){return this.data[r][t]=e,this}get(r,t){return this.data[r][t]}removeRow(r){return dr(this,r),this.data.splice(r,1),this.rows-=1,this}addRow(r,t){return t===void 0&&(t=r,r=this.rows),dr(this,r,!0),t=Float64Array.from(cn(this,t)),this.data.splice(r,0,t),this.rows+=1,this}removeColumn(r){Qr(this,r);for(let t=0;t<this.rows;t++){const e=new Float64Array(this.columns-1);for(let n=0;n<r;n++)e[n]=this.data[t][n];for(let n=r+1;n<this.columns;n++)e[n-1]=this.data[t][n];this.data[t]=e}return this.columns-=1,this}addColumn(r,t){t===void 0&&(t=r,r=this.columns),Qr(this,r,!0),t=qr(this,t);for(let e=0;e<this.rows;e++){const n=new Float64Array(this.columns+1);let i=0;for(;i<r;i++)n[i]=this.data[e][i];for(n[i++]=t[e];i<this.columns+1;i++)n[i]=this.data[e][i-1];this.data[e]=n}return this.columns+=1,this}}(function(o,r){o.prototype.add=function(t){return typeof t=="number"?this.addS(t):this.addM(t)},o.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t);return this},o.prototype.addM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t.get(e,n));return this},o.add=function(t,e){return new r(t).add(e)},o.prototype.sub=function(t){return typeof t=="number"?this.subS(t):this.subM(t)},o.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t);return this},o.prototype.subM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t.get(e,n));return this},o.sub=function(t,e){return new r(t).sub(e)},o.prototype.subtract=o.prototype.sub,o.prototype.subtractS=o.prototype.subS,o.prototype.subtractM=o.prototype.subM,o.subtract=o.sub,o.prototype.mul=function(t){return typeof t=="number"?this.mulS(t):this.mulM(t)},o.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this},o.prototype.mulM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t.get(e,n));return this},o.mul=function(t,e){return new r(t).mul(e)},o.prototype.multiply=o.prototype.mul,o.prototype.multiplyS=o.prototype.mulS,o.prototype.multiplyM=o.prototype.mulM,o.multiply=o.mul,o.prototype.div=function(t){return typeof t=="number"?this.divS(t):this.divM(t)},o.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t);return this},o.prototype.divM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t.get(e,n));return this},o.div=function(t,e){return new r(t).div(e)},o.prototype.divide=o.prototype.div,o.prototype.divideS=o.prototype.divS,o.prototype.divideM=o.prototype.divM,o.divide=o.div,o.prototype.mod=function(t){return typeof t=="number"?this.modS(t):this.modM(t)},o.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t);return this},o.prototype.modM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t.get(e,n));return this},o.mod=function(t,e){return new r(t).mod(e)},o.prototype.modulus=o.prototype.mod,o.prototype.modulusS=o.prototype.modS,o.prototype.modulusM=o.prototype.modM,o.modulus=o.mod,o.prototype.and=function(t){return typeof t=="number"?this.andS(t):this.andM(t)},o.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t);return this},o.prototype.andM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t.get(e,n));return this},o.and=function(t,e){return new r(t).and(e)},o.prototype.or=function(t){return typeof t=="number"?this.orS(t):this.orM(t)},o.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t);return this},o.prototype.orM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t.get(e,n));return this},o.or=function(t,e){return new r(t).or(e)},o.prototype.xor=function(t){return typeof t=="number"?this.xorS(t):this.xorM(t)},o.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t);return this},o.prototype.xorM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t.get(e,n));return this},o.xor=function(t,e){return new r(t).xor(e)},o.prototype.leftShift=function(t){return typeof t=="number"?this.leftShiftS(t):this.leftShiftM(t)},o.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t);return this},o.prototype.leftShiftM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t.get(e,n));return this},o.leftShift=function(t,e){return new r(t).leftShift(e)},o.prototype.signPropagatingRightShift=function(t){return typeof t=="number"?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},o.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t);return this},o.prototype.signPropagatingRightShiftM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t.get(e,n));return this},o.signPropagatingRightShift=function(t,e){return new r(t).signPropagatingRightShift(e)},o.prototype.rightShift=function(t){return typeof t=="number"?this.rightShiftS(t):this.rightShiftM(t)},o.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t);return this},o.prototype.rightShiftM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t.get(e,n));return this},o.rightShift=function(t,e){return new r(t).rightShift(e)},o.prototype.zeroFillRightShift=o.prototype.rightShift,o.prototype.zeroFillRightShiftS=o.prototype.rightShiftS,o.prototype.zeroFillRightShiftM=o.prototype.rightShiftM,o.zeroFillRightShift=o.rightShift,o.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},o.not=function(t){return new r(t).not()},o.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},o.abs=function(t){return new r(t).abs()},o.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},o.acos=function(t){return new r(t).acos()},o.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},o.acosh=function(t){return new r(t).acosh()},o.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},o.asin=function(t){return new r(t).asin()},o.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},o.asinh=function(t){return new r(t).asinh()},o.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},o.atan=function(t){return new r(t).atan()},o.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},o.atanh=function(t){return new r(t).atanh()},o.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},o.cbrt=function(t){return new r(t).cbrt()},o.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},o.ceil=function(t){return new r(t).ceil()},o.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},o.clz32=function(t){return new r(t).clz32()},o.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},o.cos=function(t){return new r(t).cos()},o.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},o.cosh=function(t){return new r(t).cosh()},o.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},o.exp=function(t){return new r(t).exp()},o.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},o.expm1=function(t){return new r(t).expm1()},o.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},o.floor=function(t){return new r(t).floor()},o.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},o.fround=function(t){return new r(t).fround()},o.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},o.log=function(t){return new r(t).log()},o.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},o.log1p=function(t){return new r(t).log1p()},o.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},o.log10=function(t){return new r(t).log10()},o.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},o.log2=function(t){return new r(t).log2()},o.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},o.round=function(t){return new r(t).round()},o.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},o.sign=function(t){return new r(t).sign()},o.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},o.sin=function(t){return new r(t).sin()},o.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},o.sinh=function(t){return new r(t).sinh()},o.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},o.sqrt=function(t){return new r(t).sqrt()},o.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},o.tan=function(t){return new r(t).tan()},o.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},o.tanh=function(t){return new r(t).tanh()},o.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},o.trunc=function(t){return new r(t).trunc()},o.pow=function(t,e){return new r(t).pow(e)},o.prototype.pow=function(t){return typeof t=="number"?this.powS(t):this.powM(t)},o.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.pow(this.get(e,n),t));return this},o.prototype.powM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.pow(this.get(e,n),t.get(e,n)));return this}})(ge,Kt);class jr extends ge{constructor(r){super(),this.data=r,this.rows=r.length,this.columns=r[0].length}set(r,t,e){return this.data[r][t]=e,this}get(r,t){return this.data[r][t]}}function Kn(o,r){let t=0;return Math.abs(o)>Math.abs(r)?(t=r/o,Math.abs(o)*Math.sqrt(1+t*t)):r!==0?(t=o/r,Math.abs(r)*Math.sqrt(1+t*t)):0}class $a{constructor(r,t={}){if((r=jr.checkMatrix(r)).isEmpty())throw new Error("Matrix must be non-empty");let e=r.rows,n=r.columns;const{computeLeftSingularVectors:i=!0,computeRightSingularVectors:s=!0,autoTranspose:u=!1}=t;let c,h=!!i,l=!!s,E=!1;if(e<n)if(u){c=r.transpose(),e=c.rows,n=c.columns,E=!0;let b=h;h=l,l=b}else c=r.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else c=r.clone();let R=Math.min(e,n),_=Math.min(e+1,n),M=new Float64Array(_),w=new Kt(e,R),L=new Kt(n,n),k=new Float64Array(n),P=new Float64Array(e),wt=new Float64Array(_);for(let b=0;b<_;b++)wt[b]=b;let gt=Math.min(e-1,n),dt=Math.max(0,Math.min(n-2,e)),X=Math.max(gt,dt);for(let b=0;b<X;b++){if(b<gt){M[b]=0;for(let C=b;C<e;C++)M[b]=Kn(M[b],c.get(C,b));if(M[b]!==0){c.get(b,b)<0&&(M[b]=-M[b]);for(let C=b;C<e;C++)c.set(C,b,c.get(C,b)/M[b]);c.set(b,b,c.get(b,b)+1)}M[b]=-M[b]}for(let C=b+1;C<n;C++){if(b<gt&&M[b]!==0){let Z=0;for(let W=b;W<e;W++)Z+=c.get(W,b)*c.get(W,C);Z=-Z/c.get(b,b);for(let W=b;W<e;W++)c.set(W,C,c.get(W,C)+Z*c.get(W,b))}k[C]=c.get(b,C)}if(h&&b<gt)for(let C=b;C<e;C++)w.set(C,b,c.get(C,b));if(b<dt){k[b]=0;for(let C=b+1;C<n;C++)k[b]=Kn(k[b],k[C]);if(k[b]!==0){k[b+1]<0&&(k[b]=0-k[b]);for(let C=b+1;C<n;C++)k[C]/=k[b];k[b+1]+=1}if(k[b]=-k[b],b+1<e&&k[b]!==0){for(let C=b+1;C<e;C++)P[C]=0;for(let C=b+1;C<e;C++)for(let Z=b+1;Z<n;Z++)P[C]+=k[Z]*c.get(C,Z);for(let C=b+1;C<n;C++){let Z=-k[C]/k[b+1];for(let W=b+1;W<e;W++)c.set(W,C,c.get(W,C)+Z*P[W])}}if(l)for(let C=b+1;C<n;C++)L.set(C,b,k[C])}}let ot=Math.min(n,e+1);if(gt<n&&(M[gt]=c.get(gt,gt)),e<ot&&(M[ot-1]=0),dt+1<ot&&(k[dt]=c.get(dt,ot-1)),k[ot-1]=0,h){for(let b=gt;b<R;b++){for(let C=0;C<e;C++)w.set(C,b,0);w.set(b,b,1)}for(let b=gt-1;b>=0;b--)if(M[b]!==0){for(let C=b+1;C<R;C++){let Z=0;for(let W=b;W<e;W++)Z+=w.get(W,b)*w.get(W,C);Z=-Z/w.get(b,b);for(let W=b;W<e;W++)w.set(W,C,w.get(W,C)+Z*w.get(W,b))}for(let C=b;C<e;C++)w.set(C,b,-w.get(C,b));w.set(b,b,1+w.get(b,b));for(let C=0;C<b-1;C++)w.set(C,b,0)}else{for(let C=0;C<e;C++)w.set(C,b,0);w.set(b,b,1)}}if(l)for(let b=n-1;b>=0;b--){if(b<dt&&k[b]!==0)for(let C=b+1;C<n;C++){let Z=0;for(let W=b+1;W<n;W++)Z+=L.get(W,b)*L.get(W,C);Z=-Z/L.get(b+1,b);for(let W=b+1;W<n;W++)L.set(W,C,L.get(W,C)+Z*L.get(W,b))}for(let C=0;C<n;C++)L.set(C,b,0);L.set(b,b,1)}let ht=ot-1,nt=Number.EPSILON;for(;ot>0;){let b,C;for(b=ot-2;b>=-1&&b!==-1;b--){const Z=Number.MIN_VALUE+nt*Math.abs(M[b]+Math.abs(M[b+1]));if(Math.abs(k[b])<=Z||Number.isNaN(k[b])){k[b]=0;break}}if(b===ot-2)C=4;else{let Z;for(Z=ot-1;Z>=b&&Z!==b;Z--){let W=(Z!==ot?Math.abs(k[Z]):0)+(Z!==b+1?Math.abs(k[Z-1]):0);if(Math.abs(M[Z])<=nt*W){M[Z]=0;break}}Z===b?C=3:Z===ot-1?C=1:(C=2,b=Z)}switch(b++,C){case 1:{let Z=k[ot-2];k[ot-2]=0;for(let W=ot-2;W>=b;W--){let xt=Kn(M[W],Z),A=M[W]/xt,d=Z/xt;if(M[W]=xt,W!==b&&(Z=-d*k[W-1],k[W-1]=A*k[W-1]),l)for(let S=0;S<n;S++)xt=A*L.get(S,W)+d*L.get(S,ot-1),L.set(S,ot-1,-d*L.get(S,W)+A*L.get(S,ot-1)),L.set(S,W,xt)}break}case 2:{let Z=k[b-1];k[b-1]=0;for(let W=b;W<ot;W++){let xt=Kn(M[W],Z),A=M[W]/xt,d=Z/xt;if(M[W]=xt,Z=-d*k[W],k[W]=A*k[W],h)for(let S=0;S<e;S++)xt=A*w.get(S,W)+d*w.get(S,b-1),w.set(S,b-1,-d*w.get(S,W)+A*w.get(S,b-1)),w.set(S,W,xt)}break}case 3:{const Z=Math.max(Math.abs(M[ot-1]),Math.abs(M[ot-2]),Math.abs(k[ot-2]),Math.abs(M[b]),Math.abs(k[b])),W=M[ot-1]/Z,xt=M[ot-2]/Z,A=k[ot-2]/Z,d=M[b]/Z,S=k[b]/Z,G=((xt+W)*(xt-W)+A*A)/2,rt=W*A*(W*A);let it=0;G===0&&rt===0||(it=G<0?0-Math.sqrt(G*G+rt):Math.sqrt(G*G+rt),it=rt/(G+it));let g=(d+W)*(d-W)+it,v=d*S;for(let f=b;f<ot-1;f++){let m=Kn(g,v);m===0&&(m=Number.MIN_VALUE);let j=g/m,H=v/m;if(f!==b&&(k[f-1]=m),g=j*M[f]+H*k[f],k[f]=j*k[f]-H*M[f],v=H*M[f+1],M[f+1]=j*M[f+1],l)for(let p=0;p<n;p++)m=j*L.get(p,f)+H*L.get(p,f+1),L.set(p,f+1,-H*L.get(p,f)+j*L.get(p,f+1)),L.set(p,f,m);if(m=Kn(g,v),m===0&&(m=Number.MIN_VALUE),j=g/m,H=v/m,M[f]=m,g=j*k[f]+H*M[f+1],M[f+1]=-H*k[f]+j*M[f+1],v=H*k[f+1],k[f+1]=j*k[f+1],h&&f<e-1)for(let p=0;p<e;p++)m=j*w.get(p,f)+H*w.get(p,f+1),w.set(p,f+1,-H*w.get(p,f)+j*w.get(p,f+1)),w.set(p,f,m)}k[ot-2]=g;break}case 4:if(M[b]<=0&&(M[b]=M[b]<0?-M[b]:0,l))for(let Z=0;Z<=ht;Z++)L.set(Z,b,-L.get(Z,b));for(;b<ht&&!(M[b]>=M[b+1]);){let Z=M[b];if(M[b]=M[b+1],M[b+1]=Z,l&&b<n-1)for(let W=0;W<n;W++)Z=L.get(W,b+1),L.set(W,b+1,L.get(W,b)),L.set(W,b,Z);if(h&&b<e-1)for(let W=0;W<e;W++)Z=w.get(W,b+1),w.set(W,b+1,w.get(W,b)),w.set(W,b,Z);b++}ot--}}if(E){let b=L;L=w,w=b}this.m=e,this.n=n,this.s=M,this.U=w,this.V=L}solve(r){let t=r,e=this.threshold,n=this.s.length,i=Kt.zeros(n,n);for(let R=0;R<n;R++)Math.abs(this.s[R])<=e?i.set(R,R,0):i.set(R,R,1/this.s[R]);let s=this.U,u=this.rightSingularVectors,c=u.mmul(i),h=u.rows,l=s.rows,E=Kt.zeros(h,l);for(let R=0;R<h;R++)for(let _=0;_<l;_++){let M=0;for(let w=0;w<n;w++)M+=c.get(R,w)*s.get(_,w);E.set(R,_,M)}return E.mmul(t)}solveForDiagonal(r){return this.solve(Kt.diag(r))}inverse(){let r=this.V,t=this.threshold,e=r.rows,n=r.columns,i=new Kt(e,this.s.length);for(let l=0;l<e;l++)for(let E=0;E<n;E++)Math.abs(this.s[E])>t&&i.set(l,E,r.get(l,E)/this.s[E]);let s=this.U,u=s.rows,c=s.columns,h=new Kt(e,u);for(let l=0;l<e;l++)for(let E=0;E<u;E++){let R=0;for(let _=0;_<c;_++)R+=i.get(l,_)*s.get(E,_);h.set(l,E,R)}return h}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let r=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,t=0,e=this.s;for(let n=0,i=e.length;n<i;n++)e[n]>r&&t++;return t}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return Kt.diag(this.s)}}var Ms={center:[0,0],linkDistance:50},aa=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="mds",this.options=y(y({},Ms),r)}return o.prototype.execute=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return[2,this.genericMDSLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return this.genericMDSLayout(!0,r,t),[2]})})},o.prototype.genericMDSLayout=function(r,t,e){return Y(this,void 0,void 0,function(){var n,i,s,u,c,h,l,E,R,_,M,w;return yt(this,function(L){return n=y(y({},this.options),e),i=n.center,s=i===void 0?[0,0]:i,u=n.linkDistance,c=u===void 0?50:u,h=t.getAllNodes(),l=t.getAllEdges(),h!=null&&h.length&&h.length!==1?(E=He({nodes:h,edges:l},!1),R=me(E),Ya(R),_=rr(R,c),M=Ka(_),w=[],M.forEach(function(k,P){var wt=qe(h[P]);wt.data.x=k[0]+s[0],wt.data.y=k[1]+s[1],w.push(wt)}),r&&w.forEach(function(k){return t.mergeNodeData(k.id,{x:k.data.x,y:k.data.y})}),[2,{nodes:w,edges:l}]):[2,Wr(t,r,s)]})})},o}(),Ya=function(o){var r=-999999;o.forEach(function(t){t.forEach(function(e){e!==1/0&&r<e&&(r=e)})}),o.forEach(function(t,e){t.forEach(function(n,i){n===1/0&&(o[e][i]=r)})})},Ka=function(o){var r=Kt.mul(Kt.pow(o,2),-.5),t=r.mean("row"),e=r.mean("column"),n=r.mean();r.add(n).subRowVector(t).subColumnVector(e);var i=new $a(r),s=Kt.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map(function(u){return Kt.mul([u],[s]).toJSON()[0].splice(0,2)})},N={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},et=function(o,r,t,e,n,i){r.forEach(function(s,u){t[u]={x:0,y:0},r.forEach(function(c,h){if(u!==h&&n[u]===n[h]){var l=s.x-c.x,E=s.y-c.y,R=Math.sqrt(l*l+E*E);if(R===0){R=1;var _=u>h?1:-1;l=.01*_,E=.01*_}if(R<i(o[u])/2+i(o[h])/2){var M=e*e/R;t[u].x+=l/R*M,t[u].y+=E/R*M}}})})},mt=function(o,r,t,e,n,i,s,u){var c=i||s/10;return e&&r.forEach(function(h,l){var E=o[l].x-o[n].x,R=o[l].y-o[n].y,_=Math.sqrt(E*E+R*R),M=R/_,w=-E/_,L=Math.sqrt(h.x*h.x+h.y*h.y),k=Math.acos((M*h.x+w*h.y)/L);k>Math.PI/2&&(k-=Math.PI/2,M*=-1,w*=-1);var P=Math.cos(k)*L;h.x=M*P,h.y=w*P}),o.forEach(function(h,l){if(l!==n){var E=Math.sqrt(r[l].x*r[l].x+r[l].y*r[l].y);if(E>0&&l!==n){var R=Math.min(c*(t/800),E);if(h.x+=r[l].x/E*R,h.y+=r[l].y/E*R,e){var _=h.x-o[n].x,M=h.y-o[n].y,w=Math.sqrt(_*_+M*M);_=_/w*u[l],M=M/w*u[l],h.x=o[n].x+_,h.y=o[n].y+M}}}}),o},Ot={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},Ct=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="radial",this.options=y(y({},Ot),r)}return o.prototype.execute=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return[2,this.genericRadialLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return this.genericRadialLayout(!0,r,t),[2]})})},o.prototype.genericRadialLayout=function(r,t,e){return Y(this,void 0,void 0,function(){var n,i,s,u,c,h,l,E,R,_,M,w,L,k,P,wt,gt,dt,X,ot,ht,nt,b,C,Z,W,xt,A,d,S,G,rt,it,g,v,f,m,j,H,p,D,B,I;return yt(this,function(q){if(n=y(y({},this.options),e),i=n.width,s=n.height,u=n.center,c=n.focusNode,h=n.unitRadius,l=n.nodeSize,E=n.nodeSpacing,R=n.strictRadial,_=n.preventOverlap,M=n.maxPreventOverlapIteration,w=n.sortBy,L=n.linkDistance,k=L===void 0?50:L,P=n.sortStrength,wt=P===void 0?10:P,gt=n.maxIteration,dt=gt===void 0?1e3:gt,X=t.getAllNodes(),ot=t.getAllEdges(),ht=i||typeof window>"u"?i:window.innerWidth,nt=s||typeof window>"u"?s:window.innerHeight,b=u||[ht/2,nt/2],!(X!=null&&X.length)||X.length===1)return[2,Wr(t,r,b)];if(C=X[0],kr(c)){for(Z=0;Z<X.length;Z++)if(X[Z].id===c){C=X[Z];break}}else C=c||X[0];return W=Zt(X,C.id),xt=He({nodes:X,edges:ot},!1),A=me(xt),d=qt(A,W),$t(A,W,d+1),S=A[W],G=ht-b[0]>b[0]?b[0]:ht-b[0],rt=nt-b[1]>b[1]?b[1]:nt-b[1],G===0&&(G=ht/2),rt===0&&(rt=nt/2),it=Math.min(G,rt),g=Math.max.apply(Math,St([],_t(S))),v=[],f=h||it/g,S.forEach(function(Q,tt){v[tt]=Q*f}),m=Ut(X,A,k,v,f,w,wt),j=zt(m),H=function(Q,tt,z){try{var $=Kt.mul(Kt.pow(tt,2),-.5),st=$.mean("row"),pt=$.mean("column"),ct=$.mean();$.add(ct).subRowVector(st).subColumnVector(pt);var vt=new $a($),Nt=Kt.sqrt(vt.diagonalMatrix).diagonal();return vt.leftSingularVectors.toJSON().map(function(Et){return Kt.mul([Et],[Nt]).toJSON()[0].splice(0,Q)})}catch{for(var ut=[],T=0;T<tt.length;T++){var V=Math.random()*z,J=Math.random()*z;ut.push([V,J])}return ut}}(k,m,k),p=H.map(function(Q){var tt=_t(Q,2),z=tt[0],$=tt[1];return{x:(isNaN(z)?Math.random()*k:z)-H[W][0],y:(isNaN($)?Math.random()*k:$)-H[W][1]}}),this.run(dt,p,j,m,v,W),_&&(D=Ir(l,E),B={nodes:X,nodeSizeFunc:D,positions:p,radii:v,height:nt,width:ht,strictRadial:!!R,focusIdx:W,iterations:M||200,k:p.length/4.5},p=function(Q,tt){for(var z=y(y({},N),tt),$=z.positions,st=z.iterations,pt=z.width,ct=z.k,vt=z.speed,Nt=vt===void 0?100:vt,ut=z.strictRadial,T=z.focusIdx,V=z.radii,J=V===void 0?[]:V,Et=z.nodeSizeFunc,Pt=Q.getAllNodes(),Gt=[],Xt=pt/10,se=0;se<st;se++)$.forEach(function(pe,Ee){Gt[Ee]={x:0,y:0}}),et(Pt,$,Gt,ct,J,Et),mt($,Gt,Nt,ut,T,Xt,pt,J);return $}(t,B)),I=[],p.forEach(function(Q,tt){var z=qe(X[tt]);z.data.x=Q.x+b[0],z.data.y=Q.y+b[1],I.push(z)}),r&&I.forEach(function(Q){return t.mergeNodeData(Q.id,{x:Q.data.x,y:Q.data.y})}),[2,{nodes:I,edges:ot}]})})},o.prototype.run=function(r,t,e,n,i,s){for(var u=0;u<=r;u++){var c=u/r;this.oneIteration(c,t,i,n,e,s)}},o.prototype.oneIteration=function(r,t,e,n,i,s){var u=1-r;t.forEach(function(c,h){var l=Mr(c,{x:0,y:0}),E=l===0?0:1/l;if(h!==s){var R=0,_=0,M=0;t.forEach(function(L,k){if(h!==k){var P=Mr(c,L),wt=P===0?0:1/P,gt=n[k][h];M+=i[h][k],R+=i[h][k]*(L.x+gt*(c.x-L.x)*wt),_+=i[h][k]*(L.y+gt*(c.y-L.y)*wt)}});var w=e[h]===0?0:1/e[h];M*=u,M+=r*w*w,R*=u,R+=r*w*c.x*E,c.x=R/M,_*=u,_+=r*w*c.y*E,c.y=_/M}})},o}(),Ut=function(o,r,t,e,n,i,s){if(!o)return[];var u=[];if(r){var c={};r.forEach(function(h,l){var E=[];h.forEach(function(R,_){var M,w;if(l===_)E.push(0);else if(e[l]===e[_])if(i==="data")E.push(R*(Math.abs(l-_)*s)/(e[l]/n));else if(i){var L=void 0,k=void 0;if(c[o[l].id])L=c[o[l].id];else{var P=(i==="id"?o[l].id:(M=o[l].data)===null||M===void 0?void 0:M[i])||0;L=kr(P)?P.charCodeAt(0):P,c[o[l].id]=L}c[o[_].id]?k=c[o[_].id]:(P=(i==="id"?o[_].id:(w=o[_].data)===null||w===void 0?void 0:w[i])||0,k=kr(P)?P.charCodeAt(0):P,c[o[_].id]=k),E.push(R*(Math.abs(L-k)*s)/(e[l]/n))}else E.push(R*t/(e[l]/n));else{var wt=(t+n)/2;E.push(R*wt)}}),u.push(E)})}return u},zt=function(o){for(var r=o.length,t=o[0].length,e=[],n=0;n<r;n++){for(var i=[],s=0;s<t;s++)o[n][s]!==0?i.push(1/(o[n][s]*o[n][s])):i.push(0);e.push(i)}return e},Zt=function(o,r){var t=-1;return o.forEach(function(e,n){e.id===r&&(t=n)}),Math.max(t,0)},$t=function(o,r,t){for(var e=o.length,n=0;n<e;n++)if(o[r][n]===1/0){o[r][n]=t,o[n][r]=t;for(var i=0;i<e;i++)o[n][i]!==1/0&&o[r][i]===1/0&&(o[r][i]=t+o[n][i],o[i][r]=t+o[n][i])}for(n=0;n<e;n++)if(n!==r){for(i=0;i<e;i++)if(o[n][i]===1/0){var s=Math.abs(o[r][n]-o[r][i]);s=s===0?1:s,o[n][i]=s}}},qt=function(o,r){for(var t=0,e=0;e<o[r].length;e++)o[r][e]!==1/0&&(t=o[r][e]>t?o[r][e]:t);return t},Wt={center:[0,0],width:300,height:300},Yt=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="random",this.options=y(y({},Wt),r)}return o.prototype.execute=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return[2,this.genericRandomLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return Y(this,void 0,void 0,function(){return yt(this,function(e){return this.genericRandomLayout(!0,r,t),[2]})})},o.prototype.genericRandomLayout=function(r,t,e){return Y(this,void 0,void 0,function(){var n,i,s,u,c,h,l,E,R;return yt(this,function(_){return n=y(y({},this.options),e),i=n.center,s=n.width,u=n.height,c=t.getAllNodes(),h=s||typeof window>"u"?s:window.innerWidth,l=u||typeof window>"u"?u:window.innerHeight,E=i||[h/2,l/2],R=[],c&&c.forEach(function(M){R.push({id:M.id,data:{x:.9*(Math.random()-.5)*h+E[0],y:.9*(Math.random()-.5)*l+E[1]}})}),r&&R.forEach(function(M){return t.mergeNodeData(M.id,{x:M.data.x,y:M.data.y})}),[2,{nodes:R,edges:t.getAllEdges()}]})})},o}(),ne={circular:Mn,concentric:_r,mds:aa,random:Yt,grid:ra,radial:Ct,force:Uo,d3force:Ia,fruchterman:vo,forceAtlas2:po,dagre:Va};function oe(o,r){ne[o]=r}function he(o){return!!o.tick&&!!o.stop}})();var Rt=F.ul,Bt=F.jE;function ye(a,lt,y,at,Y,yt,_t){try{var St=a[yt](_t),It=St.value}catch(kt){return void y(kt)}St.done?lt(It):Promise.resolve(It).then(at,Y)}function Ae(a){return function(){var lt=this,y=arguments;return new Promise(function(at,Y){var yt=a.apply(lt,y);function _t(It){ye(yt,at,Y,_t,St,"next",It)}function St(It){ye(yt,at,Y,_t,St,"throw",It)}_t(void 0)})}}function de(a){return de=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(lt){return typeof lt}:function(lt){return lt&&typeof Symbol=="function"&&lt.constructor===Symbol&&lt!==Symbol.prototype?"symbol":typeof lt},de(a)}function re(a){var lt=function(y,at){if(de(y)!=="object"||y===null)return y;var Y=y[Symbol.toPrimitive];if(Y!==void 0){var yt=Y.call(y,"string");if(de(yt)!=="object")return yt;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(y)}(a);return de(lt)==="symbol"?lt:String(lt)}function Dt(a,lt,y){return(lt=re(lt))in a?Object.defineProperty(a,lt,{value:y,enumerable:!0,configurable:!0,writable:!0}):a[lt]=y,a}function we(a,lt){if(!(a instanceof lt))throw new TypeError("Cannot call a class as a function")}function $e(a,lt){for(var y=0;y<lt.length;y++){var at=lt[y];at.enumerable=at.enumerable||!1,at.configurable=!0,"value"in at&&(at.writable=!0),Object.defineProperty(a,re(at.key),at)}}function le(a,lt,y){return lt&&$e(a.prototype,lt),y&&$e(a,y),Object.defineProperty(a,"prototype",{writable:!1}),a}var At,We=hr(922),fe=hr.n(We),ve=hr(224),be=hr.n(ve),Ge=hr(589),Qt=hr.n(Ge),ee=hr(279),bt=hr.n(ee),wr=1;function Or(){return wr++}(function(a){a[a.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",a[a.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",a[a.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",a[a.POINTS=0]="POINTS",a[a.LINES=1]="LINES",a[a.LINE_LOOP=2]="LINE_LOOP",a[a.LINE_STRIP=3]="LINE_STRIP",a[a.TRIANGLES=4]="TRIANGLES",a[a.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",a[a.TRIANGLE_FAN=6]="TRIANGLE_FAN",a[a.ZERO=0]="ZERO",a[a.ONE=1]="ONE",a[a.SRC_COLOR=768]="SRC_COLOR",a[a.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",a[a.SRC_ALPHA=770]="SRC_ALPHA",a[a.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",a[a.DST_ALPHA=772]="DST_ALPHA",a[a.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",a[a.DST_COLOR=774]="DST_COLOR",a[a.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",a[a.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",a[a.FUNC_ADD=32774]="FUNC_ADD",a[a.BLEND_EQUATION=32777]="BLEND_EQUATION",a[a.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",a[a.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",a[a.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",a[a.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",a[a.MAX_EXT=32776]="MAX_EXT",a[a.MIN_EXT=32775]="MIN_EXT",a[a.BLEND_DST_RGB=32968]="BLEND_DST_RGB",a[a.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",a[a.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",a[a.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",a[a.CONSTANT_COLOR=32769]="CONSTANT_COLOR",a[a.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",a[a.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",a[a.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",a[a.BLEND_COLOR=32773]="BLEND_COLOR",a[a.ARRAY_BUFFER=34962]="ARRAY_BUFFER",a[a.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",a[a.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",a[a.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",a[a.STREAM_DRAW=35040]="STREAM_DRAW",a[a.STATIC_DRAW=35044]="STATIC_DRAW",a[a.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",a[a.BUFFER_SIZE=34660]="BUFFER_SIZE",a[a.BUFFER_USAGE=34661]="BUFFER_USAGE",a[a.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",a[a.FRONT=1028]="FRONT",a[a.BACK=1029]="BACK",a[a.FRONT_AND_BACK=1032]="FRONT_AND_BACK",a[a.CULL_FACE=2884]="CULL_FACE",a[a.BLEND=3042]="BLEND",a[a.DITHER=3024]="DITHER",a[a.STENCIL_TEST=2960]="STENCIL_TEST",a[a.DEPTH_TEST=2929]="DEPTH_TEST",a[a.SCISSOR_TEST=3089]="SCISSOR_TEST",a[a.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",a[a.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",a[a.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",a[a.NO_ERROR=0]="NO_ERROR",a[a.INVALID_ENUM=1280]="INVALID_ENUM",a[a.INVALID_VALUE=1281]="INVALID_VALUE",a[a.INVALID_OPERATION=1282]="INVALID_OPERATION",a[a.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",a[a.CW=2304]="CW",a[a.CCW=2305]="CCW",a[a.LINE_WIDTH=2849]="LINE_WIDTH",a[a.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",a[a.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",a[a.CULL_FACE_MODE=2885]="CULL_FACE_MODE",a[a.FRONT_FACE=2886]="FRONT_FACE",a[a.DEPTH_RANGE=2928]="DEPTH_RANGE",a[a.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",a[a.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",a[a.DEPTH_FUNC=2932]="DEPTH_FUNC",a[a.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",a[a.STENCIL_FUNC=2962]="STENCIL_FUNC",a[a.STENCIL_FAIL=2964]="STENCIL_FAIL",a[a.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",a[a.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",a[a.STENCIL_REF=2967]="STENCIL_REF",a[a.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",a[a.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",a[a.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",a[a.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",a[a.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",a[a.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",a[a.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",a[a.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",a[a.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",a[a.VIEWPORT=2978]="VIEWPORT",a[a.SCISSOR_BOX=3088]="SCISSOR_BOX",a[a.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",a[a.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",a[a.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",a[a.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",a[a.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",a[a.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",a[a.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",a[a.RED_BITS=3410]="RED_BITS",a[a.GREEN_BITS=3411]="GREEN_BITS",a[a.BLUE_BITS=3412]="BLUE_BITS",a[a.ALPHA_BITS=3413]="ALPHA_BITS",a[a.DEPTH_BITS=3414]="DEPTH_BITS",a[a.STENCIL_BITS=3415]="STENCIL_BITS",a[a.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",a[a.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",a[a.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",a[a.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",a[a.SAMPLES=32937]="SAMPLES",a[a.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",a[a.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",a[a.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",a[a.DONT_CARE=4352]="DONT_CARE",a[a.FASTEST=4353]="FASTEST",a[a.NICEST=4354]="NICEST",a[a.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",a[a.BYTE=5120]="BYTE",a[a.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",a[a.SHORT=5122]="SHORT",a[a.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",a[a.INT=5124]="INT",a[a.UNSIGNED_INT=5125]="UNSIGNED_INT",a[a.FLOAT=5126]="FLOAT",a[a.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",a[a.ALPHA=6406]="ALPHA",a[a.RGB=6407]="RGB",a[a.RGBA=6408]="RGBA",a[a.LUMINANCE=6409]="LUMINANCE",a[a.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",a[a.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",a[a.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",a[a.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",a[a.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",a[a.VERTEX_SHADER=35633]="VERTEX_SHADER",a[a.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",a[a.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",a[a.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",a[a.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",a[a.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",a[a.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",a[a.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",a[a.SHADER_TYPE=35663]="SHADER_TYPE",a[a.DELETE_STATUS=35712]="DELETE_STATUS",a[a.LINK_STATUS=35714]="LINK_STATUS",a[a.VALIDATE_STATUS=35715]="VALIDATE_STATUS",a[a.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",a[a.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",a[a.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",a[a.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",a[a.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",a[a.NEVER=512]="NEVER",a[a.LESS=513]="LESS",a[a.EQUAL=514]="EQUAL",a[a.LEQUAL=515]="LEQUAL",a[a.GREATER=516]="GREATER",a[a.NOTEQUAL=517]="NOTEQUAL",a[a.GEQUAL=518]="GEQUAL",a[a.ALWAYS=519]="ALWAYS",a[a.KEEP=7680]="KEEP",a[a.REPLACE=7681]="REPLACE",a[a.INCR=7682]="INCR",a[a.DECR=7683]="DECR",a[a.INVERT=5386]="INVERT",a[a.INCR_WRAP=34055]="INCR_WRAP",a[a.DECR_WRAP=34056]="DECR_WRAP",a[a.VENDOR=7936]="VENDOR",a[a.RENDERER=7937]="RENDERER",a[a.VERSION=7938]="VERSION",a[a.NEAREST=9728]="NEAREST",a[a.LINEAR=9729]="LINEAR",a[a.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",a[a.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",a[a.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",a[a.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",a[a.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",a[a.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",a[a.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",a[a.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",a[a.TEXTURE_2D=3553]="TEXTURE_2D",a[a.TEXTURE=5890]="TEXTURE",a[a.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",a[a.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",a[a.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",a[a.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",a[a.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",a[a.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",a[a.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",a[a.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",a[a.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",a[a.TEXTURE0=33984]="TEXTURE0",a[a.TEXTURE1=33985]="TEXTURE1",a[a.TEXTURE2=33986]="TEXTURE2",a[a.TEXTURE3=33987]="TEXTURE3",a[a.TEXTURE4=33988]="TEXTURE4",a[a.TEXTURE5=33989]="TEXTURE5",a[a.TEXTURE6=33990]="TEXTURE6",a[a.TEXTURE7=33991]="TEXTURE7",a[a.TEXTURE8=33992]="TEXTURE8",a[a.TEXTURE9=33993]="TEXTURE9",a[a.TEXTURE10=33994]="TEXTURE10",a[a.TEXTURE11=33995]="TEXTURE11",a[a.TEXTURE12=33996]="TEXTURE12",a[a.TEXTURE13=33997]="TEXTURE13",a[a.TEXTURE14=33998]="TEXTURE14",a[a.TEXTURE15=33999]="TEXTURE15",a[a.TEXTURE16=34e3]="TEXTURE16",a[a.TEXTURE17=34001]="TEXTURE17",a[a.TEXTURE18=34002]="TEXTURE18",a[a.TEXTURE19=34003]="TEXTURE19",a[a.TEXTURE20=34004]="TEXTURE20",a[a.TEXTURE21=34005]="TEXTURE21",a[a.TEXTURE22=34006]="TEXTURE22",a[a.TEXTURE23=34007]="TEXTURE23",a[a.TEXTURE24=34008]="TEXTURE24",a[a.TEXTURE25=34009]="TEXTURE25",a[a.TEXTURE26=34010]="TEXTURE26",a[a.TEXTURE27=34011]="TEXTURE27",a[a.TEXTURE28=34012]="TEXTURE28",a[a.TEXTURE29=34013]="TEXTURE29",a[a.TEXTURE30=34014]="TEXTURE30",a[a.TEXTURE31=34015]="TEXTURE31",a[a.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",a[a.REPEAT=10497]="REPEAT",a[a.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",a[a.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",a[a.FLOAT_VEC2=35664]="FLOAT_VEC2",a[a.FLOAT_VEC3=35665]="FLOAT_VEC3",a[a.FLOAT_VEC4=35666]="FLOAT_VEC4",a[a.INT_VEC2=35667]="INT_VEC2",a[a.INT_VEC3=35668]="INT_VEC3",a[a.INT_VEC4=35669]="INT_VEC4",a[a.BOOL=35670]="BOOL",a[a.BOOL_VEC2=35671]="BOOL_VEC2",a[a.BOOL_VEC3=35672]="BOOL_VEC3",a[a.BOOL_VEC4=35673]="BOOL_VEC4",a[a.FLOAT_MAT2=35674]="FLOAT_MAT2",a[a.FLOAT_MAT3=35675]="FLOAT_MAT3",a[a.FLOAT_MAT4=35676]="FLOAT_MAT4",a[a.SAMPLER_2D=35678]="SAMPLER_2D",a[a.SAMPLER_CUBE=35680]="SAMPLER_CUBE",a[a.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",a[a.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",a[a.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",a[a.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",a[a.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",a[a.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",a[a.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",a[a.COMPILE_STATUS=35713]="COMPILE_STATUS",a[a.LOW_FLOAT=36336]="LOW_FLOAT",a[a.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",a[a.HIGH_FLOAT=36338]="HIGH_FLOAT",a[a.LOW_INT=36339]="LOW_INT",a[a.MEDIUM_INT=36340]="MEDIUM_INT",a[a.HIGH_INT=36341]="HIGH_INT",a[a.FRAMEBUFFER=36160]="FRAMEBUFFER",a[a.RENDERBUFFER=36161]="RENDERBUFFER",a[a.RGBA4=32854]="RGBA4",a[a.RGB5_A1=32855]="RGB5_A1",a[a.RGB565=36194]="RGB565",a[a.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",a[a.STENCIL_INDEX=6401]="STENCIL_INDEX",a[a.STENCIL_INDEX8=36168]="STENCIL_INDEX8",a[a.DEPTH_STENCIL=34041]="DEPTH_STENCIL",a[a.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",a[a.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",a[a.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",a[a.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",a[a.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",a[a.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",a[a.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",a[a.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",a[a.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",a[a.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",a[a.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",a[a.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",a[a.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",a[a.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",a[a.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",a[a.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",a[a.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",a[a.NONE=0]="NONE",a[a.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",a[a.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",a[a.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",a[a.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",a[a.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",a[a.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",a[a.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",a[a.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",a[a.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",a[a.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",a[a.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",a[a.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",a[a.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",a[a.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",a[a.COPY_SRC=1]="COPY_SRC",a[a.COPY_DST=2]="COPY_DST",a[a.SAMPLED=4]="SAMPLED",a[a.STORAGE=8]="STORAGE",a[a.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(At||(At={}));var O,Br,Le,Er,tn=function(){function a(){we(this,a),this.config=void 0}return le(a,[{key:"get",value:function(){return this.config}},{key:"set",value:function(lt){this.config=lt}}]),a}();function Vt(){if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Lt(a,lt){var y=Object.keys(a);if(Object.getOwnPropertySymbols){var at=Object.getOwnPropertySymbols(a);lt&&(at=at.filter(function(Y){return Object.getOwnPropertyDescriptor(a,Y).enumerable})),y.push.apply(y,at)}return y}function Ht(a){for(var lt=1;lt<arguments.length;lt++){var y=arguments[lt]!=null?arguments[lt]:{};lt%2?Lt(Object(y),!0).forEach(function(at){Dt(a,at,y[at])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(y)):Lt(Object(y)).forEach(function(at){Object.defineProperty(a,at,Object.getOwnPropertyDescriptor(y,at))})}return a}(function(a){a.Void="Void",a.Boolean="Boolean",a.Float="Float",a.Uint32="Uint32",a.Int32="Int32",a.Vector="Vector",a.Vector2Float="vec2<f32>",a.Vector3Float="vec3<f32>",a.Vector4Float="vec4<f32>",a.Vector2Boolean="vec2<bool>",a.Vector3Boolean="vec3<bool>",a.Vector4Boolean="vec4<bool>",a.Vector2Uint="vec2<u32>",a.Vector3Uint="vec3<u32>",a.Vector4Uint="vec4<u32>",a.Vector2Int="vec2<i32>",a.Vector3Int="vec3<i32>",a.Vector4Int="vec4<i32>",a.Matrix="Matrix",a.Matrix3x3Float="mat3x3<f32>",a.Matrix4x4Float="mat4x4<i32>",a.Struct="Struct",a.FloatArray="Float[]",a.Vector4FloatArray="vec4<f32>[]"})(O||(O={})),function(a){a.Program="Program",a.Identifier="Identifier",a.VariableDeclaration="VariableDeclaration",a.BlockStatement="BlockStatement",a.ReturnStatement="ReturnStatement",a.FunctionDeclaration="FunctionDeclaration",a.VariableDeclarator="VariableDeclarator",a.AssignmentExpression="AssignmentExpression",a.LogicalExpression="LogicalExpression",a.BinaryExpression="BinaryExpression",a.ArrayExpression="ArrayExpression",a.UnaryExpression="UnaryExpression",a.UpdateExpression="UpdateExpression",a.FunctionExpression="FunctionExpression",a.MemberExpression="MemberExpression",a.ConditionalExpression="ConditionalExpression",a.ExpressionStatement="ExpressionStatement",a.CallExpression="CallExpression",a.NumThreadStatement="NumThreadStatement",a.StorageStatement="StorageStatement",a.DoWhileStatement="DoWhileStatement",a.WhileStatement="WhileStatement",a.ForStatement="ForStatement",a.BreakStatement="BreakStatement",a.ContinueStatement="ContinueStatement",a.IfStatement="IfStatement",a.ImportedFunctionStatement="ImportedFunctionStatement"}(Br||(Br={})),function(a){a.Input="Input",a.Output="Output",a.Uniform="Uniform",a.Workgroup="Workgroup",a.UniformConstant="UniformConstant",a.Image="Image",a.StorageBuffer="StorageBuffer",a.Private="Private",a.Function="Function"}(Le||(Le={})),function(a){a.GLSL100="GLSL100",a.GLSL450="GLSL450",a.WGSL="WGSL"}(Er||(Er={}));var ue,ie,Ne,Me,Te,er,Xr,Ce,sr,ln,vr,en,fr,Cr,Ko=function(){function a(Y,yt){we(this,a),this.engine=Y,this.configService=yt,this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}var lt,y,at;return le(a,[{key:"init",value:function(){var Y=this.configService.get(),yt=Y.canvas,_t=Y.engineOptions;this.initPromise=this.engine.init(Ht({canvas:yt||Vt(),antialiasing:!1},_t))}},{key:"setBundle",value:function(Y){this.compiledBundle=JSON.parse(JSON.stringify(Y))}},{key:"setDispatch",value:function(Y){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=Y),this}},{key:"setMaxIteration",value:function(Y){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=Y),this}},{key:"setBinding",value:function(Y,yt){var _t=this;if(typeof Y=="string"){var St=be()(yt)||fe()(yt)||Qt()(yt);if(this.compiledBundle&&this.compiledBundle.context){var It=this.compiledBundle.context.defines.find(function(Tt){return Tt.name===Y});if(It)return It.value=yt,this;var kt=this.compiledBundle.context.uniforms.find(function(Tt){return Tt.name===Y});kt&&(St?(kt.data=yt,kt.isReferer=!1,kt.storageClass===Le.Uniform?this.model&&this.model.updateUniform(Y,yt):this.model&&this.model.updateBuffer(Y,yt)):(kt.isReferer=!0,kt.data=yt))}}else Object.keys(Y).forEach(function(Tt){_t.setBinding(Tt,Y[Tt])});return this}},{key:"execute",value:(at=Ae(bt().mark(function Y(){var yt,_t,St=this,It=arguments;return bt().wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:if(yt=It.length>0&&It[0]!==void 0?It[0]:1,!this.dirty){kt.next=6;break}return this.compiledBundle.context&&(yt>1?this.compiledBundle.context.maxIteration=yt:this.compiledBundle.context.maxIteration++),kt.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter(function(Tt){return Tt.isReferer}).forEach(function(Tt){var ae=Tt.data,te=Tt.name;St.model.confirmInput(ae.model,te)}),_t=0;_t<yt;_t++)this.model.run();return this.engine.endFrame(),kt.abrupt("return",this);case 12:case"end":return kt.stop()}},Y,this)})),function(){return at.apply(this,arguments)})},{key:"getOutput",value:(y=Ae(bt().mark(function Y(){return bt().wrap(function(yt){for(;;)switch(yt.prev=yt.next){case 0:return yt.abrupt("return",this.model.readData());case 1:case"end":return yt.stop()}},Y,this)})),function(){return y.apply(this,arguments)})},{key:"compile",value:(lt=Ae(bt().mark(function Y(){var yt,_t,St;return bt().wrap(function(It){for(;;)switch(It.prev=It.next){case 0:return It.next=2,this.initPromise;case 2:return yt=Ht({},this.compiledBundle.context),_t=this.engine.supportWebGPU?this.engine.useWGSL?Er.WGSL:Er.GLSL450:Er.GLSL100,St=this.compiledBundle.shaders[_t],yt.defines.filter(function(kt){return kt.runtime}).forEach(function(kt){var Tt="".concat("__DefineValuePlaceholder__").concat(kt.name);St=St.replace(Tt,"".concat(kt.value))}),yt.shader=St,yt.uniforms.forEach(function(kt){if(!kt.data&&kt.storageClass===Le.StorageBuffer){var Tt=1;kt.type===O.FloatArray?Tt=1:kt.type===O.Vector4FloatArray&&(Tt=4),kt.data=new Float32Array(yt.output.length*Tt).fill(0)}}),this.compiledBundle.context=yt,It.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=It.sent;case 12:case"end":return It.stop()}},Y,this)})),function(){return lt.apply(this,arguments)})}]),a}(),da=hr(919),la=hr.n(da),Ei=function(){function a(lt,y){we(this,a),this.attribute=void 0,this.buffer=void 0;var at=y.buffer,Y=y.offset,yt=y.stride,_t=y.normalized,St=y.size,It=y.divisor;this.buffer=at,this.attribute={buffer:at.get(),offset:Y||0,stride:yt||0,normalized:_t||!1,divisor:It||0},St&&(this.attribute.size=St)}return le(a,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(lt){this.buffer.subData(lt)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),a}(),Pn=(Dt(ue={},At.POINTS,"points"),Dt(ue,At.LINES,"lines"),Dt(ue,At.LINE_LOOP,"line loop"),Dt(ue,At.LINE_STRIP,"line strip"),Dt(ue,At.TRIANGLES,"triangles"),Dt(ue,At.TRIANGLE_FAN,"triangle fan"),Dt(ue,At.TRIANGLE_STRIP,"triangle strip"),ue),bo=(Dt(ie={},At.STATIC_DRAW,"static"),Dt(ie,At.DYNAMIC_DRAW,"dynamic"),Dt(ie,At.STREAM_DRAW,"stream"),ie),No=(Dt(Ne={},At.BYTE,"int8"),Dt(Ne,At.UNSIGNED_INT,"int16"),Dt(Ne,At.INT,"int32"),Dt(Ne,At.UNSIGNED_BYTE,"uint8"),Dt(Ne,At.UNSIGNED_SHORT,"uint16"),Dt(Ne,At.UNSIGNED_INT,"uint32"),Dt(Ne,At.FLOAT,"float"),Ne),ha=(Dt(Me={},At.ALPHA,"alpha"),Dt(Me,At.LUMINANCE,"luminance"),Dt(Me,At.LUMINANCE_ALPHA,"luminance alpha"),Dt(Me,At.RGB,"rgb"),Dt(Me,At.RGBA,"rgba"),Dt(Me,At.RGBA4,"rgba4"),Dt(Me,At.RGB5_A1,"rgb5 a1"),Dt(Me,At.RGB565,"rgb565"),Dt(Me,At.DEPTH_COMPONENT,"depth"),Dt(Me,At.DEPTH_STENCIL,"depth stencil"),Me),fa=(Dt(Te={},At.DONT_CARE,"dont care"),Dt(Te,At.NICEST,"nice"),Dt(Te,At.FASTEST,"fast"),Te),ga=(Dt(er={},At.NEAREST,"nearest"),Dt(er,At.LINEAR,"linear"),Dt(er,At.LINEAR_MIPMAP_LINEAR,"mipmap"),Dt(er,At.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),Dt(er,At.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),Dt(er,At.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),er),Zo=(Dt(Xr={},At.REPEAT,"repeat"),Dt(Xr,At.CLAMP_TO_EDGE,"clamp"),Dt(Xr,At.MIRRORED_REPEAT,"mirror"),Xr),xi=(Dt(Ce={},At.NONE,"none"),Dt(Ce,At.BROWSER_DEFAULT_WEBGL,"browser"),Ce),Sn=(Dt(sr={},At.NEVER,"never"),Dt(sr,At.ALWAYS,"always"),Dt(sr,At.LESS,"less"),Dt(sr,At.LEQUAL,"lequal"),Dt(sr,At.GREATER,"greater"),Dt(sr,At.GEQUAL,"gequal"),Dt(sr,At.EQUAL,"equal"),Dt(sr,At.NOTEQUAL,"notequal"),sr),_o=(Dt(ln={},At.FUNC_ADD,"add"),Dt(ln,At.MIN_EXT,"min"),Dt(ln,At.MAX_EXT,"max"),Dt(ln,At.FUNC_SUBTRACT,"subtract"),Dt(ln,At.FUNC_REVERSE_SUBTRACT,"reverse subtract"),ln),Ao=(Dt(vr={},At.ZERO,"zero"),Dt(vr,At.ONE,"one"),Dt(vr,At.SRC_COLOR,"src color"),Dt(vr,At.ONE_MINUS_SRC_COLOR,"one minus src color"),Dt(vr,At.SRC_ALPHA,"src alpha"),Dt(vr,At.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),Dt(vr,At.DST_COLOR,"dst color"),Dt(vr,At.ONE_MINUS_DST_COLOR,"one minus dst color"),Dt(vr,At.DST_ALPHA,"dst alpha"),Dt(vr,At.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),Dt(vr,At.CONSTANT_COLOR,"constant color"),Dt(vr,At.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),Dt(vr,At.CONSTANT_ALPHA,"constant alpha"),Dt(vr,At.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),Dt(vr,At.SRC_ALPHA_SATURATE,"src alpha saturate"),vr),pa=(Dt(en={},At.NEVER,"never"),Dt(en,At.ALWAYS,"always"),Dt(en,At.LESS,"less"),Dt(en,At.LEQUAL,"lequal"),Dt(en,At.GREATER,"greater"),Dt(en,At.GEQUAL,"gequal"),Dt(en,At.EQUAL,"equal"),Dt(en,At.NOTEQUAL,"notequal"),en),rn=(Dt(fr={},At.ZERO,"zero"),Dt(fr,At.KEEP,"keep"),Dt(fr,At.REPLACE,"replace"),Dt(fr,At.INVERT,"invert"),Dt(fr,At.INCR,"increment"),Dt(fr,At.DECR,"decrement"),Dt(fr,At.INCR_WRAP,"increment wrap"),Dt(fr,At.DECR_WRAP,"decrement wrap"),fr),is=(Dt(Cr={},At.FRONT,"front"),Dt(Cr,At.BACK,"back"),Cr),as=function(){function a(lt,y){we(this,a),this.buffer=void 0;var at=y.data,Y=y.usage,yt=y.type;this.buffer=lt.buffer({data:at,usage:bo[Y||At.STATIC_DRAW],type:No[yt||At.UNSIGNED_BYTE]})}return le(a,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(lt){var y=lt.data,at=lt.offset;this.buffer.subdata(y,at)}}]),a}();function Gn(a,lt){(lt==null||lt>a.length)&&(lt=a.length);for(var y=0,at=new Array(lt);y<lt;y++)at[y]=a[y];return at}function va(a,lt){var y=Object.keys(a);if(Object.getOwnPropertySymbols){var at=Object.getOwnPropertySymbols(a);lt&&(at=at.filter(function(Y){return Object.getOwnPropertyDescriptor(a,Y).enumerable})),y.push.apply(y,at)}return y}function Fn(a){for(var lt=1;lt<arguments.length;lt++){var y=arguments[lt]!=null?arguments[lt]:{};lt%2?va(Object(y),!0).forEach(function(at){Dt(a,at,y[at])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(y)):va(Object(y)).forEach(function(at){Object.defineProperty(a,at,Object.getOwnPropertyDescriptor(y,at))})}return a}var bi=0,Jn=function(){function a(y,at){var Y=this;we(this,a),this.reGl=y,this.context=at,this.entity=Or(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var yt={};this.context.uniforms.forEach(function(Tt){var ae=Tt.name,te=Tt.type,_e=Tt.data,ce=Tt.isReferer,Se=Tt.storageClass;if(Se===Le.StorageBuffer){if(ce)Y.textureCache[ae]={data:void 0},yt["".concat(ae,"Size")]=function(){return _e.compiledBundle.context.output.textureSize};else{Y.textureCache[ae]=Y.calcDataTexture(ae,te,_e);var jt=Y.textureCache[ae],me=jt.textureWidth,He=jt.isOutput;yt["".concat(ae,"Size")]=[me,me],He&&(Y.outputTextureName=ae,Y.context.needPingpong&&(Y.outputTextureName="".concat(ae,"Output"),Y.textureCache[Y.outputTextureName]=Y.calcDataTexture(ae,te,_e)))}yt[ae]=function(){return Y.textureCache[ae].texture}}else if(Se===Le.Uniform){if(_e&&(Array.isArray(_e)||fe()(_e))&&_e.length>16)throw new Error("invalid data type ".concat(te));yt[ae]=function(){return Tt.data}}});var _t=this.getOuputDataTexture(),St=_t.textureWidth,It=_t.texelCount;yt.u_OutputTextureSize=[St,St],yt.u_OutputTexelCount=It,this.context.output.textureSize=[St,St];var kt={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(this.context.shader),uniforms:yt,vert:`attribute vec3 a_Position;
attribute vec2 a_TexCoord;

varying vec2 v_TexCoord;

void main() {
  gl_Position = vec4(a_Position, 1.0);
  v_TexCoord = a_TexCoord;
}`,primitive:"triangle strip",count:4};this.computeCommand=this.reGl(kt)}var lt;return le(a,[{key:"run",value:function(){var y=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use(function(){y.computeCommand()})}},{key:"readData",value:(lt=Ae(bt().mark(function y(){var at,Y,yt,_t,St,It,kt,Tt,ae=this;return bt().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(this.reGl({framebuffer:this.texFBO})(function(){at=ae.reGl.read()}),!at){te.next=6;break}if(Y=this.getOuputDataTexture(),yt=Y.originalDataLength,_t=Y.elementsPerTexel,St=Y.typedArrayConstructor,It=St===void 0?Float32Array:St,kt=[],_t!==4)for(Tt=0;Tt<at.length;Tt+=4)_t===1?kt.push(at[Tt]):_t===2?kt.push(at[Tt],at[Tt+1]):kt.push(at[Tt],at[Tt+1],at[Tt+2]);else kt=at;return te.abrupt("return",new It(kt.slice(0,yt)));case 6:return te.abrupt("return",new Float32Array);case 7:case"end":return te.stop()}},y,this)})),function(){return lt.apply(this,arguments)})},{key:"confirmInput",value:function(y,at){var Y;this.entity===y.entity?(this.dynamicPingpong=!0,Y=this):Y=y,this.textureCache[at].id=Y.getOuputDataTexture().id,this.textureCache[at].texture=Y.getOuputDataTexture().texture}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(y,at){var Y=this.context.uniforms.find(function(It){return It.name===y});if(Y){var yt=this.calcDataTexture(y,Y.type,at),_t=yt.texture,St=yt.data;this.textureCache[y].data=St,this.textureCache[y].texture=_t}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var y=this.context.output.name;this.textureCache[y].id=this.getOuputDataTexture().id,this.textureCache[y].texture=this.getOuputDataTexture().texture}var at=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=at}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var y=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=y}},{key:"cloneDataTexture",value:function(y){var at=y.data,Y=y.textureWidth;return Fn(Fn({},y),{},{id:bi++,texture:this.reGl.texture({width:Y,height:Y,data:at,type:"float"})})}},{key:"calcDataTexture",value:function(y,at,Y){var yt=1;at===O.Vector4FloatArray&&(yt=4);for(var _t=[],St=0;St<Y.length;St+=yt)yt===1?_t.push(Y[St],0,0,0):yt===2?_t.push(Y[St],Y[St+1],0,0):yt===3?_t.push(Y[St],Y[St+1],Y[St+2],0):yt===4&&_t.push(Y[St],Y[St+1],Y[St+2],Y[St+3]);var It,kt=Y.length,Tt=Math.ceil(kt/yt),ae=Math.ceil(Math.sqrt(Tt)),te=ae*ae;Tt<te&&_t.push.apply(_t,function(ce){if(Array.isArray(ce))return Gn(ce)}(It=new Array(4*(te-Tt)).fill(0))||function(ce){if(typeof Symbol<"u"&&ce[Symbol.iterator]!=null||ce["@@iterator"]!=null)return Array.from(ce)}(It)||function(ce,Se){if(ce){if(typeof ce=="string")return Gn(ce,Se);var jt=Object.prototype.toString.call(ce).slice(8,-1);return jt==="Object"&&ce.constructor&&(jt=ce.constructor.name),jt==="Map"||jt==="Set"?Array.from(ce):jt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(jt)?Gn(ce,Se):void 0}}(It)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}());var _e=this.reGl.texture({width:ae,height:ae,data:_t,type:"float"});return{id:bi++,data:_t,originalDataLength:kt,typedArrayConstructor:fe()(Y)?Y.constructor:void 0,textureWidth:ae,texture:_e,texelCount:Tt,elementsPerTexel:yt,isOutput:y===this.context.output.name}}}]),a}(),ma=function(){function a(lt,y){we(this,a),this.elements=void 0;var at=y.data,Y=y.usage,yt=y.type,_t=y.count;this.elements=lt.elements({data:at,usage:bo[Y||At.STATIC_DRAW],type:No[yt||At.UNSIGNED_BYTE],count:_t})}return le(a,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(lt){var y=lt.data;this.elements.subdata(y)}},{key:"destroy",value:function(){this.elements.destroy()}}]),a}(),jn=function(){function a(lt,y){we(this,a),this.framebuffer=void 0;var at=y.width,Y=y.height,yt=y.color,_t=y.colors,St=(y.depth,y.stencil,{width:at,height:Y});Array.isArray(_t)&&(St.colors=_t.map(function(It){return It.get()})),yt&&typeof yt!="boolean"&&(St.color=yt.get()),this.framebuffer=lt.framebuffer(St)}return le(a,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(lt){var y=lt.width,at=lt.height;this.framebuffer.resize(y,at)}}]),a}(),Ni=hr(256),ss=hr.n(Ni);function _i(a){var lt={};return Object.keys(a).forEach(function(y){Qo(y,a[y],lt,"")}),lt}function Qo(a,lt,y,at){lt===null||typeof lt=="number"||typeof lt=="boolean"||Array.isArray(lt)&&typeof lt[0]=="number"||fe()(lt)||lt===""||lt.resize!==void 0?y["".concat(at&&at+".").concat(a)]=lt:(ss()(lt)&&Object.keys(lt).forEach(function(Y){Qo(Y,lt[Y],y,"".concat(at&&at+".").concat(a))}),Array.isArray(lt)&&lt.forEach(function(Y,yt){Object.keys(Y).forEach(function(_t){Qo(_t,Y[_t],y,"".concat(at&&at+".").concat(a,"[").concat(yt,"]"))})}))}function ya(a,lt){var y=Object.keys(a);if(Object.getOwnPropertySymbols){var at=Object.getOwnPropertySymbols(a);lt&&(at=at.filter(function(Y){return Object.getOwnPropertyDescriptor(a,Y).enumerable})),y.push.apply(y,at)}return y}function to(a){for(var lt=1;lt<arguments.length;lt++){var y=arguments[lt]!=null?arguments[lt]:{};lt%2?ya(Object(y),!0).forEach(function(at){Dt(a,at,y[at])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(y)):ya(Object(y)).forEach(function(at){Object.defineProperty(a,at,Object.getOwnPropertyDescriptor(y,at))})}return a}var wa=function(){function a(lt,y){we(this,a),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=lt;var at=y.vs,Y=y.fs,yt=y.defines,_t=y.attributes,St=y.uniforms,It=y.primitive,kt=y.count,Tt=y.elements,ae=y.depth,te=y.blend,_e=y.stencil,ce=y.cull,Se=y.instances,jt=y.scissor,me=y.viewport,He={};St&&(this.uniforms=_i(St),Object.keys(St).forEach(function(Ze){He[Ze]=lt.prop(Ze)}));var rr={};Object.keys(_t).forEach(function(Ze){rr[Ze]=_t[Ze].get()});var xr=yt&&this.generateDefines(yt)||"",Fe={attributes:rr,frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(xr,`
`).concat(Y),uniforms:He,vert:`
`.concat(xr,`
`).concat(at),primitive:Pn[It===void 0?At.TRIANGLES:It]};Se&&(Fe.instances=Se),kt&&(Fe.count=kt),Tt&&(Fe.elements=Tt.get()),jt&&(Fe.scissor=jt),me&&(Fe.viewport=me),this.initDepthDrawParams({depth:ae},Fe),this.initBlendDrawParams({blend:te},Fe),this.initStencilDrawParams({stencil:_e},Fe),this.initCullDrawParams({cull:ce},Fe),this.drawCommand=lt(Fe)}return le(a,[{key:"addUniforms",value:function(lt){this.uniforms=to(to({},this.uniforms),_i(lt))}},{key:"draw",value:function(lt){var y=to(to({},this.uniforms),_i(lt.uniforms||{})),at={};Object.keys(y).forEach(function(Y){var yt=de(y[Y]);yt==="boolean"||yt==="number"||Array.isArray(y[Y])||y[Y].BYTES_PER_ELEMENT?at[Y]=y[Y]:yt==="string"||(at[Y]=y[Y].get())}),this.drawCommand(at)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(lt,y){var at=lt.depth;at&&(y.depth={enable:at.enable===void 0||!!at.enable,mask:at.mask===void 0||!!at.mask,func:Sn[at.func||At.LESS],range:at.range||[0,1]})}},{key:"initBlendDrawParams",value:function(lt,y){var at=lt.blend;if(at){var Y=at.enable,yt=at.func,_t=at.equation,St=at.color,It=St===void 0?[0,0,0,0]:St;y.blend={enable:!!Y,func:{srcRGB:Ao[yt&&yt.srcRGB||At.SRC_ALPHA],srcAlpha:Ao[yt&&yt.srcAlpha||At.SRC_ALPHA],dstRGB:Ao[yt&&yt.dstRGB||At.ONE_MINUS_SRC_ALPHA],dstAlpha:Ao[yt&&yt.dstAlpha||At.ONE_MINUS_SRC_ALPHA]},equation:{rgb:_o[_t&&_t.rgb||At.FUNC_ADD],alpha:_o[_t&&_t.alpha||At.FUNC_ADD]},color:It}}}},{key:"initStencilDrawParams",value:function(lt,y){var at=lt.stencil;if(at){var Y=at.enable,yt=at.mask,_t=yt===void 0?-1:yt,St=at.func,It=St===void 0?{cmp:At.ALWAYS,ref:0,mask:-1}:St,kt=at.opFront,Tt=kt===void 0?{fail:At.KEEP,zfail:At.KEEP,zpass:At.KEEP}:kt,ae=at.opBack,te=ae===void 0?{fail:At.KEEP,zfail:At.KEEP,zpass:At.KEEP}:ae;y.stencil={enable:!!Y,mask:_t,func:to(to({},It),{},{cmp:pa[It.cmp]}),opFront:{fail:rn[Tt.fail],zfail:rn[Tt.zfail],zpass:rn[Tt.zpass]},opBack:{fail:rn[te.fail],zfail:rn[te.zfail],zpass:rn[te.zpass]}}}}},{key:"initCullDrawParams",value:function(lt,y){var at=lt.cull;if(at){var Y=at.enable,yt=at.face,_t=yt===void 0?At.BACK:yt;y.cull={enable:!!Y,face:is[_t]}}}},{key:"generateDefines",value:function(lt){return Object.keys(lt).map(function(y){return"#define ".concat(y," ").concat(Number(lt[y]))}).join(`
`)}}]),a}(),ur=function(){function a(lt,y){we(this,a),this.texture=void 0,this.width=void 0,this.height=void 0;var at=y.data,Y=y.type,yt=Y===void 0?At.UNSIGNED_BYTE:Y,_t=y.width,St=y.height,It=y.flipY,kt=It!==void 0&&It,Tt=y.format,ae=Tt===void 0?At.RGBA:Tt,te=y.mipmap,_e=te!==void 0&&te,ce=y.wrapS,Se=ce===void 0?At.CLAMP_TO_EDGE:ce,jt=y.wrapT,me=jt===void 0?At.CLAMP_TO_EDGE:jt,He=y.aniso,rr=He===void 0?0:He,xr=y.alignment,Fe=xr===void 0?1:xr,Ze=y.premultiplyAlpha,mr=Ze!==void 0&&Ze,Sr=y.mag,br=Sr===void 0?At.NEAREST:Sr,$r=y.min,Mr=$r===void 0?At.NEAREST:$r,gr=y.colorSpace,qe=gr===void 0?At.BROWSER_DEFAULT_WEBGL:gr;this.width=_t,this.height=St;var Qe={width:_t,height:St,type:No[yt],format:ha[ae],wrapS:Zo[Se],wrapT:Zo[me],mag:ga[br],min:ga[Mr],alignment:Fe,flipY:kt,colorSpace:xi[qe],premultiplyAlpha:mr,aniso:rr};at&&(Qe.data=at),typeof _e=="number"?Qe.mipmap=fa[_e]:typeof _e=="boolean"&&(Qe.mipmap=_e),this.texture=lt.texture(Qe)}return le(a,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(lt){var y=lt.width,at=lt.height;this.texture.resize(y,at),this.width=y,this.height=at}},{key:"destroy",value:function(){this.texture.destroy()}}]),a}(),Ea=function(){function a(){var y=this;we(this,a),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=function(){var at=Ae(bt().mark(function Y(yt){return bt().wrap(function(_t){for(;;)switch(_t.prev=_t.next){case 0:if(!yt.uniforms){_t.next=3;break}return _t.next=3,Promise.all(Object.keys(yt.uniforms).map(function(){var St=Ae(bt().mark(function It(kt){var Tt;return bt().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:if(!yt.uniforms[kt]||yt.uniforms[kt].load===void 0){ae.next=5;break}return ae.next=3,yt.uniforms[kt].load();case 3:Tt=ae.sent,yt.uniforms[kt]=Tt;case 5:case"end":return ae.stop()}},It)}));return function(It){return St.apply(this,arguments)}}()));case 3:return _t.abrupt("return",new wa(y.gl,yt));case 4:case"end":return _t.stop()}},Y)}));return function(Y){return at.apply(this,arguments)}}(),this.createAttribute=function(at){return new Ei(y.gl,at)},this.createBuffer=function(at){return new as(y.gl,at)},this.createElements=function(at){return new ma(y.gl,at)},this.createTexture2D=function(at){return new ur(y.gl,at)},this.createFramebuffer=function(at){return new jn(y.gl,at)},this.useFramebuffer=function(at,Y){y.gl({framebuffer:at?at.get():null})(Y)},this.createComputeModel=function(){var at=Ae(bt().mark(function Y(yt){return bt().wrap(function(_t){for(;;)switch(_t.prev=_t.next){case 0:return _t.abrupt("return",new Jn(y.gl,yt));case 1:case"end":return _t.stop()}},Y)}));return function(Y){return at.apply(this,arguments)}}(),this.clear=function(at){var Y=at.color,yt=at.depth,_t=at.stencil,St=at.framebuffer,It=St===void 0?null:St,kt={color:Y,depth:yt,stencil:_t};kt.framebuffer=It===null?It:It.get(),y.gl.clear(kt)},this.setScissor=function(at){y.gl&&y.gl._gl&&(at.enable&&at.box?(y.gl._gl.enable(At.SCISSOR_TEST),y.gl._gl.scissor(at.box.x,at.box.y,at.box.width,at.box.height)):y.gl._gl.disable(At.SCISSOR_TEST),y.gl._refresh())},this.viewport=function(at){var Y=at.x,yt=at.y,_t=at.width,St=at.height;y.gl&&y.gl._gl&&(y.gl._gl.viewport(Y,yt,_t,St),y.gl._refresh())},this.readPixels=function(at){var Y=at.framebuffer,yt={x:at.x,y:at.y,width:at.width,height:at.height};return Y&&(yt.framebuffer=Y.get()),y.gl.read(yt)},this.getCanvas=function(){return y.$canvas},this.getGLContext=function(){return y.gl._gl},this.destroy=function(){y.gl&&(y.gl.destroy(),y.inited=!1)}}var lt;return le(a,[{key:"init",value:(lt=Ae(bt().mark(function y(at){return bt().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if(!this.inited){Y.next=2;break}return Y.abrupt("return");case 2:return this.$canvas=at.canvas,Y.next=5,new Promise(function(yt,_t){la()({canvas:at.canvas,attributes:{alpha:!0,antialias:at.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(St,It){!St&&It||_t(St),yt(It)}})});case 5:this.gl=Y.sent,this.inited=!0;case 7:case"end":return Y.stop()}},y,this)})),function(y){return lt.apply(this,arguments)})},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),a}(),xa=function(){function a(){we(this,a),this.engine=void 0,this.configService=new tn}return le(a,[{key:"setConfig",value:function(lt){this.configService.set(lt)}},{key:"setEngine",value:function(lt){this.engine=lt}},{key:"createEntity",value:function(){return Or()}},{key:"createKernel",value:function(lt){var y=new Ko(this.engine,this.configService);return typeof lt=="string"?y.setBundle(JSON.parse(lt)):y.setBundle(lt),y.init(),y}},{key:"destroy",value:function(){this.engine.destroy()}}],[{key:"create",value:function(){var lt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},y=new a;return y.setConfig(lt),y.setEngine(new Ea),y}}]),a}(),nn=function(a){for(var lt=[],y=a.length,at=a[0].length,Y=function(_t){a.forEach(function(St,It){if(lt.push(St[_t]),It===y-1)for(;lt.length%4!=0;)lt.push(0)})},yt=0;yt<at;yt++)Y(yt);return new Float32Array(lt)},Ai={}.toString;const Vr=function(a){return function(lt,y){return Ai.call(lt)==="[object "+y+"]"}(a,"Number")};var Un={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Si=function(){function a(lt){lt===void 0&&(lt={}),this.options=lt,this.id="fruchtermanGPU",this.options=U(U({},Un),lt)}return a.prototype.execute=function(lt,y){return ft(this,void 0,void 0,function(){return x(this,function(at){return[2,this.genericFruchtermanLayout(!1,lt,y)]})})},a.prototype.assign=function(lt,y){return ft(this,void 0,void 0,function(){return x(this,function(at){return this.genericFruchtermanLayout(!0,lt,y),[2]})})},a.prototype.genericFruchtermanLayout=function(lt,y,at){return ft(this,void 0,void 0,function(){var Y,yt,_t,St,It,kt,Tt,ae,te,_e,ce,Se,jt,me,He,rr,xr,Fe,Ze,mr,Sr,br,$r,Mr,gr,qe,Qe,Tr,nr,Yr;return x(this,function(Ir){switch(Ir.label){case 0:if(Y=this.formatOptions(at),yt=Y.width,_t=Y.height,St=Y.center,It=Y.clustering,kt=Y.clusterGravity,Tt=Y.nodeClusterBy,ae=Y.maxIteration,te=Y.gravity,_e=Y.speed,ce=y.getAllNodes(),Se=y.getAllEdges(),!(ce!=null&&ce.length))return[2,{nodes:[],edges:Se}];if(ce.length===1)return lt&&y.mergeNodeData(ce[0].id,{x:St[0],y:St[1]}),[2,{nodes:[U(U({},ce[0]),{data:U(U({},ce[0].data),{x:St[0],y:St[1]})})],edges:Se}];for(jt=ce.map(function(je){return Rt(je,[yt,_t])}),me=_t*yt,He=Math.sqrt(me)/10,rr=me/(jt.length+1),xr=Math.sqrt(rr),Kr=[],Mn=(Wr=[Tt]).length,Lr={},jt.forEach(function(je){Wr.forEach(function(Je,Ue){if(Lr[je[Je]]===void 0&&(Lr[je[Je]]=Object.keys(Lr).length),Kr.push(Lr[je[Je]]),Ue===Mn-1)for(;Kr.length%4!=0;)Kr.push(0)})}),Fe={array:new Float32Array(Kr),count:Object.keys(Lr).length},Ze=Fe.array,mr=Fe.count,jt.forEach(function(je,Je){var Ue=0,Nr=0;Vr(je.data.fx)&&Vr(je.data.fy)&&(Ue=je.data.fx||.001,Nr=je.data.fy||.001),Ze[4*Je+1]=Ue,Ze[4*Je+2]=Nr}),Sr=jt.length,br=function(je,Je){var Ue=[],Nr=[],zr={},ir=0;for(ir=0;ir<je.length;ir++){var kr=je[ir];zr[kr.id]=ir,Ue.push(kr.data.x),Ue.push(kr.data.y),Ue.push(0),Ue.push(0),Nr.push([])}for(ir=0;ir<Je.length;ir++){var ke=Je[ir],_r=ke.source,Ar=ke.target;isNaN(zr[_r])||isNaN(zr[Ar])||(Nr[zr[_r]].push(zr[Ar]),Nr[zr[Ar]].push(zr[_r]))}var Be=0;for(ir=0;ir<je.length;ir++){var Pr=Ue.length,Dr=Nr[ir],Ye=Dr.length;Ue[4*ir+2]=Pr,Ue[4*ir+3]=Ye,Be=Math.max(Be,Ye);for(var tr=0;tr<Ye;++tr){var on=Dr[tr];Ue.push(+on)}}for(;Ue.length%4!=0;)Ue.push(0);return{maxEdgePerVetex:Be,array:new Float32Array(Ue)}}(jt,Se),$r=br.maxEdgePerVetex,Mr=br.array,gr=xa.create({engineOptions:{supportCompute:!0}}),qe=[],nr=0;nr<mr;nr++)qe.push(0,0,0,0);Qe=gr.createKernel('{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([Sr,1,1]).setBinding({u_Data:Mr,u_K:xr,u_K2:rr,u_Gravity:te,u_ClusterGravity:kt||te||1,u_Speed:_e,u_MaxDisplace:He,u_Clustering:It?1:0,u_Center:St,u_AttributeArray:Ze,u_ClusterCenters:qe,MAX_EDGE_PER_VERTEX:$r,VERTEX_COUNT:Sr}),It&&(Tr=gr.createKernel('{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([mr,1,1]).setBinding({u_Data:Mr,u_NodeAttributes:Ze,u_ClusterCenters:qe,VERTEX_COUNT:Sr,CLUSTER_COUNT:mr})),nr=0,Ir.label=1;case 1:return nr<ae?[4,Qe.execute()]:[3,6];case 2:return Ir.sent(),It?(Tr.setBinding({u_Data:Qe}),[4,Tr.execute()]):[3,4];case 3:Ir.sent(),Qe.setBinding({u_ClusterCenters:Tr}),Ir.label=4;case 4:Qe.setBinding({u_MaxDisplace:He*=.99}),Ir.label=5;case 5:return nr++,[3,1];case 6:return[4,Qe.getOutput()];case 7:return Yr=Ir.sent(),jt.forEach(function(je,Je){je.data.x=Yr[4*Je],je.data.y=Yr[4*Je+1]}),lt&&jt.forEach(function(je){var Je=je.id,Ue=je.data;return y.mergeNodeData(Je,{x:Ue.x,y:Ue.y})}),[2,{nodes:jt,edges:Se}]}var Wr,Kr,Mn,Lr})})},a.prototype.formatOptions=function(lt){lt===void 0&&(lt={});var y=U(U({},this.options),lt),at=y.clustering,Y=y.nodeClusterBy,yt=y.center,_t=y.width,St=y.height;return y.width=_t||typeof window>"u"?_t:window.innerWidth,y.height=St||typeof window>"u"?St:window.innerHeight,y.center=yt||[y.width/2,y.height/2],y.clustering=at&&!!Y,y},a}(),Jo={linkDistance:1,nodeStrength:1e3,maxIteration:1e3,edgeStrength:200,coulombDisScale:.005,damping:.9,maxSpeed:1e3,minMovement:.5,interval:.02,factor:1,gravity:10},So=function(){function a(lt){lt===void 0&&(lt={}),this.options=lt,this.id="gforce",this.options=U(U({},Jo),lt)}return a.prototype.execute=function(lt,y){return ft(this,void 0,void 0,function(){return x(this,function(at){return[2,this.genericForceLayout(!1,lt,y)]})})},a.prototype.assign=function(lt,y){return ft(this,void 0,void 0,function(){return x(this,function(at){return this.genericForceLayout(!0,lt,y),[2]})})},a.prototype.genericForceLayout=function(lt,y,at){return ft(this,void 0,void 0,function(){var Y,yt,_t,St,It,kt,Tt,ae,te,_e,ce,Se,jt,me,He,rr,xr,Fe,Ze,mr,Sr,br,$r,Mr,gr,qe,Qe,Tr,nr,Yr,Ir,Wr,Kr,Mn,Lr,je,Je,Ue,Nr,zr,ir;return x(this,function(kr){switch(kr.label){case 0:if(Y=this.formatOptions(at,y),yt=Y.width,_t=Y.height,St=Y.center,It=Y.gravity,kt=Y.linkDistance,Tt=Y.edgeStrength,ae=Y.getMass,te=Y.getCenter,_e=Y.nodeStrength,ce=Y.damping,Se=Y.maxSpeed,jt=Y.minMovement,me=Y.coulombDisScale,He=Y.factor,rr=Y.interval,xr=Y.maxIteration,Fe=y.getAllNodes(),Ze=y.getAllEdges(),!(Fe!=null&&Fe.length))return[2,{nodes:[],edges:Ze}];if(Fe.length===1)return lt&&y.mergeNodeData(Fe[0].id,{x:St[0],y:St[1]}),[2,{nodes:[U(U({},Fe[0]),{data:U(U({},Fe[0].data),{x:St[0],y:St[1]})})],edges:Ze}];for((mr=Fe.map(function(ke){return Rt(ke,[yt,_t])})).forEach(function(ke,_r){Vr(ke.data.x)||(ke.data.x=Math.random()*yt),Vr(ke.data.y)||(ke.data.y=Math.random()*_t)}),Sr=mr.length,br=function(ke,_r,Ar,Be){var Pr=[],Dr=[],Ye={},tr=0;for(tr=0;tr<ke.length;tr++){var on=ke[tr];Ye[on.id]=tr,Pr.push(on.data.x),Pr.push(on.data.y),Pr.push(0),Pr.push(0),Dr.push([])}for(tr=0;tr<_r.length;tr++){var De=_r[tr],Xe=De.source,Gr=De.target;Dr[Ye[Xe]].push(Ye[Gr]),Dr[Ye[Xe]].push(Ar(De)),Dr[Ye[Xe]].push(Be(De)),Dr[Ye[Xe]].push(0),Dr[Ye[Gr]].push(Ye[Xe]),Dr[Ye[Gr]].push(Ar(De)),Dr[Ye[Gr]].push(Be(De)),Dr[Ye[Gr]].push(0)}var eo=0;for(tr=0;tr<ke.length;tr++){var Mo=Pr.length,Tn=Dr[tr],ro=Tn.length;Pr[4*tr+2]=Mo+1048576*ro/4,Pr[4*tr+3]=0,eo=Math.max(eo,ro/4);for(var Bn=0;Bn<ro;++Bn){var Mi=Tn[Bn];Pr.push(+Mi)}}for(;Pr.length%4!=0;)Pr.push(0);return{maxEdgePerVetex:eo,array:new Float32Array(Pr)}}(mr,Ze,kt,Tt),$r=br.maxEdgePerVetex,Mr=br.array,gr=[],qe=[],Qe=[],Tr=[],nr=[],Yr=[],Ir=[],Wr=mr.map(function(ke){return y.getDegree(ke.id,"both")}),mr.forEach(function(ke,_r){gr.push(ae(ke)),qe.push(_e(ke));var Ar=[St[0],St[1],It];if(te){var Be=te(ke,Wr[_r]);Be&&Vr(Be[0])&&Vr(Be[1])&&Vr(Be[2])&&(Ar=Be)}Qe.push(Ar[0]),Tr.push(Ar[1]),nr.push(Ar[2]),Vr(ke.data.fx)&&Vr(ke.data.fy)?(Yr.push(ke.data.fx||.001),Ir.push(ke.data.fy||.001)):(Yr.push(0),Ir.push(0))}),Kr=nn([gr,Wr,qe,Yr]),Mn=nn([Qe,Tr,nr,Ir]),Lr=xa.create({engineOptions:{supportCompute:!0}}),je=[],Mr.forEach(function(ke){je.push(ke)}),Nr=0;Nr<4;Nr++)je.push(0);Je=Lr.createKernel('{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_damping;\\nuniform float u_maxSpeed;\\nuniform float u_minMovement;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nuniform float u_coulombDisScale;\\nuniform float u_factor;\\nuniform sampler2D u_NodeAttributeArray1;\\nuniform vec2 u_NodeAttributeArray1Size;\\nvec4 getDatau_NodeAttributeArray1(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray1, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray1(float address1D) {\\n  return getDatau_NodeAttributeArray1(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray1Size));\\n}\\nvec4 getDatau_NodeAttributeArray1(int address1D) {\\n  return getDatau_NodeAttributeArray1(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributeArray2;\\nuniform vec2 u_NodeAttributeArray2Size;\\nvec4 getDatau_NodeAttributeArray2(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray2, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray2(float address1D) {\\n  return getDatau_NodeAttributeArray2(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray2Size));\\n}\\nvec4 getDatau_NodeAttributeArray2(int address1D) {\\n  return getDatau_NodeAttributeArray2(float(address1D));\\n}\\nuniform float u_interval;\\nivec2 unpack_float(float packedValue) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = getDatau_NodeAttributeArray1(i);\\nvec4 attributesj = getDatau_NodeAttributeArray1(j);\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nvec4 movement = getDatau_AveMovement(0.0);\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < u_minMovement)) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes1 = getDatau_NodeAttributeArray1(i);\\nvec4 nodeAttributes2 = getDatau_NodeAttributeArray2(i);\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = u_interval * u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > u_maxSpeed) {float param2 = u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0));}else {float distx = vx * u_interval;\\nfloat disty = vy * u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\ngl_FragColor = vec4(vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"SHIFT_20","type":"Float","value":1048576,"runtime":false}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_damping","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_maxSpeed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_minMovement","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_coulombDisScale","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_factor","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray1","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray2","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_interval","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([Sr,1,1]).setBinding({u_Data:Mr,u_damping:ce,u_maxSpeed:Se,u_minMovement:jt,u_coulombDisScale:me,u_factor:He,u_NodeAttributeArray1:Kr,u_NodeAttributeArray2:Mn,MAX_EDGE_PER_VERTEX:$r,VERTEX_COUNT:Sr,u_AveMovement:je,u_interval:rr}),Ue=Lr.createKernel('{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_iter;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = getDatau_Data(j);\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngl_FragColor = vec4(vec4(movement, 0.0, 0.0, 0.0));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_iter","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_AveMovement","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([1,1,1]).setBinding({u_Data:Mr,VERTEX_COUNT:Sr,u_AveMovement:[0,0,0,0]}),Nr=0,kr.label=1;case 1:return Nr<xr?[4,Je.execute()]:[3,5];case 2:return kr.sent(),Ue.setBinding({u_Data:Je}),[4,Ue.execute()];case 3:kr.sent(),zr=Math.max(.02,rr-.002*Nr),Je.setBinding({u_interval:zr,u_AveMovement:Ue}),kr.label=4;case 4:return Nr++,[3,1];case 5:return[4,Je.getOutput()];case 6:return ir=kr.sent(),mr.forEach(function(ke,_r){ke.data.x=ir[4*_r],ke.data.y=ir[4*_r+1]}),lt&&mr.forEach(function(ke){var _r=ke.id,Ar=ke.data;return y.mergeNodeData(_r,{x:Ar.x,y:Ar.y})}),[2,{nodes:mr,edges:Ze}]}})})},a.prototype.formatOptions=function(lt,y){lt===void 0&&(lt={});var at=U(U({},this.options),lt),Y=lt.width,yt=lt.height,_t=lt.getMass;return at.width=Y||typeof window>"u"?Y:window.innerWidth,at.height=yt||typeof window>"u"?yt:window.innerHeight,lt.center||(at.center=[at.width/2,at.height/2]),_t||(at.getMass=function(St){var It=1;Vr(St==null?void 0:St.data.mass)&&(It=St==null?void 0:St.data.mass);var kt=y.getDegree(St.id,"both");return!kt||kt<5?It:5*kt*It}),at.linkDistance=Bt(1,lt.linkDistance),at.nodeStrength=Bt(1,lt.nodeStrength),at.edgeStrength=Bt(1,lt.edgeStrength),at},a}()})();var Fu=Ls.O;Ls.I;function ju(U,ft,x,Mt){const Ft=we=>Math.sqrt(we.reduce(($e,le)=>$e+le*le,0)),K=x.width,F=x.height,Rt=K*F,Bt=x.C*Math.sqrt(Rt/(U+1)),ye=we=>we*we/Bt,Ae=we=>Bt*Bt/we,de=new Float32Array(U*2).map((we,$e)=>$e%2===0?(Math.random()*K-K/2)/2:(Math.random()*F-F/2)/2);let re=K/10;const Dt=we=>we/(x.iterations+1);for(let we=0;we<x.iterations;we++){const $e=[];for(let le=0;le<U;le++){const At=le*2,We=[de[At+0],de[At+1]];$e[le]=[0,0];for(let fe=0;fe<U;fe++){const ve=le*2,be=[de[ve+0],de[ve+1]];if(le!==fe){const Ge=[We[0]-be[0],We[1]-be[1]],Qt=Ft(Ge);if(Qt!==0||Qt>1e3*Bt){const ee=Ae(Qt);$e[le][0]+=Ge[0]/Qt*ee,$e[le][1]+=Ge[1]/Qt*ee}}}}for(let le=0;le<ft.length/3;le++){const At=le*3,We=ft[At+0],fe=We*2,ve=ft[At+1],be=ve*2,Ge=ft[At+2],Qt=[de[fe+0]-de[be+0],de[fe+1]-de[be+1]],ee=Ft(Qt);if(ee!==0||ee>1e3*Bt){const bt=ye(ee),wr=Math.pow(Ge,x.edgeWeightInfluence);$e[We][0]-=Qt[0]/ee*bt*wr,$e[We][1]-=Qt[1]/ee*bt*wr,$e[ve][0]+=Qt[0]/ee*bt*wr,$e[ve][1]+=Qt[1]/ee*bt*wr}}for(let le=0;le<U;le++){const At=le*2,We=[de[At+0],de[At+1]],fe=$e[le],ve=Ft(We),be=.01*Bt*x.gravity*ve;fe[0]-=be*We[0]/ve,fe[1]-=be*We[1]/ve,fe[0]*=x.speed,fe[1]*=x.speed;const Ge=Ft(fe);if(Ge!==0){const Qt=Math.min(Ge,re*x.speed),ee=We[0]+fe[0]/Ge*Qt,bt=We[1]+fe[1]/Ge*Qt;de[At+0]=Math.min(K/2,Math.max(-K/2,ee)),de[At+1]=Math.min(F/2,Math.max(-F/2,bt))}}re=Dt(re),(we===x.iterations-1||we%x.skipUpdates+1===0)&&(Mt==null||Mt(de,we))}return de}const Uu=U=>{const ft=(U==null?void 0:U.iterations)||10,x=(U==null?void 0:U.edgeWeightInfluence)||1,Mt=(U==null?void 0:U.C)||1,Ft=(U==null?void 0:U.speed)||1,K=(U==null?void 0:U.gravity)||10,F=(U==null?void 0:U.skipUpdates)||0,Rt=(U==null?void 0:U.width)||1,Bt=(U==null?void 0:U.height)||1;return{iterations:ft,edgeWeightInfluence:x,C:Mt,speed:Ft,gravity:K,skipUpdates:F,width:Rt,height:Bt}},Bu=(U,ft="weight")=>{const x=U.nodes(),Mt=U.edges(),Ft=U.edges().reduce((F,Rt,Bt)=>{const ye=Bt*3;return F[ye+0]=x.indexOf(U.source(Rt)),F[ye+1]=x.indexOf(U.target(Rt)),F[ye+2]=U.getEdgeAttribute(Rt,ft)||1,F},new Float32Array(Mt.length*3)),K=F=>x.reduce((Rt,Bt,ye)=>{const Ae=ye*2;return{...Rt,[Bt]:{x:F[Ae+0],y:F[Ae+1]}}},{});return[Ft,x.length,K]};function uu(U,ft,x){const Mt=Uu(x||{}),[Ft,K,F]=Bu(ft,x==null?void 0:x.weightAttribute),Bt=ju(K,Ft,Mt,U?ye=>{ft.updateEachNodeAttributes((Ae,de)=>({...de,...F(ye)[Ae]}),{attributes:["x","y"]})}:void 0);if(!U)return F(Bt)}const cu=(U,ft)=>uu(!1,U,ft);cu.assign=(U,ft)=>uu(!0,U,ft);const rs=5,ns=1,os=5e3;async function Vu(U,{iterations:ft}){const x=cu(U,{height:Oe,width:Oe,iterations:ft||os,speed:rs,gravity:ns,C:1,edgeWeightInfluence:0});return Zs(U,x,Mt=>{Mt.x=Mt.x+Oe/2,Mt.y=Mt.y+Oe/2})}async function Wu(U,{iterations:ft,min_movement:x,distance_threshold_mode:Mt}){const K=await new mu({height:Oe,width:Oe,center:[Oe/2,Oe/2],gravity:ns,speed:rs,maxIteration:ft||os}).execute(U);return Yo(K)}async function qu(U,{iterations:ft,min_movement:x,distance_threshold_mode:Mt}){const K=await new Fu({height:Oe,width:Oe,center:[Oe/2,Oe/2],gravity:ns,speed:rs,maxIteration:ft||os}).execute(U);return Yo(K)}async function Hs(U,{iterations:ft,min_movement:x,distance_threshold_mode:Mt},Ft){const F=await new yu({threads:Ft,maxIteration:ft||os,minMovement:x,distanceThresholdMode:Mt,height:Oe,width:Oe,center:[Oe/2,Oe/2],gravity:ns,speed:rs}).execute(U);return Yo(F)}const zs=[{name:An.GRAPHOLOGY},{name:An.ANTV_LAYOUT},{name:An.ANTV_LAYOUT_WASM_SINGLETHREAD},{name:An.ANTV_LAYOUT_WASM_MULTITHREADS},{name:An.ANTV_LAYOUT_GPU}],Xs=document.getElementById("mask"),Hu=document.getElementById("iterations"),Xu=document.getElementById("min_movement"),$u=document.getElementById("distance_threshold_mode"),ks=document.getElementById("dataset"),Yu=document.getElementById("dataset-desc"),Ku=document.getElementById("layout"),ua=document.getElementById("run"),wi=zs.map(({name:U})=>document.getElementById(U).getContext("2d")),$s=zs.map((U,ft)=>wi[ft].canvas.parentElement.querySelector("span")),Zu=zs.map(({name:U},ft)=>{const x=document.getElementById(U+"_checkbox");return x.onchange=()=>{wi[ft].canvas.parentElement.style.display=x.checked?"block":"none"},x}),Qu=document.getElementById("scaling"),Ju=async()=>{const U=await Gs(!1),ft=await Gs(!0);return[U,ft]},tc=async(U,ft,x,Mt,Ft,K,F)=>{const Rt=performance.now(),{nodes:Bt,edges:ye}=await x(Mt,Ft,K);ft.innerHTML=`${(performance.now()-Rt).toFixed(2)}ms`,Eu(U,Bt,ye,F)};(async()=>{ua.innerHTML="Loading...",ua.disabled=!0,console.time("Load datasets");const U=await wu();ks.onchange=()=>{Yu.innerHTML=U[ks.value].desc},console.timeEnd("Load datasets"),console.time("Init WASM threads");const[ft,x]=await Ju();console.timeEnd("Init WASM threads"),ua.innerHTML="Run layouts",ua.disabled=!1;const Mt=[{name:An.GRAPHOLOGY,methods:{forceatlas2:Lu,fruchterman:Vu}},{name:An.ANTV_LAYOUT,methods:{forceatlas2:zu,force2:Pu,fruchterman:Wu}},{name:An.ANTV_LAYOUT_WASM_SINGLETHREAD,methods:{forceatlas2:Vs,force2:Ws,fruchterman:Hs}},{name:An.ANTV_LAYOUT_WASM_MULTITHREADS,methods:{forceatlas2:Vs,force2:Ws,fruchterman:Hs}},{name:An.ANTV_LAYOUT_GPU,methods:{fruchterman:qu}}];ua.onclick=async()=>{Xs.style.display="flex";const Ft=U[ks.value],K=Ku.value;await Promise.all(Mt.map(async({name:F,methods:Rt},Bt)=>{Rt[K]&&Zu[Bt].checked?await tc(wi[Bt],$s[Bt],Rt[K],Ft[F],{iterations:parseInt(Hu.value),min_movement:parseFloat(Xu.value),distance_threshold_mode:$u.value},F===An.ANTV_LAYOUT_WASM_MULTITHREADS?x:ft,Number(Qu.value)):(wi[Bt].clearRect(0,0,wi[Bt].canvas.width,wi[Bt].canvas.height),$s[Bt].innerHTML="not implemented.")})),Xs.style.display="none"}})();
