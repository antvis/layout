var is=Object.defineProperty;var as=(l,a,i)=>a in l?is(l,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[a]=i;var It=(l,a,i)=>(as(l,typeof a!="symbol"?a+"":a,i),i);(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))d(c);new MutationObserver(c=>{for(const g of c)if(g.type==="childList")for(const y of g.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&d(y)}).observe(document,{childList:!0,subtree:!0});function i(c){const g={};return c.integrity&&(g.integrity=c.integrity),c.referrerPolicy&&(g.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?g.credentials="include":c.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function d(c){if(c.ep)return;c.ep=!0;const g=i(c);fetch(c.href,g)}})();var Eo=function(a){return a!==null&&typeof a=="object"&&typeof a.addUndirectedEdgeWithKey=="function"&&typeof a.dropNode=="function"&&typeof a.multi=="boolean"},ss={913:l=>{var a=Object.prototype.hasOwnProperty,i="~";function d(){}function c(D,_,j){this.fn=D,this.context=_,this.once=j||!1}function g(D,_,j,q,V){if(typeof j!="function")throw new TypeError("The listener must be a function");var X=new c(j,q||D,V),st=i?i+_:_;return D._events[st]?D._events[st].fn?D._events[st]=[D._events[st],X]:D._events[st].push(X):(D._events[st]=X,D._eventsCount++),D}function y(D,_){--D._eventsCount==0?D._events=new d:delete D._events[_]}function k(){this._events=new d,this._eventsCount=0}Object.create&&(d.prototype=Object.create(null),new d().__proto__||(i=!1)),k.prototype.eventNames=function(){var D,_,j=[];if(this._eventsCount===0)return j;for(_ in D=this._events)a.call(D,_)&&j.push(i?_.slice(1):_);return Object.getOwnPropertySymbols?j.concat(Object.getOwnPropertySymbols(D)):j},k.prototype.listeners=function(D){var _=i?i+D:D,j=this._events[_];if(!j)return[];if(j.fn)return[j.fn];for(var q=0,V=j.length,X=new Array(V);q<V;q++)X[q]=j[q].fn;return X},k.prototype.listenerCount=function(D){var _=i?i+D:D,j=this._events[_];return j?j.fn?1:j.length:0},k.prototype.emit=function(D,_,j,q,V,X){var st=i?i+D:D;if(!this._events[st])return!1;var ft,Q,at=this._events[st],dt=arguments.length;if(at.fn){switch(at.once&&this.removeListener(D,at.fn,void 0,!0),dt){case 1:return at.fn.call(at.context),!0;case 2:return at.fn.call(at.context,_),!0;case 3:return at.fn.call(at.context,_,j),!0;case 4:return at.fn.call(at.context,_,j,q),!0;case 5:return at.fn.call(at.context,_,j,q,V),!0;case 6:return at.fn.call(at.context,_,j,q,V,X),!0}for(Q=1,ft=new Array(dt-1);Q<dt;Q++)ft[Q-1]=arguments[Q];at.fn.apply(at.context,ft)}else{var yt,Tt=at.length;for(Q=0;Q<Tt;Q++)switch(at[Q].once&&this.removeListener(D,at[Q].fn,void 0,!0),dt){case 1:at[Q].fn.call(at[Q].context);break;case 2:at[Q].fn.call(at[Q].context,_);break;case 3:at[Q].fn.call(at[Q].context,_,j);break;case 4:at[Q].fn.call(at[Q].context,_,j,q);break;default:if(!ft)for(yt=1,ft=new Array(dt-1);yt<dt;yt++)ft[yt-1]=arguments[yt];at[Q].fn.apply(at[Q].context,ft)}}return!0},k.prototype.on=function(D,_,j){return g(this,D,_,j,!1)},k.prototype.once=function(D,_,j){return g(this,D,_,j,!0)},k.prototype.removeListener=function(D,_,j,q){var V=i?i+D:D;if(!this._events[V])return this;if(!_)return y(this,V),this;var X=this._events[V];if(X.fn)X.fn!==_||q&&!X.once||j&&X.context!==j||y(this,V);else{for(var st=0,ft=[],Q=X.length;st<Q;st++)(X[st].fn!==_||q&&!X[st].once||j&&X[st].context!==j)&&ft.push(X[st]);ft.length?this._events[V]=ft.length===1?ft[0]:ft:y(this,V)}return this},k.prototype.removeAllListeners=function(D){var _;return D?(_=i?i+D:D,this._events[_]&&y(this,_)):(this._events=new d,this._eventsCount=0),this},k.prototype.off=k.prototype.removeListener,k.prototype.addListener=k.prototype.on,k.prefixed=i,k.EventEmitter=k,l.exports=k},370:(l,a,i)=>{var d=i(331),c=["stopLayout","calculateLayout"];l.exports=function(){var g=new Worker(URL.createObjectURL(new Blob(['var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{calculateLayout:()=>jn,stopLayout:()=>Ln});var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function o(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function i(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function a(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function u(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}Object.create,Object.create;const h=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[],i=this._events["*"]||[],a=function(n){for(var o=n.length,i=0;i<o;i++)if(n[i]){var a=n[i],s=a.callback;a.once&&(n.splice(i,1),0===n.length&&delete e._events[t],o--,i--),s.apply(e,r)}};a(o),a(i)},t.prototype.off=function(t,e){if(t)if(e){for(var r=this._events[t]||[],n=r.length,o=0;o<n;o++)r[o].callback===e&&(r.splice(o,1),n--,o--);0===r.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function d(t,e,r,n){for(;t.length;){const o=t.shift();if(r(o))return!0;e.add(o.id),n(o.id).forEach((r=>{e.has(r.id)||(e.add(r.id),t.push(r))}))}return!1}function l(t,e,r,n){if(r(t))return!0;e.add(t.id);for(const o of n(t.id))if(!e.has(o.id)&&l(o,e,r,n))return!0;return!1}class c extends h{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const r=e.find((e=>e.type===t.type&&e.id===t.id&&e.propertyName===t.propertyName));r?r.newValue=t.newValue:e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const r=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),r=this.bothEdgesMap.get(t);r?.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((e=>{e.childrenMap.get(t)?.forEach((t=>{e.parentMap.delete(t.id)})),e.parentMap.delete(t),e.childrenMap.delete(t)})),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){const n=this.getNode(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateNodeDataProperty(t,e,r)}))}))}updateNodeData(...t){const e=t[0],r=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:o})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),o.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),o=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),o.delete(e),i.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.source,o=e;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:o})}))}updateEdgeTarget(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.target,o=e;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:o})}))}updateEdgeDataProperty(t,e,r){const n=this.getEdge(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}updateEdgeData(...t){const e=t[0],r=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:o})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateEdgeDataProperty(t,e,r)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const r=[],n=Array.isArray(t)?t:[t];for(;n.length;){const t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach((t=>{t.children?.forEach((r=>{this.setParent(r.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const r=this.treeIndices.get(e).childrenMap.get(t);return Array.from(r||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const r=[];let n,o=this.getNode(t);for(;n=this.getParent(o.id,e);)r.push(n),o=n;return r}setParent(t,e,r){this.checkTreeExistence(r);const n=this.treeIndices.get(r),o=this.getNode(t),i=n.parentMap.get(t),a=this.getNode(e);n.parentMap.set(t,a),i&&n.childrenMap.get(i.id)?.delete(o);let s=n.childrenMap.get(a.id);s||(s=new Set,n.childrenMap.set(a.id,s)),s.add(o),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:i?.id,newParentId:a.id})}))}dfsTree(t,e,r){return l(this.getNode(t),new Set,e,(t=>this.getChildren(t,r)))}bfsTree(t,e,r){return d([this.getNode(t)],new Set,e,(t=>this.getChildren(t,r)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return d([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return l(this.getNode(t),new Set,e,n)}clone(){const t=this.getAllNodes().map((t=>({...t,data:{...t.data}}))),e=this.getAllEdges().map((t=>({...t,data:{...t.data}}))),r=new c({nodes:t,edges:e});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},n)=>{const o=new Map;t.forEach(((t,e)=>{o.set(e,r.getNode(t.id))}));const i=new Map;e.forEach(((t,e)=>{i.set(e,new Set(Array.from(t).map((t=>r.getNode(t.id)))))})),r.treeIndices.set(n,{parentMap:o,childrenMap:i})})),r}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var f=/-(\\w)/g,g=(function(t){return t.replace(f,(function(t,e){return e?e.toUpperCase():""}))},Object.create(null),Array.isArray),p=function(t){for(var e=[],r=t.length,n=0;n<r;n+=1){e[n]=[];for(var o=0;o<r;o+=1)n===o?e[n][o]=0:0!==t[n][o]&&t[n][o]?e[n][o]=t[n][o]:e[n][o]=1/0}for(var i=0;i<r;i+=1)for(n=0;n<r;n+=1)for(o=0;o<r;o+=1)e[n][o]>e[n][i]+e[i][o]&&(e[n][o]=e[n][i]+e[i][o]);return e},v=function(t,e){var r=t.nodes,n=t.edges,o=[],i={};if(!r)throw new Error("invalid nodes data!");return r&&r.forEach((function(t,e){i[t.id]=e,o.push([])})),null==n||n.forEach((function(t){var r=t.source,n=t.target,a=i[r],s=i[n];void 0!==a&&void 0!==s&&(o[a][s]=1,e||(o[s][a]=1))})),o},y=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},m={}.toString;const w=function(t,e){return m.call(t)==="[object "+e+"]"},x=function(t){return w(t,"Number")};var E=function(t){if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var e=[];return t.forEach((function(t){e.push(t)})),e.map((function(t){return E(t)}))}if("object"==typeof t){var r={};return Object.keys(t).forEach((function(e){r[e]=E(t[e])})),r}return t},N=function(t,e){var r=E(t);return r.data=r.data||{},e&&(x(r.data.x)||(r.data.x=Math.random()*e[0]),x(r.data.y)||(r.data.y=Math.random()*e[1])),r};const b=function(t){return"function"==typeof t},M=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function S(t,e){return b(e)?e:x(e)?function(){return e}:function(){return t}}function k(t,e,r){return void 0===r&&(r=!0),e||0===e?b(e)?e:x(e)?function(){return e}:g(e)?function(){if(r){var n=Math.max.apply(Math,u([],s(e)));return isNaN(n)?t:n}return e}:M(e)?function(){if(r){var n=Math.max(e.width,e.height);return isNaN(n)?t:n}return[e.width,e.height]}:function(){return t}:function(e){var r=(e.data||{}).size;return r?g(r)?r[0]>r[1]?r[0]:r[1]:M(r)?r.width>r.height?r.width:r.height:r:t}}var A=function(t,e){var r;return r=x(e)?function(){return e}:b(e)?e:function(){return 0},t?g(t)?function(e){return(t[0]>t[1]?t[0]:t[1])+r(e)}:function(e){return t+r(e)}:function(t){var e,n;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return Math.max(t.data.bboxSize[0],t.data.bboxSize[1])+r(t);if(null===(n=t.data)||void 0===n?void 0:n.size){if(g(t.data.size))return Math.max(t.data.size[0],t.data.size[1])+r(t);var o=t.data.size;return M(o)?(o.width>o.height?o.width:o.height)+r(t):o+r(t)}return 10+r(t)}},_=function(t,e,r){var o=t.getAllNodes(),i=t.getAllEdges();return(null==o?void 0:o.length)?1===o.length?(e&&t.mergeNodeData(o[0].id,{x:r[0],y:r[1]}),{nodes:[n(n({},o[0]),{data:n(n({},o[0].data),{x:r[0],y:r[1]})})],edges:i}):void 0:{nodes:[],edges:i}},z={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},R=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="circular",this.options=n(n({},z),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericCircularLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericCircularLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericCircularLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,u,h,d,l,c,f,g,p,v,y,m,w,x,E,b,M,A,z,R,O,P,T,C,q,L,j,F,V,B,G,W,$,U;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,u=o.height,h=o.center,d=o.divisions,l=o.startAngle,c=void 0===l?0:l,f=o.endAngle,g=void 0===f?2*Math.PI:f,p=o.angleRatio,v=o.ordering,y=o.clockwise,m=o.nodeSpacing,w=o.nodeSize,x=e.getAllNodes(),E=e.getAllEdges(),b=s(D(i,u,h),3),M=b[0],A=b[1],z=b[2],!(R=null==x?void 0:x.length)||1===R)return[2,_(e,t,z)];for(O=(g-c)/R,P=o.radius,T=o.startRadius,C=o.endRadius,m?(q=S(10,m),L=k(10,w),j=-1/0,x.forEach((function(t){var e=L(t);j<e&&(j=e)})),F=0,x.forEach((function(t,e){F+=0===e?j||10:(q(t)||0)+(j||10)})),P=F/(2*Math.PI)):P||T||C?!T&&C?T=C:T&&!C&&(C=T):P=Math.min(A,M)/2,V=O*p,B=[],B="topology"===v?I(e,x):"topology-directed"===v?I(e,x,!0):"degree"===v?function(t,e){var r=[];return e.forEach((function(t,e){r.push(N(t))})),r.sort((function(e,r){return t.getDegree(e.id,"both")-t.getDegree(r.id,"both")})),r}(e,x):x.map((function(t){return N(t)})),G=Math.ceil(R/d),W=0;W<R;++W)($=P)||null===T||null===C||($=T+W*(C-T)/(R-1)),$||($=10+100*W/(R-1)),U=c+W%G*V+2*Math.PI/d*Math.floor(W/G),y||(U=g-W%G*V-2*Math.PI/d*Math.floor(W/G)),B[W].data.x=z[0]+Math.cos(U)*$,B[W].data.y=z[1]+Math.sin(U)*$;return t&&B.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:B,edges:E}]}))}))},t}(),I=function(t,e,r){void 0===r&&(r=!1);var n=[N(e[0])],o={},i=e.length;o[e[0].id]=!0;var a=0;return e.forEach((function(s,u){if(0!==u)if(u!==i-1&&t.getDegree(s.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(n[a].id,s.id)||o[s.id]){for(var h=r?t.getSuccessors(n[a].id):t.getNeighbors(n[a].id),d=!1,l=0;l<h.length;l++){var c=h[l];if(t.getDegree(c.id)===t.getDegree(s.id)&&!o[c.id]){n.push(N(c)),o[c.id]=!0,d=!0;break}}for(var f=0;!d&&(o[e[f].id]||(n.push(N(e[f])),o[e[f].id]=!0,d=!0),++f!==i););}else n.push(N(s)),o[s.id]=!0,a++})),n},D=function(t,e,r){var n=t,o=e,i=r;return n||"undefined"==typeof window||(n=window.innerWidth),o||"undefined"==typeof window||(o=window.innerHeight),i||(i=[n/2,o/2]),[n,o,i]};const O=function(t){return w(t,"String")};var P={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},T=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="concentric",this.options=n(n({},P),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericConcentricLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericConcentricLayout(!0,t,e),[2]}))}))},t.prototype.genericConcentricLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,p,v,y,m,w,E,S,k,A,z,R,I,D,P,T,C,q,L,j,F,V,B,G,W,$,U,H,K,Y;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,h=o.sortBy,d=o.maxLevelDiff,l=o.sweep,c=o.clockwise,f=o.equidistant,p=o.preventOverlap,v=o.startAngle,y=void 0===v?1.5*Math.PI:v,m=o.nodeSize,w=o.nodeSpacing,E=e.getAllNodes(),S=e.getAllEdges(),k=s||"undefined"==typeof window?s:window.innerWidth,A=u||"undefined"==typeof window?u:window.innerHeight,z=i||[k/2,A/2],!(null==E?void 0:E.length)||1===E.length)return[2,_(e,t,z)];if(R=[],D=0,I=g(m)?Math.max(m[0],m[1]):m,g(w)?D=Math.max(w[0],w[1]):x(w)&&(D=w),E.forEach((function(t){var e=N(t);R.push(e);var r=I,n=e.data;g(n.size)?r=Math.max(n.size[0],n.size[1]):x(n.size)?r=n.size:M(n.size)&&(r=Math.max(n.size.width,n.size.height)),I=Math.max(I,r),b(w)&&(D=Math.max(w(t),D))})),P={},R.forEach((function(t,e){P[t.id]=e})),O(T=h)&&void 0!==R[0].data[T]||(T="degree"),"degree"===T?R.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):R.sort((function(t,e){return e.data[T]-t.data[T]})),C=R[0],q=(d||("degree"===T?e.getDegree(C.id,"both"):C.data[T]))/4,j=(L=[{nodes:[]}])[0],R.forEach((function(t){if(j.nodes.length>0){var r="degree"===T?Math.abs(e.getDegree(j.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(j.nodes[0].data[T]-t.data[T]);q&&r>=q&&(j={nodes:[]},L.push(j))}j.nodes.push(t)})),F=I+D,p||(V=L.length>0&&L[0].nodes.length>1,B=Math.min(k,A)/2-F,G=B/(L.length+(V?1:0)),F=Math.min(F,G)),W=0,L.forEach((function(t){var e=void 0===l?2*Math.PI-2*Math.PI/t.nodes.length:l;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&p){var r=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),o=Math.sqrt(F*F/(r*r+n*n));W=Math.max(o,W)}t.r=W,W+=F})),f){for($=0,U=0,H=0;H<L.length;H++)K=L[H],Y=(K.r||0)-U,$=Math.max($,Y);U=0,L.forEach((function(t,e){0===e&&(U=t.r||0),t.r=U,U+=$}))}return L.forEach((function(t){var e=t.dTheta||0,r=t.r||0;t.nodes.forEach((function(t,n){var o=y+(c?1:-1)*e*n;t.data.x=z[0]+r*Math.cos(o),t.data.y=z[1]+r*Math.sin(o)}))})),t&&R.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:R,edges:S}]}))}))},t}();function C(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i,a,s,u,h,d,l,c,f=t._root,g={data:n},p=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!f)return t._root=g,t;for(;f.length;)if((h=e>=(i=(p+y)/2))?p=i:y=i,(d=r>=(a=(v+m)/2))?v=a:m=a,o=f,!(f=f[l=d<<1|h]))return o[l]=g,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&r===u)return g.next=f,o?o[l]=g:t._root=g,t;do{o=o?o[l]=new Array(4):t._root=new Array(4),(h=e>=(i=(p+y)/2))?p=i:y=i,(d=r>=(a=(v+m)/2))?v=a:m=a}while((l=d<<1|h)==(c=(u>=a)<<1|s>=i));return o[c]=f,o[l]=g,t}function q(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function L(t){return t[0]}function j(t){return t[1]}function F(t,e,r){var n=new V(null==e?L:e,null==r?j:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function V(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function B(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var G=F.prototype=V.prototype;function W(t){return function(){return t}}function $(t){return 1e-6*(t()-.5)}G.copy=function(){var t,e,r=new V(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=B(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var o=0;o<4;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(4)}):n.target[o]=B(e));return r},G.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return C(this.cover(e,r),e,r,t)},G.addAll=function(t){var e,r,n,o,i=t.length,a=new Array(i),s=new Array(i),u=1/0,h=1/0,d=-1/0,l=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(a[r]=n,s[r]=o,n<u&&(u=n),n>d&&(d=n),o<h&&(h=o),o>l&&(l=o));if(u>d||h>l)return this;for(this.cover(u,h).cover(d,l),r=0;r<i;++r)C(this,a[r],s[r],t[r]);return this},G.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var a,s,u=o-r||1,h=this._root;r>t||t>=o||n>e||e>=i;)switch(s=(e<n)<<1|t<r,(a=new Array(4))[s]=h,h=a,u*=2,s){case 0:o=r+u,i=n+u;break;case 1:r=o-u,i=n+u;break;case 2:o=r+u,n=i-u;break;case 3:r=o-u,n=i-u}this._root&&this._root.length&&(this._root=h)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this},G.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},G.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},G.find=function(t,e,r){var n,o,i,a,s,u,h,d=this._x0,l=this._y0,c=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new q(p,d,l,c,f)),null==r?r=1/0:(d=t-r,l=e-r,c=t+r,f=e+r,r*=r);u=g.pop();)if(!(!(p=u.node)||(o=u.x0)>c||(i=u.y0)>f||(a=u.x1)<d||(s=u.y1)<l))if(p.length){var v=(o+a)/2,y=(i+s)/2;g.push(new q(p[3],v,y,a,s),new q(p[2],o,y,v,s),new q(p[1],v,i,a,y),new q(p[0],o,i,v,y)),(h=(e>=y)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-h],g[g.length-1-h]=u)}else{var m=t-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),x=m*m+w*w;if(x<r){var E=Math.sqrt(r=x);d=t-E,l=e-E,c=t+E,f=e+E,n=p.data}}return n},G.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,r,n,o,i,a,s,u,h,d,l,c,f=this._root,g=this._x0,p=this._y0,v=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((h=i>=(s=(g+v)/2))?g=s:v=s,(d=a>=(u=(p+y)/2))?p=u:y=u,e=f,!(f=f[l=d<<1|h]))return this;if(!f.length)break;(e[l+1&3]||e[l+2&3]||e[l+3&3])&&(r=e,c=l)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(o=f.next)&&delete f.next,n?(o?n.next=o:delete n.next,this):e?(o?e[l]=o:delete e[l],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[c]=f:this._root=f),this):(this._root=o,this)},G.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},G.root=function(){return this._root},G.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},G.visit=function(t){var e,r,n,o,i,a,s=[],u=this._root;for(u&&s.push(new q(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,n=e.x0,o=e.y0,i=e.x1,a=e.y1)&&u.length){var h=(n+i)/2,d=(o+a)/2;(r=u[3])&&s.push(new q(r,h,d,i,a)),(r=u[2])&&s.push(new q(r,n,d,h,a)),(r=u[1])&&s.push(new q(r,h,o,i,d)),(r=u[0])&&s.push(new q(r,n,o,h,d))}return this},G.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new q(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.x1,h=e.y1,d=(a+u)/2,l=(s+h)/2;(i=o[0])&&r.push(new q(i,a,s,d,l)),(i=o[1])&&r.push(new q(i,d,s,u,l)),(i=o[2])&&r.push(new q(i,a,l,d,h)),(i=o[3])&&r.push(new q(i,d,l,u,h))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},G.x=function(t){return arguments.length?(this._x=t,this):this._x},G.y=function(t){return arguments.length?(this._y=t,this):this._y};var U={value:()=>{}};function H(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new K(n)}function K(t){this._=t}function Y(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function J(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=U,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}K.prototype=H.prototype={constructor:K,on:function(t,e){var r,n,o=this._,i=(n=o,(t+"").trim().split(/^|\\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)o[r]=J(o[r],t.name,e);else if(null==e)for(r in o)o[r]=J(o[r],t.name,null);return this}for(;++a<s;)if((r=(t=i[a]).type)&&(r=Y(o[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new K(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};const X=H;var Q,Z,tt=0,et=0,rt=0,nt=1e3,ot=0,it=0,at=0,st="object"==typeof performance&&performance.now?performance:Date,ut="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ht(){return it||(ut(dt),it=st.now()+at)}function dt(){it=0}function lt(){this._call=this._time=this._next=null}function ct(t,e,r){var n=new lt;return n.restart(t,e,r),n}function ft(){it=(ot=st.now())+at,tt=et=0;try{!function(){ht(),++tt;for(var t,e=Q;e;)(t=it-e._time)>=0&&e._call.call(void 0,t),e=e._next;--tt}()}finally{tt=0,function(){for(var t,e,r=Q,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:Q=e);Z=t,pt(n)}(),it=0}}function gt(){var t=st.now(),e=t-ot;e>nt&&(at-=e,ot=t)}function pt(t){tt||(et&&(et=clearTimeout(et)),t-it>24?(t<1/0&&(et=setTimeout(ft,t-st.now()-at)),rt&&(rt=clearInterval(rt))):(rt||(ot=st.now(),rt=setInterval(gt,nt)),tt=1,ut(ft)))}lt.prototype=ct.prototype={constructor:lt,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?ht():+r)+(null==e?0:+e),this._next||Z===this||(Z?Z._next=this:Q=this,Z=this),this._call=t,this._time=r,pt()},stop:function(){this._call&&(this._call=null,this._time=1/0,pt())}};const vt=1664525,yt=1013904223,mt=4294967296;function wt(t){return t.x}function xt(t){return t.y}var Et=10,Nt=Math.PI*(3-Math.sqrt(5));function bt(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,a=.6,s=new Map,u=ct(l),h=X("tick","end"),d=function(){let t=1;return()=>(t=(vt*t+yt)%mt)/mt}();function l(){c(),h.call("tick",e),r<n&&(u.stop(),h.call("end",e))}function c(n){var u,h,d=t.length;void 0===n&&(n=1);for(var l=0;l<n;++l)for(r+=(i-r)*o,s.forEach((function(t){t(r)})),u=0;u<d;++u)null==(h=t[u]).fx?h.x+=h.vx*=a:(h.x=h.fx,h.vx=0),null==h.fy?h.y+=h.vy*=a:(h.y=h.fy,h.vy=0);return e}function f(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var o=Et*Math.sqrt(.5+r),i=r*Nt;e.x=o*Math.cos(i),e.y=o*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,d),e}return null==t&&(t=[]),f(),e={tick:c,restart:function(){return u.restart(l),e},stop:function(){return u.stop(),e},nodes:function(r){return arguments.length?(t=r,f(),s.forEach(g),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(d=t,s.forEach(g),e):d},force:function(t,r){return arguments.length>1?(null==r?s.delete(t):s.set(t,g(r)),e):s.get(t)},find:function(e,r,n){var o,i,a,s,u,h=0,d=t.length;for(null==n?n=1/0:n*=n,h=0;h<d;++h)(a=(o=e-(s=t[h]).x)*o+(i=r-s.y)*i)<n&&(u=s,n=a);return u},on:function(t,r){return arguments.length>1?(h.on(t,r),e):h.on(t)}}}function Mt(){var t,e,r,n,o,i=W(-30),a=1,s=1/0,u=.81;function h(r){var o,i=t.length,a=F(t,wt,xt).visitAfter(l);for(n=r,o=0;o<i;++o)e=t[o],a.visit(c)}function d(){if(t){var e,r,n=t.length;for(o=new Array(n),e=0;e<n;++e)r=t[e],o[r.index]=+i(r,e,t)}}function l(t){var e,r,n,i,a,s=0,u=0;if(t.length){for(n=i=a=0;a<4;++a)(e=t[a])&&(r=Math.abs(e.value))&&(s+=e.value,u+=r,n+=r*e.x,i+=r*e.y);t.x=n/u,t.y=i/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=o[e.data.index]}while(e=e.next)}t.value=s}function c(t,i,h,d){if(!t.value)return!0;var l=t.x-e.x,c=t.y-e.y,f=d-i,g=l*l+c*c;if(f*f/u<g)return g<s&&(0===l&&(g+=(l=$(r))*l),0===c&&(g+=(c=$(r))*c),g<a&&(g=Math.sqrt(a*g)),e.vx+=l*t.value*n/g,e.vy+=c*t.value*n/g),!0;if(!(t.length||g>=s)){(t.data!==e||t.next)&&(0===l&&(g+=(l=$(r))*l),0===c&&(g+=(c=$(r))*c),g<a&&(g=Math.sqrt(a*g)));do{t.data!==e&&(f=o[t.data.index]*n/g,e.vx+=l*f,e.vy+=c*f)}while(t=t.next)}}return h.initialize=function(e,n){t=e,r=n,d()},h.strength=function(t){return arguments.length?(i="function"==typeof t?t:W(+t),d(),h):i},h.distanceMin=function(t){return arguments.length?(a=t*t,h):Math.sqrt(a)},h.distanceMax=function(t){return arguments.length?(s=t*t,h):Math.sqrt(s)},h.theta=function(t){return arguments.length?(u=t*t,h):Math.sqrt(u)},h}function St(t){return t.index}function kt(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function At(t){var e,r,n,o,i,a,s=St,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},h=W(30),d=1;function l(n){for(var o=0,s=t.length;o<d;++o)for(var u,h,l,c,f,g,p,v=0;v<s;++v)h=(u=t[v]).source,c=(l=u.target).x+l.vx-h.x-h.vx||$(a),f=l.y+l.vy-h.y-h.vy||$(a),c*=g=((g=Math.sqrt(c*c+f*f))-r[v])/g*n*e[v],f*=g,l.vx-=c*(p=i[v]),l.vy-=f*p,h.vx+=c*(p=1-p),h.vy+=f*p}function c(){if(n){var a,u,h=n.length,d=t.length,l=new Map(n.map(((t,e)=>[s(t,e,n),t])));for(a=0,o=new Array(h);a<d;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=kt(l,u.source)),"object"!=typeof u.target&&(u.target=kt(l,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(a=0,i=new Array(d);a<d;++a)u=t[a],i[a]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);e=new Array(d),f(),r=new Array(d),g()}}function f(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+u(t[r],r,t)}function g(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+h(t[e],e,t)}return null==t&&(t=[]),l.initialize=function(t,e){n=t,a=e,c()},l.links=function(e){return arguments.length?(t=e,c(),l):t},l.id=function(t){return arguments.length?(s=t,l):s},l.iterations=function(t){return arguments.length?(d=+t,l):d},l.strength=function(t){return arguments.length?(u="function"==typeof t?t:W(+t),f(),l):u},l.distance=function(t){return arguments.length?(h="function"==typeof t?t:W(+t),g(),l):h},l}function _t(t){return t.x+t.vx}function zt(t){return t.y+t.vy}function Rt(t){var e,r,n,o=1,i=1;function a(){for(var t,a,u,h,d,l,c,f=e.length,g=0;g<i;++g)for(a=F(e,_t,zt).visitAfter(s),t=0;t<f;++t)u=e[t],l=r[u.index],c=l*l,h=u.x+u.vx,d=u.y+u.vy,a.visit(p);function p(t,e,r,i,a){var s=t.data,f=t.r,g=l+f;if(!s)return e>h+g||i<h-g||r>d+g||a<d-g;if(s.index>u.index){var p=h-s.x-s.vx,v=d-s.y-s.vy,y=p*p+v*v;y<g*g&&(0===p&&(y+=(p=$(n))*p),0===v&&(y+=(v=$(n))*v),y=(g-(y=Math.sqrt(y)))/y*o,u.vx+=(p*=y)*(g=(f*=f)/(c+f)),u.vy+=(v*=y)*g,s.vx-=p*(g=1-g),s.vy-=v*g)}}}function s(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var n,o,i=e.length;for(r=new Array(i),n=0;n<i;++n)o=e[n],r[o.index]=+t(o,n,e)}}return"function"!=typeof t&&(t=W(null==t?1:+t)),a.initialize=function(t,r){e=t,n=r,u()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(o=+t,a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:W(+e),u(),a):t},a}function It(t){var e,r,n,o=W(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=W(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:W(+t),a(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:W(+e),a(),i):t},i}function Dt(t){var e,r,n,o=W(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=W(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:W(+t),a(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:W(+e),a(),i):t},i}function Ot(){function t(t){return function(){return t}}var e,r=function(t){return t.cluster},n=t(1),o=t(-1),i=t(100),a=t(.1),u=[0,0],h=[],d={},l=[],c=100,f=100,g={none:{x:0,y:0}},p=[],v="force",y=!0,m=.1;function w(t){if(!y)return w;e.tick(),E();for(var n=0,o=h.length,i=void 0,a=t*m;n<o;++n)(i=h[n]).vx+=(g[r(i)].x-i.x)*a,i.vy+=(g[r(i)].y-i.y)*a}function x(){h&&function(){if(h&&h.length){if(void 0===r(h[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy(\'clusterAttr\') before calling .links()");var t,u,g,v,y,m=(t=[],u=[],g={},{},y=[],v=function(t){var e={};return t.forEach((function(t){var n=r(t);e[n]||(e[n]={count:0,sumforceNodeSize:0})})),t.forEach((function(t){var o=r(t),i=n(t),a=e[o];a.count=a.count+1,a.sumforceNodeSize=a.sumforceNodeSize+Math.PI*(i*i)*1.3,e[o]=a})),e}(h),y=function(t){var e={},n=[];return t.forEach((function(t){var n,o,i,a,s,u=(o=(n=t).source,i=n.target,(a=r(d[o]))<=(s=r(d[i]))?a+"~"+s:s+"~"+a),h=0;void 0!==e[u]&&(h=e[u]),h+=1,e[u]=h})),Object.entries(e).forEach((function(t){var e=s(t,2),r=e[0],o=e[1],i=r.split("~")[0],a=r.split("~")[1];void 0!==i&&void 0!==a&&n.push({source:i,target:a,count:o})})),n}(l),Object.keys(v).forEach((function(e,r){var n=v[e];t.push({id:e,size:n.count,r:Math.sqrt(n.sumforceNodeSize/Math.PI)}),g[e]=r})),y.forEach((function(t){var e=t.source,r=t.target,n=g[e],o=g[r];void 0!==n&&void 0!==o&&u.push({source:n,target:o,count:t.count})})),{nodes:t,links:u});e=bt(m.nodes).force("x",It(c).strength(.1)).force("y",Dt(f).strength(.1)).force("collide",Rt((function(t){return t.r})).iterations(4)).force("charge",Mt().strength(o)).force("links",At(m.nodes.length?m.links:[]).distance(i).strength(a)),p=e.nodes(),E()}}()}function E(){return g={none:{x:0,y:0}},p.forEach((function(t){g[t.id]={x:t.x-u[0],y:t.y-u[1]}})),g}return w.initialize=function(t){h=t,x()},w.template=function(t){return arguments.length?(v=t,x(),w):v},w.groupBy=function(t){return arguments.length?"string"==typeof t?(r=function(e){return e[t]},w):(r=t,w):r},w.enableGrouping=function(t){return arguments.length?(y=t,w):y},w.strength=function(t){return arguments.length?(m=t,w):m},w.centerX=function(t){return arguments.length?(c=t,w):c},w.centerY=function(t){return arguments.length?(f=t,w):f},w.nodes=function(t){return arguments.length?(function(t){d={},t.forEach((function(t){d[t.id]=t}))}(t||[]),h=t||[],w):h},w.links=function(t){return arguments.length?(l=t||[],x(),w):l},w.forceNodeSize=function(e){return arguments.length?(n="function"==typeof e?e:t(+e),x(),w):n},w.nodeSize=w.forceNodeSize,w.forceCharge=function(e){return arguments.length?(o="function"==typeof e?e:t(+e),x(),w):o},w.forceLinkDistance=function(e){return arguments.length?(i="function"==typeof e?e:t(+e),x(),w):i},w.forceLinkStrength=function(e){return arguments.length?(a="function"==typeof e?e:t(+e),x(),w):a},w.offset=function(t){return arguments.length?(u=t,w):u},w.getFocis=E,w}var Pt={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},Tt=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="d3force",this.options=n(n({},Pt),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){var t;null===(t=this.forceSimulation)||void 0===t||t.stop()},t.prototype.tick=function(t){var e=this;void 0===t&&(t=1),this.forceSimulation.tick(t);var r={nodes:Ct(this.lastLayoutNodes),edges:qt(this.lastLayoutEdges)};return this.lastAssign&&r.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,g,p,v,y,m,w,x,E,b,M,S,k,A,_,z,R,I,D=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=i.map((function(t){var e,r;return n(n({},N(t)),{x:null===(e=t.data)||void 0===e?void 0:e.x,y:null===(r=t.data)||void 0===r?void 0:r.y})})),h=s.map((function(t){return N(t)})),this.lastLayoutNodes=u,this.lastLayoutEdges=h,this.lastAssign=t,this.lastGraph=e,d=o.alphaMin,l=o.alphaDecay,c=o.alpha,f=o.nodeStrength,g=o.edgeStrength,p=o.linkDistance,v=o.clustering,y=o.clusterFociStrength,m=o.clusterEdgeDistance,w=o.clusterEdgeStrength,x=o.clusterNodeStrength,E=o.clusterNodeSize,b=o.collideStrength,M=void 0===b?1:b,S=o.center,k=void 0===S?[0,0]:S,A=o.preventOverlap,_=o.nodeSize,z=o.nodeSpacing,R=o.onTick,I=o.forceSimulation,[2,new Promise((function(r){if(I){v&&((i=Ot()).nodes(u),i.links(h)),I.nodes(u),h&&(s=At().id((function(t){return t.id})).links(h),g&&s.strength(g),p&&s.distance(p),I.force("link",s)),A&&D.overlapProcess(I,{nodeSize:_,nodeSpacing:z,collideStrength:M}),I.alpha(c).restart();var n=Ct(u),o=qt(h);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:o})}else try{var i,a=Mt();if(f&&a.strength(f),I=bt().nodes(u),v&&((i=Ot()).centerX(k[0]).centerY(k[1]).template("force").strength(y),h&&i.links(h),u&&i.nodes(u),i.forceLinkDistance(m).forceLinkStrength(w).forceCharge(x).forceNodeSize(E),I.force("group",i)),I.force("center",function(t,e){var r,n=1;function o(){var o,i,a=r.length,s=0,u=0;for(o=0;o<a;++o)s+=(i=r[o]).x,u+=i.y;for(s=(s/a-t)*n,u=(u/a-e)*n,o=0;o<a;++o)(i=r[o]).x-=s,i.y-=u}return null==t&&(t=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(n=+t,o):n},o}(k[0],k[1])).force("charge",a).alpha(c).alphaDecay(l).alphaMin(d),A&&D.overlapProcess(I,{nodeSize:_,nodeSpacing:z,collideStrength:M}),h){var s=At().id((function(t){return t.id})).links(h);g&&s.strength(g),p&&s.distance(p),I.force("link",s)}I.on("tick",(function(){var r=Ct(u);null==R||R({nodes:r,edges:qt(h)}),t&&r.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}))})).on("end",(function(){var n=Ct(u);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:qt(h)})}))}catch(t){console.warn(t)}D.forceSimulation=I}))]}))}))},t.prototype.overlapProcess=function(t,e){var r,n,o=e.nodeSize,i=e.nodeSpacing,a=e.collideStrength;if(n=x(i)?function(){return i}:b(i)?i:function(){return 0},o)if(b(o))r=function(t){return o(t)+n(t)};else if(g(o)){var s=(o[0]>o[1]?o[0]:o[1])/2;r=function(t){return s+n(t)}}else if(x(o)){var u=o/2;r=function(t){return u+n(t)}}else r=function(){return 10};else r=function(t){return t.size?g(t.size)?(t.size[0]>t.size[1]?t.size[0]:t.size[1])/2+n(t):M(t.size)?(t.size.width>t.size.height?t.size.width:t.size.height)/2+n(t):t.size/2+n(t):10+n(t)};t.force("collisionForce",Rt(r).strength(a))},t}(),Ct=function(t){return t.map((function(t){var e=t.x,r=t.y,i=o(t,["x","y"]);return n(n({},i),{data:n(n({},i.data),{x:e,y:r})})}))},qt=function(t){return t.map((function(t){var e=t.source,r=t.target,i=o(t,["source","target"]);return n(n({},i),{source:e.id,target:r.id})}))};var Lt=function(t,e){if("next"!==t&&"prev"!==t)return e},jt=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(function(){function t(){var t={};t.prev=t,t.next=t.prev,this.shortcut=t}return t.prototype.dequeue=function(){var t=this.shortcut,e=t.prev;if(e&&e!==t)return jt(e),e},t.prototype.enqueue=function(t){var e=this.shortcut;t.prev&&t.next&&jt(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e},t.prototype.toString=function(){for(var t=[],e=this.shortcut,r=e.prev;r!==e;)t.push(JSON.stringify(r,Lt)),r=null==r?void 0:r.prev;return"["+t.join(", ")+"]"},t}()),Vt=function(){return 1},Bt=function(t,e,r,o,i){var a,s,u=[];return t.hasNode(o.v)&&(null===(a=t.getRelatedEdges(o.v,"in"))||void 0===a||a.forEach((function(o){var a=o.data.weight,s=t.getNode(o.source);i&&u.push({v:o.source,w:o.target,in:0,out:0}),void 0===s.data.out&&(s.data.out=0),s.data.out-=a,Gt(e,r,n({v:s.id},s.data))})),null===(s=t.getRelatedEdges(o.v,"out"))||void 0===s||s.forEach((function(o){var i=o.data.weight,a=o.target,s=t.getNode(a);void 0===s.data.in&&(s.data.in=0),s.data.in-=i,Gt(e,r,n({v:s.id},s.data))})),t.removeNode(o.v)),i?u:void 0},Gt=function(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},Wt=function(t,e){var r="greedy"===e?function(t,e){var r;if(t.getAllNodes().length<=1)return[];var o=function(t,e){var r=new c,o=0,i=0;t.getAllNodes().forEach((function(t){r.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((function(t){var a=r.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target})),s=(null==e?void 0:e(t))||1;a?r.updateEdgeData(null==a?void 0:a.id,n(n({},a.data),{weight:a.data.weight+s})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:s}}),i=Math.max(i,r.getNode(t.source).data.out+=s),o=Math.max(o,r.getNode(t.target).data.in+=s)}));for(var a=[],s=i+o+3,u=0;u<s;u++)a.push(new Ft);var h=o+1;return r.getAllNodes().forEach((function(t){Gt(a,h,n({v:t.id},r.getNode(t.id).data))})),{buckets:a,zeroIdx:h,graph:r}}(t,function(t){return t.data.weight||1}||Vt);return null===(r=function(t,e,r){for(var n,o=[],i=e[e.length-1],a=e[0];t.getAllNodes().length;){for(;n=a.dequeue();)Bt(t,e,r,n);for(;n=i.dequeue();)Bt(t,e,r,n);if(t.getAllNodes().length)for(var s=e.length-2;s>0;--s)if(n=e[s].dequeue()){o=o.concat(Bt(t,e,r,n,!0));break}}return o}(o.graph,o.buckets,o.zeroIdx).map((function(e){return t.getRelatedEdges(e.v,"out").filter((function(t){return t.target===e.w}))})))||void 0===r?void 0:r.flat()}(t):$t(t);null==r||r.forEach((function(e){var r=e.data;t.removeEdge(e.id),r.forwardName=e.data.name,r.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:n({},r)})}))},$t=function(t){var e=[],r={},n={},o=function(i){n[i]||(n[i]=!0,r[i]=!0,t.getRelatedEdges(i,"out").forEach((function(t){r[t.target]?e.push(t):o(t.target)})),delete r[i])};return t.getAllNodes().forEach((function(t){return o(t.id)})),e},Ut=function(t,e,r,n){var o;do{o=""+n+Math.random()}while(t.hasNode(o));return r.dummy=e,t.addNode({id:o,data:r}),o},Ht=function(t){var e=new c;return t.getAllNodes().forEach((function(r){t.getChildren(r.id).length||e.addNode(n({},r))})),t.getAllEdges().forEach((function(t){e.addEdge(t)})),e},Kt=function(t,e){var r,n,o=Number(t.x),i=Number(t.y),a=Number(e.x)-o,s=Number(e.y)-i,u=Number(t.width)/2,h=Number(t.height)/2;return a||s?(Math.abs(s)*u>Math.abs(a)*h?(s<0&&(h=-h),r=h*a/s,n=h):(a<0&&(u=-u),r=u,n=u*s/a),{x:o+r,y:i+n}):{x:0,y:0}},Yt=function(t){for(var e=[],r=Xt(t)+1,n=0;n<r;n++)e.push([]);for(t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)})),n=0;n<r;n++)e[n]=e[n].sort((function(e,r){return n=t.getNode(e).data.order,o=t.getNode(r).data.order,Number(n)-Number(o);var n,o}));return e},Jt=function(t,e,r,n){var o={width:0,height:0};return x(r)&&x(n)&&(o.rank=r,o.order=n),Ut(t,"border",o,e)},Xt=function(t){var e;return t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)})),e||(e=0),e},Qt=function(t,e){return t.reduce((function(t,r){return e(t)>e(r)?r:t}))},Zt=function(t,e,r,n,o,i){n.includes(e.id)||(n.push(e.id),r||i.push(e.id),o(e.id).forEach((function(e){return Zt(t,e,r,n,o,i)})),r&&i.push(e.id))},te=function(t,e,r,n){var o=Array.isArray(e)?e:[e],i=function(e){return n?t.getSuccessors(e):t.getNeighbors(e)},a=[],s=[];return o.forEach((function(e){if(!t.hasNode(e.id))throw new Error("Graph does not have node: "+e);Zt(t,e,"post"===r,s,i,a)})),a},ee="edge-label",re=function(t){var e={},r=function(n){var o,i,a=t.getNode(n);return a?e[n]?a.data.rank:(e[n]=!0,null===(o=t.getRelatedEdges(n,"out"))||void 0===o||o.forEach((function(t){var e=r(t.target)-t.data.minlen;e&&(void 0===i||e<i)&&(i=e)})),i||(i=0),a.data.rank=i,i):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){return r(t.id)}))},ne=function(t,e){return t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen},oe=function(t,e){var r=function(n){e.getRelatedEdges(n,"both").forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ie=function(t,e){var r=function(n){var o;null===(o=e.getRelatedEdges(n,"both"))||void 0===o||o.forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||void 0===e.getNode(a).data.layer&&ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ae=function(t,e){return Qt(e.getAllEdges(),(function(r){return t.hasNode(r.source)!==t.hasNode(r.target)?ne(e,r):1/0}))},se=function(t,e,r){t.getAllNodes().forEach((function(t){var n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r}))},ue=function(t,e){var r=te(t,t.getAllNodes(),"post",!1);(r=r.slice(0,(null==r?void 0:r.length)-1)).forEach((function(r){he(t,e,r)}))},he=function(t,e,r){var n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find((function(t){return t.target===n||t.source===n})).data.cutvalue=de(t,e,r)},de=function(t,e,r){var n=t.getNode(r).data.parent,o=!0,i=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),a=0;return i||(o=!1,i=e.getRelatedEdges(n,"out").find((function(t){return t.target===r}))),a=i.data.weight,e.getRelatedEdges(r,"both").forEach((function(e){var i=e.source===r,s=i?e.target:e.source;if(s!==n){var u=i===o,h=e.data.weight;if(a+=u?h:-h,ye(t,r,s)){var d=t.getRelatedEdges(r,"both").find((function(t){return t.source===s||t.target===s})).data.cutvalue;a+=u?-d:d}}})),a},le=function(t,e){void 0===e&&(e=t.getAllNodes()[0].id),ce(t,{},1,e)},ce=function(t,e,r,n,o){var i,a=r,s=r,u=t.getNode(n);return e[n]=!0,null===(i=t.getNeighbors(n))||void 0===i||i.forEach((function(r){e[r.id]||(s=ce(t,e,s,r.id,n))})),u.data.low=a,u.data.lim=s++,o?u.data.parent=o:delete u.data.parent,s},fe=function(t){return t.getAllEdges().find((function(t){return t.data.cutvalue<0}))},ge=function(t,e,r){var n=r.source,o=r.target;e.getRelatedEdges(n,"out").find((function(t){return t.target===o}))||(n=r.target,o=r.source);var i=t.getNode(n),a=t.getNode(o),s=i,u=!1;i.data.lim>a.data.lim&&(s=a,u=!0);var h=e.getAllEdges().filter((function(e){return u===me(t.getNode(e.source),s)&&u!==me(t.getNode(e.target),s)}));return Qt(h,(function(t){return ne(e,t)}))},pe=function(t,e,r,n){var o=t.getRelatedEdges(r.source,"both").find((function(t){return t.source===r.target||t.target===r.target}));o&&t.removeEdge(o.id),t.addEdge({id:"e"+Math.random(),source:n.source,target:n.target,data:{}}),le(t),ue(t,e),ve(t,e)},ve=function(t,e){var r=t.getAllNodes().find((function(t){return!t.data.parent})),n=te(t,r,"pre",!1);(n=n.slice(1)).forEach((function(r){var n=t.getNode(r).data.parent,o=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),i=!1;!o&&e.hasNode(n)&&(o=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),i=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(i?null==o?void 0:o.data.minlen:-(null==o?void 0:o.data.minlen))}))},ye=function(t,e,r){return t.getRelatedEdges(e,"both").find((function(t){return t.source===r||t.target===r}))},me=function(t,e){return e.data.low<=t.data.lim&&t.data.lim<=e.data.lim},we=re,xe=function(t){!function(t){var e=function(t){var e=new c;return t.getAllNodes().forEach((function(t){e.addNode(n({},t))})),t.getAllEdges().forEach((function(t){var r=e.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target}));r?e.updateEdgeData(null==r?void 0:r.id,n(n({},r.data),{weight:r.data.weight+t.data.weight||0,minlen:Math.max(r.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e}(t);re(e);var r,o,i=function(t){var e,r,n=new c({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);oe(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r);return n}(e);for(le(i),ue(i,e);r=fe(i);)o=ge(i,e,r),pe(i,e,r,o)}(t)},Ee=function(t,e,r,n,o,i,a){var s=t.getChildren(a);if(null==s?void 0:s.length){var u=Jt(t,"_bt"),h=Jt(t,"_bb"),d=t.getNode(a);t.setParent(u,a),d.data.borderTop=u,t.setParent(h,a),d.data.borderBottom=h,null==s||s.forEach((function(s){Ee(t,e,r,n,o,i,s.id);var d=s.data.borderTop?s.data.borderTop:s.id,l=s.data.borderBottom?s.data.borderBottom:s.id,c=s.data.borderTop?n:2*n,f=d!==l?1:o-i[a]+1;t.addEdge({id:"e"+Math.random(),source:u,target:d,data:{minlen:f,weight:c,nestingEdge:!0}}),t.addEdge({id:"e"+Math.random(),source:l,target:h,data:{minlen:f,weight:c,nestingEdge:!0}})})),t.getParent(a)||t.addEdge({id:"e"+Math.random(),source:e,target:u,data:{weight:0,minlen:o+i[a]}})}else a!==e&&t.addEdge({id:"e"+Math.random(),source:e,target:a,data:{weight:0,minlen:r}})},Ne=function(t,e,r,n,o,i){var a={rank:i,borderType:e,width:0,height:0},s=o.data[e][i-1],u=Ut(t,"border",a,r);o.data[e][i]=u,t.setParent(u,n),s&&t.addEdge({id:"e"+Math.random(),source:s,target:u,data:{weight:1}})},be=function(t){t.getAllNodes().forEach((function(t){Me(t)})),t.getAllEdges().forEach((function(t){Me(t)}))},Me=function(t){var e=t.data.width;t.data.width=t.data.height,t.data.height=e},Se=function(t){(null==t?void 0:t.y)&&(t.y=-t.y)},ke=function(t){var e=t.x;t.x=t.y,t.y=e},Ae=function(t){for(var e={},r=t.getAllNodes(),n=r.map((function(t){var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),o=Math.max.apply(Math,u([],s(n))),i=[],a=0;a<o+1;a++)i.push([]);var h=r.sort((function(e,r){return t.getNode(e.id).data.rank-t.getNode(r.id).data.rank})),d=h.filter((function(e){return void 0!==t.getNode(e.id).data.fixorder})).sort((function(e,r){return t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder}));return null==d||d.forEach((function(r){isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0})),null==h||h.forEach((function(r){return t.dfsTree(r.id,(function(t){if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)}))})),i},_e=function(t,e,r){for(var n=function(t,e){return null==t?void 0:t.reduce((function(t,r,n){return t[r]=e[n],t}),{})}(r,r.map((function(t,e){return e}))),o=e.map((function(e){var r=t.getRelatedEdges(e,"out").map((function(t){return{pos:n[t.target]||0,weight:t.data.weight}}));return null==r?void 0:r.sort((function(t,e){return t.pos-e.pos}))})),i=o.flat().filter((function(t){return void 0!==t})),a=1;a<r.length;)a<<=1;var s=2*a-1;a-=1;var u=Array(s).fill(0,0,s),h=0;return null==i||i.forEach((function(t){if(t){var e=t.pos+a;u[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=u[e+1]),u[e=e-1>>1]+=t.weight;h+=t.weight*r}})),h},ze=function(t,e){for(var r=0,n=1;n<(null==e?void 0:e.length);n+=1)r+=_e(t,e[n-1],e[n]);return r},Re=function(t,e){var r,n=0,o=0;t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/o,t.weight=o,t.i=Math.min(e.i,t.i),e.merged=!0};const Ie=function(t,e){var r,n,o,i={};return null==t||t.forEach((function(t,e){i[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};var r=i[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)})),null===(r=e.getAllEdges())||void 0===r||r.forEach((function(t){var e=i[t.source],r=i[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(i[t.target]))})),function(t){for(var e,r,n=[],o=function(){var o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach((function(t){return(e=o,function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&Re(e,t)})(t);var e})),null===(r=o.out)||void 0===r||r.forEach((function(e){return(r=o,function(e){e.in.push(r),0==--e.indegree&&t.push(e)})(e);var r}))};null==t?void 0:t.length;)o();var i=n.filter((function(t){return!t.merged})),a=["vs","i","barycenter","weight"];return i.map((function(t){var e={};return null==a||a.forEach((function(r){void 0!==t[r]&&(e[r]=t[r])})),e}))}(null===(o=(n=Object.values(i)).filter)||void 0===o?void 0:o.call(n,(function(t){return!t.indegree})))};var De=function(t,e,r){for(var n,o=r;e.length&&(n=e[e.length-1]).i<=o;)e.pop(),null==t||t.push(n.vs),o++;return o},Oe=function(t,e,r,n,o,i){var a,s,u,h,d=t.getChildren(e).map((function(t){return t.id})),l=t.getNode(e),c=l?l.data.borderLeft:void 0,f=l?l.data.borderRight:void 0,g={};c&&(d=null==d?void 0:d.filter((function(t){return t!==c&&t!==f})));var p=function(t,e){return e.map((function(e){var r=t.getRelatedEdges(e,"in");if(!(null==r?void 0:r.length))return{v:e};var n={sum:0,weight:0};return null==r||r.forEach((function(e){var r=t.getNode(e.source);n.sum+=e.data.weight*r.data.order,n.weight+=e.data.weight})),{v:e,barycenter:n.sum/n.weight,weight:n.weight}}))}(t,d||[]);null==p||p.forEach((function(e){var o;if(null===(o=t.getChildren(e.v))||void 0===o?void 0:o.length){var a=Oe(t,e.v,r,n,i);g[e.v]=a,a.hasOwnProperty("barycenter")&&Te(e,a)}}));var v=Ie(p,r);Pe(v,g),null===(a=v.filter((function(t){return t.vs.length>0})))||void 0===a||a.forEach((function(e){var r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)}));var y=function(t,e,r,n){var o=function(t,e){var r={lhs:[],rhs:[]};return null==t||t.forEach((function(t){var e,o;o=(e=t).hasOwnProperty("fixorder")&&!isNaN(e.fixorder),(n?!o&&e.hasOwnProperty("barycenter"):o||e.hasOwnProperty("barycenter"))?r.lhs.push(t):r.rhs.push(t)})),r}(t),i=o.lhs,a=o.rhs.sort((function(t,e){return-t.i- -e.i})),s=[],u=0,h=0,d=0;null==i||i.sort(function(t,e){return function(r,n){if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i}}(!!e,!!r)),d=De(s,a,d),null==i||i.forEach((function(t){var e;d+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),u+=t.barycenter*t.weight,h+=t.weight,d=De(s,a,d)}));var l={vs:s.flat()};return h&&(l.barycenter=u/h,l.weight=h),l}(v,n,o,i);if(c&&(y.vs=[c,y.vs,f].flat(),null===(s=t.getPredecessors(c))||void 0===s?void 0:s.length)){var m=t.getNode((null===(u=t.getPredecessors(c))||void 0===u?void 0:u[0].id)||""),w=t.getNode((null===(h=t.getPredecessors(f))||void 0===h?void 0:h[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+w.data.order)/(y.weight+2),y.weight+=2}return y},Pe=function(t,e){null==t||t.forEach((function(t){var r,n=null===(r=t.vs)||void 0===r?void 0:r.map((function(t){return e[t]?e[t].vs:t}));t.vs=n.flat()}))},Te=function(t,e){void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},Ce=function(t){if("object"!=typeof t||null===t)return t;var e,r;if(r=t,Array.isArray?Array.isArray(r):w(r,"Array")){e=[];for(var n=0,o=t.length;n<o;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=Ce(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=Ce(t[i]):e[i]=t[i];return e};const qe=Ce;var Le=function(t,e,r){return e.map((function(e){return function(t,e,r){var o=function(t){for(var e;t.hasNode(e="_root"+Math.random()););return e}(t),i=new c({tree:[{id:o,children:[],data:{}}]});return t.getAllNodes().forEach((function(a){var s=t.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(n({},a)),(null==s?void 0:s.id)&&!i.hasNode(null==s?void 0:s.id)&&i.addNode(n({},s)),i.setParent(a.id,(null==s?void 0:s.id)||o),t.getRelatedEdges(a.id,r).forEach((function(e){var r=e.source===a.id?e.target:e.source;i.hasNode(r)||i.addNode(n({},t.getNode(r)));var o=i.getRelatedEdges(r,"out").find((function(t){return t.target===a.id})),s=void 0!==o?o.data.weight:0;o?i.updateEdgeData(o.id,n(n({},o.data),{weight:e.data.weight+s})):i.addEdge({id:e.id,source:r,target:a.id,data:{weight:e.data.weight+s}})})),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,n(n({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))})),i}(t,e,r)}))},je=function(t,e,r,n){var o=new c;null==t||t.forEach((function(t){for(var i,a=t.getRoots()[0].id,s=Oe(t,a,o,e,r,n),u=0;u<(null===(i=s.vs)||void 0===i?void 0:i.length);u++){var h=t.getNode(s.vs[u]);h&&(h.data.order=u)}!function(t,e,r){var n,o={};null==r||r.forEach((function(r){for(var i,a,s=t.getParent(r);s;){if((i=t.getParent(s.id))?(a=o[i.id],o[i.id]=s.id):(a=n,n=s.id),a&&a!==s.id)return e.addNodes([{id:a,data:{}},{id:s.id,data:{}}]),void e.addEdge({id:"e"+a+"-"+s.id,source:a,target:s.id,data:{}});s=i}}))}(t,o,s.vs)}))},Fe=function(t,e){null==e||e.forEach((function(e){null==e||e.forEach((function(e,r){t.getNode(e).data.order=r}))}))},Ve=function(t,e){var r={};function n(e,n,o,i,a){for(var s,u,h,d=n;d<o;d++)h=e[d],(null===(s=t.getNode(h))||void 0===s?void 0:s.data.dummy)&&(null===(u=t.getPredecessors(h))||void 0===u||u.forEach((function(e){var n=t.getNode(e.id);n.data.dummy&&(n.data.order<i||n.data.order>a)&&Ge(r,e.id,h)})))}function o(t,e){var r=function(t){return JSON.stringify(t.slice(1))}(t);e.get(r)||(n.apply(void 0,u([],s(t))),e.set(r,!0))}return(null==e?void 0:e.length)&&e.reduce((function(e,r){var n,i=-1,a=0,s=new Map;return null==r||r.forEach((function(u,h){var d;if("border"===(null===(d=t.getNode(u))||void 0===d?void 0:d.data.dummy)){var l=t.getPredecessors(u)||[];l.length&&(n=t.getNode(l[0].id).data.order,o([r,a,h,i,n],s),a=h,i=n)}o([r,a,r.length,n,e.length],s)})),r})),r},Be=function(t,e){var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find((function(e){return t.getNode(e.id).data.dummy}))},Ge=function(t,e,r){var n=e,o=r;if(n>o){var i=n;n=o,o=i}var a=t[n];a||(t[n]=a={}),a[o]=!0},We=function(t,e,r){var n=e;return n>r&&(n=r),!!t[n]},$e=function(t,e,r,o,i,a){var s=new c,u=Ue(o,i,a);return null==e||e.forEach((function(e){var o;null==e||e.forEach((function(e){var i=r[e];if(s.hasNode(i)||s.addNode({id:i,data:{}}),o){var a=r[o],h=s.getRelatedEdges(a,"out").find((function(t){return t.target===i}));h?s.updateEdgeData(h.id,n(n({},h.data),{weight:Math.max(u(t,e,o),h.data.weight||0)})):s.addEdge({id:"e"+Math.random(),source:a,target:i,data:{weight:Math.max(u(t,e,o),0)}})}o=e}))})),s};var Ue=function(t,e,r){return function(n,o,i){var a=n.getNode(o),s=n.getNode(i),u=0,h=0;if(u+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":h=-a.data.width/2;break;case"r":h=a.data.width/2}if(h&&(u+=r?h:-h),h=0,u+=(a.data.dummy?e:t)/2,u+=(s.data.dummy?e:t)/2,u+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":h=s.data.width/2;break;case"r":h=-s.data.width/2}return h&&(u+=r?h:-h),h=0,u}},He=function(t,e){return t.getNode(e).data.width||0},Ke=function(t,e){var r,n=Ht(t);!function(t,e){var r=(e||{}).ranksep,n=void 0===r?0:r,o=Yt(t),i=0;null==o||o.forEach((function(e){var r=e.map((function(e){return t.getNode(e).data.height})),o=Math.max.apply(Math,u(u([],s(r)),[0]));null==e||e.forEach((function(e){t.getNode(e).data.y=i+o/2})),i+=o+n}))}(n,e);var o=function(t,e){var r=e||{},n=r.align,o=r.nodesep,i=void 0===o?0:o,a=r.edgesep,h=void 0===a?0:a,d=Yt(t),l=Object.assign(function(t,e){var r={};return(null==e?void 0:e.length)&&e.reduce((function(e,n){var o=0,i=0,a=e.length,s=null==n?void 0:n[(null==n?void 0:n.length)-1];return null==n||n.forEach((function(e,u){var h,d=Be(t,e),l=d?t.getNode(d.id).data.order:a;(d||e===s)&&(null===(h=n.slice(i,u+1))||void 0===h||h.forEach((function(e){var n;null===(n=t.getPredecessors(e))||void 0===n||n.forEach((function(n){var i,a=t.getNode(n.id),s=a.data.order;!(s<o||l<s)||a.data.dummy&&(null===(i=t.getNode(e))||void 0===i?void 0:i.data.dummy)||Ge(r,n.id,e)}))})),i=u+1,o=l)})),n})),r}(t,d),Ve(t,d)),c={},f=[];["u","d"].forEach((function(e){f="u"===e?d:Object.values(d).reverse(),["l","r"].forEach((function(r){"r"===r&&(f=f.map((function(t){return Object.values(t).reverse()})));var n=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),o=function(t,e,r,n){var o={},i={},a={};return null==e||e.forEach((function(t){null==t||t.forEach((function(t,e){o[t]=t,i[t]=t,a[t]=e}))})),null==e||e.forEach((function(t){var e=-1;null==t||t.forEach((function(t){var s=n(t).map((function(t){return t.id}));if(s.length){s=s.sort((function(t,e){return a[t]-a[e]}));for(var u=(s.length-1)/2,h=Math.floor(u),d=Math.ceil(u);h<=d;++h){var l=s[h];i[t]===t&&e<a[l]&&!We(r,t,l)&&(i[l]=t,i[t]=o[t]=o[l],e=a[l])}}}))})),{root:o,align:i}}(0,f,l,n),a=function(t,e,r,n,o,i,a){var s,u={},h=$e(t,e,r,o,i,a),d=a?"borderLeft":"borderRight",l=function(t,e){for(var r=h.getAllNodes(),n=r.pop(),o={};n;)o[n.id]?t(n.id):(o[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return l((function(t){u[t]=(h.getRelatedEdges(t,"in")||[]).reduce((function(t,e){return Math.max(t,(u[e.source]||0)+e.data.weight)}),0)}),h.getPredecessors.bind(h)),l((function(e){var r=(h.getRelatedEdges(e,"out")||[]).reduce((function(t,e){return Math.min(t,(u[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==d&&(u[e]=Math.max(u[e],r))}),h.getSuccessors.bind(h)),null===(s=Object.values(n))||void 0===s||s.forEach((function(t){u[t]=u[r[t]]})),u}(t,f,o.root,o.align,i,h,"r"===r);"r"===r&&Object.keys(a).forEach((function(t){return a[t]=-a[t]})),c[e+r]=a}))}));var g=function(t,e){return Qt(Object.values(e),(function(e){var r,n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach((function(r){var i=e[r],a=He(t,r)/2;n=Math.max(i+a,n),o=Math.min(i-a,o)})),n-o}))}(t,c);return g&&function(t,e){var r=Object.values(e),n=Math.min.apply(Math,u([],s(r))),o=Math.max.apply(Math,u([],s(r)));["u","d"].forEach((function(r){["l","r"].forEach((function(i){var a,h=r+i,d=t[h];if(d!==e){var l=Object.values(d);(a="l"===i?n-Math.min.apply(Math,u([],s(l))):o-Math.max.apply(Math,u([],s(l))))&&(t[h]={},Object.keys(d).forEach((function(e){t[h][e]=d[e]+a})))}}))}))}(c,g),function(t,e){var r={};return Object.keys(t.ul).forEach((function(n){if(e)r[n]=t[e.toLowerCase()][n];else{var o=Object.values(t).map((function(t){return t[n]}));r[n]=(o[0]+o[1])/2}})),r}(c,n)}(n,e);null===(r=Object.keys(o))||void 0===r||r.forEach((function(t){n.getNode(t).data.x=o[t]}))},Ye=function(t,e){var r=e.acyclicer,o=e.ranker,i=e.rankdir,a=void 0===i?"tb":i,h=e.nodeOrder,d=e.keepNodeOrder,l=e.align,f=e.nodesep,g=void 0===f?50:f,p=e.edgesep,v=void 0===p?20:p,y=e.ranksep,m=void 0===y?50:y;hr(t),Wt(t,r);var w=function(t){var e=Ut(t,"root",{},"_root"),r=function(t){var e={},r=function(n,o){var i=t.getChildren(n);null==i||i.forEach((function(t){return r(t.id,o+1)})),e[n]=o};return t.getRoots().forEach((function(t){return r(t.id,1)})),e}(t),n=Math.max.apply(Math,u([],s(Object.values(r))));Math.abs(n)===1/0&&(n=1);var o=n-1,i=2*o+1;t.getAllEdges().forEach((function(t){t.data.minlen*=i}));var a=function(t){var e=0;return t.getAllEdges().forEach((function(t){e+=t.data.weight})),e}(t)+1;return t.getRoots().forEach((function(n){Ee(t,e,i,a,o,r,n.id)})),{nestingRoot:e,nodeRankFactor:i}}(t),x=w.nestingRoot,E=w.nodeRankFactor;!function(t,e){switch(e){case"network-simplex":xe(t);break;case"tight-tree":default:!function(t){!function(t){var e,r={},n=function(o){var i,a,s=t.getNode(o);return s?r[o]?s.data.rank:(r[o]=!0,null===(i=t.getRelatedEdges(o,"out"))||void 0===i||i.forEach((function(t){var e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),(void 0===e||a<e)&&(e=a),s.data.rank=a,a):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){t&&n(t.id)})),void 0===e&&(e=0);var o={},i=function(e,r){var n,a=t.getNode(e),s=isNaN(a.data.layer)?r:a.data.layer;(void 0===a.data.rank||a.data.rank<s)&&(a.data.rank=s),o[e]||(o[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach((function(t){i(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((function(t){var r=t.data;r&&(isNaN(r.layer)?r.rank-=e:i(t.id,r.layer))}))}(t),function(t){var e,r,n=new c({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);ie(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r)}(t)}(t);break;case"longest-path":we(t)}}(Ht(t),o),er(t),function(t,e){void 0===e&&(e=0);var r=t.getAllNodes(),n=r.filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),o=Math.min.apply(Math,u([],s(n))),i=[];r.forEach((function(t){var e=(t.data.rank||0)-o;i[e]||(i[e]=[]),i[e].push(t.id)}));for(var a=0,h=0;h<i.length;h++){var d=i[h];void 0===d?h%e!=0&&(a-=1):a&&(null==d||d.forEach((function(e){var r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=a)})))}}(t,E),function(t,e){e&&t.removeNode(e),t.getAllEdges().forEach((function(e){e.data.nestingEdge&&t.removeEdge(e.id)}))}(t,x),function(t){var e=t.getAllNodes().filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),r=Math.min.apply(Math,u([],s(e)));t.getAllNodes().forEach((function(t){t.data.hasOwnProperty("rank")&&r!==1/0&&(t.data.rank-=r)}))}(t),rr(t),nr(t);var N=[];!function(t,e){t.getAllEdges().forEach((function(r){return function(t,e,r){var n=e.source,o=t.getNode(n).data.rank,i=e.target,a=t.getNode(i).data.rank,s=e.data.labelRank;if(a!==o+1){var u,h,d;for(t.removeEdge(e.id),d=0,++o;o<a;++d,++o)e.data.points=[],u=Ut(t,"edge",h={originalEdge:e,width:0,height:0,rank:o},"_d"),o===s&&(h.width=e.data.width,h.height=e.data.height,h.dummy=ee,h.labelpos=e.data.labelpos),t.addEdge({id:"e"+Math.random(),source:n,target:u,data:{weight:e.data.weight}}),0===d&&r.push(u),n=u;t.addEdge({id:"e"+Math.random(),source:n,target:i,data:{weight:e.data.weight}})}}(t,r,e)}))}(t,N),function(t,e){var r=function(t){var e={},r=0,n=function(o){var i=r;t.getChildren(o).forEach((function(t){return n(t.id)})),e[o]={low:i,lim:r++}};return t.getRoots().forEach((function(t){return n(t.id)})),e}(t);e.forEach((function(e){var n,o,i=e,a=t.getNode(i),s=a.data.originalEdge;if(s)for(var u=function(t,e,r,n){var o,i,a,s,u=[],h=[],d=Math.min(e[r].low,e[n].low),l=Math.max(e[r].lim,e[n].lim);a=r;do{a=null===(o=t.getParent(a))||void 0===o?void 0:o.id,u.push(a)}while(a&&(e[a].low>d||l>e[a].lim));for(s=a,a=n;a&&a!==s;)h.push(a),a=null===(i=t.getParent(a))||void 0===i?void 0:i.id;return{lca:s,path:u.concat(h.reverse())}}(t,r,s.source,s.target),h=u.path,d=u.lca,l=0,c=h[l],f=!0;i!==s.target;){if(a=t.getNode(i),f){for(;c!==d&&(null===(n=t.getNode(c))||void 0===n?void 0:n.data.maxRank)<a.data.rank;)c=h[++l];c===d&&(f=!1)}if(!f){for(;l<h.length-1&&(null===(o=t.getNode(h[l+1]))||void 0===o?void 0:o.data.minRank)<=a.data.rank;)l++;c=h[l]}t.hasNode(c)&&t.setParent(i,c),i=t.getSuccessors(i)[0].id}}))}(t,N),function(t){var e=function(r){var n=t.getChildren(r),o=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach((function(t){return e(t.id)})),o.data.hasOwnProperty("minRank")){o.data.borderLeft=[],o.data.borderRight=[];for(var i=o.data.minRank,a=o.data.maxRank+1;i<a;i+=1)Ne(t,"borderLeft","_bl",r,o,i),Ne(t,"borderRight","_br",r,o,i)}};t.getRoots().forEach((function(t){return e(t.id)}))}(t),d&&function(t,e){for(var r=t.getAllNodes().filter((function(e){var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)})).map((function(t){return t.data.rank})),n=Math.max.apply(Math,u([],s(r))),o=[],i=0;i<n+1;i++)o[i]=[];null==e||e.forEach((function(e){var r=t.getNode(e);r&&!r.data.dummy&&(isNaN(r.data.rank)||(r.data.fixorder=o[r.data.rank].length,o[r.data.rank].push(e)))}))}(t,h),function(t,e){for(var r=Xt(t),n=[],o=[],i=1;i<r+1;i++)n.push(i);for(i=r-1;i>-1;i--)o.push(i);var a=Le(t,n,"in"),s=Le(t,o,"out"),u=Ae(t);Fe(t,u);for(var h,d=Number.POSITIVE_INFINITY,l=(i=0,0);l<4;++i,++l)je(i%2?a:s,i%4>=2,!1,e),u=Yt(t),(c=ze(t,u))<d&&(l=0,h=qe(u),d=c);for(u=Ae(t),Fe(t,u),i=0,l=0;l<4;++i,++l){var c;je(i%2?a:s,i%4>=2,!0,e),u=Yt(t),(c=ze(t,u))<d&&(l=0,h=qe(u),d=c)}Fe(t,h)}(t,d),dr(t),function(t,e){var r=e.toLowerCase();"lr"!==r&&"rl"!==r||be(t)}(t,a),Ke(t,{align:l,nodesep:g,edgesep:v,ranksep:m}),lr(t),ur(t),function(t,e){e.forEach((function(e){var r,n=t.getNode(e),o=n.data.originalEdge;o&&t.addEdge(o);for(var i=e;n.data.dummy;)r=t.getSuccessors(i)[0],t.removeNode(i),o.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===ee&&(o.data.x=n.data.x,o.data.y=n.data.y,o.data.width=n.data.width,o.data.height=n.data.height),i=r.id,n=t.getNode(i)}))}(t,N),ar(t),function(t,e){var r=e.toLowerCase();"bt"!==r&&"rl"!==r||function(t){t.getAllNodes().forEach((function(t){Se(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return Se(t)})),t.data.hasOwnProperty("y")&&Se(t.data)}))}(t),"lr"!==r&&"rl"!==r||(function(t){t.getAllNodes().forEach((function(t){ke(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return ke(t)})),t.data.hasOwnProperty("x")&&ke(t.data)}))}(t),be(t))}(t,a);var b=or(t),M=b.width,S=b.height;return ir(t),sr(t),function(t){t.getAllEdges().forEach((function(e){var r=e.data;if(r.reversed){t.removeEdge(e.id);var o=r.forwardName;delete r.reversed,delete r.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:n(n({},r),{forwardName:o})})}}))}(t),{width:M,height:S}},Je=["width","height","layer","fixorder"],Xe={width:0,height:0},Qe=["minlen","weight","width","height","labeloffset"],Ze={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},tr=["labelpos"],er=function(t){t.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var r=t.getNode(e.source),n={e,rank:(t.getNode(e.target).data.rank-r.data.rank)/2+r.data.rank};Ut(t,"edge-proxy",n,"_ep")}}))},rr=function(t){var e=0;return t.getAllNodes().forEach((function(r){var n,o;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(o=t.getNode(r.data.borderBottom))||void 0===o?void 0:o.data.rank,e=Math.max(e,r.data.maxRank||-1/0))})),e},nr=function(t){t.getAllNodes().forEach((function(e){"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},or=function(t,e){var r,n,o=0,i=0,a=e||{},s=a.marginx,u=void 0===s?0:s,h=a.marginy,d=void 0===h?0:h,l=function(t){if(t.data){var e=t.data.x,a=t.data.y,s=t.data.width,u=t.data.height;isNaN(e)||isNaN(s)||(void 0===r&&(r=e-s/2),r=Math.min(r,e-s/2),o=Math.max(o,e+s/2)),isNaN(a)||isNaN(u)||(void 0===n&&(n=a-u/2),n=Math.min(n,a-u/2),i=Math.max(i,a+u/2))}};return t.getAllNodes().forEach((function(t){l(t)})),t.getAllEdges().forEach((function(t){(null==t?void 0:t.data.hasOwnProperty("x"))&&l(t)})),r-=u,n-=d,t.getAllNodes().forEach((function(t){t.data.x-=r,t.data.y-=n})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){t.x-=r,t.y-=n})),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)})),{width:o-r+u,height:i-n+d}},ir=function(t){t.getAllEdges().forEach((function(e){var r,n,o=t.getNode(e.source),i=t.getNode(e.target);e.data.points?(r=e.data.points[0],n=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:i.data.x,y:i.data.y},n={x:o.data.x,y:o.data.y}),e.data.points.unshift(Kt(o.data,r)),e.data.points.push(Kt(i.data,n))}))},ar=function(t){t.getAllEdges().forEach((function(t){if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},sr=function(t){t.getAllEdges().forEach((function(t){var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},ur=function(t){t.getAllNodes().forEach((function(e){var r,n,o;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){var i=t.getNode(e.id),a=t.getNode(i.data.borderTop),s=t.getNode(i.data.borderBottom),u=t.getNode(i.data.borderLeft[(null===(n=i.data.borderLeft)||void 0===n?void 0:n.length)-1]),h=t.getNode(i.data.borderRight[(null===(o=i.data.borderRight)||void 0===o?void 0:o.length)-1]);i.data.width=Math.abs((null==h?void 0:h.data.x)-(null==u?void 0:u.data.x))||10,i.data.height=Math.abs((null==s?void 0:s.data.y)-(null==a?void 0:a.data.y))||10,i.data.x=((null==u?void 0:u.data.x)||0)+i.data.width/2,i.data.y=((null==a?void 0:a.data.y)||0)+i.data.height/2}})),t.getAllNodes().forEach((function(e){"border"===e.data.dummy&&t.removeNode(e.id)}))},hr=function(t){t.getAllEdges().forEach((function(e){if(e.source===e.target){var r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}}))},dr=function(t){var e=Yt(t);null==e||e.forEach((function(e){var r=0;null==e||e.forEach((function(e,n){var o,i=t.getNode(e);i.data.order=n+r,null===(o=i.data.selfEdges)||void 0===o||o.forEach((function(e){Ut(t,"selfedge",{width:e.data.width,height:e.data.height,rank:i.data.rank,order:n+ ++r,e},"_se")})),delete i.data.selfEdges}))}))},lr=function(t){t.getAllNodes().forEach((function(e){var r=t.getNode(e.id);if("selfedge"===r.data.dummy){var n=t.getNode(r.data.e.source),o=n.data.x+n.data.width/2,i=n.data.y,a=r.data.x-o,s=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}}))},cr=function(t,e){var r={};return null==e||e.forEach((function(e){void 0!==t[e]&&(r[e]=+t[e])})),r},fr=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(r){e[r.toLowerCase()]=t[r]})),e},gr={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="dagre",this.layoutNode=function(t){return t.data.layout},this.options=n(n({},gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericDagreLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericDagreLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericDagreLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,E,b,M,k,_,z,R,I,D,O,P,T,C,q,L,j,F,V,B,G=this;return a(this,(function(a){return o=n(n({},this.options),r),i=o.nodeSize,s=o.align,u=o.rankdir,h=void 0===u?"TB":u,d=o.ranksep,l=o.nodesep,f=o.ranksepFunc,g=o.nodesepFunc,p=o.edgeLabelSpace,v=o.nodeOrder,y=o.begin,m=o.controlPoints,w=o.radial,E=new c({tree:[]}),b=S(d||50,f),M=S(l||50,g),k=M,_=b,"LR"!==h&&"RL"!==h||(k=b,_=M),z=A(i,void 0),R=e.getAllNodes(),I=e.getAllEdges(),R.filter((function(t){return t.data.layout})).forEach((function(t){var e=z(t),r=_(t),n=e+2*k(t),o=e+2*r,i=t.data.layer;x(i)?E.addNode({id:t.id,data:{width:n,height:o,layer:i}}):E.addNode({id:t.id,data:{width:n,height:o}})})),I.forEach((function(t){G.layoutNode(E.getNode(t.source))&&G.layoutNode(E.getNode(t.target))&&E.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),function(t,e){var r,o,i=e.edgeLabelSpace,a=e.keepNodeOrder,s=e.prevGraph,u=e.rankdir,h=e.ranksep;!a&&s&&(o=s,(r=t).getAllNodes().forEach((function(t){var e=r.getNode(t.id),n=o.getNode(t.id);void 0!==n?(e.data.fixorder=n.data._order,delete n.data._order):delete e.data.fixorder})));var d=function(t){var e=new c({tree:[]});return t.getAllNodes().forEach((function(r){var o=fr(t.getNode(r.id).data),i=n(n({},Xe),o),a=cr(i,Je);e.hasNode(r.id)||e.addNode({id:r.id,data:n({},a)});var s=t.getParent(r.id);null==s||(e.hasNode(s.id)||e.addNode(n({},s)),e.setParent(r.id,s.id))})),t.getAllEdges().forEach((function(r){var n=fr(t.getEdge(r.id).data),o={};null==tr||tr.forEach((function(t){void 0!==n[t]&&(o[t]=n[t])})),e.addEdge({id:r.id,source:r.source,target:r.target,data:Object.assign({},Ze,cr(n,Qe),o)})})),e}(t);i&&(e.ranksep=function(t,e){var r=e.ranksep,n=void 0===r?0:r,o=e.rankdir;return t.getAllNodes().forEach((function(t){isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((function(t){var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===o||"BT"===o?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2}(d,{rankdir:u,ranksep:h}));try{Ye(d,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph\'s structure:\\n",t);throw t}!function(t,e){t.getAllNodes().forEach((function(r){var n,o=t.getNode(r.id);if(o){var i=e.getNode(r.id);o.data.x=i.data.x,o.data.y=i.data.y,o.data._order=i.data.order,o.data._rank=i.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(o.data.width=i.data.width,o.data.height=i.data.height)}})),t.getAllEdges().forEach((function(r){var n=t.getEdge(r.id),o=e.getEdge(r.id);n.data.points=o?o.data.points:[],o&&o.data.hasOwnProperty("x")&&(n.data.x=o.data.x,n.data.y=o.data.y)}))}(t,d)}(E,{prevGraph:null,edgeLabelSpace:p,keepNodeOrder:!!v,nodeOrder:v||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:h,nodesep:l,align:s}),D=[0,0],y&&(O=1/0,P=1/0,E.getAllNodes().forEach((function(t){O>t.data.x&&(O=t.data.x),P>t.data.y&&(P=t.data.y)})),E.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){O>t.x&&(O=t.x),P>t.y&&(P=t.y)}))})),D[0]=y[0]-O,D[1]=y[1]-P),T="LR"===h||"RL"===h,w||(C=new Set,q="BT"===h||"RL"===h?function(t,e){return e-t}:function(t,e){return t-e},E.getAllNodes().forEach((function(t){t.data.x=t.data.x+D[0],t.data.y=t.data.y+D[1],C.add(T?t.data.x:t.data.y)})),L=Array.from(C).sort(q),j=T?function(t,e){return t.x!==e.x}:function(t,e){return t.y!==e.y},F=T?function(t,e,r){var n=Math.max(e.y,r.y),o=Math.min(e.y,r.y);return t.filter((function(t){return t.y<=n&&t.y>=o}))}:function(t,e,r){var n=Math.max(e.x,r.x),o=Math.min(e.x,r.x);return t.filter((function(t){return t.x<=n&&t.x>=o}))},E.getAllEdges().forEach((function(t,e){var r;p&&m&&"loop"!==t.data.type&&(t.data.controlPoints=vr(null===(r=t.data.points)||void 0===r?void 0:r.map((function(t){var e=t.x,r=t.y;return{x:e+D[0],y:r+D[1]}})),E.getNode(t.source),E.getNode(t.target),L,T,j,F))}))),V=[],V=E.getAllNodes().map((function(t){return N(t)})),B=E.getAllEdges(),t&&(V.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),B.forEach((function(t){e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),[2,{nodes:V,edges:B}]}))}))},t}(),vr=function(t,e,r,n,o,i,a){var s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){var u=e.data,h=u.x,d=u.y,l=r.data,c=l.x,f=l.y;if(o&&(h=e.data.y,d=e.data.x,c=r.data.y,f=r.data.x),f!==d&&h!==c){var g=n.indexOf(d),p=n[g+1];if(p){var v=s[0],y=o?{x:(d+p)/2,y:(null==v?void 0:v.y)||c}:{x:(null==v?void 0:v.x)||c,y:(d+p)/2};v&&!i(v,y)||s.unshift(y)}var m=n.indexOf(f),w=Math.abs(m-g);if(1===w)(s=a(s,e.data,r.data)).length||s.push(o?{x:(d+f)/2,y:h}:{x:h,y:(d+f)/2});else if(w>1){var x=n[m-1];if(x){var E=s[s.length-1],N=o?{x:(f+x)/2,y:(null==E?void 0:E.y)||c}:{x:(null==E?void 0:E.x)||h,y:(f+x)/2};E&&!i(E,N)||s.push(N)}}}}return s};function yr(t,e,r,n,o){if(isNaN(e)||isNaN(r)||isNaN(n))return t;var i,a,s,u,h,d,l,c,f,g,p,v,y=t._root,m={data:o},w=t._x0,x=t._y0,E=t._z0,N=t._x1,b=t._y1,M=t._z1;if(!y)return t._root=m,t;for(;y.length;)if((c=e>=(a=(w+N)/2))?w=a:N=a,(f=r>=(s=(x+b)/2))?x=s:b=s,(g=n>=(u=(E+M)/2))?E=u:M=u,i=y,!(y=y[p=g<<2|f<<1|c]))return i[p]=m,t;if(h=+t._x.call(null,y.data),d=+t._y.call(null,y.data),l=+t._z.call(null,y.data),e===h&&r===d&&n===l)return m.next=y,i?i[p]=m:t._root=m,t;do{i=i?i[p]=new Array(8):t._root=new Array(8),(c=e>=(a=(w+N)/2))?w=a:N=a,(f=r>=(s=(x+b)/2))?x=s:b=s,(g=n>=(u=(E+M)/2))?E=u:M=u}while((p=g<<2|f<<1|c)==(v=(l>=u)<<2|(d>=s)<<1|h>=a));return i[v]=y,i[p]=m,t}function mr(t,e,r,n,o,i,a){this.node=t,this.x0=e,this.y0=r,this.z0=n,this.x1=o,this.y1=i,this.z1=a}function wr(t){return t[0]}function xr(t){return t[1]}function Er(t){return t[2]}function Nr(t,e,r,n){var o=new br(null==e?wr:e,null==r?xr:r,null==n?Er:n,NaN,NaN,NaN,NaN,NaN,NaN);return null==t?o:o.addAll(t)}function br(t,e,r,n,o,i,a,s,u){this._x=t,this._y=e,this._z=r,this._x0=n,this._y0=o,this._z0=i,this._x1=a,this._y1=s,this._z1=u,this._root=void 0}function Mr(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var Sr=Nr.prototype=br.prototype;function kr(t){var e=0,r=0,n=0,o=0,i=t.length;if(i){for(var a=0;a<i;a++)(s=t[a])&&s.weight&&(e+=s.weight,r+=s.x*s.weight,n+=s.y*s.weight,o+=s.z*s.weight);t.x=r/e,t.y=n/e,t.z=o/e,t.weight=e}else{var s=t;t.x=s.data.x,t.y=s.data.y,t.z=s.data.z,t.weight=s.data.weight}}Sr.copy=function(){var t,e,r=new br(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),n=this._root;if(!n)return r;if(!n.length)return r._root=Mr(n),r;for(t=[{source:n,target:r._root=new Array(8)}];n=t.pop();)for(var o=0;o<8;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(8)}):n.target[o]=Mr(e));return r},Sr.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t),n=+this._z.call(null,t);return yr(this.cover(e,r,n),e,r,n,t)},Sr.addAll=function(t){Array.isArray(t)||(t=Array.from(t));const e=t.length,r=new Float64Array(e),n=new Float64Array(e),o=new Float64Array(e);let i=1/0,a=1/0,s=1/0,u=-1/0,h=-1/0,d=-1/0;for(let l,c,f,g,p=0;p<e;++p)isNaN(c=+this._x.call(null,l=t[p]))||isNaN(f=+this._y.call(null,l))||isNaN(g=+this._z.call(null,l))||(r[p]=c,n[p]=f,o[p]=g,c<i&&(i=c),c>u&&(u=c),f<a&&(a=f),f>h&&(h=f),g<s&&(s=g),g>d&&(d=g));if(i>u||a>h||s>d)return this;this.cover(i,a,s).cover(u,h,d);for(let i=0;i<e;++i)yr(this,r[i],n[i],o[i],t[i]);return this},Sr.cover=function(t,e,r){if(isNaN(t=+t)||isNaN(e=+e)||isNaN(r=+r))return this;var n=this._x0,o=this._y0,i=this._z0,a=this._x1,s=this._y1,u=this._z1;if(isNaN(n))a=(n=Math.floor(t))+1,s=(o=Math.floor(e))+1,u=(i=Math.floor(r))+1;else{for(var h,d,l=a-n||1,c=this._root;n>t||t>=a||o>e||e>=s||i>r||r>=u;)switch(d=(r<i)<<2|(e<o)<<1|t<n,(h=new Array(8))[d]=c,c=h,l*=2,d){case 0:a=n+l,s=o+l,u=i+l;break;case 1:n=a-l,s=o+l,u=i+l;break;case 2:a=n+l,o=s-l,u=i+l;break;case 3:n=a-l,o=s-l,u=i+l;break;case 4:a=n+l,s=o+l,i=u-l;break;case 5:n=a-l,s=o+l,i=u-l;break;case 6:a=n+l,o=s-l,i=u-l;break;case 7:n=a-l,o=s-l,i=u-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=o,this._z0=i,this._x1=a,this._y1=s,this._z1=u,this},Sr.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Sr.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},Sr.find=function(t,e,r,n){var o,i,a,s,u,h,d,l,c,f=this._x0,g=this._y0,p=this._z0,v=this._x1,y=this._y1,m=this._z1,w=[],x=this._root;for(x&&w.push(new mr(x,f,g,p,v,y,m)),null==n?n=1/0:(f=t-n,g=e-n,p=r-n,v=t+n,y=e+n,m=r+n,n*=n);l=w.pop();)if(!(!(x=l.node)||(i=l.x0)>v||(a=l.y0)>y||(s=l.z0)>m||(u=l.x1)<f||(h=l.y1)<g||(d=l.z1)<p))if(x.length){var E=(i+u)/2,N=(a+h)/2,b=(s+d)/2;w.push(new mr(x[7],E,N,b,u,h,d),new mr(x[6],i,N,b,E,h,d),new mr(x[5],E,a,b,u,N,d),new mr(x[4],i,a,b,E,N,d),new mr(x[3],E,N,s,u,h,b),new mr(x[2],i,N,s,E,h,b),new mr(x[1],E,a,s,u,N,b),new mr(x[0],i,a,s,E,N,b)),(c=(r>=b)<<2|(e>=N)<<1|t>=E)&&(l=w[w.length-1],w[w.length-1]=w[w.length-1-c],w[w.length-1-c]=l)}else{var M=t-+this._x.call(null,x.data),S=e-+this._y.call(null,x.data),k=r-+this._z.call(null,x.data),A=M*M+S*S+k*k;if(A<n){var _=Math.sqrt(n=A);f=t-_,g=e-_,p=r-_,v=t+_,y=e+_,m=r+_,o=x.data}}return o},Sr.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t))||isNaN(s=+this._z.call(null,t)))return this;var e,r,n,o,i,a,s,u,h,d,l,c,f,g,p,v=this._root,y=this._x0,m=this._y0,w=this._z0,x=this._x1,E=this._y1,N=this._z1;if(!v)return this;if(v.length)for(;;){if((l=i>=(u=(y+x)/2))?y=u:x=u,(c=a>=(h=(m+E)/2))?m=h:E=h,(f=s>=(d=(w+N)/2))?w=d:N=d,e=v,!(v=v[g=f<<2|c<<1|l]))return this;if(!v.length)break;(e[g+1&7]||e[g+2&7]||e[g+3&7]||e[g+4&7]||e[g+5&7]||e[g+6&7]||e[g+7&7])&&(r=e,p=g)}for(;v.data!==t;)if(n=v,!(v=v.next))return this;return(o=v.next)&&delete v.next,n?(o?n.next=o:delete n.next,this):e?(o?e[g]=o:delete e[g],(v=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&v===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!v.length&&(r?r[p]=v:this._root=v),this):(this._root=o,this)},Sr.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},Sr.root=function(){return this._root},Sr.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Sr.visit=function(t){var e,r,n,o,i,a,s,u,h=[],d=this._root;for(d&&h.push(new mr(d,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=h.pop();)if(!t(d=e.node,n=e.x0,o=e.y0,i=e.z0,a=e.x1,s=e.y1,u=e.z1)&&d.length){var l=(n+a)/2,c=(o+s)/2,f=(i+u)/2;(r=d[7])&&h.push(new mr(r,l,c,f,a,s,u)),(r=d[6])&&h.push(new mr(r,n,c,f,l,s,u)),(r=d[5])&&h.push(new mr(r,l,o,f,a,c,u)),(r=d[4])&&h.push(new mr(r,n,o,f,l,c,u)),(r=d[3])&&h.push(new mr(r,l,c,i,a,s,f)),(r=d[2])&&h.push(new mr(r,n,c,i,l,s,f)),(r=d[1])&&h.push(new mr(r,l,o,i,a,c,f)),(r=d[0])&&h.push(new mr(r,n,o,i,l,c,f))}return this},Sr.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new mr(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.z0,h=e.x1,d=e.y1,l=e.z1,c=(a+h)/2,f=(s+d)/2,g=(u+l)/2;(i=o[0])&&r.push(new mr(i,a,s,u,c,f,g)),(i=o[1])&&r.push(new mr(i,c,s,u,h,f,g)),(i=o[2])&&r.push(new mr(i,a,f,u,c,d,g)),(i=o[3])&&r.push(new mr(i,c,f,u,h,d,g)),(i=o[4])&&r.push(new mr(i,a,s,g,c,f,l)),(i=o[5])&&r.push(new mr(i,c,s,g,h,f,l)),(i=o[6])&&r.push(new mr(i,a,f,g,c,d,l)),(i=o[7])&&r.push(new mr(i,c,f,g,h,d,l))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.z0,e.x1,e.y1,e.z1);return this},Sr.x=function(t){return arguments.length?(this._x=t,this):this._x},Sr.y=function(t){return arguments.length?(this._y=t,this):this._y},Sr.z=function(t){return arguments.length?(this._z=t,this):this._z};var Ar=function(t,e,r,n,o,i,a){var s=[r,n,o][a-1],u=i.x-t.x||.1,h=i.y-t.y||.1,d=i.z-t.z||.1,l=s-e,c=u*u+h*h+d*d,f=Math.sqrt(c)*c;if(l*l*.81<c){var g=t.weight/f;return i.vx+=u*g,i.vy+=h*g,i.vz+=d*g,!0}if(t.length)return!1;t.data!==i&&(g=t.data.weight/f,i.vx+=u*g,i.vy+=h*g,i.vz+=d*g)},_r={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},zr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=n(n({},_r),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===e.options.dimensions?t.data.z:void 0})})),n},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,E,N,b,M,S,k,A=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=this.formatOptions(o,e),h=u.dimensions,d=u.width,l=u.height,f=u.nodeSize,g=u.getMass,p=u.nodeStrength,v=u.edgeStrength,y=u.linkDistance,m=i.map((function(t,e){return n(n({},t),{data:n(n({},t.data),{x:x(t.data.x)?t.data.x:Math.random()*d,y:x(t.data.y)?t.data.y:Math.random()*l,z:x(t.data.z)?t.data.z:Math.random()*Math.sqrt(d*l),size:f(t)||30,mass:g(t),nodeStrength:p(t)})})})),w=s.map((function(t){return n(n({},t),{data:n(n({},t.data),{edgeStrength:v(t),linkDistance:y(t,e.getNode(t.source),e.getNode(t.target))})})})),(null==i?void 0:i.length)?(E={},i.forEach((function(t,e){E[t.id]={x:0,y:0,z:0}})),N=new c({nodes:m,edges:w}),this.formatCentripetal(u,N),b=u.maxIteration,M=u.minMovement,S=u.onTick,this.lastLayoutNodes=m,this.lastLayoutEdges=w,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=N,this.lastOptions=u,this.lastVelMap=E,"undefined"==typeof window?[2]:(k=0,[2,new Promise((function(r){A.timeInterval=window.setInterval((function(){i&&A.running||r({nodes:Pr(e,m),edges:s}),A.runOneStep(N,e,k,E,u),A.updatePosition(e,N,E,u),t&&m.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===h?t.data.z:void 0})})),null==S||S({nodes:Pr(e,m),edges:s}),(++k>=b||A.judgingDistance<M)&&(window.clearInterval(A.timeInterval),r({nodes:Pr(e,m),edges:s}))}),0),A.running=!0}))])):(this.lastResult={nodes:[],edges:s},[2,{nodes:[],edges:s}])}))}))},t.prototype.formatOptions=function(t,e){var r=t,n=t.width,o=t.height,i=t.getMass;if(r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=o||"undefined"==typeof window?o:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),i||(r.getMass=function(t){var r=1;x(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);var n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),t.preventOverlap){var a=S(0,t.nodeSpacing);t.nodeSize?g(t.nodeSize)?r.nodeSize=function(e){var r=t.nodeSize;return Math.max(r[0],r[1])+a(e)}:r.nodeSize=function(e){return t.nodeSize+a(e)}:r.nodeSize=function(t){var e=((null==t?void 0:t.data)||{}).size;return e?g(e)?Math.max(e[0],e[1])+a(t):M(e)?Math.max(e.width,e.height)+a(t):e+a(t):10+a(t)}}return r.linkDistance=t.linkDistance?S(1,t.linkDistance):function(t){return 1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target))},r.nodeStrength=S(1,t.nodeStrength),r.edgeStrength=S(1,t.edgeStrength),t},t.prototype.formatCentripetal=function(t,e){var r,n=t.centripetalOptions,o=t.center,i=t.clusterNodeStrength,a=t.leafCluster,s=t.clustering,u=t.nodeClusterBy,h=e.getAllNodes(),d=n||{leaf:2,single:2,others:1,center:function(t){return{x:o[0],y:o[1]}}};"function"!=typeof i&&(t.clusterNodeStrength=function(t){return i});var l=[];if(a&&u&&(r=Rr(e,u),l=Array.from(new Set(null==h?void 0:h.map((function(t){return t.data[u]}))))||[],t.centripetalOptions=Object.assign(d,{single:100,leaf:function(e){var n=r[e.id]||{},o=n.siblingLeaves,i=n.sameTypeLeaves;return(null==i?void 0:i.length)===(null==o?void 0:o.length)||1===(null==l?void 0:l.length)?1:t.clusterNodeStrength(e)},others:1,center:function(t){var n,o=e.getDegree(t.id,"both");if(!o)return{x:100,y:100};if(1===o){var i=(r[t.id]||{}).sameTypeLeaves,a=void 0===i?[]:i;1===a.length?n=void 0:a.length>1&&(n=Or(a))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y}}})),s&&u){r||(r=Rr(e,u)),l||(l=Array.from(new Set(h.map((function(t){return t.data[u]}))))),l=l.filter((function(t){return void 0!==t}));var c={};l.forEach((function(t){var r=h.filter((function(e){return e.data[u]===t})).map((function(t){return e.getNode(t.id)}));c[t]=Or(r)})),t.centripetalOptions=Object.assign(d,{single:function(e){return t.clusterNodeStrength(e)},leaf:function(e){return t.clusterNodeStrength(e)},others:function(e){return t.clusterNodeStrength(e)},center:function(t){var e=c[t.data[u]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y}}})}var f=t.centripetalOptions||{},g=f.leaf,p=f.single,v=f.others;g&&"function"!=typeof g&&(t.centripetalOptions.leaf=function(){return g}),p&&"function"!=typeof p&&(t.centripetalOptions.single=function(){return p}),v&&"function"!=typeof v&&(t.centripetalOptions.others=function(){return v})},t.prototype.runOneStep=function(t,e,r,n,o){var i={},a=t.getAllNodes(),s=t.getAllEdges();if(null==a?void 0:a.length){var u=o.monitor;this.calRepulsive(t,i,o),s&&this.calAttractive(t,i,o),this.calGravity(t,e,i,o),this.updateVelocity(t,i,n,o),u&&u({energy:this.calTotalEnergy(i,a),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}},t.prototype.calTotalEnergy=function(t,e){var r=this;if(!(null==e?void 0:e.length))return 0;var n=0;return e.forEach((function(e,o){var i=t[e.id].x,a=t[e.id].y,s=3===r.options.dimensions?t[e.id].z:0,u=i*i+a*a+s*s,h=e.data.mass;n+=(void 0===h?1:h)*u*.5})),n},t.prototype.calRepulsive=function(t,e,r){var n=r.dimensions,o=r.factor,i=r.coulombDisScale;!function(t,e,r,n,o){var i=e/r,a=t.getAllNodes(),s=a.map((function(t,e){var r=t.data,n=r.nodeStrength;return{x:r.x,y:r.y,z:r.z,size:r.size,index:e,vx:0,vy:0,vz:0,weight:i*n}})),u=(2===o?F(s,(function(t){return t.x}),(function(t){return t.y})):Nr(s,(function(t){return t.x}),(function(t){return t.y}),(function(t){return t.z}))).visitAfter(kr);s.forEach((function(t){!function(t,e,r){e.visit((function(e,n,o,i,a){return Ar(e,n,o,i,a,t,r)}))}(t,u,o)})),s.map((function(t,e){var r=a[e],o=r.id,i=r.data.mass,s=void 0===i?1:i;n[o]={x:t.vx/s,y:t.vy/s,z:t.vz/s}}))}(t,o,i*i,e,n)},t.prototype.calAttractive=function(t,e,r){var n=r.dimensions;t.getAllEdges().forEach((function(r,o){var i=r.source,a=r.target,s=t.getNode(i),u=t.getNode(a);if(s&&u){var h=u.data.x-s.data.x,d=u.data.y-s.data.y,l=3===n?u.data.z-s.data.z:0;h||d||(h=.01*Math.random(),d=.01*Math.random(),3!==n||l||(l=.01*Math.random()));var c=Math.sqrt(h*h+d*d+l*l),f=h/c,g=d/c,p=l/c,v=r.data||{},y=v.linkDistance,m=void 0===y?200:y,w=v.edgeStrength,x=(m-c)*(void 0===w?200:w),E=1/(s.data.mass||1),N=1/(u.data.mass||1),b=f*x,M=g*x,S=p*x;e[i].x-=b*E,e[i].y-=M*E,e[i].z-=S*E,e[a].x+=b*N,e[a].y+=M*N,e[a].z+=S*N}}))},t.prototype.calGravity=function(t,e,r,n){var o=n.getCenter,i=t.getAllNodes(),a=e.getAllNodes(),u=e.getAllEdges(),h=n.width,d=n.height,l=n.center,c=n.gravity,f=n.centripetalOptions;i&&i.forEach((function(n){var i=n.id,g=n.data,p=g.mass,v=g.x,y=g.y,m=g.z,w=e.getNode(i),E=0,N=0,b=0,M=c,S=t.getDegree(i,"in"),k=t.getDegree(i,"out"),A=t.getDegree(i,"both"),_=null==o?void 0:o(w,A);if(_){var z=s(_,3);E=v-z[0],N=y-z[1],M=z[2]}else E=v-l[0],N=y-l[1],b=m-l[2];if(M&&(r[i].x-=M*E/p,r[i].y-=M*N/p,r[i].z-=M*b/p),f){var R=f.leaf,I=f.single,D=f.others,O=f.center,P=(null==O?void 0:O(w,a,u,h,d))||{x:0,y:0,z:0,centerStrength:0},T=P.x,C=P.y,q=P.z,L=P.centerStrength;if(!x(T)||!x(C))return;var j=(v-T)/p,F=(y-C)/p,V=(m-q)/p;if(L&&(r[i].x-=L*j,r[i].y-=L*F,r[i].z-=L*V),0===A){var B=I(w);if(!B)return;return r[i].x-=B*j,r[i].y-=B*F,void(r[i].z-=B*V)}if(0===S||0===k){var G=R(w,a,u);if(!G)return;return r[i].x-=G*j,r[i].y-=G*F,void(r[i].z-=G*V)}var W=D(w);if(!W)return;r[i].x-=W*j,r[i].y-=W*F,r[i].z-=W*V}}))},t.prototype.updateVelocity=function(t,e,r,n){var o=n.damping,i=n.maxSpeed,a=n.interval,s=n.dimensions,u=t.getAllNodes();(null==u?void 0:u.length)&&u.forEach((function(t){var n=t.id,u=(r[n].x+e[n].x*a)*o||.01,h=(r[n].y+e[n].y*a)*o||.01,d=3===s?(r[n].z+e[n].z*a)*o||.01:0,l=Math.sqrt(u*u+h*h+d*d);if(l>i){var c=i/l;u*=c,h*=c,d*=c}r[n]={x:u,y:h,z:d}}))},t.prototype.updatePosition=function(t,e,r,n){var o=this,i=n.distanceThresholdMode,a=n.interval,s=n.dimensions,u=e.getAllNodes();if(null==u?void 0:u.length){var h=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),u.forEach((function(n){var u=n.id,d=t.getNode(u);if(x(d.data.fx)&&x(d.data.fy))e.mergeNodeData(u,{x:d.data.fx,y:d.data.fy,z:3===s?d.data.fz:void 0});else{var l=r[u].x*a,c=r[u].y*a,f=3===s?r[u].z*a:0;e.mergeNodeData(u,{x:n.data.x+l,y:n.data.y+c,z:n.data.z+f});var g=Math.sqrt(l*l+c*c+f*f);switch(i){case"max":o.judgingDistance<g&&(o.judgingDistance=g);break;case"min":o.judgingDistance>g&&(o.judgingDistance=g);break;default:h+=g}}})),i&&"mean"!==i||(this.judgingDistance=h/u.length)}else this.judgingDistance=0},t}(),Rr=function(t,e){var r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};var n={};return r.forEach((function(r,o){1===t.getDegree(r.id,"both")&&(n[r.id]=Ir(t,"leaf",r,e))})),n},Ir=function(t,e,r,n){var o=t.getDegree(r.id,"in"),i=t.getDegree(r.id,"out"),a=r,s=[];return 0===o?(a=t.getSuccessors(r.id)[0],s=t.getNeighbors(a.id)):0===i&&(a=t.getPredecessors(r.id)[0],s=t.getNeighbors(a.id)),s=s.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")})),{coreNode:a,siblingLeaves:s,sameTypeLeaves:Dr(t,e,n,r,s)}},Dr=function(t,e,r,n,o){var i=n.data[r]||"",a=(null==o?void 0:o.filter((function(t){return t.data[r]===i})))||[];return"leaf"===e&&(a=a.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")}))),a},Or=function(t){var e={x:0,y:0};t.forEach((function(t){var r=t.data,n=r.x,o=r.y;e.x+=n||0,e.y+=o||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},Pr=function(t,e){return e.map((function(e){var r=e.id,o=e.data,i=t.getNode(r);return n(n({},i),{data:n(n({},i.data),{x:o.x,y:o.y,z:o.z})})}))},Tr=function(){function t(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}return t.prototype.distanceTo=function(t){var e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)},t.prototype.setPos=function(t,e){this.rx=t,this.ry=e},t.prototype.resetForce=function(){this.fx=0,this.fy=0},t.prototype.addForce=function(t){var e=t.rx-this.rx,r=t.ry-this.ry,n=Math.hypot(e,r);n=n<1e-4?1e-4:n;var o=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=o*e/n,this.fy+=o*r/n},t.prototype.in=function(t){return t.contains(this.rx,this.ry)},t.prototype.add=function(e){var r=this.mass+e.mass;return new t({rx:(this.rx*this.mass+e.rx*e.mass)/r,ry:(this.ry*this.mass+e.ry*e.mass)/r,mass:r,degree:this.degree+e.degree})},t}();const Cr=Tr;const qr=function(){function t(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}return t.prototype.getLength=function(){return this.length},t.prototype.contains=function(t,e){var r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r},t.prototype.NW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.NE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.SW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t.prototype.SE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t}(),Lr=function(){function t(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}return t.prototype.insert=function(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e},t.prototype._putBody=function(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))},t.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},t.prototype.updateForce=function(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))},t}();var jr={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Fr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2",this.options=n(n({},jr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,x,E,b,M,S,k,A,z;return a(this,(function(a){if(o=e.getAllEdges(),i=e.getAllNodes(),s=this.formatOptions(r,i.length),u=s.width,h=s.height,d=s.prune,l=s.maxIteration,f=s.nodeSize,g=s.center,!(null==i?void 0:i.length)||1===i.length)return[2,_(e,t,g)];if(p=i.map((function(t){return N(t,[u,h])})),v=o.filter((function(t){return t.source!==t.target})),y=new c({nodes:p,edges:v}),m=this.getSizes(y,e,f),this.run(y,e,l,m,t,s),d){for(w=0;w<v.length;w+=1)x=v[w],E=x.source,b=x.target,M=y.getDegree(E),S=y.getDegree(E),M<=1?(k=y.getNode(b),y.mergeNodeData(E,{x:k.data.x,y:k.data.y})):S<=1&&(A=y.getNode(E),y.mergeNodeData(b,{x:A.data.x,y:A.data.y}));z=n(n({},s),{prune:!1,barnesHut:!1}),this.run(y,e,100,m,t,z)}return[2,{nodes:p,edges:o}]}))}))},t.prototype.getSizes=function(t,e,r){for(var n=t.getAllNodes(),o={},i=0;i<n.length;i+=1){var a=n[i],h=a.id,d=a.data;if(o[h]=10,x(d.size))o[h]=d.size;else if(g(d.size))isNaN(d.size[0])||(o[h]=Math.max(d.size[0])),isNaN(d.size[1])||(o[h]=Math.max(d.size[1]));else if(M(d.size))o[h]=Math.max(d.size.width,d.size.height);else if(b(r)){var l=r(e.getNode(h));g(l)?o[h]=Math.max.apply(Math,u([],s(l))):o[h]=l}else g(r)?o[h]=Math.max.apply(Math,u([],s(r))):x(r)&&(o[h]=r)}return o},t.prototype.formatOptions=function(t,e){void 0===t&&(t={});var r=n(n({},this.options),t),o=r.center,i=r.width,a=r.height,s=r.barnesHut,u=r.prune,h=r.maxIteration,d=r.kr,l=r.kg;return r.width=i||"undefined"==typeof window?i:window.innerWidth,r.height=a||"undefined"==typeof window?a:window.innerHeight,r.center=o||[r.width/2,r.height/2],void 0===s&&e>250&&(r.barnesHut=!0),void 0===u&&e>100&&(r.prune=!0),0!==h||u?0===h&&u&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)):(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)),d||(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),l||(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r},t.prototype.run=function(t,e,r,n,o,i){for(var a=i.kr,s=i.barnesHut,u=i.onTick,h=t.getAllNodes(),d=0,l=r,c={},f={},g={},p=0;p<h.length;p+=1){var v=h[p],y=v.data,m=v.id;if(c[m]=[0,0],s){var w={id:p,rx:y.x,ry:y.y,mass:1,g:a,degree:t.getDegree(m)};g[m]=new Cr(w)}}for(;l>0;)d=this.oneStep(t,{iter:l,preventOverlapIters:50,krPrime:100,sg:d,forces:c,preForces:f,bodies:g,sizes:n},i),l--,null==u||u({nodes:h,edges:e.getAllEdges()});return t},t.prototype.oneStep=function(t,e,r){for(var n=e.iter,o=e.preventOverlapIters,i=e.krPrime,a=e.sg,h=e.preForces,d=e.bodies,l=e.sizes,c=e.forces,f=r.preventOverlap,g=r.barnesHut,p=t.getAllNodes(),v=0;v<p.length;v+=1){var y=p[v].id;h[y]=u([],s(c[y])),c[y]=[0,0]}return c=this.getAttrForces(t,n,o,l,c,r),c=g&&(f&&n>o||!f)?this.getOptRepGraForces(t,c,d,r):this.getRepGraForces(t,n,o,c,i,l,r),this.updatePos(t,c,h,a,r)},t.prototype.getAttrForces=function(t,e,r,n,o,i){for(var a=i.preventOverlap,s=i.dissuadeHubs,u=i.mode,h=i.prune,d=t.getAllEdges(),l=0;l<d.length;l+=1){var c=d[l],f=c.source,g=c.target,p=t.getNode(f),v=t.getNode(g),y=t.getDegree(f),m=t.getDegree(g);if(!h||!(y<=1||m<=1)){var w=[v.data.x-p.data.x,v.data.y-p.data.y],x=Math.hypot(w[0],w[1]);x=x<1e-4?1e-4:x,w[0]=w[0]/x,w[1]=w[1]/x,a&&e<r&&(x=x-n[f]-n[g]);var E=x,N=E;"linlog"===u&&(N=E=Math.log(1+x)),s&&(E=x/y,N=x/m),a&&e<r&&x<=0?(E=0,N=0):a&&e<r&&x>0&&(E=x,N=x),o[f][0]+=E*w[0],o[g][0]-=N*w[0],o[f][1]+=E*w[1],o[g][1]-=N*w[1]}}return o},t.prototype.getOptRepGraForces=function(t,e,r,n){for(var o=n.kg,i=n.center,a=n.prune,s=t.getAllNodes(),u=s.length,h=9e10,d=-9e10,l=9e10,c=-9e10,f=0;f<u;f+=1){var g=s[f],p=g.id,v=g.data;a&&t.getDegree(p)<=1||(r[p].setPos(v.x,v.y),v.x>=d&&(d=v.x),v.x<=h&&(h=v.x),v.y>=c&&(c=v.y),v.y<=l&&(l=v.y))}var y=Math.max(d-h,c-l),m=new qr({xmid:(d+h)/2,ymid:(c+l)/2,length:y,massCenter:i,mass:u}),w=new Lr(m);for(f=0;f<u;f+=1)p=s[f].id,a&&t.getDegree(p)<=1||r[p].in(m)&&w.insert(r[p]);for(f=0;f<u;f+=1){var x=s[f],E=(p=x.id,v=x.data,t.getDegree(p));if(!(a&&E<=1)){r[p].resetForce(),w.updateForce(r[p]),e[p][0]-=r[p].fx,e[p][1]-=r[p].fy;var N=[v.x-i[0],v.y-i[1]],b=Math.hypot(N[0],N[1]);b=b<1e-4?1e-4:b,N[0]=N[0]/b,N[1]=N[1]/b;var M=o*(E+1);e[p][0]-=M*N[0],e[p][1]-=M*N[1]}}return e},t.prototype.getRepGraForces=function(t,e,r,n,o,i,a){for(var s=a.preventOverlap,u=a.kr,h=a.kg,d=a.center,l=a.prune,c=t.getAllNodes(),f=c.length,g=0;g<f;g+=1){for(var p=c[g],v=t.getDegree(p.id),y=g+1;y<f;y+=1){var m=c[y],w=t.getDegree(m.id);if(!l||!(v<=1||w<=1)){var x=[m.data.x-p.data.x,m.data.y-p.data.y],E=Math.hypot(x[0],x[1]);E=E<1e-4?1e-4:E,x[0]=x[0]/E,x[1]=x[1]/E,s&&e<r&&(E=E-i[p.id]-i[m.id]);var N=u*(v+1)*(w+1)/E;s&&e<r&&E<0?N=o*(v+1)*(w+1):s&&e<r&&0===E?N=0:s&&e<r&&E>0&&(N=u*(v+1)*(w+1)/E),n[p.id][0]-=N*x[0],n[m.id][0]+=N*x[0],n[p.id][1]-=N*x[1],n[m.id][1]+=N*x[1]}}var b=[p.data.x-d[0],p.data.y-d[1]],M=Math.hypot(b[0],b[1]);b[0]=b[0]/M,b[1]=b[1]/M;var S=h*(v+1);n[p.id][0]-=S*b[0],n[p.id][1]-=S*b[1]}return n},t.prototype.updatePos=function(t,e,r,n,o){for(var i=o.ks,a=o.tao,s=o.prune,u=o.ksmax,h=t.getAllNodes(),d=h.length,l=[],c=[],f=0,g=0,p=n,v=0;v<d;v+=1){var y=h[v].id,m=t.getDegree(y);if(!(s&&m<=1)){var w=[e[y][0]-r[y][0],e[y][1]-r[y][1]],E=Math.hypot(w[0],w[1]),N=[e[y][0]+r[y][0],e[y][1]+r[y][1]],b=Math.hypot(N[0],N[1]);l[v]=E,c[v]=b/2,f+=(m+1)*l[v],g+=(m+1)*c[v]}}var M=p;for(p=a*g/f,0!==M&&(p=p>1.5*M?1.5*M:p),v=0;v<d;v+=1){var S=h[v],k=(y=S.id,S.data);if(m=t.getDegree(y),!(s&&m<=1||x(k.fx)&&x(k.fy))){var A=i*p/(1+p*Math.sqrt(l[v])),_=Math.hypot(e[y][0],e[y][1]),z=u/(_=_<1e-4?1e-4:_),R=(A=A>z?z:A)*e[y][0],I=A*e[y][1];t.mergeNodeData(y,{x:k.x+R,y:k.y+I})}}return p},t}(),Vr={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Br=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=n(n({},Vr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===e.options.dimensions?t.data.z:void 0})})),n},t.prototype.genericFruchtermanLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,x,E,b=this;return a(this,(function(a){return this.running?[2]:(o=this.formatOptions(r),i=o.dimensions,s=o.width,u=o.height,h=o.center,d=o.clustering,l=o.nodeClusterBy,f=o.maxIteration,g=o.onTick,p=e.getAllNodes(),v=e.getAllEdges(),(null==p?void 0:p.length)?1===p.length?(t&&e.mergeNodeData(p[0].id,{x:h[0],y:h[1],z:3===i?h[2]:void 0}),y={nodes:[n(n({},p[0]),{data:n(n({},p[0].data),{x:h[0],y:h[1],z:3===i?h[2]:void 0})})],edges:v},this.lastResult=y,[2,y]):(m=p.map((function(t){return N(t,[s,u])})),w=new c({nodes:m,edges:v}),x={},d&&m.forEach((function(t){var e=t.data[l];x[e]||(x[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=m,this.lastLayoutEdges=v,this.lastAssign=t,this.lastGraph=w,this.lastOptions=o,this.lastClusterMap=x,"undefined"==typeof window?[2]:(E=0,[2,new Promise((function(r){b.timeInterval=window.setInterval((function(){b.running?(b.runOneStep(w,x,o),t&&m.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y,z:3===i?n.z:void 0})})),null==g||g({nodes:m,edges:v}),++E>=f&&(window.clearInterval(b.timeInterval),r({nodes:m,edges:v}))):r({nodes:m,edges:v})}),0),b.running=!0}))])):(y={nodes:[],edges:v},this.lastResult=y,[2,y]))}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=n(n({},this.options),t),r=e.clustering,o=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=r&&!!o,e},t.prototype.runOneStep=function(t,e,r){var n=r.dimensions,o=r.height,i=r.width,a=r.gravity,s=r.center,u=r.speed,h=r.clustering,d=r.nodeClusterBy,l=r.clusterGravity,c=o*i,f=Math.sqrt(c)/10,g=t.getAllNodes(),p=c/(g.length+1),v=Math.sqrt(p),y={};if(this.applyCalculate(t,y,v,p),h){for(var m in e)e[m].cx=0,e[m].cy=0,e[m].count=0;for(var m in g.forEach((function(t){var r=t.data,n=e[r[d]];x(r.x)&&(n.cx+=r.x),x(r.y)&&(n.cy+=r.y),n.count++})),e)e[m].cx/=e[m].count,e[m].cy/=e[m].count;var w=l||a;g.forEach((function(t,r){var n=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=e[o[d]],a=Math.sqrt((o.x-i.cx)*(o.x-i.cx)+(o.y-i.cy)*(o.y-i.cy)),s=v*w;y[n].x-=s*(o.x-i.cx)/a,y[n].y-=s*(o.y-i.cy)/a}}))}g.forEach((function(t,e){var r=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=.01*v*a;y[r].x-=i*(o.x-s[0]),y[r].y-=i*(o.y-s[1]),3===n&&(y[r].z-=i*(o.z-s[2]))}})),g.forEach((function(e,r){var o=e.id,i=e.data;if(x(i.fx)&&x(i.fy))return i.x=i.fx,i.y=i.fy,void(3===n&&(i.z=i.fz));if(x(i.x)&&x(i.y)){var a=Math.sqrt(y[o].x*y[o].x+y[o].y*y[o].y+(3===n?y[o].z*y[o].z:0));if(a>0){var s=Math.min(f*(u/800),a);t.mergeNodeData(o,{x:i.x+y[o].x/a*s,y:i.y+y[o].y/a*s,z:3===n?i.z+y[o].z/a*s:void 0})}}}))},t.prototype.applyCalculate=function(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)},t.prototype.calRepulsive=function(t,e,r){var n=this,o=t.getAllNodes();o.forEach((function(t,i){var a=t.data,s=t.id;e[s]={x:0,y:0,z:0},o.forEach((function(t,o){var u=t.data,h=t.id;if(!(i<=o)&&x(a.x)&&x(u.x)&&x(a.y)&&x(u.y)){var d=a.x-u.x,l=a.y-u.y,c=3===n.options.dimensions?a.z-u.z:0,f=d*d+l*l+c*c;0===f&&(f=1,d=.01,l=.01,c=.01);var g=r/f,p=d*g,v=l*g,y=c*g;e[s].x+=p,e[s].y+=v,e[h].x-=p,e[h].y-=v,3===n.options.dimensions&&(e[s].z+=y,e[h].z-=y)}}))}))},t.prototype.calAttractive=function(t,e,r){var n=this;t.getAllEdges().forEach((function(o){var i=o.source,a=o.target;if(i&&a&&i!==a){var s=t.getNode(i).data,u=t.getNode(a).data;if(x(u.x)&&x(s.x)&&x(u.y)&&x(s.y)){var h=u.x-s.x,d=u.y-s.y,l=3===n.options.dimensions?u.z-s.z:0,c=Math.sqrt(h*h+d*d+l*l)/r,f=h*c,g=d*c,p=l*c;e[i].x+=f,e[i].y+=g,e[a].x-=f,e[a].y-=g,3===n.options.dimensions&&(e[i].z+=p,e[a].z-=p)}}}))},t}(),Gr={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},Wr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="grid",this.options=n(n({},Gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericGridLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericGridLayout(!0,t,e),[2]}))}))},t.prototype.genericGridLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,p,v,y,m,w,E,b,M,A,z,R,I,D,P,T,C,q,L,j,F,V,B,G,W,$,U,H,K;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.begin,s=void 0===i?[0,0]:i,u=o.condense,h=o.preventOverlapPadding,d=o.preventOverlap,l=o.rows,c=o.cols,f=o.nodeSpacing,p=o.nodeSize,v=o.width,y=o.height,m=o.position,w=o.sortBy,E=e.getAllNodes(),b=e.getAllEdges(),!(M=null==E?void 0:E.length)||1===M)return[2,_(e,t,s)];if(A=E.map((function(t){return N(t)})),"id"===w||O(w)&&void 0!==A[0].data[w]||(w="degree"),"degree"===w?A.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):"id"===w?A.sort((function(t,e){return x(e.id)&&x(t.id)?e.id-t.id:(""+t.id).localeCompare(""+e.id)})):A.sort((function(t,e){return e.data[w]-t.data[w]})),z=v||"undefined"==typeof window?v:window.innerWidth,R=y||"undefined"==typeof window?y:window.innerHeight,I=M,D={rows:l,cols:c},null!=l&&null!=c?(D.rows=l,D.cols=c):null!=l&&null==c?(D.rows=l,D.cols=Math.ceil(I/D.rows)):null==l&&null!=c?(D.cols=c,D.rows=Math.ceil(I/D.cols)):(P=Math.sqrt(I*R/z),D.rows=Math.round(P),D.cols=Math.round(z/R*P)),D.rows=Math.max(D.rows,1),D.cols=Math.max(D.cols,1),D.cols*D.rows>I)T=$r(D),C=Ur(D),(T-1)*C>=I?$r(D,T-1):(C-1)*T>=I&&Ur(D,C-1);else for(;D.cols*D.rows<I;)T=$r(D),((C=Ur(D))+1)*T>=I?Ur(D,C+1):$r(D,T+1);for(q=u?0:z/D.cols,L=u?0:R/D.rows,(d||f)&&(j=S(10,f),F=k(30,p,!1),A.forEach((function(t){t.data.x&&t.data.y||(t.data.x=0,t.data.y=0);var r,n,o=e.getNode(t.id),i=F(o)||30;g(i)?(r=i[0],n=i[1]):(r=i,n=i);var a=void 0!==j?j(t):h,s=r+a,u=n+a;q=Math.max(q,s),L=Math.max(L,u)}))),V={},B={row:0,col:0},G={},W=0;W<A.length;W++){if($=A[W],U=void 0,m&&(U=m(e.getNode($.id))),U&&(void 0!==U.row||void 0!==U.col)){if(void 0===(H={row:U.row,col:U.col}).col)for(H.col=0;Hr(V,H);)H.col++;else if(void 0===H.row)for(H.row=0;Hr(V,H);)H.row++;G[$.id]=H,Kr(V,H)}Jr($,s,q,L,G,D,B,V)}return K={nodes:A,edges:b},t&&A.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,K]}))}))},t}(),$r=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.min(n,o):Math.min(n,o)===t.rows?t.rows=e:t.cols=e,r},Ur=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.max(n,o):Math.max(n,o)===t.rows?t.rows=e:t.cols=e,r},Hr=function(t,e){return t["c-"+e.row+"-"+e.col]||!1},Kr=function(t,e){return t["c-"+e.row+"-"+e.col]=!0},Yr=function(t,e){var r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},Jr=function(t,e,r,n,o,i,a,s){var u,h,d=o[t.id];if(d)u=d.col*r+r/2+e[0],h=d.row*n+n/2+e[1];else{for(;Hr(s,a);)Yr(i,a);u=a.col*r+r/2+e[0],h=a.row*n+n/2+e[1],Kr(s,a),Yr(i,a)}t.data.x=u,t.data.y=h};const Xr=Object.prototype.toString;function Qr(t){const e=Xr.call(t);return e.endsWith("Array]")&&!e.includes("Big")}function Zr(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!Qr(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]<a&&(a=t[s]);return a}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]>a&&(a=t[s]);return a}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,a=void 0===i?r.autoMinMax?n:0:i,s=r.max,u=void 0===s?r.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var h=(u-a)/(o-n),d=0;d<t.length;d++)e[d]=(t[d]-n)*h+a;return e}const tn=" ".repeat(2),en=" ".repeat(4);function rn(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=e;return`${t.constructor.name} {\\n${tn}[\\n${en}${function(t,e,r,n,o){const{rows:i,columns:a}=t,s=Math.min(i,e),u=Math.min(a,r),h=[];if("auto"===o){o=!1;t:for(let e=0;e<s;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let e=0;e<s;e++){let r=[];for(let i=0;i<u;i++)r.push(nn(t.get(e,i),n,o));h.push(`${r.join(" ")}`)}return u!==a&&(h[h.length-1]+=` ... ${a-r} more columns`),s!==i&&h.push(`... ${i-e} more rows`),h.join(`\\n${en}`)}(t,r,n,o,i)}\\n${tn}]\\n${tn}rows: ${t.rows}\\n${tn}columns: ${t.columns}\\n}`}function nn(t,e,r){return(t>=0&&r?` ${on(t,e-1)}`:on(t,e)).padEnd(e)}function on(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function an(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function sn(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function un(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function hn(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function dn(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(cn("startRow",e),cn("endRow",r),cn("startColumn",n),cn("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function ln(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function cn(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function fn(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class gn{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new vn(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new vn(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new vn(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new vn(t,e)}static ones(t,e){return new vn(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new vn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)o.set(r,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let a=o-n,s=new vn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(i()*a);s.set(r,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let t=0;t<n;t++)o.set(t,t,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let e=0;e<o;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new vn(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return gn.isMatrix(t)?t:new vn(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let a=o;a<e;a++){let e=t.get(r,a)-i*t.get(n,a);t.set(r,a,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new vn(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){an(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return vn.rowVector(this.getRow(t))}setRow(t,e){an(this,t),e=un(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){an(this,t),an(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){sn(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return vn.columnVector(this.getColumn(t))}setColumn(t,e){sn(this,t),e=hn(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){sn(this,t),sn(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){an(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){sn(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){fn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){fn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(an(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){an(this,t),fn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(an(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){an(this,t),fn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(sn(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){sn(this,t),fn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(sn(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){sn(this,t),fn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){gn.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=vn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new vn(e,n),i=new Float64Array(r);for(let a=0;a<n;a++){for(let e=0;e<r;e++)i[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,a,e)}}return o}strassen2x2(t){t=vn.checkMatrix(t);let e=new vn(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),h=t.get(1,1),d=(r+u)*(n+h),l=(a+u)*n,c=r*(i-h),f=u*(s-n),g=(r+o)*h,p=d+f-g+(o-u)*(s+h),v=c+g,y=l+f,m=d-l+c+(a-r)*(n+i);return e.set(0,0,p),e.set(0,1,v),e.set(1,0,y),e.set(1,1,m),e}strassen3x3(t){t=vn.checkMatrix(t);let e=new vn(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),h=this.get(2,1),d=this.get(2,2),l=t.get(0,0),c=t.get(0,1),f=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),y=t.get(2,0),m=t.get(2,1),w=t.get(2,2),x=(r-i)*(-c+p),E=(-r+i+a)*(l-c+p),N=(i+a)*(-l+c),b=r*l,M=(-r+u+h)*(l-f+v),S=(-r+u)*(f-v),k=(u+h)*(-l+f),A=(-o+h+d)*(p+y-m),_=(o-d)*(p-m),z=o*y,R=(h+d)*(-y+m),I=(-o+a+s)*(v+y-w),D=(o-s)*(v-w),O=(a+s)*(-y+w),P=b+z+n*g,T=(r+n+o-i-a-h-d)*p+E+N+b+A+z+R,C=b+M+k+(r+n+o-a-s-u-h)*v+z+I+O,q=x+a*(-l+c+g-p-v-y+w)+E+b+z+I+D,L=x+E+N+b+s*m,j=z+I+D+O+i*f,F=b+M+S+h*(-l+f+g-p-v-y+m)+A+_+z,V=A+_+z+R+u*c,B=b+M+S+k+d*w;return e.set(0,0,P),e.set(0,1,T),e.set(0,2,C),e.set(1,0,q),e.set(1,1,L),e.set(1,2,j),e.set(2,0,F),e.set(2,1,V),e.set(2,2,B),e}mmulStrassen(t){t=vn.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function a(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=gn.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${r} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let s=Math.max(r,o),u=Math.max(n,i);return e=a(e,s,u),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=a(e,n+1,o+1),r=a(r,n+1,o+1)):n%2==1?(e=a(e,n+1,o),r=a(r,n+1,o)):o%2==1&&(e=a(e,n,o+1),r=a(r,n,o+1));let i=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,s-1),h=r.subMatrix(0,i-1,0,s-1),d=e.subMatrix(0,i-1,s,e.columns-1),l=r.subMatrix(0,i-1,s,r.columns-1),c=e.subMatrix(i,e.rows-1,0,s-1),f=r.subMatrix(i,r.rows-1,0,s-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),p=r.subMatrix(i,r.rows-1,s,r.columns-1),v=t(gn.add(u,g),gn.add(h,p),i,s),y=t(gn.add(c,g),h,i,s),m=t(u,gn.sub(l,p),i,s),w=t(g,gn.sub(f,h),i,s),x=t(gn.add(u,d),p,i,s),E=t(gn.sub(c,u),gn.add(h,l),i,s),N=t(gn.sub(d,g),gn.add(f,p),i,s),b=gn.add(v,w);b.sub(x),b.add(N);let M=gn.add(m,x),S=gn.add(y,w),k=gn.sub(v,y);k.add(m),k.add(E);let A=gn.zeros(2*b.rows,2*b.columns);return A=A.setSubMatrix(b,0,0),A=A.setSubMatrix(M,b.rows,0),A=A.setSubMatrix(S,0,b.columns),A=A.setSubMatrix(k,b.rows,b.columns),A.subMatrix(0,n-1,0,o-1)}(e,t=a(t,s,u),s,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new vn(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&Zr(o,{min:e,max:r,output:o}),n.setRow(t,o)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new vn(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&Zr(o,{min:e,max:r,output:o}),n.setColumn(t,o)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=vn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new vn(e*n,r*o);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<o;s++)i.set(n*a+r,o*e+s,this.get(a,e)*t.get(r,s));return i}kroneckerSum(t){if(t=vn.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(vn.eye(r,r)),o=vn.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new vn(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=pn){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=pn){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){dn(this,t,e,r,n);let o=new vn(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new vn(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new vn(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=vn.checkMatrix(t)).isEmpty())return this;dn(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){!function(t,e){if(!Qr(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!Qr(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new vn(t.length,e.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<e.length;t++){let i=e[t];r.set(n,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new vn(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=ln(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=ln(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=ln(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=ln(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Qr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<n;a++){let n=0,s=0,u=0;for(let e=0;e<o;e++)u=t.get(a,e)-r[a],n+=u,s+=u*u;e?i.push((s-n*n/o)/(o-1)):i.push((s-n*n/o)/o)}return i}(this,r,n);case"column":if(!Qr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<o;a++){let o=0,s=0,u=0;for(let e=0;e<n;e++)u=t.get(e,a)-r[a],o+=u,s+=u*u;e?i.push((s-o*o/n)/(n-1)):i.push((s-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let a=0,s=0,u=0;for(let e=0;e<n;e++)for(let n=0;n<o;n++)u=t.get(e,n)-r,a+=u,s+=u*u;return e?(s-a*a/i)/(i-1):(s-a*a/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Qr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!Qr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!Qr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!Qr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return rn(this,t)}}function pn(t,e){return t-e}gn.prototype.klass="Matrix","undefined"!=typeof Symbol&&(gn.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return rn(this)}),gn.random=gn.rand,gn.randomInt=gn.randInt,gn.diagonal=gn.diag,gn.prototype.diagonal=gn.prototype.diag,gn.identity=gn.eye,gn.prototype.negate=gn.prototype.neg,gn.prototype.tensorProduct=gn.prototype.kroneckerProduct;class vn extends gn{constructor(t,e){if(super(),vn.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Qr(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!r[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return an(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),an(this,t,!0),e=Float64Array.from(un(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){sn(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),sn(this,t,!0),e=hn(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(gn,vn);class yn extends gn{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function mn(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class wn{constructor(t,e={}){if((t=yn.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=e;let s,u=Boolean(o),h=Boolean(i),d=!1;if(r<n)if(a){s=t.transpose(),r=s.rows,n=s.columns,d=!0;let e=u;u=h,h=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let l=Math.min(r,n),c=Math.min(r+1,n),f=new Float64Array(c),g=new vn(r,l),p=new vn(n,n),v=new Float64Array(n),y=new Float64Array(r),m=new Float64Array(c);for(let t=0;t<c;t++)m[t]=t;let w=Math.min(r-1,n),x=Math.max(0,Math.min(n-2,r)),E=Math.max(w,x);for(let t=0;t<E;t++){if(t<w){f[t]=0;for(let e=t;e<r;e++)f[t]=mn(f[t],s.get(e,t));if(0!==f[t]){s.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<r;e++)s.set(e,t,s.get(e,t)/f[t]);s.set(t,t,s.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<n;e++){if(t<w&&0!==f[t]){let n=0;for(let o=t;o<r;o++)n+=s.get(o,t)*s.get(o,e);n=-n/s.get(t,t);for(let o=t;o<r;o++)s.set(o,e,s.get(o,e)+n*s.get(o,t))}v[e]=s.get(t,e)}if(u&&t<w)for(let e=t;e<r;e++)g.set(e,t,s.get(e,t));if(t<x){v[t]=0;for(let e=t+1;e<n;e++)v[t]=mn(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<n;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<r&&0!==v[t]){for(let e=t+1;e<r;e++)y[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)y[e]+=v[r]*s.get(e,r);for(let e=t+1;e<n;e++){let n=-v[e]/v[t+1];for(let o=t+1;o<r;o++)s.set(o,e,s.get(o,e)+n*y[o])}}if(h)for(let e=t+1;e<n;e++)p.set(e,t,v[e])}}let N=Math.min(n,r+1);if(w<n&&(f[w]=s.get(w,w)),r<N&&(f[N-1]=0),x+1<N&&(v[x]=s.get(x,N-1)),v[N-1]=0,u){for(let t=w;t<l;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<l;e++){let n=0;for(let o=t;o<r;o++)n+=g.get(o,t)*g.get(o,e);n=-n/g.get(t,t);for(let o=t;o<r;o++)g.set(o,e,g.get(o,e)+n*g.get(o,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(h)for(let t=n-1;t>=0;t--){if(t<x&&0!==v[t])for(let e=t+1;e<n;e++){let r=0;for(let o=t+1;o<n;o++)r+=p.get(o,t)*p.get(o,e);r=-r/p.get(t+1,t);for(let o=t+1;o<n;o++)p.set(o,e,p.get(o,e)+r*p.get(o,t))}for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}let b=N-1,M=0,S=Number.EPSILON;for(;N>0;){let t,e;for(t=N-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===N-2)e=4;else{let r;for(r=N-1;r>=t&&r!==t;r--){let e=(r!==N?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(f[r])<=S*e){f[r]=0;break}}r===t?e=3:r===N-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[N-2];v[N-2]=0;for(let r=N-2;r>=t;r--){let o=mn(f[r],e),i=f[r]/o,a=e/o;if(f[r]=o,r!==t&&(e=-a*v[r-1],v[r-1]=i*v[r-1]),h)for(let t=0;t<n;t++)o=i*p.get(t,r)+a*p.get(t,N-1),p.set(t,N-1,-a*p.get(t,r)+i*p.get(t,N-1)),p.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<N;n++){let o=mn(f[n],e),i=f[n]/o,a=e/o;if(f[n]=o,e=-a*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g.get(e,n)+a*g.get(e,t-1),g.set(e,t-1,-a*g.get(e,n)+i*g.get(e,t-1)),g.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(f[N-1]),Math.abs(f[N-2]),Math.abs(v[N-2]),Math.abs(f[t]),Math.abs(v[t])),o=f[N-1]/e,i=f[N-2]/e,a=v[N-2]/e,s=f[t]/e,d=v[t]/e,l=((i+o)*(i-o)+a*a)/2,c=o*a*(o*a);let y=0;0===l&&0===c||(y=l<0?0-Math.sqrt(l*l+c):Math.sqrt(l*l+c),y=c/(l+y));let m=(s+o)*(s-o)+y,w=s*d;for(let e=t;e<N-1;e++){let o=mn(m,w);0===o&&(o=Number.MIN_VALUE);let i=m/o,a=w/o;if(e!==t&&(v[e-1]=o),m=i*f[e]+a*v[e],v[e]=i*v[e]-a*f[e],w=a*f[e+1],f[e+1]=i*f[e+1],h)for(let t=0;t<n;t++)o=i*p.get(t,e)+a*p.get(t,e+1),p.set(t,e+1,-a*p.get(t,e)+i*p.get(t,e+1)),p.set(t,e,o);if(o=mn(m,w),0===o&&(o=Number.MIN_VALUE),i=m/o,a=w/o,f[e]=o,m=i*v[e]+a*f[e+1],f[e+1]=-a*v[e]+i*f[e+1],w=a*v[e+1],v[e+1]=i*v[e+1],u&&e<r-1)for(let t=0;t<r;t++)o=i*g.get(t,e)+a*g.get(t,e+1),g.set(t,e+1,-a*g.get(t,e)+i*g.get(t,e+1)),g.set(t,e,o)}v[N-2]=m,M+=1;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,h))for(let e=0;e<=b;e++)p.set(e,t,-p.get(e,t));for(;t<b&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,h&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}M=0,N--}}if(d){let t=p;p=g,g=t}this.m=r,this.n=n,this.s=f,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,o=vn.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?o.set(t,t,0):o.set(t,t,1/this.s[t]);let i=this.U,a=this.rightSingularVectors,s=a.mmul(o),u=a.rows,h=i.rows,d=vn.zeros(u,h);for(let t=0;t<u;t++)for(let e=0;e<h;e++){let r=0;for(let o=0;o<n;o++)r+=s.get(t,o)*i.get(e,o);d.set(t,e,r)}return d.mmul(e)}solveForDiagonal(t){return this.solve(vn.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new vn(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,a=i.rows,s=i.columns,u=new vn(r,a);for(let t=0;t<r;t++)for(let e=0;e<a;e++){let r=0;for(let n=0;n<s;n++)r+=o.get(t,n)*i.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return vn.diag(this.s)}}var xn,En={center:[0,0],linkDistance:50},Nn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="mds",this.options=n(n({},En),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericMDSLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericMDSLayout(!0,t,e),[2]}))}))},t.prototype.genericMDSLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,g,y;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=void 0===i?[0,0]:i,u=o.linkDistance,h=void 0===u?50:u,d=e.getAllNodes(),l=e.getAllEdges(),(null==d?void 0:d.length)&&1!==d.length?(c=v({nodes:d,edges:l},!1),f=p(c),bn(f),m=h,w=[],f.forEach((function(t){var e=[];t.forEach((function(t){e.push(t*m)})),w.push(e)})),g=Mn(w),y=[],g.forEach((function(t,e){var r=N(d[e]);r.data.x=t[0]+s[0],r.data.y=t[1]+s[1],y.push(r)})),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:y,edges:l}]):[2,_(e,t,s)];var m,w}))}))},t}(),bn=function(t){var e=-999999;t.forEach((function(t){t.forEach((function(t){t!==1/0&&e<t&&(e=t)}))})),t.forEach((function(r,n){r.forEach((function(r,o){r===1/0&&(t[n][o]=e)}))}))},Mn=function(t){var e=vn.mul(vn.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),o=e.mean();e.add(o).subRowVector(r).subColumnVector(n);var i=new wn(e),a=vn.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((function(t){return vn.mul([t],[a]).toJSON()[0].splice(0,2)}))},Sn={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},kn=function(t,e,r,n,o,i){e.forEach((function(a,s){r[s]={x:0,y:0},e.forEach((function(e,u){if(s!==u&&o[s]===o[u]){var h=a.x-e.x,d=a.y-e.y,l=Math.sqrt(h*h+d*d);if(0===l){l=1;var c=s>u?1:-1;h=.01*c,d=.01*c}if(l<i(t[s])/2+i(t[u])/2){var f=n*n/l;r[s].x+=h/l*f,r[s].y+=d/l*f}}}))}))},An=function(t,e,r,n,o,i,a,s){var u=i||a/10;return n&&e.forEach((function(e,r){var n=t[r].x-t[o].x,i=t[r].y-t[o].y,a=Math.sqrt(n*n+i*i),s=i/a,u=-n/a,h=Math.sqrt(e.x*e.x+e.y*e.y),d=Math.acos((s*e.x+u*e.y)/h);d>Math.PI/2&&(d-=Math.PI/2,s*=-1,u*=-1);var l=Math.cos(d)*h;e.x=s*l,e.y=u*l})),t.forEach((function(i,a){if(a!==o){var h=Math.sqrt(e[a].x*e[a].x+e[a].y*e[a].y);if(h>0&&a!==o){var d=Math.min(u*(r/800),h);if(i.x+=e[a].x/h*d,i.y+=e[a].y/h*d,n){var l=i.x-t[o].x,c=i.y-t[o].y,f=Math.sqrt(l*l+c*c);l=l/f*s[a],c=c/f*s[a],i.x=t[o].x+l,i.y=t[o].y+c}}}})),t},_n={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},zn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="radial",this.options=n(n({},_n),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRadialLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRadialLayout(!0,t,e),[2]}))}))},t.prototype.genericRadialLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,h,d,l,c,f,g,y,m,w,x,E,b,M,S,k,z,R,I,D,P,T,C,q,L,j,F,V,B,G,W,$,U,H,K,Y,J,X,Q,Z,tt,et;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,h=o.height,d=o.center,l=o.focusNode,c=o.unitRadius,f=o.nodeSize,g=o.nodeSpacing,y=o.strictRadial,m=o.preventOverlap,w=o.maxPreventOverlapIteration,x=o.sortBy,E=o.linkDistance,b=void 0===E?50:E,M=o.sortStrength,S=void 0===M?10:M,k=o.maxIteration,z=void 0===k?1e3:k,R=e.getAllNodes(),I=e.getAllEdges(),D=i||"undefined"==typeof window?i:window.innerWidth,P=h||"undefined"==typeof window?h:window.innerHeight,T=d||[D/2,P/2],!(null==R?void 0:R.length)||1===R.length)return[2,_(e,t,T)];if(C=R[0],O(l)){for(q=0;q<R.length;q++)if(R[q].id===l){C=R[q];break}}else C=l||R[0];return L=Dn(R,C.id),j=v({nodes:R,edges:I},!1),F=p(j),V=Pn(F,L),On(F,L,V+1),B=F[L],G=D-T[0]>T[0]?T[0]:D-T[0],W=P-T[1]>T[1]?T[1]:P-T[1],0===G&&(G=D/2),0===W&&(W=P/2),$=Math.min(G,W),U=Math.max.apply(Math,u([],s(B))),H=[],K=c||$/U,B.forEach((function(t,e){H[e]=t*K})),Y=Rn(R,F,b,H,K,x,S),J=In(Y),X=function(t,e,r){try{var n=vn.mul(vn.pow(e,2),-.5),o=n.mean("row"),i=n.mean("column"),a=n.mean();n.add(a).subRowVector(o).subColumnVector(i);var s=new wn(n),u=vn.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((function(e){return vn.mul([e],[u]).toJSON()[0].splice(0,t)}))}catch(t){for(var h=[],d=0;d<e.length;d++){var l=Math.random()*r,c=Math.random()*r;h.push([l,c])}return h}}(b,Y,b),Q=X.map((function(t){var e=s(t,2),r=e[0],n=e[1];return{x:(isNaN(r)?Math.random()*b:r)-X[L][0],y:(isNaN(n)?Math.random()*b:n)-X[L][1]}})),this.run(z,Q,J,Y,H,L),m&&(Z=A(f,g),tt={nodes:R,nodeSizeFunc:Z,positions:Q,radii:H,height:P,width:D,strictRadial:Boolean(y),focusIdx:L,iterations:w||200,k:Q.length/4.5},Q=function(t,e){for(var r=n(n({},Sn),e),o=r.positions,i=r.iterations,a=r.width,s=r.k,u=r.speed,h=void 0===u?100:u,d=r.strictRadial,l=r.focusIdx,c=r.radii,f=void 0===c?[]:c,g=r.nodeSizeFunc,p=t.getAllNodes(),v=[],y=a/10,m=0;m<i;m++)o.forEach((function(t,e){v[e]={x:0,y:0}})),kn(p,o,v,s,f,g),An(o,v,h,d,l,y,a,f);return o}(e,tt)),et=[],Q.forEach((function(t,e){var r=N(R[e]);r.data.x=t.x+T[0],r.data.y=t.y+T[1],et.push(r)})),t&&et.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:et,edges:I}]}))}))},t.prototype.run=function(t,e,r,n,o,i){for(var a=0;a<=t;a++){var s=a/t;this.oneIteration(s,e,o,n,r,i)}},t.prototype.oneIteration=function(t,e,r,n,o,i){var a=1-t;e.forEach((function(s,u){var h=y(s,{x:0,y:0}),d=0===h?0:1/h;if(u!==i){var l=0,c=0,f=0;e.forEach((function(t,e){if(u!==e){var r=y(s,t),i=0===r?0:1/r,a=n[e][u];f+=o[u][e],l+=o[u][e]*(t.x+a*(s.x-t.x)*i),c+=o[u][e]*(t.y+a*(s.y-t.y)*i)}}));var g=0===r[u]?0:1/r[u];f*=a,f+=t*g*g,l*=a,l+=t*g*s.x*d,s.x=l/f,c*=a,c+=t*g*s.y*d,s.y=c/f}}))},t}(),Rn=function(t,e,r,n,o,i,a){if(!t)return[];var s=[];if(e){var u={};e.forEach((function(e,h){var d=[];e.forEach((function(e,s){var l,c;if(h===s)d.push(0);else if(n[h]===n[s])if("data"===i)d.push(e*(Math.abs(h-s)*a)/(n[h]/o));else if(i){var f=void 0,g=void 0;if(u[t[h].id])f=u[t[h].id];else{var p=("id"===i?t[h].id:null===(l=t[h].data)||void 0===l?void 0:l[i])||0;f=O(p)?p.charCodeAt(0):p,u[t[h].id]=f}u[t[s].id]?g=u[t[s].id]:(p=("id"===i?t[s].id:null===(c=t[s].data)||void 0===c?void 0:c[i])||0,g=O(p)?p.charCodeAt(0):p,u[t[s].id]=g),d.push(e*(Math.abs(f-g)*a)/(n[h]/o))}else d.push(e*r/(n[h]/o));else{var v=(r+o)/2;d.push(e*v)}})),s.push(d)}))}return s},In=function(t){for(var e=t.length,r=t[0].length,n=[],o=0;o<e;o++){for(var i=[],a=0;a<r;a++)0!==t[o][a]?i.push(1/(t[o][a]*t[o][a])):i.push(0);n.push(i)}return n},Dn=function(t,e){var r=-1;return t.forEach((function(t,n){t.id===e&&(r=n)})),Math.max(r,0)},On=function(t,e,r){for(var n=t.length,o=0;o<n;o++)if(t[e][o]===1/0){t[e][o]=r,t[o][e]=r;for(var i=0;i<n;i++)t[o][i]!==1/0&&t[e][i]===1/0&&(t[e][i]=r+t[o][i],t[i][e]=r+t[o][i])}for(o=0;o<n;o++)if(o!==e)for(i=0;i<n;i++)if(t[o][i]===1/0){var a=Math.abs(t[e][o]-t[e][i]);a=0===a?1:a,t[o][i]=a}},Pn=function(t,e){for(var r=0,n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r},Tn={center:[0,0],width:300,height:300},Cn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="random",this.options=n(n({},Tn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRandomLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRandomLayout(!0,t,e),[2]}))}))},t.prototype.genericRandomLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,h=e.getAllNodes(),d=s||"undefined"==typeof window?s:window.innerWidth,l=u||"undefined"==typeof window?u:window.innerHeight,c=i||[d/2,l/2],f=[],h&&h.forEach((function(t){f.push({id:t.id,data:{x:.9*(Math.random()-.5)*d+c[0],y:.9*(Math.random()-.5)*l+c[1]}})})),t&&f.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:f,edges:e.getAllEdges()}]}))}))},t}(),qn={circular:R,concentric:T,mds:Nn,random:Cn,grid:Wr,radial:zn,force:zr,d3force:Tt,fruchterman:Br,forceAtlas2:Fr,dagre:pr};function Ln(){var t;(null===(t=xn)||void 0===t?void 0:t.stop)&&xn.stop()}function jn(t,e){return i(this,void 0,void 0,(function(){var r,n,o,i,s,u,h,d,l;return a(this,(function(a){switch(a.label){case 0:if(r=t.layout,n=r.id,o=r.options,i=r.iterations,s=t.nodes,u=t.edges,h=new c({nodes:s,edges:u}),!(d=qn[n]))throw new Error("Unknown layout id: "+n);return[4,(xn=new d(o)).execute(h)];case 1:return l=a.sent(),!!(f=xn).tick&&!!f.stop&&(xn.stop(),l=xn.tick(i)),[2,[l,e]]}var f}))}))}addEventListener("message",(function(t){var r,n=t.data,o=n.type,i=n.method,a=n.id,s=n.params;"RPC"===o&&i&&((r=e[i])?Promise.resolve().then((function(){return r.apply(e,s)})):Promise.reject("No such method")).then((function(t){postMessage({type:"RPC",id:a,result:t})})).catch((function(t){var e={message:t};t.stack&&(e.message=t.message,e.stack=t.stack,e.name=t.name),postMessage({type:"RPC",id:a,error:e})}))})),postMessage({type:"RPC",method:"ready"});\n//# sourceMappingURL=5e37927bd3e57252658c.worker.js.map'])),{name:"[fullhash].worker.js"});return URL.revokeObjectURL(URL.createObjectURL(new Blob(['var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{calculateLayout:()=>jn,stopLayout:()=>Ln});var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function o(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function i(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function a(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function u(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}Object.create,Object.create;const h=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[],i=this._events["*"]||[],a=function(n){for(var o=n.length,i=0;i<o;i++)if(n[i]){var a=n[i],s=a.callback;a.once&&(n.splice(i,1),0===n.length&&delete e._events[t],o--,i--),s.apply(e,r)}};a(o),a(i)},t.prototype.off=function(t,e){if(t)if(e){for(var r=this._events[t]||[],n=r.length,o=0;o<n;o++)r[o].callback===e&&(r.splice(o,1),n--,o--);0===r.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function d(t,e,r,n){for(;t.length;){const o=t.shift();if(r(o))return!0;e.add(o.id),n(o.id).forEach((r=>{e.has(r.id)||(e.add(r.id),t.push(r))}))}return!1}function l(t,e,r,n){if(r(t))return!0;e.add(t.id);for(const o of n(t.id))if(!e.has(o.id)&&l(o,e,r,n))return!0;return!1}class c extends h{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const r=e.find((e=>e.type===t.type&&e.id===t.id&&e.propertyName===t.propertyName));r?r.newValue=t.newValue:e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const r=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),r=this.bothEdgesMap.get(t);r?.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((e=>{e.childrenMap.get(t)?.forEach((t=>{e.parentMap.delete(t.id)})),e.parentMap.delete(t),e.childrenMap.delete(t)})),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){const n=this.getNode(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateNodeDataProperty(t,e,r)}))}))}updateNodeData(...t){const e=t[0],r=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:o})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),o.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),o=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),o.delete(e),i.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.source,o=e;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:o})}))}updateEdgeTarget(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.target,o=e;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:o})}))}updateEdgeDataProperty(t,e,r){const n=this.getEdge(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}updateEdgeData(...t){const e=t[0],r=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:o})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateEdgeDataProperty(t,e,r)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const r=[],n=Array.isArray(t)?t:[t];for(;n.length;){const t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach((t=>{t.children?.forEach((r=>{this.setParent(r.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const r=this.treeIndices.get(e).childrenMap.get(t);return Array.from(r||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const r=[];let n,o=this.getNode(t);for(;n=this.getParent(o.id,e);)r.push(n),o=n;return r}setParent(t,e,r){this.checkTreeExistence(r);const n=this.treeIndices.get(r),o=this.getNode(t),i=n.parentMap.get(t),a=this.getNode(e);n.parentMap.set(t,a),i&&n.childrenMap.get(i.id)?.delete(o);let s=n.childrenMap.get(a.id);s||(s=new Set,n.childrenMap.set(a.id,s)),s.add(o),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:i?.id,newParentId:a.id})}))}dfsTree(t,e,r){return l(this.getNode(t),new Set,e,(t=>this.getChildren(t,r)))}bfsTree(t,e,r){return d([this.getNode(t)],new Set,e,(t=>this.getChildren(t,r)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return d([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return l(this.getNode(t),new Set,e,n)}clone(){const t=this.getAllNodes().map((t=>({...t,data:{...t.data}}))),e=this.getAllEdges().map((t=>({...t,data:{...t.data}}))),r=new c({nodes:t,edges:e});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},n)=>{const o=new Map;t.forEach(((t,e)=>{o.set(e,r.getNode(t.id))}));const i=new Map;e.forEach(((t,e)=>{i.set(e,new Set(Array.from(t).map((t=>r.getNode(t.id)))))})),r.treeIndices.set(n,{parentMap:o,childrenMap:i})})),r}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var f=/-(\\w)/g,g=(function(t){return t.replace(f,(function(t,e){return e?e.toUpperCase():""}))},Object.create(null),Array.isArray),p=function(t){for(var e=[],r=t.length,n=0;n<r;n+=1){e[n]=[];for(var o=0;o<r;o+=1)n===o?e[n][o]=0:0!==t[n][o]&&t[n][o]?e[n][o]=t[n][o]:e[n][o]=1/0}for(var i=0;i<r;i+=1)for(n=0;n<r;n+=1)for(o=0;o<r;o+=1)e[n][o]>e[n][i]+e[i][o]&&(e[n][o]=e[n][i]+e[i][o]);return e},v=function(t,e){var r=t.nodes,n=t.edges,o=[],i={};if(!r)throw new Error("invalid nodes data!");return r&&r.forEach((function(t,e){i[t.id]=e,o.push([])})),null==n||n.forEach((function(t){var r=t.source,n=t.target,a=i[r],s=i[n];void 0!==a&&void 0!==s&&(o[a][s]=1,e||(o[s][a]=1))})),o},y=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},m={}.toString;const w=function(t,e){return m.call(t)==="[object "+e+"]"},x=function(t){return w(t,"Number")};var E=function(t){if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var e=[];return t.forEach((function(t){e.push(t)})),e.map((function(t){return E(t)}))}if("object"==typeof t){var r={};return Object.keys(t).forEach((function(e){r[e]=E(t[e])})),r}return t},N=function(t,e){var r=E(t);return r.data=r.data||{},e&&(x(r.data.x)||(r.data.x=Math.random()*e[0]),x(r.data.y)||(r.data.y=Math.random()*e[1])),r};const b=function(t){return"function"==typeof t},M=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function S(t,e){return b(e)?e:x(e)?function(){return e}:function(){return t}}function k(t,e,r){return void 0===r&&(r=!0),e||0===e?b(e)?e:x(e)?function(){return e}:g(e)?function(){if(r){var n=Math.max.apply(Math,u([],s(e)));return isNaN(n)?t:n}return e}:M(e)?function(){if(r){var n=Math.max(e.width,e.height);return isNaN(n)?t:n}return[e.width,e.height]}:function(){return t}:function(e){var r=(e.data||{}).size;return r?g(r)?r[0]>r[1]?r[0]:r[1]:M(r)?r.width>r.height?r.width:r.height:r:t}}var A=function(t,e){var r;return r=x(e)?function(){return e}:b(e)?e:function(){return 0},t?g(t)?function(e){return(t[0]>t[1]?t[0]:t[1])+r(e)}:function(e){return t+r(e)}:function(t){var e,n;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return Math.max(t.data.bboxSize[0],t.data.bboxSize[1])+r(t);if(null===(n=t.data)||void 0===n?void 0:n.size){if(g(t.data.size))return Math.max(t.data.size[0],t.data.size[1])+r(t);var o=t.data.size;return M(o)?(o.width>o.height?o.width:o.height)+r(t):o+r(t)}return 10+r(t)}},_=function(t,e,r){var o=t.getAllNodes(),i=t.getAllEdges();return(null==o?void 0:o.length)?1===o.length?(e&&t.mergeNodeData(o[0].id,{x:r[0],y:r[1]}),{nodes:[n(n({},o[0]),{data:n(n({},o[0].data),{x:r[0],y:r[1]})})],edges:i}):void 0:{nodes:[],edges:i}},z={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},R=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="circular",this.options=n(n({},z),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericCircularLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericCircularLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericCircularLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,u,h,d,l,c,f,g,p,v,y,m,w,x,E,b,M,A,z,R,O,P,T,C,q,L,j,F,V,B,G,W,$,U;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,u=o.height,h=o.center,d=o.divisions,l=o.startAngle,c=void 0===l?0:l,f=o.endAngle,g=void 0===f?2*Math.PI:f,p=o.angleRatio,v=o.ordering,y=o.clockwise,m=o.nodeSpacing,w=o.nodeSize,x=e.getAllNodes(),E=e.getAllEdges(),b=s(D(i,u,h),3),M=b[0],A=b[1],z=b[2],!(R=null==x?void 0:x.length)||1===R)return[2,_(e,t,z)];for(O=(g-c)/R,P=o.radius,T=o.startRadius,C=o.endRadius,m?(q=S(10,m),L=k(10,w),j=-1/0,x.forEach((function(t){var e=L(t);j<e&&(j=e)})),F=0,x.forEach((function(t,e){F+=0===e?j||10:(q(t)||0)+(j||10)})),P=F/(2*Math.PI)):P||T||C?!T&&C?T=C:T&&!C&&(C=T):P=Math.min(A,M)/2,V=O*p,B=[],B="topology"===v?I(e,x):"topology-directed"===v?I(e,x,!0):"degree"===v?function(t,e){var r=[];return e.forEach((function(t,e){r.push(N(t))})),r.sort((function(e,r){return t.getDegree(e.id,"both")-t.getDegree(r.id,"both")})),r}(e,x):x.map((function(t){return N(t)})),G=Math.ceil(R/d),W=0;W<R;++W)($=P)||null===T||null===C||($=T+W*(C-T)/(R-1)),$||($=10+100*W/(R-1)),U=c+W%G*V+2*Math.PI/d*Math.floor(W/G),y||(U=g-W%G*V-2*Math.PI/d*Math.floor(W/G)),B[W].data.x=z[0]+Math.cos(U)*$,B[W].data.y=z[1]+Math.sin(U)*$;return t&&B.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:B,edges:E}]}))}))},t}(),I=function(t,e,r){void 0===r&&(r=!1);var n=[N(e[0])],o={},i=e.length;o[e[0].id]=!0;var a=0;return e.forEach((function(s,u){if(0!==u)if(u!==i-1&&t.getDegree(s.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(n[a].id,s.id)||o[s.id]){for(var h=r?t.getSuccessors(n[a].id):t.getNeighbors(n[a].id),d=!1,l=0;l<h.length;l++){var c=h[l];if(t.getDegree(c.id)===t.getDegree(s.id)&&!o[c.id]){n.push(N(c)),o[c.id]=!0,d=!0;break}}for(var f=0;!d&&(o[e[f].id]||(n.push(N(e[f])),o[e[f].id]=!0,d=!0),++f!==i););}else n.push(N(s)),o[s.id]=!0,a++})),n},D=function(t,e,r){var n=t,o=e,i=r;return n||"undefined"==typeof window||(n=window.innerWidth),o||"undefined"==typeof window||(o=window.innerHeight),i||(i=[n/2,o/2]),[n,o,i]};const O=function(t){return w(t,"String")};var P={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},T=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="concentric",this.options=n(n({},P),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericConcentricLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericConcentricLayout(!0,t,e),[2]}))}))},t.prototype.genericConcentricLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,p,v,y,m,w,E,S,k,A,z,R,I,D,P,T,C,q,L,j,F,V,B,G,W,$,U,H,K,Y;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,h=o.sortBy,d=o.maxLevelDiff,l=o.sweep,c=o.clockwise,f=o.equidistant,p=o.preventOverlap,v=o.startAngle,y=void 0===v?1.5*Math.PI:v,m=o.nodeSize,w=o.nodeSpacing,E=e.getAllNodes(),S=e.getAllEdges(),k=s||"undefined"==typeof window?s:window.innerWidth,A=u||"undefined"==typeof window?u:window.innerHeight,z=i||[k/2,A/2],!(null==E?void 0:E.length)||1===E.length)return[2,_(e,t,z)];if(R=[],D=0,I=g(m)?Math.max(m[0],m[1]):m,g(w)?D=Math.max(w[0],w[1]):x(w)&&(D=w),E.forEach((function(t){var e=N(t);R.push(e);var r=I,n=e.data;g(n.size)?r=Math.max(n.size[0],n.size[1]):x(n.size)?r=n.size:M(n.size)&&(r=Math.max(n.size.width,n.size.height)),I=Math.max(I,r),b(w)&&(D=Math.max(w(t),D))})),P={},R.forEach((function(t,e){P[t.id]=e})),O(T=h)&&void 0!==R[0].data[T]||(T="degree"),"degree"===T?R.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):R.sort((function(t,e){return e.data[T]-t.data[T]})),C=R[0],q=(d||("degree"===T?e.getDegree(C.id,"both"):C.data[T]))/4,j=(L=[{nodes:[]}])[0],R.forEach((function(t){if(j.nodes.length>0){var r="degree"===T?Math.abs(e.getDegree(j.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(j.nodes[0].data[T]-t.data[T]);q&&r>=q&&(j={nodes:[]},L.push(j))}j.nodes.push(t)})),F=I+D,p||(V=L.length>0&&L[0].nodes.length>1,B=Math.min(k,A)/2-F,G=B/(L.length+(V?1:0)),F=Math.min(F,G)),W=0,L.forEach((function(t){var e=void 0===l?2*Math.PI-2*Math.PI/t.nodes.length:l;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&p){var r=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),o=Math.sqrt(F*F/(r*r+n*n));W=Math.max(o,W)}t.r=W,W+=F})),f){for($=0,U=0,H=0;H<L.length;H++)K=L[H],Y=(K.r||0)-U,$=Math.max($,Y);U=0,L.forEach((function(t,e){0===e&&(U=t.r||0),t.r=U,U+=$}))}return L.forEach((function(t){var e=t.dTheta||0,r=t.r||0;t.nodes.forEach((function(t,n){var o=y+(c?1:-1)*e*n;t.data.x=z[0]+r*Math.cos(o),t.data.y=z[1]+r*Math.sin(o)}))})),t&&R.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:R,edges:S}]}))}))},t}();function C(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i,a,s,u,h,d,l,c,f=t._root,g={data:n},p=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!f)return t._root=g,t;for(;f.length;)if((h=e>=(i=(p+y)/2))?p=i:y=i,(d=r>=(a=(v+m)/2))?v=a:m=a,o=f,!(f=f[l=d<<1|h]))return o[l]=g,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&r===u)return g.next=f,o?o[l]=g:t._root=g,t;do{o=o?o[l]=new Array(4):t._root=new Array(4),(h=e>=(i=(p+y)/2))?p=i:y=i,(d=r>=(a=(v+m)/2))?v=a:m=a}while((l=d<<1|h)==(c=(u>=a)<<1|s>=i));return o[c]=f,o[l]=g,t}function q(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function L(t){return t[0]}function j(t){return t[1]}function F(t,e,r){var n=new V(null==e?L:e,null==r?j:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function V(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function B(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var G=F.prototype=V.prototype;function W(t){return function(){return t}}function $(t){return 1e-6*(t()-.5)}G.copy=function(){var t,e,r=new V(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=B(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var o=0;o<4;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(4)}):n.target[o]=B(e));return r},G.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return C(this.cover(e,r),e,r,t)},G.addAll=function(t){var e,r,n,o,i=t.length,a=new Array(i),s=new Array(i),u=1/0,h=1/0,d=-1/0,l=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(a[r]=n,s[r]=o,n<u&&(u=n),n>d&&(d=n),o<h&&(h=o),o>l&&(l=o));if(u>d||h>l)return this;for(this.cover(u,h).cover(d,l),r=0;r<i;++r)C(this,a[r],s[r],t[r]);return this},G.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var a,s,u=o-r||1,h=this._root;r>t||t>=o||n>e||e>=i;)switch(s=(e<n)<<1|t<r,(a=new Array(4))[s]=h,h=a,u*=2,s){case 0:o=r+u,i=n+u;break;case 1:r=o-u,i=n+u;break;case 2:o=r+u,n=i-u;break;case 3:r=o-u,n=i-u}this._root&&this._root.length&&(this._root=h)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this},G.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},G.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},G.find=function(t,e,r){var n,o,i,a,s,u,h,d=this._x0,l=this._y0,c=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new q(p,d,l,c,f)),null==r?r=1/0:(d=t-r,l=e-r,c=t+r,f=e+r,r*=r);u=g.pop();)if(!(!(p=u.node)||(o=u.x0)>c||(i=u.y0)>f||(a=u.x1)<d||(s=u.y1)<l))if(p.length){var v=(o+a)/2,y=(i+s)/2;g.push(new q(p[3],v,y,a,s),new q(p[2],o,y,v,s),new q(p[1],v,i,a,y),new q(p[0],o,i,v,y)),(h=(e>=y)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-h],g[g.length-1-h]=u)}else{var m=t-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),x=m*m+w*w;if(x<r){var E=Math.sqrt(r=x);d=t-E,l=e-E,c=t+E,f=e+E,n=p.data}}return n},G.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,r,n,o,i,a,s,u,h,d,l,c,f=this._root,g=this._x0,p=this._y0,v=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((h=i>=(s=(g+v)/2))?g=s:v=s,(d=a>=(u=(p+y)/2))?p=u:y=u,e=f,!(f=f[l=d<<1|h]))return this;if(!f.length)break;(e[l+1&3]||e[l+2&3]||e[l+3&3])&&(r=e,c=l)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(o=f.next)&&delete f.next,n?(o?n.next=o:delete n.next,this):e?(o?e[l]=o:delete e[l],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[c]=f:this._root=f),this):(this._root=o,this)},G.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},G.root=function(){return this._root},G.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},G.visit=function(t){var e,r,n,o,i,a,s=[],u=this._root;for(u&&s.push(new q(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,n=e.x0,o=e.y0,i=e.x1,a=e.y1)&&u.length){var h=(n+i)/2,d=(o+a)/2;(r=u[3])&&s.push(new q(r,h,d,i,a)),(r=u[2])&&s.push(new q(r,n,d,h,a)),(r=u[1])&&s.push(new q(r,h,o,i,d)),(r=u[0])&&s.push(new q(r,n,o,h,d))}return this},G.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new q(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.x1,h=e.y1,d=(a+u)/2,l=(s+h)/2;(i=o[0])&&r.push(new q(i,a,s,d,l)),(i=o[1])&&r.push(new q(i,d,s,u,l)),(i=o[2])&&r.push(new q(i,a,l,d,h)),(i=o[3])&&r.push(new q(i,d,l,u,h))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},G.x=function(t){return arguments.length?(this._x=t,this):this._x},G.y=function(t){return arguments.length?(this._y=t,this):this._y};var U={value:()=>{}};function H(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new K(n)}function K(t){this._=t}function Y(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function J(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=U,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}K.prototype=H.prototype={constructor:K,on:function(t,e){var r,n,o=this._,i=(n=o,(t+"").trim().split(/^|\\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)o[r]=J(o[r],t.name,e);else if(null==e)for(r in o)o[r]=J(o[r],t.name,null);return this}for(;++a<s;)if((r=(t=i[a]).type)&&(r=Y(o[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new K(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};const X=H;var Q,Z,tt=0,et=0,rt=0,nt=1e3,ot=0,it=0,at=0,st="object"==typeof performance&&performance.now?performance:Date,ut="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ht(){return it||(ut(dt),it=st.now()+at)}function dt(){it=0}function lt(){this._call=this._time=this._next=null}function ct(t,e,r){var n=new lt;return n.restart(t,e,r),n}function ft(){it=(ot=st.now())+at,tt=et=0;try{!function(){ht(),++tt;for(var t,e=Q;e;)(t=it-e._time)>=0&&e._call.call(void 0,t),e=e._next;--tt}()}finally{tt=0,function(){for(var t,e,r=Q,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:Q=e);Z=t,pt(n)}(),it=0}}function gt(){var t=st.now(),e=t-ot;e>nt&&(at-=e,ot=t)}function pt(t){tt||(et&&(et=clearTimeout(et)),t-it>24?(t<1/0&&(et=setTimeout(ft,t-st.now()-at)),rt&&(rt=clearInterval(rt))):(rt||(ot=st.now(),rt=setInterval(gt,nt)),tt=1,ut(ft)))}lt.prototype=ct.prototype={constructor:lt,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?ht():+r)+(null==e?0:+e),this._next||Z===this||(Z?Z._next=this:Q=this,Z=this),this._call=t,this._time=r,pt()},stop:function(){this._call&&(this._call=null,this._time=1/0,pt())}};const vt=1664525,yt=1013904223,mt=4294967296;function wt(t){return t.x}function xt(t){return t.y}var Et=10,Nt=Math.PI*(3-Math.sqrt(5));function bt(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,a=.6,s=new Map,u=ct(l),h=X("tick","end"),d=function(){let t=1;return()=>(t=(vt*t+yt)%mt)/mt}();function l(){c(),h.call("tick",e),r<n&&(u.stop(),h.call("end",e))}function c(n){var u,h,d=t.length;void 0===n&&(n=1);for(var l=0;l<n;++l)for(r+=(i-r)*o,s.forEach((function(t){t(r)})),u=0;u<d;++u)null==(h=t[u]).fx?h.x+=h.vx*=a:(h.x=h.fx,h.vx=0),null==h.fy?h.y+=h.vy*=a:(h.y=h.fy,h.vy=0);return e}function f(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var o=Et*Math.sqrt(.5+r),i=r*Nt;e.x=o*Math.cos(i),e.y=o*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,d),e}return null==t&&(t=[]),f(),e={tick:c,restart:function(){return u.restart(l),e},stop:function(){return u.stop(),e},nodes:function(r){return arguments.length?(t=r,f(),s.forEach(g),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(d=t,s.forEach(g),e):d},force:function(t,r){return arguments.length>1?(null==r?s.delete(t):s.set(t,g(r)),e):s.get(t)},find:function(e,r,n){var o,i,a,s,u,h=0,d=t.length;for(null==n?n=1/0:n*=n,h=0;h<d;++h)(a=(o=e-(s=t[h]).x)*o+(i=r-s.y)*i)<n&&(u=s,n=a);return u},on:function(t,r){return arguments.length>1?(h.on(t,r),e):h.on(t)}}}function Mt(){var t,e,r,n,o,i=W(-30),a=1,s=1/0,u=.81;function h(r){var o,i=t.length,a=F(t,wt,xt).visitAfter(l);for(n=r,o=0;o<i;++o)e=t[o],a.visit(c)}function d(){if(t){var e,r,n=t.length;for(o=new Array(n),e=0;e<n;++e)r=t[e],o[r.index]=+i(r,e,t)}}function l(t){var e,r,n,i,a,s=0,u=0;if(t.length){for(n=i=a=0;a<4;++a)(e=t[a])&&(r=Math.abs(e.value))&&(s+=e.value,u+=r,n+=r*e.x,i+=r*e.y);t.x=n/u,t.y=i/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=o[e.data.index]}while(e=e.next)}t.value=s}function c(t,i,h,d){if(!t.value)return!0;var l=t.x-e.x,c=t.y-e.y,f=d-i,g=l*l+c*c;if(f*f/u<g)return g<s&&(0===l&&(g+=(l=$(r))*l),0===c&&(g+=(c=$(r))*c),g<a&&(g=Math.sqrt(a*g)),e.vx+=l*t.value*n/g,e.vy+=c*t.value*n/g),!0;if(!(t.length||g>=s)){(t.data!==e||t.next)&&(0===l&&(g+=(l=$(r))*l),0===c&&(g+=(c=$(r))*c),g<a&&(g=Math.sqrt(a*g)));do{t.data!==e&&(f=o[t.data.index]*n/g,e.vx+=l*f,e.vy+=c*f)}while(t=t.next)}}return h.initialize=function(e,n){t=e,r=n,d()},h.strength=function(t){return arguments.length?(i="function"==typeof t?t:W(+t),d(),h):i},h.distanceMin=function(t){return arguments.length?(a=t*t,h):Math.sqrt(a)},h.distanceMax=function(t){return arguments.length?(s=t*t,h):Math.sqrt(s)},h.theta=function(t){return arguments.length?(u=t*t,h):Math.sqrt(u)},h}function St(t){return t.index}function kt(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function At(t){var e,r,n,o,i,a,s=St,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},h=W(30),d=1;function l(n){for(var o=0,s=t.length;o<d;++o)for(var u,h,l,c,f,g,p,v=0;v<s;++v)h=(u=t[v]).source,c=(l=u.target).x+l.vx-h.x-h.vx||$(a),f=l.y+l.vy-h.y-h.vy||$(a),c*=g=((g=Math.sqrt(c*c+f*f))-r[v])/g*n*e[v],f*=g,l.vx-=c*(p=i[v]),l.vy-=f*p,h.vx+=c*(p=1-p),h.vy+=f*p}function c(){if(n){var a,u,h=n.length,d=t.length,l=new Map(n.map(((t,e)=>[s(t,e,n),t])));for(a=0,o=new Array(h);a<d;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=kt(l,u.source)),"object"!=typeof u.target&&(u.target=kt(l,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(a=0,i=new Array(d);a<d;++a)u=t[a],i[a]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);e=new Array(d),f(),r=new Array(d),g()}}function f(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+u(t[r],r,t)}function g(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+h(t[e],e,t)}return null==t&&(t=[]),l.initialize=function(t,e){n=t,a=e,c()},l.links=function(e){return arguments.length?(t=e,c(),l):t},l.id=function(t){return arguments.length?(s=t,l):s},l.iterations=function(t){return arguments.length?(d=+t,l):d},l.strength=function(t){return arguments.length?(u="function"==typeof t?t:W(+t),f(),l):u},l.distance=function(t){return arguments.length?(h="function"==typeof t?t:W(+t),g(),l):h},l}function _t(t){return t.x+t.vx}function zt(t){return t.y+t.vy}function Rt(t){var e,r,n,o=1,i=1;function a(){for(var t,a,u,h,d,l,c,f=e.length,g=0;g<i;++g)for(a=F(e,_t,zt).visitAfter(s),t=0;t<f;++t)u=e[t],l=r[u.index],c=l*l,h=u.x+u.vx,d=u.y+u.vy,a.visit(p);function p(t,e,r,i,a){var s=t.data,f=t.r,g=l+f;if(!s)return e>h+g||i<h-g||r>d+g||a<d-g;if(s.index>u.index){var p=h-s.x-s.vx,v=d-s.y-s.vy,y=p*p+v*v;y<g*g&&(0===p&&(y+=(p=$(n))*p),0===v&&(y+=(v=$(n))*v),y=(g-(y=Math.sqrt(y)))/y*o,u.vx+=(p*=y)*(g=(f*=f)/(c+f)),u.vy+=(v*=y)*g,s.vx-=p*(g=1-g),s.vy-=v*g)}}}function s(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var n,o,i=e.length;for(r=new Array(i),n=0;n<i;++n)o=e[n],r[o.index]=+t(o,n,e)}}return"function"!=typeof t&&(t=W(null==t?1:+t)),a.initialize=function(t,r){e=t,n=r,u()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(o=+t,a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:W(+e),u(),a):t},a}function It(t){var e,r,n,o=W(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=W(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:W(+t),a(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:W(+e),a(),i):t},i}function Dt(t){var e,r,n,o=W(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=W(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:W(+t),a(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:W(+e),a(),i):t},i}function Ot(){function t(t){return function(){return t}}var e,r=function(t){return t.cluster},n=t(1),o=t(-1),i=t(100),a=t(.1),u=[0,0],h=[],d={},l=[],c=100,f=100,g={none:{x:0,y:0}},p=[],v="force",y=!0,m=.1;function w(t){if(!y)return w;e.tick(),E();for(var n=0,o=h.length,i=void 0,a=t*m;n<o;++n)(i=h[n]).vx+=(g[r(i)].x-i.x)*a,i.vy+=(g[r(i)].y-i.y)*a}function x(){h&&function(){if(h&&h.length){if(void 0===r(h[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy(\'clusterAttr\') before calling .links()");var t,u,g,v,y,m=(t=[],u=[],g={},{},y=[],v=function(t){var e={};return t.forEach((function(t){var n=r(t);e[n]||(e[n]={count:0,sumforceNodeSize:0})})),t.forEach((function(t){var o=r(t),i=n(t),a=e[o];a.count=a.count+1,a.sumforceNodeSize=a.sumforceNodeSize+Math.PI*(i*i)*1.3,e[o]=a})),e}(h),y=function(t){var e={},n=[];return t.forEach((function(t){var n,o,i,a,s,u=(o=(n=t).source,i=n.target,(a=r(d[o]))<=(s=r(d[i]))?a+"~"+s:s+"~"+a),h=0;void 0!==e[u]&&(h=e[u]),h+=1,e[u]=h})),Object.entries(e).forEach((function(t){var e=s(t,2),r=e[0],o=e[1],i=r.split("~")[0],a=r.split("~")[1];void 0!==i&&void 0!==a&&n.push({source:i,target:a,count:o})})),n}(l),Object.keys(v).forEach((function(e,r){var n=v[e];t.push({id:e,size:n.count,r:Math.sqrt(n.sumforceNodeSize/Math.PI)}),g[e]=r})),y.forEach((function(t){var e=t.source,r=t.target,n=g[e],o=g[r];void 0!==n&&void 0!==o&&u.push({source:n,target:o,count:t.count})})),{nodes:t,links:u});e=bt(m.nodes).force("x",It(c).strength(.1)).force("y",Dt(f).strength(.1)).force("collide",Rt((function(t){return t.r})).iterations(4)).force("charge",Mt().strength(o)).force("links",At(m.nodes.length?m.links:[]).distance(i).strength(a)),p=e.nodes(),E()}}()}function E(){return g={none:{x:0,y:0}},p.forEach((function(t){g[t.id]={x:t.x-u[0],y:t.y-u[1]}})),g}return w.initialize=function(t){h=t,x()},w.template=function(t){return arguments.length?(v=t,x(),w):v},w.groupBy=function(t){return arguments.length?"string"==typeof t?(r=function(e){return e[t]},w):(r=t,w):r},w.enableGrouping=function(t){return arguments.length?(y=t,w):y},w.strength=function(t){return arguments.length?(m=t,w):m},w.centerX=function(t){return arguments.length?(c=t,w):c},w.centerY=function(t){return arguments.length?(f=t,w):f},w.nodes=function(t){return arguments.length?(function(t){d={},t.forEach((function(t){d[t.id]=t}))}(t||[]),h=t||[],w):h},w.links=function(t){return arguments.length?(l=t||[],x(),w):l},w.forceNodeSize=function(e){return arguments.length?(n="function"==typeof e?e:t(+e),x(),w):n},w.nodeSize=w.forceNodeSize,w.forceCharge=function(e){return arguments.length?(o="function"==typeof e?e:t(+e),x(),w):o},w.forceLinkDistance=function(e){return arguments.length?(i="function"==typeof e?e:t(+e),x(),w):i},w.forceLinkStrength=function(e){return arguments.length?(a="function"==typeof e?e:t(+e),x(),w):a},w.offset=function(t){return arguments.length?(u=t,w):u},w.getFocis=E,w}var Pt={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},Tt=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="d3force",this.options=n(n({},Pt),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){var t;null===(t=this.forceSimulation)||void 0===t||t.stop()},t.prototype.tick=function(t){var e=this;void 0===t&&(t=1),this.forceSimulation.tick(t);var r={nodes:Ct(this.lastLayoutNodes),edges:qt(this.lastLayoutEdges)};return this.lastAssign&&r.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,g,p,v,y,m,w,x,E,b,M,S,k,A,_,z,R,I,D=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=i.map((function(t){var e,r;return n(n({},N(t)),{x:null===(e=t.data)||void 0===e?void 0:e.x,y:null===(r=t.data)||void 0===r?void 0:r.y})})),h=s.map((function(t){return N(t)})),this.lastLayoutNodes=u,this.lastLayoutEdges=h,this.lastAssign=t,this.lastGraph=e,d=o.alphaMin,l=o.alphaDecay,c=o.alpha,f=o.nodeStrength,g=o.edgeStrength,p=o.linkDistance,v=o.clustering,y=o.clusterFociStrength,m=o.clusterEdgeDistance,w=o.clusterEdgeStrength,x=o.clusterNodeStrength,E=o.clusterNodeSize,b=o.collideStrength,M=void 0===b?1:b,S=o.center,k=void 0===S?[0,0]:S,A=o.preventOverlap,_=o.nodeSize,z=o.nodeSpacing,R=o.onTick,I=o.forceSimulation,[2,new Promise((function(r){if(I){v&&((i=Ot()).nodes(u),i.links(h)),I.nodes(u),h&&(s=At().id((function(t){return t.id})).links(h),g&&s.strength(g),p&&s.distance(p),I.force("link",s)),A&&D.overlapProcess(I,{nodeSize:_,nodeSpacing:z,collideStrength:M}),I.alpha(c).restart();var n=Ct(u),o=qt(h);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:o})}else try{var i,a=Mt();if(f&&a.strength(f),I=bt().nodes(u),v&&((i=Ot()).centerX(k[0]).centerY(k[1]).template("force").strength(y),h&&i.links(h),u&&i.nodes(u),i.forceLinkDistance(m).forceLinkStrength(w).forceCharge(x).forceNodeSize(E),I.force("group",i)),I.force("center",function(t,e){var r,n=1;function o(){var o,i,a=r.length,s=0,u=0;for(o=0;o<a;++o)s+=(i=r[o]).x,u+=i.y;for(s=(s/a-t)*n,u=(u/a-e)*n,o=0;o<a;++o)(i=r[o]).x-=s,i.y-=u}return null==t&&(t=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(n=+t,o):n},o}(k[0],k[1])).force("charge",a).alpha(c).alphaDecay(l).alphaMin(d),A&&D.overlapProcess(I,{nodeSize:_,nodeSpacing:z,collideStrength:M}),h){var s=At().id((function(t){return t.id})).links(h);g&&s.strength(g),p&&s.distance(p),I.force("link",s)}I.on("tick",(function(){var r=Ct(u);null==R||R({nodes:r,edges:qt(h)}),t&&r.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}))})).on("end",(function(){var n=Ct(u);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:qt(h)})}))}catch(t){console.warn(t)}D.forceSimulation=I}))]}))}))},t.prototype.overlapProcess=function(t,e){var r,n,o=e.nodeSize,i=e.nodeSpacing,a=e.collideStrength;if(n=x(i)?function(){return i}:b(i)?i:function(){return 0},o)if(b(o))r=function(t){return o(t)+n(t)};else if(g(o)){var s=(o[0]>o[1]?o[0]:o[1])/2;r=function(t){return s+n(t)}}else if(x(o)){var u=o/2;r=function(t){return u+n(t)}}else r=function(){return 10};else r=function(t){return t.size?g(t.size)?(t.size[0]>t.size[1]?t.size[0]:t.size[1])/2+n(t):M(t.size)?(t.size.width>t.size.height?t.size.width:t.size.height)/2+n(t):t.size/2+n(t):10+n(t)};t.force("collisionForce",Rt(r).strength(a))},t}(),Ct=function(t){return t.map((function(t){var e=t.x,r=t.y,i=o(t,["x","y"]);return n(n({},i),{data:n(n({},i.data),{x:e,y:r})})}))},qt=function(t){return t.map((function(t){var e=t.source,r=t.target,i=o(t,["source","target"]);return n(n({},i),{source:e.id,target:r.id})}))};var Lt=function(t,e){if("next"!==t&&"prev"!==t)return e},jt=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(function(){function t(){var t={};t.prev=t,t.next=t.prev,this.shortcut=t}return t.prototype.dequeue=function(){var t=this.shortcut,e=t.prev;if(e&&e!==t)return jt(e),e},t.prototype.enqueue=function(t){var e=this.shortcut;t.prev&&t.next&&jt(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e},t.prototype.toString=function(){for(var t=[],e=this.shortcut,r=e.prev;r!==e;)t.push(JSON.stringify(r,Lt)),r=null==r?void 0:r.prev;return"["+t.join(", ")+"]"},t}()),Vt=function(){return 1},Bt=function(t,e,r,o,i){var a,s,u=[];return t.hasNode(o.v)&&(null===(a=t.getRelatedEdges(o.v,"in"))||void 0===a||a.forEach((function(o){var a=o.data.weight,s=t.getNode(o.source);i&&u.push({v:o.source,w:o.target,in:0,out:0}),void 0===s.data.out&&(s.data.out=0),s.data.out-=a,Gt(e,r,n({v:s.id},s.data))})),null===(s=t.getRelatedEdges(o.v,"out"))||void 0===s||s.forEach((function(o){var i=o.data.weight,a=o.target,s=t.getNode(a);void 0===s.data.in&&(s.data.in=0),s.data.in-=i,Gt(e,r,n({v:s.id},s.data))})),t.removeNode(o.v)),i?u:void 0},Gt=function(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},Wt=function(t,e){var r="greedy"===e?function(t,e){var r;if(t.getAllNodes().length<=1)return[];var o=function(t,e){var r=new c,o=0,i=0;t.getAllNodes().forEach((function(t){r.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((function(t){var a=r.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target})),s=(null==e?void 0:e(t))||1;a?r.updateEdgeData(null==a?void 0:a.id,n(n({},a.data),{weight:a.data.weight+s})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:s}}),i=Math.max(i,r.getNode(t.source).data.out+=s),o=Math.max(o,r.getNode(t.target).data.in+=s)}));for(var a=[],s=i+o+3,u=0;u<s;u++)a.push(new Ft);var h=o+1;return r.getAllNodes().forEach((function(t){Gt(a,h,n({v:t.id},r.getNode(t.id).data))})),{buckets:a,zeroIdx:h,graph:r}}(t,function(t){return t.data.weight||1}||Vt);return null===(r=function(t,e,r){for(var n,o=[],i=e[e.length-1],a=e[0];t.getAllNodes().length;){for(;n=a.dequeue();)Bt(t,e,r,n);for(;n=i.dequeue();)Bt(t,e,r,n);if(t.getAllNodes().length)for(var s=e.length-2;s>0;--s)if(n=e[s].dequeue()){o=o.concat(Bt(t,e,r,n,!0));break}}return o}(o.graph,o.buckets,o.zeroIdx).map((function(e){return t.getRelatedEdges(e.v,"out").filter((function(t){return t.target===e.w}))})))||void 0===r?void 0:r.flat()}(t):$t(t);null==r||r.forEach((function(e){var r=e.data;t.removeEdge(e.id),r.forwardName=e.data.name,r.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:n({},r)})}))},$t=function(t){var e=[],r={},n={},o=function(i){n[i]||(n[i]=!0,r[i]=!0,t.getRelatedEdges(i,"out").forEach((function(t){r[t.target]?e.push(t):o(t.target)})),delete r[i])};return t.getAllNodes().forEach((function(t){return o(t.id)})),e},Ut=function(t,e,r,n){var o;do{o=""+n+Math.random()}while(t.hasNode(o));return r.dummy=e,t.addNode({id:o,data:r}),o},Ht=function(t){var e=new c;return t.getAllNodes().forEach((function(r){t.getChildren(r.id).length||e.addNode(n({},r))})),t.getAllEdges().forEach((function(t){e.addEdge(t)})),e},Kt=function(t,e){var r,n,o=Number(t.x),i=Number(t.y),a=Number(e.x)-o,s=Number(e.y)-i,u=Number(t.width)/2,h=Number(t.height)/2;return a||s?(Math.abs(s)*u>Math.abs(a)*h?(s<0&&(h=-h),r=h*a/s,n=h):(a<0&&(u=-u),r=u,n=u*s/a),{x:o+r,y:i+n}):{x:0,y:0}},Yt=function(t){for(var e=[],r=Xt(t)+1,n=0;n<r;n++)e.push([]);for(t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)})),n=0;n<r;n++)e[n]=e[n].sort((function(e,r){return n=t.getNode(e).data.order,o=t.getNode(r).data.order,Number(n)-Number(o);var n,o}));return e},Jt=function(t,e,r,n){var o={width:0,height:0};return x(r)&&x(n)&&(o.rank=r,o.order=n),Ut(t,"border",o,e)},Xt=function(t){var e;return t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)})),e||(e=0),e},Qt=function(t,e){return t.reduce((function(t,r){return e(t)>e(r)?r:t}))},Zt=function(t,e,r,n,o,i){n.includes(e.id)||(n.push(e.id),r||i.push(e.id),o(e.id).forEach((function(e){return Zt(t,e,r,n,o,i)})),r&&i.push(e.id))},te=function(t,e,r,n){var o=Array.isArray(e)?e:[e],i=function(e){return n?t.getSuccessors(e):t.getNeighbors(e)},a=[],s=[];return o.forEach((function(e){if(!t.hasNode(e.id))throw new Error("Graph does not have node: "+e);Zt(t,e,"post"===r,s,i,a)})),a},ee="edge-label",re=function(t){var e={},r=function(n){var o,i,a=t.getNode(n);return a?e[n]?a.data.rank:(e[n]=!0,null===(o=t.getRelatedEdges(n,"out"))||void 0===o||o.forEach((function(t){var e=r(t.target)-t.data.minlen;e&&(void 0===i||e<i)&&(i=e)})),i||(i=0),a.data.rank=i,i):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){return r(t.id)}))},ne=function(t,e){return t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen},oe=function(t,e){var r=function(n){e.getRelatedEdges(n,"both").forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ie=function(t,e){var r=function(n){var o;null===(o=e.getRelatedEdges(n,"both"))||void 0===o||o.forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||void 0===e.getNode(a).data.layer&&ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ae=function(t,e){return Qt(e.getAllEdges(),(function(r){return t.hasNode(r.source)!==t.hasNode(r.target)?ne(e,r):1/0}))},se=function(t,e,r){t.getAllNodes().forEach((function(t){var n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r}))},ue=function(t,e){var r=te(t,t.getAllNodes(),"post",!1);(r=r.slice(0,(null==r?void 0:r.length)-1)).forEach((function(r){he(t,e,r)}))},he=function(t,e,r){var n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find((function(t){return t.target===n||t.source===n})).data.cutvalue=de(t,e,r)},de=function(t,e,r){var n=t.getNode(r).data.parent,o=!0,i=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),a=0;return i||(o=!1,i=e.getRelatedEdges(n,"out").find((function(t){return t.target===r}))),a=i.data.weight,e.getRelatedEdges(r,"both").forEach((function(e){var i=e.source===r,s=i?e.target:e.source;if(s!==n){var u=i===o,h=e.data.weight;if(a+=u?h:-h,ye(t,r,s)){var d=t.getRelatedEdges(r,"both").find((function(t){return t.source===s||t.target===s})).data.cutvalue;a+=u?-d:d}}})),a},le=function(t,e){void 0===e&&(e=t.getAllNodes()[0].id),ce(t,{},1,e)},ce=function(t,e,r,n,o){var i,a=r,s=r,u=t.getNode(n);return e[n]=!0,null===(i=t.getNeighbors(n))||void 0===i||i.forEach((function(r){e[r.id]||(s=ce(t,e,s,r.id,n))})),u.data.low=a,u.data.lim=s++,o?u.data.parent=o:delete u.data.parent,s},fe=function(t){return t.getAllEdges().find((function(t){return t.data.cutvalue<0}))},ge=function(t,e,r){var n=r.source,o=r.target;e.getRelatedEdges(n,"out").find((function(t){return t.target===o}))||(n=r.target,o=r.source);var i=t.getNode(n),a=t.getNode(o),s=i,u=!1;i.data.lim>a.data.lim&&(s=a,u=!0);var h=e.getAllEdges().filter((function(e){return u===me(t.getNode(e.source),s)&&u!==me(t.getNode(e.target),s)}));return Qt(h,(function(t){return ne(e,t)}))},pe=function(t,e,r,n){var o=t.getRelatedEdges(r.source,"both").find((function(t){return t.source===r.target||t.target===r.target}));o&&t.removeEdge(o.id),t.addEdge({id:"e"+Math.random(),source:n.source,target:n.target,data:{}}),le(t),ue(t,e),ve(t,e)},ve=function(t,e){var r=t.getAllNodes().find((function(t){return!t.data.parent})),n=te(t,r,"pre",!1);(n=n.slice(1)).forEach((function(r){var n=t.getNode(r).data.parent,o=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),i=!1;!o&&e.hasNode(n)&&(o=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),i=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(i?null==o?void 0:o.data.minlen:-(null==o?void 0:o.data.minlen))}))},ye=function(t,e,r){return t.getRelatedEdges(e,"both").find((function(t){return t.source===r||t.target===r}))},me=function(t,e){return e.data.low<=t.data.lim&&t.data.lim<=e.data.lim},we=re,xe=function(t){!function(t){var e=function(t){var e=new c;return t.getAllNodes().forEach((function(t){e.addNode(n({},t))})),t.getAllEdges().forEach((function(t){var r=e.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target}));r?e.updateEdgeData(null==r?void 0:r.id,n(n({},r.data),{weight:r.data.weight+t.data.weight||0,minlen:Math.max(r.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e}(t);re(e);var r,o,i=function(t){var e,r,n=new c({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);oe(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r);return n}(e);for(le(i),ue(i,e);r=fe(i);)o=ge(i,e,r),pe(i,e,r,o)}(t)},Ee=function(t,e,r,n,o,i,a){var s=t.getChildren(a);if(null==s?void 0:s.length){var u=Jt(t,"_bt"),h=Jt(t,"_bb"),d=t.getNode(a);t.setParent(u,a),d.data.borderTop=u,t.setParent(h,a),d.data.borderBottom=h,null==s||s.forEach((function(s){Ee(t,e,r,n,o,i,s.id);var d=s.data.borderTop?s.data.borderTop:s.id,l=s.data.borderBottom?s.data.borderBottom:s.id,c=s.data.borderTop?n:2*n,f=d!==l?1:o-i[a]+1;t.addEdge({id:"e"+Math.random(),source:u,target:d,data:{minlen:f,weight:c,nestingEdge:!0}}),t.addEdge({id:"e"+Math.random(),source:l,target:h,data:{minlen:f,weight:c,nestingEdge:!0}})})),t.getParent(a)||t.addEdge({id:"e"+Math.random(),source:e,target:u,data:{weight:0,minlen:o+i[a]}})}else a!==e&&t.addEdge({id:"e"+Math.random(),source:e,target:a,data:{weight:0,minlen:r}})},Ne=function(t,e,r,n,o,i){var a={rank:i,borderType:e,width:0,height:0},s=o.data[e][i-1],u=Ut(t,"border",a,r);o.data[e][i]=u,t.setParent(u,n),s&&t.addEdge({id:"e"+Math.random(),source:s,target:u,data:{weight:1}})},be=function(t){t.getAllNodes().forEach((function(t){Me(t)})),t.getAllEdges().forEach((function(t){Me(t)}))},Me=function(t){var e=t.data.width;t.data.width=t.data.height,t.data.height=e},Se=function(t){(null==t?void 0:t.y)&&(t.y=-t.y)},ke=function(t){var e=t.x;t.x=t.y,t.y=e},Ae=function(t){for(var e={},r=t.getAllNodes(),n=r.map((function(t){var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),o=Math.max.apply(Math,u([],s(n))),i=[],a=0;a<o+1;a++)i.push([]);var h=r.sort((function(e,r){return t.getNode(e.id).data.rank-t.getNode(r.id).data.rank})),d=h.filter((function(e){return void 0!==t.getNode(e.id).data.fixorder})).sort((function(e,r){return t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder}));return null==d||d.forEach((function(r){isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0})),null==h||h.forEach((function(r){return t.dfsTree(r.id,(function(t){if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)}))})),i},_e=function(t,e,r){for(var n=function(t,e){return null==t?void 0:t.reduce((function(t,r,n){return t[r]=e[n],t}),{})}(r,r.map((function(t,e){return e}))),o=e.map((function(e){var r=t.getRelatedEdges(e,"out").map((function(t){return{pos:n[t.target]||0,weight:t.data.weight}}));return null==r?void 0:r.sort((function(t,e){return t.pos-e.pos}))})),i=o.flat().filter((function(t){return void 0!==t})),a=1;a<r.length;)a<<=1;var s=2*a-1;a-=1;var u=Array(s).fill(0,0,s),h=0;return null==i||i.forEach((function(t){if(t){var e=t.pos+a;u[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=u[e+1]),u[e=e-1>>1]+=t.weight;h+=t.weight*r}})),h},ze=function(t,e){for(var r=0,n=1;n<(null==e?void 0:e.length);n+=1)r+=_e(t,e[n-1],e[n]);return r},Re=function(t,e){var r,n=0,o=0;t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/o,t.weight=o,t.i=Math.min(e.i,t.i),e.merged=!0};const Ie=function(t,e){var r,n,o,i={};return null==t||t.forEach((function(t,e){i[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};var r=i[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)})),null===(r=e.getAllEdges())||void 0===r||r.forEach((function(t){var e=i[t.source],r=i[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(i[t.target]))})),function(t){for(var e,r,n=[],o=function(){var o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach((function(t){return(e=o,function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&Re(e,t)})(t);var e})),null===(r=o.out)||void 0===r||r.forEach((function(e){return(r=o,function(e){e.in.push(r),0==--e.indegree&&t.push(e)})(e);var r}))};null==t?void 0:t.length;)o();var i=n.filter((function(t){return!t.merged})),a=["vs","i","barycenter","weight"];return i.map((function(t){var e={};return null==a||a.forEach((function(r){void 0!==t[r]&&(e[r]=t[r])})),e}))}(null===(o=(n=Object.values(i)).filter)||void 0===o?void 0:o.call(n,(function(t){return!t.indegree})))};var De=function(t,e,r){for(var n,o=r;e.length&&(n=e[e.length-1]).i<=o;)e.pop(),null==t||t.push(n.vs),o++;return o},Oe=function(t,e,r,n,o,i){var a,s,u,h,d=t.getChildren(e).map((function(t){return t.id})),l=t.getNode(e),c=l?l.data.borderLeft:void 0,f=l?l.data.borderRight:void 0,g={};c&&(d=null==d?void 0:d.filter((function(t){return t!==c&&t!==f})));var p=function(t,e){return e.map((function(e){var r=t.getRelatedEdges(e,"in");if(!(null==r?void 0:r.length))return{v:e};var n={sum:0,weight:0};return null==r||r.forEach((function(e){var r=t.getNode(e.source);n.sum+=e.data.weight*r.data.order,n.weight+=e.data.weight})),{v:e,barycenter:n.sum/n.weight,weight:n.weight}}))}(t,d||[]);null==p||p.forEach((function(e){var o;if(null===(o=t.getChildren(e.v))||void 0===o?void 0:o.length){var a=Oe(t,e.v,r,n,i);g[e.v]=a,a.hasOwnProperty("barycenter")&&Te(e,a)}}));var v=Ie(p,r);Pe(v,g),null===(a=v.filter((function(t){return t.vs.length>0})))||void 0===a||a.forEach((function(e){var r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)}));var y=function(t,e,r,n){var o=function(t,e){var r={lhs:[],rhs:[]};return null==t||t.forEach((function(t){var e,o;o=(e=t).hasOwnProperty("fixorder")&&!isNaN(e.fixorder),(n?!o&&e.hasOwnProperty("barycenter"):o||e.hasOwnProperty("barycenter"))?r.lhs.push(t):r.rhs.push(t)})),r}(t),i=o.lhs,a=o.rhs.sort((function(t,e){return-t.i- -e.i})),s=[],u=0,h=0,d=0;null==i||i.sort(function(t,e){return function(r,n){if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i}}(!!e,!!r)),d=De(s,a,d),null==i||i.forEach((function(t){var e;d+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),u+=t.barycenter*t.weight,h+=t.weight,d=De(s,a,d)}));var l={vs:s.flat()};return h&&(l.barycenter=u/h,l.weight=h),l}(v,n,o,i);if(c&&(y.vs=[c,y.vs,f].flat(),null===(s=t.getPredecessors(c))||void 0===s?void 0:s.length)){var m=t.getNode((null===(u=t.getPredecessors(c))||void 0===u?void 0:u[0].id)||""),w=t.getNode((null===(h=t.getPredecessors(f))||void 0===h?void 0:h[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+w.data.order)/(y.weight+2),y.weight+=2}return y},Pe=function(t,e){null==t||t.forEach((function(t){var r,n=null===(r=t.vs)||void 0===r?void 0:r.map((function(t){return e[t]?e[t].vs:t}));t.vs=n.flat()}))},Te=function(t,e){void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},Ce=function(t){if("object"!=typeof t||null===t)return t;var e,r;if(r=t,Array.isArray?Array.isArray(r):w(r,"Array")){e=[];for(var n=0,o=t.length;n<o;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=Ce(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=Ce(t[i]):e[i]=t[i];return e};const qe=Ce;var Le=function(t,e,r){return e.map((function(e){return function(t,e,r){var o=function(t){for(var e;t.hasNode(e="_root"+Math.random()););return e}(t),i=new c({tree:[{id:o,children:[],data:{}}]});return t.getAllNodes().forEach((function(a){var s=t.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(n({},a)),(null==s?void 0:s.id)&&!i.hasNode(null==s?void 0:s.id)&&i.addNode(n({},s)),i.setParent(a.id,(null==s?void 0:s.id)||o),t.getRelatedEdges(a.id,r).forEach((function(e){var r=e.source===a.id?e.target:e.source;i.hasNode(r)||i.addNode(n({},t.getNode(r)));var o=i.getRelatedEdges(r,"out").find((function(t){return t.target===a.id})),s=void 0!==o?o.data.weight:0;o?i.updateEdgeData(o.id,n(n({},o.data),{weight:e.data.weight+s})):i.addEdge({id:e.id,source:r,target:a.id,data:{weight:e.data.weight+s}})})),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,n(n({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))})),i}(t,e,r)}))},je=function(t,e,r,n){var o=new c;null==t||t.forEach((function(t){for(var i,a=t.getRoots()[0].id,s=Oe(t,a,o,e,r,n),u=0;u<(null===(i=s.vs)||void 0===i?void 0:i.length);u++){var h=t.getNode(s.vs[u]);h&&(h.data.order=u)}!function(t,e,r){var n,o={};null==r||r.forEach((function(r){for(var i,a,s=t.getParent(r);s;){if((i=t.getParent(s.id))?(a=o[i.id],o[i.id]=s.id):(a=n,n=s.id),a&&a!==s.id)return e.addNodes([{id:a,data:{}},{id:s.id,data:{}}]),void e.addEdge({id:"e"+a+"-"+s.id,source:a,target:s.id,data:{}});s=i}}))}(t,o,s.vs)}))},Fe=function(t,e){null==e||e.forEach((function(e){null==e||e.forEach((function(e,r){t.getNode(e).data.order=r}))}))},Ve=function(t,e){var r={};function n(e,n,o,i,a){for(var s,u,h,d=n;d<o;d++)h=e[d],(null===(s=t.getNode(h))||void 0===s?void 0:s.data.dummy)&&(null===(u=t.getPredecessors(h))||void 0===u||u.forEach((function(e){var n=t.getNode(e.id);n.data.dummy&&(n.data.order<i||n.data.order>a)&&Ge(r,e.id,h)})))}function o(t,e){var r=function(t){return JSON.stringify(t.slice(1))}(t);e.get(r)||(n.apply(void 0,u([],s(t))),e.set(r,!0))}return(null==e?void 0:e.length)&&e.reduce((function(e,r){var n,i=-1,a=0,s=new Map;return null==r||r.forEach((function(u,h){var d;if("border"===(null===(d=t.getNode(u))||void 0===d?void 0:d.data.dummy)){var l=t.getPredecessors(u)||[];l.length&&(n=t.getNode(l[0].id).data.order,o([r,a,h,i,n],s),a=h,i=n)}o([r,a,r.length,n,e.length],s)})),r})),r},Be=function(t,e){var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find((function(e){return t.getNode(e.id).data.dummy}))},Ge=function(t,e,r){var n=e,o=r;if(n>o){var i=n;n=o,o=i}var a=t[n];a||(t[n]=a={}),a[o]=!0},We=function(t,e,r){var n=e;return n>r&&(n=r),!!t[n]},$e=function(t,e,r,o,i,a){var s=new c,u=Ue(o,i,a);return null==e||e.forEach((function(e){var o;null==e||e.forEach((function(e){var i=r[e];if(s.hasNode(i)||s.addNode({id:i,data:{}}),o){var a=r[o],h=s.getRelatedEdges(a,"out").find((function(t){return t.target===i}));h?s.updateEdgeData(h.id,n(n({},h.data),{weight:Math.max(u(t,e,o),h.data.weight||0)})):s.addEdge({id:"e"+Math.random(),source:a,target:i,data:{weight:Math.max(u(t,e,o),0)}})}o=e}))})),s};var Ue=function(t,e,r){return function(n,o,i){var a=n.getNode(o),s=n.getNode(i),u=0,h=0;if(u+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":h=-a.data.width/2;break;case"r":h=a.data.width/2}if(h&&(u+=r?h:-h),h=0,u+=(a.data.dummy?e:t)/2,u+=(s.data.dummy?e:t)/2,u+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":h=s.data.width/2;break;case"r":h=-s.data.width/2}return h&&(u+=r?h:-h),h=0,u}},He=function(t,e){return t.getNode(e).data.width||0},Ke=function(t,e){var r,n=Ht(t);!function(t,e){var r=(e||{}).ranksep,n=void 0===r?0:r,o=Yt(t),i=0;null==o||o.forEach((function(e){var r=e.map((function(e){return t.getNode(e).data.height})),o=Math.max.apply(Math,u(u([],s(r)),[0]));null==e||e.forEach((function(e){t.getNode(e).data.y=i+o/2})),i+=o+n}))}(n,e);var o=function(t,e){var r=e||{},n=r.align,o=r.nodesep,i=void 0===o?0:o,a=r.edgesep,h=void 0===a?0:a,d=Yt(t),l=Object.assign(function(t,e){var r={};return(null==e?void 0:e.length)&&e.reduce((function(e,n){var o=0,i=0,a=e.length,s=null==n?void 0:n[(null==n?void 0:n.length)-1];return null==n||n.forEach((function(e,u){var h,d=Be(t,e),l=d?t.getNode(d.id).data.order:a;(d||e===s)&&(null===(h=n.slice(i,u+1))||void 0===h||h.forEach((function(e){var n;null===(n=t.getPredecessors(e))||void 0===n||n.forEach((function(n){var i,a=t.getNode(n.id),s=a.data.order;!(s<o||l<s)||a.data.dummy&&(null===(i=t.getNode(e))||void 0===i?void 0:i.data.dummy)||Ge(r,n.id,e)}))})),i=u+1,o=l)})),n})),r}(t,d),Ve(t,d)),c={},f=[];["u","d"].forEach((function(e){f="u"===e?d:Object.values(d).reverse(),["l","r"].forEach((function(r){"r"===r&&(f=f.map((function(t){return Object.values(t).reverse()})));var n=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),o=function(t,e,r,n){var o={},i={},a={};return null==e||e.forEach((function(t){null==t||t.forEach((function(t,e){o[t]=t,i[t]=t,a[t]=e}))})),null==e||e.forEach((function(t){var e=-1;null==t||t.forEach((function(t){var s=n(t).map((function(t){return t.id}));if(s.length){s=s.sort((function(t,e){return a[t]-a[e]}));for(var u=(s.length-1)/2,h=Math.floor(u),d=Math.ceil(u);h<=d;++h){var l=s[h];i[t]===t&&e<a[l]&&!We(r,t,l)&&(i[l]=t,i[t]=o[t]=o[l],e=a[l])}}}))})),{root:o,align:i}}(0,f,l,n),a=function(t,e,r,n,o,i,a){var s,u={},h=$e(t,e,r,o,i,a),d=a?"borderLeft":"borderRight",l=function(t,e){for(var r=h.getAllNodes(),n=r.pop(),o={};n;)o[n.id]?t(n.id):(o[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return l((function(t){u[t]=(h.getRelatedEdges(t,"in")||[]).reduce((function(t,e){return Math.max(t,(u[e.source]||0)+e.data.weight)}),0)}),h.getPredecessors.bind(h)),l((function(e){var r=(h.getRelatedEdges(e,"out")||[]).reduce((function(t,e){return Math.min(t,(u[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==d&&(u[e]=Math.max(u[e],r))}),h.getSuccessors.bind(h)),null===(s=Object.values(n))||void 0===s||s.forEach((function(t){u[t]=u[r[t]]})),u}(t,f,o.root,o.align,i,h,"r"===r);"r"===r&&Object.keys(a).forEach((function(t){return a[t]=-a[t]})),c[e+r]=a}))}));var g=function(t,e){return Qt(Object.values(e),(function(e){var r,n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach((function(r){var i=e[r],a=He(t,r)/2;n=Math.max(i+a,n),o=Math.min(i-a,o)})),n-o}))}(t,c);return g&&function(t,e){var r=Object.values(e),n=Math.min.apply(Math,u([],s(r))),o=Math.max.apply(Math,u([],s(r)));["u","d"].forEach((function(r){["l","r"].forEach((function(i){var a,h=r+i,d=t[h];if(d!==e){var l=Object.values(d);(a="l"===i?n-Math.min.apply(Math,u([],s(l))):o-Math.max.apply(Math,u([],s(l))))&&(t[h]={},Object.keys(d).forEach((function(e){t[h][e]=d[e]+a})))}}))}))}(c,g),function(t,e){var r={};return Object.keys(t.ul).forEach((function(n){if(e)r[n]=t[e.toLowerCase()][n];else{var o=Object.values(t).map((function(t){return t[n]}));r[n]=(o[0]+o[1])/2}})),r}(c,n)}(n,e);null===(r=Object.keys(o))||void 0===r||r.forEach((function(t){n.getNode(t).data.x=o[t]}))},Ye=function(t,e){var r=e.acyclicer,o=e.ranker,i=e.rankdir,a=void 0===i?"tb":i,h=e.nodeOrder,d=e.keepNodeOrder,l=e.align,f=e.nodesep,g=void 0===f?50:f,p=e.edgesep,v=void 0===p?20:p,y=e.ranksep,m=void 0===y?50:y;hr(t),Wt(t,r);var w=function(t){var e=Ut(t,"root",{},"_root"),r=function(t){var e={},r=function(n,o){var i=t.getChildren(n);null==i||i.forEach((function(t){return r(t.id,o+1)})),e[n]=o};return t.getRoots().forEach((function(t){return r(t.id,1)})),e}(t),n=Math.max.apply(Math,u([],s(Object.values(r))));Math.abs(n)===1/0&&(n=1);var o=n-1,i=2*o+1;t.getAllEdges().forEach((function(t){t.data.minlen*=i}));var a=function(t){var e=0;return t.getAllEdges().forEach((function(t){e+=t.data.weight})),e}(t)+1;return t.getRoots().forEach((function(n){Ee(t,e,i,a,o,r,n.id)})),{nestingRoot:e,nodeRankFactor:i}}(t),x=w.nestingRoot,E=w.nodeRankFactor;!function(t,e){switch(e){case"network-simplex":xe(t);break;case"tight-tree":default:!function(t){!function(t){var e,r={},n=function(o){var i,a,s=t.getNode(o);return s?r[o]?s.data.rank:(r[o]=!0,null===(i=t.getRelatedEdges(o,"out"))||void 0===i||i.forEach((function(t){var e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),(void 0===e||a<e)&&(e=a),s.data.rank=a,a):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){t&&n(t.id)})),void 0===e&&(e=0);var o={},i=function(e,r){var n,a=t.getNode(e),s=isNaN(a.data.layer)?r:a.data.layer;(void 0===a.data.rank||a.data.rank<s)&&(a.data.rank=s),o[e]||(o[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach((function(t){i(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((function(t){var r=t.data;r&&(isNaN(r.layer)?r.rank-=e:i(t.id,r.layer))}))}(t),function(t){var e,r,n=new c({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);ie(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r)}(t)}(t);break;case"longest-path":we(t)}}(Ht(t),o),er(t),function(t,e){void 0===e&&(e=0);var r=t.getAllNodes(),n=r.filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),o=Math.min.apply(Math,u([],s(n))),i=[];r.forEach((function(t){var e=(t.data.rank||0)-o;i[e]||(i[e]=[]),i[e].push(t.id)}));for(var a=0,h=0;h<i.length;h++){var d=i[h];void 0===d?h%e!=0&&(a-=1):a&&(null==d||d.forEach((function(e){var r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=a)})))}}(t,E),function(t,e){e&&t.removeNode(e),t.getAllEdges().forEach((function(e){e.data.nestingEdge&&t.removeEdge(e.id)}))}(t,x),function(t){var e=t.getAllNodes().filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),r=Math.min.apply(Math,u([],s(e)));t.getAllNodes().forEach((function(t){t.data.hasOwnProperty("rank")&&r!==1/0&&(t.data.rank-=r)}))}(t),rr(t),nr(t);var N=[];!function(t,e){t.getAllEdges().forEach((function(r){return function(t,e,r){var n=e.source,o=t.getNode(n).data.rank,i=e.target,a=t.getNode(i).data.rank,s=e.data.labelRank;if(a!==o+1){var u,h,d;for(t.removeEdge(e.id),d=0,++o;o<a;++d,++o)e.data.points=[],u=Ut(t,"edge",h={originalEdge:e,width:0,height:0,rank:o},"_d"),o===s&&(h.width=e.data.width,h.height=e.data.height,h.dummy=ee,h.labelpos=e.data.labelpos),t.addEdge({id:"e"+Math.random(),source:n,target:u,data:{weight:e.data.weight}}),0===d&&r.push(u),n=u;t.addEdge({id:"e"+Math.random(),source:n,target:i,data:{weight:e.data.weight}})}}(t,r,e)}))}(t,N),function(t,e){var r=function(t){var e={},r=0,n=function(o){var i=r;t.getChildren(o).forEach((function(t){return n(t.id)})),e[o]={low:i,lim:r++}};return t.getRoots().forEach((function(t){return n(t.id)})),e}(t);e.forEach((function(e){var n,o,i=e,a=t.getNode(i),s=a.data.originalEdge;if(s)for(var u=function(t,e,r,n){var o,i,a,s,u=[],h=[],d=Math.min(e[r].low,e[n].low),l=Math.max(e[r].lim,e[n].lim);a=r;do{a=null===(o=t.getParent(a))||void 0===o?void 0:o.id,u.push(a)}while(a&&(e[a].low>d||l>e[a].lim));for(s=a,a=n;a&&a!==s;)h.push(a),a=null===(i=t.getParent(a))||void 0===i?void 0:i.id;return{lca:s,path:u.concat(h.reverse())}}(t,r,s.source,s.target),h=u.path,d=u.lca,l=0,c=h[l],f=!0;i!==s.target;){if(a=t.getNode(i),f){for(;c!==d&&(null===(n=t.getNode(c))||void 0===n?void 0:n.data.maxRank)<a.data.rank;)c=h[++l];c===d&&(f=!1)}if(!f){for(;l<h.length-1&&(null===(o=t.getNode(h[l+1]))||void 0===o?void 0:o.data.minRank)<=a.data.rank;)l++;c=h[l]}t.hasNode(c)&&t.setParent(i,c),i=t.getSuccessors(i)[0].id}}))}(t,N),function(t){var e=function(r){var n=t.getChildren(r),o=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach((function(t){return e(t.id)})),o.data.hasOwnProperty("minRank")){o.data.borderLeft=[],o.data.borderRight=[];for(var i=o.data.minRank,a=o.data.maxRank+1;i<a;i+=1)Ne(t,"borderLeft","_bl",r,o,i),Ne(t,"borderRight","_br",r,o,i)}};t.getRoots().forEach((function(t){return e(t.id)}))}(t),d&&function(t,e){for(var r=t.getAllNodes().filter((function(e){var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)})).map((function(t){return t.data.rank})),n=Math.max.apply(Math,u([],s(r))),o=[],i=0;i<n+1;i++)o[i]=[];null==e||e.forEach((function(e){var r=t.getNode(e);r&&!r.data.dummy&&(isNaN(r.data.rank)||(r.data.fixorder=o[r.data.rank].length,o[r.data.rank].push(e)))}))}(t,h),function(t,e){for(var r=Xt(t),n=[],o=[],i=1;i<r+1;i++)n.push(i);for(i=r-1;i>-1;i--)o.push(i);var a=Le(t,n,"in"),s=Le(t,o,"out"),u=Ae(t);Fe(t,u);for(var h,d=Number.POSITIVE_INFINITY,l=(i=0,0);l<4;++i,++l)je(i%2?a:s,i%4>=2,!1,e),u=Yt(t),(c=ze(t,u))<d&&(l=0,h=qe(u),d=c);for(u=Ae(t),Fe(t,u),i=0,l=0;l<4;++i,++l){var c;je(i%2?a:s,i%4>=2,!0,e),u=Yt(t),(c=ze(t,u))<d&&(l=0,h=qe(u),d=c)}Fe(t,h)}(t,d),dr(t),function(t,e){var r=e.toLowerCase();"lr"!==r&&"rl"!==r||be(t)}(t,a),Ke(t,{align:l,nodesep:g,edgesep:v,ranksep:m}),lr(t),ur(t),function(t,e){e.forEach((function(e){var r,n=t.getNode(e),o=n.data.originalEdge;o&&t.addEdge(o);for(var i=e;n.data.dummy;)r=t.getSuccessors(i)[0],t.removeNode(i),o.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===ee&&(o.data.x=n.data.x,o.data.y=n.data.y,o.data.width=n.data.width,o.data.height=n.data.height),i=r.id,n=t.getNode(i)}))}(t,N),ar(t),function(t,e){var r=e.toLowerCase();"bt"!==r&&"rl"!==r||function(t){t.getAllNodes().forEach((function(t){Se(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return Se(t)})),t.data.hasOwnProperty("y")&&Se(t.data)}))}(t),"lr"!==r&&"rl"!==r||(function(t){t.getAllNodes().forEach((function(t){ke(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return ke(t)})),t.data.hasOwnProperty("x")&&ke(t.data)}))}(t),be(t))}(t,a);var b=or(t),M=b.width,S=b.height;return ir(t),sr(t),function(t){t.getAllEdges().forEach((function(e){var r=e.data;if(r.reversed){t.removeEdge(e.id);var o=r.forwardName;delete r.reversed,delete r.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:n(n({},r),{forwardName:o})})}}))}(t),{width:M,height:S}},Je=["width","height","layer","fixorder"],Xe={width:0,height:0},Qe=["minlen","weight","width","height","labeloffset"],Ze={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},tr=["labelpos"],er=function(t){t.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var r=t.getNode(e.source),n={e,rank:(t.getNode(e.target).data.rank-r.data.rank)/2+r.data.rank};Ut(t,"edge-proxy",n,"_ep")}}))},rr=function(t){var e=0;return t.getAllNodes().forEach((function(r){var n,o;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(o=t.getNode(r.data.borderBottom))||void 0===o?void 0:o.data.rank,e=Math.max(e,r.data.maxRank||-1/0))})),e},nr=function(t){t.getAllNodes().forEach((function(e){"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},or=function(t,e){var r,n,o=0,i=0,a=e||{},s=a.marginx,u=void 0===s?0:s,h=a.marginy,d=void 0===h?0:h,l=function(t){if(t.data){var e=t.data.x,a=t.data.y,s=t.data.width,u=t.data.height;isNaN(e)||isNaN(s)||(void 0===r&&(r=e-s/2),r=Math.min(r,e-s/2),o=Math.max(o,e+s/2)),isNaN(a)||isNaN(u)||(void 0===n&&(n=a-u/2),n=Math.min(n,a-u/2),i=Math.max(i,a+u/2))}};return t.getAllNodes().forEach((function(t){l(t)})),t.getAllEdges().forEach((function(t){(null==t?void 0:t.data.hasOwnProperty("x"))&&l(t)})),r-=u,n-=d,t.getAllNodes().forEach((function(t){t.data.x-=r,t.data.y-=n})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){t.x-=r,t.y-=n})),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)})),{width:o-r+u,height:i-n+d}},ir=function(t){t.getAllEdges().forEach((function(e){var r,n,o=t.getNode(e.source),i=t.getNode(e.target);e.data.points?(r=e.data.points[0],n=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:i.data.x,y:i.data.y},n={x:o.data.x,y:o.data.y}),e.data.points.unshift(Kt(o.data,r)),e.data.points.push(Kt(i.data,n))}))},ar=function(t){t.getAllEdges().forEach((function(t){if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},sr=function(t){t.getAllEdges().forEach((function(t){var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},ur=function(t){t.getAllNodes().forEach((function(e){var r,n,o;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){var i=t.getNode(e.id),a=t.getNode(i.data.borderTop),s=t.getNode(i.data.borderBottom),u=t.getNode(i.data.borderLeft[(null===(n=i.data.borderLeft)||void 0===n?void 0:n.length)-1]),h=t.getNode(i.data.borderRight[(null===(o=i.data.borderRight)||void 0===o?void 0:o.length)-1]);i.data.width=Math.abs((null==h?void 0:h.data.x)-(null==u?void 0:u.data.x))||10,i.data.height=Math.abs((null==s?void 0:s.data.y)-(null==a?void 0:a.data.y))||10,i.data.x=((null==u?void 0:u.data.x)||0)+i.data.width/2,i.data.y=((null==a?void 0:a.data.y)||0)+i.data.height/2}})),t.getAllNodes().forEach((function(e){"border"===e.data.dummy&&t.removeNode(e.id)}))},hr=function(t){t.getAllEdges().forEach((function(e){if(e.source===e.target){var r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}}))},dr=function(t){var e=Yt(t);null==e||e.forEach((function(e){var r=0;null==e||e.forEach((function(e,n){var o,i=t.getNode(e);i.data.order=n+r,null===(o=i.data.selfEdges)||void 0===o||o.forEach((function(e){Ut(t,"selfedge",{width:e.data.width,height:e.data.height,rank:i.data.rank,order:n+ ++r,e},"_se")})),delete i.data.selfEdges}))}))},lr=function(t){t.getAllNodes().forEach((function(e){var r=t.getNode(e.id);if("selfedge"===r.data.dummy){var n=t.getNode(r.data.e.source),o=n.data.x+n.data.width/2,i=n.data.y,a=r.data.x-o,s=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}}))},cr=function(t,e){var r={};return null==e||e.forEach((function(e){void 0!==t[e]&&(r[e]=+t[e])})),r},fr=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(r){e[r.toLowerCase()]=t[r]})),e},gr={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="dagre",this.layoutNode=function(t){return t.data.layout},this.options=n(n({},gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericDagreLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericDagreLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericDagreLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,E,b,M,k,_,z,R,I,D,O,P,T,C,q,L,j,F,V,B,G=this;return a(this,(function(a){return o=n(n({},this.options),r),i=o.nodeSize,s=o.align,u=o.rankdir,h=void 0===u?"TB":u,d=o.ranksep,l=o.nodesep,f=o.ranksepFunc,g=o.nodesepFunc,p=o.edgeLabelSpace,v=o.nodeOrder,y=o.begin,m=o.controlPoints,w=o.radial,E=new c({tree:[]}),b=S(d||50,f),M=S(l||50,g),k=M,_=b,"LR"!==h&&"RL"!==h||(k=b,_=M),z=A(i,void 0),R=e.getAllNodes(),I=e.getAllEdges(),R.filter((function(t){return t.data.layout})).forEach((function(t){var e=z(t),r=_(t),n=e+2*k(t),o=e+2*r,i=t.data.layer;x(i)?E.addNode({id:t.id,data:{width:n,height:o,layer:i}}):E.addNode({id:t.id,data:{width:n,height:o}})})),I.forEach((function(t){G.layoutNode(E.getNode(t.source))&&G.layoutNode(E.getNode(t.target))&&E.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),function(t,e){var r,o,i=e.edgeLabelSpace,a=e.keepNodeOrder,s=e.prevGraph,u=e.rankdir,h=e.ranksep;!a&&s&&(o=s,(r=t).getAllNodes().forEach((function(t){var e=r.getNode(t.id),n=o.getNode(t.id);void 0!==n?(e.data.fixorder=n.data._order,delete n.data._order):delete e.data.fixorder})));var d=function(t){var e=new c({tree:[]});return t.getAllNodes().forEach((function(r){var o=fr(t.getNode(r.id).data),i=n(n({},Xe),o),a=cr(i,Je);e.hasNode(r.id)||e.addNode({id:r.id,data:n({},a)});var s=t.getParent(r.id);null==s||(e.hasNode(s.id)||e.addNode(n({},s)),e.setParent(r.id,s.id))})),t.getAllEdges().forEach((function(r){var n=fr(t.getEdge(r.id).data),o={};null==tr||tr.forEach((function(t){void 0!==n[t]&&(o[t]=n[t])})),e.addEdge({id:r.id,source:r.source,target:r.target,data:Object.assign({},Ze,cr(n,Qe),o)})})),e}(t);i&&(e.ranksep=function(t,e){var r=e.ranksep,n=void 0===r?0:r,o=e.rankdir;return t.getAllNodes().forEach((function(t){isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((function(t){var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===o||"BT"===o?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2}(d,{rankdir:u,ranksep:h}));try{Ye(d,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph\'s structure:\\n",t);throw t}!function(t,e){t.getAllNodes().forEach((function(r){var n,o=t.getNode(r.id);if(o){var i=e.getNode(r.id);o.data.x=i.data.x,o.data.y=i.data.y,o.data._order=i.data.order,o.data._rank=i.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(o.data.width=i.data.width,o.data.height=i.data.height)}})),t.getAllEdges().forEach((function(r){var n=t.getEdge(r.id),o=e.getEdge(r.id);n.data.points=o?o.data.points:[],o&&o.data.hasOwnProperty("x")&&(n.data.x=o.data.x,n.data.y=o.data.y)}))}(t,d)}(E,{prevGraph:null,edgeLabelSpace:p,keepNodeOrder:!!v,nodeOrder:v||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:h,nodesep:l,align:s}),D=[0,0],y&&(O=1/0,P=1/0,E.getAllNodes().forEach((function(t){O>t.data.x&&(O=t.data.x),P>t.data.y&&(P=t.data.y)})),E.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){O>t.x&&(O=t.x),P>t.y&&(P=t.y)}))})),D[0]=y[0]-O,D[1]=y[1]-P),T="LR"===h||"RL"===h,w||(C=new Set,q="BT"===h||"RL"===h?function(t,e){return e-t}:function(t,e){return t-e},E.getAllNodes().forEach((function(t){t.data.x=t.data.x+D[0],t.data.y=t.data.y+D[1],C.add(T?t.data.x:t.data.y)})),L=Array.from(C).sort(q),j=T?function(t,e){return t.x!==e.x}:function(t,e){return t.y!==e.y},F=T?function(t,e,r){var n=Math.max(e.y,r.y),o=Math.min(e.y,r.y);return t.filter((function(t){return t.y<=n&&t.y>=o}))}:function(t,e,r){var n=Math.max(e.x,r.x),o=Math.min(e.x,r.x);return t.filter((function(t){return t.x<=n&&t.x>=o}))},E.getAllEdges().forEach((function(t,e){var r;p&&m&&"loop"!==t.data.type&&(t.data.controlPoints=vr(null===(r=t.data.points)||void 0===r?void 0:r.map((function(t){var e=t.x,r=t.y;return{x:e+D[0],y:r+D[1]}})),E.getNode(t.source),E.getNode(t.target),L,T,j,F))}))),V=[],V=E.getAllNodes().map((function(t){return N(t)})),B=E.getAllEdges(),t&&(V.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),B.forEach((function(t){e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),[2,{nodes:V,edges:B}]}))}))},t}(),vr=function(t,e,r,n,o,i,a){var s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){var u=e.data,h=u.x,d=u.y,l=r.data,c=l.x,f=l.y;if(o&&(h=e.data.y,d=e.data.x,c=r.data.y,f=r.data.x),f!==d&&h!==c){var g=n.indexOf(d),p=n[g+1];if(p){var v=s[0],y=o?{x:(d+p)/2,y:(null==v?void 0:v.y)||c}:{x:(null==v?void 0:v.x)||c,y:(d+p)/2};v&&!i(v,y)||s.unshift(y)}var m=n.indexOf(f),w=Math.abs(m-g);if(1===w)(s=a(s,e.data,r.data)).length||s.push(o?{x:(d+f)/2,y:h}:{x:h,y:(d+f)/2});else if(w>1){var x=n[m-1];if(x){var E=s[s.length-1],N=o?{x:(f+x)/2,y:(null==E?void 0:E.y)||c}:{x:(null==E?void 0:E.x)||h,y:(f+x)/2};E&&!i(E,N)||s.push(N)}}}}return s};function yr(t,e,r,n,o){if(isNaN(e)||isNaN(r)||isNaN(n))return t;var i,a,s,u,h,d,l,c,f,g,p,v,y=t._root,m={data:o},w=t._x0,x=t._y0,E=t._z0,N=t._x1,b=t._y1,M=t._z1;if(!y)return t._root=m,t;for(;y.length;)if((c=e>=(a=(w+N)/2))?w=a:N=a,(f=r>=(s=(x+b)/2))?x=s:b=s,(g=n>=(u=(E+M)/2))?E=u:M=u,i=y,!(y=y[p=g<<2|f<<1|c]))return i[p]=m,t;if(h=+t._x.call(null,y.data),d=+t._y.call(null,y.data),l=+t._z.call(null,y.data),e===h&&r===d&&n===l)return m.next=y,i?i[p]=m:t._root=m,t;do{i=i?i[p]=new Array(8):t._root=new Array(8),(c=e>=(a=(w+N)/2))?w=a:N=a,(f=r>=(s=(x+b)/2))?x=s:b=s,(g=n>=(u=(E+M)/2))?E=u:M=u}while((p=g<<2|f<<1|c)==(v=(l>=u)<<2|(d>=s)<<1|h>=a));return i[v]=y,i[p]=m,t}function mr(t,e,r,n,o,i,a){this.node=t,this.x0=e,this.y0=r,this.z0=n,this.x1=o,this.y1=i,this.z1=a}function wr(t){return t[0]}function xr(t){return t[1]}function Er(t){return t[2]}function Nr(t,e,r,n){var o=new br(null==e?wr:e,null==r?xr:r,null==n?Er:n,NaN,NaN,NaN,NaN,NaN,NaN);return null==t?o:o.addAll(t)}function br(t,e,r,n,o,i,a,s,u){this._x=t,this._y=e,this._z=r,this._x0=n,this._y0=o,this._z0=i,this._x1=a,this._y1=s,this._z1=u,this._root=void 0}function Mr(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var Sr=Nr.prototype=br.prototype;function kr(t){var e=0,r=0,n=0,o=0,i=t.length;if(i){for(var a=0;a<i;a++)(s=t[a])&&s.weight&&(e+=s.weight,r+=s.x*s.weight,n+=s.y*s.weight,o+=s.z*s.weight);t.x=r/e,t.y=n/e,t.z=o/e,t.weight=e}else{var s=t;t.x=s.data.x,t.y=s.data.y,t.z=s.data.z,t.weight=s.data.weight}}Sr.copy=function(){var t,e,r=new br(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),n=this._root;if(!n)return r;if(!n.length)return r._root=Mr(n),r;for(t=[{source:n,target:r._root=new Array(8)}];n=t.pop();)for(var o=0;o<8;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(8)}):n.target[o]=Mr(e));return r},Sr.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t),n=+this._z.call(null,t);return yr(this.cover(e,r,n),e,r,n,t)},Sr.addAll=function(t){Array.isArray(t)||(t=Array.from(t));const e=t.length,r=new Float64Array(e),n=new Float64Array(e),o=new Float64Array(e);let i=1/0,a=1/0,s=1/0,u=-1/0,h=-1/0,d=-1/0;for(let l,c,f,g,p=0;p<e;++p)isNaN(c=+this._x.call(null,l=t[p]))||isNaN(f=+this._y.call(null,l))||isNaN(g=+this._z.call(null,l))||(r[p]=c,n[p]=f,o[p]=g,c<i&&(i=c),c>u&&(u=c),f<a&&(a=f),f>h&&(h=f),g<s&&(s=g),g>d&&(d=g));if(i>u||a>h||s>d)return this;this.cover(i,a,s).cover(u,h,d);for(let i=0;i<e;++i)yr(this,r[i],n[i],o[i],t[i]);return this},Sr.cover=function(t,e,r){if(isNaN(t=+t)||isNaN(e=+e)||isNaN(r=+r))return this;var n=this._x0,o=this._y0,i=this._z0,a=this._x1,s=this._y1,u=this._z1;if(isNaN(n))a=(n=Math.floor(t))+1,s=(o=Math.floor(e))+1,u=(i=Math.floor(r))+1;else{for(var h,d,l=a-n||1,c=this._root;n>t||t>=a||o>e||e>=s||i>r||r>=u;)switch(d=(r<i)<<2|(e<o)<<1|t<n,(h=new Array(8))[d]=c,c=h,l*=2,d){case 0:a=n+l,s=o+l,u=i+l;break;case 1:n=a-l,s=o+l,u=i+l;break;case 2:a=n+l,o=s-l,u=i+l;break;case 3:n=a-l,o=s-l,u=i+l;break;case 4:a=n+l,s=o+l,i=u-l;break;case 5:n=a-l,s=o+l,i=u-l;break;case 6:a=n+l,o=s-l,i=u-l;break;case 7:n=a-l,o=s-l,i=u-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=o,this._z0=i,this._x1=a,this._y1=s,this._z1=u,this},Sr.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Sr.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},Sr.find=function(t,e,r,n){var o,i,a,s,u,h,d,l,c,f=this._x0,g=this._y0,p=this._z0,v=this._x1,y=this._y1,m=this._z1,w=[],x=this._root;for(x&&w.push(new mr(x,f,g,p,v,y,m)),null==n?n=1/0:(f=t-n,g=e-n,p=r-n,v=t+n,y=e+n,m=r+n,n*=n);l=w.pop();)if(!(!(x=l.node)||(i=l.x0)>v||(a=l.y0)>y||(s=l.z0)>m||(u=l.x1)<f||(h=l.y1)<g||(d=l.z1)<p))if(x.length){var E=(i+u)/2,N=(a+h)/2,b=(s+d)/2;w.push(new mr(x[7],E,N,b,u,h,d),new mr(x[6],i,N,b,E,h,d),new mr(x[5],E,a,b,u,N,d),new mr(x[4],i,a,b,E,N,d),new mr(x[3],E,N,s,u,h,b),new mr(x[2],i,N,s,E,h,b),new mr(x[1],E,a,s,u,N,b),new mr(x[0],i,a,s,E,N,b)),(c=(r>=b)<<2|(e>=N)<<1|t>=E)&&(l=w[w.length-1],w[w.length-1]=w[w.length-1-c],w[w.length-1-c]=l)}else{var M=t-+this._x.call(null,x.data),S=e-+this._y.call(null,x.data),k=r-+this._z.call(null,x.data),A=M*M+S*S+k*k;if(A<n){var _=Math.sqrt(n=A);f=t-_,g=e-_,p=r-_,v=t+_,y=e+_,m=r+_,o=x.data}}return o},Sr.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t))||isNaN(s=+this._z.call(null,t)))return this;var e,r,n,o,i,a,s,u,h,d,l,c,f,g,p,v=this._root,y=this._x0,m=this._y0,w=this._z0,x=this._x1,E=this._y1,N=this._z1;if(!v)return this;if(v.length)for(;;){if((l=i>=(u=(y+x)/2))?y=u:x=u,(c=a>=(h=(m+E)/2))?m=h:E=h,(f=s>=(d=(w+N)/2))?w=d:N=d,e=v,!(v=v[g=f<<2|c<<1|l]))return this;if(!v.length)break;(e[g+1&7]||e[g+2&7]||e[g+3&7]||e[g+4&7]||e[g+5&7]||e[g+6&7]||e[g+7&7])&&(r=e,p=g)}for(;v.data!==t;)if(n=v,!(v=v.next))return this;return(o=v.next)&&delete v.next,n?(o?n.next=o:delete n.next,this):e?(o?e[g]=o:delete e[g],(v=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&v===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!v.length&&(r?r[p]=v:this._root=v),this):(this._root=o,this)},Sr.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},Sr.root=function(){return this._root},Sr.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Sr.visit=function(t){var e,r,n,o,i,a,s,u,h=[],d=this._root;for(d&&h.push(new mr(d,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=h.pop();)if(!t(d=e.node,n=e.x0,o=e.y0,i=e.z0,a=e.x1,s=e.y1,u=e.z1)&&d.length){var l=(n+a)/2,c=(o+s)/2,f=(i+u)/2;(r=d[7])&&h.push(new mr(r,l,c,f,a,s,u)),(r=d[6])&&h.push(new mr(r,n,c,f,l,s,u)),(r=d[5])&&h.push(new mr(r,l,o,f,a,c,u)),(r=d[4])&&h.push(new mr(r,n,o,f,l,c,u)),(r=d[3])&&h.push(new mr(r,l,c,i,a,s,f)),(r=d[2])&&h.push(new mr(r,n,c,i,l,s,f)),(r=d[1])&&h.push(new mr(r,l,o,i,a,c,f)),(r=d[0])&&h.push(new mr(r,n,o,i,l,c,f))}return this},Sr.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new mr(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.z0,h=e.x1,d=e.y1,l=e.z1,c=(a+h)/2,f=(s+d)/2,g=(u+l)/2;(i=o[0])&&r.push(new mr(i,a,s,u,c,f,g)),(i=o[1])&&r.push(new mr(i,c,s,u,h,f,g)),(i=o[2])&&r.push(new mr(i,a,f,u,c,d,g)),(i=o[3])&&r.push(new mr(i,c,f,u,h,d,g)),(i=o[4])&&r.push(new mr(i,a,s,g,c,f,l)),(i=o[5])&&r.push(new mr(i,c,s,g,h,f,l)),(i=o[6])&&r.push(new mr(i,a,f,g,c,d,l)),(i=o[7])&&r.push(new mr(i,c,f,g,h,d,l))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.z0,e.x1,e.y1,e.z1);return this},Sr.x=function(t){return arguments.length?(this._x=t,this):this._x},Sr.y=function(t){return arguments.length?(this._y=t,this):this._y},Sr.z=function(t){return arguments.length?(this._z=t,this):this._z};var Ar=function(t,e,r,n,o,i,a){var s=[r,n,o][a-1],u=i.x-t.x||.1,h=i.y-t.y||.1,d=i.z-t.z||.1,l=s-e,c=u*u+h*h+d*d,f=Math.sqrt(c)*c;if(l*l*.81<c){var g=t.weight/f;return i.vx+=u*g,i.vy+=h*g,i.vz+=d*g,!0}if(t.length)return!1;t.data!==i&&(g=t.data.weight/f,i.vx+=u*g,i.vy+=h*g,i.vz+=d*g)},_r={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},zr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=n(n({},_r),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===e.options.dimensions?t.data.z:void 0})})),n},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,E,N,b,M,S,k,A=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=this.formatOptions(o,e),h=u.dimensions,d=u.width,l=u.height,f=u.nodeSize,g=u.getMass,p=u.nodeStrength,v=u.edgeStrength,y=u.linkDistance,m=i.map((function(t,e){return n(n({},t),{data:n(n({},t.data),{x:x(t.data.x)?t.data.x:Math.random()*d,y:x(t.data.y)?t.data.y:Math.random()*l,z:x(t.data.z)?t.data.z:Math.random()*Math.sqrt(d*l),size:f(t)||30,mass:g(t),nodeStrength:p(t)})})})),w=s.map((function(t){return n(n({},t),{data:n(n({},t.data),{edgeStrength:v(t),linkDistance:y(t,e.getNode(t.source),e.getNode(t.target))})})})),(null==i?void 0:i.length)?(E={},i.forEach((function(t,e){E[t.id]={x:0,y:0,z:0}})),N=new c({nodes:m,edges:w}),this.formatCentripetal(u,N),b=u.maxIteration,M=u.minMovement,S=u.onTick,this.lastLayoutNodes=m,this.lastLayoutEdges=w,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=N,this.lastOptions=u,this.lastVelMap=E,"undefined"==typeof window?[2]:(k=0,[2,new Promise((function(r){A.timeInterval=window.setInterval((function(){i&&A.running||r({nodes:Pr(e,m),edges:s}),A.runOneStep(N,e,k,E,u),A.updatePosition(e,N,E,u),t&&m.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===h?t.data.z:void 0})})),null==S||S({nodes:Pr(e,m),edges:s}),(++k>=b||A.judgingDistance<M)&&(window.clearInterval(A.timeInterval),r({nodes:Pr(e,m),edges:s}))}),0),A.running=!0}))])):(this.lastResult={nodes:[],edges:s},[2,{nodes:[],edges:s}])}))}))},t.prototype.formatOptions=function(t,e){var r=t,n=t.width,o=t.height,i=t.getMass;if(r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=o||"undefined"==typeof window?o:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),i||(r.getMass=function(t){var r=1;x(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);var n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),t.preventOverlap){var a=S(0,t.nodeSpacing);t.nodeSize?g(t.nodeSize)?r.nodeSize=function(e){var r=t.nodeSize;return Math.max(r[0],r[1])+a(e)}:r.nodeSize=function(e){return t.nodeSize+a(e)}:r.nodeSize=function(t){var e=((null==t?void 0:t.data)||{}).size;return e?g(e)?Math.max(e[0],e[1])+a(t):M(e)?Math.max(e.width,e.height)+a(t):e+a(t):10+a(t)}}return r.linkDistance=t.linkDistance?S(1,t.linkDistance):function(t){return 1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target))},r.nodeStrength=S(1,t.nodeStrength),r.edgeStrength=S(1,t.edgeStrength),t},t.prototype.formatCentripetal=function(t,e){var r,n=t.centripetalOptions,o=t.center,i=t.clusterNodeStrength,a=t.leafCluster,s=t.clustering,u=t.nodeClusterBy,h=e.getAllNodes(),d=n||{leaf:2,single:2,others:1,center:function(t){return{x:o[0],y:o[1]}}};"function"!=typeof i&&(t.clusterNodeStrength=function(t){return i});var l=[];if(a&&u&&(r=Rr(e,u),l=Array.from(new Set(null==h?void 0:h.map((function(t){return t.data[u]}))))||[],t.centripetalOptions=Object.assign(d,{single:100,leaf:function(e){var n=r[e.id]||{},o=n.siblingLeaves,i=n.sameTypeLeaves;return(null==i?void 0:i.length)===(null==o?void 0:o.length)||1===(null==l?void 0:l.length)?1:t.clusterNodeStrength(e)},others:1,center:function(t){var n,o=e.getDegree(t.id,"both");if(!o)return{x:100,y:100};if(1===o){var i=(r[t.id]||{}).sameTypeLeaves,a=void 0===i?[]:i;1===a.length?n=void 0:a.length>1&&(n=Or(a))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y}}})),s&&u){r||(r=Rr(e,u)),l||(l=Array.from(new Set(h.map((function(t){return t.data[u]}))))),l=l.filter((function(t){return void 0!==t}));var c={};l.forEach((function(t){var r=h.filter((function(e){return e.data[u]===t})).map((function(t){return e.getNode(t.id)}));c[t]=Or(r)})),t.centripetalOptions=Object.assign(d,{single:function(e){return t.clusterNodeStrength(e)},leaf:function(e){return t.clusterNodeStrength(e)},others:function(e){return t.clusterNodeStrength(e)},center:function(t){var e=c[t.data[u]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y}}})}var f=t.centripetalOptions||{},g=f.leaf,p=f.single,v=f.others;g&&"function"!=typeof g&&(t.centripetalOptions.leaf=function(){return g}),p&&"function"!=typeof p&&(t.centripetalOptions.single=function(){return p}),v&&"function"!=typeof v&&(t.centripetalOptions.others=function(){return v})},t.prototype.runOneStep=function(t,e,r,n,o){var i={},a=t.getAllNodes(),s=t.getAllEdges();if(null==a?void 0:a.length){var u=o.monitor;this.calRepulsive(t,i,o),s&&this.calAttractive(t,i,o),this.calGravity(t,e,i,o),this.updateVelocity(t,i,n,o),u&&u({energy:this.calTotalEnergy(i,a),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}},t.prototype.calTotalEnergy=function(t,e){var r=this;if(!(null==e?void 0:e.length))return 0;var n=0;return e.forEach((function(e,o){var i=t[e.id].x,a=t[e.id].y,s=3===r.options.dimensions?t[e.id].z:0,u=i*i+a*a+s*s,h=e.data.mass;n+=(void 0===h?1:h)*u*.5})),n},t.prototype.calRepulsive=function(t,e,r){var n=r.dimensions,o=r.factor,i=r.coulombDisScale;!function(t,e,r,n,o){var i=e/r,a=t.getAllNodes(),s=a.map((function(t,e){var r=t.data,n=r.nodeStrength;return{x:r.x,y:r.y,z:r.z,size:r.size,index:e,vx:0,vy:0,vz:0,weight:i*n}})),u=(2===o?F(s,(function(t){return t.x}),(function(t){return t.y})):Nr(s,(function(t){return t.x}),(function(t){return t.y}),(function(t){return t.z}))).visitAfter(kr);s.forEach((function(t){!function(t,e,r){e.visit((function(e,n,o,i,a){return Ar(e,n,o,i,a,t,r)}))}(t,u,o)})),s.map((function(t,e){var r=a[e],o=r.id,i=r.data.mass,s=void 0===i?1:i;n[o]={x:t.vx/s,y:t.vy/s,z:t.vz/s}}))}(t,o,i*i,e,n)},t.prototype.calAttractive=function(t,e,r){var n=r.dimensions;t.getAllEdges().forEach((function(r,o){var i=r.source,a=r.target,s=t.getNode(i),u=t.getNode(a);if(s&&u){var h=u.data.x-s.data.x,d=u.data.y-s.data.y,l=3===n?u.data.z-s.data.z:0;h||d||(h=.01*Math.random(),d=.01*Math.random(),3!==n||l||(l=.01*Math.random()));var c=Math.sqrt(h*h+d*d+l*l),f=h/c,g=d/c,p=l/c,v=r.data||{},y=v.linkDistance,m=void 0===y?200:y,w=v.edgeStrength,x=(m-c)*(void 0===w?200:w),E=1/(s.data.mass||1),N=1/(u.data.mass||1),b=f*x,M=g*x,S=p*x;e[i].x-=b*E,e[i].y-=M*E,e[i].z-=S*E,e[a].x+=b*N,e[a].y+=M*N,e[a].z+=S*N}}))},t.prototype.calGravity=function(t,e,r,n){var o=n.getCenter,i=t.getAllNodes(),a=e.getAllNodes(),u=e.getAllEdges(),h=n.width,d=n.height,l=n.center,c=n.gravity,f=n.centripetalOptions;i&&i.forEach((function(n){var i=n.id,g=n.data,p=g.mass,v=g.x,y=g.y,m=g.z,w=e.getNode(i),E=0,N=0,b=0,M=c,S=t.getDegree(i,"in"),k=t.getDegree(i,"out"),A=t.getDegree(i,"both"),_=null==o?void 0:o(w,A);if(_){var z=s(_,3);E=v-z[0],N=y-z[1],M=z[2]}else E=v-l[0],N=y-l[1],b=m-l[2];if(M&&(r[i].x-=M*E/p,r[i].y-=M*N/p,r[i].z-=M*b/p),f){var R=f.leaf,I=f.single,D=f.others,O=f.center,P=(null==O?void 0:O(w,a,u,h,d))||{x:0,y:0,z:0,centerStrength:0},T=P.x,C=P.y,q=P.z,L=P.centerStrength;if(!x(T)||!x(C))return;var j=(v-T)/p,F=(y-C)/p,V=(m-q)/p;if(L&&(r[i].x-=L*j,r[i].y-=L*F,r[i].z-=L*V),0===A){var B=I(w);if(!B)return;return r[i].x-=B*j,r[i].y-=B*F,void(r[i].z-=B*V)}if(0===S||0===k){var G=R(w,a,u);if(!G)return;return r[i].x-=G*j,r[i].y-=G*F,void(r[i].z-=G*V)}var W=D(w);if(!W)return;r[i].x-=W*j,r[i].y-=W*F,r[i].z-=W*V}}))},t.prototype.updateVelocity=function(t,e,r,n){var o=n.damping,i=n.maxSpeed,a=n.interval,s=n.dimensions,u=t.getAllNodes();(null==u?void 0:u.length)&&u.forEach((function(t){var n=t.id,u=(r[n].x+e[n].x*a)*o||.01,h=(r[n].y+e[n].y*a)*o||.01,d=3===s?(r[n].z+e[n].z*a)*o||.01:0,l=Math.sqrt(u*u+h*h+d*d);if(l>i){var c=i/l;u*=c,h*=c,d*=c}r[n]={x:u,y:h,z:d}}))},t.prototype.updatePosition=function(t,e,r,n){var o=this,i=n.distanceThresholdMode,a=n.interval,s=n.dimensions,u=e.getAllNodes();if(null==u?void 0:u.length){var h=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),u.forEach((function(n){var u=n.id,d=t.getNode(u);if(x(d.data.fx)&&x(d.data.fy))e.mergeNodeData(u,{x:d.data.fx,y:d.data.fy,z:3===s?d.data.fz:void 0});else{var l=r[u].x*a,c=r[u].y*a,f=3===s?r[u].z*a:0;e.mergeNodeData(u,{x:n.data.x+l,y:n.data.y+c,z:n.data.z+f});var g=Math.sqrt(l*l+c*c+f*f);switch(i){case"max":o.judgingDistance<g&&(o.judgingDistance=g);break;case"min":o.judgingDistance>g&&(o.judgingDistance=g);break;default:h+=g}}})),i&&"mean"!==i||(this.judgingDistance=h/u.length)}else this.judgingDistance=0},t}(),Rr=function(t,e){var r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};var n={};return r.forEach((function(r,o){1===t.getDegree(r.id,"both")&&(n[r.id]=Ir(t,"leaf",r,e))})),n},Ir=function(t,e,r,n){var o=t.getDegree(r.id,"in"),i=t.getDegree(r.id,"out"),a=r,s=[];return 0===o?(a=t.getSuccessors(r.id)[0],s=t.getNeighbors(a.id)):0===i&&(a=t.getPredecessors(r.id)[0],s=t.getNeighbors(a.id)),s=s.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")})),{coreNode:a,siblingLeaves:s,sameTypeLeaves:Dr(t,e,n,r,s)}},Dr=function(t,e,r,n,o){var i=n.data[r]||"",a=(null==o?void 0:o.filter((function(t){return t.data[r]===i})))||[];return"leaf"===e&&(a=a.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")}))),a},Or=function(t){var e={x:0,y:0};t.forEach((function(t){var r=t.data,n=r.x,o=r.y;e.x+=n||0,e.y+=o||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},Pr=function(t,e){return e.map((function(e){var r=e.id,o=e.data,i=t.getNode(r);return n(n({},i),{data:n(n({},i.data),{x:o.x,y:o.y,z:o.z})})}))},Tr=function(){function t(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}return t.prototype.distanceTo=function(t){var e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)},t.prototype.setPos=function(t,e){this.rx=t,this.ry=e},t.prototype.resetForce=function(){this.fx=0,this.fy=0},t.prototype.addForce=function(t){var e=t.rx-this.rx,r=t.ry-this.ry,n=Math.hypot(e,r);n=n<1e-4?1e-4:n;var o=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=o*e/n,this.fy+=o*r/n},t.prototype.in=function(t){return t.contains(this.rx,this.ry)},t.prototype.add=function(e){var r=this.mass+e.mass;return new t({rx:(this.rx*this.mass+e.rx*e.mass)/r,ry:(this.ry*this.mass+e.ry*e.mass)/r,mass:r,degree:this.degree+e.degree})},t}();const Cr=Tr;const qr=function(){function t(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}return t.prototype.getLength=function(){return this.length},t.prototype.contains=function(t,e){var r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r},t.prototype.NW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.NE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.SW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t.prototype.SE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t}(),Lr=function(){function t(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}return t.prototype.insert=function(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e},t.prototype._putBody=function(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))},t.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},t.prototype.updateForce=function(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))},t}();var jr={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Fr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2",this.options=n(n({},jr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,x,E,b,M,S,k,A,z;return a(this,(function(a){if(o=e.getAllEdges(),i=e.getAllNodes(),s=this.formatOptions(r,i.length),u=s.width,h=s.height,d=s.prune,l=s.maxIteration,f=s.nodeSize,g=s.center,!(null==i?void 0:i.length)||1===i.length)return[2,_(e,t,g)];if(p=i.map((function(t){return N(t,[u,h])})),v=o.filter((function(t){return t.source!==t.target})),y=new c({nodes:p,edges:v}),m=this.getSizes(y,e,f),this.run(y,e,l,m,t,s),d){for(w=0;w<v.length;w+=1)x=v[w],E=x.source,b=x.target,M=y.getDegree(E),S=y.getDegree(E),M<=1?(k=y.getNode(b),y.mergeNodeData(E,{x:k.data.x,y:k.data.y})):S<=1&&(A=y.getNode(E),y.mergeNodeData(b,{x:A.data.x,y:A.data.y}));z=n(n({},s),{prune:!1,barnesHut:!1}),this.run(y,e,100,m,t,z)}return[2,{nodes:p,edges:o}]}))}))},t.prototype.getSizes=function(t,e,r){for(var n=t.getAllNodes(),o={},i=0;i<n.length;i+=1){var a=n[i],h=a.id,d=a.data;if(o[h]=10,x(d.size))o[h]=d.size;else if(g(d.size))isNaN(d.size[0])||(o[h]=Math.max(d.size[0])),isNaN(d.size[1])||(o[h]=Math.max(d.size[1]));else if(M(d.size))o[h]=Math.max(d.size.width,d.size.height);else if(b(r)){var l=r(e.getNode(h));g(l)?o[h]=Math.max.apply(Math,u([],s(l))):o[h]=l}else g(r)?o[h]=Math.max.apply(Math,u([],s(r))):x(r)&&(o[h]=r)}return o},t.prototype.formatOptions=function(t,e){void 0===t&&(t={});var r=n(n({},this.options),t),o=r.center,i=r.width,a=r.height,s=r.barnesHut,u=r.prune,h=r.maxIteration,d=r.kr,l=r.kg;return r.width=i||"undefined"==typeof window?i:window.innerWidth,r.height=a||"undefined"==typeof window?a:window.innerHeight,r.center=o||[r.width/2,r.height/2],void 0===s&&e>250&&(r.barnesHut=!0),void 0===u&&e>100&&(r.prune=!0),0!==h||u?0===h&&u&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)):(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)),d||(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),l||(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r},t.prototype.run=function(t,e,r,n,o,i){for(var a=i.kr,s=i.barnesHut,u=i.onTick,h=t.getAllNodes(),d=0,l=r,c={},f={},g={},p=0;p<h.length;p+=1){var v=h[p],y=v.data,m=v.id;if(c[m]=[0,0],s){var w={id:p,rx:y.x,ry:y.y,mass:1,g:a,degree:t.getDegree(m)};g[m]=new Cr(w)}}for(;l>0;)d=this.oneStep(t,{iter:l,preventOverlapIters:50,krPrime:100,sg:d,forces:c,preForces:f,bodies:g,sizes:n},i),l--,null==u||u({nodes:h,edges:e.getAllEdges()});return t},t.prototype.oneStep=function(t,e,r){for(var n=e.iter,o=e.preventOverlapIters,i=e.krPrime,a=e.sg,h=e.preForces,d=e.bodies,l=e.sizes,c=e.forces,f=r.preventOverlap,g=r.barnesHut,p=t.getAllNodes(),v=0;v<p.length;v+=1){var y=p[v].id;h[y]=u([],s(c[y])),c[y]=[0,0]}return c=this.getAttrForces(t,n,o,l,c,r),c=g&&(f&&n>o||!f)?this.getOptRepGraForces(t,c,d,r):this.getRepGraForces(t,n,o,c,i,l,r),this.updatePos(t,c,h,a,r)},t.prototype.getAttrForces=function(t,e,r,n,o,i){for(var a=i.preventOverlap,s=i.dissuadeHubs,u=i.mode,h=i.prune,d=t.getAllEdges(),l=0;l<d.length;l+=1){var c=d[l],f=c.source,g=c.target,p=t.getNode(f),v=t.getNode(g),y=t.getDegree(f),m=t.getDegree(g);if(!h||!(y<=1||m<=1)){var w=[v.data.x-p.data.x,v.data.y-p.data.y],x=Math.hypot(w[0],w[1]);x=x<1e-4?1e-4:x,w[0]=w[0]/x,w[1]=w[1]/x,a&&e<r&&(x=x-n[f]-n[g]);var E=x,N=E;"linlog"===u&&(N=E=Math.log(1+x)),s&&(E=x/y,N=x/m),a&&e<r&&x<=0?(E=0,N=0):a&&e<r&&x>0&&(E=x,N=x),o[f][0]+=E*w[0],o[g][0]-=N*w[0],o[f][1]+=E*w[1],o[g][1]-=N*w[1]}}return o},t.prototype.getOptRepGraForces=function(t,e,r,n){for(var o=n.kg,i=n.center,a=n.prune,s=t.getAllNodes(),u=s.length,h=9e10,d=-9e10,l=9e10,c=-9e10,f=0;f<u;f+=1){var g=s[f],p=g.id,v=g.data;a&&t.getDegree(p)<=1||(r[p].setPos(v.x,v.y),v.x>=d&&(d=v.x),v.x<=h&&(h=v.x),v.y>=c&&(c=v.y),v.y<=l&&(l=v.y))}var y=Math.max(d-h,c-l),m=new qr({xmid:(d+h)/2,ymid:(c+l)/2,length:y,massCenter:i,mass:u}),w=new Lr(m);for(f=0;f<u;f+=1)p=s[f].id,a&&t.getDegree(p)<=1||r[p].in(m)&&w.insert(r[p]);for(f=0;f<u;f+=1){var x=s[f],E=(p=x.id,v=x.data,t.getDegree(p));if(!(a&&E<=1)){r[p].resetForce(),w.updateForce(r[p]),e[p][0]-=r[p].fx,e[p][1]-=r[p].fy;var N=[v.x-i[0],v.y-i[1]],b=Math.hypot(N[0],N[1]);b=b<1e-4?1e-4:b,N[0]=N[0]/b,N[1]=N[1]/b;var M=o*(E+1);e[p][0]-=M*N[0],e[p][1]-=M*N[1]}}return e},t.prototype.getRepGraForces=function(t,e,r,n,o,i,a){for(var s=a.preventOverlap,u=a.kr,h=a.kg,d=a.center,l=a.prune,c=t.getAllNodes(),f=c.length,g=0;g<f;g+=1){for(var p=c[g],v=t.getDegree(p.id),y=g+1;y<f;y+=1){var m=c[y],w=t.getDegree(m.id);if(!l||!(v<=1||w<=1)){var x=[m.data.x-p.data.x,m.data.y-p.data.y],E=Math.hypot(x[0],x[1]);E=E<1e-4?1e-4:E,x[0]=x[0]/E,x[1]=x[1]/E,s&&e<r&&(E=E-i[p.id]-i[m.id]);var N=u*(v+1)*(w+1)/E;s&&e<r&&E<0?N=o*(v+1)*(w+1):s&&e<r&&0===E?N=0:s&&e<r&&E>0&&(N=u*(v+1)*(w+1)/E),n[p.id][0]-=N*x[0],n[m.id][0]+=N*x[0],n[p.id][1]-=N*x[1],n[m.id][1]+=N*x[1]}}var b=[p.data.x-d[0],p.data.y-d[1]],M=Math.hypot(b[0],b[1]);b[0]=b[0]/M,b[1]=b[1]/M;var S=h*(v+1);n[p.id][0]-=S*b[0],n[p.id][1]-=S*b[1]}return n},t.prototype.updatePos=function(t,e,r,n,o){for(var i=o.ks,a=o.tao,s=o.prune,u=o.ksmax,h=t.getAllNodes(),d=h.length,l=[],c=[],f=0,g=0,p=n,v=0;v<d;v+=1){var y=h[v].id,m=t.getDegree(y);if(!(s&&m<=1)){var w=[e[y][0]-r[y][0],e[y][1]-r[y][1]],E=Math.hypot(w[0],w[1]),N=[e[y][0]+r[y][0],e[y][1]+r[y][1]],b=Math.hypot(N[0],N[1]);l[v]=E,c[v]=b/2,f+=(m+1)*l[v],g+=(m+1)*c[v]}}var M=p;for(p=a*g/f,0!==M&&(p=p>1.5*M?1.5*M:p),v=0;v<d;v+=1){var S=h[v],k=(y=S.id,S.data);if(m=t.getDegree(y),!(s&&m<=1||x(k.fx)&&x(k.fy))){var A=i*p/(1+p*Math.sqrt(l[v])),_=Math.hypot(e[y][0],e[y][1]),z=u/(_=_<1e-4?1e-4:_),R=(A=A>z?z:A)*e[y][0],I=A*e[y][1];t.mergeNodeData(y,{x:k.x+R,y:k.y+I})}}return p},t}(),Vr={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Br=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=n(n({},Vr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===e.options.dimensions?t.data.z:void 0})})),n},t.prototype.genericFruchtermanLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,x,E,b=this;return a(this,(function(a){return this.running?[2]:(o=this.formatOptions(r),i=o.dimensions,s=o.width,u=o.height,h=o.center,d=o.clustering,l=o.nodeClusterBy,f=o.maxIteration,g=o.onTick,p=e.getAllNodes(),v=e.getAllEdges(),(null==p?void 0:p.length)?1===p.length?(t&&e.mergeNodeData(p[0].id,{x:h[0],y:h[1],z:3===i?h[2]:void 0}),y={nodes:[n(n({},p[0]),{data:n(n({},p[0].data),{x:h[0],y:h[1],z:3===i?h[2]:void 0})})],edges:v},this.lastResult=y,[2,y]):(m=p.map((function(t){return N(t,[s,u])})),w=new c({nodes:m,edges:v}),x={},d&&m.forEach((function(t){var e=t.data[l];x[e]||(x[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=m,this.lastLayoutEdges=v,this.lastAssign=t,this.lastGraph=w,this.lastOptions=o,this.lastClusterMap=x,"undefined"==typeof window?[2]:(E=0,[2,new Promise((function(r){b.timeInterval=window.setInterval((function(){b.running?(b.runOneStep(w,x,o),t&&m.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y,z:3===i?n.z:void 0})})),null==g||g({nodes:m,edges:v}),++E>=f&&(window.clearInterval(b.timeInterval),r({nodes:m,edges:v}))):r({nodes:m,edges:v})}),0),b.running=!0}))])):(y={nodes:[],edges:v},this.lastResult=y,[2,y]))}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=n(n({},this.options),t),r=e.clustering,o=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=r&&!!o,e},t.prototype.runOneStep=function(t,e,r){var n=r.dimensions,o=r.height,i=r.width,a=r.gravity,s=r.center,u=r.speed,h=r.clustering,d=r.nodeClusterBy,l=r.clusterGravity,c=o*i,f=Math.sqrt(c)/10,g=t.getAllNodes(),p=c/(g.length+1),v=Math.sqrt(p),y={};if(this.applyCalculate(t,y,v,p),h){for(var m in e)e[m].cx=0,e[m].cy=0,e[m].count=0;for(var m in g.forEach((function(t){var r=t.data,n=e[r[d]];x(r.x)&&(n.cx+=r.x),x(r.y)&&(n.cy+=r.y),n.count++})),e)e[m].cx/=e[m].count,e[m].cy/=e[m].count;var w=l||a;g.forEach((function(t,r){var n=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=e[o[d]],a=Math.sqrt((o.x-i.cx)*(o.x-i.cx)+(o.y-i.cy)*(o.y-i.cy)),s=v*w;y[n].x-=s*(o.x-i.cx)/a,y[n].y-=s*(o.y-i.cy)/a}}))}g.forEach((function(t,e){var r=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=.01*v*a;y[r].x-=i*(o.x-s[0]),y[r].y-=i*(o.y-s[1]),3===n&&(y[r].z-=i*(o.z-s[2]))}})),g.forEach((function(e,r){var o=e.id,i=e.data;if(x(i.fx)&&x(i.fy))return i.x=i.fx,i.y=i.fy,void(3===n&&(i.z=i.fz));if(x(i.x)&&x(i.y)){var a=Math.sqrt(y[o].x*y[o].x+y[o].y*y[o].y+(3===n?y[o].z*y[o].z:0));if(a>0){var s=Math.min(f*(u/800),a);t.mergeNodeData(o,{x:i.x+y[o].x/a*s,y:i.y+y[o].y/a*s,z:3===n?i.z+y[o].z/a*s:void 0})}}}))},t.prototype.applyCalculate=function(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)},t.prototype.calRepulsive=function(t,e,r){var n=this,o=t.getAllNodes();o.forEach((function(t,i){var a=t.data,s=t.id;e[s]={x:0,y:0,z:0},o.forEach((function(t,o){var u=t.data,h=t.id;if(!(i<=o)&&x(a.x)&&x(u.x)&&x(a.y)&&x(u.y)){var d=a.x-u.x,l=a.y-u.y,c=3===n.options.dimensions?a.z-u.z:0,f=d*d+l*l+c*c;0===f&&(f=1,d=.01,l=.01,c=.01);var g=r/f,p=d*g,v=l*g,y=c*g;e[s].x+=p,e[s].y+=v,e[h].x-=p,e[h].y-=v,3===n.options.dimensions&&(e[s].z+=y,e[h].z-=y)}}))}))},t.prototype.calAttractive=function(t,e,r){var n=this;t.getAllEdges().forEach((function(o){var i=o.source,a=o.target;if(i&&a&&i!==a){var s=t.getNode(i).data,u=t.getNode(a).data;if(x(u.x)&&x(s.x)&&x(u.y)&&x(s.y)){var h=u.x-s.x,d=u.y-s.y,l=3===n.options.dimensions?u.z-s.z:0,c=Math.sqrt(h*h+d*d+l*l)/r,f=h*c,g=d*c,p=l*c;e[i].x+=f,e[i].y+=g,e[a].x-=f,e[a].y-=g,3===n.options.dimensions&&(e[i].z+=p,e[a].z-=p)}}}))},t}(),Gr={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},Wr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="grid",this.options=n(n({},Gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericGridLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericGridLayout(!0,t,e),[2]}))}))},t.prototype.genericGridLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,p,v,y,m,w,E,b,M,A,z,R,I,D,P,T,C,q,L,j,F,V,B,G,W,$,U,H,K;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.begin,s=void 0===i?[0,0]:i,u=o.condense,h=o.preventOverlapPadding,d=o.preventOverlap,l=o.rows,c=o.cols,f=o.nodeSpacing,p=o.nodeSize,v=o.width,y=o.height,m=o.position,w=o.sortBy,E=e.getAllNodes(),b=e.getAllEdges(),!(M=null==E?void 0:E.length)||1===M)return[2,_(e,t,s)];if(A=E.map((function(t){return N(t)})),"id"===w||O(w)&&void 0!==A[0].data[w]||(w="degree"),"degree"===w?A.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):"id"===w?A.sort((function(t,e){return x(e.id)&&x(t.id)?e.id-t.id:(""+t.id).localeCompare(""+e.id)})):A.sort((function(t,e){return e.data[w]-t.data[w]})),z=v||"undefined"==typeof window?v:window.innerWidth,R=y||"undefined"==typeof window?y:window.innerHeight,I=M,D={rows:l,cols:c},null!=l&&null!=c?(D.rows=l,D.cols=c):null!=l&&null==c?(D.rows=l,D.cols=Math.ceil(I/D.rows)):null==l&&null!=c?(D.cols=c,D.rows=Math.ceil(I/D.cols)):(P=Math.sqrt(I*R/z),D.rows=Math.round(P),D.cols=Math.round(z/R*P)),D.rows=Math.max(D.rows,1),D.cols=Math.max(D.cols,1),D.cols*D.rows>I)T=$r(D),C=Ur(D),(T-1)*C>=I?$r(D,T-1):(C-1)*T>=I&&Ur(D,C-1);else for(;D.cols*D.rows<I;)T=$r(D),((C=Ur(D))+1)*T>=I?Ur(D,C+1):$r(D,T+1);for(q=u?0:z/D.cols,L=u?0:R/D.rows,(d||f)&&(j=S(10,f),F=k(30,p,!1),A.forEach((function(t){t.data.x&&t.data.y||(t.data.x=0,t.data.y=0);var r,n,o=e.getNode(t.id),i=F(o)||30;g(i)?(r=i[0],n=i[1]):(r=i,n=i);var a=void 0!==j?j(t):h,s=r+a,u=n+a;q=Math.max(q,s),L=Math.max(L,u)}))),V={},B={row:0,col:0},G={},W=0;W<A.length;W++){if($=A[W],U=void 0,m&&(U=m(e.getNode($.id))),U&&(void 0!==U.row||void 0!==U.col)){if(void 0===(H={row:U.row,col:U.col}).col)for(H.col=0;Hr(V,H);)H.col++;else if(void 0===H.row)for(H.row=0;Hr(V,H);)H.row++;G[$.id]=H,Kr(V,H)}Jr($,s,q,L,G,D,B,V)}return K={nodes:A,edges:b},t&&A.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,K]}))}))},t}(),$r=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.min(n,o):Math.min(n,o)===t.rows?t.rows=e:t.cols=e,r},Ur=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.max(n,o):Math.max(n,o)===t.rows?t.rows=e:t.cols=e,r},Hr=function(t,e){return t["c-"+e.row+"-"+e.col]||!1},Kr=function(t,e){return t["c-"+e.row+"-"+e.col]=!0},Yr=function(t,e){var r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},Jr=function(t,e,r,n,o,i,a,s){var u,h,d=o[t.id];if(d)u=d.col*r+r/2+e[0],h=d.row*n+n/2+e[1];else{for(;Hr(s,a);)Yr(i,a);u=a.col*r+r/2+e[0],h=a.row*n+n/2+e[1],Kr(s,a),Yr(i,a)}t.data.x=u,t.data.y=h};const Xr=Object.prototype.toString;function Qr(t){const e=Xr.call(t);return e.endsWith("Array]")&&!e.includes("Big")}function Zr(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!Qr(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]<a&&(a=t[s]);return a}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]>a&&(a=t[s]);return a}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,a=void 0===i?r.autoMinMax?n:0:i,s=r.max,u=void 0===s?r.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var h=(u-a)/(o-n),d=0;d<t.length;d++)e[d]=(t[d]-n)*h+a;return e}const tn=" ".repeat(2),en=" ".repeat(4);function rn(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=e;return`${t.constructor.name} {\\n${tn}[\\n${en}${function(t,e,r,n,o){const{rows:i,columns:a}=t,s=Math.min(i,e),u=Math.min(a,r),h=[];if("auto"===o){o=!1;t:for(let e=0;e<s;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let e=0;e<s;e++){let r=[];for(let i=0;i<u;i++)r.push(nn(t.get(e,i),n,o));h.push(`${r.join(" ")}`)}return u!==a&&(h[h.length-1]+=` ... ${a-r} more columns`),s!==i&&h.push(`... ${i-e} more rows`),h.join(`\\n${en}`)}(t,r,n,o,i)}\\n${tn}]\\n${tn}rows: ${t.rows}\\n${tn}columns: ${t.columns}\\n}`}function nn(t,e,r){return(t>=0&&r?` ${on(t,e-1)}`:on(t,e)).padEnd(e)}function on(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function an(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function sn(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function un(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function hn(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function dn(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(cn("startRow",e),cn("endRow",r),cn("startColumn",n),cn("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function ln(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function cn(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function fn(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class gn{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new vn(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new vn(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new vn(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new vn(t,e)}static ones(t,e){return new vn(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new vn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)o.set(r,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let a=o-n,s=new vn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(i()*a);s.set(r,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let t=0;t<n;t++)o.set(t,t,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let e=0;e<o;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new vn(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return gn.isMatrix(t)?t:new vn(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let a=o;a<e;a++){let e=t.get(r,a)-i*t.get(n,a);t.set(r,a,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new vn(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){an(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return vn.rowVector(this.getRow(t))}setRow(t,e){an(this,t),e=un(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){an(this,t),an(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){sn(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return vn.columnVector(this.getColumn(t))}setColumn(t,e){sn(this,t),e=hn(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){sn(this,t),sn(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){an(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){sn(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){fn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){fn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(an(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){an(this,t),fn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(an(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){an(this,t),fn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(sn(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){sn(this,t),fn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(sn(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){sn(this,t),fn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){gn.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=vn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new vn(e,n),i=new Float64Array(r);for(let a=0;a<n;a++){for(let e=0;e<r;e++)i[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,a,e)}}return o}strassen2x2(t){t=vn.checkMatrix(t);let e=new vn(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),h=t.get(1,1),d=(r+u)*(n+h),l=(a+u)*n,c=r*(i-h),f=u*(s-n),g=(r+o)*h,p=d+f-g+(o-u)*(s+h),v=c+g,y=l+f,m=d-l+c+(a-r)*(n+i);return e.set(0,0,p),e.set(0,1,v),e.set(1,0,y),e.set(1,1,m),e}strassen3x3(t){t=vn.checkMatrix(t);let e=new vn(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),h=this.get(2,1),d=this.get(2,2),l=t.get(0,0),c=t.get(0,1),f=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),y=t.get(2,0),m=t.get(2,1),w=t.get(2,2),x=(r-i)*(-c+p),E=(-r+i+a)*(l-c+p),N=(i+a)*(-l+c),b=r*l,M=(-r+u+h)*(l-f+v),S=(-r+u)*(f-v),k=(u+h)*(-l+f),A=(-o+h+d)*(p+y-m),_=(o-d)*(p-m),z=o*y,R=(h+d)*(-y+m),I=(-o+a+s)*(v+y-w),D=(o-s)*(v-w),O=(a+s)*(-y+w),P=b+z+n*g,T=(r+n+o-i-a-h-d)*p+E+N+b+A+z+R,C=b+M+k+(r+n+o-a-s-u-h)*v+z+I+O,q=x+a*(-l+c+g-p-v-y+w)+E+b+z+I+D,L=x+E+N+b+s*m,j=z+I+D+O+i*f,F=b+M+S+h*(-l+f+g-p-v-y+m)+A+_+z,V=A+_+z+R+u*c,B=b+M+S+k+d*w;return e.set(0,0,P),e.set(0,1,T),e.set(0,2,C),e.set(1,0,q),e.set(1,1,L),e.set(1,2,j),e.set(2,0,F),e.set(2,1,V),e.set(2,2,B),e}mmulStrassen(t){t=vn.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function a(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=gn.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${r} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let s=Math.max(r,o),u=Math.max(n,i);return e=a(e,s,u),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=a(e,n+1,o+1),r=a(r,n+1,o+1)):n%2==1?(e=a(e,n+1,o),r=a(r,n+1,o)):o%2==1&&(e=a(e,n,o+1),r=a(r,n,o+1));let i=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,s-1),h=r.subMatrix(0,i-1,0,s-1),d=e.subMatrix(0,i-1,s,e.columns-1),l=r.subMatrix(0,i-1,s,r.columns-1),c=e.subMatrix(i,e.rows-1,0,s-1),f=r.subMatrix(i,r.rows-1,0,s-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),p=r.subMatrix(i,r.rows-1,s,r.columns-1),v=t(gn.add(u,g),gn.add(h,p),i,s),y=t(gn.add(c,g),h,i,s),m=t(u,gn.sub(l,p),i,s),w=t(g,gn.sub(f,h),i,s),x=t(gn.add(u,d),p,i,s),E=t(gn.sub(c,u),gn.add(h,l),i,s),N=t(gn.sub(d,g),gn.add(f,p),i,s),b=gn.add(v,w);b.sub(x),b.add(N);let M=gn.add(m,x),S=gn.add(y,w),k=gn.sub(v,y);k.add(m),k.add(E);let A=gn.zeros(2*b.rows,2*b.columns);return A=A.setSubMatrix(b,0,0),A=A.setSubMatrix(M,b.rows,0),A=A.setSubMatrix(S,0,b.columns),A=A.setSubMatrix(k,b.rows,b.columns),A.subMatrix(0,n-1,0,o-1)}(e,t=a(t,s,u),s,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new vn(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&Zr(o,{min:e,max:r,output:o}),n.setRow(t,o)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new vn(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&Zr(o,{min:e,max:r,output:o}),n.setColumn(t,o)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=vn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new vn(e*n,r*o);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<o;s++)i.set(n*a+r,o*e+s,this.get(a,e)*t.get(r,s));return i}kroneckerSum(t){if(t=vn.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(vn.eye(r,r)),o=vn.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new vn(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=pn){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=pn){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){dn(this,t,e,r,n);let o=new vn(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new vn(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new vn(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=vn.checkMatrix(t)).isEmpty())return this;dn(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){!function(t,e){if(!Qr(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!Qr(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new vn(t.length,e.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<e.length;t++){let i=e[t];r.set(n,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new vn(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=ln(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=ln(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=ln(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=ln(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Qr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<n;a++){let n=0,s=0,u=0;for(let e=0;e<o;e++)u=t.get(a,e)-r[a],n+=u,s+=u*u;e?i.push((s-n*n/o)/(o-1)):i.push((s-n*n/o)/o)}return i}(this,r,n);case"column":if(!Qr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<o;a++){let o=0,s=0,u=0;for(let e=0;e<n;e++)u=t.get(e,a)-r[a],o+=u,s+=u*u;e?i.push((s-o*o/n)/(n-1)):i.push((s-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let a=0,s=0,u=0;for(let e=0;e<n;e++)for(let n=0;n<o;n++)u=t.get(e,n)-r,a+=u,s+=u*u;return e?(s-a*a/i)/(i-1):(s-a*a/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Qr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!Qr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!Qr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!Qr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return rn(this,t)}}function pn(t,e){return t-e}gn.prototype.klass="Matrix","undefined"!=typeof Symbol&&(gn.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return rn(this)}),gn.random=gn.rand,gn.randomInt=gn.randInt,gn.diagonal=gn.diag,gn.prototype.diagonal=gn.prototype.diag,gn.identity=gn.eye,gn.prototype.negate=gn.prototype.neg,gn.prototype.tensorProduct=gn.prototype.kroneckerProduct;class vn extends gn{constructor(t,e){if(super(),vn.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Qr(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!r[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return an(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),an(this,t,!0),e=Float64Array.from(un(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){sn(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),sn(this,t,!0),e=hn(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(gn,vn);class yn extends gn{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function mn(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class wn{constructor(t,e={}){if((t=yn.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=e;let s,u=Boolean(o),h=Boolean(i),d=!1;if(r<n)if(a){s=t.transpose(),r=s.rows,n=s.columns,d=!0;let e=u;u=h,h=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let l=Math.min(r,n),c=Math.min(r+1,n),f=new Float64Array(c),g=new vn(r,l),p=new vn(n,n),v=new Float64Array(n),y=new Float64Array(r),m=new Float64Array(c);for(let t=0;t<c;t++)m[t]=t;let w=Math.min(r-1,n),x=Math.max(0,Math.min(n-2,r)),E=Math.max(w,x);for(let t=0;t<E;t++){if(t<w){f[t]=0;for(let e=t;e<r;e++)f[t]=mn(f[t],s.get(e,t));if(0!==f[t]){s.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<r;e++)s.set(e,t,s.get(e,t)/f[t]);s.set(t,t,s.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<n;e++){if(t<w&&0!==f[t]){let n=0;for(let o=t;o<r;o++)n+=s.get(o,t)*s.get(o,e);n=-n/s.get(t,t);for(let o=t;o<r;o++)s.set(o,e,s.get(o,e)+n*s.get(o,t))}v[e]=s.get(t,e)}if(u&&t<w)for(let e=t;e<r;e++)g.set(e,t,s.get(e,t));if(t<x){v[t]=0;for(let e=t+1;e<n;e++)v[t]=mn(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<n;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<r&&0!==v[t]){for(let e=t+1;e<r;e++)y[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)y[e]+=v[r]*s.get(e,r);for(let e=t+1;e<n;e++){let n=-v[e]/v[t+1];for(let o=t+1;o<r;o++)s.set(o,e,s.get(o,e)+n*y[o])}}if(h)for(let e=t+1;e<n;e++)p.set(e,t,v[e])}}let N=Math.min(n,r+1);if(w<n&&(f[w]=s.get(w,w)),r<N&&(f[N-1]=0),x+1<N&&(v[x]=s.get(x,N-1)),v[N-1]=0,u){for(let t=w;t<l;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<l;e++){let n=0;for(let o=t;o<r;o++)n+=g.get(o,t)*g.get(o,e);n=-n/g.get(t,t);for(let o=t;o<r;o++)g.set(o,e,g.get(o,e)+n*g.get(o,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(h)for(let t=n-1;t>=0;t--){if(t<x&&0!==v[t])for(let e=t+1;e<n;e++){let r=0;for(let o=t+1;o<n;o++)r+=p.get(o,t)*p.get(o,e);r=-r/p.get(t+1,t);for(let o=t+1;o<n;o++)p.set(o,e,p.get(o,e)+r*p.get(o,t))}for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}let b=N-1,M=0,S=Number.EPSILON;for(;N>0;){let t,e;for(t=N-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===N-2)e=4;else{let r;for(r=N-1;r>=t&&r!==t;r--){let e=(r!==N?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(f[r])<=S*e){f[r]=0;break}}r===t?e=3:r===N-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[N-2];v[N-2]=0;for(let r=N-2;r>=t;r--){let o=mn(f[r],e),i=f[r]/o,a=e/o;if(f[r]=o,r!==t&&(e=-a*v[r-1],v[r-1]=i*v[r-1]),h)for(let t=0;t<n;t++)o=i*p.get(t,r)+a*p.get(t,N-1),p.set(t,N-1,-a*p.get(t,r)+i*p.get(t,N-1)),p.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<N;n++){let o=mn(f[n],e),i=f[n]/o,a=e/o;if(f[n]=o,e=-a*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g.get(e,n)+a*g.get(e,t-1),g.set(e,t-1,-a*g.get(e,n)+i*g.get(e,t-1)),g.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(f[N-1]),Math.abs(f[N-2]),Math.abs(v[N-2]),Math.abs(f[t]),Math.abs(v[t])),o=f[N-1]/e,i=f[N-2]/e,a=v[N-2]/e,s=f[t]/e,d=v[t]/e,l=((i+o)*(i-o)+a*a)/2,c=o*a*(o*a);let y=0;0===l&&0===c||(y=l<0?0-Math.sqrt(l*l+c):Math.sqrt(l*l+c),y=c/(l+y));let m=(s+o)*(s-o)+y,w=s*d;for(let e=t;e<N-1;e++){let o=mn(m,w);0===o&&(o=Number.MIN_VALUE);let i=m/o,a=w/o;if(e!==t&&(v[e-1]=o),m=i*f[e]+a*v[e],v[e]=i*v[e]-a*f[e],w=a*f[e+1],f[e+1]=i*f[e+1],h)for(let t=0;t<n;t++)o=i*p.get(t,e)+a*p.get(t,e+1),p.set(t,e+1,-a*p.get(t,e)+i*p.get(t,e+1)),p.set(t,e,o);if(o=mn(m,w),0===o&&(o=Number.MIN_VALUE),i=m/o,a=w/o,f[e]=o,m=i*v[e]+a*f[e+1],f[e+1]=-a*v[e]+i*f[e+1],w=a*v[e+1],v[e+1]=i*v[e+1],u&&e<r-1)for(let t=0;t<r;t++)o=i*g.get(t,e)+a*g.get(t,e+1),g.set(t,e+1,-a*g.get(t,e)+i*g.get(t,e+1)),g.set(t,e,o)}v[N-2]=m,M+=1;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,h))for(let e=0;e<=b;e++)p.set(e,t,-p.get(e,t));for(;t<b&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,h&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}M=0,N--}}if(d){let t=p;p=g,g=t}this.m=r,this.n=n,this.s=f,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,o=vn.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?o.set(t,t,0):o.set(t,t,1/this.s[t]);let i=this.U,a=this.rightSingularVectors,s=a.mmul(o),u=a.rows,h=i.rows,d=vn.zeros(u,h);for(let t=0;t<u;t++)for(let e=0;e<h;e++){let r=0;for(let o=0;o<n;o++)r+=s.get(t,o)*i.get(e,o);d.set(t,e,r)}return d.mmul(e)}solveForDiagonal(t){return this.solve(vn.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new vn(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,a=i.rows,s=i.columns,u=new vn(r,a);for(let t=0;t<r;t++)for(let e=0;e<a;e++){let r=0;for(let n=0;n<s;n++)r+=o.get(t,n)*i.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return vn.diag(this.s)}}var xn,En={center:[0,0],linkDistance:50},Nn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="mds",this.options=n(n({},En),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericMDSLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericMDSLayout(!0,t,e),[2]}))}))},t.prototype.genericMDSLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,g,y;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=void 0===i?[0,0]:i,u=o.linkDistance,h=void 0===u?50:u,d=e.getAllNodes(),l=e.getAllEdges(),(null==d?void 0:d.length)&&1!==d.length?(c=v({nodes:d,edges:l},!1),f=p(c),bn(f),m=h,w=[],f.forEach((function(t){var e=[];t.forEach((function(t){e.push(t*m)})),w.push(e)})),g=Mn(w),y=[],g.forEach((function(t,e){var r=N(d[e]);r.data.x=t[0]+s[0],r.data.y=t[1]+s[1],y.push(r)})),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:y,edges:l}]):[2,_(e,t,s)];var m,w}))}))},t}(),bn=function(t){var e=-999999;t.forEach((function(t){t.forEach((function(t){t!==1/0&&e<t&&(e=t)}))})),t.forEach((function(r,n){r.forEach((function(r,o){r===1/0&&(t[n][o]=e)}))}))},Mn=function(t){var e=vn.mul(vn.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),o=e.mean();e.add(o).subRowVector(r).subColumnVector(n);var i=new wn(e),a=vn.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((function(t){return vn.mul([t],[a]).toJSON()[0].splice(0,2)}))},Sn={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},kn=function(t,e,r,n,o,i){e.forEach((function(a,s){r[s]={x:0,y:0},e.forEach((function(e,u){if(s!==u&&o[s]===o[u]){var h=a.x-e.x,d=a.y-e.y,l=Math.sqrt(h*h+d*d);if(0===l){l=1;var c=s>u?1:-1;h=.01*c,d=.01*c}if(l<i(t[s])/2+i(t[u])/2){var f=n*n/l;r[s].x+=h/l*f,r[s].y+=d/l*f}}}))}))},An=function(t,e,r,n,o,i,a,s){var u=i||a/10;return n&&e.forEach((function(e,r){var n=t[r].x-t[o].x,i=t[r].y-t[o].y,a=Math.sqrt(n*n+i*i),s=i/a,u=-n/a,h=Math.sqrt(e.x*e.x+e.y*e.y),d=Math.acos((s*e.x+u*e.y)/h);d>Math.PI/2&&(d-=Math.PI/2,s*=-1,u*=-1);var l=Math.cos(d)*h;e.x=s*l,e.y=u*l})),t.forEach((function(i,a){if(a!==o){var h=Math.sqrt(e[a].x*e[a].x+e[a].y*e[a].y);if(h>0&&a!==o){var d=Math.min(u*(r/800),h);if(i.x+=e[a].x/h*d,i.y+=e[a].y/h*d,n){var l=i.x-t[o].x,c=i.y-t[o].y,f=Math.sqrt(l*l+c*c);l=l/f*s[a],c=c/f*s[a],i.x=t[o].x+l,i.y=t[o].y+c}}}})),t},_n={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},zn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="radial",this.options=n(n({},_n),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRadialLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRadialLayout(!0,t,e),[2]}))}))},t.prototype.genericRadialLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,h,d,l,c,f,g,y,m,w,x,E,b,M,S,k,z,R,I,D,P,T,C,q,L,j,F,V,B,G,W,$,U,H,K,Y,J,X,Q,Z,tt,et;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,h=o.height,d=o.center,l=o.focusNode,c=o.unitRadius,f=o.nodeSize,g=o.nodeSpacing,y=o.strictRadial,m=o.preventOverlap,w=o.maxPreventOverlapIteration,x=o.sortBy,E=o.linkDistance,b=void 0===E?50:E,M=o.sortStrength,S=void 0===M?10:M,k=o.maxIteration,z=void 0===k?1e3:k,R=e.getAllNodes(),I=e.getAllEdges(),D=i||"undefined"==typeof window?i:window.innerWidth,P=h||"undefined"==typeof window?h:window.innerHeight,T=d||[D/2,P/2],!(null==R?void 0:R.length)||1===R.length)return[2,_(e,t,T)];if(C=R[0],O(l)){for(q=0;q<R.length;q++)if(R[q].id===l){C=R[q];break}}else C=l||R[0];return L=Dn(R,C.id),j=v({nodes:R,edges:I},!1),F=p(j),V=Pn(F,L),On(F,L,V+1),B=F[L],G=D-T[0]>T[0]?T[0]:D-T[0],W=P-T[1]>T[1]?T[1]:P-T[1],0===G&&(G=D/2),0===W&&(W=P/2),$=Math.min(G,W),U=Math.max.apply(Math,u([],s(B))),H=[],K=c||$/U,B.forEach((function(t,e){H[e]=t*K})),Y=Rn(R,F,b,H,K,x,S),J=In(Y),X=function(t,e,r){try{var n=vn.mul(vn.pow(e,2),-.5),o=n.mean("row"),i=n.mean("column"),a=n.mean();n.add(a).subRowVector(o).subColumnVector(i);var s=new wn(n),u=vn.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((function(e){return vn.mul([e],[u]).toJSON()[0].splice(0,t)}))}catch(t){for(var h=[],d=0;d<e.length;d++){var l=Math.random()*r,c=Math.random()*r;h.push([l,c])}return h}}(b,Y,b),Q=X.map((function(t){var e=s(t,2),r=e[0],n=e[1];return{x:(isNaN(r)?Math.random()*b:r)-X[L][0],y:(isNaN(n)?Math.random()*b:n)-X[L][1]}})),this.run(z,Q,J,Y,H,L),m&&(Z=A(f,g),tt={nodes:R,nodeSizeFunc:Z,positions:Q,radii:H,height:P,width:D,strictRadial:Boolean(y),focusIdx:L,iterations:w||200,k:Q.length/4.5},Q=function(t,e){for(var r=n(n({},Sn),e),o=r.positions,i=r.iterations,a=r.width,s=r.k,u=r.speed,h=void 0===u?100:u,d=r.strictRadial,l=r.focusIdx,c=r.radii,f=void 0===c?[]:c,g=r.nodeSizeFunc,p=t.getAllNodes(),v=[],y=a/10,m=0;m<i;m++)o.forEach((function(t,e){v[e]={x:0,y:0}})),kn(p,o,v,s,f,g),An(o,v,h,d,l,y,a,f);return o}(e,tt)),et=[],Q.forEach((function(t,e){var r=N(R[e]);r.data.x=t.x+T[0],r.data.y=t.y+T[1],et.push(r)})),t&&et.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:et,edges:I}]}))}))},t.prototype.run=function(t,e,r,n,o,i){for(var a=0;a<=t;a++){var s=a/t;this.oneIteration(s,e,o,n,r,i)}},t.prototype.oneIteration=function(t,e,r,n,o,i){var a=1-t;e.forEach((function(s,u){var h=y(s,{x:0,y:0}),d=0===h?0:1/h;if(u!==i){var l=0,c=0,f=0;e.forEach((function(t,e){if(u!==e){var r=y(s,t),i=0===r?0:1/r,a=n[e][u];f+=o[u][e],l+=o[u][e]*(t.x+a*(s.x-t.x)*i),c+=o[u][e]*(t.y+a*(s.y-t.y)*i)}}));var g=0===r[u]?0:1/r[u];f*=a,f+=t*g*g,l*=a,l+=t*g*s.x*d,s.x=l/f,c*=a,c+=t*g*s.y*d,s.y=c/f}}))},t}(),Rn=function(t,e,r,n,o,i,a){if(!t)return[];var s=[];if(e){var u={};e.forEach((function(e,h){var d=[];e.forEach((function(e,s){var l,c;if(h===s)d.push(0);else if(n[h]===n[s])if("data"===i)d.push(e*(Math.abs(h-s)*a)/(n[h]/o));else if(i){var f=void 0,g=void 0;if(u[t[h].id])f=u[t[h].id];else{var p=("id"===i?t[h].id:null===(l=t[h].data)||void 0===l?void 0:l[i])||0;f=O(p)?p.charCodeAt(0):p,u[t[h].id]=f}u[t[s].id]?g=u[t[s].id]:(p=("id"===i?t[s].id:null===(c=t[s].data)||void 0===c?void 0:c[i])||0,g=O(p)?p.charCodeAt(0):p,u[t[s].id]=g),d.push(e*(Math.abs(f-g)*a)/(n[h]/o))}else d.push(e*r/(n[h]/o));else{var v=(r+o)/2;d.push(e*v)}})),s.push(d)}))}return s},In=function(t){for(var e=t.length,r=t[0].length,n=[],o=0;o<e;o++){for(var i=[],a=0;a<r;a++)0!==t[o][a]?i.push(1/(t[o][a]*t[o][a])):i.push(0);n.push(i)}return n},Dn=function(t,e){var r=-1;return t.forEach((function(t,n){t.id===e&&(r=n)})),Math.max(r,0)},On=function(t,e,r){for(var n=t.length,o=0;o<n;o++)if(t[e][o]===1/0){t[e][o]=r,t[o][e]=r;for(var i=0;i<n;i++)t[o][i]!==1/0&&t[e][i]===1/0&&(t[e][i]=r+t[o][i],t[i][e]=r+t[o][i])}for(o=0;o<n;o++)if(o!==e)for(i=0;i<n;i++)if(t[o][i]===1/0){var a=Math.abs(t[e][o]-t[e][i]);a=0===a?1:a,t[o][i]=a}},Pn=function(t,e){for(var r=0,n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r},Tn={center:[0,0],width:300,height:300},Cn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="random",this.options=n(n({},Tn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRandomLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRandomLayout(!0,t,e),[2]}))}))},t.prototype.genericRandomLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,h=e.getAllNodes(),d=s||"undefined"==typeof window?s:window.innerWidth,l=u||"undefined"==typeof window?u:window.innerHeight,c=i||[d/2,l/2],f=[],h&&h.forEach((function(t){f.push({id:t.id,data:{x:.9*(Math.random()-.5)*d+c[0],y:.9*(Math.random()-.5)*l+c[1]}})})),t&&f.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:f,edges:e.getAllEdges()}]}))}))},t}(),qn={circular:R,concentric:T,mds:Nn,random:Cn,grid:Wr,radial:zn,force:zr,d3force:Tt,fruchterman:Br,forceAtlas2:Fr,dagre:pr};function Ln(){var t;(null===(t=xn)||void 0===t?void 0:t.stop)&&xn.stop()}function jn(t,e){return i(this,void 0,void 0,(function(){var r,n,o,i,s,u,h,d,l;return a(this,(function(a){switch(a.label){case 0:if(r=t.layout,n=r.id,o=r.options,i=r.iterations,s=t.nodes,u=t.edges,h=new c({nodes:s,edges:u}),!(d=qn[n]))throw new Error("Unknown layout id: "+n);return[4,(xn=new d(o)).execute(h)];case 1:return l=a.sent(),!!(f=xn).tick&&!!f.stop&&(xn.stop(),l=xn.tick(i)),[2,[l,e]]}var f}))}))}addEventListener("message",(function(t){var r,n=t.data,o=n.type,i=n.method,a=n.id,s=n.params;"RPC"===o&&i&&((r=e[i])?Promise.resolve().then((function(){return r.apply(e,s)})):Promise.reject("No such method")).then((function(t){postMessage({type:"RPC",id:a,result:t})})).catch((function(t){var e={message:t};t.stack&&(e.message=t.message,e.stack=t.stack,e.name=t.name),postMessage({type:"RPC",id:a,error:e})}))})),postMessage({type:"RPC",method:"ready"});\n//# sourceMappingURL=5e37927bd3e57252658c.worker.js.map']))),d(g,c),g}},331:l=>{l.exports=function(a,i){var d=0,c={};a.addEventListener("message",function(g){var y=g.data;if(y.type==="RPC")if(y.id){var k=c[y.id];k&&(delete c[y.id],y.error?k[1](Object.assign(Error(y.error.message),y.error)):k[0](y.result))}else{var D=document.createEvent("Event");D.initEvent(y.method,!1,!1),D.data=y.params,a.dispatchEvent(D)}}),i.forEach(function(g){a[g]=function(){var y=arguments;return new Promise(function(k,D){var _=++d;c[_]=[k,D],a.postMessage({type:"RPC",id:_,method:g,params:[].slice.call(y)})})}})}}},fo={};function Zt(l){var a=fo[l];if(a!==void 0)return a.exports;var i=fo[l]={exports:{}};return ss[l](i,i.exports,Zt),i.exports}Zt.n=l=>{var a=l&&l.__esModule?()=>l.default:()=>l;return Zt.d(a,{a}),a},Zt.d=(l,a)=>{for(var i in a)Zt.o(a,i)&&!Zt.o(l,i)&&Object.defineProperty(l,i,{enumerable:!0,get:a[i]})},Zt.o=(l,a)=>Object.prototype.hasOwnProperty.call(l,a);var $e={};(()=>{Zt.d($e,{SB:()=>Wr,W1:()=>Hr,jA:()=>hn,Vq:()=>Fn,E9:()=>Yn,y7:()=>Bn,O2:()=>Qn,Me:()=>Jn,AI:()=>so,D4:()=>uo,_5:()=>ho,y9:()=>di,_A:()=>q,d9:()=>ae,ul:()=>xt,qs:()=>at,gl:()=>cr,jE:()=>Jt,tO:()=>hr,zJ:()=>dt,h$:()=>Rt,BI:()=>Wt,$y:()=>Qt,H0:()=>kt,kJ:()=>V,hY:()=>es,qR:()=>ts,i_:()=>co,nu:()=>yt,He:()=>X,A3:()=>Ut});var l=function(o,r){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},l(o,r)};function a(o,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function t(){this.constructor=o}l(o,r),o.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var i=function(){return i=Object.assign||function(o){for(var r,t=1,e=arguments.length;t<e;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(o[n]=r[n]);return o},i.apply(this,arguments)};function d(o,r){var t={};for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&r.indexOf(e)<0&&(t[e]=o[e]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function"){var n=0;for(e=Object.getOwnPropertySymbols(o);n<e.length;n++)r.indexOf(e[n])<0&&Object.prototype.propertyIsEnumerable.call(o,e[n])&&(t[e[n]]=o[e[n]])}return t}function c(o,r,t,e){return new(t||(t=Promise))(function(n,s){function u(p){try{f(e.next(p))}catch(v){s(v)}}function h(p){try{f(e.throw(p))}catch(v){s(v)}}function f(p){var v;p.done?n(p.value):(v=p.value,v instanceof t?v:new t(function(m){m(v)})).then(u,h)}f((e=e.apply(o,r||[])).next())})}function g(o,r){var t,e,n,s,u={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function h(f){return function(p){return function(v){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,v[0]&&(u=0)),u;)try{if(t=1,e&&(n=2&v[0]?e.return:v[0]?e.throw||((n=e.return)&&n.call(e),0):e.next)&&!(n=n.call(e,v[1])).done)return n;switch(e=0,n&&(v=[2&v[0],n.value]),v[0]){case 0:case 1:n=v;break;case 4:return u.label++,{value:v[1],done:!1};case 5:u.label++,e=v[1],v=[0];continue;case 7:v=u.ops.pop(),u.trys.pop();continue;default:if(!((n=(n=u.trys).length>0&&n[n.length-1])||v[0]!==6&&v[0]!==2)){u=0;continue}if(v[0]===3&&(!n||v[1]>n[0]&&v[1]<n[3])){u.label=v[1];break}if(v[0]===6&&u.label<n[1]){u.label=n[1],n=v;break}if(n&&u.label<n[2]){u.label=n[2],u.ops.push(v);break}n[2]&&u.ops.pop(),u.trys.pop();continue}v=r.call(o,u)}catch(m){v=[6,m],e=0}finally{t=n=0}if(5&v[0])throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}([f,p])}}}function y(o,r){var t=typeof Symbol=="function"&&o[Symbol.iterator];if(!t)return o;var e,n,s=t.call(o),u=[];try{for(;(r===void 0||r-- >0)&&!(e=s.next()).done;)u.push(e.value)}catch(h){n={error:h}}finally{try{e&&!e.done&&(t=s.return)&&t.call(s)}finally{if(n)throw n.error}}return u}function k(o,r,t){if(t||arguments.length===2)for(var e,n=0,s=r.length;n<s;n++)!e&&n in r||(e||(e=Array.prototype.slice.call(r,0,n)),e[n]=r[n]);return o.concat(e||Array.prototype.slice.call(r))}var D,_,j=/-(\w)/g,q=(D=function(o){return o.replace(j,function(r,t){return t?t.toUpperCase():""})},_=Object.create(null),function(o){return _[o]||(_[o]=D(o))}),V=Array.isArray,X=function(o){var r=parseFloat(o);return isNaN(r)?o:r},st={}.toString;const ft=function(o,r){return st.call(o)==="[object "+r+"]"},Q=function(o){return ft(o,"Number")};var at=function(o){for(var r=[],t=o.length,e=0;e<t;e+=1){r[e]=[];for(var n=0;n<t;n+=1)e===n?r[e][n]=0:o[e][n]!==0&&o[e][n]?r[e][n]=o[e][n]:r[e][n]=1/0}for(var s=0;s<t;s+=1)for(e=0;e<t;e+=1)for(n=0;n<t;n+=1)r[e][n]>r[e][s]+r[s][n]&&(r[e][n]=r[e][s]+r[s][n]);return r},dt=function(o,r){var t=o.nodes,e=o.edges,n=[],s={};if(!t)throw new Error("invalid nodes data!");return t&&t.forEach(function(u,h){s[u.id]=h,n.push([])}),e==null||e.forEach(function(u){var h=u.source,f=u.target,p=s[h],v=s[f];p!==void 0&&v!==void 0&&(n[p][v]=1,r||(n[v][p]=1))}),n},yt=function(o,r){var t=[];return o.forEach(function(e){var n=[];e.forEach(function(s){n.push(s*r)}),t.push(n)}),t},Tt=function(o,r){if(o&&o.children){for(var t=o.children.length-1;t>=0;t--)if(!Tt(o.children[t],r))return}return!!r(o)},Ut=function(o,r){typeof r=="function"&&Tt(o,r)},kt=function(o){var r=1/0,t=1/0,e=-1/0,n=-1/0;return o.forEach(function(s){var u=s.data.size;V(u)?u.length===1&&(u=[u[0],u[0]]):Q(u)?u=[u,u]:(u===void 0||isNaN(u))&&(u=[30,30]);var h=[u[0]/2,u[1]/2],f=s.data.x-h[0],p=s.data.x+h[0],v=s.data.y-h[1],m=s.data.y+h[1];r>f&&(r=f),t>v&&(t=v),e<p&&(e=p),n<m&&(n=m)}),{minX:r,minY:t,maxX:e,maxY:n}},Rt=function(o){var r={x:0,y:0};o.forEach(function(e){r.x+=e.data.x||0,r.y+=e.data.y||0});var t=o.length||1;return{x:r.x/t,y:r.y/t}},$t=function(o,r,t){var e,n;return o==="source"?((e=t==null?void 0:t.find(function(s){return s.target===r.id}))===null||e===void 0?void 0:e.source)||{}:((n=t==null?void 0:t.find(function(s){return s.source===r.id}))===null||n===void 0?void 0:n.target)||{}},bt=function(o,r,t){var e=[];switch(o){case"source":e=t==null?void 0:t.filter(function(s){return s.source===r.id}).map(function(s){return s.target});break;case"target":e=t==null?void 0:t.filter(function(s){return s.target===r.id}).map(function(s){return s.source});break;case"both":e=t==null?void 0:t.filter(function(s){return s.source===r.id}).map(function(s){return s.target}).concat(t==null?void 0:t.filter(function(s){return s.target===r.id}).map(function(s){return s.source}))}var n=new Set(e);return Array.from(n)},Wt=function(o,r,t,e,n,s){var u=n[r.id],h=u.in,f=u.out,p=r,v=[];h===0?(p=$t("source",r,t),v=bt("both",p,t).map(function(b){return s[b]})):f===0&&(p=$t("target",r,t),v=bt("both",p,t).map(function(b){return s[b]})),v=v.filter(function(b){return n[b.id]&&(n[b.id].in===0||n[b.id].out===0)});var m=function(b,E,x,w,N){var A=x[E]||"",S=(w==null?void 0:w.filter(function(L){return L[E]===A}))||[];return b==="leaf"&&(S=S.filter(function(L){var C,T;return((C=N[L.id])===null||C===void 0?void 0:C.in)===0||((T=N[L.id])===null||T===void 0?void 0:T.out)===0})),S}(o,e,r,v,n);return{coreNode:p,relativeLeafNodes:v,sameTypeLeafNodes:m}},Qt=function(o,r){return Math.sqrt((o.x-r.x)*(o.x-r.x)+(o.y-r.y)*(o.y-r.y))},ae=function(o){if(o===null)return o;if(o instanceof Date)return new Date(o.getTime());if(o instanceof Array){var r=[];return o.forEach(function(e){r.push(e)}),r.map(function(e){return ae(e)})}if(typeof o=="object"){var t={};return Object.keys(o).forEach(function(e){t[e]=ae(o[e])}),t}return o},xt=function(o,r){var t=ae(o);return t.data=t.data||{},r&&(Q(t.data.x)||(t.data.x=Math.random()*r[0]),Q(t.data.y)||(t.data.y=Math.random()*r[1])),t};const Kt=function(o){return typeof o=="function"},ee=function(o){var r=typeof o;return o!==null&&r==="object"||r==="function"};function Jt(o,r){return Kt(r)?r:Q(r)?function(){return r}:function(){return o}}function hr(o,r,t){return t===void 0&&(t=!0),r||r===0?Kt(r)?r:Q(r)?function(){return r}:V(r)?function(){if(t){var e=Math.max.apply(Math,k([],y(r)));return isNaN(e)?o:e}return r}:ee(r)?function(){if(t){var e=Math.max(r.width,r.height);return isNaN(e)?o:e}return[r.width,r.height]}:function(){return o}:function(e){var n=(e.data||{}).size;return n?V(n)?n[0]>n[1]?n[0]:n[1]:ee(n)?n.width>n.height?n.width:n.height:n:o}}var cr=function(o,r){var t;return t=Q(r)?function(){return r}:Kt(r)?r:function(){return 0},o?V(o)?function(e){return(o[0]>o[1]?o[0]:o[1])+t(e)}:function(e){return o+t(e)}:function(e){var n,s;if(!((n=e.data)===null||n===void 0)&&n.bboxSize)return Math.max(e.data.bboxSize[0],e.data.bboxSize[1])+t(e);if(!((s=e.data)===null||s===void 0)&&s.size){if(V(e.data.size))return Math.max(e.data.size[0],e.data.size[1])+t(e);var u=e.data.size;return ee(u)?(u.width>u.height?u.width:u.height)+t(e):u+t(e)}return 10+t(e)}},we=function(o,r,t){var e=o.getAllNodes(),n=o.getAllEdges();return e!=null&&e.length?e.length===1?(r&&o.mergeNodeData(e[0].id,{x:t[0],y:t[1]}),{nodes:[i(i({},e[0]),{data:i(i({},e[0].data),{x:t[0],y:t[1]})})],edges:n}):void 0:{nodes:[],edges:n}},ni={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},Wr=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="circular",this.options=i(i({},ni),r)}return o.prototype.execute=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return[2,this.genericCircularLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){switch(e.label){case 0:return[4,this.genericCircularLayout(!0,r,t)];case 1:return e.sent(),[2]}})})},o.prototype.genericCircularLayout=function(r,t,e){return c(this,void 0,void 0,function(){var n,s,u,h,f,p,v,m,b,E,x,w,N,A,S,L,C,T,R,I,O,G,M,z,$,P,B,W,U,K,J,Y,tt,ot,rt;return g(this,function(F){if(n=i(i({},this.options),e),s=n.width,u=n.height,h=n.center,f=n.divisions,p=n.startAngle,v=p===void 0?0:p,m=n.endAngle,b=m===void 0?2*Math.PI:m,E=n.angleRatio,x=n.ordering,w=n.clockwise,N=n.nodeSpacing,A=n.nodeSize,S=t.getAllNodes(),L=t.getAllEdges(),C=y(oi(s,u,h),3),T=C[0],R=C[1],I=C[2],!(O=S==null?void 0:S.length)||O===1)return[2,we(t,r,I)];for(G=(b-v)/O,M=n.radius,z=n.startRadius,$=n.endRadius,N?(P=Jt(10,N),B=hr(10,A),W=-1/0,S.forEach(function(Z){var ut=B(Z);W<ut&&(W=ut)}),U=0,S.forEach(function(Z,ut){U+=ut===0?W||10:(P(Z)||0)+(W||10)}),M=U/(2*Math.PI)):M||z||$?!z&&$?z=$:z&&!$&&($=z):M=Math.min(R,T)/2,K=G*E,J=[],J=x==="topology"?Br(t,S):x==="topology-directed"?Br(t,S,!0):x==="degree"?function(Z,ut){var nt=[];return ut.forEach(function(H,ht){nt.push(xt(H))}),nt.sort(function(H,ht){return Z.getDegree(H.id,"both")-Z.getDegree(ht.id,"both")}),nt}(t,S):S.map(function(Z){return xt(Z)}),Y=Math.ceil(O/f),tt=0;tt<O;++tt)(ot=M)||z===null||$===null||(ot=z+tt*($-z)/(O-1)),ot||(ot=10+100*tt/(O-1)),rt=v+tt%Y*K+2*Math.PI/f*Math.floor(tt/Y),w||(rt=b-tt%Y*K-2*Math.PI/f*Math.floor(tt/Y)),J[tt].data.x=I[0]+Math.cos(rt)*ot,J[tt].data.y=I[1]+Math.sin(rt)*ot;return r&&J.forEach(function(Z){t.mergeNodeData(Z.id,{x:Z.data.x,y:Z.data.y})}),[2,{nodes:J,edges:L}]})})},o}(),Br=function(o,r,t){t===void 0&&(t=!1);var e=[xt(r[0])],n={},s=r.length;n[r[0].id]=!0;var u=0;return r.forEach(function(h,f){if(f!==0)if(f!==s-1&&o.getDegree(h.id,"both")===o.getDegree(r[f+1].id,"both")&&!o.areNeighbors(e[u].id,h.id)||n[h.id]){for(var p=t?o.getSuccessors(e[u].id):o.getNeighbors(e[u].id),v=!1,m=0;m<p.length;m++){var b=p[m];if(o.getDegree(b.id)===o.getDegree(h.id)&&!n[b.id]){e.push(xt(b)),n[b.id]=!0,v=!0;break}}for(var E=0;!v&&(n[r[E].id]||(e.push(xt(r[E])),n[r[E].id]=!0,v=!0),++E!==s););}else e.push(xt(h)),n[h.id]=!0,u++}),e},oi=function(o,r,t){var e=o,n=r,s=t;return e||typeof window>"u"||(e=window.innerWidth),n||typeof window>"u"||(n=window.innerHeight),s||(s=[e/2,n/2]),[e,n,s]},ii=Zt(913),ai=Zt.n(ii),si=Zt(370),ui=Zt.n(si),di=function(o){function r(t,e,n){var s=o.call(this)||this;return s.graph=t,s.layout=e,s.options=n,s.spawnWorker(),s}return a(r,o),r.prototype.spawnWorker=function(){this.worker&&this.worker.terminate(),this.worker=ui()(),this.running&&(this.running=!1,this.execute())},r.prototype.execute=function(){var t;return c(this,void 0,void 0,function(){var e,n,s,u;return g(this,function(h){switch(h.label){case 0:return this.running?[2,this]:(this.running=!0,(e=this.layout.options).onTick,n=d(e,["onTick"]),s={layout:{id:this.layout.id,options:n,iterations:(t=this.options)===null||t===void 0?void 0:t.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},u=new Float32Array([0]),[4,this.worker.calculateLayout(s,[u])]);case 1:return[2,y.apply(void 0,[h.sent(),1])[0]]}})})},r.prototype.stop=function(){return this.running=!1,this.worker.stopLayout(),this},r.prototype.kill=function(){this.worker&&this.worker.terminate()},r.prototype.isRunning=function(){return this.running},r}(ai());const Re=function(o){return ft(o,"String")};var hi={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},Hr=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="concentric",this.options=i(i({},hi),r)}return o.prototype.execute=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return[2,this.genericConcentricLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return this.genericConcentricLayout(!0,r,t),[2]})})},o.prototype.genericConcentricLayout=function(r,t,e){return c(this,void 0,void 0,function(){var n,s,u,h,f,p,v,m,b,E,x,w,N,A,S,L,C,T,R,I,O,G,M,z,$,P,B,W,U,K,J,Y,tt,ot,rt,F,Z,ut;return g(this,function(nt){if(n=i(i({},this.options),e),s=n.center,u=n.width,h=n.height,f=n.sortBy,p=n.maxLevelDiff,v=n.sweep,m=n.clockwise,b=n.equidistant,E=n.preventOverlap,x=n.startAngle,w=x===void 0?1.5*Math.PI:x,N=n.nodeSize,A=n.nodeSpacing,S=t.getAllNodes(),L=t.getAllEdges(),C=u||typeof window>"u"?u:window.innerWidth,T=h||typeof window>"u"?h:window.innerHeight,R=s||[C/2,T/2],!(S!=null&&S.length)||S.length===1)return[2,we(t,r,R)];if(I=[],G=0,O=V(N)?Math.max(N[0],N[1]):N,V(A)?G=Math.max(A[0],A[1]):Q(A)&&(G=A),S.forEach(function(H){var ht=xt(H);I.push(ht);var Et=O,mt=ht.data;V(mt.size)?Et=Math.max(mt.size[0],mt.size[1]):Q(mt.size)?Et=mt.size:ee(mt.size)&&(Et=Math.max(mt.size.width,mt.size.height)),O=Math.max(O,Et),Kt(A)&&(G=Math.max(A(H),G))}),M={},I.forEach(function(H,ht){M[H.id]=ht}),Re(z=f)&&I[0].data[z]!==void 0||(z="degree"),z==="degree"?I.sort(function(H,ht){return t.getDegree(ht.id,"both")-t.getDegree(H.id,"both")}):I.sort(function(H,ht){return ht.data[z]-H.data[z]}),$=I[0],P=(p||(z==="degree"?t.getDegree($.id,"both"):$.data[z]))/4,W=(B=[{nodes:[]}])[0],I.forEach(function(H){if(W.nodes.length>0){var ht=Math.abs(z==="degree"?t.getDegree(W.nodes[0].id,"both")-t.getDegree(H.id,"both"):W.nodes[0].data[z]-H.data[z]);P&&ht>=P&&(W={nodes:[]},B.push(W))}W.nodes.push(H)}),U=O+G,E||(K=B.length>0&&B[0].nodes.length>1,J=Math.min(C,T)/2-U,Y=J/(B.length+(K?1:0)),U=Math.min(U,Y)),tt=0,B.forEach(function(H){var ht=v===void 0?2*Math.PI-2*Math.PI/H.nodes.length:v;if(H.dTheta=ht/Math.max(1,H.nodes.length-1),H.nodes.length>1&&E){var Et=Math.cos(H.dTheta)-Math.cos(0),mt=Math.sin(H.dTheta)-Math.sin(0),Gt=Math.sqrt(U*U/(Et*Et+mt*mt));tt=Math.max(Gt,tt)}H.r=tt,tt+=U}),b){for(ot=0,rt=0,F=0;F<B.length;F++)Z=B[F],ut=(Z.r||0)-rt,ot=Math.max(ot,ut);rt=0,B.forEach(function(H,ht){ht===0&&(rt=H.r||0),H.r=rt,rt+=ot})}return B.forEach(function(H){var ht=H.dTheta||0,Et=H.r||0;H.nodes.forEach(function(mt,Gt){var Dt=w+(m?1:-1)*ht*Gt;mt.data.x=R[0]+Et*Math.cos(Dt),mt.data.y=R[1]+Et*Math.sin(Dt)})}),r&&I.forEach(function(H){return t.mergeNodeData(H.id,{x:H.data.x,y:H.data.y})}),[2,{nodes:I,edges:L}]})})},o}();function Kr(o,r,t,e){if(isNaN(r)||isNaN(t))return o;var n,s,u,h,f,p,v,m,b,E=o._root,x={data:e},w=o._x0,N=o._y0,A=o._x1,S=o._y1;if(!E)return o._root=x,o;for(;E.length;)if((p=r>=(s=(w+A)/2))?w=s:A=s,(v=t>=(u=(N+S)/2))?N=u:S=u,n=E,!(E=E[m=v<<1|p]))return n[m]=x,o;if(h=+o._x.call(null,E.data),f=+o._y.call(null,E.data),r===h&&t===f)return x.next=E,n?n[m]=x:o._root=x,o;do n=n?n[m]=new Array(4):o._root=new Array(4),(p=r>=(s=(w+A)/2))?w=s:A=s,(v=t>=(u=(N+S)/2))?N=u:S=u;while((m=v<<1|p)==(b=(f>=u)<<1|h>=s));return n[b]=E,n[m]=x,o}function jt(o,r,t,e,n){this.node=o,this.x0=r,this.y0=t,this.x1=e,this.y1=n}function ci(o){return o[0]}function li(o){return o[1]}function je(o,r,t){var e=new lr(r??ci,t??li,NaN,NaN,NaN,NaN);return o==null?e:e.addAll(o)}function lr(o,r,t,e,n,s){this._x=o,this._y=r,this._x0=t,this._y0=e,this._x1=n,this._y1=s,this._root=void 0}function Yr(o){for(var r={data:o.data},t=r;o=o.next;)t=t.next={data:o.data};return r}var qt=je.prototype=lr.prototype;function Ft(o){return function(){return o}}function ge(o){return 1e-6*(o()-.5)}qt.copy=function(){var o,r,t=new lr(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root;if(!e)return t;if(!e.length)return t._root=Yr(e),t;for(o=[{source:e,target:t._root=new Array(4)}];e=o.pop();)for(var n=0;n<4;++n)(r=e.source[n])&&(r.length?o.push({source:r,target:e.target[n]=new Array(4)}):e.target[n]=Yr(r));return t},qt.add=function(o){const r=+this._x.call(null,o),t=+this._y.call(null,o);return Kr(this.cover(r,t),r,t,o)},qt.addAll=function(o){var r,t,e,n,s=o.length,u=new Array(s),h=new Array(s),f=1/0,p=1/0,v=-1/0,m=-1/0;for(t=0;t<s;++t)isNaN(e=+this._x.call(null,r=o[t]))||isNaN(n=+this._y.call(null,r))||(u[t]=e,h[t]=n,e<f&&(f=e),e>v&&(v=e),n<p&&(p=n),n>m&&(m=n));if(f>v||p>m)return this;for(this.cover(f,p).cover(v,m),t=0;t<s;++t)Kr(this,u[t],h[t],o[t]);return this},qt.cover=function(o,r){if(isNaN(o=+o)||isNaN(r=+r))return this;var t=this._x0,e=this._y0,n=this._x1,s=this._y1;if(isNaN(t))n=(t=Math.floor(o))+1,s=(e=Math.floor(r))+1;else{for(var u,h,f=n-t||1,p=this._root;t>o||o>=n||e>r||r>=s;)switch(h=(r<e)<<1|o<t,(u=new Array(4))[h]=p,p=u,f*=2,h){case 0:n=t+f,s=e+f;break;case 1:t=n-f,s=e+f;break;case 2:n=t+f,e=s-f;break;case 3:t=n-f,e=s-f}this._root&&this._root.length&&(this._root=p)}return this._x0=t,this._y0=e,this._x1=n,this._y1=s,this},qt.data=function(){var o=[];return this.visit(function(r){if(!r.length)do o.push(r.data);while(r=r.next)}),o},qt.extent=function(o){return arguments.length?this.cover(+o[0][0],+o[0][1]).cover(+o[1][0],+o[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},qt.find=function(o,r,t){var e,n,s,u,h,f,p,v=this._x0,m=this._y0,b=this._x1,E=this._y1,x=[],w=this._root;for(w&&x.push(new jt(w,v,m,b,E)),t==null?t=1/0:(v=o-t,m=r-t,b=o+t,E=r+t,t*=t);f=x.pop();)if(!(!(w=f.node)||(n=f.x0)>b||(s=f.y0)>E||(u=f.x1)<v||(h=f.y1)<m))if(w.length){var N=(n+u)/2,A=(s+h)/2;x.push(new jt(w[3],N,A,u,h),new jt(w[2],n,A,N,h),new jt(w[1],N,s,u,A),new jt(w[0],n,s,N,A)),(p=(r>=A)<<1|o>=N)&&(f=x[x.length-1],x[x.length-1]=x[x.length-1-p],x[x.length-1-p]=f)}else{var S=o-+this._x.call(null,w.data),L=r-+this._y.call(null,w.data),C=S*S+L*L;if(C<t){var T=Math.sqrt(t=C);v=o-T,m=r-T,b=o+T,E=r+T,e=w.data}}return e},qt.remove=function(o){if(isNaN(s=+this._x.call(null,o))||isNaN(u=+this._y.call(null,o)))return this;var r,t,e,n,s,u,h,f,p,v,m,b,E=this._root,x=this._x0,w=this._y0,N=this._x1,A=this._y1;if(!E)return this;if(E.length)for(;;){if((p=s>=(h=(x+N)/2))?x=h:N=h,(v=u>=(f=(w+A)/2))?w=f:A=f,r=E,!(E=E[m=v<<1|p]))return this;if(!E.length)break;(r[m+1&3]||r[m+2&3]||r[m+3&3])&&(t=r,b=m)}for(;E.data!==o;)if(e=E,!(E=E.next))return this;return(n=E.next)&&delete E.next,e?(n?e.next=n:delete e.next,this):r?(n?r[m]=n:delete r[m],(E=r[0]||r[1]||r[2]||r[3])&&E===(r[3]||r[2]||r[1]||r[0])&&!E.length&&(t?t[b]=E:this._root=E),this):(this._root=n,this)},qt.removeAll=function(o){for(var r=0,t=o.length;r<t;++r)this.remove(o[r]);return this},qt.root=function(){return this._root},qt.size=function(){var o=0;return this.visit(function(r){if(!r.length)do++o;while(r=r.next)}),o},qt.visit=function(o){var r,t,e,n,s,u,h=[],f=this._root;for(f&&h.push(new jt(f,this._x0,this._y0,this._x1,this._y1));r=h.pop();)if(!o(f=r.node,e=r.x0,n=r.y0,s=r.x1,u=r.y1)&&f.length){var p=(e+s)/2,v=(n+u)/2;(t=f[3])&&h.push(new jt(t,p,v,s,u)),(t=f[2])&&h.push(new jt(t,e,v,p,u)),(t=f[1])&&h.push(new jt(t,p,n,s,v)),(t=f[0])&&h.push(new jt(t,e,n,p,v))}return this},qt.visitAfter=function(o){var r,t=[],e=[];for(this._root&&t.push(new jt(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var n=r.node;if(n.length){var s,u=r.x0,h=r.y0,f=r.x1,p=r.y1,v=(u+f)/2,m=(h+p)/2;(s=n[0])&&t.push(new jt(s,u,h,v,m)),(s=n[1])&&t.push(new jt(s,v,h,f,m)),(s=n[2])&&t.push(new jt(s,u,m,v,p)),(s=n[3])&&t.push(new jt(s,v,m,f,p))}e.push(r)}for(;r=e.pop();)o(r.node,r.x0,r.y0,r.x1,r.y1);return this},qt.x=function(o){return arguments.length?(this._x=o,this):this._x},qt.y=function(o){return arguments.length?(this._y=o,this):this._y};var fi={value:()=>{}};function Qr(){for(var o,r=0,t=arguments.length,e={};r<t;++r){if(!(o=arguments[r]+"")||o in e||/[\s.]/.test(o))throw new Error("illegal type: "+o);e[o]=[]}return new qe(e)}function qe(o){this._=o}function gi(o,r){for(var t,e=0,n=o.length;e<n;++e)if((t=o[e]).name===r)return t.value}function Jr(o,r,t){for(var e=0,n=o.length;e<n;++e)if(o[e].name===r){o[e]=fi,o=o.slice(0,e).concat(o.slice(e+1));break}return t!=null&&o.push({name:r,value:t}),o}qe.prototype=Qr.prototype={constructor:qe,on:function(o,r){var t,e,n=this._,s=(e=n,(o+"").trim().split(/^|\s+/).map(function(f){var p="",v=f.indexOf(".");if(v>=0&&(p=f.slice(v+1),f=f.slice(0,v)),f&&!e.hasOwnProperty(f))throw new Error("unknown type: "+f);return{type:f,name:p}})),u=-1,h=s.length;if(!(arguments.length<2)){if(r!=null&&typeof r!="function")throw new Error("invalid callback: "+r);for(;++u<h;)if(t=(o=s[u]).type)n[t]=Jr(n[t],o.name,r);else if(r==null)for(t in n)n[t]=Jr(n[t],o.name,null);return this}for(;++u<h;)if((t=(o=s[u]).type)&&(t=gi(n[t],o.name)))return t},copy:function(){var o={},r=this._;for(var t in r)o[t]=r[t].slice();return new qe(o)},call:function(o,r){if((t=arguments.length-2)>0)for(var t,e,n=new Array(t),s=0;s<t;++s)n[s]=arguments[s+2];if(!this._.hasOwnProperty(o))throw new Error("unknown type: "+o);for(s=0,t=(e=this._[o]).length;s<t;++s)e[s].value.apply(r,n)},apply:function(o,r,t){if(!this._.hasOwnProperty(o))throw new Error("unknown type: "+o);for(var e=this._[o],n=0,s=e.length;n<s;++n)e[n].value.apply(r,t)}};const pi=Qr;var Fe,Ie,xe=0,Te=0,Oe=0,Xr=1e3,Ve=0,ye=0,Ue=0,Pe=typeof performance=="object"&&performance.now?performance:Date,Zr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(o){setTimeout(o,17)};function tn(){return ye||(Zr(vi),ye=Pe.now()+Ue)}function vi(){ye=0}function fr(){this._call=this._time=this._next=null}function en(o,r,t){var e=new fr;return e.restart(o,r,t),e}function rn(){ye=(Ve=Pe.now())+Ue,xe=Te=0;try{(function(){tn(),++xe;for(var o,r=Fe;r;)(o=ye-r._time)>=0&&r._call.call(void 0,o),r=r._next;--xe})()}finally{xe=0,function(){for(var o,r,t=Fe,e=1/0;t;)t._call?(e>t._time&&(e=t._time),o=t,t=t._next):(r=t._next,t._next=null,t=o?o._next=r:Fe=r);Ie=o,gr(e)}(),ye=0}}function yi(){var o=Pe.now(),r=o-Ve;r>Xr&&(Ue-=r,Ve=o)}function gr(o){xe||(Te&&(Te=clearTimeout(Te)),o-ye>24?(o<1/0&&(Te=setTimeout(rn,o-Pe.now()-Ue)),Oe&&(Oe=clearInterval(Oe))):(Oe||(Ve=Pe.now(),Oe=setInterval(yi,Xr)),xe=1,Zr(rn)))}fr.prototype=en.prototype={constructor:fr,restart:function(o,r,t){if(typeof o!="function")throw new TypeError("callback is not a function");t=(t==null?tn():+t)+(r==null?0:+r),this._next||Ie===this||(Ie?Ie._next=this:Fe=this,Ie=this),this._call=o,this._time=t,gr()},stop:function(){this._call&&(this._call=null,this._time=1/0,gr())}};const mi=1664525,wi=1013904223,nn=4294967296;function xi(o){return o.x}function Ei(o){return o.y}var bi=10,Ni=Math.PI*(3-Math.sqrt(5));function on(o){var r,t=1,e=.001,n=1-Math.pow(e,1/300),s=0,u=.6,h=new Map,f=en(m),p=pi("tick","end"),v=function(){let w=1;return()=>(w=(mi*w+wi)%nn)/nn}();function m(){b(),p.call("tick",r),t<e&&(f.stop(),p.call("end",r))}function b(w){var N,A,S=o.length;w===void 0&&(w=1);for(var L=0;L<w;++L)for(t+=(s-t)*n,h.forEach(function(C){C(t)}),N=0;N<S;++N)(A=o[N]).fx==null?A.x+=A.vx*=u:(A.x=A.fx,A.vx=0),A.fy==null?A.y+=A.vy*=u:(A.y=A.fy,A.vy=0);return r}function E(){for(var w,N=0,A=o.length;N<A;++N){if((w=o[N]).index=N,w.fx!=null&&(w.x=w.fx),w.fy!=null&&(w.y=w.fy),isNaN(w.x)||isNaN(w.y)){var S=bi*Math.sqrt(.5+N),L=N*Ni;w.x=S*Math.cos(L),w.y=S*Math.sin(L)}(isNaN(w.vx)||isNaN(w.vy))&&(w.vx=w.vy=0)}}function x(w){return w.initialize&&w.initialize(o,v),w}return o==null&&(o=[]),E(),r={tick:b,restart:function(){return f.restart(m),r},stop:function(){return f.stop(),r},nodes:function(w){return arguments.length?(o=w,E(),h.forEach(x),r):o},alpha:function(w){return arguments.length?(t=+w,r):t},alphaMin:function(w){return arguments.length?(e=+w,r):e},alphaDecay:function(w){return arguments.length?(n=+w,r):+n},alphaTarget:function(w){return arguments.length?(s=+w,r):s},velocityDecay:function(w){return arguments.length?(u=1-w,r):1-u},randomSource:function(w){return arguments.length?(v=w,h.forEach(x),r):v},force:function(w,N){return arguments.length>1?(N==null?h.delete(w):h.set(w,x(N)),r):h.get(w)},find:function(w,N,A){var S,L,C,T,R,I=0,O=o.length;for(A==null?A=1/0:A*=A,I=0;I<O;++I)(C=(S=w-(T=o[I]).x)*S+(L=N-T.y)*L)<A&&(R=T,A=C);return R},on:function(w,N){return arguments.length>1?(p.on(w,N),r):p.on(w)}}}function an(){var o,r,t,e,n,s=Ft(-30),u=1,h=1/0,f=.81;function p(E){var x,w=o.length,N=je(o,xi,Ei).visitAfter(m);for(e=E,x=0;x<w;++x)r=o[x],N.visit(b)}function v(){if(o){var E,x,w=o.length;for(n=new Array(w),E=0;E<w;++E)x=o[E],n[x.index]=+s(x,E,o)}}function m(E){var x,w,N,A,S,L=0,C=0;if(E.length){for(N=A=S=0;S<4;++S)(x=E[S])&&(w=Math.abs(x.value))&&(L+=x.value,C+=w,N+=w*x.x,A+=w*x.y);E.x=N/C,E.y=A/C}else{(x=E).x=x.data.x,x.y=x.data.y;do L+=n[x.data.index];while(x=x.next)}E.value=L}function b(E,x,w,N){if(!E.value)return!0;var A=E.x-r.x,S=E.y-r.y,L=N-x,C=A*A+S*S;if(L*L/f<C)return C<h&&(A===0&&(C+=(A=ge(t))*A),S===0&&(C+=(S=ge(t))*S),C<u&&(C=Math.sqrt(u*C)),r.vx+=A*E.value*e/C,r.vy+=S*E.value*e/C),!0;if(!(E.length||C>=h)){(E.data!==r||E.next)&&(A===0&&(C+=(A=ge(t))*A),S===0&&(C+=(S=ge(t))*S),C<u&&(C=Math.sqrt(u*C)));do E.data!==r&&(L=n[E.data.index]*e/C,r.vx+=A*L,r.vy+=S*L);while(E=E.next)}}return p.initialize=function(E,x){o=E,t=x,v()},p.strength=function(E){return arguments.length?(s=typeof E=="function"?E:Ft(+E),v(),p):s},p.distanceMin=function(E){return arguments.length?(u=E*E,p):Math.sqrt(u)},p.distanceMax=function(E){return arguments.length?(h=E*E,p):Math.sqrt(h)},p.theta=function(E){return arguments.length?(f=E*E,p):Math.sqrt(f)},p}function Mi(o){return o.index}function sn(o,r){var t=o.get(r);if(!t)throw new Error("node not found: "+r);return t}function pr(o){var r,t,e,n,s,u,h=Mi,f=function(w){return 1/Math.min(n[w.source.index],n[w.target.index])},p=Ft(30),v=1;function m(w){for(var N=0,A=o.length;N<v;++N)for(var S,L,C,T,R,I,O,G=0;G<A;++G)L=(S=o[G]).source,T=(C=S.target).x+C.vx-L.x-L.vx||ge(u),R=C.y+C.vy-L.y-L.vy||ge(u),T*=I=((I=Math.sqrt(T*T+R*R))-t[G])/I*w*r[G],R*=I,C.vx-=T*(O=s[G]),C.vy-=R*O,L.vx+=T*(O=1-O),L.vy+=R*O}function b(){if(e){var w,N,A=e.length,S=o.length,L=new Map(e.map((C,T)=>[h(C,T,e),C]));for(w=0,n=new Array(A);w<S;++w)(N=o[w]).index=w,typeof N.source!="object"&&(N.source=sn(L,N.source)),typeof N.target!="object"&&(N.target=sn(L,N.target)),n[N.source.index]=(n[N.source.index]||0)+1,n[N.target.index]=(n[N.target.index]||0)+1;for(w=0,s=new Array(S);w<S;++w)N=o[w],s[w]=n[N.source.index]/(n[N.source.index]+n[N.target.index]);r=new Array(S),E(),t=new Array(S),x()}}function E(){if(e)for(var w=0,N=o.length;w<N;++w)r[w]=+f(o[w],w,o)}function x(){if(e)for(var w=0,N=o.length;w<N;++w)t[w]=+p(o[w],w,o)}return o==null&&(o=[]),m.initialize=function(w,N){e=w,u=N,b()},m.links=function(w){return arguments.length?(o=w,b(),m):o},m.id=function(w){return arguments.length?(h=w,m):h},m.iterations=function(w){return arguments.length?(v=+w,m):v},m.strength=function(w){return arguments.length?(f=typeof w=="function"?w:Ft(+w),E(),m):f},m.distance=function(w){return arguments.length?(p=typeof w=="function"?w:Ft(+w),x(),m):p},m}function Si(o){return o.x+o.vx}function Ai(o){return o.y+o.vy}function un(o){var r,t,e,n=1,s=1;function u(){for(var p,v,m,b,E,x,w,N=r.length,A=0;A<s;++A)for(v=je(r,Si,Ai).visitAfter(h),p=0;p<N;++p)m=r[p],x=t[m.index],w=x*x,b=m.x+m.vx,E=m.y+m.vy,v.visit(S);function S(L,C,T,R,I){var O=L.data,G=L.r,M=x+G;if(!O)return C>b+M||R<b-M||T>E+M||I<E-M;if(O.index>m.index){var z=b-O.x-O.vx,$=E-O.y-O.vy,P=z*z+$*$;P<M*M&&(z===0&&(P+=(z=ge(e))*z),$===0&&(P+=($=ge(e))*$),P=(M-(P=Math.sqrt(P)))/P*n,m.vx+=(z*=P)*(M=(G*=G)/(w+G)),m.vy+=($*=P)*M,O.vx-=z*(M=1-M),O.vy-=$*M)}}}function h(p){if(p.data)return p.r=t[p.data.index];for(var v=p.r=0;v<4;++v)p[v]&&p[v].r>p.r&&(p.r=p[v].r)}function f(){if(r){var p,v,m=r.length;for(t=new Array(m),p=0;p<m;++p)v=r[p],t[v.index]=+o(v,p,r)}}return typeof o!="function"&&(o=Ft(o==null?1:+o)),u.initialize=function(p,v){r=p,e=v,f()},u.iterations=function(p){return arguments.length?(s=+p,u):s},u.strength=function(p){return arguments.length?(n=+p,u):n},u.radius=function(p){return arguments.length?(o=typeof p=="function"?p:Ft(+p),f(),u):o},u}function ki(o){var r,t,e,n=Ft(.1);function s(h){for(var f,p=0,v=r.length;p<v;++p)(f=r[p]).vx+=(e[p]-f.x)*t[p]*h}function u(){if(r){var h,f=r.length;for(t=new Array(f),e=new Array(f),h=0;h<f;++h)t[h]=isNaN(e[h]=+o(r[h],h,r))?0:+n(r[h],h,r)}}return typeof o!="function"&&(o=Ft(o==null?0:+o)),s.initialize=function(h){r=h,u()},s.strength=function(h){return arguments.length?(n=typeof h=="function"?h:Ft(+h),u(),s):n},s.x=function(h){return arguments.length?(o=typeof h=="function"?h:Ft(+h),u(),s):o},s}function _i(o){var r,t,e,n=Ft(.1);function s(h){for(var f,p=0,v=r.length;p<v;++p)(f=r[p]).vy+=(e[p]-f.y)*t[p]*h}function u(){if(r){var h,f=r.length;for(t=new Array(f),e=new Array(f),h=0;h<f;++h)t[h]=isNaN(e[h]=+o(r[h],h,r))?0:+n(r[h],h,r)}}return typeof o!="function"&&(o=Ft(o==null?0:+o)),s.initialize=function(h){r=h,u()},s.strength=function(h){return arguments.length?(n=typeof h=="function"?h:Ft(+h),u(),s):n},s.y=function(h){return arguments.length?(o=typeof h=="function"?h:Ft(+h),u(),s):o},s}function dn(){function o(T){return function(){return T}}var r,t=function(T){return T.cluster},e=o(1),n=o(-1),s=o(100),u=o(.1),h=[0,0],f=[],p={},v=[],m=100,b=100,E={none:{x:0,y:0}},x=[],w="force",N=!0,A=.1;function S(T){if(!N)return S;r.tick(),C();for(var R=0,I=f.length,O=void 0,G=T*A;R<I;++R)(O=f[R]).vx+=(E[t(O)].x-O.x)*G,O.vy+=(E[t(O)].y-O.y)*G}function L(){f&&function(){if(f&&f.length){if(t(f[0])===void 0)throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy('clusterAttr') before calling .links()");var T,R,I,O,G,M=(T=[],R=[],I={},G=[],O=function(z){var $={};return z.forEach(function(P){var B=t(P);$[B]||($[B]={count:0,sumforceNodeSize:0})}),z.forEach(function(P){var B=t(P),W=e(P),U=$[B];U.count=U.count+1,U.sumforceNodeSize=U.sumforceNodeSize+Math.PI*(W*W)*1.3,$[B]=U}),$}(f),G=function(z){var $={},P=[];return z.forEach(function(B){var W,U,K,J,Y,tt=(U=(W=B).source,K=W.target,(J=t(p[U]))<=(Y=t(p[K]))?J+"~"+Y:Y+"~"+J),ot=0;$[tt]!==void 0&&(ot=$[tt]),ot+=1,$[tt]=ot}),Object.entries($).forEach(function(B){var W=y(B,2),U=W[0],K=W[1],J=U.split("~")[0],Y=U.split("~")[1];J!==void 0&&Y!==void 0&&P.push({source:J,target:Y,count:K})}),P}(v),Object.keys(O).forEach(function(z,$){var P=O[z];T.push({id:z,size:P.count,r:Math.sqrt(P.sumforceNodeSize/Math.PI)}),I[z]=$}),G.forEach(function(z){var $=z.source,P=z.target,B=I[$],W=I[P];B!==void 0&&W!==void 0&&R.push({source:B,target:W,count:z.count})}),{nodes:T,links:R});r=on(M.nodes).force("x",ki(m).strength(.1)).force("y",_i(b).strength(.1)).force("collide",un(function(z){return z.r}).iterations(4)).force("charge",an().strength(n)).force("links",pr(M.nodes.length?M.links:[]).distance(s).strength(u)),x=r.nodes(),C()}}()}function C(){return E={none:{x:0,y:0}},x.forEach(function(T){E[T.id]={x:T.x-h[0],y:T.y-h[1]}}),E}return S.initialize=function(T){f=T,L()},S.template=function(T){return arguments.length?(w=T,L(),S):w},S.groupBy=function(T){return arguments.length?typeof T=="string"?(t=function(R){return R[T]},S):(t=T,S):t},S.enableGrouping=function(T){return arguments.length?(N=T,S):N},S.strength=function(T){return arguments.length?(A=T,S):A},S.centerX=function(T){return arguments.length?(m=T,S):m},S.centerY=function(T){return arguments.length?(b=T,S):b},S.nodes=function(T){return arguments.length?(function(R){p={},R.forEach(function(I){p[I.id]=I})}(T||[]),f=T||[],S):f},S.links=function(T){return arguments.length?(v=T||[],L(),S):v},S.forceNodeSize=function(T){return arguments.length?(e=typeof T=="function"?T:o(+T),L(),S):e},S.nodeSize=S.forceNodeSize,S.forceCharge=function(T){return arguments.length?(n=typeof T=="function"?T:o(+T),L(),S):n},S.forceLinkDistance=function(T){return arguments.length?(s=typeof T=="function"?T:o(+T),L(),S):s},S.forceLinkStrength=function(T){return arguments.length?(u=typeof T=="function"?T:o(+T),L(),S):u},S.offset=function(T){return arguments.length?(h=T,S):h},S.getFocis=C,S}var zi={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},hn=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="d3force",this.options=i(i({},zi),r)}return o.prototype.execute=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return[2,this.genericForceLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return this.genericForceLayout(!0,r,t),[2]})})},o.prototype.stop=function(){var r;(r=this.forceSimulation)===null||r===void 0||r.stop()},o.prototype.tick=function(r){var t=this;r===void 0&&(r=1),this.forceSimulation.tick(r);var e={nodes:We(this.lastLayoutNodes),edges:Be(this.lastLayoutEdges)};return this.lastAssign&&e.nodes.forEach(function(n){return t.lastGraph.mergeNodeData(n.id,{x:n.data.x,y:n.data.y})}),e},o.prototype.genericForceLayout=function(r,t,e){return c(this,void 0,void 0,function(){var n,s,u,h,f,p,v,m,b,E,x,w,N,A,S,L,C,T,R,I,O,G,M,z,$,P,B=this;return g(this,function(W){return n=i(i({},this.options),e),s=t.getAllNodes(),u=t.getAllEdges(),h=s.map(function(U){var K,J;return i(i({},xt(U)),{x:(K=U.data)===null||K===void 0?void 0:K.x,y:(J=U.data)===null||J===void 0?void 0:J.y})}),f=u.map(function(U){return xt(U)}),this.lastLayoutNodes=h,this.lastLayoutEdges=f,this.lastAssign=r,this.lastGraph=t,p=n.alphaMin,v=n.alphaDecay,m=n.alpha,b=n.nodeStrength,E=n.edgeStrength,x=n.linkDistance,w=n.clustering,N=n.clusterFociStrength,A=n.clusterEdgeDistance,S=n.clusterEdgeStrength,L=n.clusterNodeStrength,C=n.clusterNodeSize,T=n.collideStrength,R=T===void 0?1:T,I=n.center,O=I===void 0?[0,0]:I,G=n.preventOverlap,M=n.nodeSize,z=n.nodeSpacing,$=n.onTick,P=n.forceSimulation,[2,new Promise(function(U){if(P){w&&((Y=dn()).nodes(h),Y.links(f)),P.nodes(h),f&&(ot=pr().id(function(rt){return rt.id}).links(f),E&&ot.strength(E),x&&ot.distance(x),P.force("link",ot)),G&&B.overlapProcess(P,{nodeSize:M,nodeSpacing:z,collideStrength:R}),P.alpha(m).restart();var K=We(h),J=Be(f);r&&K.forEach(function(rt){return t.mergeNodeData(rt.id,{x:rt.data.x,y:rt.data.y})}),U({nodes:K,edges:J})}else try{var Y,tt=an();if(b&&tt.strength(b),P=on().nodes(h),w&&((Y=dn()).centerX(O[0]).centerY(O[1]).template("force").strength(N),f&&Y.links(f),h&&Y.nodes(h),Y.forceLinkDistance(A).forceLinkStrength(S).forceCharge(L).forceNodeSize(C),P.force("group",Y)),P.force("center",function(rt,F){var Z,ut=1;function nt(){var H,ht,Et=Z.length,mt=0,Gt=0;for(H=0;H<Et;++H)mt+=(ht=Z[H]).x,Gt+=ht.y;for(mt=(mt/Et-rt)*ut,Gt=(Gt/Et-F)*ut,H=0;H<Et;++H)(ht=Z[H]).x-=mt,ht.y-=Gt}return rt==null&&(rt=0),F==null&&(F=0),nt.initialize=function(H){Z=H},nt.x=function(H){return arguments.length?(rt=+H,nt):rt},nt.y=function(H){return arguments.length?(F=+H,nt):F},nt.strength=function(H){return arguments.length?(ut=+H,nt):ut},nt}(O[0],O[1])).force("charge",tt).alpha(m).alphaDecay(v).alphaMin(p),G&&B.overlapProcess(P,{nodeSize:M,nodeSpacing:z,collideStrength:R}),f){var ot=pr().id(function(rt){return rt.id}).links(f);E&&ot.strength(E),x&&ot.distance(x),P.force("link",ot)}P.on("tick",function(){var rt=We(h);$==null||$({nodes:rt,edges:Be(f)}),r&&rt.forEach(function(F){return t.mergeNodeData(F.id,{x:F.data.x,y:F.data.y})})}).on("end",function(){var rt=We(h);r&&rt.forEach(function(F){return t.mergeNodeData(F.id,{x:F.data.x,y:F.data.y})}),U({nodes:rt,edges:Be(f)})})}catch(rt){console.warn(rt)}B.forceSimulation=P})]})})},o.prototype.overlapProcess=function(r,t){var e,n,s=t.nodeSize,u=t.nodeSpacing,h=t.collideStrength;if(n=Q(u)?function(){return u}:Kt(u)?u:function(){return 0},s)if(Kt(s))e=function(v){return s(v)+n(v)};else if(V(s)){var f=(s[0]>s[1]?s[0]:s[1])/2;e=function(v){return f+n(v)}}else if(Q(s)){var p=s/2;e=function(v){return p+n(v)}}else e=function(){return 10};else e=function(v){return v.size?V(v.size)?(v.size[0]>v.size[1]?v.size[0]:v.size[1])/2+n(v):ee(v.size)?(v.size.width>v.size.height?v.size.width:v.size.height)/2+n(v):v.size/2+n(v):10+n(v)};r.force("collisionForce",un(e).strength(h))},o}(),We=function(o){return o.map(function(r){var t=r.x,e=r.y,n=d(r,["x","y"]);return i(i({},n),{data:i(i({},n.data),{x:t,y:e})})})},Be=function(o){return o.map(function(r){var t=r.source,e=r.target,n=d(r,["source","target"]);return i(i({},n),{source:t.id,target:e.id})})};const Di=function(){function o(){this._events={}}return o.prototype.on=function(r,t,e){return this._events[r]||(this._events[r]=[]),this._events[r].push({callback:t,once:!!e}),this},o.prototype.once=function(r,t){return this.on(r,t,!0)},o.prototype.emit=function(r){for(var t=this,e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var s=this._events[r]||[],u=this._events["*"]||[],h=function(f){for(var p=f.length,v=0;v<p;v++)if(f[v]){var m=f[v],b=m.callback;m.once&&(f.splice(v,1),f.length===0&&delete t._events[r],p--,v--),b.apply(t,e)}};h(s),h(u)},o.prototype.off=function(r,t){if(r)if(t){for(var e=this._events[r]||[],n=e.length,s=0;s<n;s++)e[s].callback===t&&(e.splice(s,1),n--,s--);e.length===0&&delete this._events[r]}else delete this._events[r];else this._events={};return this},o.prototype.getEvents=function(){return this._events},o}();function cn(o,r,t,e){for(;o.length;){const n=o.shift();if(t(n))return!0;r.add(n.id),e(n.id).forEach(s=>{r.has(s.id)||(r.add(s.id),o.push(s))})}return!1}function vr(o,r,t,e){if(t(o))return!0;r.add(o.id);for(const n of e(o.id))if(!r.has(n.id)&&vr(n,r,t,e))return!0;return!1}class Vt extends Di{constructor(t){super();It(this,"nodeMap",new Map);It(this,"edgeMap",new Map);It(this,"inEdgesMap",new Map);It(this,"outEdgesMap",new Map);It(this,"bothEdgesMap",new Map);It(this,"treeIndices",new Map);It(this,"changes",[]);It(this,"batchCount",0);It(this,"onChanged",()=>{});It(this,"batch",t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()});t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach(n=>{switch(n.type){case"NodeRemoved":{let s=!1;e=e.filter(u=>{if(u.type==="NodeAdded"){const h=u.value.id===n.value.id;return h&&(s=!0),!h}return u.type==="NodeDataUpdated"?u.id!==n.value.id:u.type!=="TreeStructureChanged"||u.nodeId!==n.value.id}),s||e.push(n);break}case"EdgeRemoved":{let s=!1;e=e.filter(u=>{if(u.type==="EdgeAdded"){const h=u.value.id===n.value.id;return h&&(s=!0),!h}return u.type!=="EdgeDataUpdated"&&u.type!=="EdgeUpdated"||u.id!==n.value.id}),s||e.push(n);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const s=e.find(u=>u.type===n.type&&u.id===n.id&&u.propertyName===n.propertyName);s?s.newValue=n.newValue:e.push(n);break}case"TreeStructureDetached":e=e.filter(s=>s.type==="TreeStructureAttached"?s.treeKey!==n.treeKey:s.type!=="TreeStructureChanged"||s.treeKey!==n.treeKey),e.push(n);break;case"TreeStructureChanged":{const s=e.find(u=>u.type==="TreeStructureChanged"&&u.treeKey===n.treeKey&&u.nodeId===n.nodeId);s?s.newParentId=n.newParentId:e.push(n);break}default:e.push(n)}}),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some(n=>n.id===t)}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),e==="in"){const n=this.inEdgesMap.get(t);return Array.from(n)}if(e==="out"){const n=this.outEdgesMap.get(t);return Array.from(n)}{const n=this.bothEdgesMap.get(t);return Array.from(n)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map(n=>this.getNode(n.target));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map(n=>this.getNode(n.source));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),n=this.getSuccessors(t);return Array.from(new Set([...e,...n]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach(e=>{e.childrenMap.set(t.id,new Set)}),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch(()=>{for(const e of t)this.doAddNode(e)})}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),n=this.bothEdgesMap.get(t);n==null||n.forEach(s=>this.doRemoveEdge(s.id)),this.nodeMap.delete(t),this.treeIndices.forEach(s=>{var u;(u=s.childrenMap.get(t))==null||u.forEach(h=>{s.parentMap.delete(h.id)}),s.parentMap.delete(t),s.childrenMap.delete(t)}),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch(()=>{t.forEach(e=>this.doRemoveNode(e))})}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,n){const s=this.getNode(t);this.batch(()=>{const u=s.data[e],h=n;s.data[e]=h,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:u,newValue:h})})}mergeNodeData(t,e){this.batch(()=>{Object.entries(e).forEach(([n,s])=>{this.updateNodeDataProperty(t,n,s)})})}updateNodeData(...t){const e=t[0],n=this.getNode(e);if(typeof t[1]=="string")return void this.updateNodeDataProperty(e,t[1],t[2]);let s;if(typeof t[1]=="function"){const u=t[1];s=u(n.data)}else typeof t[1]=="object"&&(s=t[1]);this.batch(()=>{const u=n.data,h=s;n.data=s,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:u,newValue:h})})}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),n=this.outEdgesMap.get(t.source),s=this.bothEdgesMap.get(t.source),u=this.bothEdgesMap.get(t.target);e.add(t),n.add(t),s.add(t),u.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch(()=>{for(const e of t)this.doAddEdge(e)})}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),n=this.outEdgesMap.get(e.source),s=this.inEdgesMap.get(e.target),u=this.bothEdgesMap.get(e.source),h=this.bothEdgesMap.get(e.target);n.delete(e),s.delete(e),u.delete(e),h.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch(()=>{t.forEach(e=>this.doRemoveEdge(e))})}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const n=this.getEdge(t);this.checkNodeExistence(e);const s=n.source,u=e;this.outEdgesMap.get(s).delete(n),this.bothEdgesMap.get(s).delete(n),this.outEdgesMap.get(u).add(n),this.bothEdgesMap.get(u).add(n),n.source=e,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:s,newValue:u})})}updateEdgeTarget(t,e){const n=this.getEdge(t);this.checkNodeExistence(e);const s=n.target,u=e;this.inEdgesMap.get(s).delete(n),this.bothEdgesMap.get(s).delete(n),this.inEdgesMap.get(u).add(n),this.bothEdgesMap.get(u).add(n),n.target=e,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:s,newValue:u})})}updateEdgeDataProperty(t,e,n){const s=this.getEdge(t);this.batch(()=>{const u=s.data[e],h=n;s.data[e]=h,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:u,newValue:h})})}updateEdgeData(...t){const e=t[0],n=this.getEdge(e);if(typeof t[1]=="string")return void this.updateEdgeDataProperty(e,t[1],t[2]);let s;if(typeof t[1]=="function"){const u=t[1];s=u(n.data)}else typeof t[1]=="object"&&(s=t[1]);this.batch(()=>{const u=n.data,h=s;n.data=s,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:u,newValue:h})})}mergeEdgeData(t,e){this.batch(()=>{Object.entries(e).forEach(([n,s])=>{this.updateEdgeDataProperty(t,n,s)})})}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch(()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})}))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch(()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})})}addTree(t,e){this.batch(()=>{this.attachTreeStructure(e);const n=[],s=Array.isArray(t)?t:[t];for(;s.length;){const u=s.shift();n.push(u),u.children&&s.push(...u.children)}this.addNodes(n),n.forEach(u=>{var h;(h=u.children)==null||h.forEach(f=>{this.setParent(f.id,u.id,e)})})})}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter(e=>!this.getParent(e.id,t))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const n=this.treeIndices.get(e).childrenMap.get(t);return Array.from(n||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const n=[];let s,u=this.getNode(t);for(;s=this.getParent(u.id,e);)n.push(s),u=s;return n}setParent(t,e,n){var v;this.checkTreeExistence(n);const s=this.treeIndices.get(n),u=this.getNode(t),h=s.parentMap.get(t),f=this.getNode(e);s.parentMap.set(t,f),h&&((v=s.childrenMap.get(h.id))==null||v.delete(u));let p=s.childrenMap.get(f.id);p||(p=new Set,s.childrenMap.set(f.id,p)),p.add(u),this.batch(()=>{this.changes.push({type:"TreeStructureChanged",treeKey:n,nodeId:t,oldParentId:h==null?void 0:h.id,newParentId:f.id})})}dfsTree(t,e,n){return vr(this.getNode(t),new Set,e,s=>this.getChildren(s,n))}bfsTree(t,e,n){return cn([this.getNode(t)],new Set,e,s=>this.getChildren(s,n))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,n="out"){const s={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];return cn([this.getNode(t)],new Set,e,s)}dfs(t,e,n="out"){const s={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];return vr(this.getNode(t),new Set,e,s)}clone(){const t=this.getAllNodes().map(s=>({...s,data:{...s.data}})),e=this.getAllEdges().map(s=>({...s,data:{...s.data}})),n=new Vt({nodes:t,edges:e});return this.treeIndices.forEach(({parentMap:s,childrenMap:u},h)=>{const f=new Map;s.forEach((v,m)=>{f.set(m,n.getNode(v.id))});const p=new Map;u.forEach((v,m)=>{p.set(m,new Set(Array.from(v).map(b=>n.getNode(b.id))))}),n.treeIndices.set(h,{parentMap:f,childrenMap:p})}),n}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var Ri=function(o,r){if(o!=="next"&&o!=="prev")return r},ln=function(o){o.prev.next=o.next,o.next.prev=o.prev,delete o.next,delete o.prev},Ii=function(o){function r(){return o!==null&&o.apply(this,arguments)||this}return a(r,o),r}(function(){function o(){var r={};r.prev=r,r.next=r.prev,this.shortcut=r}return o.prototype.dequeue=function(){var r=this.shortcut,t=r.prev;if(t&&t!==r)return ln(t),t},o.prototype.enqueue=function(r){var t=this.shortcut;r.prev&&r.next&&ln(r),r.next=t.next,t.next.prev=r,t.next=r,r.prev=t},o.prototype.toString=function(){for(var r=[],t=this.shortcut,e=t.prev;e!==t;)r.push(JSON.stringify(e,Ri)),e=e==null?void 0:e.prev;return"["+r.join(", ")+"]"},o}()),id=function(){return 1},yr=function(o,r,t,e,n){var s,u,h=[];return o.hasNode(e.v)&&((s=o.getRelatedEdges(e.v,"in"))===null||s===void 0||s.forEach(function(f){var p=f.data.weight,v=o.getNode(f.source);n&&h.push({v:f.source,w:f.target,in:0,out:0}),v.data.out===void 0&&(v.data.out=0),v.data.out-=p,mr(r,t,i({v:v.id},v.data))}),(u=o.getRelatedEdges(e.v,"out"))===null||u===void 0||u.forEach(function(f){var p=f.data.weight,v=f.target,m=o.getNode(v);m.data.in===void 0&&(m.data.in=0),m.data.in-=p,mr(r,t,i({v:m.id},m.data))}),o.removeNode(e.v)),n?h:void 0},mr=function(o,r,t){t.out?t.in?o[t.out-t.in+r].enqueue(t):o[o.length-1].enqueue(t):o[0].enqueue(t)},Ti=function(o,r){var t=r==="greedy"?function(e,n){var s;if(e.getAllNodes().length<=1)return[];var u=function(h,f){var p=new Vt,v=0,m=0;h.getAllNodes().forEach(function(N){p.addNode({id:N.id,data:{v:N.id,in:0,out:0}})}),h.getAllEdges().forEach(function(N){var A=p.getRelatedEdges(N.source,"out").find(function(L){return L.target===N.target}),S=(f==null?void 0:f(N))||1;A?p.updateEdgeData(A==null?void 0:A.id,i(i({},A.data),{weight:A.data.weight+S})):p.addEdge({id:N.id,source:N.source,target:N.target,data:{weight:S}}),m=Math.max(m,p.getNode(N.source).data.out+=S),v=Math.max(v,p.getNode(N.target).data.in+=S)});for(var b=[],E=m+v+3,x=0;x<E;x++)b.push(new Ii);var w=v+1;return p.getAllNodes().forEach(function(N){mr(b,w,i({v:N.id},p.getNode(N.id).data))}),{buckets:b,zeroIdx:w,graph:p}}(e,function(h){return h.data.weight||1});return(s=function(h,f,p){for(var v,m=[],b=f[f.length-1],E=f[0];h.getAllNodes().length;){for(;v=E.dequeue();)yr(h,f,p,v);for(;v=b.dequeue();)yr(h,f,p,v);if(h.getAllNodes().length){for(var x=f.length-2;x>0;--x)if(v=f[x].dequeue()){m=m.concat(yr(h,f,p,v,!0));break}}}return m}(u.graph,u.buckets,u.zeroIdx).map(function(h){return e.getRelatedEdges(h.v,"out").filter(function(f){return f.target===h.w})}))===null||s===void 0?void 0:s.flat()}(o):Oi(o);t==null||t.forEach(function(e){var n=e.data;o.removeEdge(e.id),n.forwardName=e.data.name,n.reversed=!0,o.addEdge({id:e.id,source:e.target,target:e.source,data:i({},n)})})},Oi=function(o){var r=[],t={},e={},n=function(s){e[s]||(e[s]=!0,t[s]=!0,o.getRelatedEdges(s,"out").forEach(function(u){t[u.target]?r.push(u):n(u.target)}),delete t[s])};return o.getAllNodes().forEach(function(s){return n(s.id)}),r},Ee=function(o,r,t,e){var n;do n=""+e+Math.random();while(o.hasNode(n));return t.dummy=r,o.addNode({id:n,data:t}),n},fn=function(o){var r=new Vt;return o.getAllNodes().forEach(function(t){o.getChildren(t.id).length||r.addNode(i({},t))}),o.getAllEdges().forEach(function(t){r.addEdge(t)}),r},gn=function(o,r){var t,e,n=Number(o.x),s=Number(o.y),u=Number(r.x)-n,h=Number(r.y)-s,f=Number(o.width)/2,p=Number(o.height)/2;return u||h?(Math.abs(h)*f>Math.abs(u)*p?(h<0&&(p=-p),t=p*u/h,e=p):(u<0&&(f=-f),t=f,e=f*h/u),{x:n+t,y:s+e}):{x:0,y:0}},Le=function(o){for(var r=[],t=vn(o)+1,e=0;e<t;e++)r.push([]);for(o.getAllNodes().forEach(function(n){var s=n.data.rank;s!==void 0&&r[s]&&r[s].push(n.id)}),e=0;e<t;e++)r[e]=r[e].sort(function(n,s){return u=o.getNode(n).data.order,h=o.getNode(s).data.order,Number(u)-Number(h);var u,h});return r},pn=function(o,r,t,e){var n={width:0,height:0};return Q(t)&&Q(e)&&(n.rank=t,n.order=e),Ee(o,"border",n,r)},vn=function(o){var r;return o.getAllNodes().forEach(function(t){var e=t.data.rank;e!==void 0&&(r===void 0||e>r)&&(r=e)}),r||(r=0),r},wr=function(o,r){return o.reduce(function(t,e){return r(t)>r(e)?e:t})},yn=function(o,r,t,e,n,s){e.includes(r.id)||(e.push(r.id),t||s.push(r.id),n(r.id).forEach(function(u){return yn(o,u,t,e,n,s)}),t&&s.push(r.id))},mn=function(o,r,t,e){var n=Array.isArray(r)?r:[r],s=function(f){return e?o.getSuccessors(f):o.getNeighbors(f)},u=[],h=[];return n.forEach(function(f){if(!o.hasNode(f.id))throw new Error("Graph does not have node: "+f);yn(o,f,t==="post",h,s,u)}),u},wn="edge-label",xn=function(o){var r={},t=function(e){var n,s,u=o.getNode(e);return u?r[e]?u.data.rank:(r[e]=!0,(n=o.getRelatedEdges(e,"out"))===null||n===void 0||n.forEach(function(h){var f=t(h.target)-h.data.minlen;f&&(s===void 0||f<s)&&(s=f)}),s||(s=0),u.data.rank=s,s):0};o.getAllNodes().filter(function(e){return o.getRelatedEdges(e.id,"in").length===0}).forEach(function(e){return t(e.id)})},pe=function(o,r){return o.getNode(r.target).data.rank-o.getNode(r.source).data.rank-r.data.minlen},Pi=function(o,r){var t=function(e){r.getRelatedEdges(e,"both").forEach(function(n){var s=n.source,u=e===s?n.target:s;o.hasNode(u)||pe(r,n)||(o.addNode({id:u,data:{}}),o.addEdge({id:n.id,source:e,target:u,data:{}}),t(u))})};return o.getAllNodes().forEach(function(e){return t(e.id)}),o.getAllNodes().length},Li=function(o,r){var t=function(e){var n;(n=r.getRelatedEdges(e,"both"))===null||n===void 0||n.forEach(function(s){var u=s.source,h=e===u?s.target:u;o.hasNode(h)||r.getNode(h).data.layer===void 0&&pe(r,s)||(o.addNode({id:h,data:{}}),o.addEdge({id:s.id,source:e,target:h,data:{}}),t(h))})};return o.getAllNodes().forEach(function(e){return t(e.id)}),o.getAllNodes().length},En=function(o,r){return wr(r.getAllEdges(),function(t){return o.hasNode(t.source)!==o.hasNode(t.target)?pe(r,t):1/0})},bn=function(o,r,t){o.getAllNodes().forEach(function(e){var n=r.getNode(e.id);n.data.rank||(n.data.rank=0),n.data.rank+=t})},Nn=function(o,r){var t=mn(o,o.getAllNodes(),"post",!1);(t=t.slice(0,(t==null?void 0:t.length)-1)).forEach(function(e){Ci(o,r,e)})},Ci=function(o,r,t){var e=o.getNode(t).data.parent;o.getRelatedEdges(t,"both").find(function(n){return n.target===e||n.source===e}).data.cutvalue=Gi(o,r,t)},Gi=function(o,r,t){var e=o.getNode(t).data.parent,n=!0,s=r.getRelatedEdges(t,"out").find(function(h){return h.target===e}),u=0;return s||(n=!1,s=r.getRelatedEdges(e,"out").find(function(h){return h.target===t})),u=s.data.weight,r.getRelatedEdges(t,"both").forEach(function(h){var f=h.source===t,p=f?h.target:h.source;if(p!==e){var v=f===n,m=h.data.weight;if(u+=v?m:-m,Vi(o,t,p)){var b=o.getRelatedEdges(t,"both").find(function(E){return E.source===p||E.target===p}).data.cutvalue;u+=v?-b:b}}}),u},Mn=function(o,r){r===void 0&&(r=o.getAllNodes()[0].id),Sn(o,{},1,r)},Sn=function(o,r,t,e,n){var s,u=t,h=t,f=o.getNode(e);return r[e]=!0,(s=o.getNeighbors(e))===null||s===void 0||s.forEach(function(p){r[p.id]||(h=Sn(o,r,h,p.id,e))}),f.data.low=u,f.data.lim=h++,n?f.data.parent=n:delete f.data.parent,h},$i=function(o){return o.getAllEdges().find(function(r){return r.data.cutvalue<0})},ji=function(o,r,t){var e=t.source,n=t.target;r.getRelatedEdges(e,"out").find(function(v){return v.target===n})||(e=t.target,n=t.source);var s=o.getNode(e),u=o.getNode(n),h=s,f=!1;s.data.lim>u.data.lim&&(h=u,f=!0);var p=r.getAllEdges().filter(function(v){return f===An(o.getNode(v.source),h)&&f!==An(o.getNode(v.target),h)});return wr(p,function(v){return pe(r,v)})},qi=function(o,r,t,e){var n=o.getRelatedEdges(t.source,"both").find(function(s){return s.source===t.target||s.target===t.target});n&&o.removeEdge(n.id),o.addEdge({id:"e"+Math.random(),source:e.source,target:e.target,data:{}}),Mn(o),Nn(o,r),Fi(o,r)},Fi=function(o,r){var t=o.getAllNodes().find(function(n){return!n.data.parent}),e=mn(o,t,"pre",!1);(e=e.slice(1)).forEach(function(n){var s=o.getNode(n).data.parent,u=r.getRelatedEdges(n,"out").find(function(f){return f.target===s}),h=!1;!u&&r.hasNode(s)&&(u=r.getRelatedEdges(s,"out").find(function(f){return f.target===n}),h=!0),r.getNode(n).data.rank=(r.hasNode(s)&&r.getNode(s).data.rank||0)+(h?u==null?void 0:u.data.minlen:-(u==null?void 0:u.data.minlen))})},Vi=function(o,r,t){return o.getRelatedEdges(r,"both").find(function(e){return e.source===t||e.target===t})},An=function(o,r){return r.data.low<=o.data.lim&&o.data.lim<=r.data.lim},Ui=xn,Wi=function(o){(function(r){var t=function(u){var h=new Vt;return u.getAllNodes().forEach(function(f){h.addNode(i({},f))}),u.getAllEdges().forEach(function(f){var p=h.getRelatedEdges(f.source,"out").find(function(v){return v.target===f.target});p?h.updateEdgeData(p==null?void 0:p.id,i(i({},p.data),{weight:p.data.weight+f.data.weight||0,minlen:Math.max(p.data.minlen,f.data.minlen||1)})):h.addEdge({id:f.id,source:f.source,target:f.target,data:{weight:f.data.weight||0,minlen:f.data.minlen||1}})}),h}(r);xn(t);var e,n,s=function(u){var h,f,p=new Vt({tree:[]}),v=u.getAllNodes()[0],m=u.getAllNodes().length;for(p.addNode(v);Pi(p,u)<m;)h=En(p,u),f=p.hasNode(h.source)?pe(u,h):-pe(u,h),bn(p,u,f);return p}(t);for(Mn(s),Nn(s,t);e=$i(s);)n=ji(s,t,e),qi(s,t,e,n)})(o)},kn=function(o,r,t,e,n,s,u){var h=o.getChildren(u);if(h!=null&&h.length){var f=pn(o,"_bt"),p=pn(o,"_bb"),v=o.getNode(u);o.setParent(f,u),v.data.borderTop=f,o.setParent(p,u),v.data.borderBottom=p,h==null||h.forEach(function(m){kn(o,r,t,e,n,s,m.id);var b=m.data.borderTop?m.data.borderTop:m.id,E=m.data.borderBottom?m.data.borderBottom:m.id,x=m.data.borderTop?e:2*e,w=b!==E?1:n-s[u]+1;o.addEdge({id:"e"+Math.random(),source:f,target:b,data:{minlen:w,weight:x,nestingEdge:!0}}),o.addEdge({id:"e"+Math.random(),source:E,target:p,data:{minlen:w,weight:x,nestingEdge:!0}})}),o.getParent(u)||o.addEdge({id:"e"+Math.random(),source:r,target:f,data:{weight:0,minlen:n+s[u]}})}else u!==r&&o.addEdge({id:"e"+Math.random(),source:r,target:u,data:{weight:0,minlen:t}})},_n=function(o,r,t,e,n,s){var u={rank:s,borderType:r,width:0,height:0},h=n.data[r][s-1],f=Ee(o,"border",u,t);n.data[r][s]=f,o.setParent(f,e),h&&o.addEdge({id:"e"+Math.random(),source:h,target:f,data:{weight:1}})},zn=function(o){o.getAllNodes().forEach(function(r){Dn(r)}),o.getAllEdges().forEach(function(r){Dn(r)})},Dn=function(o){var r=o.data.width;o.data.width=o.data.height,o.data.height=r},xr=function(o){o!=null&&o.y&&(o.y=-o.y)},Er=function(o){var r=o.x;o.x=o.y,o.y=r},Rn=function(o){for(var r={},t=o.getAllNodes(),e=t.map(function(p){var v;return(v=p.data.rank)!==null&&v!==void 0?v:-1/0}),n=Math.max.apply(Math,k([],y(e))),s=[],u=0;u<n+1;u++)s.push([]);var h=t.sort(function(p,v){return o.getNode(p.id).data.rank-o.getNode(v.id).data.rank}),f=h.filter(function(p){return o.getNode(p.id).data.fixorder!==void 0}).sort(function(p,v){return o.getNode(p.id).data.fixorder-o.getNode(v.id).data.fixorder});return f==null||f.forEach(function(p){isNaN(o.getNode(p.id).data.rank)||s[o.getNode(p.id).data.rank].push(p.id),r[p.id]=!0}),h==null||h.forEach(function(p){return o.dfsTree(p.id,function(v){if(r.hasOwnProperty(v.id))return!0;r[v.id]=!0,isNaN(v.data.rank)||s[v.data.rank].push(v.id)})}),s},Bi=function(o,r,t){for(var e=function(v,m){return v==null?void 0:v.reduce(function(b,E,x){return b[E]=m[x],b},{})}(t,t.map(function(v,m){return m})),n=r.map(function(v){var m=o.getRelatedEdges(v,"out").map(function(b){return{pos:e[b.target]||0,weight:b.data.weight}});return m==null?void 0:m.sort(function(b,E){return b.pos-E.pos})}),s=n.flat().filter(function(v){return v!==void 0}),u=1;u<t.length;)u<<=1;var h=2*u-1;u-=1;var f=Array(h).fill(0,0,h),p=0;return s==null||s.forEach(function(v){if(v){var m=v.pos+u;f[m]+=v.weight;for(var b=0;m>0;)m%2&&(b+=f[m+1]),f[m=m-1>>1]+=v.weight;p+=v.weight*b}}),p},In=function(o,r){for(var t=0,e=1;e<(r==null?void 0:r.length);e+=1)t+=Bi(o,r[e-1],r[e]);return t},Hi=function(o,r){var t,e=0,n=0;o.weight&&(e+=o.barycenter*o.weight,n+=o.weight),r.weight&&(e+=r.barycenter*r.weight,n+=r.weight),o.vs=(t=r.vs)===null||t===void 0?void 0:t.concat(o.vs),o.barycenter=e/n,o.weight=n,o.i=Math.min(r.i,o.i),r.merged=!0};const Ki=function(o,r){var t,e,n,s={};return o==null||o.forEach(function(u,h){s[u.v]={i:h,indegree:0,in:[],out:[],vs:[u.v]};var f=s[u.v];u.barycenter!==void 0&&(f.barycenter=u.barycenter,f.weight=u.weight)}),(t=r.getAllEdges())===null||t===void 0||t.forEach(function(u){var h=s[u.source],f=s[u.target];h!==void 0&&f!==void 0&&(f.indegree++,h.out.push(s[u.target]))}),function(u){for(var h,f,p=[],v=function(){var E=u.pop();p.push(E),(h=E.in.reverse())===null||h===void 0||h.forEach(function(x){return(w=E,function(N){N.merged||(N.barycenter===void 0||w.barycenter===void 0||N.barycenter>=w.barycenter)&&Hi(w,N)})(x);var w}),(f=E.out)===null||f===void 0||f.forEach(function(x){return(w=E,function(N){N.in.push(w),--N.indegree==0&&u.push(N)})(x);var w})};u!=null&&u.length;)v();var m=p.filter(function(E){return!E.merged}),b=["vs","i","barycenter","weight"];return m.map(function(E){var x={};return b==null||b.forEach(function(w){E[w]!==void 0&&(x[w]=E[w])}),x})}((n=(e=Object.values(s)).filter)===null||n===void 0?void 0:n.call(e,function(u){return!u.indegree}))};var Tn=function(o,r,t){for(var e,n=t;r.length&&(e=r[r.length-1]).i<=n;)r.pop(),o==null||o.push(e.vs),n++;return n},On=function(o,r,t,e,n,s){var u,h,f,p,v=o.getChildren(r).map(function(C){return C.id}),m=o.getNode(r),b=m?m.data.borderLeft:void 0,E=m?m.data.borderRight:void 0,x={};b&&(v=v==null?void 0:v.filter(function(C){return C!==b&&C!==E}));var w=function(C,T){return T.map(function(R){var I=C.getRelatedEdges(R,"in");if(!(I!=null&&I.length))return{v:R};var O={sum:0,weight:0};return I==null||I.forEach(function(G){var M=C.getNode(G.source);O.sum+=G.data.weight*M.data.order,O.weight+=G.data.weight}),{v:R,barycenter:O.sum/O.weight,weight:O.weight}})}(o,v||[]);w==null||w.forEach(function(C){var T;if(!((T=o.getChildren(C.v))===null||T===void 0)&&T.length){var R=On(o,C.v,t,e,s);x[C.v]=R,R.hasOwnProperty("barycenter")&&Qi(C,R)}});var N=Ki(w,t);Yi(N,x),(u=N.filter(function(C){return C.vs.length>0}))===null||u===void 0||u.forEach(function(C){var T=o.getNode(C.vs[0]);T&&(C.fixorder=T.data.fixorder,C.order=T.data.order)});var A=function(C,T,R,I){var O=function(U,K){var J={lhs:[],rhs:[]};return U==null||U.forEach(function(Y){var tt,ot;ot=(tt=Y).hasOwnProperty("fixorder")&&!isNaN(tt.fixorder),(I?!ot&&tt.hasOwnProperty("barycenter"):ot||tt.hasOwnProperty("barycenter"))?J.lhs.push(Y):J.rhs.push(Y)}),J}(C),G=O.lhs,M=O.rhs.sort(function(U,K){return-U.i- -K.i}),z=[],$=0,P=0,B=0;G==null||G.sort(function(U,K){return function(J,Y){if(J.fixorder!==void 0&&Y.fixorder!==void 0)return J.fixorder-Y.fixorder;if(J.barycenter<Y.barycenter)return-1;if(J.barycenter>Y.barycenter)return 1;if(K&&J.order!==void 0&&Y.order!==void 0){if(J.order<Y.order)return-1;if(J.order>Y.order)return 1}return U?Y.i-J.i:J.i-Y.i}}(!!T,!!R)),B=Tn(z,M,B),G==null||G.forEach(function(U){var K;B+=(K=U.vs)===null||K===void 0?void 0:K.length,z.push(U.vs),$+=U.barycenter*U.weight,P+=U.weight,B=Tn(z,M,B)});var W={vs:z.flat()};return P&&(W.barycenter=$/P,W.weight=P),W}(N,e,n,s);if(b&&(A.vs=[b,A.vs,E].flat(),(h=o.getPredecessors(b))===null||h===void 0?void 0:h.length)){var S=o.getNode(((f=o.getPredecessors(b))===null||f===void 0?void 0:f[0].id)||""),L=o.getNode(((p=o.getPredecessors(E))===null||p===void 0?void 0:p[0].id)||"");A.hasOwnProperty("barycenter")||(A.barycenter=0,A.weight=0),A.barycenter=(A.barycenter*A.weight+S.data.order+L.data.order)/(A.weight+2),A.weight+=2}return A},Yi=function(o,r){o==null||o.forEach(function(t){var e,n=(e=t.vs)===null||e===void 0?void 0:e.map(function(s){return r[s]?r[s].vs:s});t.vs=n.flat()})},Qi=function(o,r){o.barycenter!==void 0?(o.barycenter=(o.barycenter*o.weight+r.barycenter*r.weight)/(o.weight+r.weight),o.weight+=r.weight):(o.barycenter=r.barycenter,o.weight=r.weight)},br=function(o){if(typeof o!="object"||o===null)return o;var r,t;if(t=o,Array.isArray?Array.isArray(t):ft(t,"Array")){r=[];for(var e=0,n=o.length;e<n;e++)typeof o[e]=="object"&&o[e]!=null?r[e]=br(o[e]):r[e]=o[e]}else for(var s in r={},o)typeof o[s]=="object"&&o[s]!=null?r[s]=br(o[s]):r[s]=o[s];return r};const Pn=br;var Ln=function(o,r,t){return r.map(function(e){return function(n,s,u){var h=function(p){for(var v;p.hasNode(v="_root"+Math.random()););return v}(n),f=new Vt({tree:[{id:h,children:[],data:{}}]});return n.getAllNodes().forEach(function(p){var v=n.getParent(p.id);(p.data.rank===s||p.data.minRank<=s&&s<=p.data.maxRank)&&(f.hasNode(p.id)||f.addNode(i({},p)),v!=null&&v.id&&!f.hasNode(v==null?void 0:v.id)&&f.addNode(i({},v)),f.setParent(p.id,(v==null?void 0:v.id)||h),n.getRelatedEdges(p.id,u).forEach(function(m){var b=m.source===p.id?m.target:m.source;f.hasNode(b)||f.addNode(i({},n.getNode(b)));var E=f.getRelatedEdges(b,"out").find(function(w){return w.target===p.id}),x=E!==void 0?E.data.weight:0;E?f.updateEdgeData(E.id,i(i({},E.data),{weight:m.data.weight+x})):f.addEdge({id:m.id,source:b,target:p.id,data:{weight:m.data.weight+x}})}),p.data.hasOwnProperty("minRank")&&f.updateNodeData(p.id,i(i({},p.data),{borderLeft:p.data.borderLeft[s],borderRight:p.data.borderRight[s]})))}),f}(o,e,t)})},Cn=function(o,r,t,e){var n=new Vt;o==null||o.forEach(function(s){for(var u,h=s.getRoots()[0].id,f=On(s,h,n,r,t,e),p=0;p<((u=f.vs)===null||u===void 0?void 0:u.length);p++){var v=s.getNode(f.vs[p]);v&&(v.data.order=p)}(function(m,b,E){var x,w={};E==null||E.forEach(function(N){for(var A,S,L=m.getParent(N);L;){if((A=m.getParent(L.id))?(S=w[A.id],w[A.id]=L.id):(S=x,x=L.id),S&&S!==L.id)return b.addNodes([{id:S,data:{}},{id:L.id,data:{}}]),void b.addEdge({id:"e"+S+"-"+L.id,source:S,target:L.id,data:{}});L=A}})})(s,n,f.vs)})},Nr=function(o,r){r==null||r.forEach(function(t){t==null||t.forEach(function(e,n){o.getNode(e).data.order=n})})},Ji=function(o,r){var t={};function e(s,u,h,f,p){for(var v,m,b,E=u;E<h;E++)b=s[E],!((v=o.getNode(b))===null||v===void 0)&&v.data.dummy&&((m=o.getPredecessors(b))===null||m===void 0||m.forEach(function(x){var w=o.getNode(x.id);w.data.dummy&&(w.data.order<f||w.data.order>p)&&Gn(t,x.id,b)}))}function n(s,u){var h=function(f){return JSON.stringify(f.slice(1))}(s);u.get(h)||(e.apply(void 0,k([],y(s))),u.set(h,!0))}return r!=null&&r.length&&r.reduce(function(s,u){var h,f=-1,p=0,v=new Map;return u==null||u.forEach(function(m,b){var E;if(((E=o.getNode(m))===null||E===void 0?void 0:E.data.dummy)==="border"){var x=o.getPredecessors(m)||[];x.length&&(h=o.getNode(x[0].id).data.order,n([u,p,b,f,h],v),p=b,f=h)}n([u,p,u.length,h,s.length],v)}),u}),t},Xi=function(o,r){var t,e;if(!((t=o.getNode(r))===null||t===void 0)&&t.data.dummy)return(e=o.getPredecessors(r))===null||e===void 0?void 0:e.find(function(n){return o.getNode(n.id).data.dummy})},Gn=function(o,r,t){var e=r,n=t;if(e>n){var s=e;e=n,n=s}var u=o[e];u||(o[e]=u={}),u[n]=!0},Zi=function(o,r,t){var e=r;return e>t&&(e=t),!!o[e]},ta=function(o,r,t,e,n,s){var u=new Vt,h=ea(e,n,s);return r==null||r.forEach(function(f){var p;f==null||f.forEach(function(v){var m=t[v];if(u.hasNode(m)||u.addNode({id:m,data:{}}),p){var b=t[p],E=u.getRelatedEdges(b,"out").find(function(x){return x.target===m});E?u.updateEdgeData(E.id,i(i({},E.data),{weight:Math.max(h(o,v,p),E.data.weight||0)})):u.addEdge({id:"e"+Math.random(),source:b,target:m,data:{weight:Math.max(h(o,v,p),0)}})}p=v})}),u},ea=function(o,r,t){return function(e,n,s){var u=e.getNode(n),h=e.getNode(s),f=0,p=0;if(f+=u.data.width/2,u.data.hasOwnProperty("labelpos"))switch((u.data.labelpos||"").toLowerCase()){case"l":p=-u.data.width/2;break;case"r":p=u.data.width/2}if(p&&(f+=t?p:-p),p=0,f+=(u.data.dummy?r:o)/2,f+=(h.data.dummy?r:o)/2,f+=h.data.width/2,h.data.labelpos)switch((h.data.labelpos||"").toLowerCase()){case"l":p=h.data.width/2;break;case"r":p=-h.data.width/2}return p&&(f+=t?p:-p),p=0,f}},ra=function(o,r){return o.getNode(r).data.width||0},na=function(o,r){var t,e=fn(o);(function(s,u){var h=(u||{}).ranksep,f=h===void 0?0:h,p=Le(s),v=0;p==null||p.forEach(function(m){var b=m.map(function(x){return s.getNode(x).data.height}),E=Math.max.apply(Math,k(k([],y(b)),[0]));m==null||m.forEach(function(x){s.getNode(x).data.y=v+E/2}),v+=E+f})})(e,r);var n=function(s,u){var h=u||{},f=h.align,p=h.nodesep,v=p===void 0?0:p,m=h.edgesep,b=m===void 0?0:m,E=Le(s),x=Object.assign(function(S,L){var C={};return L!=null&&L.length&&L.reduce(function(T,R){var I=0,O=0,G=T.length,M=R==null?void 0:R[(R==null?void 0:R.length)-1];return R==null||R.forEach(function(z,$){var P,B=Xi(S,z),W=B?S.getNode(B.id).data.order:G;(B||z===M)&&((P=R.slice(O,$+1))===null||P===void 0||P.forEach(function(U){var K;(K=S.getPredecessors(U))===null||K===void 0||K.forEach(function(J){var Y,tt=S.getNode(J.id),ot=tt.data.order;!(ot<I||W<ot)||tt.data.dummy&&(!((Y=S.getNode(U))===null||Y===void 0)&&Y.data.dummy)||Gn(C,J.id,U)})}),O=$+1,I=W)}),R}),C}(s,E),Ji(s,E)),w={},N=[];["u","d"].forEach(function(S){N=S==="u"?E:Object.values(E).reverse(),["l","r"].forEach(function(L){L==="r"&&(N=N.map(function(I){return Object.values(I).reverse()}));var C=(S==="u"?s.getPredecessors:s.getSuccessors).bind(s),T=function(I,O,G,M){var z={},$={},P={};return O==null||O.forEach(function(B){B==null||B.forEach(function(W,U){z[W]=W,$[W]=W,P[W]=U})}),O==null||O.forEach(function(B){var W=-1;B==null||B.forEach(function(U){var K=M(U).map(function(rt){return rt.id});if(K.length){K=K.sort(function(rt,F){return P[rt]-P[F]});for(var J=(K.length-1)/2,Y=Math.floor(J),tt=Math.ceil(J);Y<=tt;++Y){var ot=K[Y];$[U]===U&&W<P[ot]&&!Zi(G,U,ot)&&($[ot]=U,$[U]=z[U]=z[ot],W=P[ot])}}})}),{root:z,align:$}}(0,N,x,C),R=function(I,O,G,M,z,$,P){var B,W={},U=ta(I,O,G,z,$,P),K=P?"borderLeft":"borderRight",J=function(Y,tt){for(var ot=U.getAllNodes(),rt=ot.pop(),F={};rt;)F[rt.id]?Y(rt.id):(F[rt.id]=!0,ot.push(rt),ot=ot.concat(tt(rt.id))),rt=ot.pop()};return J(function(Y){W[Y]=(U.getRelatedEdges(Y,"in")||[]).reduce(function(tt,ot){return Math.max(tt,(W[ot.source]||0)+ot.data.weight)},0)},U.getPredecessors.bind(U)),J(function(Y){var tt=(U.getRelatedEdges(Y,"out")||[]).reduce(function(rt,F){return Math.min(rt,(W[F.target]||0)-F.data.weight)},Number.POSITIVE_INFINITY),ot=I.getNode(Y);tt!==Number.POSITIVE_INFINITY&&ot.data.borderType!==K&&(W[Y]=Math.max(W[Y],tt))},U.getSuccessors.bind(U)),(B=Object.values(M))===null||B===void 0||B.forEach(function(Y){W[Y]=W[G[Y]]}),W}(s,N,T.root,T.align,v,b,L==="r");L==="r"&&Object.keys(R).forEach(function(I){return R[I]=-R[I]}),w[S+L]=R})});var A=function(S,L){return wr(Object.values(L),function(C){var T,R=Number.NEGATIVE_INFINITY,I=Number.POSITIVE_INFINITY;return(T=Object.keys(C))===null||T===void 0||T.forEach(function(O){var G=C[O],M=ra(S,O)/2;R=Math.max(G+M,R),I=Math.min(G-M,I)}),R-I})}(s,w);return A&&function(S,L){var C=Object.values(L),T=Math.min.apply(Math,k([],y(C))),R=Math.max.apply(Math,k([],y(C)));["u","d"].forEach(function(I){["l","r"].forEach(function(O){var G,M=I+O,z=S[M];if(z!==L){var $=Object.values(z);(G=O==="l"?T-Math.min.apply(Math,k([],y($))):R-Math.max.apply(Math,k([],y($))))&&(S[M]={},Object.keys(z).forEach(function(P){S[M][P]=z[P]+G}))}})})}(w,A),function(S,L){var C={};return Object.keys(S.ul).forEach(function(T){if(L)C[T]=S[L.toLowerCase()][T];else{var R=Object.values(S).map(function(I){return I[T]});C[T]=(R[0]+R[1])/2}}),C}(w,f)}(e,r);(t=Object.keys(n))===null||t===void 0||t.forEach(function(s){e.getNode(s).data.x=n[s]})},oa=function(o,r){var t=r.acyclicer,e=r.ranker,n=r.rankdir,s=n===void 0?"tb":n,u=r.nodeOrder,h=r.keepNodeOrder,f=r.align,p=r.nodesep,v=p===void 0?50:p,m=r.edgesep,b=m===void 0?20:m,E=r.ranksep,x=E===void 0?50:E;ya(o),Ti(o,t);var w=function(R){var I=Ee(R,"root",{},"_root"),O=function(P){var B={},W=function(U,K){var J=P.getChildren(U);J==null||J.forEach(function(Y){return W(Y.id,K+1)}),B[U]=K};return P.getRoots().forEach(function(U){return W(U.id,1)}),B}(R),G=Math.max.apply(Math,k([],y(Object.values(O))));Math.abs(G)===1/0&&(G=1);var M=G-1,z=2*M+1;R.getAllEdges().forEach(function(P){P.data.minlen*=z});var $=function(P){var B=0;return P.getAllEdges().forEach(function(W){B+=W.data.weight}),B}(R)+1;return R.getRoots().forEach(function(P){kn(R,I,z,$,M,O,P.id)}),{nestingRoot:I,nodeRankFactor:z}}(o),N=w.nestingRoot,A=w.nodeRankFactor;(function(R,I){switch(I){case"network-simplex":Wi(R);break;case"tight-tree":default:(function(O){(function(G){var M,z={},$=function(W){var U,K,J=G.getNode(W);return J?z[W]?J.data.rank:(z[W]=!0,(U=G.getRelatedEdges(W,"out"))===null||U===void 0||U.forEach(function(Y){var tt=$(Y.target)-Y.data.minlen;tt&&(K===void 0||tt<K)&&(K=tt)}),K||(K=0),(M===void 0||K<M)&&(M=K),J.data.rank=K,K):0};G.getAllNodes().filter(function(W){return G.getRelatedEdges(W.id,"in").length===0}).forEach(function(W){W&&$(W.id)}),M===void 0&&(M=0);var P={},B=function(W,U){var K,J=G.getNode(W),Y=isNaN(J.data.layer)?U:J.data.layer;(J.data.rank===void 0||J.data.rank<Y)&&(J.data.rank=Y),P[W]||(P[W]=!0,(K=G.getRelatedEdges(W,"out"))===null||K===void 0||K.forEach(function(tt){B(tt.target,Y+tt.data.minlen)}))};G.getAllNodes().forEach(function(W){var U=W.data;U&&(isNaN(U.layer)?U.rank-=M:B(W.id,U.layer))})})(O),function(G){var M,z,$=new Vt({tree:[]}),P=G.getAllNodes()[0],B=G.getAllNodes().length;for($.addNode(P);Li($,G)<B;)M=En($,G),z=$.hasNode(M.source)?pe(G,M):-pe(G,M),bn($,G,z)}(O)})(R);break;case"longest-path":Ui(R)}})(fn(o),e),da(o),function(R,I){I===void 0&&(I=0);var O=R.getAllNodes(),G=O.filter(function(W){return W.data.rank!==void 0}).map(function(W){return W.data.rank}),M=Math.min.apply(Math,k([],y(G))),z=[];O.forEach(function(W){var U=(W.data.rank||0)-M;z[U]||(z[U]=[]),z[U].push(W.id)});for(var $=0,P=0;P<z.length;P++){var B=z[P];B===void 0?P%I!=0&&($-=1):$&&(B==null||B.forEach(function(W){var U=R.getNode(W);U&&(U.data.rank=U.data.rank||0,U.data.rank+=$)}))}}(o,A),function(R,I){I&&R.removeNode(I),R.getAllEdges().forEach(function(O){O.data.nestingEdge&&R.removeEdge(O.id)})}(o,N),function(R){var I=R.getAllNodes().filter(function(G){return G.data.rank!==void 0}).map(function(G){return G.data.rank}),O=Math.min.apply(Math,k([],y(I)));R.getAllNodes().forEach(function(G){G.data.hasOwnProperty("rank")&&O!==1/0&&(G.data.rank-=O)})}(o),ha(o),ca(o);var S=[];(function(R,I){R.getAllEdges().forEach(function(O){return function(G,M,z){var $=M.source,P=G.getNode($).data.rank,B=M.target,W=G.getNode(B).data.rank,U=M.data.labelRank;if(W!==P+1){var K,J,Y;for(G.removeEdge(M.id),Y=0,++P;P<W;++Y,++P)M.data.points=[],K=Ee(G,"edge",J={originalEdge:M,width:0,height:0,rank:P},"_d"),P===U&&(J.width=M.data.width,J.height=M.data.height,J.dummy=wn,J.labelpos=M.data.labelpos),G.addEdge({id:"e"+Math.random(),source:$,target:K,data:{weight:M.data.weight}}),Y===0&&z.push(K),$=K;G.addEdge({id:"e"+Math.random(),source:$,target:B,data:{weight:M.data.weight}})}}(R,O,I)})})(o,S),function(R,I){var O=function(G){var M={},z=0,$=function(P){var B=z;G.getChildren(P).forEach(function(W){return $(W.id)}),M[P]={low:B,lim:z++}};return G.getRoots().forEach(function(P){return $(P.id)}),M}(R);I.forEach(function(G){var M,z,$=G,P=R.getNode($),B=P.data.originalEdge;if(B)for(var W=function(ot,rt,F,Z){var ut,nt,H,ht,Et=[],mt=[],Gt=Math.min(rt[F].low,rt[Z].low),Dt=Math.max(rt[F].lim,rt[Z].lim);H=F;do H=(ut=ot.getParent(H))===null||ut===void 0?void 0:ut.id,Et.push(H);while(H&&(rt[H].low>Gt||Dt>rt[H].lim));for(ht=H,H=Z;H&&H!==ht;)mt.push(H),H=(nt=ot.getParent(H))===null||nt===void 0?void 0:nt.id;return{lca:ht,path:Et.concat(mt.reverse())}}(R,O,B.source,B.target),U=W.path,K=W.lca,J=0,Y=U[J],tt=!0;$!==B.target;){if(P=R.getNode($),tt){for(;Y!==K&&((M=R.getNode(Y))===null||M===void 0?void 0:M.data.maxRank)<P.data.rank;)Y=U[++J];Y===K&&(tt=!1)}if(!tt){for(;J<U.length-1&&((z=R.getNode(U[J+1]))===null||z===void 0?void 0:z.data.minRank)<=P.data.rank;)J++;Y=U[J]}R.hasNode(Y)&&R.setParent($,Y),$=R.getSuccessors($)[0].id}})}(o,S),function(R){var I=function(O){var G=R.getChildren(O),M=R.getNode(O);if(G!=null&&G.length&&G.forEach(function(P){return I(P.id)}),M.data.hasOwnProperty("minRank")){M.data.borderLeft=[],M.data.borderRight=[];for(var z=M.data.minRank,$=M.data.maxRank+1;z<$;z+=1)_n(R,"borderLeft","_bl",O,M,z),_n(R,"borderRight","_br",O,M,z)}};R.getRoots().forEach(function(O){return I(O.id)})}(o),h&&function(R,I){for(var O=R.getAllNodes().filter(function($){var P;return!(!((P=R.getChildren($.id))===null||P===void 0)&&P.length)}).map(function($){return $.data.rank}),G=Math.max.apply(Math,k([],y(O))),M=[],z=0;z<G+1;z++)M[z]=[];I==null||I.forEach(function($){var P=R.getNode($);P&&!P.data.dummy&&(isNaN(P.data.rank)||(P.data.fixorder=M[P.data.rank].length,M[P.data.rank].push($)))})}(o,u),function(R,I){for(var O=vn(R),G=[],M=[],z=1;z<O+1;z++)G.push(z);for(z=O-1;z>-1;z--)M.push(z);var $=Ln(R,G,"in"),P=Ln(R,M,"out"),B=Rn(R);Nr(R,B);for(var W,U=Number.POSITIVE_INFINITY,K=(z=0,0);K<4;++z,++K)Cn(z%2?$:P,z%4>=2,!1,I),B=Le(R),(J=In(R,B))<U&&(K=0,W=Pn(B),U=J);for(B=Rn(R),Nr(R,B),z=0,K=0;K<4;++z,++K){var J;Cn(z%2?$:P,z%4>=2,!0,I),B=Le(R),(J=In(R,B))<U&&(K=0,W=Pn(B),U=J)}Nr(R,W)}(o,h),ma(o),function(R,I){var O=I.toLowerCase();O!=="lr"&&O!=="rl"||zn(R)}(o,s),na(o,{align:f,nodesep:v,edgesep:b,ranksep:x}),wa(o),va(o),function(R,I){I.forEach(function(O){var G,M=R.getNode(O),z=M.data.originalEdge;z&&R.addEdge(z);for(var $=O;M.data.dummy;)G=R.getSuccessors($)[0],R.removeNode($),z.data.points.push({x:M.data.x,y:M.data.y}),M.data.dummy===wn&&(z.data.x=M.data.x,z.data.y=M.data.y,z.data.width=M.data.width,z.data.height=M.data.height),$=G.id,M=R.getNode($)})}(o,S),ga(o),function(R,I){var O=I.toLowerCase();O!=="bt"&&O!=="rl"||function(G){G.getAllNodes().forEach(function(M){xr(M.data)}),G.getAllEdges().forEach(function(M){var z;(z=M.data.points)===null||z===void 0||z.forEach(function($){return xr($)}),M.data.hasOwnProperty("y")&&xr(M.data)})}(R),O!=="lr"&&O!=="rl"||(function(G){G.getAllNodes().forEach(function(M){Er(M.data)}),G.getAllEdges().forEach(function(M){var z;(z=M.data.points)===null||z===void 0||z.forEach(function($){return Er($)}),M.data.hasOwnProperty("x")&&Er(M.data)})}(R),zn(R))}(o,s);var L=la(o),C=L.width,T=L.height;return fa(o),pa(o),function(R){R.getAllEdges().forEach(function(I){var O=I.data;if(O.reversed){R.removeEdge(I.id);var G=O.forwardName;delete O.reversed,delete O.forwardName,R.addEdge({id:I.id,source:I.target,target:I.source,data:i(i({},O),{forwardName:G})})}})}(o),{width:C,height:T}},ia=["width","height","layer","fixorder"],aa={width:0,height:0},sa=["minlen","weight","width","height","labeloffset"],ua={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},$n=["labelpos"],da=function(o){o.getAllEdges().forEach(function(r){if(r.data.width&&r.data.height){var t=o.getNode(r.source),e={e:r,rank:(o.getNode(r.target).data.rank-t.data.rank)/2+t.data.rank};Ee(o,"edge-proxy",e,"_ep")}})},ha=function(o){var r=0;return o.getAllNodes().forEach(function(t){var e,n;t.data.borderTop&&(t.data.minRank=(e=o.getNode(t.data.borderTop))===null||e===void 0?void 0:e.data.rank,t.data.maxRank=(n=o.getNode(t.data.borderBottom))===null||n===void 0?void 0:n.data.rank,r=Math.max(r,t.data.maxRank||-1/0))}),r},ca=function(o){o.getAllNodes().forEach(function(r){r.data.dummy==="edge-proxy"&&(o.getEdge(r.data.e.id).data.labelRank=r.data.rank,o.removeNode(r.id))})},la=function(o,r){var t,e,n=0,s=0,u=r||{},h=u.marginx,f=h===void 0?0:h,p=u.marginy,v=p===void 0?0:p,m=function(b){if(b.data){var E=b.data.x,x=b.data.y,w=b.data.width,N=b.data.height;isNaN(E)||isNaN(w)||(t===void 0&&(t=E-w/2),t=Math.min(t,E-w/2),n=Math.max(n,E+w/2)),isNaN(x)||isNaN(N)||(e===void 0&&(e=x-N/2),e=Math.min(e,x-N/2),s=Math.max(s,x+N/2))}};return o.getAllNodes().forEach(function(b){m(b)}),o.getAllEdges().forEach(function(b){b!=null&&b.data.hasOwnProperty("x")&&m(b)}),t-=f,e-=v,o.getAllNodes().forEach(function(b){b.data.x-=t,b.data.y-=e}),o.getAllEdges().forEach(function(b){var E;(E=b.data.points)===null||E===void 0||E.forEach(function(x){x.x-=t,x.y-=e}),b.data.hasOwnProperty("x")&&(b.data.x-=t),b.data.hasOwnProperty("y")&&(b.data.y-=e)}),{width:n-t+f,height:s-e+v}},fa=function(o){o.getAllEdges().forEach(function(r){var t,e,n=o.getNode(r.source),s=o.getNode(r.target);r.data.points?(t=r.data.points[0],e=r.data.points[r.data.points.length-1]):(r.data.points=[],t={x:s.data.x,y:s.data.y},e={x:n.data.x,y:n.data.y}),r.data.points.unshift(gn(n.data,t)),r.data.points.push(gn(s.data,e))})},ga=function(o){o.getAllEdges().forEach(function(r){if(r.data.hasOwnProperty("x"))switch(r.data.labelpos!=="l"&&r.data.labelpos!=="r"||(r.data.width-=r.data.labeloffset),r.data.labelpos){case"l":r.data.x-=r.data.width/2+r.data.labeloffset;break;case"r":r.data.x+=r.data.width/2+r.data.labeloffset}})},pa=function(o){o.getAllEdges().forEach(function(r){var t;r.data.reversed&&((t=r.data.points)===null||t===void 0||t.reverse())})},va=function(o){o.getAllNodes().forEach(function(r){var t,e,n;if(!((t=o.getChildren(r.id))===null||t===void 0)&&t.length){var s=o.getNode(r.id),u=o.getNode(s.data.borderTop),h=o.getNode(s.data.borderBottom),f=o.getNode(s.data.borderLeft[((e=s.data.borderLeft)===null||e===void 0?void 0:e.length)-1]),p=o.getNode(s.data.borderRight[((n=s.data.borderRight)===null||n===void 0?void 0:n.length)-1]);s.data.width=Math.abs((p==null?void 0:p.data.x)-(f==null?void 0:f.data.x))||10,s.data.height=Math.abs((h==null?void 0:h.data.y)-(u==null?void 0:u.data.y))||10,s.data.x=((f==null?void 0:f.data.x)||0)+s.data.width/2,s.data.y=((u==null?void 0:u.data.y)||0)+s.data.height/2}}),o.getAllNodes().forEach(function(r){r.data.dummy==="border"&&o.removeNode(r.id)})},ya=function(o){o.getAllEdges().forEach(function(r){if(r.source===r.target){var t=o.getNode(r.source);t.data.selfEdges||(t.data.selfEdges=[]),t.data.selfEdges.push(r),o.removeEdge(r.id)}})},ma=function(o){var r=Le(o);r==null||r.forEach(function(t){var e=0;t==null||t.forEach(function(n,s){var u,h=o.getNode(n);h.data.order=s+e,(u=h.data.selfEdges)===null||u===void 0||u.forEach(function(f){Ee(o,"selfedge",{width:f.data.width,height:f.data.height,rank:h.data.rank,order:s+ ++e,e:f},"_se")}),delete h.data.selfEdges})})},wa=function(o){o.getAllNodes().forEach(function(r){var t=o.getNode(r.id);if(t.data.dummy==="selfedge"){var e=o.getNode(t.data.e.source),n=e.data.x+e.data.width/2,s=e.data.y,u=t.data.x-n,h=e.data.height/2;o.hasEdge(t.data.e.id)?o.updateEdgeData(t.data.e.id,t.data.e.data):o.addEdge({id:t.data.e.id,source:t.data.e.source,target:t.data.e.target,data:t.data.e.data}),o.removeNode(r.id),t.data.e.data.points=[{x:n+2*u/3,y:s-h},{x:n+5*u/6,y:s-h},{y:s,x:n+u},{x:n+5*u/6,y:s+h},{x:n+2*u/3,y:s+h}],t.data.e.data.x=t.data.x,t.data.e.data.y=t.data.y}})},jn=function(o,r){var t={};return r==null||r.forEach(function(e){o[e]!==void 0&&(t[e]=+o[e])}),t},qn=function(o){o===void 0&&(o={});var r={};return Object.keys(o).forEach(function(t){r[t.toLowerCase()]=o[t]}),r},xa={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},Fn=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="dagre",this.layoutNode=function(t){return t.data.layout},this.options=i(i({},xa),r)}return o.prototype.execute=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return[2,this.genericDagreLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){switch(e.label){case 0:return[4,this.genericDagreLayout(!0,r,t)];case 1:return e.sent(),[2]}})})},o.prototype.genericDagreLayout=function(r,t,e){return c(this,void 0,void 0,function(){var n,s,u,h,f,p,v,m,b,E,x,w,N,A,S,L,C,T,R,I,O,G,M,z,$,P,B,W,U,K,J,Y,tt,ot=this;return g(this,function(rt){return n=i(i({},this.options),e),s=n.nodeSize,u=n.align,h=n.rankdir,f=h===void 0?"TB":h,p=n.ranksep,v=n.nodesep,m=n.ranksepFunc,b=n.nodesepFunc,E=n.edgeLabelSpace,x=n.nodeOrder,w=n.begin,N=n.controlPoints,A=n.radial,S=new Vt({tree:[]}),L=Jt(p||50,m),C=Jt(v||50,b),T=C,R=L,f!=="LR"&&f!=="RL"||(T=L,R=C),I=cr(s,void 0),O=t.getAllNodes(),G=t.getAllEdges(),O.filter(function(F){return F.data.layout}).forEach(function(F){var Z=I(F),ut=R(F),nt=Z+2*T(F),H=Z+2*ut,ht=F.data.layer;Q(ht)?S.addNode({id:F.id,data:{width:nt,height:H,layer:ht}}):S.addNode({id:F.id,data:{width:nt,height:H}})}),G.forEach(function(F){ot.layoutNode(S.getNode(F.source))&&ot.layoutNode(S.getNode(F.target))&&S.addEdge({id:F.id,source:F.source,target:F.target,data:{weight:F.data.weight||1}})}),function(F,Z){var ut,nt,H=Z.edgeLabelSpace,ht=Z.keepNodeOrder,Et=Z.prevGraph,mt=Z.rankdir,Gt=Z.ranksep;!ht&&Et&&(nt=Et,(ut=F).getAllNodes().forEach(function(wt){var vt=ut.getNode(wt.id),pt=nt.getNode(wt.id);pt!==void 0?(vt.data.fixorder=pt.data._order,delete pt.data._order):delete vt.data.fixorder}));var Dt=function(wt){var vt=new Vt({tree:[]});return wt.getAllNodes().forEach(function(pt){var Ot=qn(wt.getNode(pt.id).data),St=i(i({},aa),Ot),At=jn(St,ia);vt.hasNode(pt.id)||vt.addNode({id:pt.id,data:i({},At)});var Bt=wt.getParent(pt.id);Bt==null||(vt.hasNode(Bt.id)||vt.addNode(i({},Bt)),vt.setParent(pt.id,Bt.id))}),wt.getAllEdges().forEach(function(pt){var Ot=qn(wt.getEdge(pt.id).data),St={};$n==null||$n.forEach(function(At){Ot[At]!==void 0&&(St[At]=Ot[At])}),vt.addEdge({id:pt.id,source:pt.source,target:pt.target,data:Object.assign({},ua,jn(Ot,sa),St)})}),vt}(F);H&&(Z.ranksep=function(wt,vt){var pt=vt.ranksep,Ot=pt===void 0?0:pt,St=vt.rankdir;return wt.getAllNodes().forEach(function(At){isNaN(At.data.layer)||At.data.layer||(At.data.layer=0)}),wt.getAllEdges().forEach(function(At){var Bt;At.data.minlen*=2,((Bt=At.data.labelpos)===null||Bt===void 0?void 0:Bt.toLowerCase())!=="c"&&(St==="TB"||St==="BT"?At.data.width+=At.data.labeloffset:At.data.height+=At.data.labeloffset)}),Ot/2}(Dt,{rankdir:mt,ranksep:Gt}));try{oa(Dt,Z)}catch(wt){if(wt.message==="Not possible to find intersection inside of the rectangle")return void console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,wt);throw wt}(function(wt,vt){wt.getAllNodes().forEach(function(pt){var Ot,St=wt.getNode(pt.id);if(St){var At=vt.getNode(pt.id);St.data.x=At.data.x,St.data.y=At.data.y,St.data._order=At.data.order,St.data._rank=At.data.rank,!((Ot=vt.getChildren(pt.id))===null||Ot===void 0)&&Ot.length&&(St.data.width=At.data.width,St.data.height=At.data.height)}}),wt.getAllEdges().forEach(function(pt){var Ot=wt.getEdge(pt.id),St=vt.getEdge(pt.id);Ot.data.points=St?St.data.points:[],St&&St.data.hasOwnProperty("x")&&(Ot.data.x=St.data.x,Ot.data.y=St.data.y)})})(F,Dt)}(S,{prevGraph:null,edgeLabelSpace:E,keepNodeOrder:!!x,nodeOrder:x||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:f,nodesep:v,align:u}),M=[0,0],w&&(z=1/0,$=1/0,S.getAllNodes().forEach(function(F){z>F.data.x&&(z=F.data.x),$>F.data.y&&($=F.data.y)}),S.getAllEdges().forEach(function(F){var Z;(Z=F.data.points)===null||Z===void 0||Z.forEach(function(ut){z>ut.x&&(z=ut.x),$>ut.y&&($=ut.y)})}),M[0]=w[0]-z,M[1]=w[1]-$),P=f==="LR"||f==="RL",A||(B=new Set,W=f==="BT"||f==="RL"?function(F,Z){return Z-F}:function(F,Z){return F-Z},S.getAllNodes().forEach(function(F){F.data.x=F.data.x+M[0],F.data.y=F.data.y+M[1],B.add(P?F.data.x:F.data.y)}),U=Array.from(B).sort(W),K=P?function(F,Z){return F.x!==Z.x}:function(F,Z){return F.y!==Z.y},J=P?function(F,Z,ut){var nt=Math.max(Z.y,ut.y),H=Math.min(Z.y,ut.y);return F.filter(function(ht){return ht.y<=nt&&ht.y>=H})}:function(F,Z,ut){var nt=Math.max(Z.x,ut.x),H=Math.min(Z.x,ut.x);return F.filter(function(ht){return ht.x<=nt&&ht.x>=H})},S.getAllEdges().forEach(function(F,Z){var ut;E&&N&&F.data.type!=="loop"&&(F.data.controlPoints=Ea((ut=F.data.points)===null||ut===void 0?void 0:ut.map(function(nt){var H=nt.x,ht=nt.y;return{x:H+M[0],y:ht+M[1]}}),S.getNode(F.source),S.getNode(F.target),U,P,K,J))})),Y=[],Y=S.getAllNodes().map(function(F){return xt(F)}),tt=S.getAllEdges(),r&&(Y.forEach(function(F){t.mergeNodeData(F.id,{x:F.data.x,y:F.data.y})}),tt.forEach(function(F){t.mergeEdgeData(F.id,{controlPoints:F.data.controlPoints})})),[2,{nodes:Y,edges:tt}]})})},o}(),Ea=function(o,r,t,e,n,s,u){var h=(o==null?void 0:o.slice(1,o.length-1))||[];if(r&&t){var f=r.data,p=f.x,v=f.y,m=t.data,b=m.x,E=m.y;if(n&&(p=r.data.y,v=r.data.x,b=t.data.y,E=t.data.x),E!==v&&p!==b){var x=e.indexOf(v),w=e[x+1];if(w){var N=h[0],A=n?{x:(v+w)/2,y:(N==null?void 0:N.y)||b}:{x:(N==null?void 0:N.x)||b,y:(v+w)/2};N&&!s(N,A)||h.unshift(A)}var S=e.indexOf(E),L=Math.abs(S-x);if(L===1)(h=u(h,r.data,t.data)).length||h.push(n?{x:(v+E)/2,y:p}:{x:p,y:(v+E)/2});else if(L>1){var C=e[S-1];if(C){var T=h[h.length-1],R=n?{x:(E+C)/2,y:(T==null?void 0:T.y)||b}:{x:(T==null?void 0:T.x)||p,y:(E+C)/2};T&&!s(T,R)||h.push(R)}}}}return h};function Vn(o,r,t,e,n){if(isNaN(r)||isNaN(t)||isNaN(e))return o;var s,u,h,f,p,v,m,b,E,x,w,N,A=o._root,S={data:n},L=o._x0,C=o._y0,T=o._z0,R=o._x1,I=o._y1,O=o._z1;if(!A)return o._root=S,o;for(;A.length;)if((b=r>=(u=(L+R)/2))?L=u:R=u,(E=t>=(h=(C+I)/2))?C=h:I=h,(x=e>=(f=(T+O)/2))?T=f:O=f,s=A,!(A=A[w=x<<2|E<<1|b]))return s[w]=S,o;if(p=+o._x.call(null,A.data),v=+o._y.call(null,A.data),m=+o._z.call(null,A.data),r===p&&t===v&&e===m)return S.next=A,s?s[w]=S:o._root=S,o;do s=s?s[w]=new Array(8):o._root=new Array(8),(b=r>=(u=(L+R)/2))?L=u:R=u,(E=t>=(h=(C+I)/2))?C=h:I=h,(x=e>=(f=(T+O)/2))?T=f:O=f;while((w=x<<2|E<<1|b)==(N=(m>=f)<<2|(v>=h)<<1|p>=u));return s[N]=A,s[w]=S,o}function Mt(o,r,t,e,n,s,u){this.node=o,this.x0=r,this.y0=t,this.z0=e,this.x1=n,this.y1=s,this.z1=u}function ba(o){return o[0]}function Na(o){return o[1]}function Ma(o){return o[2]}function Un(o,r,t,e){var n=new Mr(r??ba,t??Na,e??Ma,NaN,NaN,NaN,NaN,NaN,NaN);return o==null?n:n.addAll(o)}function Mr(o,r,t,e,n,s,u,h,f){this._x=o,this._y=r,this._z=t,this._x0=e,this._y0=n,this._z0=s,this._x1=u,this._y1=h,this._z1=f,this._root=void 0}function Wn(o){for(var r={data:o.data},t=r;o=o.next;)t=t.next={data:o.data};return r}var Ct=Un.prototype=Mr.prototype;function Sa(o){var r=0,t=0,e=0,n=0,s=o.length;if(s){for(var u=0;u<s;u++)(h=o[u])&&h.weight&&(r+=h.weight,t+=h.x*h.weight,e+=h.y*h.weight,n+=h.z*h.weight);o.x=t/r,o.y=e/r,o.z=n/r,o.weight=r}else{var h=o;o.x=h.data.x,o.y=h.data.y,o.z=h.data.z,o.weight=h.data.weight}}Ct.copy=function(){var o,r,t=new Mr(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root;if(!e)return t;if(!e.length)return t._root=Wn(e),t;for(o=[{source:e,target:t._root=new Array(8)}];e=o.pop();)for(var n=0;n<8;++n)(r=e.source[n])&&(r.length?o.push({source:r,target:e.target[n]=new Array(8)}):e.target[n]=Wn(r));return t},Ct.add=function(o){const r=+this._x.call(null,o),t=+this._y.call(null,o),e=+this._z.call(null,o);return Vn(this.cover(r,t,e),r,t,e,o)},Ct.addAll=function(o){Array.isArray(o)||(o=Array.from(o));const r=o.length,t=new Float64Array(r),e=new Float64Array(r),n=new Float64Array(r);let s=1/0,u=1/0,h=1/0,f=-1/0,p=-1/0,v=-1/0;for(let m,b,E,x,w=0;w<r;++w)isNaN(b=+this._x.call(null,m=o[w]))||isNaN(E=+this._y.call(null,m))||isNaN(x=+this._z.call(null,m))||(t[w]=b,e[w]=E,n[w]=x,b<s&&(s=b),b>f&&(f=b),E<u&&(u=E),E>p&&(p=E),x<h&&(h=x),x>v&&(v=x));if(s>f||u>p||h>v)return this;this.cover(s,u,h).cover(f,p,v);for(let m=0;m<r;++m)Vn(this,t[m],e[m],n[m],o[m]);return this},Ct.cover=function(o,r,t){if(isNaN(o=+o)||isNaN(r=+r)||isNaN(t=+t))return this;var e=this._x0,n=this._y0,s=this._z0,u=this._x1,h=this._y1,f=this._z1;if(isNaN(e))u=(e=Math.floor(o))+1,h=(n=Math.floor(r))+1,f=(s=Math.floor(t))+1;else{for(var p,v,m=u-e||1,b=this._root;e>o||o>=u||n>r||r>=h||s>t||t>=f;)switch(v=(t<s)<<2|(r<n)<<1|o<e,(p=new Array(8))[v]=b,b=p,m*=2,v){case 0:u=e+m,h=n+m,f=s+m;break;case 1:e=u-m,h=n+m,f=s+m;break;case 2:u=e+m,n=h-m,f=s+m;break;case 3:e=u-m,n=h-m,f=s+m;break;case 4:u=e+m,h=n+m,s=f-m;break;case 5:e=u-m,h=n+m,s=f-m;break;case 6:u=e+m,n=h-m,s=f-m;break;case 7:e=u-m,n=h-m,s=f-m}this._root&&this._root.length&&(this._root=b)}return this._x0=e,this._y0=n,this._z0=s,this._x1=u,this._y1=h,this._z1=f,this},Ct.data=function(){var o=[];return this.visit(function(r){if(!r.length)do o.push(r.data);while(r=r.next)}),o},Ct.extent=function(o){return arguments.length?this.cover(+o[0][0],+o[0][1],+o[0][2]).cover(+o[1][0],+o[1][1],+o[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},Ct.find=function(o,r,t,e){var n,s,u,h,f,p,v,m,b,E=this._x0,x=this._y0,w=this._z0,N=this._x1,A=this._y1,S=this._z1,L=[],C=this._root;for(C&&L.push(new Mt(C,E,x,w,N,A,S)),e==null?e=1/0:(E=o-e,x=r-e,w=t-e,N=o+e,A=r+e,S=t+e,e*=e);m=L.pop();)if(!(!(C=m.node)||(s=m.x0)>N||(u=m.y0)>A||(h=m.z0)>S||(f=m.x1)<E||(p=m.y1)<x||(v=m.z1)<w))if(C.length){var T=(s+f)/2,R=(u+p)/2,I=(h+v)/2;L.push(new Mt(C[7],T,R,I,f,p,v),new Mt(C[6],s,R,I,T,p,v),new Mt(C[5],T,u,I,f,R,v),new Mt(C[4],s,u,I,T,R,v),new Mt(C[3],T,R,h,f,p,I),new Mt(C[2],s,R,h,T,p,I),new Mt(C[1],T,u,h,f,R,I),new Mt(C[0],s,u,h,T,R,I)),(b=(t>=I)<<2|(r>=R)<<1|o>=T)&&(m=L[L.length-1],L[L.length-1]=L[L.length-1-b],L[L.length-1-b]=m)}else{var O=o-+this._x.call(null,C.data),G=r-+this._y.call(null,C.data),M=t-+this._z.call(null,C.data),z=O*O+G*G+M*M;if(z<e){var $=Math.sqrt(e=z);E=o-$,x=r-$,w=t-$,N=o+$,A=r+$,S=t+$,n=C.data}}return n},Ct.remove=function(o){if(isNaN(s=+this._x.call(null,o))||isNaN(u=+this._y.call(null,o))||isNaN(h=+this._z.call(null,o)))return this;var r,t,e,n,s,u,h,f,p,v,m,b,E,x,w,N=this._root,A=this._x0,S=this._y0,L=this._z0,C=this._x1,T=this._y1,R=this._z1;if(!N)return this;if(N.length)for(;;){if((m=s>=(f=(A+C)/2))?A=f:C=f,(b=u>=(p=(S+T)/2))?S=p:T=p,(E=h>=(v=(L+R)/2))?L=v:R=v,r=N,!(N=N[x=E<<2|b<<1|m]))return this;if(!N.length)break;(r[x+1&7]||r[x+2&7]||r[x+3&7]||r[x+4&7]||r[x+5&7]||r[x+6&7]||r[x+7&7])&&(t=r,w=x)}for(;N.data!==o;)if(e=N,!(N=N.next))return this;return(n=N.next)&&delete N.next,e?(n?e.next=n:delete e.next,this):r?(n?r[x]=n:delete r[x],(N=r[0]||r[1]||r[2]||r[3]||r[4]||r[5]||r[6]||r[7])&&N===(r[7]||r[6]||r[5]||r[4]||r[3]||r[2]||r[1]||r[0])&&!N.length&&(t?t[w]=N:this._root=N),this):(this._root=n,this)},Ct.removeAll=function(o){for(var r=0,t=o.length;r<t;++r)this.remove(o[r]);return this},Ct.root=function(){return this._root},Ct.size=function(){var o=0;return this.visit(function(r){if(!r.length)do++o;while(r=r.next)}),o},Ct.visit=function(o){var r,t,e,n,s,u,h,f,p=[],v=this._root;for(v&&p.push(new Mt(v,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));r=p.pop();)if(!o(v=r.node,e=r.x0,n=r.y0,s=r.z0,u=r.x1,h=r.y1,f=r.z1)&&v.length){var m=(e+u)/2,b=(n+h)/2,E=(s+f)/2;(t=v[7])&&p.push(new Mt(t,m,b,E,u,h,f)),(t=v[6])&&p.push(new Mt(t,e,b,E,m,h,f)),(t=v[5])&&p.push(new Mt(t,m,n,E,u,b,f)),(t=v[4])&&p.push(new Mt(t,e,n,E,m,b,f)),(t=v[3])&&p.push(new Mt(t,m,b,s,u,h,E)),(t=v[2])&&p.push(new Mt(t,e,b,s,m,h,E)),(t=v[1])&&p.push(new Mt(t,m,n,s,u,b,E)),(t=v[0])&&p.push(new Mt(t,e,n,s,m,b,E))}return this},Ct.visitAfter=function(o){var r,t=[],e=[];for(this._root&&t.push(new Mt(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));r=t.pop();){var n=r.node;if(n.length){var s,u=r.x0,h=r.y0,f=r.z0,p=r.x1,v=r.y1,m=r.z1,b=(u+p)/2,E=(h+v)/2,x=(f+m)/2;(s=n[0])&&t.push(new Mt(s,u,h,f,b,E,x)),(s=n[1])&&t.push(new Mt(s,b,h,f,p,E,x)),(s=n[2])&&t.push(new Mt(s,u,E,f,b,v,x)),(s=n[3])&&t.push(new Mt(s,b,E,f,p,v,x)),(s=n[4])&&t.push(new Mt(s,u,h,x,b,E,m)),(s=n[5])&&t.push(new Mt(s,b,h,x,p,E,m)),(s=n[6])&&t.push(new Mt(s,u,E,x,b,v,m)),(s=n[7])&&t.push(new Mt(s,b,E,x,p,v,m))}e.push(r)}for(;r=e.pop();)o(r.node,r.x0,r.y0,r.z0,r.x1,r.y1,r.z1);return this},Ct.x=function(o){return arguments.length?(this._x=o,this):this._x},Ct.y=function(o){return arguments.length?(this._y=o,this):this._y},Ct.z=function(o){return arguments.length?(this._z=o,this):this._z};var Aa=function(o,r,t,e,n,s,u){var h=[t,e,n][u-1],f=s.x-o.x||.1,p=s.y-o.y||.1,v=s.z-o.z||.1,m=h-r,b=f*f+p*p+v*v,E=Math.sqrt(b)*b;if(m*m*.81<b){var x=o.weight/E;return s.vx+=f*x,s.vy+=p*x,s.vz+=v*x,!0}if(o.length)return!1;o.data!==s&&(x=o.data.weight/E,s.vx+=f*x,s.vy+=p*x,s.vz+=v*x)},ka={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},Bn=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=i(i({},ka),r)}return o.prototype.execute=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return[2,this.genericForceLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return this.genericForceLayout(!0,r,t),[2]})})},o.prototype.stop=function(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1},o.prototype.tick=function(r){var t=this;if(r===void 0&&(r=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var e=0;(this.judgingDistance>this.lastOptions.minMovement||e<1)&&e<r;e++)this.runOneStep(this.lastCalcGraph,this.lastGraph,e,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach(function(s){return t.lastGraph.mergeNodeData(s.id,{x:s.data.x,y:s.data.y,z:t.options.dimensions===3?s.data.z:void 0})}),n},o.prototype.genericForceLayout=function(r,t,e){return c(this,void 0,void 0,function(){var n,s,u,h,f,p,v,m,b,E,x,w,N,A,S,L,C,T,R,I,O=this;return g(this,function(G){return n=i(i({},this.options),e),s=t.getAllNodes(),u=t.getAllEdges(),h=this.formatOptions(n,t),f=h.dimensions,p=h.width,v=h.height,m=h.nodeSize,b=h.getMass,E=h.nodeStrength,x=h.edgeStrength,w=h.linkDistance,N=s.map(function(M,z){return i(i({},M),{data:i(i({},M.data),{x:Q(M.data.x)?M.data.x:Math.random()*p,y:Q(M.data.y)?M.data.y:Math.random()*v,z:Q(M.data.z)?M.data.z:Math.random()*Math.sqrt(p*v),size:m(M)||30,mass:b(M),nodeStrength:E(M)})})}),A=u.map(function(M){return i(i({},M),{data:i(i({},M.data),{edgeStrength:x(M),linkDistance:w(M,t.getNode(M.source),t.getNode(M.target))})})}),s!=null&&s.length?(S={},s.forEach(function(M,z){S[M.id]={x:0,y:0,z:0}}),L=new Vt({nodes:N,edges:A}),this.formatCentripetal(h,L),C=h.maxIteration,T=h.minMovement,R=h.onTick,this.lastLayoutNodes=N,this.lastLayoutEdges=A,this.lastAssign=r,this.lastGraph=t,this.lastCalcGraph=L,this.lastOptions=h,this.lastVelMap=S,typeof window>"u"?[2]:(I=0,[2,new Promise(function(M){O.timeInterval=window.setInterval(function(){s&&O.running||M({nodes:Sr(t,N),edges:u}),O.runOneStep(L,t,I,S,h),O.updatePosition(t,L,S,h),r&&N.forEach(function(z){return t.mergeNodeData(z.id,{x:z.data.x,y:z.data.y,z:f===3?z.data.z:void 0})}),R==null||R({nodes:Sr(t,N),edges:u}),(++I>=C||O.judgingDistance<T)&&(window.clearInterval(O.timeInterval),M({nodes:Sr(t,N),edges:u}))},0),O.running=!0})])):(this.lastResult={nodes:[],edges:u},[2,{nodes:[],edges:u}])})})},o.prototype.formatOptions=function(r,t){var e=r,n=r.width,s=r.height,u=r.getMass;if(e.width=n||typeof window>"u"?n:window.innerWidth,e.height=s||typeof window>"u"?s:window.innerHeight,r.center||(e.center=[e.width/2,e.height/2]),u||(e.getMass=function(f){var p=1;Q(f==null?void 0:f.data.mass)&&(p=f==null?void 0:f.data.mass);var v=t.getDegree(f.id,"both");return!v||v<5?p:5*v*p}),r.preventOverlap){var h=Jt(0,r.nodeSpacing);r.nodeSize?V(r.nodeSize)?e.nodeSize=function(f){var p=r.nodeSize;return Math.max(p[0],p[1])+h(f)}:e.nodeSize=function(f){return r.nodeSize+h(f)}:e.nodeSize=function(f){var p=((f==null?void 0:f.data)||{}).size;return p?V(p)?Math.max(p[0],p[1])+h(f):ee(p)?Math.max(p.width,p.height)+h(f):p+h(f):10+h(f)}}return e.linkDistance=r.linkDistance?Jt(1,r.linkDistance):function(f){return 1+e.nodeSize(t.getNode(f.source))+e.nodeSize(t.getNode(f.target))},e.nodeStrength=Jt(1,r.nodeStrength),e.edgeStrength=Jt(1,r.edgeStrength),r},o.prototype.formatCentripetal=function(r,t){var e,n=r.centripetalOptions,s=r.center,u=r.clusterNodeStrength,h=r.leafCluster,f=r.clustering,p=r.nodeClusterBy,v=t.getAllNodes(),m=n||{leaf:2,single:2,others:1,center:function(S){return{x:s[0],y:s[1]}}};typeof u!="function"&&(r.clusterNodeStrength=function(S){return u});var b=[];if(h&&p&&(e=Hn(t,p),b=Array.from(new Set(v==null?void 0:v.map(function(S){return S.data[p]})))||[],r.centripetalOptions=Object.assign(m,{single:100,leaf:function(S){var L=e[S.id]||{},C=L.siblingLeaves,T=L.sameTypeLeaves;return(T==null?void 0:T.length)===(C==null?void 0:C.length)||(b==null?void 0:b.length)===1?1:r.clusterNodeStrength(S)},others:1,center:function(S){var L,C=t.getDegree(S.id,"both");if(!C)return{x:100,y:100};if(C===1){var T=(e[S.id]||{}).sameTypeLeaves,R=T===void 0?[]:T;R.length===1?L=void 0:R.length>1&&(L=Kn(R))}else L=void 0;return{x:L==null?void 0:L.x,y:L==null?void 0:L.y}}})),f&&p){e||(e=Hn(t,p)),b||(b=Array.from(new Set(v.map(function(S){return S.data[p]})))),b=b.filter(function(S){return S!==void 0});var E={};b.forEach(function(S){var L=v.filter(function(C){return C.data[p]===S}).map(function(C){return t.getNode(C.id)});E[S]=Kn(L)}),r.centripetalOptions=Object.assign(m,{single:function(S){return r.clusterNodeStrength(S)},leaf:function(S){return r.clusterNodeStrength(S)},others:function(S){return r.clusterNodeStrength(S)},center:function(S){var L=E[S.data[p]];return{x:L==null?void 0:L.x,y:L==null?void 0:L.y}}})}var x=r.centripetalOptions||{},w=x.leaf,N=x.single,A=x.others;w&&typeof w!="function"&&(r.centripetalOptions.leaf=function(){return w}),N&&typeof N!="function"&&(r.centripetalOptions.single=function(){return N}),A&&typeof A!="function"&&(r.centripetalOptions.others=function(){return A})},o.prototype.runOneStep=function(r,t,e,n,s){var u={},h=r.getAllNodes(),f=r.getAllEdges();if(h!=null&&h.length){var p=s.monitor;this.calRepulsive(r,u,s),f&&this.calAttractive(r,u,s),this.calGravity(r,t,u,s),this.updateVelocity(r,u,n,s),p&&p({energy:this.calTotalEnergy(u,h),nodes:t.getAllNodes(),edges:t.getAllEdges(),iterations:e})}},o.prototype.calTotalEnergy=function(r,t){var e=this;if(!(t!=null&&t.length))return 0;var n=0;return t.forEach(function(s,u){var h=r[s.id].x,f=r[s.id].y,p=e.options.dimensions===3?r[s.id].z:0,v=h*h+f*f+p*p,m=s.data.mass;n+=(m===void 0?1:m)*v*.5}),n},o.prototype.calRepulsive=function(r,t,e){var n=e.dimensions,s=e.factor,u=e.coulombDisScale;(function(h,f,p,v,m){var b=f/p,E=h.getAllNodes(),x=E.map(function(N,A){var S=N.data,L=S.nodeStrength;return{x:S.x,y:S.y,z:S.z,size:S.size,index:A,vx:0,vy:0,vz:0,weight:b*L}}),w=(m===2?je(x,function(N){return N.x},function(N){return N.y}):Un(x,function(N){return N.x},function(N){return N.y},function(N){return N.z})).visitAfter(Sa);x.forEach(function(N){(function(A,S,L){S.visit(function(C,T,R,I,O){return Aa(C,T,R,I,O,A,L)})})(N,w,m)}),x.map(function(N,A){var S=E[A],L=S.id,C=S.data.mass,T=C===void 0?1:C;v[L]={x:N.vx/T,y:N.vy/T,z:N.vz/T}})})(r,s,u*u,t,n)},o.prototype.calAttractive=function(r,t,e){var n=e.dimensions;r.getAllEdges().forEach(function(s,u){var h=s.source,f=s.target,p=r.getNode(h),v=r.getNode(f);if(p&&v){var m=v.data.x-p.data.x,b=v.data.y-p.data.y,E=n===3?v.data.z-p.data.z:0;m||b||(m=.01*Math.random(),b=.01*Math.random(),n!==3||E||(E=.01*Math.random()));var x=Math.sqrt(m*m+b*b+E*E),w=m/x,N=b/x,A=E/x,S=s.data||{},L=S.linkDistance,C=L===void 0?200:L,T=S.edgeStrength,R=(C-x)*(T===void 0?200:T),I=1/(p.data.mass||1),O=1/(v.data.mass||1),G=w*R,M=N*R,z=A*R;t[h].x-=G*I,t[h].y-=M*I,t[h].z-=z*I,t[f].x+=G*O,t[f].y+=M*O,t[f].z+=z*O}})},o.prototype.calGravity=function(r,t,e,n){var s=n.getCenter,u=r.getAllNodes(),h=t.getAllNodes(),f=t.getAllEdges(),p=n.width,v=n.height,m=n.center,b=n.gravity,E=n.centripetalOptions;u&&u.forEach(function(x){var w=x.id,N=x.data,A=N.mass,S=N.x,L=N.y,C=N.z,T=t.getNode(w),R=0,I=0,O=0,G=b,M=r.getDegree(w,"in"),z=r.getDegree(w,"out"),$=r.getDegree(w,"both"),P=s==null?void 0:s(T,$);if(P){var B=y(P,3);R=S-B[0],I=L-B[1],G=B[2]}else R=S-m[0],I=L-m[1],O=C-m[2];if(G&&(e[w].x-=G*R/A,e[w].y-=G*I/A,e[w].z-=G*O/A),E){var W=E.leaf,U=E.single,K=E.others,J=E.center,Y=(J==null?void 0:J(T,h,f,p,v))||{x:0,y:0,z:0,centerStrength:0},tt=Y.x,ot=Y.y,rt=Y.z,F=Y.centerStrength;if(!Q(tt)||!Q(ot))return;var Z=(S-tt)/A,ut=(L-ot)/A,nt=(C-rt)/A;if(F&&(e[w].x-=F*Z,e[w].y-=F*ut,e[w].z-=F*nt),$===0){var H=U(T);return H?(e[w].x-=H*Z,e[w].y-=H*ut,void(e[w].z-=H*nt)):void 0}if(M===0||z===0){var ht=W(T,h,f);return ht?(e[w].x-=ht*Z,e[w].y-=ht*ut,void(e[w].z-=ht*nt)):void 0}var Et=K(T);if(!Et)return;e[w].x-=Et*Z,e[w].y-=Et*ut,e[w].z-=Et*nt}})},o.prototype.updateVelocity=function(r,t,e,n){var s=n.damping,u=n.maxSpeed,h=n.interval,f=n.dimensions,p=r.getAllNodes();p!=null&&p.length&&p.forEach(function(v){var m=v.id,b=(e[m].x+t[m].x*h)*s||.01,E=(e[m].y+t[m].y*h)*s||.01,x=f===3?(e[m].z+t[m].z*h)*s||.01:0,w=Math.sqrt(b*b+E*E+x*x);if(w>u){var N=u/w;b*=N,E*=N,x*=N}e[m]={x:b,y:E,z:x}})},o.prototype.updatePosition=function(r,t,e,n){var s=this,u=n.distanceThresholdMode,h=n.interval,f=n.dimensions,p=t.getAllNodes();if(p!=null&&p.length){var v=0;u==="max"?this.judgingDistance=-1/0:u==="min"&&(this.judgingDistance=1/0),p.forEach(function(m){var b=m.id,E=r.getNode(b);if(Q(E.data.fx)&&Q(E.data.fy))t.mergeNodeData(b,{x:E.data.fx,y:E.data.fy,z:f===3?E.data.fz:void 0});else{var x=e[b].x*h,w=e[b].y*h,N=f===3?e[b].z*h:0;t.mergeNodeData(b,{x:m.data.x+x,y:m.data.y+w,z:m.data.z+N});var A=Math.sqrt(x*x+w*w+N*N);switch(u){case"max":s.judgingDistance<A&&(s.judgingDistance=A);break;case"min":s.judgingDistance>A&&(s.judgingDistance=A);break;default:v+=A}}}),u&&u!=="mean"||(this.judgingDistance=v/p.length)}else this.judgingDistance=0},o}(),Hn=function(o,r){var t=o.getAllNodes();if(!(t!=null&&t.length))return{};var e={};return t.forEach(function(n,s){o.getDegree(n.id,"both")===1&&(e[n.id]=_a(o,"leaf",n,r))}),e},_a=function(o,r,t,e){var n=o.getDegree(t.id,"in"),s=o.getDegree(t.id,"out"),u=t,h=[];return n===0?(u=o.getSuccessors(t.id)[0],h=o.getNeighbors(u.id)):s===0&&(u=o.getPredecessors(t.id)[0],h=o.getNeighbors(u.id)),h=h.filter(function(f){return o.getDegree(f.id,"in")===0||o.getDegree(f.id,"out")===0}),{coreNode:u,siblingLeaves:h,sameTypeLeaves:za(o,r,e,t,h)}},za=function(o,r,t,e,n){var s=e.data[t]||"",u=(n==null?void 0:n.filter(function(h){return h.data[t]===s}))||[];return r==="leaf"&&(u=u.filter(function(h){return o.getDegree(h.id,"in")===0||o.getDegree(h.id,"out")===0})),u},Kn=function(o){var r={x:0,y:0};o.forEach(function(e){var n=e.data,s=n.x,u=n.y;r.x+=s||0,r.y+=u||0});var t=o.length||1;return{x:r.x/t,y:r.y/t}},Sr=function(o,r){return r.map(function(t){var e=t.id,n=t.data,s=o.getNode(e);return i(i({},s),{data:i(i({},s.data),{x:n.x,y:n.y,z:n.z})})})},Da=function(){function o(r){this.id=r.id||0,this.rx=r.rx,this.ry=r.ry,this.fx=0,this.fy=0,this.mass=r.mass,this.degree=r.degree,this.g=r.g||0}return o.prototype.distanceTo=function(r){var t=this.rx-r.rx,e=this.ry-r.ry;return Math.hypot(t,e)},o.prototype.setPos=function(r,t){this.rx=r,this.ry=t},o.prototype.resetForce=function(){this.fx=0,this.fy=0},o.prototype.addForce=function(r){var t=r.rx-this.rx,e=r.ry-this.ry,n=Math.hypot(t,e);n=n<1e-4?1e-4:n;var s=this.g*(this.degree+1)*(r.degree+1)/n;this.fx+=s*t/n,this.fy+=s*e/n},o.prototype.in=function(r){return r.contains(this.rx,this.ry)},o.prototype.add=function(r){var t=this.mass+r.mass;return new o({rx:(this.rx*this.mass+r.rx*r.mass)/t,ry:(this.ry*this.mass+r.ry*r.mass)/t,mass:t,degree:this.degree+r.degree})},o}();const Ra=Da,Ia=function(){function o(r){this.xmid=r.xmid,this.ymid=r.ymid,this.length=r.length,this.massCenter=r.massCenter||[0,0],this.mass=r.mass||1}return o.prototype.getLength=function(){return this.length},o.prototype.contains=function(r,t){var e=this.length/2;return r<=this.xmid+e&&r>=this.xmid-e&&t<=this.ymid+e&&t>=this.ymid-e},o.prototype.NW=function(){return new o({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},o.prototype.NE=function(){return new o({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},o.prototype.SW=function(){return new o({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},o.prototype.SE=function(){return new o({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},o}(),Ta=function(){function o(r){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,r!=null&&(this.quad=r)}return o.prototype.insert=function(r){this.body!=null?this._isExternal()?(this.quad&&(this.NW=new o(this.quad.NW()),this.NE=new o(this.quad.NE()),this.SW=new o(this.quad.SW()),this.SE=new o(this.quad.SE())),this._putBody(this.body),this._putBody(r),this.body=this.body.add(r)):(this.body=this.body.add(r),this._putBody(r)):this.body=r},o.prototype._putBody=function(r){this.quad&&(r.in(this.quad.NW())&&this.NW?this.NW.insert(r):r.in(this.quad.NE())&&this.NE?this.NE.insert(r):r.in(this.quad.SW())&&this.SW?this.SW.insert(r):r.in(this.quad.SE())&&this.SE&&this.SE.insert(r))},o.prototype._isExternal=function(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null},o.prototype.updateForce=function(r){this.body!=null&&r!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(r)<this.theta?r.addForce(this.body):(this.NW&&this.NW.updateForce(r),this.NE&&this.NE.updateForce(r),this.SW&&this.SW.updateForce(r),this.SE&&this.SE.updateForce(r)))},o}();var Oa={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Yn=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="forceAtlas2",this.options=i(i({},Oa),r)}return o.prototype.execute=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return[2,this.genericForceAtlas2Layout(!1,r,t)]})})},o.prototype.assign=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return this.genericForceAtlas2Layout(!0,r,t),[2]})})},o.prototype.genericForceAtlas2Layout=function(r,t,e){return c(this,void 0,void 0,function(){var n,s,u,h,f,p,v,m,b,E,x,w,N,A,S,L,C,T,R,I,O,G;return g(this,function(M){if(n=t.getAllEdges(),s=t.getAllNodes(),u=this.formatOptions(e,s.length),h=u.width,f=u.height,p=u.prune,v=u.maxIteration,m=u.nodeSize,b=u.center,!(s!=null&&s.length)||s.length===1)return[2,we(t,r,b)];if(E=s.map(function(z){return xt(z,[h,f])}),x=n.filter(function(z){return z.source!==z.target}),w=new Vt({nodes:E,edges:x}),N=this.getSizes(w,t,m),this.run(w,t,v,N,r,u),p){for(A=0;A<x.length;A+=1)S=x[A],L=S.source,C=S.target,T=w.getDegree(L),R=w.getDegree(L),T<=1?(I=w.getNode(C),w.mergeNodeData(L,{x:I.data.x,y:I.data.y})):R<=1&&(O=w.getNode(L),w.mergeNodeData(C,{x:O.data.x,y:O.data.y}));G=i(i({},u),{prune:!1,barnesHut:!1}),this.run(w,t,100,N,r,G)}return[2,{nodes:E,edges:n}]})})},o.prototype.getSizes=function(r,t,e){for(var n=r.getAllNodes(),s={},u=0;u<n.length;u+=1){var h=n[u],f=h.id,p=h.data;if(s[f]=10,Q(p.size))s[f]=p.size;else if(V(p.size))isNaN(p.size[0])||(s[f]=Math.max(p.size[0])),isNaN(p.size[1])||(s[f]=Math.max(p.size[1]));else if(ee(p.size))s[f]=Math.max(p.size.width,p.size.height);else if(Kt(e)){var v=e(t.getNode(f));V(v)?s[f]=Math.max.apply(Math,k([],y(v))):s[f]=v}else V(e)?s[f]=Math.max.apply(Math,k([],y(e))):Q(e)&&(s[f]=e)}return s},o.prototype.formatOptions=function(r,t){r===void 0&&(r={});var e=i(i({},this.options),r),n=e.center,s=e.width,u=e.height,h=e.barnesHut,f=e.prune,p=e.maxIteration,v=e.kr,m=e.kg;return e.width=s||typeof window>"u"?s:window.innerWidth,e.height=u||typeof window>"u"?u:window.innerHeight,e.center=n||[e.width/2,e.height/2],h===void 0&&t>250&&(e.barnesHut=!0),f===void 0&&t>100&&(e.prune=!0),p!==0||f?p===0&&f&&(e.maxIteration=100,t<=200&&t>100?e.maxIteration=500:t>200&&(e.maxIteration=950)):(e.maxIteration=250,t<=200&&t>100?e.maxIteration=1e3:t>200&&(e.maxIteration=1200)),v||(e.kr=50,t>100&&t<=500?e.kr=20:t>500&&(e.kr=1)),m||(e.kg=20,t>100&&t<=500?e.kg=10:t>500&&(e.kg=1)),e},o.prototype.run=function(r,t,e,n,s,u){for(var h=u.kr,f=u.barnesHut,p=u.onTick,v=r.getAllNodes(),m=0,b=e,E={},x={},w={},N=0;N<v.length;N+=1){var A=v[N],S=A.data,L=A.id;if(E[L]=[0,0],f){var C={id:N,rx:S.x,ry:S.y,mass:1,g:h,degree:r.getDegree(L)};w[L]=new Ra(C)}}for(;b>0;)m=this.oneStep(r,{iter:b,preventOverlapIters:50,krPrime:100,sg:m,forces:E,preForces:x,bodies:w,sizes:n},u),b--,p==null||p({nodes:v,edges:t.getAllEdges()});return r},o.prototype.oneStep=function(r,t,e){for(var n=t.iter,s=t.preventOverlapIters,u=t.krPrime,h=t.sg,f=t.preForces,p=t.bodies,v=t.sizes,m=t.forces,b=e.preventOverlap,E=e.barnesHut,x=r.getAllNodes(),w=0;w<x.length;w+=1){var N=x[w].id;f[N]=k([],y(m[N])),m[N]=[0,0]}return m=this.getAttrForces(r,n,s,v,m,e),m=E&&(b&&n>s||!b)?this.getOptRepGraForces(r,m,p,e):this.getRepGraForces(r,n,s,m,u,v,e),this.updatePos(r,m,f,h,e)},o.prototype.getAttrForces=function(r,t,e,n,s,u){for(var h=u.preventOverlap,f=u.dissuadeHubs,p=u.mode,v=u.prune,m=r.getAllEdges(),b=0;b<m.length;b+=1){var E=m[b],x=E.source,w=E.target,N=r.getNode(x),A=r.getNode(w),S=r.getDegree(x),L=r.getDegree(w);if(!v||!(S<=1||L<=1)){var C=[A.data.x-N.data.x,A.data.y-N.data.y],T=Math.hypot(C[0],C[1]);T=T<1e-4?1e-4:T,C[0]=C[0]/T,C[1]=C[1]/T,h&&t<e&&(T=T-n[x]-n[w]);var R=T,I=R;p==="linlog"&&(I=R=Math.log(1+T)),f&&(R=T/S,I=T/L),h&&t<e&&T<=0?(R=0,I=0):h&&t<e&&T>0&&(R=T,I=T),s[x][0]+=R*C[0],s[w][0]-=I*C[0],s[x][1]+=R*C[1],s[w][1]-=I*C[1]}}return s},o.prototype.getOptRepGraForces=function(r,t,e,n){for(var s=n.kg,u=n.center,h=n.prune,f=r.getAllNodes(),p=f.length,v=9e10,m=-9e10,b=9e10,E=-9e10,x=0;x<p;x+=1){var w=f[x],N=w.id,A=w.data;h&&r.getDegree(N)<=1||(e[N].setPos(A.x,A.y),A.x>=m&&(m=A.x),A.x<=v&&(v=A.x),A.y>=E&&(E=A.y),A.y<=b&&(b=A.y))}var S=Math.max(m-v,E-b),L=new Ia({xmid:(m+v)/2,ymid:(E+b)/2,length:S,massCenter:u,mass:p}),C=new Ta(L);for(x=0;x<p;x+=1)N=f[x].id,h&&r.getDegree(N)<=1||e[N].in(L)&&C.insert(e[N]);for(x=0;x<p;x+=1){var T=f[x],R=(N=T.id,A=T.data,r.getDegree(N));if(!(h&&R<=1)){e[N].resetForce(),C.updateForce(e[N]),t[N][0]-=e[N].fx,t[N][1]-=e[N].fy;var I=[A.x-u[0],A.y-u[1]],O=Math.hypot(I[0],I[1]);O=O<1e-4?1e-4:O,I[0]=I[0]/O,I[1]=I[1]/O;var G=s*(R+1);t[N][0]-=G*I[0],t[N][1]-=G*I[1]}}return t},o.prototype.getRepGraForces=function(r,t,e,n,s,u,h){for(var f=h.preventOverlap,p=h.kr,v=h.kg,m=h.center,b=h.prune,E=r.getAllNodes(),x=E.length,w=0;w<x;w+=1){for(var N=E[w],A=r.getDegree(N.id),S=w+1;S<x;S+=1){var L=E[S],C=r.getDegree(L.id);if(!b||!(A<=1||C<=1)){var T=[L.data.x-N.data.x,L.data.y-N.data.y],R=Math.hypot(T[0],T[1]);R=R<1e-4?1e-4:R,T[0]=T[0]/R,T[1]=T[1]/R,f&&t<e&&(R=R-u[N.id]-u[L.id]);var I=p*(A+1)*(C+1)/R;f&&t<e&&R<0?I=s*(A+1)*(C+1):f&&t<e&&R===0?I=0:f&&t<e&&R>0&&(I=p*(A+1)*(C+1)/R),n[N.id][0]-=I*T[0],n[L.id][0]+=I*T[0],n[N.id][1]-=I*T[1],n[L.id][1]+=I*T[1]}}var O=[N.data.x-m[0],N.data.y-m[1]],G=Math.hypot(O[0],O[1]);O[0]=O[0]/G,O[1]=O[1]/G;var M=v*(A+1);n[N.id][0]-=M*O[0],n[N.id][1]-=M*O[1]}return n},o.prototype.updatePos=function(r,t,e,n,s){for(var u=s.ks,h=s.tao,f=s.prune,p=s.ksmax,v=r.getAllNodes(),m=v.length,b=[],E=[],x=0,w=0,N=n,A=0;A<m;A+=1){var S=v[A].id,L=r.getDegree(S);if(!(f&&L<=1)){var C=[t[S][0]-e[S][0],t[S][1]-e[S][1]],T=Math.hypot(C[0],C[1]),R=[t[S][0]+e[S][0],t[S][1]+e[S][1]],I=Math.hypot(R[0],R[1]);b[A]=T,E[A]=I/2,x+=(L+1)*b[A],w+=(L+1)*E[A]}}var O=N;for(N=h*w/x,O!==0&&(N=N>1.5*O?1.5*O:N),A=0;A<m;A+=1){var G=v[A],M=(S=G.id,G.data);if(L=r.getDegree(S),!(f&&L<=1||Q(M.fx)&&Q(M.fy))){var z=u*N/(1+N*Math.sqrt(b[A])),$=Math.hypot(t[S][0],t[S][1]),P=p/($=$<1e-4?1e-4:$),B=(z=z>P?P:z)*t[S][0],W=z*t[S][1];r.mergeNodeData(S,{x:M.x+B,y:M.y+W})}}return N},o}(),Pa={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Qn=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=i(i({},Pa),r)}return o.prototype.execute=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return[2,this.genericFruchtermanLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return this.genericFruchtermanLayout(!0,r,t),[2]})})},o.prototype.stop=function(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1},o.prototype.tick=function(r){var t=this;if(r===void 0&&(r=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var e=0;e<r;e++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach(function(s){return t.lastGraph.mergeNodeData(s.id,{x:s.data.x,y:s.data.y,z:t.options.dimensions===3?s.data.z:void 0})}),n},o.prototype.genericFruchtermanLayout=function(r,t,e){return c(this,void 0,void 0,function(){var n,s,u,h,f,p,v,m,b,E,x,w,N,A,S,L,C=this;return g(this,function(T){return this.running?[2]:(n=this.formatOptions(e),s=n.dimensions,u=n.width,h=n.height,f=n.center,p=n.clustering,v=n.nodeClusterBy,m=n.maxIteration,b=n.onTick,E=t.getAllNodes(),x=t.getAllEdges(),E!=null&&E.length?E.length===1?(r&&t.mergeNodeData(E[0].id,{x:f[0],y:f[1],z:s===3?f[2]:void 0}),w={nodes:[i(i({},E[0]),{data:i(i({},E[0].data),{x:f[0],y:f[1],z:s===3?f[2]:void 0})})],edges:x},this.lastResult=w,[2,w]):(N=E.map(function(R){return xt(R,[u,h])}),A=new Vt({nodes:N,edges:x}),S={},p&&N.forEach(function(R){var I=R.data[v];S[I]||(S[I]={name:I,cx:0,cy:0,count:0})}),this.lastLayoutNodes=N,this.lastLayoutEdges=x,this.lastAssign=r,this.lastGraph=A,this.lastOptions=n,this.lastClusterMap=S,typeof window>"u"?[2]:(L=0,[2,new Promise(function(R){C.timeInterval=window.setInterval(function(){C.running?(C.runOneStep(A,S,n),r&&N.forEach(function(I){var O=I.id,G=I.data;return t.mergeNodeData(O,{x:G.x,y:G.y,z:s===3?G.z:void 0})}),b==null||b({nodes:N,edges:x}),++L>=m&&(window.clearInterval(C.timeInterval),R({nodes:N,edges:x}))):R({nodes:N,edges:x})},0),C.running=!0})])):(w={nodes:[],edges:x},this.lastResult=w,[2,w]))})})},o.prototype.formatOptions=function(r){r===void 0&&(r={});var t=i(i({},this.options),r),e=t.clustering,n=t.nodeClusterBy,s=t.center,u=t.width,h=t.height;return t.width=u||typeof window>"u"?u:window.innerWidth,t.height=h||typeof window>"u"?h:window.innerHeight,t.center=s||[t.width/2,t.height/2],t.clustering=e&&!!n,t},o.prototype.runOneStep=function(r,t,e){var n=e.dimensions,s=e.height,u=e.width,h=e.gravity,f=e.center,p=e.speed,v=e.clustering,m=e.nodeClusterBy,b=e.clusterGravity,E=s*u,x=Math.sqrt(E)/10,w=r.getAllNodes(),N=E/(w.length+1),A=Math.sqrt(N),S={};if(this.applyCalculate(r,S,A,N),v){for(var L in t)t[L].cx=0,t[L].cy=0,t[L].count=0;for(var L in w.forEach(function(R){var I=R.data,O=t[I[m]];Q(I.x)&&(O.cx+=I.x),Q(I.y)&&(O.cy+=I.y),O.count++}),t)t[L].cx/=t[L].count,t[L].cy/=t[L].count;var C=b||h;w.forEach(function(T,R){var I=T.id,O=T.data;if(Q(O.x)&&Q(O.y)){var G=t[O[m]],M=Math.sqrt((O.x-G.cx)*(O.x-G.cx)+(O.y-G.cy)*(O.y-G.cy)),z=A*C;S[I].x-=z*(O.x-G.cx)/M,S[I].y-=z*(O.y-G.cy)/M}})}w.forEach(function(T,R){var I=T.id,O=T.data;if(Q(O.x)&&Q(O.y)){var G=.01*A*h;S[I].x-=G*(O.x-f[0]),S[I].y-=G*(O.y-f[1]),n===3&&(S[I].z-=G*(O.z-f[2]))}}),w.forEach(function(T,R){var I=T.id,O=T.data;if(Q(O.fx)&&Q(O.fy))return O.x=O.fx,O.y=O.fy,void(n===3&&(O.z=O.fz));if(Q(O.x)&&Q(O.y)){var G=Math.sqrt(S[I].x*S[I].x+S[I].y*S[I].y+(n===3?S[I].z*S[I].z:0));if(G>0){var M=Math.min(x*(p/800),G);r.mergeNodeData(I,{x:O.x+S[I].x/G*M,y:O.y+S[I].y/G*M,z:n===3?O.z+S[I].z/G*M:void 0})}}})},o.prototype.applyCalculate=function(r,t,e,n){this.calRepulsive(r,t,n),this.calAttractive(r,t,e)},o.prototype.calRepulsive=function(r,t,e){var n=this,s=r.getAllNodes();s.forEach(function(u,h){var f=u.data,p=u.id;t[p]={x:0,y:0,z:0},s.forEach(function(v,m){var b=v.data,E=v.id;if(!(h<=m)&&Q(f.x)&&Q(b.x)&&Q(f.y)&&Q(b.y)){var x=f.x-b.x,w=f.y-b.y,N=n.options.dimensions===3?f.z-b.z:0,A=x*x+w*w+N*N;A===0&&(A=1,x=.01,w=.01,N=.01);var S=e/A,L=x*S,C=w*S,T=N*S;t[p].x+=L,t[p].y+=C,t[E].x-=L,t[E].y-=C,n.options.dimensions===3&&(t[p].z+=T,t[E].z-=T)}})})},o.prototype.calAttractive=function(r,t,e){var n=this;r.getAllEdges().forEach(function(s){var u=s.source,h=s.target;if(u&&h&&u!==h){var f=r.getNode(u).data,p=r.getNode(h).data;if(Q(p.x)&&Q(f.x)&&Q(p.y)&&Q(f.y)){var v=p.x-f.x,m=p.y-f.y,b=n.options.dimensions===3?p.z-f.z:0,E=Math.sqrt(v*v+m*m+b*b)/e,x=v*E,w=m*E,N=b*E;t[u].x+=x,t[u].y+=w,t[h].x-=x,t[h].y-=w,n.options.dimensions===3&&(t[u].z+=N,t[h].z-=N)}}})},o}(),La={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},Jn=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="grid",this.options=i(i({},La),r)}return o.prototype.execute=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return[2,this.genericGridLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return this.genericGridLayout(!0,r,t),[2]})})},o.prototype.genericGridLayout=function(r,t,e){return c(this,void 0,void 0,function(){var n,s,u,h,f,p,v,m,b,E,x,w,N,A,S,L,C,T,R,I,O,G,M,z,$,P,B,W,U,K,J,Y,tt,ot,rt,F,Z;return g(this,function(ut){if(n=i(i({},this.options),e),s=n.begin,u=s===void 0?[0,0]:s,h=n.condense,f=n.preventOverlapPadding,p=n.preventOverlap,v=n.rows,m=n.cols,b=n.nodeSpacing,E=n.nodeSize,x=n.width,w=n.height,N=n.position,A=n.sortBy,S=t.getAllNodes(),L=t.getAllEdges(),!(C=S==null?void 0:S.length)||C===1)return[2,we(t,r,u)];if(T=S.map(function(nt){return xt(nt)}),A==="id"||Re(A)&&T[0].data[A]!==void 0||(A="degree"),A==="degree"?T.sort(function(nt,H){return t.getDegree(H.id,"both")-t.getDegree(nt.id,"both")}):A==="id"?T.sort(function(nt,H){return Q(H.id)&&Q(nt.id)?H.id-nt.id:(""+nt.id).localeCompare(""+H.id)}):T.sort(function(nt,H){return H.data[A]-nt.data[A]}),R=x||typeof window>"u"?x:window.innerWidth,I=w||typeof window>"u"?w:window.innerHeight,O=C,G={rows:v,cols:m},v!=null&&m!=null?(G.rows=v,G.cols=m):v!=null&&m==null?(G.rows=v,G.cols=Math.ceil(O/G.rows)):v==null&&m!=null?(G.cols=m,G.rows=Math.ceil(O/G.cols)):(M=Math.sqrt(O*I/R),G.rows=Math.round(M),G.cols=Math.round(R/I*M)),G.rows=Math.max(G.rows,1),G.cols=Math.max(G.cols,1),G.cols*G.rows>O)z=He(G),$=Ke(G),(z-1)*$>=O?He(G,z-1):($-1)*z>=O&&Ke(G,$-1);else for(;G.cols*G.rows<O;)z=He(G),(($=Ke(G))+1)*z>=O?Ke(G,$+1):He(G,z+1);for(P=h?0:R/G.cols,B=h?0:I/G.rows,(p||b)&&(W=Jt(10,b),U=hr(30,E,!1),T.forEach(function(nt){nt.data.x&&nt.data.y||(nt.data.x=0,nt.data.y=0);var H,ht,Et=t.getNode(nt.id),mt=U(Et)||30;V(mt)?(H=mt[0],ht=mt[1]):(H=mt,ht=mt);var Gt=W!==void 0?W(nt):f,Dt=H+Gt,wt=ht+Gt;P=Math.max(P,Dt),B=Math.max(B,wt)})),K={},J={row:0,col:0},Y={},tt=0;tt<T.length;tt++){if(ot=T[tt],rt=void 0,N&&(rt=N(t.getNode(ot.id))),rt&&(rt.row!==void 0||rt.col!==void 0)){if((F={row:rt.row,col:rt.col}).col===void 0)for(F.col=0;Ar(K,F);)F.col++;else if(F.row===void 0)for(F.row=0;Ar(K,F);)F.row++;Y[ot.id]=F,Xn(K,F)}Ca(ot,u,P,B,Y,G,J,K)}return Z={nodes:T,edges:L},r&&T.forEach(function(nt){t.mergeNodeData(nt.id,{x:nt.data.x,y:nt.data.y})}),[2,Z]})})},o}(),He=function(o,r){var t,e=o.rows||5,n=o.cols||5;return r==null?t=Math.min(e,n):Math.min(e,n)===o.rows?o.rows=r:o.cols=r,t},Ke=function(o,r){var t,e=o.rows||5,n=o.cols||5;return r==null?t=Math.max(e,n):Math.max(e,n)===o.rows?o.rows=r:o.cols=r,t},Ar=function(o,r){return o["c-"+r.row+"-"+r.col]||!1},Xn=function(o,r){return o["c-"+r.row+"-"+r.col]=!0},Zn=function(o,r){var t=o.cols||5;r.col++,r.col>=t&&(r.col=0,r.row++)},Ca=function(o,r,t,e,n,s,u,h){var f,p,v=n[o.id];if(v)f=v.col*t+t/2+r[0],p=v.row*e+e/2+r[1];else{for(;Ar(h,u);)Zn(s,u);f=u.col*t+t/2+r[0],p=u.row*e+e/2+r[1],Xn(h,u),Zn(s,u)}o.data.x=f,o.data.y=p};const Ga=Object.prototype.toString;function Yt(o){const r=Ga.call(o);return r.endsWith("Array]")&&!r.includes("Big")}function to(o){var r,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Yt(o))throw new TypeError("input must be an array");if(o.length===0)throw new TypeError("input must not be empty");if(t.output!==void 0){if(!Yt(t.output))throw new TypeError("output option must be an array if specified");r=t.output}else r=new Array(o.length);var e=function(m){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Yt(m))throw new TypeError("input must be an array");if(m.length===0)throw new TypeError("input must not be empty");var E=b.fromIndex,x=E===void 0?0:E,w=b.toIndex,N=w===void 0?m.length:w;if(x<0||x>=m.length||!Number.isInteger(x))throw new Error("fromIndex must be a positive integer smaller than length");if(N<=x||N>m.length||!Number.isInteger(N))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var A=m[x],S=x+1;S<N;S++)m[S]<A&&(A=m[S]);return A}(o),n=function(m){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Yt(m))throw new TypeError("input must be an array");if(m.length===0)throw new TypeError("input must not be empty");var E=b.fromIndex,x=E===void 0?0:E,w=b.toIndex,N=w===void 0?m.length:w;if(x<0||x>=m.length||!Number.isInteger(x))throw new Error("fromIndex must be a positive integer smaller than length");if(N<=x||N>m.length||!Number.isInteger(N))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var A=m[x],S=x+1;S<N;S++)m[S]>A&&(A=m[S]);return A}(o);if(e===n)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var s=t.min,u=s===void 0?t.autoMinMax?e:0:s,h=t.max,f=h===void 0?t.autoMinMax?n:1:h;if(u>=f)throw new RangeError("min option must be smaller than max option");for(var p=(f-u)/(n-e),v=0;v<o.length;v++)r[v]=(o[v]-e)*p+u;return r}const Ye=" ".repeat(2),eo=" ".repeat(4);function ro(o,r={}){const{maxRows:t=15,maxColumns:e=10,maxNumSize:n=8,padMinus:s="auto"}=r;return`${o.constructor.name} {
${Ye}[
${eo}${function(u,h,f,p,v){const{rows:m,columns:b}=u,E=Math.min(m,h),x=Math.min(b,f),w=[];if(v==="auto"){v=!1;t:for(let N=0;N<E;N++)for(let A=0;A<x;A++)if(u.get(N,A)<0){v=!0;break t}}for(let N=0;N<E;N++){let A=[];for(let S=0;S<x;S++)A.push($a(u.get(N,S),p,v));w.push(`${A.join(" ")}`)}return x!==b&&(w[w.length-1]+=` ... ${b-f} more columns`),E!==m&&w.push(`... ${m-h} more rows`),w.join(`
${eo}`)}(o,t,e,n,s)}
${Ye}]
${Ye}rows: ${o.rows}
${Ye}columns: ${o.columns}
}`}function $a(o,r,t){return(o>=0&&t?` ${no(o,r-1)}`:no(o,r)).padEnd(r)}function no(o,r){let t=o.toString();if(t.length<=r)return t;let e=o.toFixed(r);if(e.length>r&&(e=o.toFixed(Math.max(0,r-(e.length-r)))),e.length<=r&&!e.startsWith("0.000")&&!e.startsWith("-0.000"))return e;let n=o.toExponential(r);return n.length>r&&(n=o.toExponential(Math.max(0,r-(n.length-r)))),n.slice(0)}function re(o,r,t){let e=t?o.rows:o.rows-1;if(r<0||r>e)throw new RangeError("Row index out of range")}function ne(o,r,t){let e=t?o.columns:o.columns-1;if(r<0||r>e)throw new RangeError("Column index out of range")}function be(o,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==o.columns)throw new RangeError("vector size must be the same as the number of columns");return r}function Ne(o,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==o.rows)throw new RangeError("vector size must be the same as the number of rows");return r}function oo(o,r,t,e,n){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(Je("startRow",r),Je("endRow",t),Je("startColumn",e),Je("endColumn",n),r>t||e>n||r<0||r>=o.rows||t<0||t>=o.rows||e<0||e>=o.columns||n<0||n>=o.columns)throw new RangeError("Submatrix indices are out of range")}function Qe(o,r=0){let t=[];for(let e=0;e<o;e++)t.push(r);return t}function Je(o,r){if(typeof r!="number")throw new TypeError(`${o} must be a number`)}function Me(o){if(o.isEmpty())throw new Error("Empty matrix has no elements to index")}class gt{static from1DArray(r,t,e){if(r*t!==e.length)throw new RangeError("data length does not match given dimensions");let n=new ct(r,t);for(let s=0;s<r;s++)for(let u=0;u<t;u++)n.set(s,u,e[s*t+u]);return n}static rowVector(r){let t=new ct(1,r.length);for(let e=0;e<r.length;e++)t.set(0,e,r[e]);return t}static columnVector(r){let t=new ct(r.length,1);for(let e=0;e<r.length;e++)t.set(e,0,r[e]);return t}static zeros(r,t){return new ct(r,t)}static ones(r,t){return new ct(r,t).fill(1)}static rand(r,t,e={}){if(typeof e!="object")throw new TypeError("options must be an object");const{random:n=Math.random}=e;let s=new ct(r,t);for(let u=0;u<r;u++)for(let h=0;h<t;h++)s.set(u,h,n());return s}static randInt(r,t,e={}){if(typeof e!="object")throw new TypeError("options must be an object");const{min:n=0,max:s=1e3,random:u=Math.random}=e;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(s))throw new TypeError("max must be an integer");if(n>=s)throw new RangeError("min must be smaller than max");let h=s-n,f=new ct(r,t);for(let p=0;p<r;p++)for(let v=0;v<t;v++){let m=n+Math.round(u()*h);f.set(p,v,m)}return f}static eye(r,t,e){t===void 0&&(t=r),e===void 0&&(e=1);let n=Math.min(r,t),s=this.zeros(r,t);for(let u=0;u<n;u++)s.set(u,u,e);return s}static diag(r,t,e){let n=r.length;t===void 0&&(t=n),e===void 0&&(e=t);let s=Math.min(n,t,e),u=this.zeros(t,e);for(let h=0;h<s;h++)u.set(h,h,r[h]);return u}static min(r,t){r=this.checkMatrix(r),t=this.checkMatrix(t);let e=r.rows,n=r.columns,s=new ct(e,n);for(let u=0;u<e;u++)for(let h=0;h<n;h++)s.set(u,h,Math.min(r.get(u,h),t.get(u,h)));return s}static max(r,t){r=this.checkMatrix(r),t=this.checkMatrix(t);let e=r.rows,n=r.columns,s=new this(e,n);for(let u=0;u<e;u++)for(let h=0;h<n;h++)s.set(u,h,Math.max(r.get(u,h),t.get(u,h)));return s}static checkMatrix(r){return gt.isMatrix(r)?r:new ct(r)}static isMatrix(r){return r!=null&&r.klass==="Matrix"}get size(){return this.rows*this.columns}apply(r){if(typeof r!="function")throw new TypeError("callback must be a function");for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)r.call(this,t,e);return this}to1DArray(){let r=[];for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)r.push(this.get(t,e));return r}to2DArray(){let r=[];for(let t=0;t<this.rows;t++){r.push([]);for(let e=0;e<this.columns;e++)r[t].push(this.get(t,e))}return r}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let r=0;r<this.rows;r++)for(let t=0;t<=r;t++)if(this.get(r,t)!==this.get(t,r))return!1;return!0}return!1}isEchelonForm(){let r=0,t=0,e=-1,n=!0,s=!1;for(;r<this.rows&&n;){for(t=0,s=!1;t<this.columns&&s===!1;)this.get(r,t)===0?t++:this.get(r,t)===1&&t>e?(s=!0,e=t):(n=!1,s=!0);r++}return n}isReducedEchelonForm(){let r=0,t=0,e=-1,n=!0,s=!1;for(;r<this.rows&&n;){for(t=0,s=!1;t<this.columns&&s===!1;)this.get(r,t)===0?t++:this.get(r,t)===1&&t>e?(s=!0,e=t):(n=!1,s=!0);for(let u=t+1;u<this.rows;u++)this.get(r,u)!==0&&(n=!1);r++}return n}echelonForm(){let r=this.clone(),t=0,e=0;for(;t<r.rows&&e<r.columns;){let n=t;for(let s=t;s<r.rows;s++)r.get(s,e)>r.get(n,e)&&(n=s);if(r.get(n,e)===0)e++;else{r.swapRows(t,n);let s=r.get(t,e);for(let u=e;u<r.columns;u++)r.set(t,u,r.get(t,u)/s);for(let u=t+1;u<r.rows;u++){let h=r.get(u,e)/r.get(t,e);r.set(u,e,0);for(let f=e+1;f<r.columns;f++)r.set(u,f,r.get(u,f)-r.get(t,f)*h)}t++,e++}}return r}reducedEchelonForm(){let r=this.echelonForm(),t=r.columns,e=r.rows,n=e-1;for(;n>=0;)if(r.maxRow(n)===0)n--;else{let s=0,u=!1;for(;s<e&&u===!1;)r.get(n,s)===1?u=!0:s++;for(let h=0;h<n;h++){let f=r.get(h,s);for(let p=s;p<t;p++){let v=r.get(h,p)-f*r.get(n,p);r.set(h,p,v)}}n--}return r}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{rows:t=1,columns:e=1}=r;if(!Number.isInteger(t)||t<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(e)||e<=0)throw new TypeError("columns must be a positive integer");let n=new ct(this.rows*t,this.columns*e);for(let s=0;s<t;s++)for(let u=0;u<e;u++)n.setSubMatrix(this,this.rows*s,this.columns*u);return n}fill(r){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,r);return this}neg(){return this.mulS(-1)}getRow(r){re(this,r);let t=[];for(let e=0;e<this.columns;e++)t.push(this.get(r,e));return t}getRowVector(r){return ct.rowVector(this.getRow(r))}setRow(r,t){re(this,r),t=be(this,t);for(let e=0;e<this.columns;e++)this.set(r,e,t[e]);return this}swapRows(r,t){re(this,r),re(this,t);for(let e=0;e<this.columns;e++){let n=this.get(r,e);this.set(r,e,this.get(t,e)),this.set(t,e,n)}return this}getColumn(r){ne(this,r);let t=[];for(let e=0;e<this.rows;e++)t.push(this.get(e,r));return t}getColumnVector(r){return ct.columnVector(this.getColumn(r))}setColumn(r,t){ne(this,r),t=Ne(this,t);for(let e=0;e<this.rows;e++)this.set(e,r,t[e]);return this}swapColumns(r,t){ne(this,r),ne(this,t);for(let e=0;e<this.rows;e++){let n=this.get(e,r);this.set(e,r,this.get(e,t)),this.set(e,t,n)}return this}addRowVector(r){r=be(this,r);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)+r[e]);return this}subRowVector(r){r=be(this,r);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)-r[e]);return this}mulRowVector(r){r=be(this,r);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)*r[e]);return this}divRowVector(r){r=be(this,r);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)/r[e]);return this}addColumnVector(r){r=Ne(this,r);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)+r[t]);return this}subColumnVector(r){r=Ne(this,r);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)-r[t]);return this}mulColumnVector(r){r=Ne(this,r);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)*r[t]);return this}divColumnVector(r){r=Ne(this,r);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)/r[t]);return this}mulRow(r,t){re(this,r);for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t);return this}mulColumn(r,t){ne(this,r);for(let e=0;e<this.rows;e++)this.set(e,r,this.get(e,r)*t);return this}max(r){if(this.isEmpty())return NaN;switch(r){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t[e]&&(t[e]=this.get(e,n));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t[n]&&(t[n]=this.get(e,n));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}default:throw new Error(`invalid option: ${r}`)}}maxIndex(){Me(this);let r=this.get(0,0),t=[0,0];for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>r&&(r=this.get(e,n),t[0]=e,t[1]=n);return t}min(r){if(this.isEmpty())return NaN;switch(r){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t[e]&&(t[e]=this.get(e,n));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t[n]&&(t[n]=this.get(e,n));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}default:throw new Error(`invalid option: ${r}`)}}minIndex(){Me(this);let r=this.get(0,0),t=[0,0];for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<r&&(r=this.get(e,n),t[0]=e,t[1]=n);return t}maxRow(r){if(re(this,r),this.isEmpty())return NaN;let t=this.get(r,0);for(let e=1;e<this.columns;e++)this.get(r,e)>t&&(t=this.get(r,e));return t}maxRowIndex(r){re(this,r),Me(this);let t=this.get(r,0),e=[r,0];for(let n=1;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[1]=n);return e}minRow(r){if(re(this,r),this.isEmpty())return NaN;let t=this.get(r,0);for(let e=1;e<this.columns;e++)this.get(r,e)<t&&(t=this.get(r,e));return t}minRowIndex(r){re(this,r),Me(this);let t=this.get(r,0),e=[r,0];for(let n=1;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[1]=n);return e}maxColumn(r){if(ne(this,r),this.isEmpty())return NaN;let t=this.get(0,r);for(let e=1;e<this.rows;e++)this.get(e,r)>t&&(t=this.get(e,r));return t}maxColumnIndex(r){ne(this,r),Me(this);let t=this.get(0,r),e=[0,r];for(let n=1;n<this.rows;n++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n);return e}minColumn(r){if(ne(this,r),this.isEmpty())return NaN;let t=this.get(0,r);for(let e=1;e<this.rows;e++)this.get(e,r)<t&&(t=this.get(e,r));return t}minColumnIndex(r){ne(this,r),Me(this);let t=this.get(0,r),e=[0,r];for(let n=1;n<this.rows;n++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n);return e}diag(){let r=Math.min(this.rows,this.columns),t=[];for(let e=0;e<r;e++)t.push(this.get(e,e));return t}norm(r="frobenius"){let t=0;if(r==="max")return this.max();if(r==="frobenius"){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t+=this.get(e,n)*this.get(e,n);return Math.sqrt(t)}throw new RangeError(`unknown norm type: ${r}`)}cumulativeSum(){let r=0;for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)r+=this.get(t,e),this.set(t,e,r);return this}dot(r){gt.isMatrix(r)&&(r=r.to1DArray());let t=this.to1DArray();if(t.length!==r.length)throw new RangeError("vectors do not have the same size");let e=0;for(let n=0;n<t.length;n++)e+=t[n]*r[n];return e}mmul(r){r=ct.checkMatrix(r);let t=this.rows,e=this.columns,n=r.columns,s=new ct(t,n),u=new Float64Array(e);for(let h=0;h<n;h++){for(let f=0;f<e;f++)u[f]=r.get(f,h);for(let f=0;f<t;f++){let p=0;for(let v=0;v<e;v++)p+=this.get(f,v)*u[v];s.set(f,h,p)}}return s}strassen2x2(r){r=ct.checkMatrix(r);let t=new ct(2,2);const e=this.get(0,0),n=r.get(0,0),s=this.get(0,1),u=r.get(0,1),h=this.get(1,0),f=r.get(1,0),p=this.get(1,1),v=r.get(1,1),m=(e+p)*(n+v),b=(h+p)*n,E=e*(u-v),x=p*(f-n),w=(e+s)*v,N=m+x-w+(s-p)*(f+v),A=E+w,S=b+x,L=m-b+E+(h-e)*(n+u);return t.set(0,0,N),t.set(0,1,A),t.set(1,0,S),t.set(1,1,L),t}strassen3x3(r){r=ct.checkMatrix(r);let t=new ct(3,3);const e=this.get(0,0),n=this.get(0,1),s=this.get(0,2),u=this.get(1,0),h=this.get(1,1),f=this.get(1,2),p=this.get(2,0),v=this.get(2,1),m=this.get(2,2),b=r.get(0,0),E=r.get(0,1),x=r.get(0,2),w=r.get(1,0),N=r.get(1,1),A=r.get(1,2),S=r.get(2,0),L=r.get(2,1),C=r.get(2,2),T=(e-u)*(-E+N),R=(-e+u+h)*(b-E+N),I=(u+h)*(-b+E),O=e*b,G=(-e+p+v)*(b-x+A),M=(-e+p)*(x-A),z=(p+v)*(-b+x),$=(-s+v+m)*(N+S-L),P=(s-m)*(N-L),B=s*S,W=(v+m)*(-S+L),U=(-s+h+f)*(A+S-C),K=(s-f)*(A-C),J=(h+f)*(-S+C),Y=O+B+n*w,tt=(e+n+s-u-h-v-m)*N+R+I+O+$+B+W,ot=O+G+z+(e+n+s-h-f-p-v)*A+B+U+J,rt=T+h*(-b+E+w-N-A-S+C)+R+O+B+U+K,F=T+R+I+O+f*L,Z=B+U+K+J+u*x,ut=O+G+M+v*(-b+x+w-N-A-S+L)+$+P+B,nt=$+P+B+W+p*E,H=O+G+M+z+m*C;return t.set(0,0,Y),t.set(0,1,tt),t.set(0,2,ot),t.set(1,0,rt),t.set(1,1,F),t.set(1,2,Z),t.set(2,0,ut),t.set(2,1,nt),t.set(2,2,H),t}mmulStrassen(r){r=ct.checkMatrix(r);let t=this.clone(),e=t.rows,n=t.columns,s=r.rows,u=r.columns;function h(v,m,b){let E=v.rows,x=v.columns;if(E===m&&x===b)return v;{let w=gt.zeros(m,b);return w=w.setSubMatrix(v,0,0),w}}n!==s&&console.warn(`Multiplying ${e} x ${n} and ${s} x ${u} matrix: dimensions do not match.`);let f=Math.max(e,s),p=Math.max(n,u);return t=h(t,f,p),function v(m,b,E,x){if(E<=512||x<=512)return m.mmul(b);E%2==1&&x%2==1?(m=h(m,E+1,x+1),b=h(b,E+1,x+1)):E%2==1?(m=h(m,E+1,x),b=h(b,E+1,x)):x%2==1&&(m=h(m,E,x+1),b=h(b,E,x+1));let w=parseInt(m.rows/2,10),N=parseInt(m.columns/2,10),A=m.subMatrix(0,w-1,0,N-1),S=b.subMatrix(0,w-1,0,N-1),L=m.subMatrix(0,w-1,N,m.columns-1),C=b.subMatrix(0,w-1,N,b.columns-1),T=m.subMatrix(w,m.rows-1,0,N-1),R=b.subMatrix(w,b.rows-1,0,N-1),I=m.subMatrix(w,m.rows-1,N,m.columns-1),O=b.subMatrix(w,b.rows-1,N,b.columns-1),G=v(gt.add(A,I),gt.add(S,O),w,N),M=v(gt.add(T,I),S,w,N),z=v(A,gt.sub(C,O),w,N),$=v(I,gt.sub(R,S),w,N),P=v(gt.add(A,L),O,w,N),B=v(gt.sub(T,A),gt.add(S,C),w,N),W=v(gt.sub(L,I),gt.add(R,O),w,N),U=gt.add(G,$);U.sub(P),U.add(W);let K=gt.add(z,P),J=gt.add(M,$),Y=gt.sub(G,M);Y.add(z),Y.add(B);let tt=gt.zeros(2*U.rows,2*U.columns);return tt=tt.setSubMatrix(U,0,0),tt=tt.setSubMatrix(K,U.rows,0),tt=tt.setSubMatrix(J,0,U.columns),tt=tt.setSubMatrix(Y,U.rows,U.columns),tt.subMatrix(0,E-1,0,x-1)}(t,r=h(r,f,p),f,p)}scaleRows(r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{min:t=0,max:e=1}=r;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(e))throw new TypeError("max must be a number");if(t>=e)throw new RangeError("min must be smaller than max");let n=new ct(this.rows,this.columns);for(let s=0;s<this.rows;s++){const u=this.getRow(s);u.length>0&&to(u,{min:t,max:e,output:u}),n.setRow(s,u)}return n}scaleColumns(r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{min:t=0,max:e=1}=r;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(e))throw new TypeError("max must be a number");if(t>=e)throw new RangeError("min must be smaller than max");let n=new ct(this.rows,this.columns);for(let s=0;s<this.columns;s++){const u=this.getColumn(s);u.length&&to(u,{min:t,max:e,output:u}),n.setColumn(s,u)}return n}flipRows(){const r=Math.ceil(this.columns/2);for(let t=0;t<this.rows;t++)for(let e=0;e<r;e++){let n=this.get(t,e),s=this.get(t,this.columns-1-e);this.set(t,e,s),this.set(t,this.columns-1-e,n)}return this}flipColumns(){const r=Math.ceil(this.rows/2);for(let t=0;t<this.columns;t++)for(let e=0;e<r;e++){let n=this.get(e,t),s=this.get(this.rows-1-e,t);this.set(e,t,s),this.set(this.rows-1-e,t,n)}return this}kroneckerProduct(r){r=ct.checkMatrix(r);let t=this.rows,e=this.columns,n=r.rows,s=r.columns,u=new ct(t*n,e*s);for(let h=0;h<t;h++)for(let f=0;f<e;f++)for(let p=0;p<n;p++)for(let v=0;v<s;v++)u.set(n*h+p,s*f+v,this.get(h,f)*r.get(p,v));return u}kroneckerSum(r){if(r=ct.checkMatrix(r),!this.isSquare()||!r.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let t=this.rows,e=r.rows,n=this.kroneckerProduct(ct.eye(e,e)),s=ct.eye(t,t).kroneckerProduct(r);return n.add(s)}transpose(){let r=new ct(this.columns,this.rows);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)r.set(e,t,this.get(t,e));return r}sortRows(r=io){for(let t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(r));return this}sortColumns(r=io){for(let t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(r));return this}subMatrix(r,t,e,n){oo(this,r,t,e,n);let s=new ct(t-r+1,n-e+1);for(let u=r;u<=t;u++)for(let h=e;h<=n;h++)s.set(u-r,h-e,this.get(u,h));return s}subMatrixRow(r,t,e){if(t===void 0&&(t=0),e===void 0&&(e=this.columns-1),t>e||t<0||t>=this.columns||e<0||e>=this.columns)throw new RangeError("Argument out of range");let n=new ct(r.length,e-t+1);for(let s=0;s<r.length;s++)for(let u=t;u<=e;u++){if(r[s]<0||r[s]>=this.rows)throw new RangeError(`Row index out of range: ${r[s]}`);n.set(s,u-t,this.get(r[s],u))}return n}subMatrixColumn(r,t,e){if(t===void 0&&(t=0),e===void 0&&(e=this.rows-1),t>e||t<0||t>=this.rows||e<0||e>=this.rows)throw new RangeError("Argument out of range");let n=new ct(e-t+1,r.length);for(let s=0;s<r.length;s++)for(let u=t;u<=e;u++){if(r[s]<0||r[s]>=this.columns)throw new RangeError(`Column index out of range: ${r[s]}`);n.set(u-t,s,this.get(u,r[s]))}return n}setSubMatrix(r,t,e){if((r=ct.checkMatrix(r)).isEmpty())return this;oo(this,t,t+r.rows-1,e,e+r.columns-1);for(let n=0;n<r.rows;n++)for(let s=0;s<r.columns;s++)this.set(t+n,e+s,r.get(n,s));return this}selection(r,t){(function(n,s){if(!Yt(s))throw new TypeError("row indices must be an array");for(let u=0;u<s.length;u++)if(s[u]<0||s[u]>=n.rows)throw new RangeError("row indices are out of range")})(this,r),function(n,s){if(!Yt(s))throw new TypeError("column indices must be an array");for(let u=0;u<s.length;u++)if(s[u]<0||s[u]>=n.columns)throw new RangeError("column indices are out of range")}(this,t);let e=new ct(r.length,t.length);for(let n=0;n<r.length;n++){let s=r[n];for(let u=0;u<t.length;u++){let h=t[u];e.set(n,u,this.get(s,h))}}return e}trace(){let r=Math.min(this.rows,this.columns),t=0;for(let e=0;e<r;e++)t+=this.get(e,e);return t}clone(){let r=new ct(this.rows,this.columns);for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)r.set(t,e,this.get(t,e));return r}sum(r){switch(r){case"row":return function(t){let e=Qe(t.rows);for(let n=0;n<t.rows;++n)for(let s=0;s<t.columns;++s)e[n]+=t.get(n,s);return e}(this);case"column":return function(t){let e=Qe(t.columns);for(let n=0;n<t.rows;++n)for(let s=0;s<t.columns;++s)e[s]+=t.get(n,s);return e}(this);case void 0:return function(t){let e=0;for(let n=0;n<t.rows;n++)for(let s=0;s<t.columns;s++)e+=t.get(n,s);return e}(this);default:throw new Error(`invalid option: ${r}`)}}product(r){switch(r){case"row":return function(t){let e=Qe(t.rows,1);for(let n=0;n<t.rows;++n)for(let s=0;s<t.columns;++s)e[n]*=t.get(n,s);return e}(this);case"column":return function(t){let e=Qe(t.columns,1);for(let n=0;n<t.rows;++n)for(let s=0;s<t.columns;++s)e[s]*=t.get(n,s);return e}(this);case void 0:return function(t){let e=1;for(let n=0;n<t.rows;n++)for(let s=0;s<t.columns;s++)e*=t.get(n,s);return e}(this);default:throw new Error(`invalid option: ${r}`)}}mean(r){const t=this.sum(r);switch(r){case"row":for(let e=0;e<this.rows;e++)t[e]/=this.columns;return t;case"column":for(let e=0;e<this.columns;e++)t[e]/=this.rows;return t;case void 0:return t/this.size;default:throw new Error(`invalid option: ${r}`)}}variance(r,t={}){if(typeof r=="object"&&(t=r,r=void 0),typeof t!="object")throw new TypeError("options must be an object");const{unbiased:e=!0,mean:n=this.mean(r)}=t;if(typeof e!="boolean")throw new TypeError("unbiased must be a boolean");switch(r){case"row":if(!Yt(n))throw new TypeError("mean must be an array");return function(s,u,h){const f=s.rows,p=s.columns,v=[];for(let m=0;m<f;m++){let b=0,E=0,x=0;for(let w=0;w<p;w++)x=s.get(m,w)-h[m],b+=x,E+=x*x;u?v.push((E-b*b/p)/(p-1)):v.push((E-b*b/p)/p)}return v}(this,e,n);case"column":if(!Yt(n))throw new TypeError("mean must be an array");return function(s,u,h){const f=s.rows,p=s.columns,v=[];for(let m=0;m<p;m++){let b=0,E=0,x=0;for(let w=0;w<f;w++)x=s.get(w,m)-h[m],b+=x,E+=x*x;u?v.push((E-b*b/f)/(f-1)):v.push((E-b*b/f)/f)}return v}(this,e,n);case void 0:if(typeof n!="number")throw new TypeError("mean must be a number");return function(s,u,h){const f=s.rows,p=s.columns,v=f*p;let m=0,b=0,E=0;for(let x=0;x<f;x++)for(let w=0;w<p;w++)E=s.get(x,w)-h,m+=E,b+=E*E;return u?(b-m*m/v)/(v-1):(b-m*m/v)/v}(this,e,n);default:throw new Error(`invalid option: ${r}`)}}standardDeviation(r,t){typeof r=="object"&&(t=r,r=void 0);const e=this.variance(r,t);if(r===void 0)return Math.sqrt(e);for(let n=0;n<e.length;n++)e[n]=Math.sqrt(e[n]);return e}center(r,t={}){if(typeof r=="object"&&(t=r,r=void 0),typeof t!="object")throw new TypeError("options must be an object");const{center:e=this.mean(r)}=t;switch(r){case"row":if(!Yt(e))throw new TypeError("center must be an array");return function(n,s){for(let u=0;u<n.rows;u++)for(let h=0;h<n.columns;h++)n.set(u,h,n.get(u,h)-s[u])}(this,e),this;case"column":if(!Yt(e))throw new TypeError("center must be an array");return function(n,s){for(let u=0;u<n.rows;u++)for(let h=0;h<n.columns;h++)n.set(u,h,n.get(u,h)-s[h])}(this,e),this;case void 0:if(typeof e!="number")throw new TypeError("center must be a number");return function(n,s){for(let u=0;u<n.rows;u++)for(let h=0;h<n.columns;h++)n.set(u,h,n.get(u,h)-s)}(this,e),this;default:throw new Error(`invalid option: ${r}`)}}scale(r,t={}){if(typeof r=="object"&&(t=r,r=void 0),typeof t!="object")throw new TypeError("options must be an object");let e=t.scale;switch(r){case"row":if(e===void 0)e=function(n){const s=[];for(let u=0;u<n.rows;u++){let h=0;for(let f=0;f<n.columns;f++)h+=Math.pow(n.get(u,f),2)/(n.columns-1);s.push(Math.sqrt(h))}return s}(this);else if(!Yt(e))throw new TypeError("scale must be an array");return function(n,s){for(let u=0;u<n.rows;u++)for(let h=0;h<n.columns;h++)n.set(u,h,n.get(u,h)/s[u])}(this,e),this;case"column":if(e===void 0)e=function(n){const s=[];for(let u=0;u<n.columns;u++){let h=0;for(let f=0;f<n.rows;f++)h+=Math.pow(n.get(f,u),2)/(n.rows-1);s.push(Math.sqrt(h))}return s}(this);else if(!Yt(e))throw new TypeError("scale must be an array");return function(n,s){for(let u=0;u<n.rows;u++)for(let h=0;h<n.columns;h++)n.set(u,h,n.get(u,h)/s[h])}(this,e),this;case void 0:if(e===void 0)e=function(n){const s=n.size-1;let u=0;for(let h=0;h<n.columns;h++)for(let f=0;f<n.rows;f++)u+=Math.pow(n.get(f,h),2)/s;return Math.sqrt(u)}(this);else if(typeof e!="number")throw new TypeError("scale must be a number");return function(n,s){for(let u=0;u<n.rows;u++)for(let h=0;h<n.columns;h++)n.set(u,h,n.get(u,h)/s)}(this,e),this;default:throw new Error(`invalid option: ${r}`)}}toString(r){return ro(this,r)}}function io(o,r){return o-r}gt.prototype.klass="Matrix",typeof Symbol<"u"&&(gt.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return ro(this)}),gt.random=gt.rand,gt.randomInt=gt.randInt,gt.diagonal=gt.diag,gt.prototype.diagonal=gt.prototype.diag,gt.identity=gt.eye,gt.prototype.negate=gt.prototype.neg,gt.prototype.tensorProduct=gt.prototype.kroneckerProduct;class ct extends gt{constructor(r,t){if(super(),ct.isMatrix(r))return r.clone();if(Number.isInteger(r)&&r>=0){if(this.data=[],!(Number.isInteger(t)&&t>=0))throw new TypeError("nColumns must be a positive integer");for(let e=0;e<r;e++)this.data.push(new Float64Array(t))}else{if(!Yt(r))throw new TypeError("First argument must be a positive number or an array");{const e=r;if(typeof(t=(r=e.length)?e[0].length:0)!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<r;n++){if(e[n].length!==t)throw new RangeError("Inconsistent array dimensions");if(!e[n].every(s=>typeof s=="number"))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(e[n]))}}}this.rows=r,this.columns=t}set(r,t,e){return this.data[r][t]=e,this}get(r,t){return this.data[r][t]}removeRow(r){return re(this,r),this.data.splice(r,1),this.rows-=1,this}addRow(r,t){return t===void 0&&(t=r,r=this.rows),re(this,r,!0),t=Float64Array.from(be(this,t)),this.data.splice(r,0,t),this.rows+=1,this}removeColumn(r){ne(this,r);for(let t=0;t<this.rows;t++){const e=new Float64Array(this.columns-1);for(let n=0;n<r;n++)e[n]=this.data[t][n];for(let n=r+1;n<this.columns;n++)e[n-1]=this.data[t][n];this.data[t]=e}return this.columns-=1,this}addColumn(r,t){t===void 0&&(t=r,r=this.columns),ne(this,r,!0),t=Ne(this,t);for(let e=0;e<this.rows;e++){const n=new Float64Array(this.columns+1);let s=0;for(;s<r;s++)n[s]=this.data[e][s];for(n[s++]=t[e];s<this.columns+1;s++)n[s]=this.data[e][s-1];this.data[e]=n}return this.columns+=1,this}}(function(o,r){o.prototype.add=function(t){return typeof t=="number"?this.addS(t):this.addM(t)},o.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t);return this},o.prototype.addM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t.get(e,n));return this},o.add=function(t,e){return new r(t).add(e)},o.prototype.sub=function(t){return typeof t=="number"?this.subS(t):this.subM(t)},o.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t);return this},o.prototype.subM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t.get(e,n));return this},o.sub=function(t,e){return new r(t).sub(e)},o.prototype.subtract=o.prototype.sub,o.prototype.subtractS=o.prototype.subS,o.prototype.subtractM=o.prototype.subM,o.subtract=o.sub,o.prototype.mul=function(t){return typeof t=="number"?this.mulS(t):this.mulM(t)},o.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this},o.prototype.mulM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t.get(e,n));return this},o.mul=function(t,e){return new r(t).mul(e)},o.prototype.multiply=o.prototype.mul,o.prototype.multiplyS=o.prototype.mulS,o.prototype.multiplyM=o.prototype.mulM,o.multiply=o.mul,o.prototype.div=function(t){return typeof t=="number"?this.divS(t):this.divM(t)},o.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t);return this},o.prototype.divM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t.get(e,n));return this},o.div=function(t,e){return new r(t).div(e)},o.prototype.divide=o.prototype.div,o.prototype.divideS=o.prototype.divS,o.prototype.divideM=o.prototype.divM,o.divide=o.div,o.prototype.mod=function(t){return typeof t=="number"?this.modS(t):this.modM(t)},o.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t);return this},o.prototype.modM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t.get(e,n));return this},o.mod=function(t,e){return new r(t).mod(e)},o.prototype.modulus=o.prototype.mod,o.prototype.modulusS=o.prototype.modS,o.prototype.modulusM=o.prototype.modM,o.modulus=o.mod,o.prototype.and=function(t){return typeof t=="number"?this.andS(t):this.andM(t)},o.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t);return this},o.prototype.andM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t.get(e,n));return this},o.and=function(t,e){return new r(t).and(e)},o.prototype.or=function(t){return typeof t=="number"?this.orS(t):this.orM(t)},o.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t);return this},o.prototype.orM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t.get(e,n));return this},o.or=function(t,e){return new r(t).or(e)},o.prototype.xor=function(t){return typeof t=="number"?this.xorS(t):this.xorM(t)},o.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t);return this},o.prototype.xorM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t.get(e,n));return this},o.xor=function(t,e){return new r(t).xor(e)},o.prototype.leftShift=function(t){return typeof t=="number"?this.leftShiftS(t):this.leftShiftM(t)},o.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t);return this},o.prototype.leftShiftM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t.get(e,n));return this},o.leftShift=function(t,e){return new r(t).leftShift(e)},o.prototype.signPropagatingRightShift=function(t){return typeof t=="number"?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},o.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t);return this},o.prototype.signPropagatingRightShiftM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t.get(e,n));return this},o.signPropagatingRightShift=function(t,e){return new r(t).signPropagatingRightShift(e)},o.prototype.rightShift=function(t){return typeof t=="number"?this.rightShiftS(t):this.rightShiftM(t)},o.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t);return this},o.prototype.rightShiftM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t.get(e,n));return this},o.rightShift=function(t,e){return new r(t).rightShift(e)},o.prototype.zeroFillRightShift=o.prototype.rightShift,o.prototype.zeroFillRightShiftS=o.prototype.rightShiftS,o.prototype.zeroFillRightShiftM=o.prototype.rightShiftM,o.zeroFillRightShift=o.rightShift,o.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},o.not=function(t){return new r(t).not()},o.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},o.abs=function(t){return new r(t).abs()},o.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},o.acos=function(t){return new r(t).acos()},o.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},o.acosh=function(t){return new r(t).acosh()},o.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},o.asin=function(t){return new r(t).asin()},o.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},o.asinh=function(t){return new r(t).asinh()},o.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},o.atan=function(t){return new r(t).atan()},o.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},o.atanh=function(t){return new r(t).atanh()},o.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},o.cbrt=function(t){return new r(t).cbrt()},o.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},o.ceil=function(t){return new r(t).ceil()},o.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},o.clz32=function(t){return new r(t).clz32()},o.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},o.cos=function(t){return new r(t).cos()},o.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},o.cosh=function(t){return new r(t).cosh()},o.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},o.exp=function(t){return new r(t).exp()},o.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},o.expm1=function(t){return new r(t).expm1()},o.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},o.floor=function(t){return new r(t).floor()},o.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},o.fround=function(t){return new r(t).fround()},o.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},o.log=function(t){return new r(t).log()},o.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},o.log1p=function(t){return new r(t).log1p()},o.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},o.log10=function(t){return new r(t).log10()},o.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},o.log2=function(t){return new r(t).log2()},o.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},o.round=function(t){return new r(t).round()},o.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},o.sign=function(t){return new r(t).sign()},o.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},o.sin=function(t){return new r(t).sin()},o.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},o.sinh=function(t){return new r(t).sinh()},o.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},o.sqrt=function(t){return new r(t).sqrt()},o.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},o.tan=function(t){return new r(t).tan()},o.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},o.tanh=function(t){return new r(t).tanh()},o.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},o.trunc=function(t){return new r(t).trunc()},o.pow=function(t,e){return new r(t).pow(e)},o.prototype.pow=function(t){return typeof t=="number"?this.powS(t):this.powM(t)},o.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.pow(this.get(e,n),t));return this},o.prototype.powM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.pow(this.get(e,n),t.get(e,n)));return this}})(gt,ct);class ja extends gt{constructor(r){super(),this.data=r,this.rows=r.length,this.columns=r[0].length}set(r,t,e){return this.data[r][t]=e,this}get(r,t){return this.data[r][t]}}function Se(o,r){let t=0;return Math.abs(o)>Math.abs(r)?(t=r/o,Math.abs(o)*Math.sqrt(1+t*t)):r!==0?(t=o/r,Math.abs(r)*Math.sqrt(1+t*t)):0}class ao{constructor(r,t={}){if((r=ja.checkMatrix(r)).isEmpty())throw new Error("Matrix must be non-empty");let e=r.rows,n=r.columns;const{computeLeftSingularVectors:s=!0,computeRightSingularVectors:u=!0,autoTranspose:h=!1}=t;let f,p=!!s,v=!!u,m=!1;if(e<n)if(h){f=r.transpose(),e=f.rows,n=f.columns,m=!0;let M=p;p=v,v=M}else f=r.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else f=r.clone();let b=Math.min(e,n),E=Math.min(e+1,n),x=new Float64Array(E),w=new ct(e,b),N=new ct(n,n),A=new Float64Array(n),S=new Float64Array(e),L=new Float64Array(E);for(let M=0;M<E;M++)L[M]=M;let C=Math.min(e-1,n),T=Math.max(0,Math.min(n-2,e)),R=Math.max(C,T);for(let M=0;M<R;M++){if(M<C){x[M]=0;for(let z=M;z<e;z++)x[M]=Se(x[M],f.get(z,M));if(x[M]!==0){f.get(M,M)<0&&(x[M]=-x[M]);for(let z=M;z<e;z++)f.set(z,M,f.get(z,M)/x[M]);f.set(M,M,f.get(M,M)+1)}x[M]=-x[M]}for(let z=M+1;z<n;z++){if(M<C&&x[M]!==0){let $=0;for(let P=M;P<e;P++)$+=f.get(P,M)*f.get(P,z);$=-$/f.get(M,M);for(let P=M;P<e;P++)f.set(P,z,f.get(P,z)+$*f.get(P,M))}A[z]=f.get(M,z)}if(p&&M<C)for(let z=M;z<e;z++)w.set(z,M,f.get(z,M));if(M<T){A[M]=0;for(let z=M+1;z<n;z++)A[M]=Se(A[M],A[z]);if(A[M]!==0){A[M+1]<0&&(A[M]=0-A[M]);for(let z=M+1;z<n;z++)A[z]/=A[M];A[M+1]+=1}if(A[M]=-A[M],M+1<e&&A[M]!==0){for(let z=M+1;z<e;z++)S[z]=0;for(let z=M+1;z<e;z++)for(let $=M+1;$<n;$++)S[z]+=A[$]*f.get(z,$);for(let z=M+1;z<n;z++){let $=-A[z]/A[M+1];for(let P=M+1;P<e;P++)f.set(P,z,f.get(P,z)+$*S[P])}}if(v)for(let z=M+1;z<n;z++)N.set(z,M,A[z])}}let I=Math.min(n,e+1);if(C<n&&(x[C]=f.get(C,C)),e<I&&(x[I-1]=0),T+1<I&&(A[T]=f.get(T,I-1)),A[I-1]=0,p){for(let M=C;M<b;M++){for(let z=0;z<e;z++)w.set(z,M,0);w.set(M,M,1)}for(let M=C-1;M>=0;M--)if(x[M]!==0){for(let z=M+1;z<b;z++){let $=0;for(let P=M;P<e;P++)$+=w.get(P,M)*w.get(P,z);$=-$/w.get(M,M);for(let P=M;P<e;P++)w.set(P,z,w.get(P,z)+$*w.get(P,M))}for(let z=M;z<e;z++)w.set(z,M,-w.get(z,M));w.set(M,M,1+w.get(M,M));for(let z=0;z<M-1;z++)w.set(z,M,0)}else{for(let z=0;z<e;z++)w.set(z,M,0);w.set(M,M,1)}}if(v)for(let M=n-1;M>=0;M--){if(M<T&&A[M]!==0)for(let z=M+1;z<n;z++){let $=0;for(let P=M+1;P<n;P++)$+=N.get(P,M)*N.get(P,z);$=-$/N.get(M+1,M);for(let P=M+1;P<n;P++)N.set(P,z,N.get(P,z)+$*N.get(P,M))}for(let z=0;z<n;z++)N.set(z,M,0);N.set(M,M,1)}let O=I-1,G=Number.EPSILON;for(;I>0;){let M,z;for(M=I-2;M>=-1&&M!==-1;M--){const $=Number.MIN_VALUE+G*Math.abs(x[M]+Math.abs(x[M+1]));if(Math.abs(A[M])<=$||Number.isNaN(A[M])){A[M]=0;break}}if(M===I-2)z=4;else{let $;for($=I-1;$>=M&&$!==M;$--){let P=($!==I?Math.abs(A[$]):0)+($!==M+1?Math.abs(A[$-1]):0);if(Math.abs(x[$])<=G*P){x[$]=0;break}}$===M?z=3:$===I-1?z=1:(z=2,M=$)}switch(M++,z){case 1:{let $=A[I-2];A[I-2]=0;for(let P=I-2;P>=M;P--){let B=Se(x[P],$),W=x[P]/B,U=$/B;if(x[P]=B,P!==M&&($=-U*A[P-1],A[P-1]=W*A[P-1]),v)for(let K=0;K<n;K++)B=W*N.get(K,P)+U*N.get(K,I-1),N.set(K,I-1,-U*N.get(K,P)+W*N.get(K,I-1)),N.set(K,P,B)}break}case 2:{let $=A[M-1];A[M-1]=0;for(let P=M;P<I;P++){let B=Se(x[P],$),W=x[P]/B,U=$/B;if(x[P]=B,$=-U*A[P],A[P]=W*A[P],p)for(let K=0;K<e;K++)B=W*w.get(K,P)+U*w.get(K,M-1),w.set(K,M-1,-U*w.get(K,P)+W*w.get(K,M-1)),w.set(K,P,B)}break}case 3:{const $=Math.max(Math.abs(x[I-1]),Math.abs(x[I-2]),Math.abs(A[I-2]),Math.abs(x[M]),Math.abs(A[M])),P=x[I-1]/$,B=x[I-2]/$,W=A[I-2]/$,U=x[M]/$,K=A[M]/$,J=((B+P)*(B-P)+W*W)/2,Y=P*W*(P*W);let tt=0;J===0&&Y===0||(tt=J<0?0-Math.sqrt(J*J+Y):Math.sqrt(J*J+Y),tt=Y/(J+tt));let ot=(U+P)*(U-P)+tt,rt=U*K;for(let F=M;F<I-1;F++){let Z=Se(ot,rt);Z===0&&(Z=Number.MIN_VALUE);let ut=ot/Z,nt=rt/Z;if(F!==M&&(A[F-1]=Z),ot=ut*x[F]+nt*A[F],A[F]=ut*A[F]-nt*x[F],rt=nt*x[F+1],x[F+1]=ut*x[F+1],v)for(let H=0;H<n;H++)Z=ut*N.get(H,F)+nt*N.get(H,F+1),N.set(H,F+1,-nt*N.get(H,F)+ut*N.get(H,F+1)),N.set(H,F,Z);if(Z=Se(ot,rt),Z===0&&(Z=Number.MIN_VALUE),ut=ot/Z,nt=rt/Z,x[F]=Z,ot=ut*A[F]+nt*x[F+1],x[F+1]=-nt*A[F]+ut*x[F+1],rt=nt*A[F+1],A[F+1]=ut*A[F+1],p&&F<e-1)for(let H=0;H<e;H++)Z=ut*w.get(H,F)+nt*w.get(H,F+1),w.set(H,F+1,-nt*w.get(H,F)+ut*w.get(H,F+1)),w.set(H,F,Z)}A[I-2]=ot;break}case 4:if(x[M]<=0&&(x[M]=x[M]<0?-x[M]:0,v))for(let $=0;$<=O;$++)N.set($,M,-N.get($,M));for(;M<O&&!(x[M]>=x[M+1]);){let $=x[M];if(x[M]=x[M+1],x[M+1]=$,v&&M<n-1)for(let P=0;P<n;P++)$=N.get(P,M+1),N.set(P,M+1,N.get(P,M)),N.set(P,M,$);if(p&&M<e-1)for(let P=0;P<e;P++)$=w.get(P,M+1),w.set(P,M+1,w.get(P,M)),w.set(P,M,$);M++}I--}}if(m){let M=N;N=w,w=M}this.m=e,this.n=n,this.s=x,this.U=w,this.V=N}solve(r){let t=r,e=this.threshold,n=this.s.length,s=ct.zeros(n,n);for(let b=0;b<n;b++)Math.abs(this.s[b])<=e?s.set(b,b,0):s.set(b,b,1/this.s[b]);let u=this.U,h=this.rightSingularVectors,f=h.mmul(s),p=h.rows,v=u.rows,m=ct.zeros(p,v);for(let b=0;b<p;b++)for(let E=0;E<v;E++){let x=0;for(let w=0;w<n;w++)x+=f.get(b,w)*u.get(E,w);m.set(b,E,x)}return m.mmul(t)}solveForDiagonal(r){return this.solve(ct.diag(r))}inverse(){let r=this.V,t=this.threshold,e=r.rows,n=r.columns,s=new ct(e,this.s.length);for(let v=0;v<e;v++)for(let m=0;m<n;m++)Math.abs(this.s[m])>t&&s.set(v,m,r.get(v,m)/this.s[m]);let u=this.U,h=u.rows,f=u.columns,p=new ct(e,h);for(let v=0;v<e;v++)for(let m=0;m<h;m++){let b=0;for(let E=0;E<f;E++)b+=s.get(v,E)*u.get(m,E);p.set(v,m,b)}return p}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let r=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,t=0,e=this.s;for(let n=0,s=e.length;n<s;n++)e[n]>r&&t++;return t}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return ct.diag(this.s)}}var qa={center:[0,0],linkDistance:50},so=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="mds",this.options=i(i({},qa),r)}return o.prototype.execute=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return[2,this.genericMDSLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return this.genericMDSLayout(!0,r,t),[2]})})},o.prototype.genericMDSLayout=function(r,t,e){return c(this,void 0,void 0,function(){var n,s,u,h,f,p,v,m,b,E,x,w;return g(this,function(N){return n=i(i({},this.options),e),s=n.center,u=s===void 0?[0,0]:s,h=n.linkDistance,f=h===void 0?50:h,p=t.getAllNodes(),v=t.getAllEdges(),p!=null&&p.length&&p.length!==1?(m=dt({nodes:p,edges:v},!1),b=at(m),Fa(b),E=yt(b,f),x=Va(E),w=[],x.forEach(function(A,S){var L=xt(p[S]);L.data.x=A[0]+u[0],L.data.y=A[1]+u[1],w.push(L)}),r&&w.forEach(function(A){return t.mergeNodeData(A.id,{x:A.data.x,y:A.data.y})}),[2,{nodes:w,edges:v}]):[2,we(t,r,u)]})})},o}(),Fa=function(o){var r=-999999;o.forEach(function(t){t.forEach(function(e){e!==1/0&&r<e&&(r=e)})}),o.forEach(function(t,e){t.forEach(function(n,s){n===1/0&&(o[e][s]=r)})})},Va=function(o){var r=ct.mul(ct.pow(o,2),-.5),t=r.mean("row"),e=r.mean("column"),n=r.mean();r.add(n).subRowVector(t).subColumnVector(e);var s=new ao(r),u=ct.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map(function(h){return ct.mul([h],[u]).toJSON()[0].splice(0,2)})},Ua={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},Wa=function(o,r,t,e,n,s){r.forEach(function(u,h){t[h]={x:0,y:0},r.forEach(function(f,p){if(h!==p&&n[h]===n[p]){var v=u.x-f.x,m=u.y-f.y,b=Math.sqrt(v*v+m*m);if(b===0){b=1;var E=h>p?1:-1;v=.01*E,m=.01*E}if(b<s(o[h])/2+s(o[p])/2){var x=e*e/b;t[h].x+=v/b*x,t[h].y+=m/b*x}}})})},Ba=function(o,r,t,e,n,s,u,h){var f=s||u/10;return e&&r.forEach(function(p,v){var m=o[v].x-o[n].x,b=o[v].y-o[n].y,E=Math.sqrt(m*m+b*b),x=b/E,w=-m/E,N=Math.sqrt(p.x*p.x+p.y*p.y),A=Math.acos((x*p.x+w*p.y)/N);A>Math.PI/2&&(A-=Math.PI/2,x*=-1,w*=-1);var S=Math.cos(A)*N;p.x=x*S,p.y=w*S}),o.forEach(function(p,v){if(v!==n){var m=Math.sqrt(r[v].x*r[v].x+r[v].y*r[v].y);if(m>0&&v!==n){var b=Math.min(f*(t/800),m);if(p.x+=r[v].x/m*b,p.y+=r[v].y/m*b,e){var E=p.x-o[n].x,x=p.y-o[n].y,w=Math.sqrt(E*E+x*x);E=E/w*h[v],x=x/w*h[v],p.x=o[n].x+E,p.y=o[n].y+x}}}}),o},Ha={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},uo=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="radial",this.options=i(i({},Ha),r)}return o.prototype.execute=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return[2,this.genericRadialLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return this.genericRadialLayout(!0,r,t),[2]})})},o.prototype.genericRadialLayout=function(r,t,e){return c(this,void 0,void 0,function(){var n,s,u,h,f,p,v,m,b,E,x,w,N,A,S,L,C,T,R,I,O,G,M,z,$,P,B,W,U,K,J,Y,tt,ot,rt,F,Z,ut,nt,H,ht,Et,mt;return g(this,function(Gt){if(n=i(i({},this.options),e),s=n.width,u=n.height,h=n.center,f=n.focusNode,p=n.unitRadius,v=n.nodeSize,m=n.nodeSpacing,b=n.strictRadial,E=n.preventOverlap,x=n.maxPreventOverlapIteration,w=n.sortBy,N=n.linkDistance,A=N===void 0?50:N,S=n.sortStrength,L=S===void 0?10:S,C=n.maxIteration,T=C===void 0?1e3:C,R=t.getAllNodes(),I=t.getAllEdges(),O=s||typeof window>"u"?s:window.innerWidth,G=u||typeof window>"u"?u:window.innerHeight,M=h||[O/2,G/2],!(R!=null&&R.length)||R.length===1)return[2,we(t,r,M)];if(z=R[0],Re(f)){for($=0;$<R.length;$++)if(R[$].id===f){z=R[$];break}}else z=f||R[0];return P=Qa(R,z.id),B=dt({nodes:R,edges:I},!1),W=at(B),U=Xa(W,P),Ja(W,P,U+1),K=W[P],J=O-M[0]>M[0]?M[0]:O-M[0],Y=G-M[1]>M[1]?M[1]:G-M[1],J===0&&(J=O/2),Y===0&&(Y=G/2),tt=Math.min(J,Y),ot=Math.max.apply(Math,k([],y(K))),rt=[],F=p||tt/ot,K.forEach(function(Dt,wt){rt[wt]=Dt*F}),Z=Ka(R,W,A,rt,F,w,L),ut=Ya(Z),nt=function(Dt,wt,vt){try{var pt=ct.mul(ct.pow(wt,2),-.5),Ot=pt.mean("row"),St=pt.mean("column"),At=pt.mean();pt.add(At).subRowVector(Ot).subColumnVector(St);var Bt=new ao(pt),kr=ct.sqrt(Bt.diagonalMatrix).diagonal();return Bt.leftSingularVectors.toJSON().map(function(rr){return ct.mul([rr],[kr]).toJSON()[0].splice(0,Dt)})}catch{for(var Xe=[],Ze=0;Ze<wt.length;Ze++){var tr=Math.random()*vt,er=Math.random()*vt;Xe.push([tr,er])}return Xe}}(A,Z,A),H=nt.map(function(Dt){var wt=y(Dt,2),vt=wt[0],pt=wt[1];return{x:(isNaN(vt)?Math.random()*A:vt)-nt[P][0],y:(isNaN(pt)?Math.random()*A:pt)-nt[P][1]}}),this.run(T,H,ut,Z,rt,P),E&&(ht=cr(v,m),Et={nodes:R,nodeSizeFunc:ht,positions:H,radii:rt,height:G,width:O,strictRadial:!!b,focusIdx:P,iterations:x||200,k:H.length/4.5},H=function(Dt,wt){for(var vt=i(i({},Ua),wt),pt=vt.positions,Ot=vt.iterations,St=vt.width,At=vt.k,Bt=vt.speed,kr=Bt===void 0?100:Bt,Xe=vt.strictRadial,Ze=vt.focusIdx,tr=vt.radii,er=tr===void 0?[]:tr,rr=vt.nodeSizeFunc,rs=Dt.getAllNodes(),_r=[],ns=St/10,lo=0;lo<Ot;lo++)pt.forEach(function(ad,os){_r[os]={x:0,y:0}}),Wa(rs,pt,_r,At,er,rr),Ba(pt,_r,kr,Xe,Ze,ns,St,er);return pt}(t,Et)),mt=[],H.forEach(function(Dt,wt){var vt=xt(R[wt]);vt.data.x=Dt.x+M[0],vt.data.y=Dt.y+M[1],mt.push(vt)}),r&&mt.forEach(function(Dt){return t.mergeNodeData(Dt.id,{x:Dt.data.x,y:Dt.data.y})}),[2,{nodes:mt,edges:I}]})})},o.prototype.run=function(r,t,e,n,s,u){for(var h=0;h<=r;h++){var f=h/r;this.oneIteration(f,t,s,n,e,u)}},o.prototype.oneIteration=function(r,t,e,n,s,u){var h=1-r;t.forEach(function(f,p){var v=Qt(f,{x:0,y:0}),m=v===0?0:1/v;if(p!==u){var b=0,E=0,x=0;t.forEach(function(N,A){if(p!==A){var S=Qt(f,N),L=S===0?0:1/S,C=n[A][p];x+=s[p][A],b+=s[p][A]*(N.x+C*(f.x-N.x)*L),E+=s[p][A]*(N.y+C*(f.y-N.y)*L)}});var w=e[p]===0?0:1/e[p];x*=h,x+=r*w*w,b*=h,b+=r*w*f.x*m,f.x=b/x,E*=h,E+=r*w*f.y*m,f.y=E/x}})},o}(),Ka=function(o,r,t,e,n,s,u){if(!o)return[];var h=[];if(r){var f={};r.forEach(function(p,v){var m=[];p.forEach(function(b,E){var x,w;if(v===E)m.push(0);else if(e[v]===e[E])if(s==="data")m.push(b*(Math.abs(v-E)*u)/(e[v]/n));else if(s){var N=void 0,A=void 0;if(f[o[v].id])N=f[o[v].id];else{var S=(s==="id"?o[v].id:(x=o[v].data)===null||x===void 0?void 0:x[s])||0;N=Re(S)?S.charCodeAt(0):S,f[o[v].id]=N}f[o[E].id]?A=f[o[E].id]:(S=(s==="id"?o[E].id:(w=o[E].data)===null||w===void 0?void 0:w[s])||0,A=Re(S)?S.charCodeAt(0):S,f[o[E].id]=A),m.push(b*(Math.abs(N-A)*u)/(e[v]/n))}else m.push(b*t/(e[v]/n));else{var L=(t+n)/2;m.push(b*L)}}),h.push(m)})}return h},Ya=function(o){for(var r=o.length,t=o[0].length,e=[],n=0;n<r;n++){for(var s=[],u=0;u<t;u++)o[n][u]!==0?s.push(1/(o[n][u]*o[n][u])):s.push(0);e.push(s)}return e},Qa=function(o,r){var t=-1;return o.forEach(function(e,n){e.id===r&&(t=n)}),Math.max(t,0)},Ja=function(o,r,t){for(var e=o.length,n=0;n<e;n++)if(o[r][n]===1/0){o[r][n]=t,o[n][r]=t;for(var s=0;s<e;s++)o[n][s]!==1/0&&o[r][s]===1/0&&(o[r][s]=t+o[n][s],o[s][r]=t+o[n][s])}for(n=0;n<e;n++)if(n!==r){for(s=0;s<e;s++)if(o[n][s]===1/0){var u=Math.abs(o[r][n]-o[r][s]);u=u===0?1:u,o[n][s]=u}}},Xa=function(o,r){for(var t=0,e=0;e<o[r].length;e++)o[r][e]!==1/0&&(t=o[r][e]>t?o[r][e]:t);return t},Za={center:[0,0],width:300,height:300},ho=function(){function o(r){r===void 0&&(r={}),this.options=r,this.id="random",this.options=i(i({},Za),r)}return o.prototype.execute=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return[2,this.genericRandomLayout(!1,r,t)]})})},o.prototype.assign=function(r,t){return c(this,void 0,void 0,function(){return g(this,function(e){return this.genericRandomLayout(!0,r,t),[2]})})},o.prototype.genericRandomLayout=function(r,t,e){return c(this,void 0,void 0,function(){var n,s,u,h,f,p,v,m,b;return g(this,function(E){return n=i(i({},this.options),e),s=n.center,u=n.width,h=n.height,f=t.getAllNodes(),p=u||typeof window>"u"?u:window.innerWidth,v=h||typeof window>"u"?h:window.innerHeight,m=s||[p/2,v/2],b=[],f&&f.forEach(function(x){b.push({id:x.id,data:{x:.9*(Math.random()-.5)*p+m[0],y:.9*(Math.random()-.5)*v+m[1]}})}),r&&b.forEach(function(x){return t.mergeNodeData(x.id,{x:x.data.x,y:x.data.y})}),[2,{nodes:b,edges:t.getAllEdges()}]})})},o}(),co={circular:Wr,concentric:Hr,mds:so,random:ho,grid:Jn,radial:uo,force:Bn,d3force:hn,fruchterman:Qn,forceAtlas2:Yn,dagre:Fn};function ts(o,r){co[o]=r}function es(o){return!!o.tick&&!!o.stop}})();var ud=$e.E9,dd=$e.y7,hd=$e.O2,Lr=$e.ul,_t=function(){return _t=Object.assign||function(a){for(var i,d=1,c=arguments.length;d<c;d++){i=arguments[d];for(var g in i)Object.prototype.hasOwnProperty.call(i,g)&&(a[g]=i[g])}return a},_t.apply(this,arguments)};function se(l,a,i,d){function c(g){return g instanceof i?g:new i(function(y){y(g)})}return new(i||(i=Promise))(function(g,y){function k(j){try{_(d.next(j))}catch(q){y(q)}}function D(j){try{_(d.throw(j))}catch(q){y(q)}}function _(j){j.done?g(j.value):c(j.value).then(k,D)}_((d=d.apply(l,a||[])).next())})}function ue(l,a){var i={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},d,c,g,y;return y={next:k(0),throw:k(1),return:k(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function k(_){return function(j){return D([_,j])}}function D(_){if(d)throw new TypeError("Generator is already executing.");for(;y&&(y=0,_[0]&&(i=0)),i;)try{if(d=1,c&&(g=_[0]&2?c.return:_[0]?c.throw||((g=c.return)&&g.call(c),0):c.next)&&!(g=g.call(c,_[1])).done)return g;switch(c=0,g&&(_=[_[0]&2,g.value]),_[0]){case 0:case 1:g=_;break;case 4:return i.label++,{value:_[1],done:!1};case 5:i.label++,c=_[1],_=[0];continue;case 7:_=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(_[0]===6||_[0]===2)){i=0;continue}if(_[0]===3&&(!g||_[1]>g[0]&&_[1]<g[3])){i.label=_[1];break}if(_[0]===6&&i.label<g[1]){i.label=g[1],g=_;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(_);break}g[2]&&i.ops.pop(),i.trys.pop();continue}_=a.call(l,i)}catch(j){_=[6,j],c=0}finally{d=g=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}}const bo=Symbol("Comlink.proxy"),us=Symbol("Comlink.endpoint"),ds=Symbol("Comlink.releaseProxy"),Ir=Symbol("Comlink.thrown"),No=l=>typeof l=="object"&&l!==null||typeof l=="function",hs={canHandle:l=>No(l)&&l[bo],serialize(l){const{port1:a,port2:i}=new MessageChannel;return So(l,a),[i,[i]]},deserialize(l){return l.start(),ko(l)}},cs={canHandle:l=>No(l)&&Ir in l,serialize({value:l}){let a;return l instanceof Error?a={isError:!0,value:{message:l.message,name:l.name,stack:l.stack}}:a={isError:!1,value:l},[a,[]]},deserialize(l){throw l.isError?Object.assign(new Error(l.value.message),l.value):l.value}},Mo=new Map([["proxy",hs],["throw",cs]]);function So(l,a=self){a.addEventListener("message",function i(d){if(!d||!d.data)return;const{id:c,type:g,path:y}=Object.assign({path:[]},d.data),k=(d.data.argumentList||[]).map(me);let D;try{const _=y.slice(0,-1).reduce((q,V)=>q[V],l),j=y.reduce((q,V)=>q[V],l);switch(g){case"GET":D=j;break;case"SET":_[y.slice(-1)[0]]=me(d.data.value),D=!0;break;case"APPLY":D=j.apply(_,k);break;case"CONSTRUCT":{const q=new j(...k);D=ps(q)}break;case"ENDPOINT":{const{port1:q,port2:V}=new MessageChannel;So(l,V),D=gs(q,[q])}break;case"RELEASE":D=void 0;break;default:return}}catch(_){D={value:_,[Ir]:0}}Promise.resolve(D).catch(_=>({value:_,[Ir]:0})).then(_=>{const[j,q]=Cr(_);a.postMessage(Object.assign(Object.assign({},j),{id:c}),q),g==="RELEASE"&&(a.removeEventListener("message",i),Ao(a))})}),a.start&&a.start()}function ls(l){return l.constructor.name==="MessagePort"}function Ao(l){ls(l)&&l.close()}function ko(l,a){return Tr(l,[],a)}function nr(l){if(l)throw new Error("Proxy has been released and is not useable")}function Tr(l,a=[],i=function(){}){let d=!1;const c=new Proxy(i,{get(g,y){if(nr(d),y===ds)return()=>Ae(l,{type:"RELEASE",path:a.map(k=>k.toString())}).then(()=>{Ao(l),d=!0});if(y==="then"){if(a.length===0)return{then:()=>c};const k=Ae(l,{type:"GET",path:a.map(D=>D.toString())}).then(me);return k.then.bind(k)}return Tr(l,[...a,y])},set(g,y,k){nr(d);const[D,_]=Cr(k);return Ae(l,{type:"SET",path:[...a,y].map(j=>j.toString()),value:D},_).then(me)},apply(g,y,k){nr(d);const D=a[a.length-1];if(D===us)return Ae(l,{type:"ENDPOINT"}).then(me);if(D==="bind")return Tr(l,a.slice(0,-1));const[_,j]=go(k);return Ae(l,{type:"APPLY",path:a.map(q=>q.toString()),argumentList:_},j).then(me)},construct(g,y){nr(d);const[k,D]=go(y);return Ae(l,{type:"CONSTRUCT",path:a.map(_=>_.toString()),argumentList:k},D).then(me)}});return c}function fs(l){return Array.prototype.concat.apply([],l)}function go(l){const a=l.map(Cr);return[a.map(i=>i[0]),fs(a.map(i=>i[1]))]}const _o=new WeakMap;function gs(l,a){return _o.set(l,a),l}function ps(l){return Object.assign(l,{[bo]:!0})}function Cr(l){for(const[a,i]of Mo)if(i.canHandle(l)){const[d,c]=i.serialize(l);return[{type:"HANDLER",name:a,value:d},c]}return[{type:"RAW",value:l},_o.get(l)||[]]}function me(l){switch(l.type){case"HANDLER":return Mo.get(l.name).deserialize(l.value);case"RAW":return l.value}}function Ae(l,a,i){return new Promise(d=>{const c=vs();l.addEventListener("message",function g(y){!y.data||!y.data.id||y.data.id!==c||(l.removeEventListener("message",g),d(y.data))}),l.start&&l.start(),l.postMessage(Object.assign({id:c},a),i)})}function vs(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}function cd(l){return l===void 0&&(l=!0),se(this,void 0,void 0,function(){var a,i;return ue(this,function(d){switch(d.label){case 0:return a=ko(new Worker(new URL("./wasm-worker.js",import.meta.resolve),{type:"module"})),[4,a(l)];case 1:return i=d.sent(),[2,i]}})})}var ys={}.toString,ms=function(l,a){return ys.call(l)==="[object "+a+"]"};const ws=ms;var xs=function(l){return ws(l,"Number")};const he=xs;var Gr=function(l,a,i){var d=[],c=[],g=[],y=[],k={};return l.forEach(function(D,_){k[D.id]=_,d.push(D.data.x,D.data.y),i===3&&d.push(D.data.z),c.push(D.data.mass||1)}),a.forEach(function(D){var _=D.data.weight||1,j=k[D.source],q=k[D.target];j!==void 0&&q!==void 0&&(g.push([q,j]),y.push(_),c[j]+=_,c[q]+=_)}),{nodes:d,masses:c,edges:g,weights:y}};function $r(l){return{mean:0,min:1,max:2}[l]}var Es={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster",maxDistance:1/0},ld=function(){function l(a){a===void 0&&(a={}),this.options=a,this.id="fruchtermanWASM",this.options=_t(_t({},Es),a)}return l.prototype.execute=function(a,i){return se(this,void 0,void 0,function(){return ue(this,function(d){return[2,this.genericFruchtermanLayout(!1,a,i)]})})},l.prototype.assign=function(a,i){return se(this,void 0,void 0,function(){return ue(this,function(d){return this.genericFruchtermanLayout(!0,a,i),[2]})})},l.prototype.genericFruchtermanLayout=function(a,i,d){return se(this,void 0,void 0,function(){var c,g,y,k,D,_,j,q,V,X,st,ft,Q,at,dt,yt,Tt;return ue(this,function(Ut){switch(Ut.label){case 0:return c=this.formatOptions(d),g=c.threads,y=c.dimensions,k=c.width,D=c.height,_=c.center,j=c.maxIteration,q=c.minMovement,V=c.distanceThresholdMode,X=c.gravity,st=c.speed,ft=c.maxDistance,Q=i.getAllNodes(),at=i.getAllEdges(),Q!=null&&Q.length?Q.length===1?(a&&i.mergeNodeData(Q[0].id,{x:_[0],y:_[1],z:y===3?_[2]:void 0}),[2,{nodes:[_t(_t({},Q[0]),{data:_t(_t({},Q[0].data),{x:_[0],y:_[1],z:y===3?_[2]:void 0})})],edges:at}]):(dt=Q.map(function(kt){return Lr(kt,[k,D])}),dt.forEach(function(kt,Rt){he(kt.data.x)||(kt.data.x=Math.random()*k),he(kt.data.y)||(kt.data.y=Math.random()*D),y===3&&(he(kt.data.z)||(kt.data.z=Math.random()*Math.sqrt(k*D)))}),yt=Gr(dt,at,y),[4,g.fruchterman({dimensions:y,nodes:yt.nodes,edges:yt.edges,masses:yt.masses,weights:yt.weights,iterations:j,min_movement:q,distance_threshold_mode:$r(V),center:_,height:D,width:k,kg:X,speed:st,max_distance:ft})]):[2,{nodes:[],edges:at}];case 1:return Tt=Ut.sent().nodes,dt.forEach(function(kt,Rt){kt.data.x=Tt[y*Rt],kt.data.y=Tt[y*Rt+1],y===3&&(kt.data.z=Tt[y*Rt+2])}),a&&dt.forEach(function(kt){var Rt=kt.id,$t=kt.data,bt={x:$t.x,y:$t.y};y===3&&(bt.z=$t.z),i.mergeNodeData(Rt,bt)}),[2,{nodes:dt,edges:at}]}})})},l.prototype.formatOptions=function(a){a===void 0&&(a={});var i=_t(_t({},this.options),a),d=i.clustering,c=i.nodeClusterBy,g=i.center,y=i.width,k=i.height;return i.width=!y&&typeof window<"u"?window.innerWidth:y,i.height=!k&&typeof window<"u"?window.innerHeight:k,i.center=g||[i.width/2,i.height/2],i.clustering=d&&!!c,i},l}(),bs={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1,maxDistance:1/0},fd=function(){function l(a){a===void 0&&(a={}),this.options=a,this.id="forceAtlas2WASM",this.options=_t(_t({},bs),a)}return l.prototype.execute=function(a,i){return se(this,void 0,void 0,function(){return ue(this,function(d){return[2,this.genericForceAtlas2Layout(!1,a,i)]})})},l.prototype.assign=function(a,i){return se(this,void 0,void 0,function(){return ue(this,function(d){return this.genericForceAtlas2Layout(!0,a,i),[2]})})},l.prototype.genericForceAtlas2Layout=function(a,i,d){return se(this,void 0,void 0,function(){var c,g,y,k,D,_,j,q,V,X,st,ft,Q,at,dt,yt,Tt,Ut,kt,Rt;return ue(this,function($t){switch($t.label){case 0:return c=this.formatOptions(d),g=c.threads,y=c.dimensions,k=c.width,D=c.height,_=c.center,j=c.maxIteration,q=c.minMovement,V=c.distanceThresholdMode,c.tao,X=c.kr,st=c.kg,ft=c.ks,Q=c.dissuadeHubs,at=c.mode,dt=c.maxDistance,yt=i.getAllNodes(),Tt=i.getAllEdges(),yt!=null&&yt.length?yt.length===1?(a&&i.mergeNodeData(yt[0].id,{x:_[0],y:_[1],z:y===3?_[2]:void 0}),[2,{nodes:[_t(_t({},yt[0]),{data:_t(_t({},yt[0].data),{x:_[0],y:_[1],z:y===3?_[2]:void 0})})],edges:Tt}]):(Ut=yt.map(function(bt){return Lr(bt,[k,D])}),Ut.forEach(function(bt,Wt){he(bt.data.x)||(bt.data.x=Math.random()*k),he(bt.data.y)||(bt.data.y=Math.random()*D),y===3&&(he(bt.data.z)||(bt.data.z=Math.random()*Math.sqrt(k*D)))}),kt=Gr(Ut,Tt,y),[4,g.forceatlas2({dimensions:y,nodes:kt.nodes,edges:kt.edges,masses:kt.masses,weights:kt.weights,iterations:j,min_movement:q,distance_threshold_mode:$r(V),center:_,ka:1,kg:st,kr:X,speed:ft,prevent_overlapping:!1,node_radius:10,kr_prime:10,strong_gravity:!1,lin_log:at==="linlog",dissuade_hubs:Q,max_distance:dt})]):[2,{nodes:[],edges:Tt}];case 1:return Rt=$t.sent().nodes,Ut.forEach(function(bt,Wt){bt.data.x=Rt[y*Wt],bt.data.y=Rt[y*Wt+1],y===3&&(bt.data.z=Rt[y*Wt+2])}),a&&Ut.forEach(function(bt){var Wt=bt.id,Qt=bt.data,ae={x:Qt.x,y:Qt.y};y===3&&(ae.z=Qt.z),i.mergeNodeData(Wt,ae)}),[2,{nodes:Ut,edges:Tt}]}})})},l.prototype.formatOptions=function(a){a===void 0&&(a={});var i=_t(_t({},this.options),a),d=i.center,c=i.width,g=i.height;return i.barnesHut,i.prune,i.maxIteration,i.kr,i.kg,i.width=!c&&typeof window<"u"?window.innerWidth:c,i.height=!g&&typeof window<"u"?window.innerHeight:g,i.center=d||[i.width/2,i.height/2],i},l}(),Ns={maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean",maxDistance:1/0},gd=function(){function l(a){a===void 0&&(a={}),this.options=a,this.id="forceWASM",this.options=_t(_t({},Ns),a)}return l.prototype.execute=function(a,i){return se(this,void 0,void 0,function(){return ue(this,function(d){return[2,this.genericForceLayout(!1,a,i)]})})},l.prototype.assign=function(a,i){return se(this,void 0,void 0,function(){return ue(this,function(d){return this.genericForceLayout(!0,a,i),[2]})})},l.prototype.genericForceLayout=function(a,i,d){return se(this,void 0,void 0,function(){var c,g,y,k,D,_,j,q,V,X,st,ft,Q,at,dt,yt,Tt,Ut,kt,Rt,$t,bt,Wt,Qt;return ue(this,function(ae){switch(ae.label){case 0:return c=this.formatOptions(d),g=c.threads,y=c.dimensions,k=c.width,D=c.height,_=c.center,j=c.maxIteration,q=c.minMovement,V=c.distanceThresholdMode,X=c.gravity,st=c.factor,ft=c.interval,Q=c.damping,at=c.maxSpeed,dt=c.edgeStrength,yt=c.linkDistance,Tt=c.nodeStrength,Ut=c.coulombDisScale,kt=c.maxDistance,Rt=i.getAllNodes(),$t=i.getAllEdges(),Rt!=null&&Rt.length?Rt.length===1?(a&&i.mergeNodeData(Rt[0].id,{x:_[0],y:_[1],z:y===3?_[2]:void 0}),[2,{nodes:[_t(_t({},Rt[0]),{data:_t(_t({},Rt[0].data),{x:_[0],y:_[1],z:y===3?_[2]:void 0})})],edges:$t}]):(bt=Rt.map(function(xt){return Lr(xt,[k,D])}),bt.forEach(function(xt){he(xt.data.x)||(xt.data.x=Math.random()*k),he(xt.data.y)||(xt.data.y=Math.random()*D),y===3&&(he(xt.data.z)||(xt.data.z=Math.random()*Math.sqrt(k*D)))}),Wt=Gr(bt,$t,y),[4,g.force2({dimensions:y,nodes:Wt.nodes,edges:Wt.edges,masses:Wt.masses,weights:Wt.weights,iterations:j,min_movement:q,distance_threshold_mode:$r(V),center:_,edge_strength:dt,link_distance:yt,node_strength:Tt,coulomb_dis_scale:Ut,kg:X,factor:st,interval:ft,damping:Q,max_speed:at,max_distance:kt})]):[2,{nodes:[],edges:$t}];case 1:return Qt=ae.sent().nodes,bt.forEach(function(xt,Kt){xt.data.x=Qt[y*Kt],xt.data.y=Qt[y*Kt+1],y===3&&(xt.data.z=Qt[y*Kt+2])}),a&&bt.forEach(function(xt){var Kt=xt.id,ee=xt.data,Jt={x:ee.x,y:ee.y};y===3&&(Jt.z=ee.z),i.mergeNodeData(Kt,Jt)}),[2,{nodes:bt,edges:$t}]}})})},l.prototype.formatOptions=function(a){a===void 0&&(a={});var i=_t(_t({},this.options),a),d=i.center,c=i.width,g=i.height;return i.width=!c&&typeof window<"u"?window.innerWidth:c,i.height=!g&&typeof window<"u"?window.innerHeight:g,i.center=d||[i.width/2,i.height/2],i},l}(),ie=(l=>(l.GRAPHOLOGY="graphology",l.ANTV_LAYOUT="@antv/layout",l.ANTV_LAYOUT_WASM_SINGLETHREAD="@antv/layout-wasm - singlethread",l.ANTV_LAYOUT_WASM_MULTITHREADS="@antv/layout-wasm - multithreads",l.ANTV_LAYOUT_GPU="@antv/layout-gpu",l))(ie||{});const zr=800;var ar={},Ms={get exports(){return ar},set exports(l){ar=l}},_e=typeof Reflect=="object"?Reflect:null,po=_e&&typeof _e.apply=="function"?_e.apply:function(a,i,d){return Function.prototype.apply.call(a,i,d)},ir;_e&&typeof _e.ownKeys=="function"?ir=_e.ownKeys:Object.getOwnPropertySymbols?ir=function(a){return Object.getOwnPropertyNames(a).concat(Object.getOwnPropertySymbols(a))}:ir=function(a){return Object.getOwnPropertyNames(a)};function Ss(l){console&&console.warn&&console.warn(l)}var zo=Number.isNaN||function(a){return a!==a};function Nt(){Nt.init.call(this)}Ms.exports=Nt;ar.once=zs;Nt.EventEmitter=Nt;Nt.prototype._events=void 0;Nt.prototype._eventsCount=0;Nt.prototype._maxListeners=void 0;var vo=10;function sr(l){if(typeof l!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof l)}Object.defineProperty(Nt,"defaultMaxListeners",{enumerable:!0,get:function(){return vo},set:function(l){if(typeof l!="number"||l<0||zo(l))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+l+".");vo=l}});Nt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Nt.prototype.setMaxListeners=function(a){if(typeof a!="number"||a<0||zo(a))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+a+".");return this._maxListeners=a,this};function Do(l){return l._maxListeners===void 0?Nt.defaultMaxListeners:l._maxListeners}Nt.prototype.getMaxListeners=function(){return Do(this)};Nt.prototype.emit=function(a){for(var i=[],d=1;d<arguments.length;d++)i.push(arguments[d]);var c=a==="error",g=this._events;if(g!==void 0)c=c&&g.error===void 0;else if(!c)return!1;if(c){var y;if(i.length>0&&(y=i[0]),y instanceof Error)throw y;var k=new Error("Unhandled error."+(y?" ("+y.message+")":""));throw k.context=y,k}var D=g[a];if(D===void 0)return!1;if(typeof D=="function")po(D,this,i);else for(var _=D.length,j=Po(D,_),d=0;d<_;++d)po(j[d],this,i);return!0};function Ro(l,a,i,d){var c,g,y;if(sr(i),g=l._events,g===void 0?(g=l._events=Object.create(null),l._eventsCount=0):(g.newListener!==void 0&&(l.emit("newListener",a,i.listener?i.listener:i),g=l._events),y=g[a]),y===void 0)y=g[a]=i,++l._eventsCount;else if(typeof y=="function"?y=g[a]=d?[i,y]:[y,i]:d?y.unshift(i):y.push(i),c=Do(l),c>0&&y.length>c&&!y.warned){y.warned=!0;var k=new Error("Possible EventEmitter memory leak detected. "+y.length+" "+String(a)+" listeners added. Use emitter.setMaxListeners() to increase limit");k.name="MaxListenersExceededWarning",k.emitter=l,k.type=a,k.count=y.length,Ss(k)}return l}Nt.prototype.addListener=function(a,i){return Ro(this,a,i,!1)};Nt.prototype.on=Nt.prototype.addListener;Nt.prototype.prependListener=function(a,i){return Ro(this,a,i,!0)};function As(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Io(l,a,i){var d={fired:!1,wrapFn:void 0,target:l,type:a,listener:i},c=As.bind(d);return c.listener=i,d.wrapFn=c,c}Nt.prototype.once=function(a,i){return sr(i),this.on(a,Io(this,a,i)),this};Nt.prototype.prependOnceListener=function(a,i){return sr(i),this.prependListener(a,Io(this,a,i)),this};Nt.prototype.removeListener=function(a,i){var d,c,g,y,k;if(sr(i),c=this._events,c===void 0)return this;if(d=c[a],d===void 0)return this;if(d===i||d.listener===i)--this._eventsCount===0?this._events=Object.create(null):(delete c[a],c.removeListener&&this.emit("removeListener",a,d.listener||i));else if(typeof d!="function"){for(g=-1,y=d.length-1;y>=0;y--)if(d[y]===i||d[y].listener===i){k=d[y].listener,g=y;break}if(g<0)return this;g===0?d.shift():ks(d,g),d.length===1&&(c[a]=d[0]),c.removeListener!==void 0&&this.emit("removeListener",a,k||i)}return this};Nt.prototype.off=Nt.prototype.removeListener;Nt.prototype.removeAllListeners=function(a){var i,d,c;if(d=this._events,d===void 0)return this;if(d.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):d[a]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete d[a]),this;if(arguments.length===0){var g=Object.keys(d),y;for(c=0;c<g.length;++c)y=g[c],y!=="removeListener"&&this.removeAllListeners(y);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(i=d[a],typeof i=="function")this.removeListener(a,i);else if(i!==void 0)for(c=i.length-1;c>=0;c--)this.removeListener(a,i[c]);return this};function To(l,a,i){var d=l._events;if(d===void 0)return[];var c=d[a];return c===void 0?[]:typeof c=="function"?i?[c.listener||c]:[c]:i?_s(c):Po(c,c.length)}Nt.prototype.listeners=function(a){return To(this,a,!0)};Nt.prototype.rawListeners=function(a){return To(this,a,!1)};Nt.listenerCount=function(l,a){return typeof l.listenerCount=="function"?l.listenerCount(a):Oo.call(l,a)};Nt.prototype.listenerCount=Oo;function Oo(l){var a=this._events;if(a!==void 0){var i=a[l];if(typeof i=="function")return 1;if(i!==void 0)return i.length}return 0}Nt.prototype.eventNames=function(){return this._eventsCount>0?ir(this._events):[]};function Po(l,a){for(var i=new Array(a),d=0;d<a;++d)i[d]=l[d];return i}function ks(l,a){for(;a+1<l.length;a++)l[a]=l[a+1];l.pop()}function _s(l){for(var a=new Array(l.length),i=0;i<a.length;++i)a[i]=l[i].listener||l[i];return a}function zs(l,a){return new Promise(function(i,d){function c(y){l.removeListener(a,g),d(y)}function g(){typeof l.removeListener=="function"&&l.removeListener("error",c),i([].slice.call(arguments))}Lo(l,a,g,{once:!0}),a!=="error"&&Ds(l,c,{once:!0})})}function Ds(l,a,i){typeof l.on=="function"&&Lo(l,"error",a,i)}function Lo(l,a,i,d){if(typeof l.on=="function")d.once?l.once(a,i):l.on(a,i);else if(typeof l.addEventListener=="function")l.addEventListener(a,function c(g){d.once&&l.removeEventListener(a,c),i(g)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof l)}function de(l){if(typeof l!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=l}typeof Symbol<"u"&&(de.prototype[Symbol.iterator]=function(){return this});de.of=function(){var l=arguments,a=l.length,i=0;return new de(function(){return i>=a?{done:!0}:{done:!1,value:l[i++]}})};de.empty=function(){var l=new de(function(){return{done:!0}});return l};de.fromSequence=function(l){var a=0,i=l.length;return new de(function(){return a>=i?{done:!0}:{done:!1,value:l[a++]}})};de.is=function(l){return l instanceof de?!0:typeof l=="object"&&l!==null&&typeof l.next=="function"};var Ht=de,jr={};jr.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u";jr.SYMBOL_SUPPORT=typeof Symbol<"u";var Rs=Ht,Co=jr,Is=Co.ARRAY_BUFFER_SUPPORT,Ts=Co.SYMBOL_SUPPORT;function Os(l){return typeof l=="string"||Array.isArray(l)||Is&&ArrayBuffer.isView(l)?Rs.fromSequence(l):typeof l!="object"||l===null?null:Ts&&typeof l[Symbol.iterator]=="function"?l[Symbol.iterator]():typeof l.next=="function"?l:null}var Go=function(a){var i=Os(a);if(!i)throw new Error("obliterator: target is not iterable nor a valid iterator.");return i},Ps=Go,$o=function(a,i){for(var d=arguments.length>1?i:1/0,c=d!==1/0?new Array(d):[],g,y=0,k=Ps(a);;){if(y===d)return c;if(g=k.next(),g.done)return y!==i&&(c.length=y),c;c[y++]=g.value}},Ls=Ht,Cs=Go,ce=function(){var a=arguments,i=null,d=-1;return new Ls(function(){var g=null;do{if(i===null){if(d++,d>=a.length)return{done:!0};i=Cs(a[d])}if(g=i.next(),g.done===!0){i=null;continue}break}while(!0);return g})};function Gs(){const l=arguments[0];for(let a=1,i=arguments.length;a<i;a++)if(arguments[a])for(const d in arguments[a])l[d]=arguments[a][d];return l}let Pt=Gs;typeof Object.assign=="function"&&(Pt=Object.assign);function te(l,a,i,d){const c=l._nodes.get(a);let g=null;return c&&(d==="mixed"?g=c.out&&c.out[i]||c.undirected&&c.undirected[i]:d==="directed"?g=c.out&&c.out[i]:g=c.undirected&&c.undirected[i]),g}function Lt(l){return typeof l=="object"&&l!==null&&l.constructor===Object}function jo(l){let a;for(a in l)return!1;return!0}function Xt(l,a,i){Object.defineProperty(l,a,{enumerable:!1,configurable:!1,writable:!0,value:i})}function oe(l,a,i){const d={enumerable:!0,configurable:!0};typeof i=="function"?d.get=i:(d.value=i,d.writable=!1),Object.defineProperty(l,a,d)}function yo(l){return!(!Lt(l)||l.attributes&&!Array.isArray(l.attributes))}function $s(){let l=Math.floor(Math.random()*256)&255;return()=>l++}class qr extends Error{constructor(a){super(),this.name="GraphError",this.message=a}}class it extends qr{constructor(a){super(a),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,it.prototype.constructor)}}class et extends qr{constructor(a){super(a),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,et.prototype.constructor)}}class lt extends qr{constructor(a){super(a),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,lt.prototype.constructor)}}function qo(l,a){this.key=l,this.attributes=a,this.clear()}qo.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function Fo(l,a){this.key=l,this.attributes=a,this.clear()}Fo.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function Vo(l,a){this.key=l,this.attributes=a,this.clear()}Vo.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function ze(l,a,i,d,c){this.key=a,this.attributes=c,this.undirected=l,this.source=i,this.target=d}ze.prototype.attach=function(){let l="out",a="in";this.undirected&&(l=a="undirected");const i=this.source.key,d=this.target.key;this.source[l][d]=this,!(this.undirected&&i===d)&&(this.target[a][i]=this)};ze.prototype.attachMulti=function(){let l="out",a="in";const i=this.source.key,d=this.target.key;this.undirected&&(l=a="undirected");const c=this.source[l],g=c[d];if(typeof g>"u"){c[d]=this,this.undirected&&i===d||(this.target[a][i]=this);return}g.previous=this,this.next=g,c[d]=this,this.target[a][i]=this};ze.prototype.detach=function(){const l=this.source.key,a=this.target.key;let i="out",d="in";this.undirected&&(i=d="undirected"),delete this.source[i][a],delete this.target[d][l]};ze.prototype.detachMulti=function(){const l=this.source.key,a=this.target.key;let i="out",d="in";this.undirected&&(i=d="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[i][a],delete this.target[d][l]):(this.next.previous=void 0,this.source[i][a]=this.next,this.target[d][l]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const Uo=0,Wo=1,js=2,Bo=3;function le(l,a,i,d,c,g,y){let k,D,_,j;if(d=""+d,i===Uo){if(k=l._nodes.get(d),!k)throw new et(`Graph.${a}: could not find the "${d}" node in the graph.`);_=c,j=g}else if(i===Bo){if(c=""+c,D=l._edges.get(c),!D)throw new et(`Graph.${a}: could not find the "${c}" edge in the graph.`);const q=D.source.key,V=D.target.key;if(d===q)k=D.target;else if(d===V)k=D.source;else throw new et(`Graph.${a}: the "${d}" node is not attached to the "${c}" edge (${q}, ${V}).`);_=g,j=y}else{if(D=l._edges.get(d),!D)throw new et(`Graph.${a}: could not find the "${d}" edge in the graph.`);i===Wo?k=D.source:k=D.target,_=c,j=g}return[k,_,j]}function qs(l,a,i){l.prototype[a]=function(d,c,g){const[y,k]=le(this,a,i,d,c,g);return y.attributes[k]}}function Fs(l,a,i){l.prototype[a]=function(d,c){const[g]=le(this,a,i,d,c);return g.attributes}}function Vs(l,a,i){l.prototype[a]=function(d,c,g){const[y,k]=le(this,a,i,d,c,g);return y.attributes.hasOwnProperty(k)}}function Us(l,a,i){l.prototype[a]=function(d,c,g,y){const[k,D,_]=le(this,a,i,d,c,g,y);return k.attributes[D]=_,this.emit("nodeAttributesUpdated",{key:k.key,type:"set",attributes:k.attributes,name:D}),this}}function Ws(l,a,i){l.prototype[a]=function(d,c,g,y){const[k,D,_]=le(this,a,i,d,c,g,y);if(typeof _!="function")throw new it(`Graph.${a}: updater should be a function.`);const j=k.attributes,q=_(j[D]);return j[D]=q,this.emit("nodeAttributesUpdated",{key:k.key,type:"set",attributes:k.attributes,name:D}),this}}function Bs(l,a,i){l.prototype[a]=function(d,c,g){const[y,k]=le(this,a,i,d,c,g);return delete y.attributes[k],this.emit("nodeAttributesUpdated",{key:y.key,type:"remove",attributes:y.attributes,name:k}),this}}function Hs(l,a,i){l.prototype[a]=function(d,c,g){const[y,k]=le(this,a,i,d,c,g);if(!Lt(k))throw new it(`Graph.${a}: provided attributes are not a plain object.`);return y.attributes=k,this.emit("nodeAttributesUpdated",{key:y.key,type:"replace",attributes:y.attributes}),this}}function Ks(l,a,i){l.prototype[a]=function(d,c,g){const[y,k]=le(this,a,i,d,c,g);if(!Lt(k))throw new it(`Graph.${a}: provided attributes are not a plain object.`);return Pt(y.attributes,k),this.emit("nodeAttributesUpdated",{key:y.key,type:"merge",attributes:y.attributes,data:k}),this}}function Ys(l,a,i){l.prototype[a]=function(d,c,g){const[y,k]=le(this,a,i,d,c,g);if(typeof k!="function")throw new it(`Graph.${a}: provided updater is not a function.`);return y.attributes=k(y.attributes),this.emit("nodeAttributesUpdated",{key:y.key,type:"update",attributes:y.attributes}),this}}const Qs=[{name:l=>`get${l}Attribute`,attacher:qs},{name:l=>`get${l}Attributes`,attacher:Fs},{name:l=>`has${l}Attribute`,attacher:Vs},{name:l=>`set${l}Attribute`,attacher:Us},{name:l=>`update${l}Attribute`,attacher:Ws},{name:l=>`remove${l}Attribute`,attacher:Bs},{name:l=>`replace${l}Attributes`,attacher:Hs},{name:l=>`merge${l}Attributes`,attacher:Ks},{name:l=>`update${l}Attributes`,attacher:Ys}];function Js(l){Qs.forEach(function({name:a,attacher:i}){i(l,a("Node"),Uo),i(l,a("Source"),Wo),i(l,a("Target"),js),i(l,a("Opposite"),Bo)})}function Xs(l,a,i){l.prototype[a]=function(d,c){let g;if(this.type!=="mixed"&&i!=="mixed"&&i!==this.type)throw new lt(`Graph.${a}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new lt(`Graph.${a}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const y=""+d,k=""+c;if(c=arguments[2],g=te(this,y,k,i),!g)throw new et(`Graph.${a}: could not find an edge for the given path ("${y}" - "${k}").`)}else{if(i!=="mixed")throw new lt(`Graph.${a}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(d=""+d,g=this._edges.get(d),!g)throw new et(`Graph.${a}: could not find the "${d}" edge in the graph.`)}return g.attributes[c]}}function Zs(l,a,i){l.prototype[a]=function(d){let c;if(this.type!=="mixed"&&i!=="mixed"&&i!==this.type)throw new lt(`Graph.${a}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new lt(`Graph.${a}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const g=""+d,y=""+arguments[1];if(c=te(this,g,y,i),!c)throw new et(`Graph.${a}: could not find an edge for the given path ("${g}" - "${y}").`)}else{if(i!=="mixed")throw new lt(`Graph.${a}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(d=""+d,c=this._edges.get(d),!c)throw new et(`Graph.${a}: could not find the "${d}" edge in the graph.`)}return c.attributes}}function tu(l,a,i){l.prototype[a]=function(d,c){let g;if(this.type!=="mixed"&&i!=="mixed"&&i!==this.type)throw new lt(`Graph.${a}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new lt(`Graph.${a}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const y=""+d,k=""+c;if(c=arguments[2],g=te(this,y,k,i),!g)throw new et(`Graph.${a}: could not find an edge for the given path ("${y}" - "${k}").`)}else{if(i!=="mixed")throw new lt(`Graph.${a}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(d=""+d,g=this._edges.get(d),!g)throw new et(`Graph.${a}: could not find the "${d}" edge in the graph.`)}return g.attributes.hasOwnProperty(c)}}function eu(l,a,i){l.prototype[a]=function(d,c,g){let y;if(this.type!=="mixed"&&i!=="mixed"&&i!==this.type)throw new lt(`Graph.${a}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new lt(`Graph.${a}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const k=""+d,D=""+c;if(c=arguments[2],g=arguments[3],y=te(this,k,D,i),!y)throw new et(`Graph.${a}: could not find an edge for the given path ("${k}" - "${D}").`)}else{if(i!=="mixed")throw new lt(`Graph.${a}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(d=""+d,y=this._edges.get(d),!y)throw new et(`Graph.${a}: could not find the "${d}" edge in the graph.`)}return y.attributes[c]=g,this.emit("edgeAttributesUpdated",{key:y.key,type:"set",attributes:y.attributes,name:c}),this}}function ru(l,a,i){l.prototype[a]=function(d,c,g){let y;if(this.type!=="mixed"&&i!=="mixed"&&i!==this.type)throw new lt(`Graph.${a}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new lt(`Graph.${a}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const k=""+d,D=""+c;if(c=arguments[2],g=arguments[3],y=te(this,k,D,i),!y)throw new et(`Graph.${a}: could not find an edge for the given path ("${k}" - "${D}").`)}else{if(i!=="mixed")throw new lt(`Graph.${a}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(d=""+d,y=this._edges.get(d),!y)throw new et(`Graph.${a}: could not find the "${d}" edge in the graph.`)}if(typeof g!="function")throw new it(`Graph.${a}: updater should be a function.`);return y.attributes[c]=g(y.attributes[c]),this.emit("edgeAttributesUpdated",{key:y.key,type:"set",attributes:y.attributes,name:c}),this}}function nu(l,a,i){l.prototype[a]=function(d,c){let g;if(this.type!=="mixed"&&i!=="mixed"&&i!==this.type)throw new lt(`Graph.${a}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new lt(`Graph.${a}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const y=""+d,k=""+c;if(c=arguments[2],g=te(this,y,k,i),!g)throw new et(`Graph.${a}: could not find an edge for the given path ("${y}" - "${k}").`)}else{if(i!=="mixed")throw new lt(`Graph.${a}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(d=""+d,g=this._edges.get(d),!g)throw new et(`Graph.${a}: could not find the "${d}" edge in the graph.`)}return delete g.attributes[c],this.emit("edgeAttributesUpdated",{key:g.key,type:"remove",attributes:g.attributes,name:c}),this}}function ou(l,a,i){l.prototype[a]=function(d,c){let g;if(this.type!=="mixed"&&i!=="mixed"&&i!==this.type)throw new lt(`Graph.${a}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new lt(`Graph.${a}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const y=""+d,k=""+c;if(c=arguments[2],g=te(this,y,k,i),!g)throw new et(`Graph.${a}: could not find an edge for the given path ("${y}" - "${k}").`)}else{if(i!=="mixed")throw new lt(`Graph.${a}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(d=""+d,g=this._edges.get(d),!g)throw new et(`Graph.${a}: could not find the "${d}" edge in the graph.`)}if(!Lt(c))throw new it(`Graph.${a}: provided attributes are not a plain object.`);return g.attributes=c,this.emit("edgeAttributesUpdated",{key:g.key,type:"replace",attributes:g.attributes}),this}}function iu(l,a,i){l.prototype[a]=function(d,c){let g;if(this.type!=="mixed"&&i!=="mixed"&&i!==this.type)throw new lt(`Graph.${a}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new lt(`Graph.${a}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const y=""+d,k=""+c;if(c=arguments[2],g=te(this,y,k,i),!g)throw new et(`Graph.${a}: could not find an edge for the given path ("${y}" - "${k}").`)}else{if(i!=="mixed")throw new lt(`Graph.${a}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(d=""+d,g=this._edges.get(d),!g)throw new et(`Graph.${a}: could not find the "${d}" edge in the graph.`)}if(!Lt(c))throw new it(`Graph.${a}: provided attributes are not a plain object.`);return Pt(g.attributes,c),this.emit("edgeAttributesUpdated",{key:g.key,type:"merge",attributes:g.attributes,data:c}),this}}function au(l,a,i){l.prototype[a]=function(d,c){let g;if(this.type!=="mixed"&&i!=="mixed"&&i!==this.type)throw new lt(`Graph.${a}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new lt(`Graph.${a}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const y=""+d,k=""+c;if(c=arguments[2],g=te(this,y,k,i),!g)throw new et(`Graph.${a}: could not find an edge for the given path ("${y}" - "${k}").`)}else{if(i!=="mixed")throw new lt(`Graph.${a}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(d=""+d,g=this._edges.get(d),!g)throw new et(`Graph.${a}: could not find the "${d}" edge in the graph.`)}if(typeof c!="function")throw new it(`Graph.${a}: provided updater is not a function.`);return g.attributes=c(g.attributes),this.emit("edgeAttributesUpdated",{key:g.key,type:"update",attributes:g.attributes}),this}}const su=[{name:l=>`get${l}Attribute`,attacher:Xs},{name:l=>`get${l}Attributes`,attacher:Zs},{name:l=>`has${l}Attribute`,attacher:tu},{name:l=>`set${l}Attribute`,attacher:eu},{name:l=>`update${l}Attribute`,attacher:ru},{name:l=>`remove${l}Attribute`,attacher:nu},{name:l=>`replace${l}Attributes`,attacher:ou},{name:l=>`merge${l}Attributes`,attacher:iu},{name:l=>`update${l}Attributes`,attacher:au}];function uu(l){su.forEach(function({name:a,attacher:i}){i(l,a("Edge"),"mixed"),i(l,a("DirectedEdge"),"directed"),i(l,a("UndirectedEdge"),"undirected")})}const du=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function hu(l,a,i,d){let c=!1;for(const g in a){if(g===d)continue;const y=a[g];if(c=i(y.key,y.attributes,y.source.key,y.target.key,y.source.attributes,y.target.attributes,y.undirected),l&&c)return y.key}}function cu(l,a,i,d){let c,g,y,k=!1;for(const D in a)if(D!==d){c=a[D];do{if(g=c.source,y=c.target,k=i(c.key,c.attributes,g.key,y.key,g.attributes,y.attributes,c.undirected),l&&k)return c.key;c=c.next}while(c!==void 0)}}function Dr(l,a){const i=Object.keys(l),d=i.length;let c,g=0;return new Ht(function(){do if(c)c=c.next;else{if(g>=d)return{done:!0};const k=i[g++];if(k===a){c=void 0;continue}c=l[k]}while(!c);return{done:!1,value:{edge:c.key,attributes:c.attributes,source:c.source.key,target:c.target.key,sourceAttributes:c.source.attributes,targetAttributes:c.target.attributes,undirected:c.undirected}}})}function lu(l,a,i,d){const c=a[i];if(!c)return;const g=c.source,y=c.target;if(d(c.key,c.attributes,g.key,y.key,g.attributes,y.attributes,c.undirected)&&l)return c.key}function fu(l,a,i,d){let c=a[i];if(!c)return;let g=!1;do{if(g=d(c.key,c.attributes,c.source.key,c.target.key,c.source.attributes,c.target.attributes,c.undirected),l&&g)return c.key;c=c.next}while(c!==void 0)}function Rr(l,a){let i=l[a];return i.next!==void 0?new Ht(function(){if(!i)return{done:!0};const d={edge:i.key,attributes:i.attributes,source:i.source.key,target:i.target.key,sourceAttributes:i.source.attributes,targetAttributes:i.target.attributes,undirected:i.undirected};return i=i.next,{done:!1,value:d}}):Ht.of({edge:i.key,attributes:i.attributes,source:i.source.key,target:i.target.key,sourceAttributes:i.source.attributes,targetAttributes:i.target.attributes,undirected:i.undirected})}function gu(l,a){if(l.size===0)return[];if(a==="mixed"||a===l.type)return typeof Array.from=="function"?Array.from(l._edges.keys()):$o(l._edges.keys(),l._edges.size);const i=a==="undirected"?l.undirectedSize:l.directedSize,d=new Array(i),c=a==="undirected",g=l._edges.values();let y=0,k,D;for(;k=g.next(),k.done!==!0;)D=k.value,D.undirected===c&&(d[y++]=D.key);return d}function Ho(l,a,i,d){if(a.size===0)return;const c=i!=="mixed"&&i!==a.type,g=i==="undirected";let y,k,D=!1;const _=a._edges.values();for(;y=_.next(),y.done!==!0;){if(k=y.value,c&&k.undirected!==g)continue;const{key:j,attributes:q,source:V,target:X}=k;if(D=d(j,q,V.key,X.key,V.attributes,X.attributes,k.undirected),l&&D)return j}}function pu(l,a){if(l.size===0)return Ht.empty();const i=a!=="mixed"&&a!==l.type,d=a==="undirected",c=l._edges.values();return new Ht(function(){let y,k;for(;;){if(y=c.next(),y.done)return y;if(k=y.value,!(i&&k.undirected!==d))break}return{value:{edge:k.key,attributes:k.attributes,source:k.source.key,target:k.target.key,sourceAttributes:k.source.attributes,targetAttributes:k.target.attributes,undirected:k.undirected},done:!1}})}function Fr(l,a,i,d,c,g){const y=a?cu:hu;let k;if(i!=="undirected"&&(d!=="out"&&(k=y(l,c.in,g),l&&k)||d!=="in"&&(k=y(l,c.out,g,d?void 0:c.key),l&&k))||i!=="directed"&&(k=y(l,c.undirected,g),l&&k))return k}function vu(l,a,i,d){const c=[];return Fr(!1,l,a,i,d,function(g){c.push(g)}),c}function yu(l,a,i){let d=Ht.empty();return l!=="undirected"&&(a!=="out"&&typeof i.in<"u"&&(d=ce(d,Dr(i.in))),a!=="in"&&typeof i.out<"u"&&(d=ce(d,Dr(i.out,a?void 0:i.key)))),l!=="directed"&&typeof i.undirected<"u"&&(d=ce(d,Dr(i.undirected))),d}function Vr(l,a,i,d,c,g,y){const k=i?fu:lu;let D;if(a!=="undirected"&&(typeof c.in<"u"&&d!=="out"&&(D=k(l,c.in,g,y),l&&D)||typeof c.out<"u"&&d!=="in"&&(d||c.key!==g)&&(D=k(l,c.out,g,y),l&&D))||a!=="directed"&&typeof c.undirected<"u"&&(D=k(l,c.undirected,g,y),l&&D))return D}function mu(l,a,i,d,c){const g=[];return Vr(!1,l,a,i,d,c,function(y){g.push(y)}),g}function wu(l,a,i,d){let c=Ht.empty();return l!=="undirected"&&(typeof i.in<"u"&&a!=="out"&&d in i.in&&(c=ce(c,Rr(i.in,d))),typeof i.out<"u"&&a!=="in"&&d in i.out&&(a||i.key!==d)&&(c=ce(c,Rr(i.out,d)))),l!=="directed"&&typeof i.undirected<"u"&&d in i.undirected&&(c=ce(c,Rr(i.undirected,d))),c}function xu(l,a){const{name:i,type:d,direction:c}=a;l.prototype[i]=function(g,y){if(d!=="mixed"&&this.type!=="mixed"&&d!==this.type)return[];if(!arguments.length)return gu(this,d);if(arguments.length===1){g=""+g;const k=this._nodes.get(g);if(typeof k>"u")throw new et(`Graph.${i}: could not find the "${g}" node in the graph.`);return vu(this.multi,d==="mixed"?this.type:d,c,k)}if(arguments.length===2){g=""+g,y=""+y;const k=this._nodes.get(g);if(!k)throw new et(`Graph.${i}:  could not find the "${g}" source node in the graph.`);if(!this._nodes.has(y))throw new et(`Graph.${i}:  could not find the "${y}" target node in the graph.`);return mu(d,this.multi,c,k,y)}throw new it(`Graph.${i}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Eu(l,a){const{name:i,type:d,direction:c}=a,g="forEach"+i[0].toUpperCase()+i.slice(1,-1);l.prototype[g]=function(_,j,q){if(!(d!=="mixed"&&this.type!=="mixed"&&d!==this.type)){if(arguments.length===1)return q=_,Ho(!1,this,d,q);if(arguments.length===2){_=""+_,q=j;const V=this._nodes.get(_);if(typeof V>"u")throw new et(`Graph.${g}: could not find the "${_}" node in the graph.`);return Fr(!1,this.multi,d==="mixed"?this.type:d,c,V,q)}if(arguments.length===3){_=""+_,j=""+j;const V=this._nodes.get(_);if(!V)throw new et(`Graph.${g}:  could not find the "${_}" source node in the graph.`);if(!this._nodes.has(j))throw new et(`Graph.${g}:  could not find the "${j}" target node in the graph.`);return Vr(!1,d,this.multi,c,V,j,q)}throw new it(`Graph.${g}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const y="map"+i[0].toUpperCase()+i.slice(1);l.prototype[y]=function(){const _=Array.prototype.slice.call(arguments),j=_.pop();let q;if(_.length===0){let V=0;d!=="directed"&&(V+=this.undirectedSize),d!=="undirected"&&(V+=this.directedSize),q=new Array(V);let X=0;_.push((st,ft,Q,at,dt,yt,Tt)=>{q[X++]=j(st,ft,Q,at,dt,yt,Tt)})}else q=[],_.push((V,X,st,ft,Q,at,dt)=>{q.push(j(V,X,st,ft,Q,at,dt))});return this[g].apply(this,_),q};const k="filter"+i[0].toUpperCase()+i.slice(1);l.prototype[k]=function(){const _=Array.prototype.slice.call(arguments),j=_.pop(),q=[];return _.push((V,X,st,ft,Q,at,dt)=>{j(V,X,st,ft,Q,at,dt)&&q.push(V)}),this[g].apply(this,_),q};const D="reduce"+i[0].toUpperCase()+i.slice(1);l.prototype[D]=function(){let _=Array.prototype.slice.call(arguments);if(_.length<2||_.length>4)throw new it(`Graph.${D}: invalid number of arguments (expecting 2, 3 or 4 and got ${_.length}).`);if(typeof _[_.length-1]=="function"&&typeof _[_.length-2]!="function")throw new it(`Graph.${D}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let j,q;_.length===2?(j=_[0],q=_[1],_=[]):_.length===3?(j=_[1],q=_[2],_=[_[0]]):_.length===4&&(j=_[2],q=_[3],_=[_[0],_[1]]);let V=q;return _.push((X,st,ft,Q,at,dt,yt)=>{V=j(V,X,st,ft,Q,at,dt,yt)}),this[g].apply(this,_),V}}function bu(l,a){const{name:i,type:d,direction:c}=a,g="find"+i[0].toUpperCase()+i.slice(1,-1);l.prototype[g]=function(D,_,j){if(d!=="mixed"&&this.type!=="mixed"&&d!==this.type)return!1;if(arguments.length===1)return j=D,Ho(!0,this,d,j);if(arguments.length===2){D=""+D,j=_;const q=this._nodes.get(D);if(typeof q>"u")throw new et(`Graph.${g}: could not find the "${D}" node in the graph.`);return Fr(!0,this.multi,d==="mixed"?this.type:d,c,q,j)}if(arguments.length===3){D=""+D,_=""+_;const q=this._nodes.get(D);if(!q)throw new et(`Graph.${g}:  could not find the "${D}" source node in the graph.`);if(!this._nodes.has(_))throw new et(`Graph.${g}:  could not find the "${_}" target node in the graph.`);return Vr(!0,d,this.multi,c,q,_,j)}throw new it(`Graph.${g}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const y="some"+i[0].toUpperCase()+i.slice(1,-1);l.prototype[y]=function(){const D=Array.prototype.slice.call(arguments),_=D.pop();return D.push((q,V,X,st,ft,Q,at)=>_(q,V,X,st,ft,Q,at)),!!this[g].apply(this,D)};const k="every"+i[0].toUpperCase()+i.slice(1,-1);l.prototype[k]=function(){const D=Array.prototype.slice.call(arguments),_=D.pop();return D.push((q,V,X,st,ft,Q,at)=>!_(q,V,X,st,ft,Q,at)),!this[g].apply(this,D)}}function Nu(l,a){const{name:i,type:d,direction:c}=a,g=i.slice(0,-1)+"Entries";l.prototype[g]=function(y,k){if(d!=="mixed"&&this.type!=="mixed"&&d!==this.type)return Ht.empty();if(!arguments.length)return pu(this,d);if(arguments.length===1){y=""+y;const D=this._nodes.get(y);if(!D)throw new et(`Graph.${g}: could not find the "${y}" node in the graph.`);return yu(d,c,D)}if(arguments.length===2){y=""+y,k=""+k;const D=this._nodes.get(y);if(!D)throw new et(`Graph.${g}:  could not find the "${y}" source node in the graph.`);if(!this._nodes.has(k))throw new et(`Graph.${g}:  could not find the "${k}" target node in the graph.`);return wu(d,c,D,k)}throw new it(`Graph.${g}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Mu(l){du.forEach(a=>{xu(l,a),Eu(l,a),bu(l,a),Nu(l,a)})}const Su=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function ur(){this.A=null,this.B=null}ur.prototype.wrap=function(l){this.A===null?this.A=l:this.B===null&&(this.B=l)};ur.prototype.has=function(l){return this.A!==null&&l in this.A||this.B!==null&&l in this.B};function Ce(l,a,i,d,c){for(const g in d){const y=d[g],k=y.source,D=y.target,_=k===i?D:k;if(a&&a.has(_.key))continue;const j=c(_.key,_.attributes);if(l&&j)return _.key}}function Ur(l,a,i,d,c){if(a!=="mixed"){if(a==="undirected")return Ce(l,null,d,d.undirected,c);if(typeof i=="string")return Ce(l,null,d,d[i],c)}const g=new ur;let y;if(a!=="undirected"){if(i!=="out"){if(y=Ce(l,null,d,d.in,c),l&&y)return y;g.wrap(d.in)}if(i!=="in"){if(y=Ce(l,g,d,d.out,c),l&&y)return y;g.wrap(d.out)}}if(a!=="directed"&&(y=Ce(l,g,d,d.undirected,c),l&&y))return y}function Au(l,a,i){if(l!=="mixed"){if(l==="undirected")return Object.keys(i.undirected);if(typeof a=="string")return Object.keys(i[a])}const d=[];return Ur(!1,l,a,i,function(c){d.push(c)}),d}function Ge(l,a,i){const d=Object.keys(i),c=d.length;let g=0;return new Ht(function(){let k=null;do{if(g>=c)return l&&l.wrap(i),{done:!0};const D=i[d[g++]],_=D.source,j=D.target;if(k=_===a?j:_,l&&l.has(k.key)){k=null;continue}}while(k===null);return{done:!1,value:{neighbor:k.key,attributes:k.attributes}}})}function ku(l,a,i){if(l!=="mixed"){if(l==="undirected")return Ge(null,i,i.undirected);if(typeof a=="string")return Ge(null,i,i[a])}let d=Ht.empty();const c=new ur;return l!=="undirected"&&(a!=="out"&&(d=ce(d,Ge(c,i,i.in))),a!=="in"&&(d=ce(d,Ge(c,i,i.out)))),l!=="directed"&&(d=ce(d,Ge(c,i,i.undirected))),d}function _u(l,a){const{name:i,type:d,direction:c}=a;l.prototype[i]=function(g){if(d!=="mixed"&&this.type!=="mixed"&&d!==this.type)return[];g=""+g;const y=this._nodes.get(g);if(typeof y>"u")throw new et(`Graph.${i}: could not find the "${g}" node in the graph.`);return Au(d==="mixed"?this.type:d,c,y)}}function zu(l,a){const{name:i,type:d,direction:c}=a,g="forEach"+i[0].toUpperCase()+i.slice(1,-1);l.prototype[g]=function(_,j){if(d!=="mixed"&&this.type!=="mixed"&&d!==this.type)return;_=""+_;const q=this._nodes.get(_);if(typeof q>"u")throw new et(`Graph.${g}: could not find the "${_}" node in the graph.`);Ur(!1,d==="mixed"?this.type:d,c,q,j)};const y="map"+i[0].toUpperCase()+i.slice(1);l.prototype[y]=function(_,j){const q=[];return this[g](_,(V,X)=>{q.push(j(V,X))}),q};const k="filter"+i[0].toUpperCase()+i.slice(1);l.prototype[k]=function(_,j){const q=[];return this[g](_,(V,X)=>{j(V,X)&&q.push(V)}),q};const D="reduce"+i[0].toUpperCase()+i.slice(1);l.prototype[D]=function(_,j,q){if(arguments.length<3)throw new it(`Graph.${D}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let V=q;return this[g](_,(X,st)=>{V=j(V,X,st)}),V}}function Du(l,a){const{name:i,type:d,direction:c}=a,g=i[0].toUpperCase()+i.slice(1,-1),y="find"+g;l.prototype[y]=function(_,j){if(d!=="mixed"&&this.type!=="mixed"&&d!==this.type)return;_=""+_;const q=this._nodes.get(_);if(typeof q>"u")throw new et(`Graph.${y}: could not find the "${_}" node in the graph.`);return Ur(!0,d==="mixed"?this.type:d,c,q,j)};const k="some"+g;l.prototype[k]=function(_,j){return!!this[y](_,j)};const D="every"+g;l.prototype[D]=function(_,j){return!this[y](_,(V,X)=>!j(V,X))}}function Ru(l,a){const{name:i,type:d,direction:c}=a,g=i.slice(0,-1)+"Entries";l.prototype[g]=function(y){if(d!=="mixed"&&this.type!=="mixed"&&d!==this.type)return Ht.empty();y=""+y;const k=this._nodes.get(y);if(typeof k>"u")throw new et(`Graph.${g}: could not find the "${y}" node in the graph.`);return ku(d==="mixed"?this.type:d,c,k)}}function Iu(l){Su.forEach(a=>{_u(l,a),zu(l,a),Du(l,a),Ru(l,a)})}function or(l,a,i,d,c){const g=d._nodes.values(),y=d.type;let k,D,_,j,q,V,X;for(;k=g.next(),k.done!==!0;){let st=!1;if(D=k.value,y!=="undirected"){j=D.out;for(_ in j){q=j[_];do{if(V=q.target,st=!0,X=c(D.key,V.key,D.attributes,V.attributes,q.key,q.attributes,q.undirected),l&&X)return q;q=q.next}while(q)}}if(y!=="directed"){j=D.undirected;for(_ in j)if(!(a&&D.key>_)){q=j[_];do{if(V=q.target,V.key!==_&&(V=q.source),st=!0,X=c(D.key,V.key,D.attributes,V.attributes,q.key,q.attributes,q.undirected),l&&X)return q;q=q.next}while(q)}}if(i&&!st&&(X=c(D.key,null,D.attributes,null,null,null,null),l&&X))return null}}function Tu(l,a){const i={key:l};return jo(a.attributes)||(i.attributes=Pt({},a.attributes)),i}function Ou(l,a,i){const d={key:a,source:i.source.key,target:i.target.key};return jo(i.attributes)||(d.attributes=Pt({},i.attributes)),l==="mixed"&&i.undirected&&(d.undirected=!0),d}function Pu(l){if(!Lt(l))throw new it('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in l))throw new it("Graph.import: serialized node is missing its key.");if("attributes"in l&&(!Lt(l.attributes)||l.attributes===null))throw new it("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function Lu(l){if(!Lt(l))throw new it('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in l))throw new it("Graph.import: serialized edge is missing its source.");if(!("target"in l))throw new it("Graph.import: serialized edge is missing its target.");if("attributes"in l&&(!Lt(l.attributes)||l.attributes===null))throw new it("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in l&&typeof l.undirected!="boolean")throw new it("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const Cu=$s(),Gu=new Set(["directed","undirected","mixed"]),mo=new Set(["domain","_events","_eventsCount","_maxListeners"]),$u=[{name:l=>`${l}Edge`,generateKey:!0},{name:l=>`${l}DirectedEdge`,generateKey:!0,type:"directed"},{name:l=>`${l}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:l=>`${l}EdgeWithKey`},{name:l=>`${l}DirectedEdgeWithKey`,type:"directed"},{name:l=>`${l}UndirectedEdgeWithKey`,type:"undirected"}],ju={allowSelfLoops:!0,multi:!1,type:"mixed"};function qu(l,a,i){if(i&&!Lt(i))throw new it(`Graph.addNode: invalid attributes. Expecting an object but got "${i}"`);if(a=""+a,i=i||{},l._nodes.has(a))throw new lt(`Graph.addNode: the "${a}" node already exist in the graph.`);const d=new l.NodeDataClass(a,i);return l._nodes.set(a,d),l.emit("nodeAdded",{key:a,attributes:i}),d}function wo(l,a,i){const d=new l.NodeDataClass(a,i);return l._nodes.set(a,d),l.emit("nodeAdded",{key:a,attributes:i}),d}function Ko(l,a,i,d,c,g,y,k){if(!d&&l.type==="undirected")throw new lt(`Graph.${a}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(d&&l.type==="directed")throw new lt(`Graph.${a}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(k&&!Lt(k))throw new it(`Graph.${a}: invalid attributes. Expecting an object but got "${k}"`);if(g=""+g,y=""+y,k=k||{},!l.allowSelfLoops&&g===y)throw new lt(`Graph.${a}: source & target are the same ("${g}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const D=l._nodes.get(g),_=l._nodes.get(y);if(!D)throw new et(`Graph.${a}: source node "${g}" not found.`);if(!_)throw new et(`Graph.${a}: target node "${y}" not found.`);const j={key:null,undirected:d,source:g,target:y,attributes:k};if(i)c=l._edgeKeyGenerator();else if(c=""+c,l._edges.has(c))throw new lt(`Graph.${a}: the "${c}" edge already exists in the graph.`);if(!l.multi&&(d?typeof D.undirected[y]<"u":typeof D.out[y]<"u"))throw new lt(`Graph.${a}: an edge linking "${g}" to "${y}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const q=new ze(d,c,D,_,k);l._edges.set(c,q);const V=g===y;return d?(D.undirectedDegree++,_.undirectedDegree++,V&&(D.undirectedLoops++,l._undirectedSelfLoopCount++)):(D.outDegree++,_.inDegree++,V&&(D.directedLoops++,l._directedSelfLoopCount++)),l.multi?q.attachMulti():q.attach(),d?l._undirectedSize++:l._directedSize++,j.key=c,l.emit("edgeAdded",j),c}function Fu(l,a,i,d,c,g,y,k,D){if(!d&&l.type==="undirected")throw new lt(`Graph.${a}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(d&&l.type==="directed")throw new lt(`Graph.${a}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(k){if(D){if(typeof k!="function")throw new it(`Graph.${a}: invalid updater function. Expecting a function but got "${k}"`)}else if(!Lt(k))throw new it(`Graph.${a}: invalid attributes. Expecting an object but got "${k}"`)}g=""+g,y=""+y;let _;if(D&&(_=k,k=void 0),!l.allowSelfLoops&&g===y)throw new lt(`Graph.${a}: source & target are the same ("${g}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let j=l._nodes.get(g),q=l._nodes.get(y),V,X;if(!i&&(V=l._edges.get(c),V)){if((V.source.key!==g||V.target.key!==y)&&(!d||V.source.key!==y||V.target.key!==g))throw new lt(`Graph.${a}: inconsistency detected when attempting to merge the "${c}" edge with "${g}" source & "${y}" target vs. ("${V.source.key}", "${V.target.key}").`);X=V}if(!X&&!l.multi&&j&&(X=d?j.undirected[y]:j.out[y]),X){const dt=[X.key,!1,!1,!1];if(D?!_:!k)return dt;if(D){const yt=X.attributes;X.attributes=_(yt),l.emit("edgeAttributesUpdated",{type:"replace",key:X.key,attributes:X.attributes})}else Pt(X.attributes,k),l.emit("edgeAttributesUpdated",{type:"merge",key:X.key,attributes:X.attributes,data:k});return dt}k=k||{},D&&_&&(k=_(k));const st={key:null,undirected:d,source:g,target:y,attributes:k};if(i)c=l._edgeKeyGenerator();else if(c=""+c,l._edges.has(c))throw new lt(`Graph.${a}: the "${c}" edge already exists in the graph.`);let ft=!1,Q=!1;j||(j=wo(l,g,{}),ft=!0,g===y&&(q=j,Q=!0)),q||(q=wo(l,y,{}),Q=!0),V=new ze(d,c,j,q,k),l._edges.set(c,V);const at=g===y;return d?(j.undirectedDegree++,q.undirectedDegree++,at&&(j.undirectedLoops++,l._undirectedSelfLoopCount++)):(j.outDegree++,q.inDegree++,at&&(j.directedLoops++,l._directedSelfLoopCount++)),l.multi?V.attachMulti():V.attach(),d?l._undirectedSize++:l._directedSize++,st.key=c,l.emit("edgeAdded",st),[c,!0,ft,Q]}function ke(l,a){l._edges.delete(a.key);const{source:i,target:d,attributes:c}=a,g=a.undirected,y=i===d;g?(i.undirectedDegree--,d.undirectedDegree--,y&&(i.undirectedLoops--,l._undirectedSelfLoopCount--)):(i.outDegree--,d.inDegree--,y&&(i.directedLoops--,l._directedSelfLoopCount--)),l.multi?a.detachMulti():a.detach(),g?l._undirectedSize--:l._directedSize--,l.emit("edgeDropped",{key:a.key,attributes:c,source:i.key,target:d.key,undirected:g})}let zt=class Or extends ar.EventEmitter{constructor(a){if(super(),a=Pt({},ju,a),typeof a.multi!="boolean")throw new it(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${a.multi}".`);if(!Gu.has(a.type))throw new it(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${a.type}".`);if(typeof a.allowSelfLoops!="boolean")throw new it(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${a.allowSelfLoops}".`);const i=a.type==="mixed"?qo:a.type==="directed"?Fo:Vo;Xt(this,"NodeDataClass",i);const d="geid_"+Cu()+"_";let c=0;const g=()=>{let y;do y=d+c++;while(this._edges.has(y));return y};Xt(this,"_attributes",{}),Xt(this,"_nodes",new Map),Xt(this,"_edges",new Map),Xt(this,"_directedSize",0),Xt(this,"_undirectedSize",0),Xt(this,"_directedSelfLoopCount",0),Xt(this,"_undirectedSelfLoopCount",0),Xt(this,"_edgeKeyGenerator",g),Xt(this,"_options",a),mo.forEach(y=>Xt(this,y,this[y])),oe(this,"order",()=>this._nodes.size),oe(this,"size",()=>this._edges.size),oe(this,"directedSize",()=>this._directedSize),oe(this,"undirectedSize",()=>this._undirectedSize),oe(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),oe(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),oe(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),oe(this,"multi",this._options.multi),oe(this,"type",this._options.type),oe(this,"allowSelfLoops",this._options.allowSelfLoops),oe(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(a){return this._nodes.has(""+a)}hasDirectedEdge(a,i){if(this.type==="undirected")return!1;if(arguments.length===1){const d=""+a,c=this._edges.get(d);return!!c&&!c.undirected}else if(arguments.length===2){a=""+a,i=""+i;const d=this._nodes.get(a);return d?d.out.hasOwnProperty(i):!1}throw new it(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(a,i){if(this.type==="directed")return!1;if(arguments.length===1){const d=""+a,c=this._edges.get(d);return!!c&&c.undirected}else if(arguments.length===2){a=""+a,i=""+i;const d=this._nodes.get(a);return d?d.undirected.hasOwnProperty(i):!1}throw new it(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(a,i){if(arguments.length===1){const d=""+a;return this._edges.has(d)}else if(arguments.length===2){a=""+a,i=""+i;const d=this._nodes.get(a);return d?typeof d.out<"u"&&d.out.hasOwnProperty(i)||typeof d.undirected<"u"&&d.undirected.hasOwnProperty(i):!1}throw new it(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(a,i){if(this.type==="undirected")return;if(a=""+a,i=""+i,this.multi)throw new lt("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const d=this._nodes.get(a);if(!d)throw new et(`Graph.directedEdge: could not find the "${a}" source node in the graph.`);if(!this._nodes.has(i))throw new et(`Graph.directedEdge: could not find the "${i}" target node in the graph.`);const c=d.out&&d.out[i]||void 0;if(c)return c.key}undirectedEdge(a,i){if(this.type==="directed")return;if(a=""+a,i=""+i,this.multi)throw new lt("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const d=this._nodes.get(a);if(!d)throw new et(`Graph.undirectedEdge: could not find the "${a}" source node in the graph.`);if(!this._nodes.has(i))throw new et(`Graph.undirectedEdge: could not find the "${i}" target node in the graph.`);const c=d.undirected&&d.undirected[i]||void 0;if(c)return c.key}edge(a,i){if(this.multi)throw new lt("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");a=""+a,i=""+i;const d=this._nodes.get(a);if(!d)throw new et(`Graph.edge: could not find the "${a}" source node in the graph.`);if(!this._nodes.has(i))throw new et(`Graph.edge: could not find the "${i}" target node in the graph.`);const c=d.out&&d.out[i]||d.undirected&&d.undirected[i]||void 0;if(c)return c.key}areDirectedNeighbors(a,i){a=""+a,i=""+i;const d=this._nodes.get(a);if(!d)throw new et(`Graph.areDirectedNeighbors: could not find the "${a}" node in the graph.`);return this.type==="undirected"?!1:i in d.in||i in d.out}areOutNeighbors(a,i){a=""+a,i=""+i;const d=this._nodes.get(a);if(!d)throw new et(`Graph.areOutNeighbors: could not find the "${a}" node in the graph.`);return this.type==="undirected"?!1:i in d.out}areInNeighbors(a,i){a=""+a,i=""+i;const d=this._nodes.get(a);if(!d)throw new et(`Graph.areInNeighbors: could not find the "${a}" node in the graph.`);return this.type==="undirected"?!1:i in d.in}areUndirectedNeighbors(a,i){a=""+a,i=""+i;const d=this._nodes.get(a);if(!d)throw new et(`Graph.areUndirectedNeighbors: could not find the "${a}" node in the graph.`);return this.type==="directed"?!1:i in d.undirected}areNeighbors(a,i){a=""+a,i=""+i;const d=this._nodes.get(a);if(!d)throw new et(`Graph.areNeighbors: could not find the "${a}" node in the graph.`);return this.type!=="undirected"&&(i in d.in||i in d.out)||this.type!=="directed"&&i in d.undirected}areInboundNeighbors(a,i){a=""+a,i=""+i;const d=this._nodes.get(a);if(!d)throw new et(`Graph.areInboundNeighbors: could not find the "${a}" node in the graph.`);return this.type!=="undirected"&&i in d.in||this.type!=="directed"&&i in d.undirected}areOutboundNeighbors(a,i){a=""+a,i=""+i;const d=this._nodes.get(a);if(!d)throw new et(`Graph.areOutboundNeighbors: could not find the "${a}" node in the graph.`);return this.type!=="undirected"&&i in d.out||this.type!=="directed"&&i in d.undirected}inDegree(a){a=""+a;const i=this._nodes.get(a);if(!i)throw new et(`Graph.inDegree: could not find the "${a}" node in the graph.`);return this.type==="undirected"?0:i.inDegree}outDegree(a){a=""+a;const i=this._nodes.get(a);if(!i)throw new et(`Graph.outDegree: could not find the "${a}" node in the graph.`);return this.type==="undirected"?0:i.outDegree}directedDegree(a){a=""+a;const i=this._nodes.get(a);if(!i)throw new et(`Graph.directedDegree: could not find the "${a}" node in the graph.`);return this.type==="undirected"?0:i.inDegree+i.outDegree}undirectedDegree(a){a=""+a;const i=this._nodes.get(a);if(!i)throw new et(`Graph.undirectedDegree: could not find the "${a}" node in the graph.`);return this.type==="directed"?0:i.undirectedDegree}inboundDegree(a){a=""+a;const i=this._nodes.get(a);if(!i)throw new et(`Graph.inboundDegree: could not find the "${a}" node in the graph.`);let d=0;return this.type!=="directed"&&(d+=i.undirectedDegree),this.type!=="undirected"&&(d+=i.inDegree),d}outboundDegree(a){a=""+a;const i=this._nodes.get(a);if(!i)throw new et(`Graph.outboundDegree: could not find the "${a}" node in the graph.`);let d=0;return this.type!=="directed"&&(d+=i.undirectedDegree),this.type!=="undirected"&&(d+=i.outDegree),d}degree(a){a=""+a;const i=this._nodes.get(a);if(!i)throw new et(`Graph.degree: could not find the "${a}" node in the graph.`);let d=0;return this.type!=="directed"&&(d+=i.undirectedDegree),this.type!=="undirected"&&(d+=i.inDegree+i.outDegree),d}inDegreeWithoutSelfLoops(a){a=""+a;const i=this._nodes.get(a);if(!i)throw new et(`Graph.inDegreeWithoutSelfLoops: could not find the "${a}" node in the graph.`);return this.type==="undirected"?0:i.inDegree-i.directedLoops}outDegreeWithoutSelfLoops(a){a=""+a;const i=this._nodes.get(a);if(!i)throw new et(`Graph.outDegreeWithoutSelfLoops: could not find the "${a}" node in the graph.`);return this.type==="undirected"?0:i.outDegree-i.directedLoops}directedDegreeWithoutSelfLoops(a){a=""+a;const i=this._nodes.get(a);if(!i)throw new et(`Graph.directedDegreeWithoutSelfLoops: could not find the "${a}" node in the graph.`);return this.type==="undirected"?0:i.inDegree+i.outDegree-i.directedLoops*2}undirectedDegreeWithoutSelfLoops(a){a=""+a;const i=this._nodes.get(a);if(!i)throw new et(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${a}" node in the graph.`);return this.type==="directed"?0:i.undirectedDegree-i.undirectedLoops*2}inboundDegreeWithoutSelfLoops(a){a=""+a;const i=this._nodes.get(a);if(!i)throw new et(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${a}" node in the graph.`);let d=0,c=0;return this.type!=="directed"&&(d+=i.undirectedDegree,c+=i.undirectedLoops*2),this.type!=="undirected"&&(d+=i.inDegree,c+=i.directedLoops),d-c}outboundDegreeWithoutSelfLoops(a){a=""+a;const i=this._nodes.get(a);if(!i)throw new et(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${a}" node in the graph.`);let d=0,c=0;return this.type!=="directed"&&(d+=i.undirectedDegree,c+=i.undirectedLoops*2),this.type!=="undirected"&&(d+=i.outDegree,c+=i.directedLoops),d-c}degreeWithoutSelfLoops(a){a=""+a;const i=this._nodes.get(a);if(!i)throw new et(`Graph.degreeWithoutSelfLoops: could not find the "${a}" node in the graph.`);let d=0,c=0;return this.type!=="directed"&&(d+=i.undirectedDegree,c+=i.undirectedLoops*2),this.type!=="undirected"&&(d+=i.inDegree+i.outDegree,c+=i.directedLoops*2),d-c}source(a){a=""+a;const i=this._edges.get(a);if(!i)throw new et(`Graph.source: could not find the "${a}" edge in the graph.`);return i.source.key}target(a){a=""+a;const i=this._edges.get(a);if(!i)throw new et(`Graph.target: could not find the "${a}" edge in the graph.`);return i.target.key}extremities(a){a=""+a;const i=this._edges.get(a);if(!i)throw new et(`Graph.extremities: could not find the "${a}" edge in the graph.`);return[i.source.key,i.target.key]}opposite(a,i){a=""+a,i=""+i;const d=this._edges.get(i);if(!d)throw new et(`Graph.opposite: could not find the "${i}" edge in the graph.`);const c=d.source.key,g=d.target.key;if(a===c)return g;if(a===g)return c;throw new et(`Graph.opposite: the "${a}" node is not attached to the "${i}" edge (${c}, ${g}).`)}hasExtremity(a,i){a=""+a,i=""+i;const d=this._edges.get(a);if(!d)throw new et(`Graph.hasExtremity: could not find the "${a}" edge in the graph.`);return d.source.key===i||d.target.key===i}isUndirected(a){a=""+a;const i=this._edges.get(a);if(!i)throw new et(`Graph.isUndirected: could not find the "${a}" edge in the graph.`);return i.undirected}isDirected(a){a=""+a;const i=this._edges.get(a);if(!i)throw new et(`Graph.isDirected: could not find the "${a}" edge in the graph.`);return!i.undirected}isSelfLoop(a){a=""+a;const i=this._edges.get(a);if(!i)throw new et(`Graph.isSelfLoop: could not find the "${a}" edge in the graph.`);return i.source===i.target}addNode(a,i){return qu(this,a,i).key}mergeNode(a,i){if(i&&!Lt(i))throw new it(`Graph.mergeNode: invalid attributes. Expecting an object but got "${i}"`);a=""+a,i=i||{};let d=this._nodes.get(a);return d?(i&&(Pt(d.attributes,i),this.emit("nodeAttributesUpdated",{type:"merge",key:a,attributes:d.attributes,data:i})),[a,!1]):(d=new this.NodeDataClass(a,i),this._nodes.set(a,d),this.emit("nodeAdded",{key:a,attributes:i}),[a,!0])}updateNode(a,i){if(i&&typeof i!="function")throw new it(`Graph.updateNode: invalid updater function. Expecting a function but got "${i}"`);a=""+a;let d=this._nodes.get(a);if(d){if(i){const g=d.attributes;d.attributes=i(g),this.emit("nodeAttributesUpdated",{type:"replace",key:a,attributes:d.attributes})}return[a,!1]}const c=i?i({}):{};return d=new this.NodeDataClass(a,c),this._nodes.set(a,d),this.emit("nodeAdded",{key:a,attributes:c}),[a,!0]}dropNode(a){a=""+a;const i=this._nodes.get(a);if(!i)throw new et(`Graph.dropNode: could not find the "${a}" node in the graph.`);let d;if(this.type!=="undirected"){for(const c in i.out){d=i.out[c];do ke(this,d),d=d.next;while(d)}for(const c in i.in){d=i.in[c];do ke(this,d),d=d.next;while(d)}}if(this.type!=="directed")for(const c in i.undirected){d=i.undirected[c];do ke(this,d),d=d.next;while(d)}this._nodes.delete(a),this.emit("nodeDropped",{key:a,attributes:i.attributes})}dropEdge(a){let i;if(arguments.length>1){const d=""+arguments[0],c=""+arguments[1];if(i=te(this,d,c,this.type),!i)throw new et(`Graph.dropEdge: could not find the "${d}" -> "${c}" edge in the graph.`)}else if(a=""+a,i=this._edges.get(a),!i)throw new et(`Graph.dropEdge: could not find the "${a}" edge in the graph.`);return ke(this,i),this}dropDirectedEdge(a,i){if(arguments.length<2)throw new lt("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new lt("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");a=""+a,i=""+i;const d=te(this,a,i,"directed");if(!d)throw new et(`Graph.dropDirectedEdge: could not find a "${a}" -> "${i}" edge in the graph.`);return ke(this,d),this}dropUndirectedEdge(a,i){if(arguments.length<2)throw new lt("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new lt("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const d=te(this,a,i,"undirected");if(!d)throw new et(`Graph.dropUndirectedEdge: could not find a "${a}" -> "${i}" edge in the graph.`);return ke(this,d),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const a=this._nodes.values();let i;for(;i=a.next(),i.done!==!0;)i.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(a){return this._attributes[a]}getAttributes(){return this._attributes}hasAttribute(a){return this._attributes.hasOwnProperty(a)}setAttribute(a,i){return this._attributes[a]=i,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:a}),this}updateAttribute(a,i){if(typeof i!="function")throw new it("Graph.updateAttribute: updater should be a function.");const d=this._attributes[a];return this._attributes[a]=i(d),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:a}),this}removeAttribute(a){return delete this._attributes[a],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:a}),this}replaceAttributes(a){if(!Lt(a))throw new it("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=a,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(a){if(!Lt(a))throw new it("Graph.mergeAttributes: provided attributes are not a plain object.");return Pt(this._attributes,a),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:a}),this}updateAttributes(a){if(typeof a!="function")throw new it("Graph.updateAttributes: provided updater is not a function.");return this._attributes=a(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(a,i){if(typeof a!="function")throw new it("Graph.updateEachNodeAttributes: expecting an updater function.");if(i&&!yo(i))throw new it("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const d=this._nodes.values();let c,g;for(;c=d.next(),c.done!==!0;)g=c.value,g.attributes=a(g.key,g.attributes);this.emit("eachNodeAttributesUpdated",{hints:i||null})}updateEachEdgeAttributes(a,i){if(typeof a!="function")throw new it("Graph.updateEachEdgeAttributes: expecting an updater function.");if(i&&!yo(i))throw new it("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const d=this._edges.values();let c,g,y,k;for(;c=d.next(),c.done!==!0;)g=c.value,y=g.source,k=g.target,g.attributes=a(g.key,g.attributes,y.key,k.key,y.attributes,k.attributes,g.undirected);this.emit("eachEdgeAttributesUpdated",{hints:i||null})}forEachAdjacencyEntry(a){if(typeof a!="function")throw new it("Graph.forEachAdjacencyEntry: expecting a callback.");or(!1,!1,!1,this,a)}forEachAdjacencyEntryWithOrphans(a){if(typeof a!="function")throw new it("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");or(!1,!1,!0,this,a)}forEachAssymetricAdjacencyEntry(a){if(typeof a!="function")throw new it("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");or(!1,!0,!1,this,a)}forEachAssymetricAdjacencyEntryWithOrphans(a){if(typeof a!="function")throw new it("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");or(!1,!0,!0,this,a)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):$o(this._nodes.keys(),this._nodes.size)}forEachNode(a){if(typeof a!="function")throw new it("Graph.forEachNode: expecting a callback.");const i=this._nodes.values();let d,c;for(;d=i.next(),d.done!==!0;)c=d.value,a(c.key,c.attributes)}findNode(a){if(typeof a!="function")throw new it("Graph.findNode: expecting a callback.");const i=this._nodes.values();let d,c;for(;d=i.next(),d.done!==!0;)if(c=d.value,a(c.key,c.attributes))return c.key}mapNodes(a){if(typeof a!="function")throw new it("Graph.mapNode: expecting a callback.");const i=this._nodes.values();let d,c;const g=new Array(this.order);let y=0;for(;d=i.next(),d.done!==!0;)c=d.value,g[y++]=a(c.key,c.attributes);return g}someNode(a){if(typeof a!="function")throw new it("Graph.someNode: expecting a callback.");const i=this._nodes.values();let d,c;for(;d=i.next(),d.done!==!0;)if(c=d.value,a(c.key,c.attributes))return!0;return!1}everyNode(a){if(typeof a!="function")throw new it("Graph.everyNode: expecting a callback.");const i=this._nodes.values();let d,c;for(;d=i.next(),d.done!==!0;)if(c=d.value,!a(c.key,c.attributes))return!1;return!0}filterNodes(a){if(typeof a!="function")throw new it("Graph.filterNodes: expecting a callback.");const i=this._nodes.values();let d,c;const g=[];for(;d=i.next(),d.done!==!0;)c=d.value,a(c.key,c.attributes)&&g.push(c.key);return g}reduceNodes(a,i){if(typeof a!="function")throw new it("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new it("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let d=i;const c=this._nodes.values();let g,y;for(;g=c.next(),g.done!==!0;)y=g.value,d=a(d,y.key,y.attributes);return d}nodeEntries(){const a=this._nodes.values();return new Ht(()=>{const i=a.next();if(i.done)return i;const d=i.value;return{value:{node:d.key,attributes:d.attributes},done:!1}})}export(){const a=new Array(this._nodes.size);let i=0;this._nodes.forEach((c,g)=>{a[i++]=Tu(g,c)});const d=new Array(this._edges.size);return i=0,this._edges.forEach((c,g)=>{d[i++]=Ou(this.type,g,c)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:a,edges:d}}import(a,i=!1){if(a instanceof Or)return a.forEachNode((D,_)=>{i?this.mergeNode(D,_):this.addNode(D,_)}),a.forEachEdge((D,_,j,q,V,X,st)=>{i?st?this.mergeUndirectedEdgeWithKey(D,j,q,_):this.mergeDirectedEdgeWithKey(D,j,q,_):st?this.addUndirectedEdgeWithKey(D,j,q,_):this.addDirectedEdgeWithKey(D,j,q,_)}),this;if(!Lt(a))throw new it("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(a.attributes){if(!Lt(a.attributes))throw new it("Graph.import: invalid attributes. Expecting a plain object.");i?this.mergeAttributes(a.attributes):this.replaceAttributes(a.attributes)}let d,c,g,y,k;if(a.nodes){if(g=a.nodes,!Array.isArray(g))throw new it("Graph.import: invalid nodes. Expecting an array.");for(d=0,c=g.length;d<c;d++){y=g[d],Pu(y);const{key:D,attributes:_}=y;i?this.mergeNode(D,_):this.addNode(D,_)}}if(a.edges){let D=!1;if(this.type==="undirected"&&(D=!0),g=a.edges,!Array.isArray(g))throw new it("Graph.import: invalid edges. Expecting an array.");for(d=0,c=g.length;d<c;d++){k=g[d],Lu(k);const{source:_,target:j,attributes:q,undirected:V=D}=k;let X;"key"in k?(X=i?V?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:V?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,X.call(this,k.key,_,j,q)):(X=i?V?this.mergeUndirectedEdge:this.mergeDirectedEdge:V?this.addUndirectedEdge:this.addDirectedEdge,X.call(this,_,j,q))}}return this}nullCopy(a){const i=new Or(Pt({},this._options,a));return i.replaceAttributes(Pt({},this.getAttributes())),i}emptyCopy(a){const i=this.nullCopy(a);return this._nodes.forEach((d,c)=>{const g=Pt({},d.attributes);d=new i.NodeDataClass(c,g),i._nodes.set(c,d)}),i}copy(a){if(a=a||{},typeof a.type=="string"&&a.type!==this.type&&a.type!=="mixed")throw new lt(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${a.type}" because this would mean losing information about the current graph.`);if(typeof a.multi=="boolean"&&a.multi!==this.multi&&a.multi!==!0)throw new lt("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof a.allowSelfLoops=="boolean"&&a.allowSelfLoops!==this.allowSelfLoops&&a.allowSelfLoops!==!0)throw new lt("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const i=this.emptyCopy(a),d=this._edges.values();let c,g;for(;c=d.next(),c.done!==!0;)g=c.value,Ko(i,"copy",!1,g.undirected,g.key,g.source.key,g.target.key,Pt({},g.attributes));return i}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const a={};this._nodes.forEach((g,y)=>{a[y]=g.attributes});const i={},d={};this._edges.forEach((g,y)=>{const k=g.undirected?"--":"->";let D="",_=g.source.key,j=g.target.key,q;g.undirected&&_>j&&(q=_,_=j,j=q);const V=`(${_})${k}(${j})`;y.startsWith("geid_")?this.multi&&(typeof d[V]>"u"?d[V]=0:d[V]++,D+=`${d[V]}. `):D+=`[${y}]: `,D+=V,i[D]=g.attributes});const c={};for(const g in this)this.hasOwnProperty(g)&&!mo.has(g)&&typeof this[g]!="function"&&typeof g!="symbol"&&(c[g]=this[g]);return c.attributes=this._attributes,c.nodes=a,c.edges=i,Xt(c,"constructor",this.constructor),c}};typeof Symbol<"u"&&(zt.prototype[Symbol.for("nodejs.util.inspect.custom")]=zt.prototype.inspect);$u.forEach(l=>{["add","merge","update"].forEach(a=>{const i=l.name(a),d=a==="add"?Ko:Fu;l.generateKey?zt.prototype[i]=function(c,g,y){return d(this,i,!0,(l.type||this.type)==="undirected",null,c,g,y,a==="update")}:zt.prototype[i]=function(c,g,y,k){return d(this,i,!1,(l.type||this.type)==="undirected",c,g,y,k,a==="update")}})});Js(zt);uu(zt);Mu(zt);Iu(zt);class Yo extends zt{constructor(a){const i=Pt({type:"directed"},a);if("multi"in i&&i.multi!==!1)throw new it("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(i.type!=="directed")throw new it('DirectedGraph.from: inconsistent "'+i.type+'" type in given options!');super(i)}}class Qo extends zt{constructor(a){const i=Pt({type:"undirected"},a);if("multi"in i&&i.multi!==!1)throw new it("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(i.type!=="undirected")throw new it('UndirectedGraph.from: inconsistent "'+i.type+'" type in given options!');super(i)}}class Jo extends zt{constructor(a){const i=Pt({multi:!0},a);if("multi"in i&&i.multi!==!0)throw new it("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(i)}}class Xo extends zt{constructor(a){const i=Pt({type:"directed",multi:!0},a);if("multi"in i&&i.multi!==!0)throw new it("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(i.type!=="directed")throw new it('MultiDirectedGraph.from: inconsistent "'+i.type+'" type in given options!');super(i)}}class Zo extends zt{constructor(a){const i=Pt({type:"undirected",multi:!0},a);if("multi"in i&&i.multi!==!0)throw new it("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(i.type!=="undirected")throw new it('MultiUndirectedGraph.from: inconsistent "'+i.type+'" type in given options!');super(i)}}function De(l){l.from=function(a,i){const d=Pt({},a.options,i),c=new l(d);return c.import(a),c}}De(zt);De(Yo);De(Qo);De(Jo);De(Xo);De(Zo);zt.Graph=zt;zt.DirectedGraph=Yo;zt.UndirectedGraph=Qo;zt.MultiGraph=Jo;zt.MultiDirectedGraph=Xo;zt.MultiUndirectedGraph=Zo;zt.InvalidArgumentsGraphError=it;zt.NotFoundGraphError=et;zt.UsageGraphError=lt;var Vu="*",Uu=function(){function l(){this._events={}}return l.prototype.on=function(a,i,d){return this._events[a]||(this._events[a]=[]),this._events[a].push({callback:i,once:!!d}),this},l.prototype.once=function(a,i){return this.on(a,i,!0)},l.prototype.emit=function(a){for(var i=this,d=[],c=1;c<arguments.length;c++)d[c-1]=arguments[c];var g=this._events[a]||[],y=this._events[Vu]||[],k=function(D){for(var _=D.length,j=0;j<_;j++)if(D[j]){var q=D[j],V=q.callback,X=q.once;X&&(D.splice(j,1),D.length===0&&delete i._events[a],_--,j--),V.apply(i,d)}};k(g),k(y)},l.prototype.off=function(a,i){if(!a)this._events={};else if(!i)delete this._events[a];else{for(var d=this._events[a]||[],c=d.length,g=0;g<c;g++)d[g].callback===i&&(d.splice(g,1),c--,g--);d.length===0&&delete this._events[a]}return this},l.prototype.getEvents=function(){return this._events},l}();function xo(l,a,i,d){for(;l.length;){const c=l.shift();if(i(c))return!0;a.add(c.id),d(c.id).forEach(y=>{a.has(y.id)||(a.add(y.id),l.push(y))})}return!1}function Pr(l,a,i,d){if(i(l))return!0;a.add(l.id);for(const g of d(l.id))if(!a.has(g.id)&&Pr(g,a,i,d))return!0;return!1}class dr extends Uu{constructor(i){super();It(this,"nodeMap",new Map);It(this,"edgeMap",new Map);It(this,"inEdgesMap",new Map);It(this,"outEdgesMap",new Map);It(this,"bothEdgesMap",new Map);It(this,"treeIndices",new Map);It(this,"changes",[]);It(this,"batchCount",0);It(this,"onChanged",()=>{});It(this,"batch",i=>{this.batchCount+=1,i(),this.batchCount-=1,this.batchCount||this.commit()});i&&(i.nodes&&this.addNodes(i.nodes),i.edges&&this.addEdges(i.edges),i.tree&&this.addTree(i.tree),i.onChanged&&(this.onChanged=i.onChanged))}commit(){const i=this.changes;this.changes=[];const d={graph:this,changes:i};this.emit("changed",d),this.onChanged(d)}reduceChanges(i){let d=[];return i.forEach(c=>{switch(c.type){case"NodeRemoved":{let g=!1;d=d.filter(y=>{if(y.type==="NodeAdded"){const k=y.value.id===c.value.id;return k&&(g=!0),!k}else{if(y.type==="NodeDataUpdated")return y.id!==c.value.id;if(y.type==="TreeStructureChanged")return y.nodeId!==c.value.id}return!0}),g||d.push(c);break}case"EdgeRemoved":{let g=!1;d=d.filter(y=>{if(y.type==="EdgeAdded"){const k=y.value.id===c.value.id;return k&&(g=!0),!k}else if(y.type==="EdgeDataUpdated"||y.type==="EdgeUpdated")return y.id!==c.value.id;return!0}),g||d.push(c);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const g=d.find(y=>y.type===c.type&&y.id===c.id&&y.propertyName===c.propertyName);g?g.newValue=c.newValue:d.push(c);break}case"TreeStructureDetached":{d=d.filter(g=>g.type==="TreeStructureAttached"||g.type==="TreeStructureChanged"?g.treeKey!==c.treeKey:!0),d.push(c);break}case"TreeStructureChanged":{const g=d.find(y=>y.type==="TreeStructureChanged"&&y.treeKey===c.treeKey&&y.nodeId===c.nodeId);g?g.newParentId=c.newParentId:d.push(c);break}default:d.push(c);break}}),d}checkNodeExistence(i){this.getNode(i)}hasNode(i){return this.nodeMap.has(i)}areNeighbors(i,d){return this.getNeighbors(d).some(c=>c.id===i)}getNode(i){const d=this.nodeMap.get(i);if(!d)throw new Error("Node not found for id: "+i);return d}getRelatedEdges(i,d){if(this.checkNodeExistence(i),d==="in"){const c=this.inEdgesMap.get(i);return Array.from(c)}else if(d==="out"){const c=this.outEdgesMap.get(i);return Array.from(c)}else{const c=this.bothEdgesMap.get(i);return Array.from(c)}}getDegree(i,d){return this.getRelatedEdges(i,d).length}getSuccessors(i){const c=this.getRelatedEdges(i,"out").map(g=>this.getNode(g.target));return Array.from(new Set(c))}getPredecessors(i){const c=this.getRelatedEdges(i,"in").map(g=>this.getNode(g.source));return Array.from(new Set(c))}getNeighbors(i){const d=this.getPredecessors(i),c=this.getSuccessors(i);return Array.from(new Set([...d,...c]))}doAddNode(i){if(this.hasNode(i.id))throw new Error("Node already exists: "+i.id);this.nodeMap.set(i.id,i),this.inEdgesMap.set(i.id,new Set),this.outEdgesMap.set(i.id,new Set),this.bothEdgesMap.set(i.id,new Set),this.treeIndices.forEach(d=>{d.childrenMap.set(i.id,new Set)}),this.changes.push({type:"NodeAdded",value:i})}addNodes(i){this.batch(()=>{for(const d of i)this.doAddNode(d)})}addNode(i){this.addNodes([i])}doRemoveNode(i){const d=this.getNode(i),c=this.bothEdgesMap.get(i);c==null||c.forEach(g=>this.doRemoveEdge(g.id)),this.nodeMap.delete(i),this.treeIndices.forEach(g=>{var y;(y=g.childrenMap.get(i))==null||y.forEach(k=>{g.parentMap.delete(k.id)}),g.parentMap.delete(i),g.childrenMap.delete(i)}),this.changes.push({type:"NodeRemoved",value:d})}removeNodes(i){this.batch(()=>{i.forEach(d=>this.doRemoveNode(d))})}removeNode(i){this.removeNodes([i])}updateNodeDataProperty(i,d,c){const g=this.getNode(i);this.batch(()=>{const y=g.data[d],k=c;g.data[d]=k,this.changes.push({type:"NodeDataUpdated",id:i,propertyName:d,oldValue:y,newValue:k})})}mergeNodeData(i,d){this.batch(()=>{Object.entries(d).forEach(([c,g])=>{this.updateNodeDataProperty(i,c,g)})})}updateNodeData(...i){const d=i[0],c=this.getNode(d);if(typeof i[1]=="string"){this.updateNodeDataProperty(d,i[1],i[2]);return}let g;if(typeof i[1]=="function"){const y=i[1];g=y(c.data)}else typeof i[1]=="object"&&(g=i[1]);this.batch(()=>{const y=c.data,k=g;c.data=g,this.changes.push({type:"NodeDataUpdated",id:d,oldValue:y,newValue:k})})}checkEdgeExistence(i){if(!this.hasEdge(i))throw new Error("Edge not found for id: "+i)}hasEdge(i){return this.edgeMap.has(i)}getEdge(i){return this.checkEdgeExistence(i),this.edgeMap.get(i)}getEdgeDetail(i){const d=this.getEdge(i);return{edge:d,source:this.getNode(d.source),target:this.getNode(d.target)}}doAddEdge(i){if(this.hasEdge(i.id))throw new Error("Edge already exists: "+i.id);this.checkNodeExistence(i.source),this.checkNodeExistence(i.target),this.edgeMap.set(i.id,i);const d=this.inEdgesMap.get(i.target),c=this.outEdgesMap.get(i.source),g=this.bothEdgesMap.get(i.source),y=this.bothEdgesMap.get(i.target);d.add(i),c.add(i),g.add(i),y.add(i),this.changes.push({type:"EdgeAdded",value:i})}addEdges(i){this.batch(()=>{for(const d of i)this.doAddEdge(d)})}addEdge(i){this.addEdges([i])}doRemoveEdge(i){const d=this.getEdge(i),c=this.outEdgesMap.get(d.source),g=this.inEdgesMap.get(d.target),y=this.bothEdgesMap.get(d.source),k=this.bothEdgesMap.get(d.target);c.delete(d),g.delete(d),y.delete(d),k.delete(d),this.edgeMap.delete(i),this.changes.push({type:"EdgeRemoved",value:d})}removeEdges(i){this.batch(()=>{i.forEach(d=>this.doRemoveEdge(d))})}removeEdge(i){this.removeEdges([i])}updateEdgeSource(i,d){const c=this.getEdge(i);this.checkNodeExistence(d);const g=c.source,y=d;this.outEdgesMap.get(g).delete(c),this.bothEdgesMap.get(g).delete(c),this.outEdgesMap.get(y).add(c),this.bothEdgesMap.get(y).add(c),c.source=d,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:i,propertyName:"source",oldValue:g,newValue:y})})}updateEdgeTarget(i,d){const c=this.getEdge(i);this.checkNodeExistence(d);const g=c.target,y=d;this.inEdgesMap.get(g).delete(c),this.bothEdgesMap.get(g).delete(c),this.inEdgesMap.get(y).add(c),this.bothEdgesMap.get(y).add(c),c.target=d,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:i,propertyName:"target",oldValue:g,newValue:y})})}updateEdgeDataProperty(i,d,c){const g=this.getEdge(i);this.batch(()=>{const y=g.data[d],k=c;g.data[d]=k,this.changes.push({type:"EdgeDataUpdated",id:i,propertyName:d,oldValue:y,newValue:k})})}updateEdgeData(...i){const d=i[0],c=this.getEdge(d);if(typeof i[1]=="string"){this.updateEdgeDataProperty(d,i[1],i[2]);return}let g;if(typeof i[1]=="function"){const y=i[1];g=y(c.data)}else typeof i[1]=="object"&&(g=i[1]);this.batch(()=>{const y=c.data,k=g;c.data=g,this.changes.push({type:"EdgeDataUpdated",id:d,oldValue:y,newValue:k})})}mergeEdgeData(i,d){this.batch(()=>{Object.entries(d).forEach(([c,g])=>{this.updateEdgeDataProperty(i,c,g)})})}checkTreeExistence(i){if(!this.hasTreeStructure(i))throw new Error("Tree structure not found for treeKey: "+i)}hasTreeStructure(i){return this.treeIndices.has(i)}attachTreeStructure(i){this.treeIndices.has(i)||(this.treeIndices.set(i,{parentMap:new Map,childrenMap:new Map}),this.batch(()=>{this.changes.push({type:"TreeStructureAttached",treeKey:i})}))}detachTreeStructure(i){this.checkTreeExistence(i),this.treeIndices.delete(i),this.batch(()=>{this.changes.push({type:"TreeStructureDetached",treeKey:i})})}addTree(i,d){this.batch(()=>{this.attachTreeStructure(d);const c=[],g=Array.isArray(i)?i:[i];for(;g.length;){const y=g.shift();c.push(y),y.children&&g.push(...y.children)}this.addNodes(c),c.forEach(y=>{var k;(k=y.children)==null||k.forEach(D=>{this.setParent(D.id,y.id,d)})})})}getRoots(i){return this.checkTreeExistence(i),this.getAllNodes().filter(d=>!this.getParent(d.id,i))}getChildren(i,d){this.checkNodeExistence(i),this.checkTreeExistence(d);const g=this.treeIndices.get(d).childrenMap.get(i);return Array.from(g||[])}getParent(i,d){return this.checkNodeExistence(i),this.checkTreeExistence(d),this.treeIndices.get(d).parentMap.get(i)||null}getAncestors(i,d){const c=[];let g=this.getNode(i),y;for(;y=this.getParent(g.id,d);)c.push(y),g=y;return c}setParent(i,d,c){var j;this.checkTreeExistence(c);const g=this.treeIndices.get(c),y=this.getNode(i),k=g.parentMap.get(i),D=this.getNode(d);g.parentMap.set(i,D),k&&((j=g.childrenMap.get(k.id))==null||j.delete(y));let _=g.childrenMap.get(D.id);_||(_=new Set,g.childrenMap.set(D.id,_)),_.add(y),this.batch(()=>{this.changes.push({type:"TreeStructureChanged",treeKey:c,nodeId:i,oldParentId:k==null?void 0:k.id,newParentId:D.id})})}dfsTree(i,d,c){const g=y=>this.getChildren(y,c);return Pr(this.getNode(i),new Set,d,g)}bfsTree(i,d,c){const g=y=>this.getChildren(y,c);return xo([this.getNode(i)],new Set,d,g)}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(i,d,c="out"){const g={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[c];return xo([this.getNode(i)],new Set,d,g)}dfs(i,d,c="out"){const g={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[c];return Pr(this.getNode(i),new Set,d,g)}clone(){const i=this.getAllNodes().map(g=>({...g,data:{...g.data}})),d=this.getAllEdges().map(g=>({...g,data:{...g.data}})),c=new dr({nodes:i,edges:d});return this.treeIndices.forEach(({parentMap:g,childrenMap:y},k)=>{const D=new Map;g.forEach((j,q)=>{D.set(q,c.getNode(j.id))});const _=new Map;y.forEach((j,q)=>{_.set(q,new Set(Array.from(j).map(V=>c.getNode(V.id))))}),c.treeIndices.set(k,{parentMap:D,childrenMap:_})}),c}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var ti=function(a){return a!==null&&typeof a=="function"&&typeof a.prototype=="object"&&typeof a.prototype.addUndirectedEdgeWithKey=="function"&&typeof a.prototype.dropNode=="function"},Wu=ti,Bu=function(l,a){if(!Wu(l))throw new Error("graphology-generators/random/clusters: invalid Graph constructor.");a=a||{};var i="clusterDensity"in a?a.clusterDensity:.5,d=a.rng||Math.random,c=a.order,g=a.size,y=a.clusters;if(typeof i!="number"||i>1||i<0)throw new Error("graphology-generators/random/clusters: `clusterDensity` option should be a number between 0 and 1.");if(typeof d!="function")throw new Error("graphology-generators/random/clusters: `rng` option should be a function.");if(typeof c!="number"||c<=0)throw new Error("graphology-generators/random/clusters: `order` option should be a positive number.");if(typeof g!="number"||g<=0)throw new Error("graphology-generators/random/clusters: `size` option should be a positive number.");if(typeof y!="number"||y<=0)throw new Error("graphology-generators/random/clusters: `clusters` option should be a positive number.");var k=new l;if(!c)return k;var D=new Array(y),_,j,q;for(q=0;q<y;q++)D[q]=[];for(q=0;q<c;q++)_=d()*y|0,k.addNode(q,{cluster:_}),D[_].push(q);if(!g)return k;var V,X,st;for(q=0;q<g;q++){if(d()<1-i){V=d()*c|0;do X=d()*c|0;while(V===X)}else{if(_=d()*y|0,j=D[_],st=j.length,!st||st<2)continue;V=j[d()*st|0];do X=j[d()*st|0];while(V===X)}k.multi?k.addEdge(V,X):k.mergeEdge(V,X)}return k},fe={},Hu=Eo,Ku=function(a){if(!Hu(a))throw new Error("graphology-metrics/simple-size: the given graph is not a valid graphology instance.");if(!a.multi)return a.size;var i=0,d=0;function c(){i++}function g(){d++}return a.forEachNode(function(y){a.type!=="directed"&&a.forEachUndirectedNeighbor(y,c),a.type!=="undirected"&&a.forEachOutNeighbor(y,g)}),i/2+d},Yu=Eo,Qu=Ku;function Ju(l,a){return 2*a/(l*(l-1))}function Xu(l,a){return a/(l*(l-1))}function Zu(l,a){var i=l*(l-1);return a/(i+i/2)}function ve(l,a,i){var d,c;if(arguments.length>3){if(d=i,c=arguments[3],typeof d!="number"||d<0)throw new Error("graphology-metrics/density: given order is not a valid number.");if(typeof c!="number"||c<0)throw new Error("graphology-metrics/density: given size is not a valid number.")}else{if(!Yu(i))throw new Error("graphology-metrics/density: given graph is not a valid graphology instance.");d=i.order,c=i.size,i.multi&&a===!1&&(c=Qu(i))}if(d<2)return 0;l===null&&(l=i.type),a===null&&(a=i.multi);var g;return l==="undirected"?g=Ju:l==="directed"?g=Xu:g=Zu,g(d,c)}fe.abstractDensity=ve;fe.density=ve.bind(null,null,null);fe.directedDensity=ve.bind(null,"directed",!1);fe.undirectedDensity=ve.bind(null,"undirected",!1);fe.mixedDensity=ve.bind(null,"mixed",!1);fe.multiDirectedDensity=ve.bind(null,"directed",!0);fe.multiUndirectedDensity=ve.bind(null,"undirected",!0);fe.multiMixedDensity=ve.bind(null,"mixed",!0);var ei=ti,ri=fe.abstractDensity;function td(l,a){if(!ei(l))throw new Error("graphology-generators/random/erdos-renyi: invalid Graph constructor.");var i=a.order,d=a.probability,c=a.rng||Math.random,g=new l;if(typeof a.approximateSize=="number"&&(d=ri(g.type,!1,i,a.approximateSize)),typeof i!="number"||i<=0)throw new Error("graphology-generators/random/erdos-renyi: invalid `order`. Should be a positive number.");if(typeof d!="number"||d<0||d>1)throw new Error("graphology-generators/random/erdos-renyi: invalid `probability`. Should be a number between 0 and 1. Or maybe you gave an `approximateSize` exceeding the graph's density.");if(typeof c!="function")throw new Error("graphology-generators/random/erdos-renyi: invalid `rng`. Should be a function.");var y,k;for(y=0;y<i;y++)g.addNode(y);if(d<=0)return g;for(y=0;y<i;y++)for(k=y+1;k<i;k++)g.type!=="directed"&&c()<d&&g.addUndirectedEdge(y,k),g.type!=="undirected"&&(c()<d&&g.addDirectedEdge(y,k),c()<d&&g.addDirectedEdge(k,y));return g}function ed(l,a){if(!ei(l))throw new Error("graphology-generators/random/erdos-renyi: invalid Graph constructor.");var i=a.order,d=a.probability,c=a.rng||Math.random,g=new l;if(typeof a.approximateSize=="number"&&(d=ri(g.type,!1,i,a.approximateSize)),typeof i!="number"||i<=0)throw new Error("graphology-generators/random/erdos-renyi: invalid `order`. Should be a positive number.");if(typeof d!="number"||d<0||d>1)throw new Error("graphology-generators/random/erdos-renyi: invalid `probability`. Should be a number between 0 and 1. Or maybe you gave an `approximateSize` exceeding the graph's density.");if(typeof c!="function")throw new Error("graphology-generators/random/erdos-renyi: invalid `rng`. Should be a function.");for(var y=0;y<i;y++)g.addNode(y);if(d<=0)return g;var k=-1,D=Math.log(1-d),_,j;if(g.type!=="undirected")for(j=0;j<i;){for(_=Math.log(1-c()),k+=1+(_/D|0),j===k&&k++;j<i&&i<=k;)k-=i,j++,j===k&&k++;j<i&&g.addDirectedEdge(j,k)}if(k=-1,g.type!=="directed")for(j=1;j<i;){for(_=Math.log(1-c()),k+=1+(_/D|0);k>=j&&j<i;)k-=j,j++;j<i&&g.addUndirectedEdge(j,k)}return g}td.sparse=ed;var rd=Bu;const pd=async(l=2)=>{const a={},i=()=>{const q=rd(zt,{order:1e3,size:2e3,clusters:5});q.edges().forEach(function(X,st){q.setEdgeAttribute(X,"weight",1)}),q.nodes().forEach(function(X){q.setNodeAttribute(X,"x",Math.random()*zr),q.setNodeAttribute(X,"y",Math.random()*zr),l===3&&q.setNodeAttribute(X,"z",Math.random()*zr)});const V=nd(q);return{desc:"Creates a graph with the desired number of nodes & edges and having a given number of clusters. Generated by Graphology Generators.",[ie.GRAPHOLOGY]:q,[ie.ANTV_LAYOUT]:V,[ie.ANTV_LAYOUT_GPU]:V,[ie.ANTV_LAYOUT_WASM_SINGLETHREAD]:V,[ie.ANTV_LAYOUT_WASM_MULTITHREADS]:V}},d=(_,j)=>async()=>{const V=await(await fetch(_)).json(),X=[],st=[],ft=new Set;V.nodes.forEach((dt,yt)=>{ft.has(dt.id)||(ft.add(dt.id),dt.x=void 0,dt.y=void 0,dt.z=void 0,X.push({id:dt.id,data:{x:dt.x,y:dt.y,z:dt.z}}))}),V.edges.forEach((dt,yt)=>{dt.id===void 0&&(dt.id=`e${yt}`),dt.weight===void 0||dt.weight===null?dt.weight=1:dt.weight=Number(dt.weight),st.push({id:dt.id,source:dt.source,target:dt.target,data:{weight:dt.weight}})});const Q=new dr({nodes:X,edges:st}),at=od(Q);return{desc:j,[ie.GRAPHOLOGY]:at,[ie.ANTV_LAYOUT]:Q,[ie.ANTV_LAYOUT_GPU]:Q,[ie.ANTV_LAYOUT_WASM_SINGLETHREAD]:Q,[ie.ANTV_LAYOUT_WASM_MULTITHREADS]:Q}},[c,g,y,k,D]=await Promise.all([i(),d("https://gw.alipayobjects.com/os/antvdemo/assets/data/relations.json",'A small dataset of "relations" between people.')(),d("https://gw.alipayobjects.com/os/basement_prod/da5a1b47-37d6-44d7-8d10-f3e046dabf82.json","Netscience with 1589 nodes & 2742 edges.")(),d("https://gw.alipayobjects.com/os/basement_prod/0b9730ff-0850-46ff-84d0-1d4afecd43e6.json","Eva with 8322 nodes & 5421 edges.")(),d("https://gw.alipayobjects.com/os/basement_prod/7bacd7d1-4119-4ac1-8be3-4c4b9bcbc25f.json","A dataset for regions on earth.")()]);return a["random-clusters"]=c,a.relations=g,a.netscience=y,a.eva=k,a.regions=D,a},nd=l=>new dr({nodes:l.nodes().map(a=>({id:a,data:{x:l.getNodeAttribute(a,"x"),y:l.getNodeAttribute(a,"y"),z:l.getNodeAttribute(a,"z")}})),edges:l.edges().map(a=>({id:a,source:l.source(a),target:l.target(a),data:{weight:l.getEdgeAttribute(a,"weight")}}))}),od=l=>{const a=new zt;return l.getAllNodes().forEach(({id:i,data:{x:d,y:c,z:g}})=>{a.hasNode(i)||a.addNode(i,{x:d,y:c,z:g})}),l.getAllEdges().forEach(({source:i,target:d,data:{weight:c}})=>{a.addEdge(i,d,{weight:c})}),a};export{zr as C,fd as F,ie as T,_t as _,gd as a,ld as b,cd as c,hd as d,ws as e,he as f,dd as h,Eo as i,pd as l,ud as u};
