var t=Object.defineProperty,e=Object.assign,r=(e,r,n)=>("symbol"!=typeof r&&(r+=""),r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n);const n={};import{_ as o,a as i,b as a,i as s,w as u,g as d,c as h,G as c,d as l}from"./vendor.eaf49d67.js";!function(t=".",e="__import__"){try{self[e]=new Function("u","return import(u)")}catch(r){const n=new URL(t,location),o=t=>{URL.revokeObjectURL(t.src),t.remove()};self[e]=t=>new Promise(((r,i)=>{const a=new URL(t,n);if(self[e].moduleMap[a])return r(self[e].moduleMap[a]);const s=new Blob([`import * as m from '${a}';`,`${e}.moduleMap['${a}']=m;`],{type:"text/javascript"}),u=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(s),onerror(){i(new Error(`Failed to import: ${t}`)),o(u)},onload(){r(self[e].moduleMap[a]),o(u)}});document.head.appendChild(u)})),self[e].moduleMap={}}}("/layout/assets/");var f={913:t=>{var e=Object.prototype.hasOwnProperty,r="~";function n(){}function o(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function i(t,e,n,i,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new o(n,i||t,a),u=r?r+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],s]:t._events[u].push(s):(t._events[u]=s,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var t,n,o=[];if(0===this._eventsCount)return o;for(n in t=this._events)e.call(t,n)&&o.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},s.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,a=new Array(i);o<i;o++)a[o]=n[o].fn;return a},s.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},s.prototype.emit=function(t,e,n,o,i,a){var s=r?r+t:t;if(!this._events[s])return!1;var u,d,h=this._events[s],c=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),c){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,n),!0;case 4:return h.fn.call(h.context,e,n,o),!0;case 5:return h.fn.call(h.context,e,n,o,i),!0;case 6:return h.fn.call(h.context,e,n,o,i,a),!0}for(d=1,u=new Array(c-1);d<c;d++)u[d-1]=arguments[d];h.fn.apply(h.context,u)}else{var l,f=h.length;for(d=0;d<f;d++)switch(h[d].once&&this.removeListener(t,h[d].fn,void 0,!0),c){case 1:h[d].fn.call(h[d].context);break;case 2:h[d].fn.call(h[d].context,e);break;case 3:h[d].fn.call(h[d].context,e,n);break;case 4:h[d].fn.call(h[d].context,e,n,o);break;default:if(!u)for(l=1,u=new Array(c-1);l<c;l++)u[l-1]=arguments[l];h[d].fn.apply(h[d].context,u)}}return!0},s.prototype.on=function(t,e,r){return i(this,t,e,r,!1)},s.prototype.once=function(t,e,r){return i(this,t,e,r,!0)},s.prototype.removeListener=function(t,e,n,o){var i=r?r+t:t;if(!this._events[i])return this;if(!e)return a(this,i),this;var s=this._events[i];if(s.fn)s.fn!==e||o&&!s.once||n&&s.context!==n||a(this,i);else{for(var u=0,d=[],h=s.length;u<h;u++)(s[u].fn!==e||o&&!s[u].once||n&&s[u].context!==n)&&d.push(s[u]);d.length?this._events[i]=1===d.length?d[0]:d:a(this,i)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&a(this,e)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,t.exports=s},497:(t,e,r)=>{var n=r(331),o=["stopLayout","calculateLayout"];t.exports=function(){var t=new Worker(URL.createObjectURL(new Blob(['var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{calculateLayout:()=>jn,stopLayout:()=>Ln});var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function o(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function i(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function a(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function u(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}Object.create,Object.create;const h=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[],i=this._events["*"]||[],a=function(n){for(var o=n.length,i=0;i<o;i++)if(n[i]){var a=n[i],s=a.callback;a.once&&(n.splice(i,1),0===n.length&&delete e._events[t],o--,i--),s.apply(e,r)}};a(o),a(i)},t.prototype.off=function(t,e){if(t)if(e){for(var r=this._events[t]||[],n=r.length,o=0;o<n;o++)r[o].callback===e&&(r.splice(o,1),n--,o--);0===r.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function d(t,e,r,n){for(;t.length;){const o=t.shift();if(r(o))return!0;e.add(o.id),n(o.id).forEach((r=>{e.has(r.id)||(e.add(r.id),t.push(r))}))}return!1}function l(t,e,r,n){if(r(t))return!0;e.add(t.id);for(const o of n(t.id))if(!e.has(o.id)&&l(o,e,r,n))return!0;return!1}class c extends h{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const r=e.find((e=>e.type===t.type&&e.id===t.id&&e.propertyName===t.propertyName));r?r.newValue=t.newValue:e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const r=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),r=this.bothEdgesMap.get(t);r?.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((e=>{e.childrenMap.get(t)?.forEach((t=>{e.parentMap.delete(t.id)})),e.parentMap.delete(t),e.childrenMap.delete(t)})),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){const n=this.getNode(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateNodeDataProperty(t,e,r)}))}))}updateNodeData(...t){const e=t[0],r=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:o})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),o.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),o=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),o.delete(e),i.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.source,o=e;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:o})}))}updateEdgeTarget(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.target,o=e;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:o})}))}updateEdgeDataProperty(t,e,r){const n=this.getEdge(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}updateEdgeData(...t){const e=t[0],r=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:o})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateEdgeDataProperty(t,e,r)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const r=[],n=Array.isArray(t)?t:[t];for(;n.length;){const t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach((t=>{t.children?.forEach((r=>{this.setParent(r.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const r=this.treeIndices.get(e).childrenMap.get(t);return Array.from(r||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const r=[];let n,o=this.getNode(t);for(;n=this.getParent(o.id,e);)r.push(n),o=n;return r}setParent(t,e,r){this.checkTreeExistence(r);const n=this.treeIndices.get(r),o=this.getNode(t),i=n.parentMap.get(t),a=this.getNode(e);n.parentMap.set(t,a),i&&n.childrenMap.get(i.id)?.delete(o);let s=n.childrenMap.get(a.id);s||(s=new Set,n.childrenMap.set(a.id,s)),s.add(o),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:i?.id,newParentId:a.id})}))}dfsTree(t,e,r){return l(this.getNode(t),new Set,e,(t=>this.getChildren(t,r)))}bfsTree(t,e,r){return d([this.getNode(t)],new Set,e,(t=>this.getChildren(t,r)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return d([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return l(this.getNode(t),new Set,e,n)}clone(){const t=this.getAllNodes().map((t=>({...t,data:{...t.data}}))),e=this.getAllEdges().map((t=>({...t,data:{...t.data}}))),r=new c({nodes:t,edges:e});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},n)=>{const o=new Map;t.forEach(((t,e)=>{o.set(e,r.getNode(t.id))}));const i=new Map;e.forEach(((t,e)=>{i.set(e,new Set(Array.from(t).map((t=>r.getNode(t.id)))))})),r.treeIndices.set(n,{parentMap:o,childrenMap:i})})),r}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var f=/-(\\w)/g,g=(function(t){return t.replace(f,(function(t,e){return e?e.toUpperCase():""}))},Object.create(null),Array.isArray),p=function(t){for(var e=[],r=t.length,n=0;n<r;n+=1){e[n]=[];for(var o=0;o<r;o+=1)n===o?e[n][o]=0:0!==t[n][o]&&t[n][o]?e[n][o]=t[n][o]:e[n][o]=1/0}for(var i=0;i<r;i+=1)for(n=0;n<r;n+=1)for(o=0;o<r;o+=1)e[n][o]>e[n][i]+e[i][o]&&(e[n][o]=e[n][i]+e[i][o]);return e},v=function(t,e){var r=t.nodes,n=t.edges,o=[],i={};if(!r)throw new Error("invalid nodes data!");return r&&r.forEach((function(t,e){i[t.id]=e,o.push([])})),null==n||n.forEach((function(t){var r=t.source,n=t.target,a=i[r],s=i[n];void 0!==a&&void 0!==s&&(o[a][s]=1,e||(o[s][a]=1))})),o},y=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},m={}.toString;const w=function(t,e){return m.call(t)==="[object "+e+"]"},x=function(t){return w(t,"Number")};var E=function(t){if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var e=[];return t.forEach((function(t){e.push(t)})),e.map((function(t){return E(t)}))}if("object"==typeof t){var r={};return Object.keys(t).forEach((function(e){r[e]=E(t[e])})),r}return t},N=function(t,e){var r=E(t);return r.data=r.data||{},e&&(x(r.data.x)||(r.data.x=Math.random()*e[0]),x(r.data.y)||(r.data.y=Math.random()*e[1])),r};const b=function(t){return"function"==typeof t},M=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function S(t,e){return b(e)?e:x(e)?function(){return e}:function(){return t}}function k(t,e,r){return void 0===r&&(r=!0),e||0===e?b(e)?e:x(e)?function(){return e}:g(e)?function(){if(r){var n=Math.max.apply(Math,u(e));return isNaN(n)?t:n}return e}:M(e)?function(){if(r){var n=Math.max(e.width,e.height);return isNaN(n)?t:n}return[e.width,e.height]}:function(){return t}:function(e){var r=(e.data||{}).size;return r?g(r)?r[0]>r[1]?r[0]:r[1]:M(r)?r.width>r.height?r.width:r.height:r:t}}var A=function(t,e){var r;return r=x(e)?function(){return e}:b(e)?e:function(){return 0},t?g(t)?function(e){return(t[0]>t[1]?t[0]:t[1])+r(e)}:function(e){return t+r(e)}:function(t){var e,n;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return Math.max(t.data.bboxSize[0],t.data.bboxSize[1])+r(t);if(null===(n=t.data)||void 0===n?void 0:n.size){if(g(t.data.size))return Math.max(t.data.size[0],t.data.size[1])+r(t);var o=t.data.size;return M(o)?(o.width>o.height?o.width:o.height)+r(t):o+r(t)}return 10+r(t)}},_=function(t,e,r){var o=t.getAllNodes(),i=t.getAllEdges();return(null==o?void 0:o.length)?1===o.length?(e&&t.mergeNodeData(o[0].id,{x:r[0],y:r[1]}),{nodes:[n(n({},o[0]),{data:n(n({},o[0].data),{x:r[0],y:r[1]})})],edges:i}):void 0:{nodes:[],edges:i}},R={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},z=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="circular",this.options=n(n({},R),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericCircularLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericCircularLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericCircularLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,u,h,d,l,c,f,g,p,v,y,m,w,x,E,b,M,A,R,z,O,P,T,C,q,L,j,F,V,B,G,W,$,U;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,u=o.height,h=o.center,d=o.divisions,l=o.startAngle,c=void 0===l?0:l,f=o.endAngle,g=void 0===f?2*Math.PI:f,p=o.angleRatio,v=o.ordering,y=o.clockwise,m=o.nodeSpacing,w=o.nodeSize,x=e.getAllNodes(),E=e.getAllEdges(),b=s(D(i,u,h),3),M=b[0],A=b[1],R=b[2],!(z=null==x?void 0:x.length)||1===z)return[2,_(e,t,R)];for(O=(g-c)/z,P=o.radius,T=o.startRadius,C=o.endRadius,m?(q=S(10,m),L=k(10,w),j=-1/0,x.forEach((function(t){var e=L(t);j<e&&(j=e)})),F=0,x.forEach((function(t,e){F+=0===e?j||10:(q(t)||0)+(j||10)})),P=F/(2*Math.PI)):P||T||C?!T&&C?T=C:T&&!C&&(C=T):P=Math.min(A,M)/2,V=O*p,B=[],B="topology"===v?I(e,x):"topology-directed"===v?I(e,x,!0):"degree"===v?function(t,e){var r=[];return e.forEach((function(t,e){r.push(N(t))})),r.sort((function(e,r){return t.getDegree(e.id,"both")-t.getDegree(r.id,"both")})),r}(e,x):x.map((function(t){return N(t)})),G=Math.ceil(z/d),W=0;W<z;++W)($=P)||null===T||null===C||($=T+W*(C-T)/(z-1)),$||($=10+100*W/(z-1)),U=c+W%G*V+2*Math.PI/d*Math.floor(W/G),y||(U=g-W%G*V-2*Math.PI/d*Math.floor(W/G)),B[W].data.x=R[0]+Math.cos(U)*$,B[W].data.y=R[1]+Math.sin(U)*$;return t&&B.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:B,edges:E}]}))}))},t}(),I=function(t,e,r){void 0===r&&(r=!1);var n=[N(e[0])],o={},i=e.length;o[e[0].id]=!0;var a=0;return e.forEach((function(s,u){if(0!==u)if(u!==i-1&&t.getDegree(s.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(n[a].id,s.id)||o[s.id]){for(var h=r?t.getSuccessors(n[a].id):t.getNeighbors(n[a].id),d=!1,l=0;l<h.length;l++){var c=h[l];if(t.getDegree(c.id)===t.getDegree(s.id)&&!o[c.id]){n.push(N(c)),o[c.id]=!0,d=!0;break}}for(var f=0;!d&&(o[e[f].id]||(n.push(N(e[f])),o[e[f].id]=!0,d=!0),++f!==i););}else n.push(N(s)),o[s.id]=!0,a++})),n},D=function(t,e,r){var n=t,o=e,i=r;return n||"undefined"==typeof window||(n=window.innerWidth),o||"undefined"==typeof window||(o=window.innerHeight),i||(i=[n/2,o/2]),[n,o,i]};const O=function(t){return w(t,"String")};var P={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},T=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="concentric",this.options=n(n({},P),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericConcentricLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericConcentricLayout(!0,t,e),[2]}))}))},t.prototype.genericConcentricLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,p,v,y,m,w,E,S,k,A,R,z,I,D,P,T,C,q,L,j,F,V,B,G,W,$,U,H,K,Y;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,h=o.sortBy,d=o.maxLevelDiff,l=o.sweep,c=o.clockwise,f=o.equidistant,p=o.preventOverlap,v=o.startAngle,y=void 0===v?1.5*Math.PI:v,m=o.nodeSize,w=o.nodeSpacing,E=e.getAllNodes(),S=e.getAllEdges(),k=s||"undefined"==typeof window?s:window.innerWidth,A=u||"undefined"==typeof window?u:window.innerHeight,R=i||[k/2,A/2],!(null==E?void 0:E.length)||1===E.length)return[2,_(e,t,R)];if(z=[],D=0,I=g(m)?Math.max(m[0],m[1]):m,g(w)?D=Math.max(w[0],w[1]):x(w)&&(D=w),E.forEach((function(t){var e=N(t);z.push(e);var r=I,n=e.data;g(n.size)?r=Math.max(n.size[0],n.size[1]):x(n.size)?r=n.size:M(n.size)&&(r=Math.max(n.size.width,n.size.height)),I=Math.max(I,r),b(w)&&(D=Math.max(w(t),D))})),P={},z.forEach((function(t,e){P[t.id]=e})),O(T=h)&&void 0!==z[0].data[T]||(T="degree"),"degree"===T?z.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):z.sort((function(t,e){return e.data[T]-t.data[T]})),C=z[0],q=(d||("degree"===T?e.getDegree(C.id,"both"):C.data[T]))/4,j=(L=[{nodes:[]}])[0],z.forEach((function(t){if(j.nodes.length>0){var r="degree"===T?Math.abs(e.getDegree(j.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(j.nodes[0].data[T]-t.data[T]);q&&r>=q&&(j={nodes:[]},L.push(j))}j.nodes.push(t)})),F=I+D,p||(V=L.length>0&&L[0].nodes.length>1,B=Math.min(k,A)/2-F,G=B/(L.length+(V?1:0)),F=Math.min(F,G)),W=0,L.forEach((function(t){var e=void 0===l?2*Math.PI-2*Math.PI/t.nodes.length:l;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&p){var r=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),o=Math.sqrt(F*F/(r*r+n*n));W=Math.max(o,W)}t.r=W,W+=F})),f){for($=0,U=0,H=0;H<L.length;H++)K=L[H],Y=(K.r||0)-U,$=Math.max($,Y);U=0,L.forEach((function(t,e){0===e&&(U=t.r||0),t.r=U,U+=$}))}return L.forEach((function(t){var e=t.dTheta||0,r=t.r||0;t.nodes.forEach((function(t,n){var o=y+(c?1:-1)*e*n;t.data.x=R[0]+r*Math.cos(o),t.data.y=R[1]+r*Math.sin(o)}))})),t&&z.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:z,edges:S}]}))}))},t}();function C(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i,a,s,u,h,d,l,c,f=t._root,g={data:n},p=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!f)return t._root=g,t;for(;f.length;)if((h=e>=(i=(p+y)/2))?p=i:y=i,(d=r>=(a=(v+m)/2))?v=a:m=a,o=f,!(f=f[l=d<<1|h]))return o[l]=g,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&r===u)return g.next=f,o?o[l]=g:t._root=g,t;do{o=o?o[l]=new Array(4):t._root=new Array(4),(h=e>=(i=(p+y)/2))?p=i:y=i,(d=r>=(a=(v+m)/2))?v=a:m=a}while((l=d<<1|h)==(c=(u>=a)<<1|s>=i));return o[c]=f,o[l]=g,t}function q(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function L(t){return t[0]}function j(t){return t[1]}function F(t,e,r){var n=new V(null==e?L:e,null==r?j:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function V(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function B(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var G=F.prototype=V.prototype;function W(t){return function(){return t}}function $(t){return 1e-6*(t()-.5)}G.copy=function(){var t,e,r=new V(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=B(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var o=0;o<4;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(4)}):n.target[o]=B(e));return r},G.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return C(this.cover(e,r),e,r,t)},G.addAll=function(t){var e,r,n,o,i=t.length,a=new Array(i),s=new Array(i),u=1/0,h=1/0,d=-1/0,l=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(a[r]=n,s[r]=o,n<u&&(u=n),n>d&&(d=n),o<h&&(h=o),o>l&&(l=o));if(u>d||h>l)return this;for(this.cover(u,h).cover(d,l),r=0;r<i;++r)C(this,a[r],s[r],t[r]);return this},G.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var a,s,u=o-r||1,h=this._root;r>t||t>=o||n>e||e>=i;)switch(s=(e<n)<<1|t<r,(a=new Array(4))[s]=h,h=a,u*=2,s){case 0:o=r+u,i=n+u;break;case 1:r=o-u,i=n+u;break;case 2:o=r+u,n=i-u;break;case 3:r=o-u,n=i-u}this._root&&this._root.length&&(this._root=h)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this},G.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},G.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},G.find=function(t,e,r){var n,o,i,a,s,u,h,d=this._x0,l=this._y0,c=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new q(p,d,l,c,f)),null==r?r=1/0:(d=t-r,l=e-r,c=t+r,f=e+r,r*=r);u=g.pop();)if(!(!(p=u.node)||(o=u.x0)>c||(i=u.y0)>f||(a=u.x1)<d||(s=u.y1)<l))if(p.length){var v=(o+a)/2,y=(i+s)/2;g.push(new q(p[3],v,y,a,s),new q(p[2],o,y,v,s),new q(p[1],v,i,a,y),new q(p[0],o,i,v,y)),(h=(e>=y)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-h],g[g.length-1-h]=u)}else{var m=t-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),x=m*m+w*w;if(x<r){var E=Math.sqrt(r=x);d=t-E,l=e-E,c=t+E,f=e+E,n=p.data}}return n},G.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,r,n,o,i,a,s,u,h,d,l,c,f=this._root,g=this._x0,p=this._y0,v=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((h=i>=(s=(g+v)/2))?g=s:v=s,(d=a>=(u=(p+y)/2))?p=u:y=u,e=f,!(f=f[l=d<<1|h]))return this;if(!f.length)break;(e[l+1&3]||e[l+2&3]||e[l+3&3])&&(r=e,c=l)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(o=f.next)&&delete f.next,n?(o?n.next=o:delete n.next,this):e?(o?e[l]=o:delete e[l],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[c]=f:this._root=f),this):(this._root=o,this)},G.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},G.root=function(){return this._root},G.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},G.visit=function(t){var e,r,n,o,i,a,s=[],u=this._root;for(u&&s.push(new q(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,n=e.x0,o=e.y0,i=e.x1,a=e.y1)&&u.length){var h=(n+i)/2,d=(o+a)/2;(r=u[3])&&s.push(new q(r,h,d,i,a)),(r=u[2])&&s.push(new q(r,n,d,h,a)),(r=u[1])&&s.push(new q(r,h,o,i,d)),(r=u[0])&&s.push(new q(r,n,o,h,d))}return this},G.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new q(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.x1,h=e.y1,d=(a+u)/2,l=(s+h)/2;(i=o[0])&&r.push(new q(i,a,s,d,l)),(i=o[1])&&r.push(new q(i,d,s,u,l)),(i=o[2])&&r.push(new q(i,a,l,d,h)),(i=o[3])&&r.push(new q(i,d,l,u,h))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},G.x=function(t){return arguments.length?(this._x=t,this):this._x},G.y=function(t){return arguments.length?(this._y=t,this):this._y};var U={value:()=>{}};function H(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new K(n)}function K(t){this._=t}function Y(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function J(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=U,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}K.prototype=H.prototype={constructor:K,on:function(t,e){var r,n,o=this._,i=(n=o,(t+"").trim().split(/^|\\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)o[r]=J(o[r],t.name,e);else if(null==e)for(r in o)o[r]=J(o[r],t.name,null);return this}for(;++a<s;)if((r=(t=i[a]).type)&&(r=Y(o[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new K(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};const X=H;var Q,Z,tt=0,et=0,rt=0,nt=1e3,ot=0,it=0,at=0,st="object"==typeof performance&&performance.now?performance:Date,ut="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ht(){return it||(ut(dt),it=st.now()+at)}function dt(){it=0}function lt(){this._call=this._time=this._next=null}function ct(t,e,r){var n=new lt;return n.restart(t,e,r),n}function ft(){it=(ot=st.now())+at,tt=et=0;try{!function(){ht(),++tt;for(var t,e=Q;e;)(t=it-e._time)>=0&&e._call.call(void 0,t),e=e._next;--tt}()}finally{tt=0,function(){for(var t,e,r=Q,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:Q=e);Z=t,pt(n)}(),it=0}}function gt(){var t=st.now(),e=t-ot;e>nt&&(at-=e,ot=t)}function pt(t){tt||(et&&(et=clearTimeout(et)),t-it>24?(t<1/0&&(et=setTimeout(ft,t-st.now()-at)),rt&&(rt=clearInterval(rt))):(rt||(ot=st.now(),rt=setInterval(gt,nt)),tt=1,ut(ft)))}lt.prototype=ct.prototype={constructor:lt,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?ht():+r)+(null==e?0:+e),this._next||Z===this||(Z?Z._next=this:Q=this,Z=this),this._call=t,this._time=r,pt()},stop:function(){this._call&&(this._call=null,this._time=1/0,pt())}};const vt=1664525,yt=1013904223,mt=4294967296;function wt(t){return t.x}function xt(t){return t.y}var Et=10,Nt=Math.PI*(3-Math.sqrt(5));function bt(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,a=.6,s=new Map,u=ct(l),h=X("tick","end"),d=function(){let t=1;return()=>(t=(vt*t+yt)%mt)/mt}();function l(){c(),h.call("tick",e),r<n&&(u.stop(),h.call("end",e))}function c(n){var u,h,d=t.length;void 0===n&&(n=1);for(var l=0;l<n;++l)for(r+=(i-r)*o,s.forEach((function(t){t(r)})),u=0;u<d;++u)null==(h=t[u]).fx?h.x+=h.vx*=a:(h.x=h.fx,h.vx=0),null==h.fy?h.y+=h.vy*=a:(h.y=h.fy,h.vy=0);return e}function f(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var o=Et*Math.sqrt(.5+r),i=r*Nt;e.x=o*Math.cos(i),e.y=o*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,d),e}return null==t&&(t=[]),f(),e={tick:c,restart:function(){return u.restart(l),e},stop:function(){return u.stop(),e},nodes:function(r){return arguments.length?(t=r,f(),s.forEach(g),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(d=t,s.forEach(g),e):d},force:function(t,r){return arguments.length>1?(null==r?s.delete(t):s.set(t,g(r)),e):s.get(t)},find:function(e,r,n){var o,i,a,s,u,h=0,d=t.length;for(null==n?n=1/0:n*=n,h=0;h<d;++h)(a=(o=e-(s=t[h]).x)*o+(i=r-s.y)*i)<n&&(u=s,n=a);return u},on:function(t,r){return arguments.length>1?(h.on(t,r),e):h.on(t)}}}function Mt(){var t,e,r,n,o,i=W(-30),a=1,s=1/0,u=.81;function h(r){var o,i=t.length,a=F(t,wt,xt).visitAfter(l);for(n=r,o=0;o<i;++o)e=t[o],a.visit(c)}function d(){if(t){var e,r,n=t.length;for(o=new Array(n),e=0;e<n;++e)r=t[e],o[r.index]=+i(r,e,t)}}function l(t){var e,r,n,i,a,s=0,u=0;if(t.length){for(n=i=a=0;a<4;++a)(e=t[a])&&(r=Math.abs(e.value))&&(s+=e.value,u+=r,n+=r*e.x,i+=r*e.y);t.x=n/u,t.y=i/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=o[e.data.index]}while(e=e.next)}t.value=s}function c(t,i,h,d){if(!t.value)return!0;var l=t.x-e.x,c=t.y-e.y,f=d-i,g=l*l+c*c;if(f*f/u<g)return g<s&&(0===l&&(g+=(l=$(r))*l),0===c&&(g+=(c=$(r))*c),g<a&&(g=Math.sqrt(a*g)),e.vx+=l*t.value*n/g,e.vy+=c*t.value*n/g),!0;if(!(t.length||g>=s)){(t.data!==e||t.next)&&(0===l&&(g+=(l=$(r))*l),0===c&&(g+=(c=$(r))*c),g<a&&(g=Math.sqrt(a*g)));do{t.data!==e&&(f=o[t.data.index]*n/g,e.vx+=l*f,e.vy+=c*f)}while(t=t.next)}}return h.initialize=function(e,n){t=e,r=n,d()},h.strength=function(t){return arguments.length?(i="function"==typeof t?t:W(+t),d(),h):i},h.distanceMin=function(t){return arguments.length?(a=t*t,h):Math.sqrt(a)},h.distanceMax=function(t){return arguments.length?(s=t*t,h):Math.sqrt(s)},h.theta=function(t){return arguments.length?(u=t*t,h):Math.sqrt(u)},h}function St(t){return t.index}function kt(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function At(t){var e,r,n,o,i,a,s=St,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},h=W(30),d=1;function l(n){for(var o=0,s=t.length;o<d;++o)for(var u,h,l,c,f,g,p,v=0;v<s;++v)h=(u=t[v]).source,c=(l=u.target).x+l.vx-h.x-h.vx||$(a),f=l.y+l.vy-h.y-h.vy||$(a),c*=g=((g=Math.sqrt(c*c+f*f))-r[v])/g*n*e[v],f*=g,l.vx-=c*(p=i[v]),l.vy-=f*p,h.vx+=c*(p=1-p),h.vy+=f*p}function c(){if(n){var a,u,h=n.length,d=t.length,l=new Map(n.map(((t,e)=>[s(t,e,n),t])));for(a=0,o=new Array(h);a<d;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=kt(l,u.source)),"object"!=typeof u.target&&(u.target=kt(l,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(a=0,i=new Array(d);a<d;++a)u=t[a],i[a]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);e=new Array(d),f(),r=new Array(d),g()}}function f(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+u(t[r],r,t)}function g(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+h(t[e],e,t)}return null==t&&(t=[]),l.initialize=function(t,e){n=t,a=e,c()},l.links=function(e){return arguments.length?(t=e,c(),l):t},l.id=function(t){return arguments.length?(s=t,l):s},l.iterations=function(t){return arguments.length?(d=+t,l):d},l.strength=function(t){return arguments.length?(u="function"==typeof t?t:W(+t),f(),l):u},l.distance=function(t){return arguments.length?(h="function"==typeof t?t:W(+t),g(),l):h},l}function _t(t){return t.x+t.vx}function Rt(t){return t.y+t.vy}function zt(t){var e,r,n,o=1,i=1;function a(){for(var t,a,u,h,d,l,c,f=e.length,g=0;g<i;++g)for(a=F(e,_t,Rt).visitAfter(s),t=0;t<f;++t)u=e[t],l=r[u.index],c=l*l,h=u.x+u.vx,d=u.y+u.vy,a.visit(p);function p(t,e,r,i,a){var s=t.data,f=t.r,g=l+f;if(!s)return e>h+g||i<h-g||r>d+g||a<d-g;if(s.index>u.index){var p=h-s.x-s.vx,v=d-s.y-s.vy,y=p*p+v*v;y<g*g&&(0===p&&(y+=(p=$(n))*p),0===v&&(y+=(v=$(n))*v),y=(g-(y=Math.sqrt(y)))/y*o,u.vx+=(p*=y)*(g=(f*=f)/(c+f)),u.vy+=(v*=y)*g,s.vx-=p*(g=1-g),s.vy-=v*g)}}}function s(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var n,o,i=e.length;for(r=new Array(i),n=0;n<i;++n)o=e[n],r[o.index]=+t(o,n,e)}}return"function"!=typeof t&&(t=W(null==t?1:+t)),a.initialize=function(t,r){e=t,n=r,u()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(o=+t,a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:W(+e),u(),a):t},a}function It(t){var e,r,n,o=W(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=W(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:W(+t),a(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:W(+e),a(),i):t},i}function Dt(t){var e,r,n,o=W(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=W(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:W(+t),a(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:W(+e),a(),i):t},i}function Ot(){function t(t){return function(){return t}}var e,r=function(t){return t.cluster},n=t(1),o=t(-1),i=t(100),a=t(.1),u=[0,0],h=[],d={},l=[],c=100,f=100,g={none:{x:0,y:0}},p=[],v="force",y=!0,m=.1;function w(t){if(!y)return w;e.tick(),E();for(var n=0,o=h.length,i=void 0,a=t*m;n<o;++n)(i=h[n]).vx+=(g[r(i)].x-i.x)*a,i.vy+=(g[r(i)].y-i.y)*a}function x(){h&&function(){if(h&&h.length){if(void 0===r(h[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy(\'clusterAttr\') before calling .links()");var t,u,g,v,y,m=(t=[],u=[],g={},{},y=[],v=function(t){var e={};return t.forEach((function(t){var n=r(t);e[n]||(e[n]={count:0,sumforceNodeSize:0})})),t.forEach((function(t){var o=r(t),i=n(t),a=e[o];a.count=a.count+1,a.sumforceNodeSize=a.sumforceNodeSize+Math.PI*(i*i)*1.3,e[o]=a})),e}(h),y=function(t){var e={},n=[];return t.forEach((function(t){var n,o,i,a,s,u=(o=(n=t).source,i=n.target,(a=r(d[o]))<=(s=r(d[i]))?a+"~"+s:s+"~"+a),h=0;void 0!==e[u]&&(h=e[u]),h+=1,e[u]=h})),Object.entries(e).forEach((function(t){var e=s(t,2),r=e[0],o=e[1],i=r.split("~")[0],a=r.split("~")[1];void 0!==i&&void 0!==a&&n.push({source:i,target:a,count:o})})),n}(l),Object.keys(v).forEach((function(e,r){var n=v[e];t.push({id:e,size:n.count,r:Math.sqrt(n.sumforceNodeSize/Math.PI)}),g[e]=r})),y.forEach((function(t){var e=t.source,r=t.target,n=g[e],o=g[r];void 0!==n&&void 0!==o&&u.push({source:n,target:o,count:t.count})})),{nodes:t,links:u});e=bt(m.nodes).force("x",It(c).strength(.1)).force("y",Dt(f).strength(.1)).force("collide",zt((function(t){return t.r})).iterations(4)).force("charge",Mt().strength(o)).force("links",At(m.nodes.length?m.links:[]).distance(i).strength(a)),p=e.nodes(),E()}}()}function E(){return g={none:{x:0,y:0}},p.forEach((function(t){g[t.id]={x:t.x-u[0],y:t.y-u[1]}})),g}return w.initialize=function(t){h=t,x()},w.template=function(t){return arguments.length?(v=t,x(),w):v},w.groupBy=function(t){return arguments.length?"string"==typeof t?(r=function(e){return e[t]},w):(r=t,w):r},w.enableGrouping=function(t){return arguments.length?(y=t,w):y},w.strength=function(t){return arguments.length?(m=t,w):m},w.centerX=function(t){return arguments.length?(c=t,w):c},w.centerY=function(t){return arguments.length?(f=t,w):f},w.nodes=function(t){return arguments.length?(function(t){d={},t.forEach((function(t){d[t.id]=t}))}(t||[]),h=t||[],w):h},w.links=function(t){return arguments.length?(l=t||[],x(),w):l},w.forceNodeSize=function(e){return arguments.length?(n="function"==typeof e?e:t(+e),x(),w):n},w.nodeSize=w.forceNodeSize,w.forceCharge=function(e){return arguments.length?(o="function"==typeof e?e:t(+e),x(),w):o},w.forceLinkDistance=function(e){return arguments.length?(i="function"==typeof e?e:t(+e),x(),w):i},w.forceLinkStrength=function(e){return arguments.length?(a="function"==typeof e?e:t(+e),x(),w):a},w.offset=function(t){return arguments.length?(u=t,w):u},w.getFocis=E,w}var Pt={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},Tt=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="d3force",this.options=n(n({},Pt),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){var t;null===(t=this.forceSimulation)||void 0===t||t.stop()},t.prototype.tick=function(t){var e=this;void 0===t&&(t=1),this.forceSimulation.tick(t);var r={nodes:Ct(this.lastLayoutNodes),edges:qt(this.lastLayoutEdges)};return this.lastAssign&&r.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,g,p,v,y,m,w,x,E,b,M,S,k,A,_,R,z,I,D=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=i.map((function(t){var e,r;return n(n({},N(t)),{x:null===(e=t.data)||void 0===e?void 0:e.x,y:null===(r=t.data)||void 0===r?void 0:r.y})})),h=s.map((function(t){return N(t)})),this.lastLayoutNodes=u,this.lastLayoutEdges=h,this.lastAssign=t,this.lastGraph=e,d=o.alphaMin,l=o.alphaDecay,c=o.alpha,f=o.nodeStrength,g=o.edgeStrength,p=o.linkDistance,v=o.clustering,y=o.clusterFociStrength,m=o.clusterEdgeDistance,w=o.clusterEdgeStrength,x=o.clusterNodeStrength,E=o.clusterNodeSize,b=o.collideStrength,M=void 0===b?1:b,S=o.center,k=void 0===S?[0,0]:S,A=o.preventOverlap,_=o.nodeSize,R=o.nodeSpacing,z=o.onTick,I=o.forceSimulation,[2,new Promise((function(r){if(I){v&&((i=Ot()).nodes(u),i.links(h)),I.nodes(u),h&&(s=At().id((function(t){return t.id})).links(h),g&&s.strength(g),p&&s.distance(p),I.force("link",s)),A&&D.overlapProcess(I,{nodeSize:_,nodeSpacing:R,collideStrength:M}),I.alpha(c).restart();var n=Ct(u),o=qt(h);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:o})}else try{var i,a=Mt();if(f&&a.strength(f),I=bt().nodes(u),v&&((i=Ot()).centerX(k[0]).centerY(k[1]).template("force").strength(y),h&&i.links(h),u&&i.nodes(u),i.forceLinkDistance(m).forceLinkStrength(w).forceCharge(x).forceNodeSize(E),I.force("group",i)),I.force("center",function(t,e){var r,n=1;function o(){var o,i,a=r.length,s=0,u=0;for(o=0;o<a;++o)s+=(i=r[o]).x,u+=i.y;for(s=(s/a-t)*n,u=(u/a-e)*n,o=0;o<a;++o)(i=r[o]).x-=s,i.y-=u}return null==t&&(t=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(n=+t,o):n},o}(k[0],k[1])).force("charge",a).alpha(c).alphaDecay(l).alphaMin(d),A&&D.overlapProcess(I,{nodeSize:_,nodeSpacing:R,collideStrength:M}),h){var s=At().id((function(t){return t.id})).links(h);g&&s.strength(g),p&&s.distance(p),I.force("link",s)}I.on("tick",(function(){var r=Ct(u);null==z||z({nodes:r,edges:qt(h)}),t&&r.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}))})).on("end",(function(){var n=Ct(u);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:qt(h)})}))}catch(t){console.warn(t)}D.forceSimulation=I}))]}))}))},t.prototype.overlapProcess=function(t,e){var r,n,o=e.nodeSize,i=e.nodeSpacing,a=e.collideStrength;if(n=x(i)?function(){return i}:b(i)?i:function(){return 0},o)if(b(o))r=function(t){return o(t)+n(t)};else if(g(o)){var s=(o[0]>o[1]?o[0]:o[1])/2;r=function(t){return s+n(t)}}else if(x(o)){var u=o/2;r=function(t){return u+n(t)}}else r=function(){return 10};else r=function(t){return t.size?g(t.size)?(t.size[0]>t.size[1]?t.size[0]:t.size[1])/2+n(t):M(t.size)?(t.size.width>t.size.height?t.size.width:t.size.height)/2+n(t):t.size/2+n(t):10+n(t)};t.force("collisionForce",zt(r).strength(a))},t}(),Ct=function(t){return t.map((function(t){var e=t.x,r=t.y,i=o(t,["x","y"]);return n(n({},i),{data:n(n({},i.data),{x:e,y:r})})}))},qt=function(t){return t.map((function(t){var e=t.source,r=t.target,i=o(t,["source","target"]);return n(n({},i),{source:e.id,target:r.id})}))};var Lt=function(t,e){if("next"!==t&&"prev"!==t)return e},jt=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(function(){function t(){var t={};t.prev=t,t.next=t.prev,this.shortcut=t}return t.prototype.dequeue=function(){var t=this.shortcut,e=t.prev;if(e&&e!==t)return jt(e),e},t.prototype.enqueue=function(t){var e=this.shortcut;t.prev&&t.next&&jt(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e},t.prototype.toString=function(){for(var t=[],e=this.shortcut,r=e.prev;r!==e;)t.push(JSON.stringify(r,Lt)),r=null==r?void 0:r.prev;return"["+t.join(", ")+"]"},t}()),Vt=function(){return 1},Bt=function(t,e,r,o,i){var a,s,u=[];return t.hasNode(o.v)&&(null===(a=t.getRelatedEdges(o.v,"in"))||void 0===a||a.forEach((function(o){var a=o.data.weight,s=t.getNode(o.source);i&&u.push({v:o.source,w:o.target,in:0,out:0}),void 0===s.data.out&&(s.data.out=0),s.data.out-=a,Gt(e,r,n({v:s.id},s.data))})),null===(s=t.getRelatedEdges(o.v,"out"))||void 0===s||s.forEach((function(o){var i=o.data.weight,a=o.target,s=t.getNode(a);void 0===s.data.in&&(s.data.in=0),s.data.in-=i,Gt(e,r,n({v:s.id},s.data))})),t.removeNode(o.v)),i?u:void 0},Gt=function(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},Wt=function(t,e){var r="greedy"===e?function(t,e){var r;if(t.getAllNodes().length<=1)return[];var o=function(t,e){var r=new c,o=0,i=0;t.getAllNodes().forEach((function(t){r.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((function(t){var a=r.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target})),s=(null==e?void 0:e(t))||1;a?r.updateEdgeData(null==a?void 0:a.id,n(n({},a.data),{weight:a.data.weight+s})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:s}}),i=Math.max(i,r.getNode(t.source).data.out+=s),o=Math.max(o,r.getNode(t.target).data.in+=s)}));for(var a=[],s=i+o+3,u=0;u<s;u++)a.push(new Ft);var h=o+1;return r.getAllNodes().forEach((function(t){Gt(a,h,n({v:t.id},r.getNode(t.id).data))})),{buckets:a,zeroIdx:h,graph:r}}(t,function(t){return t.data.weight||1}||Vt);return null===(r=function(t,e,r){for(var n,o=[],i=e[e.length-1],a=e[0];t.getAllNodes().length;){for(;n=a.dequeue();)Bt(t,e,r,n);for(;n=i.dequeue();)Bt(t,e,r,n);if(t.getAllNodes().length)for(var s=e.length-2;s>0;--s)if(n=e[s].dequeue()){o=o.concat(Bt(t,e,r,n,!0));break}}return o}(o.graph,o.buckets,o.zeroIdx).map((function(e){return t.getRelatedEdges(e.v,"out").filter((function(t){return t.target===e.w}))})))||void 0===r?void 0:r.flat()}(t):$t(t);null==r||r.forEach((function(e){var r=e.data;t.removeEdge(e.id),r.forwardName=e.data.name,r.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:n({},r)})}))},$t=function(t){var e=[],r={},n={},o=function(i){n[i]||(n[i]=!0,r[i]=!0,t.getRelatedEdges(i,"out").forEach((function(t){r[t.target]?e.push(t):o(t.target)})),delete r[i])};return t.getAllNodes().forEach((function(t){return o(t.id)})),e},Ut=function(t,e,r,n){var o;do{o=""+n+Math.random()}while(t.hasNode(o));return r.dummy=e,t.addNode({id:o,data:r}),o},Ht=function(t){var e=new c;return t.getAllNodes().forEach((function(r){t.getChildren(r.id).length||e.addNode(n({},r))})),t.getAllEdges().forEach((function(t){e.addEdge(t)})),e},Kt=function(t,e){var r,n,o=Number(t.x),i=Number(t.y),a=Number(e.x)-o,s=Number(e.y)-i,u=Number(t.width)/2,h=Number(t.height)/2;return a||s?(Math.abs(s)*u>Math.abs(a)*h?(s<0&&(h=-h),r=h*a/s,n=h):(a<0&&(u=-u),r=u,n=u*s/a),{x:o+r,y:i+n}):{x:0,y:0}},Yt=function(t){for(var e=[],r=Xt(t)+1,n=0;n<r;n++)e.push([]);for(t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)})),n=0;n<r;n++)e[n]=e[n].sort((function(e,r){return n=t.getNode(e).data.order,o=t.getNode(r).data.order,Number(n)-Number(o);var n,o}));return e},Jt=function(t,e,r,n){var o={width:0,height:0};return x(r)&&x(n)&&(o.rank=r,o.order=n),Ut(t,"border",o,e)},Xt=function(t){var e;return t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)})),e||(e=0),e},Qt=function(t,e){return t.reduce((function(t,r){return e(t)>e(r)?r:t}))},Zt=function(t,e,r,n,o,i){n.includes(e.id)||(n.push(e.id),r||i.push(e.id),o(e.id).forEach((function(e){return Zt(t,e,r,n,o,i)})),r&&i.push(e.id))},te=function(t,e,r,n){var o=Array.isArray(e)?e:[e],i=function(e){return n?t.getSuccessors(e):t.getNeighbors(e)},a=[],s=[];return o.forEach((function(e){if(!t.hasNode(e.id))throw new Error("Graph does not have node: "+e);Zt(t,e,"post"===r,s,i,a)})),a},ee="edge-label",re=function(t){var e={},r=function(n){var o,i,a=t.getNode(n);return a?e[n]?a.data.rank:(e[n]=!0,null===(o=t.getRelatedEdges(n,"out"))||void 0===o||o.forEach((function(t){var e=r(t.target)-t.data.minlen;e&&(void 0===i||e<i)&&(i=e)})),i||(i=0),a.data.rank=i,i):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){return r(t.id)}))},ne=function(t,e){return t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen},oe=function(t,e){var r=function(n){e.getRelatedEdges(n,"both").forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ie=function(t,e){var r=function(n){var o;null===(o=e.getRelatedEdges(n,"both"))||void 0===o||o.forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||void 0===e.getNode(a).data.layer&&ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ae=function(t,e){return Qt(e.getAllEdges(),(function(r){return t.hasNode(r.source)!==t.hasNode(r.target)?ne(e,r):1/0}))},se=function(t,e,r){t.getAllNodes().forEach((function(t){var n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r}))},ue=function(t,e){var r=te(t,t.getAllNodes(),"post",!1);(r=r.slice(0,(null==r?void 0:r.length)-1)).forEach((function(r){he(t,e,r)}))},he=function(t,e,r){var n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find((function(t){return t.target===n||t.source===n})).data.cutvalue=de(t,e,r)},de=function(t,e,r){var n=t.getNode(r).data.parent,o=!0,i=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),a=0;return i||(o=!1,i=e.getRelatedEdges(n,"out").find((function(t){return t.target===r}))),a=i.data.weight,e.getRelatedEdges(r,"both").forEach((function(e){var i=e.source===r,s=i?e.target:e.source;if(s!==n){var u=i===o,h=e.data.weight;if(a+=u?h:-h,ye(t,r,s)){var d=t.getRelatedEdges(r,"both").find((function(t){return t.source===s||t.target===s})).data.cutvalue;a+=u?-d:d}}})),a},le=function(t,e){void 0===e&&(e=t.getAllNodes()[0].id),ce(t,{},1,e)},ce=function(t,e,r,n,o){var i,a=r,s=r,u=t.getNode(n);return e[n]=!0,null===(i=t.getNeighbors(n))||void 0===i||i.forEach((function(r){e[r.id]||(s=ce(t,e,s,r.id,n))})),u.data.low=a,u.data.lim=s++,o?u.data.parent=o:delete u.data.parent,s},fe=function(t){return t.getAllEdges().find((function(t){return t.data.cutvalue<0}))},ge=function(t,e,r){var n=r.source,o=r.target;e.getRelatedEdges(n,"out").find((function(t){return t.target===o}))||(n=r.target,o=r.source);var i=t.getNode(n),a=t.getNode(o),s=i,u=!1;i.data.lim>a.data.lim&&(s=a,u=!0);var h=e.getAllEdges().filter((function(e){return u===me(t.getNode(e.source),s)&&u!==me(t.getNode(e.target),s)}));return Qt(h,(function(t){return ne(e,t)}))},pe=function(t,e,r,n){var o=t.getRelatedEdges(r.source,"both").find((function(t){return t.source===r.target||t.target===r.target}));o&&t.removeEdge(o.id),t.addEdge({id:"e"+Math.random(),source:n.source,target:n.target,data:{}}),le(t),ue(t,e),ve(t,e)},ve=function(t,e){var r=t.getAllNodes().find((function(t){return!t.data.parent})),n=te(t,r,"pre",!1);(n=n.slice(1)).forEach((function(r){var n=t.getNode(r).data.parent,o=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),i=!1;!o&&e.hasNode(n)&&(o=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),i=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(i?null==o?void 0:o.data.minlen:-(null==o?void 0:o.data.minlen))}))},ye=function(t,e,r){return t.getRelatedEdges(e,"both").find((function(t){return t.source===r||t.target===r}))},me=function(t,e){return e.data.low<=t.data.lim&&t.data.lim<=e.data.lim},we=re,xe=function(t){!function(t){var e=function(t){var e=new c;return t.getAllNodes().forEach((function(t){e.addNode(n({},t))})),t.getAllEdges().forEach((function(t){var r=e.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target}));r?e.updateEdgeData(null==r?void 0:r.id,n(n({},r.data),{weight:r.data.weight+t.data.weight||0,minlen:Math.max(r.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e}(t);re(e);var r,o,i=function(t){var e,r,n=new c({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);oe(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r);return n}(e);for(le(i),ue(i,e);r=fe(i);)o=ge(i,e,r),pe(i,e,r,o)}(t)},Ee=function(t,e,r,n,o,i,a){var s=t.getChildren(a);if(null==s?void 0:s.length){var u=Jt(t,"_bt"),h=Jt(t,"_bb"),d=t.getNode(a);t.setParent(u,a),d.data.borderTop=u,t.setParent(h,a),d.data.borderBottom=h,null==s||s.forEach((function(s){Ee(t,e,r,n,o,i,s.id);var d=s.data.borderTop?s.data.borderTop:s.id,l=s.data.borderBottom?s.data.borderBottom:s.id,c=s.data.borderTop?n:2*n,f=d!==l?1:o-i[a]+1;t.addEdge({id:"e"+Math.random(),source:u,target:d,data:{minlen:f,weight:c,nestingEdge:!0}}),t.addEdge({id:"e"+Math.random(),source:l,target:h,data:{minlen:f,weight:c,nestingEdge:!0}})})),t.getParent(a)||t.addEdge({id:"e"+Math.random(),source:e,target:u,data:{weight:0,minlen:o+i[a]}})}else a!==e&&t.addEdge({id:"e"+Math.random(),source:e,target:a,data:{weight:0,minlen:r}})},Ne=function(t,e,r,n,o,i){var a={rank:i,borderType:e,width:0,height:0},s=o.data[e][i-1],u=Ut(t,"border",a,r);o.data[e][i]=u,t.setParent(u,n),s&&t.addEdge({id:"e"+Math.random(),source:s,target:u,data:{weight:1}})},be=function(t){t.getAllNodes().forEach((function(t){Me(t)})),t.getAllEdges().forEach((function(t){Me(t)}))},Me=function(t){var e=t.data.width;t.data.width=t.data.height,t.data.height=e},Se=function(t){(null==t?void 0:t.y)&&(t.y=-t.y)},ke=function(t){var e=t.x;t.x=t.y,t.y=e},Ae=function(t){for(var e={},r=t.getAllNodes(),n=r.map((function(t){var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),o=Math.max.apply(Math,u(n)),i=[],a=0;a<o+1;a++)i.push([]);var s=r.sort((function(e,r){return t.getNode(e.id).data.rank-t.getNode(r.id).data.rank})),h=s.filter((function(e){return void 0!==t.getNode(e.id).data.fixorder})).sort((function(e,r){return t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder}));return null==h||h.forEach((function(r){isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0})),null==s||s.forEach((function(r){return t.dfsTree(r.id,(function(t){if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)}))})),i},_e=function(t,e,r){for(var n=function(t,e){return null==t?void 0:t.reduce((function(t,r,n){return t[r]=e[n],t}),{})}(r,r.map((function(t,e){return e}))),o=e.map((function(e){var r=t.getRelatedEdges(e,"out").map((function(t){return{pos:n[t.target]||0,weight:t.data.weight}}));return null==r?void 0:r.sort((function(t,e){return t.pos-e.pos}))})),i=o.flat().filter((function(t){return void 0!==t})),a=1;a<r.length;)a<<=1;var s=2*a-1;a-=1;var u=Array(s).fill(0,0,s),h=0;return null==i||i.forEach((function(t){if(t){var e=t.pos+a;u[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=u[e+1]),u[e=e-1>>1]+=t.weight;h+=t.weight*r}})),h},Re=function(t,e){for(var r=0,n=1;n<(null==e?void 0:e.length);n+=1)r+=_e(t,e[n-1],e[n]);return r},ze=function(t,e){var r,n=0,o=0;t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/o,t.weight=o,t.i=Math.min(e.i,t.i),e.merged=!0};const Ie=function(t,e){var r,n,o,i={};return null==t||t.forEach((function(t,e){i[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};var r=i[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)})),null===(r=e.getAllEdges())||void 0===r||r.forEach((function(t){var e=i[t.source],r=i[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(i[t.target]))})),function(t){for(var e,r,n=[],o=function(){var o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach((function(t){return(e=o,function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&ze(e,t)})(t);var e})),null===(r=o.out)||void 0===r||r.forEach((function(e){return(r=o,function(e){e.in.push(r),0==--e.indegree&&t.push(e)})(e);var r}))};null==t?void 0:t.length;)o();var i=n.filter((function(t){return!t.merged})),a=["vs","i","barycenter","weight"];return i.map((function(t){var e={};return null==a||a.forEach((function(r){void 0!==t[r]&&(e[r]=t[r])})),e}))}(null===(o=(n=Object.values(i)).filter)||void 0===o?void 0:o.call(n,(function(t){return!t.indegree})))};var De=function(t,e,r){for(var n,o=r;e.length&&(n=e[e.length-1]).i<=o;)e.pop(),null==t||t.push(n.vs),o++;return o},Oe=function(t,e,r,n,o,i){var a,s,u,h,d=t.getChildren(e).map((function(t){return t.id})),l=t.getNode(e),c=l?l.data.borderLeft:void 0,f=l?l.data.borderRight:void 0,g={};c&&(d=null==d?void 0:d.filter((function(t){return t!==c&&t!==f})));var p=function(t,e){return e.map((function(e){var r=t.getRelatedEdges(e,"in");if(!(null==r?void 0:r.length))return{v:e};var n={sum:0,weight:0};return null==r||r.forEach((function(e){var r=t.getNode(e.source);n.sum+=e.data.weight*r.data.order,n.weight+=e.data.weight})),{v:e,barycenter:n.sum/n.weight,weight:n.weight}}))}(t,d||[]);null==p||p.forEach((function(e){var o;if(null===(o=t.getChildren(e.v))||void 0===o?void 0:o.length){var a=Oe(t,e.v,r,n,i);g[e.v]=a,a.hasOwnProperty("barycenter")&&Te(e,a)}}));var v=Ie(p,r);Pe(v,g),null===(a=v.filter((function(t){return t.vs.length>0})))||void 0===a||a.forEach((function(e){var r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)}));var y=function(t,e,r,n){var o=function(t,e){var r={lhs:[],rhs:[]};return null==t||t.forEach((function(t){var e,o;o=(e=t).hasOwnProperty("fixorder")&&!isNaN(e.fixorder),(n?!o&&e.hasOwnProperty("barycenter"):o||e.hasOwnProperty("barycenter"))?r.lhs.push(t):r.rhs.push(t)})),r}(t),i=o.lhs,a=o.rhs.sort((function(t,e){return-t.i- -e.i})),s=[],u=0,h=0,d=0;null==i||i.sort(function(t,e){return function(r,n){if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i}}(!!e,!!r)),d=De(s,a,d),null==i||i.forEach((function(t){var e;d+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),u+=t.barycenter*t.weight,h+=t.weight,d=De(s,a,d)}));var l={vs:s.flat()};return h&&(l.barycenter=u/h,l.weight=h),l}(v,n,o,i);if(c&&(y.vs=[c,y.vs,f].flat(),null===(s=t.getPredecessors(c))||void 0===s?void 0:s.length)){var m=t.getNode((null===(u=t.getPredecessors(c))||void 0===u?void 0:u[0].id)||""),w=t.getNode((null===(h=t.getPredecessors(f))||void 0===h?void 0:h[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+w.data.order)/(y.weight+2),y.weight+=2}return y},Pe=function(t,e){null==t||t.forEach((function(t){var r,n=null===(r=t.vs)||void 0===r?void 0:r.map((function(t){return e[t]?e[t].vs:t}));t.vs=n.flat()}))},Te=function(t,e){void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},Ce=function(t){if("object"!=typeof t||null===t)return t;var e,r;if(r=t,Array.isArray?Array.isArray(r):w(r,"Array")){e=[];for(var n=0,o=t.length;n<o;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=Ce(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=Ce(t[i]):e[i]=t[i];return e};const qe=Ce;var Le=function(t,e,r){return e.map((function(e){return function(t,e,r){var o=function(t){for(var e;t.hasNode(e="_root"+Math.random()););return e}(t),i=new c({tree:[{id:o,children:[],data:{}}]});return t.getAllNodes().forEach((function(a){var s=t.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(n({},a)),(null==s?void 0:s.id)&&!i.hasNode(null==s?void 0:s.id)&&i.addNode(n({},s)),i.setParent(a.id,(null==s?void 0:s.id)||o),t.getRelatedEdges(a.id,r).forEach((function(e){var r=e.source===a.id?e.target:e.source;i.hasNode(r)||i.addNode(n({},t.getNode(r)));var o=i.getRelatedEdges(r,"out").find((function(t){return t.target===a.id})),s=void 0!==o?o.data.weight:0;o?i.updateEdgeData(o.id,n(n({},o.data),{weight:e.data.weight+s})):i.addEdge({id:e.id,source:r,target:a.id,data:{weight:e.data.weight+s}})})),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,n(n({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))})),i}(t,e,r)}))},je=function(t,e,r,n){var o=new c;null==t||t.forEach((function(t){for(var i,a=t.getRoots()[0].id,s=Oe(t,a,o,e,r,n),u=0;u<(null===(i=s.vs)||void 0===i?void 0:i.length);u++){var h=t.getNode(s.vs[u]);h&&(h.data.order=u)}!function(t,e,r){var n,o={};null==r||r.forEach((function(r){for(var i,a,s=t.getParent(r);s;){if((i=t.getParent(s.id))?(a=o[i.id],o[i.id]=s.id):(a=n,n=s.id),a&&a!==s.id)return e.addNodes([{id:a,data:{}},{id:s.id,data:{}}]),void e.addEdge({id:"e"+a+"-"+s.id,source:a,target:s.id,data:{}});s=i}}))}(t,o,s.vs)}))},Fe=function(t,e){null==e||e.forEach((function(e){null==e||e.forEach((function(e,r){t.getNode(e).data.order=r}))}))},Ve=function(t,e){var r={};function n(e,n,o,i,a){for(var s,u,h,d=n;d<o;d++)h=e[d],(null===(s=t.getNode(h))||void 0===s?void 0:s.data.dummy)&&(null===(u=t.getPredecessors(h))||void 0===u||u.forEach((function(e){var n=t.getNode(e.id);n.data.dummy&&(n.data.order<i||n.data.order>a)&&Ge(r,e.id,h)})))}function o(t,e){var r=function(t){return JSON.stringify(t.slice(1))}(t);e.get(r)||(n.apply(void 0,u(t)),e.set(r,!0))}return(null==e?void 0:e.length)&&e.reduce((function(e,r){var n,i=-1,a=0,s=new Map;return null==r||r.forEach((function(u,h){var d;if("border"===(null===(d=t.getNode(u))||void 0===d?void 0:d.data.dummy)){var l=t.getPredecessors(u)||[];l.length&&(n=t.getNode(l[0].id).data.order,o([r,a,h,i,n],s),a=h,i=n)}o([r,a,r.length,n,e.length],s)})),r})),r},Be=function(t,e){var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find((function(e){return t.getNode(e.id).data.dummy}))},Ge=function(t,e,r){var n=e,o=r;if(n>o){var i=n;n=o,o=i}var a=t[n];a||(t[n]=a={}),a[o]=!0},We=function(t,e,r){var n=e;return n>r&&(n=r),!!t[n]},$e=function(t,e,r,o,i,a){var s=new c,u=Ue(o,i,a);return null==e||e.forEach((function(e){var o;null==e||e.forEach((function(e){var i=r[e];if(s.hasNode(i)||s.addNode({id:i,data:{}}),o){var a=r[o],h=s.getRelatedEdges(a,"out").find((function(t){return t.target===i}));h?s.updateEdgeData(h.id,n(n({},h.data),{weight:Math.max(u(t,e,o),h.data.weight||0)})):s.addEdge({id:"e"+Math.random(),source:a,target:i,data:{weight:Math.max(u(t,e,o),0)}})}o=e}))})),s};var Ue=function(t,e,r){return function(n,o,i){var a=n.getNode(o),s=n.getNode(i),u=0,h=0;if(u+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":h=-a.data.width/2;break;case"r":h=a.data.width/2}if(h&&(u+=r?h:-h),h=0,u+=(a.data.dummy?e:t)/2,u+=(s.data.dummy?e:t)/2,u+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":h=s.data.width/2;break;case"r":h=-s.data.width/2}return h&&(u+=r?h:-h),h=0,u}},He=function(t,e){return t.getNode(e).data.width||0},Ke=function(t,e){var r,n=Ht(t);!function(t,e){var r=(e||{}).ranksep,n=void 0===r?0:r,o=Yt(t),i=0;null==o||o.forEach((function(e){var r=e.map((function(e){return t.getNode(e).data.height})),o=Math.max.apply(Math,u(r,[0]));null==e||e.forEach((function(e){t.getNode(e).data.y=i+o/2})),i+=o+n}))}(n,e);var o=function(t,e){var r=e||{},n=r.align,o=r.nodesep,i=void 0===o?0:o,a=r.edgesep,s=void 0===a?0:a,h=Yt(t),d=Object.assign(function(t,e){var r={};return(null==e?void 0:e.length)&&e.reduce((function(e,n){var o=0,i=0,a=e.length,s=null==n?void 0:n[(null==n?void 0:n.length)-1];return null==n||n.forEach((function(e,u){var h,d=Be(t,e),l=d?t.getNode(d.id).data.order:a;(d||e===s)&&(null===(h=n.slice(i,u+1))||void 0===h||h.forEach((function(e){var n;null===(n=t.getPredecessors(e))||void 0===n||n.forEach((function(n){var i,a=t.getNode(n.id),s=a.data.order;!(s<o||l<s)||a.data.dummy&&(null===(i=t.getNode(e))||void 0===i?void 0:i.data.dummy)||Ge(r,n.id,e)}))})),i=u+1,o=l)})),n})),r}(t,h),Ve(t,h)),l={},c=[];["u","d"].forEach((function(e){c="u"===e?h:Object.values(h).reverse(),["l","r"].forEach((function(r){"r"===r&&(c=c.map((function(t){return Object.values(t).reverse()})));var n=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),o=function(t,e,r,n){var o={},i={},a={};return null==e||e.forEach((function(t){null==t||t.forEach((function(t,e){o[t]=t,i[t]=t,a[t]=e}))})),null==e||e.forEach((function(t){var e=-1;null==t||t.forEach((function(t){var s=n(t).map((function(t){return t.id}));if(s.length){s=s.sort((function(t,e){return a[t]-a[e]}));for(var u=(s.length-1)/2,h=Math.floor(u),d=Math.ceil(u);h<=d;++h){var l=s[h];i[t]===t&&e<a[l]&&!We(r,t,l)&&(i[l]=t,i[t]=o[t]=o[l],e=a[l])}}}))})),{root:o,align:i}}(0,c,d,n),a=function(t,e,r,n,o,i,a){var s,u={},h=$e(t,e,r,o,i,a),d=a?"borderLeft":"borderRight",l=function(t,e){for(var r=h.getAllNodes(),n=r.pop(),o={};n;)o[n.id]?t(n.id):(o[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return l((function(t){u[t]=(h.getRelatedEdges(t,"in")||[]).reduce((function(t,e){return Math.max(t,(u[e.source]||0)+e.data.weight)}),0)}),h.getPredecessors.bind(h)),l((function(e){var r=(h.getRelatedEdges(e,"out")||[]).reduce((function(t,e){return Math.min(t,(u[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==d&&(u[e]=Math.max(u[e],r))}),h.getSuccessors.bind(h)),null===(s=Object.values(n))||void 0===s||s.forEach((function(t){u[t]=u[r[t]]})),u}(t,c,o.root,o.align,i,s,"r"===r);"r"===r&&Object.keys(a).forEach((function(t){return a[t]=-a[t]})),l[e+r]=a}))}));var f=function(t,e){return Qt(Object.values(e),(function(e){var r,n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach((function(r){var i=e[r],a=He(t,r)/2;n=Math.max(i+a,n),o=Math.min(i-a,o)})),n-o}))}(t,l);return f&&function(t,e){var r=Object.values(e),n=Math.min.apply(Math,u(r)),o=Math.max.apply(Math,u(r));["u","d"].forEach((function(r){["l","r"].forEach((function(i){var a,s=r+i,h=t[s];if(h!==e){var d=Object.values(h);(a="l"===i?n-Math.min.apply(Math,u(d)):o-Math.max.apply(Math,u(d)))&&(t[s]={},Object.keys(h).forEach((function(e){t[s][e]=h[e]+a})))}}))}))}(l,f),function(t,e){var r={};return Object.keys(t.ul).forEach((function(n){if(e)r[n]=t[e.toLowerCase()][n];else{var o=Object.values(t).map((function(t){return t[n]}));r[n]=(o[0]+o[1])/2}})),r}(l,n)}(n,e);null===(r=Object.keys(o))||void 0===r||r.forEach((function(t){n.getNode(t).data.x=o[t]}))},Ye=function(t,e){var r=e.acyclicer,o=e.ranker,i=e.rankdir,a=void 0===i?"tb":i,s=e.nodeOrder,h=e.keepNodeOrder,d=e.align,l=e.nodesep,f=void 0===l?50:l,g=e.edgesep,p=void 0===g?20:g,v=e.ranksep,y=void 0===v?50:v;hr(t),Wt(t,r);var m=function(t){var e=Ut(t,"root",{},"_root"),r=function(t){var e={},r=function(n,o){var i=t.getChildren(n);null==i||i.forEach((function(t){return r(t.id,o+1)})),e[n]=o};return t.getRoots().forEach((function(t){return r(t.id,1)})),e}(t),n=Math.max.apply(Math,u(Object.values(r)));Math.abs(n)===1/0&&(n=1);var o=n-1,i=2*o+1;t.getAllEdges().forEach((function(t){t.data.minlen*=i}));var a=function(t){var e=0;return t.getAllEdges().forEach((function(t){e+=t.data.weight})),e}(t)+1;return t.getRoots().forEach((function(n){Ee(t,e,i,a,o,r,n.id)})),{nestingRoot:e,nodeRankFactor:i}}(t),w=m.nestingRoot,x=m.nodeRankFactor;!function(t,e){switch(e){case"network-simplex":xe(t);break;case"tight-tree":default:!function(t){!function(t){var e,r={},n=function(o){var i,a,s=t.getNode(o);return s?r[o]?s.data.rank:(r[o]=!0,null===(i=t.getRelatedEdges(o,"out"))||void 0===i||i.forEach((function(t){var e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),(void 0===e||a<e)&&(e=a),s.data.rank=a,a):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){t&&n(t.id)})),void 0===e&&(e=0);var o={},i=function(e,r){var n,a=t.getNode(e),s=isNaN(a.data.layer)?r:a.data.layer;(void 0===a.data.rank||a.data.rank<s)&&(a.data.rank=s),o[e]||(o[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach((function(t){i(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((function(t){var r=t.data;r&&(isNaN(r.layer)?r.rank-=e:i(t.id,r.layer))}))}(t),function(t){var e,r,n=new c({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);ie(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r)}(t)}(t);break;case"longest-path":we(t)}}(Ht(t),o),er(t),function(t,e){void 0===e&&(e=0);var r=t.getAllNodes(),n=r.filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),o=Math.min.apply(Math,u(n)),i=[];r.forEach((function(t){var e=(t.data.rank||0)-o;i[e]||(i[e]=[]),i[e].push(t.id)}));for(var a=0,s=0;s<i.length;s++){var h=i[s];void 0===h?s%e!=0&&(a-=1):a&&(null==h||h.forEach((function(e){var r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=a)})))}}(t,x),function(t,e){e&&t.removeNode(e),t.getAllEdges().forEach((function(e){e.data.nestingEdge&&t.removeEdge(e.id)}))}(t,w),function(t){var e=t.getAllNodes().filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),r=Math.min.apply(Math,u(e));t.getAllNodes().forEach((function(t){t.data.hasOwnProperty("rank")&&r!==1/0&&(t.data.rank-=r)}))}(t),rr(t),nr(t);var E=[];!function(t,e){t.getAllEdges().forEach((function(r){return function(t,e,r){var n=e.source,o=t.getNode(n).data.rank,i=e.target,a=t.getNode(i).data.rank,s=e.data.labelRank;if(a!==o+1){var u,h,d;for(t.removeEdge(e.id),d=0,++o;o<a;++d,++o)e.data.points=[],u=Ut(t,"edge",h={originalEdge:e,width:0,height:0,rank:o},"_d"),o===s&&(h.width=e.data.width,h.height=e.data.height,h.dummy=ee,h.labelpos=e.data.labelpos),t.addEdge({id:"e"+Math.random(),source:n,target:u,data:{weight:e.data.weight}}),0===d&&r.push(u),n=u;t.addEdge({id:"e"+Math.random(),source:n,target:i,data:{weight:e.data.weight}})}}(t,r,e)}))}(t,E),function(t,e){var r=function(t){var e={},r=0,n=function(o){var i=r;t.getChildren(o).forEach((function(t){return n(t.id)})),e[o]={low:i,lim:r++}};return t.getRoots().forEach((function(t){return n(t.id)})),e}(t);e.forEach((function(e){var n,o,i=e,a=t.getNode(i),s=a.data.originalEdge;if(s)for(var u=function(t,e,r,n){var o,i,a,s,u=[],h=[],d=Math.min(e[r].low,e[n].low),l=Math.max(e[r].lim,e[n].lim);a=r;do{a=null===(o=t.getParent(a))||void 0===o?void 0:o.id,u.push(a)}while(a&&(e[a].low>d||l>e[a].lim));for(s=a,a=n;a&&a!==s;)h.push(a),a=null===(i=t.getParent(a))||void 0===i?void 0:i.id;return{lca:s,path:u.concat(h.reverse())}}(t,r,s.source,s.target),h=u.path,d=u.lca,l=0,c=h[l],f=!0;i!==s.target;){if(a=t.getNode(i),f){for(;c!==d&&(null===(n=t.getNode(c))||void 0===n?void 0:n.data.maxRank)<a.data.rank;)c=h[++l];c===d&&(f=!1)}if(!f){for(;l<h.length-1&&(null===(o=t.getNode(h[l+1]))||void 0===o?void 0:o.data.minRank)<=a.data.rank;)l++;c=h[l]}t.hasNode(c)&&t.setParent(i,c),i=t.getSuccessors(i)[0].id}}))}(t,E),function(t){var e=function(r){var n=t.getChildren(r),o=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach((function(t){return e(t.id)})),o.data.hasOwnProperty("minRank")){o.data.borderLeft=[],o.data.borderRight=[];for(var i=o.data.minRank,a=o.data.maxRank+1;i<a;i+=1)Ne(t,"borderLeft","_bl",r,o,i),Ne(t,"borderRight","_br",r,o,i)}};t.getRoots().forEach((function(t){return e(t.id)}))}(t),h&&function(t,e){for(var r=t.getAllNodes().filter((function(e){var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)})).map((function(t){return t.data.rank})),n=Math.max.apply(Math,u(r)),o=[],i=0;i<n+1;i++)o[i]=[];null==e||e.forEach((function(e){var r=t.getNode(e);r&&!r.data.dummy&&(isNaN(r.data.rank)||(r.data.fixorder=o[r.data.rank].length,o[r.data.rank].push(e)))}))}(t,s),function(t,e){for(var r=Xt(t),n=[],o=[],i=1;i<r+1;i++)n.push(i);for(i=r-1;i>-1;i--)o.push(i);var a=Le(t,n,"in"),s=Le(t,o,"out"),u=Ae(t);Fe(t,u);for(var h,d=Number.POSITIVE_INFINITY,l=(i=0,0);l<4;++i,++l)je(i%2?a:s,i%4>=2,!1,e),u=Yt(t),(c=Re(t,u))<d&&(l=0,h=qe(u),d=c);for(u=Ae(t),Fe(t,u),i=0,l=0;l<4;++i,++l){var c;je(i%2?a:s,i%4>=2,!0,e),u=Yt(t),(c=Re(t,u))<d&&(l=0,h=qe(u),d=c)}Fe(t,h)}(t,h),dr(t),function(t,e){var r=e.toLowerCase();"lr"!==r&&"rl"!==r||be(t)}(t,a),Ke(t,{align:d,nodesep:f,edgesep:p,ranksep:y}),lr(t),ur(t),function(t,e){e.forEach((function(e){var r,n=t.getNode(e),o=n.data.originalEdge;o&&t.addEdge(o);for(var i=e;n.data.dummy;)r=t.getSuccessors(i)[0],t.removeNode(i),o.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===ee&&(o.data.x=n.data.x,o.data.y=n.data.y,o.data.width=n.data.width,o.data.height=n.data.height),i=r.id,n=t.getNode(i)}))}(t,E),ar(t),function(t,e){var r=e.toLowerCase();"bt"!==r&&"rl"!==r||function(t){t.getAllNodes().forEach((function(t){Se(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return Se(t)})),t.data.hasOwnProperty("y")&&Se(t.data)}))}(t),"lr"!==r&&"rl"!==r||(function(t){t.getAllNodes().forEach((function(t){ke(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return ke(t)})),t.data.hasOwnProperty("x")&&ke(t.data)}))}(t),be(t))}(t,a);var N=or(t),b=N.width,M=N.height;return ir(t),sr(t),function(t){t.getAllEdges().forEach((function(e){var r=e.data;if(r.reversed){t.removeEdge(e.id);var o=r.forwardName;delete r.reversed,delete r.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:n(n({},r),{forwardName:o})})}}))}(t),{width:b,height:M}},Je=["width","height","layer","fixorder"],Xe={width:0,height:0},Qe=["minlen","weight","width","height","labeloffset"],Ze={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},tr=["labelpos"],er=function(t){t.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var r=t.getNode(e.source),n={e,rank:(t.getNode(e.target).data.rank-r.data.rank)/2+r.data.rank};Ut(t,"edge-proxy",n,"_ep")}}))},rr=function(t){var e=0;return t.getAllNodes().forEach((function(r){var n,o;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(o=t.getNode(r.data.borderBottom))||void 0===o?void 0:o.data.rank,e=Math.max(e,r.data.maxRank||-1/0))})),e},nr=function(t){t.getAllNodes().forEach((function(e){"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},or=function(t,e){var r,n,o=0,i=0,a=e||{},s=a.marginx,u=void 0===s?0:s,h=a.marginy,d=void 0===h?0:h,l=function(t){if(t.data){var e=t.data.x,a=t.data.y,s=t.data.width,u=t.data.height;isNaN(e)||isNaN(s)||(void 0===r&&(r=e-s/2),r=Math.min(r,e-s/2),o=Math.max(o,e+s/2)),isNaN(a)||isNaN(u)||(void 0===n&&(n=a-u/2),n=Math.min(n,a-u/2),i=Math.max(i,a+u/2))}};return t.getAllNodes().forEach((function(t){l(t)})),t.getAllEdges().forEach((function(t){(null==t?void 0:t.data.hasOwnProperty("x"))&&l(t)})),r-=u,n-=d,t.getAllNodes().forEach((function(t){t.data.x-=r,t.data.y-=n})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){t.x-=r,t.y-=n})),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)})),{width:o-r+u,height:i-n+d}},ir=function(t){t.getAllEdges().forEach((function(e){var r,n,o=t.getNode(e.source),i=t.getNode(e.target);e.data.points?(r=e.data.points[0],n=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:i.data.x,y:i.data.y},n={x:o.data.x,y:o.data.y}),e.data.points.unshift(Kt(o.data,r)),e.data.points.push(Kt(i.data,n))}))},ar=function(t){t.getAllEdges().forEach((function(t){if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},sr=function(t){t.getAllEdges().forEach((function(t){var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},ur=function(t){t.getAllNodes().forEach((function(e){var r,n,o;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){var i=t.getNode(e.id),a=t.getNode(i.data.borderTop),s=t.getNode(i.data.borderBottom),u=t.getNode(i.data.borderLeft[(null===(n=i.data.borderLeft)||void 0===n?void 0:n.length)-1]),h=t.getNode(i.data.borderRight[(null===(o=i.data.borderRight)||void 0===o?void 0:o.length)-1]);i.data.width=Math.abs((null==h?void 0:h.data.x)-(null==u?void 0:u.data.x))||10,i.data.height=Math.abs((null==s?void 0:s.data.y)-(null==a?void 0:a.data.y))||10,i.data.x=((null==u?void 0:u.data.x)||0)+i.data.width/2,i.data.y=((null==a?void 0:a.data.y)||0)+i.data.height/2}})),t.getAllNodes().forEach((function(e){"border"===e.data.dummy&&t.removeNode(e.id)}))},hr=function(t){t.getAllEdges().forEach((function(e){if(e.source===e.target){var r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}}))},dr=function(t){var e=Yt(t);null==e||e.forEach((function(e){var r=0;null==e||e.forEach((function(e,n){var o,i=t.getNode(e);i.data.order=n+r,null===(o=i.data.selfEdges)||void 0===o||o.forEach((function(e){Ut(t,"selfedge",{width:e.data.width,height:e.data.height,rank:i.data.rank,order:n+ ++r,e},"_se")})),delete i.data.selfEdges}))}))},lr=function(t){t.getAllNodes().forEach((function(e){var r=t.getNode(e.id);if("selfedge"===r.data.dummy){var n=t.getNode(r.data.e.source),o=n.data.x+n.data.width/2,i=n.data.y,a=r.data.x-o,s=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}}))},cr=function(t,e){var r={};return null==e||e.forEach((function(e){void 0!==t[e]&&(r[e]=+t[e])})),r},fr=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(r){e[r.toLowerCase()]=t[r]})),e},gr={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="dagre",this.layoutNode=function(t){return t.data.layout},this.options=n(n({},gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericDagreLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericDagreLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericDagreLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,E,b,M,k,_,R,z,I,D,O,P,T,C,q,L,j,F,V,B,G=this;return a(this,(function(a){return o=n(n({},this.options),r),i=o.nodeSize,s=o.align,u=o.rankdir,h=void 0===u?"TB":u,d=o.ranksep,l=o.nodesep,f=o.ranksepFunc,g=o.nodesepFunc,p=o.edgeLabelSpace,v=o.nodeOrder,y=o.begin,m=o.controlPoints,w=o.radial,E=new c({tree:[]}),b=S(d||50,f),M=S(l||50,g),k=M,_=b,"LR"!==h&&"RL"!==h||(k=b,_=M),R=A(i,void 0),z=e.getAllNodes(),I=e.getAllEdges(),z.filter((function(t){return t.data.layout})).forEach((function(t){var e=R(t),r=_(t),n=e+2*k(t),o=e+2*r,i=t.data.layer;x(i)?E.addNode({id:t.id,data:{width:n,height:o,layer:i}}):E.addNode({id:t.id,data:{width:n,height:o}})})),I.forEach((function(t){G.layoutNode(E.getNode(t.source))&&G.layoutNode(E.getNode(t.target))&&E.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),function(t,e){var r,o,i=e.edgeLabelSpace,a=e.keepNodeOrder,s=e.prevGraph,u=e.rankdir,h=e.ranksep;!a&&s&&(o=s,(r=t).getAllNodes().forEach((function(t){var e=r.getNode(t.id),n=o.getNode(t.id);void 0!==n?(e.data.fixorder=n.data._order,delete n.data._order):delete e.data.fixorder})));var d=function(t){var e=new c({tree:[]});return t.getAllNodes().forEach((function(r){var o=fr(t.getNode(r.id).data),i=n(n({},Xe),o),a=cr(i,Je);e.hasNode(r.id)||e.addNode({id:r.id,data:n({},a)});var s=t.getParent(r.id);null==s||(e.hasNode(s.id)||e.addNode(n({},s)),e.setParent(r.id,s.id))})),t.getAllEdges().forEach((function(r){var n=fr(t.getEdge(r.id).data),o={};null==tr||tr.forEach((function(t){void 0!==n[t]&&(o[t]=n[t])})),e.addEdge({id:r.id,source:r.source,target:r.target,data:Object.assign({},Ze,cr(n,Qe),o)})})),e}(t);i&&(e.ranksep=function(t,e){var r=e.ranksep,n=void 0===r?0:r,o=e.rankdir;return t.getAllNodes().forEach((function(t){isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((function(t){var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===o||"BT"===o?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2}(d,{rankdir:u,ranksep:h}));try{Ye(d,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph\'s structure:\\n",t);throw t}!function(t,e){t.getAllNodes().forEach((function(r){var n,o=t.getNode(r.id);if(o){var i=e.getNode(r.id);o.data.x=i.data.x,o.data.y=i.data.y,o.data._order=i.data.order,o.data._rank=i.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(o.data.width=i.data.width,o.data.height=i.data.height)}})),t.getAllEdges().forEach((function(r){var n=t.getEdge(r.id),o=e.getEdge(r.id);n.data.points=o?o.data.points:[],o&&o.data.hasOwnProperty("x")&&(n.data.x=o.data.x,n.data.y=o.data.y)}))}(t,d)}(E,{prevGraph:null,edgeLabelSpace:p,keepNodeOrder:!!v,nodeOrder:v||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:h,nodesep:l,align:s}),D=[0,0],y&&(O=1/0,P=1/0,E.getAllNodes().forEach((function(t){O>t.data.x&&(O=t.data.x),P>t.data.y&&(P=t.data.y)})),E.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){O>t.x&&(O=t.x),P>t.y&&(P=t.y)}))})),D[0]=y[0]-O,D[1]=y[1]-P),T="LR"===h||"RL"===h,w||(C=new Set,q="BT"===h||"RL"===h?function(t,e){return e-t}:function(t,e){return t-e},E.getAllNodes().forEach((function(t){t.data.x=t.data.x+D[0],t.data.y=t.data.y+D[1],C.add(T?t.data.x:t.data.y)})),L=Array.from(C).sort(q),j=T?function(t,e){return t.x!==e.x}:function(t,e){return t.y!==e.y},F=T?function(t,e,r){var n=Math.max(e.y,r.y),o=Math.min(e.y,r.y);return t.filter((function(t){return t.y<=n&&t.y>=o}))}:function(t,e,r){var n=Math.max(e.x,r.x),o=Math.min(e.x,r.x);return t.filter((function(t){return t.x<=n&&t.x>=o}))},E.getAllEdges().forEach((function(t,e){var r;p&&m&&"loop"!==t.data.type&&(t.data.controlPoints=vr(null===(r=t.data.points)||void 0===r?void 0:r.map((function(t){var e=t.x,r=t.y;return{x:e+D[0],y:r+D[1]}})),E.getNode(t.source),E.getNode(t.target),L,T,j,F))}))),V=[],V=E.getAllNodes().map((function(t){return N(t)})),B=E.getAllEdges(),t&&(V.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),B.forEach((function(t){e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),[2,{nodes:V,edges:B}]}))}))},t}(),vr=function(t,e,r,n,o,i,a){var s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){var u=e.data,h=u.x,d=u.y,l=r.data,c=l.x,f=l.y;if(o&&(h=e.data.y,d=e.data.x,c=r.data.y,f=r.data.x),f!==d&&h!==c){var g=n.indexOf(d),p=n[g+1];if(p){var v=s[0],y=o?{x:(d+p)/2,y:(null==v?void 0:v.y)||c}:{x:(null==v?void 0:v.x)||c,y:(d+p)/2};v&&!i(v,y)||s.unshift(y)}var m=n.indexOf(f),w=Math.abs(m-g);if(1===w)(s=a(s,e.data,r.data)).length||s.push(o?{x:(d+f)/2,y:h}:{x:h,y:(d+f)/2});else if(w>1){var x=n[m-1];if(x){var E=s[s.length-1],N=o?{x:(f+x)/2,y:(null==E?void 0:E.y)||c}:{x:(null==E?void 0:E.x)||h,y:(f+x)/2};E&&!i(E,N)||s.push(N)}}}}return s};function yr(t,e,r,n,o){if(isNaN(e)||isNaN(r)||isNaN(n))return t;var i,a,s,u,h,d,l,c,f,g,p,v,y=t._root,m={data:o},w=t._x0,x=t._y0,E=t._z0,N=t._x1,b=t._y1,M=t._z1;if(!y)return t._root=m,t;for(;y.length;)if((c=e>=(a=(w+N)/2))?w=a:N=a,(f=r>=(s=(x+b)/2))?x=s:b=s,(g=n>=(u=(E+M)/2))?E=u:M=u,i=y,!(y=y[p=g<<2|f<<1|c]))return i[p]=m,t;if(h=+t._x.call(null,y.data),d=+t._y.call(null,y.data),l=+t._z.call(null,y.data),e===h&&r===d&&n===l)return m.next=y,i?i[p]=m:t._root=m,t;do{i=i?i[p]=new Array(8):t._root=new Array(8),(c=e>=(a=(w+N)/2))?w=a:N=a,(f=r>=(s=(x+b)/2))?x=s:b=s,(g=n>=(u=(E+M)/2))?E=u:M=u}while((p=g<<2|f<<1|c)==(v=(l>=u)<<2|(d>=s)<<1|h>=a));return i[v]=y,i[p]=m,t}function mr(t,e,r,n,o,i,a){this.node=t,this.x0=e,this.y0=r,this.z0=n,this.x1=o,this.y1=i,this.z1=a}function wr(t){return t[0]}function xr(t){return t[1]}function Er(t){return t[2]}function Nr(t,e,r,n){var o=new br(null==e?wr:e,null==r?xr:r,null==n?Er:n,NaN,NaN,NaN,NaN,NaN,NaN);return null==t?o:o.addAll(t)}function br(t,e,r,n,o,i,a,s,u){this._x=t,this._y=e,this._z=r,this._x0=n,this._y0=o,this._z0=i,this._x1=a,this._y1=s,this._z1=u,this._root=void 0}function Mr(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var Sr=Nr.prototype=br.prototype;function kr(t){var e=0,r=0,n=0,o=0,i=t.length;if(i){for(var a=0;a<i;a++)(s=t[a])&&s.weight&&(e+=s.weight,r+=s.x*s.weight,n+=s.y*s.weight,o+=s.z*s.weight);t.x=r/e,t.y=n/e,t.z=o/e,t.weight=e}else{var s=t;t.x=s.data.x,t.y=s.data.y,t.z=s.data.z,t.weight=s.data.weight}}Sr.copy=function(){var t,e,r=new br(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),n=this._root;if(!n)return r;if(!n.length)return r._root=Mr(n),r;for(t=[{source:n,target:r._root=new Array(8)}];n=t.pop();)for(var o=0;o<8;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(8)}):n.target[o]=Mr(e));return r},Sr.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t),n=+this._z.call(null,t);return yr(this.cover(e,r,n),e,r,n,t)},Sr.addAll=function(t){Array.isArray(t)||(t=Array.from(t));const e=t.length,r=new Float64Array(e),n=new Float64Array(e),o=new Float64Array(e);let i=1/0,a=1/0,s=1/0,u=-1/0,h=-1/0,d=-1/0;for(let l,c,f,g,p=0;p<e;++p)isNaN(c=+this._x.call(null,l=t[p]))||isNaN(f=+this._y.call(null,l))||isNaN(g=+this._z.call(null,l))||(r[p]=c,n[p]=f,o[p]=g,c<i&&(i=c),c>u&&(u=c),f<a&&(a=f),f>h&&(h=f),g<s&&(s=g),g>d&&(d=g));if(i>u||a>h||s>d)return this;this.cover(i,a,s).cover(u,h,d);for(let i=0;i<e;++i)yr(this,r[i],n[i],o[i],t[i]);return this},Sr.cover=function(t,e,r){if(isNaN(t=+t)||isNaN(e=+e)||isNaN(r=+r))return this;var n=this._x0,o=this._y0,i=this._z0,a=this._x1,s=this._y1,u=this._z1;if(isNaN(n))a=(n=Math.floor(t))+1,s=(o=Math.floor(e))+1,u=(i=Math.floor(r))+1;else{for(var h,d,l=a-n||1,c=this._root;n>t||t>=a||o>e||e>=s||i>r||r>=u;)switch(d=(r<i)<<2|(e<o)<<1|t<n,(h=new Array(8))[d]=c,c=h,l*=2,d){case 0:a=n+l,s=o+l,u=i+l;break;case 1:n=a-l,s=o+l,u=i+l;break;case 2:a=n+l,o=s-l,u=i+l;break;case 3:n=a-l,o=s-l,u=i+l;break;case 4:a=n+l,s=o+l,i=u-l;break;case 5:n=a-l,s=o+l,i=u-l;break;case 6:a=n+l,o=s-l,i=u-l;break;case 7:n=a-l,o=s-l,i=u-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=o,this._z0=i,this._x1=a,this._y1=s,this._z1=u,this},Sr.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Sr.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},Sr.find=function(t,e,r,n){var o,i,a,s,u,h,d,l,c,f=this._x0,g=this._y0,p=this._z0,v=this._x1,y=this._y1,m=this._z1,w=[],x=this._root;for(x&&w.push(new mr(x,f,g,p,v,y,m)),null==n?n=1/0:(f=t-n,g=e-n,p=r-n,v=t+n,y=e+n,m=r+n,n*=n);l=w.pop();)if(!(!(x=l.node)||(i=l.x0)>v||(a=l.y0)>y||(s=l.z0)>m||(u=l.x1)<f||(h=l.y1)<g||(d=l.z1)<p))if(x.length){var E=(i+u)/2,N=(a+h)/2,b=(s+d)/2;w.push(new mr(x[7],E,N,b,u,h,d),new mr(x[6],i,N,b,E,h,d),new mr(x[5],E,a,b,u,N,d),new mr(x[4],i,a,b,E,N,d),new mr(x[3],E,N,s,u,h,b),new mr(x[2],i,N,s,E,h,b),new mr(x[1],E,a,s,u,N,b),new mr(x[0],i,a,s,E,N,b)),(c=(r>=b)<<2|(e>=N)<<1|t>=E)&&(l=w[w.length-1],w[w.length-1]=w[w.length-1-c],w[w.length-1-c]=l)}else{var M=t-+this._x.call(null,x.data),S=e-+this._y.call(null,x.data),k=r-+this._z.call(null,x.data),A=M*M+S*S+k*k;if(A<n){var _=Math.sqrt(n=A);f=t-_,g=e-_,p=r-_,v=t+_,y=e+_,m=r+_,o=x.data}}return o},Sr.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t))||isNaN(s=+this._z.call(null,t)))return this;var e,r,n,o,i,a,s,u,h,d,l,c,f,g,p,v=this._root,y=this._x0,m=this._y0,w=this._z0,x=this._x1,E=this._y1,N=this._z1;if(!v)return this;if(v.length)for(;;){if((l=i>=(u=(y+x)/2))?y=u:x=u,(c=a>=(h=(m+E)/2))?m=h:E=h,(f=s>=(d=(w+N)/2))?w=d:N=d,e=v,!(v=v[g=f<<2|c<<1|l]))return this;if(!v.length)break;(e[g+1&7]||e[g+2&7]||e[g+3&7]||e[g+4&7]||e[g+5&7]||e[g+6&7]||e[g+7&7])&&(r=e,p=g)}for(;v.data!==t;)if(n=v,!(v=v.next))return this;return(o=v.next)&&delete v.next,n?(o?n.next=o:delete n.next,this):e?(o?e[g]=o:delete e[g],(v=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&v===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!v.length&&(r?r[p]=v:this._root=v),this):(this._root=o,this)},Sr.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},Sr.root=function(){return this._root},Sr.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Sr.visit=function(t){var e,r,n,o,i,a,s,u,h=[],d=this._root;for(d&&h.push(new mr(d,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=h.pop();)if(!t(d=e.node,n=e.x0,o=e.y0,i=e.z0,a=e.x1,s=e.y1,u=e.z1)&&d.length){var l=(n+a)/2,c=(o+s)/2,f=(i+u)/2;(r=d[7])&&h.push(new mr(r,l,c,f,a,s,u)),(r=d[6])&&h.push(new mr(r,n,c,f,l,s,u)),(r=d[5])&&h.push(new mr(r,l,o,f,a,c,u)),(r=d[4])&&h.push(new mr(r,n,o,f,l,c,u)),(r=d[3])&&h.push(new mr(r,l,c,i,a,s,f)),(r=d[2])&&h.push(new mr(r,n,c,i,l,s,f)),(r=d[1])&&h.push(new mr(r,l,o,i,a,c,f)),(r=d[0])&&h.push(new mr(r,n,o,i,l,c,f))}return this},Sr.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new mr(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.z0,h=e.x1,d=e.y1,l=e.z1,c=(a+h)/2,f=(s+d)/2,g=(u+l)/2;(i=o[0])&&r.push(new mr(i,a,s,u,c,f,g)),(i=o[1])&&r.push(new mr(i,c,s,u,h,f,g)),(i=o[2])&&r.push(new mr(i,a,f,u,c,d,g)),(i=o[3])&&r.push(new mr(i,c,f,u,h,d,g)),(i=o[4])&&r.push(new mr(i,a,s,g,c,f,l)),(i=o[5])&&r.push(new mr(i,c,s,g,h,f,l)),(i=o[6])&&r.push(new mr(i,a,f,g,c,d,l)),(i=o[7])&&r.push(new mr(i,c,f,g,h,d,l))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.z0,e.x1,e.y1,e.z1);return this},Sr.x=function(t){return arguments.length?(this._x=t,this):this._x},Sr.y=function(t){return arguments.length?(this._y=t,this):this._y},Sr.z=function(t){return arguments.length?(this._z=t,this):this._z};var Ar=function(t,e,r,n,o,i,a){var s=[r,n,o][a-1],u=i.x-t.x||.1,h=i.y-t.y||.1,d=i.z-t.z||.1,l=s-e,c=u*u+h*h+d*d,f=Math.sqrt(c)*c;if(l*l*.81<c){var g=t.weight/f;return i.vx+=u*g,i.vy+=h*g,i.vz+=d*g,!0}if(t.length)return!1;t.data!==i&&(g=t.data.weight/f,i.vx+=u*g,i.vy+=h*g,i.vz+=d*g)},_r={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},Rr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=n(n({},_r),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,E,N,b,M,S,k=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=this.formatOptions(o,e),h=u.width,d=u.height,l=u.nodeSize,f=u.getMass,g=u.nodeStrength,p=u.edgeStrength,v=u.linkDistance,y=i.map((function(t){return n(n({},t),{data:n(n({},t.data),{x:x(t.data.x)?t.data.x:Math.random()*h,y:x(t.data.y)?t.data.y:Math.random()*d,size:l(t)||30,mass:f(t),nodeStrength:g(t)})})})),m=s.map((function(t){return n(n({},t),{data:n(n({},t.data),{edgeStrength:p(t),linkDistance:v(t,e.getNode(t.source),e.getNode(t.target))})})})),(null==i?void 0:i.length)?(w={},i.forEach((function(t,e){w[t.id]={x:0,y:0}})),E=new c({nodes:y,edges:m}),this.formatCentripetal(u,E),N=u.maxIteration,b=u.minMovement,M=u.onTick,this.lastLayoutNodes=y,this.lastLayoutEdges=m,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=E,this.lastOptions=u,this.lastVelMap=w,"undefined"==typeof window?[2]:(S=0,[2,new Promise((function(r){k.timeInterval=window.setInterval((function(){i&&k.running||r({nodes:Pr(e,y),edges:s}),k.runOneStep(E,e,S,w,u),k.updatePosition(e,E,w,u),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),null==M||M({nodes:Pr(e,y),edges:s}),(++S>=N||k.judgingDistance<b)&&(window.clearInterval(k.timeInterval),r({nodes:Pr(e,y),edges:s}))}),0),k.running=!0}))])):(this.lastResult={nodes:[],edges:s},[2,{nodes:[],edges:s}])}))}))},t.prototype.formatOptions=function(t,e){var r=t,n=t.width,o=t.height,i=t.getMass;if(r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=o||"undefined"==typeof window?o:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),i||(r.getMass=function(t){var r=1;x(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);var n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),t.preventOverlap){var a=S(0,t.nodeSpacing);t.nodeSize?g(t.nodeSize)?r.nodeSize=function(e){var r=t.nodeSize;return Math.max(r[0],r[1])+a(e)}:r.nodeSize=function(e){return t.nodeSize+a(e)}:r.nodeSize=function(t){var e=((null==t?void 0:t.data)||{}).size;return e?g(e)?Math.max(e[0],e[1])+a(t):M(e)?Math.max(e.width,e.height)+a(t):e+a(t):10+a(t)}}return r.linkDistance=t.linkDistance?S(1,t.linkDistance):function(t){return 1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target))},r.nodeStrength=S(1,t.nodeStrength),r.edgeStrength=S(1,t.edgeStrength),t},t.prototype.formatCentripetal=function(t,e){var r,n=t.centripetalOptions,o=t.center,i=t.clusterNodeStrength,a=t.leafCluster,s=t.clustering,u=t.nodeClusterBy,h=e.getAllNodes(),d=n||{leaf:2,single:2,others:1,center:function(t){return{x:o[0],y:o[1]}}};"function"!=typeof i&&(t.clusterNodeStrength=function(t){return i});var l=[];if(a&&u&&(r=zr(e,u),l=Array.from(new Set(null==h?void 0:h.map((function(t){return t.data[u]}))))||[],t.centripetalOptions=Object.assign(d,{single:100,leaf:function(e){var n=r[e.id]||{},o=n.siblingLeaves,i=n.sameTypeLeaves;return(null==i?void 0:i.length)===(null==o?void 0:o.length)||1===(null==l?void 0:l.length)?1:t.clusterNodeStrength(e)},others:1,center:function(t){var n,o=e.getDegree(t.id,"both");if(!o)return{x:100,y:100};if(1===o){var i=(r[t.id]||{}).sameTypeLeaves,a=void 0===i?[]:i;1===a.length?n=void 0:a.length>1&&(n=Or(a))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y}}})),s&&u){r||(r=zr(e,u)),l||(l=Array.from(new Set(h.map((function(t){return t.data[u]}))))),l=l.filter((function(t){return void 0!==t}));var c={};l.forEach((function(t){var r=h.filter((function(e){return e.data[u]===t})).map((function(t){return e.getNode(t.id)}));c[t]=Or(r)})),t.centripetalOptions=Object.assign(d,{single:function(e){return t.clusterNodeStrength(e)},leaf:function(e){return t.clusterNodeStrength(e)},others:function(e){return t.clusterNodeStrength(e)},center:function(t){var e=c[t.data[u]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y}}})}var f=t.centripetalOptions||{},g=f.leaf,p=f.single,v=f.others;g&&"function"!=typeof g&&(t.centripetalOptions.leaf=function(){return g}),p&&"function"!=typeof p&&(t.centripetalOptions.single=function(){return p}),v&&"function"!=typeof v&&(t.centripetalOptions.others=function(){return v})},t.prototype.runOneStep=function(t,e,r,n,o){var i={},a=t.getAllNodes(),s=t.getAllEdges();if(null==a?void 0:a.length){var u=o.monitor;this.calRepulsive(t,i,o),s&&this.calAttractive(t,i,o),this.calGravity(t,e,i,o),this.updateVelocity(t,i,n,o),u&&u({energy:this.calTotalEnergy(i,a),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}},t.prototype.calTotalEnergy=function(t,e){if(!(null==e?void 0:e.length))return 0;var r=0;return e.forEach((function(e,n){var o=t[e.id].x,i=t[e.id].y,a=o*o+i*i,s=e.data.mass;r+=(void 0===s?1:s)*a*.5})),r},t.prototype.calRepulsive=function(t,e,r){var n=r.dimensions,o=r.factor,i=r.coulombDisScale;!function(t,e,r,n,o){var i=e/r,a=t.getAllNodes(),s=a.map((function(t,e){var r=t.data,n=r.nodeStrength;return{x:r.x,y:r.y,z:r.z,size:r.size,index:e,vx:0,vy:0,vz:0,weight:i*n}})),u=(2===o?F(s,(function(t){return t.x}),(function(t){return t.y})):Nr(s,(function(t){return t.x}),(function(t){return t.y}),(function(t){return t.z}))).visitAfter(kr);s.forEach((function(t){!function(t,e,r){e.visit((function(e,n,o,i,a){return Ar(e,n,o,i,a,t,r)}))}(t,u,o)})),s.map((function(t,e){var r=a[e],o=r.id,i=r.data.mass,s=void 0===i?1:i;n[o]={x:t.vx/s,y:t.vy/s,z:t.vz/s}}))}(t,o,i*i,e,n)},t.prototype.calAttractive=function(t,e,r){var n=r.dimensions;t.getAllEdges().forEach((function(r,o){var i=r.source,a=r.target,s=t.getNode(i),u=t.getNode(a);if(s&&u){var h=u.data.x-s.data.x,d=u.data.y-s.data.y,l=3===n?u.data.z-s.data.z:0;h||d||(h=.01*Math.random(),d=.01*Math.random(),3!==n||l||(l=.01*Math.random()));var c=Math.sqrt(h*h+d*d+l*l),f=h/c,g=d/c,p=l/c,v=r.data||{},y=v.linkDistance,m=void 0===y?200:y,w=v.edgeStrength,x=(m-c)*(void 0===w?200:w),E=1/(s.data.mass||1),N=1/(u.data.mass||1),b=f*x,M=g*x,S=p*x;e[i].x-=b*E,e[i].y-=M*E,e[i].z-=S*E,e[a].x+=b*N,e[a].y+=M*N,e[a].z+=M*N}}))},t.prototype.calGravity=function(t,e,r,n){var o=n.getCenter,i=t.getAllNodes(),a=e.getAllNodes(),u=e.getAllEdges(),h=n.width,d=n.height,l=n.center,c=n.gravity,f=n.centripetalOptions;i&&i.forEach((function(n){var i=n.id,g=n.data,p=g.mass,v=g.x,y=g.y,m=g.z,w=e.getNode(i),E=0,N=0,b=0,M=c,S=t.getDegree(i,"in"),k=t.getDegree(i,"out"),A=t.getDegree(i,"both"),_=null==o?void 0:o(w,A);if(_){var R=s(_,3);E=v-R[0],N=y-R[1],M=R[2]}else E=v-l[0],N=y-l[1],b=m-l[2];if(M&&(r[i].x-=M*E/p,r[i].y-=M*N/p,r[i].z-=M*b/p),f){var z=f.leaf,I=f.single,D=f.others,O=f.center,P=(null==O?void 0:O(w,a,u,h,d))||{x:0,y:0,z:0,centerStrength:0},T=P.x,C=P.y,q=P.z,L=P.centerStrength;if(!x(T)||!x(C))return;var j=(v-T)/p,F=(y-C)/p,V=(m-q)/p;if(L&&(r[i].x-=L*j,r[i].y-=L*F,r[i].z-=L*V),0===A){var B=I(w);if(!B)return;return r[i].x-=B*j,r[i].y-=B*F,void(r[i].z-=B*V)}if(0===S||0===k){var G=z(w,a,u);if(!G)return;return r[i].x-=G*j,r[i].y-=G*F,void(r[i].z-=G*V)}var W=D(w);if(!W)return;r[i].x-=W*j,r[i].y-=W*F,r[i].z-=W*V}}))},t.prototype.updateVelocity=function(t,e,r,n){var o=n.damping,i=n.maxSpeed,a=n.interval,s=n.dimensions,u=t.getAllNodes();(null==u?void 0:u.length)&&u.forEach((function(t){var n=t.id,u=(r[n].x+e[n].x*a)*o||.01,h=(r[n].y+e[n].y*a)*o||.01,d=3===s?(r[n].z+e[n].z*a)*o||.01:0,l=Math.sqrt(u*u+h*h+d*d);if(l>i){var c=i/l;u*=c,h*=c,d*=c}r[n]={x:u,y:h,z:d}}))},t.prototype.updatePosition=function(t,e,r,n){var o=this,i=n.distanceThresholdMode,a=n.interval,s=n.dimensions,u=e.getAllNodes();if(null==u?void 0:u.length){var h=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),u.forEach((function(n){var u=n.id,d=t.getNode(u);if(x(d.data.fx)&&x(d.data.fy))e.mergeNodeData(u,{x:d.data.fx,y:d.data.fy});else{var l=r[u].x*a,c=r[u].y*a,f=3===s?r[u].z*a:0;e.mergeNodeData(u,{x:n.data.x+l,y:n.data.y+c,z:n.data.z+f});var g=Math.sqrt(l*l+c*c+f*f);switch(i){case"max":o.judgingDistance<g&&(o.judgingDistance=g);break;case"min":o.judgingDistance>g&&(o.judgingDistance=g);break;default:h+=g}}})),i&&"mean"!==i||(this.judgingDistance=h/u.length)}else this.judgingDistance=0},t}(),zr=function(t,e){var r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};var n={};return r.forEach((function(r,o){1===t.getDegree(r.id,"both")&&(n[r.id]=Ir(t,"leaf",r,e))})),n},Ir=function(t,e,r,n){var o=t.getDegree(r.id,"in"),i=t.getDegree(r.id,"out"),a=r,s=[];return 0===o?(a=t.getSuccessors(r.id)[0],s=t.getNeighbors(a.id)):0===i&&(a=t.getPredecessors(r.id)[0],s=t.getNeighbors(a.id)),s=s.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")})),{coreNode:a,siblingLeaves:s,sameTypeLeaves:Dr(t,e,n,r,s)}},Dr=function(t,e,r,n,o){var i=n.data[r]||"",a=(null==o?void 0:o.filter((function(t){return t.data[r]===i})))||[];return"leaf"===e&&(a=a.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")}))),a},Or=function(t){var e={x:0,y:0};t.forEach((function(t){var r=t.data,n=r.x,o=r.y;e.x+=n||0,e.y+=o||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},Pr=function(t,e){return e.map((function(e){var r=e.id,o=e.data,i=t.getNode(r);return n(n({},i),{data:n(n({},i.data),{x:o.x,y:o.y,z:o.z})})}))},Tr=function(){function t(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}return t.prototype.distanceTo=function(t){var e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)},t.prototype.setPos=function(t,e){this.rx=t,this.ry=e},t.prototype.resetForce=function(){this.fx=0,this.fy=0},t.prototype.addForce=function(t){var e=t.rx-this.rx,r=t.ry-this.ry,n=Math.hypot(e,r);n=n<1e-4?1e-4:n;var o=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=o*e/n,this.fy+=o*r/n},t.prototype.in=function(t){return t.contains(this.rx,this.ry)},t.prototype.add=function(e){var r=this.mass+e.mass;return new t({rx:(this.rx*this.mass+e.rx*e.mass)/r,ry:(this.ry*this.mass+e.ry*e.mass)/r,mass:r,degree:this.degree+e.degree})},t}();const Cr=Tr;const qr=function(){function t(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}return t.prototype.getLength=function(){return this.length},t.prototype.contains=function(t,e){var r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r},t.prototype.NW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.NE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.SW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t.prototype.SE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t}(),Lr=function(){function t(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}return t.prototype.insert=function(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e},t.prototype._putBody=function(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))},t.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},t.prototype.updateForce=function(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))},t}();var jr={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Fr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2",this.options=n(n({},jr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,x,E,b,M,S,k,A,R;return a(this,(function(a){if(o=e.getAllEdges(),i=e.getAllNodes(),s=this.formatOptions(r,i.length),u=s.width,h=s.height,d=s.prune,l=s.maxIteration,f=s.nodeSize,g=s.center,!(null==i?void 0:i.length)||1===i.length)return[2,_(e,t,g)];if(p=i.map((function(t){return N(t,[u,h])})),v=o.filter((function(t){return t.source!==t.target})),y=new c({nodes:p,edges:v}),m=this.getSizes(y,e,f),this.run(y,e,l,m,t,s),d){for(w=0;w<v.length;w+=1)x=v[w],E=x.source,b=x.target,M=y.getDegree(E),S=y.getDegree(E),M<=1?(k=y.getNode(b),y.mergeNodeData(E,{x:k.data.x,y:k.data.y})):S<=1&&(A=y.getNode(E),y.mergeNodeData(b,{x:A.data.x,y:A.data.y}));R=n(n({},s),{prune:!1,barnesHut:!1}),this.run(y,e,100,m,t,R)}return[2,{nodes:p,edges:o}]}))}))},t.prototype.getSizes=function(t,e,r){for(var n=t.getAllNodes(),o={},i=0;i<n.length;i+=1){var a=n[i],s=a.id,h=a.data;if(o[s]=10,x(h.size))o[s]=h.size;else if(g(h.size))isNaN(h.size[0])||(o[s]=Math.max(h.size[0])),isNaN(h.size[1])||(o[s]=Math.max(h.size[1]));else if(M(h.size))o[s]=Math.max(h.size.width,h.size.height);else if(b(r)){var d=r(e.getNode(s));g(d)?o[s]=Math.max.apply(Math,u(d)):o[s]=d}else g(r)?o[s]=Math.max.apply(Math,u(r)):x(r)&&(o[s]=r)}return o},t.prototype.formatOptions=function(t,e){void 0===t&&(t={});var r=n(n({},this.options),t),o=r.center,i=r.width,a=r.height,s=r.barnesHut,u=r.prune,h=r.maxIteration,d=r.kr,l=r.kg;return r.width=i||"undefined"==typeof window?i:window.innerWidth,r.height=a||"undefined"==typeof window?a:window.innerHeight,r.center=o||[r.width/2,r.height/2],void 0===s&&e>250&&(r.barnesHut=!0),void 0===u&&e>100&&(r.prune=!0),0!==h||u?0===h&&u&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)):(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)),d||(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),l||(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r},t.prototype.run=function(t,e,r,n,o,i){for(var a=i.kr,s=i.barnesHut,u=i.onTick,h=t.getAllNodes(),d=0,l=r,c={},f={},g={},p=0;p<h.length;p+=1){var v=h[p],y=v.data,m=v.id;if(c[m]=[0,0],s){var w={id:p,rx:y.x,ry:y.y,mass:1,g:a,degree:t.getDegree(m)};g[m]=new Cr(w)}}for(;l>0;)d=this.oneStep(t,{iter:l,preventOverlapIters:50,krPrime:100,sg:d,forces:c,preForces:f,bodies:g,sizes:n},i),l--,null==u||u({nodes:h,edges:e.getAllEdges()});return t},t.prototype.oneStep=function(t,e,r){for(var n=e.iter,o=e.preventOverlapIters,i=e.krPrime,a=e.sg,s=e.preForces,h=e.bodies,d=e.sizes,l=e.forces,c=r.preventOverlap,f=r.barnesHut,g=t.getAllNodes(),p=0;p<g.length;p+=1){var v=g[p].id;s[v]=u(l[v]),l[v]=[0,0]}return l=this.getAttrForces(t,n,o,d,l,r),l=f&&(c&&n>o||!c)?this.getOptRepGraForces(t,l,h,r):this.getRepGraForces(t,n,o,l,i,d,r),this.updatePos(t,l,s,a,r)},t.prototype.getAttrForces=function(t,e,r,n,o,i){for(var a=i.preventOverlap,s=i.dissuadeHubs,u=i.mode,h=i.prune,d=t.getAllEdges(),l=0;l<d.length;l+=1){var c=d[l],f=c.source,g=c.target,p=t.getNode(f),v=t.getNode(g),y=t.getDegree(f),m=t.getDegree(g);if(!h||!(y<=1||m<=1)){var w=[v.data.x-p.data.x,v.data.y-p.data.y],x=Math.hypot(w[0],w[1]);x=x<1e-4?1e-4:x,w[0]=w[0]/x,w[1]=w[1]/x,a&&e<r&&(x=x-n[f]-n[g]);var E=x,N=E;"linlog"===u&&(N=E=Math.log(1+x)),s&&(E=x/y,N=x/m),a&&e<r&&x<=0?(E=0,N=0):a&&e<r&&x>0&&(E=x,N=x),o[f][0]+=E*w[0],o[g][0]-=N*w[0],o[f][1]+=E*w[1],o[g][1]-=N*w[1]}}return o},t.prototype.getOptRepGraForces=function(t,e,r,n){for(var o=n.kg,i=n.center,a=n.prune,s=t.getAllNodes(),u=s.length,h=9e10,d=-9e10,l=9e10,c=-9e10,f=0;f<u;f+=1){var g=s[f],p=g.id,v=g.data;a&&t.getDegree(p)<=1||(r[p].setPos(v.x,v.y),v.x>=d&&(d=v.x),v.x<=h&&(h=v.x),v.y>=c&&(c=v.y),v.y<=l&&(l=v.y))}var y=Math.max(d-h,c-l),m=new qr({xmid:(d+h)/2,ymid:(c+l)/2,length:y,massCenter:i,mass:u}),w=new Lr(m);for(f=0;f<u;f+=1)p=s[f].id,a&&t.getDegree(p)<=1||r[p].in(m)&&w.insert(r[p]);for(f=0;f<u;f+=1){var x=s[f],E=(p=x.id,v=x.data,t.getDegree(p));if(!(a&&E<=1)){r[p].resetForce(),w.updateForce(r[p]),e[p][0]-=r[p].fx,e[p][1]-=r[p].fy;var N=[v.x-i[0],v.y-i[1]],b=Math.hypot(N[0],N[1]);b=b<1e-4?1e-4:b,N[0]=N[0]/b,N[1]=N[1]/b;var M=o*(E+1);e[p][0]-=M*N[0],e[p][1]-=M*N[1]}}return e},t.prototype.getRepGraForces=function(t,e,r,n,o,i,a){for(var s=a.preventOverlap,u=a.kr,h=a.kg,d=a.center,l=a.prune,c=t.getAllNodes(),f=c.length,g=0;g<f;g+=1){for(var p=c[g],v=t.getDegree(p.id),y=g+1;y<f;y+=1){var m=c[y],w=t.getDegree(m.id);if(!l||!(v<=1||w<=1)){var x=[m.data.x-p.data.x,m.data.y-p.data.y],E=Math.hypot(x[0],x[1]);E=E<1e-4?1e-4:E,x[0]=x[0]/E,x[1]=x[1]/E,s&&e<r&&(E=E-i[p.id]-i[m.id]);var N=u*(v+1)*(w+1)/E;s&&e<r&&E<0?N=o*(v+1)*(w+1):s&&e<r&&0===E?N=0:s&&e<r&&E>0&&(N=u*(v+1)*(w+1)/E),n[p.id][0]-=N*x[0],n[m.id][0]+=N*x[0],n[p.id][1]-=N*x[1],n[m.id][1]+=N*x[1]}}var b=[p.data.x-d[0],p.data.y-d[1]],M=Math.hypot(b[0],b[1]);b[0]=b[0]/M,b[1]=b[1]/M;var S=h*(v+1);n[p.id][0]-=S*b[0],n[p.id][1]-=S*b[1]}return n},t.prototype.updatePos=function(t,e,r,n,o){for(var i=o.ks,a=o.tao,s=o.prune,u=o.ksmax,h=t.getAllNodes(),d=h.length,l=[],c=[],f=0,g=0,p=n,v=0;v<d;v+=1){var y=h[v].id,m=t.getDegree(y);if(!(s&&m<=1)){var w=[e[y][0]-r[y][0],e[y][1]-r[y][1]],E=Math.hypot(w[0],w[1]),N=[e[y][0]+r[y][0],e[y][1]+r[y][1]],b=Math.hypot(N[0],N[1]);l[v]=E,c[v]=b/2,f+=(m+1)*l[v],g+=(m+1)*c[v]}}var M=p;for(p=a*g/f,0!==M&&(p=p>1.5*M?1.5*M:p),v=0;v<d;v+=1){var S=h[v],k=(y=S.id,S.data);if(m=t.getDegree(y),!(s&&m<=1||x(k.fx)&&x(k.fy))){var A=i*p/(1+p*Math.sqrt(l[v])),_=Math.hypot(e[y][0],e[y][1]),R=u/(_=_<1e-4?1e-4:_),z=(A=A>R?R:A)*e[y][0],I=A*e[y][1];t.mergeNodeData(y,{x:k.x+z,y:k.y+I})}}return p},t}(),Vr={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Br=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=n(n({},Vr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericFruchtermanLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,x,E=this;return a(this,(function(a){return this.running?[2]:(o=this.formatOptions(r),i=o.width,s=o.height,u=o.center,h=o.clustering,d=o.nodeClusterBy,l=o.maxIteration,f=o.onTick,g=e.getAllNodes(),p=e.getAllEdges(),(null==g?void 0:g.length)?1===g.length?(t&&e.mergeNodeData(g[0].id,{x:u[0],y:u[1]}),v={nodes:[n(n({},g[0]),{data:n(n({},g[0].data),{x:u[0],y:u[1]})})],edges:p},this.lastResult=v,[2,v]):(y=g.map((function(t){return N(t,[i,s])})),m=new c({nodes:y,edges:p}),w={},h&&y.forEach((function(t){var e=t.data[d];w[e]||(w[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=y,this.lastLayoutEdges=p,this.lastAssign=t,this.lastGraph=m,this.lastOptions=o,this.lastClusterMap=w,"undefined"==typeof window?[2]:(x=0,[2,new Promise((function(r){E.timeInterval=window.setInterval((function(){E.running?(E.runOneStep(m,w,o),t&&y.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y})})),null==f||f({nodes:y,edges:p}),++x>=l&&(window.clearInterval(E.timeInterval),r({nodes:y,edges:p}))):r({nodes:y,edges:p})}),0),E.running=!0}))])):(v={nodes:[],edges:p},this.lastResult=v,[2,v]))}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=n(n({},this.options),t),r=e.clustering,o=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=r&&!!o,e},t.prototype.runOneStep=function(t,e,r){var n=r.height,o=r.width,i=r.gravity,a=r.center,s=r.speed,u=r.clustering,h=r.nodeClusterBy,d=r.clusterGravity,l=n*o,c=Math.sqrt(l)/10,f=t.getAllNodes(),g=l/(f.length+1),p=Math.sqrt(g),v={};if(this.applyCalculate(t,v,p,g),u){for(var y in e)e[y].cx=0,e[y].cy=0,e[y].count=0;for(var y in f.forEach((function(t){var r=t.data,n=e[r[h]];x(r.x)&&(n.cx+=r.x),x(r.y)&&(n.cy+=r.y),n.count++})),e)e[y].cx/=e[y].count,e[y].cy/=e[y].count;var m=d||i;f.forEach((function(t,r){var n=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=e[o[h]],a=Math.sqrt((o.x-i.cx)*(o.x-i.cx)+(o.y-i.cy)*(o.y-i.cy)),s=p*m;v[n].x-=s*(o.x-i.cx)/a,v[n].y-=s*(o.y-i.cy)/a}}))}f.forEach((function(t,e){var r=t.id,n=t.data;if(x(n.x)&&x(n.y)){var o=.01*p*i;v[r].x-=o*(n.x-a[0]),v[r].y-=o*(n.y-a[1])}})),f.forEach((function(e,r){var n=e.id,o=e.data;if(x(o.fx)&&x(o.fy))return o.x=o.fx,void(o.y=o.fy);if(x(o.x)&&x(o.y)){var i=Math.sqrt(v[n].x*v[n].x+v[n].y*v[n].y);if(i>0){var a=Math.min(c*(s/800),i);t.mergeNodeData(n,{x:o.x+v[n].x/i*a,y:o.y+v[n].y/i*a})}}}))},t.prototype.applyCalculate=function(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)},t.prototype.calRepulsive=function(t,e,r){var n=t.getAllNodes();n.forEach((function(t,o){var i=t.data,a=t.id;e[a]={x:0,y:0},n.forEach((function(t,n){var s=t.data,u=t.id;if(!(o<=n)&&x(i.x)&&x(s.x)&&x(i.y)&&x(s.y)){var h=i.x-s.x,d=i.y-s.y,l=h*h+d*d;0===l&&(l=1,h=.01,d=.01);var c=r/l,f=h*c,g=d*c;e[a].x+=f,e[a].y+=g,e[u].x-=f,e[u].y-=g}}))}))},t.prototype.calAttractive=function(t,e,r){t.getAllEdges().forEach((function(n){var o=n.source,i=n.target;if(o&&i&&o!==i){var a=t.getNode(o).data,s=t.getNode(i).data;if(x(s.x)&&x(a.x)&&x(s.y)&&x(a.y)){var u=s.x-a.x,h=s.y-a.y,d=Math.sqrt(u*u+h*h)/r,l=u*d,c=h*d;e[o].x+=l,e[o].y+=c,e[i].x-=l,e[i].y-=c}}}))},t}(),Gr={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},Wr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="grid",this.options=n(n({},Gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericGridLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericGridLayout(!0,t,e),[2]}))}))},t.prototype.genericGridLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,p,v,y,m,w,E,b,M,A,R,z,I,D,P,T,C,q,L,j,F,V,B,G,W,$,U,H,K;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.begin,s=void 0===i?[0,0]:i,u=o.condense,h=o.preventOverlapPadding,d=o.preventOverlap,l=o.rows,c=o.cols,f=o.nodeSpacing,p=o.nodeSize,v=o.width,y=o.height,m=o.position,w=o.sortBy,E=e.getAllNodes(),b=e.getAllEdges(),!(M=null==E?void 0:E.length)||1===M)return[2,_(e,t,s)];if(A=E.map((function(t){return N(t)})),"id"===w||O(w)&&void 0!==A[0].data[w]||(w="degree"),"degree"===w?A.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):"id"===w?A.sort((function(t,e){return x(e.id)&&x(t.id)?e.id-t.id:(""+t.id).localeCompare(""+e.id)})):A.sort((function(t,e){return e.data[w]-t.data[w]})),R=v||"undefined"==typeof window?v:window.innerWidth,z=y||"undefined"==typeof window?y:window.innerHeight,I=M,D={rows:l,cols:c},null!=l&&null!=c?(D.rows=l,D.cols=c):null!=l&&null==c?(D.rows=l,D.cols=Math.ceil(I/D.rows)):null==l&&null!=c?(D.cols=c,D.rows=Math.ceil(I/D.cols)):(P=Math.sqrt(I*z/R),D.rows=Math.round(P),D.cols=Math.round(R/z*P)),D.rows=Math.max(D.rows,1),D.cols=Math.max(D.cols,1),D.cols*D.rows>I)T=$r(D),C=Ur(D),(T-1)*C>=I?$r(D,T-1):(C-1)*T>=I&&Ur(D,C-1);else for(;D.cols*D.rows<I;)T=$r(D),((C=Ur(D))+1)*T>=I?Ur(D,C+1):$r(D,T+1);for(q=u?0:R/D.cols,L=u?0:z/D.rows,(d||f)&&(j=S(10,f),F=k(30,p,!1),A.forEach((function(t){t.data.x&&t.data.y||(t.data.x=0,t.data.y=0);var r,n,o=e.getNode(t.id),i=F(o)||30;g(i)?(r=i[0],n=i[1]):(r=i,n=i);var a=void 0!==j?j(t):h,s=r+a,u=n+a;q=Math.max(q,s),L=Math.max(L,u)}))),V={},B={row:0,col:0},G={},W=0;W<A.length;W++){if($=A[W],U=void 0,m&&(U=m(e.getNode($.id))),U&&(void 0!==U.row||void 0!==U.col)){if(void 0===(H={row:U.row,col:U.col}).col)for(H.col=0;Hr(V,H);)H.col++;else if(void 0===H.row)for(H.row=0;Hr(V,H);)H.row++;G[$.id]=H,Kr(V,H)}Jr($,s,q,L,G,D,B,V)}return K={nodes:A,edges:b},t&&A.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,K]}))}))},t}(),$r=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.min(n,o):Math.min(n,o)===t.rows?t.rows=e:t.cols=e,r},Ur=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.max(n,o):Math.max(n,o)===t.rows?t.rows=e:t.cols=e,r},Hr=function(t,e){return t["c-"+e.row+"-"+e.col]||!1},Kr=function(t,e){return t["c-"+e.row+"-"+e.col]=!0},Yr=function(t,e){var r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},Jr=function(t,e,r,n,o,i,a,s){var u,h,d=o[t.id];if(d)u=d.col*r+r/2+e[0],h=d.row*n+n/2+e[1];else{for(;Hr(s,a);)Yr(i,a);u=a.col*r+r/2+e[0],h=a.row*n+n/2+e[1],Kr(s,a),Yr(i,a)}t.data.x=u,t.data.y=h};const Xr=Object.prototype.toString;function Qr(t){const e=Xr.call(t);return e.endsWith("Array]")&&!e.includes("Big")}function Zr(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!Qr(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]<a&&(a=t[s]);return a}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]>a&&(a=t[s]);return a}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,a=void 0===i?r.autoMinMax?n:0:i,s=r.max,u=void 0===s?r.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var h=(u-a)/(o-n),d=0;d<t.length;d++)e[d]=(t[d]-n)*h+a;return e}const tn=" ".repeat(2),en=" ".repeat(4);function rn(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=e;return`${t.constructor.name} {\\n${tn}[\\n${en}${function(t,e,r,n,o){const{rows:i,columns:a}=t,s=Math.min(i,e),u=Math.min(a,r),h=[];if("auto"===o){o=!1;t:for(let e=0;e<s;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let e=0;e<s;e++){let r=[];for(let i=0;i<u;i++)r.push(nn(t.get(e,i),n,o));h.push(`${r.join(" ")}`)}return u!==a&&(h[h.length-1]+=` ... ${a-r} more columns`),s!==i&&h.push(`... ${i-e} more rows`),h.join(`\\n${en}`)}(t,r,n,o,i)}\\n${tn}]\\n${tn}rows: ${t.rows}\\n${tn}columns: ${t.columns}\\n}`}function nn(t,e,r){return(t>=0&&r?` ${on(t,e-1)}`:on(t,e)).padEnd(e)}function on(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function an(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function sn(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function un(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function hn(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function dn(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(cn("startRow",e),cn("endRow",r),cn("startColumn",n),cn("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function ln(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function cn(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function fn(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class gn{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new vn(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new vn(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new vn(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new vn(t,e)}static ones(t,e){return new vn(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new vn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)o.set(r,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let a=o-n,s=new vn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(i()*a);s.set(r,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let t=0;t<n;t++)o.set(t,t,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let e=0;e<o;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new vn(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return gn.isMatrix(t)?t:new vn(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let a=o;a<e;a++){let e=t.get(r,a)-i*t.get(n,a);t.set(r,a,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new vn(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){an(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return vn.rowVector(this.getRow(t))}setRow(t,e){an(this,t),e=un(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){an(this,t),an(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){sn(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return vn.columnVector(this.getColumn(t))}setColumn(t,e){sn(this,t),e=hn(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){sn(this,t),sn(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){an(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){sn(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){fn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){fn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(an(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){an(this,t),fn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(an(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){an(this,t),fn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(sn(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){sn(this,t),fn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(sn(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){sn(this,t),fn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){gn.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=vn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new vn(e,n),i=new Float64Array(r);for(let a=0;a<n;a++){for(let e=0;e<r;e++)i[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,a,e)}}return o}strassen2x2(t){t=vn.checkMatrix(t);let e=new vn(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),h=t.get(1,1),d=(r+u)*(n+h),l=(a+u)*n,c=r*(i-h),f=u*(s-n),g=(r+o)*h,p=d+f-g+(o-u)*(s+h),v=c+g,y=l+f,m=d-l+c+(a-r)*(n+i);return e.set(0,0,p),e.set(0,1,v),e.set(1,0,y),e.set(1,1,m),e}strassen3x3(t){t=vn.checkMatrix(t);let e=new vn(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),h=this.get(2,1),d=this.get(2,2),l=t.get(0,0),c=t.get(0,1),f=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),y=t.get(2,0),m=t.get(2,1),w=t.get(2,2),x=(r-i)*(-c+p),E=(-r+i+a)*(l-c+p),N=(i+a)*(-l+c),b=r*l,M=(-r+u+h)*(l-f+v),S=(-r+u)*(f-v),k=(u+h)*(-l+f),A=(-o+h+d)*(p+y-m),_=(o-d)*(p-m),R=o*y,z=(h+d)*(-y+m),I=(-o+a+s)*(v+y-w),D=(o-s)*(v-w),O=(a+s)*(-y+w),P=b+R+n*g,T=(r+n+o-i-a-h-d)*p+E+N+b+A+R+z,C=b+M+k+(r+n+o-a-s-u-h)*v+R+I+O,q=x+a*(-l+c+g-p-v-y+w)+E+b+R+I+D,L=x+E+N+b+s*m,j=R+I+D+O+i*f,F=b+M+S+h*(-l+f+g-p-v-y+m)+A+_+R,V=A+_+R+z+u*c,B=b+M+S+k+d*w;return e.set(0,0,P),e.set(0,1,T),e.set(0,2,C),e.set(1,0,q),e.set(1,1,L),e.set(1,2,j),e.set(2,0,F),e.set(2,1,V),e.set(2,2,B),e}mmulStrassen(t){t=vn.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function a(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=gn.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${r} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let s=Math.max(r,o),u=Math.max(n,i);return e=a(e,s,u),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=a(e,n+1,o+1),r=a(r,n+1,o+1)):n%2==1?(e=a(e,n+1,o),r=a(r,n+1,o)):o%2==1&&(e=a(e,n,o+1),r=a(r,n,o+1));let i=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,s-1),h=r.subMatrix(0,i-1,0,s-1),d=e.subMatrix(0,i-1,s,e.columns-1),l=r.subMatrix(0,i-1,s,r.columns-1),c=e.subMatrix(i,e.rows-1,0,s-1),f=r.subMatrix(i,r.rows-1,0,s-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),p=r.subMatrix(i,r.rows-1,s,r.columns-1),v=t(gn.add(u,g),gn.add(h,p),i,s),y=t(gn.add(c,g),h,i,s),m=t(u,gn.sub(l,p),i,s),w=t(g,gn.sub(f,h),i,s),x=t(gn.add(u,d),p,i,s),E=t(gn.sub(c,u),gn.add(h,l),i,s),N=t(gn.sub(d,g),gn.add(f,p),i,s),b=gn.add(v,w);b.sub(x),b.add(N);let M=gn.add(m,x),S=gn.add(y,w),k=gn.sub(v,y);k.add(m),k.add(E);let A=gn.zeros(2*b.rows,2*b.columns);return A=A.setSubMatrix(b,0,0),A=A.setSubMatrix(M,b.rows,0),A=A.setSubMatrix(S,0,b.columns),A=A.setSubMatrix(k,b.rows,b.columns),A.subMatrix(0,n-1,0,o-1)}(e,t=a(t,s,u),s,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new vn(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&Zr(o,{min:e,max:r,output:o}),n.setRow(t,o)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new vn(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&Zr(o,{min:e,max:r,output:o}),n.setColumn(t,o)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=vn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new vn(e*n,r*o);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<o;s++)i.set(n*a+r,o*e+s,this.get(a,e)*t.get(r,s));return i}kroneckerSum(t){if(t=vn.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(vn.eye(r,r)),o=vn.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new vn(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=pn){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=pn){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){dn(this,t,e,r,n);let o=new vn(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new vn(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new vn(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=vn.checkMatrix(t)).isEmpty())return this;dn(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){!function(t,e){if(!Qr(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!Qr(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new vn(t.length,e.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<e.length;t++){let i=e[t];r.set(n,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new vn(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=ln(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=ln(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=ln(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=ln(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Qr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<n;a++){let n=0,s=0,u=0;for(let e=0;e<o;e++)u=t.get(a,e)-r[a],n+=u,s+=u*u;e?i.push((s-n*n/o)/(o-1)):i.push((s-n*n/o)/o)}return i}(this,r,n);case"column":if(!Qr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<o;a++){let o=0,s=0,u=0;for(let e=0;e<n;e++)u=t.get(e,a)-r[a],o+=u,s+=u*u;e?i.push((s-o*o/n)/(n-1)):i.push((s-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let a=0,s=0,u=0;for(let e=0;e<n;e++)for(let n=0;n<o;n++)u=t.get(e,n)-r,a+=u,s+=u*u;return e?(s-a*a/i)/(i-1):(s-a*a/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Qr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!Qr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!Qr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!Qr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return rn(this,t)}}function pn(t,e){return t-e}gn.prototype.klass="Matrix","undefined"!=typeof Symbol&&(gn.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return rn(this)}),gn.random=gn.rand,gn.randomInt=gn.randInt,gn.diagonal=gn.diag,gn.prototype.diagonal=gn.prototype.diag,gn.identity=gn.eye,gn.prototype.negate=gn.prototype.neg,gn.prototype.tensorProduct=gn.prototype.kroneckerProduct;class vn extends gn{constructor(t,e){if(super(),vn.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Qr(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!r[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return an(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),an(this,t,!0),e=Float64Array.from(un(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){sn(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),sn(this,t,!0),e=hn(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(gn,vn);class yn extends gn{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function mn(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class wn{constructor(t,e={}){if((t=yn.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=e;let s,u=Boolean(o),h=Boolean(i),d=!1;if(r<n)if(a){s=t.transpose(),r=s.rows,n=s.columns,d=!0;let e=u;u=h,h=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let l=Math.min(r,n),c=Math.min(r+1,n),f=new Float64Array(c),g=new vn(r,l),p=new vn(n,n),v=new Float64Array(n),y=new Float64Array(r),m=new Float64Array(c);for(let t=0;t<c;t++)m[t]=t;let w=Math.min(r-1,n),x=Math.max(0,Math.min(n-2,r)),E=Math.max(w,x);for(let t=0;t<E;t++){if(t<w){f[t]=0;for(let e=t;e<r;e++)f[t]=mn(f[t],s.get(e,t));if(0!==f[t]){s.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<r;e++)s.set(e,t,s.get(e,t)/f[t]);s.set(t,t,s.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<n;e++){if(t<w&&0!==f[t]){let n=0;for(let o=t;o<r;o++)n+=s.get(o,t)*s.get(o,e);n=-n/s.get(t,t);for(let o=t;o<r;o++)s.set(o,e,s.get(o,e)+n*s.get(o,t))}v[e]=s.get(t,e)}if(u&&t<w)for(let e=t;e<r;e++)g.set(e,t,s.get(e,t));if(t<x){v[t]=0;for(let e=t+1;e<n;e++)v[t]=mn(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<n;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<r&&0!==v[t]){for(let e=t+1;e<r;e++)y[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)y[e]+=v[r]*s.get(e,r);for(let e=t+1;e<n;e++){let n=-v[e]/v[t+1];for(let o=t+1;o<r;o++)s.set(o,e,s.get(o,e)+n*y[o])}}if(h)for(let e=t+1;e<n;e++)p.set(e,t,v[e])}}let N=Math.min(n,r+1);if(w<n&&(f[w]=s.get(w,w)),r<N&&(f[N-1]=0),x+1<N&&(v[x]=s.get(x,N-1)),v[N-1]=0,u){for(let t=w;t<l;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<l;e++){let n=0;for(let o=t;o<r;o++)n+=g.get(o,t)*g.get(o,e);n=-n/g.get(t,t);for(let o=t;o<r;o++)g.set(o,e,g.get(o,e)+n*g.get(o,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(h)for(let t=n-1;t>=0;t--){if(t<x&&0!==v[t])for(let e=t+1;e<n;e++){let r=0;for(let o=t+1;o<n;o++)r+=p.get(o,t)*p.get(o,e);r=-r/p.get(t+1,t);for(let o=t+1;o<n;o++)p.set(o,e,p.get(o,e)+r*p.get(o,t))}for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}let b=N-1,M=0,S=Number.EPSILON;for(;N>0;){let t,e;for(t=N-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===N-2)e=4;else{let r;for(r=N-1;r>=t&&r!==t;r--){let e=(r!==N?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(f[r])<=S*e){f[r]=0;break}}r===t?e=3:r===N-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[N-2];v[N-2]=0;for(let r=N-2;r>=t;r--){let o=mn(f[r],e),i=f[r]/o,a=e/o;if(f[r]=o,r!==t&&(e=-a*v[r-1],v[r-1]=i*v[r-1]),h)for(let t=0;t<n;t++)o=i*p.get(t,r)+a*p.get(t,N-1),p.set(t,N-1,-a*p.get(t,r)+i*p.get(t,N-1)),p.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<N;n++){let o=mn(f[n],e),i=f[n]/o,a=e/o;if(f[n]=o,e=-a*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g.get(e,n)+a*g.get(e,t-1),g.set(e,t-1,-a*g.get(e,n)+i*g.get(e,t-1)),g.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(f[N-1]),Math.abs(f[N-2]),Math.abs(v[N-2]),Math.abs(f[t]),Math.abs(v[t])),o=f[N-1]/e,i=f[N-2]/e,a=v[N-2]/e,s=f[t]/e,d=v[t]/e,l=((i+o)*(i-o)+a*a)/2,c=o*a*(o*a);let y=0;0===l&&0===c||(y=l<0?0-Math.sqrt(l*l+c):Math.sqrt(l*l+c),y=c/(l+y));let m=(s+o)*(s-o)+y,w=s*d;for(let e=t;e<N-1;e++){let o=mn(m,w);0===o&&(o=Number.MIN_VALUE);let i=m/o,a=w/o;if(e!==t&&(v[e-1]=o),m=i*f[e]+a*v[e],v[e]=i*v[e]-a*f[e],w=a*f[e+1],f[e+1]=i*f[e+1],h)for(let t=0;t<n;t++)o=i*p.get(t,e)+a*p.get(t,e+1),p.set(t,e+1,-a*p.get(t,e)+i*p.get(t,e+1)),p.set(t,e,o);if(o=mn(m,w),0===o&&(o=Number.MIN_VALUE),i=m/o,a=w/o,f[e]=o,m=i*v[e]+a*f[e+1],f[e+1]=-a*v[e]+i*f[e+1],w=a*v[e+1],v[e+1]=i*v[e+1],u&&e<r-1)for(let t=0;t<r;t++)o=i*g.get(t,e)+a*g.get(t,e+1),g.set(t,e+1,-a*g.get(t,e)+i*g.get(t,e+1)),g.set(t,e,o)}v[N-2]=m,M+=1;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,h))for(let e=0;e<=b;e++)p.set(e,t,-p.get(e,t));for(;t<b&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,h&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}M=0,N--}}if(d){let t=p;p=g,g=t}this.m=r,this.n=n,this.s=f,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,o=vn.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?o.set(t,t,0):o.set(t,t,1/this.s[t]);let i=this.U,a=this.rightSingularVectors,s=a.mmul(o),u=a.rows,h=i.rows,d=vn.zeros(u,h);for(let t=0;t<u;t++)for(let e=0;e<h;e++){let r=0;for(let o=0;o<n;o++)r+=s.get(t,o)*i.get(e,o);d.set(t,e,r)}return d.mmul(e)}solveForDiagonal(t){return this.solve(vn.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new vn(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,a=i.rows,s=i.columns,u=new vn(r,a);for(let t=0;t<r;t++)for(let e=0;e<a;e++){let r=0;for(let n=0;n<s;n++)r+=o.get(t,n)*i.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return vn.diag(this.s)}}var xn,En={center:[0,0],linkDistance:50},Nn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="mds",this.options=n(n({},En),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericMDSLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericMDSLayout(!0,t,e),[2]}))}))},t.prototype.genericMDSLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,g,y;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=void 0===i?[0,0]:i,u=o.linkDistance,h=void 0===u?50:u,d=e.getAllNodes(),l=e.getAllEdges(),(null==d?void 0:d.length)&&1!==d.length?(c=v({nodes:d,edges:l},!1),f=p(c),bn(f),m=h,w=[],f.forEach((function(t){var e=[];t.forEach((function(t){e.push(t*m)})),w.push(e)})),g=Mn(w),y=[],g.forEach((function(t,e){var r=N(d[e]);r.data.x=t[0]+s[0],r.data.y=t[1]+s[1],y.push(r)})),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:y,edges:l}]):[2,_(e,t,s)];var m,w}))}))},t}(),bn=function(t){var e=-999999;t.forEach((function(t){t.forEach((function(t){t!==1/0&&e<t&&(e=t)}))})),t.forEach((function(r,n){r.forEach((function(r,o){r===1/0&&(t[n][o]=e)}))}))},Mn=function(t){var e=vn.mul(vn.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),o=e.mean();e.add(o).subRowVector(r).subColumnVector(n);var i=new wn(e),a=vn.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((function(t){return vn.mul([t],[a]).toJSON()[0].splice(0,2)}))},Sn={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},kn=function(t,e,r,n,o,i){e.forEach((function(a,s){r[s]={x:0,y:0},e.forEach((function(e,u){if(s!==u&&o[s]===o[u]){var h=a.x-e.x,d=a.y-e.y,l=Math.sqrt(h*h+d*d);if(0===l){l=1;var c=s>u?1:-1;h=.01*c,d=.01*c}if(l<i(t[s])/2+i(t[u])/2){var f=n*n/l;r[s].x+=h/l*f,r[s].y+=d/l*f}}}))}))},An=function(t,e,r,n,o,i,a,s){var u=i||a/10;return n&&e.forEach((function(e,r){var n=t[r].x-t[o].x,i=t[r].y-t[o].y,a=Math.sqrt(n*n+i*i),s=i/a,u=-n/a,h=Math.sqrt(e.x*e.x+e.y*e.y),d=Math.acos((s*e.x+u*e.y)/h);d>Math.PI/2&&(d-=Math.PI/2,s*=-1,u*=-1);var l=Math.cos(d)*h;e.x=s*l,e.y=u*l})),t.forEach((function(i,a){if(a!==o){var h=Math.sqrt(e[a].x*e[a].x+e[a].y*e[a].y);if(h>0&&a!==o){var d=Math.min(u*(r/800),h);if(i.x+=e[a].x/h*d,i.y+=e[a].y/h*d,n){var l=i.x-t[o].x,c=i.y-t[o].y,f=Math.sqrt(l*l+c*c);l=l/f*s[a],c=c/f*s[a],i.x=t[o].x+l,i.y=t[o].y+c}}}})),t},_n={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},Rn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="radial",this.options=n(n({},_n),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRadialLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRadialLayout(!0,t,e),[2]}))}))},t.prototype.genericRadialLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,h,d,l,c,f,g,y,m,w,x,E,b,M,S,k,R,z,I,D,P,T,C,q,L,j,F,V,B,G,W,$,U,H,K,Y,J,X,Q,Z,tt,et;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,h=o.height,d=o.center,l=o.focusNode,c=o.unitRadius,f=o.nodeSize,g=o.nodeSpacing,y=o.strictRadial,m=o.preventOverlap,w=o.maxPreventOverlapIteration,x=o.sortBy,E=o.linkDistance,b=void 0===E?50:E,M=o.sortStrength,S=void 0===M?10:M,k=o.maxIteration,R=void 0===k?1e3:k,z=e.getAllNodes(),I=e.getAllEdges(),D=i||"undefined"==typeof window?i:window.innerWidth,P=h||"undefined"==typeof window?h:window.innerHeight,T=d||[D/2,P/2],!(null==z?void 0:z.length)||1===z.length)return[2,_(e,t,T)];if(C=z[0],O(l)){for(q=0;q<z.length;q++)if(z[q].id===l){C=z[q];break}}else C=l||z[0];return L=Dn(z,C.id),j=v({nodes:z,edges:I},!1),F=p(j),V=Pn(F,L),On(F,L,V+1),B=F[L],G=D-T[0]>T[0]?T[0]:D-T[0],W=P-T[1]>T[1]?T[1]:P-T[1],0===G&&(G=D/2),0===W&&(W=P/2),$=Math.min(G,W),U=Math.max.apply(Math,u(B)),H=[],K=c||$/U,B.forEach((function(t,e){H[e]=t*K})),Y=zn(z,F,b,H,K,x,S),J=In(Y),X=function(t,e,r){try{var n=vn.mul(vn.pow(e,2),-.5),o=n.mean("row"),i=n.mean("column"),a=n.mean();n.add(a).subRowVector(o).subColumnVector(i);var s=new wn(n),u=vn.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((function(e){return vn.mul([e],[u]).toJSON()[0].splice(0,t)}))}catch(t){for(var h=[],d=0;d<e.length;d++){var l=Math.random()*r,c=Math.random()*r;h.push([l,c])}return h}}(b,Y,b),Q=X.map((function(t){var e=s(t,2),r=e[0],n=e[1];return{x:(isNaN(r)?Math.random()*b:r)-X[L][0],y:(isNaN(n)?Math.random()*b:n)-X[L][1]}})),this.run(R,Q,J,Y,H,L),m&&(Z=A(f,g),tt={nodes:z,nodeSizeFunc:Z,positions:Q,radii:H,height:P,width:D,strictRadial:Boolean(y),focusIdx:L,iterations:w||200,k:Q.length/4.5},Q=function(t,e){for(var r=n(n({},Sn),e),o=r.positions,i=r.iterations,a=r.width,s=r.k,u=r.speed,h=void 0===u?100:u,d=r.strictRadial,l=r.focusIdx,c=r.radii,f=void 0===c?[]:c,g=r.nodeSizeFunc,p=t.getAllNodes(),v=[],y=a/10,m=0;m<i;m++)o.forEach((function(t,e){v[e]={x:0,y:0}})),kn(p,o,v,s,f,g),An(o,v,h,d,l,y,a,f);return o}(e,tt)),et=[],Q.forEach((function(t,e){var r=N(z[e]);r.data.x=t.x+T[0],r.data.y=t.y+T[1],et.push(r)})),t&&et.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:et,edges:I}]}))}))},t.prototype.run=function(t,e,r,n,o,i){for(var a=0;a<=t;a++){var s=a/t;this.oneIteration(s,e,o,n,r,i)}},t.prototype.oneIteration=function(t,e,r,n,o,i){var a=1-t;e.forEach((function(s,u){var h=y(s,{x:0,y:0}),d=0===h?0:1/h;if(u!==i){var l=0,c=0,f=0;e.forEach((function(t,e){if(u!==e){var r=y(s,t),i=0===r?0:1/r,a=n[e][u];f+=o[u][e],l+=o[u][e]*(t.x+a*(s.x-t.x)*i),c+=o[u][e]*(t.y+a*(s.y-t.y)*i)}}));var g=0===r[u]?0:1/r[u];f*=a,f+=t*g*g,l*=a,l+=t*g*s.x*d,s.x=l/f,c*=a,c+=t*g*s.y*d,s.y=c/f}}))},t}(),zn=function(t,e,r,n,o,i,a){if(!t)return[];var s=[];if(e){var u={};e.forEach((function(e,h){var d=[];e.forEach((function(e,s){var l,c;if(h===s)d.push(0);else if(n[h]===n[s])if("data"===i)d.push(e*(Math.abs(h-s)*a)/(n[h]/o));else if(i){var f=void 0,g=void 0;if(u[t[h].id])f=u[t[h].id];else{var p=("id"===i?t[h].id:null===(l=t[h].data)||void 0===l?void 0:l[i])||0;f=O(p)?p.charCodeAt(0):p,u[t[h].id]=f}u[t[s].id]?g=u[t[s].id]:(p=("id"===i?t[s].id:null===(c=t[s].data)||void 0===c?void 0:c[i])||0,g=O(p)?p.charCodeAt(0):p,u[t[s].id]=g),d.push(e*(Math.abs(f-g)*a)/(n[h]/o))}else d.push(e*r/(n[h]/o));else{var v=(r+o)/2;d.push(e*v)}})),s.push(d)}))}return s},In=function(t){for(var e=t.length,r=t[0].length,n=[],o=0;o<e;o++){for(var i=[],a=0;a<r;a++)0!==t[o][a]?i.push(1/(t[o][a]*t[o][a])):i.push(0);n.push(i)}return n},Dn=function(t,e){var r=-1;return t.forEach((function(t,n){t.id===e&&(r=n)})),Math.max(r,0)},On=function(t,e,r){for(var n=t.length,o=0;o<n;o++)if(t[e][o]===1/0){t[e][o]=r,t[o][e]=r;for(var i=0;i<n;i++)t[o][i]!==1/0&&t[e][i]===1/0&&(t[e][i]=r+t[o][i],t[i][e]=r+t[o][i])}for(o=0;o<n;o++)if(o!==e)for(i=0;i<n;i++)if(t[o][i]===1/0){var a=Math.abs(t[e][o]-t[e][i]);a=0===a?1:a,t[o][i]=a}},Pn=function(t,e){for(var r=0,n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r},Tn={center:[0,0],width:300,height:300},Cn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="random",this.options=n(n({},Tn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRandomLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRandomLayout(!0,t,e),[2]}))}))},t.prototype.genericRandomLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,h=e.getAllNodes(),d=s||"undefined"==typeof window?s:window.innerWidth,l=u||"undefined"==typeof window?u:window.innerHeight,c=i||[d/2,l/2],f=[],h&&h.forEach((function(t){f.push({id:t.id,data:{x:.9*(Math.random()-.5)*d+c[0],y:.9*(Math.random()-.5)*l+c[1]}})})),t&&f.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:f,edges:e.getAllEdges()}]}))}))},t}(),qn={circular:z,concentric:T,mds:Nn,random:Cn,grid:Wr,radial:Rn,force:Rr,d3force:Tt,fruchterman:Br,forceAtlas2:Fr,dagre:pr};function Ln(){var t;(null===(t=xn)||void 0===t?void 0:t.stop)&&xn.stop()}function jn(t,e){return i(this,void 0,void 0,(function(){var r,n,o,i,s,u,h,d,l;return a(this,(function(a){switch(a.label){case 0:if(r=t.layout,n=r.id,o=r.options,i=r.iterations,s=t.nodes,u=t.edges,h=new c({nodes:s,edges:u}),!(d=qn[n]))throw new Error("Unknown layout id: "+n);return[4,(xn=new d(o)).execute(h)];case 1:return l=a.sent(),!!(f=xn).tick&&!!f.stop&&(xn.stop(),l=xn.tick(i)),[2,[l,e]]}var f}))}))}addEventListener("message",(function(t){var r,n=t.data,o=n.type,i=n.method,a=n.id,s=n.params;"RPC"===o&&i&&((r=e[i])?Promise.resolve().then((function(){return r.apply(e,s)})):Promise.reject("No such method")).then((function(t){postMessage({type:"RPC",id:a,result:t})})).catch((function(t){var e={message:t};t.stack&&(e.message=t.message,e.stack=t.stack,e.name=t.name),postMessage({type:"RPC",id:a,error:e})}))})),postMessage({type:"RPC",method:"ready"});\n//# sourceMappingURL=8884498ddca05396fc34.worker.js.map'])),{name:"[fullhash].worker.js"});return URL.revokeObjectURL(URL.createObjectURL(new Blob(['var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{calculateLayout:()=>jn,stopLayout:()=>Ln});var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function o(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function i(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function a(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function u(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}Object.create,Object.create;const h=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[],i=this._events["*"]||[],a=function(n){for(var o=n.length,i=0;i<o;i++)if(n[i]){var a=n[i],s=a.callback;a.once&&(n.splice(i,1),0===n.length&&delete e._events[t],o--,i--),s.apply(e,r)}};a(o),a(i)},t.prototype.off=function(t,e){if(t)if(e){for(var r=this._events[t]||[],n=r.length,o=0;o<n;o++)r[o].callback===e&&(r.splice(o,1),n--,o--);0===r.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function d(t,e,r,n){for(;t.length;){const o=t.shift();if(r(o))return!0;e.add(o.id),n(o.id).forEach((r=>{e.has(r.id)||(e.add(r.id),t.push(r))}))}return!1}function l(t,e,r,n){if(r(t))return!0;e.add(t.id);for(const o of n(t.id))if(!e.has(o.id)&&l(o,e,r,n))return!0;return!1}class c extends h{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const r=e.find((e=>e.type===t.type&&e.id===t.id&&e.propertyName===t.propertyName));r?r.newValue=t.newValue:e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const r=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),r=this.bothEdgesMap.get(t);r?.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((e=>{e.childrenMap.get(t)?.forEach((t=>{e.parentMap.delete(t.id)})),e.parentMap.delete(t),e.childrenMap.delete(t)})),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){const n=this.getNode(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateNodeDataProperty(t,e,r)}))}))}updateNodeData(...t){const e=t[0],r=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:o})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),o.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),o=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),o.delete(e),i.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.source,o=e;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:o})}))}updateEdgeTarget(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.target,o=e;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:o})}))}updateEdgeDataProperty(t,e,r){const n=this.getEdge(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}updateEdgeData(...t){const e=t[0],r=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:o})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateEdgeDataProperty(t,e,r)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const r=[],n=Array.isArray(t)?t:[t];for(;n.length;){const t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach((t=>{t.children?.forEach((r=>{this.setParent(r.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const r=this.treeIndices.get(e).childrenMap.get(t);return Array.from(r||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const r=[];let n,o=this.getNode(t);for(;n=this.getParent(o.id,e);)r.push(n),o=n;return r}setParent(t,e,r){this.checkTreeExistence(r);const n=this.treeIndices.get(r),o=this.getNode(t),i=n.parentMap.get(t),a=this.getNode(e);n.parentMap.set(t,a),i&&n.childrenMap.get(i.id)?.delete(o);let s=n.childrenMap.get(a.id);s||(s=new Set,n.childrenMap.set(a.id,s)),s.add(o),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:i?.id,newParentId:a.id})}))}dfsTree(t,e,r){return l(this.getNode(t),new Set,e,(t=>this.getChildren(t,r)))}bfsTree(t,e,r){return d([this.getNode(t)],new Set,e,(t=>this.getChildren(t,r)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return d([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return l(this.getNode(t),new Set,e,n)}clone(){const t=this.getAllNodes().map((t=>({...t,data:{...t.data}}))),e=this.getAllEdges().map((t=>({...t,data:{...t.data}}))),r=new c({nodes:t,edges:e});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},n)=>{const o=new Map;t.forEach(((t,e)=>{o.set(e,r.getNode(t.id))}));const i=new Map;e.forEach(((t,e)=>{i.set(e,new Set(Array.from(t).map((t=>r.getNode(t.id)))))})),r.treeIndices.set(n,{parentMap:o,childrenMap:i})})),r}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var f=/-(\\w)/g,g=(function(t){return t.replace(f,(function(t,e){return e?e.toUpperCase():""}))},Object.create(null),Array.isArray),p=function(t){for(var e=[],r=t.length,n=0;n<r;n+=1){e[n]=[];for(var o=0;o<r;o+=1)n===o?e[n][o]=0:0!==t[n][o]&&t[n][o]?e[n][o]=t[n][o]:e[n][o]=1/0}for(var i=0;i<r;i+=1)for(n=0;n<r;n+=1)for(o=0;o<r;o+=1)e[n][o]>e[n][i]+e[i][o]&&(e[n][o]=e[n][i]+e[i][o]);return e},v=function(t,e){var r=t.nodes,n=t.edges,o=[],i={};if(!r)throw new Error("invalid nodes data!");return r&&r.forEach((function(t,e){i[t.id]=e,o.push([])})),null==n||n.forEach((function(t){var r=t.source,n=t.target,a=i[r],s=i[n];void 0!==a&&void 0!==s&&(o[a][s]=1,e||(o[s][a]=1))})),o},y=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},m={}.toString;const w=function(t,e){return m.call(t)==="[object "+e+"]"},x=function(t){return w(t,"Number")};var E=function(t){if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var e=[];return t.forEach((function(t){e.push(t)})),e.map((function(t){return E(t)}))}if("object"==typeof t){var r={};return Object.keys(t).forEach((function(e){r[e]=E(t[e])})),r}return t},N=function(t,e){var r=E(t);return r.data=r.data||{},e&&(x(r.data.x)||(r.data.x=Math.random()*e[0]),x(r.data.y)||(r.data.y=Math.random()*e[1])),r};const b=function(t){return"function"==typeof t},M=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function S(t,e){return b(e)?e:x(e)?function(){return e}:function(){return t}}function k(t,e,r){return void 0===r&&(r=!0),e||0===e?b(e)?e:x(e)?function(){return e}:g(e)?function(){if(r){var n=Math.max.apply(Math,u(e));return isNaN(n)?t:n}return e}:M(e)?function(){if(r){var n=Math.max(e.width,e.height);return isNaN(n)?t:n}return[e.width,e.height]}:function(){return t}:function(e){var r=(e.data||{}).size;return r?g(r)?r[0]>r[1]?r[0]:r[1]:M(r)?r.width>r.height?r.width:r.height:r:t}}var A=function(t,e){var r;return r=x(e)?function(){return e}:b(e)?e:function(){return 0},t?g(t)?function(e){return(t[0]>t[1]?t[0]:t[1])+r(e)}:function(e){return t+r(e)}:function(t){var e,n;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return Math.max(t.data.bboxSize[0],t.data.bboxSize[1])+r(t);if(null===(n=t.data)||void 0===n?void 0:n.size){if(g(t.data.size))return Math.max(t.data.size[0],t.data.size[1])+r(t);var o=t.data.size;return M(o)?(o.width>o.height?o.width:o.height)+r(t):o+r(t)}return 10+r(t)}},_=function(t,e,r){var o=t.getAllNodes(),i=t.getAllEdges();return(null==o?void 0:o.length)?1===o.length?(e&&t.mergeNodeData(o[0].id,{x:r[0],y:r[1]}),{nodes:[n(n({},o[0]),{data:n(n({},o[0].data),{x:r[0],y:r[1]})})],edges:i}):void 0:{nodes:[],edges:i}},R={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},z=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="circular",this.options=n(n({},R),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericCircularLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericCircularLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericCircularLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,u,h,d,l,c,f,g,p,v,y,m,w,x,E,b,M,A,R,z,O,P,T,C,q,L,j,F,V,B,G,W,$,U;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,u=o.height,h=o.center,d=o.divisions,l=o.startAngle,c=void 0===l?0:l,f=o.endAngle,g=void 0===f?2*Math.PI:f,p=o.angleRatio,v=o.ordering,y=o.clockwise,m=o.nodeSpacing,w=o.nodeSize,x=e.getAllNodes(),E=e.getAllEdges(),b=s(D(i,u,h),3),M=b[0],A=b[1],R=b[2],!(z=null==x?void 0:x.length)||1===z)return[2,_(e,t,R)];for(O=(g-c)/z,P=o.radius,T=o.startRadius,C=o.endRadius,m?(q=S(10,m),L=k(10,w),j=-1/0,x.forEach((function(t){var e=L(t);j<e&&(j=e)})),F=0,x.forEach((function(t,e){F+=0===e?j||10:(q(t)||0)+(j||10)})),P=F/(2*Math.PI)):P||T||C?!T&&C?T=C:T&&!C&&(C=T):P=Math.min(A,M)/2,V=O*p,B=[],B="topology"===v?I(e,x):"topology-directed"===v?I(e,x,!0):"degree"===v?function(t,e){var r=[];return e.forEach((function(t,e){r.push(N(t))})),r.sort((function(e,r){return t.getDegree(e.id,"both")-t.getDegree(r.id,"both")})),r}(e,x):x.map((function(t){return N(t)})),G=Math.ceil(z/d),W=0;W<z;++W)($=P)||null===T||null===C||($=T+W*(C-T)/(z-1)),$||($=10+100*W/(z-1)),U=c+W%G*V+2*Math.PI/d*Math.floor(W/G),y||(U=g-W%G*V-2*Math.PI/d*Math.floor(W/G)),B[W].data.x=R[0]+Math.cos(U)*$,B[W].data.y=R[1]+Math.sin(U)*$;return t&&B.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:B,edges:E}]}))}))},t}(),I=function(t,e,r){void 0===r&&(r=!1);var n=[N(e[0])],o={},i=e.length;o[e[0].id]=!0;var a=0;return e.forEach((function(s,u){if(0!==u)if(u!==i-1&&t.getDegree(s.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(n[a].id,s.id)||o[s.id]){for(var h=r?t.getSuccessors(n[a].id):t.getNeighbors(n[a].id),d=!1,l=0;l<h.length;l++){var c=h[l];if(t.getDegree(c.id)===t.getDegree(s.id)&&!o[c.id]){n.push(N(c)),o[c.id]=!0,d=!0;break}}for(var f=0;!d&&(o[e[f].id]||(n.push(N(e[f])),o[e[f].id]=!0,d=!0),++f!==i););}else n.push(N(s)),o[s.id]=!0,a++})),n},D=function(t,e,r){var n=t,o=e,i=r;return n||"undefined"==typeof window||(n=window.innerWidth),o||"undefined"==typeof window||(o=window.innerHeight),i||(i=[n/2,o/2]),[n,o,i]};const O=function(t){return w(t,"String")};var P={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},T=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="concentric",this.options=n(n({},P),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericConcentricLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericConcentricLayout(!0,t,e),[2]}))}))},t.prototype.genericConcentricLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,p,v,y,m,w,E,S,k,A,R,z,I,D,P,T,C,q,L,j,F,V,B,G,W,$,U,H,K,Y;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,h=o.sortBy,d=o.maxLevelDiff,l=o.sweep,c=o.clockwise,f=o.equidistant,p=o.preventOverlap,v=o.startAngle,y=void 0===v?1.5*Math.PI:v,m=o.nodeSize,w=o.nodeSpacing,E=e.getAllNodes(),S=e.getAllEdges(),k=s||"undefined"==typeof window?s:window.innerWidth,A=u||"undefined"==typeof window?u:window.innerHeight,R=i||[k/2,A/2],!(null==E?void 0:E.length)||1===E.length)return[2,_(e,t,R)];if(z=[],D=0,I=g(m)?Math.max(m[0],m[1]):m,g(w)?D=Math.max(w[0],w[1]):x(w)&&(D=w),E.forEach((function(t){var e=N(t);z.push(e);var r=I,n=e.data;g(n.size)?r=Math.max(n.size[0],n.size[1]):x(n.size)?r=n.size:M(n.size)&&(r=Math.max(n.size.width,n.size.height)),I=Math.max(I,r),b(w)&&(D=Math.max(w(t),D))})),P={},z.forEach((function(t,e){P[t.id]=e})),O(T=h)&&void 0!==z[0].data[T]||(T="degree"),"degree"===T?z.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):z.sort((function(t,e){return e.data[T]-t.data[T]})),C=z[0],q=(d||("degree"===T?e.getDegree(C.id,"both"):C.data[T]))/4,j=(L=[{nodes:[]}])[0],z.forEach((function(t){if(j.nodes.length>0){var r="degree"===T?Math.abs(e.getDegree(j.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(j.nodes[0].data[T]-t.data[T]);q&&r>=q&&(j={nodes:[]},L.push(j))}j.nodes.push(t)})),F=I+D,p||(V=L.length>0&&L[0].nodes.length>1,B=Math.min(k,A)/2-F,G=B/(L.length+(V?1:0)),F=Math.min(F,G)),W=0,L.forEach((function(t){var e=void 0===l?2*Math.PI-2*Math.PI/t.nodes.length:l;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&p){var r=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),o=Math.sqrt(F*F/(r*r+n*n));W=Math.max(o,W)}t.r=W,W+=F})),f){for($=0,U=0,H=0;H<L.length;H++)K=L[H],Y=(K.r||0)-U,$=Math.max($,Y);U=0,L.forEach((function(t,e){0===e&&(U=t.r||0),t.r=U,U+=$}))}return L.forEach((function(t){var e=t.dTheta||0,r=t.r||0;t.nodes.forEach((function(t,n){var o=y+(c?1:-1)*e*n;t.data.x=R[0]+r*Math.cos(o),t.data.y=R[1]+r*Math.sin(o)}))})),t&&z.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:z,edges:S}]}))}))},t}();function C(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i,a,s,u,h,d,l,c,f=t._root,g={data:n},p=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!f)return t._root=g,t;for(;f.length;)if((h=e>=(i=(p+y)/2))?p=i:y=i,(d=r>=(a=(v+m)/2))?v=a:m=a,o=f,!(f=f[l=d<<1|h]))return o[l]=g,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&r===u)return g.next=f,o?o[l]=g:t._root=g,t;do{o=o?o[l]=new Array(4):t._root=new Array(4),(h=e>=(i=(p+y)/2))?p=i:y=i,(d=r>=(a=(v+m)/2))?v=a:m=a}while((l=d<<1|h)==(c=(u>=a)<<1|s>=i));return o[c]=f,o[l]=g,t}function q(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function L(t){return t[0]}function j(t){return t[1]}function F(t,e,r){var n=new V(null==e?L:e,null==r?j:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function V(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function B(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var G=F.prototype=V.prototype;function W(t){return function(){return t}}function $(t){return 1e-6*(t()-.5)}G.copy=function(){var t,e,r=new V(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=B(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var o=0;o<4;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(4)}):n.target[o]=B(e));return r},G.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return C(this.cover(e,r),e,r,t)},G.addAll=function(t){var e,r,n,o,i=t.length,a=new Array(i),s=new Array(i),u=1/0,h=1/0,d=-1/0,l=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(a[r]=n,s[r]=o,n<u&&(u=n),n>d&&(d=n),o<h&&(h=o),o>l&&(l=o));if(u>d||h>l)return this;for(this.cover(u,h).cover(d,l),r=0;r<i;++r)C(this,a[r],s[r],t[r]);return this},G.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var a,s,u=o-r||1,h=this._root;r>t||t>=o||n>e||e>=i;)switch(s=(e<n)<<1|t<r,(a=new Array(4))[s]=h,h=a,u*=2,s){case 0:o=r+u,i=n+u;break;case 1:r=o-u,i=n+u;break;case 2:o=r+u,n=i-u;break;case 3:r=o-u,n=i-u}this._root&&this._root.length&&(this._root=h)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this},G.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},G.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},G.find=function(t,e,r){var n,o,i,a,s,u,h,d=this._x0,l=this._y0,c=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new q(p,d,l,c,f)),null==r?r=1/0:(d=t-r,l=e-r,c=t+r,f=e+r,r*=r);u=g.pop();)if(!(!(p=u.node)||(o=u.x0)>c||(i=u.y0)>f||(a=u.x1)<d||(s=u.y1)<l))if(p.length){var v=(o+a)/2,y=(i+s)/2;g.push(new q(p[3],v,y,a,s),new q(p[2],o,y,v,s),new q(p[1],v,i,a,y),new q(p[0],o,i,v,y)),(h=(e>=y)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-h],g[g.length-1-h]=u)}else{var m=t-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),x=m*m+w*w;if(x<r){var E=Math.sqrt(r=x);d=t-E,l=e-E,c=t+E,f=e+E,n=p.data}}return n},G.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,r,n,o,i,a,s,u,h,d,l,c,f=this._root,g=this._x0,p=this._y0,v=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((h=i>=(s=(g+v)/2))?g=s:v=s,(d=a>=(u=(p+y)/2))?p=u:y=u,e=f,!(f=f[l=d<<1|h]))return this;if(!f.length)break;(e[l+1&3]||e[l+2&3]||e[l+3&3])&&(r=e,c=l)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(o=f.next)&&delete f.next,n?(o?n.next=o:delete n.next,this):e?(o?e[l]=o:delete e[l],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[c]=f:this._root=f),this):(this._root=o,this)},G.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},G.root=function(){return this._root},G.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},G.visit=function(t){var e,r,n,o,i,a,s=[],u=this._root;for(u&&s.push(new q(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,n=e.x0,o=e.y0,i=e.x1,a=e.y1)&&u.length){var h=(n+i)/2,d=(o+a)/2;(r=u[3])&&s.push(new q(r,h,d,i,a)),(r=u[2])&&s.push(new q(r,n,d,h,a)),(r=u[1])&&s.push(new q(r,h,o,i,d)),(r=u[0])&&s.push(new q(r,n,o,h,d))}return this},G.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new q(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.x1,h=e.y1,d=(a+u)/2,l=(s+h)/2;(i=o[0])&&r.push(new q(i,a,s,d,l)),(i=o[1])&&r.push(new q(i,d,s,u,l)),(i=o[2])&&r.push(new q(i,a,l,d,h)),(i=o[3])&&r.push(new q(i,d,l,u,h))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},G.x=function(t){return arguments.length?(this._x=t,this):this._x},G.y=function(t){return arguments.length?(this._y=t,this):this._y};var U={value:()=>{}};function H(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new K(n)}function K(t){this._=t}function Y(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function J(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=U,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}K.prototype=H.prototype={constructor:K,on:function(t,e){var r,n,o=this._,i=(n=o,(t+"").trim().split(/^|\\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)o[r]=J(o[r],t.name,e);else if(null==e)for(r in o)o[r]=J(o[r],t.name,null);return this}for(;++a<s;)if((r=(t=i[a]).type)&&(r=Y(o[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new K(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};const X=H;var Q,Z,tt=0,et=0,rt=0,nt=1e3,ot=0,it=0,at=0,st="object"==typeof performance&&performance.now?performance:Date,ut="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ht(){return it||(ut(dt),it=st.now()+at)}function dt(){it=0}function lt(){this._call=this._time=this._next=null}function ct(t,e,r){var n=new lt;return n.restart(t,e,r),n}function ft(){it=(ot=st.now())+at,tt=et=0;try{!function(){ht(),++tt;for(var t,e=Q;e;)(t=it-e._time)>=0&&e._call.call(void 0,t),e=e._next;--tt}()}finally{tt=0,function(){for(var t,e,r=Q,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:Q=e);Z=t,pt(n)}(),it=0}}function gt(){var t=st.now(),e=t-ot;e>nt&&(at-=e,ot=t)}function pt(t){tt||(et&&(et=clearTimeout(et)),t-it>24?(t<1/0&&(et=setTimeout(ft,t-st.now()-at)),rt&&(rt=clearInterval(rt))):(rt||(ot=st.now(),rt=setInterval(gt,nt)),tt=1,ut(ft)))}lt.prototype=ct.prototype={constructor:lt,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?ht():+r)+(null==e?0:+e),this._next||Z===this||(Z?Z._next=this:Q=this,Z=this),this._call=t,this._time=r,pt()},stop:function(){this._call&&(this._call=null,this._time=1/0,pt())}};const vt=1664525,yt=1013904223,mt=4294967296;function wt(t){return t.x}function xt(t){return t.y}var Et=10,Nt=Math.PI*(3-Math.sqrt(5));function bt(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,a=.6,s=new Map,u=ct(l),h=X("tick","end"),d=function(){let t=1;return()=>(t=(vt*t+yt)%mt)/mt}();function l(){c(),h.call("tick",e),r<n&&(u.stop(),h.call("end",e))}function c(n){var u,h,d=t.length;void 0===n&&(n=1);for(var l=0;l<n;++l)for(r+=(i-r)*o,s.forEach((function(t){t(r)})),u=0;u<d;++u)null==(h=t[u]).fx?h.x+=h.vx*=a:(h.x=h.fx,h.vx=0),null==h.fy?h.y+=h.vy*=a:(h.y=h.fy,h.vy=0);return e}function f(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var o=Et*Math.sqrt(.5+r),i=r*Nt;e.x=o*Math.cos(i),e.y=o*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,d),e}return null==t&&(t=[]),f(),e={tick:c,restart:function(){return u.restart(l),e},stop:function(){return u.stop(),e},nodes:function(r){return arguments.length?(t=r,f(),s.forEach(g),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(d=t,s.forEach(g),e):d},force:function(t,r){return arguments.length>1?(null==r?s.delete(t):s.set(t,g(r)),e):s.get(t)},find:function(e,r,n){var o,i,a,s,u,h=0,d=t.length;for(null==n?n=1/0:n*=n,h=0;h<d;++h)(a=(o=e-(s=t[h]).x)*o+(i=r-s.y)*i)<n&&(u=s,n=a);return u},on:function(t,r){return arguments.length>1?(h.on(t,r),e):h.on(t)}}}function Mt(){var t,e,r,n,o,i=W(-30),a=1,s=1/0,u=.81;function h(r){var o,i=t.length,a=F(t,wt,xt).visitAfter(l);for(n=r,o=0;o<i;++o)e=t[o],a.visit(c)}function d(){if(t){var e,r,n=t.length;for(o=new Array(n),e=0;e<n;++e)r=t[e],o[r.index]=+i(r,e,t)}}function l(t){var e,r,n,i,a,s=0,u=0;if(t.length){for(n=i=a=0;a<4;++a)(e=t[a])&&(r=Math.abs(e.value))&&(s+=e.value,u+=r,n+=r*e.x,i+=r*e.y);t.x=n/u,t.y=i/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=o[e.data.index]}while(e=e.next)}t.value=s}function c(t,i,h,d){if(!t.value)return!0;var l=t.x-e.x,c=t.y-e.y,f=d-i,g=l*l+c*c;if(f*f/u<g)return g<s&&(0===l&&(g+=(l=$(r))*l),0===c&&(g+=(c=$(r))*c),g<a&&(g=Math.sqrt(a*g)),e.vx+=l*t.value*n/g,e.vy+=c*t.value*n/g),!0;if(!(t.length||g>=s)){(t.data!==e||t.next)&&(0===l&&(g+=(l=$(r))*l),0===c&&(g+=(c=$(r))*c),g<a&&(g=Math.sqrt(a*g)));do{t.data!==e&&(f=o[t.data.index]*n/g,e.vx+=l*f,e.vy+=c*f)}while(t=t.next)}}return h.initialize=function(e,n){t=e,r=n,d()},h.strength=function(t){return arguments.length?(i="function"==typeof t?t:W(+t),d(),h):i},h.distanceMin=function(t){return arguments.length?(a=t*t,h):Math.sqrt(a)},h.distanceMax=function(t){return arguments.length?(s=t*t,h):Math.sqrt(s)},h.theta=function(t){return arguments.length?(u=t*t,h):Math.sqrt(u)},h}function St(t){return t.index}function kt(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function At(t){var e,r,n,o,i,a,s=St,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},h=W(30),d=1;function l(n){for(var o=0,s=t.length;o<d;++o)for(var u,h,l,c,f,g,p,v=0;v<s;++v)h=(u=t[v]).source,c=(l=u.target).x+l.vx-h.x-h.vx||$(a),f=l.y+l.vy-h.y-h.vy||$(a),c*=g=((g=Math.sqrt(c*c+f*f))-r[v])/g*n*e[v],f*=g,l.vx-=c*(p=i[v]),l.vy-=f*p,h.vx+=c*(p=1-p),h.vy+=f*p}function c(){if(n){var a,u,h=n.length,d=t.length,l=new Map(n.map(((t,e)=>[s(t,e,n),t])));for(a=0,o=new Array(h);a<d;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=kt(l,u.source)),"object"!=typeof u.target&&(u.target=kt(l,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(a=0,i=new Array(d);a<d;++a)u=t[a],i[a]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);e=new Array(d),f(),r=new Array(d),g()}}function f(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+u(t[r],r,t)}function g(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+h(t[e],e,t)}return null==t&&(t=[]),l.initialize=function(t,e){n=t,a=e,c()},l.links=function(e){return arguments.length?(t=e,c(),l):t},l.id=function(t){return arguments.length?(s=t,l):s},l.iterations=function(t){return arguments.length?(d=+t,l):d},l.strength=function(t){return arguments.length?(u="function"==typeof t?t:W(+t),f(),l):u},l.distance=function(t){return arguments.length?(h="function"==typeof t?t:W(+t),g(),l):h},l}function _t(t){return t.x+t.vx}function Rt(t){return t.y+t.vy}function zt(t){var e,r,n,o=1,i=1;function a(){for(var t,a,u,h,d,l,c,f=e.length,g=0;g<i;++g)for(a=F(e,_t,Rt).visitAfter(s),t=0;t<f;++t)u=e[t],l=r[u.index],c=l*l,h=u.x+u.vx,d=u.y+u.vy,a.visit(p);function p(t,e,r,i,a){var s=t.data,f=t.r,g=l+f;if(!s)return e>h+g||i<h-g||r>d+g||a<d-g;if(s.index>u.index){var p=h-s.x-s.vx,v=d-s.y-s.vy,y=p*p+v*v;y<g*g&&(0===p&&(y+=(p=$(n))*p),0===v&&(y+=(v=$(n))*v),y=(g-(y=Math.sqrt(y)))/y*o,u.vx+=(p*=y)*(g=(f*=f)/(c+f)),u.vy+=(v*=y)*g,s.vx-=p*(g=1-g),s.vy-=v*g)}}}function s(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var n,o,i=e.length;for(r=new Array(i),n=0;n<i;++n)o=e[n],r[o.index]=+t(o,n,e)}}return"function"!=typeof t&&(t=W(null==t?1:+t)),a.initialize=function(t,r){e=t,n=r,u()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(o=+t,a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:W(+e),u(),a):t},a}function It(t){var e,r,n,o=W(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=W(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:W(+t),a(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:W(+e),a(),i):t},i}function Dt(t){var e,r,n,o=W(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=W(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:W(+t),a(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:W(+e),a(),i):t},i}function Ot(){function t(t){return function(){return t}}var e,r=function(t){return t.cluster},n=t(1),o=t(-1),i=t(100),a=t(.1),u=[0,0],h=[],d={},l=[],c=100,f=100,g={none:{x:0,y:0}},p=[],v="force",y=!0,m=.1;function w(t){if(!y)return w;e.tick(),E();for(var n=0,o=h.length,i=void 0,a=t*m;n<o;++n)(i=h[n]).vx+=(g[r(i)].x-i.x)*a,i.vy+=(g[r(i)].y-i.y)*a}function x(){h&&function(){if(h&&h.length){if(void 0===r(h[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy(\'clusterAttr\') before calling .links()");var t,u,g,v,y,m=(t=[],u=[],g={},{},y=[],v=function(t){var e={};return t.forEach((function(t){var n=r(t);e[n]||(e[n]={count:0,sumforceNodeSize:0})})),t.forEach((function(t){var o=r(t),i=n(t),a=e[o];a.count=a.count+1,a.sumforceNodeSize=a.sumforceNodeSize+Math.PI*(i*i)*1.3,e[o]=a})),e}(h),y=function(t){var e={},n=[];return t.forEach((function(t){var n,o,i,a,s,u=(o=(n=t).source,i=n.target,(a=r(d[o]))<=(s=r(d[i]))?a+"~"+s:s+"~"+a),h=0;void 0!==e[u]&&(h=e[u]),h+=1,e[u]=h})),Object.entries(e).forEach((function(t){var e=s(t,2),r=e[0],o=e[1],i=r.split("~")[0],a=r.split("~")[1];void 0!==i&&void 0!==a&&n.push({source:i,target:a,count:o})})),n}(l),Object.keys(v).forEach((function(e,r){var n=v[e];t.push({id:e,size:n.count,r:Math.sqrt(n.sumforceNodeSize/Math.PI)}),g[e]=r})),y.forEach((function(t){var e=t.source,r=t.target,n=g[e],o=g[r];void 0!==n&&void 0!==o&&u.push({source:n,target:o,count:t.count})})),{nodes:t,links:u});e=bt(m.nodes).force("x",It(c).strength(.1)).force("y",Dt(f).strength(.1)).force("collide",zt((function(t){return t.r})).iterations(4)).force("charge",Mt().strength(o)).force("links",At(m.nodes.length?m.links:[]).distance(i).strength(a)),p=e.nodes(),E()}}()}function E(){return g={none:{x:0,y:0}},p.forEach((function(t){g[t.id]={x:t.x-u[0],y:t.y-u[1]}})),g}return w.initialize=function(t){h=t,x()},w.template=function(t){return arguments.length?(v=t,x(),w):v},w.groupBy=function(t){return arguments.length?"string"==typeof t?(r=function(e){return e[t]},w):(r=t,w):r},w.enableGrouping=function(t){return arguments.length?(y=t,w):y},w.strength=function(t){return arguments.length?(m=t,w):m},w.centerX=function(t){return arguments.length?(c=t,w):c},w.centerY=function(t){return arguments.length?(f=t,w):f},w.nodes=function(t){return arguments.length?(function(t){d={},t.forEach((function(t){d[t.id]=t}))}(t||[]),h=t||[],w):h},w.links=function(t){return arguments.length?(l=t||[],x(),w):l},w.forceNodeSize=function(e){return arguments.length?(n="function"==typeof e?e:t(+e),x(),w):n},w.nodeSize=w.forceNodeSize,w.forceCharge=function(e){return arguments.length?(o="function"==typeof e?e:t(+e),x(),w):o},w.forceLinkDistance=function(e){return arguments.length?(i="function"==typeof e?e:t(+e),x(),w):i},w.forceLinkStrength=function(e){return arguments.length?(a="function"==typeof e?e:t(+e),x(),w):a},w.offset=function(t){return arguments.length?(u=t,w):u},w.getFocis=E,w}var Pt={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},Tt=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="d3force",this.options=n(n({},Pt),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){var t;null===(t=this.forceSimulation)||void 0===t||t.stop()},t.prototype.tick=function(t){var e=this;void 0===t&&(t=1),this.forceSimulation.tick(t);var r={nodes:Ct(this.lastLayoutNodes),edges:qt(this.lastLayoutEdges)};return this.lastAssign&&r.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,g,p,v,y,m,w,x,E,b,M,S,k,A,_,R,z,I,D=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=i.map((function(t){var e,r;return n(n({},N(t)),{x:null===(e=t.data)||void 0===e?void 0:e.x,y:null===(r=t.data)||void 0===r?void 0:r.y})})),h=s.map((function(t){return N(t)})),this.lastLayoutNodes=u,this.lastLayoutEdges=h,this.lastAssign=t,this.lastGraph=e,d=o.alphaMin,l=o.alphaDecay,c=o.alpha,f=o.nodeStrength,g=o.edgeStrength,p=o.linkDistance,v=o.clustering,y=o.clusterFociStrength,m=o.clusterEdgeDistance,w=o.clusterEdgeStrength,x=o.clusterNodeStrength,E=o.clusterNodeSize,b=o.collideStrength,M=void 0===b?1:b,S=o.center,k=void 0===S?[0,0]:S,A=o.preventOverlap,_=o.nodeSize,R=o.nodeSpacing,z=o.onTick,I=o.forceSimulation,[2,new Promise((function(r){if(I){v&&((i=Ot()).nodes(u),i.links(h)),I.nodes(u),h&&(s=At().id((function(t){return t.id})).links(h),g&&s.strength(g),p&&s.distance(p),I.force("link",s)),A&&D.overlapProcess(I,{nodeSize:_,nodeSpacing:R,collideStrength:M}),I.alpha(c).restart();var n=Ct(u),o=qt(h);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:o})}else try{var i,a=Mt();if(f&&a.strength(f),I=bt().nodes(u),v&&((i=Ot()).centerX(k[0]).centerY(k[1]).template("force").strength(y),h&&i.links(h),u&&i.nodes(u),i.forceLinkDistance(m).forceLinkStrength(w).forceCharge(x).forceNodeSize(E),I.force("group",i)),I.force("center",function(t,e){var r,n=1;function o(){var o,i,a=r.length,s=0,u=0;for(o=0;o<a;++o)s+=(i=r[o]).x,u+=i.y;for(s=(s/a-t)*n,u=(u/a-e)*n,o=0;o<a;++o)(i=r[o]).x-=s,i.y-=u}return null==t&&(t=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(n=+t,o):n},o}(k[0],k[1])).force("charge",a).alpha(c).alphaDecay(l).alphaMin(d),A&&D.overlapProcess(I,{nodeSize:_,nodeSpacing:R,collideStrength:M}),h){var s=At().id((function(t){return t.id})).links(h);g&&s.strength(g),p&&s.distance(p),I.force("link",s)}I.on("tick",(function(){var r=Ct(u);null==z||z({nodes:r,edges:qt(h)}),t&&r.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}))})).on("end",(function(){var n=Ct(u);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:qt(h)})}))}catch(t){console.warn(t)}D.forceSimulation=I}))]}))}))},t.prototype.overlapProcess=function(t,e){var r,n,o=e.nodeSize,i=e.nodeSpacing,a=e.collideStrength;if(n=x(i)?function(){return i}:b(i)?i:function(){return 0},o)if(b(o))r=function(t){return o(t)+n(t)};else if(g(o)){var s=(o[0]>o[1]?o[0]:o[1])/2;r=function(t){return s+n(t)}}else if(x(o)){var u=o/2;r=function(t){return u+n(t)}}else r=function(){return 10};else r=function(t){return t.size?g(t.size)?(t.size[0]>t.size[1]?t.size[0]:t.size[1])/2+n(t):M(t.size)?(t.size.width>t.size.height?t.size.width:t.size.height)/2+n(t):t.size/2+n(t):10+n(t)};t.force("collisionForce",zt(r).strength(a))},t}(),Ct=function(t){return t.map((function(t){var e=t.x,r=t.y,i=o(t,["x","y"]);return n(n({},i),{data:n(n({},i.data),{x:e,y:r})})}))},qt=function(t){return t.map((function(t){var e=t.source,r=t.target,i=o(t,["source","target"]);return n(n({},i),{source:e.id,target:r.id})}))};var Lt=function(t,e){if("next"!==t&&"prev"!==t)return e},jt=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(function(){function t(){var t={};t.prev=t,t.next=t.prev,this.shortcut=t}return t.prototype.dequeue=function(){var t=this.shortcut,e=t.prev;if(e&&e!==t)return jt(e),e},t.prototype.enqueue=function(t){var e=this.shortcut;t.prev&&t.next&&jt(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e},t.prototype.toString=function(){for(var t=[],e=this.shortcut,r=e.prev;r!==e;)t.push(JSON.stringify(r,Lt)),r=null==r?void 0:r.prev;return"["+t.join(", ")+"]"},t}()),Vt=function(){return 1},Bt=function(t,e,r,o,i){var a,s,u=[];return t.hasNode(o.v)&&(null===(a=t.getRelatedEdges(o.v,"in"))||void 0===a||a.forEach((function(o){var a=o.data.weight,s=t.getNode(o.source);i&&u.push({v:o.source,w:o.target,in:0,out:0}),void 0===s.data.out&&(s.data.out=0),s.data.out-=a,Gt(e,r,n({v:s.id},s.data))})),null===(s=t.getRelatedEdges(o.v,"out"))||void 0===s||s.forEach((function(o){var i=o.data.weight,a=o.target,s=t.getNode(a);void 0===s.data.in&&(s.data.in=0),s.data.in-=i,Gt(e,r,n({v:s.id},s.data))})),t.removeNode(o.v)),i?u:void 0},Gt=function(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},Wt=function(t,e){var r="greedy"===e?function(t,e){var r;if(t.getAllNodes().length<=1)return[];var o=function(t,e){var r=new c,o=0,i=0;t.getAllNodes().forEach((function(t){r.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((function(t){var a=r.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target})),s=(null==e?void 0:e(t))||1;a?r.updateEdgeData(null==a?void 0:a.id,n(n({},a.data),{weight:a.data.weight+s})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:s}}),i=Math.max(i,r.getNode(t.source).data.out+=s),o=Math.max(o,r.getNode(t.target).data.in+=s)}));for(var a=[],s=i+o+3,u=0;u<s;u++)a.push(new Ft);var h=o+1;return r.getAllNodes().forEach((function(t){Gt(a,h,n({v:t.id},r.getNode(t.id).data))})),{buckets:a,zeroIdx:h,graph:r}}(t,function(t){return t.data.weight||1}||Vt);return null===(r=function(t,e,r){for(var n,o=[],i=e[e.length-1],a=e[0];t.getAllNodes().length;){for(;n=a.dequeue();)Bt(t,e,r,n);for(;n=i.dequeue();)Bt(t,e,r,n);if(t.getAllNodes().length)for(var s=e.length-2;s>0;--s)if(n=e[s].dequeue()){o=o.concat(Bt(t,e,r,n,!0));break}}return o}(o.graph,o.buckets,o.zeroIdx).map((function(e){return t.getRelatedEdges(e.v,"out").filter((function(t){return t.target===e.w}))})))||void 0===r?void 0:r.flat()}(t):$t(t);null==r||r.forEach((function(e){var r=e.data;t.removeEdge(e.id),r.forwardName=e.data.name,r.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:n({},r)})}))},$t=function(t){var e=[],r={},n={},o=function(i){n[i]||(n[i]=!0,r[i]=!0,t.getRelatedEdges(i,"out").forEach((function(t){r[t.target]?e.push(t):o(t.target)})),delete r[i])};return t.getAllNodes().forEach((function(t){return o(t.id)})),e},Ut=function(t,e,r,n){var o;do{o=""+n+Math.random()}while(t.hasNode(o));return r.dummy=e,t.addNode({id:o,data:r}),o},Ht=function(t){var e=new c;return t.getAllNodes().forEach((function(r){t.getChildren(r.id).length||e.addNode(n({},r))})),t.getAllEdges().forEach((function(t){e.addEdge(t)})),e},Kt=function(t,e){var r,n,o=Number(t.x),i=Number(t.y),a=Number(e.x)-o,s=Number(e.y)-i,u=Number(t.width)/2,h=Number(t.height)/2;return a||s?(Math.abs(s)*u>Math.abs(a)*h?(s<0&&(h=-h),r=h*a/s,n=h):(a<0&&(u=-u),r=u,n=u*s/a),{x:o+r,y:i+n}):{x:0,y:0}},Yt=function(t){for(var e=[],r=Xt(t)+1,n=0;n<r;n++)e.push([]);for(t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)})),n=0;n<r;n++)e[n]=e[n].sort((function(e,r){return n=t.getNode(e).data.order,o=t.getNode(r).data.order,Number(n)-Number(o);var n,o}));return e},Jt=function(t,e,r,n){var o={width:0,height:0};return x(r)&&x(n)&&(o.rank=r,o.order=n),Ut(t,"border",o,e)},Xt=function(t){var e;return t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)})),e||(e=0),e},Qt=function(t,e){return t.reduce((function(t,r){return e(t)>e(r)?r:t}))},Zt=function(t,e,r,n,o,i){n.includes(e.id)||(n.push(e.id),r||i.push(e.id),o(e.id).forEach((function(e){return Zt(t,e,r,n,o,i)})),r&&i.push(e.id))},te=function(t,e,r,n){var o=Array.isArray(e)?e:[e],i=function(e){return n?t.getSuccessors(e):t.getNeighbors(e)},a=[],s=[];return o.forEach((function(e){if(!t.hasNode(e.id))throw new Error("Graph does not have node: "+e);Zt(t,e,"post"===r,s,i,a)})),a},ee="edge-label",re=function(t){var e={},r=function(n){var o,i,a=t.getNode(n);return a?e[n]?a.data.rank:(e[n]=!0,null===(o=t.getRelatedEdges(n,"out"))||void 0===o||o.forEach((function(t){var e=r(t.target)-t.data.minlen;e&&(void 0===i||e<i)&&(i=e)})),i||(i=0),a.data.rank=i,i):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){return r(t.id)}))},ne=function(t,e){return t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen},oe=function(t,e){var r=function(n){e.getRelatedEdges(n,"both").forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ie=function(t,e){var r=function(n){var o;null===(o=e.getRelatedEdges(n,"both"))||void 0===o||o.forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||void 0===e.getNode(a).data.layer&&ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ae=function(t,e){return Qt(e.getAllEdges(),(function(r){return t.hasNode(r.source)!==t.hasNode(r.target)?ne(e,r):1/0}))},se=function(t,e,r){t.getAllNodes().forEach((function(t){var n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r}))},ue=function(t,e){var r=te(t,t.getAllNodes(),"post",!1);(r=r.slice(0,(null==r?void 0:r.length)-1)).forEach((function(r){he(t,e,r)}))},he=function(t,e,r){var n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find((function(t){return t.target===n||t.source===n})).data.cutvalue=de(t,e,r)},de=function(t,e,r){var n=t.getNode(r).data.parent,o=!0,i=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),a=0;return i||(o=!1,i=e.getRelatedEdges(n,"out").find((function(t){return t.target===r}))),a=i.data.weight,e.getRelatedEdges(r,"both").forEach((function(e){var i=e.source===r,s=i?e.target:e.source;if(s!==n){var u=i===o,h=e.data.weight;if(a+=u?h:-h,ye(t,r,s)){var d=t.getRelatedEdges(r,"both").find((function(t){return t.source===s||t.target===s})).data.cutvalue;a+=u?-d:d}}})),a},le=function(t,e){void 0===e&&(e=t.getAllNodes()[0].id),ce(t,{},1,e)},ce=function(t,e,r,n,o){var i,a=r,s=r,u=t.getNode(n);return e[n]=!0,null===(i=t.getNeighbors(n))||void 0===i||i.forEach((function(r){e[r.id]||(s=ce(t,e,s,r.id,n))})),u.data.low=a,u.data.lim=s++,o?u.data.parent=o:delete u.data.parent,s},fe=function(t){return t.getAllEdges().find((function(t){return t.data.cutvalue<0}))},ge=function(t,e,r){var n=r.source,o=r.target;e.getRelatedEdges(n,"out").find((function(t){return t.target===o}))||(n=r.target,o=r.source);var i=t.getNode(n),a=t.getNode(o),s=i,u=!1;i.data.lim>a.data.lim&&(s=a,u=!0);var h=e.getAllEdges().filter((function(e){return u===me(t.getNode(e.source),s)&&u!==me(t.getNode(e.target),s)}));return Qt(h,(function(t){return ne(e,t)}))},pe=function(t,e,r,n){var o=t.getRelatedEdges(r.source,"both").find((function(t){return t.source===r.target||t.target===r.target}));o&&t.removeEdge(o.id),t.addEdge({id:"e"+Math.random(),source:n.source,target:n.target,data:{}}),le(t),ue(t,e),ve(t,e)},ve=function(t,e){var r=t.getAllNodes().find((function(t){return!t.data.parent})),n=te(t,r,"pre",!1);(n=n.slice(1)).forEach((function(r){var n=t.getNode(r).data.parent,o=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),i=!1;!o&&e.hasNode(n)&&(o=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),i=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(i?null==o?void 0:o.data.minlen:-(null==o?void 0:o.data.minlen))}))},ye=function(t,e,r){return t.getRelatedEdges(e,"both").find((function(t){return t.source===r||t.target===r}))},me=function(t,e){return e.data.low<=t.data.lim&&t.data.lim<=e.data.lim},we=re,xe=function(t){!function(t){var e=function(t){var e=new c;return t.getAllNodes().forEach((function(t){e.addNode(n({},t))})),t.getAllEdges().forEach((function(t){var r=e.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target}));r?e.updateEdgeData(null==r?void 0:r.id,n(n({},r.data),{weight:r.data.weight+t.data.weight||0,minlen:Math.max(r.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e}(t);re(e);var r,o,i=function(t){var e,r,n=new c({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);oe(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r);return n}(e);for(le(i),ue(i,e);r=fe(i);)o=ge(i,e,r),pe(i,e,r,o)}(t)},Ee=function(t,e,r,n,o,i,a){var s=t.getChildren(a);if(null==s?void 0:s.length){var u=Jt(t,"_bt"),h=Jt(t,"_bb"),d=t.getNode(a);t.setParent(u,a),d.data.borderTop=u,t.setParent(h,a),d.data.borderBottom=h,null==s||s.forEach((function(s){Ee(t,e,r,n,o,i,s.id);var d=s.data.borderTop?s.data.borderTop:s.id,l=s.data.borderBottom?s.data.borderBottom:s.id,c=s.data.borderTop?n:2*n,f=d!==l?1:o-i[a]+1;t.addEdge({id:"e"+Math.random(),source:u,target:d,data:{minlen:f,weight:c,nestingEdge:!0}}),t.addEdge({id:"e"+Math.random(),source:l,target:h,data:{minlen:f,weight:c,nestingEdge:!0}})})),t.getParent(a)||t.addEdge({id:"e"+Math.random(),source:e,target:u,data:{weight:0,minlen:o+i[a]}})}else a!==e&&t.addEdge({id:"e"+Math.random(),source:e,target:a,data:{weight:0,minlen:r}})},Ne=function(t,e,r,n,o,i){var a={rank:i,borderType:e,width:0,height:0},s=o.data[e][i-1],u=Ut(t,"border",a,r);o.data[e][i]=u,t.setParent(u,n),s&&t.addEdge({id:"e"+Math.random(),source:s,target:u,data:{weight:1}})},be=function(t){t.getAllNodes().forEach((function(t){Me(t)})),t.getAllEdges().forEach((function(t){Me(t)}))},Me=function(t){var e=t.data.width;t.data.width=t.data.height,t.data.height=e},Se=function(t){(null==t?void 0:t.y)&&(t.y=-t.y)},ke=function(t){var e=t.x;t.x=t.y,t.y=e},Ae=function(t){for(var e={},r=t.getAllNodes(),n=r.map((function(t){var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),o=Math.max.apply(Math,u(n)),i=[],a=0;a<o+1;a++)i.push([]);var s=r.sort((function(e,r){return t.getNode(e.id).data.rank-t.getNode(r.id).data.rank})),h=s.filter((function(e){return void 0!==t.getNode(e.id).data.fixorder})).sort((function(e,r){return t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder}));return null==h||h.forEach((function(r){isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0})),null==s||s.forEach((function(r){return t.dfsTree(r.id,(function(t){if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)}))})),i},_e=function(t,e,r){for(var n=function(t,e){return null==t?void 0:t.reduce((function(t,r,n){return t[r]=e[n],t}),{})}(r,r.map((function(t,e){return e}))),o=e.map((function(e){var r=t.getRelatedEdges(e,"out").map((function(t){return{pos:n[t.target]||0,weight:t.data.weight}}));return null==r?void 0:r.sort((function(t,e){return t.pos-e.pos}))})),i=o.flat().filter((function(t){return void 0!==t})),a=1;a<r.length;)a<<=1;var s=2*a-1;a-=1;var u=Array(s).fill(0,0,s),h=0;return null==i||i.forEach((function(t){if(t){var e=t.pos+a;u[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=u[e+1]),u[e=e-1>>1]+=t.weight;h+=t.weight*r}})),h},Re=function(t,e){for(var r=0,n=1;n<(null==e?void 0:e.length);n+=1)r+=_e(t,e[n-1],e[n]);return r},ze=function(t,e){var r,n=0,o=0;t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/o,t.weight=o,t.i=Math.min(e.i,t.i),e.merged=!0};const Ie=function(t,e){var r,n,o,i={};return null==t||t.forEach((function(t,e){i[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};var r=i[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)})),null===(r=e.getAllEdges())||void 0===r||r.forEach((function(t){var e=i[t.source],r=i[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(i[t.target]))})),function(t){for(var e,r,n=[],o=function(){var o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach((function(t){return(e=o,function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&ze(e,t)})(t);var e})),null===(r=o.out)||void 0===r||r.forEach((function(e){return(r=o,function(e){e.in.push(r),0==--e.indegree&&t.push(e)})(e);var r}))};null==t?void 0:t.length;)o();var i=n.filter((function(t){return!t.merged})),a=["vs","i","barycenter","weight"];return i.map((function(t){var e={};return null==a||a.forEach((function(r){void 0!==t[r]&&(e[r]=t[r])})),e}))}(null===(o=(n=Object.values(i)).filter)||void 0===o?void 0:o.call(n,(function(t){return!t.indegree})))};var De=function(t,e,r){for(var n,o=r;e.length&&(n=e[e.length-1]).i<=o;)e.pop(),null==t||t.push(n.vs),o++;return o},Oe=function(t,e,r,n,o,i){var a,s,u,h,d=t.getChildren(e).map((function(t){return t.id})),l=t.getNode(e),c=l?l.data.borderLeft:void 0,f=l?l.data.borderRight:void 0,g={};c&&(d=null==d?void 0:d.filter((function(t){return t!==c&&t!==f})));var p=function(t,e){return e.map((function(e){var r=t.getRelatedEdges(e,"in");if(!(null==r?void 0:r.length))return{v:e};var n={sum:0,weight:0};return null==r||r.forEach((function(e){var r=t.getNode(e.source);n.sum+=e.data.weight*r.data.order,n.weight+=e.data.weight})),{v:e,barycenter:n.sum/n.weight,weight:n.weight}}))}(t,d||[]);null==p||p.forEach((function(e){var o;if(null===(o=t.getChildren(e.v))||void 0===o?void 0:o.length){var a=Oe(t,e.v,r,n,i);g[e.v]=a,a.hasOwnProperty("barycenter")&&Te(e,a)}}));var v=Ie(p,r);Pe(v,g),null===(a=v.filter((function(t){return t.vs.length>0})))||void 0===a||a.forEach((function(e){var r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)}));var y=function(t,e,r,n){var o=function(t,e){var r={lhs:[],rhs:[]};return null==t||t.forEach((function(t){var e,o;o=(e=t).hasOwnProperty("fixorder")&&!isNaN(e.fixorder),(n?!o&&e.hasOwnProperty("barycenter"):o||e.hasOwnProperty("barycenter"))?r.lhs.push(t):r.rhs.push(t)})),r}(t),i=o.lhs,a=o.rhs.sort((function(t,e){return-t.i- -e.i})),s=[],u=0,h=0,d=0;null==i||i.sort(function(t,e){return function(r,n){if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i}}(!!e,!!r)),d=De(s,a,d),null==i||i.forEach((function(t){var e;d+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),u+=t.barycenter*t.weight,h+=t.weight,d=De(s,a,d)}));var l={vs:s.flat()};return h&&(l.barycenter=u/h,l.weight=h),l}(v,n,o,i);if(c&&(y.vs=[c,y.vs,f].flat(),null===(s=t.getPredecessors(c))||void 0===s?void 0:s.length)){var m=t.getNode((null===(u=t.getPredecessors(c))||void 0===u?void 0:u[0].id)||""),w=t.getNode((null===(h=t.getPredecessors(f))||void 0===h?void 0:h[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+w.data.order)/(y.weight+2),y.weight+=2}return y},Pe=function(t,e){null==t||t.forEach((function(t){var r,n=null===(r=t.vs)||void 0===r?void 0:r.map((function(t){return e[t]?e[t].vs:t}));t.vs=n.flat()}))},Te=function(t,e){void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},Ce=function(t){if("object"!=typeof t||null===t)return t;var e,r;if(r=t,Array.isArray?Array.isArray(r):w(r,"Array")){e=[];for(var n=0,o=t.length;n<o;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=Ce(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=Ce(t[i]):e[i]=t[i];return e};const qe=Ce;var Le=function(t,e,r){return e.map((function(e){return function(t,e,r){var o=function(t){for(var e;t.hasNode(e="_root"+Math.random()););return e}(t),i=new c({tree:[{id:o,children:[],data:{}}]});return t.getAllNodes().forEach((function(a){var s=t.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(n({},a)),(null==s?void 0:s.id)&&!i.hasNode(null==s?void 0:s.id)&&i.addNode(n({},s)),i.setParent(a.id,(null==s?void 0:s.id)||o),t.getRelatedEdges(a.id,r).forEach((function(e){var r=e.source===a.id?e.target:e.source;i.hasNode(r)||i.addNode(n({},t.getNode(r)));var o=i.getRelatedEdges(r,"out").find((function(t){return t.target===a.id})),s=void 0!==o?o.data.weight:0;o?i.updateEdgeData(o.id,n(n({},o.data),{weight:e.data.weight+s})):i.addEdge({id:e.id,source:r,target:a.id,data:{weight:e.data.weight+s}})})),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,n(n({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))})),i}(t,e,r)}))},je=function(t,e,r,n){var o=new c;null==t||t.forEach((function(t){for(var i,a=t.getRoots()[0].id,s=Oe(t,a,o,e,r,n),u=0;u<(null===(i=s.vs)||void 0===i?void 0:i.length);u++){var h=t.getNode(s.vs[u]);h&&(h.data.order=u)}!function(t,e,r){var n,o={};null==r||r.forEach((function(r){for(var i,a,s=t.getParent(r);s;){if((i=t.getParent(s.id))?(a=o[i.id],o[i.id]=s.id):(a=n,n=s.id),a&&a!==s.id)return e.addNodes([{id:a,data:{}},{id:s.id,data:{}}]),void e.addEdge({id:"e"+a+"-"+s.id,source:a,target:s.id,data:{}});s=i}}))}(t,o,s.vs)}))},Fe=function(t,e){null==e||e.forEach((function(e){null==e||e.forEach((function(e,r){t.getNode(e).data.order=r}))}))},Ve=function(t,e){var r={};function n(e,n,o,i,a){for(var s,u,h,d=n;d<o;d++)h=e[d],(null===(s=t.getNode(h))||void 0===s?void 0:s.data.dummy)&&(null===(u=t.getPredecessors(h))||void 0===u||u.forEach((function(e){var n=t.getNode(e.id);n.data.dummy&&(n.data.order<i||n.data.order>a)&&Ge(r,e.id,h)})))}function o(t,e){var r=function(t){return JSON.stringify(t.slice(1))}(t);e.get(r)||(n.apply(void 0,u(t)),e.set(r,!0))}return(null==e?void 0:e.length)&&e.reduce((function(e,r){var n,i=-1,a=0,s=new Map;return null==r||r.forEach((function(u,h){var d;if("border"===(null===(d=t.getNode(u))||void 0===d?void 0:d.data.dummy)){var l=t.getPredecessors(u)||[];l.length&&(n=t.getNode(l[0].id).data.order,o([r,a,h,i,n],s),a=h,i=n)}o([r,a,r.length,n,e.length],s)})),r})),r},Be=function(t,e){var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find((function(e){return t.getNode(e.id).data.dummy}))},Ge=function(t,e,r){var n=e,o=r;if(n>o){var i=n;n=o,o=i}var a=t[n];a||(t[n]=a={}),a[o]=!0},We=function(t,e,r){var n=e;return n>r&&(n=r),!!t[n]},$e=function(t,e,r,o,i,a){var s=new c,u=Ue(o,i,a);return null==e||e.forEach((function(e){var o;null==e||e.forEach((function(e){var i=r[e];if(s.hasNode(i)||s.addNode({id:i,data:{}}),o){var a=r[o],h=s.getRelatedEdges(a,"out").find((function(t){return t.target===i}));h?s.updateEdgeData(h.id,n(n({},h.data),{weight:Math.max(u(t,e,o),h.data.weight||0)})):s.addEdge({id:"e"+Math.random(),source:a,target:i,data:{weight:Math.max(u(t,e,o),0)}})}o=e}))})),s};var Ue=function(t,e,r){return function(n,o,i){var a=n.getNode(o),s=n.getNode(i),u=0,h=0;if(u+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":h=-a.data.width/2;break;case"r":h=a.data.width/2}if(h&&(u+=r?h:-h),h=0,u+=(a.data.dummy?e:t)/2,u+=(s.data.dummy?e:t)/2,u+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":h=s.data.width/2;break;case"r":h=-s.data.width/2}return h&&(u+=r?h:-h),h=0,u}},He=function(t,e){return t.getNode(e).data.width||0},Ke=function(t,e){var r,n=Ht(t);!function(t,e){var r=(e||{}).ranksep,n=void 0===r?0:r,o=Yt(t),i=0;null==o||o.forEach((function(e){var r=e.map((function(e){return t.getNode(e).data.height})),o=Math.max.apply(Math,u(r,[0]));null==e||e.forEach((function(e){t.getNode(e).data.y=i+o/2})),i+=o+n}))}(n,e);var o=function(t,e){var r=e||{},n=r.align,o=r.nodesep,i=void 0===o?0:o,a=r.edgesep,s=void 0===a?0:a,h=Yt(t),d=Object.assign(function(t,e){var r={};return(null==e?void 0:e.length)&&e.reduce((function(e,n){var o=0,i=0,a=e.length,s=null==n?void 0:n[(null==n?void 0:n.length)-1];return null==n||n.forEach((function(e,u){var h,d=Be(t,e),l=d?t.getNode(d.id).data.order:a;(d||e===s)&&(null===(h=n.slice(i,u+1))||void 0===h||h.forEach((function(e){var n;null===(n=t.getPredecessors(e))||void 0===n||n.forEach((function(n){var i,a=t.getNode(n.id),s=a.data.order;!(s<o||l<s)||a.data.dummy&&(null===(i=t.getNode(e))||void 0===i?void 0:i.data.dummy)||Ge(r,n.id,e)}))})),i=u+1,o=l)})),n})),r}(t,h),Ve(t,h)),l={},c=[];["u","d"].forEach((function(e){c="u"===e?h:Object.values(h).reverse(),["l","r"].forEach((function(r){"r"===r&&(c=c.map((function(t){return Object.values(t).reverse()})));var n=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),o=function(t,e,r,n){var o={},i={},a={};return null==e||e.forEach((function(t){null==t||t.forEach((function(t,e){o[t]=t,i[t]=t,a[t]=e}))})),null==e||e.forEach((function(t){var e=-1;null==t||t.forEach((function(t){var s=n(t).map((function(t){return t.id}));if(s.length){s=s.sort((function(t,e){return a[t]-a[e]}));for(var u=(s.length-1)/2,h=Math.floor(u),d=Math.ceil(u);h<=d;++h){var l=s[h];i[t]===t&&e<a[l]&&!We(r,t,l)&&(i[l]=t,i[t]=o[t]=o[l],e=a[l])}}}))})),{root:o,align:i}}(0,c,d,n),a=function(t,e,r,n,o,i,a){var s,u={},h=$e(t,e,r,o,i,a),d=a?"borderLeft":"borderRight",l=function(t,e){for(var r=h.getAllNodes(),n=r.pop(),o={};n;)o[n.id]?t(n.id):(o[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return l((function(t){u[t]=(h.getRelatedEdges(t,"in")||[]).reduce((function(t,e){return Math.max(t,(u[e.source]||0)+e.data.weight)}),0)}),h.getPredecessors.bind(h)),l((function(e){var r=(h.getRelatedEdges(e,"out")||[]).reduce((function(t,e){return Math.min(t,(u[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==d&&(u[e]=Math.max(u[e],r))}),h.getSuccessors.bind(h)),null===(s=Object.values(n))||void 0===s||s.forEach((function(t){u[t]=u[r[t]]})),u}(t,c,o.root,o.align,i,s,"r"===r);"r"===r&&Object.keys(a).forEach((function(t){return a[t]=-a[t]})),l[e+r]=a}))}));var f=function(t,e){return Qt(Object.values(e),(function(e){var r,n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach((function(r){var i=e[r],a=He(t,r)/2;n=Math.max(i+a,n),o=Math.min(i-a,o)})),n-o}))}(t,l);return f&&function(t,e){var r=Object.values(e),n=Math.min.apply(Math,u(r)),o=Math.max.apply(Math,u(r));["u","d"].forEach((function(r){["l","r"].forEach((function(i){var a,s=r+i,h=t[s];if(h!==e){var d=Object.values(h);(a="l"===i?n-Math.min.apply(Math,u(d)):o-Math.max.apply(Math,u(d)))&&(t[s]={},Object.keys(h).forEach((function(e){t[s][e]=h[e]+a})))}}))}))}(l,f),function(t,e){var r={};return Object.keys(t.ul).forEach((function(n){if(e)r[n]=t[e.toLowerCase()][n];else{var o=Object.values(t).map((function(t){return t[n]}));r[n]=(o[0]+o[1])/2}})),r}(l,n)}(n,e);null===(r=Object.keys(o))||void 0===r||r.forEach((function(t){n.getNode(t).data.x=o[t]}))},Ye=function(t,e){var r=e.acyclicer,o=e.ranker,i=e.rankdir,a=void 0===i?"tb":i,s=e.nodeOrder,h=e.keepNodeOrder,d=e.align,l=e.nodesep,f=void 0===l?50:l,g=e.edgesep,p=void 0===g?20:g,v=e.ranksep,y=void 0===v?50:v;hr(t),Wt(t,r);var m=function(t){var e=Ut(t,"root",{},"_root"),r=function(t){var e={},r=function(n,o){var i=t.getChildren(n);null==i||i.forEach((function(t){return r(t.id,o+1)})),e[n]=o};return t.getRoots().forEach((function(t){return r(t.id,1)})),e}(t),n=Math.max.apply(Math,u(Object.values(r)));Math.abs(n)===1/0&&(n=1);var o=n-1,i=2*o+1;t.getAllEdges().forEach((function(t){t.data.minlen*=i}));var a=function(t){var e=0;return t.getAllEdges().forEach((function(t){e+=t.data.weight})),e}(t)+1;return t.getRoots().forEach((function(n){Ee(t,e,i,a,o,r,n.id)})),{nestingRoot:e,nodeRankFactor:i}}(t),w=m.nestingRoot,x=m.nodeRankFactor;!function(t,e){switch(e){case"network-simplex":xe(t);break;case"tight-tree":default:!function(t){!function(t){var e,r={},n=function(o){var i,a,s=t.getNode(o);return s?r[o]?s.data.rank:(r[o]=!0,null===(i=t.getRelatedEdges(o,"out"))||void 0===i||i.forEach((function(t){var e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),(void 0===e||a<e)&&(e=a),s.data.rank=a,a):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){t&&n(t.id)})),void 0===e&&(e=0);var o={},i=function(e,r){var n,a=t.getNode(e),s=isNaN(a.data.layer)?r:a.data.layer;(void 0===a.data.rank||a.data.rank<s)&&(a.data.rank=s),o[e]||(o[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach((function(t){i(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((function(t){var r=t.data;r&&(isNaN(r.layer)?r.rank-=e:i(t.id,r.layer))}))}(t),function(t){var e,r,n=new c({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);ie(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r)}(t)}(t);break;case"longest-path":we(t)}}(Ht(t),o),er(t),function(t,e){void 0===e&&(e=0);var r=t.getAllNodes(),n=r.filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),o=Math.min.apply(Math,u(n)),i=[];r.forEach((function(t){var e=(t.data.rank||0)-o;i[e]||(i[e]=[]),i[e].push(t.id)}));for(var a=0,s=0;s<i.length;s++){var h=i[s];void 0===h?s%e!=0&&(a-=1):a&&(null==h||h.forEach((function(e){var r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=a)})))}}(t,x),function(t,e){e&&t.removeNode(e),t.getAllEdges().forEach((function(e){e.data.nestingEdge&&t.removeEdge(e.id)}))}(t,w),function(t){var e=t.getAllNodes().filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),r=Math.min.apply(Math,u(e));t.getAllNodes().forEach((function(t){t.data.hasOwnProperty("rank")&&r!==1/0&&(t.data.rank-=r)}))}(t),rr(t),nr(t);var E=[];!function(t,e){t.getAllEdges().forEach((function(r){return function(t,e,r){var n=e.source,o=t.getNode(n).data.rank,i=e.target,a=t.getNode(i).data.rank,s=e.data.labelRank;if(a!==o+1){var u,h,d;for(t.removeEdge(e.id),d=0,++o;o<a;++d,++o)e.data.points=[],u=Ut(t,"edge",h={originalEdge:e,width:0,height:0,rank:o},"_d"),o===s&&(h.width=e.data.width,h.height=e.data.height,h.dummy=ee,h.labelpos=e.data.labelpos),t.addEdge({id:"e"+Math.random(),source:n,target:u,data:{weight:e.data.weight}}),0===d&&r.push(u),n=u;t.addEdge({id:"e"+Math.random(),source:n,target:i,data:{weight:e.data.weight}})}}(t,r,e)}))}(t,E),function(t,e){var r=function(t){var e={},r=0,n=function(o){var i=r;t.getChildren(o).forEach((function(t){return n(t.id)})),e[o]={low:i,lim:r++}};return t.getRoots().forEach((function(t){return n(t.id)})),e}(t);e.forEach((function(e){var n,o,i=e,a=t.getNode(i),s=a.data.originalEdge;if(s)for(var u=function(t,e,r,n){var o,i,a,s,u=[],h=[],d=Math.min(e[r].low,e[n].low),l=Math.max(e[r].lim,e[n].lim);a=r;do{a=null===(o=t.getParent(a))||void 0===o?void 0:o.id,u.push(a)}while(a&&(e[a].low>d||l>e[a].lim));for(s=a,a=n;a&&a!==s;)h.push(a),a=null===(i=t.getParent(a))||void 0===i?void 0:i.id;return{lca:s,path:u.concat(h.reverse())}}(t,r,s.source,s.target),h=u.path,d=u.lca,l=0,c=h[l],f=!0;i!==s.target;){if(a=t.getNode(i),f){for(;c!==d&&(null===(n=t.getNode(c))||void 0===n?void 0:n.data.maxRank)<a.data.rank;)c=h[++l];c===d&&(f=!1)}if(!f){for(;l<h.length-1&&(null===(o=t.getNode(h[l+1]))||void 0===o?void 0:o.data.minRank)<=a.data.rank;)l++;c=h[l]}t.hasNode(c)&&t.setParent(i,c),i=t.getSuccessors(i)[0].id}}))}(t,E),function(t){var e=function(r){var n=t.getChildren(r),o=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach((function(t){return e(t.id)})),o.data.hasOwnProperty("minRank")){o.data.borderLeft=[],o.data.borderRight=[];for(var i=o.data.minRank,a=o.data.maxRank+1;i<a;i+=1)Ne(t,"borderLeft","_bl",r,o,i),Ne(t,"borderRight","_br",r,o,i)}};t.getRoots().forEach((function(t){return e(t.id)}))}(t),h&&function(t,e){for(var r=t.getAllNodes().filter((function(e){var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)})).map((function(t){return t.data.rank})),n=Math.max.apply(Math,u(r)),o=[],i=0;i<n+1;i++)o[i]=[];null==e||e.forEach((function(e){var r=t.getNode(e);r&&!r.data.dummy&&(isNaN(r.data.rank)||(r.data.fixorder=o[r.data.rank].length,o[r.data.rank].push(e)))}))}(t,s),function(t,e){for(var r=Xt(t),n=[],o=[],i=1;i<r+1;i++)n.push(i);for(i=r-1;i>-1;i--)o.push(i);var a=Le(t,n,"in"),s=Le(t,o,"out"),u=Ae(t);Fe(t,u);for(var h,d=Number.POSITIVE_INFINITY,l=(i=0,0);l<4;++i,++l)je(i%2?a:s,i%4>=2,!1,e),u=Yt(t),(c=Re(t,u))<d&&(l=0,h=qe(u),d=c);for(u=Ae(t),Fe(t,u),i=0,l=0;l<4;++i,++l){var c;je(i%2?a:s,i%4>=2,!0,e),u=Yt(t),(c=Re(t,u))<d&&(l=0,h=qe(u),d=c)}Fe(t,h)}(t,h),dr(t),function(t,e){var r=e.toLowerCase();"lr"!==r&&"rl"!==r||be(t)}(t,a),Ke(t,{align:d,nodesep:f,edgesep:p,ranksep:y}),lr(t),ur(t),function(t,e){e.forEach((function(e){var r,n=t.getNode(e),o=n.data.originalEdge;o&&t.addEdge(o);for(var i=e;n.data.dummy;)r=t.getSuccessors(i)[0],t.removeNode(i),o.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===ee&&(o.data.x=n.data.x,o.data.y=n.data.y,o.data.width=n.data.width,o.data.height=n.data.height),i=r.id,n=t.getNode(i)}))}(t,E),ar(t),function(t,e){var r=e.toLowerCase();"bt"!==r&&"rl"!==r||function(t){t.getAllNodes().forEach((function(t){Se(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return Se(t)})),t.data.hasOwnProperty("y")&&Se(t.data)}))}(t),"lr"!==r&&"rl"!==r||(function(t){t.getAllNodes().forEach((function(t){ke(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return ke(t)})),t.data.hasOwnProperty("x")&&ke(t.data)}))}(t),be(t))}(t,a);var N=or(t),b=N.width,M=N.height;return ir(t),sr(t),function(t){t.getAllEdges().forEach((function(e){var r=e.data;if(r.reversed){t.removeEdge(e.id);var o=r.forwardName;delete r.reversed,delete r.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:n(n({},r),{forwardName:o})})}}))}(t),{width:b,height:M}},Je=["width","height","layer","fixorder"],Xe={width:0,height:0},Qe=["minlen","weight","width","height","labeloffset"],Ze={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},tr=["labelpos"],er=function(t){t.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var r=t.getNode(e.source),n={e,rank:(t.getNode(e.target).data.rank-r.data.rank)/2+r.data.rank};Ut(t,"edge-proxy",n,"_ep")}}))},rr=function(t){var e=0;return t.getAllNodes().forEach((function(r){var n,o;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(o=t.getNode(r.data.borderBottom))||void 0===o?void 0:o.data.rank,e=Math.max(e,r.data.maxRank||-1/0))})),e},nr=function(t){t.getAllNodes().forEach((function(e){"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},or=function(t,e){var r,n,o=0,i=0,a=e||{},s=a.marginx,u=void 0===s?0:s,h=a.marginy,d=void 0===h?0:h,l=function(t){if(t.data){var e=t.data.x,a=t.data.y,s=t.data.width,u=t.data.height;isNaN(e)||isNaN(s)||(void 0===r&&(r=e-s/2),r=Math.min(r,e-s/2),o=Math.max(o,e+s/2)),isNaN(a)||isNaN(u)||(void 0===n&&(n=a-u/2),n=Math.min(n,a-u/2),i=Math.max(i,a+u/2))}};return t.getAllNodes().forEach((function(t){l(t)})),t.getAllEdges().forEach((function(t){(null==t?void 0:t.data.hasOwnProperty("x"))&&l(t)})),r-=u,n-=d,t.getAllNodes().forEach((function(t){t.data.x-=r,t.data.y-=n})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){t.x-=r,t.y-=n})),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)})),{width:o-r+u,height:i-n+d}},ir=function(t){t.getAllEdges().forEach((function(e){var r,n,o=t.getNode(e.source),i=t.getNode(e.target);e.data.points?(r=e.data.points[0],n=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:i.data.x,y:i.data.y},n={x:o.data.x,y:o.data.y}),e.data.points.unshift(Kt(o.data,r)),e.data.points.push(Kt(i.data,n))}))},ar=function(t){t.getAllEdges().forEach((function(t){if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},sr=function(t){t.getAllEdges().forEach((function(t){var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},ur=function(t){t.getAllNodes().forEach((function(e){var r,n,o;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){var i=t.getNode(e.id),a=t.getNode(i.data.borderTop),s=t.getNode(i.data.borderBottom),u=t.getNode(i.data.borderLeft[(null===(n=i.data.borderLeft)||void 0===n?void 0:n.length)-1]),h=t.getNode(i.data.borderRight[(null===(o=i.data.borderRight)||void 0===o?void 0:o.length)-1]);i.data.width=Math.abs((null==h?void 0:h.data.x)-(null==u?void 0:u.data.x))||10,i.data.height=Math.abs((null==s?void 0:s.data.y)-(null==a?void 0:a.data.y))||10,i.data.x=((null==u?void 0:u.data.x)||0)+i.data.width/2,i.data.y=((null==a?void 0:a.data.y)||0)+i.data.height/2}})),t.getAllNodes().forEach((function(e){"border"===e.data.dummy&&t.removeNode(e.id)}))},hr=function(t){t.getAllEdges().forEach((function(e){if(e.source===e.target){var r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}}))},dr=function(t){var e=Yt(t);null==e||e.forEach((function(e){var r=0;null==e||e.forEach((function(e,n){var o,i=t.getNode(e);i.data.order=n+r,null===(o=i.data.selfEdges)||void 0===o||o.forEach((function(e){Ut(t,"selfedge",{width:e.data.width,height:e.data.height,rank:i.data.rank,order:n+ ++r,e},"_se")})),delete i.data.selfEdges}))}))},lr=function(t){t.getAllNodes().forEach((function(e){var r=t.getNode(e.id);if("selfedge"===r.data.dummy){var n=t.getNode(r.data.e.source),o=n.data.x+n.data.width/2,i=n.data.y,a=r.data.x-o,s=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}}))},cr=function(t,e){var r={};return null==e||e.forEach((function(e){void 0!==t[e]&&(r[e]=+t[e])})),r},fr=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(r){e[r.toLowerCase()]=t[r]})),e},gr={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="dagre",this.layoutNode=function(t){return t.data.layout},this.options=n(n({},gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericDagreLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericDagreLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericDagreLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,E,b,M,k,_,R,z,I,D,O,P,T,C,q,L,j,F,V,B,G=this;return a(this,(function(a){return o=n(n({},this.options),r),i=o.nodeSize,s=o.align,u=o.rankdir,h=void 0===u?"TB":u,d=o.ranksep,l=o.nodesep,f=o.ranksepFunc,g=o.nodesepFunc,p=o.edgeLabelSpace,v=o.nodeOrder,y=o.begin,m=o.controlPoints,w=o.radial,E=new c({tree:[]}),b=S(d||50,f),M=S(l||50,g),k=M,_=b,"LR"!==h&&"RL"!==h||(k=b,_=M),R=A(i,void 0),z=e.getAllNodes(),I=e.getAllEdges(),z.filter((function(t){return t.data.layout})).forEach((function(t){var e=R(t),r=_(t),n=e+2*k(t),o=e+2*r,i=t.data.layer;x(i)?E.addNode({id:t.id,data:{width:n,height:o,layer:i}}):E.addNode({id:t.id,data:{width:n,height:o}})})),I.forEach((function(t){G.layoutNode(E.getNode(t.source))&&G.layoutNode(E.getNode(t.target))&&E.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),function(t,e){var r,o,i=e.edgeLabelSpace,a=e.keepNodeOrder,s=e.prevGraph,u=e.rankdir,h=e.ranksep;!a&&s&&(o=s,(r=t).getAllNodes().forEach((function(t){var e=r.getNode(t.id),n=o.getNode(t.id);void 0!==n?(e.data.fixorder=n.data._order,delete n.data._order):delete e.data.fixorder})));var d=function(t){var e=new c({tree:[]});return t.getAllNodes().forEach((function(r){var o=fr(t.getNode(r.id).data),i=n(n({},Xe),o),a=cr(i,Je);e.hasNode(r.id)||e.addNode({id:r.id,data:n({},a)});var s=t.getParent(r.id);null==s||(e.hasNode(s.id)||e.addNode(n({},s)),e.setParent(r.id,s.id))})),t.getAllEdges().forEach((function(r){var n=fr(t.getEdge(r.id).data),o={};null==tr||tr.forEach((function(t){void 0!==n[t]&&(o[t]=n[t])})),e.addEdge({id:r.id,source:r.source,target:r.target,data:Object.assign({},Ze,cr(n,Qe),o)})})),e}(t);i&&(e.ranksep=function(t,e){var r=e.ranksep,n=void 0===r?0:r,o=e.rankdir;return t.getAllNodes().forEach((function(t){isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((function(t){var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===o||"BT"===o?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2}(d,{rankdir:u,ranksep:h}));try{Ye(d,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph\'s structure:\\n",t);throw t}!function(t,e){t.getAllNodes().forEach((function(r){var n,o=t.getNode(r.id);if(o){var i=e.getNode(r.id);o.data.x=i.data.x,o.data.y=i.data.y,o.data._order=i.data.order,o.data._rank=i.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(o.data.width=i.data.width,o.data.height=i.data.height)}})),t.getAllEdges().forEach((function(r){var n=t.getEdge(r.id),o=e.getEdge(r.id);n.data.points=o?o.data.points:[],o&&o.data.hasOwnProperty("x")&&(n.data.x=o.data.x,n.data.y=o.data.y)}))}(t,d)}(E,{prevGraph:null,edgeLabelSpace:p,keepNodeOrder:!!v,nodeOrder:v||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:h,nodesep:l,align:s}),D=[0,0],y&&(O=1/0,P=1/0,E.getAllNodes().forEach((function(t){O>t.data.x&&(O=t.data.x),P>t.data.y&&(P=t.data.y)})),E.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){O>t.x&&(O=t.x),P>t.y&&(P=t.y)}))})),D[0]=y[0]-O,D[1]=y[1]-P),T="LR"===h||"RL"===h,w||(C=new Set,q="BT"===h||"RL"===h?function(t,e){return e-t}:function(t,e){return t-e},E.getAllNodes().forEach((function(t){t.data.x=t.data.x+D[0],t.data.y=t.data.y+D[1],C.add(T?t.data.x:t.data.y)})),L=Array.from(C).sort(q),j=T?function(t,e){return t.x!==e.x}:function(t,e){return t.y!==e.y},F=T?function(t,e,r){var n=Math.max(e.y,r.y),o=Math.min(e.y,r.y);return t.filter((function(t){return t.y<=n&&t.y>=o}))}:function(t,e,r){var n=Math.max(e.x,r.x),o=Math.min(e.x,r.x);return t.filter((function(t){return t.x<=n&&t.x>=o}))},E.getAllEdges().forEach((function(t,e){var r;p&&m&&"loop"!==t.data.type&&(t.data.controlPoints=vr(null===(r=t.data.points)||void 0===r?void 0:r.map((function(t){var e=t.x,r=t.y;return{x:e+D[0],y:r+D[1]}})),E.getNode(t.source),E.getNode(t.target),L,T,j,F))}))),V=[],V=E.getAllNodes().map((function(t){return N(t)})),B=E.getAllEdges(),t&&(V.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),B.forEach((function(t){e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),[2,{nodes:V,edges:B}]}))}))},t}(),vr=function(t,e,r,n,o,i,a){var s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){var u=e.data,h=u.x,d=u.y,l=r.data,c=l.x,f=l.y;if(o&&(h=e.data.y,d=e.data.x,c=r.data.y,f=r.data.x),f!==d&&h!==c){var g=n.indexOf(d),p=n[g+1];if(p){var v=s[0],y=o?{x:(d+p)/2,y:(null==v?void 0:v.y)||c}:{x:(null==v?void 0:v.x)||c,y:(d+p)/2};v&&!i(v,y)||s.unshift(y)}var m=n.indexOf(f),w=Math.abs(m-g);if(1===w)(s=a(s,e.data,r.data)).length||s.push(o?{x:(d+f)/2,y:h}:{x:h,y:(d+f)/2});else if(w>1){var x=n[m-1];if(x){var E=s[s.length-1],N=o?{x:(f+x)/2,y:(null==E?void 0:E.y)||c}:{x:(null==E?void 0:E.x)||h,y:(f+x)/2};E&&!i(E,N)||s.push(N)}}}}return s};function yr(t,e,r,n,o){if(isNaN(e)||isNaN(r)||isNaN(n))return t;var i,a,s,u,h,d,l,c,f,g,p,v,y=t._root,m={data:o},w=t._x0,x=t._y0,E=t._z0,N=t._x1,b=t._y1,M=t._z1;if(!y)return t._root=m,t;for(;y.length;)if((c=e>=(a=(w+N)/2))?w=a:N=a,(f=r>=(s=(x+b)/2))?x=s:b=s,(g=n>=(u=(E+M)/2))?E=u:M=u,i=y,!(y=y[p=g<<2|f<<1|c]))return i[p]=m,t;if(h=+t._x.call(null,y.data),d=+t._y.call(null,y.data),l=+t._z.call(null,y.data),e===h&&r===d&&n===l)return m.next=y,i?i[p]=m:t._root=m,t;do{i=i?i[p]=new Array(8):t._root=new Array(8),(c=e>=(a=(w+N)/2))?w=a:N=a,(f=r>=(s=(x+b)/2))?x=s:b=s,(g=n>=(u=(E+M)/2))?E=u:M=u}while((p=g<<2|f<<1|c)==(v=(l>=u)<<2|(d>=s)<<1|h>=a));return i[v]=y,i[p]=m,t}function mr(t,e,r,n,o,i,a){this.node=t,this.x0=e,this.y0=r,this.z0=n,this.x1=o,this.y1=i,this.z1=a}function wr(t){return t[0]}function xr(t){return t[1]}function Er(t){return t[2]}function Nr(t,e,r,n){var o=new br(null==e?wr:e,null==r?xr:r,null==n?Er:n,NaN,NaN,NaN,NaN,NaN,NaN);return null==t?o:o.addAll(t)}function br(t,e,r,n,o,i,a,s,u){this._x=t,this._y=e,this._z=r,this._x0=n,this._y0=o,this._z0=i,this._x1=a,this._y1=s,this._z1=u,this._root=void 0}function Mr(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var Sr=Nr.prototype=br.prototype;function kr(t){var e=0,r=0,n=0,o=0,i=t.length;if(i){for(var a=0;a<i;a++)(s=t[a])&&s.weight&&(e+=s.weight,r+=s.x*s.weight,n+=s.y*s.weight,o+=s.z*s.weight);t.x=r/e,t.y=n/e,t.z=o/e,t.weight=e}else{var s=t;t.x=s.data.x,t.y=s.data.y,t.z=s.data.z,t.weight=s.data.weight}}Sr.copy=function(){var t,e,r=new br(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),n=this._root;if(!n)return r;if(!n.length)return r._root=Mr(n),r;for(t=[{source:n,target:r._root=new Array(8)}];n=t.pop();)for(var o=0;o<8;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(8)}):n.target[o]=Mr(e));return r},Sr.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t),n=+this._z.call(null,t);return yr(this.cover(e,r,n),e,r,n,t)},Sr.addAll=function(t){Array.isArray(t)||(t=Array.from(t));const e=t.length,r=new Float64Array(e),n=new Float64Array(e),o=new Float64Array(e);let i=1/0,a=1/0,s=1/0,u=-1/0,h=-1/0,d=-1/0;for(let l,c,f,g,p=0;p<e;++p)isNaN(c=+this._x.call(null,l=t[p]))||isNaN(f=+this._y.call(null,l))||isNaN(g=+this._z.call(null,l))||(r[p]=c,n[p]=f,o[p]=g,c<i&&(i=c),c>u&&(u=c),f<a&&(a=f),f>h&&(h=f),g<s&&(s=g),g>d&&(d=g));if(i>u||a>h||s>d)return this;this.cover(i,a,s).cover(u,h,d);for(let i=0;i<e;++i)yr(this,r[i],n[i],o[i],t[i]);return this},Sr.cover=function(t,e,r){if(isNaN(t=+t)||isNaN(e=+e)||isNaN(r=+r))return this;var n=this._x0,o=this._y0,i=this._z0,a=this._x1,s=this._y1,u=this._z1;if(isNaN(n))a=(n=Math.floor(t))+1,s=(o=Math.floor(e))+1,u=(i=Math.floor(r))+1;else{for(var h,d,l=a-n||1,c=this._root;n>t||t>=a||o>e||e>=s||i>r||r>=u;)switch(d=(r<i)<<2|(e<o)<<1|t<n,(h=new Array(8))[d]=c,c=h,l*=2,d){case 0:a=n+l,s=o+l,u=i+l;break;case 1:n=a-l,s=o+l,u=i+l;break;case 2:a=n+l,o=s-l,u=i+l;break;case 3:n=a-l,o=s-l,u=i+l;break;case 4:a=n+l,s=o+l,i=u-l;break;case 5:n=a-l,s=o+l,i=u-l;break;case 6:a=n+l,o=s-l,i=u-l;break;case 7:n=a-l,o=s-l,i=u-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=o,this._z0=i,this._x1=a,this._y1=s,this._z1=u,this},Sr.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Sr.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},Sr.find=function(t,e,r,n){var o,i,a,s,u,h,d,l,c,f=this._x0,g=this._y0,p=this._z0,v=this._x1,y=this._y1,m=this._z1,w=[],x=this._root;for(x&&w.push(new mr(x,f,g,p,v,y,m)),null==n?n=1/0:(f=t-n,g=e-n,p=r-n,v=t+n,y=e+n,m=r+n,n*=n);l=w.pop();)if(!(!(x=l.node)||(i=l.x0)>v||(a=l.y0)>y||(s=l.z0)>m||(u=l.x1)<f||(h=l.y1)<g||(d=l.z1)<p))if(x.length){var E=(i+u)/2,N=(a+h)/2,b=(s+d)/2;w.push(new mr(x[7],E,N,b,u,h,d),new mr(x[6],i,N,b,E,h,d),new mr(x[5],E,a,b,u,N,d),new mr(x[4],i,a,b,E,N,d),new mr(x[3],E,N,s,u,h,b),new mr(x[2],i,N,s,E,h,b),new mr(x[1],E,a,s,u,N,b),new mr(x[0],i,a,s,E,N,b)),(c=(r>=b)<<2|(e>=N)<<1|t>=E)&&(l=w[w.length-1],w[w.length-1]=w[w.length-1-c],w[w.length-1-c]=l)}else{var M=t-+this._x.call(null,x.data),S=e-+this._y.call(null,x.data),k=r-+this._z.call(null,x.data),A=M*M+S*S+k*k;if(A<n){var _=Math.sqrt(n=A);f=t-_,g=e-_,p=r-_,v=t+_,y=e+_,m=r+_,o=x.data}}return o},Sr.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t))||isNaN(s=+this._z.call(null,t)))return this;var e,r,n,o,i,a,s,u,h,d,l,c,f,g,p,v=this._root,y=this._x0,m=this._y0,w=this._z0,x=this._x1,E=this._y1,N=this._z1;if(!v)return this;if(v.length)for(;;){if((l=i>=(u=(y+x)/2))?y=u:x=u,(c=a>=(h=(m+E)/2))?m=h:E=h,(f=s>=(d=(w+N)/2))?w=d:N=d,e=v,!(v=v[g=f<<2|c<<1|l]))return this;if(!v.length)break;(e[g+1&7]||e[g+2&7]||e[g+3&7]||e[g+4&7]||e[g+5&7]||e[g+6&7]||e[g+7&7])&&(r=e,p=g)}for(;v.data!==t;)if(n=v,!(v=v.next))return this;return(o=v.next)&&delete v.next,n?(o?n.next=o:delete n.next,this):e?(o?e[g]=o:delete e[g],(v=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&v===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!v.length&&(r?r[p]=v:this._root=v),this):(this._root=o,this)},Sr.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},Sr.root=function(){return this._root},Sr.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Sr.visit=function(t){var e,r,n,o,i,a,s,u,h=[],d=this._root;for(d&&h.push(new mr(d,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=h.pop();)if(!t(d=e.node,n=e.x0,o=e.y0,i=e.z0,a=e.x1,s=e.y1,u=e.z1)&&d.length){var l=(n+a)/2,c=(o+s)/2,f=(i+u)/2;(r=d[7])&&h.push(new mr(r,l,c,f,a,s,u)),(r=d[6])&&h.push(new mr(r,n,c,f,l,s,u)),(r=d[5])&&h.push(new mr(r,l,o,f,a,c,u)),(r=d[4])&&h.push(new mr(r,n,o,f,l,c,u)),(r=d[3])&&h.push(new mr(r,l,c,i,a,s,f)),(r=d[2])&&h.push(new mr(r,n,c,i,l,s,f)),(r=d[1])&&h.push(new mr(r,l,o,i,a,c,f)),(r=d[0])&&h.push(new mr(r,n,o,i,l,c,f))}return this},Sr.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new mr(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.z0,h=e.x1,d=e.y1,l=e.z1,c=(a+h)/2,f=(s+d)/2,g=(u+l)/2;(i=o[0])&&r.push(new mr(i,a,s,u,c,f,g)),(i=o[1])&&r.push(new mr(i,c,s,u,h,f,g)),(i=o[2])&&r.push(new mr(i,a,f,u,c,d,g)),(i=o[3])&&r.push(new mr(i,c,f,u,h,d,g)),(i=o[4])&&r.push(new mr(i,a,s,g,c,f,l)),(i=o[5])&&r.push(new mr(i,c,s,g,h,f,l)),(i=o[6])&&r.push(new mr(i,a,f,g,c,d,l)),(i=o[7])&&r.push(new mr(i,c,f,g,h,d,l))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.z0,e.x1,e.y1,e.z1);return this},Sr.x=function(t){return arguments.length?(this._x=t,this):this._x},Sr.y=function(t){return arguments.length?(this._y=t,this):this._y},Sr.z=function(t){return arguments.length?(this._z=t,this):this._z};var Ar=function(t,e,r,n,o,i,a){var s=[r,n,o][a-1],u=i.x-t.x||.1,h=i.y-t.y||.1,d=i.z-t.z||.1,l=s-e,c=u*u+h*h+d*d,f=Math.sqrt(c)*c;if(l*l*.81<c){var g=t.weight/f;return i.vx+=u*g,i.vy+=h*g,i.vz+=d*g,!0}if(t.length)return!1;t.data!==i&&(g=t.data.weight/f,i.vx+=u*g,i.vy+=h*g,i.vz+=d*g)},_r={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},Rr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=n(n({},_r),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,E,N,b,M,S,k=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=this.formatOptions(o,e),h=u.width,d=u.height,l=u.nodeSize,f=u.getMass,g=u.nodeStrength,p=u.edgeStrength,v=u.linkDistance,y=i.map((function(t){return n(n({},t),{data:n(n({},t.data),{x:x(t.data.x)?t.data.x:Math.random()*h,y:x(t.data.y)?t.data.y:Math.random()*d,size:l(t)||30,mass:f(t),nodeStrength:g(t)})})})),m=s.map((function(t){return n(n({},t),{data:n(n({},t.data),{edgeStrength:p(t),linkDistance:v(t,e.getNode(t.source),e.getNode(t.target))})})})),(null==i?void 0:i.length)?(w={},i.forEach((function(t,e){w[t.id]={x:0,y:0}})),E=new c({nodes:y,edges:m}),this.formatCentripetal(u,E),N=u.maxIteration,b=u.minMovement,M=u.onTick,this.lastLayoutNodes=y,this.lastLayoutEdges=m,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=E,this.lastOptions=u,this.lastVelMap=w,"undefined"==typeof window?[2]:(S=0,[2,new Promise((function(r){k.timeInterval=window.setInterval((function(){i&&k.running||r({nodes:Pr(e,y),edges:s}),k.runOneStep(E,e,S,w,u),k.updatePosition(e,E,w,u),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),null==M||M({nodes:Pr(e,y),edges:s}),(++S>=N||k.judgingDistance<b)&&(window.clearInterval(k.timeInterval),r({nodes:Pr(e,y),edges:s}))}),0),k.running=!0}))])):(this.lastResult={nodes:[],edges:s},[2,{nodes:[],edges:s}])}))}))},t.prototype.formatOptions=function(t,e){var r=t,n=t.width,o=t.height,i=t.getMass;if(r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=o||"undefined"==typeof window?o:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),i||(r.getMass=function(t){var r=1;x(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);var n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),t.preventOverlap){var a=S(0,t.nodeSpacing);t.nodeSize?g(t.nodeSize)?r.nodeSize=function(e){var r=t.nodeSize;return Math.max(r[0],r[1])+a(e)}:r.nodeSize=function(e){return t.nodeSize+a(e)}:r.nodeSize=function(t){var e=((null==t?void 0:t.data)||{}).size;return e?g(e)?Math.max(e[0],e[1])+a(t):M(e)?Math.max(e.width,e.height)+a(t):e+a(t):10+a(t)}}return r.linkDistance=t.linkDistance?S(1,t.linkDistance):function(t){return 1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target))},r.nodeStrength=S(1,t.nodeStrength),r.edgeStrength=S(1,t.edgeStrength),t},t.prototype.formatCentripetal=function(t,e){var r,n=t.centripetalOptions,o=t.center,i=t.clusterNodeStrength,a=t.leafCluster,s=t.clustering,u=t.nodeClusterBy,h=e.getAllNodes(),d=n||{leaf:2,single:2,others:1,center:function(t){return{x:o[0],y:o[1]}}};"function"!=typeof i&&(t.clusterNodeStrength=function(t){return i});var l=[];if(a&&u&&(r=zr(e,u),l=Array.from(new Set(null==h?void 0:h.map((function(t){return t.data[u]}))))||[],t.centripetalOptions=Object.assign(d,{single:100,leaf:function(e){var n=r[e.id]||{},o=n.siblingLeaves,i=n.sameTypeLeaves;return(null==i?void 0:i.length)===(null==o?void 0:o.length)||1===(null==l?void 0:l.length)?1:t.clusterNodeStrength(e)},others:1,center:function(t){var n,o=e.getDegree(t.id,"both");if(!o)return{x:100,y:100};if(1===o){var i=(r[t.id]||{}).sameTypeLeaves,a=void 0===i?[]:i;1===a.length?n=void 0:a.length>1&&(n=Or(a))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y}}})),s&&u){r||(r=zr(e,u)),l||(l=Array.from(new Set(h.map((function(t){return t.data[u]}))))),l=l.filter((function(t){return void 0!==t}));var c={};l.forEach((function(t){var r=h.filter((function(e){return e.data[u]===t})).map((function(t){return e.getNode(t.id)}));c[t]=Or(r)})),t.centripetalOptions=Object.assign(d,{single:function(e){return t.clusterNodeStrength(e)},leaf:function(e){return t.clusterNodeStrength(e)},others:function(e){return t.clusterNodeStrength(e)},center:function(t){var e=c[t.data[u]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y}}})}var f=t.centripetalOptions||{},g=f.leaf,p=f.single,v=f.others;g&&"function"!=typeof g&&(t.centripetalOptions.leaf=function(){return g}),p&&"function"!=typeof p&&(t.centripetalOptions.single=function(){return p}),v&&"function"!=typeof v&&(t.centripetalOptions.others=function(){return v})},t.prototype.runOneStep=function(t,e,r,n,o){var i={},a=t.getAllNodes(),s=t.getAllEdges();if(null==a?void 0:a.length){var u=o.monitor;this.calRepulsive(t,i,o),s&&this.calAttractive(t,i,o),this.calGravity(t,e,i,o),this.updateVelocity(t,i,n,o),u&&u({energy:this.calTotalEnergy(i,a),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}},t.prototype.calTotalEnergy=function(t,e){if(!(null==e?void 0:e.length))return 0;var r=0;return e.forEach((function(e,n){var o=t[e.id].x,i=t[e.id].y,a=o*o+i*i,s=e.data.mass;r+=(void 0===s?1:s)*a*.5})),r},t.prototype.calRepulsive=function(t,e,r){var n=r.dimensions,o=r.factor,i=r.coulombDisScale;!function(t,e,r,n,o){var i=e/r,a=t.getAllNodes(),s=a.map((function(t,e){var r=t.data,n=r.nodeStrength;return{x:r.x,y:r.y,z:r.z,size:r.size,index:e,vx:0,vy:0,vz:0,weight:i*n}})),u=(2===o?F(s,(function(t){return t.x}),(function(t){return t.y})):Nr(s,(function(t){return t.x}),(function(t){return t.y}),(function(t){return t.z}))).visitAfter(kr);s.forEach((function(t){!function(t,e,r){e.visit((function(e,n,o,i,a){return Ar(e,n,o,i,a,t,r)}))}(t,u,o)})),s.map((function(t,e){var r=a[e],o=r.id,i=r.data.mass,s=void 0===i?1:i;n[o]={x:t.vx/s,y:t.vy/s,z:t.vz/s}}))}(t,o,i*i,e,n)},t.prototype.calAttractive=function(t,e,r){var n=r.dimensions;t.getAllEdges().forEach((function(r,o){var i=r.source,a=r.target,s=t.getNode(i),u=t.getNode(a);if(s&&u){var h=u.data.x-s.data.x,d=u.data.y-s.data.y,l=3===n?u.data.z-s.data.z:0;h||d||(h=.01*Math.random(),d=.01*Math.random(),3!==n||l||(l=.01*Math.random()));var c=Math.sqrt(h*h+d*d+l*l),f=h/c,g=d/c,p=l/c,v=r.data||{},y=v.linkDistance,m=void 0===y?200:y,w=v.edgeStrength,x=(m-c)*(void 0===w?200:w),E=1/(s.data.mass||1),N=1/(u.data.mass||1),b=f*x,M=g*x,S=p*x;e[i].x-=b*E,e[i].y-=M*E,e[i].z-=S*E,e[a].x+=b*N,e[a].y+=M*N,e[a].z+=M*N}}))},t.prototype.calGravity=function(t,e,r,n){var o=n.getCenter,i=t.getAllNodes(),a=e.getAllNodes(),u=e.getAllEdges(),h=n.width,d=n.height,l=n.center,c=n.gravity,f=n.centripetalOptions;i&&i.forEach((function(n){var i=n.id,g=n.data,p=g.mass,v=g.x,y=g.y,m=g.z,w=e.getNode(i),E=0,N=0,b=0,M=c,S=t.getDegree(i,"in"),k=t.getDegree(i,"out"),A=t.getDegree(i,"both"),_=null==o?void 0:o(w,A);if(_){var R=s(_,3);E=v-R[0],N=y-R[1],M=R[2]}else E=v-l[0],N=y-l[1],b=m-l[2];if(M&&(r[i].x-=M*E/p,r[i].y-=M*N/p,r[i].z-=M*b/p),f){var z=f.leaf,I=f.single,D=f.others,O=f.center,P=(null==O?void 0:O(w,a,u,h,d))||{x:0,y:0,z:0,centerStrength:0},T=P.x,C=P.y,q=P.z,L=P.centerStrength;if(!x(T)||!x(C))return;var j=(v-T)/p,F=(y-C)/p,V=(m-q)/p;if(L&&(r[i].x-=L*j,r[i].y-=L*F,r[i].z-=L*V),0===A){var B=I(w);if(!B)return;return r[i].x-=B*j,r[i].y-=B*F,void(r[i].z-=B*V)}if(0===S||0===k){var G=z(w,a,u);if(!G)return;return r[i].x-=G*j,r[i].y-=G*F,void(r[i].z-=G*V)}var W=D(w);if(!W)return;r[i].x-=W*j,r[i].y-=W*F,r[i].z-=W*V}}))},t.prototype.updateVelocity=function(t,e,r,n){var o=n.damping,i=n.maxSpeed,a=n.interval,s=n.dimensions,u=t.getAllNodes();(null==u?void 0:u.length)&&u.forEach((function(t){var n=t.id,u=(r[n].x+e[n].x*a)*o||.01,h=(r[n].y+e[n].y*a)*o||.01,d=3===s?(r[n].z+e[n].z*a)*o||.01:0,l=Math.sqrt(u*u+h*h+d*d);if(l>i){var c=i/l;u*=c,h*=c,d*=c}r[n]={x:u,y:h,z:d}}))},t.prototype.updatePosition=function(t,e,r,n){var o=this,i=n.distanceThresholdMode,a=n.interval,s=n.dimensions,u=e.getAllNodes();if(null==u?void 0:u.length){var h=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),u.forEach((function(n){var u=n.id,d=t.getNode(u);if(x(d.data.fx)&&x(d.data.fy))e.mergeNodeData(u,{x:d.data.fx,y:d.data.fy});else{var l=r[u].x*a,c=r[u].y*a,f=3===s?r[u].z*a:0;e.mergeNodeData(u,{x:n.data.x+l,y:n.data.y+c,z:n.data.z+f});var g=Math.sqrt(l*l+c*c+f*f);switch(i){case"max":o.judgingDistance<g&&(o.judgingDistance=g);break;case"min":o.judgingDistance>g&&(o.judgingDistance=g);break;default:h+=g}}})),i&&"mean"!==i||(this.judgingDistance=h/u.length)}else this.judgingDistance=0},t}(),zr=function(t,e){var r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};var n={};return r.forEach((function(r,o){1===t.getDegree(r.id,"both")&&(n[r.id]=Ir(t,"leaf",r,e))})),n},Ir=function(t,e,r,n){var o=t.getDegree(r.id,"in"),i=t.getDegree(r.id,"out"),a=r,s=[];return 0===o?(a=t.getSuccessors(r.id)[0],s=t.getNeighbors(a.id)):0===i&&(a=t.getPredecessors(r.id)[0],s=t.getNeighbors(a.id)),s=s.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")})),{coreNode:a,siblingLeaves:s,sameTypeLeaves:Dr(t,e,n,r,s)}},Dr=function(t,e,r,n,o){var i=n.data[r]||"",a=(null==o?void 0:o.filter((function(t){return t.data[r]===i})))||[];return"leaf"===e&&(a=a.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")}))),a},Or=function(t){var e={x:0,y:0};t.forEach((function(t){var r=t.data,n=r.x,o=r.y;e.x+=n||0,e.y+=o||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},Pr=function(t,e){return e.map((function(e){var r=e.id,o=e.data,i=t.getNode(r);return n(n({},i),{data:n(n({},i.data),{x:o.x,y:o.y,z:o.z})})}))},Tr=function(){function t(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}return t.prototype.distanceTo=function(t){var e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)},t.prototype.setPos=function(t,e){this.rx=t,this.ry=e},t.prototype.resetForce=function(){this.fx=0,this.fy=0},t.prototype.addForce=function(t){var e=t.rx-this.rx,r=t.ry-this.ry,n=Math.hypot(e,r);n=n<1e-4?1e-4:n;var o=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=o*e/n,this.fy+=o*r/n},t.prototype.in=function(t){return t.contains(this.rx,this.ry)},t.prototype.add=function(e){var r=this.mass+e.mass;return new t({rx:(this.rx*this.mass+e.rx*e.mass)/r,ry:(this.ry*this.mass+e.ry*e.mass)/r,mass:r,degree:this.degree+e.degree})},t}();const Cr=Tr;const qr=function(){function t(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}return t.prototype.getLength=function(){return this.length},t.prototype.contains=function(t,e){var r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r},t.prototype.NW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.NE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.SW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t.prototype.SE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t}(),Lr=function(){function t(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}return t.prototype.insert=function(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e},t.prototype._putBody=function(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))},t.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},t.prototype.updateForce=function(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))},t}();var jr={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Fr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2",this.options=n(n({},jr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,x,E,b,M,S,k,A,R;return a(this,(function(a){if(o=e.getAllEdges(),i=e.getAllNodes(),s=this.formatOptions(r,i.length),u=s.width,h=s.height,d=s.prune,l=s.maxIteration,f=s.nodeSize,g=s.center,!(null==i?void 0:i.length)||1===i.length)return[2,_(e,t,g)];if(p=i.map((function(t){return N(t,[u,h])})),v=o.filter((function(t){return t.source!==t.target})),y=new c({nodes:p,edges:v}),m=this.getSizes(y,e,f),this.run(y,e,l,m,t,s),d){for(w=0;w<v.length;w+=1)x=v[w],E=x.source,b=x.target,M=y.getDegree(E),S=y.getDegree(E),M<=1?(k=y.getNode(b),y.mergeNodeData(E,{x:k.data.x,y:k.data.y})):S<=1&&(A=y.getNode(E),y.mergeNodeData(b,{x:A.data.x,y:A.data.y}));R=n(n({},s),{prune:!1,barnesHut:!1}),this.run(y,e,100,m,t,R)}return[2,{nodes:p,edges:o}]}))}))},t.prototype.getSizes=function(t,e,r){for(var n=t.getAllNodes(),o={},i=0;i<n.length;i+=1){var a=n[i],s=a.id,h=a.data;if(o[s]=10,x(h.size))o[s]=h.size;else if(g(h.size))isNaN(h.size[0])||(o[s]=Math.max(h.size[0])),isNaN(h.size[1])||(o[s]=Math.max(h.size[1]));else if(M(h.size))o[s]=Math.max(h.size.width,h.size.height);else if(b(r)){var d=r(e.getNode(s));g(d)?o[s]=Math.max.apply(Math,u(d)):o[s]=d}else g(r)?o[s]=Math.max.apply(Math,u(r)):x(r)&&(o[s]=r)}return o},t.prototype.formatOptions=function(t,e){void 0===t&&(t={});var r=n(n({},this.options),t),o=r.center,i=r.width,a=r.height,s=r.barnesHut,u=r.prune,h=r.maxIteration,d=r.kr,l=r.kg;return r.width=i||"undefined"==typeof window?i:window.innerWidth,r.height=a||"undefined"==typeof window?a:window.innerHeight,r.center=o||[r.width/2,r.height/2],void 0===s&&e>250&&(r.barnesHut=!0),void 0===u&&e>100&&(r.prune=!0),0!==h||u?0===h&&u&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)):(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)),d||(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),l||(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r},t.prototype.run=function(t,e,r,n,o,i){for(var a=i.kr,s=i.barnesHut,u=i.onTick,h=t.getAllNodes(),d=0,l=r,c={},f={},g={},p=0;p<h.length;p+=1){var v=h[p],y=v.data,m=v.id;if(c[m]=[0,0],s){var w={id:p,rx:y.x,ry:y.y,mass:1,g:a,degree:t.getDegree(m)};g[m]=new Cr(w)}}for(;l>0;)d=this.oneStep(t,{iter:l,preventOverlapIters:50,krPrime:100,sg:d,forces:c,preForces:f,bodies:g,sizes:n},i),l--,null==u||u({nodes:h,edges:e.getAllEdges()});return t},t.prototype.oneStep=function(t,e,r){for(var n=e.iter,o=e.preventOverlapIters,i=e.krPrime,a=e.sg,s=e.preForces,h=e.bodies,d=e.sizes,l=e.forces,c=r.preventOverlap,f=r.barnesHut,g=t.getAllNodes(),p=0;p<g.length;p+=1){var v=g[p].id;s[v]=u(l[v]),l[v]=[0,0]}return l=this.getAttrForces(t,n,o,d,l,r),l=f&&(c&&n>o||!c)?this.getOptRepGraForces(t,l,h,r):this.getRepGraForces(t,n,o,l,i,d,r),this.updatePos(t,l,s,a,r)},t.prototype.getAttrForces=function(t,e,r,n,o,i){for(var a=i.preventOverlap,s=i.dissuadeHubs,u=i.mode,h=i.prune,d=t.getAllEdges(),l=0;l<d.length;l+=1){var c=d[l],f=c.source,g=c.target,p=t.getNode(f),v=t.getNode(g),y=t.getDegree(f),m=t.getDegree(g);if(!h||!(y<=1||m<=1)){var w=[v.data.x-p.data.x,v.data.y-p.data.y],x=Math.hypot(w[0],w[1]);x=x<1e-4?1e-4:x,w[0]=w[0]/x,w[1]=w[1]/x,a&&e<r&&(x=x-n[f]-n[g]);var E=x,N=E;"linlog"===u&&(N=E=Math.log(1+x)),s&&(E=x/y,N=x/m),a&&e<r&&x<=0?(E=0,N=0):a&&e<r&&x>0&&(E=x,N=x),o[f][0]+=E*w[0],o[g][0]-=N*w[0],o[f][1]+=E*w[1],o[g][1]-=N*w[1]}}return o},t.prototype.getOptRepGraForces=function(t,e,r,n){for(var o=n.kg,i=n.center,a=n.prune,s=t.getAllNodes(),u=s.length,h=9e10,d=-9e10,l=9e10,c=-9e10,f=0;f<u;f+=1){var g=s[f],p=g.id,v=g.data;a&&t.getDegree(p)<=1||(r[p].setPos(v.x,v.y),v.x>=d&&(d=v.x),v.x<=h&&(h=v.x),v.y>=c&&(c=v.y),v.y<=l&&(l=v.y))}var y=Math.max(d-h,c-l),m=new qr({xmid:(d+h)/2,ymid:(c+l)/2,length:y,massCenter:i,mass:u}),w=new Lr(m);for(f=0;f<u;f+=1)p=s[f].id,a&&t.getDegree(p)<=1||r[p].in(m)&&w.insert(r[p]);for(f=0;f<u;f+=1){var x=s[f],E=(p=x.id,v=x.data,t.getDegree(p));if(!(a&&E<=1)){r[p].resetForce(),w.updateForce(r[p]),e[p][0]-=r[p].fx,e[p][1]-=r[p].fy;var N=[v.x-i[0],v.y-i[1]],b=Math.hypot(N[0],N[1]);b=b<1e-4?1e-4:b,N[0]=N[0]/b,N[1]=N[1]/b;var M=o*(E+1);e[p][0]-=M*N[0],e[p][1]-=M*N[1]}}return e},t.prototype.getRepGraForces=function(t,e,r,n,o,i,a){for(var s=a.preventOverlap,u=a.kr,h=a.kg,d=a.center,l=a.prune,c=t.getAllNodes(),f=c.length,g=0;g<f;g+=1){for(var p=c[g],v=t.getDegree(p.id),y=g+1;y<f;y+=1){var m=c[y],w=t.getDegree(m.id);if(!l||!(v<=1||w<=1)){var x=[m.data.x-p.data.x,m.data.y-p.data.y],E=Math.hypot(x[0],x[1]);E=E<1e-4?1e-4:E,x[0]=x[0]/E,x[1]=x[1]/E,s&&e<r&&(E=E-i[p.id]-i[m.id]);var N=u*(v+1)*(w+1)/E;s&&e<r&&E<0?N=o*(v+1)*(w+1):s&&e<r&&0===E?N=0:s&&e<r&&E>0&&(N=u*(v+1)*(w+1)/E),n[p.id][0]-=N*x[0],n[m.id][0]+=N*x[0],n[p.id][1]-=N*x[1],n[m.id][1]+=N*x[1]}}var b=[p.data.x-d[0],p.data.y-d[1]],M=Math.hypot(b[0],b[1]);b[0]=b[0]/M,b[1]=b[1]/M;var S=h*(v+1);n[p.id][0]-=S*b[0],n[p.id][1]-=S*b[1]}return n},t.prototype.updatePos=function(t,e,r,n,o){for(var i=o.ks,a=o.tao,s=o.prune,u=o.ksmax,h=t.getAllNodes(),d=h.length,l=[],c=[],f=0,g=0,p=n,v=0;v<d;v+=1){var y=h[v].id,m=t.getDegree(y);if(!(s&&m<=1)){var w=[e[y][0]-r[y][0],e[y][1]-r[y][1]],E=Math.hypot(w[0],w[1]),N=[e[y][0]+r[y][0],e[y][1]+r[y][1]],b=Math.hypot(N[0],N[1]);l[v]=E,c[v]=b/2,f+=(m+1)*l[v],g+=(m+1)*c[v]}}var M=p;for(p=a*g/f,0!==M&&(p=p>1.5*M?1.5*M:p),v=0;v<d;v+=1){var S=h[v],k=(y=S.id,S.data);if(m=t.getDegree(y),!(s&&m<=1||x(k.fx)&&x(k.fy))){var A=i*p/(1+p*Math.sqrt(l[v])),_=Math.hypot(e[y][0],e[y][1]),R=u/(_=_<1e-4?1e-4:_),z=(A=A>R?R:A)*e[y][0],I=A*e[y][1];t.mergeNodeData(y,{x:k.x+z,y:k.y+I})}}return p},t}(),Vr={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Br=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=n(n({},Vr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericFruchtermanLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,x,E=this;return a(this,(function(a){return this.running?[2]:(o=this.formatOptions(r),i=o.width,s=o.height,u=o.center,h=o.clustering,d=o.nodeClusterBy,l=o.maxIteration,f=o.onTick,g=e.getAllNodes(),p=e.getAllEdges(),(null==g?void 0:g.length)?1===g.length?(t&&e.mergeNodeData(g[0].id,{x:u[0],y:u[1]}),v={nodes:[n(n({},g[0]),{data:n(n({},g[0].data),{x:u[0],y:u[1]})})],edges:p},this.lastResult=v,[2,v]):(y=g.map((function(t){return N(t,[i,s])})),m=new c({nodes:y,edges:p}),w={},h&&y.forEach((function(t){var e=t.data[d];w[e]||(w[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=y,this.lastLayoutEdges=p,this.lastAssign=t,this.lastGraph=m,this.lastOptions=o,this.lastClusterMap=w,"undefined"==typeof window?[2]:(x=0,[2,new Promise((function(r){E.timeInterval=window.setInterval((function(){E.running?(E.runOneStep(m,w,o),t&&y.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y})})),null==f||f({nodes:y,edges:p}),++x>=l&&(window.clearInterval(E.timeInterval),r({nodes:y,edges:p}))):r({nodes:y,edges:p})}),0),E.running=!0}))])):(v={nodes:[],edges:p},this.lastResult=v,[2,v]))}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=n(n({},this.options),t),r=e.clustering,o=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=r&&!!o,e},t.prototype.runOneStep=function(t,e,r){var n=r.height,o=r.width,i=r.gravity,a=r.center,s=r.speed,u=r.clustering,h=r.nodeClusterBy,d=r.clusterGravity,l=n*o,c=Math.sqrt(l)/10,f=t.getAllNodes(),g=l/(f.length+1),p=Math.sqrt(g),v={};if(this.applyCalculate(t,v,p,g),u){for(var y in e)e[y].cx=0,e[y].cy=0,e[y].count=0;for(var y in f.forEach((function(t){var r=t.data,n=e[r[h]];x(r.x)&&(n.cx+=r.x),x(r.y)&&(n.cy+=r.y),n.count++})),e)e[y].cx/=e[y].count,e[y].cy/=e[y].count;var m=d||i;f.forEach((function(t,r){var n=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=e[o[h]],a=Math.sqrt((o.x-i.cx)*(o.x-i.cx)+(o.y-i.cy)*(o.y-i.cy)),s=p*m;v[n].x-=s*(o.x-i.cx)/a,v[n].y-=s*(o.y-i.cy)/a}}))}f.forEach((function(t,e){var r=t.id,n=t.data;if(x(n.x)&&x(n.y)){var o=.01*p*i;v[r].x-=o*(n.x-a[0]),v[r].y-=o*(n.y-a[1])}})),f.forEach((function(e,r){var n=e.id,o=e.data;if(x(o.fx)&&x(o.fy))return o.x=o.fx,void(o.y=o.fy);if(x(o.x)&&x(o.y)){var i=Math.sqrt(v[n].x*v[n].x+v[n].y*v[n].y);if(i>0){var a=Math.min(c*(s/800),i);t.mergeNodeData(n,{x:o.x+v[n].x/i*a,y:o.y+v[n].y/i*a})}}}))},t.prototype.applyCalculate=function(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)},t.prototype.calRepulsive=function(t,e,r){var n=t.getAllNodes();n.forEach((function(t,o){var i=t.data,a=t.id;e[a]={x:0,y:0},n.forEach((function(t,n){var s=t.data,u=t.id;if(!(o<=n)&&x(i.x)&&x(s.x)&&x(i.y)&&x(s.y)){var h=i.x-s.x,d=i.y-s.y,l=h*h+d*d;0===l&&(l=1,h=.01,d=.01);var c=r/l,f=h*c,g=d*c;e[a].x+=f,e[a].y+=g,e[u].x-=f,e[u].y-=g}}))}))},t.prototype.calAttractive=function(t,e,r){t.getAllEdges().forEach((function(n){var o=n.source,i=n.target;if(o&&i&&o!==i){var a=t.getNode(o).data,s=t.getNode(i).data;if(x(s.x)&&x(a.x)&&x(s.y)&&x(a.y)){var u=s.x-a.x,h=s.y-a.y,d=Math.sqrt(u*u+h*h)/r,l=u*d,c=h*d;e[o].x+=l,e[o].y+=c,e[i].x-=l,e[i].y-=c}}}))},t}(),Gr={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},Wr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="grid",this.options=n(n({},Gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericGridLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericGridLayout(!0,t,e),[2]}))}))},t.prototype.genericGridLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,p,v,y,m,w,E,b,M,A,R,z,I,D,P,T,C,q,L,j,F,V,B,G,W,$,U,H,K;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.begin,s=void 0===i?[0,0]:i,u=o.condense,h=o.preventOverlapPadding,d=o.preventOverlap,l=o.rows,c=o.cols,f=o.nodeSpacing,p=o.nodeSize,v=o.width,y=o.height,m=o.position,w=o.sortBy,E=e.getAllNodes(),b=e.getAllEdges(),!(M=null==E?void 0:E.length)||1===M)return[2,_(e,t,s)];if(A=E.map((function(t){return N(t)})),"id"===w||O(w)&&void 0!==A[0].data[w]||(w="degree"),"degree"===w?A.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):"id"===w?A.sort((function(t,e){return x(e.id)&&x(t.id)?e.id-t.id:(""+t.id).localeCompare(""+e.id)})):A.sort((function(t,e){return e.data[w]-t.data[w]})),R=v||"undefined"==typeof window?v:window.innerWidth,z=y||"undefined"==typeof window?y:window.innerHeight,I=M,D={rows:l,cols:c},null!=l&&null!=c?(D.rows=l,D.cols=c):null!=l&&null==c?(D.rows=l,D.cols=Math.ceil(I/D.rows)):null==l&&null!=c?(D.cols=c,D.rows=Math.ceil(I/D.cols)):(P=Math.sqrt(I*z/R),D.rows=Math.round(P),D.cols=Math.round(R/z*P)),D.rows=Math.max(D.rows,1),D.cols=Math.max(D.cols,1),D.cols*D.rows>I)T=$r(D),C=Ur(D),(T-1)*C>=I?$r(D,T-1):(C-1)*T>=I&&Ur(D,C-1);else for(;D.cols*D.rows<I;)T=$r(D),((C=Ur(D))+1)*T>=I?Ur(D,C+1):$r(D,T+1);for(q=u?0:R/D.cols,L=u?0:z/D.rows,(d||f)&&(j=S(10,f),F=k(30,p,!1),A.forEach((function(t){t.data.x&&t.data.y||(t.data.x=0,t.data.y=0);var r,n,o=e.getNode(t.id),i=F(o)||30;g(i)?(r=i[0],n=i[1]):(r=i,n=i);var a=void 0!==j?j(t):h,s=r+a,u=n+a;q=Math.max(q,s),L=Math.max(L,u)}))),V={},B={row:0,col:0},G={},W=0;W<A.length;W++){if($=A[W],U=void 0,m&&(U=m(e.getNode($.id))),U&&(void 0!==U.row||void 0!==U.col)){if(void 0===(H={row:U.row,col:U.col}).col)for(H.col=0;Hr(V,H);)H.col++;else if(void 0===H.row)for(H.row=0;Hr(V,H);)H.row++;G[$.id]=H,Kr(V,H)}Jr($,s,q,L,G,D,B,V)}return K={nodes:A,edges:b},t&&A.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,K]}))}))},t}(),$r=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.min(n,o):Math.min(n,o)===t.rows?t.rows=e:t.cols=e,r},Ur=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.max(n,o):Math.max(n,o)===t.rows?t.rows=e:t.cols=e,r},Hr=function(t,e){return t["c-"+e.row+"-"+e.col]||!1},Kr=function(t,e){return t["c-"+e.row+"-"+e.col]=!0},Yr=function(t,e){var r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},Jr=function(t,e,r,n,o,i,a,s){var u,h,d=o[t.id];if(d)u=d.col*r+r/2+e[0],h=d.row*n+n/2+e[1];else{for(;Hr(s,a);)Yr(i,a);u=a.col*r+r/2+e[0],h=a.row*n+n/2+e[1],Kr(s,a),Yr(i,a)}t.data.x=u,t.data.y=h};const Xr=Object.prototype.toString;function Qr(t){const e=Xr.call(t);return e.endsWith("Array]")&&!e.includes("Big")}function Zr(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!Qr(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]<a&&(a=t[s]);return a}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]>a&&(a=t[s]);return a}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,a=void 0===i?r.autoMinMax?n:0:i,s=r.max,u=void 0===s?r.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var h=(u-a)/(o-n),d=0;d<t.length;d++)e[d]=(t[d]-n)*h+a;return e}const tn=" ".repeat(2),en=" ".repeat(4);function rn(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=e;return`${t.constructor.name} {\\n${tn}[\\n${en}${function(t,e,r,n,o){const{rows:i,columns:a}=t,s=Math.min(i,e),u=Math.min(a,r),h=[];if("auto"===o){o=!1;t:for(let e=0;e<s;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let e=0;e<s;e++){let r=[];for(let i=0;i<u;i++)r.push(nn(t.get(e,i),n,o));h.push(`${r.join(" ")}`)}return u!==a&&(h[h.length-1]+=` ... ${a-r} more columns`),s!==i&&h.push(`... ${i-e} more rows`),h.join(`\\n${en}`)}(t,r,n,o,i)}\\n${tn}]\\n${tn}rows: ${t.rows}\\n${tn}columns: ${t.columns}\\n}`}function nn(t,e,r){return(t>=0&&r?` ${on(t,e-1)}`:on(t,e)).padEnd(e)}function on(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function an(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function sn(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function un(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function hn(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function dn(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(cn("startRow",e),cn("endRow",r),cn("startColumn",n),cn("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function ln(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function cn(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function fn(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class gn{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new vn(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new vn(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new vn(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new vn(t,e)}static ones(t,e){return new vn(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new vn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)o.set(r,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let a=o-n,s=new vn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(i()*a);s.set(r,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let t=0;t<n;t++)o.set(t,t,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let e=0;e<o;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new vn(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return gn.isMatrix(t)?t:new vn(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let a=o;a<e;a++){let e=t.get(r,a)-i*t.get(n,a);t.set(r,a,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new vn(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){an(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return vn.rowVector(this.getRow(t))}setRow(t,e){an(this,t),e=un(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){an(this,t),an(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){sn(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return vn.columnVector(this.getColumn(t))}setColumn(t,e){sn(this,t),e=hn(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){sn(this,t),sn(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){an(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){sn(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){fn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){fn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(an(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){an(this,t),fn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(an(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){an(this,t),fn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(sn(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){sn(this,t),fn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(sn(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){sn(this,t),fn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){gn.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=vn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new vn(e,n),i=new Float64Array(r);for(let a=0;a<n;a++){for(let e=0;e<r;e++)i[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,a,e)}}return o}strassen2x2(t){t=vn.checkMatrix(t);let e=new vn(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),h=t.get(1,1),d=(r+u)*(n+h),l=(a+u)*n,c=r*(i-h),f=u*(s-n),g=(r+o)*h,p=d+f-g+(o-u)*(s+h),v=c+g,y=l+f,m=d-l+c+(a-r)*(n+i);return e.set(0,0,p),e.set(0,1,v),e.set(1,0,y),e.set(1,1,m),e}strassen3x3(t){t=vn.checkMatrix(t);let e=new vn(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),h=this.get(2,1),d=this.get(2,2),l=t.get(0,0),c=t.get(0,1),f=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),y=t.get(2,0),m=t.get(2,1),w=t.get(2,2),x=(r-i)*(-c+p),E=(-r+i+a)*(l-c+p),N=(i+a)*(-l+c),b=r*l,M=(-r+u+h)*(l-f+v),S=(-r+u)*(f-v),k=(u+h)*(-l+f),A=(-o+h+d)*(p+y-m),_=(o-d)*(p-m),R=o*y,z=(h+d)*(-y+m),I=(-o+a+s)*(v+y-w),D=(o-s)*(v-w),O=(a+s)*(-y+w),P=b+R+n*g,T=(r+n+o-i-a-h-d)*p+E+N+b+A+R+z,C=b+M+k+(r+n+o-a-s-u-h)*v+R+I+O,q=x+a*(-l+c+g-p-v-y+w)+E+b+R+I+D,L=x+E+N+b+s*m,j=R+I+D+O+i*f,F=b+M+S+h*(-l+f+g-p-v-y+m)+A+_+R,V=A+_+R+z+u*c,B=b+M+S+k+d*w;return e.set(0,0,P),e.set(0,1,T),e.set(0,2,C),e.set(1,0,q),e.set(1,1,L),e.set(1,2,j),e.set(2,0,F),e.set(2,1,V),e.set(2,2,B),e}mmulStrassen(t){t=vn.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function a(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=gn.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${r} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let s=Math.max(r,o),u=Math.max(n,i);return e=a(e,s,u),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=a(e,n+1,o+1),r=a(r,n+1,o+1)):n%2==1?(e=a(e,n+1,o),r=a(r,n+1,o)):o%2==1&&(e=a(e,n,o+1),r=a(r,n,o+1));let i=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,s-1),h=r.subMatrix(0,i-1,0,s-1),d=e.subMatrix(0,i-1,s,e.columns-1),l=r.subMatrix(0,i-1,s,r.columns-1),c=e.subMatrix(i,e.rows-1,0,s-1),f=r.subMatrix(i,r.rows-1,0,s-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),p=r.subMatrix(i,r.rows-1,s,r.columns-1),v=t(gn.add(u,g),gn.add(h,p),i,s),y=t(gn.add(c,g),h,i,s),m=t(u,gn.sub(l,p),i,s),w=t(g,gn.sub(f,h),i,s),x=t(gn.add(u,d),p,i,s),E=t(gn.sub(c,u),gn.add(h,l),i,s),N=t(gn.sub(d,g),gn.add(f,p),i,s),b=gn.add(v,w);b.sub(x),b.add(N);let M=gn.add(m,x),S=gn.add(y,w),k=gn.sub(v,y);k.add(m),k.add(E);let A=gn.zeros(2*b.rows,2*b.columns);return A=A.setSubMatrix(b,0,0),A=A.setSubMatrix(M,b.rows,0),A=A.setSubMatrix(S,0,b.columns),A=A.setSubMatrix(k,b.rows,b.columns),A.subMatrix(0,n-1,0,o-1)}(e,t=a(t,s,u),s,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new vn(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&Zr(o,{min:e,max:r,output:o}),n.setRow(t,o)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new vn(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&Zr(o,{min:e,max:r,output:o}),n.setColumn(t,o)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=vn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new vn(e*n,r*o);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<o;s++)i.set(n*a+r,o*e+s,this.get(a,e)*t.get(r,s));return i}kroneckerSum(t){if(t=vn.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(vn.eye(r,r)),o=vn.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new vn(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=pn){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=pn){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){dn(this,t,e,r,n);let o=new vn(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new vn(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new vn(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=vn.checkMatrix(t)).isEmpty())return this;dn(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){!function(t,e){if(!Qr(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!Qr(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new vn(t.length,e.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<e.length;t++){let i=e[t];r.set(n,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new vn(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=ln(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=ln(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=ln(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=ln(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Qr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<n;a++){let n=0,s=0,u=0;for(let e=0;e<o;e++)u=t.get(a,e)-r[a],n+=u,s+=u*u;e?i.push((s-n*n/o)/(o-1)):i.push((s-n*n/o)/o)}return i}(this,r,n);case"column":if(!Qr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<o;a++){let o=0,s=0,u=0;for(let e=0;e<n;e++)u=t.get(e,a)-r[a],o+=u,s+=u*u;e?i.push((s-o*o/n)/(n-1)):i.push((s-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let a=0,s=0,u=0;for(let e=0;e<n;e++)for(let n=0;n<o;n++)u=t.get(e,n)-r,a+=u,s+=u*u;return e?(s-a*a/i)/(i-1):(s-a*a/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Qr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!Qr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!Qr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!Qr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return rn(this,t)}}function pn(t,e){return t-e}gn.prototype.klass="Matrix","undefined"!=typeof Symbol&&(gn.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return rn(this)}),gn.random=gn.rand,gn.randomInt=gn.randInt,gn.diagonal=gn.diag,gn.prototype.diagonal=gn.prototype.diag,gn.identity=gn.eye,gn.prototype.negate=gn.prototype.neg,gn.prototype.tensorProduct=gn.prototype.kroneckerProduct;class vn extends gn{constructor(t,e){if(super(),vn.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Qr(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!r[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return an(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),an(this,t,!0),e=Float64Array.from(un(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){sn(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),sn(this,t,!0),e=hn(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(gn,vn);class yn extends gn{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function mn(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class wn{constructor(t,e={}){if((t=yn.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=e;let s,u=Boolean(o),h=Boolean(i),d=!1;if(r<n)if(a){s=t.transpose(),r=s.rows,n=s.columns,d=!0;let e=u;u=h,h=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let l=Math.min(r,n),c=Math.min(r+1,n),f=new Float64Array(c),g=new vn(r,l),p=new vn(n,n),v=new Float64Array(n),y=new Float64Array(r),m=new Float64Array(c);for(let t=0;t<c;t++)m[t]=t;let w=Math.min(r-1,n),x=Math.max(0,Math.min(n-2,r)),E=Math.max(w,x);for(let t=0;t<E;t++){if(t<w){f[t]=0;for(let e=t;e<r;e++)f[t]=mn(f[t],s.get(e,t));if(0!==f[t]){s.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<r;e++)s.set(e,t,s.get(e,t)/f[t]);s.set(t,t,s.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<n;e++){if(t<w&&0!==f[t]){let n=0;for(let o=t;o<r;o++)n+=s.get(o,t)*s.get(o,e);n=-n/s.get(t,t);for(let o=t;o<r;o++)s.set(o,e,s.get(o,e)+n*s.get(o,t))}v[e]=s.get(t,e)}if(u&&t<w)for(let e=t;e<r;e++)g.set(e,t,s.get(e,t));if(t<x){v[t]=0;for(let e=t+1;e<n;e++)v[t]=mn(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<n;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<r&&0!==v[t]){for(let e=t+1;e<r;e++)y[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)y[e]+=v[r]*s.get(e,r);for(let e=t+1;e<n;e++){let n=-v[e]/v[t+1];for(let o=t+1;o<r;o++)s.set(o,e,s.get(o,e)+n*y[o])}}if(h)for(let e=t+1;e<n;e++)p.set(e,t,v[e])}}let N=Math.min(n,r+1);if(w<n&&(f[w]=s.get(w,w)),r<N&&(f[N-1]=0),x+1<N&&(v[x]=s.get(x,N-1)),v[N-1]=0,u){for(let t=w;t<l;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<l;e++){let n=0;for(let o=t;o<r;o++)n+=g.get(o,t)*g.get(o,e);n=-n/g.get(t,t);for(let o=t;o<r;o++)g.set(o,e,g.get(o,e)+n*g.get(o,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(h)for(let t=n-1;t>=0;t--){if(t<x&&0!==v[t])for(let e=t+1;e<n;e++){let r=0;for(let o=t+1;o<n;o++)r+=p.get(o,t)*p.get(o,e);r=-r/p.get(t+1,t);for(let o=t+1;o<n;o++)p.set(o,e,p.get(o,e)+r*p.get(o,t))}for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}let b=N-1,M=0,S=Number.EPSILON;for(;N>0;){let t,e;for(t=N-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===N-2)e=4;else{let r;for(r=N-1;r>=t&&r!==t;r--){let e=(r!==N?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(f[r])<=S*e){f[r]=0;break}}r===t?e=3:r===N-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[N-2];v[N-2]=0;for(let r=N-2;r>=t;r--){let o=mn(f[r],e),i=f[r]/o,a=e/o;if(f[r]=o,r!==t&&(e=-a*v[r-1],v[r-1]=i*v[r-1]),h)for(let t=0;t<n;t++)o=i*p.get(t,r)+a*p.get(t,N-1),p.set(t,N-1,-a*p.get(t,r)+i*p.get(t,N-1)),p.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<N;n++){let o=mn(f[n],e),i=f[n]/o,a=e/o;if(f[n]=o,e=-a*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g.get(e,n)+a*g.get(e,t-1),g.set(e,t-1,-a*g.get(e,n)+i*g.get(e,t-1)),g.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(f[N-1]),Math.abs(f[N-2]),Math.abs(v[N-2]),Math.abs(f[t]),Math.abs(v[t])),o=f[N-1]/e,i=f[N-2]/e,a=v[N-2]/e,s=f[t]/e,d=v[t]/e,l=((i+o)*(i-o)+a*a)/2,c=o*a*(o*a);let y=0;0===l&&0===c||(y=l<0?0-Math.sqrt(l*l+c):Math.sqrt(l*l+c),y=c/(l+y));let m=(s+o)*(s-o)+y,w=s*d;for(let e=t;e<N-1;e++){let o=mn(m,w);0===o&&(o=Number.MIN_VALUE);let i=m/o,a=w/o;if(e!==t&&(v[e-1]=o),m=i*f[e]+a*v[e],v[e]=i*v[e]-a*f[e],w=a*f[e+1],f[e+1]=i*f[e+1],h)for(let t=0;t<n;t++)o=i*p.get(t,e)+a*p.get(t,e+1),p.set(t,e+1,-a*p.get(t,e)+i*p.get(t,e+1)),p.set(t,e,o);if(o=mn(m,w),0===o&&(o=Number.MIN_VALUE),i=m/o,a=w/o,f[e]=o,m=i*v[e]+a*f[e+1],f[e+1]=-a*v[e]+i*f[e+1],w=a*v[e+1],v[e+1]=i*v[e+1],u&&e<r-1)for(let t=0;t<r;t++)o=i*g.get(t,e)+a*g.get(t,e+1),g.set(t,e+1,-a*g.get(t,e)+i*g.get(t,e+1)),g.set(t,e,o)}v[N-2]=m,M+=1;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,h))for(let e=0;e<=b;e++)p.set(e,t,-p.get(e,t));for(;t<b&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,h&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}M=0,N--}}if(d){let t=p;p=g,g=t}this.m=r,this.n=n,this.s=f,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,o=vn.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?o.set(t,t,0):o.set(t,t,1/this.s[t]);let i=this.U,a=this.rightSingularVectors,s=a.mmul(o),u=a.rows,h=i.rows,d=vn.zeros(u,h);for(let t=0;t<u;t++)for(let e=0;e<h;e++){let r=0;for(let o=0;o<n;o++)r+=s.get(t,o)*i.get(e,o);d.set(t,e,r)}return d.mmul(e)}solveForDiagonal(t){return this.solve(vn.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new vn(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,a=i.rows,s=i.columns,u=new vn(r,a);for(let t=0;t<r;t++)for(let e=0;e<a;e++){let r=0;for(let n=0;n<s;n++)r+=o.get(t,n)*i.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return vn.diag(this.s)}}var xn,En={center:[0,0],linkDistance:50},Nn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="mds",this.options=n(n({},En),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericMDSLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericMDSLayout(!0,t,e),[2]}))}))},t.prototype.genericMDSLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,g,y;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=void 0===i?[0,0]:i,u=o.linkDistance,h=void 0===u?50:u,d=e.getAllNodes(),l=e.getAllEdges(),(null==d?void 0:d.length)&&1!==d.length?(c=v({nodes:d,edges:l},!1),f=p(c),bn(f),m=h,w=[],f.forEach((function(t){var e=[];t.forEach((function(t){e.push(t*m)})),w.push(e)})),g=Mn(w),y=[],g.forEach((function(t,e){var r=N(d[e]);r.data.x=t[0]+s[0],r.data.y=t[1]+s[1],y.push(r)})),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:y,edges:l}]):[2,_(e,t,s)];var m,w}))}))},t}(),bn=function(t){var e=-999999;t.forEach((function(t){t.forEach((function(t){t!==1/0&&e<t&&(e=t)}))})),t.forEach((function(r,n){r.forEach((function(r,o){r===1/0&&(t[n][o]=e)}))}))},Mn=function(t){var e=vn.mul(vn.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),o=e.mean();e.add(o).subRowVector(r).subColumnVector(n);var i=new wn(e),a=vn.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((function(t){return vn.mul([t],[a]).toJSON()[0].splice(0,2)}))},Sn={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},kn=function(t,e,r,n,o,i){e.forEach((function(a,s){r[s]={x:0,y:0},e.forEach((function(e,u){if(s!==u&&o[s]===o[u]){var h=a.x-e.x,d=a.y-e.y,l=Math.sqrt(h*h+d*d);if(0===l){l=1;var c=s>u?1:-1;h=.01*c,d=.01*c}if(l<i(t[s])/2+i(t[u])/2){var f=n*n/l;r[s].x+=h/l*f,r[s].y+=d/l*f}}}))}))},An=function(t,e,r,n,o,i,a,s){var u=i||a/10;return n&&e.forEach((function(e,r){var n=t[r].x-t[o].x,i=t[r].y-t[o].y,a=Math.sqrt(n*n+i*i),s=i/a,u=-n/a,h=Math.sqrt(e.x*e.x+e.y*e.y),d=Math.acos((s*e.x+u*e.y)/h);d>Math.PI/2&&(d-=Math.PI/2,s*=-1,u*=-1);var l=Math.cos(d)*h;e.x=s*l,e.y=u*l})),t.forEach((function(i,a){if(a!==o){var h=Math.sqrt(e[a].x*e[a].x+e[a].y*e[a].y);if(h>0&&a!==o){var d=Math.min(u*(r/800),h);if(i.x+=e[a].x/h*d,i.y+=e[a].y/h*d,n){var l=i.x-t[o].x,c=i.y-t[o].y,f=Math.sqrt(l*l+c*c);l=l/f*s[a],c=c/f*s[a],i.x=t[o].x+l,i.y=t[o].y+c}}}})),t},_n={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},Rn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="radial",this.options=n(n({},_n),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRadialLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRadialLayout(!0,t,e),[2]}))}))},t.prototype.genericRadialLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,h,d,l,c,f,g,y,m,w,x,E,b,M,S,k,R,z,I,D,P,T,C,q,L,j,F,V,B,G,W,$,U,H,K,Y,J,X,Q,Z,tt,et;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,h=o.height,d=o.center,l=o.focusNode,c=o.unitRadius,f=o.nodeSize,g=o.nodeSpacing,y=o.strictRadial,m=o.preventOverlap,w=o.maxPreventOverlapIteration,x=o.sortBy,E=o.linkDistance,b=void 0===E?50:E,M=o.sortStrength,S=void 0===M?10:M,k=o.maxIteration,R=void 0===k?1e3:k,z=e.getAllNodes(),I=e.getAllEdges(),D=i||"undefined"==typeof window?i:window.innerWidth,P=h||"undefined"==typeof window?h:window.innerHeight,T=d||[D/2,P/2],!(null==z?void 0:z.length)||1===z.length)return[2,_(e,t,T)];if(C=z[0],O(l)){for(q=0;q<z.length;q++)if(z[q].id===l){C=z[q];break}}else C=l||z[0];return L=Dn(z,C.id),j=v({nodes:z,edges:I},!1),F=p(j),V=Pn(F,L),On(F,L,V+1),B=F[L],G=D-T[0]>T[0]?T[0]:D-T[0],W=P-T[1]>T[1]?T[1]:P-T[1],0===G&&(G=D/2),0===W&&(W=P/2),$=Math.min(G,W),U=Math.max.apply(Math,u(B)),H=[],K=c||$/U,B.forEach((function(t,e){H[e]=t*K})),Y=zn(z,F,b,H,K,x,S),J=In(Y),X=function(t,e,r){try{var n=vn.mul(vn.pow(e,2),-.5),o=n.mean("row"),i=n.mean("column"),a=n.mean();n.add(a).subRowVector(o).subColumnVector(i);var s=new wn(n),u=vn.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((function(e){return vn.mul([e],[u]).toJSON()[0].splice(0,t)}))}catch(t){for(var h=[],d=0;d<e.length;d++){var l=Math.random()*r,c=Math.random()*r;h.push([l,c])}return h}}(b,Y,b),Q=X.map((function(t){var e=s(t,2),r=e[0],n=e[1];return{x:(isNaN(r)?Math.random()*b:r)-X[L][0],y:(isNaN(n)?Math.random()*b:n)-X[L][1]}})),this.run(R,Q,J,Y,H,L),m&&(Z=A(f,g),tt={nodes:z,nodeSizeFunc:Z,positions:Q,radii:H,height:P,width:D,strictRadial:Boolean(y),focusIdx:L,iterations:w||200,k:Q.length/4.5},Q=function(t,e){for(var r=n(n({},Sn),e),o=r.positions,i=r.iterations,a=r.width,s=r.k,u=r.speed,h=void 0===u?100:u,d=r.strictRadial,l=r.focusIdx,c=r.radii,f=void 0===c?[]:c,g=r.nodeSizeFunc,p=t.getAllNodes(),v=[],y=a/10,m=0;m<i;m++)o.forEach((function(t,e){v[e]={x:0,y:0}})),kn(p,o,v,s,f,g),An(o,v,h,d,l,y,a,f);return o}(e,tt)),et=[],Q.forEach((function(t,e){var r=N(z[e]);r.data.x=t.x+T[0],r.data.y=t.y+T[1],et.push(r)})),t&&et.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:et,edges:I}]}))}))},t.prototype.run=function(t,e,r,n,o,i){for(var a=0;a<=t;a++){var s=a/t;this.oneIteration(s,e,o,n,r,i)}},t.prototype.oneIteration=function(t,e,r,n,o,i){var a=1-t;e.forEach((function(s,u){var h=y(s,{x:0,y:0}),d=0===h?0:1/h;if(u!==i){var l=0,c=0,f=0;e.forEach((function(t,e){if(u!==e){var r=y(s,t),i=0===r?0:1/r,a=n[e][u];f+=o[u][e],l+=o[u][e]*(t.x+a*(s.x-t.x)*i),c+=o[u][e]*(t.y+a*(s.y-t.y)*i)}}));var g=0===r[u]?0:1/r[u];f*=a,f+=t*g*g,l*=a,l+=t*g*s.x*d,s.x=l/f,c*=a,c+=t*g*s.y*d,s.y=c/f}}))},t}(),zn=function(t,e,r,n,o,i,a){if(!t)return[];var s=[];if(e){var u={};e.forEach((function(e,h){var d=[];e.forEach((function(e,s){var l,c;if(h===s)d.push(0);else if(n[h]===n[s])if("data"===i)d.push(e*(Math.abs(h-s)*a)/(n[h]/o));else if(i){var f=void 0,g=void 0;if(u[t[h].id])f=u[t[h].id];else{var p=("id"===i?t[h].id:null===(l=t[h].data)||void 0===l?void 0:l[i])||0;f=O(p)?p.charCodeAt(0):p,u[t[h].id]=f}u[t[s].id]?g=u[t[s].id]:(p=("id"===i?t[s].id:null===(c=t[s].data)||void 0===c?void 0:c[i])||0,g=O(p)?p.charCodeAt(0):p,u[t[s].id]=g),d.push(e*(Math.abs(f-g)*a)/(n[h]/o))}else d.push(e*r/(n[h]/o));else{var v=(r+o)/2;d.push(e*v)}})),s.push(d)}))}return s},In=function(t){for(var e=t.length,r=t[0].length,n=[],o=0;o<e;o++){for(var i=[],a=0;a<r;a++)0!==t[o][a]?i.push(1/(t[o][a]*t[o][a])):i.push(0);n.push(i)}return n},Dn=function(t,e){var r=-1;return t.forEach((function(t,n){t.id===e&&(r=n)})),Math.max(r,0)},On=function(t,e,r){for(var n=t.length,o=0;o<n;o++)if(t[e][o]===1/0){t[e][o]=r,t[o][e]=r;for(var i=0;i<n;i++)t[o][i]!==1/0&&t[e][i]===1/0&&(t[e][i]=r+t[o][i],t[i][e]=r+t[o][i])}for(o=0;o<n;o++)if(o!==e)for(i=0;i<n;i++)if(t[o][i]===1/0){var a=Math.abs(t[e][o]-t[e][i]);a=0===a?1:a,t[o][i]=a}},Pn=function(t,e){for(var r=0,n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r},Tn={center:[0,0],width:300,height:300},Cn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="random",this.options=n(n({},Tn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRandomLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRandomLayout(!0,t,e),[2]}))}))},t.prototype.genericRandomLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,h=e.getAllNodes(),d=s||"undefined"==typeof window?s:window.innerWidth,l=u||"undefined"==typeof window?u:window.innerHeight,c=i||[d/2,l/2],f=[],h&&h.forEach((function(t){f.push({id:t.id,data:{x:.9*(Math.random()-.5)*d+c[0],y:.9*(Math.random()-.5)*l+c[1]}})})),t&&f.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:f,edges:e.getAllEdges()}]}))}))},t}(),qn={circular:z,concentric:T,mds:Nn,random:Cn,grid:Wr,radial:Rn,force:Rr,d3force:Tt,fruchterman:Br,forceAtlas2:Fr,dagre:pr};function Ln(){var t;(null===(t=xn)||void 0===t?void 0:t.stop)&&xn.stop()}function jn(t,e){return i(this,void 0,void 0,(function(){var r,n,o,i,s,u,h,d,l;return a(this,(function(a){switch(a.label){case 0:if(r=t.layout,n=r.id,o=r.options,i=r.iterations,s=t.nodes,u=t.edges,h=new c({nodes:s,edges:u}),!(d=qn[n]))throw new Error("Unknown layout id: "+n);return[4,(xn=new d(o)).execute(h)];case 1:return l=a.sent(),!!(f=xn).tick&&!!f.stop&&(xn.stop(),l=xn.tick(i)),[2,[l,e]]}var f}))}))}addEventListener("message",(function(t){var r,n=t.data,o=n.type,i=n.method,a=n.id,s=n.params;"RPC"===o&&i&&((r=e[i])?Promise.resolve().then((function(){return r.apply(e,s)})):Promise.reject("No such method")).then((function(t){postMessage({type:"RPC",id:a,result:t})})).catch((function(t){var e={message:t};t.stack&&(e.message=t.message,e.stack=t.stack,e.name=t.name),postMessage({type:"RPC",id:a,error:e})}))})),postMessage({type:"RPC",method:"ready"});\n//# sourceMappingURL=8884498ddca05396fc34.worker.js.map']))),n(t,o),t}},331:t=>{t.exports=function(t,e){var r=0,n={};t.addEventListener("message",(function(e){var r=e.data;if("RPC"===r.type)if(r.id){var o=n[r.id];o&&(delete n[r.id],r.error?o[1](Object.assign(Error(r.error.message),r.error)):o[0](r.result))}else{var i=document.createEvent("Event");i.initEvent(r.method,!1,!1),i.data=r.params,t.dispatchEvent(i)}})),e.forEach((function(e){t[e]=function(){var o=arguments;return new Promise((function(i,a){var s=++r;n[s]=[i,a],t.postMessage({type:"RPC",id:s,method:e,params:[].slice.call(o)})}))}}))}}},g={};function p(t){var e=g[t];if(void 0!==e)return e.exports;var r=g[t]={exports:{}};return f[t](r,r.exports,p),r.exports}p.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return p.d(e,{a:e}),e},p.d=(t,e)=>{for(var r in e)p.o(e,r)&&!p.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},p.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var v={};(()=>{p.d(v,{SB:()=>U,W1:()=>Q,jA:()=>Wt,Vq:()=>br,E9:()=>Wr,y7:()=>Cr,O2:()=>$r,Me:()=>Yr,AI:()=>kn,D4:()=>Cn,_5:()=>Vn,y9:()=>X,_A:()=>f,d9:()=>R,ul:()=>O,qs:()=>E,gl:()=>F,jE:()=>L,tO:()=>P,zJ:()=>b,h$:()=>S,BI:()=>T,$y:()=>D,H0:()=>A,kJ:()=>g,hY:()=>Wn,qR:()=>qn,i_:()=>Bn,nu:()=>N,He:()=>m,A3:()=>_});var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};function n(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function i(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function a(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(e){i(e)}}function s(t){try{u(n.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function s(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(u){s=[6,u],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function u(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function d(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(u(arguments[e]));return t}var h,c,l=/-(\w)/g,f=(h=function(t){return t.replace(l,(function(t,e){return e?e.toUpperCase():""}))},c=Object.create(null),function(t){return c[t]||(c[t]=h(t))}),g=Array.isArray,m=function(t){var e=parseFloat(t);return isNaN(e)?t:e},y={}.toString;const w=function(t,e){return y.call(t)==="[object "+e+"]"},x=function(t){return w(t,"Number")};var E=function(t){for(var e=[],r=t.length,n=0;n<r;n+=1){e[n]=[];for(var o=0;o<r;o+=1)n===o?e[n][o]=0:0!==t[n][o]&&t[n][o]?e[n][o]=t[n][o]:e[n][o]=1/0}for(var i=0;i<r;i+=1)for(n=0;n<r;n+=1)for(o=0;o<r;o+=1)e[n][o]>e[n][i]+e[i][o]&&(e[n][o]=e[n][i]+e[i][o]);return e},b=function(t,e){var r=t.nodes,n=t.edges,o=[],i={};if(!r)throw new Error("invalid nodes data!");return r&&r.forEach((function(t,e){i[t.id]=e,o.push([])})),null==n||n.forEach((function(t){var r=t.source,n=t.target,a=i[r],s=i[n];void 0!==a&&void 0!==s&&(o[a][s]=1,e||(o[s][a]=1))})),o},N=function(t,e){var r=[];return t.forEach((function(t){var n=[];t.forEach((function(t){n.push(t*e)})),r.push(n)})),r},M=function(t,e){if(t&&t.children)for(var r=t.children.length-1;r>=0;r--)if(!M(t.children[r],e))return;return!!e(t)},_=function(t,e){"function"==typeof e&&M(t,e)},A=function(t){var e=1/0,r=1/0,n=-1/0,o=-1/0;return t.forEach((function(t){var i=t.data.size;g(i)?1===i.length&&(i=[i[0],i[0]]):x(i)?i=[i,i]:(void 0===i||isNaN(i))&&(i=[30,30]);var a=[i[0]/2,i[1]/2],s=t.data.x-a[0],u=t.data.x+a[0],d=t.data.y-a[1],h=t.data.y+a[1];e>s&&(e=s),r>d&&(r=d),n<u&&(n=u),o<h&&(o=h)})),{minX:e,minY:r,maxX:n,maxY:o}},S=function(t){var e={x:0,y:0};t.forEach((function(t){e.x+=t.data.x||0,e.y+=t.data.y||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},k=function(t,e,r){var n,o;return"source"===t?(null===(n=null==r?void 0:r.find((function(t){return t.target===e.id})))||void 0===n?void 0:n.source)||{}:(null===(o=null==r?void 0:r.find((function(t){return t.source===e.id})))||void 0===o?void 0:o.target)||{}},I=function(t,e,r){var n=[];switch(t){case"source":n=null==r?void 0:r.filter((function(t){return t.source===e.id})).map((function(t){return t.target}));break;case"target":n=null==r?void 0:r.filter((function(t){return t.target===e.id})).map((function(t){return t.source}));break;case"both":n=null==r?void 0:r.filter((function(t){return t.source===e.id})).map((function(t){return t.target})).concat(null==r?void 0:r.filter((function(t){return t.target===e.id})).map((function(t){return t.source})))}var o=new Set(n);return Array.from(o)},T=function(t,e,r,n,o,i){var a,s,u,d,h,c,l=o[e.id],f=l.in,g=l.out,p=e,v=[];return 0===f?(p=k("source",e,r),v=I("both",p,r).map((function(t){return i[t]}))):0===g&&(p=k("target",e,r),v=I("both",p,r).map((function(t){return i[t]}))),{coreNode:p,relativeLeafNodes:v=v.filter((function(t){return o[t.id]&&(0===o[t.id].in||0===o[t.id].out)})),sameTypeLeafNodes:(a=t,u=v,d=o,h=e[s=n]||"",c=(null==u?void 0:u.filter((function(t){return t[s]===h})))||[],"leaf"===a&&(c=c.filter((function(t){var e,r;return 0===(null===(e=d[t.id])||void 0===e?void 0:e.in)||0===(null===(r=d[t.id])||void 0===r?void 0:r.out)}))),c)}},D=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},R=function(t){if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var e=[];return t.forEach((function(t){e.push(t)})),e.map((function(t){return R(t)}))}if("object"==typeof t){var r={};return Object.keys(t).forEach((function(e){r[e]=R(t[e])})),r}return t},O=function(t,e){var r=R(t);return r.data=r.data||{},e&&(x(r.data.x)||(r.data.x=Math.random()*e[0]),x(r.data.y)||(r.data.y=Math.random()*e[1])),r};const z=function(t){return"function"==typeof t},C=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function L(t,e){return z(e)?e:x(e)?function(){return e}:function(){return t}}function P(t,e,r){return void 0===r&&(r=!0),e||0===e?z(e)?e:x(e)?function(){return e}:g(e)?function(){if(r){var n=Math.max.apply(Math,d(e));return isNaN(n)?t:n}return e}:C(e)?function(){if(r){var n=Math.max(e.width,e.height);return isNaN(n)?t:n}return[e.width,e.height]}:function(){return t}:function(e){var r=(e.data||{}).size;return r?g(r)?r[0]>r[1]?r[0]:r[1]:C(r)?r.width>r.height?r.width:r.height:r:t}}var F=function(t,e){var r;return r=x(e)?function(){return e}:z(e)?e:function(){return 0},t?g(t)?function(e){return(t[0]>t[1]?t[0]:t[1])+r(e)}:function(e){return t+r(e)}:function(t){var e,n;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return Math.max(t.data.bboxSize[0],t.data.bboxSize[1])+r(t);if(null===(n=t.data)||void 0===n?void 0:n.size){if(g(t.data.size))return Math.max(t.data.size[0],t.data.size[1])+r(t);var o=t.data.size;return C(o)?(o.width>o.height?o.width:o.height)+r(t):o+r(t)}return 10+r(t)}},j=function(t,e,r){var n=t.getAllNodes(),i=t.getAllEdges();return(null==n?void 0:n.length)?1===n.length?(e&&t.mergeNodeData(n[0].id,{x:r[0],y:r[1]}),{nodes:[o(o({},n[0]),{data:o(o({},n[0].data),{x:r[0],y:r[1]})})],edges:i}):void 0:{nodes:[],edges:i}},G={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},U=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="circular",this.options=o(o({},G),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,this.genericCircularLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){switch(r.label){case 0:return[4,this.genericCircularLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericCircularLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,d,h,c,l,f,g,p,v,m,y,w,x,E,b,N,M,_,A,S,k,I,T,D,R,z,C,F,G,U,q,W,H;return s(this,(function(s){if(n=o(o({},this.options),r),i=n.width,a=n.height,d=n.center,h=n.divisions,c=n.startAngle,l=void 0===c?0:c,f=n.endAngle,g=void 0===f?2*Math.PI:f,p=n.angleRatio,v=n.ordering,m=n.clockwise,y=n.nodeSpacing,w=n.nodeSize,x=e.getAllNodes(),E=e.getAllEdges(),b=u(B(i,a,d),3),N=b[0],M=b[1],_=b[2],!(A=null==x?void 0:x.length)||1===A)return[2,j(e,t,_)];for(S=(g-l)/A,k=n.radius,I=n.startRadius,T=n.endRadius,y?(D=L(10,y),R=P(10,w),z=-1/0,x.forEach((function(t){var e=R(t);z<e&&(z=e)})),C=0,x.forEach((function(t,e){C+=0===e?z||10:(D(t)||0)+(z||10)})),k=C/(2*Math.PI)):k||I||T?!I&&T?I=T:I&&!T&&(T=I):k=Math.min(M,N)/2,F=S*p,G=[],G="topology"===v?V(e,x):"topology-directed"===v?V(e,x,!0):"degree"===v?function(t,e){var r=[];return e.forEach((function(t,e){r.push(O(t))})),r.sort((function(e,r){return t.getDegree(e.id,"both")-t.getDegree(r.id,"both")})),r}(e,x):x.map((function(t){return O(t)})),U=Math.ceil(A/h),q=0;q<A;++q)(W=k)||null===I||null===T||(W=I+q*(T-I)/(A-1)),W||(W=10+100*q/(A-1)),H=l+q%U*F+2*Math.PI/h*Math.floor(q/U),m||(H=g-q%U*F-2*Math.PI/h*Math.floor(q/U)),G[q].data.x=_[0]+Math.cos(H)*W,G[q].data.y=_[1]+Math.sin(H)*W;return t&&G.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:G,edges:E}]}))}))},t}(),V=function(t,e,r){void 0===r&&(r=!1);var n=[O(e[0])],o={},i=e.length;o[e[0].id]=!0;var a=0;return e.forEach((function(s,u){if(0!==u)if(u!==i-1&&t.getDegree(s.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(n[a].id,s.id)||o[s.id]){for(var d=r?t.getSuccessors(n[a].id):t.getNeighbors(n[a].id),h=!1,c=0;c<d.length;c++){var l=d[c];if(t.getDegree(l.id)===t.getDegree(s.id)&&!o[l.id]){n.push(O(l)),o[l.id]=!0,h=!0;break}}for(var f=0;!h&&(o[e[f].id]||(n.push(O(e[f])),o[e[f].id]=!0,h=!0),++f!==i););}else n.push(O(s)),o[s.id]=!0,a++})),n},B=function(t,e,r){var n=t,o=e,i=r;return n||"undefined"==typeof window||(n=window.innerWidth),o||"undefined"==typeof window||(o=window.innerHeight),i||(i=[n/2,o/2]),[n,o,i]},q=p(913),W=p.n(q),H=p(497),$=p.n(H),X=function(t){function e(e,r,n){var o=t.call(this)||this;return o.graph=e,o.layout=r,o.options=n,o.spawnWorker(),o}return n(e,t),e.prototype.spawnWorker=function(){this.worker&&this.worker.terminate(),this.worker=$()(),this.running&&(this.running=!1,this.execute())},e.prototype.execute=function(){var t;return a(this,void 0,void 0,(function(){var e,r,n,o;return s(this,(function(a){switch(a.label){case 0:return this.running?[2,this]:(this.running=!0,(e=this.layout.options).onTick,r=i(e,["onTick"]),n={layout:{id:this.layout.id,options:r,iterations:null===(t=this.options)||void 0===t?void 0:t.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},o=new Float32Array([0]),[4,this.worker.calculateLayout(n,[o])]);case 1:return[2,u.apply(void 0,[a.sent(),1])[0]]}}))}))},e.prototype.stop=function(){return this.running=!1,this.worker.stopLayout(),this},e.prototype.kill=function(){this.worker&&this.worker.terminate()},e.prototype.isRunning=function(){return this.running},e}(W());const Y=function(t){return w(t,"String")};var K={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},Q=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="concentric",this.options=o(o({},K),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,this.genericConcentricLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return this.genericConcentricLayout(!0,t,e),[2]}))}))},t.prototype.genericConcentricLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,u,d,h,c,l,f,p,v,m,y,w,E,b,N,M,_,A,S,k,I,T,D,R,L,P,F,G,U,V,B,q,W,H,$,X;return s(this,(function(s){if(n=o(o({},this.options),r),i=n.center,a=n.width,u=n.height,d=n.sortBy,h=n.maxLevelDiff,c=n.sweep,l=n.clockwise,f=n.equidistant,p=n.preventOverlap,v=n.startAngle,m=void 0===v?1.5*Math.PI:v,y=n.nodeSize,w=n.nodeSpacing,E=e.getAllNodes(),b=e.getAllEdges(),N=a||"undefined"==typeof window?a:window.innerWidth,M=u||"undefined"==typeof window?u:window.innerHeight,_=i||[N/2,M/2],!(null==E?void 0:E.length)||1===E.length)return[2,j(e,t,_)];if(A=[],k=0,S=g(y)?Math.max(y[0],y[1]):y,g(w)?k=Math.max(w[0],w[1]):x(w)&&(k=w),E.forEach((function(t){var e=O(t);A.push(e);var r=S,n=e.data;g(n.size)?r=Math.max(n.size[0],n.size[1]):x(n.size)?r=n.size:C(n.size)&&(r=Math.max(n.size.width,n.size.height)),S=Math.max(S,r),z(w)&&(k=Math.max(w(t),k))})),I={},A.forEach((function(t,e){I[t.id]=e})),Y(T=d)&&void 0!==A[0].data[T]||(T="degree"),"degree"===T?A.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):A.sort((function(t,e){return e.data[T]-t.data[T]})),D=A[0],R=(h||("degree"===T?e.getDegree(D.id,"both"):D.data[T]))/4,P=(L=[{nodes:[]}])[0],A.forEach((function(t){if(P.nodes.length>0){var r="degree"===T?Math.abs(e.getDegree(P.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(P.nodes[0].data[T]-t.data[T]);R&&r>=R&&(P={nodes:[]},L.push(P))}P.nodes.push(t)})),F=S+k,p||(G=L.length>0&&L[0].nodes.length>1,U=Math.min(N,M)/2-F,V=U/(L.length+(G?1:0)),F=Math.min(F,V)),B=0,L.forEach((function(t){var e=void 0===c?2*Math.PI-2*Math.PI/t.nodes.length:c;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&p){var r=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),o=Math.sqrt(F*F/(r*r+n*n));B=Math.max(o,B)}t.r=B,B+=F})),f){for(q=0,W=0,H=0;H<L.length;H++)$=L[H],X=($.r||0)-W,q=Math.max(q,X);W=0,L.forEach((function(t,e){0===e&&(W=t.r||0),t.r=W,W+=q}))}return L.forEach((function(t){var e=t.dTheta||0,r=t.r||0;t.nodes.forEach((function(t,n){var o=m+(l?1:-1)*e*n;t.data.x=_[0]+r*Math.cos(o),t.data.y=_[1]+r*Math.sin(o)}))})),t&&A.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:A,edges:b}]}))}))},t}();function Z(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i,a,s,u,d,h,c,l,f=t._root,g={data:n},p=t._x0,v=t._y0,m=t._x1,y=t._y1;if(!f)return t._root=g,t;for(;f.length;)if((d=e>=(i=(p+m)/2))?p=i:m=i,(h=r>=(a=(v+y)/2))?v=a:y=a,o=f,!(f=f[c=h<<1|d]))return o[c]=g,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&r===u)return g.next=f,o?o[c]=g:t._root=g,t;do{o=o?o[c]=new Array(4):t._root=new Array(4),(d=e>=(i=(p+m)/2))?p=i:m=i,(h=r>=(a=(v+y)/2))?v=a:y=a}while((c=h<<1|d)==(l=(u>=a)<<1|s>=i));return o[l]=f,o[c]=g,t}function J(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function tt(t){return t[0]}function et(t){return t[1]}function rt(t,e,r){var n=new nt(null==e?tt:e,null==r?et:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function nt(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function ot(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var it=rt.prototype=nt.prototype;function at(t){return function(){return t}}function st(t){return 1e-6*(t()-.5)}it.copy=function(){var t,e,r=new nt(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=ot(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var o=0;o<4;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(4)}):n.target[o]=ot(e));return r},it.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return Z(this.cover(e,r),e,r,t)},it.addAll=function(t){var e,r,n,o,i=t.length,a=new Array(i),s=new Array(i),u=1/0,d=1/0,h=-1/0,c=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(a[r]=n,s[r]=o,n<u&&(u=n),n>h&&(h=n),o<d&&(d=o),o>c&&(c=o));if(u>h||d>c)return this;for(this.cover(u,d).cover(h,c),r=0;r<i;++r)Z(this,a[r],s[r],t[r]);return this},it.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var a,s,u=o-r||1,d=this._root;r>t||t>=o||n>e||e>=i;)switch(s=(e<n)<<1|t<r,(a=new Array(4))[s]=d,d=a,u*=2,s){case 0:o=r+u,i=n+u;break;case 1:r=o-u,i=n+u;break;case 2:o=r+u,n=i-u;break;case 3:r=o-u,n=i-u}this._root&&this._root.length&&(this._root=d)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this},it.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},it.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},it.find=function(t,e,r){var n,o,i,a,s,u,d,h=this._x0,c=this._y0,l=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new J(p,h,c,l,f)),null==r?r=1/0:(h=t-r,c=e-r,l=t+r,f=e+r,r*=r);u=g.pop();)if(!(!(p=u.node)||(o=u.x0)>l||(i=u.y0)>f||(a=u.x1)<h||(s=u.y1)<c))if(p.length){var v=(o+a)/2,m=(i+s)/2;g.push(new J(p[3],v,m,a,s),new J(p[2],o,m,v,s),new J(p[1],v,i,a,m),new J(p[0],o,i,v,m)),(d=(e>=m)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-d],g[g.length-1-d]=u)}else{var y=t-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),x=y*y+w*w;if(x<r){var E=Math.sqrt(r=x);h=t-E,c=e-E,l=t+E,f=e+E,n=p.data}}return n},it.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,r,n,o,i,a,s,u,d,h,c,l,f=this._root,g=this._x0,p=this._y0,v=this._x1,m=this._y1;if(!f)return this;if(f.length)for(;;){if((d=i>=(s=(g+v)/2))?g=s:v=s,(h=a>=(u=(p+m)/2))?p=u:m=u,e=f,!(f=f[c=h<<1|d]))return this;if(!f.length)break;(e[c+1&3]||e[c+2&3]||e[c+3&3])&&(r=e,l=c)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(o=f.next)&&delete f.next,n?(o?n.next=o:delete n.next,this):e?(o?e[c]=o:delete e[c],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[l]=f:this._root=f),this):(this._root=o,this)},it.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},it.root=function(){return this._root},it.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},it.visit=function(t){var e,r,n,o,i,a,s=[],u=this._root;for(u&&s.push(new J(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,n=e.x0,o=e.y0,i=e.x1,a=e.y1)&&u.length){var d=(n+i)/2,h=(o+a)/2;(r=u[3])&&s.push(new J(r,d,h,i,a)),(r=u[2])&&s.push(new J(r,n,h,d,a)),(r=u[1])&&s.push(new J(r,d,o,i,h)),(r=u[0])&&s.push(new J(r,n,o,d,h))}return this},it.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new J(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.x1,d=e.y1,h=(a+u)/2,c=(s+d)/2;(i=o[0])&&r.push(new J(i,a,s,h,c)),(i=o[1])&&r.push(new J(i,h,s,u,c)),(i=o[2])&&r.push(new J(i,a,c,h,d)),(i=o[3])&&r.push(new J(i,h,c,u,d))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},it.x=function(t){return arguments.length?(this._x=t,this):this._x},it.y=function(t){return arguments.length?(this._y=t,this):this._y};var ut={value:()=>{}};function dt(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new ht(n)}function ht(t){this._=t}function ct(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function lt(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=ut,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}ht.prototype=dt.prototype={constructor:ht,on:function(t,e){var r,n,o=this._,i=(n=o,(t+"").trim().split(/^|\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)o[r]=lt(o[r],t.name,e);else if(null==e)for(r in o)o[r]=lt(o[r],t.name,null);return this}for(;++a<s;)if((r=(t=i[a]).type)&&(r=ct(o[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new ht(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};const ft=dt;var gt,pt,vt=0,mt=0,yt=0,wt=0,xt=0,Et=0,bt="object"==typeof performance&&performance.now?performance:Date,Nt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Mt(){return xt||(Nt(_t),xt=bt.now()+Et)}function _t(){xt=0}function At(){this._call=this._time=this._next=null}function St(t,e,r){var n=new At;return n.restart(t,e,r),n}function kt(){xt=(wt=bt.now())+Et,vt=mt=0;try{!function(){Mt(),++vt;for(var t,e=gt;e;)(t=xt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--vt}()}finally{vt=0,function(){for(var t,e,r=gt,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:gt=e);pt=t,Tt(n)}(),xt=0}}function It(){var t=bt.now(),e=t-wt;e>1e3&&(Et-=e,wt=t)}function Tt(t){vt||(mt&&(mt=clearTimeout(mt)),t-xt>24?(t<1/0&&(mt=setTimeout(kt,t-bt.now()-Et)),yt&&(yt=clearInterval(yt))):(yt||(wt=bt.now(),yt=setInterval(It,1e3)),vt=1,Nt(kt)))}At.prototype=St.prototype={constructor:At,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?Mt():+r)+(null==e?0:+e),this._next||pt===this||(pt?pt._next=this:gt=this,pt=this),this._call=t,this._time=r,Tt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Tt())}};const Dt=4294967296;function Rt(t){return t.x}function Ot(t){return t.y}var zt=Math.PI*(3-Math.sqrt(5));function Ct(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,a=.6,s=new Map,u=St(c),d=ft("tick","end"),h=function(){let t=1;return()=>(t=(1664525*t+1013904223)%Dt)/Dt}();function c(){l(),d.call("tick",e),r<n&&(u.stop(),d.call("end",e))}function l(n){var u,d,h=t.length;void 0===n&&(n=1);for(var c=0;c<n;++c)for(r+=(i-r)*o,s.forEach((function(t){t(r)})),u=0;u<h;++u)null==(d=t[u]).fx?d.x+=d.vx*=a:(d.x=d.fx,d.vx=0),null==d.fy?d.y+=d.vy*=a:(d.y=d.fy,d.vy=0);return e}function f(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var o=10*Math.sqrt(.5+r),i=r*zt;e.x=o*Math.cos(i),e.y=o*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,h),e}return null==t&&(t=[]),f(),e={tick:l,restart:function(){return u.restart(c),e},stop:function(){return u.stop(),e},nodes:function(r){return arguments.length?(t=r,f(),s.forEach(g),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(h=t,s.forEach(g),e):h},force:function(t,r){return arguments.length>1?(null==r?s.delete(t):s.set(t,g(r)),e):s.get(t)},find:function(e,r,n){var o,i,a,s,u,d=0,h=t.length;for(null==n?n=1/0:n*=n,d=0;d<h;++d)(a=(o=e-(s=t[d]).x)*o+(i=r-s.y)*i)<n&&(u=s,n=a);return u},on:function(t,r){return arguments.length>1?(d.on(t,r),e):d.on(t)}}}function Lt(){var t,e,r,n,o,i=at(-30),a=1,s=1/0,u=.81;function d(r){var o,i=t.length,a=rt(t,Rt,Ot).visitAfter(c);for(n=r,o=0;o<i;++o)e=t[o],a.visit(l)}function h(){if(t){var e,r,n=t.length;for(o=new Array(n),e=0;e<n;++e)r=t[e],o[r.index]=+i(r,e,t)}}function c(t){var e,r,n,i,a,s=0,u=0;if(t.length){for(n=i=a=0;a<4;++a)(e=t[a])&&(r=Math.abs(e.value))&&(s+=e.value,u+=r,n+=r*e.x,i+=r*e.y);t.x=n/u,t.y=i/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=o[e.data.index]}while(e=e.next)}t.value=s}function l(t,i,d,h){if(!t.value)return!0;var c=t.x-e.x,l=t.y-e.y,f=h-i,g=c*c+l*l;if(f*f/u<g)return g<s&&(0===c&&(g+=(c=st(r))*c),0===l&&(g+=(l=st(r))*l),g<a&&(g=Math.sqrt(a*g)),e.vx+=c*t.value*n/g,e.vy+=l*t.value*n/g),!0;if(!(t.length||g>=s)){(t.data!==e||t.next)&&(0===c&&(g+=(c=st(r))*c),0===l&&(g+=(l=st(r))*l),g<a&&(g=Math.sqrt(a*g)));do{t.data!==e&&(f=o[t.data.index]*n/g,e.vx+=c*f,e.vy+=l*f)}while(t=t.next)}}return d.initialize=function(e,n){t=e,r=n,h()},d.strength=function(t){return arguments.length?(i="function"==typeof t?t:at(+t),h(),d):i},d.distanceMin=function(t){return arguments.length?(a=t*t,d):Math.sqrt(a)},d.distanceMax=function(t){return arguments.length?(s=t*t,d):Math.sqrt(s)},d.theta=function(t){return arguments.length?(u=t*t,d):Math.sqrt(u)},d}function Pt(t){return t.index}function Ft(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function jt(t){var e,r,n,o,i,a,s=Pt,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},d=at(30),h=1;function c(n){for(var o=0,s=t.length;o<h;++o)for(var u,d,c,l,f,g,p,v=0;v<s;++v)d=(u=t[v]).source,l=(c=u.target).x+c.vx-d.x-d.vx||st(a),f=c.y+c.vy-d.y-d.vy||st(a),l*=g=((g=Math.sqrt(l*l+f*f))-r[v])/g*n*e[v],f*=g,c.vx-=l*(p=i[v]),c.vy-=f*p,d.vx+=l*(p=1-p),d.vy+=f*p}function l(){if(n){var a,u,d=n.length,h=t.length,c=new Map(n.map(((t,e)=>[s(t,e,n),t])));for(a=0,o=new Array(d);a<h;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=Ft(c,u.source)),"object"!=typeof u.target&&(u.target=Ft(c,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(a=0,i=new Array(h);a<h;++a)u=t[a],i[a]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);e=new Array(h),f(),r=new Array(h),g()}}function f(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+u(t[r],r,t)}function g(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+d(t[e],e,t)}return null==t&&(t=[]),c.initialize=function(t,e){n=t,a=e,l()},c.links=function(e){return arguments.length?(t=e,l(),c):t},c.id=function(t){return arguments.length?(s=t,c):s},c.iterations=function(t){return arguments.length?(h=+t,c):h},c.strength=function(t){return arguments.length?(u="function"==typeof t?t:at(+t),f(),c):u},c.distance=function(t){return arguments.length?(d="function"==typeof t?t:at(+t),g(),c):d},c}function Gt(t){return t.x+t.vx}function Ut(t){return t.y+t.vy}function Vt(t){var e,r,n,o=1,i=1;function a(){for(var t,a,u,d,h,c,l,f=e.length,g=0;g<i;++g)for(a=rt(e,Gt,Ut).visitAfter(s),t=0;t<f;++t)u=e[t],c=r[u.index],l=c*c,d=u.x+u.vx,h=u.y+u.vy,a.visit(p);function p(t,e,r,i,a){var s=t.data,f=t.r,g=c+f;if(!s)return e>d+g||i<d-g||r>h+g||a<h-g;if(s.index>u.index){var p=d-s.x-s.vx,v=h-s.y-s.vy,m=p*p+v*v;m<g*g&&(0===p&&(m+=(p=st(n))*p),0===v&&(m+=(v=st(n))*v),m=(g-(m=Math.sqrt(m)))/m*o,u.vx+=(p*=m)*(g=(f*=f)/(l+f)),u.vy+=(v*=m)*g,s.vx-=p*(g=1-g),s.vy-=v*g)}}}function s(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var n,o,i=e.length;for(r=new Array(i),n=0;n<i;++n)o=e[n],r[o.index]=+t(o,n,e)}}return"function"!=typeof t&&(t=at(null==t?1:+t)),a.initialize=function(t,r){e=t,n=r,u()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(o=+t,a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:at(+e),u(),a):t},a}function Bt(){function t(t){return function(){return t}}var e,r=function(t){return t.cluster},n=t(1),o=t(-1),i=t(100),a=t(.1),s=[0,0],d=[],h={},c=[],l=100,f=100,g={none:{x:0,y:0}},p=[],v="force",m=!0,y=.1;function w(t){if(!m)return w;e.tick(),E();for(var n=0,o=d.length,i=void 0,a=t*y;n<o;++n)(i=d[n]).vx+=(g[r(i)].x-i.x)*a,i.vy+=(g[r(i)].y-i.y)*a}function x(){d&&function(){if(d&&d.length){if(void 0===r(d[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy('clusterAttr') before calling .links()");var t,s,g,v,m,y=(t=[],s=[],g={},m=[],x={},(w=d).forEach((function(t){var e=r(t);x[e]||(x[e]={count:0,sumforceNodeSize:0})})),w.forEach((function(t){var e=r(t),o=n(t),i=x[e];i.count=i.count+1,i.sumforceNodeSize=i.sumforceNodeSize+Math.PI*(o*o)*1.3,x[e]=i})),v=x,m=function(t){var e={},n=[];return t.forEach((function(t){var n,o,i,a,s,u=(o=(n=t).source,i=n.target,(a=r(h[o]))<=(s=r(h[i]))?a+"~"+s:s+"~"+a),d=0;void 0!==e[u]&&(d=e[u]),d+=1,e[u]=d})),Object.entries(e).forEach((function(t){var e=u(t,2),r=e[0],o=e[1],i=r.split("~")[0],a=r.split("~")[1];void 0!==i&&void 0!==a&&n.push({source:i,target:a,count:o})})),n}(c),Object.keys(v).forEach((function(e,r){var n=v[e];t.push({id:e,size:n.count,r:Math.sqrt(n.sumforceNodeSize/Math.PI)}),g[e]=r})),m.forEach((function(t){var e=t.source,r=t.target,n=g[e],o=g[r];void 0!==n&&void 0!==o&&s.push({source:n,target:o,count:t.count})})),{nodes:t,links:s});e=Ct(y.nodes).force("x",function(t){var e,r,n,o=at(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=at(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:at(+t),a(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:at(+e),a(),i):t},i}(l).strength(.1)).force("y",function(t){var e,r,n,o=at(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=at(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:at(+t),a(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:at(+e),a(),i):t},i}(f).strength(.1)).force("collide",Vt((function(t){return t.r})).iterations(4)).force("charge",Lt().strength(o)).force("links",jt(y.nodes.length?y.links:[]).distance(i).strength(a)),p=e.nodes(),E()}var w,x}()}function E(){return g={none:{x:0,y:0}},p.forEach((function(t){g[t.id]={x:t.x-s[0],y:t.y-s[1]}})),g}return w.initialize=function(t){d=t,x()},w.template=function(t){return arguments.length?(v=t,x(),w):v},w.groupBy=function(t){return arguments.length?"string"==typeof t?(r=function(e){return e[t]},w):(r=t,w):r},w.enableGrouping=function(t){return arguments.length?(m=t,w):m},w.strength=function(t){return arguments.length?(y=t,w):y},w.centerX=function(t){return arguments.length?(l=t,w):l},w.centerY=function(t){return arguments.length?(f=t,w):f},w.nodes=function(t){return arguments.length?(h={},(t||[]).forEach((function(t){h[t.id]=t})),d=t||[],w):d},w.links=function(t){return arguments.length?(c=t||[],x(),w):c},w.forceNodeSize=function(e){return arguments.length?(n="function"==typeof e?e:t(+e),x(),w):n},w.nodeSize=w.forceNodeSize,w.forceCharge=function(e){return arguments.length?(o="function"==typeof e?e:t(+e),x(),w):o},w.forceLinkDistance=function(e){return arguments.length?(i="function"==typeof e?e:t(+e),x(),w):i},w.forceLinkStrength=function(e){return arguments.length?(a="function"==typeof e?e:t(+e),x(),w):a},w.offset=function(t){return arguments.length?(s=t,w):s},w.getFocis=E,w}var qt={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},Wt=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="d3force",this.options=o(o({},qt),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){var t;null===(t=this.forceSimulation)||void 0===t||t.stop()},t.prototype.tick=function(t){var e=this;void 0===t&&(t=1),this.forceSimulation.tick(t);var r={nodes:Ht(this.lastLayoutNodes),edges:$t(this.lastLayoutEdges)};return this.lastAssign&&r.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r},t.prototype.genericForceLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,u,d,h,c,l,f,g,p,v,m,y,w,x,E,b,N,M,_,A,S,k,I,T,D=this;return s(this,(function(s){return n=o(o({},this.options),r),i=e.getAllNodes(),a=e.getAllEdges(),u=i.map((function(t){var e,r;return o(o({},O(t)),{x:null===(e=t.data)||void 0===e?void 0:e.x,y:null===(r=t.data)||void 0===r?void 0:r.y})})),d=a.map((function(t){return O(t)})),this.lastLayoutNodes=u,this.lastLayoutEdges=d,this.lastAssign=t,this.lastGraph=e,h=n.alphaMin,c=n.alphaDecay,l=n.alpha,f=n.nodeStrength,g=n.edgeStrength,p=n.linkDistance,v=n.clustering,m=n.clusterFociStrength,y=n.clusterEdgeDistance,w=n.clusterEdgeStrength,x=n.clusterNodeStrength,E=n.clusterNodeSize,b=n.collideStrength,N=void 0===b?1:b,M=n.center,_=void 0===M?[0,0]:M,A=n.preventOverlap,S=n.nodeSize,k=n.nodeSpacing,I=n.onTick,T=n.forceSimulation,[2,new Promise((function(r){if(T){v&&((i=Bt()).nodes(u),i.links(d)),T.nodes(u),d&&(s=jt().id((function(t){return t.id})).links(d),g&&s.strength(g),p&&s.distance(p),T.force("link",s)),A&&D.overlapProcess(T,{nodeSize:S,nodeSpacing:k,collideStrength:N}),T.alpha(l).restart();var n=Ht(u),o=$t(d);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:o})}else try{var i,a=Lt();if(f&&a.strength(f),T=Ct().nodes(u),v&&((i=Bt()).centerX(_[0]).centerY(_[1]).template("force").strength(m),d&&i.links(d),u&&i.nodes(u),i.forceLinkDistance(y).forceLinkStrength(w).forceCharge(x).forceNodeSize(E),T.force("group",i)),T.force("center",function(t,e){var r,n=1;function o(){var o,i,a=r.length,s=0,u=0;for(o=0;o<a;++o)s+=(i=r[o]).x,u+=i.y;for(s=(s/a-t)*n,u=(u/a-e)*n,o=0;o<a;++o)(i=r[o]).x-=s,i.y-=u}return null==t&&(t=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(n=+t,o):n},o}(_[0],_[1])).force("charge",a).alpha(l).alphaDecay(c).alphaMin(h),A&&D.overlapProcess(T,{nodeSize:S,nodeSpacing:k,collideStrength:N}),d){var s=jt().id((function(t){return t.id})).links(d);g&&s.strength(g),p&&s.distance(p),T.force("link",s)}T.on("tick",(function(){var r=Ht(u);null==I||I({nodes:r,edges:$t(d)}),t&&r.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}))})).on("end",(function(){var n=Ht(u);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:$t(d)})}))}catch(b){console.warn(b)}D.forceSimulation=T}))]}))}))},t.prototype.overlapProcess=function(t,e){var r,n,o=e.nodeSize,i=e.nodeSpacing,a=e.collideStrength;if(n=x(i)?function(){return i}:z(i)?i:function(){return 0},o)if(z(o))r=function(t){return o(t)+n(t)};else if(g(o)){var s=(o[0]>o[1]?o[0]:o[1])/2;r=function(t){return s+n(t)}}else if(x(o)){var u=o/2;r=function(t){return u+n(t)}}else r=function(){return 10};else r=function(t){return t.size?g(t.size)?(t.size[0]>t.size[1]?t.size[0]:t.size[1])/2+n(t):C(t.size)?(t.size.width>t.size.height?t.size.width:t.size.height)/2+n(t):t.size/2+n(t):10+n(t)};t.force("collisionForce",Vt(r).strength(a))},t}(),Ht=function(t){return t.map((function(t){var e=t.x,r=t.y,n=i(t,["x","y"]);return o(o({},n),{data:o(o({},n.data),{x:e,y:r})})}))},$t=function(t){return t.map((function(t){var e=t.source,r=t.target,n=i(t,["source","target"]);return o(o({},n),{source:e.id,target:r.id})}))};const Xt=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[],i=this._events["*"]||[],a=function(n){for(var o=n.length,i=0;i<o;i++)if(n[i]){var a=n[i],s=a.callback;a.once&&(n.splice(i,1),0===n.length&&delete e._events[t],o--,i--),s.apply(e,r)}};a(o),a(i)},t.prototype.off=function(t,e){if(t)if(e){for(var r=this._events[t]||[],n=r.length,o=0;o<n;o++)r[o].callback===e&&(r.splice(o,1),n--,o--);0===r.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function Yt(t,e,r,n){for(;t.length;){const o=t.shift();if(r(o))return!0;e.add(o.id),n(o.id).forEach((r=>{e.has(r.id)||(e.add(r.id),t.push(r))}))}return!1}function Kt(t,e,r,n){if(r(t))return!0;e.add(t.id);for(const o of n(t.id))if(!e.has(o.id)&&Kt(o,e,r,n))return!0;return!1}class Qt extends Xt{constructor(t){r(this,"nodeMap",new Map),r(this,"edgeMap",new Map),r(this,"inEdgesMap",new Map),r(this,"outEdgesMap",new Map),r(this,"bothEdgesMap",new Map),r(this,"treeIndices",new Map),r(this,"changes",[]),r(this,"batchCount",0),r(this,"onChanged",(()=>{})),r(this,"batch",(t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()})),super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const r=e.find((e=>e.type===t.type&&e.id===t.id&&e.propertyName===t.propertyName));r?r.newValue=t.newValue:e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const r=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),r=this.bothEdgesMap.get(t);null==r||r.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((e=>{var r;null==(r=e.childrenMap.get(t))||r.forEach((t=>{e.parentMap.delete(t.id)})),e.parentMap.delete(t),e.childrenMap.delete(t)})),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){const n=this.getNode(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateNodeDataProperty(t,e,r)}))}))}updateNodeData(...t){const e=t[0],r=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:o})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),o.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),o=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),o.delete(e),i.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.source,o=e;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:o})}))}updateEdgeTarget(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.target,o=e;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:o})}))}updateEdgeDataProperty(t,e,r){const n=this.getEdge(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}updateEdgeData(...t){const e=t[0],r=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:o})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateEdgeDataProperty(t,e,r)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const r=[],n=Array.isArray(t)?t:[t];for(;n.length;){const t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach((t=>{var r;null==(r=t.children)||r.forEach((r=>{this.setParent(r.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const r=this.treeIndices.get(e).childrenMap.get(t);return Array.from(r||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const r=[];let n,o=this.getNode(t);for(;n=this.getParent(o.id,e);)r.push(n),o=n;return r}setParent(t,e,r){var n;this.checkTreeExistence(r);const o=this.treeIndices.get(r),i=this.getNode(t),a=o.parentMap.get(t),s=this.getNode(e);o.parentMap.set(t,s),a&&(null==(n=o.childrenMap.get(a.id))||n.delete(i));let u=o.childrenMap.get(s.id);u||(u=new Set,o.childrenMap.set(s.id,u)),u.add(i),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:null==a?void 0:a.id,newParentId:s.id})}))}dfsTree(t,e,r){return Kt(this.getNode(t),new Set,e,(t=>this.getChildren(t,r)))}bfsTree(t,e,r){return Yt([this.getNode(t)],new Set,e,(t=>this.getChildren(t,r)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return Yt([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return Kt(this.getNode(t),new Set,e,n)}clone(){const t=this.getAllNodes().map((t=>e(e({},t),{data:e({},t.data)}))),r=this.getAllEdges().map((t=>e(e({},t),{data:e({},t.data)}))),n=new Qt({nodes:t,edges:r});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},r)=>{const o=new Map;t.forEach(((t,e)=>{o.set(e,n.getNode(t.id))}));const i=new Map;e.forEach(((t,e)=>{i.set(e,new Set(Array.from(t).map((t=>n.getNode(t.id)))))})),n.treeIndices.set(r,{parentMap:o,childrenMap:i})})),n}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var Zt=function(t,e){if("next"!==t&&"prev"!==t)return e},Jt=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},te=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(function(){function t(){var t={};t.prev=t,t.next=t.prev,this.shortcut=t}return t.prototype.dequeue=function(){var t=this.shortcut,e=t.prev;if(e&&e!==t)return Jt(e),e},t.prototype.enqueue=function(t){var e=this.shortcut;t.prev&&t.next&&Jt(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e},t.prototype.toString=function(){for(var t=[],e=this.shortcut,r=e.prev;r!==e;)t.push(JSON.stringify(r,Zt)),r=null==r?void 0:r.prev;return"["+t.join(", ")+"]"},t}()),ee=function(t,e,r,n,i){var a,s,u=[];return t.hasNode(n.v)&&(null===(a=t.getRelatedEdges(n.v,"in"))||void 0===a||a.forEach((function(n){var a=n.data.weight,s=t.getNode(n.source);i&&u.push({v:n.source,w:n.target,in:0,out:0}),void 0===s.data.out&&(s.data.out=0),s.data.out-=a,re(e,r,o({v:s.id},s.data))})),null===(s=t.getRelatedEdges(n.v,"out"))||void 0===s||s.forEach((function(n){var i=n.data.weight,a=n.target,s=t.getNode(a);void 0===s.data.in&&(s.data.in=0),s.data.in-=i,re(e,r,o({v:s.id},s.data))})),t.removeNode(n.v)),i?u:void 0},re=function(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},ne=function(t){var e=[],r={},n={},o=function(i){n[i]||(n[i]=!0,r[i]=!0,t.getRelatedEdges(i,"out").forEach((function(t){r[t.target]?e.push(t):o(t.target)})),delete r[i])};return t.getAllNodes().forEach((function(t){return o(t.id)})),e},oe=function(t,e,r,n){var o;do{o=""+n+Math.random()}while(t.hasNode(o));return r.dummy=e,t.addNode({id:o,data:r}),o},ie=function(t){var e=new Qt;return t.getAllNodes().forEach((function(r){t.getChildren(r.id).length||e.addNode(o({},r))})),t.getAllEdges().forEach((function(t){e.addEdge(t)})),e},ae=function(t,e){var r,n,o=Number(t.x),i=Number(t.y),a=Number(e.x)-o,s=Number(e.y)-i,u=Number(t.width)/2,d=Number(t.height)/2;return a||s?(Math.abs(s)*u>Math.abs(a)*d?(s<0&&(d=-d),r=d*a/s,n=d):(a<0&&(u=-u),r=u,n=u*s/a),{x:o+r,y:i+n}):{x:0,y:0}},se=function(t){for(var e=[],r=de(t)+1,n=0;n<r;n++)e.push([]);for(t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)})),n=0;n<r;n++)e[n]=e[n].sort((function(e,r){return n=t.getNode(e).data.order,o=t.getNode(r).data.order,Number(n)-Number(o);var n,o}));return e},ue=function(t,e,r,n){var o={width:0,height:0};return x(r)&&x(n)&&(o.rank=r,o.order=n),oe(t,"border",o,e)},de=function(t){var e;return t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)})),e||(e=0),e},he=function(t,e){return t.reduce((function(t,r){return e(t)>e(r)?r:t}))},ce=function(t,e,r,n,o,i){n.includes(e.id)||(n.push(e.id),r||i.push(e.id),o(e.id).forEach((function(e){return ce(t,e,r,n,o,i)})),r&&i.push(e.id))},le=function(t,e,r,n){var o=Array.isArray(e)?e:[e],i=function(e){return n?t.getSuccessors(e):t.getNeighbors(e)},a=[],s=[];return o.forEach((function(e){if(!t.hasNode(e.id))throw new Error("Graph does not have node: "+e);ce(t,e,"post"===r,s,i,a)})),a},fe="edge-label",ge=function(t){var e={},r=function(n){var o,i,a=t.getNode(n);return a?e[n]?a.data.rank:(e[n]=!0,null===(o=t.getRelatedEdges(n,"out"))||void 0===o||o.forEach((function(t){var e=r(t.target)-t.data.minlen;e&&(void 0===i||e<i)&&(i=e)})),i||(i=0),a.data.rank=i,i):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){return r(t.id)}))},pe=function(t,e){return t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen},ve=function(t,e){var r=function(n){e.getRelatedEdges(n,"both").forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||pe(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},me=function(t,e){var r=function(n){var o;null===(o=e.getRelatedEdges(n,"both"))||void 0===o||o.forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||void 0===e.getNode(a).data.layer&&pe(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ye=function(t,e){return he(e.getAllEdges(),(function(r){return t.hasNode(r.source)!==t.hasNode(r.target)?pe(e,r):1/0}))},we=function(t,e,r){t.getAllNodes().forEach((function(t){var n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r}))},xe=function(t,e){var r=le(t,t.getAllNodes(),"post",!1);(r=r.slice(0,(null==r?void 0:r.length)-1)).forEach((function(r){Ee(t,e,r)}))},Ee=function(t,e,r){var n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find((function(t){return t.target===n||t.source===n})).data.cutvalue=be(t,e,r)},be=function(t,e,r){var n=t.getNode(r).data.parent,o=!0,i=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),a=0;return i||(o=!1,i=e.getRelatedEdges(n,"out").find((function(t){return t.target===r}))),a=i.data.weight,e.getRelatedEdges(r,"both").forEach((function(e){var i=e.source===r,s=i?e.target:e.source;if(s!==n){var u=i===o,d=e.data.weight;if(a+=u?d:-d,Ie(t,r,s)){var h=t.getRelatedEdges(r,"both").find((function(t){return t.source===s||t.target===s})).data.cutvalue;a+=u?-h:h}}})),a},Ne=function(t,e){void 0===e&&(e=t.getAllNodes()[0].id),Me(t,{},1,e)},Me=function(t,e,r,n,o){var i,a=r,s=r,u=t.getNode(n);return e[n]=!0,null===(i=t.getNeighbors(n))||void 0===i||i.forEach((function(r){e[r.id]||(s=Me(t,e,s,r.id,n))})),u.data.low=a,u.data.lim=s++,o?u.data.parent=o:delete u.data.parent,s},_e=function(t){return t.getAllEdges().find((function(t){return t.data.cutvalue<0}))},Ae=function(t,e,r){var n=r.source,o=r.target;e.getRelatedEdges(n,"out").find((function(t){return t.target===o}))||(n=r.target,o=r.source);var i=t.getNode(n),a=t.getNode(o),s=i,u=!1;i.data.lim>a.data.lim&&(s=a,u=!0);var d=e.getAllEdges().filter((function(e){return u===Te(t.getNode(e.source),s)&&u!==Te(t.getNode(e.target),s)}));return he(d,(function(t){return pe(e,t)}))},Se=function(t,e,r,n){var o=t.getRelatedEdges(r.source,"both").find((function(t){return t.source===r.target||t.target===r.target}));o&&t.removeEdge(o.id),t.addEdge({id:"e"+Math.random(),source:n.source,target:n.target,data:{}}),Ne(t),xe(t,e),ke(t,e)},ke=function(t,e){var r=t.getAllNodes().find((function(t){return!t.data.parent})),n=le(t,r,"pre",!1);(n=n.slice(1)).forEach((function(r){var n=t.getNode(r).data.parent,o=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),i=!1;!o&&e.hasNode(n)&&(o=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),i=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(i?null==o?void 0:o.data.minlen:-(null==o?void 0:o.data.minlen))}))},Ie=function(t,e,r){return t.getRelatedEdges(e,"both").find((function(t){return t.source===r||t.target===r}))},Te=function(t,e){return e.data.low<=t.data.lim&&t.data.lim<=e.data.lim},De=ge,Re=function(t,e,r,n,o,i,a){var s=t.getChildren(a);if(null==s?void 0:s.length){var u=ue(t,"_bt"),d=ue(t,"_bb"),h=t.getNode(a);t.setParent(u,a),h.data.borderTop=u,t.setParent(d,a),h.data.borderBottom=d,null==s||s.forEach((function(s){Re(t,e,r,n,o,i,s.id);var h=s.data.borderTop?s.data.borderTop:s.id,c=s.data.borderBottom?s.data.borderBottom:s.id,l=s.data.borderTop?n:2*n,f=h!==c?1:o-i[a]+1;t.addEdge({id:"e"+Math.random(),source:u,target:h,data:{minlen:f,weight:l,nestingEdge:!0}}),t.addEdge({id:"e"+Math.random(),source:c,target:d,data:{minlen:f,weight:l,nestingEdge:!0}})})),t.getParent(a)||t.addEdge({id:"e"+Math.random(),source:e,target:u,data:{weight:0,minlen:o+i[a]}})}else a!==e&&t.addEdge({id:"e"+Math.random(),source:e,target:a,data:{weight:0,minlen:r}})},Oe=function(t,e,r,n,o,i){var a={rank:i,borderType:e,width:0,height:0},s=o.data[e][i-1],u=oe(t,"border",a,r);o.data[e][i]=u,t.setParent(u,n),s&&t.addEdge({id:"e"+Math.random(),source:s,target:u,data:{weight:1}})},ze=function(t){t.getAllNodes().forEach((function(t){Ce(t)})),t.getAllEdges().forEach((function(t){Ce(t)}))},Ce=function(t){var e=t.data.width;t.data.width=t.data.height,t.data.height=e},Le=function(t){(null==t?void 0:t.y)&&(t.y=-t.y)},Pe=function(t){var e=t.x;t.x=t.y,t.y=e},Fe=function(t){for(var e={},r=t.getAllNodes(),n=r.map((function(t){var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),o=Math.max.apply(Math,d(n)),i=[],a=0;a<o+1;a++)i.push([]);var s=r.sort((function(e,r){return t.getNode(e.id).data.rank-t.getNode(r.id).data.rank})),u=s.filter((function(e){return void 0!==t.getNode(e.id).data.fixorder})).sort((function(e,r){return t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder}));return null==u||u.forEach((function(r){isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0})),null==s||s.forEach((function(r){return t.dfsTree(r.id,(function(t){if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)}))})),i},je=function(t,e,r){for(var n=function(t,e){return null==t?void 0:t.reduce((function(t,r,n){return t[r]=e[n],t}),{})}(r,r.map((function(t,e){return e}))),o=e.map((function(e){var r=t.getRelatedEdges(e,"out").map((function(t){return{pos:n[t.target]||0,weight:t.data.weight}}));return null==r?void 0:r.sort((function(t,e){return t.pos-e.pos}))})).flat().filter((function(t){return void 0!==t})),i=1;i<r.length;)i<<=1;var a=2*i-1;i-=1;var s=Array(a).fill(0,0,a),u=0;return null==o||o.forEach((function(t){if(t){var e=t.pos+i;s[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=s[e+1]),s[e=e-1>>1]+=t.weight;u+=t.weight*r}})),u},Ge=function(t,e){for(var r=0,n=1;n<(null==e?void 0:e.length);n+=1)r+=je(t,e[n-1],e[n]);return r};const Ue=function(t,e){var r,n,o,i={};return null==t||t.forEach((function(t,e){i[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};var r=i[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)})),null===(r=e.getAllEdges())||void 0===r||r.forEach((function(t){var e=i[t.source],r=i[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(i[t.target]))})),function(t){for(var e,r,n=[],o=function(){var o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach((function(t){return(e=o,function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&function(t,e){var r,n=0,o=0;t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/o,t.weight=o,t.i=Math.min(e.i,t.i),e.merged=!0}(e,t)})(t);var e})),null===(r=o.out)||void 0===r||r.forEach((function(e){return(r=o,function(e){e.in.push(r),0==--e.indegree&&t.push(e)})(e);var r}))};null==t?void 0:t.length;)o();var i=n.filter((function(t){return!t.merged})),a=["vs","i","barycenter","weight"];return i.map((function(t){var e={};return null==a||a.forEach((function(r){void 0!==t[r]&&(e[r]=t[r])})),e}))}(null===(o=(n=Object.values(i)).filter)||void 0===o?void 0:o.call(n,(function(t){return!t.indegree})))};var Ve=function(t,e,r){for(var n,o=r;e.length&&(n=e[e.length-1]).i<=o;)e.pop(),null==t||t.push(n.vs),o++;return o},Be=function(t,e,r,n,o,i){var a,s,u,d,h=t.getChildren(e).map((function(t){return t.id})),c=t.getNode(e),l=c?c.data.borderLeft:void 0,f=c?c.data.borderRight:void 0,g={};l&&(h=null==h?void 0:h.filter((function(t){return t!==l&&t!==f})));var p,v=(p=t,(h||[]).map((function(t){var e=p.getRelatedEdges(t,"in");if(!(null==e?void 0:e.length))return{v:t};var r={sum:0,weight:0};return null==e||e.forEach((function(t){var e=p.getNode(t.source);r.sum+=t.data.weight*e.data.order,r.weight+=t.data.weight})),{v:t,barycenter:r.sum/r.weight,weight:r.weight}})));null==v||v.forEach((function(e){var o;if(null===(o=t.getChildren(e.v))||void 0===o?void 0:o.length){var a=Be(t,e.v,r,n,i);g[e.v]=a,a.hasOwnProperty("barycenter")&&We(e,a)}}));var m=Ue(v,r);qe(m,g),null===(a=m.filter((function(t){return t.vs.length>0})))||void 0===a||a.forEach((function(e){var r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)}));var y=function(t,e,r,n){var o,i,a=(i={lhs:[],rhs:[]},null==(o=t)||o.forEach((function(t){var e,r;r=(e=t).hasOwnProperty("fixorder")&&!isNaN(e.fixorder),(n?!r&&e.hasOwnProperty("barycenter"):r||e.hasOwnProperty("barycenter"))?i.lhs.push(t):i.rhs.push(t)})),i),s=a.lhs,u=a.rhs.sort((function(t,e){return-t.i- -e.i})),d=[],h=0,c=0,l=0;null==s||s.sort(function(t,e){return function(r,n){if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i}}(!!e,!!r)),l=Ve(d,u,l),null==s||s.forEach((function(t){var e;l+=null===(e=t.vs)||void 0===e?void 0:e.length,d.push(t.vs),h+=t.barycenter*t.weight,c+=t.weight,l=Ve(d,u,l)}));var f={vs:d.flat()};return c&&(f.barycenter=h/c,f.weight=c),f}(m,n,o,i);if(l&&(y.vs=[l,y.vs,f].flat(),null===(s=t.getPredecessors(l))||void 0===s?void 0:s.length)){var w=t.getNode((null===(u=t.getPredecessors(l))||void 0===u?void 0:u[0].id)||""),x=t.getNode((null===(d=t.getPredecessors(f))||void 0===d?void 0:d[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+w.data.order+x.data.order)/(y.weight+2),y.weight+=2}return y},qe=function(t,e){null==t||t.forEach((function(t){var r,n=null===(r=t.vs)||void 0===r?void 0:r.map((function(t){return e[t]?e[t].vs:t}));t.vs=n.flat()}))},We=function(t,e){void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},He=function(t){if("object"!=typeof t||null===t)return t;var e,r;if(r=t,Array.isArray?Array.isArray(r):w(r,"Array")){e=[];for(var n=0,o=t.length;n<o;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=He(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=He(t[i]):e[i]=t[i];return e};const $e=He;var Xe=function(t,e,r){return e.map((function(e){return i=e,a=r,s=function(t){for(var e;t.hasNode(e="_root"+Math.random()););return e}(n=t),u=new Qt({tree:[{id:s,children:[],data:{}}]}),n.getAllNodes().forEach((function(t){var e=n.getParent(t.id);(t.data.rank===i||t.data.minRank<=i&&i<=t.data.maxRank)&&(u.hasNode(t.id)||u.addNode(o({},t)),(null==e?void 0:e.id)&&!u.hasNode(null==e?void 0:e.id)&&u.addNode(o({},e)),u.setParent(t.id,(null==e?void 0:e.id)||s),n.getRelatedEdges(t.id,a).forEach((function(e){var r=e.source===t.id?e.target:e.source;u.hasNode(r)||u.addNode(o({},n.getNode(r)));var i=u.getRelatedEdges(r,"out").find((function(e){return e.target===t.id})),a=void 0!==i?i.data.weight:0;i?u.updateEdgeData(i.id,o(o({},i.data),{weight:e.data.weight+a})):u.addEdge({id:e.id,source:r,target:t.id,data:{weight:e.data.weight+a}})})),t.data.hasOwnProperty("minRank")&&u.updateNodeData(t.id,o(o({},t.data),{borderLeft:t.data.borderLeft[i],borderRight:t.data.borderRight[i]})))})),u;var n,i,a,s,u}))},Ye=function(t,e,r,n){var o=new Qt;null==t||t.forEach((function(t){for(var i,a=t.getRoots()[0].id,s=Be(t,a,o,e,r,n),u=0;u<(null===(i=s.vs)||void 0===i?void 0:i.length);u++){var d=t.getNode(s.vs[u]);d&&(d.data.order=u)}var h,c,l,f,g;h=t,c=o,l=s.vs,g={},null==l||l.forEach((function(t){for(var e,r,n=h.getParent(t);n;){if((e=h.getParent(n.id))?(r=g[e.id],g[e.id]=n.id):(r=f,f=n.id),r&&r!==n.id)return c.addNodes([{id:r,data:{}},{id:n.id,data:{}}]),void c.addEdge({id:"e"+r+"-"+n.id,source:r,target:n.id,data:{}});n=e}}))}))},Ke=function(t,e){null==e||e.forEach((function(e){null==e||e.forEach((function(e,r){t.getNode(e).data.order=r}))}))},Qe=function(t,e){var r={};function n(e,n,o,i,a){for(var s,u,d,h=n;h<o;h++)d=e[h],(null===(s=t.getNode(d))||void 0===s?void 0:s.data.dummy)&&(null===(u=t.getPredecessors(d))||void 0===u||u.forEach((function(e){var n=t.getNode(e.id);n.data.dummy&&(n.data.order<i||n.data.order>a)&&Ze(r,e.id,d)})))}function o(t,e){var r,o=(r=t,JSON.stringify(r.slice(1)));e.get(o)||(n.apply(void 0,d(t)),e.set(o,!0))}return(null==e?void 0:e.length)&&e.reduce((function(e,r){var n,i=-1,a=0,s=new Map;return null==r||r.forEach((function(u,d){var h;if("border"===(null===(h=t.getNode(u))||void 0===h?void 0:h.data.dummy)){var c=t.getPredecessors(u)||[];c.length&&(n=t.getNode(c[0].id).data.order,o([r,a,d,i,n],s),a=d,i=n)}o([r,a,r.length,n,e.length],s)})),r})),r},Ze=function(t,e,r){var n=e,o=r;if(n>o){var i=n;n=o,o=i}var a=t[n];a||(t[n]=a={}),a[o]=!0},Je=function(t,e,r){var n=e;return n>r&&(n=r),!!t[n]},tr=function(t,e,r){return function(n,o,i){var a=n.getNode(o),s=n.getNode(i),u=0,d=0;if(u+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":d=-a.data.width/2;break;case"r":d=a.data.width/2}if(d&&(u+=r?d:-d),d=0,u+=(a.data.dummy?e:t)/2,u+=(s.data.dummy?e:t)/2,u+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":d=s.data.width/2;break;case"r":d=-s.data.width/2}return d&&(u+=r?d:-d),d=0,u}},er=function(t,e){var r,n,i,a,s,u,h=ie(t);n=h,i=(e||{}).ranksep,a=void 0===i?0:i,s=se(n),u=0,null==s||s.forEach((function(t){var e=t.map((function(t){return n.getNode(t).data.height})),r=Math.max.apply(Math,d(e,[0]));null==t||t.forEach((function(t){n.getNode(t).data.y=u+r/2})),u+=r+a}));var c=function(t,e){var r,n,i,a=e||{},s=a.align,u=a.nodesep,h=void 0===u?0:u,c=a.edgesep,l=void 0===c?0:c,f=se(t),g=Object.assign((r=t,i={},(null==(n=f)?void 0:n.length)&&n.reduce((function(t,e){var n=0,o=0,a=t.length,s=null==e?void 0:e[(null==e?void 0:e.length)-1];return null==e||e.forEach((function(t,u){var d,h=function(t,e){var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find((function(e){return t.getNode(e.id).data.dummy}))}(r,t),c=h?r.getNode(h.id).data.order:a;(h||t===s)&&(null===(d=e.slice(o,u+1))||void 0===d||d.forEach((function(t){var e;null===(e=r.getPredecessors(t))||void 0===e||e.forEach((function(e){var o,a=r.getNode(e.id),s=a.data.order;!(s<n||c<s)||a.data.dummy&&(null===(o=r.getNode(t))||void 0===o?void 0:o.data.dummy)||Ze(i,e.id,t)}))})),o=u+1,n=c)})),e})),i),Qe(t,f)),p={},v=[];["u","d"].forEach((function(e){v="u"===e?f:Object.values(f).reverse(),["l","r"].forEach((function(r){"r"===r&&(v=v.map((function(t){return Object.values(t).reverse()})));var n,i,a,s,u,d,c=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),f=(i=g,a=c,s={},u={},d={},null==(n=v)||n.forEach((function(t){null==t||t.forEach((function(t,e){s[t]=t,u[t]=t,d[t]=e}))})),null==n||n.forEach((function(t){var e=-1;null==t||t.forEach((function(t){var r=a(t).map((function(t){return t.id}));if(r.length)for(var n=((r=r.sort((function(t,e){return d[t]-d[e]}))).length-1)/2,o=Math.floor(n),h=Math.ceil(n);o<=h;++o){var c=r[o];u[t]===t&&e<d[c]&&!Je(i,t,c)&&(u[c]=t,u[t]=s[t]=s[c],e=d[c])}}))})),{root:s,align:u}),m=function(t,e,r,n,i,a,s){var u,d={},h=function(t,e,r,n,i,a){var s=new Qt,u=tr(n,i,a);return null==e||e.forEach((function(e){var n;null==e||e.forEach((function(e){var i=r[e];if(s.hasNode(i)||s.addNode({id:i,data:{}}),n){var a=r[n],d=s.getRelatedEdges(a,"out").find((function(t){return t.target===i}));d?s.updateEdgeData(d.id,o(o({},d.data),{weight:Math.max(u(t,e,n),d.data.weight||0)})):s.addEdge({id:"e"+Math.random(),source:a,target:i,data:{weight:Math.max(u(t,e,n),0)}})}n=e}))})),s}(t,e,r,i,a,s),c=s?"borderLeft":"borderRight",l=function(t,e){for(var r=h.getAllNodes(),n=r.pop(),o={};n;)o[n.id]?t(n.id):(o[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return l((function(t){d[t]=(h.getRelatedEdges(t,"in")||[]).reduce((function(t,e){return Math.max(t,(d[e.source]||0)+e.data.weight)}),0)}),h.getPredecessors.bind(h)),l((function(e){var r=(h.getRelatedEdges(e,"out")||[]).reduce((function(t,e){return Math.min(t,(d[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==c&&(d[e]=Math.max(d[e],r))}),h.getSuccessors.bind(h)),null===(u=Object.values(n))||void 0===u||u.forEach((function(t){d[t]=d[r[t]]})),d}(t,v,f.root,f.align,h,l,"r"===r);"r"===r&&Object.keys(m).forEach((function(t){return m[t]=-m[t]})),p[e+r]=m}))}));var m=function(t,e){return he(Object.values(e),(function(e){var r,n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach((function(r){var i=e[r],a=function(t,e){return t.getNode(e).data.width||0}(t,r)/2;n=Math.max(i+a,n),o=Math.min(i-a,o)})),n-o}))}(t,p);return m&&function(t,e){var r=Object.values(e),n=Math.min.apply(Math,d(r)),o=Math.max.apply(Math,d(r));["u","d"].forEach((function(r){["l","r"].forEach((function(i){var a,s=r+i,u=t[s];if(u!==e){var h=Object.values(u);(a="l"===i?n-Math.min.apply(Math,d(h)):o-Math.max.apply(Math,d(h)))&&(t[s]={},Object.keys(u).forEach((function(e){t[s][e]=u[e]+a})))}}))}))}(p,m),function(t,e){var r={};return Object.keys(t.ul).forEach((function(n){if(e)r[n]=t[e.toLowerCase()][n];else{var o=Object.values(t).map((function(t){return t[n]}));r[n]=(o[0]+o[1])/2}})),r}(p,s)}(h,e);null===(r=Object.keys(c))||void 0===r||r.forEach((function(t){h.getNode(t).data.x=c[t]}))},rr=function(t,e){var r=e.acyclicer,n=e.ranker,i=e.rankdir,a=void 0===i?"tb":i,s=e.nodeOrder,u=e.keepNodeOrder,h=e.align,c=e.nodesep,l=void 0===c?50:c,f=e.edgesep,g=void 0===f?20:f,p=e.ranksep,v=void 0===p?50:p;vr(t),function(t,e){var r="greedy"===e?function(t,e){var r;if(t.getAllNodes().length<=1)return[];var n=function(t,e){var r=new Qt,n=0,i=0;t.getAllNodes().forEach((function(t){r.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((function(t){var a=r.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target})),s=(null==e?void 0:e(t))||1;a?r.updateEdgeData(null==a?void 0:a.id,o(o({},a.data),{weight:a.data.weight+s})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:s}}),i=Math.max(i,r.getNode(t.source).data.out+=s),n=Math.max(n,r.getNode(t.target).data.in+=s)}));for(var a=[],s=i+n+3,u=0;u<s;u++)a.push(new te);var d=n+1;return r.getAllNodes().forEach((function(t){re(a,d,o({v:t.id},r.getNode(t.id).data))})),{buckets:a,zeroIdx:d,graph:r}}(t,(function(t){return t.data.weight||1}));return null===(r=function(t,e,r){for(var n,o=[],i=e[e.length-1],a=e[0];t.getAllNodes().length;){for(;n=a.dequeue();)ee(t,e,r,n);for(;n=i.dequeue();)ee(t,e,r,n);if(t.getAllNodes().length)for(var s=e.length-2;s>0;--s)if(n=e[s].dequeue()){o=o.concat(ee(t,e,r,n,!0));break}}return o}(n.graph,n.buckets,n.zeroIdx).map((function(e){return t.getRelatedEdges(e.v,"out").filter((function(t){return t.target===e.w}))})))||void 0===r?void 0:r.flat()}(t):ne(t);null==r||r.forEach((function(e){var r=e.data;t.removeEdge(e.id),r.forwardName=e.data.name,r.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:o({},r)})}))}(t,r);var m,y,w=function(t){var e,r,n,o=oe(t,"root",{},"_root"),i=(r={},n=function(t,o){var i=e.getChildren(t);null==i||i.forEach((function(t){return n(t.id,o+1)})),r[t]=o},(e=t).getRoots().forEach((function(t){return n(t.id,1)})),r),a=Math.max.apply(Math,d(Object.values(i)));Math.abs(a)===1/0&&(a=1);var s=a-1,u=2*s+1;t.getAllEdges().forEach((function(t){t.data.minlen*=u}));var h=function(t){var e=0;return t.getAllEdges().forEach((function(t){e+=t.data.weight})),e}(t)+1;return t.getRoots().forEach((function(e){Re(t,o,u,h,s,i,e.id)})),{nestingRoot:o,nodeRankFactor:u}}(t),x=w.nestingRoot,E=w.nodeRankFactor;!function(t,e){switch(e){case"network-simplex":!function(t){!function(t){var e,r,n=(e=t,r=new Qt,e.getAllNodes().forEach((function(t){r.addNode(o({},t))})),e.getAllEdges().forEach((function(t){var e=r.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target}));e?r.updateEdgeData(null==e?void 0:e.id,o(o({},e.data),{weight:e.data.weight+t.data.weight||0,minlen:Math.max(e.data.minlen,t.data.minlen||1)})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),r);ge(n);var i,a,s=function(t){var e,r,n=new Qt({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);ve(n,t)<i;)e=ye(n,t),r=n.hasNode(e.source)?pe(t,e):-pe(t,e),we(n,t,r);return n}(n);for(Ne(s),xe(s,n);i=_e(s);)a=Ae(s,n,i),Se(s,n,i,a)}(t)}(t);break;case"tight-tree":default:(function(t){var e,r={},n=function(o){var i,a,s=t.getNode(o);return s?r[o]?s.data.rank:(r[o]=!0,null===(i=t.getRelatedEdges(o,"out"))||void 0===i||i.forEach((function(t){var e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),(void 0===e||a<e)&&(e=a),s.data.rank=a,a):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){t&&n(t.id)})),void 0===e&&(e=0);var o={},i=function(e,r){var n,a=t.getNode(e),s=isNaN(a.data.layer)?r:a.data.layer;(void 0===a.data.rank||a.data.rank<s)&&(a.data.rank=s),o[e]||(o[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach((function(t){i(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((function(t){var r=t.data;r&&(isNaN(r.layer)?r.rank-=e:i(t.id,r.layer))}))})(r=t),function(t){var e,r,n=new Qt({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);me(n,t)<i;)e=ye(n,t),r=n.hasNode(e.source)?pe(t,e):-pe(t,e),we(n,t,r)}(r);break;case"longest-path":De(t)}var r}(ie(t),n),ur(t),function(t,e){void 0===e&&(e=0);var r=t.getAllNodes(),n=r.filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),o=Math.min.apply(Math,d(n)),i=[];r.forEach((function(t){var e=(t.data.rank||0)-o;i[e]||(i[e]=[]),i[e].push(t.id)}));for(var a=0,s=0;s<i.length;s++){var u=i[s];void 0===u?s%e!=0&&(a-=1):a&&(null==u||u.forEach((function(e){var r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=a)})))}}(t,E),m=t,(y=x)&&m.removeNode(y),m.getAllEdges().forEach((function(t){t.data.nestingEdge&&m.removeEdge(t.id)})),function(t){var e=t.getAllNodes().filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),r=Math.min.apply(Math,d(e));t.getAllNodes().forEach((function(t){t.data.hasOwnProperty("rank")&&r!==1/0&&(t.data.rank-=r)}))}(t),dr(t),hr(t);var b=[];!function(t,e){t.getAllEdges().forEach((function(r){return function(t,e,r){var n=e.source,o=t.getNode(n).data.rank,i=e.target,a=t.getNode(i).data.rank,s=e.data.labelRank;if(a!==o+1){var u,d,h;for(t.removeEdge(e.id),h=0,++o;o<a;++h,++o)e.data.points=[],u=oe(t,"edge",d={originalEdge:e,width:0,height:0,rank:o},"_d"),o===s&&(d.width=e.data.width,d.height=e.data.height,d.dummy=fe,d.labelpos=e.data.labelpos),t.addEdge({id:"e"+Math.random(),source:n,target:u,data:{weight:e.data.weight}}),0===h&&r.push(u),n=u;t.addEdge({id:"e"+Math.random(),source:n,target:i,data:{weight:e.data.weight}})}}(t,r,e)}))}(t,b),function(t,e){var r,n,o,i,a=(n={},o=0,i=function(t){var e=o;r.getChildren(t).forEach((function(t){return i(t.id)})),n[t]={low:e,lim:o++}},(r=t).getRoots().forEach((function(t){return i(t.id)})),n);e.forEach((function(e){var r,n,o=e,i=t.getNode(o),s=i.data.originalEdge;if(s)for(var u=function(t,e,r,n){var o,i,a,s,u=[],d=[],h=Math.min(e[r].low,e[n].low),c=Math.max(e[r].lim,e[n].lim);a=r;do{a=null===(o=t.getParent(a))||void 0===o?void 0:o.id,u.push(a)}while(a&&(e[a].low>h||c>e[a].lim));for(s=a,a=n;a&&a!==s;)d.push(a),a=null===(i=t.getParent(a))||void 0===i?void 0:i.id;return{lca:s,path:u.concat(d.reverse())}}(t,a,s.source,s.target),d=u.path,h=u.lca,c=0,l=d[c],f=!0;o!==s.target;){if(i=t.getNode(o),f){for(;l!==h&&(null===(r=t.getNode(l))||void 0===r?void 0:r.data.maxRank)<i.data.rank;)l=d[++c];l===h&&(f=!1)}if(!f){for(;c<d.length-1&&(null===(n=t.getNode(d[c+1]))||void 0===n?void 0:n.data.minRank)<=i.data.rank;)c++;l=d[c]}t.hasNode(l)&&t.setParent(o,l),o=t.getSuccessors(o)[0].id}}))}(t,b),function(t){var e=function(r){var n=t.getChildren(r),o=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach((function(t){return e(t.id)})),o.data.hasOwnProperty("minRank")){o.data.borderLeft=[],o.data.borderRight=[];for(var i=o.data.minRank,a=o.data.maxRank+1;i<a;i+=1)Oe(t,"borderLeft","_bl",r,o,i),Oe(t,"borderRight","_br",r,o,i)}};t.getRoots().forEach((function(t){return e(t.id)}))}(t),u&&function(t,e){for(var r=t.getAllNodes().filter((function(e){var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)})).map((function(t){return t.data.rank})),n=Math.max.apply(Math,d(r)),o=[],i=0;i<n+1;i++)o[i]=[];null==e||e.forEach((function(e){var r=t.getNode(e);r&&!r.data.dummy&&(isNaN(r.data.rank)||(r.data.fixorder=o[r.data.rank].length,o[r.data.rank].push(e)))}))}(t,s),function(t,e){for(var r=de(t),n=[],o=[],i=1;i<r+1;i++)n.push(i);for(i=r-1;i>-1;i--)o.push(i);var a=Xe(t,n,"in"),s=Xe(t,o,"out"),u=Fe(t);Ke(t,u);for(var d,h=Number.POSITIVE_INFINITY,c=(i=0,0);c<4;++i,++c)Ye(i%2?a:s,i%4>=2,!1,e),u=se(t),(l=Ge(t,u))<h&&(c=0,d=$e(u),h=l);for(u=Fe(t),Ke(t,u),i=0,c=0;c<4;++i,++c){var l;Ye(i%2?a:s,i%4>=2,!0,e),u=se(t),(l=Ge(t,u))<h&&(c=0,d=$e(u),h=l)}Ke(t,d)}(t,u),mr(t),function(t,e){var r=e.toLowerCase();"lr"!==r&&"rl"!==r||ze(t)}(t,a),er(t,{align:h,nodesep:l,edgesep:g,ranksep:v}),yr(t),pr(t),function(t,e){e.forEach((function(e){var r,n=t.getNode(e),o=n.data.originalEdge;o&&t.addEdge(o);for(var i=e;n.data.dummy;)r=t.getSuccessors(i)[0],t.removeNode(i),o.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===fe&&(o.data.x=n.data.x,o.data.y=n.data.y,o.data.width=n.data.width,o.data.height=n.data.height),i=r.id,n=t.getNode(i)}))}(t,b),fr(t),function(t,e){var r,n=e.toLowerCase();"bt"!==n&&"rl"!==n||((r=t).getAllNodes().forEach((function(t){Le(t.data)})),r.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return Le(t)})),t.data.hasOwnProperty("y")&&Le(t.data)}))),"lr"!==n&&"rl"!==n||(function(t){t.getAllNodes().forEach((function(t){Pe(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return Pe(t)})),t.data.hasOwnProperty("x")&&Pe(t.data)}))}(t),ze(t))}(t,a);var N=cr(t),M=N.width,_=N.height;return lr(t),gr(t),function(t){t.getAllEdges().forEach((function(e){var r=e.data;if(r.reversed){t.removeEdge(e.id);var n=r.forwardName;delete r.reversed,delete r.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:o(o({},r),{forwardName:n})})}}))}(t),{width:M,height:_}},nr=["width","height","layer","fixorder"],or={width:0,height:0},ir=["minlen","weight","width","height","labeloffset"],ar={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},sr=["labelpos"],ur=function(t){t.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var r=t.getNode(e.source),n={e:e,rank:(t.getNode(e.target).data.rank-r.data.rank)/2+r.data.rank};oe(t,"edge-proxy",n,"_ep")}}))},dr=function(t){var e=0;return t.getAllNodes().forEach((function(r){var n,o;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(o=t.getNode(r.data.borderBottom))||void 0===o?void 0:o.data.rank,e=Math.max(e,r.data.maxRank||-1/0))})),e},hr=function(t){t.getAllNodes().forEach((function(e){"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},cr=function(t,e){var r,n,o=0,i=0,a=e||{},s=a.marginx,u=void 0===s?0:s,d=a.marginy,h=void 0===d?0:d,c=function(t){if(t.data){var e=t.data.x,a=t.data.y,s=t.data.width,u=t.data.height;isNaN(e)||isNaN(s)||(void 0===r&&(r=e-s/2),r=Math.min(r,e-s/2),o=Math.max(o,e+s/2)),isNaN(a)||isNaN(u)||(void 0===n&&(n=a-u/2),n=Math.min(n,a-u/2),i=Math.max(i,a+u/2))}};return t.getAllNodes().forEach((function(t){c(t)})),t.getAllEdges().forEach((function(t){(null==t?void 0:t.data.hasOwnProperty("x"))&&c(t)})),r-=u,n-=h,t.getAllNodes().forEach((function(t){t.data.x-=r,t.data.y-=n})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){t.x-=r,t.y-=n})),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)})),{width:o-r+u,height:i-n+h}},lr=function(t){t.getAllEdges().forEach((function(e){var r,n,o=t.getNode(e.source),i=t.getNode(e.target);e.data.points?(r=e.data.points[0],n=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:i.data.x,y:i.data.y},n={x:o.data.x,y:o.data.y}),e.data.points.unshift(ae(o.data,r)),e.data.points.push(ae(i.data,n))}))},fr=function(t){t.getAllEdges().forEach((function(t){if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},gr=function(t){t.getAllEdges().forEach((function(t){var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},pr=function(t){t.getAllNodes().forEach((function(e){var r,n,o;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){var i=t.getNode(e.id),a=t.getNode(i.data.borderTop),s=t.getNode(i.data.borderBottom),u=t.getNode(i.data.borderLeft[(null===(n=i.data.borderLeft)||void 0===n?void 0:n.length)-1]),d=t.getNode(i.data.borderRight[(null===(o=i.data.borderRight)||void 0===o?void 0:o.length)-1]);i.data.width=Math.abs((null==d?void 0:d.data.x)-(null==u?void 0:u.data.x))||10,i.data.height=Math.abs((null==s?void 0:s.data.y)-(null==a?void 0:a.data.y))||10,i.data.x=((null==u?void 0:u.data.x)||0)+i.data.width/2,i.data.y=((null==a?void 0:a.data.y)||0)+i.data.height/2}})),t.getAllNodes().forEach((function(e){"border"===e.data.dummy&&t.removeNode(e.id)}))},vr=function(t){t.getAllEdges().forEach((function(e){if(e.source===e.target){var r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}}))},mr=function(t){var e=se(t);null==e||e.forEach((function(e){var r=0;null==e||e.forEach((function(e,n){var o,i=t.getNode(e);i.data.order=n+r,null===(o=i.data.selfEdges)||void 0===o||o.forEach((function(e){oe(t,"selfedge",{width:e.data.width,height:e.data.height,rank:i.data.rank,order:n+ ++r,e:e},"_se")})),delete i.data.selfEdges}))}))},yr=function(t){t.getAllNodes().forEach((function(e){var r=t.getNode(e.id);if("selfedge"===r.data.dummy){var n=t.getNode(r.data.e.source),o=n.data.x+n.data.width/2,i=n.data.y,a=r.data.x-o,s=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}}))},wr=function(t,e){var r={};return null==e||e.forEach((function(e){void 0!==t[e]&&(r[e]=+t[e])})),r},xr=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(r){e[r.toLowerCase()]=t[r]})),e},Er={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},br=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="dagre",this.layoutNode=function(t){return t.data.layout},this.options=o(o({},Er),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,this.genericDagreLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){switch(r.label){case 0:return[4,this.genericDagreLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericDagreLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,u,d,h,c,l,f,g,p,v,m,y,w,E,b,N,M,_,A,S,k,I,T,D,R,z,C,P,j,G,U,V=this;return s(this,(function(s){return n=o(o({},this.options),r),i=n.nodeSize,a=n.align,u=n.rankdir,d=void 0===u?"TB":u,h=n.ranksep,c=n.nodesep,l=n.ranksepFunc,f=n.nodesepFunc,g=n.edgeLabelSpace,p=n.nodeOrder,v=n.begin,m=n.controlPoints,y=n.radial,w=new Qt({tree:[]}),E=L(h||50,l),b=L(c||50,f),N=b,M=E,"LR"!==d&&"RL"!==d||(N=E,M=b),_=F(i,void 0),A=e.getAllNodes(),S=e.getAllEdges(),A.filter((function(t){return t.data.layout})).forEach((function(t){var e=_(t),r=M(t),n=e+2*N(t),o=e+2*r,i=t.data.layer;x(i)?w.addNode({id:t.id,data:{width:n,height:o,layer:i}}):w.addNode({id:t.id,data:{width:n,height:o}})})),S.forEach((function(t){V.layoutNode(w.getNode(t.source))&&V.layoutNode(w.getNode(t.target))&&w.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),function(t,e){var r,n,i=e.edgeLabelSpace,a=e.keepNodeOrder,s=e.prevGraph,u=e.rankdir,d=e.ranksep;!a&&s&&(n=s,(r=t).getAllNodes().forEach((function(t){var e=r.getNode(t.id),o=n.getNode(t.id);void 0!==o?(e.data.fixorder=o.data._order,delete o.data._order):delete e.data.fixorder})));var h,c,l=(h=t,c=new Qt({tree:[]}),h.getAllNodes().forEach((function(t){var e=xr(h.getNode(t.id).data),r=o(o({},or),e),n=wr(r,nr);c.hasNode(t.id)||c.addNode({id:t.id,data:o({},n)});var i=h.getParent(t.id);null==i||(c.hasNode(i.id)||c.addNode(o({},i)),c.setParent(t.id,i.id))})),h.getAllEdges().forEach((function(t){var e=xr(h.getEdge(t.id).data),r={};null==sr||sr.forEach((function(t){void 0!==e[t]&&(r[t]=e[t])})),c.addEdge({id:t.id,source:t.source,target:t.target,data:Object.assign({},ar,wr(e,ir),r)})})),c);i&&(e.ranksep=function(t,e){var r=e.ranksep,n=void 0===r?0:r,o=e.rankdir;return t.getAllNodes().forEach((function(t){isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((function(t){var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===o||"BT"===o?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2}(l,{rankdir:u,ranksep:d}));try{rr(l,e)}catch(h){if("Not possible to find intersection inside of the rectangle"===h.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:\n",h);throw h}!function(t,e){t.getAllNodes().forEach((function(r){var n,o=t.getNode(r.id);if(o){var i=e.getNode(r.id);o.data.x=i.data.x,o.data.y=i.data.y,o.data._order=i.data.order,o.data._rank=i.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(o.data.width=i.data.width,o.data.height=i.data.height)}})),t.getAllEdges().forEach((function(r){var n=t.getEdge(r.id),o=e.getEdge(r.id);n.data.points=o?o.data.points:[],o&&o.data.hasOwnProperty("x")&&(n.data.x=o.data.x,n.data.y=o.data.y)}))}(t,l)}(w,{prevGraph:null,edgeLabelSpace:g,keepNodeOrder:!!p,nodeOrder:p||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:d,nodesep:c,align:a}),k=[0,0],v&&(I=1/0,T=1/0,w.getAllNodes().forEach((function(t){I>t.data.x&&(I=t.data.x),T>t.data.y&&(T=t.data.y)})),w.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){I>t.x&&(I=t.x),T>t.y&&(T=t.y)}))})),k[0]=v[0]-I,k[1]=v[1]-T),D="LR"===d||"RL"===d,y||(R=new Set,z="BT"===d||"RL"===d?function(t,e){return e-t}:function(t,e){return t-e},w.getAllNodes().forEach((function(t){t.data.x=t.data.x+k[0],t.data.y=t.data.y+k[1],R.add(D?t.data.x:t.data.y)})),C=Array.from(R).sort(z),P=D?function(t,e){return t.x!==e.x}:function(t,e){return t.y!==e.y},j=D?function(t,e,r){var n=Math.max(e.y,r.y),o=Math.min(e.y,r.y);return t.filter((function(t){return t.y<=n&&t.y>=o}))}:function(t,e,r){var n=Math.max(e.x,r.x),o=Math.min(e.x,r.x);return t.filter((function(t){return t.x<=n&&t.x>=o}))},w.getAllEdges().forEach((function(t,e){var r;g&&m&&"loop"!==t.data.type&&(t.data.controlPoints=Nr(null===(r=t.data.points)||void 0===r?void 0:r.map((function(t){var e=t.x,r=t.y;return{x:e+k[0],y:r+k[1]}})),w.getNode(t.source),w.getNode(t.target),C,D,P,j))}))),G=[],G=w.getAllNodes().map((function(t){return O(t)})),U=w.getAllEdges(),t&&(G.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),U.forEach((function(t){e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),[2,{nodes:G,edges:U}]}))}))},t}(),Nr=function(t,e,r,n,o,i,a){var s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){var u=e.data,d=u.x,h=u.y,c=r.data,l=c.x,f=c.y;if(o&&(d=e.data.y,h=e.data.x,l=r.data.y,f=r.data.x),f!==h&&d!==l){var g=n.indexOf(h),p=n[g+1];if(p){var v=s[0],m=o?{x:(h+p)/2,y:(null==v?void 0:v.y)||l}:{x:(null==v?void 0:v.x)||l,y:(h+p)/2};v&&!i(v,m)||s.unshift(m)}var y=n.indexOf(f),w=Math.abs(y-g);if(1===w)(s=a(s,e.data,r.data)).length||s.push(o?{x:(h+f)/2,y:d}:{x:d,y:(h+f)/2});else if(w>1){var x=n[y-1];if(x){var E=s[s.length-1],b=o?{x:(f+x)/2,y:(null==E?void 0:E.y)||l}:{x:(null==E?void 0:E.x)||d,y:(f+x)/2};E&&!i(E,b)||s.push(b)}}}}return s};function Mr(t,e,r,n,o){if(isNaN(e)||isNaN(r)||isNaN(n))return t;var i,a,s,u,d,h,c,l,f,g,p,v,m=t._root,y={data:o},w=t._x0,x=t._y0,E=t._z0,b=t._x1,N=t._y1,M=t._z1;if(!m)return t._root=y,t;for(;m.length;)if((l=e>=(a=(w+b)/2))?w=a:b=a,(f=r>=(s=(x+N)/2))?x=s:N=s,(g=n>=(u=(E+M)/2))?E=u:M=u,i=m,!(m=m[p=g<<2|f<<1|l]))return i[p]=y,t;if(d=+t._x.call(null,m.data),h=+t._y.call(null,m.data),c=+t._z.call(null,m.data),e===d&&r===h&&n===c)return y.next=m,i?i[p]=y:t._root=y,t;do{i=i?i[p]=new Array(8):t._root=new Array(8),(l=e>=(a=(w+b)/2))?w=a:b=a,(f=r>=(s=(x+N)/2))?x=s:N=s,(g=n>=(u=(E+M)/2))?E=u:M=u}while((p=g<<2|f<<1|l)==(v=(c>=u)<<2|(h>=s)<<1|d>=a));return i[v]=m,i[p]=y,t}function _r(t,e,r,n,o,i,a){this.node=t,this.x0=e,this.y0=r,this.z0=n,this.x1=o,this.y1=i,this.z1=a}function Ar(t){return t[0]}function Sr(t){return t[1]}function kr(t){return t[2]}function Ir(t,e,r,n){var o=new Tr(null==e?Ar:e,null==r?Sr:r,null==n?kr:n,NaN,NaN,NaN,NaN,NaN,NaN);return null==t?o:o.addAll(t)}function Tr(t,e,r,n,o,i,a,s,u){this._x=t,this._y=e,this._z=r,this._x0=n,this._y0=o,this._z0=i,this._x1=a,this._y1=s,this._z1=u,this._root=void 0}function Dr(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var Rr=Ir.prototype=Tr.prototype;function Or(t){var e=0,r=0,n=0,o=0,i=t.length;if(i){for(var a=0;a<i;a++)(s=t[a])&&s.weight&&(e+=s.weight,r+=s.x*s.weight,n+=s.y*s.weight,o+=s.z*s.weight);t.x=r/e,t.y=n/e,t.z=o/e,t.weight=e}else{var s=t;t.x=s.data.x,t.y=s.data.y,t.z=s.data.z,t.weight=s.data.weight}}Rr.copy=function(){var t,e,r=new Tr(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),n=this._root;if(!n)return r;if(!n.length)return r._root=Dr(n),r;for(t=[{source:n,target:r._root=new Array(8)}];n=t.pop();)for(var o=0;o<8;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(8)}):n.target[o]=Dr(e));return r},Rr.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t),n=+this._z.call(null,t);return Mr(this.cover(e,r,n),e,r,n,t)},Rr.addAll=function(t){Array.isArray(t)||(t=Array.from(t));const e=t.length,r=new Float64Array(e),n=new Float64Array(e),o=new Float64Array(e);let i=1/0,a=1/0,s=1/0,u=-1/0,d=-1/0,h=-1/0;for(let c,l,f,g,p=0;p<e;++p)isNaN(l=+this._x.call(null,c=t[p]))||isNaN(f=+this._y.call(null,c))||isNaN(g=+this._z.call(null,c))||(r[p]=l,n[p]=f,o[p]=g,l<i&&(i=l),l>u&&(u=l),f<a&&(a=f),f>d&&(d=f),g<s&&(s=g),g>h&&(h=g));if(i>u||a>d||s>h)return this;this.cover(i,a,s).cover(u,d,h);for(let c=0;c<e;++c)Mr(this,r[c],n[c],o[c],t[c]);return this},Rr.cover=function(t,e,r){if(isNaN(t=+t)||isNaN(e=+e)||isNaN(r=+r))return this;var n=this._x0,o=this._y0,i=this._z0,a=this._x1,s=this._y1,u=this._z1;if(isNaN(n))a=(n=Math.floor(t))+1,s=(o=Math.floor(e))+1,u=(i=Math.floor(r))+1;else{for(var d,h,c=a-n||1,l=this._root;n>t||t>=a||o>e||e>=s||i>r||r>=u;)switch(h=(r<i)<<2|(e<o)<<1|t<n,(d=new Array(8))[h]=l,l=d,c*=2,h){case 0:a=n+c,s=o+c,u=i+c;break;case 1:n=a-c,s=o+c,u=i+c;break;case 2:a=n+c,o=s-c,u=i+c;break;case 3:n=a-c,o=s-c,u=i+c;break;case 4:a=n+c,s=o+c,i=u-c;break;case 5:n=a-c,s=o+c,i=u-c;break;case 6:a=n+c,o=s-c,i=u-c;break;case 7:n=a-c,o=s-c,i=u-c}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=o,this._z0=i,this._x1=a,this._y1=s,this._z1=u,this},Rr.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Rr.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},Rr.find=function(t,e,r,n){var o,i,a,s,u,d,h,c,l,f=this._x0,g=this._y0,p=this._z0,v=this._x1,m=this._y1,y=this._z1,w=[],x=this._root;for(x&&w.push(new _r(x,f,g,p,v,m,y)),null==n?n=1/0:(f=t-n,g=e-n,p=r-n,v=t+n,m=e+n,y=r+n,n*=n);c=w.pop();)if(!(!(x=c.node)||(i=c.x0)>v||(a=c.y0)>m||(s=c.z0)>y||(u=c.x1)<f||(d=c.y1)<g||(h=c.z1)<p))if(x.length){var E=(i+u)/2,b=(a+d)/2,N=(s+h)/2;w.push(new _r(x[7],E,b,N,u,d,h),new _r(x[6],i,b,N,E,d,h),new _r(x[5],E,a,N,u,b,h),new _r(x[4],i,a,N,E,b,h),new _r(x[3],E,b,s,u,d,N),new _r(x[2],i,b,s,E,d,N),new _r(x[1],E,a,s,u,b,N),new _r(x[0],i,a,s,E,b,N)),(l=(r>=N)<<2|(e>=b)<<1|t>=E)&&(c=w[w.length-1],w[w.length-1]=w[w.length-1-l],w[w.length-1-l]=c)}else{var M=t-+this._x.call(null,x.data),_=e-+this._y.call(null,x.data),A=r-+this._z.call(null,x.data),S=M*M+_*_+A*A;if(S<n){var k=Math.sqrt(n=S);f=t-k,g=e-k,p=r-k,v=t+k,m=e+k,y=r+k,o=x.data}}return o},Rr.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t))||isNaN(s=+this._z.call(null,t)))return this;var e,r,n,o,i,a,s,u,d,h,c,l,f,g,p,v=this._root,m=this._x0,y=this._y0,w=this._z0,x=this._x1,E=this._y1,b=this._z1;if(!v)return this;if(v.length)for(;;){if((c=i>=(u=(m+x)/2))?m=u:x=u,(l=a>=(d=(y+E)/2))?y=d:E=d,(f=s>=(h=(w+b)/2))?w=h:b=h,e=v,!(v=v[g=f<<2|l<<1|c]))return this;if(!v.length)break;(e[g+1&7]||e[g+2&7]||e[g+3&7]||e[g+4&7]||e[g+5&7]||e[g+6&7]||e[g+7&7])&&(r=e,p=g)}for(;v.data!==t;)if(n=v,!(v=v.next))return this;return(o=v.next)&&delete v.next,n?(o?n.next=o:delete n.next,this):e?(o?e[g]=o:delete e[g],(v=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&v===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!v.length&&(r?r[p]=v:this._root=v),this):(this._root=o,this)},Rr.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},Rr.root=function(){return this._root},Rr.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Rr.visit=function(t){var e,r,n,o,i,a,s,u,d=[],h=this._root;for(h&&d.push(new _r(h,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=d.pop();)if(!t(h=e.node,n=e.x0,o=e.y0,i=e.z0,a=e.x1,s=e.y1,u=e.z1)&&h.length){var c=(n+a)/2,l=(o+s)/2,f=(i+u)/2;(r=h[7])&&d.push(new _r(r,c,l,f,a,s,u)),(r=h[6])&&d.push(new _r(r,n,l,f,c,s,u)),(r=h[5])&&d.push(new _r(r,c,o,f,a,l,u)),(r=h[4])&&d.push(new _r(r,n,o,f,c,l,u)),(r=h[3])&&d.push(new _r(r,c,l,i,a,s,f)),(r=h[2])&&d.push(new _r(r,n,l,i,c,s,f)),(r=h[1])&&d.push(new _r(r,c,o,i,a,l,f)),(r=h[0])&&d.push(new _r(r,n,o,i,c,l,f))}return this},Rr.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new _r(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.z0,d=e.x1,h=e.y1,c=e.z1,l=(a+d)/2,f=(s+h)/2,g=(u+c)/2;(i=o[0])&&r.push(new _r(i,a,s,u,l,f,g)),(i=o[1])&&r.push(new _r(i,l,s,u,d,f,g)),(i=o[2])&&r.push(new _r(i,a,f,u,l,h,g)),(i=o[3])&&r.push(new _r(i,l,f,u,d,h,g)),(i=o[4])&&r.push(new _r(i,a,s,g,l,f,c)),(i=o[5])&&r.push(new _r(i,l,s,g,d,f,c)),(i=o[6])&&r.push(new _r(i,a,f,g,l,h,c)),(i=o[7])&&r.push(new _r(i,l,f,g,d,h,c))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.z0,e.x1,e.y1,e.z1);return this},Rr.x=function(t){return arguments.length?(this._x=t,this):this._x},Rr.y=function(t){return arguments.length?(this._y=t,this):this._y},Rr.z=function(t){return arguments.length?(this._z=t,this):this._z};var zr={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},Cr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=o(o({},zr),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericForceLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,u,d,h,c,l,f,g,p,v,m,y,w,E,b,N,M,_=this;return s(this,(function(s){return n=o(o({},this.options),r),i=e.getAllNodes(),a=e.getAllEdges(),u=this.formatOptions(n,e),d=u.width,h=u.height,c=u.nodeSize,l=u.getMass,f=u.nodeStrength,g=u.edgeStrength,p=u.linkDistance,v=i.map((function(t){return o(o({},t),{data:o(o({},t.data),{x:x(t.data.x)?t.data.x:Math.random()*d,y:x(t.data.y)?t.data.y:Math.random()*h,size:c(t)||30,mass:l(t),nodeStrength:f(t)})})})),m=a.map((function(t){return o(o({},t),{data:o(o({},t.data),{edgeStrength:g(t),linkDistance:p(t,e.getNode(t.source),e.getNode(t.target))})})})),(null==i?void 0:i.length)?(y={},i.forEach((function(t,e){y[t.id]={x:0,y:0}})),w=new Qt({nodes:v,edges:m}),this.formatCentripetal(u,w),E=u.maxIteration,b=u.minMovement,N=u.onTick,this.lastLayoutNodes=v,this.lastLayoutEdges=m,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=w,this.lastOptions=u,this.lastVelMap=y,"undefined"==typeof window?[2]:(M=0,[2,new Promise((function(r){_.timeInterval=window.setInterval((function(){i&&_.running||r({nodes:Gr(e,v),edges:a}),_.runOneStep(w,e,M,y,u),_.updatePosition(e,w,y,u),t&&v.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),null==N||N({nodes:Gr(e,v),edges:a}),(++M>=E||_.judgingDistance<b)&&(window.clearInterval(_.timeInterval),r({nodes:Gr(e,v),edges:a}))}),0),_.running=!0}))])):(this.lastResult={nodes:[],edges:a},[2,{nodes:[],edges:a}])}))}))},t.prototype.formatOptions=function(t,e){var r=t,n=t.width,o=t.height,i=t.getMass;if(r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=o||"undefined"==typeof window?o:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),i||(r.getMass=function(t){var r=1;x(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);var n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),t.preventOverlap){var a=L(0,t.nodeSpacing);t.nodeSize?g(t.nodeSize)?r.nodeSize=function(e){var r=t.nodeSize;return Math.max(r[0],r[1])+a(e)}:r.nodeSize=function(e){return t.nodeSize+a(e)}:r.nodeSize=function(t){var e=((null==t?void 0:t.data)||{}).size;return e?g(e)?Math.max(e[0],e[1])+a(t):C(e)?Math.max(e.width,e.height)+a(t):e+a(t):10+a(t)}}return r.linkDistance=t.linkDistance?L(1,t.linkDistance):function(t){return 1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target))},r.nodeStrength=L(1,t.nodeStrength),r.edgeStrength=L(1,t.edgeStrength),t},t.prototype.formatCentripetal=function(t,e){var r,n=t.centripetalOptions,o=t.center,i=t.clusterNodeStrength,a=t.leafCluster,s=t.clustering,u=t.nodeClusterBy,d=e.getAllNodes(),h=n||{leaf:2,single:2,others:1,center:function(t){return{x:o[0],y:o[1]}}};"function"!=typeof i&&(t.clusterNodeStrength=function(t){return i});var c=[];if(a&&u&&(r=Lr(e,u),c=Array.from(new Set(null==d?void 0:d.map((function(t){return t.data[u]}))))||[],t.centripetalOptions=Object.assign(h,{single:100,leaf:function(e){var n=r[e.id]||{},o=n.siblingLeaves,i=n.sameTypeLeaves;return(null==i?void 0:i.length)===(null==o?void 0:o.length)||1===(null==c?void 0:c.length)?1:t.clusterNodeStrength(e)},others:1,center:function(t){var n,o=e.getDegree(t.id,"both");if(!o)return{x:100,y:100};if(1===o){var i=(r[t.id]||{}).sameTypeLeaves,a=void 0===i?[]:i;1===a.length?n=void 0:a.length>1&&(n=jr(a))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y}}})),s&&u){r||(r=Lr(e,u)),c||(c=Array.from(new Set(d.map((function(t){return t.data[u]}))))),c=c.filter((function(t){return void 0!==t}));var l={};c.forEach((function(t){var r=d.filter((function(e){return e.data[u]===t})).map((function(t){return e.getNode(t.id)}));l[t]=jr(r)})),t.centripetalOptions=Object.assign(h,{single:function(e){return t.clusterNodeStrength(e)},leaf:function(e){return t.clusterNodeStrength(e)},others:function(e){return t.clusterNodeStrength(e)},center:function(t){var e=l[t.data[u]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y}}})}var f=t.centripetalOptions||{},g=f.leaf,p=f.single,v=f.others;g&&"function"!=typeof g&&(t.centripetalOptions.leaf=function(){return g}),p&&"function"!=typeof p&&(t.centripetalOptions.single=function(){return p}),v&&"function"!=typeof v&&(t.centripetalOptions.others=function(){return v})},t.prototype.runOneStep=function(t,e,r,n,o){var i={},a=t.getAllNodes(),s=t.getAllEdges();if(null==a?void 0:a.length){var u=o.monitor;this.calRepulsive(t,i,o),s&&this.calAttractive(t,i,o),this.calGravity(t,e,i,o),this.updateVelocity(t,i,n,o),u&&u({energy:this.calTotalEnergy(i,a),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}},t.prototype.calTotalEnergy=function(t,e){if(!(null==e?void 0:e.length))return 0;var r=0;return e.forEach((function(e,n){var o=t[e.id].x,i=t[e.id].y,a=o*o+i*i,s=e.data.mass;r+=(void 0===s?1:s)*a*.5})),r},t.prototype.calRepulsive=function(t,e,r){var n,o,i,a,s,u,d=r.dimensions,h=r.factor,c=r.coulombDisScale;n=e,o=d,i=h/(c*c),a=t.getAllNodes(),s=a.map((function(t,e){var r=t.data,n=r.nodeStrength;return{x:r.x,y:r.y,z:r.z,size:r.size,index:e,vx:0,vy:0,vz:0,weight:i*n}})),u=(2===o?rt(s,(function(t){return t.x}),(function(t){return t.y})):Ir(s,(function(t){return t.x}),(function(t){return t.y}),(function(t){return t.z}))).visitAfter(Or),s.forEach((function(t){var e,r;e=t,r=o,u.visit((function(t,n,o,i,a){return function(t,e,r,n,o,i,a){var s=[r,n,o][a-1],u=i.x-t.x||.1,d=i.y-t.y||.1,h=i.z-t.z||.1,c=s-e,l=u*u+d*d+h*h,f=Math.sqrt(l)*l;if(c*c*.81<l){var g=t.weight/f;return i.vx+=u*g,i.vy+=d*g,i.vz+=h*g,!0}if(t.length)return!1;t.data!==i&&(g=t.data.weight/f,i.vx+=u*g,i.vy+=d*g,i.vz+=h*g)}(t,n,o,i,a,e,r)}))})),s.map((function(t,e){var r=a[e],o=r.id,i=r.data.mass,s=void 0===i?1:i;n[o]={x:t.vx/s,y:t.vy/s,z:t.vz/s}}))},t.prototype.calAttractive=function(t,e,r){var n=r.dimensions;t.getAllEdges().forEach((function(r,o){var i=r.source,a=r.target,s=t.getNode(i),u=t.getNode(a);if(s&&u){var d=u.data.x-s.data.x,h=u.data.y-s.data.y,c=3===n?u.data.z-s.data.z:0;d||h||(d=.01*Math.random(),h=.01*Math.random(),3!==n||c||(c=.01*Math.random()));var l=Math.sqrt(d*d+h*h+c*c),f=d/l,g=h/l,p=c/l,v=r.data||{},m=v.linkDistance,y=void 0===m?200:m,w=v.edgeStrength,x=(y-l)*(void 0===w?200:w),E=1/(s.data.mass||1),b=1/(u.data.mass||1),N=f*x,M=g*x,_=p*x;e[i].x-=N*E,e[i].y-=M*E,e[i].z-=_*E,e[a].x+=N*b,e[a].y+=M*b,e[a].z+=M*b}}))},t.prototype.calGravity=function(t,e,r,n){var o=n.getCenter,i=t.getAllNodes(),a=e.getAllNodes(),s=e.getAllEdges(),d=n.width,h=n.height,c=n.center,l=n.gravity,f=n.centripetalOptions;i&&i.forEach((function(n){var i=n.id,g=n.data,p=g.mass,v=g.x,m=g.y,y=g.z,w=e.getNode(i),E=0,b=0,N=0,M=l,_=t.getDegree(i,"in"),A=t.getDegree(i,"out"),S=t.getDegree(i,"both"),k=null==o?void 0:o(w,S);if(k){var I=u(k,3);E=v-I[0],b=m-I[1],M=I[2]}else E=v-c[0],b=m-c[1],N=y-c[2];if(M&&(r[i].x-=M*E/p,r[i].y-=M*b/p,r[i].z-=M*N/p),f){var T=f.leaf,D=f.single,R=f.others,O=f.center,z=(null==O?void 0:O(w,a,s,d,h))||{x:0,y:0,z:0,centerStrength:0},C=z.x,L=z.y,P=z.z,F=z.centerStrength;if(!x(C)||!x(L))return;var j=(v-C)/p,G=(m-L)/p,U=(y-P)/p;if(F&&(r[i].x-=F*j,r[i].y-=F*G,r[i].z-=F*U),0===S){var V=D(w);if(!V)return;return r[i].x-=V*j,r[i].y-=V*G,void(r[i].z-=V*U)}if(0===_||0===A){var B=T(w,a,s);if(!B)return;return r[i].x-=B*j,r[i].y-=B*G,void(r[i].z-=B*U)}var q=R(w);if(!q)return;r[i].x-=q*j,r[i].y-=q*G,r[i].z-=q*U}}))},t.prototype.updateVelocity=function(t,e,r,n){var o=n.damping,i=n.maxSpeed,a=n.interval,s=n.dimensions,u=t.getAllNodes();(null==u?void 0:u.length)&&u.forEach((function(t){var n=t.id,u=(r[n].x+e[n].x*a)*o||.01,d=(r[n].y+e[n].y*a)*o||.01,h=3===s?(r[n].z+e[n].z*a)*o||.01:0,c=Math.sqrt(u*u+d*d+h*h);if(c>i){var l=i/c;u*=l,d*=l,h*=l}r[n]={x:u,y:d,z:h}}))},t.prototype.updatePosition=function(t,e,r,n){var o=this,i=n.distanceThresholdMode,a=n.interval,s=n.dimensions,u=e.getAllNodes();if(null==u?void 0:u.length){var d=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),u.forEach((function(n){var u=n.id,h=t.getNode(u);if(x(h.data.fx)&&x(h.data.fy))e.mergeNodeData(u,{x:h.data.fx,y:h.data.fy});else{var c=r[u].x*a,l=r[u].y*a,f=3===s?r[u].z*a:0;e.mergeNodeData(u,{x:n.data.x+c,y:n.data.y+l,z:n.data.z+f});var g=Math.sqrt(c*c+l*l+f*f);switch(i){case"max":o.judgingDistance<g&&(o.judgingDistance=g);break;case"min":o.judgingDistance>g&&(o.judgingDistance=g);break;default:d+=g}}})),i&&"mean"!==i||(this.judgingDistance=d/u.length)}else this.judgingDistance=0},t}(),Lr=function(t,e){var r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};var n={};return r.forEach((function(r,o){1===t.getDegree(r.id,"both")&&(n[r.id]=Pr(t,"leaf",r,e))})),n},Pr=function(t,e,r,n){var o=t.getDegree(r.id,"in"),i=t.getDegree(r.id,"out"),a=r,s=[];return 0===o?(a=t.getSuccessors(r.id)[0],s=t.getNeighbors(a.id)):0===i&&(a=t.getPredecessors(r.id)[0],s=t.getNeighbors(a.id)),{coreNode:a,siblingLeaves:s=s.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")})),sameTypeLeaves:Fr(t,e,n,r,s)}},Fr=function(t,e,r,n,o){var i=n.data[r]||"",a=(null==o?void 0:o.filter((function(t){return t.data[r]===i})))||[];return"leaf"===e&&(a=a.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")}))),a},jr=function(t){var e={x:0,y:0};t.forEach((function(t){var r=t.data,n=r.x,o=r.y;e.x+=n||0,e.y+=o||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},Gr=function(t,e){return e.map((function(e){var r=e.id,n=e.data,i=t.getNode(r);return o(o({},i),{data:o(o({},i.data),{x:n.x,y:n.y,z:n.z})})}))};const Ur=function(){function t(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}return t.prototype.distanceTo=function(t){var e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)},t.prototype.setPos=function(t,e){this.rx=t,this.ry=e},t.prototype.resetForce=function(){this.fx=0,this.fy=0},t.prototype.addForce=function(t){var e=t.rx-this.rx,r=t.ry-this.ry,n=Math.hypot(e,r);n=n<1e-4?1e-4:n;var o=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=o*e/n,this.fy+=o*r/n},t.prototype.in=function(t){return t.contains(this.rx,this.ry)},t.prototype.add=function(e){var r=this.mass+e.mass;return new t({rx:(this.rx*this.mass+e.rx*e.mass)/r,ry:(this.ry*this.mass+e.ry*e.mass)/r,mass:r,degree:this.degree+e.degree})},t}(),Vr=function(){function t(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}return t.prototype.getLength=function(){return this.length},t.prototype.contains=function(t,e){var r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r},t.prototype.NW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.NE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.SW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t.prototype.SE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t}(),Br=function(){function t(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}return t.prototype.insert=function(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e},t.prototype._putBody=function(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))},t.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},t.prototype.updateForce=function(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))},t}();var qr={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Wr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2",this.options=o(o({},qr),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,u,d,h,c,l,f,g,p,v,m,y,w,x,E,b,N,M,_,A;return s(this,(function(s){if(n=e.getAllEdges(),i=e.getAllNodes(),a=this.formatOptions(r,i.length),u=a.width,d=a.height,h=a.prune,c=a.maxIteration,l=a.nodeSize,f=a.center,!(null==i?void 0:i.length)||1===i.length)return[2,j(e,t,f)];if(g=i.map((function(t){return O(t,[u,d])})),p=n.filter((function(t){return t.source!==t.target})),v=new Qt({nodes:g,edges:p}),m=this.getSizes(v,e,l),this.run(v,e,c,m,t,a),h){for(y=0;y<p.length;y+=1)w=p[y],x=w.source,E=w.target,b=v.getDegree(x),N=v.getDegree(x),b<=1?(M=v.getNode(E),v.mergeNodeData(x,{x:M.data.x,y:M.data.y})):N<=1&&(_=v.getNode(x),v.mergeNodeData(E,{x:_.data.x,y:_.data.y}));A=o(o({},a),{prune:!1,barnesHut:!1}),this.run(v,e,100,m,t,A)}return[2,{nodes:g,edges:n}]}))}))},t.prototype.getSizes=function(t,e,r){for(var n=t.getAllNodes(),o={},i=0;i<n.length;i+=1){var a=n[i],s=a.id,u=a.data;if(o[s]=10,x(u.size))o[s]=u.size;else if(g(u.size))isNaN(u.size[0])||(o[s]=Math.max(u.size[0])),isNaN(u.size[1])||(o[s]=Math.max(u.size[1]));else if(C(u.size))o[s]=Math.max(u.size.width,u.size.height);else if(z(r)){var h=r(e.getNode(s));g(h)?o[s]=Math.max.apply(Math,d(h)):o[s]=h}else g(r)?o[s]=Math.max.apply(Math,d(r)):x(r)&&(o[s]=r)}return o},t.prototype.formatOptions=function(t,e){void 0===t&&(t={});var r=o(o({},this.options),t),n=r.center,i=r.width,a=r.height,s=r.barnesHut,u=r.prune,d=r.maxIteration,h=r.kr,c=r.kg;return r.width=i||"undefined"==typeof window?i:window.innerWidth,r.height=a||"undefined"==typeof window?a:window.innerHeight,r.center=n||[r.width/2,r.height/2],void 0===s&&e>250&&(r.barnesHut=!0),void 0===u&&e>100&&(r.prune=!0),0!==d||u?0===d&&u&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)):(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)),h||(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),c||(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r},t.prototype.run=function(t,e,r,n,o,i){for(var a=i.kr,s=i.barnesHut,u=i.onTick,d=t.getAllNodes(),h=0,c=r,l={},f={},g={},p=0;p<d.length;p+=1){var v=d[p],m=v.data,y=v.id;if(l[y]=[0,0],s){var w={id:p,rx:m.x,ry:m.y,mass:1,g:a,degree:t.getDegree(y)};g[y]=new Ur(w)}}for(;c>0;)h=this.oneStep(t,{iter:c,preventOverlapIters:50,krPrime:100,sg:h,forces:l,preForces:f,bodies:g,sizes:n},i),c--,null==u||u({nodes:d,edges:e.getAllEdges()});return t},t.prototype.oneStep=function(t,e,r){for(var n=e.iter,o=e.preventOverlapIters,i=e.krPrime,a=e.sg,s=e.preForces,u=e.bodies,h=e.sizes,c=e.forces,l=r.preventOverlap,f=r.barnesHut,g=t.getAllNodes(),p=0;p<g.length;p+=1){var v=g[p].id;s[v]=d(c[v]),c[v]=[0,0]}return c=this.getAttrForces(t,n,o,h,c,r),c=f&&(l&&n>o||!l)?this.getOptRepGraForces(t,c,u,r):this.getRepGraForces(t,n,o,c,i,h,r),this.updatePos(t,c,s,a,r)},t.prototype.getAttrForces=function(t,e,r,n,o,i){for(var a=i.preventOverlap,s=i.dissuadeHubs,u=i.mode,d=i.prune,h=t.getAllEdges(),c=0;c<h.length;c+=1){var l=h[c],f=l.source,g=l.target,p=t.getNode(f),v=t.getNode(g),m=t.getDegree(f),y=t.getDegree(g);if(!d||!(m<=1||y<=1)){var w=[v.data.x-p.data.x,v.data.y-p.data.y],x=Math.hypot(w[0],w[1]);x=x<1e-4?1e-4:x,w[0]=w[0]/x,w[1]=w[1]/x,a&&e<r&&(x=x-n[f]-n[g]);var E=x,b=E;"linlog"===u&&(b=E=Math.log(1+x)),s&&(E=x/m,b=x/y),a&&e<r&&x<=0?(E=0,b=0):a&&e<r&&x>0&&(E=x,b=x),o[f][0]+=E*w[0],o[g][0]-=b*w[0],o[f][1]+=E*w[1],o[g][1]-=b*w[1]}}return o},t.prototype.getOptRepGraForces=function(t,e,r,n){for(var o=n.kg,i=n.center,a=n.prune,s=t.getAllNodes(),u=s.length,d=9e10,h=-9e10,c=9e10,l=-9e10,f=0;f<u;f+=1){var g=s[f],p=g.id,v=g.data;a&&t.getDegree(p)<=1||(r[p].setPos(v.x,v.y),v.x>=h&&(h=v.x),v.x<=d&&(d=v.x),v.y>=l&&(l=v.y),v.y<=c&&(c=v.y))}var m=Math.max(h-d,l-c),y=new Vr({xmid:(h+d)/2,ymid:(l+c)/2,length:m,massCenter:i,mass:u}),w=new Br(y);for(f=0;f<u;f+=1)p=s[f].id,a&&t.getDegree(p)<=1||r[p].in(y)&&w.insert(r[p]);for(f=0;f<u;f+=1){var x=s[f],E=(p=x.id,v=x.data,t.getDegree(p));if(!(a&&E<=1)){r[p].resetForce(),w.updateForce(r[p]),e[p][0]-=r[p].fx,e[p][1]-=r[p].fy;var b=[v.x-i[0],v.y-i[1]],N=Math.hypot(b[0],b[1]);N=N<1e-4?1e-4:N,b[0]=b[0]/N,b[1]=b[1]/N;var M=o*(E+1);e[p][0]-=M*b[0],e[p][1]-=M*b[1]}}return e},t.prototype.getRepGraForces=function(t,e,r,n,o,i,a){for(var s=a.preventOverlap,u=a.kr,d=a.kg,h=a.center,c=a.prune,l=t.getAllNodes(),f=l.length,g=0;g<f;g+=1){for(var p=l[g],v=t.getDegree(p.id),m=g+1;m<f;m+=1){var y=l[m],w=t.getDegree(y.id);if(!c||!(v<=1||w<=1)){var x=[y.data.x-p.data.x,y.data.y-p.data.y],E=Math.hypot(x[0],x[1]);E=E<1e-4?1e-4:E,x[0]=x[0]/E,x[1]=x[1]/E,s&&e<r&&(E=E-i[p.id]-i[y.id]);var b=u*(v+1)*(w+1)/E;s&&e<r&&E<0?b=o*(v+1)*(w+1):s&&e<r&&0===E?b=0:s&&e<r&&E>0&&(b=u*(v+1)*(w+1)/E),n[p.id][0]-=b*x[0],n[y.id][0]+=b*x[0],n[p.id][1]-=b*x[1],n[y.id][1]+=b*x[1]}}var N=[p.data.x-h[0],p.data.y-h[1]],M=Math.hypot(N[0],N[1]);N[0]=N[0]/M,N[1]=N[1]/M;var _=d*(v+1);n[p.id][0]-=_*N[0],n[p.id][1]-=_*N[1]}return n},t.prototype.updatePos=function(t,e,r,n,o){for(var i=o.ks,a=o.tao,s=o.prune,u=o.ksmax,d=t.getAllNodes(),h=d.length,c=[],l=[],f=0,g=0,p=n,v=0;v<h;v+=1){var m=d[v].id,y=t.getDegree(m);if(!(s&&y<=1)){var w=[e[m][0]-r[m][0],e[m][1]-r[m][1]],E=Math.hypot(w[0],w[1]),b=[e[m][0]+r[m][0],e[m][1]+r[m][1]],N=Math.hypot(b[0],b[1]);c[v]=E,l[v]=N/2,f+=(y+1)*c[v],g+=(y+1)*l[v]}}var M=p;for(p=a*g/f,0!==M&&(p=p>1.5*M?1.5*M:p),v=0;v<h;v+=1){var _=d[v],A=(m=_.id,_.data);if(y=t.getDegree(m),!(s&&y<=1||x(A.fx)&&x(A.fy))){var S=i*p/(1+p*Math.sqrt(c[v])),k=Math.hypot(e[m][0],e[m][1]),I=u/(k=k<1e-4?1e-4:k),T=(S=S>I?I:S)*e[m][0],D=S*e[m][1];t.mergeNodeData(m,{x:A.x+T,y:A.y+D})}}return p},t}(),Hr={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},$r=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=o(o({},Hr),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericFruchtermanLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,u,d,h,c,l,f,g,p,v,m,y,w,x=this;return s(this,(function(s){return this.running?[2]:(n=this.formatOptions(r),i=n.width,a=n.height,u=n.center,d=n.clustering,h=n.nodeClusterBy,c=n.maxIteration,l=n.onTick,f=e.getAllNodes(),g=e.getAllEdges(),(null==f?void 0:f.length)?1===f.length?(t&&e.mergeNodeData(f[0].id,{x:u[0],y:u[1]}),p={nodes:[o(o({},f[0]),{data:o(o({},f[0].data),{x:u[0],y:u[1]})})],edges:g},this.lastResult=p,[2,p]):(v=f.map((function(t){return O(t,[i,a])})),m=new Qt({nodes:v,edges:g}),y={},d&&v.forEach((function(t){var e=t.data[h];y[e]||(y[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=v,this.lastLayoutEdges=g,this.lastAssign=t,this.lastGraph=m,this.lastOptions=n,this.lastClusterMap=y,"undefined"==typeof window?[2]:(w=0,[2,new Promise((function(r){x.timeInterval=window.setInterval((function(){x.running?(x.runOneStep(m,y,n),t&&v.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y})})),null==l||l({nodes:v,edges:g}),++w>=c&&(window.clearInterval(x.timeInterval),r({nodes:v,edges:g}))):r({nodes:v,edges:g})}),0),x.running=!0}))])):(p={nodes:[],edges:g},this.lastResult=p,[2,p]))}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=o(o({},this.options),t),r=e.clustering,n=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=r&&!!n,e},t.prototype.runOneStep=function(t,e,r){var n=r.height,o=r.width,i=r.gravity,a=r.center,s=r.speed,u=r.clustering,d=r.nodeClusterBy,h=r.clusterGravity,c=n*o,l=Math.sqrt(c)/10,f=t.getAllNodes(),g=c/(f.length+1),p=Math.sqrt(g),v={};if(this.applyCalculate(t,v,p,g),u){for(var m in e)e[m].cx=0,e[m].cy=0,e[m].count=0;for(var m in f.forEach((function(t){var r=t.data,n=e[r[d]];x(r.x)&&(n.cx+=r.x),x(r.y)&&(n.cy+=r.y),n.count++})),e)e[m].cx/=e[m].count,e[m].cy/=e[m].count;var y=h||i;f.forEach((function(t,r){var n=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=e[o[d]],a=Math.sqrt((o.x-i.cx)*(o.x-i.cx)+(o.y-i.cy)*(o.y-i.cy)),s=p*y;v[n].x-=s*(o.x-i.cx)/a,v[n].y-=s*(o.y-i.cy)/a}}))}f.forEach((function(t,e){var r=t.id,n=t.data;if(x(n.x)&&x(n.y)){var o=.01*p*i;v[r].x-=o*(n.x-a[0]),v[r].y-=o*(n.y-a[1])}})),f.forEach((function(e,r){var n=e.id,o=e.data;if(x(o.fx)&&x(o.fy))return o.x=o.fx,void(o.y=o.fy);if(x(o.x)&&x(o.y)){var i=Math.sqrt(v[n].x*v[n].x+v[n].y*v[n].y);if(i>0){var a=Math.min(l*(s/800),i);t.mergeNodeData(n,{x:o.x+v[n].x/i*a,y:o.y+v[n].y/i*a})}}}))},t.prototype.applyCalculate=function(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)},t.prototype.calRepulsive=function(t,e,r){var n=t.getAllNodes();n.forEach((function(t,o){var i=t.data,a=t.id;e[a]={x:0,y:0},n.forEach((function(t,n){var s=t.data,u=t.id;if(!(o<=n)&&x(i.x)&&x(s.x)&&x(i.y)&&x(s.y)){var d=i.x-s.x,h=i.y-s.y,c=d*d+h*h;0===c&&(c=1,d=.01,h=.01);var l=r/c,f=d*l,g=h*l;e[a].x+=f,e[a].y+=g,e[u].x-=f,e[u].y-=g}}))}))},t.prototype.calAttractive=function(t,e,r){t.getAllEdges().forEach((function(n){var o=n.source,i=n.target;if(o&&i&&o!==i){var a=t.getNode(o).data,s=t.getNode(i).data;if(x(s.x)&&x(a.x)&&x(s.y)&&x(a.y)){var u=s.x-a.x,d=s.y-a.y,h=Math.sqrt(u*u+d*d)/r,c=u*h,l=d*h;e[o].x+=c,e[o].y+=l,e[i].x-=c,e[i].y-=l}}}))},t}(),Xr={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},Yr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="grid",this.options=o(o({},Xr),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,this.genericGridLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return this.genericGridLayout(!0,t,e),[2]}))}))},t.prototype.genericGridLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,u,d,h,c,l,f,p,v,m,y,w,E,b,N,M,_,A,S,k,I,T,D,R,z,C,F,G,U,V,B,q,W,H,$;return s(this,(function(s){if(n=o(o({},this.options),r),i=n.begin,a=void 0===i?[0,0]:i,u=n.condense,d=n.preventOverlapPadding,h=n.preventOverlap,c=n.rows,l=n.cols,f=n.nodeSpacing,p=n.nodeSize,v=n.width,m=n.height,y=n.position,w=n.sortBy,E=e.getAllNodes(),b=e.getAllEdges(),!(N=null==E?void 0:E.length)||1===N)return[2,j(e,t,a)];if(M=E.map((function(t){return O(t)})),"id"===w||Y(w)&&void 0!==M[0].data[w]||(w="degree"),"degree"===w?M.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):"id"===w?M.sort((function(t,e){return x(e.id)&&x(t.id)?e.id-t.id:(""+t.id).localeCompare(""+e.id)})):M.sort((function(t,e){return e.data[w]-t.data[w]})),_=v||"undefined"==typeof window?v:window.innerWidth,A=m||"undefined"==typeof window?m:window.innerHeight,S=N,k={rows:c,cols:l},null!=c&&null!=l?(k.rows=c,k.cols=l):null!=c&&null==l?(k.rows=c,k.cols=Math.ceil(S/k.rows)):null==c&&null!=l?(k.cols=l,k.rows=Math.ceil(S/k.cols)):(I=Math.sqrt(S*A/_),k.rows=Math.round(I),k.cols=Math.round(_/A*I)),k.rows=Math.max(k.rows,1),k.cols=Math.max(k.cols,1),k.cols*k.rows>S)T=Kr(k),D=Qr(k),(T-1)*D>=S?Kr(k,T-1):(D-1)*T>=S&&Qr(k,D-1);else for(;k.cols*k.rows<S;)T=Kr(k),((D=Qr(k))+1)*T>=S?Qr(k,D+1):Kr(k,T+1);for(R=u?0:_/k.cols,z=u?0:A/k.rows,(h||f)&&(C=L(10,f),F=P(30,p,!1),M.forEach((function(t){t.data.x&&t.data.y||(t.data.x=0,t.data.y=0);var r,n,o=e.getNode(t.id),i=F(o)||30;g(i)?(r=i[0],n=i[1]):(r=i,n=i);var a=void 0!==C?C(t):d,s=r+a,u=n+a;R=Math.max(R,s),z=Math.max(z,u)}))),G={},U={row:0,col:0},V={},B=0;B<M.length;B++){if(q=M[B],W=void 0,y&&(W=y(e.getNode(q.id))),W&&(void 0!==W.row||void 0!==W.col)){if(void 0===(H={row:W.row,col:W.col}).col)for(H.col=0;Zr(G,H);)H.col++;else if(void 0===H.row)for(H.row=0;Zr(G,H);)H.row++;V[q.id]=H,Jr(G,H)}en(q,a,R,z,V,k,U,G)}return $={nodes:M,edges:b},t&&M.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,$]}))}))},t}(),Kr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.min(n,o):Math.min(n,o)===t.rows?t.rows=e:t.cols=e,r},Qr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.max(n,o):Math.max(n,o)===t.rows?t.rows=e:t.cols=e,r},Zr=function(t,e){return t["c-"+e.row+"-"+e.col]||!1},Jr=function(t,e){return t["c-"+e.row+"-"+e.col]=!0},tn=function(t,e){var r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},en=function(t,e,r,n,o,i,a,s){var u,d,h=o[t.id];if(h)u=h.col*r+r/2+e[0],d=h.row*n+n/2+e[1];else{for(;Zr(s,a);)tn(i,a);u=a.col*r+r/2+e[0],d=a.row*n+n/2+e[1],Jr(s,a),tn(i,a)}t.data.x=u,t.data.y=d};const rn=Object.prototype.toString;function nn(t){const e=rn.call(t);return e.endsWith("Array]")&&!e.includes("Big")}function on(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!nn(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!nn(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!nn(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]<a&&(a=t[s]);return a}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!nn(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]>a&&(a=t[s]);return a}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,a=void 0===i?r.autoMinMax?n:0:i,s=r.max,u=void 0===s?r.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var d=(u-a)/(o-n),h=0;h<t.length;h++)e[h]=(t[h]-n)*d+a;return e}const an=" ".repeat(2),sn=" ".repeat(4);function un(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=e;return`${t.constructor.name} {\n${an}[\n${sn}${function(t,e,r,n,o){const{rows:i,columns:a}=t,s=Math.min(i,e),u=Math.min(a,r),d=[];if("auto"===o){o=!1;t:for(let e=0;e<s;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let h=0;h<s;h++){let e=[];for(let r=0;r<u;r++)e.push(dn(t.get(h,r),n,o));d.push(`${e.join(" ")}`)}return u!==a&&(d[d.length-1]+=` ... ${a-r} more columns`),s!==i&&d.push(`... ${i-e} more rows`),d.join(`\n${sn}`)}(t,r,n,o,i)}\n${an}]\n${an}rows: ${t.rows}\n${an}columns: ${t.columns}\n}`}function dn(t,e,r){return(t>=0&&r?` ${hn(t,e-1)}`:hn(t,e)).padEnd(e)}function hn(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function cn(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function ln(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function fn(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function gn(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function pn(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(mn("startRow",e),mn("endRow",r),mn("startColumn",n),mn("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function vn(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function mn(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function yn(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class wn{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new En(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new En(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new En(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new En(t,e)}static ones(t,e){return new En(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new En(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)o.set(i,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let a=o-n,s=new En(t,e);for(let u=0;u<t;u++)for(let t=0;t<e;t++){let e=n+Math.round(i()*a);s.set(u,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let i=0;i<n;i++)o.set(i,i,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let a=0;a<o;a++)i.set(a,a,t[a]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new En(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return wn.isMatrix(t)?t:new En(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let a=o;a<e;a++){let e=t.get(r,a)-i*t.get(n,a);t.set(r,a,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new En(this.rows*e,this.columns*r);for(let o=0;o<e;o++)for(let t=0;t<r;t++)n.setSubMatrix(this,this.rows*o,this.columns*t);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){cn(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return En.rowVector(this.getRow(t))}setRow(t,e){cn(this,t),e=fn(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){cn(this,t),cn(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){ln(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return En.columnVector(this.getColumn(t))}setColumn(t,e){ln(this,t),e=gn(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){ln(this,t),ln(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=fn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=fn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=fn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=fn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=gn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=gn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=gn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=gn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){cn(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){ln(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){yn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){yn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(cn(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){cn(this,t),yn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(cn(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){cn(this,t),yn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(ln(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){ln(this,t),yn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(ln(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){ln(this,t),yn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){wn.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=En.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new En(e,n),i=new Float64Array(r);for(let a=0;a<n;a++){for(let e=0;e<r;e++)i[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,a,e)}}return o}strassen2x2(t){t=En.checkMatrix(t);let e=new En(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),d=t.get(1,1),h=(r+u)*(n+d),c=(a+u)*n,l=r*(i-d),f=u*(s-n),g=(r+o)*d,p=h+f-g+(o-u)*(s+d),v=l+g,m=c+f,y=h-c+l+(a-r)*(n+i);return e.set(0,0,p),e.set(0,1,v),e.set(1,0,m),e.set(1,1,y),e}strassen3x3(t){t=En.checkMatrix(t);let e=new En(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),d=this.get(2,1),h=this.get(2,2),c=t.get(0,0),l=t.get(0,1),f=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),m=t.get(2,0),y=t.get(2,1),w=t.get(2,2),x=(r-i)*(-l+p),E=(-r+i+a)*(c-l+p),b=(i+a)*(-c+l),N=r*c,M=(-r+u+d)*(c-f+v),_=(-r+u)*(f-v),A=(u+d)*(-c+f),S=(-o+d+h)*(p+m-y),k=(o-h)*(p-y),I=o*m,T=(d+h)*(-m+y),D=(-o+a+s)*(v+m-w),R=(o-s)*(v-w),O=(a+s)*(-m+w),z=N+I+n*g,C=(r+n+o-i-a-d-h)*p+E+b+N+S+I+T,L=N+M+A+(r+n+o-a-s-u-d)*v+I+D+O,P=x+a*(-c+l+g-p-v-m+w)+E+N+I+D+R,F=x+E+b+N+s*y,j=I+D+R+O+i*f,G=N+M+_+d*(-c+f+g-p-v-m+y)+S+k+I,U=S+k+I+T+u*l,V=N+M+_+A+h*w;return e.set(0,0,z),e.set(0,1,C),e.set(0,2,L),e.set(1,0,P),e.set(1,1,F),e.set(1,2,j),e.set(2,0,G),e.set(2,1,U),e.set(2,2,V),e}mmulStrassen(t){t=En.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function a(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=wn.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${r} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let s=Math.max(r,o),u=Math.max(n,i);return e=a(e,s,u),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=a(e,n+1,o+1),r=a(r,n+1,o+1)):n%2==1?(e=a(e,n+1,o),r=a(r,n+1,o)):o%2==1&&(e=a(e,n,o+1),r=a(r,n,o+1));let i=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,s-1),d=r.subMatrix(0,i-1,0,s-1),h=e.subMatrix(0,i-1,s,e.columns-1),c=r.subMatrix(0,i-1,s,r.columns-1),l=e.subMatrix(i,e.rows-1,0,s-1),f=r.subMatrix(i,r.rows-1,0,s-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),p=r.subMatrix(i,r.rows-1,s,r.columns-1),v=t(wn.add(u,g),wn.add(d,p),i,s),m=t(wn.add(l,g),d,i,s),y=t(u,wn.sub(c,p),i,s),w=t(g,wn.sub(f,d),i,s),x=t(wn.add(u,h),p,i,s),E=t(wn.sub(l,u),wn.add(d,c),i,s),b=t(wn.sub(h,g),wn.add(f,p),i,s),N=wn.add(v,w);N.sub(x),N.add(b);let M=wn.add(y,x),_=wn.add(m,w),A=wn.sub(v,m);A.add(y),A.add(E);let S=wn.zeros(2*N.rows,2*N.columns);return S=S.setSubMatrix(N,0,0),S=S.setSubMatrix(M,N.rows,0),S=S.setSubMatrix(_,0,N.columns),S=S.setSubMatrix(A,N.rows,N.columns),S.subMatrix(0,n-1,0,o-1)}(e,t=a(t,s,u),s,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new En(this.rows,this.columns);for(let o=0;o<this.rows;o++){const t=this.getRow(o);t.length>0&&on(t,{min:e,max:r,output:t}),n.setRow(o,t)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new En(this.rows,this.columns);for(let o=0;o<this.columns;o++){const t=this.getColumn(o);t.length&&on(t,{min:e,max:r,output:t}),n.setColumn(o,t)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=En.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new En(e*n,r*o);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<o;s++)i.set(n*a+r,o*e+s,this.get(a,e)*t.get(r,s));return i}kroneckerSum(t){if(t=En.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(En.eye(r,r)),o=En.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new En(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=xn){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=xn){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){pn(this,t,e,r,n);let o=new En(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new En(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new En(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=En.checkMatrix(t)).isEmpty())return this;pn(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){!function(t,e){if(!nn(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!nn(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new En(t.length,e.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<e.length;t++){let i=e[t];r.set(n,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new En(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=vn(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=vn(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=vn(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=vn(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!nn(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<n;a++){let n=0,s=0,u=0;for(let e=0;e<o;e++)u=t.get(a,e)-r[a],n+=u,s+=u*u;e?i.push((s-n*n/o)/(o-1)):i.push((s-n*n/o)/o)}return i}(this,r,n);case"column":if(!nn(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<o;a++){let o=0,s=0,u=0;for(let e=0;e<n;e++)u=t.get(e,a)-r[a],o+=u,s+=u*u;e?i.push((s-o*o/n)/(n-1)):i.push((s-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let a=0,s=0,u=0;for(let d=0;d<n;d++)for(let e=0;e<o;e++)u=t.get(d,e)-r,a+=u,s+=u*u;return e?(s-a*a/i)/(i-1):(s-a*a/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let n=0;n<r.length;n++)r[n]=Math.sqrt(r[n]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!nn(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!nn(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!nn(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!nn(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return un(this,t)}}function xn(t,e){return t-e}wn.prototype.klass="Matrix","undefined"!=typeof Symbol&&(wn.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return un(this)}),wn.random=wn.rand,wn.randomInt=wn.randInt,wn.diagonal=wn.diag,wn.prototype.diagonal=wn.prototype.diag,wn.identity=wn.eye,wn.prototype.negate=wn.prototype.neg,wn.prototype.tensorProduct=wn.prototype.kroneckerProduct;class En extends wn{constructor(t,e){if(super(),En.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!nn(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!r[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return cn(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),cn(this,t,!0),e=Float64Array.from(fn(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){ln(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),ln(this,t,!0),e=gn(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}}var bn,Nn;Nn=En,(bn=wn).prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},bn.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},bn.prototype.addM=function(t){if(t=Nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},bn.add=function(t,e){return new Nn(t).add(e)},bn.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},bn.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},bn.prototype.subM=function(t){if(t=Nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},bn.sub=function(t,e){return new Nn(t).sub(e)},bn.prototype.subtract=bn.prototype.sub,bn.prototype.subtractS=bn.prototype.subS,bn.prototype.subtractM=bn.prototype.subM,bn.subtract=bn.sub,bn.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},bn.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},bn.prototype.mulM=function(t){if(t=Nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},bn.mul=function(t,e){return new Nn(t).mul(e)},bn.prototype.multiply=bn.prototype.mul,bn.prototype.multiplyS=bn.prototype.mulS,bn.prototype.multiplyM=bn.prototype.mulM,bn.multiply=bn.mul,bn.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},bn.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},bn.prototype.divM=function(t){if(t=Nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},bn.div=function(t,e){return new Nn(t).div(e)},bn.prototype.divide=bn.prototype.div,bn.prototype.divideS=bn.prototype.divS,bn.prototype.divideM=bn.prototype.divM,bn.divide=bn.div,bn.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},bn.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},bn.prototype.modM=function(t){if(t=Nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},bn.mod=function(t,e){return new Nn(t).mod(e)},bn.prototype.modulus=bn.prototype.mod,bn.prototype.modulusS=bn.prototype.modS,bn.prototype.modulusM=bn.prototype.modM,bn.modulus=bn.mod,bn.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},bn.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},bn.prototype.andM=function(t){if(t=Nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},bn.and=function(t,e){return new Nn(t).and(e)},bn.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},bn.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},bn.prototype.orM=function(t){if(t=Nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},bn.or=function(t,e){return new Nn(t).or(e)},bn.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},bn.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},bn.prototype.xorM=function(t){if(t=Nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},bn.xor=function(t,e){return new Nn(t).xor(e)},bn.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},bn.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},bn.prototype.leftShiftM=function(t){if(t=Nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},bn.leftShift=function(t,e){return new Nn(t).leftShift(e)},bn.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},bn.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},bn.prototype.signPropagatingRightShiftM=function(t){if(t=Nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},bn.signPropagatingRightShift=function(t,e){return new Nn(t).signPropagatingRightShift(e)},bn.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},bn.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},bn.prototype.rightShiftM=function(t){if(t=Nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},bn.rightShift=function(t,e){return new Nn(t).rightShift(e)},bn.prototype.zeroFillRightShift=bn.prototype.rightShift,bn.prototype.zeroFillRightShiftS=bn.prototype.rightShiftS,bn.prototype.zeroFillRightShiftM=bn.prototype.rightShiftM,bn.zeroFillRightShift=bn.rightShift,bn.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},bn.not=function(t){return new Nn(t).not()},bn.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},bn.abs=function(t){return new Nn(t).abs()},bn.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},bn.acos=function(t){return new Nn(t).acos()},bn.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},bn.acosh=function(t){return new Nn(t).acosh()},bn.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},bn.asin=function(t){return new Nn(t).asin()},bn.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},bn.asinh=function(t){return new Nn(t).asinh()},bn.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},bn.atan=function(t){return new Nn(t).atan()},bn.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},bn.atanh=function(t){return new Nn(t).atanh()},bn.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},bn.cbrt=function(t){return new Nn(t).cbrt()},bn.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},bn.ceil=function(t){return new Nn(t).ceil()},bn.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},bn.clz32=function(t){return new Nn(t).clz32()},bn.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},bn.cos=function(t){return new Nn(t).cos()},bn.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},bn.cosh=function(t){return new Nn(t).cosh()},bn.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},bn.exp=function(t){return new Nn(t).exp()},bn.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},bn.expm1=function(t){return new Nn(t).expm1()},bn.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},bn.floor=function(t){return new Nn(t).floor()},bn.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},bn.fround=function(t){return new Nn(t).fround()},bn.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},bn.log=function(t){return new Nn(t).log()},bn.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},bn.log1p=function(t){return new Nn(t).log1p()},bn.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},bn.log10=function(t){return new Nn(t).log10()},bn.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},bn.log2=function(t){return new Nn(t).log2()},bn.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},bn.round=function(t){return new Nn(t).round()},bn.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},bn.sign=function(t){return new Nn(t).sign()},bn.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},bn.sin=function(t){return new Nn(t).sin()},bn.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},bn.sinh=function(t){return new Nn(t).sinh()},bn.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},bn.sqrt=function(t){return new Nn(t).sqrt()},bn.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},bn.tan=function(t){return new Nn(t).tan()},bn.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},bn.tanh=function(t){return new Nn(t).tanh()},bn.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},bn.trunc=function(t){return new Nn(t).trunc()},bn.pow=function(t,e){return new Nn(t).pow(e)},bn.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},bn.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},bn.prototype.powM=function(t){if(t=Nn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this};class Mn extends wn{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function _n(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class An{constructor(t,e={}){if((t=Mn.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=e;let s,u=Boolean(o),d=Boolean(i),h=!1;if(r<n)if(a){s=t.transpose(),r=s.rows,n=s.columns,h=!0;let e=u;u=d,d=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let c=Math.min(r,n),l=Math.min(r+1,n),f=new Float64Array(l),g=new En(r,c),p=new En(n,n),v=new Float64Array(n),m=new Float64Array(r),y=new Float64Array(l);for(let _=0;_<l;_++)y[_]=_;let w=Math.min(r-1,n),x=Math.max(0,Math.min(n-2,r)),E=Math.max(w,x);for(let _=0;_<E;_++){if(_<w){f[_]=0;for(let t=_;t<r;t++)f[_]=_n(f[_],s.get(t,_));if(0!==f[_]){s.get(_,_)<0&&(f[_]=-f[_]);for(let t=_;t<r;t++)s.set(t,_,s.get(t,_)/f[_]);s.set(_,_,s.get(_,_)+1)}f[_]=-f[_]}for(let t=_+1;t<n;t++){if(_<w&&0!==f[_]){let e=0;for(let n=_;n<r;n++)e+=s.get(n,_)*s.get(n,t);e=-e/s.get(_,_);for(let n=_;n<r;n++)s.set(n,t,s.get(n,t)+e*s.get(n,_))}v[t]=s.get(_,t)}if(u&&_<w)for(let t=_;t<r;t++)g.set(t,_,s.get(t,_));if(_<x){v[_]=0;for(let t=_+1;t<n;t++)v[_]=_n(v[_],v[t]);if(0!==v[_]){v[_+1]<0&&(v[_]=0-v[_]);for(let t=_+1;t<n;t++)v[t]/=v[_];v[_+1]+=1}if(v[_]=-v[_],_+1<r&&0!==v[_]){for(let t=_+1;t<r;t++)m[t]=0;for(let t=_+1;t<r;t++)for(let e=_+1;e<n;e++)m[t]+=v[e]*s.get(t,e);for(let t=_+1;t<n;t++){let e=-v[t]/v[_+1];for(let n=_+1;n<r;n++)s.set(n,t,s.get(n,t)+e*m[n])}}if(d)for(let t=_+1;t<n;t++)p.set(t,_,v[t])}}let b=Math.min(n,r+1);if(w<n&&(f[w]=s.get(w,w)),r<b&&(f[b-1]=0),x+1<b&&(v[x]=s.get(x,b-1)),v[b-1]=0,u){for(let t=w;t<c;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<c;e++){let n=0;for(let o=t;o<r;o++)n+=g.get(o,t)*g.get(o,e);n=-n/g.get(t,t);for(let o=t;o<r;o++)g.set(o,e,g.get(o,e)+n*g.get(o,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(d)for(let _=n-1;_>=0;_--){if(_<x&&0!==v[_])for(let t=_+1;t<n;t++){let e=0;for(let r=_+1;r<n;r++)e+=p.get(r,_)*p.get(r,t);e=-e/p.get(_+1,_);for(let r=_+1;r<n;r++)p.set(r,t,p.get(r,t)+e*p.get(r,_))}for(let t=0;t<n;t++)p.set(t,_,0);p.set(_,_,1)}let N=b-1,M=Number.EPSILON;for(;b>0;){let t,e;for(t=b-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+M*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===b-2)e=4;else{let r;for(r=b-1;r>=t&&r!==t;r--){let e=(r!==b?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(f[r])<=M*e){f[r]=0;break}}r===t?e=3:r===b-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[b-2];v[b-2]=0;for(let r=b-2;r>=t;r--){let o=_n(f[r],e),i=f[r]/o,a=e/o;if(f[r]=o,r!==t&&(e=-a*v[r-1],v[r-1]=i*v[r-1]),d)for(let t=0;t<n;t++)o=i*p.get(t,r)+a*p.get(t,b-1),p.set(t,b-1,-a*p.get(t,r)+i*p.get(t,b-1)),p.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<b;n++){let o=_n(f[n],e),i=f[n]/o,a=e/o;if(f[n]=o,e=-a*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g.get(e,n)+a*g.get(e,t-1),g.set(e,t-1,-a*g.get(e,n)+i*g.get(e,t-1)),g.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(f[b-1]),Math.abs(f[b-2]),Math.abs(v[b-2]),Math.abs(f[t]),Math.abs(v[t])),o=f[b-1]/e,i=f[b-2]/e,a=v[b-2]/e,s=f[t]/e,h=v[t]/e,c=((i+o)*(i-o)+a*a)/2,l=o*a*(o*a);let m=0;0===c&&0===l||(m=c<0?0-Math.sqrt(c*c+l):Math.sqrt(c*c+l),m=l/(c+m));let y=(s+o)*(s-o)+m,w=s*h;for(let x=t;x<b-1;x++){let e=_n(y,w);0===e&&(e=Number.MIN_VALUE);let o=y/e,i=w/e;if(x!==t&&(v[x-1]=e),y=o*f[x]+i*v[x],v[x]=o*v[x]-i*f[x],w=i*f[x+1],f[x+1]=o*f[x+1],d)for(let t=0;t<n;t++)e=o*p.get(t,x)+i*p.get(t,x+1),p.set(t,x+1,-i*p.get(t,x)+o*p.get(t,x+1)),p.set(t,x,e);if(e=_n(y,w),0===e&&(e=Number.MIN_VALUE),o=y/e,i=w/e,f[x]=e,y=o*v[x]+i*f[x+1],f[x+1]=-i*v[x]+o*f[x+1],w=i*v[x+1],v[x+1]=o*v[x+1],u&&x<r-1)for(let t=0;t<r;t++)e=o*g.get(t,x)+i*g.get(t,x+1),g.set(t,x+1,-i*g.get(t,x)+o*g.get(t,x+1)),g.set(t,x,e)}v[b-2]=y;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,d))for(let e=0;e<=N;e++)p.set(e,t,-p.get(e,t));for(;t<N&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,d&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}b--}}if(h){let t=p;p=g,g=t}this.m=r,this.n=n,this.s=f,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,o=En.zeros(n,n);for(let c=0;c<n;c++)Math.abs(this.s[c])<=r?o.set(c,c,0):o.set(c,c,1/this.s[c]);let i=this.U,a=this.rightSingularVectors,s=a.mmul(o),u=a.rows,d=i.rows,h=En.zeros(u,d);for(let c=0;c<u;c++)for(let t=0;t<d;t++){let e=0;for(let r=0;r<n;r++)e+=s.get(c,r)*i.get(t,r);h.set(c,t,e)}return h.mmul(e)}solveForDiagonal(t){return this.solve(En.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new En(r,this.s.length);for(let d=0;d<r;d++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(d,r,t.get(d,r)/this.s[r]);let i=this.U,a=i.rows,s=i.columns,u=new En(r,a);for(let d=0;d<r;d++)for(let t=0;t<a;t++){let e=0;for(let r=0;r<s;r++)e+=o.get(d,r)*i.get(t,r);u.set(d,t,e)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return En.diag(this.s)}}var Sn={center:[0,0],linkDistance:50},kn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="mds",this.options=o(o({},Sn),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,this.genericMDSLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return this.genericMDSLayout(!0,t,e),[2]}))}))},t.prototype.genericMDSLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,u,d,h,c,l,f,g,p,v;return s(this,(function(s){return n=o(o({},this.options),r),i=n.center,a=void 0===i?[0,0]:i,u=n.linkDistance,d=void 0===u?50:u,h=e.getAllNodes(),c=e.getAllEdges(),(null==h?void 0:h.length)&&1!==h.length?(l=b({nodes:h,edges:c},!1),f=E(l),In(f),g=N(f,d),p=Tn(g),v=[],p.forEach((function(t,e){var r=O(h[e]);r.data.x=t[0]+a[0],r.data.y=t[1]+a[1],v.push(r)})),t&&v.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:v,edges:c}]):[2,j(e,t,a)]}))}))},t}(),In=function(t){var e=-999999;t.forEach((function(t){t.forEach((function(t){t!==1/0&&e<t&&(e=t)}))})),t.forEach((function(r,n){r.forEach((function(r,o){r===1/0&&(t[n][o]=e)}))}))},Tn=function(t){var e=En.mul(En.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),o=e.mean();e.add(o).subRowVector(r).subColumnVector(n);var i=new An(e),a=En.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((function(t){return En.mul([t],[a]).toJSON()[0].splice(0,2)}))},Dn={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},Rn=function(t,e,r,n,o,i){e.forEach((function(a,s){r[s]={x:0,y:0},e.forEach((function(e,u){if(s!==u&&o[s]===o[u]){var d=a.x-e.x,h=a.y-e.y,c=Math.sqrt(d*d+h*h);if(0===c){c=1;var l=s>u?1:-1;d=.01*l,h=.01*l}if(c<i(t[s])/2+i(t[u])/2){var f=n*n/c;r[s].x+=d/c*f,r[s].y+=h/c*f}}}))}))},On=function(t,e,r,n,o,i,a,s){var u=i||a/10;return n&&e.forEach((function(e,r){var n=t[r].x-t[o].x,i=t[r].y-t[o].y,a=Math.sqrt(n*n+i*i),s=i/a,u=-n/a,d=Math.sqrt(e.x*e.x+e.y*e.y),h=Math.acos((s*e.x+u*e.y)/d);h>Math.PI/2&&(h-=Math.PI/2,s*=-1,u*=-1);var c=Math.cos(h)*d;e.x=s*c,e.y=u*c})),t.forEach((function(i,a){if(a!==o){var d=Math.sqrt(e[a].x*e[a].x+e[a].y*e[a].y);if(d>0&&a!==o){var h=Math.min(u*(r/800),d);if(i.x+=e[a].x/d*h,i.y+=e[a].y/d*h,n){var c=i.x-t[o].x,l=i.y-t[o].y,f=Math.sqrt(c*c+l*l);c=c/f*s[a],l=l/f*s[a],i.x=t[o].x+c,i.y=t[o].y+l}}}})),t},zn={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},Cn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="radial",this.options=o(o({},zn),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,this.genericRadialLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return this.genericRadialLayout(!0,t,e),[2]}))}))},t.prototype.genericRadialLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,h,c,l,f,g,p,v,m,y,w,x,N,M,_,A,S,k,I,T,D,R,z,C,L,P,G,U,V,B,q,W,H,$,X,K,Q,Z,J,tt,et;return s(this,(function(s){if(n=o(o({},this.options),r),i=n.width,a=n.height,h=n.center,c=n.focusNode,l=n.unitRadius,f=n.nodeSize,g=n.nodeSpacing,p=n.strictRadial,v=n.preventOverlap,m=n.maxPreventOverlapIteration,y=n.sortBy,w=n.linkDistance,x=void 0===w?50:w,N=n.sortStrength,M=void 0===N?10:N,_=n.maxIteration,A=void 0===_?1e3:_,S=e.getAllNodes(),k=e.getAllEdges(),I=i||"undefined"==typeof window?i:window.innerWidth,T=a||"undefined"==typeof window?a:window.innerHeight,D=h||[I/2,T/2],!(null==S?void 0:S.length)||1===S.length)return[2,j(e,t,D)];if(R=S[0],Y(c)){for(z=0;z<S.length;z++)if(S[z].id===c){R=S[z];break}}else R=c||S[0];return C=Fn(S,R.id),L=b({nodes:S,edges:k},!1),P=E(L),G=Gn(P,C),jn(P,C,G+1),U=P[C],V=I-D[0]>D[0]?D[0]:I-D[0],B=T-D[1]>D[1]?D[1]:T-D[1],0===V&&(V=I/2),0===B&&(B=T/2),q=Math.min(V,B),W=Math.max.apply(Math,d(U)),H=[],$=l||q/W,U.forEach((function(t,e){H[e]=t*$})),X=Ln(S,P,x,H,$,y,M),K=Pn(X),Q=function(t,e,r){try{var n=En.mul(En.pow(e,2),-.5),o=n.mean("row"),i=n.mean("column"),a=n.mean();n.add(a).subRowVector(o).subColumnVector(i);var s=new An(n),u=En.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((function(e){return En.mul([e],[u]).toJSON()[0].splice(0,t)}))}catch(f){for(var d=[],h=0;h<e.length;h++){var c=Math.random()*r,l=Math.random()*r;d.push([c,l])}return d}}(x,X,x),Z=Q.map((function(t){var e=u(t,2),r=e[0],n=e[1];return{x:(isNaN(r)?Math.random()*x:r)-Q[C][0],y:(isNaN(n)?Math.random()*x:n)-Q[C][1]}})),this.run(A,Z,K,X,H,C),v&&(J=F(f,g),tt={nodes:S,nodeSizeFunc:J,positions:Z,radii:H,height:T,width:I,strictRadial:Boolean(p),focusIdx:C,iterations:m||200,k:Z.length/4.5},Z=function(t,e){for(var r=o(o({},Dn),e),n=r.positions,i=r.iterations,a=r.width,s=r.k,u=r.speed,d=void 0===u?100:u,h=r.strictRadial,c=r.focusIdx,l=r.radii,f=void 0===l?[]:l,g=r.nodeSizeFunc,p=t.getAllNodes(),v=[],m=a/10,y=0;y<i;y++)n.forEach((function(t,e){v[e]={x:0,y:0}})),Rn(p,n,v,s,f,g),On(n,v,d,h,c,m,a,f);return n}(e,tt)),et=[],Z.forEach((function(t,e){var r=O(S[e]);r.data.x=t.x+D[0],r.data.y=t.y+D[1],et.push(r)})),t&&et.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:et,edges:k}]}))}))},t.prototype.run=function(t,e,r,n,o,i){for(var a=0;a<=t;a++){var s=a/t;this.oneIteration(s,e,o,n,r,i)}},t.prototype.oneIteration=function(t,e,r,n,o,i){var a=1-t;e.forEach((function(s,u){var d=D(s,{x:0,y:0}),h=0===d?0:1/d;if(u!==i){var c=0,l=0,f=0;e.forEach((function(t,e){if(u!==e){var r=D(s,t),i=0===r?0:1/r,a=n[e][u];f+=o[u][e],c+=o[u][e]*(t.x+a*(s.x-t.x)*i),l+=o[u][e]*(t.y+a*(s.y-t.y)*i)}}));var g=0===r[u]?0:1/r[u];f*=a,f+=t*g*g,c*=a,c+=t*g*s.x*h,s.x=c/f,l*=a,l+=t*g*s.y*h,s.y=l/f}}))},t}(),Ln=function(t,e,r,n,o,i,a){if(!t)return[];var s=[];if(e){var u={};e.forEach((function(e,d){var h=[];e.forEach((function(e,s){var c,l;if(d===s)h.push(0);else if(n[d]===n[s])if("data"===i)h.push(e*(Math.abs(d-s)*a)/(n[d]/o));else if(i){var f=void 0,g=void 0;if(u[t[d].id])f=u[t[d].id];else{var p=("id"===i?t[d].id:null===(c=t[d].data)||void 0===c?void 0:c[i])||0;f=Y(p)?p.charCodeAt(0):p,u[t[d].id]=f}u[t[s].id]?g=u[t[s].id]:(p=("id"===i?t[s].id:null===(l=t[s].data)||void 0===l?void 0:l[i])||0,g=Y(p)?p.charCodeAt(0):p,u[t[s].id]=g),h.push(e*(Math.abs(f-g)*a)/(n[d]/o))}else h.push(e*r/(n[d]/o));else{var v=(r+o)/2;h.push(e*v)}})),s.push(h)}))}return s},Pn=function(t){for(var e=t.length,r=t[0].length,n=[],o=0;o<e;o++){for(var i=[],a=0;a<r;a++)0!==t[o][a]?i.push(1/(t[o][a]*t[o][a])):i.push(0);n.push(i)}return n},Fn=function(t,e){var r=-1;return t.forEach((function(t,n){t.id===e&&(r=n)})),Math.max(r,0)},jn=function(t,e,r){for(var n=t.length,o=0;o<n;o++)if(t[e][o]===1/0){t[e][o]=r,t[o][e]=r;for(var i=0;i<n;i++)t[o][i]!==1/0&&t[e][i]===1/0&&(t[e][i]=r+t[o][i],t[i][e]=r+t[o][i])}for(o=0;o<n;o++)if(o!==e)for(i=0;i<n;i++)if(t[o][i]===1/0){var a=Math.abs(t[e][o]-t[e][i]);a=0===a?1:a,t[o][i]=a}},Gn=function(t,e){for(var r=0,n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r},Un={center:[0,0],width:300,height:300},Vn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="random",this.options=o(o({},Un),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,this.genericRandomLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return s(this,(function(r){return this.genericRandomLayout(!0,t,e),[2]}))}))},t.prototype.genericRandomLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,u,d,h,c,l,f;return s(this,(function(s){return n=o(o({},this.options),r),i=n.center,a=n.width,u=n.height,d=e.getAllNodes(),h=a||"undefined"==typeof window?a:window.innerWidth,c=u||"undefined"==typeof window?u:window.innerHeight,l=i||[h/2,c/2],f=[],d&&d.forEach((function(t){f.push({id:t.id,data:{x:.9*(Math.random()-.5)*h+l[0],y:.9*(Math.random()-.5)*c+l[1]}})})),t&&f.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:f,edges:e.getAllEdges()}]}))}))},t}(),Bn={circular:U,concentric:Q,mds:kn,random:Vn,grid:Yr,radial:Cn,force:Cr,d3force:Wt,fruchterman:$r,forceAtlas2:Wr,dagre:br};function qn(t,e){Bn[t]=e}function Wn(t){return!!t.tick&&!!t.stop}})();var m=v.E9,y=v.y7,w=v.O2,x=v.ul;function E(t,e,r){const n=[],o=[];return Object.keys(e).forEach((t=>{r&&r(e[t]),n.push(e[t].x,e[t].y)})),t.edges().forEach((r=>{const n=t.source(r),i=t.target(r);o.push(e[n].x,e[n].y,e[i].x,e[i].y)})),{nodes:n,edges:o}}function b(t){const e=[],r=[],n={};return t.nodes.forEach((({id:t,data:{x:r,y:o}})=>{n[t]={x:r,y:o},e.push(r,o)})),t.edges.forEach((({source:t,target:e})=>{const o=n[t].x,i=n[t].y,a=n[e].x,s=n[e].y;r.push(o,i,a,s)})),{nodes:e,edges:r}}var N=function(t,e){var r=[],n=[],o=[],i=[],a={};return t.forEach((function(t,e){a[t.id]=e,r.push(t.data.x,t.data.y),n.push(t.data.mass||1)})),e.forEach((function(t){var e=t.data.weight||1,r=a[t.source],s=a[t.target];void 0!==r&&void 0!==s&&(o.push([s,r]),i.push(e),n[r]+=e,n[s]+=e)})),{nodes:r,masses:n,edges:o,weights:i}};function M(t){return{mean:0,min:1,max:2}[t]}var _,A,S={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster",maxDistance:1/0},k=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchtermanWASM",this.options=o(o({},S),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.genericFruchtermanLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var n,i,u,d,h,c,l,f,g,p,v,m,y,w,E,b;return a(this,(function(a){switch(a.label){case 0:return n=this.formatOptions(r),i=n.threads,u=n.width,d=n.height,h=n.center,c=n.maxIteration,l=n.minMovement,f=n.distanceThresholdMode,g=n.gravity,p=n.speed,v=n.maxDistance,m=e.getAllNodes(),y=e.getAllEdges(),(null==m?void 0:m.length)?1===m.length?(t&&e.mergeNodeData(m[0].id,{x:h[0],y:h[1]}),[2,{nodes:[o(o({},m[0]),{data:o(o({},m[0].data),{x:h[0],y:h[1]})})],edges:y}]):((w=m.map((function(t){return x(t,[u,d])}))).forEach((function(t,e){s(t.data.x)||(t.data.x=Math.random()*u),s(t.data.y)||(t.data.y=Math.random()*d)})),E=N(w,y),[4,i.fruchterman({nodes:E.nodes,edges:E.edges,masses:E.masses,weights:E.weights,iterations:c,min_movement:l,distance_threshold_mode:M(f),center:h,height:d,width:u,kg:g,speed:p,max_distance:v})]):[2,{nodes:[],edges:y}];case 1:return b=a.sent().nodes,w.forEach((function(t,e){t.data.x=b[2*e],t.data.y=b[2*e+1]})),t&&w.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y})})),[2,{nodes:w,edges:y}]}}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=o(o({},this.options),t),r=e.clustering,n=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=r&&!!n,e},t}(),I={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1,maxDistance:1/0},T=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2WASM",this.options=o(o({},I),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,r){return i(this,void 0,void 0,(function(){var n,i,u,d,h,c,l,f,g,p,v,m,y,w,E,b,_,A,S;return a(this,(function(a){switch(a.label){case 0:return n=this.formatOptions(r),i=n.threads,u=n.width,d=n.height,h=n.center,c=n.maxIteration,l=n.minMovement,f=n.distanceThresholdMode,n.tao,g=n.kr,p=n.kg,v=n.ks,m=n.dissuadeHubs,y=n.mode,w=n.maxDistance,E=e.getAllNodes(),b=e.getAllEdges(),(null==E?void 0:E.length)?1===E.length?(t&&e.mergeNodeData(E[0].id,{x:h[0],y:h[1]}),[2,{nodes:[o(o({},E[0]),{data:o(o({},E[0].data),{x:h[0],y:h[1]})})],edges:b}]):((_=E.map((function(t){return x(t,[u,d])}))).forEach((function(t,e){s(t.data.x)||(t.data.x=Math.random()*u),s(t.data.y)||(t.data.y=Math.random()*d)})),A=N(_,b),[4,i.forceatlas2({nodes:A.nodes,edges:A.edges,masses:A.masses,weights:A.weights,iterations:c,min_movement:l,distance_threshold_mode:M(f),center:h,ka:1,kg:p,kr:g,speed:v,prevent_overlapping:!1,node_radius:10,kr_prime:10,strong_gravity:!1,lin_log:"linlog"===y,dissuade_hubs:m,max_distance:w})]):[2,{nodes:[],edges:b}];case 1:return S=a.sent().nodes,_.forEach((function(t,e){t.data.x=S[2*e],t.data.y=S[2*e+1]})),t&&_.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y})})),[2,{nodes:_,edges:b}]}}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=o(o({},this.options),t),r=e.center,n=e.width,i=e.height;return e.barnesHut,e.prune,e.maxIteration,e.kr,e.kg,e.width=n||"undefined"==typeof window?n:window.innerWidth,e.height=i||"undefined"==typeof window?i:window.innerHeight,e.center=r||[e.width/2,e.height/2],e},t}(),D={maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean",maxDistance:1/0},R=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceWASM",this.options=o(o({},D),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var n,i,u,d,h,c,l,f,g,p,v,m,y,w,E,b,_,A,S,k,I,T,D;return a(this,(function(a){switch(a.label){case 0:return n=this.formatOptions(r),i=n.threads,u=n.width,d=n.height,h=n.center,c=n.maxIteration,l=n.minMovement,f=n.distanceThresholdMode,g=n.gravity,p=n.factor,v=n.interval,m=n.damping,y=n.maxSpeed,w=n.edgeStrength,E=n.linkDistance,b=n.nodeStrength,_=n.coulombDisScale,A=n.maxDistance,S=e.getAllNodes(),k=e.getAllEdges(),(null==S?void 0:S.length)?1===S.length?(t&&e.mergeNodeData(S[0].id,{x:h[0],y:h[1]}),[2,{nodes:[o(o({},S[0]),{data:o(o({},S[0].data),{x:h[0],y:h[1]})})],edges:k}]):((I=S.map((function(t){return x(t,[u,d])}))).forEach((function(t,e){s(t.data.x)||(t.data.x=Math.random()*u),s(t.data.y)||(t.data.y=Math.random()*d)})),T=N(I,k),[4,i.force2({nodes:T.nodes,edges:T.edges,masses:T.masses,weights:T.weights,iterations:c,min_movement:l,distance_threshold_mode:M(f),center:h,edge_strength:w,link_distance:E,node_strength:b,coulomb_dis_scale:_,kg:g,factor:p,interval:v,damping:m,max_speed:y,max_distance:A})]):[2,{nodes:[],edges:k}];case 1:return D=a.sent().nodes,I.forEach((function(t,e){t.data.x=D[2*e],t.data.y=D[2*e+1]})),t&&I.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y})})),[2,{nodes:I,edges:k}]}}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=o(o({},this.options),t),r=e.center,n=e.width,i=e.height;return e.width=n||"undefined"==typeof window?n:window.innerWidth,e.height=i||"undefined"==typeof window?i:window.innerHeight,e.center=r||[e.width/2,e.height/2],e},t}();function O(t){return void 0===t&&(t=!0),i(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,u(new Worker(new URL("./wasm-worker.js",n.url),{type:"module"}))(t)];case 1:return[2,e.sent()]}}))}))}(A=_||(_={})).GRAPHOLOGY="graphology",A.ANTV_LAYOUT="@antv/layout",A.ANTV_LAYOUT_WASM_SINGLETHREAD="@antv/layout-wasm - singlethread",A.ANTV_LAYOUT_WASM_MULTITHREADS="@antv/layout-wasm - multithreads",A.ANTV_LAYOUT_GPU="@antv/layout-gpu";async function z(t,{iterations:e}){return E(t,d(t,{settings:{barnesHutOptimize:!1,strongGravityMode:!1,gravity:1,scalingRatio:1,slowDown:1},iterations:e||100,getEdgeWeight:"weight"}),(t=>{t.x=t.x+400,t.y=t.y+400}))}async function C(t,{iterations:e}){const r=new m({kr:1,kg:1,ks:.1,maxIteration:e||100,width:800,height:800,center:[400,400]});return b(await r.execute(t))}async function L(t,{iterations:e,min_movement:r,distance_threshold_mode:n},o){const i=new T({threads:o,maxIteration:e||100,minMovement:r,distanceThresholdMode:n,height:800,width:800,center:[400,400],kg:1,kr:1,ks:.1});return b(await i.execute(t))}async function P(t,{iterations:e,min_movement:r,distance_threshold_mode:n}){const o=new y({factor:1,gravity:10,linkDistance:200,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:1e3,minMovement:r,interval:.02,preventOverlap:!0,distanceThresholdMode:n,maxIteration:e||100,width:800,height:800,center:[400,400]});return b(await o.execute(t))}async function F(t,{iterations:e,min_movement:r,distance_threshold_mode:n},o){const i=new R({threads:o,maxIteration:e||100,minMovement:r,distanceThresholdMode:n,height:800,width:800,center:[400,400],factor:1,gravity:10,linkDistance:200,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:1e3,interval:.02});return b(await i.execute(t))}
/*! For license information please see index.esm.js.LICENSE.txt */var j={737:(t,e,r)=>{var n=r(68).default;function o(){t.exports=o=function(){return e},t.exports.__esModule=!0,t.exports.default=t.exports;var e={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",d=s.asyncIterator||"@@asyncIterator",h=s.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(D){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof p?e:p,i=Object.create(o.prototype),s=new k(n||[]);return a(i,"_invoke",{value:M(t,r,s)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(n){return{type:"throw",arg:n}}}e.wrap=l;var g={};function p(){}function v(){}function m(){}var y={};c(y,u,(function(){return this}));var w=Object.getPrototypeOf,x=w&&w(w(I([])));x&&x!==r&&i.call(x,u)&&(y=x);var E=m.prototype=p.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function N(t,e){function r(o,a,s,u){var d=f(t[o],t,a);if("throw"!==d.type){var h=d.arg,c=h.value;return c&&"object"==n(c)&&i.call(c,"__await")?e.resolve(c.__await).then((function(t){r("next",t,s,u)}),(function(t){r("throw",t,s,u)})):e.resolve(c).then((function(t){h.value=t,s(h)}),(function(t){return r("throw",t,s,u)}))}u(d.arg)}var o;a(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}})}function M(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=_(a,r);if(s){if(s===g)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=f(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function _(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=f(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,g;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,g):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,g)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function I(t){if(t){var e=t[u];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(i.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:T}}function T(){return{value:void 0,done:!0}}return v.prototype=m,a(E,"constructor",{value:m,configurable:!0}),a(m,"constructor",{value:v,configurable:!0}),v.displayName=c(m,h,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,c(t,h,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},b(N.prototype),c(N.prototype,d,(function(){return this})),e.AsyncIterator=N,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new N(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(E),c(E,h,"Generator"),c(E,u,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:I(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),g}},e}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},68:t=>{function e(r){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},279:(t,e,r)=>{var n=r(737)();t.exports=n;try{regeneratorRuntime=n}catch(o){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},861:(t,e,r)=>{var n=r(250).Symbol;t.exports=n},823:(t,e,r)=>{var n=r(861),o=r(339),i=r(151),a=n?n.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":a&&a in Object(t)?o(t):i(t)}},448:(t,e,r)=>{var n=r(823),o=r(52),i=r(440),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(t){return i(t)&&o(t.length)&&!!a[n(t)]}},525:t=>{t.exports=function(t){return function(e){return t(e)}}},302:(t,e,r)=>{var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;t.exports=n},490:(t,e,r)=>{var n=r(540)(Object.getPrototypeOf,Object);t.exports=n},339:(t,e,r)=>{var n=r(861),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,s=n?n.toStringTag:void 0;t.exports=function(t){var e=i.call(t,s),r=t[s];try{t[s]=void 0;var n=!0}catch(u){}var o=a.call(t);return n&&(e?t[s]=r:delete t[s]),o}},690:(t,e,r)=>{t=r.nmd(t);var n=r(302),o=e&&!e.nodeType&&e,i=o&&t&&!t.nodeType&&t,a=i&&i.exports===o&&n.process,s=function(){try{return i&&i.require&&i.require("util").types||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=s},151:t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},540:t=>{t.exports=function(t,e){return function(r){return t(e(r))}}},250:(t,e,r)=>{var n=r(302),o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")();t.exports=i},589:t=>{var e=Array.isArray;t.exports=e},52:t=>{t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},224:(t,e,r)=>{var n=r(823),o=r(440);t.exports=function(t){return"number"==typeof t||o(t)&&"[object Number]"==n(t)}},440:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},256:(t,e,r)=>{var n=r(823),o=r(490),i=r(440),a=Function.prototype,s=Object.prototype,u=a.toString,d=s.hasOwnProperty,h=u.call(Object);t.exports=function(t){if(!i(t)||"[object Object]"!=n(t))return!1;var e=o(t);if(null===e)return!0;var r=d.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&u.call(r)==h}},922:(t,e,r)=>{var n=r(448),o=r(525),i=r(690),a=i&&i.isTypedArray,s=a?o(a):n;t.exports=s},919:function(t){t.exports=function(){var t=function(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array||t instanceof Uint8ClampedArray},e=function(t,e){for(var r=Object.keys(e),n=0;n<r.length;++n)t[r[n]]=e[r[n]];return t},r="\n";function n(t){var e=new Error("(regl) "+t);throw console.error(e),e}function o(t,e){t||n(e)}function i(t){return t?": "+t:""}function a(t,e){switch(e){case"number":return"number"==typeof t;case"object":return"object"==typeof t;case"string":return"string"==typeof t;case"boolean":return"boolean"==typeof t;case"function":return"function"==typeof t;case"undefined":return void 0===t;case"symbol":return"symbol"==typeof t}}function s(t,e,r){e.indexOf(t)<0&&n("invalid value"+i(r)+". must be one of: "+e)}var u=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function d(t,e){for(t+="";t.length<e;)t=" "+t;return t}function h(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function c(t,e){this.number=t,this.line=e,this.errors=[]}function l(t,e,r){this.file=t,this.line=e,this.message=r}function f(){var t=new Error,e=(t.stack||t).toString(),r=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(e);if(r)return r[1];var n=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(e);return n?n[1]:"unknown"}function g(){var t=new Error,e=(t.stack||t).toString(),r=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(e);if(r)return r[1];var n=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(e);return n?n[1]:"unknown"}function p(t,e){var r,n=t.split("\n"),o=1,i=0,a={unknown:new h,0:new h};a.unknown.name=a[0].name=e||f(),a.unknown.lines.push(new c(0,""));for(var s=0;s<n.length;++s){var u=n[s],d=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(u);if(d)switch(d[1]){case"line":var l=/(\d+)(\s+\d+)?/.exec(d[2]);l&&(o=0|l[1],l[2]&&((i=0|l[2])in a||(a[i]=new h)));break;case"define":var g=/SHADER_NAME(_B64)?\s+(.*)$/.exec(d[2]);g&&(a[i].name=g[1]?(r=g[2],"undefined"!=typeof atob?atob(r):"base64:"+r):g[2])}a[i].lines.push(new c(o++,u))}return Object.keys(a).forEach((function(t){var e=a[t];e.lines.forEach((function(t){e.index[t.number]=t}))})),a}function v(t){t._commandRef=f()}function m(t,e){var r=g();n(t+" in command "+(e||f())+("unknown"===r?"":" called from "+r))}function y(t,e,r,n){a(t,e)||m("invalid parameter type"+i(r)+". expected "+e+", got "+typeof t,n||f())}var w=33071,x={};function E(t,e){return 32820===t||32819===t||33635===t?2:34042===t?4:x[t]*e}function b(t){return!(t&t-1||!t)}x[5120]=x[5121]=1,x[5122]=x[5123]=x[36193]=x[33635]=x[32819]=x[32820]=2,x[5124]=x[5125]=x[5126]=x[34042]=4;var N=e(o,{optional:function(t){t()},raise:n,commandRaise:m,command:function(t,e,r){t||m(e,r||f())},parameter:function(t,e,r){t in e||n("unknown parameter ("+t+")"+i(r)+". possible values: "+Object.keys(e).join())},commandParameter:function(t,e,r,n){t in e||m("unknown parameter ("+t+")"+i(r)+". possible values: "+Object.keys(e).join(),n||f())},constructor:function(t){Object.keys(t).forEach((function(t){u.indexOf(t)<0&&n('invalid regl constructor argument "'+t+'". must be one of '+u)}))},type:function(t,e,r){a(t,e)||n("invalid parameter type"+i(r)+". expected "+e+", got "+typeof t)},commandType:y,isTypedArray:function(e,r){t(e)||n("invalid parameter type"+i(r)+". must be a typed array")},nni:function(t,e){t>=0&&(0|t)===t||n("invalid parameter type, ("+t+")"+i(e)+". must be a nonnegative integer")},oneOf:s,shaderError:function(t,e,n,i,a){if(!t.getShaderParameter(e,t.COMPILE_STATUS)){var s=t.getShaderInfoLog(e),u=i===t.FRAGMENT_SHADER?"fragment":"vertex";y(n,"string",u+" shader source must be a string",a);var h=p(n,a),c=(f=[],s.split("\n").forEach((function(t){if(!(t.length<5)){var e=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(t);e?f.push(new l(0|e[1],0|e[2],e[3].trim())):t.length>0&&f.push(new l("unknown",0,t))}})),f);(function(t,e){e.forEach((function(e){var r=t[e.file];if(r){var n=r.index[e.line];if(n)return n.errors.push(e),void(r.hasErrors=!0)}t.unknown.hasErrors=!0,t.unknown.lines[0].errors.push(e)}))})(h,c),Object.keys(h).forEach((function(t){var e=h[t];if(e.hasErrors){var n=[""],o=[""];i("file number "+t+": "+e.name+"\n","color:red;text-decoration:underline;font-weight:bold"),e.lines.forEach((function(t){if(t.errors.length>0){i(d(t.number,4)+"|  ","background-color:yellow; font-weight:bold"),i(t.line+r,"color:red; background-color:yellow; font-weight:bold");var e=0;t.errors.forEach((function(n){var o=n.message,a=/^\s*'(.*)'\s*:\s*(.*)$/.exec(o);if(a){var s=a[1];o=a[2],"assign"===s&&(s="="),e=Math.max(t.line.indexOf(s,e),0)}else e=0;i(d("| ",6)),i(d("^^^",e+3)+r,"font-weight:bold"),i(d("| ",6)),i(o+r,"font-weight:bold")})),i(d("| ",6)+r)}else i(d(t.number,4)+"|  "),i(t.line+r,"color:red")})),"undefined"==typeof document||window.chrome?console.log(n.join("")):(o[0]=n.join("%c"),console.log.apply(console,o))}function i(t,e){n.push(t),o.push(e||"")}})),o.raise("Error compiling "+u+" shader, "+h[0].name)}var f},linkError:function(t,e,n,i,a){if(!t.getProgramParameter(e,t.LINK_STATUS)){var s=t.getProgramInfoLog(e),u=p(n,a),d='Error linking program with vertex shader, "'+p(i,a)[0].name+'", and fragment shader "'+u[0].name+'"';"undefined"!=typeof document?console.log("%c"+d+"\n%c"+s,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(d+r+s),o.raise(d)}},callSite:g,saveCommandRef:v,saveDrawInfo:function(t,e,r,n){function o(t){return t?n.id(t):0}function i(t,e){Object.keys(e).forEach((function(e){t[n.id(e)]=!0}))}v(t),t._fragId=o(t.static.frag),t._vertId=o(t.static.vert);var a=t._uniformSet={};i(a,e.static),i(a,e.dynamic);var s=t._attributeSet={};i(s,r.static),i(s,r.dynamic),t._hasCount="count"in t.static||"count"in t.dynamic||"elements"in t.static||"elements"in t.dynamic},framebufferFormat:function(t,e,r){t.texture?s(t.texture._texture.internalformat,e,"unsupported texture format for attachment"):s(t.renderbuffer._renderbuffer.format,r,"unsupported renderbuffer format for attachment")},guessCommand:f,texture2D:function(t,e,r){var n,i=e.width,a=e.height,s=e.channels;o(i>0&&i<=r.maxTextureSize&&a>0&&a<=r.maxTextureSize,"invalid texture shape"),t.wrapS===w&&t.wrapT===w||o(b(i)&&b(a),"incompatible wrap mode for texture, both width and height must be power of 2"),1===e.mipmask?1!==i&&1!==a&&o(9984!==t.minFilter&&9986!==t.minFilter&&9985!==t.minFilter&&9987!==t.minFilter,"min filter requires mipmap"):(o(b(i)&&b(a),"texture must be a square power of 2 to support mipmapping"),o(e.mipmask===(i<<1)-1,"missing or incomplete mipmap data")),5126===e.type&&(r.extensions.indexOf("oes_texture_float_linear")<0&&o(9728===t.minFilter&&9728===t.magFilter,"filter not supported, must enable oes_texture_float_linear"),o(!t.genMipmaps,"mipmap generation not supported with float textures"));var u=e.images;for(n=0;n<16;++n)if(u[n]){var d=i>>n,h=a>>n;o(e.mipmask&1<<n,"missing mipmap data");var c=u[n];if(o(c.width===d&&c.height===h,"invalid shape for mip images"),o(c.format===e.format&&c.internalformat===e.internalformat&&c.type===e.type,"incompatible type for mip image"),c.compressed);else if(c.data){var l=Math.ceil(E(c.type,s)*d/c.unpackAlignment)*c.unpackAlignment;o(c.data.byteLength===l*h,"invalid data for image, buffer size is inconsistent with image format")}else c.element||c.copy}else t.genMipmaps||o(0==(e.mipmask&1<<n),"extra mipmap data");e.compressed&&o(!t.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(t,e,r,n){var i=t.width,a=t.height,s=t.channels;o(i>0&&i<=n.maxTextureSize&&a>0&&a<=n.maxTextureSize,"invalid texture shape"),o(i===a,"cube map must be square"),o(e.wrapS===w&&e.wrapT===w,"wrap mode not supported by cube map");for(var u=0;u<r.length;++u){var d=r[u];o(d.width===i&&d.height===a,"inconsistent cube map face shape"),e.genMipmaps&&(o(!d.compressed,"can not generate mipmap for compressed textures"),o(1===d.mipmask,"can not specify mipmaps and generate mipmaps"));for(var h=d.images,c=0;c<16;++c){var l=h[c];if(l){var f=i>>c,g=a>>c;o(d.mipmask&1<<c,"missing mipmap data"),o(l.width===f&&l.height===g,"invalid shape for mip images"),o(l.format===t.format&&l.internalformat===t.internalformat&&l.type===t.type,"incompatible type for mip image"),l.compressed||(l.data?o(l.data.byteLength===f*g*Math.max(E(l.type,s),l.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):l.element||l.copy)}}}}}),M=0;function _(t,e){this.id=M++,this.type=t,this.data=e}function A(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function S(t){if(0===t.length)return[];var e=t.charAt(0),r=t.charAt(t.length-1);if(t.length>1&&e===r&&('"'===e||"'"===e))return['"'+A(t.substr(1,t.length-2))+'"'];var n=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(t);if(n)return S(t.substr(0,n.index)).concat(S(n[1])).concat(S(t.substr(n.index+n[0].length)));var o=t.split(".");if(1===o.length)return['"'+A(t)+'"'];for(var i=[],a=0;a<o.length;++a)i=i.concat(S(o[a]));return i}function k(t){return"["+S(t).join("][")+"]"}var I={DynamicVariable:_,define:function(t,e){return new _(t,k(e+""))},isDynamic:function(t){return"function"==typeof t&&!t._reglType||t instanceof _},unbox:function t(e,r){return"function"==typeof e?new _(0,e):"number"==typeof e||"boolean"==typeof e?new _(5,e):Array.isArray(e)?new _(6,e.map(((e,n)=>t(e,r+"["+n+"]")))):e instanceof _?e:void N(!1,"invalid option type in uniform "+r)},accessor:k},T={next:"function"==typeof requestAnimationFrame?function(t){return requestAnimationFrame(t)}:function(t){return setTimeout(t,16)},cancel:"function"==typeof cancelAnimationFrame?function(t){return cancelAnimationFrame(t)}:clearTimeout},D="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function R(t){return"string"==typeof t?t.split():(N(Array.isArray(t),"invalid extension array"),t)}function O(t){return"string"==typeof t?(N("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(t)):t}function z(t,e){for(var r=Array(t),n=0;n<t;++n)r[n]=e(n);return r}function C(t){var e,r;return e=(t>65535)<<4,e|=r=((t>>>=e)>255)<<3,e|=r=((t>>>=r)>15)<<2,(e|=r=((t>>>=r)>3)<<1)|(t>>>=r)>>1}function L(){var t=z(8,(function(){return[]}));function e(e){var r=function(t){for(var e=16;e<=1<<28;e*=16)if(t<=e)return e;return 0}(e),n=t[C(r)>>2];return n.length>0?n.pop():new ArrayBuffer(r)}function r(e){t[C(e.byteLength)>>2].push(e)}return{alloc:e,free:r,allocType:function(t,r){var n=null;switch(t){case 5120:n=new Int8Array(e(r),0,r);break;case 5121:n=new Uint8Array(e(r),0,r);break;case 5122:n=new Int16Array(e(2*r),0,r);break;case 5123:n=new Uint16Array(e(2*r),0,r);break;case 5124:n=new Int32Array(e(4*r),0,r);break;case 5125:n=new Uint32Array(e(4*r),0,r);break;case 5126:n=new Float32Array(e(4*r),0,r);break;default:return null}return n.length!==r?n.subarray(0,r):n},freeType:function(t){r(t.buffer)}}}var P=L();P.zero=L();var F=3553,j=6408,G=5126,U=36160;function V(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||t(e.data))}var B=function(t){return Object.keys(t).map((function(e){return t[e]}))},q=function(t){for(var e=[],r=t;r.length;r=r[0])e.push(r.length);return e},W=function(t,e,r,n){var o=1;if(e.length)for(var i=0;i<e.length;++i)o*=e[i];else o=0;var a=n||P.allocType(r,o);switch(e.length){case 0:break;case 1:!function(t,e,r){for(var n=0;n<e;++n)r[n]=t[n]}(t,e[0],a);break;case 2:!function(t,e,r,n){for(var o=0,i=0;i<e;++i)for(var a=t[i],s=0;s<r;++s)n[o++]=a[s]}(t,e[0],e[1],a);break;case 3:H(t,e[0],e[1],e[2],a,0);break;default:$(t,e,0,a,0)}return a};function H(t,e,r,n,o,i){for(var a=i,s=0;s<e;++s)for(var u=t[s],d=0;d<r;++d)for(var h=u[d],c=0;c<n;++c)o[a++]=h[c]}function $(t,e,r,n,o){for(var i=1,a=r+1;a<e.length;++a)i*=e[a];var s=e[r];if(e.length-r==4){var u=e[r+1],d=e[r+2],h=e[r+3];for(a=0;a<s;++a)H(t[a],u,d,h,n,o),o+=i}else for(a=0;a<s;++a)$(t[a],e,r+1,n,o),o+=i}var X={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Y={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},K={dynamic:35048,stream:35040,static:35044},Q=W,Z=q,J=5121,tt=5126,et=[];function rt(t){return 0|X[Object.prototype.toString.call(t)]}function nt(t,e){for(var r=0;r<e.length;++r)t[r]=e[r]}function ot(t,e,r,n,o,i,a){for(var s=0,u=0;u<r;++u)for(var d=0;d<n;++d)t[s++]=e[o*u+i*d+a]}et[5120]=1,et[5122]=2,et[5124]=4,et[5121]=1,et[5123]=2,et[5125]=4,et[5126]=4;var it={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},at=5121,st=5123,ut=5125,dt=34963,ht=new Float32Array(1),ct=new Uint32Array(ht.buffer);function lt(t){for(var e=P.allocType(5123,t.length),r=0;r<t.length;++r)if(isNaN(t[r]))e[r]=65535;else if(t[r]===1/0)e[r]=31744;else if(t[r]===-1/0)e[r]=64512;else{ht[0]=t[r];var n=ct[0],o=n>>>31<<15,i=(n<<1>>>24)-127,a=n>>13&1023;if(i<-24)e[r]=o;else if(i<-14){var s=-14-i;e[r]=o+(a+1024>>s)}else e[r]=i>15?o+31744:o+(i+15<<10)+a}return e}function ft(e){return Array.isArray(e)||t(e)}var gt=function(t){return!(t&t-1||!t)},pt=3553,vt=34067,mt=34069,yt=6408,wt=6406,xt=6407,Et=6409,bt=6410,Nt=32855,Mt=6402,_t=34041,At=35904,St=35906,kt=36193,It=33776,Tt=33777,Dt=33778,Rt=33779,Ot=5121,zt=5123,Ct=5125,Lt=5126,Pt=33071,Ft=9728,jt=9984,Gt=9987,Ut=4352,Vt=33984,Bt=[jt,9986,9985,Gt],qt=[0,Et,bt,xt,yt],Wt={};function Ht(t){return"[object "+t+"]"}Wt[Et]=Wt[wt]=Wt[Mt]=1,Wt[_t]=Wt[bt]=2,Wt[xt]=Wt[At]=3,Wt[yt]=Wt[St]=4;var $t=Ht("HTMLCanvasElement"),Xt=Ht("OffscreenCanvas"),Yt=Ht("CanvasRenderingContext2D"),Kt=Ht("ImageBitmap"),Qt=Ht("HTMLImageElement"),Zt=Ht("HTMLVideoElement"),Jt=Object.keys(X).concat([$t,Xt,Yt,Kt,Qt,Zt]),te=[];te[Ot]=1,te[Lt]=4,te[kt]=2,te[zt]=2,te[Ct]=4;var ee=[];function re(t){return Array.isArray(t)&&(0===t.length||"number"==typeof t[0])}function ne(t){return!!Array.isArray(t)&&!(0===t.length||!ft(t[0]))}function oe(t){return Object.prototype.toString.call(t)}function ie(t){return oe(t)===$t}function ae(t){return oe(t)===Xt}function se(t){if(!t)return!1;var e=oe(t);return Jt.indexOf(e)>=0||re(t)||ne(t)||V(t)}function ue(t){return 0|X[Object.prototype.toString.call(t)]}function de(t,e){return P.allocType(t.type===kt?Lt:t.type,e)}function he(t,e){t.type===kt?(t.data=lt(e),P.freeType(e)):t.data=e}function ce(t,e,r,n,o,i){var a;if(a=void 0!==ee[t]?ee[t]:Wt[t]*te[e],i&&(a*=6),o){for(var s=0,u=r;u>=1;)s+=a*u*u,u/=2;return s}return a*r*n}ee[32854]=2,ee[Nt]=2,ee[36194]=2,ee[_t]=4,ee[It]=.5,ee[Tt]=.5,ee[Dt]=1,ee[Rt]=1,ee[35986]=.5,ee[35987]=1,ee[34798]=1,ee[35840]=.5,ee[35841]=.25,ee[35842]=.5,ee[35843]=.25,ee[36196]=.5;var le=36161,fe=32854,ge=[];function pe(t,e,r){return ge[t]*e*r}ge[32854]=2,ge[32855]=2,ge[36194]=2,ge[33189]=2,ge[36168]=1,ge[34041]=4,ge[35907]=4,ge[34836]=16,ge[34842]=8,ge[34843]=6;var ve=36160,me=36161,ye=3553,we=34069,xe=[6407,6408],Ee=[];Ee[6408]=4,Ee[6407]=3;var be=[];be[5121]=1,be[5126]=4,be[36193]=2;var Ne=[32854,32855,36194,35907,34842,34843,34836],Me={36053:"complete",36054:"incomplete attachment",36057:"incomplete dimensions",36055:"incomplete, missing attachment",36061:"unsupported"};function _e(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.offset=0,this.stride=0,this.divisor=0}var Ae=5121,Se=5126;function ke(t){return Array.prototype.slice.call(t)}function Ie(t){return ke(t).join("")}var Te="xyzw".split(""),De="dither",Re="blend.enable",Oe="blend.color",ze="blend.equation",Ce="blend.func",Le="depth.enable",Pe="depth.func",Fe="depth.range",je="depth.mask",Ge="colorMask",Ue="cull.enable",Ve="cull.face",Be="frontFace",qe="lineWidth",We="polygonOffset.enable",He="polygonOffset.offset",$e="sample.alpha",Xe="sample.enable",Ye="sample.coverage",Ke="stencil.enable",Qe="stencil.mask",Ze="stencil.func",Je="stencil.opFront",tr="stencil.opBack",er="scissor.enable",rr="scissor.box",nr="viewport",or="profile",ir="framebuffer",ar="vert",sr="frag",ur="elements",dr="primitive",hr="count",cr="offset",lr="instances",fr="vao",gr="Width",pr="Height",vr=ir+gr,mr=ir+pr,yr="drawingBuffer",wr=yr+gr,xr=yr+pr,Er=[Ce,ze,Ze,Je,tr,Ye,nr,rr,He],br=34962,Nr=5126,Mr=35664,_r=35665,Ar=35666,Sr=5124,kr=35667,Ir=35668,Tr=35669,Dr=35670,Rr=35671,Or=35672,zr=35673,Cr=35674,Lr=35675,Pr=35676,Fr=35678,jr=35680,Gr=1028,Ur=1029,Vr=2305,Br=7680,qr={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Wr=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Hr={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},$r={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Xr={frag:35632,vert:35633},Yr={cw:2304,ccw:Vr};function Kr(e){return Array.isArray(e)||t(e)||V(e)}function Qr(t){return t.sort((function(t,e){return t===nr?-1:e===nr?1:t<e?-1:1}))}function Zr(t,e,r,n){this.thisDep=t,this.contextDep=e,this.propDep=r,this.append=n}function Jr(t){return t&&!(t.thisDep||t.contextDep||t.propDep)}function tn(t){return new Zr(!1,!1,!1,t)}function en(t,e){var r=t.type;if(0===r){var n=t.data.length;return new Zr(!0,n>=1,n>=2,e)}if(4===r){var o=t.data;return new Zr(o.thisDep,o.contextDep,o.propDep,e)}if(5===r)return new Zr(!1,!1,!1,e);if(6===r){for(var i=!1,a=!1,s=!1,u=0;u<t.data.length;++u){var d=t.data[u];if(1===d.type)s=!0;else if(2===d.type)a=!0;else if(3===d.type)i=!0;else if(0===d.type){i=!0;var h=d.data;h>=1&&(a=!0),h>=2&&(s=!0)}else 4===d.type&&(i=i||d.data.thisDep,a=a||d.data.contextDep,s=s||d.data.propDep)}return new Zr(i,a,s,e)}return new Zr(3===r,2===r,1===r,e)}var rn=new Zr(!1,!1,!1,(function(){}));function nn(t,r,n,o,i,a,s,u,d,h,c,l,f,g,p){var v=h.Record,m={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(m.min=32775,m.max=32776);var y=n.angle_instanced_arrays,w=n.webgl_draw_buffers,x={dirty:!0,profile:p.profile},E={},b=[],M={},_={};function A(t){return t.replace(".","_")}function S(t,e,r){var n=A(t);b.push(t),E[n]=x[n]=!!r,M[n]=e}function k(t,e,r){var n=A(t);b.push(t),Array.isArray(r)?(x[n]=r.slice(),E[n]=r.slice()):x[n]=E[n]=r,_[n]=e}S(De,3024),S(Re,3042),k(Oe,"blendColor",[0,0,0,0]),k(ze,"blendEquationSeparate",[32774,32774]),k(Ce,"blendFuncSeparate",[1,0,1,0]),S(Le,2929,!0),k(Pe,"depthFunc",513),k(Fe,"depthRange",[0,1]),k(je,"depthMask",!0),k(Ge,Ge,[!0,!0,!0,!0]),S(Ue,2884),k(Ve,"cullFace",Ur),k(Be,Be,Vr),k(qe,qe,1),S(We,32823),k(He,"polygonOffset",[0,0]),S($e,32926),S(Xe,32928),k(Ye,"sampleCoverage",[1,!1]),S(Ke,2960),k(Qe,"stencilMask",-1),k(Ze,"stencilFunc",[519,0,-1]),k(Je,"stencilOpSeparate",[Gr,Br,Br,Br]),k(tr,"stencilOpSeparate",[Ur,Br,Br,Br]),S(er,3089),k(rr,"scissor",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]),k(nr,nr,[0,0,t.drawingBufferWidth,t.drawingBufferHeight]);var T={gl:t,context:f,strings:r,next:E,current:x,draw:l,elements:a,buffer:i,shader:c,attributes:h.state,vao:h,uniforms:d,framebuffer:u,extensions:n,timer:g,isBufferArgs:Kr},D={primTypes:it,compareFuncs:Hr,blendFuncs:qr,blendEquations:m,stencilOps:$r,glTypes:Y,orientationType:Yr};N.optional((function(){T.isArrayLike=ft})),w&&(D.backBuffer=[Ur],D.drawBuffer=z(o.maxDrawbuffers,(function(t){return 0===t?[0]:z(t,(function(t){return 36064+t}))})));var R=0;function O(){var t=function(){var t=0,r=[],n=[];function o(){var r=[],n=[];return e((function(){r.push.apply(r,ke(arguments))}),{def:function(){var e="v"+t++;return n.push(e),arguments.length>0&&(r.push(e,"="),r.push.apply(r,ke(arguments)),r.push(";")),e},toString:function(){return Ie([n.length>0?"var "+n.join(",")+";":"",Ie(r)])}})}function i(){var t=o(),r=o(),n=t.toString,i=r.toString;function a(e,n){r(e,n,"=",t.def(e,n),";")}return e((function(){t.apply(t,ke(arguments))}),{def:t.def,entry:t,exit:r,save:a,set:function(e,r,n){a(e,r),t(e,r,"=",n,";")},toString:function(){return n()+i()}})}var a=o(),s={};return{global:a,link:function(e){for(var o=0;o<n.length;++o)if(n[o]===e)return r[o];var i="g"+t++;return r.push(i),n.push(e),i},block:o,proc:function(t,r){var n=[];function o(){var t="a"+n.length;return n.push(t),t}r=r||0;for(var a=0;a<r;++a)o();var u=i(),d=u.toString;return s[t]=e(u,{arg:o,toString:function(){return Ie(["function(",n.join(),"){",d(),"}"])}})},scope:i,cond:function(){var t=Ie(arguments),r=i(),n=i(),o=r.toString,a=n.toString;return e(r,{then:function(){return r.apply(r,ke(arguments)),this},else:function(){return n.apply(n,ke(arguments)),this},toString:function(){var e=a();return e&&(e="else{"+e+"}"),Ie(["if(",t,"){",o(),"}",e])}})},compile:function(){var t=['"use strict";',a,"return {"];Object.keys(s).forEach((function(e){t.push('"',e,'":',s[e].toString(),",")})),t.push("}");var e=Ie(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,r.concat(e)).apply(null,n)}}}(),n=t.link,o=t.global;t.id=R++,t.batchId="0";var i=n(T),a=t.shared={props:"a0"};Object.keys(T).forEach((function(t){a[t]=o.def(i,".",t)})),N.optional((function(){t.CHECK=n(N),t.commandStr=N.guessCommand(),t.command=n(t.commandStr),t.assert=function(t,e,r){t("if(!(",e,"))",this.CHECK,".commandRaise(",n(r),",",this.command,");")},D.invalidBlendCombinations=Wr}));var s=t.next={},u=t.current={};Object.keys(_).forEach((function(t){Array.isArray(x[t])&&(s[t]=o.def(a.next,".",t),u[t]=o.def(a.current,".",t))}));var d=t.constants={};Object.keys(D).forEach((function(t){d[t]=o.def(JSON.stringify(D[t]))})),t.invoke=function(e,r){switch(r.type){case 0:var o=["this",a.context,a.props,t.batchId];return e.def(n(r.data),".call(",o.slice(0,Math.max(r.data.length+1,4)),")");case 1:return e.def(a.props,r.data);case 2:return e.def(a.context,r.data);case 3:return e.def("this",r.data);case 4:return r.data.append(t,e),r.data.ref;case 5:return r.data.toString();case 6:return r.data.map((function(r){return t.invoke(e,r)}))}},t.attribCache={};var c={};return t.scopeAttrib=function(t){var e=r.id(t);if(e in c)return c[e];var o=h.scope[e];return o||(o=h.scope[e]=new v),c[e]=n(o)},t}function C(t,e,r){var n=t.shared.context,o=t.scope();Object.keys(r).forEach((function(i){e.save(n,"."+i);var a=r[i].append(t,e);Array.isArray(a)?o(n,".",i,"=[",a.join(),"];"):o(n,".",i,"=",a,";")})),e(o)}function L(t,e,r,n){var o,i=t.shared,a=i.gl,s=i.framebuffer;w&&(o=e.def(i.extensions,".webgl_draw_buffers"));var u,d=t.constants,h=d.drawBuffer,c=d.backBuffer;u=r?r.append(t,e):e.def(s,".next"),n||e("if(",u,"!==",s,".cur){"),e("if(",u,"){",a,".bindFramebuffer(",36160,",",u,".framebuffer);"),w&&e(o,".drawBuffersWEBGL(",h,"[",u,".colorAttachments.length]);"),e("}else{",a,".bindFramebuffer(",36160,",null);"),w&&e(o,".drawBuffersWEBGL(",c,");"),e("}",s,".cur=",u,";"),n||e("}")}function P(t,e,r){var n=t.shared,o=n.gl,i=t.current,a=t.next,s=n.current,u=n.next,d=t.cond(s,".dirty");b.forEach((function(e){var n,h,c=A(e);if(!(c in r.state))if(c in a){n=a[c],h=i[c];var l=z(x[c].length,(function(t){return d.def(n,"[",t,"]")}));d(t.cond(l.map((function(t,e){return t+"!=="+h+"["+e+"]"})).join("||")).then(o,".",_[c],"(",l,");",l.map((function(t,e){return h+"["+e+"]="+t})).join(";"),";"))}else{n=d.def(u,".",c);var f=t.cond(n,"!==",s,".",c);d(f),c in M?f(t.cond(n).then(o,".enable(",M[c],");").else(o,".disable(",M[c],");"),s,".",c,"=",n,";"):f(o,".",_[c],"(",n,");",s,".",c,"=",n,";")}})),0===Object.keys(r.state).length&&d(s,".dirty=false;"),e(d)}function F(t,e,r,n){var o=t.shared,i=t.current,a=o.current,s=o.gl;Qr(Object.keys(r)).forEach((function(o){var u=r[o];if(!n||n(u)){var d=u.append(t,e);if(M[o]){var h=M[o];Jr(u)?e(s,d?".enable(":".disable(",h,");"):e(t.cond(d).then(s,".enable(",h,");").else(s,".disable(",h,");")),e(a,".",o,"=",d,";")}else if(ft(d)){var c=i[o];e(s,".",_[o],"(",d,");",d.map((function(t,e){return c+"["+e+"]="+t})).join(";"),";")}else e(s,".",_[o],"(",d,");",a,".",o,"=",d,";")}}))}function j(t,e){y&&(t.instancing=e.def(t.shared.extensions,".angle_instanced_arrays"))}function G(t,e,r,n,o){var i,a,s,u=t.shared,d=t.stats,h=u.current,c=u.timer,l=r.profile;function f(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function p(t){t(i=e.def(),"=",f(),";"),"string"==typeof o?t(d,".count+=",o,";"):t(d,".count++;"),g&&(n?t(a=e.def(),"=",c,".getNumPendingQueries();"):t(c,".beginQuery(",d,");"))}function v(t){t(d,".cpuTime+=",f(),"-",i,";"),g&&(n?t(c,".pushScopeStats(",a,",",c,".getNumPendingQueries(),",d,");"):t(c,".endQuery();"))}function m(t){var r=e.def(h,".profile");e(h,".profile=",t,";"),e.exit(h,".profile=",r,";")}if(l){if(Jr(l))return void(l.enable?(p(e),v(e.exit),m("true")):m("false"));m(s=l.append(t,e))}else s=e.def(h,".profile");var y=t.block();p(y),e("if(",s,"){",y,"}");var w=t.block();v(w),e.exit("if(",s,"){",w,"}")}function U(t,e,r,n,o){var i=t.shared;n.forEach((function(n){var a,s=n.name,u=r.attributes[s];if(u){if(!o(u))return;a=u.append(t,e)}else{if(!o(rn))return;var d=t.scopeAttrib(s);N.optional((function(){t.assert(e,d+".state","missing attribute "+s)})),a={},Object.keys(new v).forEach((function(t){a[t]=e.def(d,".",t)}))}!function(r,n,o){var a=i.gl,s=e.def(r,".location"),u=e.def(i.attributes,"[",s,"]"),d=o.state,h=o.buffer,c=[o.x,o.y,o.z,o.w],l=["buffer","normalized","offset","stride"];function f(){e("if(!",u,".buffer){",a,".enableVertexAttribArray(",s,");}");var r,i=o.type;if(r=o.size?e.def(o.size,"||",n):n,e("if(",u,".type!==",i,"||",u,".size!==",r,"||",l.map((function(t){return u+"."+t+"!=="+o[t]})).join("||"),"){",a,".bindBuffer(",br,",",h,".buffer);",a,".vertexAttribPointer(",[s,r,i,o.normalized,o.stride,o.offset],");",u,".type=",i,";",u,".size=",r,";",l.map((function(t){return u+"."+t+"="+o[t]+";"})).join(""),"}"),y){var d=o.divisor;e("if(",u,".divisor!==",d,"){",t.instancing,".vertexAttribDivisorANGLE(",[s,d],");",u,".divisor=",d,";}")}}function g(){e("if(",u,".buffer){",a,".disableVertexAttribArray(",s,");",u,".buffer=null;","}if(",Te.map((function(t,e){return u+"."+t+"!=="+c[e]})).join("||"),"){",a,".vertexAttrib4f(",s,",",c,");",Te.map((function(t,e){return u+"."+t+"="+c[e]+";"})).join(""),"}")}1===d?f():2===d?g():(e("if(",d,"===",1,"){"),f(),e("}else{"),g(),e("}"))}(t.link(n),function(t){switch(t){case Mr:case kr:case Rr:return 2;case _r:case Ir:case Or:return 3;case Ar:case Tr:case zr:return 4;default:return 1}}(n.info.type),a)}))}function V(t,e,n,o,i){for(var a,s=t.shared,u=s.gl,d=0;d<o.length;++d){var h,c=o[d],l=c.name,f=c.info.type,g=n.uniforms[l],p=t.link(c)+".location";if(g){if(!i(g))continue;if(Jr(g)){var v=g.value;if(N.command(null!=v,'missing uniform "'+l+'"',t.commandStr),f===Fr||f===jr){N.command("function"==typeof v&&(f===Fr&&("texture2d"===v._reglType||"framebuffer"===v._reglType)||f===jr&&("textureCube"===v._reglType||"framebufferCube"===v._reglType)),"invalid texture for uniform "+l,t.commandStr);var m=t.link(v._texture||v.color[0]._texture);e(u,".uniform1i(",p,",",m+".bind());"),e.exit(m,".unbind();")}else if(f===Cr||f===Lr||f===Pr){N.optional((function(){N.command(ft(v),"invalid matrix for uniform "+l,t.commandStr),N.command(f===Cr&&4===v.length||f===Lr&&9===v.length||f===Pr&&16===v.length,"invalid length for matrix uniform "+l,t.commandStr)}));var y=t.global.def("new Float32Array(["+Array.prototype.slice.call(v)+"])"),w=2;f===Lr?w=3:f===Pr&&(w=4),e(u,".uniformMatrix",w,"fv(",p,",false,",y,");")}else{switch(f){case Nr:N.commandType(v,"number","uniform "+l,t.commandStr),a="1f";break;case Mr:N.command(ft(v)&&2===v.length,"uniform "+l,t.commandStr),a="2f";break;case _r:N.command(ft(v)&&3===v.length,"uniform "+l,t.commandStr),a="3f";break;case Ar:N.command(ft(v)&&4===v.length,"uniform "+l,t.commandStr),a="4f";break;case Dr:N.commandType(v,"boolean","uniform "+l,t.commandStr),a="1i";break;case Sr:N.commandType(v,"number","uniform "+l,t.commandStr),a="1i";break;case Rr:case kr:N.command(ft(v)&&2===v.length,"uniform "+l,t.commandStr),a="2i";break;case Or:case Ir:N.command(ft(v)&&3===v.length,"uniform "+l,t.commandStr),a="3i";break;case zr:case Tr:N.command(ft(v)&&4===v.length,"uniform "+l,t.commandStr),a="4i"}e(u,".uniform",a,"(",p,",",ft(v)?Array.prototype.slice.call(v):v,");")}continue}h=g.append(t,e)}else{if(!i(rn))continue;h=e.def(s.uniforms,"[",r.id(l),"]")}f===Fr?(N(!Array.isArray(h),"must specify a scalar prop for textures"),e("if(",h,"&&",h,'._reglType==="framebuffer"){',h,"=",h,".color[0];","}")):f===jr&&(N(!Array.isArray(h),"must specify a scalar prop for cube maps"),e("if(",h,"&&",h,'._reglType==="framebufferCube"){',h,"=",h,".color[0];","}")),N.optional((function(){function r(r,n){t.assert(e,r,'bad data or missing for uniform "'+l+'".  '+n)}function n(t){N(!Array.isArray(h),"must not specify an array type for uniform"),r("typeof "+h+'==="'+t+'"',"invalid type, expected "+t)}function o(e,n){Array.isArray(h)?N(h.length===e,"must have length "+e):r(s.isArrayLike+"("+h+")&&"+h+".length==="+e,"invalid vector, should have length "+e,t.commandStr)}function i(e){N(!Array.isArray(h),"must not specify a value type"),r("typeof "+h+'==="function"&&'+h+'._reglType==="texture'+(3553===e?"2d":"Cube")+'"',"invalid texture type",t.commandStr)}switch(f){case Sr:n("number");break;case kr:o(2);break;case Ir:o(3);break;case Tr:o(4);break;case Nr:n("number");break;case Mr:o(2);break;case _r:o(3);break;case Ar:o(4);break;case Dr:n("boolean");break;case Rr:o(2);break;case Or:o(3);break;case zr:case Cr:o(4);break;case Lr:o(9);break;case Pr:o(16);break;case Fr:i(3553);break;case jr:i(34067)}}));var x=1;switch(f){case Fr:case jr:var E=e.def(h,"._texture");e(u,".uniform1i(",p,",",E,".bind());"),e.exit(E,".unbind();");continue;case Sr:case Dr:a="1i";break;case kr:case Rr:a="2i",x=2;break;case Ir:case Or:a="3i",x=3;break;case Tr:case zr:a="4i",x=4;break;case Nr:a="1f";break;case Mr:a="2f",x=2;break;case _r:a="3f",x=3;break;case Ar:a="4f",x=4;break;case Cr:a="Matrix2fv";break;case Lr:a="Matrix3fv";break;case Pr:a="Matrix4fv"}if(e(u,".uniform",a,"(",p,","),"M"===a.charAt(0)){var b=Math.pow(f-Cr+2,2),M=t.global.def("new Float32Array(",b,")");Array.isArray(h)?e("false,(",z(b,(function(t){return M+"["+t+"]="+h[t]})),",",M,")"):e("false,(Array.isArray(",h,")||",h," instanceof Float32Array)?",h,":(",z(b,(function(t){return M+"["+t+"]="+h+"["+t+"]"})),",",M,")")}else x>1?e(z(x,(function(t){return Array.isArray(h)?h[t]:h+"["+t+"]"}))):(N(!Array.isArray(h),"uniform value must not be an array"),e(h));e(");")}}function B(t,e,r,n){var o,i,a,s=t.shared,u=s.gl,d=s.draw,h=n.draw,c=(i=h.elements,a=e,i?((i.contextDep&&n.contextDynamic||i.propDep)&&(a=r),o=i.append(t,a)):o=a.def(d,".",ur),o&&a("if("+o+")"+u+".bindBuffer(34963,"+o+".buffer.buffer);"),o);function l(o){var i=h[o];return i?i.contextDep&&n.contextDynamic||i.propDep?i.append(t,r):i.append(t,e):e.def(d,".",o)}var f,g,p=l(dr),v=l(cr),m=function(){var o,i=h.count,a=e;return i?((i.contextDep&&n.contextDynamic||i.propDep)&&(a=r),o=i.append(t,a),N.optional((function(){i.MISSING&&t.assert(e,"false","missing vertex count"),i.DYNAMIC&&t.assert(a,o+">=0","missing vertex count")}))):(o=a.def(d,".",hr),N.optional((function(){t.assert(a,o+">=0","missing vertex count")}))),o}();if("number"==typeof m){if(0===m)return}else r("if(",m,"){"),r.exit("}");y&&(f=l(lr),g=t.instancing);var w=c+".type",x=h.elements&&Jr(h.elements);function E(){function t(){r(g,".drawElementsInstancedANGLE(",[p,m,w,v+"<<(("+w+"-5121)>>1)",f],");")}function e(){r(g,".drawArraysInstancedANGLE(",[p,v,m,f],");")}c?x?t():(r("if(",c,"){"),t(),r("}else{"),e(),r("}")):e()}function b(){function t(){r(u+".drawElements("+[p,m,w,v+"<<(("+w+"-5121)>>1)"]+");")}function e(){r(u+".drawArrays("+[p,v,m]+");")}c?x?t():(r("if(",c,"){"),t(),r("}else{"),e(),r("}")):e()}y&&("number"!=typeof f||f>=0)?"string"==typeof f?(r("if(",f,">0){"),E(),r("}else if(",f,"<0){"),b(),r("}")):E():b()}function q(t,e,r,n,o){var i=O(),a=i.proc("body",o);return N.optional((function(){i.commandStr=e.commandStr,i.command=i.link(e.commandStr)})),y&&(i.instancing=a.def(i.shared.extensions,".angle_instanced_arrays")),t(i,a,r,n),i.compile().body}function W(t,e,r,n){j(t,e),r.useVAO?r.drawVAO?e(t.shared.vao,".setVAO(",r.drawVAO.append(t,e),");"):e(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(e(t.shared.vao,".setVAO(null);"),U(t,e,r,n.attributes,(function(){return!0}))),V(t,e,r,n.uniforms,(function(){return!0})),B(t,e,e,r)}function H(t,e,r,n){function o(){return!0}t.batchId="a1",j(t,e),U(t,e,r,n.attributes,o),V(t,e,r,n.uniforms,o),B(t,e,e,r)}function $(t,e,r,n){j(t,e);var o=r.contextDep,i=e.def(),a=e.def();t.shared.props=a,t.batchId=i;var s=t.scope(),u=t.scope();function d(t){return t.contextDep&&o||t.propDep}function h(t){return!d(t)}if(e(s.entry,"for(",i,"=0;",i,"<","a1",";++",i,"){",a,"=","a0","[",i,"];",u,"}",s.exit),r.needsContext&&C(t,u,r.context),r.needsFramebuffer&&L(t,u,r.framebuffer),F(t,u,r.state,d),r.profile&&d(r.profile)&&G(t,u,r,!1,!0),n)r.useVAO?r.drawVAO?d(r.drawVAO)?u(t.shared.vao,".setVAO(",r.drawVAO.append(t,u),");"):s(t.shared.vao,".setVAO(",r.drawVAO.append(t,s),");"):s(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(s(t.shared.vao,".setVAO(null);"),U(t,s,r,n.attributes,h),U(t,u,r,n.attributes,d)),V(t,s,r,n.uniforms,h),V(t,u,r,n.uniforms,d),B(t,s,u,r);else{var c=t.global.def("{}"),l=r.shader.progVar.append(t,u),f=u.def(l,".id"),g=u.def(c,"[",f,"]");u(t.shared.gl,".useProgram(",l,".program);","if(!",g,"){",g,"=",c,"[",f,"]=",t.link((function(e){return q(H,t,r,e,2)})),"(",l,");}",g,".call(this,a0[",i,"],",i,");")}}function X(t,e,r){var n=e.static[r];if(n&&function(t){if("object"==typeof t&&!ft(t)){for(var e=Object.keys(t),r=0;r<e.length;++r)if(I.isDynamic(t[e[r]]))return!0;return!1}}(n)){var o=t.global,i=Object.keys(n),a=!1,s=!1,u=!1,d=t.global.def("{}");i.forEach((function(e){var r=n[e];if(I.isDynamic(r)){"function"==typeof r&&(r=n[e]=I.unbox(r));var i=en(r,null);a=a||i.thisDep,u=u||i.propDep,s=s||i.contextDep}else{switch(o(d,".",e,"="),typeof r){case"number":o(r);break;case"string":o('"',r,'"');break;case"object":Array.isArray(r)&&o("[",r.join(),"]");break;default:o(t.link(r))}o(";")}})),e.dynamic[r]=new I.DynamicVariable(4,{thisDep:a,contextDep:s,propDep:u,ref:d,append:function(t,e){i.forEach((function(r){var o=n[r];if(I.isDynamic(o)){var i=t.invoke(e,o);e(d,".",r,"=",i,";")}}))}}),delete e.static[r]}}return{next:E,current:x,procs:function(){var t=O(),e=t.proc("poll"),r=t.proc("refresh"),i=t.block();e(i),r(i);var a,s=t.shared,u=s.gl,d=s.next,h=s.current;i(h,".dirty=false;"),L(t,e),L(t,r,null,!0),y&&(a=t.link(y)),n.oes_vertex_array_object&&r(t.link(n.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var c=0;c<o.maxAttributes;++c){var l=r.def(s.attributes,"[",c,"]"),f=t.cond(l,".buffer");f.then(u,".enableVertexAttribArray(",c,");",u,".bindBuffer(",br,",",l,".buffer.buffer);",u,".vertexAttribPointer(",c,",",l,".size,",l,".type,",l,".normalized,",l,".stride,",l,".offset);").else(u,".disableVertexAttribArray(",c,");",u,".vertexAttrib4f(",c,",",l,".x,",l,".y,",l,".z,",l,".w);",l,".buffer=null;"),r(f),y&&r(a,".vertexAttribDivisorANGLE(",c,",",l,".divisor);")}return r(t.shared.vao,".currentVAO=null;",t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"),Object.keys(M).forEach((function(n){var o=M[n],a=i.def(d,".",n),s=t.block();s("if(",a,"){",u,".enable(",o,")}else{",u,".disable(",o,")}",h,".",n,"=",a,";"),r(s),e("if(",a,"!==",h,".",n,"){",s,"}")})),Object.keys(_).forEach((function(n){var o,a,s=_[n],c=x[n],l=t.block();if(l(u,".",s,"("),ft(c)){var f=c.length;o=t.global.def(d,".",n),a=t.global.def(h,".",n),l(z(f,(function(t){return o+"["+t+"]"})),");",z(f,(function(t){return a+"["+t+"]="+o+"["+t+"];"})).join("")),e("if(",z(f,(function(t){return o+"["+t+"]!=="+a+"["+t+"]"})).join("||"),"){",l,"}")}else o=i.def(d,".",n),a=i.def(h,".",n),l(o,");",h,".",n,"=",o,";"),e("if(",o,"!==",a,"){",l,"}");r(l)})),t.compile()}(),compile:function(t,s,d,l,f){var g=O();g.stats=g.link(f),Object.keys(s.static).forEach((function(t){X(g,s,t)})),Er.forEach((function(e){X(g,t,e)}));var p=function(t,e,s,d,l){var f=t.static,g=t.dynamic;N.optional((function(){var t=[ir,ar,sr,ur,dr,cr,hr,lr,or,fr].concat(b);function e(e){Object.keys(e).forEach((function(e){N.command(t.indexOf(e)>=0,'unknown parameter "'+e+'"',l.commandStr)}))}e(f),e(g)}));var p,w,x,E,M,_=function(t,e){var r=t.static;if("string"==typeof r[sr]&&"string"==typeof r[ar]){if(Object.keys(e.dynamic).length>0)return null;var n=e.static,o=Object.keys(n);if(o.length>0&&"number"==typeof n[o[0]]){for(var i=[],a=0;a<o.length;++a)N("number"==typeof n[o[a]],"must specify all vertex attribute locations when using vaos"),i.push([0|n[o[a]],o[a]]);return i}}return null}(t,e),S=function(t,e){var r=t.static,n=t.dynamic;if(ir in r){var o=r[ir];return o?(o=u.getFramebuffer(o),N.command(o,"invalid framebuffer object"),tn((function(t,e){var r=t.link(o),n=t.shared;e.set(n.framebuffer,".next",r);var i=n.context;return e.set(i,"."+vr,r+".width"),e.set(i,"."+mr,r+".height"),r}))):tn((function(t,e){var r=t.shared;e.set(r.framebuffer,".next","null");var n=r.context;return e.set(n,"."+vr,n+"."+wr),e.set(n,"."+mr,n+"."+xr),"null"}))}if(ir in n){var i=n[ir];return en(i,(function(t,e){var r=t.invoke(e,i),n=t.shared,o=n.framebuffer,a=e.def(o,".getFramebuffer(",r,")");N.optional((function(){t.assert(e,"!"+r+"||"+a,"invalid framebuffer object")})),e.set(o,".next",a);var s=n.context;return e.set(s,"."+vr,a+"?"+a+".width:"+s+"."+wr),e.set(s,"."+mr,a+"?"+a+".height:"+s+"."+xr),a}))}return null}(t),k=function(t,e,r){var n=t.static,o=t.dynamic;function i(t){if(t in n){var i=n[t];N.commandType(i,"object","invalid "+t,r.commandStr);var a,s,u=!0,d=0|i.x,h=0|i.y;return"width"in i?(a=0|i.width,N.command(a>=0,"invalid "+t,r.commandStr)):u=!1,"height"in i?(s=0|i.height,N.command(s>=0,"invalid "+t,r.commandStr)):u=!1,new Zr(!u&&e&&e.thisDep,!u&&e&&e.contextDep,!u&&e&&e.propDep,(function(t,e){var r=t.shared.context,n=a;"width"in i||(n=e.def(r,".",vr,"-",d));var o=s;return"height"in i||(o=e.def(r,".",mr,"-",h)),[d,h,n,o]}))}if(t in o){var c=o[t],l=en(c,(function(e,r){var n=e.invoke(r,c);N.optional((function(){e.assert(r,n+"&&typeof "+n+'==="object"',"invalid "+t)}));var o=e.shared.context,i=r.def(n,".x|0"),a=r.def(n,".y|0"),s=r.def('"width" in ',n,"?",n,".width|0:","(",o,".",vr,"-",i,")"),u=r.def('"height" in ',n,"?",n,".height|0:","(",o,".",mr,"-",a,")");return N.optional((function(){e.assert(r,s+">=0&&"+u+">=0","invalid "+t)})),[i,a,s,u]}));return e&&(l.thisDep=l.thisDep||e.thisDep,l.contextDep=l.contextDep||e.contextDep,l.propDep=l.propDep||e.propDep),l}return e?new Zr(e.thisDep,e.contextDep,e.propDep,(function(t,e){var r=t.shared.context;return[0,0,e.def(r,".",vr),e.def(r,".",mr)]})):null}var a=i(nr);if(a){var s=a;a=new Zr(a.thisDep,a.contextDep,a.propDep,(function(t,e){var r=s.append(t,e),n=t.shared.context;return e.set(n,".viewportWidth",r[2]),e.set(n,".viewportHeight",r[3]),r}))}return{viewport:a,scissor_box:i(rr)}}(t,S,l),I=function(t,e){var r=t.static,n=t.dynamic,o=function(){if(ur in r){var t=r[ur];Kr(t)?t=a.getElements(a.create(t,!0)):t&&(t=a.getElements(t),N.command(t,"invalid elements",e.commandStr));var o=tn((function(e,r){if(t){var n=e.link(t);return e.ELEMENTS=n,n}return e.ELEMENTS=null,null}));return o.value=t,o}if(ur in n){var i=n[ur];return en(i,(function(t,e){var r=t.shared,n=r.isBufferArgs,o=r.elements,a=t.invoke(e,i),s=e.def("null"),u=e.def(n,"(",a,")"),d=t.cond(u).then(s,"=",o,".createStream(",a,");").else(s,"=",o,".getElements(",a,");");return N.optional((function(){t.assert(d.else,"!"+a+"||"+s,"invalid elements")})),e.entry(d),e.exit(t.cond(u).then(o,".destroyStream(",s,");")),t.ELEMENTS=s,s}))}return null}();function i(t,i){if(t in r){var a=0|r[t];return N.command(!i||a>=0,"invalid "+t,e.commandStr),tn((function(t,e){return i&&(t.OFFSET=a),a}))}if(t in n){var s=n[t];return en(s,(function(e,r){var n=e.invoke(r,s);return i&&(e.OFFSET=n,N.optional((function(){e.assert(r,n+">=0","invalid "+t)}))),n}))}return i&&o?tn((function(t,e){return t.OFFSET="0",0})):null}var s=i(cr,!0);return{elements:o,primitive:function(){if(dr in r){var t=r[dr];return N.commandParameter(t,it,"invalid primitve",e.commandStr),tn((function(e,r){return it[t]}))}if(dr in n){var i=n[dr];return en(i,(function(t,e){var r=t.constants.primTypes,n=t.invoke(e,i);return N.optional((function(){t.assert(e,n+" in "+r,"invalid primitive, must be one of "+Object.keys(it))})),e.def(r,"[",n,"]")}))}return o?Jr(o)?o.value?tn((function(t,e){return e.def(t.ELEMENTS,".primType")})):tn((function(){return 4})):new Zr(o.thisDep,o.contextDep,o.propDep,(function(t,e){var r=t.ELEMENTS;return e.def(r,"?",r,".primType:",4)})):null}(),count:function(){if(hr in r){var t=0|r[hr];return N.command("number"==typeof t&&t>=0,"invalid vertex count",e.commandStr),tn((function(){return t}))}if(hr in n){var i=n[hr];return en(i,(function(t,e){var r=t.invoke(e,i);return N.optional((function(){t.assert(e,"typeof "+r+'==="number"&&'+r+">=0&&"+r+"===("+r+"|0)","invalid vertex count")})),r}))}if(o){if(Jr(o)){if(o)return s?new Zr(s.thisDep,s.contextDep,s.propDep,(function(t,e){var r=e.def(t.ELEMENTS,".vertCount-",t.OFFSET);return N.optional((function(){t.assert(e,r+">=0","invalid vertex offset/element buffer too small")})),r})):tn((function(t,e){return e.def(t.ELEMENTS,".vertCount")}));var a=tn((function(){return-1}));return N.optional((function(){a.MISSING=!0})),a}var u=new Zr(o.thisDep||s.thisDep,o.contextDep||s.contextDep,o.propDep||s.propDep,(function(t,e){var r=t.ELEMENTS;return t.OFFSET?e.def(r,"?",r,".vertCount-",t.OFFSET,":-1"):e.def(r,"?",r,".vertCount:-1")}));return N.optional((function(){u.DYNAMIC=!0})),u}return null}(),instances:i(lr,!1),offset:s}}(t,l),T=(w=l,x=(p=t).static,E=p.dynamic,M={},b.forEach((function(t){var e=A(t);function r(r,n){if(t in x){var o=r(x[t]);M[e]=tn((function(){return o}))}else if(t in E){var i=E[t];M[e]=en(i,(function(t,e){return n(t,e,t.invoke(e,i))}))}}switch(t){case Ue:case Re:case De:case Ke:case Le:case er:case We:case $e:case Xe:case je:return r((function(e){return N.commandType(e,"boolean",t,w.commandStr),e}),(function(e,r,n){return N.optional((function(){e.assert(r,"typeof "+n+'==="boolean"',"invalid flag "+t,e.commandStr)})),n}));case Pe:return r((function(e){return N.commandParameter(e,Hr,"invalid "+t,w.commandStr),Hr[e]}),(function(e,r,n){var o=e.constants.compareFuncs;return N.optional((function(){e.assert(r,n+" in "+o,"invalid "+t+", must be one of "+Object.keys(Hr))})),r.def(o,"[",n,"]")}));case Fe:return r((function(t){return N.command(ft(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&t[0]<=t[1],"depth range is 2d array",w.commandStr),t}),(function(t,e,r){return N.optional((function(){t.assert(e,t.shared.isArrayLike+"("+r+")&&"+r+".length===2&&typeof "+r+'[0]==="number"&&typeof '+r+'[1]==="number"&&'+r+"[0]<="+r+"[1]","depth range must be a 2d array")})),[e.def("+",r,"[0]"),e.def("+",r,"[1]")]}));case Ce:return r((function(t){N.commandType(t,"object","blend.func",w.commandStr);var r="srcRGB"in t?t.srcRGB:t.src,n="srcAlpha"in t?t.srcAlpha:t.src,o="dstRGB"in t?t.dstRGB:t.dst,i="dstAlpha"in t?t.dstAlpha:t.dst;return N.commandParameter(r,qr,e+".srcRGB",w.commandStr),N.commandParameter(n,qr,e+".srcAlpha",w.commandStr),N.commandParameter(o,qr,e+".dstRGB",w.commandStr),N.commandParameter(i,qr,e+".dstAlpha",w.commandStr),N.command(-1===Wr.indexOf(r+", "+o),"unallowed blending combination (srcRGB, dstRGB) = ("+r+", "+o+")",w.commandStr),[qr[r],qr[o],qr[n],qr[i]]}),(function(e,r,n){var o=e.constants.blendFuncs;function i(i,a){var s=r.def('"',i,a,'" in ',n,"?",n,".",i,a,":",n,".",i);return N.optional((function(){e.assert(r,s+" in "+o,"invalid "+t+"."+i+a+", must be one of "+Object.keys(qr))})),s}N.optional((function(){e.assert(r,n+"&&typeof "+n+'==="object"',"invalid blend func, must be an object")}));var a=i("src","RGB"),s=i("dst","RGB");N.optional((function(){var t=e.constants.invalidBlendCombinations;e.assert(r,t+".indexOf("+a+'+", "+'+s+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")}));var u=r.def(o,"[",a,"]"),d=r.def(o,"[",i("src","Alpha"),"]");return[u,r.def(o,"[",s,"]"),d,r.def(o,"[",i("dst","Alpha"),"]")]}));case ze:return r((function(e){return"string"==typeof e?(N.commandParameter(e,m,"invalid "+t,w.commandStr),[m[e],m[e]]):"object"==typeof e?(N.commandParameter(e.rgb,m,t+".rgb",w.commandStr),N.commandParameter(e.alpha,m,t+".alpha",w.commandStr),[m[e.rgb],m[e.alpha]]):void N.commandRaise("invalid blend.equation",w.commandStr)}),(function(e,r,n){var o=e.constants.blendEquations,i=r.def(),a=r.def(),s=e.cond("typeof ",n,'==="string"');return N.optional((function(){function r(t,r,n){e.assert(t,n+" in "+o,"invalid "+r+", must be one of "+Object.keys(m))}r(s.then,t,n),e.assert(s.else,n+"&&typeof "+n+'==="object"',"invalid "+t),r(s.else,t+".rgb",n+".rgb"),r(s.else,t+".alpha",n+".alpha")})),s.then(i,"=",a,"=",o,"[",n,"];"),s.else(i,"=",o,"[",n,".rgb];",a,"=",o,"[",n,".alpha];"),r(s),[i,a]}));case Oe:return r((function(t){return N.command(ft(t)&&4===t.length,"blend.color must be a 4d array",w.commandStr),z(4,(function(e){return+t[e]}))}),(function(t,e,r){return N.optional((function(){t.assert(e,t.shared.isArrayLike+"("+r+")&&"+r+".length===4","blend.color must be a 4d array")})),z(4,(function(t){return e.def("+",r,"[",t,"]")}))}));case Qe:return r((function(t){return N.commandType(t,"number",e,w.commandStr),0|t}),(function(t,e,r){return N.optional((function(){t.assert(e,"typeof "+r+'==="number"',"invalid stencil.mask")})),e.def(r,"|0")}));case Ze:return r((function(r){N.commandType(r,"object",e,w.commandStr);var n=r.cmp||"keep",o=r.ref||0,i="mask"in r?r.mask:-1;return N.commandParameter(n,Hr,t+".cmp",w.commandStr),N.commandType(o,"number",t+".ref",w.commandStr),N.commandType(i,"number",t+".mask",w.commandStr),[Hr[n],o,i]}),(function(t,e,r){var n=t.constants.compareFuncs;return N.optional((function(){function o(){t.assert(e,Array.prototype.join.call(arguments,""),"invalid stencil.func")}o(r+"&&typeof ",r,'==="object"'),o('!("cmp" in ',r,")||(",r,".cmp in ",n,")")})),[e.def('"cmp" in ',r,"?",n,"[",r,".cmp]",":",Br),e.def(r,".ref|0"),e.def('"mask" in ',r,"?",r,".mask|0:-1")]}));case Je:case tr:return r((function(r){N.commandType(r,"object",e,w.commandStr);var n=r.fail||"keep",o=r.zfail||"keep",i=r.zpass||"keep";return N.commandParameter(n,$r,t+".fail",w.commandStr),N.commandParameter(o,$r,t+".zfail",w.commandStr),N.commandParameter(i,$r,t+".zpass",w.commandStr),[t===tr?Ur:Gr,$r[n],$r[o],$r[i]]}),(function(e,r,n){var o=e.constants.stencilOps;function i(i){return N.optional((function(){e.assert(r,'!("'+i+'" in '+n+")||("+n+"."+i+" in "+o+")","invalid "+t+"."+i+", must be one of "+Object.keys($r))})),r.def('"',i,'" in ',n,"?",o,"[",n,".",i,"]:",Br)}return N.optional((function(){e.assert(r,n+"&&typeof "+n+'==="object"',"invalid "+t)})),[t===tr?Ur:Gr,i("fail"),i("zfail"),i("zpass")]}));case He:return r((function(t){N.commandType(t,"object",e,w.commandStr);var r=0|t.factor,n=0|t.units;return N.commandType(r,"number",e+".factor",w.commandStr),N.commandType(n,"number",e+".units",w.commandStr),[r,n]}),(function(e,r,n){return N.optional((function(){e.assert(r,n+"&&typeof "+n+'==="object"',"invalid "+t)})),[r.def(n,".factor|0"),r.def(n,".units|0")]}));case Ve:return r((function(t){var r=0;return"front"===t?r=Gr:"back"===t&&(r=Ur),N.command(!!r,e,w.commandStr),r}),(function(t,e,r){return N.optional((function(){t.assert(e,r+'==="front"||'+r+'==="back"',"invalid cull.face")})),e.def(r,'==="front"?',Gr,":",Ur)}));case qe:return r((function(t){return N.command("number"==typeof t&&t>=o.lineWidthDims[0]&&t<=o.lineWidthDims[1],"invalid line width, must be a positive number between "+o.lineWidthDims[0]+" and "+o.lineWidthDims[1],w.commandStr),t}),(function(t,e,r){return N.optional((function(){t.assert(e,"typeof "+r+'==="number"&&'+r+">="+o.lineWidthDims[0]+"&&"+r+"<="+o.lineWidthDims[1],"invalid line width")})),r}));case Be:return r((function(t){return N.commandParameter(t,Yr,e,w.commandStr),Yr[t]}),(function(t,e,r){return N.optional((function(){t.assert(e,r+'==="cw"||'+r+'==="ccw"',"invalid frontFace, must be one of cw,ccw")})),e.def(r+'==="cw"?2304:'+Vr)}));case Ge:return r((function(t){return N.command(ft(t)&&4===t.length,"color.mask must be length 4 array",w.commandStr),t.map((function(t){return!!t}))}),(function(t,e,r){return N.optional((function(){t.assert(e,t.shared.isArrayLike+"("+r+")&&"+r+".length===4","invalid color.mask")})),z(4,(function(t){return"!!"+r+"["+t+"]"}))}));case Ye:return r((function(t){N.command("object"==typeof t&&t,e,w.commandStr);var r="value"in t?t.value:1,n=!!t.invert;return N.command("number"==typeof r&&r>=0&&r<=1,"sample.coverage.value must be a number between 0 and 1",w.commandStr),[r,n]}),(function(t,e,r){return N.optional((function(){t.assert(e,r+"&&typeof "+r+'==="object"',"invalid sample.coverage")})),[e.def('"value" in ',r,"?+",r,".value:1"),e.def("!!",r,".invert")]}))}})),M),D=function(t,e,n){var o=t.static,i=t.dynamic;function a(t){if(t in o){var e=r.id(o[t]);N.optional((function(){c.shader(Xr[t],e,N.guessCommand())}));var n=tn((function(){return e}));return n.id=e,n}if(t in i){var a=i[t];return en(a,(function(e,r){var n=e.invoke(r,a),o=r.def(e.shared.strings,".id(",n,")");return N.optional((function(){r(e.shared.shader,".shader(",Xr[t],",",o,",",e.command,");")})),o}))}return null}var s,u=a(sr),d=a(ar),h=null;return Jr(u)&&Jr(d)?(h=c.program(d.id,u.id,null,n),s=tn((function(t,e){return t.link(h)}))):s=new Zr(u&&u.thisDep||d&&d.thisDep,u&&u.contextDep||d&&d.contextDep,u&&u.propDep||d&&d.propDep,(function(t,e){var r,n=t.shared.shader;r=u?u.append(t,e):e.def(n,".",sr);var o=n+".program("+(d?d.append(t,e):e.def(n,".",ar))+","+r;return N.optional((function(){o+=","+t.command})),e.def(o+")")})),{frag:u,vert:d,progVar:s,program:h}}(t,0,_);function R(t){var e=k[t];e&&(T[t]=e)}R(nr),R(A(rr));var O=Object.keys(T).length>0,C={framebuffer:S,draw:I,shader:D,state:T,dirty:O,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(C.profile=function(t){var e,r=t.static,n=t.dynamic;if(or in r){var o=!!r[or];(e=tn((function(t,e){return o}))).enable=o}else if(or in n){var i=n[or];e=en(i,(function(t,e){return t.invoke(e,i)}))}return e}(t),C.uniforms=function(t,e){var r=t.static,n=t.dynamic,o={};return Object.keys(r).forEach((function(t){var n,i=r[t];if("number"==typeof i||"boolean"==typeof i)n=tn((function(){return i}));else if("function"==typeof i){var a=i._reglType;"texture2d"===a||"textureCube"===a?n=tn((function(t){return t.link(i)})):"framebuffer"===a||"framebufferCube"===a?(N.command(i.color.length>0,'missing color attachment for framebuffer sent to uniform "'+t+'"',e.commandStr),n=tn((function(t){return t.link(i.color[0])}))):N.commandRaise('invalid data for uniform "'+t+'"',e.commandStr)}else ft(i)?n=tn((function(e){return e.global.def("[",z(i.length,(function(r){return N.command("number"==typeof i[r]||"boolean"==typeof i[r],"invalid uniform "+t,e.commandStr),i[r]})),"]")})):N.commandRaise('invalid or missing data for uniform "'+t+'"',e.commandStr);n.value=i,o[t]=n})),Object.keys(n).forEach((function(t){var e=n[t];o[t]=en(e,(function(t,r){return t.invoke(r,e)}))})),o}(s,l),C.drawVAO=C.scopeVAO=function(t,e){var r=t.static,n=t.dynamic;if(fr in r){var o=r[fr];return null!==o&&null===h.getVAO(o)&&(o=h.createVAO(o)),tn((function(t){return t.link(h.getVAO(o))}))}if(fr in n){var i=n[fr];return en(i,(function(t,e){var r=t.invoke(e,i);return e.def(t.shared.vao+".getVAO("+r+")")}))}return null}(t),!C.drawVAO&&D.program&&!_&&n.angle_instanced_arrays){var L=!0,P=D.program.attributes.map((function(t){var r=e.static[t];return L=L&&!!r,r}));if(L&&P.length>0){var F=h.getVAO(h.createVAO(P));C.drawVAO=new Zr(null,null,null,(function(t,e){return t.link(F)})),C.useVAO=!0}}return _?C.useVAO=!0:C.attributes=function(t,e){var n=t.static,o=t.dynamic,a={};return Object.keys(n).forEach((function(t){var o=n[t],s=r.id(t),u=new v;if(Kr(o))u.state=1,u.buffer=i.getBuffer(i.create(o,br,!1,!0)),u.type=0;else{var d=i.getBuffer(o);if(d)u.state=1,u.buffer=d,u.type=0;else if(N.command("object"==typeof o&&o,"invalid data for attribute "+t,e.commandStr),"constant"in o){var h=o.constant;u.buffer="null",u.state=2,"number"==typeof h?u.x=h:(N.command(ft(h)&&h.length>0&&h.length<=4,"invalid constant for attribute "+t,e.commandStr),Te.forEach((function(t,e){e<h.length&&(u[t]=h[e])})))}else{d=Kr(o.buffer)?i.getBuffer(i.create(o.buffer,br,!1,!0)):i.getBuffer(o.buffer),N.command(!!d,'missing buffer for attribute "'+t+'"',e.commandStr);var c=0|o.offset;N.command(c>=0,'invalid offset for attribute "'+t+'"',e.commandStr);var l=0|o.stride;N.command(l>=0&&l<256,'invalid stride for attribute "'+t+'", must be integer betweeen [0, 255]',e.commandStr);var f=0|o.size;N.command(!("size"in o)||f>0&&f<=4,'invalid size for attribute "'+t+'", must be 1,2,3,4',e.commandStr);var g=!!o.normalized,p=0;"type"in o&&(N.commandParameter(o.type,Y,"invalid type for attribute "+t,e.commandStr),p=Y[o.type]);var m=0|o.divisor;"divisor"in o&&(N.command(0===m||y,'cannot specify divisor for attribute "'+t+'", instancing not supported',e.commandStr),N.command(m>=0,'invalid divisor for attribute "'+t+'"',e.commandStr)),N.optional((function(){var r=e.commandStr,n=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(o).forEach((function(e){N.command(n.indexOf(e)>=0,'unknown parameter "'+e+'" for attribute pointer "'+t+'" (valid parameters are '+n+")",r)}))})),u.buffer=d,u.state=1,u.size=f,u.normalized=g,u.type=p||d.dtype,u.offset=c,u.stride=l,u.divisor=m}}a[t]=tn((function(t,e){var r=t.attribCache;if(s in r)return r[s];var n={isStream:!1};return Object.keys(u).forEach((function(t){n[t]=u[t]})),u.buffer&&(n.buffer=t.link(u.buffer),n.type=n.type||n.buffer+".dtype"),r[s]=n,n}))})),Object.keys(o).forEach((function(t){var e=o[t];a[t]=en(e,(function(r,n){var o=r.invoke(n,e),i=r.shared,a=r.constants,s=i.isBufferArgs,u=i.buffer;N.optional((function(){r.assert(n,o+"&&(typeof "+o+'==="object"||typeof '+o+'==="function")&&('+s+"("+o+")||"+u+".getBuffer("+o+")||"+u+".getBuffer("+o+".buffer)||"+s+"("+o+'.buffer)||("constant" in '+o+"&&(typeof "+o+'.constant==="number"||'+i.isArrayLike+"("+o+".constant))))",'invalid dynamic attribute "'+t+'"')}));var d={isStream:n.def(!1)},h=new v;h.state=1,Object.keys(h).forEach((function(t){d[t]=n.def(""+h[t])}));var c=d.buffer,l=d.type;function f(t){n(d[t],"=",o,".",t,"|0;")}return n("if(",s,"(",o,")){",d.isStream,"=true;",c,"=",u,".createStream(",br,",",o,");",l,"=",c,".dtype;","}else{",c,"=",u,".getBuffer(",o,");","if(",c,"){",l,"=",c,".dtype;",'}else if("constant" in ',o,"){",d.state,"=",2,";","if(typeof "+o+'.constant === "number"){',d[Te[0]],"=",o,".constant;",Te.slice(1).map((function(t){return d[t]})).join("="),"=0;","}else{",Te.map((function(t,e){return d[t]+"="+o+".constant.length>"+e+"?"+o+".constant["+e+"]:0;"})).join(""),"}}else{","if(",s,"(",o,".buffer)){",c,"=",u,".createStream(",br,",",o,".buffer);","}else{",c,"=",u,".getBuffer(",o,".buffer);","}",l,'="type" in ',o,"?",a.glTypes,"[",o,".type]:",c,".dtype;",d.normalized,"=!!",o,".normalized;"),f("size"),f("offset"),f("stride"),f("divisor"),n("}}"),n.exit("if(",d.isStream,"){",u,".destroyStream(",c,");","}"),d}))})),a}(e,l),C.context=function(t){var e=t.static,r=t.dynamic,n={};return Object.keys(e).forEach((function(t){var r=e[t];n[t]=tn((function(t,e){return"number"==typeof r||"boolean"==typeof r?""+r:t.link(r)}))})),Object.keys(r).forEach((function(t){var e=r[t];n[t]=en(e,(function(t,r){return t.invoke(r,e)}))})),n}(d),C}(t,s,d,l,g);return function(t,e){var r=t.proc("draw",1);j(t,r),C(t,r,e.context),L(t,r,e.framebuffer),P(t,r,e),F(t,r,e.state),G(t,r,e,!1,!0);var n=e.shader.progVar.append(t,r);if(r(t.shared.gl,".useProgram(",n,".program);"),e.shader.program)W(t,r,e,e.shader.program);else{r(t.shared.vao,".setVAO(null);");var o=t.global.def("{}"),i=r.def(n,".id"),a=r.def(o,"[",i,"]");r(t.cond(a).then(a,".call(this,a0);").else(a,"=",o,"[",i,"]=",t.link((function(r){return q(W,t,e,r,1)})),"(",n,");",a,".call(this,a0);"))}Object.keys(e.state).length>0&&r(t.shared.current,".dirty=true;")}(g,p),function(t,e){var n=t.proc("scope",3);t.batchId="a2";var o=t.shared,i=o.current;function a(r){var i=e.shader[r];i&&n.set(o.shader,"."+r,i.append(t,n))}C(t,n,e.context),e.framebuffer&&e.framebuffer.append(t,n),Qr(Object.keys(e.state)).forEach((function(r){var i=e.state[r].append(t,n);ft(i)?i.forEach((function(e,o){n.set(t.next[r],"["+o+"]",e)})):n.set(o.next,"."+r,i)})),G(t,n,e,!0,!0),[ur,cr,hr,lr,dr].forEach((function(r){var i=e.draw[r];i&&n.set(o.draw,"."+r,""+i.append(t,n))})),Object.keys(e.uniforms).forEach((function(i){var a=e.uniforms[i].append(t,n);Array.isArray(a)&&(a="["+a.join()+"]"),n.set(o.uniforms,"["+r.id(i)+"]",a)})),Object.keys(e.attributes).forEach((function(r){var o=e.attributes[r].append(t,n),i=t.scopeAttrib(r);Object.keys(new v).forEach((function(t){n.set(i,"."+t,o[t])}))})),e.scopeVAO&&n.set(o.vao,".targetVAO",e.scopeVAO.append(t,n)),a(ar),a(sr),Object.keys(e.state).length>0&&(n(i,".dirty=true;"),n.exit(i,".dirty=true;")),n("a1(",t.shared.context,",a0,",t.batchId,");")}(g,p),function(t,e){var r=t.proc("batch",2);t.batchId="0",j(t,r);var n=!1,o=!0;Object.keys(e.context).forEach((function(t){n=n||e.context[t].propDep})),n||(C(t,r,e.context),o=!1);var i=e.framebuffer,a=!1;function s(t){return t.contextDep&&n||t.propDep}i?(i.propDep?n=a=!0:i.contextDep&&n&&(a=!0),a||L(t,r,i)):L(t,r,null),e.state.viewport&&e.state.viewport.propDep&&(n=!0),P(t,r,e),F(t,r,e.state,(function(t){return!s(t)})),e.profile&&s(e.profile)||G(t,r,e,!1,"a1"),e.contextDep=n,e.needsContext=o,e.needsFramebuffer=a;var u=e.shader.progVar;if(u.contextDep&&n||u.propDep)$(t,r,e,null);else{var d=u.append(t,r);if(r(t.shared.gl,".useProgram(",d,".program);"),e.shader.program)$(t,r,e,e.shader.program);else{r(t.shared.vao,".setVAO(null);");var h=t.global.def("{}"),c=r.def(d,".id"),l=r.def(h,"[",c,"]");r(t.cond(l).then(l,".call(this,a0,a1);").else(l,"=",h,"[",c,"]=",t.link((function(r){return q($,t,e,r,2)})),"(",d,");",l,".call(this,a0,a1);"))}}Object.keys(e.state).length>0&&r(t.shared.current,".dirty=true;")}(g,p),e(g.compile(),{destroy:function(){p.shader.program.destroy()}})}}}var on="webglcontextlost",an="webglcontextrestored";function sn(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return r;return-1}return function(r){var n=function(t){var r,n,o,i,a,s,u=t||{},d={},h=[],c=[],l="undefined"==typeof window?1:window.devicePixelRatio,f=!1,g=function(t){t&&N.raise(t)},p=function(){};if("string"==typeof u?(N("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),r=document.querySelector(u),N(r,"invalid query string for element")):"object"==typeof u?"string"==typeof(a=u).nodeName&&"function"==typeof a.appendChild&&"function"==typeof a.getBoundingClientRect?r=u:"function"==typeof(s=u).drawArrays||"function"==typeof s.drawElements?o=(i=u).canvas:(N.constructor(u),"gl"in u?i=u.gl:"canvas"in u?o=O(u.canvas):"container"in u&&(n=O(u.container)),"attributes"in u&&(d=u.attributes,N.type(d,"object","invalid context attributes")),"extensions"in u&&(h=R(u.extensions)),"optionalExtensions"in u&&(c=R(u.optionalExtensions)),"onDone"in u&&(N.type(u.onDone,"function","invalid or missing onDone callback"),g=u.onDone),"profile"in u&&(f=!!u.profile),"pixelRatio"in u&&(l=+u.pixelRatio,N(l>0,"invalid pixel ratio"))):N.raise("invalid arguments to regl"),r&&("canvas"===r.nodeName.toLowerCase()?o=r:n=r),!i){if(!o){N("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var v=function(t,r,n){var o,i=document.createElement("canvas");function a(){var r=window.innerWidth,o=window.innerHeight;if(t!==document.body){var a=t.getBoundingClientRect();r=a.right-a.left,o=a.bottom-a.top}i.width=n*r,i.height=n*o,e(i.style,{width:r+"px",height:o+"px"})}return e(i.style,{border:0,margin:0,padding:0,top:0,left:0}),t.appendChild(i),t===document.body&&(i.style.position="absolute",e(t.style,{margin:0,padding:0})),t!==document.body&&"function"==typeof ResizeObserver?(o=new ResizeObserver((function(){setTimeout(a)}))).observe(t):window.addEventListener("resize",a,!1),a(),{canvas:i,onDestroy:function(){o?o.disconnect():window.removeEventListener("resize",a),t.removeChild(i)}}}(n||document.body,0,l);if(!v)return null;o=v.canvas,p=v.onDestroy}void 0===d.premultipliedAlpha&&(d.premultipliedAlpha=!0),i=function(t,e){function r(r){try{return t.getContext(r,e)}catch(n){return null}}return r("webgl")||r("experimental-webgl")||r("webgl-experimental")}(o,d)}return i?{gl:i,canvas:o,container:n,extensions:h,optionalExtensions:c,pixelRatio:l,profile:f,onDone:g,onDestroy:p}:(p(),g("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}(r);if(!n)return null;var o=n.gl,i=o.getContextAttributes(),a=o.isContextLost(),s=function(t,e){var r={};function n(e){N.type(e,"string","extension name must be string");var n,o=e.toLowerCase();try{n=r[o]=t.getExtension(o)}catch(i){}return!!n}for(var o=0;o<e.extensions.length;++o){var i=e.extensions[o];if(!n(i))return e.onDestroy(),e.onDone('"'+i+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return e.optionalExtensions.forEach(n),{extensions:r,restore:function(){Object.keys(r).forEach((function(t){if(r[t]&&!n(t))throw new Error("(regl): error restoring extension "+t)}))}}}(o,n);if(!s)return null;var u,d,h=(u={"":0},d=[""],{id:function(t){var e=u[t];return e||(e=u[t]=d.length,d.push(t),e)},str:function(t){return d[t]}}),c={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},l=s.extensions,f=function(t,e){if(!e.ext_disjoint_timer_query)return null;var r=[];function n(t){r.push(t)}var o=[];function i(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var a=[];function s(t){a.push(t)}var u=[];function d(t,e,r){var n=a.pop()||new i;n.startQueryIndex=t,n.endQueryIndex=e,n.sum=0,n.stats=r,u.push(n)}var h=[],c=[];return{beginQuery:function(t){var n=r.pop()||e.ext_disjoint_timer_query.createQueryEXT();e.ext_disjoint_timer_query.beginQueryEXT(35007,n),o.push(n),d(o.length-1,o.length,t)},endQuery:function(){e.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:d,update:function(){var t,r,i=o.length;if(0!==i){c.length=Math.max(c.length,i+1),h.length=Math.max(h.length,i+1),h[0]=0,c[0]=0;var a=0;for(t=0,r=0;r<o.length;++r){var d=o[r];e.ext_disjoint_timer_query.getQueryObjectEXT(d,34919)?(a+=e.ext_disjoint_timer_query.getQueryObjectEXT(d,34918),n(d)):o[t++]=d,h[r+1]=a,c[r+1]=t}for(o.length=t,t=0,r=0;r<u.length;++r){var l=u[r],f=l.startQueryIndex,g=l.endQueryIndex;l.sum+=h[g]-h[f];var p=c[f],v=c[g];v===p?(l.stats.gpuTime+=l.sum/1e6,s(l)):(l.startQueryIndex=p,l.endQueryIndex=v,u[t++]=l)}u.length=t}},getNumPendingQueries:function(){return o.length},clear:function(){r.push.apply(r,o);for(var t=0;t<r.length;t++)e.ext_disjoint_timer_query.deleteQueryEXT(r[t]);o.length=0,r.length=0},restore:function(){o.length=0,r.length=0}}}(0,l),g=D(),p=o.drawingBufferWidth,v=o.drawingBufferHeight,m={tick:0,time:0,viewportWidth:p,viewportHeight:v,framebufferWidth:p,framebufferHeight:v,drawingBufferWidth:p,drawingBufferHeight:v,pixelRatio:n.pixelRatio},y=function(t,e){var r=1;e.ext_texture_filter_anisotropic&&(r=t.getParameter(34047));var n=1,o=1;e.webgl_draw_buffers&&(n=t.getParameter(34852),o=t.getParameter(36063));var i=!!e.oes_texture_float;if(i){var a=t.createTexture();t.bindTexture(F,a),t.texImage2D(F,0,j,1,1,0,j,G,null);var s=t.createFramebuffer();if(t.bindFramebuffer(U,s),t.framebufferTexture2D(U,36064,F,a,0),t.bindTexture(F,null),36053!==t.checkFramebufferStatus(U))i=!1;else{t.viewport(0,0,1,1),t.clearColor(1,0,0,1),t.clear(16384);var u=P.allocType(G,4);t.readPixels(0,0,1,1,j,G,u),t.getError()?i=!1:(t.deleteFramebuffer(s),t.deleteTexture(a),i=1===u[0]),P.freeType(u)}}var d=!0;if("undefined"==typeof navigator||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var h=t.createTexture(),c=P.allocType(5121,36);t.activeTexture(33984),t.bindTexture(34067,h),t.texImage2D(34069,0,j,3,3,0,j,5121,c),P.freeType(c),t.bindTexture(34067,null),t.deleteTexture(h),d=!t.getError()}return{colorBits:[t.getParameter(3410),t.getParameter(3411),t.getParameter(3412),t.getParameter(3413)],depthBits:t.getParameter(3414),stencilBits:t.getParameter(3415),subpixelBits:t.getParameter(3408),extensions:Object.keys(e).filter((function(t){return!!e[t]})),maxAnisotropic:r,maxDrawbuffers:n,maxColorAttachments:o,pointSizeDims:t.getParameter(33901),lineWidthDims:t.getParameter(33902),maxViewportDims:t.getParameter(3386),maxCombinedTextureUnits:t.getParameter(35661),maxCubeMapSize:t.getParameter(34076),maxRenderbufferSize:t.getParameter(34024),maxTextureUnits:t.getParameter(34930),maxTextureSize:t.getParameter(3379),maxAttributes:t.getParameter(34921),maxVertexUniforms:t.getParameter(36347),maxVertexTextureUnits:t.getParameter(35660),maxVaryingVectors:t.getParameter(36348),maxFragmentUniforms:t.getParameter(36349),glsl:t.getParameter(35724),renderer:t.getParameter(7937),vendor:t.getParameter(7936),version:t.getParameter(7938),readFloat:i,npotTextureCube:d}}(o,l),w=function(e,r,n,o){var i=0,a={};function s(t){this.id=i++,this.buffer=e.createBuffer(),this.type=t,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=J,this.persistentData=null,n.profile&&(this.stats={size:0})}s.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},s.prototype.destroy=function(){c(this)};var u=[];function d(t,r,n){t.byteLength=r.byteLength,e.bufferData(t.type,r,n)}function h(e,r,n,o,i,a){var s,u;if(e.usage=n,Array.isArray(r)){if(e.dtype=o||tt,r.length>0)if(Array.isArray(r[0])){s=Z(r);for(var h=1,c=1;c<s.length;++c)h*=s[c];e.dimension=h,d(e,u=Q(r,s,e.dtype),n),a?e.persistentData=u:P.freeType(u)}else if("number"==typeof r[0]){e.dimension=i;var l=P.allocType(e.dtype,r.length);nt(l,r),d(e,l,n),a?e.persistentData=l:P.freeType(l)}else t(r[0])?(e.dimension=r[0].length,e.dtype=o||rt(r[0])||tt,d(e,u=Q(r,[r.length,r[0].length],e.dtype),n),a?e.persistentData=u:P.freeType(u)):N.raise("invalid buffer data")}else if(t(r))e.dtype=o||rt(r),e.dimension=i,d(e,r,n),a&&(e.persistentData=new Uint8Array(new Uint8Array(r.buffer)));else if(V(r)){s=r.shape;var f=r.stride,g=r.offset,p=0,v=0,m=0,y=0;1===s.length?(p=s[0],v=1,m=f[0],y=0):2===s.length?(p=s[0],v=s[1],m=f[0],y=f[1]):N.raise("invalid shape"),e.dtype=o||rt(r.data)||tt,e.dimension=v;var w=P.allocType(e.dtype,p*v);ot(w,r.data,p,v,m,y,g),d(e,w,n),a?e.persistentData=w:P.freeType(w)}else r instanceof ArrayBuffer?(e.dtype=J,e.dimension=i,d(e,r,n),a&&(e.persistentData=new Uint8Array(new Uint8Array(r)))):N.raise("invalid buffer data")}function c(t){r.bufferCount--,function(t){x.destroyBuffer(t)}(t);var n=t.buffer;N(n,"buffer must not be deleted already"),e.deleteBuffer(n),t.buffer=null,delete a[t.id]}return n.profile&&(r.getTotalBufferSize=function(){var t=0;return Object.keys(a).forEach((function(e){t+=a[e].stats.size})),t}),{create:function(o,i,u,d){r.bufferCount++;var l=new s(i);function f(r){var o=35044,i=null,a=0,s=0,u=1;return Array.isArray(r)||t(r)||V(r)||r instanceof ArrayBuffer?i=r:"number"==typeof r?a=0|r:r&&(N.type(r,"object","buffer arguments must be an object, a number or an array"),"data"in r&&(N(null===i||Array.isArray(i)||t(i)||V(i),"invalid data for buffer"),i=r.data),"usage"in r&&(N.parameter(r.usage,K,"invalid buffer usage"),o=K[r.usage]),"type"in r&&(N.parameter(r.type,Y,"invalid buffer type"),s=Y[r.type]),"dimension"in r&&(N.type(r.dimension,"number","invalid dimension"),u=0|r.dimension),"length"in r&&(N.nni(a,"buffer length must be a nonnegative integer"),a=0|r.length)),l.bind(),i?h(l,i,o,s,u,d):(a&&e.bufferData(l.type,a,o),l.dtype=s||J,l.usage=o,l.dimension=u,l.byteLength=a),n.profile&&(l.stats.size=l.byteLength*et[l.dtype]),f}function g(t,r){N(r+t.byteLength<=l.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+t.byteLength+" starting from offset "+r+" to a buffer of size "+l.byteLength),e.bufferSubData(l.type,r,t)}return a[l.id]=l,u||f(o),f._reglType="buffer",f._buffer=l,f.subdata=function(e,r){var n,o=0|(r||0);if(l.bind(),t(e)||e instanceof ArrayBuffer)g(e,o);else if(Array.isArray(e)){if(e.length>0)if("number"==typeof e[0]){var i=P.allocType(l.dtype,e.length);nt(i,e),g(i,o),P.freeType(i)}else if(Array.isArray(e[0])||t(e[0])){n=Z(e);var a=Q(e,n,l.dtype);g(a,o),P.freeType(a)}else N.raise("invalid buffer data")}else if(V(e)){n=e.shape;var s=e.stride,u=0,d=0,h=0,c=0;1===n.length?(u=n[0],d=1,h=s[0],c=0):2===n.length?(u=n[0],d=n[1],h=s[0],c=s[1]):N.raise("invalid shape");var p=Array.isArray(e.data)?l.dtype:rt(e.data),v=P.allocType(p,u*d);ot(v,e.data,u,d,h,c,e.offset),g(v,o),P.freeType(v)}else N.raise("invalid data for buffer subdata");return f},n.profile&&(f.stats=l.stats),f.destroy=function(){c(l)},f},createStream:function(t,e){var r=u.pop();return r||(r=new s(t)),r.bind(),h(r,e,35040,0,1,!1),r},destroyStream:function(t){u.push(t)},clear:function(){B(a).forEach(c),u.forEach(c)},getBuffer:function(t){return t&&t._buffer instanceof s?t._buffer:null},restore:function(){B(a).forEach((function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)}))},_initBuffer:h}}(o,c,n),x=function(e,r,n,o,i){for(var a=n.maxAttributes,s=new Array(a),u=0;u<a;++u)s[u]=new _e;var d=0,h={},c={Record:_e,scope:{},state:s,currentVAO:null,targetVAO:null,restore:l()?function(){l()&&B(h).forEach((function(t){t.refresh()}))}:function(){},createVAO:function(e){var n=new g;function s(e){N(Array.isArray(e),"arguments to vertex array constructor must be an array"),N(e.length<a,"too many attributes"),N(e.length>0,"must specify at least one attribute");var o={},u=n.attributes;u.length=e.length;for(var d=0;d<e.length;++d){var h,c=e[d],l=u[d]=new _e,f=c.data||c;Array.isArray(f)||t(f)||V(f)?(n.buffers[d]&&(h=n.buffers[d],t(f)&&h._buffer.byteLength>=f.byteLength?h.subdata(f):(h.destroy(),n.buffers[d]=null)),n.buffers[d]||(h=n.buffers[d]=i.create(c,34962,!1,!0)),l.buffer=i.getBuffer(h),l.size=0|l.buffer.dimension,l.normalized=!1,l.type=l.buffer.dtype,l.offset=0,l.stride=0,l.divisor=0,l.state=1,o[d]=1):i.getBuffer(c)?(l.buffer=i.getBuffer(c),l.size=0|l.buffer.dimension,l.normalized=!1,l.type=l.buffer.dtype,l.offset=0,l.stride=0,l.divisor=0,l.state=1):i.getBuffer(c.buffer)?(l.buffer=i.getBuffer(c.buffer),l.size=0|(+c.size||l.buffer.dimension),l.normalized=!!c.normalized||!1,"type"in c?(N.parameter(c.type,Y,"invalid buffer type"),l.type=Y[c.type]):l.type=l.buffer.dtype,l.offset=0|(c.offset||0),l.stride=0|(c.stride||0),l.divisor=0|(c.divisor||0),l.state=1,N(l.size>=1&&l.size<=4,"size must be between 1 and 4"),N(l.offset>=0,"invalid offset"),N(l.stride>=0&&l.stride<=255,"stride must be between 0 and 255"),N(l.divisor>=0,"divisor must be positive"),N(!l.divisor||!!r.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in c?(N(d>0,"first attribute must not be a constant"),l.x=+c.x||0,l.y=+c.y||0,l.z=+c.z||0,l.w=+c.w||0,l.state=2):N(!1,"invalid attribute spec for location "+d)}for(var g=0;g<n.buffers.length;++g)!o[g]&&n.buffers[g]&&(n.buffers[g].destroy(),n.buffers[g]=null);return n.refresh(),s}return o.vaoCount+=1,s.destroy=function(){for(var t=0;t<n.buffers.length;++t)n.buffers[t]&&n.buffers[t].destroy();n.buffers.length=0,n.destroy()},s._vao=n,s._reglType="vao",s(e)},getVAO:function(t){return"function"==typeof t&&t._vao?t._vao:null},destroyBuffer:function(t){for(var r=0;r<s.length;++r){var n=s[r];n.buffer===t&&(e.disableVertexAttribArray(r),n.buffer=null)}},setVAO:l()?function(t){if(t!==c.currentVAO){var e=l();t?e.bindVertexArrayOES(t.vao):e.bindVertexArrayOES(null),c.currentVAO=t}}:function(t){if(t!==c.currentVAO){if(t)t.bindAttrs();else for(var r=f(),n=0;n<s.length;++n){var o=s[n];o.buffer?(e.enableVertexAttribArray(n),e.vertexAttribPointer(n,o.size,o.type,o.normalized,o.stride,o.offfset),r&&o.divisor&&r.vertexAttribDivisorANGLE(n,o.divisor)):(e.disableVertexAttribArray(n),e.vertexAttrib4f(n,o.x,o.y,o.z,o.w))}c.currentVAO=t}},clear:l()?function(){B(h).forEach((function(t){t.destroy()}))}:function(){}};function l(){return r.oes_vertex_array_object}function f(){return r.angle_instanced_arrays}function g(){this.id=++d,this.attributes=[];var t=l();this.vao=t?t.createVertexArrayOES():null,h[this.id]=this,this.buffers=[]}return g.prototype.bindAttrs=function(){for(var t=f(),r=this.attributes,n=0;n<r.length;++n){var o=r[n];o.buffer?(e.enableVertexAttribArray(n),e.bindBuffer(34962,o.buffer.buffer),e.vertexAttribPointer(n,o.size,o.type,o.normalized,o.stride,o.offset),t&&o.divisor&&t.vertexAttribDivisorANGLE(n,o.divisor)):(e.disableVertexAttribArray(n),e.vertexAttrib4f(n,o.x,o.y,o.z,o.w))}for(var i=r.length;i<a;++i)e.disableVertexAttribArray(i)},g.prototype.refresh=function(){var t=l();t&&(t.bindVertexArrayOES(this.vao),this.bindAttrs(),c.currentVAO=this)},g.prototype.destroy=function(){if(this.vao){var t=l();this===c.currentVAO&&(c.currentVAO=null,t.bindVertexArrayOES(null)),t.deleteVertexArrayOES(this.vao),this.vao=null}h[this.id]&&(delete h[this.id],o.vaoCount-=1)},c}(o,l,y,c,w),E=function(e,r,n,o){var i={},a=0,s={uint8:at,uint16:st};function u(t){this.id=a++,i[this.id]=this,this.buffer=t,this.primType=4,this.vertCount=0,this.type=0}r.oes_element_index_uint&&(s.uint32=ut),u.prototype.bind=function(){this.buffer.bind()};var d=[];function h(o,i,a,s,u,d,h){var c;if(o.buffer.bind(),i){var l=h;h||t(i)&&(!V(i)||t(i.data))||(l=r.oes_element_index_uint?ut:st),n._initBuffer(o.buffer,i,a,l,3)}else e.bufferData(dt,d,a),o.buffer.dtype=c||at,o.buffer.usage=a,o.buffer.dimension=3,o.buffer.byteLength=d;if(c=h,!h){switch(o.buffer.dtype){case at:case 5120:c=at;break;case st:case 5122:c=st;break;case ut:case 5124:c=ut;break;default:N.raise("unsupported type for element array")}o.buffer.dtype=c}o.type=c,N(c!==ut||!!r.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var f=u;f<0&&(f=o.buffer.byteLength,c===st?f>>=1:c===ut&&(f>>=2)),o.vertCount=f;var g=s;if(s<0){g=4;var p=o.buffer.dimension;1===p&&(g=0),2===p&&(g=1),3===p&&(g=4)}o.primType=g}function c(t){o.elementsCount--,N(null!==t.buffer,"must not double destroy elements"),delete i[t.id],t.buffer.destroy(),t.buffer=null}return{create:function(e,r){var i=n.create(null,dt,!0),a=new u(i._buffer);function d(e){if(e)if("number"==typeof e)i(e),a.primType=4,a.vertCount=0|e,a.type=at;else{var r=null,n=35044,o=-1,u=-1,c=0,l=0;Array.isArray(e)||t(e)||V(e)?r=e:(N.type(e,"object","invalid arguments for elements"),"data"in e&&(r=e.data,N(Array.isArray(r)||t(r)||V(r),"invalid data for element buffer")),"usage"in e&&(N.parameter(e.usage,K,"invalid element buffer usage"),n=K[e.usage]),"primitive"in e&&(N.parameter(e.primitive,it,"invalid element buffer primitive"),o=it[e.primitive]),"count"in e&&(N("number"==typeof e.count&&e.count>=0,"invalid vertex count for elements"),u=0|e.count),"type"in e&&(N.parameter(e.type,s,"invalid buffer type"),l=s[e.type]),"length"in e?c=0|e.length:(c=u,l===st||5122===l?c*=2:l!==ut&&5124!==l||(c*=4))),h(a,r,n,o,u,c,l)}else i(),a.primType=4,a.vertCount=0,a.type=at;return d}return o.elementsCount++,d(e),d._reglType="elements",d._elements=a,d.subdata=function(t,e){return i.subdata(t,e),d},d.destroy=function(){c(a)},d},createStream:function(t){var e=d.pop();return e||(e=new u(n.create(null,dt,!0,!1)._buffer)),h(e,t,35040,-1,-1,0,0),e},destroyStream:function(t){d.push(t)},getElements:function(t){return"function"==typeof t&&t._elements instanceof u?t._elements:null},clear:function(){B(i).forEach(c)}}}(o,l,w,c),b=function(t,r,n,o){var i={},a={};function s(t,e,r,n){this.name=t,this.id=e,this.location=r,this.info=n}function u(t,e){for(var r=0;r<t.length;++r)if(t[r].id===e.id)return void(t[r].location=e.location);t.push(e)}function d(e,n,o){var s=35632===e?i:a,u=s[n];if(!u){var d=r.str(n);u=t.createShader(e),t.shaderSource(u,d),t.compileShader(u),N.shaderError(t,u,d,e,o),s[n]=u}return u}var h={},c=[],l=0;function f(t,e){this.id=l++,this.fragId=t,this.vertId=e,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,o.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function g(e,n,i){var a,h,c=d(35632,e.fragId),l=d(35633,e.vertId),f=e.program=t.createProgram();if(t.attachShader(f,c),t.attachShader(f,l),i)for(a=0;a<i.length;++a){var g=i[a];t.bindAttribLocation(f,g[0],g[1])}t.linkProgram(f),N.linkError(t,f,r.str(e.fragId),r.str(e.vertId),n);var p=t.getProgramParameter(f,35718);o.profile&&(e.stats.uniformsCount=p);var v=e.uniforms;for(a=0;a<p;++a)if(h=t.getActiveUniform(f,a))if(h.size>1)for(var m=0;m<h.size;++m){var y=h.name.replace("[0]","["+m+"]");u(v,new s(y,r.id(y),t.getUniformLocation(f,y),h))}else u(v,new s(h.name,r.id(h.name),t.getUniformLocation(f,h.name),h));var w=t.getProgramParameter(f,35721);o.profile&&(e.stats.attributesCount=w);var x=e.attributes;for(a=0;a<w;++a)(h=t.getActiveAttrib(f,a))&&u(x,new s(h.name,r.id(h.name),t.getAttribLocation(f,h.name),h))}return o.profile&&(n.getMaxUniformsCount=function(){var t=0;return c.forEach((function(e){e.stats.uniformsCount>t&&(t=e.stats.uniformsCount)})),t},n.getMaxAttributesCount=function(){var t=0;return c.forEach((function(e){e.stats.attributesCount>t&&(t=e.stats.attributesCount)})),t}),{clear:function(){var e=t.deleteShader.bind(t);B(i).forEach(e),i={},B(a).forEach(e),a={},c.forEach((function(e){t.deleteProgram(e.program)})),c.length=0,h={},n.shaderCount=0},program:function(r,o,s,u){N.command(r>=0,"missing vertex shader",s),N.command(o>=0,"missing fragment shader",s);var d=h[o];d||(d=h[o]={});var l=d[r];if(l&&(l.refCount++,!u))return l;var p=new f(o,r);return n.shaderCount++,g(p,s,u),l||(d[r]=p),c.push(p),e(p,{destroy:function(){if(p.refCount--,p.refCount<=0){t.deleteProgram(p.program);var e=c.indexOf(p);c.splice(e,1),n.shaderCount--}d[p.vertId].refCount<=0&&(t.deleteShader(a[p.vertId]),delete a[p.vertId],delete h[p.fragId][p.vertId]),Object.keys(h[p.fragId]).length||(t.deleteShader(i[p.fragId]),delete i[p.fragId],delete h[p.fragId])}})},restore:function(){i={},a={};for(var t=0;t<c.length;++t)g(c[t],null,c[t].attributes.map((function(t){return[t.location,t.name]})))},shader:d,frag:-1,vert:-1}}(o,h,c,n),M=function(r,n,o,i,a,s,u){var d={"don't care":Ut,"dont care":Ut,nice:4354,fast:4353},h={repeat:10497,clamp:Pt,mirror:33648},c={nearest:Ft,linear:9729},l=e({mipmap:Gt,"nearest mipmap nearest":jt,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":Gt},c),f={none:0,browser:37444},g={uint8:Ot,rgba4:32819,rgb565:33635,"rgb5 a1":32820},p={alpha:wt,luminance:Et,"luminance alpha":bt,rgb:xt,rgba:yt,rgba4:32854,"rgb5 a1":Nt,rgb565:36194},v={};n.ext_srgb&&(p.srgb=At,p.srgba=St),n.oes_texture_float&&(g.float32=g.float=Lt),n.oes_texture_half_float&&(g.float16=g["half float"]=kt),n.webgl_depth_texture&&(e(p,{depth:Mt,"depth stencil":_t}),e(g,{uint16:zt,uint32:Ct,"depth stencil":34042})),n.webgl_compressed_texture_s3tc&&e(v,{"rgb s3tc dxt1":It,"rgba s3tc dxt1":Tt,"rgba s3tc dxt3":Dt,"rgba s3tc dxt5":Rt}),n.webgl_compressed_texture_atc&&e(v,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),n.webgl_compressed_texture_pvrtc&&e(v,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),n.webgl_compressed_texture_etc1&&(v["rgb etc1"]=36196);var m=Array.prototype.slice.call(r.getParameter(34467));Object.keys(v).forEach((function(t){var e=v[t];m.indexOf(e)>=0&&(p[t]=e)}));var y=Object.keys(p);o.textureFormats=y;var w=[];Object.keys(p).forEach((function(t){var e=p[t];w[e]=t}));var x=[];Object.keys(g).forEach((function(t){var e=g[t];x[e]=t}));var E=[];Object.keys(c).forEach((function(t){E[c[t]]=t}));var b=[];Object.keys(l).forEach((function(t){var e=l[t];b[e]=t}));var M=[];Object.keys(h).forEach((function(t){M[h[t]]=t}));var _=y.reduce((function(t,e){var r=p[e];return r===Et||r===wt||r===Et||r===bt||r===Mt||r===_t||n.ext_srgb&&(r===At||r===St)?t[r]=r:r===Nt||e.indexOf("rgba")>=0?t[r]=yt:t[r]=xt,t}),{});function A(){this.internalformat=yt,this.format=yt,this.type=Ot,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=37444,this.width=0,this.height=0,this.channels=0}function S(t,e){t.internalformat=e.internalformat,t.format=e.format,t.type=e.type,t.compressed=e.compressed,t.premultiplyAlpha=e.premultiplyAlpha,t.flipY=e.flipY,t.unpackAlignment=e.unpackAlignment,t.colorSpace=e.colorSpace,t.width=e.width,t.height=e.height,t.channels=e.channels}function k(t,e){if("object"==typeof e&&e){if("premultiplyAlpha"in e&&(N.type(e.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),t.premultiplyAlpha=e.premultiplyAlpha),"flipY"in e&&(N.type(e.flipY,"boolean","invalid texture flip"),t.flipY=e.flipY),"alignment"in e&&(N.oneOf(e.alignment,[1,2,4,8],"invalid texture unpack alignment"),t.unpackAlignment=e.alignment),"colorSpace"in e&&(N.parameter(e.colorSpace,f,"invalid colorSpace"),t.colorSpace=f[e.colorSpace]),"type"in e){var r=e.type;N(n.oes_texture_float||!("float"===r||"float32"===r),"you must enable the OES_texture_float extension in order to use floating point textures."),N(n.oes_texture_half_float||!("half float"===r||"float16"===r),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),N(n.webgl_depth_texture||!("uint16"===r||"uint32"===r||"depth stencil"===r),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),N.parameter(r,g,"invalid texture type"),t.type=g[r]}var i=t.width,a=t.height,s=t.channels,u=!1;"shape"in e?(N(Array.isArray(e.shape)&&e.shape.length>=2,"shape must be an array"),i=e.shape[0],a=e.shape[1],3===e.shape.length&&(s=e.shape[2],N(s>0&&s<=4,"invalid number of channels"),u=!0),N(i>=0&&i<=o.maxTextureSize,"invalid width"),N(a>=0&&a<=o.maxTextureSize,"invalid height")):("radius"in e&&(i=a=e.radius,N(i>=0&&i<=o.maxTextureSize,"invalid radius")),"width"in e&&(i=e.width,N(i>=0&&i<=o.maxTextureSize,"invalid width")),"height"in e&&(a=e.height,N(a>=0&&a<=o.maxTextureSize,"invalid height")),"channels"in e&&(s=e.channels,N(s>0&&s<=4,"invalid number of channels"),u=!0)),t.width=0|i,t.height=0|a,t.channels=0|s;var d=!1;if("format"in e){var h=e.format;N(n.webgl_depth_texture||!("depth"===h||"depth stencil"===h),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),N.parameter(h,p,"invalid texture format");var c=t.internalformat=p[h];t.format=_[c],h in g&&("type"in e||(t.type=g[h])),h in v&&(t.compressed=!0),d=!0}!u&&d?t.channels=Wt[t.format]:u&&!d?t.channels!==qt[t.format]&&(t.format=t.internalformat=qt[t.channels]):d&&u&&N(t.channels===Wt[t.format],"number of channels inconsistent with specified format")}}function I(t){r.pixelStorei(37440,t.flipY),r.pixelStorei(37441,t.premultiplyAlpha),r.pixelStorei(37443,t.colorSpace),r.pixelStorei(3317,t.unpackAlignment)}function T(){A.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function D(e,r){var n=null;if(se(r)?n=r:r&&(N.type(r,"object","invalid pixel data type"),k(e,r),"x"in r&&(e.xOffset=0|r.x),"y"in r&&(e.yOffset=0|r.y),se(r.data)&&(n=r.data)),N(!e.compressed||n instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),r.copy){N(!n,"can not specify copy and data field for the same texture");var i=a.viewportWidth,s=a.viewportHeight;e.width=e.width||i-e.xOffset,e.height=e.height||s-e.yOffset,e.needsCopy=!0,N(e.xOffset>=0&&e.xOffset<i&&e.yOffset>=0&&e.yOffset<s&&e.width>0&&e.width<=i&&e.height>0&&e.height<=s,"copy texture read out of bounds")}else if(n){if(t(n))e.channels=e.channels||4,e.data=n,"type"in r||e.type!==Ot||(e.type=ue(n));else if(re(n))e.channels=e.channels||4,function(t,e){var r=e.length;switch(t.type){case Ot:case zt:case Ct:case Lt:var n=P.allocType(t.type,r);n.set(e),t.data=n;break;case kt:t.data=lt(e);break;default:N.raise("unsupported texture type, must specify a typed array")}}(e,n),e.alignment=1,e.needsFree=!0;else if(V(n)){var u=n.data;Array.isArray(u)||e.type!==Ot||(e.type=ue(u));var d,h,c,l,f,g,p=n.shape,v=n.stride;3===p.length?(c=p[2],g=v[2]):(N(2===p.length,"invalid ndarray pixel data, must be 2 or 3D"),c=1,g=1),d=p[0],h=p[1],l=v[0],f=v[1],e.alignment=1,e.width=d,e.height=h,e.channels=c,e.format=e.internalformat=qt[c],e.needsFree=!0,function(t,e,r,n,o,i){for(var a=t.width,s=t.height,u=t.channels,d=de(t,a*s*u),h=0,c=0;c<s;++c)for(var l=0;l<a;++l)for(var f=0;f<u;++f)d[h++]=e[r*l+n*c+o*f+i];he(t,d)}(e,u,l,f,g,n.offset)}else if(ie(n)||ae(n)||oe(n)===Yt)ie(n)||ae(n)?e.element=n:e.element=n.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(oe(n)===Kt)e.element=n,e.width=n.width,e.height=n.height,e.channels=4;else if(oe(n)===Qt)e.element=n,e.width=n.naturalWidth,e.height=n.naturalHeight,e.channels=4;else if(function(t){return oe(t)===Zt}(n))e.element=n,e.width=n.videoWidth,e.height=n.videoHeight,e.channels=4;else if(ne(n)){var m=e.width||n[0].length,y=e.height||n.length,w=e.channels;w=ft(n[0][0])?w||n[0][0].length:w||1;for(var x=q(n),E=1,b=0;b<x.length;++b)E*=x[b];var M=de(e,E);W(n,x,"",M),he(e,M),e.alignment=1,e.width=m,e.height=y,e.channels=w,e.format=e.internalformat=qt[w],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4;e.type===Lt?N(o.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):e.type===kt&&N(o.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function R(t,e,n){var o=t.element,a=t.data,s=t.internalformat,u=t.format,d=t.type,h=t.width,c=t.height;I(t),o?r.texImage2D(e,n,u,u,d,o):t.compressed?r.compressedTexImage2D(e,n,s,h,c,0,a):t.needsCopy?(i(),r.copyTexImage2D(e,n,u,t.xOffset,t.yOffset,h,c,0)):r.texImage2D(e,n,u,h,c,0,u,d,a||null)}function O(t,e,n,o,a){var s=t.element,u=t.data,d=t.internalformat,h=t.format,c=t.type,l=t.width,f=t.height;I(t),s?r.texSubImage2D(e,a,n,o,h,c,s):t.compressed?r.compressedTexSubImage2D(e,a,n,o,d,l,f,u):t.needsCopy?(i(),r.copyTexSubImage2D(e,a,n,o,t.xOffset,t.yOffset,l,f)):r.texSubImage2D(e,a,n,o,l,f,h,c,u)}var z=[];function C(){return z.pop()||new T}function L(t){t.needsFree&&P.freeType(t.data),T.call(t),z.push(t)}function F(){A.call(this),this.genMipmaps=!1,this.mipmapHint=Ut,this.mipmask=0,this.images=Array(16)}function j(t,e,r){var n=t.images[0]=C();t.mipmask=1,n.width=t.width=e,n.height=t.height=r,n.channels=t.channels=4}function G(t,e){var r=null;if(se(e))S(r=t.images[0]=C(),t),D(r,e),t.mipmask=1;else if(k(t,e),Array.isArray(e.mipmap))for(var n=e.mipmap,o=0;o<n.length;++o)S(r=t.images[o]=C(),t),r.width>>=o,r.height>>=o,D(r,n[o]),t.mipmask|=1<<o;else S(r=t.images[0]=C(),t),D(r,e),t.mipmask=1;S(t,t.images[0]),!t.compressed||t.internalformat!==It&&t.internalformat!==Tt&&t.internalformat!==Dt&&t.internalformat!==Rt||N(t.width%4==0&&t.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function U(t,e){for(var r=t.images,n=0;n<r.length;++n){if(!r[n])return;R(r[n],e,n)}}var H=[];function $(){var t=H.pop()||new F;A.call(t),t.mipmask=0;for(var e=0;e<16;++e)t.images[e]=null;return t}function X(t){for(var e=t.images,r=0;r<e.length;++r)e[r]&&L(e[r]),e[r]=null;H.push(t)}function Y(){this.minFilter=Ft,this.magFilter=Ft,this.wrapS=Pt,this.wrapT=Pt,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Ut}function K(t,e){if("min"in e){var r=e.min;N.parameter(r,l),t.minFilter=l[r],Bt.indexOf(t.minFilter)>=0&&!("faces"in e)&&(t.genMipmaps=!0)}if("mag"in e){var n=e.mag;N.parameter(n,c),t.magFilter=c[n]}var i=t.wrapS,a=t.wrapT;if("wrap"in e){var s=e.wrap;"string"==typeof s?(N.parameter(s,h),i=a=h[s]):Array.isArray(s)&&(N.parameter(s[0],h),N.parameter(s[1],h),i=h[s[0]],a=h[s[1]])}else{if("wrapS"in e){var u=e.wrapS;N.parameter(u,h),i=h[u]}if("wrapT"in e){var f=e.wrapT;N.parameter(f,h),a=h[f]}}if(t.wrapS=i,t.wrapT=a,"anisotropic"in e){var g=e.anisotropic;N("number"==typeof g&&g>=1&&g<=o.maxAnisotropic,"aniso samples must be between 1 and "),t.anisotropic=e.anisotropic}if("mipmap"in e){var p=!1;switch(typeof e.mipmap){case"string":N.parameter(e.mipmap,d,"invalid mipmap hint"),t.mipmapHint=d[e.mipmap],t.genMipmaps=!0,p=!0;break;case"boolean":p=t.genMipmaps=e.mipmap;break;case"object":N(Array.isArray(e.mipmap),"invalid mipmap type"),t.genMipmaps=!1,p=!0;break;default:N.raise("invalid mipmap type")}p&&!("min"in e)&&(t.minFilter=jt)}}function Q(t,e){r.texParameteri(e,10241,t.minFilter),r.texParameteri(e,10240,t.magFilter),r.texParameteri(e,10242,t.wrapS),r.texParameteri(e,10243,t.wrapT),n.ext_texture_filter_anisotropic&&r.texParameteri(e,34046,t.anisotropic),t.genMipmaps&&(r.hint(33170,t.mipmapHint),r.generateMipmap(e))}var Z=0,J={},tt=o.maxTextureUnits,et=Array(tt).map((function(){return null}));function rt(t){A.call(this),this.mipmask=0,this.internalformat=yt,this.id=Z++,this.refCount=1,this.target=t,this.texture=r.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Y,u.profile&&(this.stats={size:0})}function nt(t){r.activeTexture(Vt),r.bindTexture(t.target,t.texture)}function ot(){var t=et[0];t?r.bindTexture(t.target,t.texture):r.bindTexture(pt,null)}function it(t){var e=t.texture;N(e,"must not double destroy texture");var n=t.unit,o=t.target;n>=0&&(r.activeTexture(Vt+n),r.bindTexture(o,null),et[n]=null),r.deleteTexture(e),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete J[t.id],s.textureCount--}return e(rt.prototype,{bind:function(){var t=this;t.bindCount+=1;var e=t.unit;if(e<0){for(var n=0;n<tt;++n){var o=et[n];if(o){if(o.bindCount>0)continue;o.unit=-1}et[n]=t,e=n;break}e>=tt&&N.raise("insufficient number of texture units"),u.profile&&s.maxTextureUnits<e+1&&(s.maxTextureUnits=e+1),t.unit=e,r.activeTexture(Vt+e),r.bindTexture(t.target,t.texture)}return e},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&it(this)}}),u.profile&&(s.getTotalTextureSize=function(){var t=0;return Object.keys(J).forEach((function(e){t+=J[e].stats.size})),t}),{create2D:function(t,e){var n=new rt(pt);function i(t,e){var r=n.texInfo;Y.call(r);var a=$();return"number"==typeof t?j(a,0|t,"number"==typeof e?0|e:0|t):t?(N.type(t,"object","invalid arguments to regl.texture"),K(r,t),G(a,t)):j(a,1,1),r.genMipmaps&&(a.mipmask=(a.width<<1)-1),n.mipmask=a.mipmask,S(n,a),N.texture2D(r,a,o),n.internalformat=a.internalformat,i.width=a.width,i.height=a.height,nt(n),U(a,pt),Q(r,pt),ot(),X(a),u.profile&&(n.stats.size=ce(n.internalformat,n.type,a.width,a.height,r.genMipmaps,!1)),i.format=w[n.internalformat],i.type=x[n.type],i.mag=E[r.magFilter],i.min=b[r.minFilter],i.wrapS=M[r.wrapS],i.wrapT=M[r.wrapT],i}return J[n.id]=n,s.textureCount++,i(t,e),i.subimage=function(t,e,r,o){N(!!t,"must specify image data");var a=0|e,s=0|r,u=0|o,d=C();return S(d,n),d.width=0,d.height=0,D(d,t),d.width=d.width||(n.width>>u)-a,d.height=d.height||(n.height>>u)-s,N(n.type===d.type&&n.format===d.format&&n.internalformat===d.internalformat,"incompatible format for texture.subimage"),N(a>=0&&s>=0&&a+d.width<=n.width&&s+d.height<=n.height,"texture.subimage write out of bounds"),N(n.mipmask&1<<u,"missing mipmap data"),N(d.data||d.element||d.needsCopy,"missing image data"),nt(n),O(d,pt,a,s,u),ot(),L(d),i},i.resize=function(t,e){var o=0|t,a=0|e||o;if(o===n.width&&a===n.height)return i;i.width=n.width=o,i.height=n.height=a,nt(n);for(var s=0;n.mipmask>>s;++s){var d=o>>s,h=a>>s;if(!d||!h)break;r.texImage2D(pt,s,n.format,d,h,0,n.format,n.type,null)}return ot(),u.profile&&(n.stats.size=ce(n.internalformat,n.type,o,a,!1,!1)),i},i._reglType="texture2d",i._texture=n,u.profile&&(i.stats=n.stats),i.destroy=function(){n.decRef()},i},createCube:function(t,e,n,i,a,d){var h=new rt(vt);J[h.id]=h,s.cubeCount++;var c=new Array(6);function l(t,e,r,n,i,a){var s,d=h.texInfo;for(Y.call(d),s=0;s<6;++s)c[s]=$();if("number"!=typeof t&&t)if("object"==typeof t)if(e)G(c[0],t),G(c[1],e),G(c[2],r),G(c[3],n),G(c[4],i),G(c[5],a);else if(K(d,t),k(h,t),"faces"in t){var f=t.faces;for(N(Array.isArray(f)&&6===f.length,"cube faces must be a length 6 array"),s=0;s<6;++s)N("object"==typeof f[s]&&!!f[s],"invalid input for cube map face"),S(c[s],h),G(c[s],f[s])}else for(s=0;s<6;++s)G(c[s],t);else N.raise("invalid arguments to cube map");else{var g=0|t||1;for(s=0;s<6;++s)j(c[s],g,g)}for(S(h,c[0]),o.npotTextureCube||N(gt(h.width)&&gt(h.height),"your browser does not support non power or two texture dimensions"),d.genMipmaps?h.mipmask=(c[0].width<<1)-1:h.mipmask=c[0].mipmask,N.textureCube(h,d,c,o),h.internalformat=c[0].internalformat,l.width=c[0].width,l.height=c[0].height,nt(h),s=0;s<6;++s)U(c[s],mt+s);for(Q(d,vt),ot(),u.profile&&(h.stats.size=ce(h.internalformat,h.type,l.width,l.height,d.genMipmaps,!0)),l.format=w[h.internalformat],l.type=x[h.type],l.mag=E[d.magFilter],l.min=b[d.minFilter],l.wrapS=M[d.wrapS],l.wrapT=M[d.wrapT],s=0;s<6;++s)X(c[s]);return l}return l(t,e,n,i,a,d),l.subimage=function(t,e,r,n,o){N(!!e,"must specify image data"),N("number"==typeof t&&t===(0|t)&&t>=0&&t<6,"invalid face");var i=0|r,a=0|n,s=0|o,u=C();return S(u,h),u.width=0,u.height=0,D(u,e),u.width=u.width||(h.width>>s)-i,u.height=u.height||(h.height>>s)-a,N(h.type===u.type&&h.format===u.format&&h.internalformat===u.internalformat,"incompatible format for texture.subimage"),N(i>=0&&a>=0&&i+u.width<=h.width&&a+u.height<=h.height,"texture.subimage write out of bounds"),N(h.mipmask&1<<s,"missing mipmap data"),N(u.data||u.element||u.needsCopy,"missing image data"),nt(h),O(u,mt+t,i,a,s),ot(),L(u),l},l.resize=function(t){var e=0|t;if(e!==h.width){l.width=h.width=e,l.height=h.height=e,nt(h);for(var n=0;n<6;++n)for(var o=0;h.mipmask>>o;++o)r.texImage2D(mt+n,o,h.format,e>>o,e>>o,0,h.format,h.type,null);return ot(),u.profile&&(h.stats.size=ce(h.internalformat,h.type,l.width,l.height,!1,!0)),l}},l._reglType="textureCube",l._texture=h,u.profile&&(l.stats=h.stats),l.destroy=function(){h.decRef()},l},clear:function(){for(var t=0;t<tt;++t)r.activeTexture(Vt+t),r.bindTexture(pt,null),et[t]=null;B(J).forEach(it),s.cubeCount=0,s.textureCount=0},getTexture:function(t){return null},restore:function(){for(var t=0;t<tt;++t){var e=et[t];e&&(e.bindCount=0,e.unit=-1,et[t]=null)}B(J).forEach((function(t){t.texture=r.createTexture(),r.bindTexture(t.target,t.texture);for(var e=0;e<32;++e)if(0!=(t.mipmask&1<<e))if(t.target===pt)r.texImage2D(pt,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);else for(var n=0;n<6;++n)r.texImage2D(mt+n,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);Q(t.texInfo,t.target)}))},refresh:function(){for(var t=0;t<tt;++t){var e=et[t];e&&(e.bindCount=0,e.unit=-1,et[t]=null),r.activeTexture(Vt+t),r.bindTexture(pt,null),r.bindTexture(vt,null)}}}}(o,l,y,(function(){S.procs.poll()}),m,c,n),_=function(t,e,r,n,o){var i={rgba4:fe,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};e.ext_srgb&&(i.srgba=35907),e.ext_color_buffer_half_float&&(i.rgba16f=34842,i.rgb16f=34843),e.webgl_color_buffer_float&&(i.rgba32f=34836);var a=[];Object.keys(i).forEach((function(t){var e=i[t];a[e]=t}));var s=0,u={};function d(t){this.id=s++,this.refCount=1,this.renderbuffer=t,this.format=fe,this.width=0,this.height=0,o.profile&&(this.stats={size:0})}function h(e){var r=e.renderbuffer;N(r,"must not double destroy renderbuffer"),t.bindRenderbuffer(le,null),t.deleteRenderbuffer(r),e.renderbuffer=null,e.refCount=0,delete u[e.id],n.renderbufferCount--}return d.prototype.decRef=function(){--this.refCount<=0&&h(this)},o.profile&&(n.getTotalRenderbufferSize=function(){var t=0;return Object.keys(u).forEach((function(e){t+=u[e].stats.size})),t}),{create:function(e,s){var h=new d(t.createRenderbuffer());function c(e,n){var s=0,u=0,d=fe;if("object"==typeof e&&e){var l=e;if("shape"in l){var f=l.shape;N(Array.isArray(f)&&f.length>=2,"invalid renderbuffer shape"),s=0|f[0],u=0|f[1]}else"radius"in l&&(s=u=0|l.radius),"width"in l&&(s=0|l.width),"height"in l&&(u=0|l.height);"format"in l&&(N.parameter(l.format,i,"invalid renderbuffer format"),d=i[l.format])}else"number"==typeof e?(s=0|e,u="number"==typeof n?0|n:s):e?N.raise("invalid arguments to renderbuffer constructor"):s=u=1;if(N(s>0&&u>0&&s<=r.maxRenderbufferSize&&u<=r.maxRenderbufferSize,"invalid renderbuffer size"),s!==h.width||u!==h.height||d!==h.format)return c.width=h.width=s,c.height=h.height=u,h.format=d,t.bindRenderbuffer(le,h.renderbuffer),t.renderbufferStorage(le,d,s,u),N(0===t.getError(),"invalid render buffer format"),o.profile&&(h.stats.size=pe(h.format,h.width,h.height)),c.format=a[h.format],c}return u[h.id]=h,n.renderbufferCount++,c(e,s),c.resize=function(e,n){var i=0|e,a=0|n||i;return i===h.width&&a===h.height||(N(i>0&&a>0&&i<=r.maxRenderbufferSize&&a<=r.maxRenderbufferSize,"invalid renderbuffer size"),c.width=h.width=i,c.height=h.height=a,t.bindRenderbuffer(le,h.renderbuffer),t.renderbufferStorage(le,h.format,i,a),N(0===t.getError(),"invalid render buffer format"),o.profile&&(h.stats.size=pe(h.format,h.width,h.height))),c},c._reglType="renderbuffer",c._renderbuffer=h,o.profile&&(c.stats=h.stats),c.destroy=function(){h.decRef()},c},clear:function(){B(u).forEach(h)},restore:function(){B(u).forEach((function(e){e.renderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(le,e.renderbuffer),t.renderbufferStorage(le,e.format,e.width,e.height)})),t.bindRenderbuffer(le,null)}}}(o,l,y,c,n),A=function(t,r,n,o,i,a){var s={cur:null,next:null,dirty:!1,setFBO:null},u=["rgba"],d=["rgba4","rgb565","rgb5 a1"];r.ext_srgb&&d.push("srgba"),r.ext_color_buffer_half_float&&d.push("rgba16f","rgb16f"),r.webgl_color_buffer_float&&d.push("rgba32f");var h=["uint8"];function c(t,e,r){this.target=t,this.texture=e,this.renderbuffer=r;var n=0,o=0;e?(n=e.width,o=e.height):r&&(n=r.width,o=r.height),this.width=n,this.height=o}function l(t){t&&(t.texture&&t.texture._texture.decRef(),t.renderbuffer&&t.renderbuffer._renderbuffer.decRef())}function f(t,e,r){if(t)if(t.texture){var n=t.texture._texture,o=Math.max(1,n.width),i=Math.max(1,n.height);N(o===e&&i===r,"inconsistent width/height for supplied texture"),n.refCount+=1}else{var a=t.renderbuffer._renderbuffer;N(a.width===e&&a.height===r,"inconsistent width/height for renderbuffer"),a.refCount+=1}}function g(e,r){r&&(r.texture?t.framebufferTexture2D(ve,e,r.target,r.texture._texture.texture,0):t.framebufferRenderbuffer(ve,e,me,r.renderbuffer._renderbuffer.renderbuffer))}function p(t){var e=ye,r=null,n=null,o=t;"object"==typeof t&&(o=t.data,"target"in t&&(e=0|t.target)),N.type(o,"function","invalid attachment data");var i=o._reglType;return"texture2d"===i?(r=o,N(e===ye)):"textureCube"===i?(r=o,N(e>=we&&e<we+6,"invalid cube map target")):"renderbuffer"===i?(n=o,e=me):N.raise("invalid regl object for attachment"),new c(e,r,n)}function v(t,e,r,n,a){if(r){var s=o.create2D({width:t,height:e,format:n,type:a});return s._texture.refCount=0,new c(ye,s,null)}var u=i.create({width:t,height:e,format:n});return u._renderbuffer.refCount=0,new c(me,null,u)}function m(t){return t&&(t.texture||t.renderbuffer)}function y(t,e,r){t&&(t.texture?t.texture.resize(e,r):t.renderbuffer&&t.renderbuffer.resize(e,r),t.width=e,t.height=r)}r.oes_texture_half_float&&h.push("half float","float16"),r.oes_texture_float&&h.push("float","float32");var w=0,x={};function E(){this.id=w++,x[this.id]=this,this.framebuffer=t.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function b(t){t.colorAttachments.forEach(l),l(t.depthAttachment),l(t.stencilAttachment),l(t.depthStencilAttachment)}function M(e){var r=e.framebuffer;N(r,"must not double destroy framebuffer"),t.deleteFramebuffer(r),e.framebuffer=null,a.framebufferCount--,delete x[e.id]}function _(e){var r;t.bindFramebuffer(ve,e.framebuffer);var o=e.colorAttachments;for(r=0;r<o.length;++r)g(36064+r,o[r]);for(r=o.length;r<n.maxColorAttachments;++r)t.framebufferTexture2D(ve,36064+r,ye,null,0);t.framebufferTexture2D(ve,33306,ye,null,0),t.framebufferTexture2D(ve,36096,ye,null,0),t.framebufferTexture2D(ve,36128,ye,null,0),g(36096,e.depthAttachment),g(36128,e.stencilAttachment),g(33306,e.depthStencilAttachment);var i=t.checkFramebufferStatus(ve);t.isContextLost()||36053===i||N.raise("framebuffer configuration not supported, status = "+Me[i]),t.bindFramebuffer(ve,s.next?s.next.framebuffer:null),s.cur=s.next,t.getError()}function A(t,o){var i=new E;function c(t,e){var o;N(s.next!==i,"can not update framebuffer which is currently in use");var a=0,l=0,g=!0,y=!0,w=null,x=!0,E="rgba",M="uint8",A=1,S=null,k=null,I=null,T=!1;if("number"==typeof t)a=0|t,l=0|e||a;else if(t){N.type(t,"object","invalid arguments for framebuffer");var D=t;if("shape"in D){var R=D.shape;N(Array.isArray(R)&&R.length>=2,"invalid shape for framebuffer"),a=R[0],l=R[1]}else"radius"in D&&(a=l=D.radius),"width"in D&&(a=D.width),"height"in D&&(l=D.height);("color"in D||"colors"in D)&&(w=D.color||D.colors,Array.isArray(w)&&N(1===w.length||r.webgl_draw_buffers,"multiple render targets not supported")),w||("colorCount"in D&&(A=0|D.colorCount,N(A>0,"invalid color buffer count")),"colorTexture"in D&&(x=!!D.colorTexture,E="rgba4"),"colorType"in D&&(M=D.colorType,x?(N(r.oes_texture_float||!("float"===M||"float32"===M),"you must enable OES_texture_float in order to use floating point framebuffer objects"),N(r.oes_texture_half_float||!("half float"===M||"float16"===M),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===M||"float16"===M?(N(r.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),E="rgba16f"):"float"!==M&&"float32"!==M||(N(r.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),E="rgba32f"),N.oneOf(M,h,"invalid color type")),"colorFormat"in D&&(E=D.colorFormat,u.indexOf(E)>=0?x=!0:d.indexOf(E)>=0?x=!1:x?N.oneOf(D.colorFormat,u,"invalid color format for texture"):N.oneOf(D.colorFormat,d,"invalid color format for renderbuffer"))),("depthTexture"in D||"depthStencilTexture"in D)&&(T=!(!D.depthTexture&&!D.depthStencilTexture),N(!T||r.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in D&&("boolean"==typeof D.depth?g=D.depth:(S=D.depth,y=!1)),"stencil"in D&&("boolean"==typeof D.stencil?y=D.stencil:(k=D.stencil,g=!1)),"depthStencil"in D&&("boolean"==typeof D.depthStencil?g=y=D.depthStencil:(I=D.depthStencil,g=!1,y=!1))}else a=l=1;var O=null,z=null,C=null,L=null;if(Array.isArray(w))O=w.map(p);else if(w)O=[p(w)];else for(O=new Array(A),o=0;o<A;++o)O[o]=v(a,l,x,E,M);N(r.webgl_draw_buffers||O.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),N(O.length<=n.maxColorAttachments,"too many color attachments, not supported"),a=a||O[0].width,l=l||O[0].height,S?z=p(S):g&&!y&&(z=v(a,l,T,"depth","uint32")),k?C=p(k):y&&!g&&(C=v(a,l,!1,"stencil","uint8")),I?L=p(I):!S&&!k&&y&&g&&(L=v(a,l,T,"depth stencil","depth stencil")),N(!!S+!!k+!!I<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var P=null;for(o=0;o<O.length;++o)if(f(O[o],a,l),N(!O[o]||O[o].texture&&xe.indexOf(O[o].texture._texture.format)>=0||O[o].renderbuffer&&Ne.indexOf(O[o].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+o+" is invalid"),O[o]&&O[o].texture){var F=Ee[O[o].texture._texture.format]*be[O[o].texture._texture.type];null===P?P=F:N(P===F,"all color attachments much have the same number of bits per pixel.")}return f(z,a,l),N(!z||z.texture&&6402===z.texture._texture.format||z.renderbuffer&&33189===z.renderbuffer._renderbuffer.format,"invalid depth attachment for framebuffer object"),f(C,a,l),N(!C||C.renderbuffer&&36168===C.renderbuffer._renderbuffer.format,"invalid stencil attachment for framebuffer object"),f(L,a,l),N(!L||L.texture&&34041===L.texture._texture.format||L.renderbuffer&&34041===L.renderbuffer._renderbuffer.format,"invalid depth-stencil attachment for framebuffer object"),b(i),i.width=a,i.height=l,i.colorAttachments=O,i.depthAttachment=z,i.stencilAttachment=C,i.depthStencilAttachment=L,c.color=O.map(m),c.depth=m(z),c.stencil=m(C),c.depthStencil=m(L),c.width=i.width,c.height=i.height,_(i),c}return a.framebufferCount++,c(t,o),e(c,{resize:function(t,e){N(s.next!==i,"can not resize a framebuffer which is currently in use");var r=Math.max(0|t,1),n=Math.max(0|e||r,1);if(r===i.width&&n===i.height)return c;for(var o=i.colorAttachments,a=0;a<o.length;++a)y(o[a],r,n);return y(i.depthAttachment,r,n),y(i.stencilAttachment,r,n),y(i.depthStencilAttachment,r,n),i.width=c.width=r,i.height=c.height=n,_(i),c},_reglType:"framebuffer",_framebuffer:i,destroy:function(){M(i),b(i)},use:function(t){s.setFBO({framebuffer:c},t)}})}return e(s,{getFramebuffer:function(t){if("function"==typeof t&&"framebuffer"===t._reglType){var e=t._framebuffer;if(e instanceof E)return e}return null},create:A,createCube:function(t){var i=Array(6);function a(t){var n;N(i.indexOf(s.next)<0,"can not update framebuffer which is currently in use");var d,c={color:null},l=0,f=null,g="rgba",p="uint8",v=1;if("number"==typeof t)l=0|t;else if(t){N.type(t,"object","invalid arguments for framebuffer");var m=t;if("shape"in m){var y=m.shape;N(Array.isArray(y)&&y.length>=2,"invalid shape for framebuffer"),N(y[0]===y[1],"cube framebuffer must be square"),l=y[0]}else"radius"in m&&(l=0|m.radius),"width"in m?(l=0|m.width,"height"in m&&N(m.height===l,"must be square")):"height"in m&&(l=0|m.height);("color"in m||"colors"in m)&&(f=m.color||m.colors,Array.isArray(f)&&N(1===f.length||r.webgl_draw_buffers,"multiple render targets not supported")),f||("colorCount"in m&&(v=0|m.colorCount,N(v>0,"invalid color buffer count")),"colorType"in m&&(N.oneOf(m.colorType,h,"invalid color type"),p=m.colorType),"colorFormat"in m&&(g=m.colorFormat,N.oneOf(m.colorFormat,u,"invalid color format for texture"))),"depth"in m&&(c.depth=m.depth),"stencil"in m&&(c.stencil=m.stencil),"depthStencil"in m&&(c.depthStencil=m.depthStencil)}else l=1;if(f)if(Array.isArray(f))for(d=[],n=0;n<f.length;++n)d[n]=f[n];else d=[f];else{d=Array(v);var w={radius:l,format:g,type:p};for(n=0;n<v;++n)d[n]=o.createCube(w)}for(c.color=Array(d.length),n=0;n<d.length;++n){var x=d[n];N("function"==typeof x&&"textureCube"===x._reglType,"invalid cube map"),l=l||x.width,N(x.width===l&&x.height===l,"invalid cube map shape"),c.color[n]={target:we,data:d[n]}}for(n=0;n<6;++n){for(var E=0;E<d.length;++E)c.color[E].target=we+n;n>0&&(c.depth=i[0].depth,c.stencil=i[0].stencil,c.depthStencil=i[0].depthStencil),i[n]?i[n](c):i[n]=A(c)}return e(a,{width:l,height:l,color:d})}return a(t),e(a,{faces:i,resize:function(t){var e,r=0|t;if(N(r>0&&r<=n.maxCubeMapSize,"invalid radius for cube fbo"),r===a.width)return a;var o=a.color;for(e=0;e<o.length;++e)o[e].resize(r);for(e=0;e<6;++e)i[e].resize(r);return a.width=a.height=r,a},_reglType:"framebufferCube",destroy:function(){i.forEach((function(t){t.destroy()}))}})},clear:function(){B(x).forEach(M)},restore:function(){s.cur=null,s.next=null,s.dirty=!0,B(x).forEach((function(e){e.framebuffer=t.createFramebuffer(),_(e)}))}})}(o,l,y,M,_,c),S=nn(o,h,l,y,w,E,0,A,{},x,b,{elements:null,primitive:4,count:-1,offset:0,instances:-1},m,f,n),k=function(e,r,n,o,i,a,s){function u(u){var d;null===r.next?(N(i.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),d=Ae):(N(null!==r.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),d=r.next.colorAttachments[0].texture._texture.type,a.oes_texture_float?(N(d===Ae||d===Se,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),d===Se&&N(s.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):N(d===Ae,"Reading from a framebuffer is only allowed for the type 'uint8'"));var h=0,c=0,l=o.framebufferWidth,f=o.framebufferHeight,g=null;t(u)?g=u:u&&(N.type(u,"object","invalid arguments to regl.read()"),h=0|u.x,c=0|u.y,N(h>=0&&h<o.framebufferWidth,"invalid x offset for regl.read"),N(c>=0&&c<o.framebufferHeight,"invalid y offset for regl.read"),l=0|(u.width||o.framebufferWidth-h),f=0|(u.height||o.framebufferHeight-c),g=u.data||null),g&&(d===Ae?N(g instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):d===Se&&N(g instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),N(l>0&&l+h<=o.framebufferWidth,"invalid width for read pixels"),N(f>0&&f+c<=o.framebufferHeight,"invalid height for read pixels"),n();var p=l*f*4;return g||(d===Ae?g=new Uint8Array(p):d===Se&&(g=g||new Float32Array(p))),N.isTypedArray(g,"data buffer for regl.read() must be a typedarray"),N(g.byteLength>=p,"data buffer for regl.read() too small"),e.pixelStorei(3333,4),e.readPixels(h,c,l,f,6408,d,g),g}return function(t){return t&&"framebuffer"in t?(e=t,r.setFBO({framebuffer:e.framebuffer},(function(){n=u(e)})),n):u(t);var e,n}}(o,A,S.procs.poll,m,i,l,y),z=S.next,C=o.canvas,L=[],H=[],$=[],X=[n.onDestroy],ht=null;function ct(){if(0===L.length)return f&&f.update(),void(ht=null);ht=T.next(ct),Te();for(var t=L.length-1;t>=0;--t){var e=L[t];e&&e(m,null,0)}o.flush(),f&&f.update()}function Ht(){!ht&&L.length>0&&(ht=T.next(ct))}function $t(){ht&&(T.cancel(ct),ht=null)}function Xt(t){t.preventDefault(),a=!0,$t(),H.forEach((function(t){t()}))}function Jt(t){o.getError(),a=!1,s.restore(),b.restore(),w.restore(),M.restore(),_.restore(),A.restore(),x.restore(),f&&f.restore(),S.procs.refresh(),Ht(),$.forEach((function(t){t()}))}function te(t){function r(t,e){var r={},n={};return Object.keys(t).forEach((function(o){var i=t[o];if(I.isDynamic(i))n[o]=I.unbox(i,o);else{if(e&&Array.isArray(i))for(var a=0;a<i.length;++a)if(I.isDynamic(i[a]))return void(n[o]=I.unbox(i,o));r[o]=i}})),{dynamic:n,static:r}}N(!!t,"invalid args to regl({...})"),N.type(t,"object","invalid args to regl({...})");var n=r(t.context||{},!0),o=r(t.uniforms||{},!0),i=r(t.attributes||{},!1),s=r(function(t){var r=e({},t);function n(t){if(t in r){var e=r[t];delete r[t],Object.keys(e).forEach((function(n){r[t+"."+n]=e[n]}))}}return delete r.uniforms,delete r.attributes,delete r.context,delete r.vao,"stencil"in r&&r.stencil.op&&(r.stencil.opBack=r.stencil.opFront=r.stencil.op,delete r.stencil.op),n("blend"),n("depth"),n("cull"),n("stencil"),n("polygonOffset"),n("scissor"),n("sample"),"vao"in t&&(r.vao=t.vao),r}(t),!1),u={gpuTime:0,cpuTime:0,count:0},d=S.compile(s,i,o,n,u),h=d.draw,c=d.batch,l=d.scope,f=[];return e((function(t,e){var r;if(a&&N.raise("context lost"),"function"==typeof t)return l.call(this,null,t,0);if("function"==typeof e)if("number"==typeof t)for(r=0;r<t;++r)l.call(this,null,e,r);else{if(!Array.isArray(t))return l.call(this,t,e,0);for(r=0;r<t.length;++r)l.call(this,t[r],e,r)}else if("number"==typeof t){if(t>0)return c.call(this,function(t){for(;f.length<t;)f.push(null);return f}(0|t),0|t)}else{if(!Array.isArray(t))return h.call(this,t);if(t.length)return c.call(this,t,t.length)}}),{stats:u,destroy:function(){d.destroy()}})}C&&(C.addEventListener(on,Xt,!1),C.addEventListener(an,Jt,!1));var ee=A.setFBO=te({framebuffer:I.define.call(null,1,"framebuffer")});function ge(t,e){var r=0;S.procs.poll();var n=e.color;n&&(o.clearColor(+n[0]||0,+n[1]||0,+n[2]||0,+n[3]||0),r|=16384),"depth"in e&&(o.clearDepth(+e.depth),r|=256),"stencil"in e&&(o.clearStencil(0|e.stencil),r|=1024),N(!!r,"called regl.clear with no buffer specified"),o.clear(r)}function ke(t){return N.type(t,"function","regl.frame() callback must be a function"),L.push(t),Ht(),{cancel:function(){var e=sn(L,t);N(e>=0,"cannot cancel a frame twice"),L[e]=function t(){var e=sn(L,t);L[e]=L[L.length-1],L.length-=1,L.length<=0&&$t()}}}}function Ie(){var t=z.viewport,e=z.scissor_box;t[0]=t[1]=e[0]=e[1]=0,m.viewportWidth=m.framebufferWidth=m.drawingBufferWidth=t[2]=e[2]=o.drawingBufferWidth,m.viewportHeight=m.framebufferHeight=m.drawingBufferHeight=t[3]=e[3]=o.drawingBufferHeight}function Te(){m.tick+=1,m.time=Re(),Ie(),S.procs.poll()}function De(){M.refresh(),Ie(),S.procs.refresh(),f&&f.update()}function Re(){return(D()-g)/1e3}De();var Oe=e(te,{clear:function(t){if(N("object"==typeof t&&t,"regl.clear() takes an object as input"),"framebuffer"in t)if(t.framebuffer&&"framebufferCube"===t.framebuffer_reglType)for(var r=0;r<6;++r)ee(e({framebuffer:t.framebuffer.faces[r]},t),ge);else ee(t,ge);else ge(0,t)},prop:I.define.bind(null,1),context:I.define.bind(null,2),this:I.define.bind(null,3),draw:te({}),buffer:function(t){return w.create(t,34962,!1,!1)},elements:function(t){return E.create(t,!1)},texture:M.create2D,cube:M.createCube,renderbuffer:_.create,framebuffer:A.create,framebufferCube:A.createCube,vao:x.createVAO,attributes:i,frame:ke,on:function(t,e){var r;switch(N.type(e,"function","listener callback must be a function"),t){case"frame":return ke(e);case"lost":r=H;break;case"restore":r=$;break;case"destroy":r=X;break;default:N.raise("invalid event, must be one of frame,lost,restore,destroy")}return r.push(e),{cancel:function(){for(var t=0;t<r.length;++t)if(r[t]===e)return r[t]=r[r.length-1],void r.pop()}}},limits:y,hasExtension:function(t){return y.extensions.indexOf(t.toLowerCase())>=0},read:k,destroy:function(){L.length=0,$t(),C&&(C.removeEventListener(on,Xt),C.removeEventListener(an,Jt)),b.clear(),A.clear(),_.clear(),M.clear(),E.clear(),w.clear(),x.clear(),f&&f.clear(),X.forEach((function(t){t()}))},_gl:o,_refresh:De,poll:function(){Te(),f&&f.update()},now:Re,stats:c});return n.onDone(null,Oe),Oe}}()}},G={};function U(t){var e=G[t];if(void 0!==e)return e.exports;var r=G[t]={id:t,loaded:!1,exports:{}};return j[t].call(r.exports,r,r.exports,U),r.loaded=!0,r.exports}U.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return U.d(e,{a:e}),e},U.d=(t,e)=>{for(var r in e)U.o(e,r)&&!U.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},U.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),U.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),U.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var V={};(()=>{U.d(V,{O:()=>Ut,I:()=>Bt});var t=function(){return(t=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function n(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(e){i(e)}}function s(t){try{u(n.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function o(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(u){s=[6,u],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}var i={913:t=>{var e=Object.prototype.hasOwnProperty,r="~";function n(){}function o(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function i(t,e,n,i,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new o(n,i||t,a),u=r?r+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],s]:t._events[u].push(s):(t._events[u]=s,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var t,n,o=[];if(0===this._eventsCount)return o;for(n in t=this._events)e.call(t,n)&&o.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},s.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,a=new Array(i);o<i;o++)a[o]=n[o].fn;return a},s.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},s.prototype.emit=function(t,e,n,o,i,a){var s=r?r+t:t;if(!this._events[s])return!1;var u,d,h=this._events[s],c=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),c){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,n),!0;case 4:return h.fn.call(h.context,e,n,o),!0;case 5:return h.fn.call(h.context,e,n,o,i),!0;case 6:return h.fn.call(h.context,e,n,o,i,a),!0}for(d=1,u=new Array(c-1);d<c;d++)u[d-1]=arguments[d];h.fn.apply(h.context,u)}else{var l,f=h.length;for(d=0;d<f;d++)switch(h[d].once&&this.removeListener(t,h[d].fn,void 0,!0),c){case 1:h[d].fn.call(h[d].context);break;case 2:h[d].fn.call(h[d].context,e);break;case 3:h[d].fn.call(h[d].context,e,n);break;case 4:h[d].fn.call(h[d].context,e,n,o);break;default:if(!u)for(l=1,u=new Array(c-1);l<c;l++)u[l-1]=arguments[l];h[d].fn.apply(h[d].context,u)}}return!0},s.prototype.on=function(t,e,r){return i(this,t,e,r,!1)},s.prototype.once=function(t,e,r){return i(this,t,e,r,!0)},s.prototype.removeListener=function(t,e,n,o){var i=r?r+t:t;if(!this._events[i])return this;if(!e)return a(this,i),this;var s=this._events[i];if(s.fn)s.fn!==e||o&&!s.once||n&&s.context!==n||a(this,i);else{for(var u=0,d=[],h=s.length;u<h;u++)(s[u].fn!==e||o&&!s[u].once||n&&s[u].context!==n)&&d.push(s[u]);d.length?this._events[i]=1===d.length?d[0]:d:a(this,i)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&a(this,e)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,t.exports=s},617:(t,e,r)=>{var n=r(331),o=["stopLayout","calculateLayout"];t.exports=function(){var t=new Worker(URL.createObjectURL(new Blob(['var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{calculateLayout:()=>_n,stopLayout:()=>In});var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function o(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function i(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function a(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function u(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}Object.create,Object.create;const d=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[],i=this._events["*"]||[],a=function(n){for(var o=n.length,i=0;i<o;i++)if(n[i]){var a=n[i],s=a.callback;a.once&&(n.splice(i,1),0===n.length&&delete e._events[t],o--,i--),s.apply(e,r)}};a(o),a(i)},t.prototype.off=function(t,e){if(t)if(e){for(var r=this._events[t]||[],n=r.length,o=0;o<n;o++)r[o].callback===e&&(r.splice(o,1),n--,o--);0===r.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function h(t,e,r,n){for(;t.length;){const o=t.shift();if(r(o))return!0;e.add(o.id),n(o.id).forEach((r=>{e.has(r.id)||(e.add(r.id),t.push(r))}))}return!1}function c(t,e,r,n){if(r(t))return!0;e.add(t.id);for(const o of n(t.id))if(!e.has(o.id)&&c(o,e,r,n))return!0;return!1}class l extends d{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const r=e.find((e=>e.type===t.type&&e.id===t.id&&e.propertyName===t.propertyName));r?r.newValue=t.newValue:e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const r=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),r=this.bothEdgesMap.get(t);r?.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((e=>{e.childrenMap.get(t)?.forEach((t=>{e.parentMap.delete(t.id)})),e.parentMap.delete(t),e.childrenMap.delete(t)})),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){const n=this.getNode(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateNodeDataProperty(t,e,r)}))}))}updateNodeData(...t){const e=t[0],r=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:o})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),o.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),o=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),o.delete(e),i.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.source,o=e;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:o})}))}updateEdgeTarget(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.target,o=e;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:o})}))}updateEdgeDataProperty(t,e,r){const n=this.getEdge(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}updateEdgeData(...t){const e=t[0],r=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:o})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateEdgeDataProperty(t,e,r)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const r=[],n=Array.isArray(t)?t:[t];for(;n.length;){const t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach((t=>{t.children?.forEach((r=>{this.setParent(r.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const r=this.treeIndices.get(e).childrenMap.get(t);return Array.from(r||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const r=[];let n,o=this.getNode(t);for(;n=this.getParent(o.id,e);)r.push(n),o=n;return r}setParent(t,e,r){this.checkTreeExistence(r);const n=this.treeIndices.get(r),o=this.getNode(t),i=n.parentMap.get(t),a=this.getNode(e);n.parentMap.set(t,a),i&&n.childrenMap.get(i.id)?.delete(o);let s=n.childrenMap.get(a.id);s||(s=new Set,n.childrenMap.set(a.id,s)),s.add(o),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:i?.id,newParentId:a.id})}))}dfsTree(t,e,r){return c(this.getNode(t),new Set,e,(t=>this.getChildren(t,r)))}bfsTree(t,e,r){return h([this.getNode(t)],new Set,e,(t=>this.getChildren(t,r)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return h([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return c(this.getNode(t),new Set,e,n)}clone(){const t=this.getAllNodes().map((t=>({...t,data:{...t.data}}))),e=this.getAllEdges().map((t=>({...t,data:{...t.data}}))),r=new l({nodes:t,edges:e});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},n)=>{const o=new Map;t.forEach(((t,e)=>{o.set(e,r.getNode(t.id))}));const i=new Map;e.forEach(((t,e)=>{i.set(e,new Set(Array.from(t).map((t=>r.getNode(t.id)))))})),r.treeIndices.set(n,{parentMap:o,childrenMap:i})})),r}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var f=/-(\\w)/g,g=(function(t){return t.replace(f,(function(t,e){return e?e.toUpperCase():""}))},Object.create(null),Array.isArray),p=function(t){for(var e=[],r=t.length,n=0;n<r;n+=1){e[n]=[];for(var o=0;o<r;o+=1)n===o?e[n][o]=0:0!==t[n][o]&&t[n][o]?e[n][o]=t[n][o]:e[n][o]=1/0}for(var i=0;i<r;i+=1)for(n=0;n<r;n+=1)for(o=0;o<r;o+=1)e[n][o]>e[n][i]+e[i][o]&&(e[n][o]=e[n][i]+e[i][o]);return e},v=function(t,e){var r=t.nodes,n=t.edges,o=[],i={};if(!r)throw new Error("invalid nodes data!");return r&&r.forEach((function(t,e){i[t.id]=e,o.push([])})),null==n||n.forEach((function(t){var r=t.source,n=t.target,a=i[r],s=i[n];void 0!==a&&void 0!==s&&(o[a][s]=1,e||(o[s][a]=1))})),o},y=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},m={}.toString;const w=function(t,e){return m.call(t)==="[object "+e+"]"},x=function(t){return w(t,"Number")};var E=function(t){if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var e=[];return t.forEach((function(t){e.push(t)})),e.map((function(t){return E(t)}))}if("object"==typeof t){var r={};return Object.keys(t).forEach((function(e){r[e]=E(t[e])})),r}return t},b=function(t,e){var r=E(t);return r.data=r.data||{},e&&(x(r.data.x)||(r.data.x=Math.random()*e[0]),x(r.data.y)||(r.data.y=Math.random()*e[1])),r};const N=function(t){return"function"==typeof t},M=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function S(t,e){return N(e)?e:x(e)?function(){return e}:function(){return t}}function k(t,e,r){return void 0===r&&(r=!0),e||0===e?N(e)?e:x(e)?function(){return e}:g(e)?function(){if(r){var n=Math.max.apply(Math,u([],s(e)));return isNaN(n)?t:n}return e}:M(e)?function(){if(r){var n=Math.max(e.width,e.height);return isNaN(n)?t:n}return[e.width,e.height]}:function(){return t}:function(e){var r=(e.data||{}).size;return r?g(r)?r[0]>r[1]?r[0]:r[1]:M(r)?r.width>r.height?r.width:r.height:r:t}}var A=function(t,e){var r;return r=x(e)?function(){return e}:N(e)?e:function(){return 0},t?g(t)?function(e){return(t[0]>t[1]?t[0]:t[1])+r(e)}:function(e){return t+r(e)}:function(t){var e,n;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return Math.max(t.data.bboxSize[0],t.data.bboxSize[1])+r(t);if(null===(n=t.data)||void 0===n?void 0:n.size){if(g(t.data.size))return Math.max(t.data.size[0],t.data.size[1])+r(t);var o=t.data.size;return M(o)?(o.width>o.height?o.width:o.height)+r(t):o+r(t)}return 10+r(t)}},R=function(t,e,r){var o=t.getAllNodes(),i=t.getAllEdges();return(null==o?void 0:o.length)?1===o.length?(e&&t.mergeNodeData(o[0].id,{x:r[0],y:r[1]}),{nodes:[n(n({},o[0]),{data:n(n({},o[0].data),{x:r[0],y:r[1]})})],edges:i}):void 0:{nodes:[],edges:i}},I={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},_=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="circular",this.options=n(n({},I),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericCircularLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericCircularLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericCircularLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,u,d,h,c,l,f,g,p,v,y,m,w,x,E,N,M,A,I,_,P,T,z,C,L,q,j,F,V,G,W,B,$,U;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,u=o.height,d=o.center,h=o.divisions,c=o.startAngle,l=void 0===c?0:c,f=o.endAngle,g=void 0===f?2*Math.PI:f,p=o.angleRatio,v=o.ordering,y=o.clockwise,m=o.nodeSpacing,w=o.nodeSize,x=e.getAllNodes(),E=e.getAllEdges(),N=s(O(i,u,d),3),M=N[0],A=N[1],I=N[2],!(_=null==x?void 0:x.length)||1===_)return[2,R(e,t,I)];for(P=(g-l)/_,T=o.radius,z=o.startRadius,C=o.endRadius,m?(L=S(10,m),q=k(10,w),j=-1/0,x.forEach((function(t){var e=q(t);j<e&&(j=e)})),F=0,x.forEach((function(t,e){F+=0===e?j||10:(L(t)||0)+(j||10)})),T=F/(2*Math.PI)):T||z||C?!z&&C?z=C:z&&!C&&(C=z):T=Math.min(A,M)/2,V=P*p,G=[],G="topology"===v?D(e,x):"topology-directed"===v?D(e,x,!0):"degree"===v?function(t,e){var r=[];return e.forEach((function(t,e){r.push(b(t))})),r.sort((function(e,r){return t.getDegree(e.id,"both")-t.getDegree(r.id,"both")})),r}(e,x):x.map((function(t){return b(t)})),W=Math.ceil(_/h),B=0;B<_;++B)($=T)||null===z||null===C||($=z+B*(C-z)/(_-1)),$||($=10+100*B/(_-1)),U=l+B%W*V+2*Math.PI/h*Math.floor(B/W),y||(U=g-B%W*V-2*Math.PI/h*Math.floor(B/W)),G[B].data.x=I[0]+Math.cos(U)*$,G[B].data.y=I[1]+Math.sin(U)*$;return t&&G.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:G,edges:E}]}))}))},t}(),D=function(t,e,r){void 0===r&&(r=!1);var n=[b(e[0])],o={},i=e.length;o[e[0].id]=!0;var a=0;return e.forEach((function(s,u){if(0!==u)if(u!==i-1&&t.getDegree(s.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(n[a].id,s.id)||o[s.id]){for(var d=r?t.getSuccessors(n[a].id):t.getNeighbors(n[a].id),h=!1,c=0;c<d.length;c++){var l=d[c];if(t.getDegree(l.id)===t.getDegree(s.id)&&!o[l.id]){n.push(b(l)),o[l.id]=!0,h=!0;break}}for(var f=0;!h&&(o[e[f].id]||(n.push(b(e[f])),o[e[f].id]=!0,h=!0),++f!==i););}else n.push(b(s)),o[s.id]=!0,a++})),n},O=function(t,e,r){var n=t,o=e,i=r;return n||"undefined"==typeof window||(n=window.innerWidth),o||"undefined"==typeof window||(o=window.innerHeight),i||(i=[n/2,o/2]),[n,o,i]};const P=function(t){return w(t,"String")};var T={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},z=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="concentric",this.options=n(n({},T),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericConcentricLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericConcentricLayout(!0,t,e),[2]}))}))},t.prototype.genericConcentricLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,p,v,y,m,w,E,S,k,A,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K,Y;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,d=o.sortBy,h=o.maxLevelDiff,c=o.sweep,l=o.clockwise,f=o.equidistant,p=o.preventOverlap,v=o.startAngle,y=void 0===v?1.5*Math.PI:v,m=o.nodeSize,w=o.nodeSpacing,E=e.getAllNodes(),S=e.getAllEdges(),k=s||"undefined"==typeof window?s:window.innerWidth,A=u||"undefined"==typeof window?u:window.innerHeight,I=i||[k/2,A/2],!(null==E?void 0:E.length)||1===E.length)return[2,R(e,t,I)];if(_=[],O=0,D=g(m)?Math.max(m[0],m[1]):m,g(w)?O=Math.max(w[0],w[1]):x(w)&&(O=w),E.forEach((function(t){var e=b(t);_.push(e);var r=D,n=e.data;g(n.size)?r=Math.max(n.size[0],n.size[1]):x(n.size)?r=n.size:M(n.size)&&(r=Math.max(n.size.width,n.size.height)),D=Math.max(D,r),N(w)&&(O=Math.max(w(t),O))})),T={},_.forEach((function(t,e){T[t.id]=e})),P(z=d)&&void 0!==_[0].data[z]||(z="degree"),"degree"===z?_.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):_.sort((function(t,e){return e.data[z]-t.data[z]})),C=_[0],L=(h||("degree"===z?e.getDegree(C.id,"both"):C.data[z]))/4,j=(q=[{nodes:[]}])[0],_.forEach((function(t){if(j.nodes.length>0){var r="degree"===z?Math.abs(e.getDegree(j.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(j.nodes[0].data[z]-t.data[z]);L&&r>=L&&(j={nodes:[]},q.push(j))}j.nodes.push(t)})),F=D+O,p||(V=q.length>0&&q[0].nodes.length>1,G=Math.min(k,A)/2-F,W=G/(q.length+(V?1:0)),F=Math.min(F,W)),B=0,q.forEach((function(t){var e=void 0===c?2*Math.PI-2*Math.PI/t.nodes.length:c;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&p){var r=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),o=Math.sqrt(F*F/(r*r+n*n));B=Math.max(o,B)}t.r=B,B+=F})),f){for($=0,U=0,H=0;H<q.length;H++)K=q[H],Y=(K.r||0)-U,$=Math.max($,Y);U=0,q.forEach((function(t,e){0===e&&(U=t.r||0),t.r=U,U+=$}))}return q.forEach((function(t){var e=t.dTheta||0,r=t.r||0;t.nodes.forEach((function(t,n){var o=y+(l?1:-1)*e*n;t.data.x=I[0]+r*Math.cos(o),t.data.y=I[1]+r*Math.sin(o)}))})),t&&_.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:_,edges:S}]}))}))},t}();function C(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i,a,s,u,d,h,c,l,f=t._root,g={data:n},p=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!f)return t._root=g,t;for(;f.length;)if((d=e>=(i=(p+y)/2))?p=i:y=i,(h=r>=(a=(v+m)/2))?v=a:m=a,o=f,!(f=f[c=h<<1|d]))return o[c]=g,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&r===u)return g.next=f,o?o[c]=g:t._root=g,t;do{o=o?o[c]=new Array(4):t._root=new Array(4),(d=e>=(i=(p+y)/2))?p=i:y=i,(h=r>=(a=(v+m)/2))?v=a:m=a}while((c=h<<1|d)==(l=(u>=a)<<1|s>=i));return o[l]=f,o[c]=g,t}function L(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function q(t){return t[0]}function j(t){return t[1]}function F(t,e,r){var n=new V(null==e?q:e,null==r?j:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function V(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function G(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var W=F.prototype=V.prototype;function B(t){return function(){return t}}function $(t){return 1e-6*(t()-.5)}W.copy=function(){var t,e,r=new V(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=G(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var o=0;o<4;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(4)}):n.target[o]=G(e));return r},W.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return C(this.cover(e,r),e,r,t)},W.addAll=function(t){var e,r,n,o,i=t.length,a=new Array(i),s=new Array(i),u=1/0,d=1/0,h=-1/0,c=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(a[r]=n,s[r]=o,n<u&&(u=n),n>h&&(h=n),o<d&&(d=o),o>c&&(c=o));if(u>h||d>c)return this;for(this.cover(u,d).cover(h,c),r=0;r<i;++r)C(this,a[r],s[r],t[r]);return this},W.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var a,s,u=o-r||1,d=this._root;r>t||t>=o||n>e||e>=i;)switch(s=(e<n)<<1|t<r,(a=new Array(4))[s]=d,d=a,u*=2,s){case 0:o=r+u,i=n+u;break;case 1:r=o-u,i=n+u;break;case 2:o=r+u,n=i-u;break;case 3:r=o-u,n=i-u}this._root&&this._root.length&&(this._root=d)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this},W.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},W.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},W.find=function(t,e,r){var n,o,i,a,s,u,d,h=this._x0,c=this._y0,l=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new L(p,h,c,l,f)),null==r?r=1/0:(h=t-r,c=e-r,l=t+r,f=e+r,r*=r);u=g.pop();)if(!(!(p=u.node)||(o=u.x0)>l||(i=u.y0)>f||(a=u.x1)<h||(s=u.y1)<c))if(p.length){var v=(o+a)/2,y=(i+s)/2;g.push(new L(p[3],v,y,a,s),new L(p[2],o,y,v,s),new L(p[1],v,i,a,y),new L(p[0],o,i,v,y)),(d=(e>=y)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-d],g[g.length-1-d]=u)}else{var m=t-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),x=m*m+w*w;if(x<r){var E=Math.sqrt(r=x);h=t-E,c=e-E,l=t+E,f=e+E,n=p.data}}return n},W.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,r,n,o,i,a,s,u,d,h,c,l,f=this._root,g=this._x0,p=this._y0,v=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((d=i>=(s=(g+v)/2))?g=s:v=s,(h=a>=(u=(p+y)/2))?p=u:y=u,e=f,!(f=f[c=h<<1|d]))return this;if(!f.length)break;(e[c+1&3]||e[c+2&3]||e[c+3&3])&&(r=e,l=c)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(o=f.next)&&delete f.next,n?(o?n.next=o:delete n.next,this):e?(o?e[c]=o:delete e[c],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[l]=f:this._root=f),this):(this._root=o,this)},W.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},W.root=function(){return this._root},W.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},W.visit=function(t){var e,r,n,o,i,a,s=[],u=this._root;for(u&&s.push(new L(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,n=e.x0,o=e.y0,i=e.x1,a=e.y1)&&u.length){var d=(n+i)/2,h=(o+a)/2;(r=u[3])&&s.push(new L(r,d,h,i,a)),(r=u[2])&&s.push(new L(r,n,h,d,a)),(r=u[1])&&s.push(new L(r,d,o,i,h)),(r=u[0])&&s.push(new L(r,n,o,d,h))}return this},W.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new L(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.x1,d=e.y1,h=(a+u)/2,c=(s+d)/2;(i=o[0])&&r.push(new L(i,a,s,h,c)),(i=o[1])&&r.push(new L(i,h,s,u,c)),(i=o[2])&&r.push(new L(i,a,c,h,d)),(i=o[3])&&r.push(new L(i,h,c,u,d))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},W.x=function(t){return arguments.length?(this._x=t,this):this._x},W.y=function(t){return arguments.length?(this._y=t,this):this._y};var U={value:()=>{}};function H(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new K(n)}function K(t){this._=t}function Y(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function J(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=U,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}K.prototype=H.prototype={constructor:K,on:function(t,e){var r,n,o=this._,i=(n=o,(t+"").trim().split(/^|\\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)o[r]=J(o[r],t.name,e);else if(null==e)for(r in o)o[r]=J(o[r],t.name,null);return this}for(;++a<s;)if((r=(t=i[a]).type)&&(r=Y(o[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new K(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};const X=H;var Q,Z,tt=0,et=0,rt=0,nt=1e3,ot=0,it=0,at=0,st="object"==typeof performance&&performance.now?performance:Date,ut="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function dt(){return it||(ut(ht),it=st.now()+at)}function ht(){it=0}function ct(){this._call=this._time=this._next=null}function lt(t,e,r){var n=new ct;return n.restart(t,e,r),n}function ft(){it=(ot=st.now())+at,tt=et=0;try{!function(){dt(),++tt;for(var t,e=Q;e;)(t=it-e._time)>=0&&e._call.call(void 0,t),e=e._next;--tt}()}finally{tt=0,function(){for(var t,e,r=Q,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:Q=e);Z=t,pt(n)}(),it=0}}function gt(){var t=st.now(),e=t-ot;e>nt&&(at-=e,ot=t)}function pt(t){tt||(et&&(et=clearTimeout(et)),t-it>24?(t<1/0&&(et=setTimeout(ft,t-st.now()-at)),rt&&(rt=clearInterval(rt))):(rt||(ot=st.now(),rt=setInterval(gt,nt)),tt=1,ut(ft)))}ct.prototype=lt.prototype={constructor:ct,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?dt():+r)+(null==e?0:+e),this._next||Z===this||(Z?Z._next=this:Q=this,Z=this),this._call=t,this._time=r,pt()},stop:function(){this._call&&(this._call=null,this._time=1/0,pt())}};const vt=1664525,yt=1013904223,mt=4294967296;function wt(t){return t.x}function xt(t){return t.y}var Et=10,bt=Math.PI*(3-Math.sqrt(5));function Nt(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,a=.6,s=new Map,u=lt(c),d=X("tick","end"),h=function(){let t=1;return()=>(t=(vt*t+yt)%mt)/mt}();function c(){l(),d.call("tick",e),r<n&&(u.stop(),d.call("end",e))}function l(n){var u,d,h=t.length;void 0===n&&(n=1);for(var c=0;c<n;++c)for(r+=(i-r)*o,s.forEach((function(t){t(r)})),u=0;u<h;++u)null==(d=t[u]).fx?d.x+=d.vx*=a:(d.x=d.fx,d.vx=0),null==d.fy?d.y+=d.vy*=a:(d.y=d.fy,d.vy=0);return e}function f(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var o=Et*Math.sqrt(.5+r),i=r*bt;e.x=o*Math.cos(i),e.y=o*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,h),e}return null==t&&(t=[]),f(),e={tick:l,restart:function(){return u.restart(c),e},stop:function(){return u.stop(),e},nodes:function(r){return arguments.length?(t=r,f(),s.forEach(g),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(h=t,s.forEach(g),e):h},force:function(t,r){return arguments.length>1?(null==r?s.delete(t):s.set(t,g(r)),e):s.get(t)},find:function(e,r,n){var o,i,a,s,u,d=0,h=t.length;for(null==n?n=1/0:n*=n,d=0;d<h;++d)(a=(o=e-(s=t[d]).x)*o+(i=r-s.y)*i)<n&&(u=s,n=a);return u},on:function(t,r){return arguments.length>1?(d.on(t,r),e):d.on(t)}}}function Mt(){var t,e,r,n,o,i=B(-30),a=1,s=1/0,u=.81;function d(r){var o,i=t.length,a=F(t,wt,xt).visitAfter(c);for(n=r,o=0;o<i;++o)e=t[o],a.visit(l)}function h(){if(t){var e,r,n=t.length;for(o=new Array(n),e=0;e<n;++e)r=t[e],o[r.index]=+i(r,e,t)}}function c(t){var e,r,n,i,a,s=0,u=0;if(t.length){for(n=i=a=0;a<4;++a)(e=t[a])&&(r=Math.abs(e.value))&&(s+=e.value,u+=r,n+=r*e.x,i+=r*e.y);t.x=n/u,t.y=i/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=o[e.data.index]}while(e=e.next)}t.value=s}function l(t,i,d,h){if(!t.value)return!0;var c=t.x-e.x,l=t.y-e.y,f=h-i,g=c*c+l*l;if(f*f/u<g)return g<s&&(0===c&&(g+=(c=$(r))*c),0===l&&(g+=(l=$(r))*l),g<a&&(g=Math.sqrt(a*g)),e.vx+=c*t.value*n/g,e.vy+=l*t.value*n/g),!0;if(!(t.length||g>=s)){(t.data!==e||t.next)&&(0===c&&(g+=(c=$(r))*c),0===l&&(g+=(l=$(r))*l),g<a&&(g=Math.sqrt(a*g)));do{t.data!==e&&(f=o[t.data.index]*n/g,e.vx+=c*f,e.vy+=l*f)}while(t=t.next)}}return d.initialize=function(e,n){t=e,r=n,h()},d.strength=function(t){return arguments.length?(i="function"==typeof t?t:B(+t),h(),d):i},d.distanceMin=function(t){return arguments.length?(a=t*t,d):Math.sqrt(a)},d.distanceMax=function(t){return arguments.length?(s=t*t,d):Math.sqrt(s)},d.theta=function(t){return arguments.length?(u=t*t,d):Math.sqrt(u)},d}function St(t){return t.index}function kt(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function At(t){var e,r,n,o,i,a,s=St,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},d=B(30),h=1;function c(n){for(var o=0,s=t.length;o<h;++o)for(var u,d,c,l,f,g,p,v=0;v<s;++v)d=(u=t[v]).source,l=(c=u.target).x+c.vx-d.x-d.vx||$(a),f=c.y+c.vy-d.y-d.vy||$(a),l*=g=((g=Math.sqrt(l*l+f*f))-r[v])/g*n*e[v],f*=g,c.vx-=l*(p=i[v]),c.vy-=f*p,d.vx+=l*(p=1-p),d.vy+=f*p}function l(){if(n){var a,u,d=n.length,h=t.length,c=new Map(n.map(((t,e)=>[s(t,e,n),t])));for(a=0,o=new Array(d);a<h;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=kt(c,u.source)),"object"!=typeof u.target&&(u.target=kt(c,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(a=0,i=new Array(h);a<h;++a)u=t[a],i[a]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);e=new Array(h),f(),r=new Array(h),g()}}function f(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+u(t[r],r,t)}function g(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+d(t[e],e,t)}return null==t&&(t=[]),c.initialize=function(t,e){n=t,a=e,l()},c.links=function(e){return arguments.length?(t=e,l(),c):t},c.id=function(t){return arguments.length?(s=t,c):s},c.iterations=function(t){return arguments.length?(h=+t,c):h},c.strength=function(t){return arguments.length?(u="function"==typeof t?t:B(+t),f(),c):u},c.distance=function(t){return arguments.length?(d="function"==typeof t?t:B(+t),g(),c):d},c}function Rt(t){return t.x+t.vx}function It(t){return t.y+t.vy}function _t(t){var e,r,n,o=1,i=1;function a(){for(var t,a,u,d,h,c,l,f=e.length,g=0;g<i;++g)for(a=F(e,Rt,It).visitAfter(s),t=0;t<f;++t)u=e[t],c=r[u.index],l=c*c,d=u.x+u.vx,h=u.y+u.vy,a.visit(p);function p(t,e,r,i,a){var s=t.data,f=t.r,g=c+f;if(!s)return e>d+g||i<d-g||r>h+g||a<h-g;if(s.index>u.index){var p=d-s.x-s.vx,v=h-s.y-s.vy,y=p*p+v*v;y<g*g&&(0===p&&(y+=(p=$(n))*p),0===v&&(y+=(v=$(n))*v),y=(g-(y=Math.sqrt(y)))/y*o,u.vx+=(p*=y)*(g=(f*=f)/(l+f)),u.vy+=(v*=y)*g,s.vx-=p*(g=1-g),s.vy-=v*g)}}}function s(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var n,o,i=e.length;for(r=new Array(i),n=0;n<i;++n)o=e[n],r[o.index]=+t(o,n,e)}}return"function"!=typeof t&&(t=B(null==t?1:+t)),a.initialize=function(t,r){e=t,n=r,u()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(o=+t,a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),u(),a):t},a}function Dt(t){var e,r,n,o=B(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=B(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:B(+t),a(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),a(),i):t},i}function Ot(t){var e,r,n,o=B(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=B(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:B(+t),a(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),a(),i):t},i}function Pt(){function t(t){return function(){return t}}var e,r=function(t){return t.cluster},n=t(1),o=t(-1),i=t(100),a=t(.1),u=[0,0],d=[],h={},c=[],l=100,f=100,g={none:{x:0,y:0}},p=[],v="force",y=!0,m=.1;function w(t){if(!y)return w;e.tick(),E();for(var n=0,o=d.length,i=void 0,a=t*m;n<o;++n)(i=d[n]).vx+=(g[r(i)].x-i.x)*a,i.vy+=(g[r(i)].y-i.y)*a}function x(){d&&function(){if(d&&d.length){if(void 0===r(d[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy(\'clusterAttr\') before calling .links()");var t,u,g,v,y,m=(t=[],u=[],g={},{},y=[],v=function(t){var e={};return t.forEach((function(t){var n=r(t);e[n]||(e[n]={count:0,sumforceNodeSize:0})})),t.forEach((function(t){var o=r(t),i=n(t),a=e[o];a.count=a.count+1,a.sumforceNodeSize=a.sumforceNodeSize+Math.PI*(i*i)*1.3,e[o]=a})),e}(d),y=function(t){var e={},n=[];return t.forEach((function(t){var n,o,i,a,s,u=(o=(n=t).source,i=n.target,(a=r(h[o]))<=(s=r(h[i]))?a+"~"+s:s+"~"+a),d=0;void 0!==e[u]&&(d=e[u]),d+=1,e[u]=d})),Object.entries(e).forEach((function(t){var e=s(t,2),r=e[0],o=e[1],i=r.split("~")[0],a=r.split("~")[1];void 0!==i&&void 0!==a&&n.push({source:i,target:a,count:o})})),n}(c),Object.keys(v).forEach((function(e,r){var n=v[e];t.push({id:e,size:n.count,r:Math.sqrt(n.sumforceNodeSize/Math.PI)}),g[e]=r})),y.forEach((function(t){var e=t.source,r=t.target,n=g[e],o=g[r];void 0!==n&&void 0!==o&&u.push({source:n,target:o,count:t.count})})),{nodes:t,links:u});e=Nt(m.nodes).force("x",Dt(l).strength(.1)).force("y",Ot(f).strength(.1)).force("collide",_t((function(t){return t.r})).iterations(4)).force("charge",Mt().strength(o)).force("links",At(m.nodes.length?m.links:[]).distance(i).strength(a)),p=e.nodes(),E()}}()}function E(){return g={none:{x:0,y:0}},p.forEach((function(t){g[t.id]={x:t.x-u[0],y:t.y-u[1]}})),g}return w.initialize=function(t){d=t,x()},w.template=function(t){return arguments.length?(v=t,x(),w):v},w.groupBy=function(t){return arguments.length?"string"==typeof t?(r=function(e){return e[t]},w):(r=t,w):r},w.enableGrouping=function(t){return arguments.length?(y=t,w):y},w.strength=function(t){return arguments.length?(m=t,w):m},w.centerX=function(t){return arguments.length?(l=t,w):l},w.centerY=function(t){return arguments.length?(f=t,w):f},w.nodes=function(t){return arguments.length?(function(t){h={},t.forEach((function(t){h[t.id]=t}))}(t||[]),d=t||[],w):d},w.links=function(t){return arguments.length?(c=t||[],x(),w):c},w.forceNodeSize=function(e){return arguments.length?(n="function"==typeof e?e:t(+e),x(),w):n},w.nodeSize=w.forceNodeSize,w.forceCharge=function(e){return arguments.length?(o="function"==typeof e?e:t(+e),x(),w):o},w.forceLinkDistance=function(e){return arguments.length?(i="function"==typeof e?e:t(+e),x(),w):i},w.forceLinkStrength=function(e){return arguments.length?(a="function"==typeof e?e:t(+e),x(),w):a},w.offset=function(t){return arguments.length?(u=t,w):u},w.getFocis=E,w}var Tt={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},zt=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="d3force",this.options=n(n({},Tt),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){var t;null===(t=this.forceSimulation)||void 0===t||t.stop()},t.prototype.tick=function(t){var e=this;void 0===t&&(t=1),this.forceSimulation.tick(t);var r={nodes:Ct(this.lastLayoutNodes),edges:Lt(this.lastLayoutEdges)};return this.lastAssign&&r.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,g,p,v,y,m,w,x,E,N,M,S,k,A,R,I,_,D,O=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=i.map((function(t){var e,r;return n(n({},b(t)),{x:null===(e=t.data)||void 0===e?void 0:e.x,y:null===(r=t.data)||void 0===r?void 0:r.y})})),d=s.map((function(t){return b(t)})),this.lastLayoutNodes=u,this.lastLayoutEdges=d,this.lastAssign=t,this.lastGraph=e,h=o.alphaMin,c=o.alphaDecay,l=o.alpha,f=o.nodeStrength,g=o.edgeStrength,p=o.linkDistance,v=o.clustering,y=o.clusterFociStrength,m=o.clusterEdgeDistance,w=o.clusterEdgeStrength,x=o.clusterNodeStrength,E=o.clusterNodeSize,N=o.collideStrength,M=void 0===N?1:N,S=o.center,k=void 0===S?[0,0]:S,A=o.preventOverlap,R=o.nodeSize,I=o.nodeSpacing,_=o.onTick,D=o.forceSimulation,[2,new Promise((function(r){if(D){v&&((i=Pt()).nodes(u),i.links(d)),D.nodes(u),d&&(s=At().id((function(t){return t.id})).links(d),g&&s.strength(g),p&&s.distance(p),D.force("link",s)),A&&O.overlapProcess(D,{nodeSize:R,nodeSpacing:I,collideStrength:M}),D.alpha(l).restart();var n=Ct(u),o=Lt(d);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:o})}else try{var i,a=Mt();if(f&&a.strength(f),D=Nt().nodes(u),v&&((i=Pt()).centerX(k[0]).centerY(k[1]).template("force").strength(y),d&&i.links(d),u&&i.nodes(u),i.forceLinkDistance(m).forceLinkStrength(w).forceCharge(x).forceNodeSize(E),D.force("group",i)),D.force("center",function(t,e){var r,n=1;function o(){var o,i,a=r.length,s=0,u=0;for(o=0;o<a;++o)s+=(i=r[o]).x,u+=i.y;for(s=(s/a-t)*n,u=(u/a-e)*n,o=0;o<a;++o)(i=r[o]).x-=s,i.y-=u}return null==t&&(t=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(n=+t,o):n},o}(k[0],k[1])).force("charge",a).alpha(l).alphaDecay(c).alphaMin(h),A&&O.overlapProcess(D,{nodeSize:R,nodeSpacing:I,collideStrength:M}),d){var s=At().id((function(t){return t.id})).links(d);g&&s.strength(g),p&&s.distance(p),D.force("link",s)}D.on("tick",(function(){var r=Ct(u);null==_||_({nodes:r,edges:Lt(d)}),t&&r.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}))})).on("end",(function(){var n=Ct(u);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:Lt(d)})}))}catch(t){console.warn(t)}O.forceSimulation=D}))]}))}))},t.prototype.overlapProcess=function(t,e){var r,n,o=e.nodeSize,i=e.nodeSpacing,a=e.collideStrength;if(n=x(i)?function(){return i}:N(i)?i:function(){return 0},o)if(N(o))r=function(t){return o(t)+n(t)};else if(g(o)){var s=(o[0]>o[1]?o[0]:o[1])/2;r=function(t){return s+n(t)}}else if(x(o)){var u=o/2;r=function(t){return u+n(t)}}else r=function(){return 10};else r=function(t){return t.size?g(t.size)?(t.size[0]>t.size[1]?t.size[0]:t.size[1])/2+n(t):M(t.size)?(t.size.width>t.size.height?t.size.width:t.size.height)/2+n(t):t.size/2+n(t):10+n(t)};t.force("collisionForce",_t(r).strength(a))},t}(),Ct=function(t){return t.map((function(t){var e=t.x,r=t.y,i=o(t,["x","y"]);return n(n({},i),{data:n(n({},i.data),{x:e,y:r})})}))},Lt=function(t){return t.map((function(t){var e=t.source,r=t.target,i=o(t,["source","target"]);return n(n({},i),{source:e.id,target:r.id})}))};var qt=function(t,e){if("next"!==t&&"prev"!==t)return e},jt=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(function(){function t(){var t={};t.prev=t,t.next=t.prev,this.shortcut=t}return t.prototype.dequeue=function(){var t=this.shortcut,e=t.prev;if(e&&e!==t)return jt(e),e},t.prototype.enqueue=function(t){var e=this.shortcut;t.prev&&t.next&&jt(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e},t.prototype.toString=function(){for(var t=[],e=this.shortcut,r=e.prev;r!==e;)t.push(JSON.stringify(r,qt)),r=null==r?void 0:r.prev;return"["+t.join(", ")+"]"},t}()),Vt=function(){return 1},Gt=function(t,e,r,o,i){var a,s,u=[];return t.hasNode(o.v)&&(null===(a=t.getRelatedEdges(o.v,"in"))||void 0===a||a.forEach((function(o){var a=o.data.weight,s=t.getNode(o.source);i&&u.push({v:o.source,w:o.target,in:0,out:0}),void 0===s.data.out&&(s.data.out=0),s.data.out-=a,Wt(e,r,n({v:s.id},s.data))})),null===(s=t.getRelatedEdges(o.v,"out"))||void 0===s||s.forEach((function(o){var i=o.data.weight,a=o.target,s=t.getNode(a);void 0===s.data.in&&(s.data.in=0),s.data.in-=i,Wt(e,r,n({v:s.id},s.data))})),t.removeNode(o.v)),i?u:void 0},Wt=function(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},Bt=function(t,e){var r="greedy"===e?function(t,e){var r;if(t.getAllNodes().length<=1)return[];var o=function(t,e){var r=new l,o=0,i=0;t.getAllNodes().forEach((function(t){r.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((function(t){var a=r.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target})),s=(null==e?void 0:e(t))||1;a?r.updateEdgeData(null==a?void 0:a.id,n(n({},a.data),{weight:a.data.weight+s})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:s}}),i=Math.max(i,r.getNode(t.source).data.out+=s),o=Math.max(o,r.getNode(t.target).data.in+=s)}));for(var a=[],s=i+o+3,u=0;u<s;u++)a.push(new Ft);var d=o+1;return r.getAllNodes().forEach((function(t){Wt(a,d,n({v:t.id},r.getNode(t.id).data))})),{buckets:a,zeroIdx:d,graph:r}}(t,function(t){return t.data.weight||1}||Vt);return null===(r=function(t,e,r){for(var n,o=[],i=e[e.length-1],a=e[0];t.getAllNodes().length;){for(;n=a.dequeue();)Gt(t,e,r,n);for(;n=i.dequeue();)Gt(t,e,r,n);if(t.getAllNodes().length)for(var s=e.length-2;s>0;--s)if(n=e[s].dequeue()){o=o.concat(Gt(t,e,r,n,!0));break}}return o}(o.graph,o.buckets,o.zeroIdx).map((function(e){return t.getRelatedEdges(e.v,"out").filter((function(t){return t.target===e.w}))})))||void 0===r?void 0:r.flat()}(t):$t(t);null==r||r.forEach((function(e){var r=e.data;t.removeEdge(e.id),r.forwardName=e.data.name,r.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:n({},r)})}))},$t=function(t){var e=[],r={},n={},o=function(i){n[i]||(n[i]=!0,r[i]=!0,t.getRelatedEdges(i,"out").forEach((function(t){r[t.target]?e.push(t):o(t.target)})),delete r[i])};return t.getAllNodes().forEach((function(t){return o(t.id)})),e},Ut=function(t,e,r,n){var o;do{o=""+n+Math.random()}while(t.hasNode(o));return r.dummy=e,t.addNode({id:o,data:r}),o},Ht=function(t){var e=new l;return t.getAllNodes().forEach((function(r){t.getChildren(r.id).length||e.addNode(n({},r))})),t.getAllEdges().forEach((function(t){e.addEdge(t)})),e},Kt=function(t,e){var r,n,o=Number(t.x),i=Number(t.y),a=Number(e.x)-o,s=Number(e.y)-i,u=Number(t.width)/2,d=Number(t.height)/2;return a||s?(Math.abs(s)*u>Math.abs(a)*d?(s<0&&(d=-d),r=d*a/s,n=d):(a<0&&(u=-u),r=u,n=u*s/a),{x:o+r,y:i+n}):{x:0,y:0}},Yt=function(t){for(var e=[],r=Xt(t)+1,n=0;n<r;n++)e.push([]);for(t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)})),n=0;n<r;n++)e[n]=e[n].sort((function(e,r){return n=t.getNode(e).data.order,o=t.getNode(r).data.order,Number(n)-Number(o);var n,o}));return e},Jt=function(t,e,r,n){var o={width:0,height:0};return x(r)&&x(n)&&(o.rank=r,o.order=n),Ut(t,"border",o,e)},Xt=function(t){var e;return t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)})),e||(e=0),e},Qt=function(t,e){return t.reduce((function(t,r){return e(t)>e(r)?r:t}))},Zt=function(t,e,r,n,o,i){n.includes(e.id)||(n.push(e.id),r||i.push(e.id),o(e.id).forEach((function(e){return Zt(t,e,r,n,o,i)})),r&&i.push(e.id))},te=function(t,e,r,n){var o=Array.isArray(e)?e:[e],i=function(e){return n?t.getSuccessors(e):t.getNeighbors(e)},a=[],s=[];return o.forEach((function(e){if(!t.hasNode(e.id))throw new Error("Graph does not have node: "+e);Zt(t,e,"post"===r,s,i,a)})),a},ee="edge-label",re=function(t){var e={},r=function(n){var o,i,a=t.getNode(n);return a?e[n]?a.data.rank:(e[n]=!0,null===(o=t.getRelatedEdges(n,"out"))||void 0===o||o.forEach((function(t){var e=r(t.target)-t.data.minlen;e&&(void 0===i||e<i)&&(i=e)})),i||(i=0),a.data.rank=i,i):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){return r(t.id)}))},ne=function(t,e){return t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen},oe=function(t,e){var r=function(n){e.getRelatedEdges(n,"both").forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ie=function(t,e){var r=function(n){var o;null===(o=e.getRelatedEdges(n,"both"))||void 0===o||o.forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||void 0===e.getNode(a).data.layer&&ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ae=function(t,e){return Qt(e.getAllEdges(),(function(r){return t.hasNode(r.source)!==t.hasNode(r.target)?ne(e,r):1/0}))},se=function(t,e,r){t.getAllNodes().forEach((function(t){var n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r}))},ue=function(t,e){var r=te(t,t.getAllNodes(),"post",!1);(r=r.slice(0,(null==r?void 0:r.length)-1)).forEach((function(r){de(t,e,r)}))},de=function(t,e,r){var n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find((function(t){return t.target===n||t.source===n})).data.cutvalue=he(t,e,r)},he=function(t,e,r){var n=t.getNode(r).data.parent,o=!0,i=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),a=0;return i||(o=!1,i=e.getRelatedEdges(n,"out").find((function(t){return t.target===r}))),a=i.data.weight,e.getRelatedEdges(r,"both").forEach((function(e){var i=e.source===r,s=i?e.target:e.source;if(s!==n){var u=i===o,d=e.data.weight;if(a+=u?d:-d,ye(t,r,s)){var h=t.getRelatedEdges(r,"both").find((function(t){return t.source===s||t.target===s})).data.cutvalue;a+=u?-h:h}}})),a},ce=function(t,e){void 0===e&&(e=t.getAllNodes()[0].id),le(t,{},1,e)},le=function(t,e,r,n,o){var i,a=r,s=r,u=t.getNode(n);return e[n]=!0,null===(i=t.getNeighbors(n))||void 0===i||i.forEach((function(r){e[r.id]||(s=le(t,e,s,r.id,n))})),u.data.low=a,u.data.lim=s++,o?u.data.parent=o:delete u.data.parent,s},fe=function(t){return t.getAllEdges().find((function(t){return t.data.cutvalue<0}))},ge=function(t,e,r){var n=r.source,o=r.target;e.getRelatedEdges(n,"out").find((function(t){return t.target===o}))||(n=r.target,o=r.source);var i=t.getNode(n),a=t.getNode(o),s=i,u=!1;i.data.lim>a.data.lim&&(s=a,u=!0);var d=e.getAllEdges().filter((function(e){return u===me(t.getNode(e.source),s)&&u!==me(t.getNode(e.target),s)}));return Qt(d,(function(t){return ne(e,t)}))},pe=function(t,e,r,n){var o=t.getRelatedEdges(r.source,"both").find((function(t){return t.source===r.target||t.target===r.target}));o&&t.removeEdge(o.id),t.addEdge({id:"e"+Math.random(),source:n.source,target:n.target,data:{}}),ce(t),ue(t,e),ve(t,e)},ve=function(t,e){var r=t.getAllNodes().find((function(t){return!t.data.parent})),n=te(t,r,"pre",!1);(n=n.slice(1)).forEach((function(r){var n=t.getNode(r).data.parent,o=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),i=!1;!o&&e.hasNode(n)&&(o=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),i=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(i?null==o?void 0:o.data.minlen:-(null==o?void 0:o.data.minlen))}))},ye=function(t,e,r){return t.getRelatedEdges(e,"both").find((function(t){return t.source===r||t.target===r}))},me=function(t,e){return e.data.low<=t.data.lim&&t.data.lim<=e.data.lim},we=re,xe=function(t){!function(t){var e=function(t){var e=new l;return t.getAllNodes().forEach((function(t){e.addNode(n({},t))})),t.getAllEdges().forEach((function(t){var r=e.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target}));r?e.updateEdgeData(null==r?void 0:r.id,n(n({},r.data),{weight:r.data.weight+t.data.weight||0,minlen:Math.max(r.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e}(t);re(e);var r,o,i=function(t){var e,r,n=new l({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);oe(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r);return n}(e);for(ce(i),ue(i,e);r=fe(i);)o=ge(i,e,r),pe(i,e,r,o)}(t)},Ee=function(t,e,r,n,o,i,a){var s=t.getChildren(a);if(null==s?void 0:s.length){var u=Jt(t,"_bt"),d=Jt(t,"_bb"),h=t.getNode(a);t.setParent(u,a),h.data.borderTop=u,t.setParent(d,a),h.data.borderBottom=d,null==s||s.forEach((function(s){Ee(t,e,r,n,o,i,s.id);var h=s.data.borderTop?s.data.borderTop:s.id,c=s.data.borderBottom?s.data.borderBottom:s.id,l=s.data.borderTop?n:2*n,f=h!==c?1:o-i[a]+1;t.addEdge({id:"e"+Math.random(),source:u,target:h,data:{minlen:f,weight:l,nestingEdge:!0}}),t.addEdge({id:"e"+Math.random(),source:c,target:d,data:{minlen:f,weight:l,nestingEdge:!0}})})),t.getParent(a)||t.addEdge({id:"e"+Math.random(),source:e,target:u,data:{weight:0,minlen:o+i[a]}})}else a!==e&&t.addEdge({id:"e"+Math.random(),source:e,target:a,data:{weight:0,minlen:r}})},be=function(t,e,r,n,o,i){var a={rank:i,borderType:e,width:0,height:0},s=o.data[e][i-1],u=Ut(t,"border",a,r);o.data[e][i]=u,t.setParent(u,n),s&&t.addEdge({id:"e"+Math.random(),source:s,target:u,data:{weight:1}})},Ne=function(t){t.getAllNodes().forEach((function(t){Me(t)})),t.getAllEdges().forEach((function(t){Me(t)}))},Me=function(t){var e=t.data.width;t.data.width=t.data.height,t.data.height=e},Se=function(t){(null==t?void 0:t.y)&&(t.y=-t.y)},ke=function(t){var e=t.x;t.x=t.y,t.y=e},Ae=function(t){for(var e={},r=t.getAllNodes(),n=r.map((function(t){var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),o=Math.max.apply(Math,u([],s(n))),i=[],a=0;a<o+1;a++)i.push([]);var d=r.sort((function(e,r){return t.getNode(e.id).data.rank-t.getNode(r.id).data.rank})),h=d.filter((function(e){return void 0!==t.getNode(e.id).data.fixorder})).sort((function(e,r){return t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder}));return null==h||h.forEach((function(r){isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0})),null==d||d.forEach((function(r){return t.dfsTree(r.id,(function(t){if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)}))})),i},Re=function(t,e,r){for(var n=function(t,e){return null==t?void 0:t.reduce((function(t,r,n){return t[r]=e[n],t}),{})}(r,r.map((function(t,e){return e}))),o=e.map((function(e){var r=t.getRelatedEdges(e,"out").map((function(t){return{pos:n[t.target]||0,weight:t.data.weight}}));return null==r?void 0:r.sort((function(t,e){return t.pos-e.pos}))})),i=o.flat().filter((function(t){return void 0!==t})),a=1;a<r.length;)a<<=1;var s=2*a-1;a-=1;var u=Array(s).fill(0,0,s),d=0;return null==i||i.forEach((function(t){if(t){var e=t.pos+a;u[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=u[e+1]),u[e=e-1>>1]+=t.weight;d+=t.weight*r}})),d},Ie=function(t,e){for(var r=0,n=1;n<(null==e?void 0:e.length);n+=1)r+=Re(t,e[n-1],e[n]);return r},_e=function(t,e){var r,n=0,o=0;t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/o,t.weight=o,t.i=Math.min(e.i,t.i),e.merged=!0};const De=function(t,e){var r,n,o,i={};return null==t||t.forEach((function(t,e){i[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};var r=i[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)})),null===(r=e.getAllEdges())||void 0===r||r.forEach((function(t){var e=i[t.source],r=i[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(i[t.target]))})),function(t){for(var e,r,n=[],o=function(){var o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach((function(t){return(e=o,function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&_e(e,t)})(t);var e})),null===(r=o.out)||void 0===r||r.forEach((function(e){return(r=o,function(e){e.in.push(r),0==--e.indegree&&t.push(e)})(e);var r}))};null==t?void 0:t.length;)o();var i=n.filter((function(t){return!t.merged})),a=["vs","i","barycenter","weight"];return i.map((function(t){var e={};return null==a||a.forEach((function(r){void 0!==t[r]&&(e[r]=t[r])})),e}))}(null===(o=(n=Object.values(i)).filter)||void 0===o?void 0:o.call(n,(function(t){return!t.indegree})))};var Oe=function(t,e,r){for(var n,o=r;e.length&&(n=e[e.length-1]).i<=o;)e.pop(),null==t||t.push(n.vs),o++;return o},Pe=function(t,e,r,n,o,i){var a,s,u,d,h=t.getChildren(e).map((function(t){return t.id})),c=t.getNode(e),l=c?c.data.borderLeft:void 0,f=c?c.data.borderRight:void 0,g={};l&&(h=null==h?void 0:h.filter((function(t){return t!==l&&t!==f})));var p=function(t,e){return e.map((function(e){var r=t.getRelatedEdges(e,"in");if(!(null==r?void 0:r.length))return{v:e};var n={sum:0,weight:0};return null==r||r.forEach((function(e){var r=t.getNode(e.source);n.sum+=e.data.weight*r.data.order,n.weight+=e.data.weight})),{v:e,barycenter:n.sum/n.weight,weight:n.weight}}))}(t,h||[]);null==p||p.forEach((function(e){var o;if(null===(o=t.getChildren(e.v))||void 0===o?void 0:o.length){var a=Pe(t,e.v,r,n,i);g[e.v]=a,a.hasOwnProperty("barycenter")&&ze(e,a)}}));var v=De(p,r);Te(v,g),null===(a=v.filter((function(t){return t.vs.length>0})))||void 0===a||a.forEach((function(e){var r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)}));var y=function(t,e,r,n){var o=function(t,e){var r={lhs:[],rhs:[]};return null==t||t.forEach((function(t){var e,o;o=(e=t).hasOwnProperty("fixorder")&&!isNaN(e.fixorder),(n?!o&&e.hasOwnProperty("barycenter"):o||e.hasOwnProperty("barycenter"))?r.lhs.push(t):r.rhs.push(t)})),r}(t),i=o.lhs,a=o.rhs.sort((function(t,e){return-t.i- -e.i})),s=[],u=0,d=0,h=0;null==i||i.sort(function(t,e){return function(r,n){if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i}}(!!e,!!r)),h=Oe(s,a,h),null==i||i.forEach((function(t){var e;h+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),u+=t.barycenter*t.weight,d+=t.weight,h=Oe(s,a,h)}));var c={vs:s.flat()};return d&&(c.barycenter=u/d,c.weight=d),c}(v,n,o,i);if(l&&(y.vs=[l,y.vs,f].flat(),null===(s=t.getPredecessors(l))||void 0===s?void 0:s.length)){var m=t.getNode((null===(u=t.getPredecessors(l))||void 0===u?void 0:u[0].id)||""),w=t.getNode((null===(d=t.getPredecessors(f))||void 0===d?void 0:d[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+w.data.order)/(y.weight+2),y.weight+=2}return y},Te=function(t,e){null==t||t.forEach((function(t){var r,n=null===(r=t.vs)||void 0===r?void 0:r.map((function(t){return e[t]?e[t].vs:t}));t.vs=n.flat()}))},ze=function(t,e){void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},Ce=function(t){if("object"!=typeof t||null===t)return t;var e,r;if(r=t,Array.isArray?Array.isArray(r):w(r,"Array")){e=[];for(var n=0,o=t.length;n<o;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=Ce(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=Ce(t[i]):e[i]=t[i];return e};const Le=Ce;var qe=function(t,e,r){return e.map((function(e){return function(t,e,r){var o=function(t){for(var e;t.hasNode(e="_root"+Math.random()););return e}(t),i=new l({tree:[{id:o,children:[],data:{}}]});return t.getAllNodes().forEach((function(a){var s=t.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(n({},a)),(null==s?void 0:s.id)&&!i.hasNode(null==s?void 0:s.id)&&i.addNode(n({},s)),i.setParent(a.id,(null==s?void 0:s.id)||o),t.getRelatedEdges(a.id,r).forEach((function(e){var r=e.source===a.id?e.target:e.source;i.hasNode(r)||i.addNode(n({},t.getNode(r)));var o=i.getRelatedEdges(r,"out").find((function(t){return t.target===a.id})),s=void 0!==o?o.data.weight:0;o?i.updateEdgeData(o.id,n(n({},o.data),{weight:e.data.weight+s})):i.addEdge({id:e.id,source:r,target:a.id,data:{weight:e.data.weight+s}})})),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,n(n({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))})),i}(t,e,r)}))},je=function(t,e,r,n){var o=new l;null==t||t.forEach((function(t){for(var i,a=t.getRoots()[0].id,s=Pe(t,a,o,e,r,n),u=0;u<(null===(i=s.vs)||void 0===i?void 0:i.length);u++){var d=t.getNode(s.vs[u]);d&&(d.data.order=u)}!function(t,e,r){var n,o={};null==r||r.forEach((function(r){for(var i,a,s=t.getParent(r);s;){if((i=t.getParent(s.id))?(a=o[i.id],o[i.id]=s.id):(a=n,n=s.id),a&&a!==s.id)return e.addNodes([{id:a,data:{}},{id:s.id,data:{}}]),void e.addEdge({id:"e"+a+"-"+s.id,source:a,target:s.id,data:{}});s=i}}))}(t,o,s.vs)}))},Fe=function(t,e){null==e||e.forEach((function(e){null==e||e.forEach((function(e,r){t.getNode(e).data.order=r}))}))},Ve=function(t,e){var r={};function n(e,n,o,i,a){for(var s,u,d,h=n;h<o;h++)d=e[h],(null===(s=t.getNode(d))||void 0===s?void 0:s.data.dummy)&&(null===(u=t.getPredecessors(d))||void 0===u||u.forEach((function(e){var n=t.getNode(e.id);n.data.dummy&&(n.data.order<i||n.data.order>a)&&We(r,e.id,d)})))}function o(t,e){var r=function(t){return JSON.stringify(t.slice(1))}(t);e.get(r)||(n.apply(void 0,u([],s(t))),e.set(r,!0))}return(null==e?void 0:e.length)&&e.reduce((function(e,r){var n,i=-1,a=0,s=new Map;return null==r||r.forEach((function(u,d){var h;if("border"===(null===(h=t.getNode(u))||void 0===h?void 0:h.data.dummy)){var c=t.getPredecessors(u)||[];c.length&&(n=t.getNode(c[0].id).data.order,o([r,a,d,i,n],s),a=d,i=n)}o([r,a,r.length,n,e.length],s)})),r})),r},Ge=function(t,e){var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find((function(e){return t.getNode(e.id).data.dummy}))},We=function(t,e,r){var n=e,o=r;if(n>o){var i=n;n=o,o=i}var a=t[n];a||(t[n]=a={}),a[o]=!0},Be=function(t,e,r){var n=e;return n>r&&(n=r),!!t[n]},$e=function(t,e,r,o,i,a){var s=new l,u=Ue(o,i,a);return null==e||e.forEach((function(e){var o;null==e||e.forEach((function(e){var i=r[e];if(s.hasNode(i)||s.addNode({id:i,data:{}}),o){var a=r[o],d=s.getRelatedEdges(a,"out").find((function(t){return t.target===i}));d?s.updateEdgeData(d.id,n(n({},d.data),{weight:Math.max(u(t,e,o),d.data.weight||0)})):s.addEdge({id:"e"+Math.random(),source:a,target:i,data:{weight:Math.max(u(t,e,o),0)}})}o=e}))})),s};var Ue=function(t,e,r){return function(n,o,i){var a=n.getNode(o),s=n.getNode(i),u=0,d=0;if(u+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":d=-a.data.width/2;break;case"r":d=a.data.width/2}if(d&&(u+=r?d:-d),d=0,u+=(a.data.dummy?e:t)/2,u+=(s.data.dummy?e:t)/2,u+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":d=s.data.width/2;break;case"r":d=-s.data.width/2}return d&&(u+=r?d:-d),d=0,u}},He=function(t,e){return t.getNode(e).data.width||0},Ke=function(t,e){var r,n=Ht(t);!function(t,e){var r=(e||{}).ranksep,n=void 0===r?0:r,o=Yt(t),i=0;null==o||o.forEach((function(e){var r=e.map((function(e){return t.getNode(e).data.height})),o=Math.max.apply(Math,u(u([],s(r)),[0]));null==e||e.forEach((function(e){t.getNode(e).data.y=i+o/2})),i+=o+n}))}(n,e);var o=function(t,e){var r=e||{},n=r.align,o=r.nodesep,i=void 0===o?0:o,a=r.edgesep,d=void 0===a?0:a,h=Yt(t),c=Object.assign(function(t,e){var r={};return(null==e?void 0:e.length)&&e.reduce((function(e,n){var o=0,i=0,a=e.length,s=null==n?void 0:n[(null==n?void 0:n.length)-1];return null==n||n.forEach((function(e,u){var d,h=Ge(t,e),c=h?t.getNode(h.id).data.order:a;(h||e===s)&&(null===(d=n.slice(i,u+1))||void 0===d||d.forEach((function(e){var n;null===(n=t.getPredecessors(e))||void 0===n||n.forEach((function(n){var i,a=t.getNode(n.id),s=a.data.order;!(s<o||c<s)||a.data.dummy&&(null===(i=t.getNode(e))||void 0===i?void 0:i.data.dummy)||We(r,n.id,e)}))})),i=u+1,o=c)})),n})),r}(t,h),Ve(t,h)),l={},f=[];["u","d"].forEach((function(e){f="u"===e?h:Object.values(h).reverse(),["l","r"].forEach((function(r){"r"===r&&(f=f.map((function(t){return Object.values(t).reverse()})));var n=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),o=function(t,e,r,n){var o={},i={},a={};return null==e||e.forEach((function(t){null==t||t.forEach((function(t,e){o[t]=t,i[t]=t,a[t]=e}))})),null==e||e.forEach((function(t){var e=-1;null==t||t.forEach((function(t){var s=n(t).map((function(t){return t.id}));if(s.length){s=s.sort((function(t,e){return a[t]-a[e]}));for(var u=(s.length-1)/2,d=Math.floor(u),h=Math.ceil(u);d<=h;++d){var c=s[d];i[t]===t&&e<a[c]&&!Be(r,t,c)&&(i[c]=t,i[t]=o[t]=o[c],e=a[c])}}}))})),{root:o,align:i}}(0,f,c,n),a=function(t,e,r,n,o,i,a){var s,u={},d=$e(t,e,r,o,i,a),h=a?"borderLeft":"borderRight",c=function(t,e){for(var r=d.getAllNodes(),n=r.pop(),o={};n;)o[n.id]?t(n.id):(o[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return c((function(t){u[t]=(d.getRelatedEdges(t,"in")||[]).reduce((function(t,e){return Math.max(t,(u[e.source]||0)+e.data.weight)}),0)}),d.getPredecessors.bind(d)),c((function(e){var r=(d.getRelatedEdges(e,"out")||[]).reduce((function(t,e){return Math.min(t,(u[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==h&&(u[e]=Math.max(u[e],r))}),d.getSuccessors.bind(d)),null===(s=Object.values(n))||void 0===s||s.forEach((function(t){u[t]=u[r[t]]})),u}(t,f,o.root,o.align,i,d,"r"===r);"r"===r&&Object.keys(a).forEach((function(t){return a[t]=-a[t]})),l[e+r]=a}))}));var g=function(t,e){return Qt(Object.values(e),(function(e){var r,n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach((function(r){var i=e[r],a=He(t,r)/2;n=Math.max(i+a,n),o=Math.min(i-a,o)})),n-o}))}(t,l);return g&&function(t,e){var r=Object.values(e),n=Math.min.apply(Math,u([],s(r))),o=Math.max.apply(Math,u([],s(r)));["u","d"].forEach((function(r){["l","r"].forEach((function(i){var a,d=r+i,h=t[d];if(h!==e){var c=Object.values(h);(a="l"===i?n-Math.min.apply(Math,u([],s(c))):o-Math.max.apply(Math,u([],s(c))))&&(t[d]={},Object.keys(h).forEach((function(e){t[d][e]=h[e]+a})))}}))}))}(l,g),function(t,e){var r={};return Object.keys(t.ul).forEach((function(n){if(e)r[n]=t[e.toLowerCase()][n];else{var o=Object.values(t).map((function(t){return t[n]}));r[n]=(o[0]+o[1])/2}})),r}(l,n)}(n,e);null===(r=Object.keys(o))||void 0===r||r.forEach((function(t){n.getNode(t).data.x=o[t]}))},Ye=function(t,e){var r=e.acyclicer,o=e.ranker,i=e.rankdir,a=void 0===i?"tb":i,d=e.nodeOrder,h=e.keepNodeOrder,c=e.align,f=e.nodesep,g=void 0===f?50:f,p=e.edgesep,v=void 0===p?20:p,y=e.ranksep,m=void 0===y?50:y;dr(t),Bt(t,r);var w=function(t){var e=Ut(t,"root",{},"_root"),r=function(t){var e={},r=function(n,o){var i=t.getChildren(n);null==i||i.forEach((function(t){return r(t.id,o+1)})),e[n]=o};return t.getRoots().forEach((function(t){return r(t.id,1)})),e}(t),n=Math.max.apply(Math,u([],s(Object.values(r))));Math.abs(n)===1/0&&(n=1);var o=n-1,i=2*o+1;t.getAllEdges().forEach((function(t){t.data.minlen*=i}));var a=function(t){var e=0;return t.getAllEdges().forEach((function(t){e+=t.data.weight})),e}(t)+1;return t.getRoots().forEach((function(n){Ee(t,e,i,a,o,r,n.id)})),{nestingRoot:e,nodeRankFactor:i}}(t),x=w.nestingRoot,E=w.nodeRankFactor;!function(t,e){switch(e){case"network-simplex":xe(t);break;case"tight-tree":default:!function(t){!function(t){var e,r={},n=function(o){var i,a,s=t.getNode(o);return s?r[o]?s.data.rank:(r[o]=!0,null===(i=t.getRelatedEdges(o,"out"))||void 0===i||i.forEach((function(t){var e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),(void 0===e||a<e)&&(e=a),s.data.rank=a,a):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){t&&n(t.id)})),void 0===e&&(e=0);var o={},i=function(e,r){var n,a=t.getNode(e),s=isNaN(a.data.layer)?r:a.data.layer;(void 0===a.data.rank||a.data.rank<s)&&(a.data.rank=s),o[e]||(o[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach((function(t){i(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((function(t){var r=t.data;r&&(isNaN(r.layer)?r.rank-=e:i(t.id,r.layer))}))}(t),function(t){var e,r,n=new l({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);ie(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r)}(t)}(t);break;case"longest-path":we(t)}}(Ht(t),o),er(t),function(t,e){void 0===e&&(e=0);var r=t.getAllNodes(),n=r.filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),o=Math.min.apply(Math,u([],s(n))),i=[];r.forEach((function(t){var e=(t.data.rank||0)-o;i[e]||(i[e]=[]),i[e].push(t.id)}));for(var a=0,d=0;d<i.length;d++){var h=i[d];void 0===h?d%e!=0&&(a-=1):a&&(null==h||h.forEach((function(e){var r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=a)})))}}(t,E),function(t,e){e&&t.removeNode(e),t.getAllEdges().forEach((function(e){e.data.nestingEdge&&t.removeEdge(e.id)}))}(t,x),function(t){var e=t.getAllNodes().filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),r=Math.min.apply(Math,u([],s(e)));t.getAllNodes().forEach((function(t){t.data.hasOwnProperty("rank")&&r!==1/0&&(t.data.rank-=r)}))}(t),rr(t),nr(t);var b=[];!function(t,e){t.getAllEdges().forEach((function(r){return function(t,e,r){var n=e.source,o=t.getNode(n).data.rank,i=e.target,a=t.getNode(i).data.rank,s=e.data.labelRank;if(a!==o+1){var u,d,h;for(t.removeEdge(e.id),h=0,++o;o<a;++h,++o)e.data.points=[],u=Ut(t,"edge",d={originalEdge:e,width:0,height:0,rank:o},"_d"),o===s&&(d.width=e.data.width,d.height=e.data.height,d.dummy=ee,d.labelpos=e.data.labelpos),t.addEdge({id:"e"+Math.random(),source:n,target:u,data:{weight:e.data.weight}}),0===h&&r.push(u),n=u;t.addEdge({id:"e"+Math.random(),source:n,target:i,data:{weight:e.data.weight}})}}(t,r,e)}))}(t,b),function(t,e){var r=function(t){var e={},r=0,n=function(o){var i=r;t.getChildren(o).forEach((function(t){return n(t.id)})),e[o]={low:i,lim:r++}};return t.getRoots().forEach((function(t){return n(t.id)})),e}(t);e.forEach((function(e){var n,o,i=e,a=t.getNode(i),s=a.data.originalEdge;if(s)for(var u=function(t,e,r,n){var o,i,a,s,u=[],d=[],h=Math.min(e[r].low,e[n].low),c=Math.max(e[r].lim,e[n].lim);a=r;do{a=null===(o=t.getParent(a))||void 0===o?void 0:o.id,u.push(a)}while(a&&(e[a].low>h||c>e[a].lim));for(s=a,a=n;a&&a!==s;)d.push(a),a=null===(i=t.getParent(a))||void 0===i?void 0:i.id;return{lca:s,path:u.concat(d.reverse())}}(t,r,s.source,s.target),d=u.path,h=u.lca,c=0,l=d[c],f=!0;i!==s.target;){if(a=t.getNode(i),f){for(;l!==h&&(null===(n=t.getNode(l))||void 0===n?void 0:n.data.maxRank)<a.data.rank;)l=d[++c];l===h&&(f=!1)}if(!f){for(;c<d.length-1&&(null===(o=t.getNode(d[c+1]))||void 0===o?void 0:o.data.minRank)<=a.data.rank;)c++;l=d[c]}t.hasNode(l)&&t.setParent(i,l),i=t.getSuccessors(i)[0].id}}))}(t,b),function(t){var e=function(r){var n=t.getChildren(r),o=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach((function(t){return e(t.id)})),o.data.hasOwnProperty("minRank")){o.data.borderLeft=[],o.data.borderRight=[];for(var i=o.data.minRank,a=o.data.maxRank+1;i<a;i+=1)be(t,"borderLeft","_bl",r,o,i),be(t,"borderRight","_br",r,o,i)}};t.getRoots().forEach((function(t){return e(t.id)}))}(t),h&&function(t,e){for(var r=t.getAllNodes().filter((function(e){var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)})).map((function(t){return t.data.rank})),n=Math.max.apply(Math,u([],s(r))),o=[],i=0;i<n+1;i++)o[i]=[];null==e||e.forEach((function(e){var r=t.getNode(e);r&&!r.data.dummy&&(isNaN(r.data.rank)||(r.data.fixorder=o[r.data.rank].length,o[r.data.rank].push(e)))}))}(t,d),function(t,e){for(var r=Xt(t),n=[],o=[],i=1;i<r+1;i++)n.push(i);for(i=r-1;i>-1;i--)o.push(i);var a=qe(t,n,"in"),s=qe(t,o,"out"),u=Ae(t);Fe(t,u);for(var d,h=Number.POSITIVE_INFINITY,c=(i=0,0);c<4;++i,++c)je(i%2?a:s,i%4>=2,!1,e),u=Yt(t),(l=Ie(t,u))<h&&(c=0,d=Le(u),h=l);for(u=Ae(t),Fe(t,u),i=0,c=0;c<4;++i,++c){var l;je(i%2?a:s,i%4>=2,!0,e),u=Yt(t),(l=Ie(t,u))<h&&(c=0,d=Le(u),h=l)}Fe(t,d)}(t,h),hr(t),function(t,e){var r=e.toLowerCase();"lr"!==r&&"rl"!==r||Ne(t)}(t,a),Ke(t,{align:c,nodesep:g,edgesep:v,ranksep:m}),cr(t),ur(t),function(t,e){e.forEach((function(e){var r,n=t.getNode(e),o=n.data.originalEdge;o&&t.addEdge(o);for(var i=e;n.data.dummy;)r=t.getSuccessors(i)[0],t.removeNode(i),o.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===ee&&(o.data.x=n.data.x,o.data.y=n.data.y,o.data.width=n.data.width,o.data.height=n.data.height),i=r.id,n=t.getNode(i)}))}(t,b),ar(t),function(t,e){var r=e.toLowerCase();"bt"!==r&&"rl"!==r||function(t){t.getAllNodes().forEach((function(t){Se(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return Se(t)})),t.data.hasOwnProperty("y")&&Se(t.data)}))}(t),"lr"!==r&&"rl"!==r||(function(t){t.getAllNodes().forEach((function(t){ke(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return ke(t)})),t.data.hasOwnProperty("x")&&ke(t.data)}))}(t),Ne(t))}(t,a);var N=or(t),M=N.width,S=N.height;return ir(t),sr(t),function(t){t.getAllEdges().forEach((function(e){var r=e.data;if(r.reversed){t.removeEdge(e.id);var o=r.forwardName;delete r.reversed,delete r.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:n(n({},r),{forwardName:o})})}}))}(t),{width:M,height:S}},Je=["width","height","layer","fixorder"],Xe={width:0,height:0},Qe=["minlen","weight","width","height","labeloffset"],Ze={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},tr=["labelpos"],er=function(t){t.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var r=t.getNode(e.source),n={e,rank:(t.getNode(e.target).data.rank-r.data.rank)/2+r.data.rank};Ut(t,"edge-proxy",n,"_ep")}}))},rr=function(t){var e=0;return t.getAllNodes().forEach((function(r){var n,o;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(o=t.getNode(r.data.borderBottom))||void 0===o?void 0:o.data.rank,e=Math.max(e,r.data.maxRank||-1/0))})),e},nr=function(t){t.getAllNodes().forEach((function(e){"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},or=function(t,e){var r,n,o=0,i=0,a=e||{},s=a.marginx,u=void 0===s?0:s,d=a.marginy,h=void 0===d?0:d,c=function(t){if(t.data){var e=t.data.x,a=t.data.y,s=t.data.width,u=t.data.height;isNaN(e)||isNaN(s)||(void 0===r&&(r=e-s/2),r=Math.min(r,e-s/2),o=Math.max(o,e+s/2)),isNaN(a)||isNaN(u)||(void 0===n&&(n=a-u/2),n=Math.min(n,a-u/2),i=Math.max(i,a+u/2))}};return t.getAllNodes().forEach((function(t){c(t)})),t.getAllEdges().forEach((function(t){(null==t?void 0:t.data.hasOwnProperty("x"))&&c(t)})),r-=u,n-=h,t.getAllNodes().forEach((function(t){t.data.x-=r,t.data.y-=n})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){t.x-=r,t.y-=n})),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)})),{width:o-r+u,height:i-n+h}},ir=function(t){t.getAllEdges().forEach((function(e){var r,n,o=t.getNode(e.source),i=t.getNode(e.target);e.data.points?(r=e.data.points[0],n=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:i.data.x,y:i.data.y},n={x:o.data.x,y:o.data.y}),e.data.points.unshift(Kt(o.data,r)),e.data.points.push(Kt(i.data,n))}))},ar=function(t){t.getAllEdges().forEach((function(t){if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},sr=function(t){t.getAllEdges().forEach((function(t){var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},ur=function(t){t.getAllNodes().forEach((function(e){var r,n,o;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){var i=t.getNode(e.id),a=t.getNode(i.data.borderTop),s=t.getNode(i.data.borderBottom),u=t.getNode(i.data.borderLeft[(null===(n=i.data.borderLeft)||void 0===n?void 0:n.length)-1]),d=t.getNode(i.data.borderRight[(null===(o=i.data.borderRight)||void 0===o?void 0:o.length)-1]);i.data.width=Math.abs((null==d?void 0:d.data.x)-(null==u?void 0:u.data.x))||10,i.data.height=Math.abs((null==s?void 0:s.data.y)-(null==a?void 0:a.data.y))||10,i.data.x=((null==u?void 0:u.data.x)||0)+i.data.width/2,i.data.y=((null==a?void 0:a.data.y)||0)+i.data.height/2}})),t.getAllNodes().forEach((function(e){"border"===e.data.dummy&&t.removeNode(e.id)}))},dr=function(t){t.getAllEdges().forEach((function(e){if(e.source===e.target){var r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}}))},hr=function(t){var e=Yt(t);null==e||e.forEach((function(e){var r=0;null==e||e.forEach((function(e,n){var o,i=t.getNode(e);i.data.order=n+r,null===(o=i.data.selfEdges)||void 0===o||o.forEach((function(e){Ut(t,"selfedge",{width:e.data.width,height:e.data.height,rank:i.data.rank,order:n+ ++r,e},"_se")})),delete i.data.selfEdges}))}))},cr=function(t){t.getAllNodes().forEach((function(e){var r=t.getNode(e.id);if("selfedge"===r.data.dummy){var n=t.getNode(r.data.e.source),o=n.data.x+n.data.width/2,i=n.data.y,a=r.data.x-o,s=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}}))},lr=function(t,e){var r={};return null==e||e.forEach((function(e){void 0!==t[e]&&(r[e]=+t[e])})),r},fr=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(r){e[r.toLowerCase()]=t[r]})),e},gr={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="dagre",this.layoutNode=function(t){return t.data.layout},this.options=n(n({},gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericDagreLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericDagreLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericDagreLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,E,N,M,k,R,I,_,D,O,P,T,z,C,L,q,j,F,V,G,W=this;return a(this,(function(a){return o=n(n({},this.options),r),i=o.nodeSize,s=o.align,u=o.rankdir,d=void 0===u?"TB":u,h=o.ranksep,c=o.nodesep,f=o.ranksepFunc,g=o.nodesepFunc,p=o.edgeLabelSpace,v=o.nodeOrder,y=o.begin,m=o.controlPoints,w=o.radial,E=new l({tree:[]}),N=S(h||50,f),M=S(c||50,g),k=M,R=N,"LR"!==d&&"RL"!==d||(k=N,R=M),I=A(i,void 0),_=e.getAllNodes(),D=e.getAllEdges(),_.filter((function(t){return t.data.layout})).forEach((function(t){var e=I(t),r=R(t),n=e+2*k(t),o=e+2*r,i=t.data.layer;x(i)?E.addNode({id:t.id,data:{width:n,height:o,layer:i}}):E.addNode({id:t.id,data:{width:n,height:o}})})),D.forEach((function(t){W.layoutNode(E.getNode(t.source))&&W.layoutNode(E.getNode(t.target))&&E.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),function(t,e){var r,o,i=e.edgeLabelSpace,a=e.keepNodeOrder,s=e.prevGraph,u=e.rankdir,d=e.ranksep;!a&&s&&(o=s,(r=t).getAllNodes().forEach((function(t){var e=r.getNode(t.id),n=o.getNode(t.id);void 0!==n?(e.data.fixorder=n.data._order,delete n.data._order):delete e.data.fixorder})));var h=function(t){var e=new l({tree:[]});return t.getAllNodes().forEach((function(r){var o=fr(t.getNode(r.id).data),i=n(n({},Xe),o),a=lr(i,Je);e.hasNode(r.id)||e.addNode({id:r.id,data:n({},a)});var s=t.getParent(r.id);null==s||(e.hasNode(s.id)||e.addNode(n({},s)),e.setParent(r.id,s.id))})),t.getAllEdges().forEach((function(r){var n=fr(t.getEdge(r.id).data),o={};null==tr||tr.forEach((function(t){void 0!==n[t]&&(o[t]=n[t])})),e.addEdge({id:r.id,source:r.source,target:r.target,data:Object.assign({},Ze,lr(n,Qe),o)})})),e}(t);i&&(e.ranksep=function(t,e){var r=e.ranksep,n=void 0===r?0:r,o=e.rankdir;return t.getAllNodes().forEach((function(t){isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((function(t){var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===o||"BT"===o?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2}(h,{rankdir:u,ranksep:d}));try{Ye(h,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph\'s structure:\\n",t);throw t}!function(t,e){t.getAllNodes().forEach((function(r){var n,o=t.getNode(r.id);if(o){var i=e.getNode(r.id);o.data.x=i.data.x,o.data.y=i.data.y,o.data._order=i.data.order,o.data._rank=i.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(o.data.width=i.data.width,o.data.height=i.data.height)}})),t.getAllEdges().forEach((function(r){var n=t.getEdge(r.id),o=e.getEdge(r.id);n.data.points=o?o.data.points:[],o&&o.data.hasOwnProperty("x")&&(n.data.x=o.data.x,n.data.y=o.data.y)}))}(t,h)}(E,{prevGraph:null,edgeLabelSpace:p,keepNodeOrder:!!v,nodeOrder:v||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:d,nodesep:c,align:s}),O=[0,0],y&&(P=1/0,T=1/0,E.getAllNodes().forEach((function(t){P>t.data.x&&(P=t.data.x),T>t.data.y&&(T=t.data.y)})),E.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){P>t.x&&(P=t.x),T>t.y&&(T=t.y)}))})),O[0]=y[0]-P,O[1]=y[1]-T),z="LR"===d||"RL"===d,w||(C=new Set,L="BT"===d||"RL"===d?function(t,e){return e-t}:function(t,e){return t-e},E.getAllNodes().forEach((function(t){t.data.x=t.data.x+O[0],t.data.y=t.data.y+O[1],C.add(z?t.data.x:t.data.y)})),q=Array.from(C).sort(L),j=z?function(t,e){return t.x!==e.x}:function(t,e){return t.y!==e.y},F=z?function(t,e,r){var n=Math.max(e.y,r.y),o=Math.min(e.y,r.y);return t.filter((function(t){return t.y<=n&&t.y>=o}))}:function(t,e,r){var n=Math.max(e.x,r.x),o=Math.min(e.x,r.x);return t.filter((function(t){return t.x<=n&&t.x>=o}))},E.getAllEdges().forEach((function(t,e){var r;p&&m&&"loop"!==t.data.type&&(t.data.controlPoints=vr(null===(r=t.data.points)||void 0===r?void 0:r.map((function(t){var e=t.x,r=t.y;return{x:e+O[0],y:r+O[1]}})),E.getNode(t.source),E.getNode(t.target),q,z,j,F))}))),V=[],V=E.getAllNodes().map((function(t){return b(t)})),G=E.getAllEdges(),t&&(V.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),G.forEach((function(t){e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),[2,{nodes:V,edges:G}]}))}))},t}(),vr=function(t,e,r,n,o,i,a){var s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){var u=e.data,d=u.x,h=u.y,c=r.data,l=c.x,f=c.y;if(o&&(d=e.data.y,h=e.data.x,l=r.data.y,f=r.data.x),f!==h&&d!==l){var g=n.indexOf(h),p=n[g+1];if(p){var v=s[0],y=o?{x:(h+p)/2,y:(null==v?void 0:v.y)||l}:{x:(null==v?void 0:v.x)||l,y:(h+p)/2};v&&!i(v,y)||s.unshift(y)}var m=n.indexOf(f),w=Math.abs(m-g);if(1===w)(s=a(s,e.data,r.data)).length||s.push(o?{x:(h+f)/2,y:d}:{x:d,y:(h+f)/2});else if(w>1){var x=n[m-1];if(x){var E=s[s.length-1],b=o?{x:(f+x)/2,y:(null==E?void 0:E.y)||l}:{x:(null==E?void 0:E.x)||d,y:(f+x)/2};E&&!i(E,b)||s.push(b)}}}}return s};function yr(t){var e=0,r=0,n=0;if(t.length){for(var o=0;o<4;o++)(i=t[o])&&i.weight&&(e+=i.weight,r+=i.x*i.weight,n+=i.y*i.weight);t.x=r/e,t.y=n/e,t.weight=e}else{var i=t;t.x=i.data.x,t.y=i.data.y,t.weight=i.data.weight}}var mr=function(t,e,r,n,o,i){var a=i.x-t.x||.1,s=i.y-t.y||.1,u=n-e,d=a*a+s*s,h=Math.sqrt(d)*d;if(u*u*.81<d){var c=t.weight/h;return i.vx+=a*c,i.vy+=s*c,!0}if(t.length)return!1;t.data!==i&&(c=t.data.weight/h,i.vx+=a*c,i.vy+=s*c)},wr={maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},xr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=n(n({},wr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,E,b,N,M,S,k=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=this.formatOptions(o,e),d=u.width,h=u.height,c=u.nodeSize,f=u.getMass,g=u.nodeStrength,p=u.edgeStrength,v=u.linkDistance,y=i.map((function(t){return n(n({},t),{data:n(n({},t.data),{x:x(t.data.x)?t.data.x:Math.random()*d,y:x(t.data.y)?t.data.y:Math.random()*h,size:c(t)||30,mass:f(t),nodeStrength:g(t)})})})),m=s.map((function(t){return n(n({},t),{data:n(n({},t.data),{edgeStrength:p(t),linkDistance:v(t,e.getNode(t.source),e.getNode(t.target))})})})),(null==i?void 0:i.length)?(w={},i.forEach((function(t,e){w[t.id]={x:0,y:0}})),E=new l({nodes:y,edges:m}),this.formatCentripetal(u,E),b=u.maxIteration,N=u.minMovement,M=u.onTick,this.lastLayoutNodes=y,this.lastLayoutEdges=m,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=E,this.lastOptions=u,this.lastVelMap=w,"undefined"==typeof window?[2]:(S=0,[2,new Promise((function(r){k.timeInterval=window.setInterval((function(){i&&k.running||r({nodes:Sr(e,y),edges:s}),k.runOneStep(E,e,S,w,u),k.updatePosition(e,E,w,u),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),null==M||M({nodes:Sr(e,y),edges:s}),(++S>=b||k.judgingDistance<N)&&(window.clearInterval(k.timeInterval),r({nodes:Sr(e,y),edges:s}))}),0),k.running=!0}))])):(this.lastResult={nodes:[],edges:s},[2,{nodes:[],edges:s}])}))}))},t.prototype.formatOptions=function(t,e){var r=t,n=t.width,o=t.height,i=t.getMass;if(r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=o||"undefined"==typeof window?o:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),i||(r.getMass=function(t){var r=1;x(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);var n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),t.preventOverlap){var a=S(0,t.nodeSpacing);t.nodeSize?g(t.nodeSize)?r.nodeSize=function(e){var r=t.nodeSize;return Math.max(r[0],r[1])+a(e)}:r.nodeSize=function(e){return t.nodeSize+a(e)}:r.nodeSize=function(t){var e=((null==t?void 0:t.data)||{}).size;return e?g(e)?Math.max(e[0],e[1])+a(t):M(e)?Math.max(e.width,e.height)+a(t):e+a(t):10+a(t)}}return r.linkDistance=t.linkDistance?S(1,t.linkDistance):function(t){return 1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target))},r.nodeStrength=S(1,t.nodeStrength),r.edgeStrength=S(1,t.edgeStrength),t},t.prototype.formatCentripetal=function(t,e){var r,n=t.centripetalOptions,o=t.center,i=t.clusterNodeStrength,a=t.leafCluster,s=t.clustering,u=t.nodeClusterBy,d=e.getAllNodes(),h=n||{leaf:2,single:2,others:1,center:function(t){return{x:o[0],y:o[1]}}};"function"!=typeof i&&(t.clusterNodeStrength=function(t){return i});var c=[];if(a&&u&&(r=Er(e,u),c=Array.from(new Set(null==d?void 0:d.map((function(t){return t.data[u]}))))||[],t.centripetalOptions=Object.assign(h,{single:100,leaf:function(e){var n=r[e.id]||{},o=n.siblingLeaves,i=n.sameTypeLeaves;return(null==i?void 0:i.length)===(null==o?void 0:o.length)||1===(null==c?void 0:c.length)?1:t.clusterNodeStrength(e)},others:1,center:function(t){var n,o=e.getDegree(t.id,"both");if(!o)return{x:100,y:100};if(1===o){var i=(r[t.id]||{}).sameTypeLeaves,a=void 0===i?[]:i;1===a.length?n=void 0:a.length>1&&(n=Mr(a))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y}}})),s&&u){r||(r=Er(e,u)),c||(c=Array.from(new Set(d.map((function(t){return t.data[u]}))))),c=c.filter((function(t){return void 0!==t}));var l={};c.forEach((function(t){var r=d.filter((function(e){return e.data[u]===t})).map((function(t){return e.getNode(t.id)}));l[t]=Mr(r)})),t.centripetalOptions=Object.assign(h,{single:function(e){return t.clusterNodeStrength(e)},leaf:function(e){return t.clusterNodeStrength(e)},others:function(e){return t.clusterNodeStrength(e)},center:function(t){var e=l[t.data[u]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y}}})}var f=t.centripetalOptions||{},g=f.leaf,p=f.single,v=f.others;g&&"function"!=typeof g&&(t.centripetalOptions.leaf=function(){return g}),p&&"function"!=typeof p&&(t.centripetalOptions.single=function(){return p}),v&&"function"!=typeof v&&(t.centripetalOptions.others=function(){return v})},t.prototype.runOneStep=function(t,e,r,n,o){var i={},a=t.getAllNodes(),s=t.getAllEdges();if(null==a?void 0:a.length){var u=o.monitor;this.calRepulsive(t,i,o),s&&this.calAttractive(t,i),this.calGravity(t,e,i,o),this.updateVelocity(t,i,n,o),u&&u({energy:this.calTotalEnergy(i,a),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}},t.prototype.calTotalEnergy=function(t,e){if(!(null==e?void 0:e.length))return 0;var r=0;return e.forEach((function(e,n){var o=t[e.id].x,i=t[e.id].y,a=o*o+i*i,s=e.data.mass;r+=(void 0===s?1:s)*a*.5})),r},t.prototype.calRepulsive=function(t,e,r){var n=r.factor,o=r.coulombDisScale;!function(t,e,r,n){var o=e/r,i=t.getAllNodes(),a=i.map((function(t,e){var r=t.data,n=r.nodeStrength;return{x:r.x,y:r.y,size:r.size,index:e,vx:0,vy:0,weight:o*n}})),s=F(a,(function(t){return t.x}),(function(t){return t.y})).visitAfter(yr);a.forEach((function(t){!function(t,e){e.visit((function(e,r,n,o,i){return mr(e,r,n,o,i,t)}))}(t,s)})),a.map((function(t,e){var r=i[e],o=r.id,a=r.data.mass,s=void 0===a?1:a;n[o]={x:t.vx/s,y:t.vy/s}}))}(t,n,o*o,e)},t.prototype.calAttractive=function(t,e){t.getAllEdges().forEach((function(r,n){var o=r.source,i=r.target,a=t.getNode(o),s=t.getNode(i);if(a&&s){var u=s.data.x-a.data.x,d=s.data.y-a.data.y;u||d||(u=.01*Math.random(),d=.01*Math.random());var h=Math.sqrt(u*u+d*d),c=u/h,l=d/h,f=r.data||{},g=f.linkDistance,p=void 0===g?200:g,v=f.edgeStrength,y=(p-h)*(void 0===v?200:v),m=1/(a.data.mass||1),w=1/(s.data.mass||1),x=c*y,E=l*y;e[o].x-=x*m,e[o].y-=E*m,e[i].x+=x*w,e[i].y+=E*w}}))},t.prototype.calGravity=function(t,e,r,n){var o=n.getCenter,i=t.getAllNodes(),a=e.getAllNodes(),u=e.getAllEdges(),d=n.width,h=n.height,c=n.center,l=n.gravity,f=n.centripetalOptions;i&&i.forEach((function(n){var i=n.id,g=n.data,p=g.mass,v=g.x,y=g.y,m=e.getNode(i),w=0,E=0,b=l,N=t.getDegree(i,"in"),M=t.getDegree(i,"out"),S=t.getDegree(i,"both"),k=null==o?void 0:o(m,S);if(k){var A=s(k,3);w=v-A[0],E=y-A[1],b=A[2]}else w=v-c[0],E=y-c[1];if(b&&(r[i].x-=b*w/p,r[i].y-=b*E/p),f){var R=f.leaf,I=f.single,_=f.others,D=f.center,O=(null==D?void 0:D(m,a,u,d,h))||{x:0,y:0,centerStrength:0},P=O.x,T=O.y,z=O.centerStrength;if(!x(P)||!x(T))return;var C=(v-P)/p,L=(y-T)/p;if(z&&(r[i].x-=z*C,r[i].y-=z*L),0===S){var q=I(m);if(!q)return;return r[i].x-=q*C,void(r[i].y-=q*L)}if(0===N||0===M){var j=R(m,a,u);if(!j)return;return r[i].x-=j*C,void(r[i].y-=j*L)}var F=_(m);if(!F)return;r[i].x-=F*C,r[i].y-=F*L}}))},t.prototype.updateVelocity=function(t,e,r,n){var o=n.damping,i=n.maxSpeed,a=n.interval,s=t.getAllNodes();(null==s?void 0:s.length)&&s.forEach((function(t){var n=t.id,s=(r[n].x+e[n].x*a)*o||.01,u=(r[n].y+e[n].y*a)*o||.01,d=Math.sqrt(s*s+u*u);if(d>i){var h=i/d;s*=h,u*=h}r[n]={x:s,y:u}}))},t.prototype.updatePosition=function(t,e,r,n){var o=this,i=n.distanceThresholdMode,a=n.interval,s=e.getAllNodes();if(null==s?void 0:s.length){var u=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),s.forEach((function(n){var s=n.id,d=t.getNode(s);if(x(d.data.fx)&&x(d.data.fy))e.mergeNodeData(s,{x:d.data.fx,y:d.data.fy});else{var h=r[s].x*a,c=r[s].y*a;e.mergeNodeData(s,{x:n.data.x+h,y:n.data.y+c});var l=Math.sqrt(h*h+c*c);switch(i){case"max":o.judgingDistance<l&&(o.judgingDistance=l);break;case"min":o.judgingDistance>l&&(o.judgingDistance=l);break;default:u+=l}}})),i&&"mean"!==i||(this.judgingDistance=u/s.length)}else this.judgingDistance=0},t}(),Er=function(t,e){var r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};var n={};return r.forEach((function(r,o){1===t.getDegree(r.id,"both")&&(n[r.id]=br(t,"leaf",r,e))})),n},br=function(t,e,r,n){var o=t.getDegree(r.id,"in"),i=t.getDegree(r.id,"out"),a=r,s=[];return 0===o?(a=t.getSuccessors(r.id)[0],s=t.getNeighbors(a.id)):0===i&&(a=t.getPredecessors(r.id)[0],s=t.getNeighbors(a.id)),s=s.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")})),{coreNode:a,siblingLeaves:s,sameTypeLeaves:Nr(t,e,n,r,s)}},Nr=function(t,e,r,n,o){var i=n.data[r]||"",a=(null==o?void 0:o.filter((function(t){return t.data[r]===i})))||[];return"leaf"===e&&(a=a.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")}))),a},Mr=function(t){var e={x:0,y:0};t.forEach((function(t){var r=t.data,n=r.x,o=r.y;e.x+=n||0,e.y+=o||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},Sr=function(t,e){return e.map((function(e){var r=e.id,o=e.data,i=t.getNode(r);return n(n({},i),{data:n(n({},i.data),{x:o.x,y:o.y})})}))},kr=function(){function t(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}return t.prototype.distanceTo=function(t){var e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)},t.prototype.setPos=function(t,e){this.rx=t,this.ry=e},t.prototype.resetForce=function(){this.fx=0,this.fy=0},t.prototype.addForce=function(t){var e=t.rx-this.rx,r=t.ry-this.ry,n=Math.hypot(e,r);n=n<1e-4?1e-4:n;var o=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=o*e/n,this.fy+=o*r/n},t.prototype.in=function(t){return t.contains(this.rx,this.ry)},t.prototype.add=function(e){var r=this.mass+e.mass;return new t({rx:(this.rx*this.mass+e.rx*e.mass)/r,ry:(this.ry*this.mass+e.ry*e.mass)/r,mass:r,degree:this.degree+e.degree})},t}();const Ar=kr;const Rr=function(){function t(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}return t.prototype.getLength=function(){return this.length},t.prototype.contains=function(t,e){var r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r},t.prototype.NW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.NE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.SW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t.prototype.SE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t}(),Ir=function(){function t(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}return t.prototype.insert=function(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e},t.prototype._putBody=function(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))},t.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},t.prototype.updateForce=function(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))},t}();var _r={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Dr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2",this.options=n(n({},_r),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,x,E,N,M,S,k,A,I;return a(this,(function(a){if(o=e.getAllEdges(),i=e.getAllNodes(),s=this.formatOptions(r,i.length),u=s.width,d=s.height,h=s.prune,c=s.maxIteration,f=s.nodeSize,g=s.center,!(null==i?void 0:i.length)||1===i.length)return[2,R(e,t,g)];if(p=i.map((function(t){return b(t,[u,d])})),v=o.filter((function(t){return t.source!==t.target})),y=new l({nodes:p,edges:v}),m=this.getSizes(y,e,f),this.run(y,e,c,m,t,s),h){for(w=0;w<v.length;w+=1)x=v[w],E=x.source,N=x.target,M=y.getDegree(E),S=y.getDegree(E),M<=1?(k=y.getNode(N),y.mergeNodeData(E,{x:k.data.x,y:k.data.y})):S<=1&&(A=y.getNode(E),y.mergeNodeData(N,{x:A.data.x,y:A.data.y}));I=n(n({},s),{prune:!1,barnesHut:!1}),this.run(y,e,100,m,t,I)}return[2,{nodes:p,edges:o}]}))}))},t.prototype.getSizes=function(t,e,r){for(var n=t.getAllNodes(),o={},i=0;i<n.length;i+=1){var a=n[i],d=a.id,h=a.data;if(o[d]=10,x(h.size))o[d]=h.size;else if(g(h.size))isNaN(h.size[0])||(o[d]=Math.max(h.size[0])),isNaN(h.size[1])||(o[d]=Math.max(h.size[1]));else if(M(h.size))o[d]=Math.max(h.size.width,h.size.height);else if(N(r)){var c=r(e.getNode(d));g(c)?o[d]=Math.max.apply(Math,u([],s(c))):o[d]=c}else g(r)?o[d]=Math.max.apply(Math,u([],s(r))):x(r)&&(o[d]=r)}return o},t.prototype.formatOptions=function(t,e){void 0===t&&(t={});var r=n(n({},this.options),t),o=r.center,i=r.width,a=r.height,s=r.barnesHut,u=r.prune,d=r.maxIteration,h=r.kr,c=r.kg;return r.width=i||"undefined"==typeof window?i:window.innerWidth,r.height=a||"undefined"==typeof window?a:window.innerHeight,r.center=o||[r.width/2,r.height/2],void 0===s&&e>250&&(r.barnesHut=!0),void 0===u&&e>100&&(r.prune=!0),0!==d||u?0===d&&u&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)):(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)),h||(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),c||(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r},t.prototype.run=function(t,e,r,n,o,i){for(var a=i.kr,s=i.barnesHut,u=i.onTick,d=t.getAllNodes(),h=0,c=r,l={},f={},g={},p=0;p<d.length;p+=1){var v=d[p],y=v.data,m=v.id;if(l[m]=[0,0],s){var w={id:p,rx:y.x,ry:y.y,mass:1,g:a,degree:t.getDegree(m)};g[m]=new Ar(w)}}for(;c>0;)h=this.oneStep(t,{iter:c,preventOverlapIters:50,krPrime:100,sg:h,forces:l,preForces:f,bodies:g,sizes:n},i),c--,null==u||u({nodes:d,edges:e.getAllEdges()});return t},t.prototype.oneStep=function(t,e,r){for(var n=e.iter,o=e.preventOverlapIters,i=e.krPrime,a=e.sg,d=e.preForces,h=e.bodies,c=e.sizes,l=e.forces,f=r.preventOverlap,g=r.barnesHut,p=t.getAllNodes(),v=0;v<p.length;v+=1){var y=p[v].id;d[y]=u([],s(l[y])),l[y]=[0,0]}return l=this.getAttrForces(t,n,o,c,l,r),l=g&&(f&&n>o||!f)?this.getOptRepGraForces(t,l,h,r):this.getRepGraForces(t,n,o,l,i,c,r),this.updatePos(t,l,d,a,r)},t.prototype.getAttrForces=function(t,e,r,n,o,i){for(var a=i.preventOverlap,s=i.dissuadeHubs,u=i.mode,d=i.prune,h=t.getAllEdges(),c=0;c<h.length;c+=1){var l=h[c],f=l.source,g=l.target,p=t.getNode(f),v=t.getNode(g),y=t.getDegree(f),m=t.getDegree(g);if(!d||!(y<=1||m<=1)){var w=[v.data.x-p.data.x,v.data.y-p.data.y],x=Math.hypot(w[0],w[1]);x=x<1e-4?1e-4:x,w[0]=w[0]/x,w[1]=w[1]/x,a&&e<r&&(x=x-n[f]-n[g]);var E=x,b=E;"linlog"===u&&(b=E=Math.log(1+x)),s&&(E=x/y,b=x/m),a&&e<r&&x<=0?(E=0,b=0):a&&e<r&&x>0&&(E=x,b=x),o[f][0]+=E*w[0],o[g][0]-=b*w[0],o[f][1]+=E*w[1],o[g][1]-=b*w[1]}}return o},t.prototype.getOptRepGraForces=function(t,e,r,n){for(var o=n.kg,i=n.center,a=n.prune,s=t.getAllNodes(),u=s.length,d=9e10,h=-9e10,c=9e10,l=-9e10,f=0;f<u;f+=1){var g=s[f],p=g.id,v=g.data;a&&t.getDegree(p)<=1||(r[p].setPos(v.x,v.y),v.x>=h&&(h=v.x),v.x<=d&&(d=v.x),v.y>=l&&(l=v.y),v.y<=c&&(c=v.y))}var y=Math.max(h-d,l-c),m=new Rr({xmid:(h+d)/2,ymid:(l+c)/2,length:y,massCenter:i,mass:u}),w=new Ir(m);for(f=0;f<u;f+=1)p=s[f].id,a&&t.getDegree(p)<=1||r[p].in(m)&&w.insert(r[p]);for(f=0;f<u;f+=1){var x=s[f],E=(p=x.id,v=x.data,t.getDegree(p));if(!(a&&E<=1)){r[p].resetForce(),w.updateForce(r[p]),e[p][0]-=r[p].fx,e[p][1]-=r[p].fy;var b=[v.x-i[0],v.y-i[1]],N=Math.hypot(b[0],b[1]);N=N<1e-4?1e-4:N,b[0]=b[0]/N,b[1]=b[1]/N;var M=o*(E+1);e[p][0]-=M*b[0],e[p][1]-=M*b[1]}}return e},t.prototype.getRepGraForces=function(t,e,r,n,o,i,a){for(var s=a.preventOverlap,u=a.kr,d=a.kg,h=a.center,c=a.prune,l=t.getAllNodes(),f=l.length,g=0;g<f;g+=1){for(var p=l[g],v=t.getDegree(p.id),y=g+1;y<f;y+=1){var m=l[y],w=t.getDegree(m.id);if(!c||!(v<=1||w<=1)){var x=[m.data.x-p.data.x,m.data.y-p.data.y],E=Math.hypot(x[0],x[1]);E=E<1e-4?1e-4:E,x[0]=x[0]/E,x[1]=x[1]/E,s&&e<r&&(E=E-i[p.id]-i[m.id]);var b=u*(v+1)*(w+1)/E;s&&e<r&&E<0?b=o*(v+1)*(w+1):s&&e<r&&0===E?b=0:s&&e<r&&E>0&&(b=u*(v+1)*(w+1)/E),n[p.id][0]-=b*x[0],n[m.id][0]+=b*x[0],n[p.id][1]-=b*x[1],n[m.id][1]+=b*x[1]}}var N=[p.data.x-h[0],p.data.y-h[1]],M=Math.hypot(N[0],N[1]);N[0]=N[0]/M,N[1]=N[1]/M;var S=d*(v+1);n[p.id][0]-=S*N[0],n[p.id][1]-=S*N[1]}return n},t.prototype.updatePos=function(t,e,r,n,o){for(var i=o.ks,a=o.tao,s=o.prune,u=o.ksmax,d=t.getAllNodes(),h=d.length,c=[],l=[],f=0,g=0,p=n,v=0;v<h;v+=1){var y=d[v].id,m=t.getDegree(y);if(!(s&&m<=1)){var w=[e[y][0]-r[y][0],e[y][1]-r[y][1]],E=Math.hypot(w[0],w[1]),b=[e[y][0]+r[y][0],e[y][1]+r[y][1]],N=Math.hypot(b[0],b[1]);c[v]=E,l[v]=N/2,f+=(m+1)*c[v],g+=(m+1)*l[v]}}var M=p;for(p=a*g/f,0!==M&&(p=p>1.5*M?1.5*M:p),v=0;v<h;v+=1){var S=d[v],k=(y=S.id,S.data);if(m=t.getDegree(y),!(s&&m<=1||x(k.fx)&&x(k.fy))){var A=i*p/(1+p*Math.sqrt(c[v])),R=Math.hypot(e[y][0],e[y][1]),I=u/(R=R<1e-4?1e-4:R),_=(A=A>I?I:A)*e[y][0],D=A*e[y][1];t.mergeNodeData(y,{x:k.x+_,y:k.y+D})}}return p},t}(),Or={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=n(n({},Or),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericFruchtermanLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,x,E=this;return a(this,(function(a){return this.running?[2]:(o=this.formatOptions(r),i=o.width,s=o.height,u=o.center,d=o.clustering,h=o.nodeClusterBy,c=o.maxIteration,f=o.onTick,g=e.getAllNodes(),p=e.getAllEdges(),(null==g?void 0:g.length)?1===g.length?(t&&e.mergeNodeData(g[0].id,{x:u[0],y:u[1]}),v={nodes:[n(n({},g[0]),{data:n(n({},g[0].data),{x:u[0],y:u[1]})})],edges:p},this.lastResult=v,[2,v]):(y=g.map((function(t){return b(t,[i,s])})),m=new l({nodes:y,edges:p}),w={},d&&y.forEach((function(t){var e=t.data[h];w[e]||(w[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=y,this.lastLayoutEdges=p,this.lastAssign=t,this.lastGraph=m,this.lastOptions=o,this.lastClusterMap=w,"undefined"==typeof window?[2]:(x=0,[2,new Promise((function(r){E.timeInterval=window.setInterval((function(){E.running?(E.runOneStep(m,w,o),t&&y.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y})})),null==f||f({nodes:y,edges:p}),++x>=c&&(window.clearInterval(E.timeInterval),r({nodes:y,edges:p}))):r({nodes:y,edges:p})}),0),E.running=!0}))])):(v={nodes:[],edges:p},this.lastResult=v,[2,v]))}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=n(n({},this.options),t),r=e.clustering,o=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=r&&!!o,e},t.prototype.runOneStep=function(t,e,r){var n=r.height,o=r.width,i=r.gravity,a=r.center,s=r.speed,u=r.clustering,d=r.nodeClusterBy,h=r.clusterGravity,c=n*o,l=Math.sqrt(c)/10,f=t.getAllNodes(),g=c/(f.length+1),p=Math.sqrt(g),v={};if(this.applyCalculate(t,v,p,g),u){for(var y in e)e[y].cx=0,e[y].cy=0,e[y].count=0;for(var y in f.forEach((function(t){var r=t.data,n=e[r[d]];x(r.x)&&(n.cx+=r.x),x(r.y)&&(n.cy+=r.y),n.count++})),e)e[y].cx/=e[y].count,e[y].cy/=e[y].count;var m=h||i;f.forEach((function(t,r){var n=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=e[o[d]],a=Math.sqrt((o.x-i.cx)*(o.x-i.cx)+(o.y-i.cy)*(o.y-i.cy)),s=p*m;v[n].x-=s*(o.x-i.cx)/a,v[n].y-=s*(o.y-i.cy)/a}}))}f.forEach((function(t,e){var r=t.id,n=t.data;if(x(n.x)&&x(n.y)){var o=.01*p*i;v[r].x-=o*(n.x-a[0]),v[r].y-=o*(n.y-a[1])}})),f.forEach((function(e,r){var n=e.id,o=e.data;if(x(o.fx)&&x(o.fy))return o.x=o.fx,void(o.y=o.fy);if(x(o.x)&&x(o.y)){var i=Math.sqrt(v[n].x*v[n].x+v[n].y*v[n].y);if(i>0){var a=Math.min(l*(s/800),i);t.mergeNodeData(n,{x:o.x+v[n].x/i*a,y:o.y+v[n].y/i*a})}}}))},t.prototype.applyCalculate=function(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)},t.prototype.calRepulsive=function(t,e,r){var n=t.getAllNodes();n.forEach((function(t,o){var i=t.data,a=t.id;e[a]={x:0,y:0},n.forEach((function(t,n){var s=t.data,u=t.id;if(!(o<=n)&&x(i.x)&&x(s.x)&&x(i.y)&&x(s.y)){var d=i.x-s.x,h=i.y-s.y,c=d*d+h*h;0===c&&(c=1,d=.01,h=.01);var l=r/c,f=d*l,g=h*l;e[a].x+=f,e[a].y+=g,e[u].x-=f,e[u].y-=g}}))}))},t.prototype.calAttractive=function(t,e,r){t.getAllEdges().forEach((function(n){var o=n.source,i=n.target;if(o&&i&&o!==i){var a=t.getNode(o).data,s=t.getNode(i).data;if(x(s.x)&&x(a.x)&&x(s.y)&&x(a.y)){var u=s.x-a.x,d=s.y-a.y,h=Math.sqrt(u*u+d*d)/r,c=u*h,l=d*h;e[o].x+=c,e[o].y+=l,e[i].x-=c,e[i].y-=l}}}))},t}(),Tr={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},zr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="grid",this.options=n(n({},Tr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericGridLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericGridLayout(!0,t,e),[2]}))}))},t.prototype.genericGridLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,p,v,y,m,w,E,N,M,A,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.begin,s=void 0===i?[0,0]:i,u=o.condense,d=o.preventOverlapPadding,h=o.preventOverlap,c=o.rows,l=o.cols,f=o.nodeSpacing,p=o.nodeSize,v=o.width,y=o.height,m=o.position,w=o.sortBy,E=e.getAllNodes(),N=e.getAllEdges(),!(M=null==E?void 0:E.length)||1===M)return[2,R(e,t,s)];if(A=E.map((function(t){return b(t)})),"id"===w||P(w)&&void 0!==A[0].data[w]||(w="degree"),"degree"===w?A.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):"id"===w?A.sort((function(t,e){return x(e.id)&&x(t.id)?e.id-t.id:(""+t.id).localeCompare(""+e.id)})):A.sort((function(t,e){return e.data[w]-t.data[w]})),I=v||"undefined"==typeof window?v:window.innerWidth,_=y||"undefined"==typeof window?y:window.innerHeight,D=M,O={rows:c,cols:l},null!=c&&null!=l?(O.rows=c,O.cols=l):null!=c&&null==l?(O.rows=c,O.cols=Math.ceil(D/O.rows)):null==c&&null!=l?(O.cols=l,O.rows=Math.ceil(D/O.cols)):(T=Math.sqrt(D*_/I),O.rows=Math.round(T),O.cols=Math.round(I/_*T)),O.rows=Math.max(O.rows,1),O.cols=Math.max(O.cols,1),O.cols*O.rows>D)z=Cr(O),C=Lr(O),(z-1)*C>=D?Cr(O,z-1):(C-1)*z>=D&&Lr(O,C-1);else for(;O.cols*O.rows<D;)z=Cr(O),((C=Lr(O))+1)*z>=D?Lr(O,C+1):Cr(O,z+1);for(L=u?0:I/O.cols,q=u?0:_/O.rows,(h||f)&&(j=S(10,f),F=k(30,p,!1),A.forEach((function(t){t.data.x&&t.data.y||(t.data.x=0,t.data.y=0);var r,n,o=e.getNode(t.id),i=F(o)||30;g(i)?(r=i[0],n=i[1]):(r=i,n=i);var a=void 0!==j?j(t):d,s=r+a,u=n+a;L=Math.max(L,s),q=Math.max(q,u)}))),V={},G={row:0,col:0},W={},B=0;B<A.length;B++){if($=A[B],U=void 0,m&&(U=m(e.getNode($.id))),U&&(void 0!==U.row||void 0!==U.col)){if(void 0===(H={row:U.row,col:U.col}).col)for(H.col=0;qr(V,H);)H.col++;else if(void 0===H.row)for(H.row=0;qr(V,H);)H.row++;W[$.id]=H,jr(V,H)}Vr($,s,L,q,W,O,G,V)}return K={nodes:A,edges:N},t&&A.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,K]}))}))},t}(),Cr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.min(n,o):Math.min(n,o)===t.rows?t.rows=e:t.cols=e,r},Lr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.max(n,o):Math.max(n,o)===t.rows?t.rows=e:t.cols=e,r},qr=function(t,e){return t["c-"+e.row+"-"+e.col]||!1},jr=function(t,e){return t["c-"+e.row+"-"+e.col]=!0},Fr=function(t,e){var r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},Vr=function(t,e,r,n,o,i,a,s){var u,d,h=o[t.id];if(h)u=h.col*r+r/2+e[0],d=h.row*n+n/2+e[1];else{for(;qr(s,a);)Fr(i,a);u=a.col*r+r/2+e[0],d=a.row*n+n/2+e[1],jr(s,a),Fr(i,a)}t.data.x=u,t.data.y=d};const Gr=Object.prototype.toString;function Wr(t){return Gr.call(t).endsWith("Array]")}function Br(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!Wr(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]<a&&(a=t[s]);return a}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]>a&&(a=t[s]);return a}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,a=void 0===i?r.autoMinMax?n:0:i,s=r.max,u=void 0===s?r.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var d=(u-a)/(o-n),h=0;h<t.length;h++)e[h]=(t[h]-n)*d+a;return e}const $r=" ".repeat(2),Ur=" ".repeat(4);function Hr(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=e;return`${t.constructor.name} {\\n${$r}[\\n${Ur}${function(t,e,r,n,o){const{rows:i,columns:a}=t,s=Math.min(i,e),u=Math.min(a,r),d=[];if("auto"===o){o=!1;t:for(let e=0;e<s;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let e=0;e<s;e++){let r=[];for(let i=0;i<u;i++)r.push(Kr(t.get(e,i),n,o));d.push(`${r.join(" ")}`)}return u!==a&&(d[d.length-1]+=` ... ${a-r} more columns`),s!==i&&d.push(`... ${i-e} more rows`),d.join(`\\n${Ur}`)}(t,r,n,o,i)}\\n${$r}]\\n${$r}rows: ${t.rows}\\n${$r}columns: ${t.columns}\\n}`}function Kr(t,e,r){return(t>=0&&r?` ${Yr(t,e-1)}`:Yr(t,e)).padEnd(e)}function Yr(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function Jr(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function Xr(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function Qr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function Zr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function tn(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(rn("startRow",e),rn("endRow",r),rn("startColumn",n),rn("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function en(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function rn(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function nn(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class on{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new sn(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new sn(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new sn(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new sn(t,e)}static ones(t,e){return new sn(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new sn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)o.set(r,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let a=o-n,s=new sn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(i()*a);s.set(r,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let t=0;t<n;t++)o.set(t,t,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let e=0;e<o;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new sn(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return on.isMatrix(t)?t:new sn(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let a=o;a<e;a++){let e=t.get(r,a)-i*t.get(n,a);t.set(r,a,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new sn(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){Jr(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return sn.rowVector(this.getRow(t))}setRow(t,e){Jr(this,t),e=Qr(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){Jr(this,t),Jr(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){Xr(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return sn.columnVector(this.getColumn(t))}setColumn(t,e){Xr(this,t),e=Zr(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){Xr(this,t),Xr(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){Jr(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){Xr(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){nn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){nn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(Jr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){Jr(this,t),nn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(Jr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){Jr(this,t),nn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(Xr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){Xr(this,t),nn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(Xr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){Xr(this,t),nn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){on.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=sn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new sn(e,n),i=new Float64Array(r);for(let a=0;a<n;a++){for(let e=0;e<r;e++)i[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,a,e)}}return o}strassen2x2(t){t=sn.checkMatrix(t);let e=new sn(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),d=t.get(1,1),h=(r+u)*(n+d),c=(a+u)*n,l=r*(i-d),f=u*(s-n),g=(r+o)*d,p=h+f-g+(o-u)*(s+d),v=l+g,y=c+f,m=h-c+l+(a-r)*(n+i);return e.set(0,0,p),e.set(0,1,v),e.set(1,0,y),e.set(1,1,m),e}strassen3x3(t){t=sn.checkMatrix(t);let e=new sn(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),d=this.get(2,1),h=this.get(2,2),c=t.get(0,0),l=t.get(0,1),f=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),y=t.get(2,0),m=t.get(2,1),w=t.get(2,2),x=(r-i)*(-l+p),E=(-r+i+a)*(c-l+p),b=(i+a)*(-c+l),N=r*c,M=(-r+u+d)*(c-f+v),S=(-r+u)*(f-v),k=(u+d)*(-c+f),A=(-o+d+h)*(p+y-m),R=(o-h)*(p-m),I=o*y,_=(d+h)*(-y+m),D=(-o+a+s)*(v+y-w),O=(o-s)*(v-w),P=(a+s)*(-y+w),T=N+I+n*g,z=(r+n+o-i-a-d-h)*p+E+b+N+A+I+_,C=N+M+k+(r+n+o-a-s-u-d)*v+I+D+P,L=x+a*(-c+l+g-p-v-y+w)+E+N+I+D+O,q=x+E+b+N+s*m,j=I+D+O+P+i*f,F=N+M+S+d*(-c+f+g-p-v-y+m)+A+R+I,V=A+R+I+_+u*l,G=N+M+S+k+h*w;return e.set(0,0,T),e.set(0,1,z),e.set(0,2,C),e.set(1,0,L),e.set(1,1,q),e.set(1,2,j),e.set(2,0,F),e.set(2,1,V),e.set(2,2,G),e}mmulStrassen(t){t=sn.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function a(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=on.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${r} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let s=Math.max(r,o),u=Math.max(n,i);return e=a(e,s,u),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=a(e,n+1,o+1),r=a(r,n+1,o+1)):n%2==1?(e=a(e,n+1,o),r=a(r,n+1,o)):o%2==1&&(e=a(e,n,o+1),r=a(r,n,o+1));let i=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,s-1),d=r.subMatrix(0,i-1,0,s-1),h=e.subMatrix(0,i-1,s,e.columns-1),c=r.subMatrix(0,i-1,s,r.columns-1),l=e.subMatrix(i,e.rows-1,0,s-1),f=r.subMatrix(i,r.rows-1,0,s-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),p=r.subMatrix(i,r.rows-1,s,r.columns-1),v=t(on.add(u,g),on.add(d,p),i,s),y=t(on.add(l,g),d,i,s),m=t(u,on.sub(c,p),i,s),w=t(g,on.sub(f,d),i,s),x=t(on.add(u,h),p,i,s),E=t(on.sub(l,u),on.add(d,c),i,s),b=t(on.sub(h,g),on.add(f,p),i,s),N=on.add(v,w);N.sub(x),N.add(b);let M=on.add(m,x),S=on.add(y,w),k=on.sub(v,y);k.add(m),k.add(E);let A=on.zeros(2*N.rows,2*N.columns);return A=A.setSubMatrix(N,0,0),A=A.setSubMatrix(M,N.rows,0),A=A.setSubMatrix(S,0,N.columns),A=A.setSubMatrix(k,N.rows,N.columns),A.subMatrix(0,n-1,0,o-1)}(e,t=a(t,s,u),s,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new sn(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&Br(o,{min:e,max:r,output:o}),n.setRow(t,o)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new sn(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&Br(o,{min:e,max:r,output:o}),n.setColumn(t,o)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=sn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new sn(e*n,r*o);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<o;s++)i.set(n*a+r,o*e+s,this.get(a,e)*t.get(r,s));return i}kroneckerSum(t){if(t=sn.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(sn.eye(r,r)),o=sn.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new sn(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=an){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=an){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){tn(this,t,e,r,n);let o=new sn(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new sn(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new sn(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=sn.checkMatrix(t)).isEmpty())return this;tn(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){!function(t,e){if(!Wr(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!Wr(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new sn(t.length,e.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<e.length;t++){let i=e[t];r.set(n,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new sn(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=en(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=en(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=en(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=en(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Wr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<n;a++){let n=0,s=0,u=0;for(let e=0;e<o;e++)u=t.get(a,e)-r[a],n+=u,s+=u*u;e?i.push((s-n*n/o)/(o-1)):i.push((s-n*n/o)/o)}return i}(this,r,n);case"column":if(!Wr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<o;a++){let o=0,s=0,u=0;for(let e=0;e<n;e++)u=t.get(e,a)-r[a],o+=u,s+=u*u;e?i.push((s-o*o/n)/(n-1)):i.push((s-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let a=0,s=0,u=0;for(let e=0;e<n;e++)for(let n=0;n<o;n++)u=t.get(e,n)-r,a+=u,s+=u*u;return e?(s-a*a/i)/(i-1):(s-a*a/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Wr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!Wr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!Wr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!Wr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return Hr(this,t)}}function an(t,e){return t-e}on.prototype.klass="Matrix","undefined"!=typeof Symbol&&(on.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return Hr(this)}),on.random=on.rand,on.randomInt=on.randInt,on.diagonal=on.diag,on.prototype.diagonal=on.prototype.diag,on.identity=on.eye,on.prototype.negate=on.prototype.neg,on.prototype.tensorProduct=on.prototype.kroneckerProduct;class sn extends on{constructor(t,e){if(super(),sn.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Wr(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!r[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return Jr(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),Jr(this,t,!0),e=Float64Array.from(Qr(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){Xr(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),Xr(this,t,!0),e=Zr(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(on,sn);class un extends on{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function dn(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class hn{constructor(t,e={}){if((t=un.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=e;let s,u=Boolean(o),d=Boolean(i),h=!1;if(r<n)if(a){s=t.transpose(),r=s.rows,n=s.columns,h=!0;let e=u;u=d,d=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let c=Math.min(r,n),l=Math.min(r+1,n),f=new Float64Array(l),g=new sn(r,c),p=new sn(n,n),v=new Float64Array(n),y=new Float64Array(r),m=new Float64Array(l);for(let t=0;t<l;t++)m[t]=t;let w=Math.min(r-1,n),x=Math.max(0,Math.min(n-2,r)),E=Math.max(w,x);for(let t=0;t<E;t++){if(t<w){f[t]=0;for(let e=t;e<r;e++)f[t]=dn(f[t],s.get(e,t));if(0!==f[t]){s.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<r;e++)s.set(e,t,s.get(e,t)/f[t]);s.set(t,t,s.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<n;e++){if(t<w&&0!==f[t]){let n=0;for(let o=t;o<r;o++)n+=s.get(o,t)*s.get(o,e);n=-n/s.get(t,t);for(let o=t;o<r;o++)s.set(o,e,s.get(o,e)+n*s.get(o,t))}v[e]=s.get(t,e)}if(u&&t<w)for(let e=t;e<r;e++)g.set(e,t,s.get(e,t));if(t<x){v[t]=0;for(let e=t+1;e<n;e++)v[t]=dn(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<n;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<r&&0!==v[t]){for(let e=t+1;e<r;e++)y[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)y[e]+=v[r]*s.get(e,r);for(let e=t+1;e<n;e++){let n=-v[e]/v[t+1];for(let o=t+1;o<r;o++)s.set(o,e,s.get(o,e)+n*y[o])}}if(d)for(let e=t+1;e<n;e++)p.set(e,t,v[e])}}let b=Math.min(n,r+1);if(w<n&&(f[w]=s.get(w,w)),r<b&&(f[b-1]=0),x+1<b&&(v[x]=s.get(x,b-1)),v[b-1]=0,u){for(let t=w;t<c;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<c;e++){let n=0;for(let o=t;o<r;o++)n+=g.get(o,t)*g.get(o,e);n=-n/g.get(t,t);for(let o=t;o<r;o++)g.set(o,e,g.get(o,e)+n*g.get(o,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(d)for(let t=n-1;t>=0;t--){if(t<x&&0!==v[t])for(let e=t+1;e<n;e++){let r=0;for(let o=t+1;o<n;o++)r+=p.get(o,t)*p.get(o,e);r=-r/p.get(t+1,t);for(let o=t+1;o<n;o++)p.set(o,e,p.get(o,e)+r*p.get(o,t))}for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}let N=b-1,M=0,S=Number.EPSILON;for(;b>0;){let t,e;for(t=b-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===b-2)e=4;else{let r;for(r=b-1;r>=t&&r!==t;r--){let e=(r!==b?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(f[r])<=S*e){f[r]=0;break}}r===t?e=3:r===b-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[b-2];v[b-2]=0;for(let r=b-2;r>=t;r--){let o=dn(f[r],e),i=f[r]/o,a=e/o;if(f[r]=o,r!==t&&(e=-a*v[r-1],v[r-1]=i*v[r-1]),d)for(let t=0;t<n;t++)o=i*p.get(t,r)+a*p.get(t,b-1),p.set(t,b-1,-a*p.get(t,r)+i*p.get(t,b-1)),p.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<b;n++){let o=dn(f[n],e),i=f[n]/o,a=e/o;if(f[n]=o,e=-a*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g.get(e,n)+a*g.get(e,t-1),g.set(e,t-1,-a*g.get(e,n)+i*g.get(e,t-1)),g.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(f[b-1]),Math.abs(f[b-2]),Math.abs(v[b-2]),Math.abs(f[t]),Math.abs(v[t])),o=f[b-1]/e,i=f[b-2]/e,a=v[b-2]/e,s=f[t]/e,h=v[t]/e,c=((i+o)*(i-o)+a*a)/2,l=o*a*(o*a);let y=0;0===c&&0===l||(y=c<0?0-Math.sqrt(c*c+l):Math.sqrt(c*c+l),y=l/(c+y));let m=(s+o)*(s-o)+y,w=s*h;for(let e=t;e<b-1;e++){let o=dn(m,w);0===o&&(o=Number.MIN_VALUE);let i=m/o,a=w/o;if(e!==t&&(v[e-1]=o),m=i*f[e]+a*v[e],v[e]=i*v[e]-a*f[e],w=a*f[e+1],f[e+1]=i*f[e+1],d)for(let t=0;t<n;t++)o=i*p.get(t,e)+a*p.get(t,e+1),p.set(t,e+1,-a*p.get(t,e)+i*p.get(t,e+1)),p.set(t,e,o);if(o=dn(m,w),0===o&&(o=Number.MIN_VALUE),i=m/o,a=w/o,f[e]=o,m=i*v[e]+a*f[e+1],f[e+1]=-a*v[e]+i*f[e+1],w=a*v[e+1],v[e+1]=i*v[e+1],u&&e<r-1)for(let t=0;t<r;t++)o=i*g.get(t,e)+a*g.get(t,e+1),g.set(t,e+1,-a*g.get(t,e)+i*g.get(t,e+1)),g.set(t,e,o)}v[b-2]=m,M+=1;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,d))for(let e=0;e<=N;e++)p.set(e,t,-p.get(e,t));for(;t<N&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,d&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}M=0,b--}}if(h){let t=p;p=g,g=t}this.m=r,this.n=n,this.s=f,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,o=sn.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?o.set(t,t,0):o.set(t,t,1/this.s[t]);let i=this.U,a=this.rightSingularVectors,s=a.mmul(o),u=a.rows,d=i.rows,h=sn.zeros(u,d);for(let t=0;t<u;t++)for(let e=0;e<d;e++){let r=0;for(let o=0;o<n;o++)r+=s.get(t,o)*i.get(e,o);h.set(t,e,r)}return h.mmul(e)}solveForDiagonal(t){return this.solve(sn.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new sn(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,a=i.rows,s=i.columns,u=new sn(r,a);for(let t=0;t<r;t++)for(let e=0;e<a;e++){let r=0;for(let n=0;n<s;n++)r+=o.get(t,n)*i.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return sn.diag(this.s)}}var cn,ln={center:[0,0],linkDistance:50},fn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="mds",this.options=n(n({},ln),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericMDSLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericMDSLayout(!0,t,e),[2]}))}))},t.prototype.genericMDSLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,g,y;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=void 0===i?[0,0]:i,u=o.linkDistance,d=void 0===u?50:u,h=e.getAllNodes(),c=e.getAllEdges(),(null==h?void 0:h.length)&&1!==h.length?(l=v({nodes:h,edges:c},!1),f=p(l),gn(f),m=d,w=[],f.forEach((function(t){var e=[];t.forEach((function(t){e.push(t*m)})),w.push(e)})),g=pn(w),y=[],g.forEach((function(t,e){var r=b(h[e]);r.data.x=t[0]+s[0],r.data.y=t[1]+s[1],y.push(r)})),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:y,edges:c}]):[2,R(e,t,s)];var m,w}))}))},t}(),gn=function(t){var e=-999999;t.forEach((function(t){t.forEach((function(t){t!==1/0&&e<t&&(e=t)}))})),t.forEach((function(r,n){r.forEach((function(r,o){r===1/0&&(t[n][o]=e)}))}))},pn=function(t){var e=sn.mul(sn.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),o=e.mean();e.add(o).subRowVector(r).subColumnVector(n);var i=new hn(e),a=sn.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((function(t){return sn.mul([t],[a]).toJSON()[0].splice(0,2)}))},vn={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},yn=function(t,e,r,n,o,i){e.forEach((function(a,s){r[s]={x:0,y:0},e.forEach((function(e,u){if(s!==u&&o[s]===o[u]){var d=a.x-e.x,h=a.y-e.y,c=Math.sqrt(d*d+h*h);if(0===c){c=1;var l=s>u?1:-1;d=.01*l,h=.01*l}if(c<i(t[s])/2+i(t[u])/2){var f=n*n/c;r[s].x+=d/c*f,r[s].y+=h/c*f}}}))}))},mn=function(t,e,r,n,o,i,a,s){var u=i||a/10;return n&&e.forEach((function(e,r){var n=t[r].x-t[o].x,i=t[r].y-t[o].y,a=Math.sqrt(n*n+i*i),s=i/a,u=-n/a,d=Math.sqrt(e.x*e.x+e.y*e.y),h=Math.acos((s*e.x+u*e.y)/d);h>Math.PI/2&&(h-=Math.PI/2,s*=-1,u*=-1);var c=Math.cos(h)*d;e.x=s*c,e.y=u*c})),t.forEach((function(i,a){if(a!==o){var d=Math.sqrt(e[a].x*e[a].x+e[a].y*e[a].y);if(d>0&&a!==o){var h=Math.min(u*(r/800),d);if(i.x+=e[a].x/d*h,i.y+=e[a].y/d*h,n){var c=i.x-t[o].x,l=i.y-t[o].y,f=Math.sqrt(c*c+l*l);c=c/f*s[a],l=l/f*s[a],i.x=t[o].x+c,i.y=t[o].y+l}}}})),t},wn={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},xn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="radial",this.options=n(n({},wn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRadialLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRadialLayout(!0,t,e),[2]}))}))},t.prototype.genericRadialLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,d,h,c,l,f,g,y,m,w,x,E,N,M,S,k,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K,Y,J,X,Q,Z,tt,et;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,d=o.height,h=o.center,c=o.focusNode,l=o.unitRadius,f=o.nodeSize,g=o.nodeSpacing,y=o.strictRadial,m=o.preventOverlap,w=o.maxPreventOverlapIteration,x=o.sortBy,E=o.linkDistance,N=void 0===E?50:E,M=o.sortStrength,S=void 0===M?10:M,k=o.maxIteration,I=void 0===k?1e3:k,_=e.getAllNodes(),D=e.getAllEdges(),O=i||"undefined"==typeof window?i:window.innerWidth,T=d||"undefined"==typeof window?d:window.innerHeight,z=h||[O/2,T/2],!(null==_?void 0:_.length)||1===_.length)return[2,R(e,t,z)];if(C=_[0],P(c)){for(L=0;L<_.length;L++)if(_[L].id===c){C=_[L];break}}else C=c||_[0];return q=Nn(_,C.id),j=v({nodes:_,edges:D},!1),F=p(j),V=Sn(F,q),Mn(F,q,V+1),G=F[q],W=O-z[0]>z[0]?z[0]:O-z[0],B=T-z[1]>z[1]?z[1]:T-z[1],0===W&&(W=O/2),0===B&&(B=T/2),$=Math.min(W,B),U=Math.max.apply(Math,u([],s(G))),H=[],K=l||$/U,G.forEach((function(t,e){H[e]=t*K})),Y=En(_,F,N,H,K,x,S),J=bn(Y),X=function(t,e,r){try{var n=sn.mul(sn.pow(e,2),-.5),o=n.mean("row"),i=n.mean("column"),a=n.mean();n.add(a).subRowVector(o).subColumnVector(i);var s=new hn(n),u=sn.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((function(e){return sn.mul([e],[u]).toJSON()[0].splice(0,t)}))}catch(t){for(var d=[],h=0;h<e.length;h++){var c=Math.random()*r,l=Math.random()*r;d.push([c,l])}return d}}(N,Y,N),Q=X.map((function(t){var e=s(t,2),r=e[0],n=e[1];return{x:(isNaN(r)?Math.random()*N:r)-X[q][0],y:(isNaN(n)?Math.random()*N:n)-X[q][1]}})),this.run(I,Q,J,Y,H,q),m&&(Z=A(f,g),tt={nodes:_,nodeSizeFunc:Z,positions:Q,radii:H,height:T,width:O,strictRadial:Boolean(y),focusIdx:q,iterations:w||200,k:Q.length/4.5},Q=function(t,e){for(var r=n(n({},vn),e),o=r.positions,i=r.iterations,a=r.width,s=r.k,u=r.speed,d=void 0===u?100:u,h=r.strictRadial,c=r.focusIdx,l=r.radii,f=void 0===l?[]:l,g=r.nodeSizeFunc,p=t.getAllNodes(),v=[],y=a/10,m=0;m<i;m++)o.forEach((function(t,e){v[e]={x:0,y:0}})),yn(p,o,v,s,f,g),mn(o,v,d,h,c,y,a,f);return o}(e,tt)),et=[],Q.forEach((function(t,e){var r=b(_[e]);r.data.x=t.x+z[0],r.data.y=t.y+z[1],et.push(r)})),t&&et.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:et,edges:D}]}))}))},t.prototype.run=function(t,e,r,n,o,i){for(var a=0;a<=t;a++){var s=a/t;this.oneIteration(s,e,o,n,r,i)}},t.prototype.oneIteration=function(t,e,r,n,o,i){var a=1-t;e.forEach((function(s,u){var d=y(s,{x:0,y:0}),h=0===d?0:1/d;if(u!==i){var c=0,l=0,f=0;e.forEach((function(t,e){if(u!==e){var r=y(s,t),i=0===r?0:1/r,a=n[e][u];f+=o[u][e],c+=o[u][e]*(t.x+a*(s.x-t.x)*i),l+=o[u][e]*(t.y+a*(s.y-t.y)*i)}}));var g=0===r[u]?0:1/r[u];f*=a,f+=t*g*g,c*=a,c+=t*g*s.x*h,s.x=c/f,l*=a,l+=t*g*s.y*h,s.y=l/f}}))},t}(),En=function(t,e,r,n,o,i,a){if(!t)return[];var s=[];if(e){var u={};e.forEach((function(e,d){var h=[];e.forEach((function(e,s){var c,l;if(d===s)h.push(0);else if(n[d]===n[s])if("data"===i)h.push(e*(Math.abs(d-s)*a)/(n[d]/o));else if(i){var f=void 0,g=void 0;if(u[t[d].id])f=u[t[d].id];else{var p=("id"===i?t[d].id:null===(c=t[d].data)||void 0===c?void 0:c[i])||0;f=P(p)?p.charCodeAt(0):p,u[t[d].id]=f}u[t[s].id]?g=u[t[s].id]:(p=("id"===i?t[s].id:null===(l=t[s].data)||void 0===l?void 0:l[i])||0,g=P(p)?p.charCodeAt(0):p,u[t[s].id]=g),h.push(e*(Math.abs(f-g)*a)/(n[d]/o))}else h.push(e*r/(n[d]/o));else{var v=(r+o)/2;h.push(e*v)}})),s.push(h)}))}return s},bn=function(t){for(var e=t.length,r=t[0].length,n=[],o=0;o<e;o++){for(var i=[],a=0;a<r;a++)0!==t[o][a]?i.push(1/(t[o][a]*t[o][a])):i.push(0);n.push(i)}return n},Nn=function(t,e){var r=-1;return t.forEach((function(t,n){t.id===e&&(r=n)})),Math.max(r,0)},Mn=function(t,e,r){for(var n=t.length,o=0;o<n;o++)if(t[e][o]===1/0){t[e][o]=r,t[o][e]=r;for(var i=0;i<n;i++)t[o][i]!==1/0&&t[e][i]===1/0&&(t[e][i]=r+t[o][i],t[i][e]=r+t[o][i])}for(o=0;o<n;o++)if(o!==e)for(i=0;i<n;i++)if(t[o][i]===1/0){var a=Math.abs(t[e][o]-t[e][i]);a=0===a?1:a,t[o][i]=a}},Sn=function(t,e){for(var r=0,n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r},kn={center:[0,0],width:300,height:300},An=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="random",this.options=n(n({},kn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRandomLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRandomLayout(!0,t,e),[2]}))}))},t.prototype.genericRandomLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,d=e.getAllNodes(),h=s||"undefined"==typeof window?s:window.innerWidth,c=u||"undefined"==typeof window?u:window.innerHeight,l=i||[h/2,c/2],f=[],d&&d.forEach((function(t){f.push({id:t.id,data:{x:.9*(Math.random()-.5)*h+l[0],y:.9*(Math.random()-.5)*c+l[1]}})})),t&&f.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:f,edges:e.getAllEdges()}]}))}))},t}(),Rn={circular:_,concentric:z,mds:fn,random:An,grid:zr,radial:xn,force:xr,d3force:zt,fruchterman:Pr,forceAtlas2:Dr,dagre:pr};function In(){var t;(null===(t=cn)||void 0===t?void 0:t.stop)&&cn.stop()}function _n(t,e){return i(this,void 0,void 0,(function(){var r,n,o,i,s,u,d,h,c;return a(this,(function(a){switch(a.label){case 0:if(r=t.layout,n=r.id,o=r.options,i=r.iterations,s=t.nodes,u=t.edges,d=new l({nodes:s,edges:u}),!(h=Rn[n]))throw new Error("Unknown layout id: "+n);return[4,(cn=new h(o)).execute(d)];case 1:return c=a.sent(),!!(f=cn).tick&&!!f.stop&&(cn.stop(),c=cn.tick(i)),[2,[c,e]]}var f}))}))}addEventListener("message",(function(t){var r,n=t.data,o=n.type,i=n.method,a=n.id,s=n.params;"RPC"===o&&i&&((r=e[i])?Promise.resolve().then((function(){return r.apply(e,s)})):Promise.reject("No such method")).then((function(t){postMessage({type:"RPC",id:a,result:t})})).catch((function(t){var e={message:t};t.stack&&(e.message=t.message,e.stack=t.stack,e.name=t.name),postMessage({type:"RPC",id:a,error:e})}))})),postMessage({type:"RPC",method:"ready"});\n//# sourceMappingURL=c1c68049e416ee50a3be.worker.js.map'])),{name:"[fullhash].worker.js"});return URL.revokeObjectURL(URL.createObjectURL(new Blob(['var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{calculateLayout:()=>_n,stopLayout:()=>In});var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function o(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function i(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function a(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function u(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}Object.create,Object.create;const d=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[],i=this._events["*"]||[],a=function(n){for(var o=n.length,i=0;i<o;i++)if(n[i]){var a=n[i],s=a.callback;a.once&&(n.splice(i,1),0===n.length&&delete e._events[t],o--,i--),s.apply(e,r)}};a(o),a(i)},t.prototype.off=function(t,e){if(t)if(e){for(var r=this._events[t]||[],n=r.length,o=0;o<n;o++)r[o].callback===e&&(r.splice(o,1),n--,o--);0===r.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function h(t,e,r,n){for(;t.length;){const o=t.shift();if(r(o))return!0;e.add(o.id),n(o.id).forEach((r=>{e.has(r.id)||(e.add(r.id),t.push(r))}))}return!1}function c(t,e,r,n){if(r(t))return!0;e.add(t.id);for(const o of n(t.id))if(!e.has(o.id)&&c(o,e,r,n))return!0;return!1}class l extends d{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const r=e.find((e=>e.type===t.type&&e.id===t.id&&e.propertyName===t.propertyName));r?r.newValue=t.newValue:e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const r=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),r=this.bothEdgesMap.get(t);r?.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((e=>{e.childrenMap.get(t)?.forEach((t=>{e.parentMap.delete(t.id)})),e.parentMap.delete(t),e.childrenMap.delete(t)})),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){const n=this.getNode(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateNodeDataProperty(t,e,r)}))}))}updateNodeData(...t){const e=t[0],r=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:o})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),o.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),o=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),o.delete(e),i.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.source,o=e;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:o})}))}updateEdgeTarget(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.target,o=e;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:o})}))}updateEdgeDataProperty(t,e,r){const n=this.getEdge(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}updateEdgeData(...t){const e=t[0],r=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:o})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateEdgeDataProperty(t,e,r)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const r=[],n=Array.isArray(t)?t:[t];for(;n.length;){const t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach((t=>{t.children?.forEach((r=>{this.setParent(r.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const r=this.treeIndices.get(e).childrenMap.get(t);return Array.from(r||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const r=[];let n,o=this.getNode(t);for(;n=this.getParent(o.id,e);)r.push(n),o=n;return r}setParent(t,e,r){this.checkTreeExistence(r);const n=this.treeIndices.get(r),o=this.getNode(t),i=n.parentMap.get(t),a=this.getNode(e);n.parentMap.set(t,a),i&&n.childrenMap.get(i.id)?.delete(o);let s=n.childrenMap.get(a.id);s||(s=new Set,n.childrenMap.set(a.id,s)),s.add(o),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:i?.id,newParentId:a.id})}))}dfsTree(t,e,r){return c(this.getNode(t),new Set,e,(t=>this.getChildren(t,r)))}bfsTree(t,e,r){return h([this.getNode(t)],new Set,e,(t=>this.getChildren(t,r)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return h([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return c(this.getNode(t),new Set,e,n)}clone(){const t=this.getAllNodes().map((t=>({...t,data:{...t.data}}))),e=this.getAllEdges().map((t=>({...t,data:{...t.data}}))),r=new l({nodes:t,edges:e});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},n)=>{const o=new Map;t.forEach(((t,e)=>{o.set(e,r.getNode(t.id))}));const i=new Map;e.forEach(((t,e)=>{i.set(e,new Set(Array.from(t).map((t=>r.getNode(t.id)))))})),r.treeIndices.set(n,{parentMap:o,childrenMap:i})})),r}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var f=/-(\\w)/g,g=(function(t){return t.replace(f,(function(t,e){return e?e.toUpperCase():""}))},Object.create(null),Array.isArray),p=function(t){for(var e=[],r=t.length,n=0;n<r;n+=1){e[n]=[];for(var o=0;o<r;o+=1)n===o?e[n][o]=0:0!==t[n][o]&&t[n][o]?e[n][o]=t[n][o]:e[n][o]=1/0}for(var i=0;i<r;i+=1)for(n=0;n<r;n+=1)for(o=0;o<r;o+=1)e[n][o]>e[n][i]+e[i][o]&&(e[n][o]=e[n][i]+e[i][o]);return e},v=function(t,e){var r=t.nodes,n=t.edges,o=[],i={};if(!r)throw new Error("invalid nodes data!");return r&&r.forEach((function(t,e){i[t.id]=e,o.push([])})),null==n||n.forEach((function(t){var r=t.source,n=t.target,a=i[r],s=i[n];void 0!==a&&void 0!==s&&(o[a][s]=1,e||(o[s][a]=1))})),o},y=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},m={}.toString;const w=function(t,e){return m.call(t)==="[object "+e+"]"},x=function(t){return w(t,"Number")};var E=function(t){if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var e=[];return t.forEach((function(t){e.push(t)})),e.map((function(t){return E(t)}))}if("object"==typeof t){var r={};return Object.keys(t).forEach((function(e){r[e]=E(t[e])})),r}return t},b=function(t,e){var r=E(t);return r.data=r.data||{},e&&(x(r.data.x)||(r.data.x=Math.random()*e[0]),x(r.data.y)||(r.data.y=Math.random()*e[1])),r};const N=function(t){return"function"==typeof t},M=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function S(t,e){return N(e)?e:x(e)?function(){return e}:function(){return t}}function k(t,e,r){return void 0===r&&(r=!0),e||0===e?N(e)?e:x(e)?function(){return e}:g(e)?function(){if(r){var n=Math.max.apply(Math,u([],s(e)));return isNaN(n)?t:n}return e}:M(e)?function(){if(r){var n=Math.max(e.width,e.height);return isNaN(n)?t:n}return[e.width,e.height]}:function(){return t}:function(e){var r=(e.data||{}).size;return r?g(r)?r[0]>r[1]?r[0]:r[1]:M(r)?r.width>r.height?r.width:r.height:r:t}}var A=function(t,e){var r;return r=x(e)?function(){return e}:N(e)?e:function(){return 0},t?g(t)?function(e){return(t[0]>t[1]?t[0]:t[1])+r(e)}:function(e){return t+r(e)}:function(t){var e,n;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return Math.max(t.data.bboxSize[0],t.data.bboxSize[1])+r(t);if(null===(n=t.data)||void 0===n?void 0:n.size){if(g(t.data.size))return Math.max(t.data.size[0],t.data.size[1])+r(t);var o=t.data.size;return M(o)?(o.width>o.height?o.width:o.height)+r(t):o+r(t)}return 10+r(t)}},R=function(t,e,r){var o=t.getAllNodes(),i=t.getAllEdges();return(null==o?void 0:o.length)?1===o.length?(e&&t.mergeNodeData(o[0].id,{x:r[0],y:r[1]}),{nodes:[n(n({},o[0]),{data:n(n({},o[0].data),{x:r[0],y:r[1]})})],edges:i}):void 0:{nodes:[],edges:i}},I={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},_=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="circular",this.options=n(n({},I),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericCircularLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericCircularLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericCircularLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,u,d,h,c,l,f,g,p,v,y,m,w,x,E,N,M,A,I,_,P,T,z,C,L,q,j,F,V,G,W,B,$,U;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,u=o.height,d=o.center,h=o.divisions,c=o.startAngle,l=void 0===c?0:c,f=o.endAngle,g=void 0===f?2*Math.PI:f,p=o.angleRatio,v=o.ordering,y=o.clockwise,m=o.nodeSpacing,w=o.nodeSize,x=e.getAllNodes(),E=e.getAllEdges(),N=s(O(i,u,d),3),M=N[0],A=N[1],I=N[2],!(_=null==x?void 0:x.length)||1===_)return[2,R(e,t,I)];for(P=(g-l)/_,T=o.radius,z=o.startRadius,C=o.endRadius,m?(L=S(10,m),q=k(10,w),j=-1/0,x.forEach((function(t){var e=q(t);j<e&&(j=e)})),F=0,x.forEach((function(t,e){F+=0===e?j||10:(L(t)||0)+(j||10)})),T=F/(2*Math.PI)):T||z||C?!z&&C?z=C:z&&!C&&(C=z):T=Math.min(A,M)/2,V=P*p,G=[],G="topology"===v?D(e,x):"topology-directed"===v?D(e,x,!0):"degree"===v?function(t,e){var r=[];return e.forEach((function(t,e){r.push(b(t))})),r.sort((function(e,r){return t.getDegree(e.id,"both")-t.getDegree(r.id,"both")})),r}(e,x):x.map((function(t){return b(t)})),W=Math.ceil(_/h),B=0;B<_;++B)($=T)||null===z||null===C||($=z+B*(C-z)/(_-1)),$||($=10+100*B/(_-1)),U=l+B%W*V+2*Math.PI/h*Math.floor(B/W),y||(U=g-B%W*V-2*Math.PI/h*Math.floor(B/W)),G[B].data.x=I[0]+Math.cos(U)*$,G[B].data.y=I[1]+Math.sin(U)*$;return t&&G.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:G,edges:E}]}))}))},t}(),D=function(t,e,r){void 0===r&&(r=!1);var n=[b(e[0])],o={},i=e.length;o[e[0].id]=!0;var a=0;return e.forEach((function(s,u){if(0!==u)if(u!==i-1&&t.getDegree(s.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(n[a].id,s.id)||o[s.id]){for(var d=r?t.getSuccessors(n[a].id):t.getNeighbors(n[a].id),h=!1,c=0;c<d.length;c++){var l=d[c];if(t.getDegree(l.id)===t.getDegree(s.id)&&!o[l.id]){n.push(b(l)),o[l.id]=!0,h=!0;break}}for(var f=0;!h&&(o[e[f].id]||(n.push(b(e[f])),o[e[f].id]=!0,h=!0),++f!==i););}else n.push(b(s)),o[s.id]=!0,a++})),n},O=function(t,e,r){var n=t,o=e,i=r;return n||"undefined"==typeof window||(n=window.innerWidth),o||"undefined"==typeof window||(o=window.innerHeight),i||(i=[n/2,o/2]),[n,o,i]};const P=function(t){return w(t,"String")};var T={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},z=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="concentric",this.options=n(n({},T),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericConcentricLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericConcentricLayout(!0,t,e),[2]}))}))},t.prototype.genericConcentricLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,p,v,y,m,w,E,S,k,A,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K,Y;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,d=o.sortBy,h=o.maxLevelDiff,c=o.sweep,l=o.clockwise,f=o.equidistant,p=o.preventOverlap,v=o.startAngle,y=void 0===v?1.5*Math.PI:v,m=o.nodeSize,w=o.nodeSpacing,E=e.getAllNodes(),S=e.getAllEdges(),k=s||"undefined"==typeof window?s:window.innerWidth,A=u||"undefined"==typeof window?u:window.innerHeight,I=i||[k/2,A/2],!(null==E?void 0:E.length)||1===E.length)return[2,R(e,t,I)];if(_=[],O=0,D=g(m)?Math.max(m[0],m[1]):m,g(w)?O=Math.max(w[0],w[1]):x(w)&&(O=w),E.forEach((function(t){var e=b(t);_.push(e);var r=D,n=e.data;g(n.size)?r=Math.max(n.size[0],n.size[1]):x(n.size)?r=n.size:M(n.size)&&(r=Math.max(n.size.width,n.size.height)),D=Math.max(D,r),N(w)&&(O=Math.max(w(t),O))})),T={},_.forEach((function(t,e){T[t.id]=e})),P(z=d)&&void 0!==_[0].data[z]||(z="degree"),"degree"===z?_.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):_.sort((function(t,e){return e.data[z]-t.data[z]})),C=_[0],L=(h||("degree"===z?e.getDegree(C.id,"both"):C.data[z]))/4,j=(q=[{nodes:[]}])[0],_.forEach((function(t){if(j.nodes.length>0){var r="degree"===z?Math.abs(e.getDegree(j.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(j.nodes[0].data[z]-t.data[z]);L&&r>=L&&(j={nodes:[]},q.push(j))}j.nodes.push(t)})),F=D+O,p||(V=q.length>0&&q[0].nodes.length>1,G=Math.min(k,A)/2-F,W=G/(q.length+(V?1:0)),F=Math.min(F,W)),B=0,q.forEach((function(t){var e=void 0===c?2*Math.PI-2*Math.PI/t.nodes.length:c;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&p){var r=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),o=Math.sqrt(F*F/(r*r+n*n));B=Math.max(o,B)}t.r=B,B+=F})),f){for($=0,U=0,H=0;H<q.length;H++)K=q[H],Y=(K.r||0)-U,$=Math.max($,Y);U=0,q.forEach((function(t,e){0===e&&(U=t.r||0),t.r=U,U+=$}))}return q.forEach((function(t){var e=t.dTheta||0,r=t.r||0;t.nodes.forEach((function(t,n){var o=y+(l?1:-1)*e*n;t.data.x=I[0]+r*Math.cos(o),t.data.y=I[1]+r*Math.sin(o)}))})),t&&_.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:_,edges:S}]}))}))},t}();function C(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i,a,s,u,d,h,c,l,f=t._root,g={data:n},p=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!f)return t._root=g,t;for(;f.length;)if((d=e>=(i=(p+y)/2))?p=i:y=i,(h=r>=(a=(v+m)/2))?v=a:m=a,o=f,!(f=f[c=h<<1|d]))return o[c]=g,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&r===u)return g.next=f,o?o[c]=g:t._root=g,t;do{o=o?o[c]=new Array(4):t._root=new Array(4),(d=e>=(i=(p+y)/2))?p=i:y=i,(h=r>=(a=(v+m)/2))?v=a:m=a}while((c=h<<1|d)==(l=(u>=a)<<1|s>=i));return o[l]=f,o[c]=g,t}function L(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function q(t){return t[0]}function j(t){return t[1]}function F(t,e,r){var n=new V(null==e?q:e,null==r?j:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function V(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function G(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var W=F.prototype=V.prototype;function B(t){return function(){return t}}function $(t){return 1e-6*(t()-.5)}W.copy=function(){var t,e,r=new V(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=G(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var o=0;o<4;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(4)}):n.target[o]=G(e));return r},W.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return C(this.cover(e,r),e,r,t)},W.addAll=function(t){var e,r,n,o,i=t.length,a=new Array(i),s=new Array(i),u=1/0,d=1/0,h=-1/0,c=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(a[r]=n,s[r]=o,n<u&&(u=n),n>h&&(h=n),o<d&&(d=o),o>c&&(c=o));if(u>h||d>c)return this;for(this.cover(u,d).cover(h,c),r=0;r<i;++r)C(this,a[r],s[r],t[r]);return this},W.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var a,s,u=o-r||1,d=this._root;r>t||t>=o||n>e||e>=i;)switch(s=(e<n)<<1|t<r,(a=new Array(4))[s]=d,d=a,u*=2,s){case 0:o=r+u,i=n+u;break;case 1:r=o-u,i=n+u;break;case 2:o=r+u,n=i-u;break;case 3:r=o-u,n=i-u}this._root&&this._root.length&&(this._root=d)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this},W.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},W.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},W.find=function(t,e,r){var n,o,i,a,s,u,d,h=this._x0,c=this._y0,l=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new L(p,h,c,l,f)),null==r?r=1/0:(h=t-r,c=e-r,l=t+r,f=e+r,r*=r);u=g.pop();)if(!(!(p=u.node)||(o=u.x0)>l||(i=u.y0)>f||(a=u.x1)<h||(s=u.y1)<c))if(p.length){var v=(o+a)/2,y=(i+s)/2;g.push(new L(p[3],v,y,a,s),new L(p[2],o,y,v,s),new L(p[1],v,i,a,y),new L(p[0],o,i,v,y)),(d=(e>=y)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-d],g[g.length-1-d]=u)}else{var m=t-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),x=m*m+w*w;if(x<r){var E=Math.sqrt(r=x);h=t-E,c=e-E,l=t+E,f=e+E,n=p.data}}return n},W.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,r,n,o,i,a,s,u,d,h,c,l,f=this._root,g=this._x0,p=this._y0,v=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((d=i>=(s=(g+v)/2))?g=s:v=s,(h=a>=(u=(p+y)/2))?p=u:y=u,e=f,!(f=f[c=h<<1|d]))return this;if(!f.length)break;(e[c+1&3]||e[c+2&3]||e[c+3&3])&&(r=e,l=c)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(o=f.next)&&delete f.next,n?(o?n.next=o:delete n.next,this):e?(o?e[c]=o:delete e[c],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[l]=f:this._root=f),this):(this._root=o,this)},W.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},W.root=function(){return this._root},W.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},W.visit=function(t){var e,r,n,o,i,a,s=[],u=this._root;for(u&&s.push(new L(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,n=e.x0,o=e.y0,i=e.x1,a=e.y1)&&u.length){var d=(n+i)/2,h=(o+a)/2;(r=u[3])&&s.push(new L(r,d,h,i,a)),(r=u[2])&&s.push(new L(r,n,h,d,a)),(r=u[1])&&s.push(new L(r,d,o,i,h)),(r=u[0])&&s.push(new L(r,n,o,d,h))}return this},W.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new L(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.x1,d=e.y1,h=(a+u)/2,c=(s+d)/2;(i=o[0])&&r.push(new L(i,a,s,h,c)),(i=o[1])&&r.push(new L(i,h,s,u,c)),(i=o[2])&&r.push(new L(i,a,c,h,d)),(i=o[3])&&r.push(new L(i,h,c,u,d))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},W.x=function(t){return arguments.length?(this._x=t,this):this._x},W.y=function(t){return arguments.length?(this._y=t,this):this._y};var U={value:()=>{}};function H(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new K(n)}function K(t){this._=t}function Y(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function J(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=U,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}K.prototype=H.prototype={constructor:K,on:function(t,e){var r,n,o=this._,i=(n=o,(t+"").trim().split(/^|\\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)o[r]=J(o[r],t.name,e);else if(null==e)for(r in o)o[r]=J(o[r],t.name,null);return this}for(;++a<s;)if((r=(t=i[a]).type)&&(r=Y(o[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new K(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};const X=H;var Q,Z,tt=0,et=0,rt=0,nt=1e3,ot=0,it=0,at=0,st="object"==typeof performance&&performance.now?performance:Date,ut="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function dt(){return it||(ut(ht),it=st.now()+at)}function ht(){it=0}function ct(){this._call=this._time=this._next=null}function lt(t,e,r){var n=new ct;return n.restart(t,e,r),n}function ft(){it=(ot=st.now())+at,tt=et=0;try{!function(){dt(),++tt;for(var t,e=Q;e;)(t=it-e._time)>=0&&e._call.call(void 0,t),e=e._next;--tt}()}finally{tt=0,function(){for(var t,e,r=Q,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:Q=e);Z=t,pt(n)}(),it=0}}function gt(){var t=st.now(),e=t-ot;e>nt&&(at-=e,ot=t)}function pt(t){tt||(et&&(et=clearTimeout(et)),t-it>24?(t<1/0&&(et=setTimeout(ft,t-st.now()-at)),rt&&(rt=clearInterval(rt))):(rt||(ot=st.now(),rt=setInterval(gt,nt)),tt=1,ut(ft)))}ct.prototype=lt.prototype={constructor:ct,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?dt():+r)+(null==e?0:+e),this._next||Z===this||(Z?Z._next=this:Q=this,Z=this),this._call=t,this._time=r,pt()},stop:function(){this._call&&(this._call=null,this._time=1/0,pt())}};const vt=1664525,yt=1013904223,mt=4294967296;function wt(t){return t.x}function xt(t){return t.y}var Et=10,bt=Math.PI*(3-Math.sqrt(5));function Nt(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,a=.6,s=new Map,u=lt(c),d=X("tick","end"),h=function(){let t=1;return()=>(t=(vt*t+yt)%mt)/mt}();function c(){l(),d.call("tick",e),r<n&&(u.stop(),d.call("end",e))}function l(n){var u,d,h=t.length;void 0===n&&(n=1);for(var c=0;c<n;++c)for(r+=(i-r)*o,s.forEach((function(t){t(r)})),u=0;u<h;++u)null==(d=t[u]).fx?d.x+=d.vx*=a:(d.x=d.fx,d.vx=0),null==d.fy?d.y+=d.vy*=a:(d.y=d.fy,d.vy=0);return e}function f(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var o=Et*Math.sqrt(.5+r),i=r*bt;e.x=o*Math.cos(i),e.y=o*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,h),e}return null==t&&(t=[]),f(),e={tick:l,restart:function(){return u.restart(c),e},stop:function(){return u.stop(),e},nodes:function(r){return arguments.length?(t=r,f(),s.forEach(g),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(h=t,s.forEach(g),e):h},force:function(t,r){return arguments.length>1?(null==r?s.delete(t):s.set(t,g(r)),e):s.get(t)},find:function(e,r,n){var o,i,a,s,u,d=0,h=t.length;for(null==n?n=1/0:n*=n,d=0;d<h;++d)(a=(o=e-(s=t[d]).x)*o+(i=r-s.y)*i)<n&&(u=s,n=a);return u},on:function(t,r){return arguments.length>1?(d.on(t,r),e):d.on(t)}}}function Mt(){var t,e,r,n,o,i=B(-30),a=1,s=1/0,u=.81;function d(r){var o,i=t.length,a=F(t,wt,xt).visitAfter(c);for(n=r,o=0;o<i;++o)e=t[o],a.visit(l)}function h(){if(t){var e,r,n=t.length;for(o=new Array(n),e=0;e<n;++e)r=t[e],o[r.index]=+i(r,e,t)}}function c(t){var e,r,n,i,a,s=0,u=0;if(t.length){for(n=i=a=0;a<4;++a)(e=t[a])&&(r=Math.abs(e.value))&&(s+=e.value,u+=r,n+=r*e.x,i+=r*e.y);t.x=n/u,t.y=i/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=o[e.data.index]}while(e=e.next)}t.value=s}function l(t,i,d,h){if(!t.value)return!0;var c=t.x-e.x,l=t.y-e.y,f=h-i,g=c*c+l*l;if(f*f/u<g)return g<s&&(0===c&&(g+=(c=$(r))*c),0===l&&(g+=(l=$(r))*l),g<a&&(g=Math.sqrt(a*g)),e.vx+=c*t.value*n/g,e.vy+=l*t.value*n/g),!0;if(!(t.length||g>=s)){(t.data!==e||t.next)&&(0===c&&(g+=(c=$(r))*c),0===l&&(g+=(l=$(r))*l),g<a&&(g=Math.sqrt(a*g)));do{t.data!==e&&(f=o[t.data.index]*n/g,e.vx+=c*f,e.vy+=l*f)}while(t=t.next)}}return d.initialize=function(e,n){t=e,r=n,h()},d.strength=function(t){return arguments.length?(i="function"==typeof t?t:B(+t),h(),d):i},d.distanceMin=function(t){return arguments.length?(a=t*t,d):Math.sqrt(a)},d.distanceMax=function(t){return arguments.length?(s=t*t,d):Math.sqrt(s)},d.theta=function(t){return arguments.length?(u=t*t,d):Math.sqrt(u)},d}function St(t){return t.index}function kt(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function At(t){var e,r,n,o,i,a,s=St,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},d=B(30),h=1;function c(n){for(var o=0,s=t.length;o<h;++o)for(var u,d,c,l,f,g,p,v=0;v<s;++v)d=(u=t[v]).source,l=(c=u.target).x+c.vx-d.x-d.vx||$(a),f=c.y+c.vy-d.y-d.vy||$(a),l*=g=((g=Math.sqrt(l*l+f*f))-r[v])/g*n*e[v],f*=g,c.vx-=l*(p=i[v]),c.vy-=f*p,d.vx+=l*(p=1-p),d.vy+=f*p}function l(){if(n){var a,u,d=n.length,h=t.length,c=new Map(n.map(((t,e)=>[s(t,e,n),t])));for(a=0,o=new Array(d);a<h;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=kt(c,u.source)),"object"!=typeof u.target&&(u.target=kt(c,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(a=0,i=new Array(h);a<h;++a)u=t[a],i[a]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);e=new Array(h),f(),r=new Array(h),g()}}function f(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+u(t[r],r,t)}function g(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+d(t[e],e,t)}return null==t&&(t=[]),c.initialize=function(t,e){n=t,a=e,l()},c.links=function(e){return arguments.length?(t=e,l(),c):t},c.id=function(t){return arguments.length?(s=t,c):s},c.iterations=function(t){return arguments.length?(h=+t,c):h},c.strength=function(t){return arguments.length?(u="function"==typeof t?t:B(+t),f(),c):u},c.distance=function(t){return arguments.length?(d="function"==typeof t?t:B(+t),g(),c):d},c}function Rt(t){return t.x+t.vx}function It(t){return t.y+t.vy}function _t(t){var e,r,n,o=1,i=1;function a(){for(var t,a,u,d,h,c,l,f=e.length,g=0;g<i;++g)for(a=F(e,Rt,It).visitAfter(s),t=0;t<f;++t)u=e[t],c=r[u.index],l=c*c,d=u.x+u.vx,h=u.y+u.vy,a.visit(p);function p(t,e,r,i,a){var s=t.data,f=t.r,g=c+f;if(!s)return e>d+g||i<d-g||r>h+g||a<h-g;if(s.index>u.index){var p=d-s.x-s.vx,v=h-s.y-s.vy,y=p*p+v*v;y<g*g&&(0===p&&(y+=(p=$(n))*p),0===v&&(y+=(v=$(n))*v),y=(g-(y=Math.sqrt(y)))/y*o,u.vx+=(p*=y)*(g=(f*=f)/(l+f)),u.vy+=(v*=y)*g,s.vx-=p*(g=1-g),s.vy-=v*g)}}}function s(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var n,o,i=e.length;for(r=new Array(i),n=0;n<i;++n)o=e[n],r[o.index]=+t(o,n,e)}}return"function"!=typeof t&&(t=B(null==t?1:+t)),a.initialize=function(t,r){e=t,n=r,u()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(o=+t,a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),u(),a):t},a}function Dt(t){var e,r,n,o=B(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=B(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:B(+t),a(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),a(),i):t},i}function Ot(t){var e,r,n,o=B(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=B(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:B(+t),a(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),a(),i):t},i}function Pt(){function t(t){return function(){return t}}var e,r=function(t){return t.cluster},n=t(1),o=t(-1),i=t(100),a=t(.1),u=[0,0],d=[],h={},c=[],l=100,f=100,g={none:{x:0,y:0}},p=[],v="force",y=!0,m=.1;function w(t){if(!y)return w;e.tick(),E();for(var n=0,o=d.length,i=void 0,a=t*m;n<o;++n)(i=d[n]).vx+=(g[r(i)].x-i.x)*a,i.vy+=(g[r(i)].y-i.y)*a}function x(){d&&function(){if(d&&d.length){if(void 0===r(d[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy(\'clusterAttr\') before calling .links()");var t,u,g,v,y,m=(t=[],u=[],g={},{},y=[],v=function(t){var e={};return t.forEach((function(t){var n=r(t);e[n]||(e[n]={count:0,sumforceNodeSize:0})})),t.forEach((function(t){var o=r(t),i=n(t),a=e[o];a.count=a.count+1,a.sumforceNodeSize=a.sumforceNodeSize+Math.PI*(i*i)*1.3,e[o]=a})),e}(d),y=function(t){var e={},n=[];return t.forEach((function(t){var n,o,i,a,s,u=(o=(n=t).source,i=n.target,(a=r(h[o]))<=(s=r(h[i]))?a+"~"+s:s+"~"+a),d=0;void 0!==e[u]&&(d=e[u]),d+=1,e[u]=d})),Object.entries(e).forEach((function(t){var e=s(t,2),r=e[0],o=e[1],i=r.split("~")[0],a=r.split("~")[1];void 0!==i&&void 0!==a&&n.push({source:i,target:a,count:o})})),n}(c),Object.keys(v).forEach((function(e,r){var n=v[e];t.push({id:e,size:n.count,r:Math.sqrt(n.sumforceNodeSize/Math.PI)}),g[e]=r})),y.forEach((function(t){var e=t.source,r=t.target,n=g[e],o=g[r];void 0!==n&&void 0!==o&&u.push({source:n,target:o,count:t.count})})),{nodes:t,links:u});e=Nt(m.nodes).force("x",Dt(l).strength(.1)).force("y",Ot(f).strength(.1)).force("collide",_t((function(t){return t.r})).iterations(4)).force("charge",Mt().strength(o)).force("links",At(m.nodes.length?m.links:[]).distance(i).strength(a)),p=e.nodes(),E()}}()}function E(){return g={none:{x:0,y:0}},p.forEach((function(t){g[t.id]={x:t.x-u[0],y:t.y-u[1]}})),g}return w.initialize=function(t){d=t,x()},w.template=function(t){return arguments.length?(v=t,x(),w):v},w.groupBy=function(t){return arguments.length?"string"==typeof t?(r=function(e){return e[t]},w):(r=t,w):r},w.enableGrouping=function(t){return arguments.length?(y=t,w):y},w.strength=function(t){return arguments.length?(m=t,w):m},w.centerX=function(t){return arguments.length?(l=t,w):l},w.centerY=function(t){return arguments.length?(f=t,w):f},w.nodes=function(t){return arguments.length?(function(t){h={},t.forEach((function(t){h[t.id]=t}))}(t||[]),d=t||[],w):d},w.links=function(t){return arguments.length?(c=t||[],x(),w):c},w.forceNodeSize=function(e){return arguments.length?(n="function"==typeof e?e:t(+e),x(),w):n},w.nodeSize=w.forceNodeSize,w.forceCharge=function(e){return arguments.length?(o="function"==typeof e?e:t(+e),x(),w):o},w.forceLinkDistance=function(e){return arguments.length?(i="function"==typeof e?e:t(+e),x(),w):i},w.forceLinkStrength=function(e){return arguments.length?(a="function"==typeof e?e:t(+e),x(),w):a},w.offset=function(t){return arguments.length?(u=t,w):u},w.getFocis=E,w}var Tt={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},zt=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="d3force",this.options=n(n({},Tt),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){var t;null===(t=this.forceSimulation)||void 0===t||t.stop()},t.prototype.tick=function(t){var e=this;void 0===t&&(t=1),this.forceSimulation.tick(t);var r={nodes:Ct(this.lastLayoutNodes),edges:Lt(this.lastLayoutEdges)};return this.lastAssign&&r.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,g,p,v,y,m,w,x,E,N,M,S,k,A,R,I,_,D,O=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=i.map((function(t){var e,r;return n(n({},b(t)),{x:null===(e=t.data)||void 0===e?void 0:e.x,y:null===(r=t.data)||void 0===r?void 0:r.y})})),d=s.map((function(t){return b(t)})),this.lastLayoutNodes=u,this.lastLayoutEdges=d,this.lastAssign=t,this.lastGraph=e,h=o.alphaMin,c=o.alphaDecay,l=o.alpha,f=o.nodeStrength,g=o.edgeStrength,p=o.linkDistance,v=o.clustering,y=o.clusterFociStrength,m=o.clusterEdgeDistance,w=o.clusterEdgeStrength,x=o.clusterNodeStrength,E=o.clusterNodeSize,N=o.collideStrength,M=void 0===N?1:N,S=o.center,k=void 0===S?[0,0]:S,A=o.preventOverlap,R=o.nodeSize,I=o.nodeSpacing,_=o.onTick,D=o.forceSimulation,[2,new Promise((function(r){if(D){v&&((i=Pt()).nodes(u),i.links(d)),D.nodes(u),d&&(s=At().id((function(t){return t.id})).links(d),g&&s.strength(g),p&&s.distance(p),D.force("link",s)),A&&O.overlapProcess(D,{nodeSize:R,nodeSpacing:I,collideStrength:M}),D.alpha(l).restart();var n=Ct(u),o=Lt(d);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:o})}else try{var i,a=Mt();if(f&&a.strength(f),D=Nt().nodes(u),v&&((i=Pt()).centerX(k[0]).centerY(k[1]).template("force").strength(y),d&&i.links(d),u&&i.nodes(u),i.forceLinkDistance(m).forceLinkStrength(w).forceCharge(x).forceNodeSize(E),D.force("group",i)),D.force("center",function(t,e){var r,n=1;function o(){var o,i,a=r.length,s=0,u=0;for(o=0;o<a;++o)s+=(i=r[o]).x,u+=i.y;for(s=(s/a-t)*n,u=(u/a-e)*n,o=0;o<a;++o)(i=r[o]).x-=s,i.y-=u}return null==t&&(t=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(n=+t,o):n},o}(k[0],k[1])).force("charge",a).alpha(l).alphaDecay(c).alphaMin(h),A&&O.overlapProcess(D,{nodeSize:R,nodeSpacing:I,collideStrength:M}),d){var s=At().id((function(t){return t.id})).links(d);g&&s.strength(g),p&&s.distance(p),D.force("link",s)}D.on("tick",(function(){var r=Ct(u);null==_||_({nodes:r,edges:Lt(d)}),t&&r.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}))})).on("end",(function(){var n=Ct(u);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:Lt(d)})}))}catch(t){console.warn(t)}O.forceSimulation=D}))]}))}))},t.prototype.overlapProcess=function(t,e){var r,n,o=e.nodeSize,i=e.nodeSpacing,a=e.collideStrength;if(n=x(i)?function(){return i}:N(i)?i:function(){return 0},o)if(N(o))r=function(t){return o(t)+n(t)};else if(g(o)){var s=(o[0]>o[1]?o[0]:o[1])/2;r=function(t){return s+n(t)}}else if(x(o)){var u=o/2;r=function(t){return u+n(t)}}else r=function(){return 10};else r=function(t){return t.size?g(t.size)?(t.size[0]>t.size[1]?t.size[0]:t.size[1])/2+n(t):M(t.size)?(t.size.width>t.size.height?t.size.width:t.size.height)/2+n(t):t.size/2+n(t):10+n(t)};t.force("collisionForce",_t(r).strength(a))},t}(),Ct=function(t){return t.map((function(t){var e=t.x,r=t.y,i=o(t,["x","y"]);return n(n({},i),{data:n(n({},i.data),{x:e,y:r})})}))},Lt=function(t){return t.map((function(t){var e=t.source,r=t.target,i=o(t,["source","target"]);return n(n({},i),{source:e.id,target:r.id})}))};var qt=function(t,e){if("next"!==t&&"prev"!==t)return e},jt=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(function(){function t(){var t={};t.prev=t,t.next=t.prev,this.shortcut=t}return t.prototype.dequeue=function(){var t=this.shortcut,e=t.prev;if(e&&e!==t)return jt(e),e},t.prototype.enqueue=function(t){var e=this.shortcut;t.prev&&t.next&&jt(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e},t.prototype.toString=function(){for(var t=[],e=this.shortcut,r=e.prev;r!==e;)t.push(JSON.stringify(r,qt)),r=null==r?void 0:r.prev;return"["+t.join(", ")+"]"},t}()),Vt=function(){return 1},Gt=function(t,e,r,o,i){var a,s,u=[];return t.hasNode(o.v)&&(null===(a=t.getRelatedEdges(o.v,"in"))||void 0===a||a.forEach((function(o){var a=o.data.weight,s=t.getNode(o.source);i&&u.push({v:o.source,w:o.target,in:0,out:0}),void 0===s.data.out&&(s.data.out=0),s.data.out-=a,Wt(e,r,n({v:s.id},s.data))})),null===(s=t.getRelatedEdges(o.v,"out"))||void 0===s||s.forEach((function(o){var i=o.data.weight,a=o.target,s=t.getNode(a);void 0===s.data.in&&(s.data.in=0),s.data.in-=i,Wt(e,r,n({v:s.id},s.data))})),t.removeNode(o.v)),i?u:void 0},Wt=function(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},Bt=function(t,e){var r="greedy"===e?function(t,e){var r;if(t.getAllNodes().length<=1)return[];var o=function(t,e){var r=new l,o=0,i=0;t.getAllNodes().forEach((function(t){r.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((function(t){var a=r.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target})),s=(null==e?void 0:e(t))||1;a?r.updateEdgeData(null==a?void 0:a.id,n(n({},a.data),{weight:a.data.weight+s})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:s}}),i=Math.max(i,r.getNode(t.source).data.out+=s),o=Math.max(o,r.getNode(t.target).data.in+=s)}));for(var a=[],s=i+o+3,u=0;u<s;u++)a.push(new Ft);var d=o+1;return r.getAllNodes().forEach((function(t){Wt(a,d,n({v:t.id},r.getNode(t.id).data))})),{buckets:a,zeroIdx:d,graph:r}}(t,function(t){return t.data.weight||1}||Vt);return null===(r=function(t,e,r){for(var n,o=[],i=e[e.length-1],a=e[0];t.getAllNodes().length;){for(;n=a.dequeue();)Gt(t,e,r,n);for(;n=i.dequeue();)Gt(t,e,r,n);if(t.getAllNodes().length)for(var s=e.length-2;s>0;--s)if(n=e[s].dequeue()){o=o.concat(Gt(t,e,r,n,!0));break}}return o}(o.graph,o.buckets,o.zeroIdx).map((function(e){return t.getRelatedEdges(e.v,"out").filter((function(t){return t.target===e.w}))})))||void 0===r?void 0:r.flat()}(t):$t(t);null==r||r.forEach((function(e){var r=e.data;t.removeEdge(e.id),r.forwardName=e.data.name,r.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:n({},r)})}))},$t=function(t){var e=[],r={},n={},o=function(i){n[i]||(n[i]=!0,r[i]=!0,t.getRelatedEdges(i,"out").forEach((function(t){r[t.target]?e.push(t):o(t.target)})),delete r[i])};return t.getAllNodes().forEach((function(t){return o(t.id)})),e},Ut=function(t,e,r,n){var o;do{o=""+n+Math.random()}while(t.hasNode(o));return r.dummy=e,t.addNode({id:o,data:r}),o},Ht=function(t){var e=new l;return t.getAllNodes().forEach((function(r){t.getChildren(r.id).length||e.addNode(n({},r))})),t.getAllEdges().forEach((function(t){e.addEdge(t)})),e},Kt=function(t,e){var r,n,o=Number(t.x),i=Number(t.y),a=Number(e.x)-o,s=Number(e.y)-i,u=Number(t.width)/2,d=Number(t.height)/2;return a||s?(Math.abs(s)*u>Math.abs(a)*d?(s<0&&(d=-d),r=d*a/s,n=d):(a<0&&(u=-u),r=u,n=u*s/a),{x:o+r,y:i+n}):{x:0,y:0}},Yt=function(t){for(var e=[],r=Xt(t)+1,n=0;n<r;n++)e.push([]);for(t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)})),n=0;n<r;n++)e[n]=e[n].sort((function(e,r){return n=t.getNode(e).data.order,o=t.getNode(r).data.order,Number(n)-Number(o);var n,o}));return e},Jt=function(t,e,r,n){var o={width:0,height:0};return x(r)&&x(n)&&(o.rank=r,o.order=n),Ut(t,"border",o,e)},Xt=function(t){var e;return t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)})),e||(e=0),e},Qt=function(t,e){return t.reduce((function(t,r){return e(t)>e(r)?r:t}))},Zt=function(t,e,r,n,o,i){n.includes(e.id)||(n.push(e.id),r||i.push(e.id),o(e.id).forEach((function(e){return Zt(t,e,r,n,o,i)})),r&&i.push(e.id))},te=function(t,e,r,n){var o=Array.isArray(e)?e:[e],i=function(e){return n?t.getSuccessors(e):t.getNeighbors(e)},a=[],s=[];return o.forEach((function(e){if(!t.hasNode(e.id))throw new Error("Graph does not have node: "+e);Zt(t,e,"post"===r,s,i,a)})),a},ee="edge-label",re=function(t){var e={},r=function(n){var o,i,a=t.getNode(n);return a?e[n]?a.data.rank:(e[n]=!0,null===(o=t.getRelatedEdges(n,"out"))||void 0===o||o.forEach((function(t){var e=r(t.target)-t.data.minlen;e&&(void 0===i||e<i)&&(i=e)})),i||(i=0),a.data.rank=i,i):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){return r(t.id)}))},ne=function(t,e){return t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen},oe=function(t,e){var r=function(n){e.getRelatedEdges(n,"both").forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ie=function(t,e){var r=function(n){var o;null===(o=e.getRelatedEdges(n,"both"))||void 0===o||o.forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||void 0===e.getNode(a).data.layer&&ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ae=function(t,e){return Qt(e.getAllEdges(),(function(r){return t.hasNode(r.source)!==t.hasNode(r.target)?ne(e,r):1/0}))},se=function(t,e,r){t.getAllNodes().forEach((function(t){var n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r}))},ue=function(t,e){var r=te(t,t.getAllNodes(),"post",!1);(r=r.slice(0,(null==r?void 0:r.length)-1)).forEach((function(r){de(t,e,r)}))},de=function(t,e,r){var n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find((function(t){return t.target===n||t.source===n})).data.cutvalue=he(t,e,r)},he=function(t,e,r){var n=t.getNode(r).data.parent,o=!0,i=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),a=0;return i||(o=!1,i=e.getRelatedEdges(n,"out").find((function(t){return t.target===r}))),a=i.data.weight,e.getRelatedEdges(r,"both").forEach((function(e){var i=e.source===r,s=i?e.target:e.source;if(s!==n){var u=i===o,d=e.data.weight;if(a+=u?d:-d,ye(t,r,s)){var h=t.getRelatedEdges(r,"both").find((function(t){return t.source===s||t.target===s})).data.cutvalue;a+=u?-h:h}}})),a},ce=function(t,e){void 0===e&&(e=t.getAllNodes()[0].id),le(t,{},1,e)},le=function(t,e,r,n,o){var i,a=r,s=r,u=t.getNode(n);return e[n]=!0,null===(i=t.getNeighbors(n))||void 0===i||i.forEach((function(r){e[r.id]||(s=le(t,e,s,r.id,n))})),u.data.low=a,u.data.lim=s++,o?u.data.parent=o:delete u.data.parent,s},fe=function(t){return t.getAllEdges().find((function(t){return t.data.cutvalue<0}))},ge=function(t,e,r){var n=r.source,o=r.target;e.getRelatedEdges(n,"out").find((function(t){return t.target===o}))||(n=r.target,o=r.source);var i=t.getNode(n),a=t.getNode(o),s=i,u=!1;i.data.lim>a.data.lim&&(s=a,u=!0);var d=e.getAllEdges().filter((function(e){return u===me(t.getNode(e.source),s)&&u!==me(t.getNode(e.target),s)}));return Qt(d,(function(t){return ne(e,t)}))},pe=function(t,e,r,n){var o=t.getRelatedEdges(r.source,"both").find((function(t){return t.source===r.target||t.target===r.target}));o&&t.removeEdge(o.id),t.addEdge({id:"e"+Math.random(),source:n.source,target:n.target,data:{}}),ce(t),ue(t,e),ve(t,e)},ve=function(t,e){var r=t.getAllNodes().find((function(t){return!t.data.parent})),n=te(t,r,"pre",!1);(n=n.slice(1)).forEach((function(r){var n=t.getNode(r).data.parent,o=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),i=!1;!o&&e.hasNode(n)&&(o=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),i=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(i?null==o?void 0:o.data.minlen:-(null==o?void 0:o.data.minlen))}))},ye=function(t,e,r){return t.getRelatedEdges(e,"both").find((function(t){return t.source===r||t.target===r}))},me=function(t,e){return e.data.low<=t.data.lim&&t.data.lim<=e.data.lim},we=re,xe=function(t){!function(t){var e=function(t){var e=new l;return t.getAllNodes().forEach((function(t){e.addNode(n({},t))})),t.getAllEdges().forEach((function(t){var r=e.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target}));r?e.updateEdgeData(null==r?void 0:r.id,n(n({},r.data),{weight:r.data.weight+t.data.weight||0,minlen:Math.max(r.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e}(t);re(e);var r,o,i=function(t){var e,r,n=new l({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);oe(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r);return n}(e);for(ce(i),ue(i,e);r=fe(i);)o=ge(i,e,r),pe(i,e,r,o)}(t)},Ee=function(t,e,r,n,o,i,a){var s=t.getChildren(a);if(null==s?void 0:s.length){var u=Jt(t,"_bt"),d=Jt(t,"_bb"),h=t.getNode(a);t.setParent(u,a),h.data.borderTop=u,t.setParent(d,a),h.data.borderBottom=d,null==s||s.forEach((function(s){Ee(t,e,r,n,o,i,s.id);var h=s.data.borderTop?s.data.borderTop:s.id,c=s.data.borderBottom?s.data.borderBottom:s.id,l=s.data.borderTop?n:2*n,f=h!==c?1:o-i[a]+1;t.addEdge({id:"e"+Math.random(),source:u,target:h,data:{minlen:f,weight:l,nestingEdge:!0}}),t.addEdge({id:"e"+Math.random(),source:c,target:d,data:{minlen:f,weight:l,nestingEdge:!0}})})),t.getParent(a)||t.addEdge({id:"e"+Math.random(),source:e,target:u,data:{weight:0,minlen:o+i[a]}})}else a!==e&&t.addEdge({id:"e"+Math.random(),source:e,target:a,data:{weight:0,minlen:r}})},be=function(t,e,r,n,o,i){var a={rank:i,borderType:e,width:0,height:0},s=o.data[e][i-1],u=Ut(t,"border",a,r);o.data[e][i]=u,t.setParent(u,n),s&&t.addEdge({id:"e"+Math.random(),source:s,target:u,data:{weight:1}})},Ne=function(t){t.getAllNodes().forEach((function(t){Me(t)})),t.getAllEdges().forEach((function(t){Me(t)}))},Me=function(t){var e=t.data.width;t.data.width=t.data.height,t.data.height=e},Se=function(t){(null==t?void 0:t.y)&&(t.y=-t.y)},ke=function(t){var e=t.x;t.x=t.y,t.y=e},Ae=function(t){for(var e={},r=t.getAllNodes(),n=r.map((function(t){var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),o=Math.max.apply(Math,u([],s(n))),i=[],a=0;a<o+1;a++)i.push([]);var d=r.sort((function(e,r){return t.getNode(e.id).data.rank-t.getNode(r.id).data.rank})),h=d.filter((function(e){return void 0!==t.getNode(e.id).data.fixorder})).sort((function(e,r){return t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder}));return null==h||h.forEach((function(r){isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0})),null==d||d.forEach((function(r){return t.dfsTree(r.id,(function(t){if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)}))})),i},Re=function(t,e,r){for(var n=function(t,e){return null==t?void 0:t.reduce((function(t,r,n){return t[r]=e[n],t}),{})}(r,r.map((function(t,e){return e}))),o=e.map((function(e){var r=t.getRelatedEdges(e,"out").map((function(t){return{pos:n[t.target]||0,weight:t.data.weight}}));return null==r?void 0:r.sort((function(t,e){return t.pos-e.pos}))})),i=o.flat().filter((function(t){return void 0!==t})),a=1;a<r.length;)a<<=1;var s=2*a-1;a-=1;var u=Array(s).fill(0,0,s),d=0;return null==i||i.forEach((function(t){if(t){var e=t.pos+a;u[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=u[e+1]),u[e=e-1>>1]+=t.weight;d+=t.weight*r}})),d},Ie=function(t,e){for(var r=0,n=1;n<(null==e?void 0:e.length);n+=1)r+=Re(t,e[n-1],e[n]);return r},_e=function(t,e){var r,n=0,o=0;t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/o,t.weight=o,t.i=Math.min(e.i,t.i),e.merged=!0};const De=function(t,e){var r,n,o,i={};return null==t||t.forEach((function(t,e){i[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};var r=i[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)})),null===(r=e.getAllEdges())||void 0===r||r.forEach((function(t){var e=i[t.source],r=i[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(i[t.target]))})),function(t){for(var e,r,n=[],o=function(){var o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach((function(t){return(e=o,function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&_e(e,t)})(t);var e})),null===(r=o.out)||void 0===r||r.forEach((function(e){return(r=o,function(e){e.in.push(r),0==--e.indegree&&t.push(e)})(e);var r}))};null==t?void 0:t.length;)o();var i=n.filter((function(t){return!t.merged})),a=["vs","i","barycenter","weight"];return i.map((function(t){var e={};return null==a||a.forEach((function(r){void 0!==t[r]&&(e[r]=t[r])})),e}))}(null===(o=(n=Object.values(i)).filter)||void 0===o?void 0:o.call(n,(function(t){return!t.indegree})))};var Oe=function(t,e,r){for(var n,o=r;e.length&&(n=e[e.length-1]).i<=o;)e.pop(),null==t||t.push(n.vs),o++;return o},Pe=function(t,e,r,n,o,i){var a,s,u,d,h=t.getChildren(e).map((function(t){return t.id})),c=t.getNode(e),l=c?c.data.borderLeft:void 0,f=c?c.data.borderRight:void 0,g={};l&&(h=null==h?void 0:h.filter((function(t){return t!==l&&t!==f})));var p=function(t,e){return e.map((function(e){var r=t.getRelatedEdges(e,"in");if(!(null==r?void 0:r.length))return{v:e};var n={sum:0,weight:0};return null==r||r.forEach((function(e){var r=t.getNode(e.source);n.sum+=e.data.weight*r.data.order,n.weight+=e.data.weight})),{v:e,barycenter:n.sum/n.weight,weight:n.weight}}))}(t,h||[]);null==p||p.forEach((function(e){var o;if(null===(o=t.getChildren(e.v))||void 0===o?void 0:o.length){var a=Pe(t,e.v,r,n,i);g[e.v]=a,a.hasOwnProperty("barycenter")&&ze(e,a)}}));var v=De(p,r);Te(v,g),null===(a=v.filter((function(t){return t.vs.length>0})))||void 0===a||a.forEach((function(e){var r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)}));var y=function(t,e,r,n){var o=function(t,e){var r={lhs:[],rhs:[]};return null==t||t.forEach((function(t){var e,o;o=(e=t).hasOwnProperty("fixorder")&&!isNaN(e.fixorder),(n?!o&&e.hasOwnProperty("barycenter"):o||e.hasOwnProperty("barycenter"))?r.lhs.push(t):r.rhs.push(t)})),r}(t),i=o.lhs,a=o.rhs.sort((function(t,e){return-t.i- -e.i})),s=[],u=0,d=0,h=0;null==i||i.sort(function(t,e){return function(r,n){if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i}}(!!e,!!r)),h=Oe(s,a,h),null==i||i.forEach((function(t){var e;h+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),u+=t.barycenter*t.weight,d+=t.weight,h=Oe(s,a,h)}));var c={vs:s.flat()};return d&&(c.barycenter=u/d,c.weight=d),c}(v,n,o,i);if(l&&(y.vs=[l,y.vs,f].flat(),null===(s=t.getPredecessors(l))||void 0===s?void 0:s.length)){var m=t.getNode((null===(u=t.getPredecessors(l))||void 0===u?void 0:u[0].id)||""),w=t.getNode((null===(d=t.getPredecessors(f))||void 0===d?void 0:d[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+w.data.order)/(y.weight+2),y.weight+=2}return y},Te=function(t,e){null==t||t.forEach((function(t){var r,n=null===(r=t.vs)||void 0===r?void 0:r.map((function(t){return e[t]?e[t].vs:t}));t.vs=n.flat()}))},ze=function(t,e){void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},Ce=function(t){if("object"!=typeof t||null===t)return t;var e,r;if(r=t,Array.isArray?Array.isArray(r):w(r,"Array")){e=[];for(var n=0,o=t.length;n<o;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=Ce(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=Ce(t[i]):e[i]=t[i];return e};const Le=Ce;var qe=function(t,e,r){return e.map((function(e){return function(t,e,r){var o=function(t){for(var e;t.hasNode(e="_root"+Math.random()););return e}(t),i=new l({tree:[{id:o,children:[],data:{}}]});return t.getAllNodes().forEach((function(a){var s=t.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(n({},a)),(null==s?void 0:s.id)&&!i.hasNode(null==s?void 0:s.id)&&i.addNode(n({},s)),i.setParent(a.id,(null==s?void 0:s.id)||o),t.getRelatedEdges(a.id,r).forEach((function(e){var r=e.source===a.id?e.target:e.source;i.hasNode(r)||i.addNode(n({},t.getNode(r)));var o=i.getRelatedEdges(r,"out").find((function(t){return t.target===a.id})),s=void 0!==o?o.data.weight:0;o?i.updateEdgeData(o.id,n(n({},o.data),{weight:e.data.weight+s})):i.addEdge({id:e.id,source:r,target:a.id,data:{weight:e.data.weight+s}})})),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,n(n({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))})),i}(t,e,r)}))},je=function(t,e,r,n){var o=new l;null==t||t.forEach((function(t){for(var i,a=t.getRoots()[0].id,s=Pe(t,a,o,e,r,n),u=0;u<(null===(i=s.vs)||void 0===i?void 0:i.length);u++){var d=t.getNode(s.vs[u]);d&&(d.data.order=u)}!function(t,e,r){var n,o={};null==r||r.forEach((function(r){for(var i,a,s=t.getParent(r);s;){if((i=t.getParent(s.id))?(a=o[i.id],o[i.id]=s.id):(a=n,n=s.id),a&&a!==s.id)return e.addNodes([{id:a,data:{}},{id:s.id,data:{}}]),void e.addEdge({id:"e"+a+"-"+s.id,source:a,target:s.id,data:{}});s=i}}))}(t,o,s.vs)}))},Fe=function(t,e){null==e||e.forEach((function(e){null==e||e.forEach((function(e,r){t.getNode(e).data.order=r}))}))},Ve=function(t,e){var r={};function n(e,n,o,i,a){for(var s,u,d,h=n;h<o;h++)d=e[h],(null===(s=t.getNode(d))||void 0===s?void 0:s.data.dummy)&&(null===(u=t.getPredecessors(d))||void 0===u||u.forEach((function(e){var n=t.getNode(e.id);n.data.dummy&&(n.data.order<i||n.data.order>a)&&We(r,e.id,d)})))}function o(t,e){var r=function(t){return JSON.stringify(t.slice(1))}(t);e.get(r)||(n.apply(void 0,u([],s(t))),e.set(r,!0))}return(null==e?void 0:e.length)&&e.reduce((function(e,r){var n,i=-1,a=0,s=new Map;return null==r||r.forEach((function(u,d){var h;if("border"===(null===(h=t.getNode(u))||void 0===h?void 0:h.data.dummy)){var c=t.getPredecessors(u)||[];c.length&&(n=t.getNode(c[0].id).data.order,o([r,a,d,i,n],s),a=d,i=n)}o([r,a,r.length,n,e.length],s)})),r})),r},Ge=function(t,e){var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find((function(e){return t.getNode(e.id).data.dummy}))},We=function(t,e,r){var n=e,o=r;if(n>o){var i=n;n=o,o=i}var a=t[n];a||(t[n]=a={}),a[o]=!0},Be=function(t,e,r){var n=e;return n>r&&(n=r),!!t[n]},$e=function(t,e,r,o,i,a){var s=new l,u=Ue(o,i,a);return null==e||e.forEach((function(e){var o;null==e||e.forEach((function(e){var i=r[e];if(s.hasNode(i)||s.addNode({id:i,data:{}}),o){var a=r[o],d=s.getRelatedEdges(a,"out").find((function(t){return t.target===i}));d?s.updateEdgeData(d.id,n(n({},d.data),{weight:Math.max(u(t,e,o),d.data.weight||0)})):s.addEdge({id:"e"+Math.random(),source:a,target:i,data:{weight:Math.max(u(t,e,o),0)}})}o=e}))})),s};var Ue=function(t,e,r){return function(n,o,i){var a=n.getNode(o),s=n.getNode(i),u=0,d=0;if(u+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":d=-a.data.width/2;break;case"r":d=a.data.width/2}if(d&&(u+=r?d:-d),d=0,u+=(a.data.dummy?e:t)/2,u+=(s.data.dummy?e:t)/2,u+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":d=s.data.width/2;break;case"r":d=-s.data.width/2}return d&&(u+=r?d:-d),d=0,u}},He=function(t,e){return t.getNode(e).data.width||0},Ke=function(t,e){var r,n=Ht(t);!function(t,e){var r=(e||{}).ranksep,n=void 0===r?0:r,o=Yt(t),i=0;null==o||o.forEach((function(e){var r=e.map((function(e){return t.getNode(e).data.height})),o=Math.max.apply(Math,u(u([],s(r)),[0]));null==e||e.forEach((function(e){t.getNode(e).data.y=i+o/2})),i+=o+n}))}(n,e);var o=function(t,e){var r=e||{},n=r.align,o=r.nodesep,i=void 0===o?0:o,a=r.edgesep,d=void 0===a?0:a,h=Yt(t),c=Object.assign(function(t,e){var r={};return(null==e?void 0:e.length)&&e.reduce((function(e,n){var o=0,i=0,a=e.length,s=null==n?void 0:n[(null==n?void 0:n.length)-1];return null==n||n.forEach((function(e,u){var d,h=Ge(t,e),c=h?t.getNode(h.id).data.order:a;(h||e===s)&&(null===(d=n.slice(i,u+1))||void 0===d||d.forEach((function(e){var n;null===(n=t.getPredecessors(e))||void 0===n||n.forEach((function(n){var i,a=t.getNode(n.id),s=a.data.order;!(s<o||c<s)||a.data.dummy&&(null===(i=t.getNode(e))||void 0===i?void 0:i.data.dummy)||We(r,n.id,e)}))})),i=u+1,o=c)})),n})),r}(t,h),Ve(t,h)),l={},f=[];["u","d"].forEach((function(e){f="u"===e?h:Object.values(h).reverse(),["l","r"].forEach((function(r){"r"===r&&(f=f.map((function(t){return Object.values(t).reverse()})));var n=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),o=function(t,e,r,n){var o={},i={},a={};return null==e||e.forEach((function(t){null==t||t.forEach((function(t,e){o[t]=t,i[t]=t,a[t]=e}))})),null==e||e.forEach((function(t){var e=-1;null==t||t.forEach((function(t){var s=n(t).map((function(t){return t.id}));if(s.length){s=s.sort((function(t,e){return a[t]-a[e]}));for(var u=(s.length-1)/2,d=Math.floor(u),h=Math.ceil(u);d<=h;++d){var c=s[d];i[t]===t&&e<a[c]&&!Be(r,t,c)&&(i[c]=t,i[t]=o[t]=o[c],e=a[c])}}}))})),{root:o,align:i}}(0,f,c,n),a=function(t,e,r,n,o,i,a){var s,u={},d=$e(t,e,r,o,i,a),h=a?"borderLeft":"borderRight",c=function(t,e){for(var r=d.getAllNodes(),n=r.pop(),o={};n;)o[n.id]?t(n.id):(o[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return c((function(t){u[t]=(d.getRelatedEdges(t,"in")||[]).reduce((function(t,e){return Math.max(t,(u[e.source]||0)+e.data.weight)}),0)}),d.getPredecessors.bind(d)),c((function(e){var r=(d.getRelatedEdges(e,"out")||[]).reduce((function(t,e){return Math.min(t,(u[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==h&&(u[e]=Math.max(u[e],r))}),d.getSuccessors.bind(d)),null===(s=Object.values(n))||void 0===s||s.forEach((function(t){u[t]=u[r[t]]})),u}(t,f,o.root,o.align,i,d,"r"===r);"r"===r&&Object.keys(a).forEach((function(t){return a[t]=-a[t]})),l[e+r]=a}))}));var g=function(t,e){return Qt(Object.values(e),(function(e){var r,n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach((function(r){var i=e[r],a=He(t,r)/2;n=Math.max(i+a,n),o=Math.min(i-a,o)})),n-o}))}(t,l);return g&&function(t,e){var r=Object.values(e),n=Math.min.apply(Math,u([],s(r))),o=Math.max.apply(Math,u([],s(r)));["u","d"].forEach((function(r){["l","r"].forEach((function(i){var a,d=r+i,h=t[d];if(h!==e){var c=Object.values(h);(a="l"===i?n-Math.min.apply(Math,u([],s(c))):o-Math.max.apply(Math,u([],s(c))))&&(t[d]={},Object.keys(h).forEach((function(e){t[d][e]=h[e]+a})))}}))}))}(l,g),function(t,e){var r={};return Object.keys(t.ul).forEach((function(n){if(e)r[n]=t[e.toLowerCase()][n];else{var o=Object.values(t).map((function(t){return t[n]}));r[n]=(o[0]+o[1])/2}})),r}(l,n)}(n,e);null===(r=Object.keys(o))||void 0===r||r.forEach((function(t){n.getNode(t).data.x=o[t]}))},Ye=function(t,e){var r=e.acyclicer,o=e.ranker,i=e.rankdir,a=void 0===i?"tb":i,d=e.nodeOrder,h=e.keepNodeOrder,c=e.align,f=e.nodesep,g=void 0===f?50:f,p=e.edgesep,v=void 0===p?20:p,y=e.ranksep,m=void 0===y?50:y;dr(t),Bt(t,r);var w=function(t){var e=Ut(t,"root",{},"_root"),r=function(t){var e={},r=function(n,o){var i=t.getChildren(n);null==i||i.forEach((function(t){return r(t.id,o+1)})),e[n]=o};return t.getRoots().forEach((function(t){return r(t.id,1)})),e}(t),n=Math.max.apply(Math,u([],s(Object.values(r))));Math.abs(n)===1/0&&(n=1);var o=n-1,i=2*o+1;t.getAllEdges().forEach((function(t){t.data.minlen*=i}));var a=function(t){var e=0;return t.getAllEdges().forEach((function(t){e+=t.data.weight})),e}(t)+1;return t.getRoots().forEach((function(n){Ee(t,e,i,a,o,r,n.id)})),{nestingRoot:e,nodeRankFactor:i}}(t),x=w.nestingRoot,E=w.nodeRankFactor;!function(t,e){switch(e){case"network-simplex":xe(t);break;case"tight-tree":default:!function(t){!function(t){var e,r={},n=function(o){var i,a,s=t.getNode(o);return s?r[o]?s.data.rank:(r[o]=!0,null===(i=t.getRelatedEdges(o,"out"))||void 0===i||i.forEach((function(t){var e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),(void 0===e||a<e)&&(e=a),s.data.rank=a,a):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){t&&n(t.id)})),void 0===e&&(e=0);var o={},i=function(e,r){var n,a=t.getNode(e),s=isNaN(a.data.layer)?r:a.data.layer;(void 0===a.data.rank||a.data.rank<s)&&(a.data.rank=s),o[e]||(o[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach((function(t){i(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((function(t){var r=t.data;r&&(isNaN(r.layer)?r.rank-=e:i(t.id,r.layer))}))}(t),function(t){var e,r,n=new l({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);ie(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r)}(t)}(t);break;case"longest-path":we(t)}}(Ht(t),o),er(t),function(t,e){void 0===e&&(e=0);var r=t.getAllNodes(),n=r.filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),o=Math.min.apply(Math,u([],s(n))),i=[];r.forEach((function(t){var e=(t.data.rank||0)-o;i[e]||(i[e]=[]),i[e].push(t.id)}));for(var a=0,d=0;d<i.length;d++){var h=i[d];void 0===h?d%e!=0&&(a-=1):a&&(null==h||h.forEach((function(e){var r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=a)})))}}(t,E),function(t,e){e&&t.removeNode(e),t.getAllEdges().forEach((function(e){e.data.nestingEdge&&t.removeEdge(e.id)}))}(t,x),function(t){var e=t.getAllNodes().filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),r=Math.min.apply(Math,u([],s(e)));t.getAllNodes().forEach((function(t){t.data.hasOwnProperty("rank")&&r!==1/0&&(t.data.rank-=r)}))}(t),rr(t),nr(t);var b=[];!function(t,e){t.getAllEdges().forEach((function(r){return function(t,e,r){var n=e.source,o=t.getNode(n).data.rank,i=e.target,a=t.getNode(i).data.rank,s=e.data.labelRank;if(a!==o+1){var u,d,h;for(t.removeEdge(e.id),h=0,++o;o<a;++h,++o)e.data.points=[],u=Ut(t,"edge",d={originalEdge:e,width:0,height:0,rank:o},"_d"),o===s&&(d.width=e.data.width,d.height=e.data.height,d.dummy=ee,d.labelpos=e.data.labelpos),t.addEdge({id:"e"+Math.random(),source:n,target:u,data:{weight:e.data.weight}}),0===h&&r.push(u),n=u;t.addEdge({id:"e"+Math.random(),source:n,target:i,data:{weight:e.data.weight}})}}(t,r,e)}))}(t,b),function(t,e){var r=function(t){var e={},r=0,n=function(o){var i=r;t.getChildren(o).forEach((function(t){return n(t.id)})),e[o]={low:i,lim:r++}};return t.getRoots().forEach((function(t){return n(t.id)})),e}(t);e.forEach((function(e){var n,o,i=e,a=t.getNode(i),s=a.data.originalEdge;if(s)for(var u=function(t,e,r,n){var o,i,a,s,u=[],d=[],h=Math.min(e[r].low,e[n].low),c=Math.max(e[r].lim,e[n].lim);a=r;do{a=null===(o=t.getParent(a))||void 0===o?void 0:o.id,u.push(a)}while(a&&(e[a].low>h||c>e[a].lim));for(s=a,a=n;a&&a!==s;)d.push(a),a=null===(i=t.getParent(a))||void 0===i?void 0:i.id;return{lca:s,path:u.concat(d.reverse())}}(t,r,s.source,s.target),d=u.path,h=u.lca,c=0,l=d[c],f=!0;i!==s.target;){if(a=t.getNode(i),f){for(;l!==h&&(null===(n=t.getNode(l))||void 0===n?void 0:n.data.maxRank)<a.data.rank;)l=d[++c];l===h&&(f=!1)}if(!f){for(;c<d.length-1&&(null===(o=t.getNode(d[c+1]))||void 0===o?void 0:o.data.minRank)<=a.data.rank;)c++;l=d[c]}t.hasNode(l)&&t.setParent(i,l),i=t.getSuccessors(i)[0].id}}))}(t,b),function(t){var e=function(r){var n=t.getChildren(r),o=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach((function(t){return e(t.id)})),o.data.hasOwnProperty("minRank")){o.data.borderLeft=[],o.data.borderRight=[];for(var i=o.data.minRank,a=o.data.maxRank+1;i<a;i+=1)be(t,"borderLeft","_bl",r,o,i),be(t,"borderRight","_br",r,o,i)}};t.getRoots().forEach((function(t){return e(t.id)}))}(t),h&&function(t,e){for(var r=t.getAllNodes().filter((function(e){var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)})).map((function(t){return t.data.rank})),n=Math.max.apply(Math,u([],s(r))),o=[],i=0;i<n+1;i++)o[i]=[];null==e||e.forEach((function(e){var r=t.getNode(e);r&&!r.data.dummy&&(isNaN(r.data.rank)||(r.data.fixorder=o[r.data.rank].length,o[r.data.rank].push(e)))}))}(t,d),function(t,e){for(var r=Xt(t),n=[],o=[],i=1;i<r+1;i++)n.push(i);for(i=r-1;i>-1;i--)o.push(i);var a=qe(t,n,"in"),s=qe(t,o,"out"),u=Ae(t);Fe(t,u);for(var d,h=Number.POSITIVE_INFINITY,c=(i=0,0);c<4;++i,++c)je(i%2?a:s,i%4>=2,!1,e),u=Yt(t),(l=Ie(t,u))<h&&(c=0,d=Le(u),h=l);for(u=Ae(t),Fe(t,u),i=0,c=0;c<4;++i,++c){var l;je(i%2?a:s,i%4>=2,!0,e),u=Yt(t),(l=Ie(t,u))<h&&(c=0,d=Le(u),h=l)}Fe(t,d)}(t,h),hr(t),function(t,e){var r=e.toLowerCase();"lr"!==r&&"rl"!==r||Ne(t)}(t,a),Ke(t,{align:c,nodesep:g,edgesep:v,ranksep:m}),cr(t),ur(t),function(t,e){e.forEach((function(e){var r,n=t.getNode(e),o=n.data.originalEdge;o&&t.addEdge(o);for(var i=e;n.data.dummy;)r=t.getSuccessors(i)[0],t.removeNode(i),o.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===ee&&(o.data.x=n.data.x,o.data.y=n.data.y,o.data.width=n.data.width,o.data.height=n.data.height),i=r.id,n=t.getNode(i)}))}(t,b),ar(t),function(t,e){var r=e.toLowerCase();"bt"!==r&&"rl"!==r||function(t){t.getAllNodes().forEach((function(t){Se(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return Se(t)})),t.data.hasOwnProperty("y")&&Se(t.data)}))}(t),"lr"!==r&&"rl"!==r||(function(t){t.getAllNodes().forEach((function(t){ke(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return ke(t)})),t.data.hasOwnProperty("x")&&ke(t.data)}))}(t),Ne(t))}(t,a);var N=or(t),M=N.width,S=N.height;return ir(t),sr(t),function(t){t.getAllEdges().forEach((function(e){var r=e.data;if(r.reversed){t.removeEdge(e.id);var o=r.forwardName;delete r.reversed,delete r.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:n(n({},r),{forwardName:o})})}}))}(t),{width:M,height:S}},Je=["width","height","layer","fixorder"],Xe={width:0,height:0},Qe=["minlen","weight","width","height","labeloffset"],Ze={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},tr=["labelpos"],er=function(t){t.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var r=t.getNode(e.source),n={e,rank:(t.getNode(e.target).data.rank-r.data.rank)/2+r.data.rank};Ut(t,"edge-proxy",n,"_ep")}}))},rr=function(t){var e=0;return t.getAllNodes().forEach((function(r){var n,o;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(o=t.getNode(r.data.borderBottom))||void 0===o?void 0:o.data.rank,e=Math.max(e,r.data.maxRank||-1/0))})),e},nr=function(t){t.getAllNodes().forEach((function(e){"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},or=function(t,e){var r,n,o=0,i=0,a=e||{},s=a.marginx,u=void 0===s?0:s,d=a.marginy,h=void 0===d?0:d,c=function(t){if(t.data){var e=t.data.x,a=t.data.y,s=t.data.width,u=t.data.height;isNaN(e)||isNaN(s)||(void 0===r&&(r=e-s/2),r=Math.min(r,e-s/2),o=Math.max(o,e+s/2)),isNaN(a)||isNaN(u)||(void 0===n&&(n=a-u/2),n=Math.min(n,a-u/2),i=Math.max(i,a+u/2))}};return t.getAllNodes().forEach((function(t){c(t)})),t.getAllEdges().forEach((function(t){(null==t?void 0:t.data.hasOwnProperty("x"))&&c(t)})),r-=u,n-=h,t.getAllNodes().forEach((function(t){t.data.x-=r,t.data.y-=n})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){t.x-=r,t.y-=n})),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)})),{width:o-r+u,height:i-n+h}},ir=function(t){t.getAllEdges().forEach((function(e){var r,n,o=t.getNode(e.source),i=t.getNode(e.target);e.data.points?(r=e.data.points[0],n=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:i.data.x,y:i.data.y},n={x:o.data.x,y:o.data.y}),e.data.points.unshift(Kt(o.data,r)),e.data.points.push(Kt(i.data,n))}))},ar=function(t){t.getAllEdges().forEach((function(t){if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},sr=function(t){t.getAllEdges().forEach((function(t){var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},ur=function(t){t.getAllNodes().forEach((function(e){var r,n,o;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){var i=t.getNode(e.id),a=t.getNode(i.data.borderTop),s=t.getNode(i.data.borderBottom),u=t.getNode(i.data.borderLeft[(null===(n=i.data.borderLeft)||void 0===n?void 0:n.length)-1]),d=t.getNode(i.data.borderRight[(null===(o=i.data.borderRight)||void 0===o?void 0:o.length)-1]);i.data.width=Math.abs((null==d?void 0:d.data.x)-(null==u?void 0:u.data.x))||10,i.data.height=Math.abs((null==s?void 0:s.data.y)-(null==a?void 0:a.data.y))||10,i.data.x=((null==u?void 0:u.data.x)||0)+i.data.width/2,i.data.y=((null==a?void 0:a.data.y)||0)+i.data.height/2}})),t.getAllNodes().forEach((function(e){"border"===e.data.dummy&&t.removeNode(e.id)}))},dr=function(t){t.getAllEdges().forEach((function(e){if(e.source===e.target){var r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}}))},hr=function(t){var e=Yt(t);null==e||e.forEach((function(e){var r=0;null==e||e.forEach((function(e,n){var o,i=t.getNode(e);i.data.order=n+r,null===(o=i.data.selfEdges)||void 0===o||o.forEach((function(e){Ut(t,"selfedge",{width:e.data.width,height:e.data.height,rank:i.data.rank,order:n+ ++r,e},"_se")})),delete i.data.selfEdges}))}))},cr=function(t){t.getAllNodes().forEach((function(e){var r=t.getNode(e.id);if("selfedge"===r.data.dummy){var n=t.getNode(r.data.e.source),o=n.data.x+n.data.width/2,i=n.data.y,a=r.data.x-o,s=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}}))},lr=function(t,e){var r={};return null==e||e.forEach((function(e){void 0!==t[e]&&(r[e]=+t[e])})),r},fr=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(r){e[r.toLowerCase()]=t[r]})),e},gr={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="dagre",this.layoutNode=function(t){return t.data.layout},this.options=n(n({},gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericDagreLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericDagreLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericDagreLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,E,N,M,k,R,I,_,D,O,P,T,z,C,L,q,j,F,V,G,W=this;return a(this,(function(a){return o=n(n({},this.options),r),i=o.nodeSize,s=o.align,u=o.rankdir,d=void 0===u?"TB":u,h=o.ranksep,c=o.nodesep,f=o.ranksepFunc,g=o.nodesepFunc,p=o.edgeLabelSpace,v=o.nodeOrder,y=o.begin,m=o.controlPoints,w=o.radial,E=new l({tree:[]}),N=S(h||50,f),M=S(c||50,g),k=M,R=N,"LR"!==d&&"RL"!==d||(k=N,R=M),I=A(i,void 0),_=e.getAllNodes(),D=e.getAllEdges(),_.filter((function(t){return t.data.layout})).forEach((function(t){var e=I(t),r=R(t),n=e+2*k(t),o=e+2*r,i=t.data.layer;x(i)?E.addNode({id:t.id,data:{width:n,height:o,layer:i}}):E.addNode({id:t.id,data:{width:n,height:o}})})),D.forEach((function(t){W.layoutNode(E.getNode(t.source))&&W.layoutNode(E.getNode(t.target))&&E.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),function(t,e){var r,o,i=e.edgeLabelSpace,a=e.keepNodeOrder,s=e.prevGraph,u=e.rankdir,d=e.ranksep;!a&&s&&(o=s,(r=t).getAllNodes().forEach((function(t){var e=r.getNode(t.id),n=o.getNode(t.id);void 0!==n?(e.data.fixorder=n.data._order,delete n.data._order):delete e.data.fixorder})));var h=function(t){var e=new l({tree:[]});return t.getAllNodes().forEach((function(r){var o=fr(t.getNode(r.id).data),i=n(n({},Xe),o),a=lr(i,Je);e.hasNode(r.id)||e.addNode({id:r.id,data:n({},a)});var s=t.getParent(r.id);null==s||(e.hasNode(s.id)||e.addNode(n({},s)),e.setParent(r.id,s.id))})),t.getAllEdges().forEach((function(r){var n=fr(t.getEdge(r.id).data),o={};null==tr||tr.forEach((function(t){void 0!==n[t]&&(o[t]=n[t])})),e.addEdge({id:r.id,source:r.source,target:r.target,data:Object.assign({},Ze,lr(n,Qe),o)})})),e}(t);i&&(e.ranksep=function(t,e){var r=e.ranksep,n=void 0===r?0:r,o=e.rankdir;return t.getAllNodes().forEach((function(t){isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((function(t){var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===o||"BT"===o?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2}(h,{rankdir:u,ranksep:d}));try{Ye(h,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph\'s structure:\\n",t);throw t}!function(t,e){t.getAllNodes().forEach((function(r){var n,o=t.getNode(r.id);if(o){var i=e.getNode(r.id);o.data.x=i.data.x,o.data.y=i.data.y,o.data._order=i.data.order,o.data._rank=i.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(o.data.width=i.data.width,o.data.height=i.data.height)}})),t.getAllEdges().forEach((function(r){var n=t.getEdge(r.id),o=e.getEdge(r.id);n.data.points=o?o.data.points:[],o&&o.data.hasOwnProperty("x")&&(n.data.x=o.data.x,n.data.y=o.data.y)}))}(t,h)}(E,{prevGraph:null,edgeLabelSpace:p,keepNodeOrder:!!v,nodeOrder:v||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:d,nodesep:c,align:s}),O=[0,0],y&&(P=1/0,T=1/0,E.getAllNodes().forEach((function(t){P>t.data.x&&(P=t.data.x),T>t.data.y&&(T=t.data.y)})),E.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){P>t.x&&(P=t.x),T>t.y&&(T=t.y)}))})),O[0]=y[0]-P,O[1]=y[1]-T),z="LR"===d||"RL"===d,w||(C=new Set,L="BT"===d||"RL"===d?function(t,e){return e-t}:function(t,e){return t-e},E.getAllNodes().forEach((function(t){t.data.x=t.data.x+O[0],t.data.y=t.data.y+O[1],C.add(z?t.data.x:t.data.y)})),q=Array.from(C).sort(L),j=z?function(t,e){return t.x!==e.x}:function(t,e){return t.y!==e.y},F=z?function(t,e,r){var n=Math.max(e.y,r.y),o=Math.min(e.y,r.y);return t.filter((function(t){return t.y<=n&&t.y>=o}))}:function(t,e,r){var n=Math.max(e.x,r.x),o=Math.min(e.x,r.x);return t.filter((function(t){return t.x<=n&&t.x>=o}))},E.getAllEdges().forEach((function(t,e){var r;p&&m&&"loop"!==t.data.type&&(t.data.controlPoints=vr(null===(r=t.data.points)||void 0===r?void 0:r.map((function(t){var e=t.x,r=t.y;return{x:e+O[0],y:r+O[1]}})),E.getNode(t.source),E.getNode(t.target),q,z,j,F))}))),V=[],V=E.getAllNodes().map((function(t){return b(t)})),G=E.getAllEdges(),t&&(V.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),G.forEach((function(t){e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),[2,{nodes:V,edges:G}]}))}))},t}(),vr=function(t,e,r,n,o,i,a){var s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){var u=e.data,d=u.x,h=u.y,c=r.data,l=c.x,f=c.y;if(o&&(d=e.data.y,h=e.data.x,l=r.data.y,f=r.data.x),f!==h&&d!==l){var g=n.indexOf(h),p=n[g+1];if(p){var v=s[0],y=o?{x:(h+p)/2,y:(null==v?void 0:v.y)||l}:{x:(null==v?void 0:v.x)||l,y:(h+p)/2};v&&!i(v,y)||s.unshift(y)}var m=n.indexOf(f),w=Math.abs(m-g);if(1===w)(s=a(s,e.data,r.data)).length||s.push(o?{x:(h+f)/2,y:d}:{x:d,y:(h+f)/2});else if(w>1){var x=n[m-1];if(x){var E=s[s.length-1],b=o?{x:(f+x)/2,y:(null==E?void 0:E.y)||l}:{x:(null==E?void 0:E.x)||d,y:(f+x)/2};E&&!i(E,b)||s.push(b)}}}}return s};function yr(t){var e=0,r=0,n=0;if(t.length){for(var o=0;o<4;o++)(i=t[o])&&i.weight&&(e+=i.weight,r+=i.x*i.weight,n+=i.y*i.weight);t.x=r/e,t.y=n/e,t.weight=e}else{var i=t;t.x=i.data.x,t.y=i.data.y,t.weight=i.data.weight}}var mr=function(t,e,r,n,o,i){var a=i.x-t.x||.1,s=i.y-t.y||.1,u=n-e,d=a*a+s*s,h=Math.sqrt(d)*d;if(u*u*.81<d){var c=t.weight/h;return i.vx+=a*c,i.vy+=s*c,!0}if(t.length)return!1;t.data!==i&&(c=t.data.weight/h,i.vx+=a*c,i.vy+=s*c)},wr={maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},xr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=n(n({},wr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,E,b,N,M,S,k=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=this.formatOptions(o,e),d=u.width,h=u.height,c=u.nodeSize,f=u.getMass,g=u.nodeStrength,p=u.edgeStrength,v=u.linkDistance,y=i.map((function(t){return n(n({},t),{data:n(n({},t.data),{x:x(t.data.x)?t.data.x:Math.random()*d,y:x(t.data.y)?t.data.y:Math.random()*h,size:c(t)||30,mass:f(t),nodeStrength:g(t)})})})),m=s.map((function(t){return n(n({},t),{data:n(n({},t.data),{edgeStrength:p(t),linkDistance:v(t,e.getNode(t.source),e.getNode(t.target))})})})),(null==i?void 0:i.length)?(w={},i.forEach((function(t,e){w[t.id]={x:0,y:0}})),E=new l({nodes:y,edges:m}),this.formatCentripetal(u,E),b=u.maxIteration,N=u.minMovement,M=u.onTick,this.lastLayoutNodes=y,this.lastLayoutEdges=m,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=E,this.lastOptions=u,this.lastVelMap=w,"undefined"==typeof window?[2]:(S=0,[2,new Promise((function(r){k.timeInterval=window.setInterval((function(){i&&k.running||r({nodes:Sr(e,y),edges:s}),k.runOneStep(E,e,S,w,u),k.updatePosition(e,E,w,u),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),null==M||M({nodes:Sr(e,y),edges:s}),(++S>=b||k.judgingDistance<N)&&(window.clearInterval(k.timeInterval),r({nodes:Sr(e,y),edges:s}))}),0),k.running=!0}))])):(this.lastResult={nodes:[],edges:s},[2,{nodes:[],edges:s}])}))}))},t.prototype.formatOptions=function(t,e){var r=t,n=t.width,o=t.height,i=t.getMass;if(r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=o||"undefined"==typeof window?o:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),i||(r.getMass=function(t){var r=1;x(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);var n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),t.preventOverlap){var a=S(0,t.nodeSpacing);t.nodeSize?g(t.nodeSize)?r.nodeSize=function(e){var r=t.nodeSize;return Math.max(r[0],r[1])+a(e)}:r.nodeSize=function(e){return t.nodeSize+a(e)}:r.nodeSize=function(t){var e=((null==t?void 0:t.data)||{}).size;return e?g(e)?Math.max(e[0],e[1])+a(t):M(e)?Math.max(e.width,e.height)+a(t):e+a(t):10+a(t)}}return r.linkDistance=t.linkDistance?S(1,t.linkDistance):function(t){return 1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target))},r.nodeStrength=S(1,t.nodeStrength),r.edgeStrength=S(1,t.edgeStrength),t},t.prototype.formatCentripetal=function(t,e){var r,n=t.centripetalOptions,o=t.center,i=t.clusterNodeStrength,a=t.leafCluster,s=t.clustering,u=t.nodeClusterBy,d=e.getAllNodes(),h=n||{leaf:2,single:2,others:1,center:function(t){return{x:o[0],y:o[1]}}};"function"!=typeof i&&(t.clusterNodeStrength=function(t){return i});var c=[];if(a&&u&&(r=Er(e,u),c=Array.from(new Set(null==d?void 0:d.map((function(t){return t.data[u]}))))||[],t.centripetalOptions=Object.assign(h,{single:100,leaf:function(e){var n=r[e.id]||{},o=n.siblingLeaves,i=n.sameTypeLeaves;return(null==i?void 0:i.length)===(null==o?void 0:o.length)||1===(null==c?void 0:c.length)?1:t.clusterNodeStrength(e)},others:1,center:function(t){var n,o=e.getDegree(t.id,"both");if(!o)return{x:100,y:100};if(1===o){var i=(r[t.id]||{}).sameTypeLeaves,a=void 0===i?[]:i;1===a.length?n=void 0:a.length>1&&(n=Mr(a))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y}}})),s&&u){r||(r=Er(e,u)),c||(c=Array.from(new Set(d.map((function(t){return t.data[u]}))))),c=c.filter((function(t){return void 0!==t}));var l={};c.forEach((function(t){var r=d.filter((function(e){return e.data[u]===t})).map((function(t){return e.getNode(t.id)}));l[t]=Mr(r)})),t.centripetalOptions=Object.assign(h,{single:function(e){return t.clusterNodeStrength(e)},leaf:function(e){return t.clusterNodeStrength(e)},others:function(e){return t.clusterNodeStrength(e)},center:function(t){var e=l[t.data[u]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y}}})}var f=t.centripetalOptions||{},g=f.leaf,p=f.single,v=f.others;g&&"function"!=typeof g&&(t.centripetalOptions.leaf=function(){return g}),p&&"function"!=typeof p&&(t.centripetalOptions.single=function(){return p}),v&&"function"!=typeof v&&(t.centripetalOptions.others=function(){return v})},t.prototype.runOneStep=function(t,e,r,n,o){var i={},a=t.getAllNodes(),s=t.getAllEdges();if(null==a?void 0:a.length){var u=o.monitor;this.calRepulsive(t,i,o),s&&this.calAttractive(t,i),this.calGravity(t,e,i,o),this.updateVelocity(t,i,n,o),u&&u({energy:this.calTotalEnergy(i,a),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}},t.prototype.calTotalEnergy=function(t,e){if(!(null==e?void 0:e.length))return 0;var r=0;return e.forEach((function(e,n){var o=t[e.id].x,i=t[e.id].y,a=o*o+i*i,s=e.data.mass;r+=(void 0===s?1:s)*a*.5})),r},t.prototype.calRepulsive=function(t,e,r){var n=r.factor,o=r.coulombDisScale;!function(t,e,r,n){var o=e/r,i=t.getAllNodes(),a=i.map((function(t,e){var r=t.data,n=r.nodeStrength;return{x:r.x,y:r.y,size:r.size,index:e,vx:0,vy:0,weight:o*n}})),s=F(a,(function(t){return t.x}),(function(t){return t.y})).visitAfter(yr);a.forEach((function(t){!function(t,e){e.visit((function(e,r,n,o,i){return mr(e,r,n,o,i,t)}))}(t,s)})),a.map((function(t,e){var r=i[e],o=r.id,a=r.data.mass,s=void 0===a?1:a;n[o]={x:t.vx/s,y:t.vy/s}}))}(t,n,o*o,e)},t.prototype.calAttractive=function(t,e){t.getAllEdges().forEach((function(r,n){var o=r.source,i=r.target,a=t.getNode(o),s=t.getNode(i);if(a&&s){var u=s.data.x-a.data.x,d=s.data.y-a.data.y;u||d||(u=.01*Math.random(),d=.01*Math.random());var h=Math.sqrt(u*u+d*d),c=u/h,l=d/h,f=r.data||{},g=f.linkDistance,p=void 0===g?200:g,v=f.edgeStrength,y=(p-h)*(void 0===v?200:v),m=1/(a.data.mass||1),w=1/(s.data.mass||1),x=c*y,E=l*y;e[o].x-=x*m,e[o].y-=E*m,e[i].x+=x*w,e[i].y+=E*w}}))},t.prototype.calGravity=function(t,e,r,n){var o=n.getCenter,i=t.getAllNodes(),a=e.getAllNodes(),u=e.getAllEdges(),d=n.width,h=n.height,c=n.center,l=n.gravity,f=n.centripetalOptions;i&&i.forEach((function(n){var i=n.id,g=n.data,p=g.mass,v=g.x,y=g.y,m=e.getNode(i),w=0,E=0,b=l,N=t.getDegree(i,"in"),M=t.getDegree(i,"out"),S=t.getDegree(i,"both"),k=null==o?void 0:o(m,S);if(k){var A=s(k,3);w=v-A[0],E=y-A[1],b=A[2]}else w=v-c[0],E=y-c[1];if(b&&(r[i].x-=b*w/p,r[i].y-=b*E/p),f){var R=f.leaf,I=f.single,_=f.others,D=f.center,O=(null==D?void 0:D(m,a,u,d,h))||{x:0,y:0,centerStrength:0},P=O.x,T=O.y,z=O.centerStrength;if(!x(P)||!x(T))return;var C=(v-P)/p,L=(y-T)/p;if(z&&(r[i].x-=z*C,r[i].y-=z*L),0===S){var q=I(m);if(!q)return;return r[i].x-=q*C,void(r[i].y-=q*L)}if(0===N||0===M){var j=R(m,a,u);if(!j)return;return r[i].x-=j*C,void(r[i].y-=j*L)}var F=_(m);if(!F)return;r[i].x-=F*C,r[i].y-=F*L}}))},t.prototype.updateVelocity=function(t,e,r,n){var o=n.damping,i=n.maxSpeed,a=n.interval,s=t.getAllNodes();(null==s?void 0:s.length)&&s.forEach((function(t){var n=t.id,s=(r[n].x+e[n].x*a)*o||.01,u=(r[n].y+e[n].y*a)*o||.01,d=Math.sqrt(s*s+u*u);if(d>i){var h=i/d;s*=h,u*=h}r[n]={x:s,y:u}}))},t.prototype.updatePosition=function(t,e,r,n){var o=this,i=n.distanceThresholdMode,a=n.interval,s=e.getAllNodes();if(null==s?void 0:s.length){var u=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),s.forEach((function(n){var s=n.id,d=t.getNode(s);if(x(d.data.fx)&&x(d.data.fy))e.mergeNodeData(s,{x:d.data.fx,y:d.data.fy});else{var h=r[s].x*a,c=r[s].y*a;e.mergeNodeData(s,{x:n.data.x+h,y:n.data.y+c});var l=Math.sqrt(h*h+c*c);switch(i){case"max":o.judgingDistance<l&&(o.judgingDistance=l);break;case"min":o.judgingDistance>l&&(o.judgingDistance=l);break;default:u+=l}}})),i&&"mean"!==i||(this.judgingDistance=u/s.length)}else this.judgingDistance=0},t}(),Er=function(t,e){var r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};var n={};return r.forEach((function(r,o){1===t.getDegree(r.id,"both")&&(n[r.id]=br(t,"leaf",r,e))})),n},br=function(t,e,r,n){var o=t.getDegree(r.id,"in"),i=t.getDegree(r.id,"out"),a=r,s=[];return 0===o?(a=t.getSuccessors(r.id)[0],s=t.getNeighbors(a.id)):0===i&&(a=t.getPredecessors(r.id)[0],s=t.getNeighbors(a.id)),s=s.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")})),{coreNode:a,siblingLeaves:s,sameTypeLeaves:Nr(t,e,n,r,s)}},Nr=function(t,e,r,n,o){var i=n.data[r]||"",a=(null==o?void 0:o.filter((function(t){return t.data[r]===i})))||[];return"leaf"===e&&(a=a.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")}))),a},Mr=function(t){var e={x:0,y:0};t.forEach((function(t){var r=t.data,n=r.x,o=r.y;e.x+=n||0,e.y+=o||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},Sr=function(t,e){return e.map((function(e){var r=e.id,o=e.data,i=t.getNode(r);return n(n({},i),{data:n(n({},i.data),{x:o.x,y:o.y})})}))},kr=function(){function t(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}return t.prototype.distanceTo=function(t){var e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)},t.prototype.setPos=function(t,e){this.rx=t,this.ry=e},t.prototype.resetForce=function(){this.fx=0,this.fy=0},t.prototype.addForce=function(t){var e=t.rx-this.rx,r=t.ry-this.ry,n=Math.hypot(e,r);n=n<1e-4?1e-4:n;var o=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=o*e/n,this.fy+=o*r/n},t.prototype.in=function(t){return t.contains(this.rx,this.ry)},t.prototype.add=function(e){var r=this.mass+e.mass;return new t({rx:(this.rx*this.mass+e.rx*e.mass)/r,ry:(this.ry*this.mass+e.ry*e.mass)/r,mass:r,degree:this.degree+e.degree})},t}();const Ar=kr;const Rr=function(){function t(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}return t.prototype.getLength=function(){return this.length},t.prototype.contains=function(t,e){var r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r},t.prototype.NW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.NE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.SW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t.prototype.SE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t}(),Ir=function(){function t(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}return t.prototype.insert=function(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e},t.prototype._putBody=function(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))},t.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},t.prototype.updateForce=function(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))},t}();var _r={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Dr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2",this.options=n(n({},_r),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,x,E,N,M,S,k,A,I;return a(this,(function(a){if(o=e.getAllEdges(),i=e.getAllNodes(),s=this.formatOptions(r,i.length),u=s.width,d=s.height,h=s.prune,c=s.maxIteration,f=s.nodeSize,g=s.center,!(null==i?void 0:i.length)||1===i.length)return[2,R(e,t,g)];if(p=i.map((function(t){return b(t,[u,d])})),v=o.filter((function(t){return t.source!==t.target})),y=new l({nodes:p,edges:v}),m=this.getSizes(y,e,f),this.run(y,e,c,m,t,s),h){for(w=0;w<v.length;w+=1)x=v[w],E=x.source,N=x.target,M=y.getDegree(E),S=y.getDegree(E),M<=1?(k=y.getNode(N),y.mergeNodeData(E,{x:k.data.x,y:k.data.y})):S<=1&&(A=y.getNode(E),y.mergeNodeData(N,{x:A.data.x,y:A.data.y}));I=n(n({},s),{prune:!1,barnesHut:!1}),this.run(y,e,100,m,t,I)}return[2,{nodes:p,edges:o}]}))}))},t.prototype.getSizes=function(t,e,r){for(var n=t.getAllNodes(),o={},i=0;i<n.length;i+=1){var a=n[i],d=a.id,h=a.data;if(o[d]=10,x(h.size))o[d]=h.size;else if(g(h.size))isNaN(h.size[0])||(o[d]=Math.max(h.size[0])),isNaN(h.size[1])||(o[d]=Math.max(h.size[1]));else if(M(h.size))o[d]=Math.max(h.size.width,h.size.height);else if(N(r)){var c=r(e.getNode(d));g(c)?o[d]=Math.max.apply(Math,u([],s(c))):o[d]=c}else g(r)?o[d]=Math.max.apply(Math,u([],s(r))):x(r)&&(o[d]=r)}return o},t.prototype.formatOptions=function(t,e){void 0===t&&(t={});var r=n(n({},this.options),t),o=r.center,i=r.width,a=r.height,s=r.barnesHut,u=r.prune,d=r.maxIteration,h=r.kr,c=r.kg;return r.width=i||"undefined"==typeof window?i:window.innerWidth,r.height=a||"undefined"==typeof window?a:window.innerHeight,r.center=o||[r.width/2,r.height/2],void 0===s&&e>250&&(r.barnesHut=!0),void 0===u&&e>100&&(r.prune=!0),0!==d||u?0===d&&u&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)):(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)),h||(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),c||(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r},t.prototype.run=function(t,e,r,n,o,i){for(var a=i.kr,s=i.barnesHut,u=i.onTick,d=t.getAllNodes(),h=0,c=r,l={},f={},g={},p=0;p<d.length;p+=1){var v=d[p],y=v.data,m=v.id;if(l[m]=[0,0],s){var w={id:p,rx:y.x,ry:y.y,mass:1,g:a,degree:t.getDegree(m)};g[m]=new Ar(w)}}for(;c>0;)h=this.oneStep(t,{iter:c,preventOverlapIters:50,krPrime:100,sg:h,forces:l,preForces:f,bodies:g,sizes:n},i),c--,null==u||u({nodes:d,edges:e.getAllEdges()});return t},t.prototype.oneStep=function(t,e,r){for(var n=e.iter,o=e.preventOverlapIters,i=e.krPrime,a=e.sg,d=e.preForces,h=e.bodies,c=e.sizes,l=e.forces,f=r.preventOverlap,g=r.barnesHut,p=t.getAllNodes(),v=0;v<p.length;v+=1){var y=p[v].id;d[y]=u([],s(l[y])),l[y]=[0,0]}return l=this.getAttrForces(t,n,o,c,l,r),l=g&&(f&&n>o||!f)?this.getOptRepGraForces(t,l,h,r):this.getRepGraForces(t,n,o,l,i,c,r),this.updatePos(t,l,d,a,r)},t.prototype.getAttrForces=function(t,e,r,n,o,i){for(var a=i.preventOverlap,s=i.dissuadeHubs,u=i.mode,d=i.prune,h=t.getAllEdges(),c=0;c<h.length;c+=1){var l=h[c],f=l.source,g=l.target,p=t.getNode(f),v=t.getNode(g),y=t.getDegree(f),m=t.getDegree(g);if(!d||!(y<=1||m<=1)){var w=[v.data.x-p.data.x,v.data.y-p.data.y],x=Math.hypot(w[0],w[1]);x=x<1e-4?1e-4:x,w[0]=w[0]/x,w[1]=w[1]/x,a&&e<r&&(x=x-n[f]-n[g]);var E=x,b=E;"linlog"===u&&(b=E=Math.log(1+x)),s&&(E=x/y,b=x/m),a&&e<r&&x<=0?(E=0,b=0):a&&e<r&&x>0&&(E=x,b=x),o[f][0]+=E*w[0],o[g][0]-=b*w[0],o[f][1]+=E*w[1],o[g][1]-=b*w[1]}}return o},t.prototype.getOptRepGraForces=function(t,e,r,n){for(var o=n.kg,i=n.center,a=n.prune,s=t.getAllNodes(),u=s.length,d=9e10,h=-9e10,c=9e10,l=-9e10,f=0;f<u;f+=1){var g=s[f],p=g.id,v=g.data;a&&t.getDegree(p)<=1||(r[p].setPos(v.x,v.y),v.x>=h&&(h=v.x),v.x<=d&&(d=v.x),v.y>=l&&(l=v.y),v.y<=c&&(c=v.y))}var y=Math.max(h-d,l-c),m=new Rr({xmid:(h+d)/2,ymid:(l+c)/2,length:y,massCenter:i,mass:u}),w=new Ir(m);for(f=0;f<u;f+=1)p=s[f].id,a&&t.getDegree(p)<=1||r[p].in(m)&&w.insert(r[p]);for(f=0;f<u;f+=1){var x=s[f],E=(p=x.id,v=x.data,t.getDegree(p));if(!(a&&E<=1)){r[p].resetForce(),w.updateForce(r[p]),e[p][0]-=r[p].fx,e[p][1]-=r[p].fy;var b=[v.x-i[0],v.y-i[1]],N=Math.hypot(b[0],b[1]);N=N<1e-4?1e-4:N,b[0]=b[0]/N,b[1]=b[1]/N;var M=o*(E+1);e[p][0]-=M*b[0],e[p][1]-=M*b[1]}}return e},t.prototype.getRepGraForces=function(t,e,r,n,o,i,a){for(var s=a.preventOverlap,u=a.kr,d=a.kg,h=a.center,c=a.prune,l=t.getAllNodes(),f=l.length,g=0;g<f;g+=1){for(var p=l[g],v=t.getDegree(p.id),y=g+1;y<f;y+=1){var m=l[y],w=t.getDegree(m.id);if(!c||!(v<=1||w<=1)){var x=[m.data.x-p.data.x,m.data.y-p.data.y],E=Math.hypot(x[0],x[1]);E=E<1e-4?1e-4:E,x[0]=x[0]/E,x[1]=x[1]/E,s&&e<r&&(E=E-i[p.id]-i[m.id]);var b=u*(v+1)*(w+1)/E;s&&e<r&&E<0?b=o*(v+1)*(w+1):s&&e<r&&0===E?b=0:s&&e<r&&E>0&&(b=u*(v+1)*(w+1)/E),n[p.id][0]-=b*x[0],n[m.id][0]+=b*x[0],n[p.id][1]-=b*x[1],n[m.id][1]+=b*x[1]}}var N=[p.data.x-h[0],p.data.y-h[1]],M=Math.hypot(N[0],N[1]);N[0]=N[0]/M,N[1]=N[1]/M;var S=d*(v+1);n[p.id][0]-=S*N[0],n[p.id][1]-=S*N[1]}return n},t.prototype.updatePos=function(t,e,r,n,o){for(var i=o.ks,a=o.tao,s=o.prune,u=o.ksmax,d=t.getAllNodes(),h=d.length,c=[],l=[],f=0,g=0,p=n,v=0;v<h;v+=1){var y=d[v].id,m=t.getDegree(y);if(!(s&&m<=1)){var w=[e[y][0]-r[y][0],e[y][1]-r[y][1]],E=Math.hypot(w[0],w[1]),b=[e[y][0]+r[y][0],e[y][1]+r[y][1]],N=Math.hypot(b[0],b[1]);c[v]=E,l[v]=N/2,f+=(m+1)*c[v],g+=(m+1)*l[v]}}var M=p;for(p=a*g/f,0!==M&&(p=p>1.5*M?1.5*M:p),v=0;v<h;v+=1){var S=d[v],k=(y=S.id,S.data);if(m=t.getDegree(y),!(s&&m<=1||x(k.fx)&&x(k.fy))){var A=i*p/(1+p*Math.sqrt(c[v])),R=Math.hypot(e[y][0],e[y][1]),I=u/(R=R<1e-4?1e-4:R),_=(A=A>I?I:A)*e[y][0],D=A*e[y][1];t.mergeNodeData(y,{x:k.x+_,y:k.y+D})}}return p},t}(),Or={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=n(n({},Or),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericFruchtermanLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,x,E=this;return a(this,(function(a){return this.running?[2]:(o=this.formatOptions(r),i=o.width,s=o.height,u=o.center,d=o.clustering,h=o.nodeClusterBy,c=o.maxIteration,f=o.onTick,g=e.getAllNodes(),p=e.getAllEdges(),(null==g?void 0:g.length)?1===g.length?(t&&e.mergeNodeData(g[0].id,{x:u[0],y:u[1]}),v={nodes:[n(n({},g[0]),{data:n(n({},g[0].data),{x:u[0],y:u[1]})})],edges:p},this.lastResult=v,[2,v]):(y=g.map((function(t){return b(t,[i,s])})),m=new l({nodes:y,edges:p}),w={},d&&y.forEach((function(t){var e=t.data[h];w[e]||(w[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=y,this.lastLayoutEdges=p,this.lastAssign=t,this.lastGraph=m,this.lastOptions=o,this.lastClusterMap=w,"undefined"==typeof window?[2]:(x=0,[2,new Promise((function(r){E.timeInterval=window.setInterval((function(){E.running?(E.runOneStep(m,w,o),t&&y.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y})})),null==f||f({nodes:y,edges:p}),++x>=c&&(window.clearInterval(E.timeInterval),r({nodes:y,edges:p}))):r({nodes:y,edges:p})}),0),E.running=!0}))])):(v={nodes:[],edges:p},this.lastResult=v,[2,v]))}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=n(n({},this.options),t),r=e.clustering,o=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=r&&!!o,e},t.prototype.runOneStep=function(t,e,r){var n=r.height,o=r.width,i=r.gravity,a=r.center,s=r.speed,u=r.clustering,d=r.nodeClusterBy,h=r.clusterGravity,c=n*o,l=Math.sqrt(c)/10,f=t.getAllNodes(),g=c/(f.length+1),p=Math.sqrt(g),v={};if(this.applyCalculate(t,v,p,g),u){for(var y in e)e[y].cx=0,e[y].cy=0,e[y].count=0;for(var y in f.forEach((function(t){var r=t.data,n=e[r[d]];x(r.x)&&(n.cx+=r.x),x(r.y)&&(n.cy+=r.y),n.count++})),e)e[y].cx/=e[y].count,e[y].cy/=e[y].count;var m=h||i;f.forEach((function(t,r){var n=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=e[o[d]],a=Math.sqrt((o.x-i.cx)*(o.x-i.cx)+(o.y-i.cy)*(o.y-i.cy)),s=p*m;v[n].x-=s*(o.x-i.cx)/a,v[n].y-=s*(o.y-i.cy)/a}}))}f.forEach((function(t,e){var r=t.id,n=t.data;if(x(n.x)&&x(n.y)){var o=.01*p*i;v[r].x-=o*(n.x-a[0]),v[r].y-=o*(n.y-a[1])}})),f.forEach((function(e,r){var n=e.id,o=e.data;if(x(o.fx)&&x(o.fy))return o.x=o.fx,void(o.y=o.fy);if(x(o.x)&&x(o.y)){var i=Math.sqrt(v[n].x*v[n].x+v[n].y*v[n].y);if(i>0){var a=Math.min(l*(s/800),i);t.mergeNodeData(n,{x:o.x+v[n].x/i*a,y:o.y+v[n].y/i*a})}}}))},t.prototype.applyCalculate=function(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)},t.prototype.calRepulsive=function(t,e,r){var n=t.getAllNodes();n.forEach((function(t,o){var i=t.data,a=t.id;e[a]={x:0,y:0},n.forEach((function(t,n){var s=t.data,u=t.id;if(!(o<=n)&&x(i.x)&&x(s.x)&&x(i.y)&&x(s.y)){var d=i.x-s.x,h=i.y-s.y,c=d*d+h*h;0===c&&(c=1,d=.01,h=.01);var l=r/c,f=d*l,g=h*l;e[a].x+=f,e[a].y+=g,e[u].x-=f,e[u].y-=g}}))}))},t.prototype.calAttractive=function(t,e,r){t.getAllEdges().forEach((function(n){var o=n.source,i=n.target;if(o&&i&&o!==i){var a=t.getNode(o).data,s=t.getNode(i).data;if(x(s.x)&&x(a.x)&&x(s.y)&&x(a.y)){var u=s.x-a.x,d=s.y-a.y,h=Math.sqrt(u*u+d*d)/r,c=u*h,l=d*h;e[o].x+=c,e[o].y+=l,e[i].x-=c,e[i].y-=l}}}))},t}(),Tr={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},zr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="grid",this.options=n(n({},Tr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericGridLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericGridLayout(!0,t,e),[2]}))}))},t.prototype.genericGridLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,p,v,y,m,w,E,N,M,A,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.begin,s=void 0===i?[0,0]:i,u=o.condense,d=o.preventOverlapPadding,h=o.preventOverlap,c=o.rows,l=o.cols,f=o.nodeSpacing,p=o.nodeSize,v=o.width,y=o.height,m=o.position,w=o.sortBy,E=e.getAllNodes(),N=e.getAllEdges(),!(M=null==E?void 0:E.length)||1===M)return[2,R(e,t,s)];if(A=E.map((function(t){return b(t)})),"id"===w||P(w)&&void 0!==A[0].data[w]||(w="degree"),"degree"===w?A.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):"id"===w?A.sort((function(t,e){return x(e.id)&&x(t.id)?e.id-t.id:(""+t.id).localeCompare(""+e.id)})):A.sort((function(t,e){return e.data[w]-t.data[w]})),I=v||"undefined"==typeof window?v:window.innerWidth,_=y||"undefined"==typeof window?y:window.innerHeight,D=M,O={rows:c,cols:l},null!=c&&null!=l?(O.rows=c,O.cols=l):null!=c&&null==l?(O.rows=c,O.cols=Math.ceil(D/O.rows)):null==c&&null!=l?(O.cols=l,O.rows=Math.ceil(D/O.cols)):(T=Math.sqrt(D*_/I),O.rows=Math.round(T),O.cols=Math.round(I/_*T)),O.rows=Math.max(O.rows,1),O.cols=Math.max(O.cols,1),O.cols*O.rows>D)z=Cr(O),C=Lr(O),(z-1)*C>=D?Cr(O,z-1):(C-1)*z>=D&&Lr(O,C-1);else for(;O.cols*O.rows<D;)z=Cr(O),((C=Lr(O))+1)*z>=D?Lr(O,C+1):Cr(O,z+1);for(L=u?0:I/O.cols,q=u?0:_/O.rows,(h||f)&&(j=S(10,f),F=k(30,p,!1),A.forEach((function(t){t.data.x&&t.data.y||(t.data.x=0,t.data.y=0);var r,n,o=e.getNode(t.id),i=F(o)||30;g(i)?(r=i[0],n=i[1]):(r=i,n=i);var a=void 0!==j?j(t):d,s=r+a,u=n+a;L=Math.max(L,s),q=Math.max(q,u)}))),V={},G={row:0,col:0},W={},B=0;B<A.length;B++){if($=A[B],U=void 0,m&&(U=m(e.getNode($.id))),U&&(void 0!==U.row||void 0!==U.col)){if(void 0===(H={row:U.row,col:U.col}).col)for(H.col=0;qr(V,H);)H.col++;else if(void 0===H.row)for(H.row=0;qr(V,H);)H.row++;W[$.id]=H,jr(V,H)}Vr($,s,L,q,W,O,G,V)}return K={nodes:A,edges:N},t&&A.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,K]}))}))},t}(),Cr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.min(n,o):Math.min(n,o)===t.rows?t.rows=e:t.cols=e,r},Lr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.max(n,o):Math.max(n,o)===t.rows?t.rows=e:t.cols=e,r},qr=function(t,e){return t["c-"+e.row+"-"+e.col]||!1},jr=function(t,e){return t["c-"+e.row+"-"+e.col]=!0},Fr=function(t,e){var r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},Vr=function(t,e,r,n,o,i,a,s){var u,d,h=o[t.id];if(h)u=h.col*r+r/2+e[0],d=h.row*n+n/2+e[1];else{for(;qr(s,a);)Fr(i,a);u=a.col*r+r/2+e[0],d=a.row*n+n/2+e[1],jr(s,a),Fr(i,a)}t.data.x=u,t.data.y=d};const Gr=Object.prototype.toString;function Wr(t){return Gr.call(t).endsWith("Array]")}function Br(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!Wr(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]<a&&(a=t[s]);return a}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]>a&&(a=t[s]);return a}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,a=void 0===i?r.autoMinMax?n:0:i,s=r.max,u=void 0===s?r.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var d=(u-a)/(o-n),h=0;h<t.length;h++)e[h]=(t[h]-n)*d+a;return e}const $r=" ".repeat(2),Ur=" ".repeat(4);function Hr(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=e;return`${t.constructor.name} {\\n${$r}[\\n${Ur}${function(t,e,r,n,o){const{rows:i,columns:a}=t,s=Math.min(i,e),u=Math.min(a,r),d=[];if("auto"===o){o=!1;t:for(let e=0;e<s;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let e=0;e<s;e++){let r=[];for(let i=0;i<u;i++)r.push(Kr(t.get(e,i),n,o));d.push(`${r.join(" ")}`)}return u!==a&&(d[d.length-1]+=` ... ${a-r} more columns`),s!==i&&d.push(`... ${i-e} more rows`),d.join(`\\n${Ur}`)}(t,r,n,o,i)}\\n${$r}]\\n${$r}rows: ${t.rows}\\n${$r}columns: ${t.columns}\\n}`}function Kr(t,e,r){return(t>=0&&r?` ${Yr(t,e-1)}`:Yr(t,e)).padEnd(e)}function Yr(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function Jr(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function Xr(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function Qr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function Zr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function tn(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(rn("startRow",e),rn("endRow",r),rn("startColumn",n),rn("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function en(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function rn(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function nn(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class on{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new sn(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new sn(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new sn(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new sn(t,e)}static ones(t,e){return new sn(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new sn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)o.set(r,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let a=o-n,s=new sn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(i()*a);s.set(r,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let t=0;t<n;t++)o.set(t,t,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let e=0;e<o;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new sn(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return on.isMatrix(t)?t:new sn(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let a=o;a<e;a++){let e=t.get(r,a)-i*t.get(n,a);t.set(r,a,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new sn(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){Jr(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return sn.rowVector(this.getRow(t))}setRow(t,e){Jr(this,t),e=Qr(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){Jr(this,t),Jr(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){Xr(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return sn.columnVector(this.getColumn(t))}setColumn(t,e){Xr(this,t),e=Zr(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){Xr(this,t),Xr(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){Jr(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){Xr(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){nn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){nn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(Jr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){Jr(this,t),nn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(Jr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){Jr(this,t),nn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(Xr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){Xr(this,t),nn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(Xr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){Xr(this,t),nn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){on.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=sn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new sn(e,n),i=new Float64Array(r);for(let a=0;a<n;a++){for(let e=0;e<r;e++)i[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,a,e)}}return o}strassen2x2(t){t=sn.checkMatrix(t);let e=new sn(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),d=t.get(1,1),h=(r+u)*(n+d),c=(a+u)*n,l=r*(i-d),f=u*(s-n),g=(r+o)*d,p=h+f-g+(o-u)*(s+d),v=l+g,y=c+f,m=h-c+l+(a-r)*(n+i);return e.set(0,0,p),e.set(0,1,v),e.set(1,0,y),e.set(1,1,m),e}strassen3x3(t){t=sn.checkMatrix(t);let e=new sn(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),d=this.get(2,1),h=this.get(2,2),c=t.get(0,0),l=t.get(0,1),f=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),y=t.get(2,0),m=t.get(2,1),w=t.get(2,2),x=(r-i)*(-l+p),E=(-r+i+a)*(c-l+p),b=(i+a)*(-c+l),N=r*c,M=(-r+u+d)*(c-f+v),S=(-r+u)*(f-v),k=(u+d)*(-c+f),A=(-o+d+h)*(p+y-m),R=(o-h)*(p-m),I=o*y,_=(d+h)*(-y+m),D=(-o+a+s)*(v+y-w),O=(o-s)*(v-w),P=(a+s)*(-y+w),T=N+I+n*g,z=(r+n+o-i-a-d-h)*p+E+b+N+A+I+_,C=N+M+k+(r+n+o-a-s-u-d)*v+I+D+P,L=x+a*(-c+l+g-p-v-y+w)+E+N+I+D+O,q=x+E+b+N+s*m,j=I+D+O+P+i*f,F=N+M+S+d*(-c+f+g-p-v-y+m)+A+R+I,V=A+R+I+_+u*l,G=N+M+S+k+h*w;return e.set(0,0,T),e.set(0,1,z),e.set(0,2,C),e.set(1,0,L),e.set(1,1,q),e.set(1,2,j),e.set(2,0,F),e.set(2,1,V),e.set(2,2,G),e}mmulStrassen(t){t=sn.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function a(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=on.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${r} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let s=Math.max(r,o),u=Math.max(n,i);return e=a(e,s,u),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=a(e,n+1,o+1),r=a(r,n+1,o+1)):n%2==1?(e=a(e,n+1,o),r=a(r,n+1,o)):o%2==1&&(e=a(e,n,o+1),r=a(r,n,o+1));let i=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,s-1),d=r.subMatrix(0,i-1,0,s-1),h=e.subMatrix(0,i-1,s,e.columns-1),c=r.subMatrix(0,i-1,s,r.columns-1),l=e.subMatrix(i,e.rows-1,0,s-1),f=r.subMatrix(i,r.rows-1,0,s-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),p=r.subMatrix(i,r.rows-1,s,r.columns-1),v=t(on.add(u,g),on.add(d,p),i,s),y=t(on.add(l,g),d,i,s),m=t(u,on.sub(c,p),i,s),w=t(g,on.sub(f,d),i,s),x=t(on.add(u,h),p,i,s),E=t(on.sub(l,u),on.add(d,c),i,s),b=t(on.sub(h,g),on.add(f,p),i,s),N=on.add(v,w);N.sub(x),N.add(b);let M=on.add(m,x),S=on.add(y,w),k=on.sub(v,y);k.add(m),k.add(E);let A=on.zeros(2*N.rows,2*N.columns);return A=A.setSubMatrix(N,0,0),A=A.setSubMatrix(M,N.rows,0),A=A.setSubMatrix(S,0,N.columns),A=A.setSubMatrix(k,N.rows,N.columns),A.subMatrix(0,n-1,0,o-1)}(e,t=a(t,s,u),s,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new sn(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&Br(o,{min:e,max:r,output:o}),n.setRow(t,o)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new sn(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&Br(o,{min:e,max:r,output:o}),n.setColumn(t,o)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=sn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new sn(e*n,r*o);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<o;s++)i.set(n*a+r,o*e+s,this.get(a,e)*t.get(r,s));return i}kroneckerSum(t){if(t=sn.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(sn.eye(r,r)),o=sn.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new sn(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=an){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=an){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){tn(this,t,e,r,n);let o=new sn(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new sn(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new sn(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=sn.checkMatrix(t)).isEmpty())return this;tn(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){!function(t,e){if(!Wr(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!Wr(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new sn(t.length,e.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<e.length;t++){let i=e[t];r.set(n,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new sn(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=en(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=en(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=en(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=en(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Wr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<n;a++){let n=0,s=0,u=0;for(let e=0;e<o;e++)u=t.get(a,e)-r[a],n+=u,s+=u*u;e?i.push((s-n*n/o)/(o-1)):i.push((s-n*n/o)/o)}return i}(this,r,n);case"column":if(!Wr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<o;a++){let o=0,s=0,u=0;for(let e=0;e<n;e++)u=t.get(e,a)-r[a],o+=u,s+=u*u;e?i.push((s-o*o/n)/(n-1)):i.push((s-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let a=0,s=0,u=0;for(let e=0;e<n;e++)for(let n=0;n<o;n++)u=t.get(e,n)-r,a+=u,s+=u*u;return e?(s-a*a/i)/(i-1):(s-a*a/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Wr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!Wr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!Wr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!Wr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return Hr(this,t)}}function an(t,e){return t-e}on.prototype.klass="Matrix","undefined"!=typeof Symbol&&(on.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return Hr(this)}),on.random=on.rand,on.randomInt=on.randInt,on.diagonal=on.diag,on.prototype.diagonal=on.prototype.diag,on.identity=on.eye,on.prototype.negate=on.prototype.neg,on.prototype.tensorProduct=on.prototype.kroneckerProduct;class sn extends on{constructor(t,e){if(super(),sn.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Wr(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!r[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return Jr(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),Jr(this,t,!0),e=Float64Array.from(Qr(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){Xr(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),Xr(this,t,!0),e=Zr(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(on,sn);class un extends on{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function dn(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class hn{constructor(t,e={}){if((t=un.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=e;let s,u=Boolean(o),d=Boolean(i),h=!1;if(r<n)if(a){s=t.transpose(),r=s.rows,n=s.columns,h=!0;let e=u;u=d,d=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let c=Math.min(r,n),l=Math.min(r+1,n),f=new Float64Array(l),g=new sn(r,c),p=new sn(n,n),v=new Float64Array(n),y=new Float64Array(r),m=new Float64Array(l);for(let t=0;t<l;t++)m[t]=t;let w=Math.min(r-1,n),x=Math.max(0,Math.min(n-2,r)),E=Math.max(w,x);for(let t=0;t<E;t++){if(t<w){f[t]=0;for(let e=t;e<r;e++)f[t]=dn(f[t],s.get(e,t));if(0!==f[t]){s.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<r;e++)s.set(e,t,s.get(e,t)/f[t]);s.set(t,t,s.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<n;e++){if(t<w&&0!==f[t]){let n=0;for(let o=t;o<r;o++)n+=s.get(o,t)*s.get(o,e);n=-n/s.get(t,t);for(let o=t;o<r;o++)s.set(o,e,s.get(o,e)+n*s.get(o,t))}v[e]=s.get(t,e)}if(u&&t<w)for(let e=t;e<r;e++)g.set(e,t,s.get(e,t));if(t<x){v[t]=0;for(let e=t+1;e<n;e++)v[t]=dn(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<n;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<r&&0!==v[t]){for(let e=t+1;e<r;e++)y[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)y[e]+=v[r]*s.get(e,r);for(let e=t+1;e<n;e++){let n=-v[e]/v[t+1];for(let o=t+1;o<r;o++)s.set(o,e,s.get(o,e)+n*y[o])}}if(d)for(let e=t+1;e<n;e++)p.set(e,t,v[e])}}let b=Math.min(n,r+1);if(w<n&&(f[w]=s.get(w,w)),r<b&&(f[b-1]=0),x+1<b&&(v[x]=s.get(x,b-1)),v[b-1]=0,u){for(let t=w;t<c;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<c;e++){let n=0;for(let o=t;o<r;o++)n+=g.get(o,t)*g.get(o,e);n=-n/g.get(t,t);for(let o=t;o<r;o++)g.set(o,e,g.get(o,e)+n*g.get(o,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(d)for(let t=n-1;t>=0;t--){if(t<x&&0!==v[t])for(let e=t+1;e<n;e++){let r=0;for(let o=t+1;o<n;o++)r+=p.get(o,t)*p.get(o,e);r=-r/p.get(t+1,t);for(let o=t+1;o<n;o++)p.set(o,e,p.get(o,e)+r*p.get(o,t))}for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}let N=b-1,M=0,S=Number.EPSILON;for(;b>0;){let t,e;for(t=b-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===b-2)e=4;else{let r;for(r=b-1;r>=t&&r!==t;r--){let e=(r!==b?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(f[r])<=S*e){f[r]=0;break}}r===t?e=3:r===b-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[b-2];v[b-2]=0;for(let r=b-2;r>=t;r--){let o=dn(f[r],e),i=f[r]/o,a=e/o;if(f[r]=o,r!==t&&(e=-a*v[r-1],v[r-1]=i*v[r-1]),d)for(let t=0;t<n;t++)o=i*p.get(t,r)+a*p.get(t,b-1),p.set(t,b-1,-a*p.get(t,r)+i*p.get(t,b-1)),p.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<b;n++){let o=dn(f[n],e),i=f[n]/o,a=e/o;if(f[n]=o,e=-a*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g.get(e,n)+a*g.get(e,t-1),g.set(e,t-1,-a*g.get(e,n)+i*g.get(e,t-1)),g.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(f[b-1]),Math.abs(f[b-2]),Math.abs(v[b-2]),Math.abs(f[t]),Math.abs(v[t])),o=f[b-1]/e,i=f[b-2]/e,a=v[b-2]/e,s=f[t]/e,h=v[t]/e,c=((i+o)*(i-o)+a*a)/2,l=o*a*(o*a);let y=0;0===c&&0===l||(y=c<0?0-Math.sqrt(c*c+l):Math.sqrt(c*c+l),y=l/(c+y));let m=(s+o)*(s-o)+y,w=s*h;for(let e=t;e<b-1;e++){let o=dn(m,w);0===o&&(o=Number.MIN_VALUE);let i=m/o,a=w/o;if(e!==t&&(v[e-1]=o),m=i*f[e]+a*v[e],v[e]=i*v[e]-a*f[e],w=a*f[e+1],f[e+1]=i*f[e+1],d)for(let t=0;t<n;t++)o=i*p.get(t,e)+a*p.get(t,e+1),p.set(t,e+1,-a*p.get(t,e)+i*p.get(t,e+1)),p.set(t,e,o);if(o=dn(m,w),0===o&&(o=Number.MIN_VALUE),i=m/o,a=w/o,f[e]=o,m=i*v[e]+a*f[e+1],f[e+1]=-a*v[e]+i*f[e+1],w=a*v[e+1],v[e+1]=i*v[e+1],u&&e<r-1)for(let t=0;t<r;t++)o=i*g.get(t,e)+a*g.get(t,e+1),g.set(t,e+1,-a*g.get(t,e)+i*g.get(t,e+1)),g.set(t,e,o)}v[b-2]=m,M+=1;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,d))for(let e=0;e<=N;e++)p.set(e,t,-p.get(e,t));for(;t<N&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,d&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}M=0,b--}}if(h){let t=p;p=g,g=t}this.m=r,this.n=n,this.s=f,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,o=sn.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?o.set(t,t,0):o.set(t,t,1/this.s[t]);let i=this.U,a=this.rightSingularVectors,s=a.mmul(o),u=a.rows,d=i.rows,h=sn.zeros(u,d);for(let t=0;t<u;t++)for(let e=0;e<d;e++){let r=0;for(let o=0;o<n;o++)r+=s.get(t,o)*i.get(e,o);h.set(t,e,r)}return h.mmul(e)}solveForDiagonal(t){return this.solve(sn.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new sn(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,a=i.rows,s=i.columns,u=new sn(r,a);for(let t=0;t<r;t++)for(let e=0;e<a;e++){let r=0;for(let n=0;n<s;n++)r+=o.get(t,n)*i.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return sn.diag(this.s)}}var cn,ln={center:[0,0],linkDistance:50},fn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="mds",this.options=n(n({},ln),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericMDSLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericMDSLayout(!0,t,e),[2]}))}))},t.prototype.genericMDSLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,g,y;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=void 0===i?[0,0]:i,u=o.linkDistance,d=void 0===u?50:u,h=e.getAllNodes(),c=e.getAllEdges(),(null==h?void 0:h.length)&&1!==h.length?(l=v({nodes:h,edges:c},!1),f=p(l),gn(f),m=d,w=[],f.forEach((function(t){var e=[];t.forEach((function(t){e.push(t*m)})),w.push(e)})),g=pn(w),y=[],g.forEach((function(t,e){var r=b(h[e]);r.data.x=t[0]+s[0],r.data.y=t[1]+s[1],y.push(r)})),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:y,edges:c}]):[2,R(e,t,s)];var m,w}))}))},t}(),gn=function(t){var e=-999999;t.forEach((function(t){t.forEach((function(t){t!==1/0&&e<t&&(e=t)}))})),t.forEach((function(r,n){r.forEach((function(r,o){r===1/0&&(t[n][o]=e)}))}))},pn=function(t){var e=sn.mul(sn.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),o=e.mean();e.add(o).subRowVector(r).subColumnVector(n);var i=new hn(e),a=sn.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((function(t){return sn.mul([t],[a]).toJSON()[0].splice(0,2)}))},vn={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},yn=function(t,e,r,n,o,i){e.forEach((function(a,s){r[s]={x:0,y:0},e.forEach((function(e,u){if(s!==u&&o[s]===o[u]){var d=a.x-e.x,h=a.y-e.y,c=Math.sqrt(d*d+h*h);if(0===c){c=1;var l=s>u?1:-1;d=.01*l,h=.01*l}if(c<i(t[s])/2+i(t[u])/2){var f=n*n/c;r[s].x+=d/c*f,r[s].y+=h/c*f}}}))}))},mn=function(t,e,r,n,o,i,a,s){var u=i||a/10;return n&&e.forEach((function(e,r){var n=t[r].x-t[o].x,i=t[r].y-t[o].y,a=Math.sqrt(n*n+i*i),s=i/a,u=-n/a,d=Math.sqrt(e.x*e.x+e.y*e.y),h=Math.acos((s*e.x+u*e.y)/d);h>Math.PI/2&&(h-=Math.PI/2,s*=-1,u*=-1);var c=Math.cos(h)*d;e.x=s*c,e.y=u*c})),t.forEach((function(i,a){if(a!==o){var d=Math.sqrt(e[a].x*e[a].x+e[a].y*e[a].y);if(d>0&&a!==o){var h=Math.min(u*(r/800),d);if(i.x+=e[a].x/d*h,i.y+=e[a].y/d*h,n){var c=i.x-t[o].x,l=i.y-t[o].y,f=Math.sqrt(c*c+l*l);c=c/f*s[a],l=l/f*s[a],i.x=t[o].x+c,i.y=t[o].y+l}}}})),t},wn={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},xn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="radial",this.options=n(n({},wn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRadialLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRadialLayout(!0,t,e),[2]}))}))},t.prototype.genericRadialLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,d,h,c,l,f,g,y,m,w,x,E,N,M,S,k,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K,Y,J,X,Q,Z,tt,et;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,d=o.height,h=o.center,c=o.focusNode,l=o.unitRadius,f=o.nodeSize,g=o.nodeSpacing,y=o.strictRadial,m=o.preventOverlap,w=o.maxPreventOverlapIteration,x=o.sortBy,E=o.linkDistance,N=void 0===E?50:E,M=o.sortStrength,S=void 0===M?10:M,k=o.maxIteration,I=void 0===k?1e3:k,_=e.getAllNodes(),D=e.getAllEdges(),O=i||"undefined"==typeof window?i:window.innerWidth,T=d||"undefined"==typeof window?d:window.innerHeight,z=h||[O/2,T/2],!(null==_?void 0:_.length)||1===_.length)return[2,R(e,t,z)];if(C=_[0],P(c)){for(L=0;L<_.length;L++)if(_[L].id===c){C=_[L];break}}else C=c||_[0];return q=Nn(_,C.id),j=v({nodes:_,edges:D},!1),F=p(j),V=Sn(F,q),Mn(F,q,V+1),G=F[q],W=O-z[0]>z[0]?z[0]:O-z[0],B=T-z[1]>z[1]?z[1]:T-z[1],0===W&&(W=O/2),0===B&&(B=T/2),$=Math.min(W,B),U=Math.max.apply(Math,u([],s(G))),H=[],K=l||$/U,G.forEach((function(t,e){H[e]=t*K})),Y=En(_,F,N,H,K,x,S),J=bn(Y),X=function(t,e,r){try{var n=sn.mul(sn.pow(e,2),-.5),o=n.mean("row"),i=n.mean("column"),a=n.mean();n.add(a).subRowVector(o).subColumnVector(i);var s=new hn(n),u=sn.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((function(e){return sn.mul([e],[u]).toJSON()[0].splice(0,t)}))}catch(t){for(var d=[],h=0;h<e.length;h++){var c=Math.random()*r,l=Math.random()*r;d.push([c,l])}return d}}(N,Y,N),Q=X.map((function(t){var e=s(t,2),r=e[0],n=e[1];return{x:(isNaN(r)?Math.random()*N:r)-X[q][0],y:(isNaN(n)?Math.random()*N:n)-X[q][1]}})),this.run(I,Q,J,Y,H,q),m&&(Z=A(f,g),tt={nodes:_,nodeSizeFunc:Z,positions:Q,radii:H,height:T,width:O,strictRadial:Boolean(y),focusIdx:q,iterations:w||200,k:Q.length/4.5},Q=function(t,e){for(var r=n(n({},vn),e),o=r.positions,i=r.iterations,a=r.width,s=r.k,u=r.speed,d=void 0===u?100:u,h=r.strictRadial,c=r.focusIdx,l=r.radii,f=void 0===l?[]:l,g=r.nodeSizeFunc,p=t.getAllNodes(),v=[],y=a/10,m=0;m<i;m++)o.forEach((function(t,e){v[e]={x:0,y:0}})),yn(p,o,v,s,f,g),mn(o,v,d,h,c,y,a,f);return o}(e,tt)),et=[],Q.forEach((function(t,e){var r=b(_[e]);r.data.x=t.x+z[0],r.data.y=t.y+z[1],et.push(r)})),t&&et.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:et,edges:D}]}))}))},t.prototype.run=function(t,e,r,n,o,i){for(var a=0;a<=t;a++){var s=a/t;this.oneIteration(s,e,o,n,r,i)}},t.prototype.oneIteration=function(t,e,r,n,o,i){var a=1-t;e.forEach((function(s,u){var d=y(s,{x:0,y:0}),h=0===d?0:1/d;if(u!==i){var c=0,l=0,f=0;e.forEach((function(t,e){if(u!==e){var r=y(s,t),i=0===r?0:1/r,a=n[e][u];f+=o[u][e],c+=o[u][e]*(t.x+a*(s.x-t.x)*i),l+=o[u][e]*(t.y+a*(s.y-t.y)*i)}}));var g=0===r[u]?0:1/r[u];f*=a,f+=t*g*g,c*=a,c+=t*g*s.x*h,s.x=c/f,l*=a,l+=t*g*s.y*h,s.y=l/f}}))},t}(),En=function(t,e,r,n,o,i,a){if(!t)return[];var s=[];if(e){var u={};e.forEach((function(e,d){var h=[];e.forEach((function(e,s){var c,l;if(d===s)h.push(0);else if(n[d]===n[s])if("data"===i)h.push(e*(Math.abs(d-s)*a)/(n[d]/o));else if(i){var f=void 0,g=void 0;if(u[t[d].id])f=u[t[d].id];else{var p=("id"===i?t[d].id:null===(c=t[d].data)||void 0===c?void 0:c[i])||0;f=P(p)?p.charCodeAt(0):p,u[t[d].id]=f}u[t[s].id]?g=u[t[s].id]:(p=("id"===i?t[s].id:null===(l=t[s].data)||void 0===l?void 0:l[i])||0,g=P(p)?p.charCodeAt(0):p,u[t[s].id]=g),h.push(e*(Math.abs(f-g)*a)/(n[d]/o))}else h.push(e*r/(n[d]/o));else{var v=(r+o)/2;h.push(e*v)}})),s.push(h)}))}return s},bn=function(t){for(var e=t.length,r=t[0].length,n=[],o=0;o<e;o++){for(var i=[],a=0;a<r;a++)0!==t[o][a]?i.push(1/(t[o][a]*t[o][a])):i.push(0);n.push(i)}return n},Nn=function(t,e){var r=-1;return t.forEach((function(t,n){t.id===e&&(r=n)})),Math.max(r,0)},Mn=function(t,e,r){for(var n=t.length,o=0;o<n;o++)if(t[e][o]===1/0){t[e][o]=r,t[o][e]=r;for(var i=0;i<n;i++)t[o][i]!==1/0&&t[e][i]===1/0&&(t[e][i]=r+t[o][i],t[i][e]=r+t[o][i])}for(o=0;o<n;o++)if(o!==e)for(i=0;i<n;i++)if(t[o][i]===1/0){var a=Math.abs(t[e][o]-t[e][i]);a=0===a?1:a,t[o][i]=a}},Sn=function(t,e){for(var r=0,n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r},kn={center:[0,0],width:300,height:300},An=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="random",this.options=n(n({},kn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRandomLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRandomLayout(!0,t,e),[2]}))}))},t.prototype.genericRandomLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,d=e.getAllNodes(),h=s||"undefined"==typeof window?s:window.innerWidth,c=u||"undefined"==typeof window?u:window.innerHeight,l=i||[h/2,c/2],f=[],d&&d.forEach((function(t){f.push({id:t.id,data:{x:.9*(Math.random()-.5)*h+l[0],y:.9*(Math.random()-.5)*c+l[1]}})})),t&&f.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:f,edges:e.getAllEdges()}]}))}))},t}(),Rn={circular:_,concentric:z,mds:fn,random:An,grid:zr,radial:xn,force:xr,d3force:zt,fruchterman:Pr,forceAtlas2:Dr,dagre:pr};function In(){var t;(null===(t=cn)||void 0===t?void 0:t.stop)&&cn.stop()}function _n(t,e){return i(this,void 0,void 0,(function(){var r,n,o,i,s,u,d,h,c;return a(this,(function(a){switch(a.label){case 0:if(r=t.layout,n=r.id,o=r.options,i=r.iterations,s=t.nodes,u=t.edges,d=new l({nodes:s,edges:u}),!(h=Rn[n]))throw new Error("Unknown layout id: "+n);return[4,(cn=new h(o)).execute(d)];case 1:return c=a.sent(),!!(f=cn).tick&&!!f.stop&&(cn.stop(),c=cn.tick(i)),[2,[c,e]]}var f}))}))}addEventListener("message",(function(t){var r,n=t.data,o=n.type,i=n.method,a=n.id,s=n.params;"RPC"===o&&i&&((r=e[i])?Promise.resolve().then((function(){return r.apply(e,s)})):Promise.reject("No such method")).then((function(t){postMessage({type:"RPC",id:a,result:t})})).catch((function(t){var e={message:t};t.stack&&(e.message=t.message,e.stack=t.stack,e.name=t.name),postMessage({type:"RPC",id:a,error:e})}))})),postMessage({type:"RPC",method:"ready"});\n//# sourceMappingURL=c1c68049e416ee50a3be.worker.js.map']))),n(t,o),t}},331:t=>{t.exports=function(t,e){var r=0,n={};t.addEventListener("message",(function(e){var r=e.data;if("RPC"===r.type)if(r.id){var o=n[r.id];o&&(delete n[r.id],r.error?o[1](Object.assign(Error(r.error.message),r.error)):o[0](r.result))}else{var i=document.createEvent("Event");i.initEvent(r.method,!1,!1),i.data=r.params,t.dispatchEvent(i)}})),e.forEach((function(e){t[e]=function(){var o=arguments;return new Promise((function(i,a){var s=++r;n[s]=[i,a],t.postMessage({type:"RPC",id:s,method:e,params:[].slice.call(o)})}))}}))}}},a={};function s(t){var e=a[t];if(void 0!==e)return e.exports;var r=a[t]={exports:{}};return i[t](r,r.exports,s),r.exports}s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var u={};(()=>{s.d(u,{SB:()=>U,W1:()=>Q,jA:()=>Wt,Vq:()=>yr,E9:()=>Rr,y7:()=>br,O2:()=>zr,Me:()=>Lr,AI:()=>pn,D4:()=>bn,_5:()=>In,y9:()=>X,_A:()=>p,d9:()=>R,ul:()=>O,qs:()=>E,gl:()=>F,jE:()=>L,tO:()=>P,zJ:()=>b,h$:()=>S,BI:()=>T,$y:()=>D,H0:()=>A,kJ:()=>v,hY:()=>Rn,qR:()=>Dn,i_:()=>Tn,nu:()=>N,He:()=>m,A3:()=>_});var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};function n(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function i(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function a(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(e){i(e)}}function s(t){try{u(n.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function d(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(u){s=[6,u],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function h(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function c(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}var l,f,g=/-(\w)/g,p=(l=function(t){return t.replace(g,(function(t,e){return e?e.toUpperCase():""}))},f=Object.create(null),function(t){return f[t]||(f[t]=l(t))}),v=Array.isArray,m=function(t){var e=parseFloat(t);return isNaN(e)?t:e},y={}.toString;const w=function(t,e){return y.call(t)==="[object "+e+"]"},x=function(t){return w(t,"Number")};var E=function(t){for(var e=[],r=t.length,n=0;n<r;n+=1){e[n]=[];for(var o=0;o<r;o+=1)n===o?e[n][o]=0:0!==t[n][o]&&t[n][o]?e[n][o]=t[n][o]:e[n][o]=1/0}for(var i=0;i<r;i+=1)for(n=0;n<r;n+=1)for(o=0;o<r;o+=1)e[n][o]>e[n][i]+e[i][o]&&(e[n][o]=e[n][i]+e[i][o]);return e},b=function(t,e){var r=t.nodes,n=t.edges,o=[],i={};if(!r)throw new Error("invalid nodes data!");return r&&r.forEach((function(t,e){i[t.id]=e,o.push([])})),null==n||n.forEach((function(t){var r=t.source,n=t.target,a=i[r],s=i[n];void 0!==a&&void 0!==s&&(o[a][s]=1,e||(o[s][a]=1))})),o},N=function(t,e){var r=[];return t.forEach((function(t){var n=[];t.forEach((function(t){n.push(t*e)})),r.push(n)})),r},M=function(t,e){if(t&&t.children)for(var r=t.children.length-1;r>=0;r--)if(!M(t.children[r],e))return;return!!e(t)},_=function(t,e){"function"==typeof e&&M(t,e)},A=function(t){var e=1/0,r=1/0,n=-1/0,o=-1/0;return t.forEach((function(t){var i=t.data.size;v(i)?1===i.length&&(i=[i[0],i[0]]):x(i)?i=[i,i]:(void 0===i||isNaN(i))&&(i=[30,30]);var a=[i[0]/2,i[1]/2],s=t.data.x-a[0],u=t.data.x+a[0],d=t.data.y-a[1],h=t.data.y+a[1];e>s&&(e=s),r>d&&(r=d),n<u&&(n=u),o<h&&(o=h)})),{minX:e,minY:r,maxX:n,maxY:o}},S=function(t){var e={x:0,y:0};t.forEach((function(t){e.x+=t.data.x||0,e.y+=t.data.y||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},k=function(t,e,r){var n,o;return"source"===t?(null===(n=null==r?void 0:r.find((function(t){return t.target===e.id})))||void 0===n?void 0:n.source)||{}:(null===(o=null==r?void 0:r.find((function(t){return t.source===e.id})))||void 0===o?void 0:o.target)||{}},I=function(t,e,r){var n=[];switch(t){case"source":n=null==r?void 0:r.filter((function(t){return t.source===e.id})).map((function(t){return t.target}));break;case"target":n=null==r?void 0:r.filter((function(t){return t.target===e.id})).map((function(t){return t.source}));break;case"both":n=null==r?void 0:r.filter((function(t){return t.source===e.id})).map((function(t){return t.target})).concat(null==r?void 0:r.filter((function(t){return t.target===e.id})).map((function(t){return t.source})))}var o=new Set(n);return Array.from(o)},T=function(t,e,r,n,o,i){var a,s,u,d,h,c,l=o[e.id],f=l.in,g=l.out,p=e,v=[];return 0===f?(p=k("source",e,r),v=I("both",p,r).map((function(t){return i[t]}))):0===g&&(p=k("target",e,r),v=I("both",p,r).map((function(t){return i[t]}))),{coreNode:p,relativeLeafNodes:v=v.filter((function(t){return o[t.id]&&(0===o[t.id].in||0===o[t.id].out)})),sameTypeLeafNodes:(a=t,u=v,d=o,h=e[s=n]||"",c=(null==u?void 0:u.filter((function(t){return t[s]===h})))||[],"leaf"===a&&(c=c.filter((function(t){var e,r;return 0===(null===(e=d[t.id])||void 0===e?void 0:e.in)||0===(null===(r=d[t.id])||void 0===r?void 0:r.out)}))),c)}},D=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},R=function(t){if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var e=[];return t.forEach((function(t){e.push(t)})),e.map((function(t){return R(t)}))}if("object"==typeof t){var r={};return Object.keys(t).forEach((function(e){r[e]=R(t[e])})),r}return t},O=function(t,e){var r=R(t);return r.data=r.data||{},e&&(x(r.data.x)||(r.data.x=Math.random()*e[0]),x(r.data.y)||(r.data.y=Math.random()*e[1])),r};const z=function(t){return"function"==typeof t},C=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function L(t,e){return z(e)?e:x(e)?function(){return e}:function(){return t}}function P(t,e,r){return void 0===r&&(r=!0),e||0===e?z(e)?e:x(e)?function(){return e}:v(e)?function(){if(r){var n=Math.max.apply(Math,c([],h(e)));return isNaN(n)?t:n}return e}:C(e)?function(){if(r){var n=Math.max(e.width,e.height);return isNaN(n)?t:n}return[e.width,e.height]}:function(){return t}:function(e){var r=(e.data||{}).size;return r?v(r)?r[0]>r[1]?r[0]:r[1]:C(r)?r.width>r.height?r.width:r.height:r:t}}var F=function(t,e){var r;return r=x(e)?function(){return e}:z(e)?e:function(){return 0},t?v(t)?function(e){return(t[0]>t[1]?t[0]:t[1])+r(e)}:function(e){return t+r(e)}:function(t){var e,n;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return Math.max(t.data.bboxSize[0],t.data.bboxSize[1])+r(t);if(null===(n=t.data)||void 0===n?void 0:n.size){if(v(t.data.size))return Math.max(t.data.size[0],t.data.size[1])+r(t);var o=t.data.size;return C(o)?(o.width>o.height?o.width:o.height)+r(t):o+r(t)}return 10+r(t)}},j=function(t,e,r){var n=t.getAllNodes(),i=t.getAllEdges();return(null==n?void 0:n.length)?1===n.length?(e&&t.mergeNodeData(n[0].id,{x:r[0],y:r[1]}),{nodes:[o(o({},n[0]),{data:o(o({},n[0].data),{x:r[0],y:r[1]})})],edges:i}):void 0:{nodes:[],edges:i}},G={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},U=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="circular",this.options=o(o({},G),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return[2,this.genericCircularLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){switch(r.label){case 0:return[4,this.genericCircularLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericCircularLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,s,u,c,l,f,g,p,v,m,y,w,x,E,b,N,M,_,A,S,k,I,T,D,R,z,C,F,G,U,q,W,H;return d(this,(function(d){if(n=o(o({},this.options),r),i=n.width,a=n.height,s=n.center,u=n.divisions,c=n.startAngle,l=void 0===c?0:c,f=n.endAngle,g=void 0===f?2*Math.PI:f,p=n.angleRatio,v=n.ordering,m=n.clockwise,y=n.nodeSpacing,w=n.nodeSize,x=e.getAllNodes(),E=e.getAllEdges(),b=h(B(i,a,s),3),N=b[0],M=b[1],_=b[2],!(A=null==x?void 0:x.length)||1===A)return[2,j(e,t,_)];for(S=(g-l)/A,k=n.radius,I=n.startRadius,T=n.endRadius,y?(D=L(10,y),R=P(10,w),z=-1/0,x.forEach((function(t){var e=R(t);z<e&&(z=e)})),C=0,x.forEach((function(t,e){C+=0===e?z||10:(D(t)||0)+(z||10)})),k=C/(2*Math.PI)):k||I||T?!I&&T?I=T:I&&!T&&(T=I):k=Math.min(M,N)/2,F=S*p,G=[],G="topology"===v?V(e,x):"topology-directed"===v?V(e,x,!0):"degree"===v?function(t,e){var r=[];return e.forEach((function(t,e){r.push(O(t))})),r.sort((function(e,r){return t.getDegree(e.id,"both")-t.getDegree(r.id,"both")})),r}(e,x):x.map((function(t){return O(t)})),U=Math.ceil(A/u),q=0;q<A;++q)(W=k)||null===I||null===T||(W=I+q*(T-I)/(A-1)),W||(W=10+100*q/(A-1)),H=l+q%U*F+2*Math.PI/u*Math.floor(q/U),m||(H=g-q%U*F-2*Math.PI/u*Math.floor(q/U)),G[q].data.x=_[0]+Math.cos(H)*W,G[q].data.y=_[1]+Math.sin(H)*W;return t&&G.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:G,edges:E}]}))}))},t}(),V=function(t,e,r){void 0===r&&(r=!1);var n=[O(e[0])],o={},i=e.length;o[e[0].id]=!0;var a=0;return e.forEach((function(s,u){if(0!==u)if(u!==i-1&&t.getDegree(s.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(n[a].id,s.id)||o[s.id]){for(var d=r?t.getSuccessors(n[a].id):t.getNeighbors(n[a].id),h=!1,c=0;c<d.length;c++){var l=d[c];if(t.getDegree(l.id)===t.getDegree(s.id)&&!o[l.id]){n.push(O(l)),o[l.id]=!0,h=!0;break}}for(var f=0;!h&&(o[e[f].id]||(n.push(O(e[f])),o[e[f].id]=!0,h=!0),++f!==i););}else n.push(O(s)),o[s.id]=!0,a++})),n},B=function(t,e,r){var n=t,o=e,i=r;return n||"undefined"==typeof window||(n=window.innerWidth),o||"undefined"==typeof window||(o=window.innerHeight),i||(i=[n/2,o/2]),[n,o,i]},q=s(913),W=s.n(q),H=s(617),$=s.n(H),X=function(t){function e(e,r,n){var o=t.call(this)||this;return o.graph=e,o.layout=r,o.options=n,o.spawnWorker(),o}return n(e,t),e.prototype.spawnWorker=function(){this.worker&&this.worker.terminate(),this.worker=$()(),this.running&&(this.running=!1,this.execute())},e.prototype.execute=function(){var t;return a(this,void 0,void 0,(function(){var e,r,n,o;return d(this,(function(a){switch(a.label){case 0:return this.running?[2,this]:(this.running=!0,(e=this.layout.options).onTick,r=i(e,["onTick"]),n={layout:{id:this.layout.id,options:r,iterations:null===(t=this.options)||void 0===t?void 0:t.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},o=new Float32Array([0]),[4,this.worker.calculateLayout(n,[o])]);case 1:return[2,h.apply(void 0,[a.sent(),1])[0]]}}))}))},e.prototype.stop=function(){return this.running=!1,this.worker.stopLayout(),this},e.prototype.kill=function(){this.worker&&this.worker.terminate()},e.prototype.isRunning=function(){return this.running},e}(W());const Y=function(t){return w(t,"String")};var K={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},Q=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="concentric",this.options=o(o({},K),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return[2,this.genericConcentricLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return this.genericConcentricLayout(!0,t,e),[2]}))}))},t.prototype.genericConcentricLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,s,u,h,c,l,f,g,p,m,y,w,E,b,N,M,_,A,S,k,I,T,D,R,L,P,F,G,U,V,B,q,W,H,$,X;return d(this,(function(d){if(n=o(o({},this.options),r),i=n.center,a=n.width,s=n.height,u=n.sortBy,h=n.maxLevelDiff,c=n.sweep,l=n.clockwise,f=n.equidistant,g=n.preventOverlap,p=n.startAngle,m=void 0===p?1.5*Math.PI:p,y=n.nodeSize,w=n.nodeSpacing,E=e.getAllNodes(),b=e.getAllEdges(),N=a||"undefined"==typeof window?a:window.innerWidth,M=s||"undefined"==typeof window?s:window.innerHeight,_=i||[N/2,M/2],!(null==E?void 0:E.length)||1===E.length)return[2,j(e,t,_)];if(A=[],k=0,S=v(y)?Math.max(y[0],y[1]):y,v(w)?k=Math.max(w[0],w[1]):x(w)&&(k=w),E.forEach((function(t){var e=O(t);A.push(e);var r=S,n=e.data;v(n.size)?r=Math.max(n.size[0],n.size[1]):x(n.size)?r=n.size:C(n.size)&&(r=Math.max(n.size.width,n.size.height)),S=Math.max(S,r),z(w)&&(k=Math.max(w(t),k))})),I={},A.forEach((function(t,e){I[t.id]=e})),Y(T=u)&&void 0!==A[0].data[T]||(T="degree"),"degree"===T?A.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):A.sort((function(t,e){return e.data[T]-t.data[T]})),D=A[0],R=(h||("degree"===T?e.getDegree(D.id,"both"):D.data[T]))/4,P=(L=[{nodes:[]}])[0],A.forEach((function(t){if(P.nodes.length>0){var r="degree"===T?Math.abs(e.getDegree(P.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(P.nodes[0].data[T]-t.data[T]);R&&r>=R&&(P={nodes:[]},L.push(P))}P.nodes.push(t)})),F=S+k,g||(G=L.length>0&&L[0].nodes.length>1,U=Math.min(N,M)/2-F,V=U/(L.length+(G?1:0)),F=Math.min(F,V)),B=0,L.forEach((function(t){var e=void 0===c?2*Math.PI-2*Math.PI/t.nodes.length:c;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&g){var r=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),o=Math.sqrt(F*F/(r*r+n*n));B=Math.max(o,B)}t.r=B,B+=F})),f){for(q=0,W=0,H=0;H<L.length;H++)$=L[H],X=($.r||0)-W,q=Math.max(q,X);W=0,L.forEach((function(t,e){0===e&&(W=t.r||0),t.r=W,W+=q}))}return L.forEach((function(t){var e=t.dTheta||0,r=t.r||0;t.nodes.forEach((function(t,n){var o=m+(l?1:-1)*e*n;t.data.x=_[0]+r*Math.cos(o),t.data.y=_[1]+r*Math.sin(o)}))})),t&&A.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:A,edges:b}]}))}))},t}();function Z(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i,a,s,u,d,h,c,l,f=t._root,g={data:n},p=t._x0,v=t._y0,m=t._x1,y=t._y1;if(!f)return t._root=g,t;for(;f.length;)if((d=e>=(i=(p+m)/2))?p=i:m=i,(h=r>=(a=(v+y)/2))?v=a:y=a,o=f,!(f=f[c=h<<1|d]))return o[c]=g,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&r===u)return g.next=f,o?o[c]=g:t._root=g,t;do{o=o?o[c]=new Array(4):t._root=new Array(4),(d=e>=(i=(p+m)/2))?p=i:m=i,(h=r>=(a=(v+y)/2))?v=a:y=a}while((c=h<<1|d)==(l=(u>=a)<<1|s>=i));return o[l]=f,o[c]=g,t}function J(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function tt(t){return t[0]}function et(t){return t[1]}function rt(t,e,r){var n=new nt(null==e?tt:e,null==r?et:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function nt(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function ot(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var it=rt.prototype=nt.prototype;function at(t){return function(){return t}}function st(t){return 1e-6*(t()-.5)}it.copy=function(){var t,e,r=new nt(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=ot(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var o=0;o<4;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(4)}):n.target[o]=ot(e));return r},it.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return Z(this.cover(e,r),e,r,t)},it.addAll=function(t){var e,r,n,o,i=t.length,a=new Array(i),s=new Array(i),u=1/0,d=1/0,h=-1/0,c=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(a[r]=n,s[r]=o,n<u&&(u=n),n>h&&(h=n),o<d&&(d=o),o>c&&(c=o));if(u>h||d>c)return this;for(this.cover(u,d).cover(h,c),r=0;r<i;++r)Z(this,a[r],s[r],t[r]);return this},it.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var a,s,u=o-r||1,d=this._root;r>t||t>=o||n>e||e>=i;)switch(s=(e<n)<<1|t<r,(a=new Array(4))[s]=d,d=a,u*=2,s){case 0:o=r+u,i=n+u;break;case 1:r=o-u,i=n+u;break;case 2:o=r+u,n=i-u;break;case 3:r=o-u,n=i-u}this._root&&this._root.length&&(this._root=d)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this},it.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},it.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},it.find=function(t,e,r){var n,o,i,a,s,u,d,h=this._x0,c=this._y0,l=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new J(p,h,c,l,f)),null==r?r=1/0:(h=t-r,c=e-r,l=t+r,f=e+r,r*=r);u=g.pop();)if(!(!(p=u.node)||(o=u.x0)>l||(i=u.y0)>f||(a=u.x1)<h||(s=u.y1)<c))if(p.length){var v=(o+a)/2,m=(i+s)/2;g.push(new J(p[3],v,m,a,s),new J(p[2],o,m,v,s),new J(p[1],v,i,a,m),new J(p[0],o,i,v,m)),(d=(e>=m)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-d],g[g.length-1-d]=u)}else{var y=t-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),x=y*y+w*w;if(x<r){var E=Math.sqrt(r=x);h=t-E,c=e-E,l=t+E,f=e+E,n=p.data}}return n},it.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,r,n,o,i,a,s,u,d,h,c,l,f=this._root,g=this._x0,p=this._y0,v=this._x1,m=this._y1;if(!f)return this;if(f.length)for(;;){if((d=i>=(s=(g+v)/2))?g=s:v=s,(h=a>=(u=(p+m)/2))?p=u:m=u,e=f,!(f=f[c=h<<1|d]))return this;if(!f.length)break;(e[c+1&3]||e[c+2&3]||e[c+3&3])&&(r=e,l=c)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(o=f.next)&&delete f.next,n?(o?n.next=o:delete n.next,this):e?(o?e[c]=o:delete e[c],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[l]=f:this._root=f),this):(this._root=o,this)},it.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},it.root=function(){return this._root},it.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},it.visit=function(t){var e,r,n,o,i,a,s=[],u=this._root;for(u&&s.push(new J(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,n=e.x0,o=e.y0,i=e.x1,a=e.y1)&&u.length){var d=(n+i)/2,h=(o+a)/2;(r=u[3])&&s.push(new J(r,d,h,i,a)),(r=u[2])&&s.push(new J(r,n,h,d,a)),(r=u[1])&&s.push(new J(r,d,o,i,h)),(r=u[0])&&s.push(new J(r,n,o,d,h))}return this},it.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new J(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.x1,d=e.y1,h=(a+u)/2,c=(s+d)/2;(i=o[0])&&r.push(new J(i,a,s,h,c)),(i=o[1])&&r.push(new J(i,h,s,u,c)),(i=o[2])&&r.push(new J(i,a,c,h,d)),(i=o[3])&&r.push(new J(i,h,c,u,d))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},it.x=function(t){return arguments.length?(this._x=t,this):this._x},it.y=function(t){return arguments.length?(this._y=t,this):this._y};var ut={value:()=>{}};function dt(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new ht(n)}function ht(t){this._=t}function ct(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function lt(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=ut,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}ht.prototype=dt.prototype={constructor:ht,on:function(t,e){var r,n,o=this._,i=(n=o,(t+"").trim().split(/^|\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)o[r]=lt(o[r],t.name,e);else if(null==e)for(r in o)o[r]=lt(o[r],t.name,null);return this}for(;++a<s;)if((r=(t=i[a]).type)&&(r=ct(o[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new ht(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};const ft=dt;var gt,pt,vt=0,mt=0,yt=0,wt=0,xt=0,Et=0,bt="object"==typeof performance&&performance.now?performance:Date,Nt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Mt(){return xt||(Nt(_t),xt=bt.now()+Et)}function _t(){xt=0}function At(){this._call=this._time=this._next=null}function St(t,e,r){var n=new At;return n.restart(t,e,r),n}function kt(){xt=(wt=bt.now())+Et,vt=mt=0;try{!function(){Mt(),++vt;for(var t,e=gt;e;)(t=xt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--vt}()}finally{vt=0,function(){for(var t,e,r=gt,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:gt=e);pt=t,Tt(n)}(),xt=0}}function It(){var t=bt.now(),e=t-wt;e>1e3&&(Et-=e,wt=t)}function Tt(t){vt||(mt&&(mt=clearTimeout(mt)),t-xt>24?(t<1/0&&(mt=setTimeout(kt,t-bt.now()-Et)),yt&&(yt=clearInterval(yt))):(yt||(wt=bt.now(),yt=setInterval(It,1e3)),vt=1,Nt(kt)))}At.prototype=St.prototype={constructor:At,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?Mt():+r)+(null==e?0:+e),this._next||pt===this||(pt?pt._next=this:gt=this,pt=this),this._call=t,this._time=r,Tt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Tt())}};const Dt=4294967296;function Rt(t){return t.x}function Ot(t){return t.y}var zt=Math.PI*(3-Math.sqrt(5));function Ct(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,a=.6,s=new Map,u=St(c),d=ft("tick","end"),h=function(){let t=1;return()=>(t=(1664525*t+1013904223)%Dt)/Dt}();function c(){l(),d.call("tick",e),r<n&&(u.stop(),d.call("end",e))}function l(n){var u,d,h=t.length;void 0===n&&(n=1);for(var c=0;c<n;++c)for(r+=(i-r)*o,s.forEach((function(t){t(r)})),u=0;u<h;++u)null==(d=t[u]).fx?d.x+=d.vx*=a:(d.x=d.fx,d.vx=0),null==d.fy?d.y+=d.vy*=a:(d.y=d.fy,d.vy=0);return e}function f(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var o=10*Math.sqrt(.5+r),i=r*zt;e.x=o*Math.cos(i),e.y=o*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,h),e}return null==t&&(t=[]),f(),e={tick:l,restart:function(){return u.restart(c),e},stop:function(){return u.stop(),e},nodes:function(r){return arguments.length?(t=r,f(),s.forEach(g),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(h=t,s.forEach(g),e):h},force:function(t,r){return arguments.length>1?(null==r?s.delete(t):s.set(t,g(r)),e):s.get(t)},find:function(e,r,n){var o,i,a,s,u,d=0,h=t.length;for(null==n?n=1/0:n*=n,d=0;d<h;++d)(a=(o=e-(s=t[d]).x)*o+(i=r-s.y)*i)<n&&(u=s,n=a);return u},on:function(t,r){return arguments.length>1?(d.on(t,r),e):d.on(t)}}}function Lt(){var t,e,r,n,o,i=at(-30),a=1,s=1/0,u=.81;function d(r){var o,i=t.length,a=rt(t,Rt,Ot).visitAfter(c);for(n=r,o=0;o<i;++o)e=t[o],a.visit(l)}function h(){if(t){var e,r,n=t.length;for(o=new Array(n),e=0;e<n;++e)r=t[e],o[r.index]=+i(r,e,t)}}function c(t){var e,r,n,i,a,s=0,u=0;if(t.length){for(n=i=a=0;a<4;++a)(e=t[a])&&(r=Math.abs(e.value))&&(s+=e.value,u+=r,n+=r*e.x,i+=r*e.y);t.x=n/u,t.y=i/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=o[e.data.index]}while(e=e.next)}t.value=s}function l(t,i,d,h){if(!t.value)return!0;var c=t.x-e.x,l=t.y-e.y,f=h-i,g=c*c+l*l;if(f*f/u<g)return g<s&&(0===c&&(g+=(c=st(r))*c),0===l&&(g+=(l=st(r))*l),g<a&&(g=Math.sqrt(a*g)),e.vx+=c*t.value*n/g,e.vy+=l*t.value*n/g),!0;if(!(t.length||g>=s)){(t.data!==e||t.next)&&(0===c&&(g+=(c=st(r))*c),0===l&&(g+=(l=st(r))*l),g<a&&(g=Math.sqrt(a*g)));do{t.data!==e&&(f=o[t.data.index]*n/g,e.vx+=c*f,e.vy+=l*f)}while(t=t.next)}}return d.initialize=function(e,n){t=e,r=n,h()},d.strength=function(t){return arguments.length?(i="function"==typeof t?t:at(+t),h(),d):i},d.distanceMin=function(t){return arguments.length?(a=t*t,d):Math.sqrt(a)},d.distanceMax=function(t){return arguments.length?(s=t*t,d):Math.sqrt(s)},d.theta=function(t){return arguments.length?(u=t*t,d):Math.sqrt(u)},d}function Pt(t){return t.index}function Ft(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function jt(t){var e,r,n,o,i,a,s=Pt,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},d=at(30),h=1;function c(n){for(var o=0,s=t.length;o<h;++o)for(var u,d,c,l,f,g,p,v=0;v<s;++v)d=(u=t[v]).source,l=(c=u.target).x+c.vx-d.x-d.vx||st(a),f=c.y+c.vy-d.y-d.vy||st(a),l*=g=((g=Math.sqrt(l*l+f*f))-r[v])/g*n*e[v],f*=g,c.vx-=l*(p=i[v]),c.vy-=f*p,d.vx+=l*(p=1-p),d.vy+=f*p}function l(){if(n){var a,u,d=n.length,h=t.length,c=new Map(n.map(((t,e)=>[s(t,e,n),t])));for(a=0,o=new Array(d);a<h;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=Ft(c,u.source)),"object"!=typeof u.target&&(u.target=Ft(c,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(a=0,i=new Array(h);a<h;++a)u=t[a],i[a]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);e=new Array(h),f(),r=new Array(h),g()}}function f(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+u(t[r],r,t)}function g(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+d(t[e],e,t)}return null==t&&(t=[]),c.initialize=function(t,e){n=t,a=e,l()},c.links=function(e){return arguments.length?(t=e,l(),c):t},c.id=function(t){return arguments.length?(s=t,c):s},c.iterations=function(t){return arguments.length?(h=+t,c):h},c.strength=function(t){return arguments.length?(u="function"==typeof t?t:at(+t),f(),c):u},c.distance=function(t){return arguments.length?(d="function"==typeof t?t:at(+t),g(),c):d},c}function Gt(t){return t.x+t.vx}function Ut(t){return t.y+t.vy}function Vt(t){var e,r,n,o=1,i=1;function a(){for(var t,a,u,d,h,c,l,f=e.length,g=0;g<i;++g)for(a=rt(e,Gt,Ut).visitAfter(s),t=0;t<f;++t)u=e[t],c=r[u.index],l=c*c,d=u.x+u.vx,h=u.y+u.vy,a.visit(p);function p(t,e,r,i,a){var s=t.data,f=t.r,g=c+f;if(!s)return e>d+g||i<d-g||r>h+g||a<h-g;if(s.index>u.index){var p=d-s.x-s.vx,v=h-s.y-s.vy,m=p*p+v*v;m<g*g&&(0===p&&(m+=(p=st(n))*p),0===v&&(m+=(v=st(n))*v),m=(g-(m=Math.sqrt(m)))/m*o,u.vx+=(p*=m)*(g=(f*=f)/(l+f)),u.vy+=(v*=m)*g,s.vx-=p*(g=1-g),s.vy-=v*g)}}}function s(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var n,o,i=e.length;for(r=new Array(i),n=0;n<i;++n)o=e[n],r[o.index]=+t(o,n,e)}}return"function"!=typeof t&&(t=at(null==t?1:+t)),a.initialize=function(t,r){e=t,n=r,u()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(o=+t,a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:at(+e),u(),a):t},a}function Bt(){function t(t){return function(){return t}}var e,r=function(t){return t.cluster},n=t(1),o=t(-1),i=t(100),a=t(.1),s=[0,0],u=[],d={},c=[],l=100,f=100,g={none:{x:0,y:0}},p=[],v="force",m=!0,y=.1;function w(t){if(!m)return w;e.tick(),E();for(var n=0,o=u.length,i=void 0,a=t*y;n<o;++n)(i=u[n]).vx+=(g[r(i)].x-i.x)*a,i.vy+=(g[r(i)].y-i.y)*a}function x(){u&&function(){if(u&&u.length){if(void 0===r(u[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy('clusterAttr') before calling .links()");var t,s,g,v,m,y=(t=[],s=[],g={},m=[],x={},(w=u).forEach((function(t){var e=r(t);x[e]||(x[e]={count:0,sumforceNodeSize:0})})),w.forEach((function(t){var e=r(t),o=n(t),i=x[e];i.count=i.count+1,i.sumforceNodeSize=i.sumforceNodeSize+Math.PI*(o*o)*1.3,x[e]=i})),v=x,m=function(t){var e={},n=[];return t.forEach((function(t){var n,o,i,a,s,u=(o=(n=t).source,i=n.target,(a=r(d[o]))<=(s=r(d[i]))?a+"~"+s:s+"~"+a),h=0;void 0!==e[u]&&(h=e[u]),h+=1,e[u]=h})),Object.entries(e).forEach((function(t){var e=h(t,2),r=e[0],o=e[1],i=r.split("~")[0],a=r.split("~")[1];void 0!==i&&void 0!==a&&n.push({source:i,target:a,count:o})})),n}(c),Object.keys(v).forEach((function(e,r){var n=v[e];t.push({id:e,size:n.count,r:Math.sqrt(n.sumforceNodeSize/Math.PI)}),g[e]=r})),m.forEach((function(t){var e=t.source,r=t.target,n=g[e],o=g[r];void 0!==n&&void 0!==o&&s.push({source:n,target:o,count:t.count})})),{nodes:t,links:s});e=Ct(y.nodes).force("x",function(t){var e,r,n,o=at(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=at(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:at(+t),a(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:at(+e),a(),i):t},i}(l).strength(.1)).force("y",function(t){var e,r,n,o=at(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=at(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:at(+t),a(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:at(+e),a(),i):t},i}(f).strength(.1)).force("collide",Vt((function(t){return t.r})).iterations(4)).force("charge",Lt().strength(o)).force("links",jt(y.nodes.length?y.links:[]).distance(i).strength(a)),p=e.nodes(),E()}var w,x}()}function E(){return g={none:{x:0,y:0}},p.forEach((function(t){g[t.id]={x:t.x-s[0],y:t.y-s[1]}})),g}return w.initialize=function(t){u=t,x()},w.template=function(t){return arguments.length?(v=t,x(),w):v},w.groupBy=function(t){return arguments.length?"string"==typeof t?(r=function(e){return e[t]},w):(r=t,w):r},w.enableGrouping=function(t){return arguments.length?(m=t,w):m},w.strength=function(t){return arguments.length?(y=t,w):y},w.centerX=function(t){return arguments.length?(l=t,w):l},w.centerY=function(t){return arguments.length?(f=t,w):f},w.nodes=function(t){return arguments.length?(d={},(t||[]).forEach((function(t){d[t.id]=t})),u=t||[],w):u},w.links=function(t){return arguments.length?(c=t||[],x(),w):c},w.forceNodeSize=function(e){return arguments.length?(n="function"==typeof e?e:t(+e),x(),w):n},w.nodeSize=w.forceNodeSize,w.forceCharge=function(e){return arguments.length?(o="function"==typeof e?e:t(+e),x(),w):o},w.forceLinkDistance=function(e){return arguments.length?(i="function"==typeof e?e:t(+e),x(),w):i},w.forceLinkStrength=function(e){return arguments.length?(a="function"==typeof e?e:t(+e),x(),w):a},w.offset=function(t){return arguments.length?(s=t,w):s},w.getFocis=E,w}var qt={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},Wt=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="d3force",this.options=o(o({},qt),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){var t;null===(t=this.forceSimulation)||void 0===t||t.stop()},t.prototype.tick=function(t){var e=this;void 0===t&&(t=1),this.forceSimulation.tick(t);var r={nodes:Ht(this.lastLayoutNodes),edges:$t(this.lastLayoutEdges)};return this.lastAssign&&r.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r},t.prototype.genericForceLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,s,u,h,c,l,f,g,p,v,m,y,w,x,E,b,N,M,_,A,S,k,I,T,D=this;return d(this,(function(d){return n=o(o({},this.options),r),i=e.getAllNodes(),a=e.getAllEdges(),s=i.map((function(t){var e,r;return o(o({},O(t)),{x:null===(e=t.data)||void 0===e?void 0:e.x,y:null===(r=t.data)||void 0===r?void 0:r.y})})),u=a.map((function(t){return O(t)})),this.lastLayoutNodes=s,this.lastLayoutEdges=u,this.lastAssign=t,this.lastGraph=e,h=n.alphaMin,c=n.alphaDecay,l=n.alpha,f=n.nodeStrength,g=n.edgeStrength,p=n.linkDistance,v=n.clustering,m=n.clusterFociStrength,y=n.clusterEdgeDistance,w=n.clusterEdgeStrength,x=n.clusterNodeStrength,E=n.clusterNodeSize,b=n.collideStrength,N=void 0===b?1:b,M=n.center,_=void 0===M?[0,0]:M,A=n.preventOverlap,S=n.nodeSize,k=n.nodeSpacing,I=n.onTick,T=n.forceSimulation,[2,new Promise((function(r){if(T){v&&((i=Bt()).nodes(s),i.links(u)),T.nodes(s),u&&(d=jt().id((function(t){return t.id})).links(u),g&&d.strength(g),p&&d.distance(p),T.force("link",d)),A&&D.overlapProcess(T,{nodeSize:S,nodeSpacing:k,collideStrength:N}),T.alpha(l).restart();var n=Ht(s),o=$t(u);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:o})}else try{var i,a=Lt();if(f&&a.strength(f),T=Ct().nodes(s),v&&((i=Bt()).centerX(_[0]).centerY(_[1]).template("force").strength(m),u&&i.links(u),s&&i.nodes(s),i.forceLinkDistance(y).forceLinkStrength(w).forceCharge(x).forceNodeSize(E),T.force("group",i)),T.force("center",function(t,e){var r,n=1;function o(){var o,i,a=r.length,s=0,u=0;for(o=0;o<a;++o)s+=(i=r[o]).x,u+=i.y;for(s=(s/a-t)*n,u=(u/a-e)*n,o=0;o<a;++o)(i=r[o]).x-=s,i.y-=u}return null==t&&(t=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(n=+t,o):n},o}(_[0],_[1])).force("charge",a).alpha(l).alphaDecay(c).alphaMin(h),A&&D.overlapProcess(T,{nodeSize:S,nodeSpacing:k,collideStrength:N}),u){var d=jt().id((function(t){return t.id})).links(u);g&&d.strength(g),p&&d.distance(p),T.force("link",d)}T.on("tick",(function(){var r=Ht(s);null==I||I({nodes:r,edges:$t(u)}),t&&r.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}))})).on("end",(function(){var n=Ht(s);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:$t(u)})}))}catch(b){console.warn(b)}D.forceSimulation=T}))]}))}))},t.prototype.overlapProcess=function(t,e){var r,n,o=e.nodeSize,i=e.nodeSpacing,a=e.collideStrength;if(n=x(i)?function(){return i}:z(i)?i:function(){return 0},o)if(z(o))r=function(t){return o(t)+n(t)};else if(v(o)){var s=(o[0]>o[1]?o[0]:o[1])/2;r=function(t){return s+n(t)}}else if(x(o)){var u=o/2;r=function(t){return u+n(t)}}else r=function(){return 10};else r=function(t){return t.size?v(t.size)?(t.size[0]>t.size[1]?t.size[0]:t.size[1])/2+n(t):C(t.size)?(t.size.width>t.size.height?t.size.width:t.size.height)/2+n(t):t.size/2+n(t):10+n(t)};t.force("collisionForce",Vt(r).strength(a))},t}(),Ht=function(t){return t.map((function(t){var e=t.x,r=t.y,n=i(t,["x","y"]);return o(o({},n),{data:o(o({},n.data),{x:e,y:r})})}))},$t=function(t){return t.map((function(t){var e=t.source,r=t.target,n=i(t,["source","target"]);return o(o({},n),{source:e.id,target:r.id})}))};const Xt=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[],i=this._events["*"]||[],a=function(n){for(var o=n.length,i=0;i<o;i++)if(n[i]){var a=n[i],s=a.callback;a.once&&(n.splice(i,1),0===n.length&&delete e._events[t],o--,i--),s.apply(e,r)}};a(o),a(i)},t.prototype.off=function(t,e){if(t)if(e){for(var r=this._events[t]||[],n=r.length,o=0;o<n;o++)r[o].callback===e&&(r.splice(o,1),n--,o--);0===r.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function Yt(t,e,r,n){for(;t.length;){const o=t.shift();if(r(o))return!0;e.add(o.id),n(o.id).forEach((r=>{e.has(r.id)||(e.add(r.id),t.push(r))}))}return!1}function Kt(t,e,r,n){if(r(t))return!0;e.add(t.id);for(const o of n(t.id))if(!e.has(o.id)&&Kt(o,e,r,n))return!0;return!1}class Qt extends Xt{constructor(t){r(this,"nodeMap",new Map),r(this,"edgeMap",new Map),r(this,"inEdgesMap",new Map),r(this,"outEdgesMap",new Map),r(this,"bothEdgesMap",new Map),r(this,"treeIndices",new Map),r(this,"changes",[]),r(this,"batchCount",0),r(this,"onChanged",(()=>{})),r(this,"batch",(t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()})),super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const r=e.find((e=>e.type===t.type&&e.id===t.id&&e.propertyName===t.propertyName));r?r.newValue=t.newValue:e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const r=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),r=this.bothEdgesMap.get(t);null==r||r.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((e=>{var r;null==(r=e.childrenMap.get(t))||r.forEach((t=>{e.parentMap.delete(t.id)})),e.parentMap.delete(t),e.childrenMap.delete(t)})),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){const n=this.getNode(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateNodeDataProperty(t,e,r)}))}))}updateNodeData(...t){const e=t[0],r=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:o})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),o.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),o=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),o.delete(e),i.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.source,o=e;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:o})}))}updateEdgeTarget(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.target,o=e;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:o})}))}updateEdgeDataProperty(t,e,r){const n=this.getEdge(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}updateEdgeData(...t){const e=t[0],r=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:o})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateEdgeDataProperty(t,e,r)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const r=[],n=Array.isArray(t)?t:[t];for(;n.length;){const t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach((t=>{var r;null==(r=t.children)||r.forEach((r=>{this.setParent(r.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const r=this.treeIndices.get(e).childrenMap.get(t);return Array.from(r||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const r=[];let n,o=this.getNode(t);for(;n=this.getParent(o.id,e);)r.push(n),o=n;return r}setParent(t,e,r){var n;this.checkTreeExistence(r);const o=this.treeIndices.get(r),i=this.getNode(t),a=o.parentMap.get(t),s=this.getNode(e);o.parentMap.set(t,s),a&&(null==(n=o.childrenMap.get(a.id))||n.delete(i));let u=o.childrenMap.get(s.id);u||(u=new Set,o.childrenMap.set(s.id,u)),u.add(i),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:null==a?void 0:a.id,newParentId:s.id})}))}dfsTree(t,e,r){return Kt(this.getNode(t),new Set,e,(t=>this.getChildren(t,r)))}bfsTree(t,e,r){return Yt([this.getNode(t)],new Set,e,(t=>this.getChildren(t,r)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return Yt([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return Kt(this.getNode(t),new Set,e,n)}clone(){const t=this.getAllNodes().map((t=>e(e({},t),{data:e({},t.data)}))),r=this.getAllEdges().map((t=>e(e({},t),{data:e({},t.data)}))),n=new Qt({nodes:t,edges:r});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},r)=>{const o=new Map;t.forEach(((t,e)=>{o.set(e,n.getNode(t.id))}));const i=new Map;e.forEach(((t,e)=>{i.set(e,new Set(Array.from(t).map((t=>n.getNode(t.id)))))})),n.treeIndices.set(r,{parentMap:o,childrenMap:i})})),n}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var Zt=function(t,e){if("next"!==t&&"prev"!==t)return e},Jt=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},te=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(function(){function t(){var t={};t.prev=t,t.next=t.prev,this.shortcut=t}return t.prototype.dequeue=function(){var t=this.shortcut,e=t.prev;if(e&&e!==t)return Jt(e),e},t.prototype.enqueue=function(t){var e=this.shortcut;t.prev&&t.next&&Jt(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e},t.prototype.toString=function(){for(var t=[],e=this.shortcut,r=e.prev;r!==e;)t.push(JSON.stringify(r,Zt)),r=null==r?void 0:r.prev;return"["+t.join(", ")+"]"},t}()),ee=function(t,e,r,n,i){var a,s,u=[];return t.hasNode(n.v)&&(null===(a=t.getRelatedEdges(n.v,"in"))||void 0===a||a.forEach((function(n){var a=n.data.weight,s=t.getNode(n.source);i&&u.push({v:n.source,w:n.target,in:0,out:0}),void 0===s.data.out&&(s.data.out=0),s.data.out-=a,re(e,r,o({v:s.id},s.data))})),null===(s=t.getRelatedEdges(n.v,"out"))||void 0===s||s.forEach((function(n){var i=n.data.weight,a=n.target,s=t.getNode(a);void 0===s.data.in&&(s.data.in=0),s.data.in-=i,re(e,r,o({v:s.id},s.data))})),t.removeNode(n.v)),i?u:void 0},re=function(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},ne=function(t,e,r,n){var o;do{o=""+n+Math.random()}while(t.hasNode(o));return r.dummy=e,t.addNode({id:o,data:r}),o},oe=function(t){var e=new Qt;return t.getAllNodes().forEach((function(r){t.getChildren(r.id).length||e.addNode(o({},r))})),t.getAllEdges().forEach((function(t){e.addEdge(t)})),e},ie=function(t,e){var r,n,o=Number(t.x),i=Number(t.y),a=Number(e.x)-o,s=Number(e.y)-i,u=Number(t.width)/2,d=Number(t.height)/2;return a||s?(Math.abs(s)*u>Math.abs(a)*d?(s<0&&(d=-d),r=d*a/s,n=d):(a<0&&(u=-u),r=u,n=u*s/a),{x:o+r,y:i+n}):{x:0,y:0}},ae=function(t){for(var e=[],r=ue(t)+1,n=0;n<r;n++)e.push([]);for(t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)})),n=0;n<r;n++)e[n]=e[n].sort((function(e,r){return n=t.getNode(e).data.order,o=t.getNode(r).data.order,Number(n)-Number(o);var n,o}));return e},se=function(t,e,r,n){var o={width:0,height:0};return x(r)&&x(n)&&(o.rank=r,o.order=n),ne(t,"border",o,e)},ue=function(t){var e;return t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)})),e||(e=0),e},de=function(t,e){return t.reduce((function(t,r){return e(t)>e(r)?r:t}))},he=function(t,e,r,n,o,i){n.includes(e.id)||(n.push(e.id),r||i.push(e.id),o(e.id).forEach((function(e){return he(t,e,r,n,o,i)})),r&&i.push(e.id))},ce=function(t,e,r,n){var o=Array.isArray(e)?e:[e],i=function(e){return n?t.getSuccessors(e):t.getNeighbors(e)},a=[],s=[];return o.forEach((function(e){if(!t.hasNode(e.id))throw new Error("Graph does not have node: "+e);he(t,e,"post"===r,s,i,a)})),a},le="edge-label",fe=function(t){var e={},r=function(n){var o,i,a=t.getNode(n);return a?e[n]?a.data.rank:(e[n]=!0,null===(o=t.getRelatedEdges(n,"out"))||void 0===o||o.forEach((function(t){var e=r(t.target)-t.data.minlen;e&&(void 0===i||e<i)&&(i=e)})),i||(i=0),a.data.rank=i,i):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){return r(t.id)}))},ge=function(t,e){return t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen},pe=function(t,e){var r=function(n){e.getRelatedEdges(n,"both").forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||ge(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ve=function(t,e){var r=function(n){var o;null===(o=e.getRelatedEdges(n,"both"))||void 0===o||o.forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||void 0===e.getNode(a).data.layer&&ge(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},me=function(t,e){return de(e.getAllEdges(),(function(r){return t.hasNode(r.source)!==t.hasNode(r.target)?ge(e,r):1/0}))},ye=function(t,e,r){t.getAllNodes().forEach((function(t){var n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r}))},we=function(t,e){var r=ce(t,t.getAllNodes(),"post",!1);(r=r.slice(0,(null==r?void 0:r.length)-1)).forEach((function(r){xe(t,e,r)}))},xe=function(t,e,r){var n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find((function(t){return t.target===n||t.source===n})).data.cutvalue=Ee(t,e,r)},Ee=function(t,e,r){var n=t.getNode(r).data.parent,o=!0,i=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),a=0;return i||(o=!1,i=e.getRelatedEdges(n,"out").find((function(t){return t.target===r}))),a=i.data.weight,e.getRelatedEdges(r,"both").forEach((function(e){var i=e.source===r,s=i?e.target:e.source;if(s!==n){var u=i===o,d=e.data.weight;if(a+=u?d:-d,ke(t,r,s)){var h=t.getRelatedEdges(r,"both").find((function(t){return t.source===s||t.target===s})).data.cutvalue;a+=u?-h:h}}})),a},be=function(t,e){void 0===e&&(e=t.getAllNodes()[0].id),Ne(t,{},1,e)},Ne=function(t,e,r,n,o){var i,a=r,s=r,u=t.getNode(n);return e[n]=!0,null===(i=t.getNeighbors(n))||void 0===i||i.forEach((function(r){e[r.id]||(s=Ne(t,e,s,r.id,n))})),u.data.low=a,u.data.lim=s++,o?u.data.parent=o:delete u.data.parent,s},Me=function(t){return t.getAllEdges().find((function(t){return t.data.cutvalue<0}))},_e=function(t,e,r){var n=r.source,o=r.target;e.getRelatedEdges(n,"out").find((function(t){return t.target===o}))||(n=r.target,o=r.source);var i=t.getNode(n),a=t.getNode(o),s=i,u=!1;i.data.lim>a.data.lim&&(s=a,u=!0);var d=e.getAllEdges().filter((function(e){return u===Ie(t.getNode(e.source),s)&&u!==Ie(t.getNode(e.target),s)}));return de(d,(function(t){return ge(e,t)}))},Ae=function(t,e,r,n){var o=t.getRelatedEdges(r.source,"both").find((function(t){return t.source===r.target||t.target===r.target}));o&&t.removeEdge(o.id),t.addEdge({id:"e"+Math.random(),source:n.source,target:n.target,data:{}}),be(t),we(t,e),Se(t,e)},Se=function(t,e){var r=t.getAllNodes().find((function(t){return!t.data.parent})),n=ce(t,r,"pre",!1);(n=n.slice(1)).forEach((function(r){var n=t.getNode(r).data.parent,o=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),i=!1;!o&&e.hasNode(n)&&(o=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),i=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(i?null==o?void 0:o.data.minlen:-(null==o?void 0:o.data.minlen))}))},ke=function(t,e,r){return t.getRelatedEdges(e,"both").find((function(t){return t.source===r||t.target===r}))},Ie=function(t,e){return e.data.low<=t.data.lim&&t.data.lim<=e.data.lim},Te=fe,De=function(t,e,r,n,o,i,a){var s=t.getChildren(a);if(null==s?void 0:s.length){var u=se(t,"_bt"),d=se(t,"_bb"),h=t.getNode(a);t.setParent(u,a),h.data.borderTop=u,t.setParent(d,a),h.data.borderBottom=d,null==s||s.forEach((function(s){De(t,e,r,n,o,i,s.id);var h=s.data.borderTop?s.data.borderTop:s.id,c=s.data.borderBottom?s.data.borderBottom:s.id,l=s.data.borderTop?n:2*n,f=h!==c?1:o-i[a]+1;t.addEdge({id:"e"+Math.random(),source:u,target:h,data:{minlen:f,weight:l,nestingEdge:!0}}),t.addEdge({id:"e"+Math.random(),source:c,target:d,data:{minlen:f,weight:l,nestingEdge:!0}})})),t.getParent(a)||t.addEdge({id:"e"+Math.random(),source:e,target:u,data:{weight:0,minlen:o+i[a]}})}else a!==e&&t.addEdge({id:"e"+Math.random(),source:e,target:a,data:{weight:0,minlen:r}})},Re=function(t,e,r,n,o,i){var a={rank:i,borderType:e,width:0,height:0},s=o.data[e][i-1],u=ne(t,"border",a,r);o.data[e][i]=u,t.setParent(u,n),s&&t.addEdge({id:"e"+Math.random(),source:s,target:u,data:{weight:1}})},Oe=function(t){t.getAllNodes().forEach((function(t){ze(t)})),t.getAllEdges().forEach((function(t){ze(t)}))},ze=function(t){var e=t.data.width;t.data.width=t.data.height,t.data.height=e},Ce=function(t){(null==t?void 0:t.y)&&(t.y=-t.y)},Le=function(t){var e=t.x;t.x=t.y,t.y=e},Pe=function(t){for(var e={},r=t.getAllNodes(),n=r.map((function(t){var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),o=Math.max.apply(Math,c([],h(n))),i=[],a=0;a<o+1;a++)i.push([]);var s=r.sort((function(e,r){return t.getNode(e.id).data.rank-t.getNode(r.id).data.rank})),u=s.filter((function(e){return void 0!==t.getNode(e.id).data.fixorder})).sort((function(e,r){return t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder}));return null==u||u.forEach((function(r){isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0})),null==s||s.forEach((function(r){return t.dfsTree(r.id,(function(t){if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)}))})),i},Fe=function(t,e,r){for(var n=function(t,e){return null==t?void 0:t.reduce((function(t,r,n){return t[r]=e[n],t}),{})}(r,r.map((function(t,e){return e}))),o=e.map((function(e){var r=t.getRelatedEdges(e,"out").map((function(t){return{pos:n[t.target]||0,weight:t.data.weight}}));return null==r?void 0:r.sort((function(t,e){return t.pos-e.pos}))})).flat().filter((function(t){return void 0!==t})),i=1;i<r.length;)i<<=1;var a=2*i-1;i-=1;var s=Array(a).fill(0,0,a),u=0;return null==o||o.forEach((function(t){if(t){var e=t.pos+i;s[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=s[e+1]),s[e=e-1>>1]+=t.weight;u+=t.weight*r}})),u},je=function(t,e){for(var r=0,n=1;n<(null==e?void 0:e.length);n+=1)r+=Fe(t,e[n-1],e[n]);return r},Ge=function(t,e,r){for(var n,o=r;e.length&&(n=e[e.length-1]).i<=o;)e.pop(),null==t||t.push(n.vs),o++;return o},Ue=function(t,e,r,n,o,i){var a,s,u,d,h=t.getChildren(e).map((function(t){return t.id})),c=t.getNode(e),l=c?c.data.borderLeft:void 0,f=c?c.data.borderRight:void 0,g={};l&&(h=null==h?void 0:h.filter((function(t){return t!==l&&t!==f})));var p,v=(p=t,(h||[]).map((function(t){var e=p.getRelatedEdges(t,"in");if(!(null==e?void 0:e.length))return{v:t};var r={sum:0,weight:0};return null==e||e.forEach((function(t){var e=p.getNode(t.source);r.sum+=t.data.weight*e.data.order,r.weight+=t.data.weight})),{v:t,barycenter:r.sum/r.weight,weight:r.weight}})));null==v||v.forEach((function(e){var o;if(null===(o=t.getChildren(e.v))||void 0===o?void 0:o.length){var a=Ue(t,e.v,r,n,i);g[e.v]=a,a.hasOwnProperty("barycenter")&&Be(e,a)}}));var m=function(t,e){var r,n,o,i={};return null==t||t.forEach((function(t,e){i[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};var r=i[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)})),null===(r=e.getAllEdges())||void 0===r||r.forEach((function(t){var e=i[t.source],r=i[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(i[t.target]))})),function(t){for(var e,r,n=[],o=function(){var o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach((function(t){return(e=o,function(t){var r,n,o,i,a;t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&(n=t,i=0,a=0,(r=e).weight&&(i+=r.barycenter*r.weight,a+=r.weight),n.weight&&(i+=n.barycenter*n.weight,a+=n.weight),r.vs=null===(o=n.vs)||void 0===o?void 0:o.concat(r.vs),r.barycenter=i/a,r.weight=a,r.i=Math.min(n.i,r.i),n.merged=!0)})(t);var e})),null===(r=o.out)||void 0===r||r.forEach((function(e){return(r=o,function(e){e.in.push(r),0==--e.indegree&&t.push(e)})(e);var r}))};null==t?void 0:t.length;)o();var i=n.filter((function(t){return!t.merged})),a=["vs","i","barycenter","weight"];return i.map((function(t){var e={};return null==a||a.forEach((function(r){void 0!==t[r]&&(e[r]=t[r])})),e}))}(null===(o=(n=Object.values(i)).filter)||void 0===o?void 0:o.call(n,(function(t){return!t.indegree})))}(v,r);Ve(m,g),null===(a=m.filter((function(t){return t.vs.length>0})))||void 0===a||a.forEach((function(e){var r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)}));var y=function(t,e,r,n){var o,i,a=(i={lhs:[],rhs:[]},null==(o=t)||o.forEach((function(t){var e,r;r=(e=t).hasOwnProperty("fixorder")&&!isNaN(e.fixorder),(n?!r&&e.hasOwnProperty("barycenter"):r||e.hasOwnProperty("barycenter"))?i.lhs.push(t):i.rhs.push(t)})),i),s=a.lhs,u=a.rhs.sort((function(t,e){return-t.i- -e.i})),d=[],h=0,c=0,l=0;null==s||s.sort(function(t,e){return function(r,n){if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i}}(!!e,!!r)),l=Ge(d,u,l),null==s||s.forEach((function(t){var e;l+=null===(e=t.vs)||void 0===e?void 0:e.length,d.push(t.vs),h+=t.barycenter*t.weight,c+=t.weight,l=Ge(d,u,l)}));var f={vs:d.flat()};return c&&(f.barycenter=h/c,f.weight=c),f}(m,n,o,i);if(l&&(y.vs=[l,y.vs,f].flat(),null===(s=t.getPredecessors(l))||void 0===s?void 0:s.length)){var w=t.getNode((null===(u=t.getPredecessors(l))||void 0===u?void 0:u[0].id)||""),x=t.getNode((null===(d=t.getPredecessors(f))||void 0===d?void 0:d[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+w.data.order+x.data.order)/(y.weight+2),y.weight+=2}return y},Ve=function(t,e){null==t||t.forEach((function(t){var r,n=null===(r=t.vs)||void 0===r?void 0:r.map((function(t){return e[t]?e[t].vs:t}));t.vs=n.flat()}))},Be=function(t,e){void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},qe=function(t){if("object"!=typeof t||null===t)return t;var e,r;if(r=t,Array.isArray?Array.isArray(r):w(r,"Array")){e=[];for(var n=0,o=t.length;n<o;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=qe(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=qe(t[i]):e[i]=t[i];return e};const We=qe;var He=function(t,e,r){return e.map((function(e){return i=e,a=r,s=function(t){for(var e;t.hasNode(e="_root"+Math.random()););return e}(n=t),u=new Qt({tree:[{id:s,children:[],data:{}}]}),n.getAllNodes().forEach((function(t){var e=n.getParent(t.id);(t.data.rank===i||t.data.minRank<=i&&i<=t.data.maxRank)&&(u.hasNode(t.id)||u.addNode(o({},t)),(null==e?void 0:e.id)&&!u.hasNode(null==e?void 0:e.id)&&u.addNode(o({},e)),u.setParent(t.id,(null==e?void 0:e.id)||s),n.getRelatedEdges(t.id,a).forEach((function(e){var r=e.source===t.id?e.target:e.source;u.hasNode(r)||u.addNode(o({},n.getNode(r)));var i=u.getRelatedEdges(r,"out").find((function(e){return e.target===t.id})),a=void 0!==i?i.data.weight:0;i?u.updateEdgeData(i.id,o(o({},i.data),{weight:e.data.weight+a})):u.addEdge({id:e.id,source:r,target:t.id,data:{weight:e.data.weight+a}})})),t.data.hasOwnProperty("minRank")&&u.updateNodeData(t.id,o(o({},t.data),{borderLeft:t.data.borderLeft[i],borderRight:t.data.borderRight[i]})))})),u;var n,i,a,s,u}))},$e=function(t,e,r,n){var o=new Qt;null==t||t.forEach((function(t){for(var i,a=t.getRoots()[0].id,s=Ue(t,a,o,e,r,n),u=0;u<(null===(i=s.vs)||void 0===i?void 0:i.length);u++){var d=t.getNode(s.vs[u]);d&&(d.data.order=u)}var h,c,l,f,g;h=t,c=o,l=s.vs,g={},null==l||l.forEach((function(t){for(var e,r,n=h.getParent(t);n;){if((e=h.getParent(n.id))?(r=g[e.id],g[e.id]=n.id):(r=f,f=n.id),r&&r!==n.id)return c.addNodes([{id:r,data:{}},{id:n.id,data:{}}]),void c.addEdge({id:"e"+r+"-"+n.id,source:r,target:n.id,data:{}});n=e}}))}))},Xe=function(t,e){null==e||e.forEach((function(e){null==e||e.forEach((function(e,r){t.getNode(e).data.order=r}))}))},Ye=function(t,e,r){var n=e,o=r;if(n>o){var i=n;n=o,o=i}var a=t[n];a||(t[n]=a={}),a[o]=!0},Ke=function(t,e,r){var n=e;return n>r&&(n=r),!!t[n]},Qe=function(t,e,r){return function(n,o,i){var a=n.getNode(o),s=n.getNode(i),u=0,d=0;if(u+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":d=-a.data.width/2;break;case"r":d=a.data.width/2}if(d&&(u+=r?d:-d),d=0,u+=(a.data.dummy?e:t)/2,u+=(s.data.dummy?e:t)/2,u+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":d=s.data.width/2;break;case"r":d=-s.data.width/2}return d&&(u+=r?d:-d),d=0,u}},Ze=function(t,e){var r,n,i,a,s,u,d,l=e.acyclicer,f=e.ranker,g=e.rankdir,p=void 0===g?"tb":g,v=e.nodeOrder,m=e.keepNodeOrder,y=e.align,w=e.nodesep,x=void 0===w?50:w,E=e.edgesep,b=void 0===E?20:E,N=e.ranksep,M=void 0===N?50:N;lr(t),r=t,null==(d="greedy"===l?function(t,e){var r;if(t.getAllNodes().length<=1)return[];var n=function(t,e){var r=new Qt,n=0,i=0;t.getAllNodes().forEach((function(t){r.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((function(t){var a=r.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target})),s=(null==e?void 0:e(t))||1;a?r.updateEdgeData(null==a?void 0:a.id,o(o({},a.data),{weight:a.data.weight+s})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:s}}),i=Math.max(i,r.getNode(t.source).data.out+=s),n=Math.max(n,r.getNode(t.target).data.in+=s)}));for(var a=[],s=i+n+3,u=0;u<s;u++)a.push(new te);var d=n+1;return r.getAllNodes().forEach((function(t){re(a,d,o({v:t.id},r.getNode(t.id).data))})),{buckets:a,zeroIdx:d,graph:r}}(t,(function(t){return t.data.weight||1}));return null===(r=function(t,e,r){for(var n,o=[],i=e[e.length-1],a=e[0];t.getAllNodes().length;){for(;n=a.dequeue();)ee(t,e,r,n);for(;n=i.dequeue();)ee(t,e,r,n);if(t.getAllNodes().length)for(var s=e.length-2;s>0;--s)if(n=e[s].dequeue()){o=o.concat(ee(t,e,r,n,!0));break}}return o}(n.graph,n.buckets,n.zeroIdx).map((function(e){return t.getRelatedEdges(e.v,"out").filter((function(t){return t.target===e.w}))})))||void 0===r?void 0:r.flat()}(r):(i=[],a={},s={},u=function(t){s[t]||(s[t]=!0,a[t]=!0,n.getRelatedEdges(t,"out").forEach((function(t){a[t.target]?i.push(t):u(t.target)})),delete a[t])},(n=r).getAllNodes().forEach((function(t){return u(t.id)})),i))||d.forEach((function(t){var e=t.data;r.removeEdge(t.id),e.forwardName=t.data.name,e.reversed=!0,r.addEdge({id:t.id,source:t.target,target:t.source,data:o({},e)})}));var _=function(t){var e=ne(t,"root",{},"_root"),r=function(t){var e={},r=function(n,o){var i=t.getChildren(n);null==i||i.forEach((function(t){return r(t.id,o+1)})),e[n]=o};return t.getRoots().forEach((function(t){return r(t.id,1)})),e}(t),n=Math.max.apply(Math,c([],h(Object.values(r))));Math.abs(n)===1/0&&(n=1);var o=n-1,i=2*o+1;t.getAllEdges().forEach((function(t){t.data.minlen*=i}));var a=function(t){var e=0;return t.getAllEdges().forEach((function(t){e+=t.data.weight})),e}(t)+1;return t.getRoots().forEach((function(n){De(t,e,i,a,o,r,n.id)})),{nestingRoot:e,nodeRankFactor:i}}(t),A=_.nestingRoot,S=_.nodeRankFactor;!function(t,e){switch(e){case"network-simplex":!function(t){!function(t){var e,r,n=(e=t,r=new Qt,e.getAllNodes().forEach((function(t){r.addNode(o({},t))})),e.getAllEdges().forEach((function(t){var e=r.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target}));e?r.updateEdgeData(null==e?void 0:e.id,o(o({},e.data),{weight:e.data.weight+t.data.weight||0,minlen:Math.max(e.data.minlen,t.data.minlen||1)})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),r);fe(n);var i,a,s=function(t){var e,r,n=new Qt({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);pe(n,t)<i;)e=me(n,t),r=n.hasNode(e.source)?ge(t,e):-ge(t,e),ye(n,t,r);return n}(n);for(be(s),we(s,n);i=Me(s);)a=_e(s,n,i),Ae(s,n,i,a)}(t)}(t);break;case"tight-tree":default:!function(t){!function(t){var e,r={},n=function(o){var i,a,s=t.getNode(o);return s?r[o]?s.data.rank:(r[o]=!0,null===(i=t.getRelatedEdges(o,"out"))||void 0===i||i.forEach((function(t){var e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),(void 0===e||a<e)&&(e=a),s.data.rank=a,a):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){t&&n(t.id)})),void 0===e&&(e=0);var o={},i=function(e,r){var n,a=t.getNode(e),s=isNaN(a.data.layer)?r:a.data.layer;(void 0===a.data.rank||a.data.rank<s)&&(a.data.rank=s),o[e]||(o[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach((function(t){i(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((function(t){var r=t.data;r&&(isNaN(r.layer)?r.rank-=e:i(t.id,r.layer))}))}(t),function(t){var e,r,n=new Qt({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);ve(n,t)<i;)e=me(n,t),r=n.hasNode(e.source)?ge(t,e):-ge(t,e),ye(n,t,r)}(t)}(t);break;case"longest-path":Te(t)}}(oe(t),f),or(t),function(t,e){void 0===e&&(e=0);var r=t.getAllNodes(),n=r.filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),o=Math.min.apply(Math,c([],h(n))),i=[];r.forEach((function(t){var e=(t.data.rank||0)-o;i[e]||(i[e]=[]),i[e].push(t.id)}));for(var a=0,s=0;s<i.length;s++){var u=i[s];void 0===u?s%e!=0&&(a-=1):a&&(null==u||u.forEach((function(e){var r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=a)})))}}(t,S),function(t,e){e&&t.removeNode(e),t.getAllEdges().forEach((function(e){e.data.nestingEdge&&t.removeEdge(e.id)}))}(t,A),function(t){var e=t.getAllNodes().filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),r=Math.min.apply(Math,c([],h(e)));t.getAllNodes().forEach((function(t){t.data.hasOwnProperty("rank")&&r!==1/0&&(t.data.rank-=r)}))}(t),ir(t),ar(t);var k=[];!function(t,e){t.getAllEdges().forEach((function(r){return function(t,e,r){var n=e.source,o=t.getNode(n).data.rank,i=e.target,a=t.getNode(i).data.rank,s=e.data.labelRank;if(a!==o+1){var u,d,h;for(t.removeEdge(e.id),h=0,++o;o<a;++h,++o)e.data.points=[],u=ne(t,"edge",d={originalEdge:e,width:0,height:0,rank:o},"_d"),o===s&&(d.width=e.data.width,d.height=e.data.height,d.dummy=le,d.labelpos=e.data.labelpos),t.addEdge({id:"e"+Math.random(),source:n,target:u,data:{weight:e.data.weight}}),0===h&&r.push(u),n=u;t.addEdge({id:"e"+Math.random(),source:n,target:i,data:{weight:e.data.weight}})}}(t,r,e)}))}(t,k),function(t,e){var r=function(t){var e={},r=0,n=function(o){var i=r;t.getChildren(o).forEach((function(t){return n(t.id)})),e[o]={low:i,lim:r++}};return t.getRoots().forEach((function(t){return n(t.id)})),e}(t);e.forEach((function(e){var n,o,i=e,a=t.getNode(i),s=a.data.originalEdge;if(s)for(var u=function(t,e,r,n){var o,i,a,s,u=[],d=[],h=Math.min(e[r].low,e[n].low),c=Math.max(e[r].lim,e[n].lim);a=r;do{a=null===(o=t.getParent(a))||void 0===o?void 0:o.id,u.push(a)}while(a&&(e[a].low>h||c>e[a].lim));for(s=a,a=n;a&&a!==s;)d.push(a),a=null===(i=t.getParent(a))||void 0===i?void 0:i.id;return{lca:s,path:u.concat(d.reverse())}}(t,r,s.source,s.target),d=u.path,h=u.lca,c=0,l=d[c],f=!0;i!==s.target;){if(a=t.getNode(i),f){for(;l!==h&&(null===(n=t.getNode(l))||void 0===n?void 0:n.data.maxRank)<a.data.rank;)l=d[++c];l===h&&(f=!1)}if(!f){for(;c<d.length-1&&(null===(o=t.getNode(d[c+1]))||void 0===o?void 0:o.data.minRank)<=a.data.rank;)c++;l=d[c]}t.hasNode(l)&&t.setParent(i,l),i=t.getSuccessors(i)[0].id}}))}(t,k),function(t){var e=function(r){var n=t.getChildren(r),o=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach((function(t){return e(t.id)})),o.data.hasOwnProperty("minRank")){o.data.borderLeft=[],o.data.borderRight=[];for(var i=o.data.minRank,a=o.data.maxRank+1;i<a;i+=1)Re(t,"borderLeft","_bl",r,o,i),Re(t,"borderRight","_br",r,o,i)}};t.getRoots().forEach((function(t){return e(t.id)}))}(t),m&&function(t,e){for(var r=t.getAllNodes().filter((function(e){var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)})).map((function(t){return t.data.rank})),n=Math.max.apply(Math,c([],h(r))),o=[],i=0;i<n+1;i++)o[i]=[];null==e||e.forEach((function(e){var r=t.getNode(e);r&&!r.data.dummy&&(isNaN(r.data.rank)||(r.data.fixorder=o[r.data.rank].length,o[r.data.rank].push(e)))}))}(t,v),function(t,e){for(var r=ue(t),n=[],o=[],i=1;i<r+1;i++)n.push(i);for(i=r-1;i>-1;i--)o.push(i);var a=He(t,n,"in"),s=He(t,o,"out"),u=Pe(t);Xe(t,u);for(var d,h=Number.POSITIVE_INFINITY,c=(i=0,0);c<4;++i,++c)$e(i%2?a:s,i%4>=2,!1,e),u=ae(t),(l=je(t,u))<h&&(c=0,d=We(u),h=l);for(u=Pe(t),Xe(t,u),i=0,c=0;c<4;++i,++c){var l;$e(i%2?a:s,i%4>=2,!0,e),u=ae(t),(l=je(t,u))<h&&(c=0,d=We(u),h=l)}Xe(t,d)}(t,m),fr(t),function(t,e){var r=e.toLowerCase();"lr"!==r&&"rl"!==r||Oe(t)}(t,p),function(t,e){var r,n=oe(t);!function(t,e){var r=(e||{}).ranksep,n=void 0===r?0:r,o=ae(t),i=0;null==o||o.forEach((function(e){var r=e.map((function(e){return t.getNode(e).data.height})),o=Math.max.apply(Math,c(c([],h(r)),[0]));null==e||e.forEach((function(e){t.getNode(e).data.y=i+o/2})),i+=o+n}))}(n,e);var i=function(t,e){var r,n,i,a=e||{},s=a.align,u=a.nodesep,d=void 0===u?0:u,l=a.edgesep,f=void 0===l?0:l,g=ae(t),p=Object.assign((r=t,i={},(null==(n=g)?void 0:n.length)&&n.reduce((function(t,e){var n=0,o=0,a=t.length,s=null==e?void 0:e[(null==e?void 0:e.length)-1];return null==e||e.forEach((function(t,u){var d,h=function(t,e){var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find((function(e){return t.getNode(e.id).data.dummy}))}(r,t),c=h?r.getNode(h.id).data.order:a;(h||t===s)&&(null===(d=e.slice(o,u+1))||void 0===d||d.forEach((function(t){var e;null===(e=r.getPredecessors(t))||void 0===e||e.forEach((function(e){var o,a=r.getNode(e.id),s=a.data.order;!(s<n||c<s)||a.data.dummy&&(null===(o=r.getNode(t))||void 0===o?void 0:o.data.dummy)||Ye(i,e.id,t)}))})),o=u+1,n=c)})),e})),i),function(t,e){var r={};function n(e,n,o,i,a){for(var s,u,d,h=n;h<o;h++)d=e[h],(null===(s=t.getNode(d))||void 0===s?void 0:s.data.dummy)&&(null===(u=t.getPredecessors(d))||void 0===u||u.forEach((function(e){var n=t.getNode(e.id);n.data.dummy&&(n.data.order<i||n.data.order>a)&&Ye(r,e.id,d)})))}function o(t,e){var r,o=(r=t,JSON.stringify(r.slice(1)));e.get(o)||(n.apply(void 0,c([],h(t))),e.set(o,!0))}return(null==e?void 0:e.length)&&e.reduce((function(e,r){var n,i=-1,a=0,s=new Map;return null==r||r.forEach((function(u,d){var h;if("border"===(null===(h=t.getNode(u))||void 0===h?void 0:h.data.dummy)){var c=t.getPredecessors(u)||[];c.length&&(n=t.getNode(c[0].id).data.order,o([r,a,d,i,n],s),a=d,i=n)}o([r,a,r.length,n,e.length],s)})),r})),r}(t,g)),v={},m=[];["u","d"].forEach((function(e){m="u"===e?g:Object.values(g).reverse(),["l","r"].forEach((function(r){"r"===r&&(m=m.map((function(t){return Object.values(t).reverse()})));var n,i,a,s,u,h,c=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),l=(i=p,a=c,s={},u={},h={},null==(n=m)||n.forEach((function(t){null==t||t.forEach((function(t,e){s[t]=t,u[t]=t,h[t]=e}))})),null==n||n.forEach((function(t){var e=-1;null==t||t.forEach((function(t){var r=a(t).map((function(t){return t.id}));if(r.length)for(var n=((r=r.sort((function(t,e){return h[t]-h[e]}))).length-1)/2,o=Math.floor(n),d=Math.ceil(n);o<=d;++o){var c=r[o];u[t]===t&&e<h[c]&&!Ke(i,t,c)&&(u[c]=t,u[t]=s[t]=s[c],e=h[c])}}))})),{root:s,align:u}),g=function(t,e,r,n,i,a,s){var u,d={},h=function(t,e,r,n,i,a){var s=new Qt,u=Qe(n,i,a);return null==e||e.forEach((function(e){var n;null==e||e.forEach((function(e){var i=r[e];if(s.hasNode(i)||s.addNode({id:i,data:{}}),n){var a=r[n],d=s.getRelatedEdges(a,"out").find((function(t){return t.target===i}));d?s.updateEdgeData(d.id,o(o({},d.data),{weight:Math.max(u(t,e,n),d.data.weight||0)})):s.addEdge({id:"e"+Math.random(),source:a,target:i,data:{weight:Math.max(u(t,e,n),0)}})}n=e}))})),s}(t,e,r,i,a,s),c=s?"borderLeft":"borderRight",l=function(t,e){for(var r=h.getAllNodes(),n=r.pop(),o={};n;)o[n.id]?t(n.id):(o[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return l((function(t){d[t]=(h.getRelatedEdges(t,"in")||[]).reduce((function(t,e){return Math.max(t,(d[e.source]||0)+e.data.weight)}),0)}),h.getPredecessors.bind(h)),l((function(e){var r=(h.getRelatedEdges(e,"out")||[]).reduce((function(t,e){return Math.min(t,(d[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==c&&(d[e]=Math.max(d[e],r))}),h.getSuccessors.bind(h)),null===(u=Object.values(n))||void 0===u||u.forEach((function(t){d[t]=d[r[t]]})),d}(t,m,l.root,l.align,d,f,"r"===r);"r"===r&&Object.keys(g).forEach((function(t){return g[t]=-g[t]})),v[e+r]=g}))}));var y=function(t,e){return de(Object.values(e),(function(e){var r,n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach((function(r){var i,a=e[r],s=(i=r,(t.getNode(i).data.width||0)/2);n=Math.max(a+s,n),o=Math.min(a-s,o)})),n-o}))}(t,v);return y&&function(t,e){var r=Object.values(e),n=Math.min.apply(Math,c([],h(r))),o=Math.max.apply(Math,c([],h(r)));["u","d"].forEach((function(r){["l","r"].forEach((function(i){var a,s=r+i,u=t[s];if(u!==e){var d=Object.values(u);(a="l"===i?n-Math.min.apply(Math,c([],h(d))):o-Math.max.apply(Math,c([],h(d))))&&(t[s]={},Object.keys(u).forEach((function(e){t[s][e]=u[e]+a})))}}))}))}(v,y),function(t,e){var r={};return Object.keys(t.ul).forEach((function(n){if(e)r[n]=t[e.toLowerCase()][n];else{var o=Object.values(t).map((function(t){return t[n]}));r[n]=(o[0]+o[1])/2}})),r}(v,s)}(n,e);null===(r=Object.keys(i))||void 0===r||r.forEach((function(t){n.getNode(t).data.x=i[t]}))}(t,{align:y,nodesep:x,edgesep:b,ranksep:M}),gr(t),cr(t),function(t,e){e.forEach((function(e){var r,n=t.getNode(e),o=n.data.originalEdge;o&&t.addEdge(o);for(var i=e;n.data.dummy;)r=t.getSuccessors(i)[0],t.removeNode(i),o.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===le&&(o.data.x=n.data.x,o.data.y=n.data.y,o.data.width=n.data.width,o.data.height=n.data.height),i=r.id,n=t.getNode(i)}))}(t,k),dr(t),function(t,e){var r=e.toLowerCase();"bt"!==r&&"rl"!==r||function(t){t.getAllNodes().forEach((function(t){Ce(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return Ce(t)})),t.data.hasOwnProperty("y")&&Ce(t.data)}))}(t),"lr"!==r&&"rl"!==r||(function(t){t.getAllNodes().forEach((function(t){Le(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return Le(t)})),t.data.hasOwnProperty("x")&&Le(t.data)}))}(t),Oe(t))}(t,p);var I=sr(t),T=I.width,D=I.height;return ur(t),hr(t),function(t){t.getAllEdges().forEach((function(e){var r=e.data;if(r.reversed){t.removeEdge(e.id);var n=r.forwardName;delete r.reversed,delete r.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:o(o({},r),{forwardName:n})})}}))}(t),{width:T,height:D}},Je=["width","height","layer","fixorder"],tr={width:0,height:0},er=["minlen","weight","width","height","labeloffset"],rr={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},nr=["labelpos"],or=function(t){t.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var r=t.getNode(e.source),n={e:e,rank:(t.getNode(e.target).data.rank-r.data.rank)/2+r.data.rank};ne(t,"edge-proxy",n,"_ep")}}))},ir=function(t){var e=0;return t.getAllNodes().forEach((function(r){var n,o;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(o=t.getNode(r.data.borderBottom))||void 0===o?void 0:o.data.rank,e=Math.max(e,r.data.maxRank||-1/0))})),e},ar=function(t){t.getAllNodes().forEach((function(e){"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},sr=function(t,e){var r,n,o=0,i=0,a=e||{},s=a.marginx,u=void 0===s?0:s,d=a.marginy,h=void 0===d?0:d,c=function(t){if(t.data){var e=t.data.x,a=t.data.y,s=t.data.width,u=t.data.height;isNaN(e)||isNaN(s)||(void 0===r&&(r=e-s/2),r=Math.min(r,e-s/2),o=Math.max(o,e+s/2)),isNaN(a)||isNaN(u)||(void 0===n&&(n=a-u/2),n=Math.min(n,a-u/2),i=Math.max(i,a+u/2))}};return t.getAllNodes().forEach((function(t){c(t)})),t.getAllEdges().forEach((function(t){(null==t?void 0:t.data.hasOwnProperty("x"))&&c(t)})),r-=u,n-=h,t.getAllNodes().forEach((function(t){t.data.x-=r,t.data.y-=n})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){t.x-=r,t.y-=n})),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)})),{width:o-r+u,height:i-n+h}},ur=function(t){t.getAllEdges().forEach((function(e){var r,n,o=t.getNode(e.source),i=t.getNode(e.target);e.data.points?(r=e.data.points[0],n=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:i.data.x,y:i.data.y},n={x:o.data.x,y:o.data.y}),e.data.points.unshift(ie(o.data,r)),e.data.points.push(ie(i.data,n))}))},dr=function(t){t.getAllEdges().forEach((function(t){if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},hr=function(t){t.getAllEdges().forEach((function(t){var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},cr=function(t){t.getAllNodes().forEach((function(e){var r,n,o;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){var i=t.getNode(e.id),a=t.getNode(i.data.borderTop),s=t.getNode(i.data.borderBottom),u=t.getNode(i.data.borderLeft[(null===(n=i.data.borderLeft)||void 0===n?void 0:n.length)-1]),d=t.getNode(i.data.borderRight[(null===(o=i.data.borderRight)||void 0===o?void 0:o.length)-1]);i.data.width=Math.abs((null==d?void 0:d.data.x)-(null==u?void 0:u.data.x))||10,i.data.height=Math.abs((null==s?void 0:s.data.y)-(null==a?void 0:a.data.y))||10,i.data.x=((null==u?void 0:u.data.x)||0)+i.data.width/2,i.data.y=((null==a?void 0:a.data.y)||0)+i.data.height/2}})),t.getAllNodes().forEach((function(e){"border"===e.data.dummy&&t.removeNode(e.id)}))},lr=function(t){t.getAllEdges().forEach((function(e){if(e.source===e.target){var r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}}))},fr=function(t){var e=ae(t);null==e||e.forEach((function(e){var r=0;null==e||e.forEach((function(e,n){var o,i=t.getNode(e);i.data.order=n+r,null===(o=i.data.selfEdges)||void 0===o||o.forEach((function(e){ne(t,"selfedge",{width:e.data.width,height:e.data.height,rank:i.data.rank,order:n+ ++r,e:e},"_se")})),delete i.data.selfEdges}))}))},gr=function(t){t.getAllNodes().forEach((function(e){var r=t.getNode(e.id);if("selfedge"===r.data.dummy){var n=t.getNode(r.data.e.source),o=n.data.x+n.data.width/2,i=n.data.y,a=r.data.x-o,s=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}}))},pr=function(t,e){var r={};return null==e||e.forEach((function(e){void 0!==t[e]&&(r[e]=+t[e])})),r},vr=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(r){e[r.toLowerCase()]=t[r]})),e},mr={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},yr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="dagre",this.layoutNode=function(t){return t.data.layout},this.options=o(o({},mr),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return[2,this.genericDagreLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){switch(r.label){case 0:return[4,this.genericDagreLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericDagreLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,s,u,h,c,l,f,g,p,v,m,y,w,E,b,N,M,_,A,S,k,I,T,D,R,z,C,P,j,G,U,V=this;return d(this,(function(d){return n=o(o({},this.options),r),i=n.nodeSize,a=n.align,s=n.rankdir,u=void 0===s?"TB":s,h=n.ranksep,c=n.nodesep,l=n.ranksepFunc,f=n.nodesepFunc,g=n.edgeLabelSpace,p=n.nodeOrder,v=n.begin,m=n.controlPoints,y=n.radial,w=new Qt({tree:[]}),E=L(h||50,l),b=L(c||50,f),N=b,M=E,"LR"!==u&&"RL"!==u||(N=E,M=b),_=F(i,void 0),A=e.getAllNodes(),S=e.getAllEdges(),A.filter((function(t){return t.data.layout})).forEach((function(t){var e=_(t),r=M(t),n=e+2*N(t),o=e+2*r,i=t.data.layer;x(i)?w.addNode({id:t.id,data:{width:n,height:o,layer:i}}):w.addNode({id:t.id,data:{width:n,height:o}})})),S.forEach((function(t){V.layoutNode(w.getNode(t.source))&&V.layoutNode(w.getNode(t.target))&&w.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),function(t,e){var r,n,i=e.edgeLabelSpace,a=e.keepNodeOrder,s=e.prevGraph,u=e.rankdir,d=e.ranksep;!a&&s&&(n=s,(r=t).getAllNodes().forEach((function(t){var e=r.getNode(t.id),o=n.getNode(t.id);void 0!==o?(e.data.fixorder=o.data._order,delete o.data._order):delete e.data.fixorder})));var h,c,l=(h=t,c=new Qt({tree:[]}),h.getAllNodes().forEach((function(t){var e=vr(h.getNode(t.id).data),r=o(o({},tr),e),n=pr(r,Je);c.hasNode(t.id)||c.addNode({id:t.id,data:o({},n)});var i=h.getParent(t.id);null==i||(c.hasNode(i.id)||c.addNode(o({},i)),c.setParent(t.id,i.id))})),h.getAllEdges().forEach((function(t){var e=vr(h.getEdge(t.id).data),r={};null==nr||nr.forEach((function(t){void 0!==e[t]&&(r[t]=e[t])})),c.addEdge({id:t.id,source:t.source,target:t.target,data:Object.assign({},rr,pr(e,er),r)})})),c);i&&(e.ranksep=function(t,e){var r=e.ranksep,n=void 0===r?0:r,o=e.rankdir;return t.getAllNodes().forEach((function(t){isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((function(t){var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===o||"BT"===o?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2}(l,{rankdir:u,ranksep:d}));try{Ze(l,e)}catch(h){if("Not possible to find intersection inside of the rectangle"===h.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:\n",h);throw h}!function(t,e){t.getAllNodes().forEach((function(r){var n,o=t.getNode(r.id);if(o){var i=e.getNode(r.id);o.data.x=i.data.x,o.data.y=i.data.y,o.data._order=i.data.order,o.data._rank=i.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(o.data.width=i.data.width,o.data.height=i.data.height)}})),t.getAllEdges().forEach((function(r){var n=t.getEdge(r.id),o=e.getEdge(r.id);n.data.points=o?o.data.points:[],o&&o.data.hasOwnProperty("x")&&(n.data.x=o.data.x,n.data.y=o.data.y)}))}(t,l)}(w,{prevGraph:null,edgeLabelSpace:g,keepNodeOrder:!!p,nodeOrder:p||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:u,nodesep:c,align:a}),k=[0,0],v&&(I=1/0,T=1/0,w.getAllNodes().forEach((function(t){I>t.data.x&&(I=t.data.x),T>t.data.y&&(T=t.data.y)})),w.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){I>t.x&&(I=t.x),T>t.y&&(T=t.y)}))})),k[0]=v[0]-I,k[1]=v[1]-T),D="LR"===u||"RL"===u,y||(R=new Set,z="BT"===u||"RL"===u?function(t,e){return e-t}:function(t,e){return t-e},w.getAllNodes().forEach((function(t){t.data.x=t.data.x+k[0],t.data.y=t.data.y+k[1],R.add(D?t.data.x:t.data.y)})),C=Array.from(R).sort(z),P=D?function(t,e){return t.x!==e.x}:function(t,e){return t.y!==e.y},j=D?function(t,e,r){var n=Math.max(e.y,r.y),o=Math.min(e.y,r.y);return t.filter((function(t){return t.y<=n&&t.y>=o}))}:function(t,e,r){var n=Math.max(e.x,r.x),o=Math.min(e.x,r.x);return t.filter((function(t){return t.x<=n&&t.x>=o}))},w.getAllEdges().forEach((function(t,e){var r;g&&m&&"loop"!==t.data.type&&(t.data.controlPoints=wr(null===(r=t.data.points)||void 0===r?void 0:r.map((function(t){var e=t.x,r=t.y;return{x:e+k[0],y:r+k[1]}})),w.getNode(t.source),w.getNode(t.target),C,D,P,j))}))),G=[],G=w.getAllNodes().map((function(t){return O(t)})),U=w.getAllEdges(),t&&(G.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),U.forEach((function(t){e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),[2,{nodes:G,edges:U}]}))}))},t}(),wr=function(t,e,r,n,o,i,a){var s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){var u=e.data,d=u.x,h=u.y,c=r.data,l=c.x,f=c.y;if(o&&(d=e.data.y,h=e.data.x,l=r.data.y,f=r.data.x),f!==h&&d!==l){var g=n.indexOf(h),p=n[g+1];if(p){var v=s[0],m=o?{x:(h+p)/2,y:(null==v?void 0:v.y)||l}:{x:(null==v?void 0:v.x)||l,y:(h+p)/2};v&&!i(v,m)||s.unshift(m)}var y=n.indexOf(f),w=Math.abs(y-g);if(1===w)(s=a(s,e.data,r.data)).length||s.push(o?{x:(h+f)/2,y:d}:{x:d,y:(h+f)/2});else if(w>1){var x=n[y-1];if(x){var E=s[s.length-1],b=o?{x:(f+x)/2,y:(null==E?void 0:E.y)||l}:{x:(null==E?void 0:E.x)||d,y:(f+x)/2};E&&!i(E,b)||s.push(b)}}}}return s};function xr(t){var e=0,r=0,n=0;if(t.length){for(var o=0;o<4;o++)(i=t[o])&&i.weight&&(e+=i.weight,r+=i.x*i.weight,n+=i.y*i.weight);t.x=r/e,t.y=n/e,t.weight=e}else{var i=t;t.x=i.data.x,t.y=i.data.y,t.weight=i.data.weight}}var Er={maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},br=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=o(o({},Er),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericForceLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,s,u,h,c,l,f,g,p,v,m,y,w,E,b,N,M,_=this;return d(this,(function(d){return n=o(o({},this.options),r),i=e.getAllNodes(),a=e.getAllEdges(),s=this.formatOptions(n,e),u=s.width,h=s.height,c=s.nodeSize,l=s.getMass,f=s.nodeStrength,g=s.edgeStrength,p=s.linkDistance,v=i.map((function(t){return o(o({},t),{data:o(o({},t.data),{x:x(t.data.x)?t.data.x:Math.random()*u,y:x(t.data.y)?t.data.y:Math.random()*h,size:c(t)||30,mass:l(t),nodeStrength:f(t)})})})),m=a.map((function(t){return o(o({},t),{data:o(o({},t.data),{edgeStrength:g(t),linkDistance:p(t,e.getNode(t.source),e.getNode(t.target))})})})),(null==i?void 0:i.length)?(y={},i.forEach((function(t,e){y[t.id]={x:0,y:0}})),w=new Qt({nodes:v,edges:m}),this.formatCentripetal(s,w),E=s.maxIteration,b=s.minMovement,N=s.onTick,this.lastLayoutNodes=v,this.lastLayoutEdges=m,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=w,this.lastOptions=s,this.lastVelMap=y,"undefined"==typeof window?[2]:(M=0,[2,new Promise((function(r){_.timeInterval=window.setInterval((function(){i&&_.running||r({nodes:Sr(e,v),edges:a}),_.runOneStep(w,e,M,y,s),_.updatePosition(e,w,y,s),t&&v.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),null==N||N({nodes:Sr(e,v),edges:a}),(++M>=E||_.judgingDistance<b)&&(window.clearInterval(_.timeInterval),r({nodes:Sr(e,v),edges:a}))}),0),_.running=!0}))])):(this.lastResult={nodes:[],edges:a},[2,{nodes:[],edges:a}])}))}))},t.prototype.formatOptions=function(t,e){var r=t,n=t.width,o=t.height,i=t.getMass;if(r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=o||"undefined"==typeof window?o:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),i||(r.getMass=function(t){var r=1;x(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);var n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),t.preventOverlap){var a=L(0,t.nodeSpacing);t.nodeSize?v(t.nodeSize)?r.nodeSize=function(e){var r=t.nodeSize;return Math.max(r[0],r[1])+a(e)}:r.nodeSize=function(e){return t.nodeSize+a(e)}:r.nodeSize=function(t){var e=((null==t?void 0:t.data)||{}).size;return e?v(e)?Math.max(e[0],e[1])+a(t):C(e)?Math.max(e.width,e.height)+a(t):e+a(t):10+a(t)}}return r.linkDistance=t.linkDistance?L(1,t.linkDistance):function(t){return 1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target))},r.nodeStrength=L(1,t.nodeStrength),r.edgeStrength=L(1,t.edgeStrength),t},t.prototype.formatCentripetal=function(t,e){var r,n=t.centripetalOptions,o=t.center,i=t.clusterNodeStrength,a=t.leafCluster,s=t.clustering,u=t.nodeClusterBy,d=e.getAllNodes(),h=n||{leaf:2,single:2,others:1,center:function(t){return{x:o[0],y:o[1]}}};"function"!=typeof i&&(t.clusterNodeStrength=function(t){return i});var c=[];if(a&&u&&(r=Nr(e,u),c=Array.from(new Set(null==d?void 0:d.map((function(t){return t.data[u]}))))||[],t.centripetalOptions=Object.assign(h,{single:100,leaf:function(e){var n=r[e.id]||{},o=n.siblingLeaves,i=n.sameTypeLeaves;return(null==i?void 0:i.length)===(null==o?void 0:o.length)||1===(null==c?void 0:c.length)?1:t.clusterNodeStrength(e)},others:1,center:function(t){var n,o=e.getDegree(t.id,"both");if(!o)return{x:100,y:100};if(1===o){var i=(r[t.id]||{}).sameTypeLeaves,a=void 0===i?[]:i;1===a.length?n=void 0:a.length>1&&(n=Ar(a))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y}}})),s&&u){r||(r=Nr(e,u)),c||(c=Array.from(new Set(d.map((function(t){return t.data[u]}))))),c=c.filter((function(t){return void 0!==t}));var l={};c.forEach((function(t){var r=d.filter((function(e){return e.data[u]===t})).map((function(t){return e.getNode(t.id)}));l[t]=Ar(r)})),t.centripetalOptions=Object.assign(h,{single:function(e){return t.clusterNodeStrength(e)},leaf:function(e){return t.clusterNodeStrength(e)},others:function(e){return t.clusterNodeStrength(e)},center:function(t){var e=l[t.data[u]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y}}})}var f=t.centripetalOptions||{},g=f.leaf,p=f.single,v=f.others;g&&"function"!=typeof g&&(t.centripetalOptions.leaf=function(){return g}),p&&"function"!=typeof p&&(t.centripetalOptions.single=function(){return p}),v&&"function"!=typeof v&&(t.centripetalOptions.others=function(){return v})},t.prototype.runOneStep=function(t,e,r,n,o){var i={},a=t.getAllNodes(),s=t.getAllEdges();if(null==a?void 0:a.length){var u=o.monitor;this.calRepulsive(t,i,o),s&&this.calAttractive(t,i),this.calGravity(t,e,i,o),this.updateVelocity(t,i,n,o),u&&u({energy:this.calTotalEnergy(i,a),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}},t.prototype.calTotalEnergy=function(t,e){if(!(null==e?void 0:e.length))return 0;var r=0;return e.forEach((function(e,n){var o=t[e.id].x,i=t[e.id].y,a=o*o+i*i,s=e.data.mass;r+=(void 0===s?1:s)*a*.5})),r},t.prototype.calRepulsive=function(t,e,r){var n,o,i,a,s,u=r.factor,d=r.coulombDisScale;n=e,o=u/(d*d),i=t.getAllNodes(),a=i.map((function(t,e){var r=t.data,n=r.nodeStrength;return{x:r.x,y:r.y,size:r.size,index:e,vx:0,vy:0,weight:o*n}})),s=rt(a,(function(t){return t.x}),(function(t){return t.y})).visitAfter(xr),a.forEach((function(t){var e;e=t,s.visit((function(t,r,n,o,i){return function(t,e,r,n,o,i){var a=i.x-t.x||.1,s=i.y-t.y||.1,u=n-e,d=a*a+s*s,h=Math.sqrt(d)*d;if(u*u*.81<d){var c=t.weight/h;return i.vx+=a*c,i.vy+=s*c,!0}if(t.length)return!1;t.data!==i&&(c=t.data.weight/h,i.vx+=a*c,i.vy+=s*c)}(t,r,0,o,0,e)}))})),a.map((function(t,e){var r=i[e],o=r.id,a=r.data.mass,s=void 0===a?1:a;n[o]={x:t.vx/s,y:t.vy/s}}))},t.prototype.calAttractive=function(t,e){t.getAllEdges().forEach((function(r,n){var o=r.source,i=r.target,a=t.getNode(o),s=t.getNode(i);if(a&&s){var u=s.data.x-a.data.x,d=s.data.y-a.data.y;u||d||(u=.01*Math.random(),d=.01*Math.random());var h=Math.sqrt(u*u+d*d),c=u/h,l=d/h,f=r.data||{},g=f.linkDistance,p=void 0===g?200:g,v=f.edgeStrength,m=(p-h)*(void 0===v?200:v),y=1/(a.data.mass||1),w=1/(s.data.mass||1),x=c*m,E=l*m;e[o].x-=x*y,e[o].y-=E*y,e[i].x+=x*w,e[i].y+=E*w}}))},t.prototype.calGravity=function(t,e,r,n){var o=n.getCenter,i=t.getAllNodes(),a=e.getAllNodes(),s=e.getAllEdges(),u=n.width,d=n.height,c=n.center,l=n.gravity,f=n.centripetalOptions;i&&i.forEach((function(n){var i=n.id,g=n.data,p=g.mass,v=g.x,m=g.y,y=e.getNode(i),w=0,E=0,b=l,N=t.getDegree(i,"in"),M=t.getDegree(i,"out"),_=t.getDegree(i,"both"),A=null==o?void 0:o(y,_);if(A){var S=h(A,3);w=v-S[0],E=m-S[1],b=S[2]}else w=v-c[0],E=m-c[1];if(b&&(r[i].x-=b*w/p,r[i].y-=b*E/p),f){var k=f.leaf,I=f.single,T=f.others,D=f.center,R=(null==D?void 0:D(y,a,s,u,d))||{x:0,y:0,centerStrength:0},O=R.x,z=R.y,C=R.centerStrength;if(!x(O)||!x(z))return;var L=(v-O)/p,P=(m-z)/p;if(C&&(r[i].x-=C*L,r[i].y-=C*P),0===_){var F=I(y);if(!F)return;return r[i].x-=F*L,void(r[i].y-=F*P)}if(0===N||0===M){var j=k(y,a,s);if(!j)return;return r[i].x-=j*L,void(r[i].y-=j*P)}var G=T(y);if(!G)return;r[i].x-=G*L,r[i].y-=G*P}}))},t.prototype.updateVelocity=function(t,e,r,n){var o=n.damping,i=n.maxSpeed,a=n.interval,s=t.getAllNodes();(null==s?void 0:s.length)&&s.forEach((function(t){var n=t.id,s=(r[n].x+e[n].x*a)*o||.01,u=(r[n].y+e[n].y*a)*o||.01,d=Math.sqrt(s*s+u*u);if(d>i){var h=i/d;s*=h,u*=h}r[n]={x:s,y:u}}))},t.prototype.updatePosition=function(t,e,r,n){var o=this,i=n.distanceThresholdMode,a=n.interval,s=e.getAllNodes();if(null==s?void 0:s.length){var u=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),s.forEach((function(n){var s=n.id,d=t.getNode(s);if(x(d.data.fx)&&x(d.data.fy))e.mergeNodeData(s,{x:d.data.fx,y:d.data.fy});else{var h=r[s].x*a,c=r[s].y*a;e.mergeNodeData(s,{x:n.data.x+h,y:n.data.y+c});var l=Math.sqrt(h*h+c*c);switch(i){case"max":o.judgingDistance<l&&(o.judgingDistance=l);break;case"min":o.judgingDistance>l&&(o.judgingDistance=l);break;default:u+=l}}})),i&&"mean"!==i||(this.judgingDistance=u/s.length)}else this.judgingDistance=0},t}(),Nr=function(t,e){var r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};var n={};return r.forEach((function(r,o){1===t.getDegree(r.id,"both")&&(n[r.id]=Mr(t,"leaf",r,e))})),n},Mr=function(t,e,r,n){var o=t.getDegree(r.id,"in"),i=t.getDegree(r.id,"out"),a=r,s=[];return 0===o?(a=t.getSuccessors(r.id)[0],s=t.getNeighbors(a.id)):0===i&&(a=t.getPredecessors(r.id)[0],s=t.getNeighbors(a.id)),{coreNode:a,siblingLeaves:s=s.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")})),sameTypeLeaves:_r(t,e,n,r,s)}},_r=function(t,e,r,n,o){var i=n.data[r]||"",a=(null==o?void 0:o.filter((function(t){return t.data[r]===i})))||[];return"leaf"===e&&(a=a.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")}))),a},Ar=function(t){var e={x:0,y:0};t.forEach((function(t){var r=t.data,n=r.x,o=r.y;e.x+=n||0,e.y+=o||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},Sr=function(t,e){return e.map((function(e){var r=e.id,n=e.data,i=t.getNode(r);return o(o({},i),{data:o(o({},i.data),{x:n.x,y:n.y})})}))};const kr=function(){function t(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}return t.prototype.distanceTo=function(t){var e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)},t.prototype.setPos=function(t,e){this.rx=t,this.ry=e},t.prototype.resetForce=function(){this.fx=0,this.fy=0},t.prototype.addForce=function(t){var e=t.rx-this.rx,r=t.ry-this.ry,n=Math.hypot(e,r);n=n<1e-4?1e-4:n;var o=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=o*e/n,this.fy+=o*r/n},t.prototype.in=function(t){return t.contains(this.rx,this.ry)},t.prototype.add=function(e){var r=this.mass+e.mass;return new t({rx:(this.rx*this.mass+e.rx*e.mass)/r,ry:(this.ry*this.mass+e.ry*e.mass)/r,mass:r,degree:this.degree+e.degree})},t}(),Ir=function(){function t(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}return t.prototype.getLength=function(){return this.length},t.prototype.contains=function(t,e){var r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r},t.prototype.NW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.NE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.SW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t.prototype.SE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t}(),Tr=function(){function t(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}return t.prototype.insert=function(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e},t.prototype._putBody=function(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))},t.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},t.prototype.updateForce=function(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))},t}();var Dr={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Rr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2",this.options=o(o({},Dr),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,s,u,h,c,l,f,g,p,v,m,y,w,x,E,b,N,M,_,A;return d(this,(function(d){if(n=e.getAllEdges(),i=e.getAllNodes(),a=this.formatOptions(r,i.length),s=a.width,u=a.height,h=a.prune,c=a.maxIteration,l=a.nodeSize,f=a.center,!(null==i?void 0:i.length)||1===i.length)return[2,j(e,t,f)];if(g=i.map((function(t){return O(t,[s,u])})),p=n.filter((function(t){return t.source!==t.target})),v=new Qt({nodes:g,edges:p}),m=this.getSizes(v,e,l),this.run(v,e,c,m,t,a),h){for(y=0;y<p.length;y+=1)w=p[y],x=w.source,E=w.target,b=v.getDegree(x),N=v.getDegree(x),b<=1?(M=v.getNode(E),v.mergeNodeData(x,{x:M.data.x,y:M.data.y})):N<=1&&(_=v.getNode(x),v.mergeNodeData(E,{x:_.data.x,y:_.data.y}));A=o(o({},a),{prune:!1,barnesHut:!1}),this.run(v,e,100,m,t,A)}return[2,{nodes:g,edges:n}]}))}))},t.prototype.getSizes=function(t,e,r){for(var n=t.getAllNodes(),o={},i=0;i<n.length;i+=1){var a=n[i],s=a.id,u=a.data;if(o[s]=10,x(u.size))o[s]=u.size;else if(v(u.size))isNaN(u.size[0])||(o[s]=Math.max(u.size[0])),isNaN(u.size[1])||(o[s]=Math.max(u.size[1]));else if(C(u.size))o[s]=Math.max(u.size.width,u.size.height);else if(z(r)){var d=r(e.getNode(s));v(d)?o[s]=Math.max.apply(Math,c([],h(d))):o[s]=d}else v(r)?o[s]=Math.max.apply(Math,c([],h(r))):x(r)&&(o[s]=r)}return o},t.prototype.formatOptions=function(t,e){void 0===t&&(t={});var r=o(o({},this.options),t),n=r.center,i=r.width,a=r.height,s=r.barnesHut,u=r.prune,d=r.maxIteration,h=r.kr,c=r.kg;return r.width=i||"undefined"==typeof window?i:window.innerWidth,r.height=a||"undefined"==typeof window?a:window.innerHeight,r.center=n||[r.width/2,r.height/2],void 0===s&&e>250&&(r.barnesHut=!0),void 0===u&&e>100&&(r.prune=!0),0!==d||u?0===d&&u&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)):(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)),h||(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),c||(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r},t.prototype.run=function(t,e,r,n,o,i){for(var a=i.kr,s=i.barnesHut,u=i.onTick,d=t.getAllNodes(),h=0,c=r,l={},f={},g={},p=0;p<d.length;p+=1){var v=d[p],m=v.data,y=v.id;if(l[y]=[0,0],s){var w={id:p,rx:m.x,ry:m.y,mass:1,g:a,degree:t.getDegree(y)};g[y]=new kr(w)}}for(;c>0;)h=this.oneStep(t,{iter:c,preventOverlapIters:50,krPrime:100,sg:h,forces:l,preForces:f,bodies:g,sizes:n},i),c--,null==u||u({nodes:d,edges:e.getAllEdges()});return t},t.prototype.oneStep=function(t,e,r){for(var n=e.iter,o=e.preventOverlapIters,i=e.krPrime,a=e.sg,s=e.preForces,u=e.bodies,d=e.sizes,l=e.forces,f=r.preventOverlap,g=r.barnesHut,p=t.getAllNodes(),v=0;v<p.length;v+=1){var m=p[v].id;s[m]=c([],h(l[m])),l[m]=[0,0]}return l=this.getAttrForces(t,n,o,d,l,r),l=g&&(f&&n>o||!f)?this.getOptRepGraForces(t,l,u,r):this.getRepGraForces(t,n,o,l,i,d,r),this.updatePos(t,l,s,a,r)},t.prototype.getAttrForces=function(t,e,r,n,o,i){for(var a=i.preventOverlap,s=i.dissuadeHubs,u=i.mode,d=i.prune,h=t.getAllEdges(),c=0;c<h.length;c+=1){var l=h[c],f=l.source,g=l.target,p=t.getNode(f),v=t.getNode(g),m=t.getDegree(f),y=t.getDegree(g);if(!d||!(m<=1||y<=1)){var w=[v.data.x-p.data.x,v.data.y-p.data.y],x=Math.hypot(w[0],w[1]);x=x<1e-4?1e-4:x,w[0]=w[0]/x,w[1]=w[1]/x,a&&e<r&&(x=x-n[f]-n[g]);var E=x,b=E;"linlog"===u&&(b=E=Math.log(1+x)),s&&(E=x/m,b=x/y),a&&e<r&&x<=0?(E=0,b=0):a&&e<r&&x>0&&(E=x,b=x),o[f][0]+=E*w[0],o[g][0]-=b*w[0],o[f][1]+=E*w[1],o[g][1]-=b*w[1]}}return o},t.prototype.getOptRepGraForces=function(t,e,r,n){for(var o=n.kg,i=n.center,a=n.prune,s=t.getAllNodes(),u=s.length,d=9e10,h=-9e10,c=9e10,l=-9e10,f=0;f<u;f+=1){var g=s[f],p=g.id,v=g.data;a&&t.getDegree(p)<=1||(r[p].setPos(v.x,v.y),v.x>=h&&(h=v.x),v.x<=d&&(d=v.x),v.y>=l&&(l=v.y),v.y<=c&&(c=v.y))}var m=Math.max(h-d,l-c),y=new Ir({xmid:(h+d)/2,ymid:(l+c)/2,length:m,massCenter:i,mass:u}),w=new Tr(y);for(f=0;f<u;f+=1)p=s[f].id,a&&t.getDegree(p)<=1||r[p].in(y)&&w.insert(r[p]);for(f=0;f<u;f+=1){var x=s[f],E=(p=x.id,v=x.data,t.getDegree(p));if(!(a&&E<=1)){r[p].resetForce(),w.updateForce(r[p]),e[p][0]-=r[p].fx,e[p][1]-=r[p].fy;var b=[v.x-i[0],v.y-i[1]],N=Math.hypot(b[0],b[1]);N=N<1e-4?1e-4:N,b[0]=b[0]/N,b[1]=b[1]/N;var M=o*(E+1);e[p][0]-=M*b[0],e[p][1]-=M*b[1]}}return e},t.prototype.getRepGraForces=function(t,e,r,n,o,i,a){for(var s=a.preventOverlap,u=a.kr,d=a.kg,h=a.center,c=a.prune,l=t.getAllNodes(),f=l.length,g=0;g<f;g+=1){for(var p=l[g],v=t.getDegree(p.id),m=g+1;m<f;m+=1){var y=l[m],w=t.getDegree(y.id);if(!c||!(v<=1||w<=1)){var x=[y.data.x-p.data.x,y.data.y-p.data.y],E=Math.hypot(x[0],x[1]);E=E<1e-4?1e-4:E,x[0]=x[0]/E,x[1]=x[1]/E,s&&e<r&&(E=E-i[p.id]-i[y.id]);var b=u*(v+1)*(w+1)/E;s&&e<r&&E<0?b=o*(v+1)*(w+1):s&&e<r&&0===E?b=0:s&&e<r&&E>0&&(b=u*(v+1)*(w+1)/E),n[p.id][0]-=b*x[0],n[y.id][0]+=b*x[0],n[p.id][1]-=b*x[1],n[y.id][1]+=b*x[1]}}var N=[p.data.x-h[0],p.data.y-h[1]],M=Math.hypot(N[0],N[1]);N[0]=N[0]/M,N[1]=N[1]/M;var _=d*(v+1);n[p.id][0]-=_*N[0],n[p.id][1]-=_*N[1]}return n},t.prototype.updatePos=function(t,e,r,n,o){for(var i=o.ks,a=o.tao,s=o.prune,u=o.ksmax,d=t.getAllNodes(),h=d.length,c=[],l=[],f=0,g=0,p=n,v=0;v<h;v+=1){var m=d[v].id,y=t.getDegree(m);if(!(s&&y<=1)){var w=[e[m][0]-r[m][0],e[m][1]-r[m][1]],E=Math.hypot(w[0],w[1]),b=[e[m][0]+r[m][0],e[m][1]+r[m][1]],N=Math.hypot(b[0],b[1]);c[v]=E,l[v]=N/2,f+=(y+1)*c[v],g+=(y+1)*l[v]}}var M=p;for(p=a*g/f,0!==M&&(p=p>1.5*M?1.5*M:p),v=0;v<h;v+=1){var _=d[v],A=(m=_.id,_.data);if(y=t.getDegree(m),!(s&&y<=1||x(A.fx)&&x(A.fy))){var S=i*p/(1+p*Math.sqrt(c[v])),k=Math.hypot(e[m][0],e[m][1]),I=u/(k=k<1e-4?1e-4:k),T=(S=S>I?I:S)*e[m][0],D=S*e[m][1];t.mergeNodeData(m,{x:A.x+T,y:A.y+D})}}return p},t}(),Or={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},zr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=o(o({},Or),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericFruchtermanLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,s,u,h,c,l,f,g,p,v,m,y,w,x=this;return d(this,(function(d){return this.running?[2]:(n=this.formatOptions(r),i=n.width,a=n.height,s=n.center,u=n.clustering,h=n.nodeClusterBy,c=n.maxIteration,l=n.onTick,f=e.getAllNodes(),g=e.getAllEdges(),(null==f?void 0:f.length)?1===f.length?(t&&e.mergeNodeData(f[0].id,{x:s[0],y:s[1]}),p={nodes:[o(o({},f[0]),{data:o(o({},f[0].data),{x:s[0],y:s[1]})})],edges:g},this.lastResult=p,[2,p]):(v=f.map((function(t){return O(t,[i,a])})),m=new Qt({nodes:v,edges:g}),y={},u&&v.forEach((function(t){var e=t.data[h];y[e]||(y[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=v,this.lastLayoutEdges=g,this.lastAssign=t,this.lastGraph=m,this.lastOptions=n,this.lastClusterMap=y,"undefined"==typeof window?[2]:(w=0,[2,new Promise((function(r){x.timeInterval=window.setInterval((function(){x.running?(x.runOneStep(m,y,n),t&&v.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y})})),null==l||l({nodes:v,edges:g}),++w>=c&&(window.clearInterval(x.timeInterval),r({nodes:v,edges:g}))):r({nodes:v,edges:g})}),0),x.running=!0}))])):(p={nodes:[],edges:g},this.lastResult=p,[2,p]))}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=o(o({},this.options),t),r=e.clustering,n=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=r&&!!n,e},t.prototype.runOneStep=function(t,e,r){var n=r.height,o=r.width,i=r.gravity,a=r.center,s=r.speed,u=r.clustering,d=r.nodeClusterBy,h=r.clusterGravity,c=n*o,l=Math.sqrt(c)/10,f=t.getAllNodes(),g=c/(f.length+1),p=Math.sqrt(g),v={};if(this.applyCalculate(t,v,p,g),u){for(var m in e)e[m].cx=0,e[m].cy=0,e[m].count=0;for(var m in f.forEach((function(t){var r=t.data,n=e[r[d]];x(r.x)&&(n.cx+=r.x),x(r.y)&&(n.cy+=r.y),n.count++})),e)e[m].cx/=e[m].count,e[m].cy/=e[m].count;var y=h||i;f.forEach((function(t,r){var n=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=e[o[d]],a=Math.sqrt((o.x-i.cx)*(o.x-i.cx)+(o.y-i.cy)*(o.y-i.cy)),s=p*y;v[n].x-=s*(o.x-i.cx)/a,v[n].y-=s*(o.y-i.cy)/a}}))}f.forEach((function(t,e){var r=t.id,n=t.data;if(x(n.x)&&x(n.y)){var o=.01*p*i;v[r].x-=o*(n.x-a[0]),v[r].y-=o*(n.y-a[1])}})),f.forEach((function(e,r){var n=e.id,o=e.data;if(x(o.fx)&&x(o.fy))return o.x=o.fx,void(o.y=o.fy);if(x(o.x)&&x(o.y)){var i=Math.sqrt(v[n].x*v[n].x+v[n].y*v[n].y);if(i>0){var a=Math.min(l*(s/800),i);t.mergeNodeData(n,{x:o.x+v[n].x/i*a,y:o.y+v[n].y/i*a})}}}))},t.prototype.applyCalculate=function(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)},t.prototype.calRepulsive=function(t,e,r){var n=t.getAllNodes();n.forEach((function(t,o){var i=t.data,a=t.id;e[a]={x:0,y:0},n.forEach((function(t,n){var s=t.data,u=t.id;if(!(o<=n)&&x(i.x)&&x(s.x)&&x(i.y)&&x(s.y)){var d=i.x-s.x,h=i.y-s.y,c=d*d+h*h;0===c&&(c=1,d=.01,h=.01);var l=r/c,f=d*l,g=h*l;e[a].x+=f,e[a].y+=g,e[u].x-=f,e[u].y-=g}}))}))},t.prototype.calAttractive=function(t,e,r){t.getAllEdges().forEach((function(n){var o=n.source,i=n.target;if(o&&i&&o!==i){var a=t.getNode(o).data,s=t.getNode(i).data;if(x(s.x)&&x(a.x)&&x(s.y)&&x(a.y)){var u=s.x-a.x,d=s.y-a.y,h=Math.sqrt(u*u+d*d)/r,c=u*h,l=d*h;e[o].x+=c,e[o].y+=l,e[i].x-=c,e[i].y-=l}}}))},t}(),Cr={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},Lr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="grid",this.options=o(o({},Cr),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return[2,this.genericGridLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return this.genericGridLayout(!0,t,e),[2]}))}))},t.prototype.genericGridLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,s,u,h,c,l,f,g,p,m,y,w,E,b,N,M,_,A,S,k,I,T,D,R,z,C,F,G,U,V,B,q,W,H,$;return d(this,(function(d){if(n=o(o({},this.options),r),i=n.begin,a=void 0===i?[0,0]:i,s=n.condense,u=n.preventOverlapPadding,h=n.preventOverlap,c=n.rows,l=n.cols,f=n.nodeSpacing,g=n.nodeSize,p=n.width,m=n.height,y=n.position,w=n.sortBy,E=e.getAllNodes(),b=e.getAllEdges(),!(N=null==E?void 0:E.length)||1===N)return[2,j(e,t,a)];if(M=E.map((function(t){return O(t)})),"id"===w||Y(w)&&void 0!==M[0].data[w]||(w="degree"),"degree"===w?M.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):"id"===w?M.sort((function(t,e){return x(e.id)&&x(t.id)?e.id-t.id:(""+t.id).localeCompare(""+e.id)})):M.sort((function(t,e){return e.data[w]-t.data[w]})),_=p||"undefined"==typeof window?p:window.innerWidth,A=m||"undefined"==typeof window?m:window.innerHeight,S=N,k={rows:c,cols:l},null!=c&&null!=l?(k.rows=c,k.cols=l):null!=c&&null==l?(k.rows=c,k.cols=Math.ceil(S/k.rows)):null==c&&null!=l?(k.cols=l,k.rows=Math.ceil(S/k.cols)):(I=Math.sqrt(S*A/_),k.rows=Math.round(I),k.cols=Math.round(_/A*I)),k.rows=Math.max(k.rows,1),k.cols=Math.max(k.cols,1),k.cols*k.rows>S)T=Pr(k),D=Fr(k),(T-1)*D>=S?Pr(k,T-1):(D-1)*T>=S&&Fr(k,D-1);else for(;k.cols*k.rows<S;)T=Pr(k),((D=Fr(k))+1)*T>=S?Fr(k,D+1):Pr(k,T+1);for(R=s?0:_/k.cols,z=s?0:A/k.rows,(h||f)&&(C=L(10,f),F=P(30,g,!1),M.forEach((function(t){t.data.x&&t.data.y||(t.data.x=0,t.data.y=0);var r,n,o=e.getNode(t.id),i=F(o)||30;v(i)?(r=i[0],n=i[1]):(r=i,n=i);var a=void 0!==C?C(t):u,s=r+a,d=n+a;R=Math.max(R,s),z=Math.max(z,d)}))),G={},U={row:0,col:0},V={},B=0;B<M.length;B++){if(q=M[B],W=void 0,y&&(W=y(e.getNode(q.id))),W&&(void 0!==W.row||void 0!==W.col)){if(void 0===(H={row:W.row,col:W.col}).col)for(H.col=0;jr(G,H);)H.col++;else if(void 0===H.row)for(H.row=0;jr(G,H);)H.row++;V[q.id]=H,Gr(G,H)}Vr(q,a,R,z,V,k,U,G)}return $={nodes:M,edges:b},t&&M.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,$]}))}))},t}(),Pr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.min(n,o):Math.min(n,o)===t.rows?t.rows=e:t.cols=e,r},Fr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.max(n,o):Math.max(n,o)===t.rows?t.rows=e:t.cols=e,r},jr=function(t,e){return t["c-"+e.row+"-"+e.col]||!1},Gr=function(t,e){return t["c-"+e.row+"-"+e.col]=!0},Ur=function(t,e){var r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},Vr=function(t,e,r,n,o,i,a,s){var u,d,h=o[t.id];if(h)u=h.col*r+r/2+e[0],d=h.row*n+n/2+e[1];else{for(;jr(s,a);)Ur(i,a);u=a.col*r+r/2+e[0],d=a.row*n+n/2+e[1],Gr(s,a),Ur(i,a)}t.data.x=u,t.data.y=d};const Br=Object.prototype.toString;function qr(t){return Br.call(t).endsWith("Array]")}function Wr(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!qr(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]<a&&(a=t[s]);return a}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]>a&&(a=t[s]);return a}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,a=void 0===i?r.autoMinMax?n:0:i,s=r.max,u=void 0===s?r.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var d=(u-a)/(o-n),h=0;h<t.length;h++)e[h]=(t[h]-n)*d+a;return e}const Hr=" ".repeat(2),$r=" ".repeat(4);function Xr(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=e;return`${t.constructor.name} {\n${Hr}[\n${$r}${function(t,e,r,n,o){const{rows:i,columns:a}=t,s=Math.min(i,e),u=Math.min(a,r),d=[];if("auto"===o){o=!1;t:for(let e=0;e<s;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let h=0;h<s;h++){let e=[];for(let r=0;r<u;r++)e.push(Yr(t.get(h,r),n,o));d.push(`${e.join(" ")}`)}return u!==a&&(d[d.length-1]+=` ... ${a-r} more columns`),s!==i&&d.push(`... ${i-e} more rows`),d.join(`\n${$r}`)}(t,r,n,o,i)}\n${Hr}]\n${Hr}rows: ${t.rows}\n${Hr}columns: ${t.columns}\n}`}function Yr(t,e,r){return(t>=0&&r?` ${Kr(t,e-1)}`:Kr(t,e)).padEnd(e)}function Kr(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function Qr(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function Zr(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function Jr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function tn(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function en(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(nn("startRow",e),nn("endRow",r),nn("startColumn",n),nn("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function rn(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function nn(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function on(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class an{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new un(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new un(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new un(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new un(t,e)}static ones(t,e){return new un(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new un(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)o.set(i,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let a=o-n,s=new un(t,e);for(let u=0;u<t;u++)for(let t=0;t<e;t++){let e=n+Math.round(i()*a);s.set(u,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let i=0;i<n;i++)o.set(i,i,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let a=0;a<o;a++)i.set(a,a,t[a]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new un(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return an.isMatrix(t)?t:new un(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let a=o;a<e;a++){let e=t.get(r,a)-i*t.get(n,a);t.set(r,a,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new un(this.rows*e,this.columns*r);for(let o=0;o<e;o++)for(let t=0;t<r;t++)n.setSubMatrix(this,this.rows*o,this.columns*t);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){Qr(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return un.rowVector(this.getRow(t))}setRow(t,e){Qr(this,t),e=Jr(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){Qr(this,t),Qr(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){Zr(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return un.columnVector(this.getColumn(t))}setColumn(t,e){Zr(this,t),e=tn(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){Zr(this,t),Zr(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=Jr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=Jr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=Jr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=Jr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=tn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=tn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=tn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=tn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){Qr(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){Zr(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){on(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){on(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(Qr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){Qr(this,t),on(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(Qr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){Qr(this,t),on(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(Zr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){Zr(this,t),on(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(Zr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){Zr(this,t),on(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){an.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=un.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new un(e,n),i=new Float64Array(r);for(let a=0;a<n;a++){for(let e=0;e<r;e++)i[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,a,e)}}return o}strassen2x2(t){t=un.checkMatrix(t);let e=new un(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),d=t.get(1,1),h=(r+u)*(n+d),c=(a+u)*n,l=r*(i-d),f=u*(s-n),g=(r+o)*d,p=h+f-g+(o-u)*(s+d),v=l+g,m=c+f,y=h-c+l+(a-r)*(n+i);return e.set(0,0,p),e.set(0,1,v),e.set(1,0,m),e.set(1,1,y),e}strassen3x3(t){t=un.checkMatrix(t);let e=new un(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),d=this.get(2,1),h=this.get(2,2),c=t.get(0,0),l=t.get(0,1),f=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),m=t.get(2,0),y=t.get(2,1),w=t.get(2,2),x=(r-i)*(-l+p),E=(-r+i+a)*(c-l+p),b=(i+a)*(-c+l),N=r*c,M=(-r+u+d)*(c-f+v),_=(-r+u)*(f-v),A=(u+d)*(-c+f),S=(-o+d+h)*(p+m-y),k=(o-h)*(p-y),I=o*m,T=(d+h)*(-m+y),D=(-o+a+s)*(v+m-w),R=(o-s)*(v-w),O=(a+s)*(-m+w),z=N+I+n*g,C=(r+n+o-i-a-d-h)*p+E+b+N+S+I+T,L=N+M+A+(r+n+o-a-s-u-d)*v+I+D+O,P=x+a*(-c+l+g-p-v-m+w)+E+N+I+D+R,F=x+E+b+N+s*y,j=I+D+R+O+i*f,G=N+M+_+d*(-c+f+g-p-v-m+y)+S+k+I,U=S+k+I+T+u*l,V=N+M+_+A+h*w;return e.set(0,0,z),e.set(0,1,C),e.set(0,2,L),e.set(1,0,P),e.set(1,1,F),e.set(1,2,j),e.set(2,0,G),e.set(2,1,U),e.set(2,2,V),e}mmulStrassen(t){t=un.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function a(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=an.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${r} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let s=Math.max(r,o),u=Math.max(n,i);return e=a(e,s,u),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=a(e,n+1,o+1),r=a(r,n+1,o+1)):n%2==1?(e=a(e,n+1,o),r=a(r,n+1,o)):o%2==1&&(e=a(e,n,o+1),r=a(r,n,o+1));let i=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,s-1),d=r.subMatrix(0,i-1,0,s-1),h=e.subMatrix(0,i-1,s,e.columns-1),c=r.subMatrix(0,i-1,s,r.columns-1),l=e.subMatrix(i,e.rows-1,0,s-1),f=r.subMatrix(i,r.rows-1,0,s-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),p=r.subMatrix(i,r.rows-1,s,r.columns-1),v=t(an.add(u,g),an.add(d,p),i,s),m=t(an.add(l,g),d,i,s),y=t(u,an.sub(c,p),i,s),w=t(g,an.sub(f,d),i,s),x=t(an.add(u,h),p,i,s),E=t(an.sub(l,u),an.add(d,c),i,s),b=t(an.sub(h,g),an.add(f,p),i,s),N=an.add(v,w);N.sub(x),N.add(b);let M=an.add(y,x),_=an.add(m,w),A=an.sub(v,m);A.add(y),A.add(E);let S=an.zeros(2*N.rows,2*N.columns);return S=S.setSubMatrix(N,0,0),S=S.setSubMatrix(M,N.rows,0),S=S.setSubMatrix(_,0,N.columns),S=S.setSubMatrix(A,N.rows,N.columns),S.subMatrix(0,n-1,0,o-1)}(e,t=a(t,s,u),s,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new un(this.rows,this.columns);for(let o=0;o<this.rows;o++){const t=this.getRow(o);t.length>0&&Wr(t,{min:e,max:r,output:t}),n.setRow(o,t)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new un(this.rows,this.columns);for(let o=0;o<this.columns;o++){const t=this.getColumn(o);t.length&&Wr(t,{min:e,max:r,output:t}),n.setColumn(o,t)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=un.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new un(e*n,r*o);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<o;s++)i.set(n*a+r,o*e+s,this.get(a,e)*t.get(r,s));return i}kroneckerSum(t){if(t=un.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(un.eye(r,r)),o=un.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new un(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=sn){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=sn){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){en(this,t,e,r,n);let o=new un(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new un(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new un(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=un.checkMatrix(t)).isEmpty())return this;en(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){!function(t,e){if(!qr(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!qr(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new un(t.length,e.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<e.length;t++){let i=e[t];r.set(n,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new un(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=rn(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=rn(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=rn(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=rn(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!qr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<n;a++){let n=0,s=0,u=0;for(let e=0;e<o;e++)u=t.get(a,e)-r[a],n+=u,s+=u*u;e?i.push((s-n*n/o)/(o-1)):i.push((s-n*n/o)/o)}return i}(this,r,n);case"column":if(!qr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<o;a++){let o=0,s=0,u=0;for(let e=0;e<n;e++)u=t.get(e,a)-r[a],o+=u,s+=u*u;e?i.push((s-o*o/n)/(n-1)):i.push((s-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let a=0,s=0,u=0;for(let d=0;d<n;d++)for(let e=0;e<o;e++)u=t.get(d,e)-r,a+=u,s+=u*u;return e?(s-a*a/i)/(i-1):(s-a*a/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let n=0;n<r.length;n++)r[n]=Math.sqrt(r[n]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!qr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!qr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!qr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!qr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return Xr(this,t)}}function sn(t,e){return t-e}an.prototype.klass="Matrix","undefined"!=typeof Symbol&&(an.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return Xr(this)}),an.random=an.rand,an.randomInt=an.randInt,an.diagonal=an.diag,an.prototype.diagonal=an.prototype.diag,an.identity=an.eye,an.prototype.negate=an.prototype.neg,an.prototype.tensorProduct=an.prototype.kroneckerProduct;class un extends an{constructor(t,e){if(super(),un.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!qr(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!r[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return Qr(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),Qr(this,t,!0),e=Float64Array.from(Jr(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){Zr(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),Zr(this,t,!0),e=tn(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}}var dn,hn;hn=un,(dn=an).prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},dn.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},dn.prototype.addM=function(t){if(t=hn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},dn.add=function(t,e){return new hn(t).add(e)},dn.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},dn.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},dn.prototype.subM=function(t){if(t=hn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},dn.sub=function(t,e){return new hn(t).sub(e)},dn.prototype.subtract=dn.prototype.sub,dn.prototype.subtractS=dn.prototype.subS,dn.prototype.subtractM=dn.prototype.subM,dn.subtract=dn.sub,dn.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},dn.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},dn.prototype.mulM=function(t){if(t=hn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},dn.mul=function(t,e){return new hn(t).mul(e)},dn.prototype.multiply=dn.prototype.mul,dn.prototype.multiplyS=dn.prototype.mulS,dn.prototype.multiplyM=dn.prototype.mulM,dn.multiply=dn.mul,dn.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},dn.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},dn.prototype.divM=function(t){if(t=hn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},dn.div=function(t,e){return new hn(t).div(e)},dn.prototype.divide=dn.prototype.div,dn.prototype.divideS=dn.prototype.divS,dn.prototype.divideM=dn.prototype.divM,dn.divide=dn.div,dn.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},dn.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},dn.prototype.modM=function(t){if(t=hn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},dn.mod=function(t,e){return new hn(t).mod(e)},dn.prototype.modulus=dn.prototype.mod,dn.prototype.modulusS=dn.prototype.modS,dn.prototype.modulusM=dn.prototype.modM,dn.modulus=dn.mod,dn.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},dn.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},dn.prototype.andM=function(t){if(t=hn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},dn.and=function(t,e){return new hn(t).and(e)},dn.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},dn.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},dn.prototype.orM=function(t){if(t=hn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},dn.or=function(t,e){return new hn(t).or(e)},dn.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},dn.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},dn.prototype.xorM=function(t){if(t=hn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},dn.xor=function(t,e){return new hn(t).xor(e)},dn.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},dn.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},dn.prototype.leftShiftM=function(t){if(t=hn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},dn.leftShift=function(t,e){return new hn(t).leftShift(e)},dn.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},dn.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},dn.prototype.signPropagatingRightShiftM=function(t){if(t=hn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},dn.signPropagatingRightShift=function(t,e){return new hn(t).signPropagatingRightShift(e)},dn.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},dn.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},dn.prototype.rightShiftM=function(t){if(t=hn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},dn.rightShift=function(t,e){return new hn(t).rightShift(e)},dn.prototype.zeroFillRightShift=dn.prototype.rightShift,dn.prototype.zeroFillRightShiftS=dn.prototype.rightShiftS,dn.prototype.zeroFillRightShiftM=dn.prototype.rightShiftM,dn.zeroFillRightShift=dn.rightShift,dn.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},dn.not=function(t){return new hn(t).not()},dn.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},dn.abs=function(t){return new hn(t).abs()},dn.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},dn.acos=function(t){return new hn(t).acos()},dn.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},dn.acosh=function(t){return new hn(t).acosh()},dn.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},dn.asin=function(t){return new hn(t).asin()},dn.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},dn.asinh=function(t){return new hn(t).asinh()},dn.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},dn.atan=function(t){return new hn(t).atan()},dn.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},dn.atanh=function(t){return new hn(t).atanh()},dn.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},dn.cbrt=function(t){return new hn(t).cbrt()},dn.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},dn.ceil=function(t){return new hn(t).ceil()},dn.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},dn.clz32=function(t){return new hn(t).clz32()},dn.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},dn.cos=function(t){return new hn(t).cos()},dn.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},dn.cosh=function(t){return new hn(t).cosh()},dn.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},dn.exp=function(t){return new hn(t).exp()},dn.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},dn.expm1=function(t){return new hn(t).expm1()},dn.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},dn.floor=function(t){return new hn(t).floor()},dn.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},dn.fround=function(t){return new hn(t).fround()},dn.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},dn.log=function(t){return new hn(t).log()},dn.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},dn.log1p=function(t){return new hn(t).log1p()},dn.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},dn.log10=function(t){return new hn(t).log10()},dn.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},dn.log2=function(t){return new hn(t).log2()},dn.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},dn.round=function(t){return new hn(t).round()},dn.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},dn.sign=function(t){return new hn(t).sign()},dn.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},dn.sin=function(t){return new hn(t).sin()},dn.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},dn.sinh=function(t){return new hn(t).sinh()},dn.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},dn.sqrt=function(t){return new hn(t).sqrt()},dn.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},dn.tan=function(t){return new hn(t).tan()},dn.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},dn.tanh=function(t){return new hn(t).tanh()},dn.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},dn.trunc=function(t){return new hn(t).trunc()},dn.pow=function(t,e){return new hn(t).pow(e)},dn.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},dn.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},dn.prototype.powM=function(t){if(t=hn.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this};class cn extends an{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function ln(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class fn{constructor(t,e={}){if((t=cn.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=e;let s,u=Boolean(o),d=Boolean(i),h=!1;if(r<n)if(a){s=t.transpose(),r=s.rows,n=s.columns,h=!0;let e=u;u=d,d=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let c=Math.min(r,n),l=Math.min(r+1,n),f=new Float64Array(l),g=new un(r,c),p=new un(n,n),v=new Float64Array(n),m=new Float64Array(r),y=new Float64Array(l);for(let _=0;_<l;_++)y[_]=_;let w=Math.min(r-1,n),x=Math.max(0,Math.min(n-2,r)),E=Math.max(w,x);for(let _=0;_<E;_++){if(_<w){f[_]=0;for(let t=_;t<r;t++)f[_]=ln(f[_],s.get(t,_));if(0!==f[_]){s.get(_,_)<0&&(f[_]=-f[_]);for(let t=_;t<r;t++)s.set(t,_,s.get(t,_)/f[_]);s.set(_,_,s.get(_,_)+1)}f[_]=-f[_]}for(let t=_+1;t<n;t++){if(_<w&&0!==f[_]){let e=0;for(let n=_;n<r;n++)e+=s.get(n,_)*s.get(n,t);e=-e/s.get(_,_);for(let n=_;n<r;n++)s.set(n,t,s.get(n,t)+e*s.get(n,_))}v[t]=s.get(_,t)}if(u&&_<w)for(let t=_;t<r;t++)g.set(t,_,s.get(t,_));if(_<x){v[_]=0;for(let t=_+1;t<n;t++)v[_]=ln(v[_],v[t]);if(0!==v[_]){v[_+1]<0&&(v[_]=0-v[_]);for(let t=_+1;t<n;t++)v[t]/=v[_];v[_+1]+=1}if(v[_]=-v[_],_+1<r&&0!==v[_]){for(let t=_+1;t<r;t++)m[t]=0;for(let t=_+1;t<r;t++)for(let e=_+1;e<n;e++)m[t]+=v[e]*s.get(t,e);for(let t=_+1;t<n;t++){let e=-v[t]/v[_+1];for(let n=_+1;n<r;n++)s.set(n,t,s.get(n,t)+e*m[n])}}if(d)for(let t=_+1;t<n;t++)p.set(t,_,v[t])}}let b=Math.min(n,r+1);if(w<n&&(f[w]=s.get(w,w)),r<b&&(f[b-1]=0),x+1<b&&(v[x]=s.get(x,b-1)),v[b-1]=0,u){for(let t=w;t<c;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<c;e++){let n=0;for(let o=t;o<r;o++)n+=g.get(o,t)*g.get(o,e);n=-n/g.get(t,t);for(let o=t;o<r;o++)g.set(o,e,g.get(o,e)+n*g.get(o,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(d)for(let _=n-1;_>=0;_--){if(_<x&&0!==v[_])for(let t=_+1;t<n;t++){let e=0;for(let r=_+1;r<n;r++)e+=p.get(r,_)*p.get(r,t);e=-e/p.get(_+1,_);for(let r=_+1;r<n;r++)p.set(r,t,p.get(r,t)+e*p.get(r,_))}for(let t=0;t<n;t++)p.set(t,_,0);p.set(_,_,1)}let N=b-1,M=Number.EPSILON;for(;b>0;){let t,e;for(t=b-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+M*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===b-2)e=4;else{let r;for(r=b-1;r>=t&&r!==t;r--){let e=(r!==b?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(f[r])<=M*e){f[r]=0;break}}r===t?e=3:r===b-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[b-2];v[b-2]=0;for(let r=b-2;r>=t;r--){let o=ln(f[r],e),i=f[r]/o,a=e/o;if(f[r]=o,r!==t&&(e=-a*v[r-1],v[r-1]=i*v[r-1]),d)for(let t=0;t<n;t++)o=i*p.get(t,r)+a*p.get(t,b-1),p.set(t,b-1,-a*p.get(t,r)+i*p.get(t,b-1)),p.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<b;n++){let o=ln(f[n],e),i=f[n]/o,a=e/o;if(f[n]=o,e=-a*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g.get(e,n)+a*g.get(e,t-1),g.set(e,t-1,-a*g.get(e,n)+i*g.get(e,t-1)),g.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(f[b-1]),Math.abs(f[b-2]),Math.abs(v[b-2]),Math.abs(f[t]),Math.abs(v[t])),o=f[b-1]/e,i=f[b-2]/e,a=v[b-2]/e,s=f[t]/e,h=v[t]/e,c=((i+o)*(i-o)+a*a)/2,l=o*a*(o*a);let m=0;0===c&&0===l||(m=c<0?0-Math.sqrt(c*c+l):Math.sqrt(c*c+l),m=l/(c+m));let y=(s+o)*(s-o)+m,w=s*h;for(let x=t;x<b-1;x++){let e=ln(y,w);0===e&&(e=Number.MIN_VALUE);let o=y/e,i=w/e;if(x!==t&&(v[x-1]=e),y=o*f[x]+i*v[x],v[x]=o*v[x]-i*f[x],w=i*f[x+1],f[x+1]=o*f[x+1],d)for(let t=0;t<n;t++)e=o*p.get(t,x)+i*p.get(t,x+1),p.set(t,x+1,-i*p.get(t,x)+o*p.get(t,x+1)),p.set(t,x,e);if(e=ln(y,w),0===e&&(e=Number.MIN_VALUE),o=y/e,i=w/e,f[x]=e,y=o*v[x]+i*f[x+1],f[x+1]=-i*v[x]+o*f[x+1],w=i*v[x+1],v[x+1]=o*v[x+1],u&&x<r-1)for(let t=0;t<r;t++)e=o*g.get(t,x)+i*g.get(t,x+1),g.set(t,x+1,-i*g.get(t,x)+o*g.get(t,x+1)),g.set(t,x,e)}v[b-2]=y;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,d))for(let e=0;e<=N;e++)p.set(e,t,-p.get(e,t));for(;t<N&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,d&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}b--}}if(h){let t=p;p=g,g=t}this.m=r,this.n=n,this.s=f,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,o=un.zeros(n,n);for(let c=0;c<n;c++)Math.abs(this.s[c])<=r?o.set(c,c,0):o.set(c,c,1/this.s[c]);let i=this.U,a=this.rightSingularVectors,s=a.mmul(o),u=a.rows,d=i.rows,h=un.zeros(u,d);for(let c=0;c<u;c++)for(let t=0;t<d;t++){let e=0;for(let r=0;r<n;r++)e+=s.get(c,r)*i.get(t,r);h.set(c,t,e)}return h.mmul(e)}solveForDiagonal(t){return this.solve(un.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new un(r,this.s.length);for(let d=0;d<r;d++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(d,r,t.get(d,r)/this.s[r]);let i=this.U,a=i.rows,s=i.columns,u=new un(r,a);for(let d=0;d<r;d++)for(let t=0;t<a;t++){let e=0;for(let r=0;r<s;r++)e+=o.get(d,r)*i.get(t,r);u.set(d,t,e)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return un.diag(this.s)}}var gn={center:[0,0],linkDistance:50},pn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="mds",this.options=o(o({},gn),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return[2,this.genericMDSLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return this.genericMDSLayout(!0,t,e),[2]}))}))},t.prototype.genericMDSLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,s,u,h,c,l,f,g,p,v;return d(this,(function(d){return n=o(o({},this.options),r),i=n.center,a=void 0===i?[0,0]:i,s=n.linkDistance,u=void 0===s?50:s,h=e.getAllNodes(),c=e.getAllEdges(),(null==h?void 0:h.length)&&1!==h.length?(l=b({nodes:h,edges:c},!1),f=E(l),vn(f),g=N(f,u),p=mn(g),v=[],p.forEach((function(t,e){var r=O(h[e]);r.data.x=t[0]+a[0],r.data.y=t[1]+a[1],v.push(r)})),t&&v.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:v,edges:c}]):[2,j(e,t,a)]}))}))},t}(),vn=function(t){var e=-999999;t.forEach((function(t){t.forEach((function(t){t!==1/0&&e<t&&(e=t)}))})),t.forEach((function(r,n){r.forEach((function(r,o){r===1/0&&(t[n][o]=e)}))}))},mn=function(t){var e=un.mul(un.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),o=e.mean();e.add(o).subRowVector(r).subColumnVector(n);var i=new fn(e),a=un.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((function(t){return un.mul([t],[a]).toJSON()[0].splice(0,2)}))},yn={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},wn=function(t,e,r,n,o,i){e.forEach((function(a,s){r[s]={x:0,y:0},e.forEach((function(e,u){if(s!==u&&o[s]===o[u]){var d=a.x-e.x,h=a.y-e.y,c=Math.sqrt(d*d+h*h);if(0===c){c=1;var l=s>u?1:-1;d=.01*l,h=.01*l}if(c<i(t[s])/2+i(t[u])/2){var f=n*n/c;r[s].x+=d/c*f,r[s].y+=h/c*f}}}))}))},xn=function(t,e,r,n,o,i,a,s){var u=i||a/10;return n&&e.forEach((function(e,r){var n=t[r].x-t[o].x,i=t[r].y-t[o].y,a=Math.sqrt(n*n+i*i),s=i/a,u=-n/a,d=Math.sqrt(e.x*e.x+e.y*e.y),h=Math.acos((s*e.x+u*e.y)/d);h>Math.PI/2&&(h-=Math.PI/2,s*=-1,u*=-1);var c=Math.cos(h)*d;e.x=s*c,e.y=u*c})),t.forEach((function(i,a){if(a!==o){var d=Math.sqrt(e[a].x*e[a].x+e[a].y*e[a].y);if(d>0&&a!==o){var h=Math.min(u*(r/800),d);if(i.x+=e[a].x/d*h,i.y+=e[a].y/d*h,n){var c=i.x-t[o].x,l=i.y-t[o].y,f=Math.sqrt(c*c+l*l);c=c/f*s[a],l=l/f*s[a],i.x=t[o].x+c,i.y=t[o].y+l}}}})),t},En={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},bn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="radial",this.options=o(o({},En),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return[2,this.genericRadialLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return this.genericRadialLayout(!0,t,e),[2]}))}))},t.prototype.genericRadialLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,s,u,l,f,g,p,v,m,y,w,x,N,M,_,A,S,k,I,T,D,R,z,C,L,P,G,U,V,B,q,W,H,$,X,K,Q,Z,J,tt,et;return d(this,(function(d){if(n=o(o({},this.options),r),i=n.width,a=n.height,s=n.center,u=n.focusNode,l=n.unitRadius,f=n.nodeSize,g=n.nodeSpacing,p=n.strictRadial,v=n.preventOverlap,m=n.maxPreventOverlapIteration,y=n.sortBy,w=n.linkDistance,x=void 0===w?50:w,N=n.sortStrength,M=void 0===N?10:N,_=n.maxIteration,A=void 0===_?1e3:_,S=e.getAllNodes(),k=e.getAllEdges(),I=i||"undefined"==typeof window?i:window.innerWidth,T=a||"undefined"==typeof window?a:window.innerHeight,D=s||[I/2,T/2],!(null==S?void 0:S.length)||1===S.length)return[2,j(e,t,D)];if(R=S[0],Y(u)){for(z=0;z<S.length;z++)if(S[z].id===u){R=S[z];break}}else R=u||S[0];return C=_n(S,R.id),L=b({nodes:S,edges:k},!1),P=E(L),G=Sn(P,C),An(P,C,G+1),U=P[C],V=I-D[0]>D[0]?D[0]:I-D[0],B=T-D[1]>D[1]?D[1]:T-D[1],0===V&&(V=I/2),0===B&&(B=T/2),q=Math.min(V,B),W=Math.max.apply(Math,c([],h(U))),H=[],$=l||q/W,U.forEach((function(t,e){H[e]=t*$})),X=Nn(S,P,x,H,$,y,M),K=Mn(X),Q=function(t,e,r){try{var n=un.mul(un.pow(e,2),-.5),o=n.mean("row"),i=n.mean("column"),a=n.mean();n.add(a).subRowVector(o).subColumnVector(i);var s=new fn(n),u=un.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((function(e){return un.mul([e],[u]).toJSON()[0].splice(0,t)}))}catch(f){for(var d=[],h=0;h<e.length;h++){var c=Math.random()*r,l=Math.random()*r;d.push([c,l])}return d}}(x,X,x),Z=Q.map((function(t){var e=h(t,2),r=e[0],n=e[1];return{x:(isNaN(r)?Math.random()*x:r)-Q[C][0],y:(isNaN(n)?Math.random()*x:n)-Q[C][1]}})),this.run(A,Z,K,X,H,C),v&&(J=F(f,g),tt={nodes:S,nodeSizeFunc:J,positions:Z,radii:H,height:T,width:I,strictRadial:Boolean(p),focusIdx:C,iterations:m||200,k:Z.length/4.5},Z=function(t,e){for(var r=o(o({},yn),e),n=r.positions,i=r.iterations,a=r.width,s=r.k,u=r.speed,d=void 0===u?100:u,h=r.strictRadial,c=r.focusIdx,l=r.radii,f=void 0===l?[]:l,g=r.nodeSizeFunc,p=t.getAllNodes(),v=[],m=a/10,y=0;y<i;y++)n.forEach((function(t,e){v[e]={x:0,y:0}})),wn(p,n,v,s,f,g),xn(n,v,d,h,c,m,a,f);return n}(e,tt)),et=[],Z.forEach((function(t,e){var r=O(S[e]);r.data.x=t.x+D[0],r.data.y=t.y+D[1],et.push(r)})),t&&et.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:et,edges:k}]}))}))},t.prototype.run=function(t,e,r,n,o,i){for(var a=0;a<=t;a++){var s=a/t;this.oneIteration(s,e,o,n,r,i)}},t.prototype.oneIteration=function(t,e,r,n,o,i){var a=1-t;e.forEach((function(s,u){var d=D(s,{x:0,y:0}),h=0===d?0:1/d;if(u!==i){var c=0,l=0,f=0;e.forEach((function(t,e){if(u!==e){var r=D(s,t),i=0===r?0:1/r,a=n[e][u];f+=o[u][e],c+=o[u][e]*(t.x+a*(s.x-t.x)*i),l+=o[u][e]*(t.y+a*(s.y-t.y)*i)}}));var g=0===r[u]?0:1/r[u];f*=a,f+=t*g*g,c*=a,c+=t*g*s.x*h,s.x=c/f,l*=a,l+=t*g*s.y*h,s.y=l/f}}))},t}(),Nn=function(t,e,r,n,o,i,a){if(!t)return[];var s=[];if(e){var u={};e.forEach((function(e,d){var h=[];e.forEach((function(e,s){var c,l;if(d===s)h.push(0);else if(n[d]===n[s])if("data"===i)h.push(e*(Math.abs(d-s)*a)/(n[d]/o));else if(i){var f=void 0,g=void 0;if(u[t[d].id])f=u[t[d].id];else{var p=("id"===i?t[d].id:null===(c=t[d].data)||void 0===c?void 0:c[i])||0;f=Y(p)?p.charCodeAt(0):p,u[t[d].id]=f}u[t[s].id]?g=u[t[s].id]:(p=("id"===i?t[s].id:null===(l=t[s].data)||void 0===l?void 0:l[i])||0,g=Y(p)?p.charCodeAt(0):p,u[t[s].id]=g),h.push(e*(Math.abs(f-g)*a)/(n[d]/o))}else h.push(e*r/(n[d]/o));else{var v=(r+o)/2;h.push(e*v)}})),s.push(h)}))}return s},Mn=function(t){for(var e=t.length,r=t[0].length,n=[],o=0;o<e;o++){for(var i=[],a=0;a<r;a++)0!==t[o][a]?i.push(1/(t[o][a]*t[o][a])):i.push(0);n.push(i)}return n},_n=function(t,e){var r=-1;return t.forEach((function(t,n){t.id===e&&(r=n)})),Math.max(r,0)},An=function(t,e,r){for(var n=t.length,o=0;o<n;o++)if(t[e][o]===1/0){t[e][o]=r,t[o][e]=r;for(var i=0;i<n;i++)t[o][i]!==1/0&&t[e][i]===1/0&&(t[e][i]=r+t[o][i],t[i][e]=r+t[o][i])}for(o=0;o<n;o++)if(o!==e)for(i=0;i<n;i++)if(t[o][i]===1/0){var a=Math.abs(t[e][o]-t[e][i]);a=0===a?1:a,t[o][i]=a}},Sn=function(t,e){for(var r=0,n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r},kn={center:[0,0],width:300,height:300},In=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="random",this.options=o(o({},kn),t)}return t.prototype.execute=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return[2,this.genericRandomLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return a(this,void 0,void 0,(function(){return d(this,(function(r){return this.genericRandomLayout(!0,t,e),[2]}))}))},t.prototype.genericRandomLayout=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,a,s,u,h,c,l,f;return d(this,(function(d){return n=o(o({},this.options),r),i=n.center,a=n.width,s=n.height,u=e.getAllNodes(),h=a||"undefined"==typeof window?a:window.innerWidth,c=s||"undefined"==typeof window?s:window.innerHeight,l=i||[h/2,c/2],f=[],u&&u.forEach((function(t){f.push({id:t.id,data:{x:.9*(Math.random()-.5)*h+l[0],y:.9*(Math.random()-.5)*c+l[1]}})})),t&&f.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:f,edges:e.getAllEdges()}]}))}))},t}(),Tn={circular:U,concentric:Q,mds:pn,random:In,grid:Lr,radial:bn,force:br,d3force:Wt,fruchterman:zr,forceAtlas2:Rr,dagre:yr};function Dn(t,e){Tn[t]=e}function Rn(t){return!!t.tick&&!!t.stop}})();var d=u.ul,h=u.jE;function c(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(d){return void r(d)}s.done?e(u):Promise.resolve(u).then(n,o)}function l(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){c(i,n,o,a,s,"next",t)}function s(t){c(i,n,o,a,s,"throw",t)}a(void 0)}))}}function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t){var e=function(t,e){if("object"!==f(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===f(e)?e:String(e)}function p(t,e,r){return(e=g(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,g(n.key),n)}}function y(t,e,r){return e&&m(t.prototype,e),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var w,x,E=U(922),b=U.n(E),N=U(224),M=U.n(N),_=U(589),A=U.n(_),S=U(279),k=U.n(S),I=1;function T(){return I++}(x=w||(w={}))[x.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",x[x.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",x[x.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",x[x.POINTS=0]="POINTS",x[x.LINES=1]="LINES",x[x.LINE_LOOP=2]="LINE_LOOP",x[x.LINE_STRIP=3]="LINE_STRIP",x[x.TRIANGLES=4]="TRIANGLES",x[x.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",x[x.TRIANGLE_FAN=6]="TRIANGLE_FAN",x[x.ZERO=0]="ZERO",x[x.ONE=1]="ONE",x[x.SRC_COLOR=768]="SRC_COLOR",x[x.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",x[x.SRC_ALPHA=770]="SRC_ALPHA",x[x.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",x[x.DST_ALPHA=772]="DST_ALPHA",x[x.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",x[x.DST_COLOR=774]="DST_COLOR",x[x.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",x[x.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",x[x.FUNC_ADD=32774]="FUNC_ADD",x[x.BLEND_EQUATION=32777]="BLEND_EQUATION",x[x.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",x[x.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",x[x.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",x[x.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",x[x.MAX_EXT=32776]="MAX_EXT",x[x.MIN_EXT=32775]="MIN_EXT",x[x.BLEND_DST_RGB=32968]="BLEND_DST_RGB",x[x.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",x[x.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",x[x.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",x[x.CONSTANT_COLOR=32769]="CONSTANT_COLOR",x[x.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",x[x.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",x[x.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",x[x.BLEND_COLOR=32773]="BLEND_COLOR",x[x.ARRAY_BUFFER=34962]="ARRAY_BUFFER",x[x.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",x[x.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",x[x.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",x[x.STREAM_DRAW=35040]="STREAM_DRAW",x[x.STATIC_DRAW=35044]="STATIC_DRAW",x[x.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",x[x.BUFFER_SIZE=34660]="BUFFER_SIZE",x[x.BUFFER_USAGE=34661]="BUFFER_USAGE",x[x.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",x[x.FRONT=1028]="FRONT",x[x.BACK=1029]="BACK",x[x.FRONT_AND_BACK=1032]="FRONT_AND_BACK",x[x.CULL_FACE=2884]="CULL_FACE",x[x.BLEND=3042]="BLEND",x[x.DITHER=3024]="DITHER",x[x.STENCIL_TEST=2960]="STENCIL_TEST",x[x.DEPTH_TEST=2929]="DEPTH_TEST",x[x.SCISSOR_TEST=3089]="SCISSOR_TEST",x[x.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",x[x.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",x[x.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",x[x.NO_ERROR=0]="NO_ERROR",x[x.INVALID_ENUM=1280]="INVALID_ENUM",x[x.INVALID_VALUE=1281]="INVALID_VALUE",x[x.INVALID_OPERATION=1282]="INVALID_OPERATION",x[x.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",x[x.CW=2304]="CW",x[x.CCW=2305]="CCW",x[x.LINE_WIDTH=2849]="LINE_WIDTH",x[x.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",x[x.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",x[x.CULL_FACE_MODE=2885]="CULL_FACE_MODE",x[x.FRONT_FACE=2886]="FRONT_FACE",x[x.DEPTH_RANGE=2928]="DEPTH_RANGE",x[x.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",x[x.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",x[x.DEPTH_FUNC=2932]="DEPTH_FUNC",x[x.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",x[x.STENCIL_FUNC=2962]="STENCIL_FUNC",x[x.STENCIL_FAIL=2964]="STENCIL_FAIL",x[x.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",x[x.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",x[x.STENCIL_REF=2967]="STENCIL_REF",x[x.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",x[x.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",x[x.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",x[x.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",x[x.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",x[x.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",x[x.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",x[x.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",x[x.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",x[x.VIEWPORT=2978]="VIEWPORT",x[x.SCISSOR_BOX=3088]="SCISSOR_BOX",x[x.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",x[x.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",x[x.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",x[x.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",x[x.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",x[x.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",x[x.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",x[x.RED_BITS=3410]="RED_BITS",x[x.GREEN_BITS=3411]="GREEN_BITS",x[x.BLUE_BITS=3412]="BLUE_BITS",x[x.ALPHA_BITS=3413]="ALPHA_BITS",x[x.DEPTH_BITS=3414]="DEPTH_BITS",x[x.STENCIL_BITS=3415]="STENCIL_BITS",x[x.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",x[x.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",x[x.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",x[x.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",x[x.SAMPLES=32937]="SAMPLES",x[x.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",x[x.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",x[x.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",x[x.DONT_CARE=4352]="DONT_CARE",x[x.FASTEST=4353]="FASTEST",x[x.NICEST=4354]="NICEST",x[x.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",x[x.BYTE=5120]="BYTE",x[x.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",x[x.SHORT=5122]="SHORT",x[x.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",x[x.INT=5124]="INT",x[x.UNSIGNED_INT=5125]="UNSIGNED_INT",x[x.FLOAT=5126]="FLOAT",x[x.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",x[x.ALPHA=6406]="ALPHA",x[x.RGB=6407]="RGB",x[x.RGBA=6408]="RGBA",x[x.LUMINANCE=6409]="LUMINANCE",x[x.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",x[x.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",x[x.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",x[x.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",x[x.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",x[x.VERTEX_SHADER=35633]="VERTEX_SHADER",x[x.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",x[x.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",x[x.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",x[x.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",x[x.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",x[x.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",x[x.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",x[x.SHADER_TYPE=35663]="SHADER_TYPE",x[x.DELETE_STATUS=35712]="DELETE_STATUS",x[x.LINK_STATUS=35714]="LINK_STATUS",x[x.VALIDATE_STATUS=35715]="VALIDATE_STATUS",x[x.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",x[x.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",x[x.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",x[x.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",x[x.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",x[x.NEVER=512]="NEVER",x[x.LESS=513]="LESS",x[x.EQUAL=514]="EQUAL",x[x.LEQUAL=515]="LEQUAL",x[x.GREATER=516]="GREATER",x[x.NOTEQUAL=517]="NOTEQUAL",x[x.GEQUAL=518]="GEQUAL",x[x.ALWAYS=519]="ALWAYS",x[x.KEEP=7680]="KEEP",x[x.REPLACE=7681]="REPLACE",x[x.INCR=7682]="INCR",x[x.DECR=7683]="DECR",x[x.INVERT=5386]="INVERT",x[x.INCR_WRAP=34055]="INCR_WRAP",x[x.DECR_WRAP=34056]="DECR_WRAP",x[x.VENDOR=7936]="VENDOR",x[x.RENDERER=7937]="RENDERER",x[x.VERSION=7938]="VERSION",x[x.NEAREST=9728]="NEAREST",x[x.LINEAR=9729]="LINEAR",x[x.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",x[x.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",x[x.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",x[x.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",x[x.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",x[x.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",x[x.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",x[x.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",x[x.TEXTURE_2D=3553]="TEXTURE_2D",x[x.TEXTURE=5890]="TEXTURE",x[x.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",x[x.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",x[x.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",x[x.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",x[x.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",x[x.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",x[x.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",x[x.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",x[x.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",x[x.TEXTURE0=33984]="TEXTURE0",x[x.TEXTURE1=33985]="TEXTURE1",x[x.TEXTURE2=33986]="TEXTURE2",x[x.TEXTURE3=33987]="TEXTURE3",x[x.TEXTURE4=33988]="TEXTURE4",x[x.TEXTURE5=33989]="TEXTURE5",x[x.TEXTURE6=33990]="TEXTURE6",x[x.TEXTURE7=33991]="TEXTURE7",x[x.TEXTURE8=33992]="TEXTURE8",x[x.TEXTURE9=33993]="TEXTURE9",x[x.TEXTURE10=33994]="TEXTURE10",x[x.TEXTURE11=33995]="TEXTURE11",x[x.TEXTURE12=33996]="TEXTURE12",x[x.TEXTURE13=33997]="TEXTURE13",x[x.TEXTURE14=33998]="TEXTURE14",x[x.TEXTURE15=33999]="TEXTURE15",x[x.TEXTURE16=34e3]="TEXTURE16",x[x.TEXTURE17=34001]="TEXTURE17",x[x.TEXTURE18=34002]="TEXTURE18",x[x.TEXTURE19=34003]="TEXTURE19",x[x.TEXTURE20=34004]="TEXTURE20",x[x.TEXTURE21=34005]="TEXTURE21",x[x.TEXTURE22=34006]="TEXTURE22",x[x.TEXTURE23=34007]="TEXTURE23",x[x.TEXTURE24=34008]="TEXTURE24",x[x.TEXTURE25=34009]="TEXTURE25",x[x.TEXTURE26=34010]="TEXTURE26",x[x.TEXTURE27=34011]="TEXTURE27",x[x.TEXTURE28=34012]="TEXTURE28",x[x.TEXTURE29=34013]="TEXTURE29",x[x.TEXTURE30=34014]="TEXTURE30",x[x.TEXTURE31=34015]="TEXTURE31",x[x.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",x[x.REPEAT=10497]="REPEAT",x[x.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",x[x.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",x[x.FLOAT_VEC2=35664]="FLOAT_VEC2",x[x.FLOAT_VEC3=35665]="FLOAT_VEC3",x[x.FLOAT_VEC4=35666]="FLOAT_VEC4",x[x.INT_VEC2=35667]="INT_VEC2",x[x.INT_VEC3=35668]="INT_VEC3",x[x.INT_VEC4=35669]="INT_VEC4",x[x.BOOL=35670]="BOOL",x[x.BOOL_VEC2=35671]="BOOL_VEC2",x[x.BOOL_VEC3=35672]="BOOL_VEC3",x[x.BOOL_VEC4=35673]="BOOL_VEC4",x[x.FLOAT_MAT2=35674]="FLOAT_MAT2",x[x.FLOAT_MAT3=35675]="FLOAT_MAT3",x[x.FLOAT_MAT4=35676]="FLOAT_MAT4",x[x.SAMPLER_2D=35678]="SAMPLER_2D",x[x.SAMPLER_CUBE=35680]="SAMPLER_CUBE",x[x.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",x[x.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",x[x.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",x[x.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",x[x.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",x[x.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",x[x.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",x[x.COMPILE_STATUS=35713]="COMPILE_STATUS",x[x.LOW_FLOAT=36336]="LOW_FLOAT",x[x.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",x[x.HIGH_FLOAT=36338]="HIGH_FLOAT",x[x.LOW_INT=36339]="LOW_INT",x[x.MEDIUM_INT=36340]="MEDIUM_INT",x[x.HIGH_INT=36341]="HIGH_INT",x[x.FRAMEBUFFER=36160]="FRAMEBUFFER",x[x.RENDERBUFFER=36161]="RENDERBUFFER",x[x.RGBA4=32854]="RGBA4",x[x.RGB5_A1=32855]="RGB5_A1",x[x.RGB565=36194]="RGB565",x[x.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",x[x.STENCIL_INDEX=6401]="STENCIL_INDEX",x[x.STENCIL_INDEX8=36168]="STENCIL_INDEX8",x[x.DEPTH_STENCIL=34041]="DEPTH_STENCIL",x[x.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",x[x.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",x[x.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",x[x.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",x[x.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",x[x.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",x[x.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",x[x.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",x[x.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",x[x.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",x[x.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",x[x.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",x[x.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",x[x.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",x[x.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",x[x.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",x[x.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",x[x.NONE=0]="NONE",x[x.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",x[x.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",x[x.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",x[x.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",x[x.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",x[x.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",x[x.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",x[x.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",x[x.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",x[x.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",x[x.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",x[x.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",x[x.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",x[x.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",x[x.COPY_SRC=1]="COPY_SRC",x[x.COPY_DST=2]="COPY_DST",x[x.SAMPLED=4]="SAMPLED",x[x.STORAGE=8]="STORAGE",x[x.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT";var D,R,O,z,C=function(){function t(){v(this,t),this.config=void 0}return y(t,[{key:"get",value:function(){return this.config}},{key:"set",value:function(t){this.config=t}}]),t}();function L(){if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function P(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function F(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?P(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}"undefined"!=typeof navigator&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),function(t){t.Void="Void",t.Boolean="Boolean",t.Float="Float",t.Uint32="Uint32",t.Int32="Int32",t.Vector="Vector",t.Vector2Float="vec2<f32>",t.Vector3Float="vec3<f32>",t.Vector4Float="vec4<f32>",t.Vector2Boolean="vec2<bool>",t.Vector3Boolean="vec3<bool>",t.Vector4Boolean="vec4<bool>",t.Vector2Uint="vec2<u32>",t.Vector3Uint="vec3<u32>",t.Vector4Uint="vec4<u32>",t.Vector2Int="vec2<i32>",t.Vector3Int="vec3<i32>",t.Vector4Int="vec4<i32>",t.Matrix="Matrix",t.Matrix3x3Float="mat3x3<f32>",t.Matrix4x4Float="mat4x4<i32>",t.Struct="Struct",t.FloatArray="Float[]",t.Vector4FloatArray="vec4<f32>[]"}(D||(D={})),function(t){t.Program="Program",t.Identifier="Identifier",t.VariableDeclaration="VariableDeclaration",t.BlockStatement="BlockStatement",t.ReturnStatement="ReturnStatement",t.FunctionDeclaration="FunctionDeclaration",t.VariableDeclarator="VariableDeclarator",t.AssignmentExpression="AssignmentExpression",t.LogicalExpression="LogicalExpression",t.BinaryExpression="BinaryExpression",t.ArrayExpression="ArrayExpression",t.UnaryExpression="UnaryExpression",t.UpdateExpression="UpdateExpression",t.FunctionExpression="FunctionExpression",t.MemberExpression="MemberExpression",t.ConditionalExpression="ConditionalExpression",t.ExpressionStatement="ExpressionStatement",t.CallExpression="CallExpression",t.NumThreadStatement="NumThreadStatement",t.StorageStatement="StorageStatement",t.DoWhileStatement="DoWhileStatement",t.WhileStatement="WhileStatement",t.ForStatement="ForStatement",t.BreakStatement="BreakStatement",t.ContinueStatement="ContinueStatement",t.IfStatement="IfStatement",t.ImportedFunctionStatement="ImportedFunctionStatement"}(R||(R={})),function(t){t.Input="Input",t.Output="Output",t.Uniform="Uniform",t.Workgroup="Workgroup",t.UniformConstant="UniformConstant",t.Image="Image",t.StorageBuffer="StorageBuffer",t.Private="Private",t.Function="Function"}(O||(O={})),function(t){t.GLSL100="GLSL100",t.GLSL450="GLSL450",t.WGSL="WGSL"}(z||(z={}));var j,G,B,q,W,H,$,X,Y,K,Q,Z,J,tt,et=function(){function t(e,r){v(this,t),this.engine=e,this.configService=r,this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}var e,r,n;return y(t,[{key:"init",value:function(){var t=this.configService.get(),e=t.canvas,r=t.engineOptions;this.initPromise=this.engine.init(F({canvas:e||L(),antialiasing:!1},r))}},{key:"setBundle",value:function(t){this.compiledBundle=JSON.parse(JSON.stringify(t))}},{key:"setDispatch",value:function(t){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=t),this}},{key:"setMaxIteration",value:function(t){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=t),this}},{key:"setBinding",value:function(t,e){var r=this;if("string"==typeof t){var n=M()(e)||b()(e)||A()(e);if(this.compiledBundle&&this.compiledBundle.context){var o=this.compiledBundle.context.defines.find((function(e){return e.name===t}));if(o)return o.value=e,this;var i=this.compiledBundle.context.uniforms.find((function(e){return e.name===t}));i&&(n?(i.data=e,i.isReferer=!1,i.storageClass===O.Uniform?this.model&&this.model.updateUniform(t,e):this.model&&this.model.updateBuffer(t,e)):(i.isReferer=!0,i.data=e))}}else Object.keys(t).forEach((function(e){r.setBinding(e,t[e])}));return this}},{key:"execute",value:(n=l(k().mark((function t(){var e,r,n=this,o=arguments;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=o.length>0&&void 0!==o[0]?o[0]:1,!this.dirty){t.next=6;break}return this.compiledBundle.context&&(e>1?this.compiledBundle.context.maxIteration=e:this.compiledBundle.context.maxIteration++),t.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter((function(t){return t.isReferer})).forEach((function(t){var e=t.data,r=t.name;n.model.confirmInput(e.model,r)})),r=0;r<e;r++)this.model.run();return this.engine.endFrame(),t.abrupt("return",this);case 12:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"getOutput",value:(r=l(k().mark((function t(){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.model.readData());case 1:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"compile",value:(e=l(k().mark((function t(){var e,r,n;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initPromise;case 2:return e=F({},this.compiledBundle.context),r=this.engine.supportWebGPU?this.engine.useWGSL?z.WGSL:z.GLSL450:z.GLSL100,n=this.compiledBundle.shaders[r],e.defines.filter((function(t){return t.runtime})).forEach((function(t){var e="".concat("__DefineValuePlaceholder__").concat(t.name);n=n.replace(e,"".concat(t.value))})),e.shader=n,e.uniforms.forEach((function(t){if(!t.data&&t.storageClass===O.StorageBuffer){var r=1;t.type===D.FloatArray?r=1:t.type===D.Vector4FloatArray&&(r=4),t.data=new Float32Array(e.output.length*r).fill(0)}})),this.compiledBundle.context=e,t.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=t.sent;case 12:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),t}(),rt=U(919),nt=U.n(rt),ot=function(){function t(e,r){v(this,t),this.attribute=void 0,this.buffer=void 0;var n=r.buffer,o=r.offset,i=r.stride,a=r.normalized,s=r.size,u=r.divisor;this.buffer=n,this.attribute={buffer:n.get(),offset:o||0,stride:i||0,normalized:a||!1,divisor:u||0},s&&(this.attribute.size=s)}return y(t,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(t){this.buffer.subData(t)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),t}(),it=(p(j={},w.POINTS,"points"),p(j,w.LINES,"lines"),p(j,w.LINE_LOOP,"line loop"),p(j,w.LINE_STRIP,"line strip"),p(j,w.TRIANGLES,"triangles"),p(j,w.TRIANGLE_FAN,"triangle fan"),p(j,w.TRIANGLE_STRIP,"triangle strip"),j),at=(p(G={},w.STATIC_DRAW,"static"),p(G,w.DYNAMIC_DRAW,"dynamic"),p(G,w.STREAM_DRAW,"stream"),G),st=(p(B={},w.BYTE,"int8"),p(B,w.UNSIGNED_INT,"int16"),p(B,w.INT,"int32"),p(B,w.UNSIGNED_BYTE,"uint8"),p(B,w.UNSIGNED_SHORT,"uint16"),p(B,w.UNSIGNED_INT,"uint32"),p(B,w.FLOAT,"float"),B),ut=(p(q={},w.ALPHA,"alpha"),p(q,w.LUMINANCE,"luminance"),p(q,w.LUMINANCE_ALPHA,"luminance alpha"),p(q,w.RGB,"rgb"),p(q,w.RGBA,"rgba"),p(q,w.RGBA4,"rgba4"),p(q,w.RGB5_A1,"rgb5 a1"),p(q,w.RGB565,"rgb565"),p(q,w.DEPTH_COMPONENT,"depth"),p(q,w.DEPTH_STENCIL,"depth stencil"),q),dt=(p(W={},w.DONT_CARE,"dont care"),p(W,w.NICEST,"nice"),p(W,w.FASTEST,"fast"),W),ht=(p(H={},w.NEAREST,"nearest"),p(H,w.LINEAR,"linear"),p(H,w.LINEAR_MIPMAP_LINEAR,"mipmap"),p(H,w.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),p(H,w.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),p(H,w.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),H),ct=(p($={},w.REPEAT,"repeat"),p($,w.CLAMP_TO_EDGE,"clamp"),p($,w.MIRRORED_REPEAT,"mirror"),$),lt=(p(X={},w.NONE,"none"),p(X,w.BROWSER_DEFAULT_WEBGL,"browser"),X),ft=(p(Y={},w.NEVER,"never"),p(Y,w.ALWAYS,"always"),p(Y,w.LESS,"less"),p(Y,w.LEQUAL,"lequal"),p(Y,w.GREATER,"greater"),p(Y,w.GEQUAL,"gequal"),p(Y,w.EQUAL,"equal"),p(Y,w.NOTEQUAL,"notequal"),Y),gt=(p(K={},w.FUNC_ADD,"add"),p(K,w.MIN_EXT,"min"),p(K,w.MAX_EXT,"max"),p(K,w.FUNC_SUBTRACT,"subtract"),p(K,w.FUNC_REVERSE_SUBTRACT,"reverse subtract"),K),pt=(p(Q={},w.ZERO,"zero"),p(Q,w.ONE,"one"),p(Q,w.SRC_COLOR,"src color"),p(Q,w.ONE_MINUS_SRC_COLOR,"one minus src color"),p(Q,w.SRC_ALPHA,"src alpha"),p(Q,w.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),p(Q,w.DST_COLOR,"dst color"),p(Q,w.ONE_MINUS_DST_COLOR,"one minus dst color"),p(Q,w.DST_ALPHA,"dst alpha"),p(Q,w.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),p(Q,w.CONSTANT_COLOR,"constant color"),p(Q,w.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),p(Q,w.CONSTANT_ALPHA,"constant alpha"),p(Q,w.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),p(Q,w.SRC_ALPHA_SATURATE,"src alpha saturate"),Q),vt=(p(Z={},w.NEVER,"never"),p(Z,w.ALWAYS,"always"),p(Z,w.LESS,"less"),p(Z,w.LEQUAL,"lequal"),p(Z,w.GREATER,"greater"),p(Z,w.GEQUAL,"gequal"),p(Z,w.EQUAL,"equal"),p(Z,w.NOTEQUAL,"notequal"),Z),mt=(p(J={},w.ZERO,"zero"),p(J,w.KEEP,"keep"),p(J,w.REPLACE,"replace"),p(J,w.INVERT,"invert"),p(J,w.INCR,"increment"),p(J,w.DECR,"decrement"),p(J,w.INCR_WRAP,"increment wrap"),p(J,w.DECR_WRAP,"decrement wrap"),J),yt=(p(tt={},w.FRONT,"front"),p(tt,w.BACK,"back"),tt),wt=function(){function t(e,r){v(this,t),this.buffer=void 0;var n=r.data,o=r.usage,i=r.type;this.buffer=e.buffer({data:n,usage:at[o||w.STATIC_DRAW],type:st[i||w.UNSIGNED_BYTE]})}return y(t,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(t){var e=t.data,r=t.offset;this.buffer.subdata(e,r)}}]),t}();function xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Et(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function bt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Et(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Et(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var Nt=0,Mt=function(){function t(e,r){var n=this;v(this,t),this.reGl=e,this.context=r,this.entity=T(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var o={};this.context.uniforms.forEach((function(t){var e=t.name,r=t.type,i=t.data,a=t.isReferer,s=t.storageClass;if(s===O.StorageBuffer){if(a)n.textureCache[e]={data:void 0},o["".concat(e,"Size")]=function(){return i.compiledBundle.context.output.textureSize};else{n.textureCache[e]=n.calcDataTexture(e,r,i);var u=n.textureCache[e],d=u.textureWidth,h=u.isOutput;o["".concat(e,"Size")]=[d,d],h&&(n.outputTextureName=e,n.context.needPingpong&&(n.outputTextureName="".concat(e,"Output"),n.textureCache[n.outputTextureName]=n.calcDataTexture(e,r,i)))}o[e]=function(){return n.textureCache[e].texture}}else if(s===O.Uniform){if(i&&(Array.isArray(i)||b()(i))&&i.length>16)throw new Error("invalid data type ".concat(r));o[e]=function(){return t.data}}}));var i=this.getOuputDataTexture(),a=i.textureWidth,s=i.texelCount;o.u_OutputTextureSize=[a,a],o.u_OutputTexelCount=s,this.context.output.textureSize=[a,a];var u={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n".concat(this.context.shader),uniforms:o,vert:"attribute vec3 a_Position;\nattribute vec2 a_TexCoord;\n\nvarying vec2 v_TexCoord;\n\nvoid main() {\n  gl_Position = vec4(a_Position, 1.0);\n  v_TexCoord = a_TexCoord;\n}",primitive:"triangle strip",count:4};this.computeCommand=this.reGl(u)}var e;return y(t,[{key:"run",value:function(){var t=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use((function(){t.computeCommand()}))}},{key:"readData",value:(e=l(k().mark((function t(){var e,r,n,o,i,a,s,u,d=this;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.reGl({framebuffer:this.texFBO})((function(){e=d.reGl.read()})),!e){t.next=6;break}if(r=this.getOuputDataTexture(),n=r.originalDataLength,o=r.elementsPerTexel,i=r.typedArrayConstructor,a=void 0===i?Float32Array:i,s=[],4!==o)for(u=0;u<e.length;u+=4)1===o?s.push(e[u]):2===o?s.push(e[u],e[u+1]):s.push(e[u],e[u+1],e[u+2]);else s=e;return t.abrupt("return",new a(s.slice(0,n)));case 6:return t.abrupt("return",new Float32Array);case 7:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"confirmInput",value:function(t,e){var r;this.entity===t.entity?(this.dynamicPingpong=!0,r=this):r=t,this.textureCache[e].id=r.getOuputDataTexture().id,this.textureCache[e].texture=r.getOuputDataTexture().texture}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(t,e){var r=this.context.uniforms.find((function(e){return e.name===t}));if(r){var n=this.calcDataTexture(t,r.type,e),o=n.texture,i=n.data;this.textureCache[t].data=i,this.textureCache[t].texture=o}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var t=this.context.output.name;this.textureCache[t].id=this.getOuputDataTexture().id,this.textureCache[t].texture=this.getOuputDataTexture().texture}var e=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=e}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var t=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=t}},{key:"cloneDataTexture",value:function(t){var e=t.data,r=t.textureWidth;return bt(bt({},t),{},{id:Nt++,texture:this.reGl.texture({width:r,height:r,data:e,type:"float"})})}},{key:"calcDataTexture",value:function(t,e,r){var n=1;e===D.Vector4FloatArray&&(n=4);for(var o=[],i=0;i<r.length;i+=n)1===n?o.push(r[i],0,0,0):2===n?o.push(r[i],r[i+1],0,0):3===n?o.push(r[i],r[i+1],r[i+2],0):4===n&&o.push(r[i],r[i+1],r[i+2],r[i+3]);var a,s=r.length,u=Math.ceil(s/n),d=Math.ceil(Math.sqrt(u)),h=d*d;u<h&&o.push.apply(o,function(t){if(Array.isArray(t))return xt(t)}(a=new Array(4*(h-u)).fill(0))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(a)||function(t,e){if(t){if("string"==typeof t)return xt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xt(t,e):void 0}}(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var c=this.reGl.texture({width:d,height:d,data:o,type:"float"});return{id:Nt++,data:o,originalDataLength:s,typedArrayConstructor:b()(r)?r.constructor:void 0,textureWidth:d,texture:c,texelCount:u,elementsPerTexel:n,isOutput:t===this.context.output.name}}}]),t}(),_t=function(){function t(e,r){v(this,t),this.elements=void 0;var n=r.data,o=r.usage,i=r.type,a=r.count;this.elements=e.elements({data:n,usage:at[o||w.STATIC_DRAW],type:st[i||w.UNSIGNED_BYTE],count:a})}return y(t,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(t){var e=t.data;this.elements.subdata(e)}},{key:"destroy",value:function(){this.elements.destroy()}}]),t}(),At=function(){function t(e,r){v(this,t),this.framebuffer=void 0;var n=r.width,o=r.height,i=r.color,a=r.colors,s=(r.depth,r.stencil,{width:n,height:o});Array.isArray(a)&&(s.colors=a.map((function(t){return t.get()}))),i&&"boolean"!=typeof i&&(s.color=i.get()),this.framebuffer=e.framebuffer(s)}return y(t,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(t){var e=t.width,r=t.height;this.framebuffer.resize(e,r)}}]),t}(),St=U(256),kt=U.n(St);function It(t){var e={};return Object.keys(t).forEach((function(r){Tt(r,t[r],e,"")})),e}function Tt(t,e,r,n){null===e||"number"==typeof e||"boolean"==typeof e||Array.isArray(e)&&"number"==typeof e[0]||b()(e)||""===e||void 0!==e.resize?r["".concat(n&&n+".").concat(t)]=e:(kt()(e)&&Object.keys(e).forEach((function(o){Tt(o,e[o],r,"".concat(n&&n+".").concat(t))})),Array.isArray(e)&&e.forEach((function(e,o){Object.keys(e).forEach((function(i){Tt(i,e[i],r,"".concat(n&&n+".").concat(t,"[").concat(o,"]"))}))})))}function Dt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Rt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Dt(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Dt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var Ot=function(){function t(e,r){v(this,t),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=e;var n=r.vs,o=r.fs,i=r.defines,a=r.attributes,s=r.uniforms,u=r.primitive,d=r.count,h=r.elements,c=r.depth,l=r.blend,f=r.stencil,g=r.cull,p=r.instances,m=r.scissor,y=r.viewport,x={};s&&(this.uniforms=It(s),Object.keys(s).forEach((function(t){x[t]=e.prop(t)})));var E={};Object.keys(a).forEach((function(t){E[t]=a[t].get()}));var b=i&&this.generateDefines(i)||"",N={attributes:E,frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n".concat(b,"\n").concat(o),uniforms:x,vert:"\n".concat(b,"\n").concat(n),primitive:it[void 0===u?w.TRIANGLES:u]};p&&(N.instances=p),d&&(N.count=d),h&&(N.elements=h.get()),m&&(N.scissor=m),y&&(N.viewport=y),this.initDepthDrawParams({depth:c},N),this.initBlendDrawParams({blend:l},N),this.initStencilDrawParams({stencil:f},N),this.initCullDrawParams({cull:g},N),this.drawCommand=e(N)}return y(t,[{key:"addUniforms",value:function(t){this.uniforms=Rt(Rt({},this.uniforms),It(t))}},{key:"draw",value:function(t){var e=Rt(Rt({},this.uniforms),It(t.uniforms||{})),r={};Object.keys(e).forEach((function(t){var n=f(e[t]);"boolean"===n||"number"===n||Array.isArray(e[t])||e[t].BYTES_PER_ELEMENT?r[t]=e[t]:"string"===n||(r[t]=e[t].get())})),this.drawCommand(r)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(t,e){var r=t.depth;r&&(e.depth={enable:void 0===r.enable||!!r.enable,mask:void 0===r.mask||!!r.mask,func:ft[r.func||w.LESS],range:r.range||[0,1]})}},{key:"initBlendDrawParams",value:function(t,e){var r=t.blend;if(r){var n=r.enable,o=r.func,i=r.equation,a=r.color,s=void 0===a?[0,0,0,0]:a;e.blend={enable:!!n,func:{srcRGB:pt[o&&o.srcRGB||w.SRC_ALPHA],srcAlpha:pt[o&&o.srcAlpha||w.SRC_ALPHA],dstRGB:pt[o&&o.dstRGB||w.ONE_MINUS_SRC_ALPHA],dstAlpha:pt[o&&o.dstAlpha||w.ONE_MINUS_SRC_ALPHA]},equation:{rgb:gt[i&&i.rgb||w.FUNC_ADD],alpha:gt[i&&i.alpha||w.FUNC_ADD]},color:s}}}},{key:"initStencilDrawParams",value:function(t,e){var r=t.stencil;if(r){var n=r.enable,o=r.mask,i=void 0===o?-1:o,a=r.func,s=void 0===a?{cmp:w.ALWAYS,ref:0,mask:-1}:a,u=r.opFront,d=void 0===u?{fail:w.KEEP,zfail:w.KEEP,zpass:w.KEEP}:u,h=r.opBack,c=void 0===h?{fail:w.KEEP,zfail:w.KEEP,zpass:w.KEEP}:h;e.stencil={enable:!!n,mask:i,func:Rt(Rt({},s),{},{cmp:vt[s.cmp]}),opFront:{fail:mt[d.fail],zfail:mt[d.zfail],zpass:mt[d.zpass]},opBack:{fail:mt[c.fail],zfail:mt[c.zfail],zpass:mt[c.zpass]}}}}},{key:"initCullDrawParams",value:function(t,e){var r=t.cull;if(r){var n=r.enable,o=r.face,i=void 0===o?w.BACK:o;e.cull={enable:!!n,face:yt[i]}}}},{key:"generateDefines",value:function(t){return Object.keys(t).map((function(e){return"#define ".concat(e," ").concat(Number(t[e]))})).join("\n")}}]),t}(),zt=function(){function t(e,r){v(this,t),this.texture=void 0,this.width=void 0,this.height=void 0;var n=r.data,o=r.type,i=void 0===o?w.UNSIGNED_BYTE:o,a=r.width,s=r.height,u=r.flipY,d=void 0!==u&&u,h=r.format,c=void 0===h?w.RGBA:h,l=r.mipmap,f=void 0!==l&&l,g=r.wrapS,p=void 0===g?w.CLAMP_TO_EDGE:g,m=r.wrapT,y=void 0===m?w.CLAMP_TO_EDGE:m,x=r.aniso,E=void 0===x?0:x,b=r.alignment,N=void 0===b?1:b,M=r.premultiplyAlpha,_=void 0!==M&&M,A=r.mag,S=void 0===A?w.NEAREST:A,k=r.min,I=void 0===k?w.NEAREST:k,T=r.colorSpace,D=void 0===T?w.BROWSER_DEFAULT_WEBGL:T;this.width=a,this.height=s;var R={width:a,height:s,type:st[i],format:ut[c],wrapS:ct[p],wrapT:ct[y],mag:ht[S],min:ht[I],alignment:N,flipY:d,colorSpace:lt[D],premultiplyAlpha:_,aniso:E};n&&(R.data=n),"number"==typeof f?R.mipmap=dt[f]:"boolean"==typeof f&&(R.mipmap=f),this.texture=e.texture(R)}return y(t,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(t){var e=t.width,r=t.height;this.texture.resize(e,r),this.width=e,this.height=r}},{key:"destroy",value:function(){this.texture.destroy()}}]),t}(),Ct=function(){function t(){var e,r=this;v(this,t),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=(e=l(k().mark((function t(e){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.uniforms){t.next=3;break}return t.next=3,Promise.all(Object.keys(e.uniforms).map(function(){var t=l(k().mark((function t(r){var n;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.uniforms[r]||void 0===e.uniforms[r].load){t.next=5;break}return t.next=3,e.uniforms[r].load();case 3:n=t.sent,e.uniforms[r]=n;case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 3:return t.abrupt("return",new Ot(r.gl,e));case 4:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)}),this.createAttribute=function(t){return new ot(r.gl,t)},this.createBuffer=function(t){return new wt(r.gl,t)},this.createElements=function(t){return new _t(r.gl,t)},this.createTexture2D=function(t){return new zt(r.gl,t)},this.createFramebuffer=function(t){return new At(r.gl,t)},this.useFramebuffer=function(t,e){r.gl({framebuffer:t?t.get():null})(e)},this.createComputeModel=function(){var t=l(k().mark((function t(e){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Mt(r.gl,e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.clear=function(t){var e=t.color,n=t.depth,o=t.stencil,i=t.framebuffer,a=void 0===i?null:i,s={color:e,depth:n,stencil:o};s.framebuffer=null===a?a:a.get(),r.gl.clear(s)},this.setScissor=function(t){r.gl&&r.gl._gl&&(t.enable&&t.box?(r.gl._gl.enable(w.SCISSOR_TEST),r.gl._gl.scissor(t.box.x,t.box.y,t.box.width,t.box.height)):r.gl._gl.disable(w.SCISSOR_TEST),r.gl._refresh())},this.viewport=function(t){var e=t.x,n=t.y,o=t.width,i=t.height;r.gl&&r.gl._gl&&(r.gl._gl.viewport(e,n,o,i),r.gl._refresh())},this.readPixels=function(t){var e=t.framebuffer,n={x:t.x,y:t.y,width:t.width,height:t.height};return e&&(n.framebuffer=e.get()),r.gl.read(n)},this.getCanvas=function(){return r.$canvas},this.getGLContext=function(){return r.gl._gl},this.destroy=function(){r.gl&&(r.gl.destroy(),r.inited=!1)}}var e;return y(t,[{key:"init",value:(e=l(k().mark((function t(e){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.inited){t.next=2;break}return t.abrupt("return");case 2:return this.$canvas=e.canvas,t.next=5,new Promise((function(t,r){nt()({canvas:e.canvas,attributes:{alpha:!0,antialias:e.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(e,n){!e&&n||r(e),t(n)}})}));case 5:this.gl=t.sent,this.inited=!0;case 7:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),t}(),Lt=function(){function t(){v(this,t),this.engine=void 0,this.configService=new C}return y(t,[{key:"setConfig",value:function(t){this.configService.set(t)}},{key:"setEngine",value:function(t){this.engine=t}},{key:"createEntity",value:function(){return T()}},{key:"createKernel",value:function(t){var e=new et(this.engine,this.configService);return"string"==typeof t?e.setBundle(JSON.parse(t)):e.setBundle(t),e.init(),e}},{key:"destroy",value:function(){this.engine.destroy()}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=new t;return r.setConfig(e),r.setEngine(new Ct),r}}]),t}(),Pt=function(t){for(var e=[],r=t.length,n=t[0].length,o=function(n){t.forEach((function(t,o){if(e.push(t[n]),o===r-1)for(;e.length%4!=0;)e.push(0)}))},i=0;i<n;i++)o(i);return new Float32Array(e)},Ft={}.toString;const jt=function(t){return e=t,"[object Number]"===Ft.call(e);var e};var Gt={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Ut=function(){function e(e){void 0===e&&(e={}),this.options=e,this.id="fruchtermanGPU",this.options=t(t({},Gt),e)}return e.prototype.execute=function(t,e){return n(this,void 0,void 0,(function(){return o(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},e.prototype.assign=function(t,e){return n(this,void 0,void 0,(function(){return o(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},e.prototype.genericFruchtermanLayout=function(e,r,i){return n(this,void 0,void 0,(function(){var n,a,s,u,h,c,l,f,g,p,v,m,y,w,x,E,b,N,M,_,A,S,k,I,T,D,R,O,z,C;return o(this,(function(o){switch(o.label){case 0:if(n=this.formatOptions(i),a=n.width,s=n.height,u=n.center,h=n.clustering,c=n.clusterGravity,l=n.nodeClusterBy,f=n.maxIteration,g=n.gravity,p=n.speed,v=r.getAllNodes(),m=r.getAllEdges(),!(null==v?void 0:v.length))return[2,{nodes:[],edges:m}];if(1===v.length)return e&&r.mergeNodeData(v[0].id,{x:u[0],y:u[1]}),[2,{nodes:[t(t({},v[0]),{data:t(t({},v[0].data),{x:u[0],y:u[1]})})],edges:m}];for(y=v.map((function(t){return d(t,[a,s])})),w=s*a,x=Math.sqrt(w)/10,E=w/(y.length+1),b=Math.sqrt(E),P=[],F=(L=[l]).length,j={},y.forEach((function(t){L.forEach((function(e,r){if(void 0===j[t[e]]&&(j[t[e]]=Object.keys(j).length),P.push(j[t[e]]),r===F-1)for(;P.length%4!=0;)P.push(0)}))})),N={array:new Float32Array(P),count:Object.keys(j).length},M=N.array,_=N.count,y.forEach((function(t,e){var r=0,n=0;jt(t.data.fx)&&jt(t.data.fy)&&(r=t.data.fx||.001,n=t.data.fy||.001),M[4*e+1]=r,M[4*e+2]=n})),A=y.length,S=function(t,e){var r=[],n=[],o={},i=0;for(i=0;i<t.length;i++){var a=t[i];o[a.id]=i,r.push(a.data.x),r.push(a.data.y),r.push(0),r.push(0),n.push([])}for(i=0;i<e.length;i++){var s=e[i],u=s.source,d=s.target;isNaN(o[u])||isNaN(o[d])||(n[o[u]].push(o[d]),n[o[d]].push(o[u]))}var h=0;for(i=0;i<t.length;i++){var c=r.length,l=n[i],f=l.length;r[4*i+2]=c,r[4*i+3]=f,h=Math.max(h,f);for(var g=0;g<f;++g){var p=l[g];r.push(+p)}}for(;r.length%4!=0;)r.push(0);return{maxEdgePerVetex:h,array:new Float32Array(r)}}(y,m),k=S.maxEdgePerVetex,I=S.array,T=Lt.create({engineOptions:{supportCompute:!0}}),D=[],z=0;z<_;z++)D.push(0,0,0,0);R=T.createKernel('{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([A,1,1]).setBinding({u_Data:I,u_K:b,u_K2:E,u_Gravity:g,u_ClusterGravity:c||g||1,u_Speed:p,u_MaxDisplace:x,u_Clustering:h?1:0,u_Center:u,u_AttributeArray:M,u_ClusterCenters:D,MAX_EDGE_PER_VERTEX:k,VERTEX_COUNT:A}),h&&(O=T.createKernel('{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([_,1,1]).setBinding({u_Data:I,u_NodeAttributes:M,u_ClusterCenters:D,VERTEX_COUNT:A,CLUSTER_COUNT:_})),z=0,o.label=1;case 1:return z<f?[4,R.execute()]:[3,6];case 2:return o.sent(),h?(O.setBinding({u_Data:R}),[4,O.execute()]):[3,4];case 3:o.sent(),R.setBinding({u_ClusterCenters:O}),o.label=4;case 4:R.setBinding({u_MaxDisplace:x*=.99}),o.label=5;case 5:return z++,[3,1];case 6:return[4,R.getOutput()];case 7:return C=o.sent(),y.forEach((function(t,e){t.data.x=C[4*e],t.data.y=C[4*e+1]})),e&&y.forEach((function(t){var e=t.id,n=t.data;return r.mergeNodeData(e,{x:n.x,y:n.y})})),[2,{nodes:y,edges:m}]}var L,P,F,j}))}))},e.prototype.formatOptions=function(e){void 0===e&&(e={});var r=t(t({},this.options),e),n=r.clustering,o=r.nodeClusterBy,i=r.center,a=r.width,s=r.height;return r.width=a||"undefined"==typeof window?a:window.innerWidth,r.height=s||"undefined"==typeof window?s:window.innerHeight,r.center=i||[r.width/2,r.height/2],r.clustering=n&&!!o,r},e}(),Vt={linkDistance:1,nodeStrength:1e3,maxIteration:1e3,edgeStrength:200,coulombDisScale:.005,damping:.9,maxSpeed:1e3,minMovement:.5,interval:.02,factor:1,gravity:10},Bt=function(){function e(e){void 0===e&&(e={}),this.options=e,this.id="gforce",this.options=t(t({},Vt),e)}return e.prototype.execute=function(t,e){return n(this,void 0,void 0,(function(){return o(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},e.prototype.assign=function(t,e){return n(this,void 0,void 0,(function(){return o(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},e.prototype.genericForceLayout=function(e,r,i){return n(this,void 0,void 0,(function(){var n,a,s,u,h,c,l,f,g,p,v,m,y,w,x,E,b,N,M,_,A,S,k,I,T,D,R,O,z,C,L,P,F,j,G,U,V,B,q,W,H;return o(this,(function(o){switch(o.label){case 0:if(n=this.formatOptions(i,r),a=n.width,s=n.height,u=n.center,h=n.gravity,c=n.linkDistance,l=n.edgeStrength,f=n.getMass,g=n.getCenter,p=n.nodeStrength,v=n.damping,m=n.maxSpeed,y=n.minMovement,w=n.coulombDisScale,x=n.factor,E=n.interval,b=n.maxIteration,N=r.getAllNodes(),M=r.getAllEdges(),!(null==N?void 0:N.length))return[2,{nodes:[],edges:M}];if(1===N.length)return e&&r.mergeNodeData(N[0].id,{x:u[0],y:u[1]}),[2,{nodes:[t(t({},N[0]),{data:t(t({},N[0].data),{x:u[0],y:u[1]})})],edges:M}];for((_=N.map((function(t){return d(t,[a,s])}))).forEach((function(t,e){jt(t.data.x)||(t.data.x=Math.random()*a),jt(t.data.y)||(t.data.y=Math.random()*s)})),A=_.length,S=function(t,e,r,n){var o=[],i=[],a={},s=0;for(s=0;s<t.length;s++){var u=t[s];a[u.id]=s,o.push(u.data.x),o.push(u.data.y),o.push(0),o.push(0),i.push([])}for(s=0;s<e.length;s++){var d=e[s],h=d.source,c=d.target;i[a[h]].push(a[c]),i[a[h]].push(r(d)),i[a[h]].push(n(d)),i[a[h]].push(0),i[a[c]].push(a[h]),i[a[c]].push(r(d)),i[a[c]].push(n(d)),i[a[c]].push(0)}var l=0;for(s=0;s<t.length;s++){var f=o.length,g=i[s],p=g.length;o[4*s+2]=f+1048576*p/4,o[4*s+3]=0,l=Math.max(l,p/4);for(var v=0;v<p;++v){var m=g[v];o.push(+m)}}for(;o.length%4!=0;)o.push(0);return{maxEdgePerVetex:l,array:new Float32Array(o)}}(_,M,c,l),k=S.maxEdgePerVetex,I=S.array,T=[],D=[],R=[],O=[],z=[],C=[],L=[],P=_.map((function(t){return r.getDegree(t.id,"both")})),_.forEach((function(t,e){T.push(f(t)),D.push(p(t));var r=[u[0],u[1],h];if(g){var n=g(t,P[e]);n&&jt(n[0])&&jt(n[1])&&jt(n[2])&&(r=n)}R.push(r[0]),O.push(r[1]),z.push(r[2]),jt(t.data.fx)&&jt(t.data.fy)?(C.push(t.data.fx||.001),L.push(t.data.fy||.001)):(C.push(0),L.push(0))})),F=Pt([T,P,D,C]),j=Pt([R,O,z,L]),G=Lt.create({engineOptions:{supportCompute:!0}}),U=[],I.forEach((function(t){U.push(t)})),q=0;q<4;q++)U.push(0);V=G.createKernel('{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_damping;\\nuniform float u_maxSpeed;\\nuniform float u_minMovement;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nuniform float u_coulombDisScale;\\nuniform float u_factor;\\nuniform sampler2D u_NodeAttributeArray1;\\nuniform vec2 u_NodeAttributeArray1Size;\\nvec4 getDatau_NodeAttributeArray1(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray1, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray1(float address1D) {\\n  return getDatau_NodeAttributeArray1(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray1Size));\\n}\\nvec4 getDatau_NodeAttributeArray1(int address1D) {\\n  return getDatau_NodeAttributeArray1(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributeArray2;\\nuniform vec2 u_NodeAttributeArray2Size;\\nvec4 getDatau_NodeAttributeArray2(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray2, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray2(float address1D) {\\n  return getDatau_NodeAttributeArray2(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray2Size));\\n}\\nvec4 getDatau_NodeAttributeArray2(int address1D) {\\n  return getDatau_NodeAttributeArray2(float(address1D));\\n}\\nuniform float u_interval;\\nivec2 unpack_float(float packedValue) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = getDatau_NodeAttributeArray1(i);\\nvec4 attributesj = getDatau_NodeAttributeArray1(j);\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nvec4 movement = getDatau_AveMovement(0.0);\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < u_minMovement)) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes1 = getDatau_NodeAttributeArray1(i);\\nvec4 nodeAttributes2 = getDatau_NodeAttributeArray2(i);\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = u_interval * u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > u_maxSpeed) {float param2 = u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0));}else {float distx = vx * u_interval;\\nfloat disty = vy * u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\ngl_FragColor = vec4(vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"SHIFT_20","type":"Float","value":1048576,"runtime":false}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_damping","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_maxSpeed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_minMovement","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_coulombDisScale","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_factor","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray1","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray2","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_interval","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([A,1,1]).setBinding({u_Data:I,u_damping:v,u_maxSpeed:m,u_minMovement:y,u_coulombDisScale:w,u_factor:x,u_NodeAttributeArray1:F,u_NodeAttributeArray2:j,MAX_EDGE_PER_VERTEX:k,VERTEX_COUNT:A,u_AveMovement:U,u_interval:E}),B=G.createKernel('{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_iter;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = getDatau_Data(j);\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngl_FragColor = vec4(vec4(movement, 0.0, 0.0, 0.0));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_iter","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_AveMovement","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([1,1,1]).setBinding({u_Data:I,VERTEX_COUNT:A,u_AveMovement:[0,0,0,0]}),q=0,o.label=1;case 1:return q<b?[4,V.execute()]:[3,5];case 2:return o.sent(),B.setBinding({u_Data:V}),[4,B.execute()];case 3:o.sent(),W=Math.max(.02,E-.002*q),V.setBinding({u_interval:W,u_AveMovement:B}),o.label=4;case 4:return q++,[3,1];case 5:return[4,V.getOutput()];case 6:return H=o.sent(),_.forEach((function(t,e){t.data.x=H[4*e],t.data.y=H[4*e+1]})),e&&_.forEach((function(t){var e=t.id,n=t.data;return r.mergeNodeData(e,{x:n.x,y:n.y})})),[2,{nodes:_,edges:M}]}}))}))},e.prototype.formatOptions=function(e,r){void 0===e&&(e={});var n=t(t({},this.options),e),o=e.width,i=e.height,a=e.getMass;return n.width=o||"undefined"==typeof window?o:window.innerWidth,n.height=i||"undefined"==typeof window?i:window.innerHeight,e.center||(n.center=[n.width/2,n.height/2]),a||(n.getMass=function(t){var e=1;jt(null==t?void 0:t.data.mass)&&(e=null==t?void 0:t.data.mass);var n=r.getDegree(t.id,"both");return!n||n<5?e:5*n*e}),n.linkDistance=h(1,e.linkDistance),n.nodeStrength=h(1,e.nodeStrength),n.edgeStrength=h(1,e.edgeStrength),n},e}()})();var B=V.O;function q(t,r,n){const o=(t=>({iterations:(null==t?void 0:t.iterations)||10,edgeWeightInfluence:(null==t?void 0:t.edgeWeightInfluence)||1,C:(null==t?void 0:t.C)||1,speed:(null==t?void 0:t.speed)||1,gravity:(null==t?void 0:t.gravity)||10,skipUpdates:(null==t?void 0:t.skipUpdates)||0,width:(null==t?void 0:t.width)||1,height:(null==t?void 0:t.height)||1}))(n||{}),[i,a,s]=((t,r="weight")=>{const n=t.nodes(),o=t.edges();return[t.edges().reduce(((e,o,i)=>{const a=3*i;return e[a+0]=n.indexOf(t.source(o)),e[a+1]=n.indexOf(t.target(o)),e[a+2]=t.getEdgeAttribute(o,r)||1,e}),new Float32Array(3*o.length)),n.length,t=>n.reduce(((r,n,o)=>{const i=2*o;return e(e({},r),{[n]:{x:t[i+0],y:t[i+1]}})}),{})]})(r,null==n?void 0:n.weightAttribute),u=function(t,e,r,n){const o=t=>Math.sqrt(t.reduce(((t,e)=>t+e*e),0)),i=r.width,a=r.height,s=i*a,u=r.C*Math.sqrt(s/(t+1)),d=t=>t*t/u,h=t=>u*u/t,c=new Float32Array(2*t).map(((t,e)=>e%2==0?(Math.random()*i-i/2)/2:(Math.random()*a-a/2)/2));let l=i/10;for(let f=0;f<r.iterations;f++){const s=[];for(let e=0;e<t;e++){const r=2*e,n=[c[r+0],c[r+1]];s[e]=[0,0];for(let i=0;i<t;i++){const t=2*e,r=[c[t+0],c[t+1]];if(e!==i){const t=[n[0]-r[0],n[1]-r[1]],i=o(t);if(0!==i||i>1e3*u){const r=h(i);s[e][0]+=t[0]/i*r,s[e][1]+=t[1]/i*r}}}}for(let t=0;t<e.length/3;t++){const n=3*t,i=e[n+0],a=2*i,h=e[n+1],l=2*h,f=e[n+2],g=[c[a+0]-c[l+0],c[a+1]-c[l+1]],p=o(g);if(0!==p||p>1e3*u){const t=d(p),e=Math.pow(f,r.edgeWeightInfluence);s[i][0]-=g[0]/p*t*e,s[i][1]-=g[1]/p*t*e,s[h][0]+=g[0]/p*t*e,s[h][1]+=g[1]/p*t*e}}for(let e=0;e<t;e++){const t=2*e,n=[c[t+0],c[t+1]],d=s[e],h=o(n),f=.01*u*r.gravity*h;d[0]-=f*n[0]/h,d[1]-=f*n[1]/h,d[0]*=r.speed,d[1]*=r.speed;const g=o(d);if(0!==g){const e=Math.min(g,l*r.speed),o=n[0]+d[0]/g*e,s=n[1]+d[1]/g*e;c[t+0]=Math.min(i/2,Math.max(-i/2,o)),c[t+1]=Math.min(a/2,Math.max(-a/2,s))}}l/=r.iterations+1,f!==r.iterations-1&&f%r.skipUpdates+1!=0||null==n||n(c,f)}return c}(a,i,o,t?t=>{r.updateEachNodeAttributes(((r,n)=>e(e({},n),s(t)[r])),{attributes:["x","y"]})}:void 0);if(!t)return s(u)}const W=(t,e)=>q(!1,t,e);W.assign=(t,e)=>q(!0,t,e);async function H(t,{iterations:e}){return E(t,W(t,{height:800,width:800,iterations:e||5e3,speed:5,gravity:1,C:1,edgeWeightInfluence:0}),(t=>{t.x=t.x+400,t.y=t.y+400}))}async function $(t,{iterations:e,min_movement:r,distance_threshold_mode:n}){const o=new w({height:800,width:800,center:[400,400],gravity:1,speed:5,maxIteration:e||5e3});return b(await o.execute(t))}async function X(t,{iterations:e,min_movement:r,distance_threshold_mode:n}){const o=new B({height:800,width:800,center:[400,400],gravity:1,speed:5,maxIteration:e||5e3});return b(await o.execute(t))}async function Y(t,{iterations:e,min_movement:r,distance_threshold_mode:n},o){const i=new k({threads:o,maxIteration:e||5e3,minMovement:r,distanceThresholdMode:n,height:800,width:800,center:[400,400],gravity:1,speed:5});return b(await i.execute(t))}const K=t=>new c({nodes:t.nodes().map((e=>({id:e,data:{x:t.getNodeAttribute(e,"x"),y:t.getNodeAttribute(e,"y")}}))),edges:t.edges().map((e=>({id:e,source:t.source(e),target:t.target(e),data:{weight:t.getEdgeAttribute(e,"weight")}})))}),Q=t=>{const e=new l;return t.getAllNodes().forEach((({id:t,data:{x:r,y:n}})=>{e.hasNode(t)||e.addNode(t,{x:r,y:n})})),t.getAllEdges().forEach((({source:t,target:r,data:{weight:n}})=>{e.addEdge(t,r,{weight:n})})),e},Z=[{name:_.GRAPHOLOGY},{name:_.ANTV_LAYOUT},{name:_.ANTV_LAYOUT_WASM_SINGLETHREAD},{name:_.ANTV_LAYOUT_WASM_MULTITHREADS},{name:_.ANTV_LAYOUT_GPU}],J=document.getElementById("mask"),tt=document.getElementById("iterations"),et=document.getElementById("min_movement"),rt=document.getElementById("distance_threshold_mode"),nt=document.getElementById("dataset"),ot=document.getElementById("dataset-desc"),it=document.getElementById("layout"),at=document.getElementById("run"),st=Z.map((({name:t})=>document.getElementById(t).getContext("2d"))),ut=Z.map(((t,e)=>st[e].canvas.parentElement.querySelector("span"))),dt=Z.map((({name:t},e)=>{const r=document.getElementById(t+"_checkbox");return r.onchange=()=>{st[e].canvas.parentElement.style.display=r.checked?"block":"none"},r})),ht=document.getElementById("scaling"),ct=async(t,e,r,n,o,i,a)=>{const s=performance.now(),{nodes:u,edges:d}=await r(n,o,i);e.innerHTML=`${(performance.now()-s).toFixed(2)}ms`,function(t,e,r,n){t.resetTransform(),t.clearRect(0,0,t.canvas.width,t.canvas.height);const o=new DOMMatrix;t.setTransform(o.translate(t.canvas.width/2,t.canvas.height/2,0).scale(n,n).translate(-t.canvas.width/2,-t.canvas.height/2,0));for(let i=0;i<r.length;i+=4)t.moveTo(r[i],r[i+1]),t.lineTo(r[i+2],r[i+3]),t.strokeStyle="grey",t.lineWidth=1,t.stroke();for(let i=0;i<e.length;i+=2)t.beginPath(),t.arc(e[i],e[i+1],5,0,2*Math.PI,!1),t.fillStyle="red",t.fill(),t.stroke()}(t,u,d,a)};(async()=>{at.innerHTML="Loading...",at.disabled=!0,console.time("Load datasets");const t=await(async()=>{const t={},e=(t,e)=>async()=>{const r=await fetch(t),n=await r.json(),o=[],i=[],a=new Set;n.nodes.forEach((t=>{a.has(t.id)||(a.add(t.id),t.x=800*Math.random(),t.y=800*Math.random(),o.push({id:t.id,data:{x:t.x,y:t.y}}))})),n.edges.forEach(((t,e)=>{void 0===t.id&&(t.id=`e${e}`),void 0===t.weight||null===t.weight?t.weight=1:t.weight=Number(t.weight),i.push({id:t.id,source:t.source,target:t.target,data:{weight:t.weight}})}));const s=new c({nodes:o,edges:i}),u=Q(s);return{desc:e,[_.GRAPHOLOGY]:u,[_.ANTV_LAYOUT]:s,[_.ANTV_LAYOUT_GPU]:s,[_.ANTV_LAYOUT_WASM_SINGLETHREAD]:s,[_.ANTV_LAYOUT_WASM_MULTITHREADS]:s}},[r,n,o,i,a]=await Promise.all([(()=>{const t=h(l,{order:1e3,size:2e3,clusters:5});t.edges().forEach((function(e,r){t.setEdgeAttribute(e,"weight",1)})),t.nodes().forEach((function(e){t.setNodeAttribute(e,"x",800*Math.random()),t.setNodeAttribute(e,"y",800*Math.random())}));const e=K(t);return{desc:"Creates a graph with the desired number of nodes & edges and having a given number of clusters. Generated by Graphology Generators.",[_.GRAPHOLOGY]:t,[_.ANTV_LAYOUT]:e,[_.ANTV_LAYOUT_GPU]:e,[_.ANTV_LAYOUT_WASM_SINGLETHREAD]:e,[_.ANTV_LAYOUT_WASM_MULTITHREADS]:e}})(),e("https://gw.alipayobjects.com/os/antvdemo/assets/data/relations.json",'A small dataset of "relations" between people.')(),e("https://gw.alipayobjects.com/os/basement_prod/da5a1b47-37d6-44d7-8d10-f3e046dabf82.json","Netscience with 1589 nodes & 2742 edges.")(),e("https://gw.alipayobjects.com/os/basement_prod/0b9730ff-0850-46ff-84d0-1d4afecd43e6.json","Eva with 8322 nodes & 5421 edges.")(),e("https://gw.alipayobjects.com/os/basement_prod/7bacd7d1-4119-4ac1-8be3-4c4b9bcbc25f.json","A dataset for regions on earth.")()]);return t["random-clusters"]=r,t.relations=n,t.netscience=o,t.eva=i,t.regions=a,t})();nt.onchange=()=>{ot.innerHTML=t[nt.value].desc},console.timeEnd("Load datasets"),console.time("Init WASM threads");const[e,r]=await(async()=>[await O(!1),await O(!0)])();console.timeEnd("Init WASM threads"),at.innerHTML="Run layouts",at.disabled=!1;const n=[{name:_.GRAPHOLOGY,methods:{forceatlas2:z,fruchterman:H}},{name:_.ANTV_LAYOUT,methods:{forceatlas2:C,force2:P,fruchterman:$}},{name:_.ANTV_LAYOUT_WASM_SINGLETHREAD,methods:{forceatlas2:L,force2:F,fruchterman:Y}},{name:_.ANTV_LAYOUT_WASM_MULTITHREADS,methods:{forceatlas2:L,force2:F,fruchterman:Y}},{name:_.ANTV_LAYOUT_GPU,methods:{fruchterman:X}}];at.onclick=async()=>{J.style.display="flex";const o=t[nt.value],i=it.value;await Promise.all(n.map((async({name:t,methods:n},a)=>{n[i]&&dt[a].checked?await ct(st[a],ut[a],n[i],o[t],{iterations:parseInt(tt.value),min_movement:parseFloat(et.value),distance_threshold_mode:rt.value},t===_.ANTV_LAYOUT_WASM_MULTITHREADS?r:e,Number(ht.value)):(st[a].clearRect(0,0,st[a].canvas.width,st[a].canvas.height),ut[a].innerHTML="not implemented.")}))),J.style.display="none"}})();
