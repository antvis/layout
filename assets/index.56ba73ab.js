var Ud=Object.defineProperty;var Bd=(p,h,a)=>h in p?Ud(p,h,{enumerable:!0,configurable:!0,writable:!0,value:a}):p[h]=a;var en=(p,h,a)=>(Bd(p,typeof h!="symbol"?h+"":h,a),a);(function(){const h=document.createElement("link").relList;if(h&&h.supports&&h.supports("modulepreload"))return;for(const w of document.querySelectorAll('link[rel="modulepreload"]'))f(w);new MutationObserver(w=>{for(const m of w)if(m.type==="childList")for(const E of m.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&f(E)}).observe(document,{childList:!0,subtree:!0});function a(w){const m={};return w.integrity&&(m.integrity=w.integrity),w.referrerpolicy&&(m.referrerPolicy=w.referrerpolicy),w.crossorigin==="use-credentials"?m.credentials="include":w.crossorigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function f(w){if(w.ep)return;w.ep=!0;const m=a(w);fetch(w.href,m)}})();if(typeof window>"u"){self.addEventListener("install",()=>self.skipWaiting()),self.addEventListener("activate",h=>h.waitUntil(self.clients.claim()));async function p(h){if(h.cache==="only-if-cached"&&h.mode!=="same-origin")return;h.mode==="no-cors"&&(h=new Request(h.url,{cache:h.cache,credentials:"omit",headers:h.headers,integrity:h.integrity,destination:h.destination,keepalive:h.keepalive,method:h.method,mode:h.mode,redirect:h.redirect,referrer:h.referrer,referrerPolicy:h.referrerPolicy,signal:h.signal}));let a=await fetch(h).catch(w=>console.error(w));if(a.status===0)return a;const f=new Headers(a.headers);return f.set("Cross-Origin-Embedder-Policy","credentialless"),f.set("Cross-Origin-Opener-Policy","same-origin"),new Response(a.body,{status:a.status,statusText:a.statusText,headers:f})}self.addEventListener("fetch",function(h){h.respondWith(p(h.request))})}else(async function(){if(window.crossOriginIsolated!==!1)return;let p=await navigator.serviceWorker.register(window.document.currentScript.src).catch(h=>console.error("COOP/COEP Service Worker failed to register:",h));p&&(console.log("COOP/COEP Service Worker registered",p.scope),p.addEventListener("updatefound",()=>{console.log("Reloading page to make use of updated COOP/COEP Service Worker."),window.location.reload()}),p.active&&!navigator.serviceWorker.controller&&(console.log("Reloading page to make use of COOP/COEP Service Worker."),window.location.reload()))})();function Vd(p,h,a){p.clearRect(0,0,p.canvas.width,p.canvas.height);for(let f=0;f<a.length;f+=4)p.moveTo(a[f],a[f+1]),p.lineTo(a[f+2],a[f+3]),p.strokeStyle="grey",p.lineWidth=1,p.stroke();for(let f=0;f<h.length;f+=2)p.beginPath(),p.arc(h[f],h[f+1],5,0,2*Math.PI,!1),p.fillStyle="red",p.fill(),p.stroke()}var cu=function(h){return h!==null&&typeof h=="object"&&typeof h.addUndirectedEdgeWithKey=="function"&&typeof h.dropNode=="function"&&typeof h.multi=="boolean"},Ks={};function qd(p){return typeof p!="number"||isNaN(p)?1:p}function Wd(p,h){var a={},f=function(E){return typeof E>"u"?h:E};typeof h=="function"&&(f=h);var w=function(E){return f(E[p])},m=function(){return f(void 0)};return typeof p=="string"?(a.fromAttributes=w,a.fromGraph=function(E,R){return w(E.getNodeAttributes(R))},a.fromEntry=function(E,R){return w(R)}):typeof p=="function"?(a.fromAttributes=function(){throw new Error("graphology-utils/getters/createNodeValueGetter: irrelevant usage.")},a.fromGraph=function(E,R){return f(p(R,E.getNodeAttributes(R)))},a.fromEntry=function(E,R){return f(p(E,R))}):(a.fromAttributes=m,a.fromGraph=m,a.fromEntry=m),a}function ud(p,h){var a={},f=function(E){return typeof E>"u"?h:E};typeof h=="function"&&(f=h);var w=function(E){return f(E[p])},m=function(){return f(void 0)};return typeof p=="string"?(a.fromAttributes=w,a.fromGraph=function(E,R){return w(E.getEdgeAttributes(R))},a.fromEntry=function(E,R){return w(R)},a.fromPartialEntry=a.fromEntry,a.fromMinimalEntry=a.fromEntry):typeof p=="function"?(a.fromAttributes=function(){throw new Error("graphology-utils/getters/createEdgeValueGetter: irrelevant usage.")},a.fromGraph=function(E,R){var H=E.extremities(R);return f(p(R,E.getEdgeAttributes(R),H[0],H[1],E.getNodeAttributes(H[0]),E.getNodeAttributes(H[1]),E.isUndirected(R)))},a.fromEntry=function(E,R,H,gt,Ut,Qt,Zt){return f(p(E,R,H,gt,Ut,Qt,Zt))},a.fromPartialEntry=function(E,R,H,gt){return f(p(E,R,H,gt))},a.fromMinimalEntry=function(E,R){return f(p(E,R))}):(a.fromAttributes=m,a.fromGraph=m,a.fromEntry=m,a.fromMinimalEntry=m),a}Ks.createNodeValueGetter=Wd;Ks.createEdgeValueGetter=ud;Ks.createEdgeWeightGetter=function(p){return ud(p,qd)};var no=0,Cn=1,rn=2,nn=3,va=4,ma=5,an=6,Gu=7,Hs=8,Fu=9,$d=0,Hd=1,Xd=2,co=0,ii=1,Io=2,us=3,Ua=4,jn=5,Ro=6,Ui=7,Bi=8,ju=3,xi=10,Yd=3,wo=9,iu=10,Kd=function(h,a,f){var w,m,E,R,H,gt,Ut,Qt,Zt,be,ie=a.length,Ze=f.length,me=h.adjustSizes,ze=h.barnesHutTheta*h.barnesHutTheta,re,ir,sr,br,qr,$e,Xe,le=[];for(E=0;E<ie;E+=xi)a[E+va]=a[E+rn],a[E+ma]=a[E+nn],a[E+rn]=0,a[E+nn]=0;if(h.outboundAttractionDistribution){for(re=0,E=0;E<ie;E+=xi)re+=a[E+an];re/=ie/xi}if(h.barnesHutOptimize){var Pr=1/0,Yn=-1/0,at=1/0,zr=-1/0,Gr,dn,pn;for(E=0;E<ie;E+=xi)Pr=Math.min(Pr,a[E+no]),Yn=Math.max(Yn,a[E+no]),at=Math.min(at,a[E+Cn]),zr=Math.max(zr,a[E+Cn]);var De=Yn-Pr,Me=zr-at;for(De>Me?(at-=(De-Me)/2,zr=at+De):(Pr-=(Me-De)/2,Yn=Pr+Me),le[0+co]=-1,le[0+ii]=(Pr+Yn)/2,le[0+Io]=(at+zr)/2,le[0+us]=Math.max(Yn-Pr,zr-at),le[0+Ua]=-1,le[0+jn]=-1,le[0+Ro]=0,le[0+Ui]=0,le[0+Bi]=0,w=1,E=0;E<ie;E+=xi)for(m=0,pn=ju;;)if(le[m+jn]>=0){a[E+no]<le[m+ii]?a[E+Cn]<le[m+Io]?Gr=le[m+jn]:Gr=le[m+jn]+wo:a[E+Cn]<le[m+Io]?Gr=le[m+jn]+wo*2:Gr=le[m+jn]+wo*3,le[m+Ui]=(le[m+Ui]*le[m+Ro]+a[E+no]*a[E+an])/(le[m+Ro]+a[E+an]),le[m+Bi]=(le[m+Bi]*le[m+Ro]+a[E+Cn]*a[E+an])/(le[m+Ro]+a[E+an]),le[m+Ro]+=a[E+an],m=Gr;continue}else if(le[m+co]<0){le[m+co]=E;break}else{if(le[m+jn]=w*wo,Qt=le[m+us]/2,Zt=le[m+jn],le[Zt+co]=-1,le[Zt+ii]=le[m+ii]-Qt,le[Zt+Io]=le[m+Io]-Qt,le[Zt+us]=Qt,le[Zt+Ua]=Zt+wo,le[Zt+jn]=-1,le[Zt+Ro]=0,le[Zt+Ui]=0,le[Zt+Bi]=0,Zt+=wo,le[Zt+co]=-1,le[Zt+ii]=le[m+ii]-Qt,le[Zt+Io]=le[m+Io]+Qt,le[Zt+us]=Qt,le[Zt+Ua]=Zt+wo,le[Zt+jn]=-1,le[Zt+Ro]=0,le[Zt+Ui]=0,le[Zt+Bi]=0,Zt+=wo,le[Zt+co]=-1,le[Zt+ii]=le[m+ii]+Qt,le[Zt+Io]=le[m+Io]-Qt,le[Zt+us]=Qt,le[Zt+Ua]=Zt+wo,le[Zt+jn]=-1,le[Zt+Ro]=0,le[Zt+Ui]=0,le[Zt+Bi]=0,Zt+=wo,le[Zt+co]=-1,le[Zt+ii]=le[m+ii]+Qt,le[Zt+Io]=le[m+Io]+Qt,le[Zt+us]=Qt,le[Zt+Ua]=le[m+Ua],le[Zt+jn]=-1,le[Zt+Ro]=0,le[Zt+Ui]=0,le[Zt+Bi]=0,w+=4,a[le[m+co]+no]<le[m+ii]?a[le[m+co]+Cn]<le[m+Io]?Gr=le[m+jn]:Gr=le[m+jn]+wo:a[le[m+co]+Cn]<le[m+Io]?Gr=le[m+jn]+wo*2:Gr=le[m+jn]+wo*3,le[m+Ro]=a[le[m+co]+an],le[m+Ui]=a[le[m+co]+no],le[m+Bi]=a[le[m+co]+Cn],le[Gr+co]=le[m+co],le[m+co]=-1,a[E+no]<le[m+ii]?a[E+Cn]<le[m+Io]?dn=le[m+jn]:dn=le[m+jn]+wo:a[E+Cn]<le[m+Io]?dn=le[m+jn]+wo*2:dn=le[m+jn]+wo*3,Gr===dn)if(pn--){m=Gr;continue}else{pn=ju;break}le[dn+co]=E;break}}if(h.barnesHutOptimize)for(ir=h.scalingRatio,E=0;E<ie;E+=xi)for(m=0;;)if(le[m+jn]>=0)if($e=Math.pow(a[E+no]-le[m+Ui],2)+Math.pow(a[E+Cn]-le[m+Bi],2),be=le[m+us],4*be*be/$e<ze){if(sr=a[E+no]-le[m+Ui],br=a[E+Cn]-le[m+Bi],me===!0?$e>0?(Xe=ir*a[E+an]*le[m+Ro]/$e,a[E+rn]+=sr*Xe,a[E+nn]+=br*Xe):$e<0&&(Xe=-ir*a[E+an]*le[m+Ro]/Math.sqrt($e),a[E+rn]+=sr*Xe,a[E+nn]+=br*Xe):$e>0&&(Xe=ir*a[E+an]*le[m+Ro]/$e,a[E+rn]+=sr*Xe,a[E+nn]+=br*Xe),m=le[m+Ua],m<0)break;continue}else{m=le[m+jn];continue}else{if(gt=le[m+co],gt>=0&&gt!==E&&(sr=a[E+no]-a[gt+no],br=a[E+Cn]-a[gt+Cn],$e=sr*sr+br*br,me===!0?$e>0?(Xe=ir*a[E+an]*a[gt+an]/$e,a[E+rn]+=sr*Xe,a[E+nn]+=br*Xe):$e<0&&(Xe=-ir*a[E+an]*a[gt+an]/Math.sqrt($e),a[E+rn]+=sr*Xe,a[E+nn]+=br*Xe):$e>0&&(Xe=ir*a[E+an]*a[gt+an]/$e,a[E+rn]+=sr*Xe,a[E+nn]+=br*Xe)),m=le[m+Ua],m<0)break;continue}else for(ir=h.scalingRatio,R=0;R<ie;R+=xi)for(H=0;H<R;H+=xi)sr=a[R+no]-a[H+no],br=a[R+Cn]-a[H+Cn],me===!0?($e=Math.sqrt(sr*sr+br*br)-a[R+Hs]-a[H+Hs],$e>0?(Xe=ir*a[R+an]*a[H+an]/$e/$e,a[R+rn]+=sr*Xe,a[R+nn]+=br*Xe,a[H+rn]-=sr*Xe,a[H+nn]-=br*Xe):$e<0&&(Xe=100*ir*a[R+an]*a[H+an],a[R+rn]+=sr*Xe,a[R+nn]+=br*Xe,a[H+rn]-=sr*Xe,a[H+nn]-=br*Xe)):($e=Math.sqrt(sr*sr+br*br),$e>0&&(Xe=ir*a[R+an]*a[H+an]/$e/$e,a[R+rn]+=sr*Xe,a[R+nn]+=br*Xe,a[H+rn]-=sr*Xe,a[H+nn]-=br*Xe));for(Zt=h.gravity/h.scalingRatio,ir=h.scalingRatio,E=0;E<ie;E+=xi)Xe=0,sr=a[E+no],br=a[E+Cn],$e=Math.sqrt(Math.pow(sr,2)+Math.pow(br,2)),h.strongGravityMode?$e>0&&(Xe=ir*a[E+an]*Zt):$e>0&&(Xe=ir*a[E+an]*Zt/$e),a[E+rn]-=sr*Xe,a[E+nn]-=br*Xe;for(ir=1*(h.outboundAttractionDistribution?re:1),Ut=0;Ut<Ze;Ut+=Yd)R=f[Ut+$d],H=f[Ut+Hd],Qt=f[Ut+Xd],qr=Math.pow(Qt,h.edgeWeightInfluence),sr=a[R+no]-a[H+no],br=a[R+Cn]-a[H+Cn],me===!0?($e=Math.sqrt(sr*sr+br*br)-a[R+Hs]-a[H+Hs],h.linLogMode?h.outboundAttractionDistribution?$e>0&&(Xe=-ir*qr*Math.log(1+$e)/$e/a[R+an]):$e>0&&(Xe=-ir*qr*Math.log(1+$e)/$e):h.outboundAttractionDistribution?$e>0&&(Xe=-ir*qr/a[R+an]):$e>0&&(Xe=-ir*qr)):($e=Math.sqrt(Math.pow(sr,2)+Math.pow(br,2)),h.linLogMode?h.outboundAttractionDistribution?$e>0&&(Xe=-ir*qr*Math.log(1+$e)/$e/a[R+an]):$e>0&&(Xe=-ir*qr*Math.log(1+$e)/$e):h.outboundAttractionDistribution?($e=1,Xe=-ir*qr/a[R+an]):($e=1,Xe=-ir*qr)),$e>0&&(a[R+rn]+=sr*Xe,a[R+nn]+=br*Xe,a[H+rn]-=sr*Xe,a[H+nn]-=br*Xe);var Ce,mr,Ye,Ar,Or,Sr;if(me===!0)for(E=0;E<ie;E+=xi)a[E+Fu]!==1&&(Ce=Math.sqrt(Math.pow(a[E+rn],2)+Math.pow(a[E+nn],2)),Ce>iu&&(a[E+rn]=a[E+rn]*iu/Ce,a[E+nn]=a[E+nn]*iu/Ce),mr=a[E+an]*Math.sqrt((a[E+va]-a[E+rn])*(a[E+va]-a[E+rn])+(a[E+ma]-a[E+nn])*(a[E+ma]-a[E+nn])),Ye=Math.sqrt((a[E+va]+a[E+rn])*(a[E+va]+a[E+rn])+(a[E+ma]+a[E+nn])*(a[E+ma]+a[E+nn]))/2,Ar=.1*Math.log(1+Ye)/(1+Math.sqrt(mr)),Or=a[E+no]+a[E+rn]*(Ar/h.slowDown),a[E+no]=Or,Sr=a[E+Cn]+a[E+nn]*(Ar/h.slowDown),a[E+Cn]=Sr);else for(E=0;E<ie;E+=xi)a[E+Fu]!==1&&(mr=a[E+an]*Math.sqrt((a[E+va]-a[E+rn])*(a[E+va]-a[E+rn])+(a[E+ma]-a[E+nn])*(a[E+ma]-a[E+nn])),Ye=Math.sqrt((a[E+va]+a[E+rn])*(a[E+va]+a[E+rn])+(a[E+ma]+a[E+nn])*(a[E+ma]+a[E+nn]))/2,Ar=a[E+Gu]*Math.log(1+Ye)/(1+Math.sqrt(mr)),a[E+Gu]=Math.min(1,Math.sqrt(Ar*(Math.pow(a[E+rn],2)+Math.pow(a[E+nn],2))/(1+Math.sqrt(mr)))),Or=a[E+no]+a[E+rn]*(Ar/h.slowDown),a[E+no]=Or,Sr=a[E+Cn]+a[E+nn]*(Ar/h.slowDown),a[E+Cn]=Sr);return{}},Ba={},Bs=10,Uu=3;Ba.assign=function(p){p=p||{};var h=Array.prototype.slice.call(arguments).slice(1),a,f,w;for(a=0,w=h.length;a<w;a++)if(!!h[a])for(f in h[a])p[f]=h[a][f];return p};Ba.validateSettings=function(p){return"linLogMode"in p&&typeof p.linLogMode!="boolean"?{message:"the `linLogMode` setting should be a boolean."}:"outboundAttractionDistribution"in p&&typeof p.outboundAttractionDistribution!="boolean"?{message:"the `outboundAttractionDistribution` setting should be a boolean."}:"adjustSizes"in p&&typeof p.adjustSizes!="boolean"?{message:"the `adjustSizes` setting should be a boolean."}:"edgeWeightInfluence"in p&&typeof p.edgeWeightInfluence!="number"?{message:"the `edgeWeightInfluence` setting should be a number."}:"scalingRatio"in p&&!(typeof p.scalingRatio=="number"&&p.scalingRatio>=0)?{message:"the `scalingRatio` setting should be a number >= 0."}:"strongGravityMode"in p&&typeof p.strongGravityMode!="boolean"?{message:"the `strongGravityMode` setting should be a boolean."}:"gravity"in p&&!(typeof p.gravity=="number"&&p.gravity>=0)?{message:"the `gravity` setting should be a number >= 0."}:"slowDown"in p&&!(typeof p.slowDown=="number"||p.slowDown>=0)?{message:"the `slowDown` setting should be a number >= 0."}:"barnesHutOptimize"in p&&typeof p.barnesHutOptimize!="boolean"?{message:"the `barnesHutOptimize` setting should be a boolean."}:"barnesHutTheta"in p&&!(typeof p.barnesHutTheta=="number"&&p.barnesHutTheta>=0)?{message:"the `barnesHutTheta` setting should be a number >= 0."}:null};Ba.graphToByteArrays=function(p,h){var a=p.order,f=p.size,w={},m,E=new Float32Array(a*Bs),R=new Float32Array(f*Uu);return m=0,p.forEachNode(function(H,gt){w[H]=m,E[m]=gt.x,E[m+1]=gt.y,E[m+2]=0,E[m+3]=0,E[m+4]=0,E[m+5]=0,E[m+6]=1,E[m+7]=1,E[m+8]=gt.size||1,E[m+9]=gt.fixed?1:0,m+=Bs}),m=0,p.forEachEdge(function(H,gt,Ut,Qt,Zt,be,ie){var Ze=w[Ut],me=w[Qt],ze=h(H,gt,Ut,Qt,Zt,be,ie);E[Ze+6]+=ze,E[me+6]+=ze,R[m]=Ze,R[m+1]=me,R[m+2]=ze,m+=Uu}),{nodes:E,edges:R}};Ba.assignLayoutChanges=function(p,h,a){var f=0;p.updateEachNodeAttributes(function(w,m){return m.x=h[f],m.y=h[f+1],f+=Bs,a?a(w,m):m})};Ba.readGraphPositions=function(p,h){var a=0;p.forEachNode(function(f,w){h[a]=w.x,h[a+1]=w.y,a+=Bs})};Ba.collectLayoutChanges=function(p,h,a){for(var f=p.nodes(),w={},m=0,E=0,R=h.length;m<R;m+=Bs){if(a){var H=Object.assign({},p.getNodeAttributes(f[E]));H.x=h[m],H.y=h[m+1],H=a(f[E],H),w[f[E]]={x:H.x,y:H.y}}else w[f[E]]={x:h[m],y:h[m+1]};E++}return w};Ba.createWorker=function(h){var a=window.URL||window.webkitURL,f=h.toString(),w=a.createObjectURL(new Blob(["("+f+").call(this);"],{type:"text/javascript"})),m=new Worker(w);return a.revokeObjectURL(w),m};var Zd={linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:1,scalingRatio:1,strongGravityMode:!1,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5},Jd=cu,Qd=Ks.createEdgeWeightGetter,tc=Kd,Gs=Ba,ec=Zd;function dd(p,h,a){if(!Jd(h))throw new Error("graphology-layout-forceatlas2: the given graph is not a valid graphology instance.");typeof a=="number"&&(a={iterations:a});var f=a.iterations;if(typeof f!="number")throw new Error("graphology-layout-forceatlas2: invalid number of iterations.");if(f<=0)throw new Error("graphology-layout-forceatlas2: you should provide a positive number of iterations.");var w=Qd("getEdgeWeight"in a?a.getEdgeWeight:"weight").fromEntry,m=typeof a.outputReducer=="function"?a.outputReducer:null,E=Gs.assign({},ec,a.settings),R=Gs.validateSettings(E);if(R)throw new Error("graphology-layout-forceatlas2: "+R.message);var H=Gs.graphToByteArrays(h,w),gt;for(gt=0;gt<f;gt++)tc(E,H.nodes,H.edges);if(p){Gs.assignLayoutChanges(h,H.nodes,m);return}return Gs.collectLayoutChanges(h,H.nodes)}function rc(p){var h=typeof p=="number"?p:p.order;return{barnesHutOptimize:h>2e3,strongGravityMode:!0,gravity:.05,scalingRatio:10,slowDown:1+Math.log(h)}}var hu=dd.bind(null,!1);hu.assign=dd.bind(null,!0);hu.inferSettings=rc;var nc=hu,oc={913:p=>{var h=Object.prototype.hasOwnProperty,a="~";function f(){}function w(H,gt,Ut){this.fn=H,this.context=gt,this.once=Ut||!1}function m(H,gt,Ut,Qt,Zt){if(typeof Ut!="function")throw new TypeError("The listener must be a function");var be=new w(Ut,Qt||H,Zt),ie=a?a+gt:gt;return H._events[ie]?H._events[ie].fn?H._events[ie]=[H._events[ie],be]:H._events[ie].push(be):(H._events[ie]=be,H._eventsCount++),H}function E(H,gt){--H._eventsCount==0?H._events=new f:delete H._events[gt]}function R(){this._events=new f,this._eventsCount=0}Object.create&&(f.prototype=Object.create(null),new f().__proto__||(a=!1)),R.prototype.eventNames=function(){var H,gt,Ut=[];if(this._eventsCount===0)return Ut;for(gt in H=this._events)h.call(H,gt)&&Ut.push(a?gt.slice(1):gt);return Object.getOwnPropertySymbols?Ut.concat(Object.getOwnPropertySymbols(H)):Ut},R.prototype.listeners=function(H){var gt=a?a+H:H,Ut=this._events[gt];if(!Ut)return[];if(Ut.fn)return[Ut.fn];for(var Qt=0,Zt=Ut.length,be=new Array(Zt);Qt<Zt;Qt++)be[Qt]=Ut[Qt].fn;return be},R.prototype.listenerCount=function(H){var gt=a?a+H:H,Ut=this._events[gt];return Ut?Ut.fn?1:Ut.length:0},R.prototype.emit=function(H,gt,Ut,Qt,Zt,be){var ie=a?a+H:H;if(!this._events[ie])return!1;var Ze,me,ze=this._events[ie],re=arguments.length;if(ze.fn){switch(ze.once&&this.removeListener(H,ze.fn,void 0,!0),re){case 1:return ze.fn.call(ze.context),!0;case 2:return ze.fn.call(ze.context,gt),!0;case 3:return ze.fn.call(ze.context,gt,Ut),!0;case 4:return ze.fn.call(ze.context,gt,Ut,Qt),!0;case 5:return ze.fn.call(ze.context,gt,Ut,Qt,Zt),!0;case 6:return ze.fn.call(ze.context,gt,Ut,Qt,Zt,be),!0}for(me=1,Ze=new Array(re-1);me<re;me++)Ze[me-1]=arguments[me];ze.fn.apply(ze.context,Ze)}else{var ir,sr=ze.length;for(me=0;me<sr;me++)switch(ze[me].once&&this.removeListener(H,ze[me].fn,void 0,!0),re){case 1:ze[me].fn.call(ze[me].context);break;case 2:ze[me].fn.call(ze[me].context,gt);break;case 3:ze[me].fn.call(ze[me].context,gt,Ut);break;case 4:ze[me].fn.call(ze[me].context,gt,Ut,Qt);break;default:if(!Ze)for(ir=1,Ze=new Array(re-1);ir<re;ir++)Ze[ir-1]=arguments[ir];ze[me].fn.apply(ze[me].context,Ze)}}return!0},R.prototype.on=function(H,gt,Ut){return m(this,H,gt,Ut,!1)},R.prototype.once=function(H,gt,Ut){return m(this,H,gt,Ut,!0)},R.prototype.removeListener=function(H,gt,Ut,Qt){var Zt=a?a+H:H;if(!this._events[Zt])return this;if(!gt)return E(this,Zt),this;var be=this._events[Zt];if(be.fn)be.fn!==gt||Qt&&!be.once||Ut&&be.context!==Ut||E(this,Zt);else{for(var ie=0,Ze=[],me=be.length;ie<me;ie++)(be[ie].fn!==gt||Qt&&!be[ie].once||Ut&&be[ie].context!==Ut)&&Ze.push(be[ie]);Ze.length?this._events[Zt]=Ze.length===1?Ze[0]:Ze:E(this,Zt)}return this},R.prototype.removeAllListeners=function(H){var gt;return H?(gt=a?a+H:H,this._events[gt]&&E(this,gt)):(this._events=new f,this._eventsCount=0),this},R.prototype.off=R.prototype.removeListener,R.prototype.addListener=R.prototype.on,R.prefixed=a,R.EventEmitter=R,p.exports=R},617:(p,h,a)=>{var f=a(331),w=["stopLayout","calculateLayout"];p.exports=function(){var m=new Worker(URL.createObjectURL(new Blob(['var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{calculateLayout:()=>_n,stopLayout:()=>In});var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function o(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function i(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function a(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function u(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}Object.create,Object.create;const d=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[],i=this._events["*"]||[],a=function(n){for(var o=n.length,i=0;i<o;i++)if(n[i]){var a=n[i],s=a.callback;a.once&&(n.splice(i,1),0===n.length&&delete e._events[t],o--,i--),s.apply(e,r)}};a(o),a(i)},t.prototype.off=function(t,e){if(t)if(e){for(var r=this._events[t]||[],n=r.length,o=0;o<n;o++)r[o].callback===e&&(r.splice(o,1),n--,o--);0===r.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function h(t,e,r,n){for(;t.length;){const o=t.shift();if(r(o))return!0;e.add(o.id),n(o.id).forEach((r=>{e.has(r.id)||(e.add(r.id),t.push(r))}))}return!1}function c(t,e,r,n){if(r(t))return!0;e.add(t.id);for(const o of n(t.id))if(!e.has(o.id)&&c(o,e,r,n))return!0;return!1}class l extends d{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const r=e.find((e=>e.type===t.type&&e.id===t.id&&e.propertyName===t.propertyName));r?r.newValue=t.newValue:e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const r=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),r=this.bothEdgesMap.get(t);r?.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((e=>{e.childrenMap.get(t)?.forEach((t=>{e.parentMap.delete(t.id)})),e.parentMap.delete(t),e.childrenMap.delete(t)})),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){const n=this.getNode(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateNodeDataProperty(t,e,r)}))}))}updateNodeData(...t){const e=t[0],r=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:o})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),o.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),o=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),o.delete(e),i.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.source,o=e;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:o})}))}updateEdgeTarget(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.target,o=e;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:o})}))}updateEdgeDataProperty(t,e,r){const n=this.getEdge(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}updateEdgeData(...t){const e=t[0],r=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:o})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateEdgeDataProperty(t,e,r)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const r=[],n=Array.isArray(t)?t:[t];for(;n.length;){const t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach((t=>{t.children?.forEach((r=>{this.setParent(r.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const r=this.treeIndices.get(e).childrenMap.get(t);return Array.from(r||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const r=[];let n,o=this.getNode(t);for(;n=this.getParent(o.id,e);)r.push(n),o=n;return r}setParent(t,e,r){this.checkTreeExistence(r);const n=this.treeIndices.get(r),o=this.getNode(t),i=n.parentMap.get(t),a=this.getNode(e);n.parentMap.set(t,a),i&&n.childrenMap.get(i.id)?.delete(o);let s=n.childrenMap.get(a.id);s||(s=new Set,n.childrenMap.set(a.id,s)),s.add(o),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:i?.id,newParentId:a.id})}))}dfsTree(t,e,r){return c(this.getNode(t),new Set,e,(t=>this.getChildren(t,r)))}bfsTree(t,e,r){return h([this.getNode(t)],new Set,e,(t=>this.getChildren(t,r)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return h([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return c(this.getNode(t),new Set,e,n)}clone(){const t=this.getAllNodes().map((t=>({...t,data:{...t.data}}))),e=this.getAllEdges().map((t=>({...t,data:{...t.data}}))),r=new l({nodes:t,edges:e});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},n)=>{const o=new Map;t.forEach(((t,e)=>{o.set(e,r.getNode(t.id))}));const i=new Map;e.forEach(((t,e)=>{i.set(e,new Set(Array.from(t).map((t=>r.getNode(t.id)))))})),r.treeIndices.set(n,{parentMap:o,childrenMap:i})})),r}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var f=/-(\\w)/g,g=(function(t){return t.replace(f,(function(t,e){return e?e.toUpperCase():""}))},Object.create(null),Array.isArray),p=function(t){for(var e=[],r=t.length,n=0;n<r;n+=1){e[n]=[];for(var o=0;o<r;o+=1)n===o?e[n][o]=0:0!==t[n][o]&&t[n][o]?e[n][o]=t[n][o]:e[n][o]=1/0}for(var i=0;i<r;i+=1)for(n=0;n<r;n+=1)for(o=0;o<r;o+=1)e[n][o]>e[n][i]+e[i][o]&&(e[n][o]=e[n][i]+e[i][o]);return e},v=function(t,e){var r=t.nodes,n=t.edges,o=[],i={};if(!r)throw new Error("invalid nodes data!");return r&&r.forEach((function(t,e){i[t.id]=e,o.push([])})),null==n||n.forEach((function(t){var r=t.source,n=t.target,a=i[r],s=i[n];void 0!==a&&void 0!==s&&(o[a][s]=1,e||(o[s][a]=1))})),o},y=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},m={}.toString;const w=function(t,e){return m.call(t)==="[object "+e+"]"},x=function(t){return w(t,"Number")};var E=function(t){if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var e=[];return t.forEach((function(t){e.push(t)})),e.map((function(t){return E(t)}))}if("object"==typeof t){var r={};return Object.keys(t).forEach((function(e){r[e]=E(t[e])})),r}return t},b=function(t,e){var r=E(t);return r.data=r.data||{},e&&(x(r.data.x)||(r.data.x=Math.random()*e[0]),x(r.data.y)||(r.data.y=Math.random()*e[1])),r};const N=function(t){return"function"==typeof t},M=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function S(t,e){return N(e)?e:x(e)?function(){return e}:function(){return t}}function k(t,e,r){return void 0===r&&(r=!0),e||0===e?N(e)?e:x(e)?function(){return e}:g(e)?function(){if(r){var n=Math.max.apply(Math,u([],s(e)));return isNaN(n)?t:n}return e}:M(e)?function(){if(r){var n=Math.max(e.width,e.height);return isNaN(n)?t:n}return[e.width,e.height]}:function(){return t}:function(e){var r=(e.data||{}).size;return r?g(r)?r[0]>r[1]?r[0]:r[1]:M(r)?r.width>r.height?r.width:r.height:r:t}}var A=function(t,e){var r;return r=x(e)?function(){return e}:N(e)?e:function(){return 0},t?g(t)?function(e){return(t[0]>t[1]?t[0]:t[1])+r(e)}:function(e){return t+r(e)}:function(t){var e,n;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return Math.max(t.data.bboxSize[0],t.data.bboxSize[1])+r(t);if(null===(n=t.data)||void 0===n?void 0:n.size){if(g(t.data.size))return Math.max(t.data.size[0],t.data.size[1])+r(t);var o=t.data.size;return M(o)?(o.width>o.height?o.width:o.height)+r(t):o+r(t)}return 10+r(t)}},R=function(t,e,r){var o=t.getAllNodes(),i=t.getAllEdges();return(null==o?void 0:o.length)?1===o.length?(e&&t.mergeNodeData(o[0].id,{x:r[0],y:r[1]}),{nodes:[n(n({},o[0]),{data:n(n({},o[0].data),{x:r[0],y:r[1]})})],edges:i}):void 0:{nodes:[],edges:i}},I={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},_=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="circular",this.options=n(n({},I),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericCircularLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericCircularLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericCircularLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,u,d,h,c,l,f,g,p,v,y,m,w,x,E,N,M,A,I,_,P,T,z,C,L,q,j,F,V,G,W,B,$,U;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,u=o.height,d=o.center,h=o.divisions,c=o.startAngle,l=void 0===c?0:c,f=o.endAngle,g=void 0===f?2*Math.PI:f,p=o.angleRatio,v=o.ordering,y=o.clockwise,m=o.nodeSpacing,w=o.nodeSize,x=e.getAllNodes(),E=e.getAllEdges(),N=s(O(i,u,d),3),M=N[0],A=N[1],I=N[2],!(_=null==x?void 0:x.length)||1===_)return[2,R(e,t,I)];for(P=(g-l)/_,T=o.radius,z=o.startRadius,C=o.endRadius,m?(L=S(10,m),q=k(10,w),j=-1/0,x.forEach((function(t){var e=q(t);j<e&&(j=e)})),F=0,x.forEach((function(t,e){F+=0===e?j||10:(L(t)||0)+(j||10)})),T=F/(2*Math.PI)):T||z||C?!z&&C?z=C:z&&!C&&(C=z):T=Math.min(A,M)/2,V=P*p,G=[],G="topology"===v?D(e,x):"topology-directed"===v?D(e,x,!0):"degree"===v?function(t,e){var r=[];return e.forEach((function(t,e){r.push(b(t))})),r.sort((function(e,r){return t.getDegree(e.id,"both")-t.getDegree(r.id,"both")})),r}(e,x):x.map((function(t){return b(t)})),W=Math.ceil(_/h),B=0;B<_;++B)($=T)||null===z||null===C||($=z+B*(C-z)/(_-1)),$||($=10+100*B/(_-1)),U=l+B%W*V+2*Math.PI/h*Math.floor(B/W),y||(U=g-B%W*V-2*Math.PI/h*Math.floor(B/W)),G[B].data.x=I[0]+Math.cos(U)*$,G[B].data.y=I[1]+Math.sin(U)*$;return t&&G.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:G,edges:E}]}))}))},t}(),D=function(t,e,r){void 0===r&&(r=!1);var n=[b(e[0])],o={},i=e.length;o[e[0].id]=!0;var a=0;return e.forEach((function(s,u){if(0!==u)if(u!==i-1&&t.getDegree(s.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(n[a].id,s.id)||o[s.id]){for(var d=r?t.getSuccessors(n[a].id):t.getNeighbors(n[a].id),h=!1,c=0;c<d.length;c++){var l=d[c];if(t.getDegree(l.id)===t.getDegree(s.id)&&!o[l.id]){n.push(b(l)),o[l.id]=!0,h=!0;break}}for(var f=0;!h&&(o[e[f].id]||(n.push(b(e[f])),o[e[f].id]=!0,h=!0),++f!==i););}else n.push(b(s)),o[s.id]=!0,a++})),n},O=function(t,e,r){var n=t,o=e,i=r;return n||"undefined"==typeof window||(n=window.innerWidth),o||"undefined"==typeof window||(o=window.innerHeight),i||(i=[n/2,o/2]),[n,o,i]};const P=function(t){return w(t,"String")};var T={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},z=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="concentric",this.options=n(n({},T),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericConcentricLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericConcentricLayout(!0,t,e),[2]}))}))},t.prototype.genericConcentricLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,p,v,y,m,w,E,S,k,A,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K,Y;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,d=o.sortBy,h=o.maxLevelDiff,c=o.sweep,l=o.clockwise,f=o.equidistant,p=o.preventOverlap,v=o.startAngle,y=void 0===v?1.5*Math.PI:v,m=o.nodeSize,w=o.nodeSpacing,E=e.getAllNodes(),S=e.getAllEdges(),k=s||"undefined"==typeof window?s:window.innerWidth,A=u||"undefined"==typeof window?u:window.innerHeight,I=i||[k/2,A/2],!(null==E?void 0:E.length)||1===E.length)return[2,R(e,t,I)];if(_=[],O=0,D=g(m)?Math.max(m[0],m[1]):m,g(w)?O=Math.max(w[0],w[1]):x(w)&&(O=w),E.forEach((function(t){var e=b(t);_.push(e);var r=D,n=e.data;g(n.size)?r=Math.max(n.size[0],n.size[1]):x(n.size)?r=n.size:M(n.size)&&(r=Math.max(n.size.width,n.size.height)),D=Math.max(D,r),N(w)&&(O=Math.max(w(t),O))})),T={},_.forEach((function(t,e){T[t.id]=e})),P(z=d)&&void 0!==_[0].data[z]||(z="degree"),"degree"===z?_.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):_.sort((function(t,e){return e.data[z]-t.data[z]})),C=_[0],L=(h||("degree"===z?e.getDegree(C.id,"both"):C.data[z]))/4,j=(q=[{nodes:[]}])[0],_.forEach((function(t){if(j.nodes.length>0){var r="degree"===z?Math.abs(e.getDegree(j.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(j.nodes[0].data[z]-t.data[z]);L&&r>=L&&(j={nodes:[]},q.push(j))}j.nodes.push(t)})),F=D+O,p||(V=q.length>0&&q[0].nodes.length>1,G=Math.min(k,A)/2-F,W=G/(q.length+(V?1:0)),F=Math.min(F,W)),B=0,q.forEach((function(t){var e=void 0===c?2*Math.PI-2*Math.PI/t.nodes.length:c;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&p){var r=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),o=Math.sqrt(F*F/(r*r+n*n));B=Math.max(o,B)}t.r=B,B+=F})),f){for($=0,U=0,H=0;H<q.length;H++)K=q[H],Y=(K.r||0)-U,$=Math.max($,Y);U=0,q.forEach((function(t,e){0===e&&(U=t.r||0),t.r=U,U+=$}))}return q.forEach((function(t){var e=t.dTheta||0,r=t.r||0;t.nodes.forEach((function(t,n){var o=y+(l?1:-1)*e*n;t.data.x=I[0]+r*Math.cos(o),t.data.y=I[1]+r*Math.sin(o)}))})),t&&_.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:_,edges:S}]}))}))},t}();function C(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i,a,s,u,d,h,c,l,f=t._root,g={data:n},p=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!f)return t._root=g,t;for(;f.length;)if((d=e>=(i=(p+y)/2))?p=i:y=i,(h=r>=(a=(v+m)/2))?v=a:m=a,o=f,!(f=f[c=h<<1|d]))return o[c]=g,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&r===u)return g.next=f,o?o[c]=g:t._root=g,t;do{o=o?o[c]=new Array(4):t._root=new Array(4),(d=e>=(i=(p+y)/2))?p=i:y=i,(h=r>=(a=(v+m)/2))?v=a:m=a}while((c=h<<1|d)==(l=(u>=a)<<1|s>=i));return o[l]=f,o[c]=g,t}function L(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function q(t){return t[0]}function j(t){return t[1]}function F(t,e,r){var n=new V(null==e?q:e,null==r?j:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function V(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function G(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var W=F.prototype=V.prototype;function B(t){return function(){return t}}function $(t){return 1e-6*(t()-.5)}W.copy=function(){var t,e,r=new V(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=G(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var o=0;o<4;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(4)}):n.target[o]=G(e));return r},W.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return C(this.cover(e,r),e,r,t)},W.addAll=function(t){var e,r,n,o,i=t.length,a=new Array(i),s=new Array(i),u=1/0,d=1/0,h=-1/0,c=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(a[r]=n,s[r]=o,n<u&&(u=n),n>h&&(h=n),o<d&&(d=o),o>c&&(c=o));if(u>h||d>c)return this;for(this.cover(u,d).cover(h,c),r=0;r<i;++r)C(this,a[r],s[r],t[r]);return this},W.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var a,s,u=o-r||1,d=this._root;r>t||t>=o||n>e||e>=i;)switch(s=(e<n)<<1|t<r,(a=new Array(4))[s]=d,d=a,u*=2,s){case 0:o=r+u,i=n+u;break;case 1:r=o-u,i=n+u;break;case 2:o=r+u,n=i-u;break;case 3:r=o-u,n=i-u}this._root&&this._root.length&&(this._root=d)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this},W.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},W.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},W.find=function(t,e,r){var n,o,i,a,s,u,d,h=this._x0,c=this._y0,l=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new L(p,h,c,l,f)),null==r?r=1/0:(h=t-r,c=e-r,l=t+r,f=e+r,r*=r);u=g.pop();)if(!(!(p=u.node)||(o=u.x0)>l||(i=u.y0)>f||(a=u.x1)<h||(s=u.y1)<c))if(p.length){var v=(o+a)/2,y=(i+s)/2;g.push(new L(p[3],v,y,a,s),new L(p[2],o,y,v,s),new L(p[1],v,i,a,y),new L(p[0],o,i,v,y)),(d=(e>=y)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-d],g[g.length-1-d]=u)}else{var m=t-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),x=m*m+w*w;if(x<r){var E=Math.sqrt(r=x);h=t-E,c=e-E,l=t+E,f=e+E,n=p.data}}return n},W.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,r,n,o,i,a,s,u,d,h,c,l,f=this._root,g=this._x0,p=this._y0,v=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((d=i>=(s=(g+v)/2))?g=s:v=s,(h=a>=(u=(p+y)/2))?p=u:y=u,e=f,!(f=f[c=h<<1|d]))return this;if(!f.length)break;(e[c+1&3]||e[c+2&3]||e[c+3&3])&&(r=e,l=c)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(o=f.next)&&delete f.next,n?(o?n.next=o:delete n.next,this):e?(o?e[c]=o:delete e[c],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[l]=f:this._root=f),this):(this._root=o,this)},W.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},W.root=function(){return this._root},W.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},W.visit=function(t){var e,r,n,o,i,a,s=[],u=this._root;for(u&&s.push(new L(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,n=e.x0,o=e.y0,i=e.x1,a=e.y1)&&u.length){var d=(n+i)/2,h=(o+a)/2;(r=u[3])&&s.push(new L(r,d,h,i,a)),(r=u[2])&&s.push(new L(r,n,h,d,a)),(r=u[1])&&s.push(new L(r,d,o,i,h)),(r=u[0])&&s.push(new L(r,n,o,d,h))}return this},W.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new L(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.x1,d=e.y1,h=(a+u)/2,c=(s+d)/2;(i=o[0])&&r.push(new L(i,a,s,h,c)),(i=o[1])&&r.push(new L(i,h,s,u,c)),(i=o[2])&&r.push(new L(i,a,c,h,d)),(i=o[3])&&r.push(new L(i,h,c,u,d))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},W.x=function(t){return arguments.length?(this._x=t,this):this._x},W.y=function(t){return arguments.length?(this._y=t,this):this._y};var U={value:()=>{}};function H(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new K(n)}function K(t){this._=t}function Y(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function J(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=U,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}K.prototype=H.prototype={constructor:K,on:function(t,e){var r,n,o=this._,i=(n=o,(t+"").trim().split(/^|\\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)o[r]=J(o[r],t.name,e);else if(null==e)for(r in o)o[r]=J(o[r],t.name,null);return this}for(;++a<s;)if((r=(t=i[a]).type)&&(r=Y(o[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new K(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};const X=H;var Q,Z,tt=0,et=0,rt=0,nt=1e3,ot=0,it=0,at=0,st="object"==typeof performance&&performance.now?performance:Date,ut="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function dt(){return it||(ut(ht),it=st.now()+at)}function ht(){it=0}function ct(){this._call=this._time=this._next=null}function lt(t,e,r){var n=new ct;return n.restart(t,e,r),n}function ft(){it=(ot=st.now())+at,tt=et=0;try{!function(){dt(),++tt;for(var t,e=Q;e;)(t=it-e._time)>=0&&e._call.call(void 0,t),e=e._next;--tt}()}finally{tt=0,function(){for(var t,e,r=Q,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:Q=e);Z=t,pt(n)}(),it=0}}function gt(){var t=st.now(),e=t-ot;e>nt&&(at-=e,ot=t)}function pt(t){tt||(et&&(et=clearTimeout(et)),t-it>24?(t<1/0&&(et=setTimeout(ft,t-st.now()-at)),rt&&(rt=clearInterval(rt))):(rt||(ot=st.now(),rt=setInterval(gt,nt)),tt=1,ut(ft)))}ct.prototype=lt.prototype={constructor:ct,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?dt():+r)+(null==e?0:+e),this._next||Z===this||(Z?Z._next=this:Q=this,Z=this),this._call=t,this._time=r,pt()},stop:function(){this._call&&(this._call=null,this._time=1/0,pt())}};const vt=1664525,yt=1013904223,mt=4294967296;function wt(t){return t.x}function xt(t){return t.y}var Et=10,bt=Math.PI*(3-Math.sqrt(5));function Nt(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,a=.6,s=new Map,u=lt(c),d=X("tick","end"),h=function(){let t=1;return()=>(t=(vt*t+yt)%mt)/mt}();function c(){l(),d.call("tick",e),r<n&&(u.stop(),d.call("end",e))}function l(n){var u,d,h=t.length;void 0===n&&(n=1);for(var c=0;c<n;++c)for(r+=(i-r)*o,s.forEach((function(t){t(r)})),u=0;u<h;++u)null==(d=t[u]).fx?d.x+=d.vx*=a:(d.x=d.fx,d.vx=0),null==d.fy?d.y+=d.vy*=a:(d.y=d.fy,d.vy=0);return e}function f(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var o=Et*Math.sqrt(.5+r),i=r*bt;e.x=o*Math.cos(i),e.y=o*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,h),e}return null==t&&(t=[]),f(),e={tick:l,restart:function(){return u.restart(c),e},stop:function(){return u.stop(),e},nodes:function(r){return arguments.length?(t=r,f(),s.forEach(g),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(h=t,s.forEach(g),e):h},force:function(t,r){return arguments.length>1?(null==r?s.delete(t):s.set(t,g(r)),e):s.get(t)},find:function(e,r,n){var o,i,a,s,u,d=0,h=t.length;for(null==n?n=1/0:n*=n,d=0;d<h;++d)(a=(o=e-(s=t[d]).x)*o+(i=r-s.y)*i)<n&&(u=s,n=a);return u},on:function(t,r){return arguments.length>1?(d.on(t,r),e):d.on(t)}}}function Mt(){var t,e,r,n,o,i=B(-30),a=1,s=1/0,u=.81;function d(r){var o,i=t.length,a=F(t,wt,xt).visitAfter(c);for(n=r,o=0;o<i;++o)e=t[o],a.visit(l)}function h(){if(t){var e,r,n=t.length;for(o=new Array(n),e=0;e<n;++e)r=t[e],o[r.index]=+i(r,e,t)}}function c(t){var e,r,n,i,a,s=0,u=0;if(t.length){for(n=i=a=0;a<4;++a)(e=t[a])&&(r=Math.abs(e.value))&&(s+=e.value,u+=r,n+=r*e.x,i+=r*e.y);t.x=n/u,t.y=i/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=o[e.data.index]}while(e=e.next)}t.value=s}function l(t,i,d,h){if(!t.value)return!0;var c=t.x-e.x,l=t.y-e.y,f=h-i,g=c*c+l*l;if(f*f/u<g)return g<s&&(0===c&&(g+=(c=$(r))*c),0===l&&(g+=(l=$(r))*l),g<a&&(g=Math.sqrt(a*g)),e.vx+=c*t.value*n/g,e.vy+=l*t.value*n/g),!0;if(!(t.length||g>=s)){(t.data!==e||t.next)&&(0===c&&(g+=(c=$(r))*c),0===l&&(g+=(l=$(r))*l),g<a&&(g=Math.sqrt(a*g)));do{t.data!==e&&(f=o[t.data.index]*n/g,e.vx+=c*f,e.vy+=l*f)}while(t=t.next)}}return d.initialize=function(e,n){t=e,r=n,h()},d.strength=function(t){return arguments.length?(i="function"==typeof t?t:B(+t),h(),d):i},d.distanceMin=function(t){return arguments.length?(a=t*t,d):Math.sqrt(a)},d.distanceMax=function(t){return arguments.length?(s=t*t,d):Math.sqrt(s)},d.theta=function(t){return arguments.length?(u=t*t,d):Math.sqrt(u)},d}function St(t){return t.index}function kt(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function At(t){var e,r,n,o,i,a,s=St,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},d=B(30),h=1;function c(n){for(var o=0,s=t.length;o<h;++o)for(var u,d,c,l,f,g,p,v=0;v<s;++v)d=(u=t[v]).source,l=(c=u.target).x+c.vx-d.x-d.vx||$(a),f=c.y+c.vy-d.y-d.vy||$(a),l*=g=((g=Math.sqrt(l*l+f*f))-r[v])/g*n*e[v],f*=g,c.vx-=l*(p=i[v]),c.vy-=f*p,d.vx+=l*(p=1-p),d.vy+=f*p}function l(){if(n){var a,u,d=n.length,h=t.length,c=new Map(n.map(((t,e)=>[s(t,e,n),t])));for(a=0,o=new Array(d);a<h;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=kt(c,u.source)),"object"!=typeof u.target&&(u.target=kt(c,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(a=0,i=new Array(h);a<h;++a)u=t[a],i[a]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);e=new Array(h),f(),r=new Array(h),g()}}function f(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+u(t[r],r,t)}function g(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+d(t[e],e,t)}return null==t&&(t=[]),c.initialize=function(t,e){n=t,a=e,l()},c.links=function(e){return arguments.length?(t=e,l(),c):t},c.id=function(t){return arguments.length?(s=t,c):s},c.iterations=function(t){return arguments.length?(h=+t,c):h},c.strength=function(t){return arguments.length?(u="function"==typeof t?t:B(+t),f(),c):u},c.distance=function(t){return arguments.length?(d="function"==typeof t?t:B(+t),g(),c):d},c}function Rt(t){return t.x+t.vx}function It(t){return t.y+t.vy}function _t(t){var e,r,n,o=1,i=1;function a(){for(var t,a,u,d,h,c,l,f=e.length,g=0;g<i;++g)for(a=F(e,Rt,It).visitAfter(s),t=0;t<f;++t)u=e[t],c=r[u.index],l=c*c,d=u.x+u.vx,h=u.y+u.vy,a.visit(p);function p(t,e,r,i,a){var s=t.data,f=t.r,g=c+f;if(!s)return e>d+g||i<d-g||r>h+g||a<h-g;if(s.index>u.index){var p=d-s.x-s.vx,v=h-s.y-s.vy,y=p*p+v*v;y<g*g&&(0===p&&(y+=(p=$(n))*p),0===v&&(y+=(v=$(n))*v),y=(g-(y=Math.sqrt(y)))/y*o,u.vx+=(p*=y)*(g=(f*=f)/(l+f)),u.vy+=(v*=y)*g,s.vx-=p*(g=1-g),s.vy-=v*g)}}}function s(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var n,o,i=e.length;for(r=new Array(i),n=0;n<i;++n)o=e[n],r[o.index]=+t(o,n,e)}}return"function"!=typeof t&&(t=B(null==t?1:+t)),a.initialize=function(t,r){e=t,n=r,u()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(o=+t,a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),u(),a):t},a}function Dt(t){var e,r,n,o=B(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=B(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:B(+t),a(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),a(),i):t},i}function Ot(t){var e,r,n,o=B(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=B(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:B(+t),a(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),a(),i):t},i}function Pt(){function t(t){return function(){return t}}var e,r=function(t){return t.cluster},n=t(1),o=t(-1),i=t(100),a=t(.1),u=[0,0],d=[],h={},c=[],l=100,f=100,g={none:{x:0,y:0}},p=[],v="force",y=!0,m=.1;function w(t){if(!y)return w;e.tick(),E();for(var n=0,o=d.length,i=void 0,a=t*m;n<o;++n)(i=d[n]).vx+=(g[r(i)].x-i.x)*a,i.vy+=(g[r(i)].y-i.y)*a}function x(){d&&function(){if(d&&d.length){if(void 0===r(d[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy(\'clusterAttr\') before calling .links()");var t,u,g,v,y,m=(t=[],u=[],g={},{},y=[],v=function(t){var e={};return t.forEach((function(t){var n=r(t);e[n]||(e[n]={count:0,sumforceNodeSize:0})})),t.forEach((function(t){var o=r(t),i=n(t),a=e[o];a.count=a.count+1,a.sumforceNodeSize=a.sumforceNodeSize+Math.PI*(i*i)*1.3,e[o]=a})),e}(d),y=function(t){var e={},n=[];return t.forEach((function(t){var n,o,i,a,s,u=(o=(n=t).source,i=n.target,(a=r(h[o]))<=(s=r(h[i]))?a+"~"+s:s+"~"+a),d=0;void 0!==e[u]&&(d=e[u]),d+=1,e[u]=d})),Object.entries(e).forEach((function(t){var e=s(t,2),r=e[0],o=e[1],i=r.split("~")[0],a=r.split("~")[1];void 0!==i&&void 0!==a&&n.push({source:i,target:a,count:o})})),n}(c),Object.keys(v).forEach((function(e,r){var n=v[e];t.push({id:e,size:n.count,r:Math.sqrt(n.sumforceNodeSize/Math.PI)}),g[e]=r})),y.forEach((function(t){var e=t.source,r=t.target,n=g[e],o=g[r];void 0!==n&&void 0!==o&&u.push({source:n,target:o,count:t.count})})),{nodes:t,links:u});e=Nt(m.nodes).force("x",Dt(l).strength(.1)).force("y",Ot(f).strength(.1)).force("collide",_t((function(t){return t.r})).iterations(4)).force("charge",Mt().strength(o)).force("links",At(m.nodes.length?m.links:[]).distance(i).strength(a)),p=e.nodes(),E()}}()}function E(){return g={none:{x:0,y:0}},p.forEach((function(t){g[t.id]={x:t.x-u[0],y:t.y-u[1]}})),g}return w.initialize=function(t){d=t,x()},w.template=function(t){return arguments.length?(v=t,x(),w):v},w.groupBy=function(t){return arguments.length?"string"==typeof t?(r=function(e){return e[t]},w):(r=t,w):r},w.enableGrouping=function(t){return arguments.length?(y=t,w):y},w.strength=function(t){return arguments.length?(m=t,w):m},w.centerX=function(t){return arguments.length?(l=t,w):l},w.centerY=function(t){return arguments.length?(f=t,w):f},w.nodes=function(t){return arguments.length?(function(t){h={},t.forEach((function(t){h[t.id]=t}))}(t||[]),d=t||[],w):d},w.links=function(t){return arguments.length?(c=t||[],x(),w):c},w.forceNodeSize=function(e){return arguments.length?(n="function"==typeof e?e:t(+e),x(),w):n},w.nodeSize=w.forceNodeSize,w.forceCharge=function(e){return arguments.length?(o="function"==typeof e?e:t(+e),x(),w):o},w.forceLinkDistance=function(e){return arguments.length?(i="function"==typeof e?e:t(+e),x(),w):i},w.forceLinkStrength=function(e){return arguments.length?(a="function"==typeof e?e:t(+e),x(),w):a},w.offset=function(t){return arguments.length?(u=t,w):u},w.getFocis=E,w}var Tt={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},zt=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="d3force",this.options=n(n({},Tt),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){var t;null===(t=this.forceSimulation)||void 0===t||t.stop()},t.prototype.tick=function(t){var e=this;void 0===t&&(t=1),this.forceSimulation.tick(t);var r={nodes:Ct(this.lastLayoutNodes),edges:Lt(this.lastLayoutEdges)};return this.lastAssign&&r.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,g,p,v,y,m,w,x,E,N,M,S,k,A,R,I,_,D,O=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=i.map((function(t){var e,r;return n(n({},b(t)),{x:null===(e=t.data)||void 0===e?void 0:e.x,y:null===(r=t.data)||void 0===r?void 0:r.y})})),d=s.map((function(t){return b(t)})),this.lastLayoutNodes=u,this.lastLayoutEdges=d,this.lastAssign=t,this.lastGraph=e,h=o.alphaMin,c=o.alphaDecay,l=o.alpha,f=o.nodeStrength,g=o.edgeStrength,p=o.linkDistance,v=o.clustering,y=o.clusterFociStrength,m=o.clusterEdgeDistance,w=o.clusterEdgeStrength,x=o.clusterNodeStrength,E=o.clusterNodeSize,N=o.collideStrength,M=void 0===N?1:N,S=o.center,k=void 0===S?[0,0]:S,A=o.preventOverlap,R=o.nodeSize,I=o.nodeSpacing,_=o.onTick,D=o.forceSimulation,[2,new Promise((function(r){if(D){v&&((i=Pt()).nodes(u),i.links(d)),D.nodes(u),d&&(s=At().id((function(t){return t.id})).links(d),g&&s.strength(g),p&&s.distance(p),D.force("link",s)),A&&O.overlapProcess(D,{nodeSize:R,nodeSpacing:I,collideStrength:M}),D.alpha(l).restart();var n=Ct(u),o=Lt(d);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:o})}else try{var i,a=Mt();if(f&&a.strength(f),D=Nt().nodes(u),v&&((i=Pt()).centerX(k[0]).centerY(k[1]).template("force").strength(y),d&&i.links(d),u&&i.nodes(u),i.forceLinkDistance(m).forceLinkStrength(w).forceCharge(x).forceNodeSize(E),D.force("group",i)),D.force("center",function(t,e){var r,n=1;function o(){var o,i,a=r.length,s=0,u=0;for(o=0;o<a;++o)s+=(i=r[o]).x,u+=i.y;for(s=(s/a-t)*n,u=(u/a-e)*n,o=0;o<a;++o)(i=r[o]).x-=s,i.y-=u}return null==t&&(t=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(n=+t,o):n},o}(k[0],k[1])).force("charge",a).alpha(l).alphaDecay(c).alphaMin(h),A&&O.overlapProcess(D,{nodeSize:R,nodeSpacing:I,collideStrength:M}),d){var s=At().id((function(t){return t.id})).links(d);g&&s.strength(g),p&&s.distance(p),D.force("link",s)}D.on("tick",(function(){var r=Ct(u);null==_||_({nodes:r,edges:Lt(d)}),t&&r.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}))})).on("end",(function(){var n=Ct(u);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:Lt(d)})}))}catch(t){console.warn(t)}O.forceSimulation=D}))]}))}))},t.prototype.overlapProcess=function(t,e){var r,n,o=e.nodeSize,i=e.nodeSpacing,a=e.collideStrength;if(n=x(i)?function(){return i}:N(i)?i:function(){return 0},o)if(N(o))r=function(t){return o(t)+n(t)};else if(g(o)){var s=(o[0]>o[1]?o[0]:o[1])/2;r=function(t){return s+n(t)}}else if(x(o)){var u=o/2;r=function(t){return u+n(t)}}else r=function(){return 10};else r=function(t){return t.size?g(t.size)?(t.size[0]>t.size[1]?t.size[0]:t.size[1])/2+n(t):M(t.size)?(t.size.width>t.size.height?t.size.width:t.size.height)/2+n(t):t.size/2+n(t):10+n(t)};t.force("collisionForce",_t(r).strength(a))},t}(),Ct=function(t){return t.map((function(t){var e=t.x,r=t.y,i=o(t,["x","y"]);return n(n({},i),{data:n(n({},i.data),{x:e,y:r})})}))},Lt=function(t){return t.map((function(t){var e=t.source,r=t.target,i=o(t,["source","target"]);return n(n({},i),{source:e.id,target:r.id})}))};var qt=function(t,e){if("next"!==t&&"prev"!==t)return e},jt=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(function(){function t(){var t={};t.prev=t,t.next=t.prev,this.shortcut=t}return t.prototype.dequeue=function(){var t=this.shortcut,e=t.prev;if(e&&e!==t)return jt(e),e},t.prototype.enqueue=function(t){var e=this.shortcut;t.prev&&t.next&&jt(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e},t.prototype.toString=function(){for(var t=[],e=this.shortcut,r=e.prev;r!==e;)t.push(JSON.stringify(r,qt)),r=null==r?void 0:r.prev;return"["+t.join(", ")+"]"},t}()),Vt=function(){return 1},Gt=function(t,e,r,o,i){var a,s,u=[];return t.hasNode(o.v)&&(null===(a=t.getRelatedEdges(o.v,"in"))||void 0===a||a.forEach((function(o){var a=o.data.weight,s=t.getNode(o.source);i&&u.push({v:o.source,w:o.target,in:0,out:0}),void 0===s.data.out&&(s.data.out=0),s.data.out-=a,Wt(e,r,n({v:s.id},s.data))})),null===(s=t.getRelatedEdges(o.v,"out"))||void 0===s||s.forEach((function(o){var i=o.data.weight,a=o.target,s=t.getNode(a);void 0===s.data.in&&(s.data.in=0),s.data.in-=i,Wt(e,r,n({v:s.id},s.data))})),t.removeNode(o.v)),i?u:void 0},Wt=function(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},Bt=function(t,e){var r="greedy"===e?function(t,e){var r;if(t.getAllNodes().length<=1)return[];var o=function(t,e){var r=new l,o=0,i=0;t.getAllNodes().forEach((function(t){r.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((function(t){var a=r.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target})),s=(null==e?void 0:e(t))||1;a?r.updateEdgeData(null==a?void 0:a.id,n(n({},a.data),{weight:a.data.weight+s})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:s}}),i=Math.max(i,r.getNode(t.source).data.out+=s),o=Math.max(o,r.getNode(t.target).data.in+=s)}));for(var a=[],s=i+o+3,u=0;u<s;u++)a.push(new Ft);var d=o+1;return r.getAllNodes().forEach((function(t){Wt(a,d,n({v:t.id},r.getNode(t.id).data))})),{buckets:a,zeroIdx:d,graph:r}}(t,function(t){return t.data.weight||1}||Vt);return null===(r=function(t,e,r){for(var n,o=[],i=e[e.length-1],a=e[0];t.getAllNodes().length;){for(;n=a.dequeue();)Gt(t,e,r,n);for(;n=i.dequeue();)Gt(t,e,r,n);if(t.getAllNodes().length)for(var s=e.length-2;s>0;--s)if(n=e[s].dequeue()){o=o.concat(Gt(t,e,r,n,!0));break}}return o}(o.graph,o.buckets,o.zeroIdx).map((function(e){return t.getRelatedEdges(e.v,"out").filter((function(t){return t.target===e.w}))})))||void 0===r?void 0:r.flat()}(t):$t(t);null==r||r.forEach((function(e){var r=e.data;t.removeEdge(e.id),r.forwardName=e.data.name,r.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:n({},r)})}))},$t=function(t){var e=[],r={},n={},o=function(i){n[i]||(n[i]=!0,r[i]=!0,t.getRelatedEdges(i,"out").forEach((function(t){r[t.target]?e.push(t):o(t.target)})),delete r[i])};return t.getAllNodes().forEach((function(t){return o(t.id)})),e},Ut=function(t,e,r,n){var o;do{o=""+n+Math.random()}while(t.hasNode(o));return r.dummy=e,t.addNode({id:o,data:r}),o},Ht=function(t){var e=new l;return t.getAllNodes().forEach((function(r){t.getChildren(r.id).length||e.addNode(n({},r))})),t.getAllEdges().forEach((function(t){e.addEdge(t)})),e},Kt=function(t,e){var r,n,o=Number(t.x),i=Number(t.y),a=Number(e.x)-o,s=Number(e.y)-i,u=Number(t.width)/2,d=Number(t.height)/2;return a||s?(Math.abs(s)*u>Math.abs(a)*d?(s<0&&(d=-d),r=d*a/s,n=d):(a<0&&(u=-u),r=u,n=u*s/a),{x:o+r,y:i+n}):{x:0,y:0}},Yt=function(t){for(var e=[],r=Xt(t)+1,n=0;n<r;n++)e.push([]);for(t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)})),n=0;n<r;n++)e[n]=e[n].sort((function(e,r){return n=t.getNode(e).data.order,o=t.getNode(r).data.order,Number(n)-Number(o);var n,o}));return e},Jt=function(t,e,r,n){var o={width:0,height:0};return x(r)&&x(n)&&(o.rank=r,o.order=n),Ut(t,"border",o,e)},Xt=function(t){var e;return t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)})),e||(e=0),e},Qt=function(t,e){return t.reduce((function(t,r){return e(t)>e(r)?r:t}))},Zt=function(t,e,r,n,o,i){n.includes(e.id)||(n.push(e.id),r||i.push(e.id),o(e.id).forEach((function(e){return Zt(t,e,r,n,o,i)})),r&&i.push(e.id))},te=function(t,e,r,n){var o=Array.isArray(e)?e:[e],i=function(e){return n?t.getSuccessors(e):t.getNeighbors(e)},a=[],s=[];return o.forEach((function(e){if(!t.hasNode(e.id))throw new Error("Graph does not have node: "+e);Zt(t,e,"post"===r,s,i,a)})),a},ee="edge-label",re=function(t){var e={},r=function(n){var o,i,a=t.getNode(n);return a?e[n]?a.data.rank:(e[n]=!0,null===(o=t.getRelatedEdges(n,"out"))||void 0===o||o.forEach((function(t){var e=r(t.target)-t.data.minlen;e&&(void 0===i||e<i)&&(i=e)})),i||(i=0),a.data.rank=i,i):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){return r(t.id)}))},ne=function(t,e){return t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen},oe=function(t,e){var r=function(n){e.getRelatedEdges(n,"both").forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ie=function(t,e){var r=function(n){var o;null===(o=e.getRelatedEdges(n,"both"))||void 0===o||o.forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||void 0===e.getNode(a).data.layer&&ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ae=function(t,e){return Qt(e.getAllEdges(),(function(r){return t.hasNode(r.source)!==t.hasNode(r.target)?ne(e,r):1/0}))},se=function(t,e,r){t.getAllNodes().forEach((function(t){var n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r}))},ue=function(t,e){var r=te(t,t.getAllNodes(),"post",!1);(r=r.slice(0,(null==r?void 0:r.length)-1)).forEach((function(r){de(t,e,r)}))},de=function(t,e,r){var n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find((function(t){return t.target===n||t.source===n})).data.cutvalue=he(t,e,r)},he=function(t,e,r){var n=t.getNode(r).data.parent,o=!0,i=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),a=0;return i||(o=!1,i=e.getRelatedEdges(n,"out").find((function(t){return t.target===r}))),a=i.data.weight,e.getRelatedEdges(r,"both").forEach((function(e){var i=e.source===r,s=i?e.target:e.source;if(s!==n){var u=i===o,d=e.data.weight;if(a+=u?d:-d,ye(t,r,s)){var h=t.getRelatedEdges(r,"both").find((function(t){return t.source===s||t.target===s})).data.cutvalue;a+=u?-h:h}}})),a},ce=function(t,e){void 0===e&&(e=t.getAllNodes()[0].id),le(t,{},1,e)},le=function(t,e,r,n,o){var i,a=r,s=r,u=t.getNode(n);return e[n]=!0,null===(i=t.getNeighbors(n))||void 0===i||i.forEach((function(r){e[r.id]||(s=le(t,e,s,r.id,n))})),u.data.low=a,u.data.lim=s++,o?u.data.parent=o:delete u.data.parent,s},fe=function(t){return t.getAllEdges().find((function(t){return t.data.cutvalue<0}))},ge=function(t,e,r){var n=r.source,o=r.target;e.getRelatedEdges(n,"out").find((function(t){return t.target===o}))||(n=r.target,o=r.source);var i=t.getNode(n),a=t.getNode(o),s=i,u=!1;i.data.lim>a.data.lim&&(s=a,u=!0);var d=e.getAllEdges().filter((function(e){return u===me(t.getNode(e.source),s)&&u!==me(t.getNode(e.target),s)}));return Qt(d,(function(t){return ne(e,t)}))},pe=function(t,e,r,n){var o=t.getRelatedEdges(r.source,"both").find((function(t){return t.source===r.target||t.target===r.target}));o&&t.removeEdge(o.id),t.addEdge({id:"e"+Math.random(),source:n.source,target:n.target,data:{}}),ce(t),ue(t,e),ve(t,e)},ve=function(t,e){var r=t.getAllNodes().find((function(t){return!t.data.parent})),n=te(t,r,"pre",!1);(n=n.slice(1)).forEach((function(r){var n=t.getNode(r).data.parent,o=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),i=!1;!o&&e.hasNode(n)&&(o=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),i=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(i?null==o?void 0:o.data.minlen:-(null==o?void 0:o.data.minlen))}))},ye=function(t,e,r){return t.getRelatedEdges(e,"both").find((function(t){return t.source===r||t.target===r}))},me=function(t,e){return e.data.low<=t.data.lim&&t.data.lim<=e.data.lim},we=re,xe=function(t){!function(t){var e=function(t){var e=new l;return t.getAllNodes().forEach((function(t){e.addNode(n({},t))})),t.getAllEdges().forEach((function(t){var r=e.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target}));r?e.updateEdgeData(null==r?void 0:r.id,n(n({},r.data),{weight:r.data.weight+t.data.weight||0,minlen:Math.max(r.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e}(t);re(e);var r,o,i=function(t){var e,r,n=new l({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);oe(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r);return n}(e);for(ce(i),ue(i,e);r=fe(i);)o=ge(i,e,r),pe(i,e,r,o)}(t)},Ee=function(t,e,r,n,o,i,a){var s=t.getChildren(a);if(null==s?void 0:s.length){var u=Jt(t,"_bt"),d=Jt(t,"_bb"),h=t.getNode(a);t.setParent(u,a),h.data.borderTop=u,t.setParent(d,a),h.data.borderBottom=d,null==s||s.forEach((function(s){Ee(t,e,r,n,o,i,s.id);var h=s.data.borderTop?s.data.borderTop:s.id,c=s.data.borderBottom?s.data.borderBottom:s.id,l=s.data.borderTop?n:2*n,f=h!==c?1:o-i[a]+1;t.addEdge({id:"e"+Math.random(),source:u,target:h,data:{minlen:f,weight:l,nestingEdge:!0}}),t.addEdge({id:"e"+Math.random(),source:c,target:d,data:{minlen:f,weight:l,nestingEdge:!0}})})),t.getParent(a)||t.addEdge({id:"e"+Math.random(),source:e,target:u,data:{weight:0,minlen:o+i[a]}})}else a!==e&&t.addEdge({id:"e"+Math.random(),source:e,target:a,data:{weight:0,minlen:r}})},be=function(t,e,r,n,o,i){var a={rank:i,borderType:e,width:0,height:0},s=o.data[e][i-1],u=Ut(t,"border",a,r);o.data[e][i]=u,t.setParent(u,n),s&&t.addEdge({id:"e"+Math.random(),source:s,target:u,data:{weight:1}})},Ne=function(t){t.getAllNodes().forEach((function(t){Me(t)})),t.getAllEdges().forEach((function(t){Me(t)}))},Me=function(t){var e=t.data.width;t.data.width=t.data.height,t.data.height=e},Se=function(t){(null==t?void 0:t.y)&&(t.y=-t.y)},ke=function(t){var e=t.x;t.x=t.y,t.y=e},Ae=function(t){for(var e={},r=t.getAllNodes(),n=r.map((function(t){var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),o=Math.max.apply(Math,u([],s(n))),i=[],a=0;a<o+1;a++)i.push([]);var d=r.sort((function(e,r){return t.getNode(e.id).data.rank-t.getNode(r.id).data.rank})),h=d.filter((function(e){return void 0!==t.getNode(e.id).data.fixorder})).sort((function(e,r){return t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder}));return null==h||h.forEach((function(r){isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0})),null==d||d.forEach((function(r){return t.dfsTree(r.id,(function(t){if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)}))})),i},Re=function(t,e,r){for(var n=function(t,e){return null==t?void 0:t.reduce((function(t,r,n){return t[r]=e[n],t}),{})}(r,r.map((function(t,e){return e}))),o=e.map((function(e){var r=t.getRelatedEdges(e,"out").map((function(t){return{pos:n[t.target]||0,weight:t.data.weight}}));return null==r?void 0:r.sort((function(t,e){return t.pos-e.pos}))})),i=o.flat().filter((function(t){return void 0!==t})),a=1;a<r.length;)a<<=1;var s=2*a-1;a-=1;var u=Array(s).fill(0,0,s),d=0;return null==i||i.forEach((function(t){if(t){var e=t.pos+a;u[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=u[e+1]),u[e=e-1>>1]+=t.weight;d+=t.weight*r}})),d},Ie=function(t,e){for(var r=0,n=1;n<(null==e?void 0:e.length);n+=1)r+=Re(t,e[n-1],e[n]);return r},_e=function(t,e){var r,n=0,o=0;t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/o,t.weight=o,t.i=Math.min(e.i,t.i),e.merged=!0};const De=function(t,e){var r,n,o,i={};return null==t||t.forEach((function(t,e){i[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};var r=i[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)})),null===(r=e.getAllEdges())||void 0===r||r.forEach((function(t){var e=i[t.source],r=i[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(i[t.target]))})),function(t){for(var e,r,n=[],o=function(){var o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach((function(t){return(e=o,function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&_e(e,t)})(t);var e})),null===(r=o.out)||void 0===r||r.forEach((function(e){return(r=o,function(e){e.in.push(r),0==--e.indegree&&t.push(e)})(e);var r}))};null==t?void 0:t.length;)o();var i=n.filter((function(t){return!t.merged})),a=["vs","i","barycenter","weight"];return i.map((function(t){var e={};return null==a||a.forEach((function(r){void 0!==t[r]&&(e[r]=t[r])})),e}))}(null===(o=(n=Object.values(i)).filter)||void 0===o?void 0:o.call(n,(function(t){return!t.indegree})))};var Oe=function(t,e,r){for(var n,o=r;e.length&&(n=e[e.length-1]).i<=o;)e.pop(),null==t||t.push(n.vs),o++;return o},Pe=function(t,e,r,n,o,i){var a,s,u,d,h=t.getChildren(e).map((function(t){return t.id})),c=t.getNode(e),l=c?c.data.borderLeft:void 0,f=c?c.data.borderRight:void 0,g={};l&&(h=null==h?void 0:h.filter((function(t){return t!==l&&t!==f})));var p=function(t,e){return e.map((function(e){var r=t.getRelatedEdges(e,"in");if(!(null==r?void 0:r.length))return{v:e};var n={sum:0,weight:0};return null==r||r.forEach((function(e){var r=t.getNode(e.source);n.sum+=e.data.weight*r.data.order,n.weight+=e.data.weight})),{v:e,barycenter:n.sum/n.weight,weight:n.weight}}))}(t,h||[]);null==p||p.forEach((function(e){var o;if(null===(o=t.getChildren(e.v))||void 0===o?void 0:o.length){var a=Pe(t,e.v,r,n,i);g[e.v]=a,a.hasOwnProperty("barycenter")&&ze(e,a)}}));var v=De(p,r);Te(v,g),null===(a=v.filter((function(t){return t.vs.length>0})))||void 0===a||a.forEach((function(e){var r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)}));var y=function(t,e,r,n){var o=function(t,e){var r={lhs:[],rhs:[]};return null==t||t.forEach((function(t){var e,o;o=(e=t).hasOwnProperty("fixorder")&&!isNaN(e.fixorder),(n?!o&&e.hasOwnProperty("barycenter"):o||e.hasOwnProperty("barycenter"))?r.lhs.push(t):r.rhs.push(t)})),r}(t),i=o.lhs,a=o.rhs.sort((function(t,e){return-t.i- -e.i})),s=[],u=0,d=0,h=0;null==i||i.sort(function(t,e){return function(r,n){if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i}}(!!e,!!r)),h=Oe(s,a,h),null==i||i.forEach((function(t){var e;h+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),u+=t.barycenter*t.weight,d+=t.weight,h=Oe(s,a,h)}));var c={vs:s.flat()};return d&&(c.barycenter=u/d,c.weight=d),c}(v,n,o,i);if(l&&(y.vs=[l,y.vs,f].flat(),null===(s=t.getPredecessors(l))||void 0===s?void 0:s.length)){var m=t.getNode((null===(u=t.getPredecessors(l))||void 0===u?void 0:u[0].id)||""),w=t.getNode((null===(d=t.getPredecessors(f))||void 0===d?void 0:d[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+w.data.order)/(y.weight+2),y.weight+=2}return y},Te=function(t,e){null==t||t.forEach((function(t){var r,n=null===(r=t.vs)||void 0===r?void 0:r.map((function(t){return e[t]?e[t].vs:t}));t.vs=n.flat()}))},ze=function(t,e){void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},Ce=function(t){if("object"!=typeof t||null===t)return t;var e,r;if(r=t,Array.isArray?Array.isArray(r):w(r,"Array")){e=[];for(var n=0,o=t.length;n<o;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=Ce(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=Ce(t[i]):e[i]=t[i];return e};const Le=Ce;var qe=function(t,e,r){return e.map((function(e){return function(t,e,r){var o=function(t){for(var e;t.hasNode(e="_root"+Math.random()););return e}(t),i=new l({tree:[{id:o,children:[],data:{}}]});return t.getAllNodes().forEach((function(a){var s=t.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(n({},a)),(null==s?void 0:s.id)&&!i.hasNode(null==s?void 0:s.id)&&i.addNode(n({},s)),i.setParent(a.id,(null==s?void 0:s.id)||o),t.getRelatedEdges(a.id,r).forEach((function(e){var r=e.source===a.id?e.target:e.source;i.hasNode(r)||i.addNode(n({},t.getNode(r)));var o=i.getRelatedEdges(r,"out").find((function(t){return t.target===a.id})),s=void 0!==o?o.data.weight:0;o?i.updateEdgeData(o.id,n(n({},o.data),{weight:e.data.weight+s})):i.addEdge({id:e.id,source:r,target:a.id,data:{weight:e.data.weight+s}})})),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,n(n({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))})),i}(t,e,r)}))},je=function(t,e,r,n){var o=new l;null==t||t.forEach((function(t){for(var i,a=t.getRoots()[0].id,s=Pe(t,a,o,e,r,n),u=0;u<(null===(i=s.vs)||void 0===i?void 0:i.length);u++){var d=t.getNode(s.vs[u]);d&&(d.data.order=u)}!function(t,e,r){var n,o={};null==r||r.forEach((function(r){for(var i,a,s=t.getParent(r);s;){if((i=t.getParent(s.id))?(a=o[i.id],o[i.id]=s.id):(a=n,n=s.id),a&&a!==s.id)return e.addNodes([{id:a,data:{}},{id:s.id,data:{}}]),void e.addEdge({id:"e"+a+"-"+s.id,source:a,target:s.id,data:{}});s=i}}))}(t,o,s.vs)}))},Fe=function(t,e){null==e||e.forEach((function(e){null==e||e.forEach((function(e,r){t.getNode(e).data.order=r}))}))},Ve=function(t,e){var r={};function n(e,n,o,i,a){for(var s,u,d,h=n;h<o;h++)d=e[h],(null===(s=t.getNode(d))||void 0===s?void 0:s.data.dummy)&&(null===(u=t.getPredecessors(d))||void 0===u||u.forEach((function(e){var n=t.getNode(e.id);n.data.dummy&&(n.data.order<i||n.data.order>a)&&We(r,e.id,d)})))}function o(t,e){var r=function(t){return JSON.stringify(t.slice(1))}(t);e.get(r)||(n.apply(void 0,u([],s(t))),e.set(r,!0))}return(null==e?void 0:e.length)&&e.reduce((function(e,r){var n,i=-1,a=0,s=new Map;return null==r||r.forEach((function(u,d){var h;if("border"===(null===(h=t.getNode(u))||void 0===h?void 0:h.data.dummy)){var c=t.getPredecessors(u)||[];c.length&&(n=t.getNode(c[0].id).data.order,o([r,a,d,i,n],s),a=d,i=n)}o([r,a,r.length,n,e.length],s)})),r})),r},Ge=function(t,e){var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find((function(e){return t.getNode(e.id).data.dummy}))},We=function(t,e,r){var n=e,o=r;if(n>o){var i=n;n=o,o=i}var a=t[n];a||(t[n]=a={}),a[o]=!0},Be=function(t,e,r){var n=e;return n>r&&(n=r),!!t[n]},$e=function(t,e,r,o,i,a){var s=new l,u=Ue(o,i,a);return null==e||e.forEach((function(e){var o;null==e||e.forEach((function(e){var i=r[e];if(s.hasNode(i)||s.addNode({id:i,data:{}}),o){var a=r[o],d=s.getRelatedEdges(a,"out").find((function(t){return t.target===i}));d?s.updateEdgeData(d.id,n(n({},d.data),{weight:Math.max(u(t,e,o),d.data.weight||0)})):s.addEdge({id:"e"+Math.random(),source:a,target:i,data:{weight:Math.max(u(t,e,o),0)}})}o=e}))})),s};var Ue=function(t,e,r){return function(n,o,i){var a=n.getNode(o),s=n.getNode(i),u=0,d=0;if(u+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":d=-a.data.width/2;break;case"r":d=a.data.width/2}if(d&&(u+=r?d:-d),d=0,u+=(a.data.dummy?e:t)/2,u+=(s.data.dummy?e:t)/2,u+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":d=s.data.width/2;break;case"r":d=-s.data.width/2}return d&&(u+=r?d:-d),d=0,u}},He=function(t,e){return t.getNode(e).data.width||0},Ke=function(t,e){var r,n=Ht(t);!function(t,e){var r=(e||{}).ranksep,n=void 0===r?0:r,o=Yt(t),i=0;null==o||o.forEach((function(e){var r=e.map((function(e){return t.getNode(e).data.height})),o=Math.max.apply(Math,u(u([],s(r)),[0]));null==e||e.forEach((function(e){t.getNode(e).data.y=i+o/2})),i+=o+n}))}(n,e);var o=function(t,e){var r=e||{},n=r.align,o=r.nodesep,i=void 0===o?0:o,a=r.edgesep,d=void 0===a?0:a,h=Yt(t),c=Object.assign(function(t,e){var r={};return(null==e?void 0:e.length)&&e.reduce((function(e,n){var o=0,i=0,a=e.length,s=null==n?void 0:n[(null==n?void 0:n.length)-1];return null==n||n.forEach((function(e,u){var d,h=Ge(t,e),c=h?t.getNode(h.id).data.order:a;(h||e===s)&&(null===(d=n.slice(i,u+1))||void 0===d||d.forEach((function(e){var n;null===(n=t.getPredecessors(e))||void 0===n||n.forEach((function(n){var i,a=t.getNode(n.id),s=a.data.order;!(s<o||c<s)||a.data.dummy&&(null===(i=t.getNode(e))||void 0===i?void 0:i.data.dummy)||We(r,n.id,e)}))})),i=u+1,o=c)})),n})),r}(t,h),Ve(t,h)),l={},f=[];["u","d"].forEach((function(e){f="u"===e?h:Object.values(h).reverse(),["l","r"].forEach((function(r){"r"===r&&(f=f.map((function(t){return Object.values(t).reverse()})));var n=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),o=function(t,e,r,n){var o={},i={},a={};return null==e||e.forEach((function(t){null==t||t.forEach((function(t,e){o[t]=t,i[t]=t,a[t]=e}))})),null==e||e.forEach((function(t){var e=-1;null==t||t.forEach((function(t){var s=n(t).map((function(t){return t.id}));if(s.length){s=s.sort((function(t,e){return a[t]-a[e]}));for(var u=(s.length-1)/2,d=Math.floor(u),h=Math.ceil(u);d<=h;++d){var c=s[d];i[t]===t&&e<a[c]&&!Be(r,t,c)&&(i[c]=t,i[t]=o[t]=o[c],e=a[c])}}}))})),{root:o,align:i}}(0,f,c,n),a=function(t,e,r,n,o,i,a){var s,u={},d=$e(t,e,r,o,i,a),h=a?"borderLeft":"borderRight",c=function(t,e){for(var r=d.getAllNodes(),n=r.pop(),o={};n;)o[n.id]?t(n.id):(o[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return c((function(t){u[t]=(d.getRelatedEdges(t,"in")||[]).reduce((function(t,e){return Math.max(t,(u[e.source]||0)+e.data.weight)}),0)}),d.getPredecessors.bind(d)),c((function(e){var r=(d.getRelatedEdges(e,"out")||[]).reduce((function(t,e){return Math.min(t,(u[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==h&&(u[e]=Math.max(u[e],r))}),d.getSuccessors.bind(d)),null===(s=Object.values(n))||void 0===s||s.forEach((function(t){u[t]=u[r[t]]})),u}(t,f,o.root,o.align,i,d,"r"===r);"r"===r&&Object.keys(a).forEach((function(t){return a[t]=-a[t]})),l[e+r]=a}))}));var g=function(t,e){return Qt(Object.values(e),(function(e){var r,n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach((function(r){var i=e[r],a=He(t,r)/2;n=Math.max(i+a,n),o=Math.min(i-a,o)})),n-o}))}(t,l);return g&&function(t,e){var r=Object.values(e),n=Math.min.apply(Math,u([],s(r))),o=Math.max.apply(Math,u([],s(r)));["u","d"].forEach((function(r){["l","r"].forEach((function(i){var a,d=r+i,h=t[d];if(h!==e){var c=Object.values(h);(a="l"===i?n-Math.min.apply(Math,u([],s(c))):o-Math.max.apply(Math,u([],s(c))))&&(t[d]={},Object.keys(h).forEach((function(e){t[d][e]=h[e]+a})))}}))}))}(l,g),function(t,e){var r={};return Object.keys(t.ul).forEach((function(n){if(e)r[n]=t[e.toLowerCase()][n];else{var o=Object.values(t).map((function(t){return t[n]}));r[n]=(o[0]+o[1])/2}})),r}(l,n)}(n,e);null===(r=Object.keys(o))||void 0===r||r.forEach((function(t){n.getNode(t).data.x=o[t]}))},Ye=function(t,e){var r=e.acyclicer,o=e.ranker,i=e.rankdir,a=void 0===i?"tb":i,d=e.nodeOrder,h=e.keepNodeOrder,c=e.align,f=e.nodesep,g=void 0===f?50:f,p=e.edgesep,v=void 0===p?20:p,y=e.ranksep,m=void 0===y?50:y;dr(t),Bt(t,r);var w=function(t){var e=Ut(t,"root",{},"_root"),r=function(t){var e={},r=function(n,o){var i=t.getChildren(n);null==i||i.forEach((function(t){return r(t.id,o+1)})),e[n]=o};return t.getRoots().forEach((function(t){return r(t.id,1)})),e}(t),n=Math.max.apply(Math,u([],s(Object.values(r))));Math.abs(n)===1/0&&(n=1);var o=n-1,i=2*o+1;t.getAllEdges().forEach((function(t){t.data.minlen*=i}));var a=function(t){var e=0;return t.getAllEdges().forEach((function(t){e+=t.data.weight})),e}(t)+1;return t.getRoots().forEach((function(n){Ee(t,e,i,a,o,r,n.id)})),{nestingRoot:e,nodeRankFactor:i}}(t),x=w.nestingRoot,E=w.nodeRankFactor;!function(t,e){switch(e){case"network-simplex":xe(t);break;case"tight-tree":default:!function(t){!function(t){var e,r={},n=function(o){var i,a,s=t.getNode(o);return s?r[o]?s.data.rank:(r[o]=!0,null===(i=t.getRelatedEdges(o,"out"))||void 0===i||i.forEach((function(t){var e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),(void 0===e||a<e)&&(e=a),s.data.rank=a,a):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){t&&n(t.id)})),void 0===e&&(e=0);var o={},i=function(e,r){var n,a=t.getNode(e),s=isNaN(a.data.layer)?r:a.data.layer;(void 0===a.data.rank||a.data.rank<s)&&(a.data.rank=s),o[e]||(o[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach((function(t){i(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((function(t){var r=t.data;r&&(isNaN(r.layer)?r.rank-=e:i(t.id,r.layer))}))}(t),function(t){var e,r,n=new l({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);ie(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r)}(t)}(t);break;case"longest-path":we(t)}}(Ht(t),o),er(t),function(t,e){void 0===e&&(e=0);var r=t.getAllNodes(),n=r.filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),o=Math.min.apply(Math,u([],s(n))),i=[];r.forEach((function(t){var e=(t.data.rank||0)-o;i[e]||(i[e]=[]),i[e].push(t.id)}));for(var a=0,d=0;d<i.length;d++){var h=i[d];void 0===h?d%e!=0&&(a-=1):a&&(null==h||h.forEach((function(e){var r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=a)})))}}(t,E),function(t,e){e&&t.removeNode(e),t.getAllEdges().forEach((function(e){e.data.nestingEdge&&t.removeEdge(e.id)}))}(t,x),function(t){var e=t.getAllNodes().filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),r=Math.min.apply(Math,u([],s(e)));t.getAllNodes().forEach((function(t){t.data.hasOwnProperty("rank")&&r!==1/0&&(t.data.rank-=r)}))}(t),rr(t),nr(t);var b=[];!function(t,e){t.getAllEdges().forEach((function(r){return function(t,e,r){var n=e.source,o=t.getNode(n).data.rank,i=e.target,a=t.getNode(i).data.rank,s=e.data.labelRank;if(a!==o+1){var u,d,h;for(t.removeEdge(e.id),h=0,++o;o<a;++h,++o)e.data.points=[],u=Ut(t,"edge",d={originalEdge:e,width:0,height:0,rank:o},"_d"),o===s&&(d.width=e.data.width,d.height=e.data.height,d.dummy=ee,d.labelpos=e.data.labelpos),t.addEdge({id:"e"+Math.random(),source:n,target:u,data:{weight:e.data.weight}}),0===h&&r.push(u),n=u;t.addEdge({id:"e"+Math.random(),source:n,target:i,data:{weight:e.data.weight}})}}(t,r,e)}))}(t,b),function(t,e){var r=function(t){var e={},r=0,n=function(o){var i=r;t.getChildren(o).forEach((function(t){return n(t.id)})),e[o]={low:i,lim:r++}};return t.getRoots().forEach((function(t){return n(t.id)})),e}(t);e.forEach((function(e){var n,o,i=e,a=t.getNode(i),s=a.data.originalEdge;if(s)for(var u=function(t,e,r,n){var o,i,a,s,u=[],d=[],h=Math.min(e[r].low,e[n].low),c=Math.max(e[r].lim,e[n].lim);a=r;do{a=null===(o=t.getParent(a))||void 0===o?void 0:o.id,u.push(a)}while(a&&(e[a].low>h||c>e[a].lim));for(s=a,a=n;a&&a!==s;)d.push(a),a=null===(i=t.getParent(a))||void 0===i?void 0:i.id;return{lca:s,path:u.concat(d.reverse())}}(t,r,s.source,s.target),d=u.path,h=u.lca,c=0,l=d[c],f=!0;i!==s.target;){if(a=t.getNode(i),f){for(;l!==h&&(null===(n=t.getNode(l))||void 0===n?void 0:n.data.maxRank)<a.data.rank;)l=d[++c];l===h&&(f=!1)}if(!f){for(;c<d.length-1&&(null===(o=t.getNode(d[c+1]))||void 0===o?void 0:o.data.minRank)<=a.data.rank;)c++;l=d[c]}t.hasNode(l)&&t.setParent(i,l),i=t.getSuccessors(i)[0].id}}))}(t,b),function(t){var e=function(r){var n=t.getChildren(r),o=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach((function(t){return e(t.id)})),o.data.hasOwnProperty("minRank")){o.data.borderLeft=[],o.data.borderRight=[];for(var i=o.data.minRank,a=o.data.maxRank+1;i<a;i+=1)be(t,"borderLeft","_bl",r,o,i),be(t,"borderRight","_br",r,o,i)}};t.getRoots().forEach((function(t){return e(t.id)}))}(t),h&&function(t,e){for(var r=t.getAllNodes().filter((function(e){var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)})).map((function(t){return t.data.rank})),n=Math.max.apply(Math,u([],s(r))),o=[],i=0;i<n+1;i++)o[i]=[];null==e||e.forEach((function(e){var r=t.getNode(e);r&&!r.data.dummy&&(isNaN(r.data.rank)||(r.data.fixorder=o[r.data.rank].length,o[r.data.rank].push(e)))}))}(t,d),function(t,e){for(var r=Xt(t),n=[],o=[],i=1;i<r+1;i++)n.push(i);for(i=r-1;i>-1;i--)o.push(i);var a=qe(t,n,"in"),s=qe(t,o,"out"),u=Ae(t);Fe(t,u);for(var d,h=Number.POSITIVE_INFINITY,c=(i=0,0);c<4;++i,++c)je(i%2?a:s,i%4>=2,!1,e),u=Yt(t),(l=Ie(t,u))<h&&(c=0,d=Le(u),h=l);for(u=Ae(t),Fe(t,u),i=0,c=0;c<4;++i,++c){var l;je(i%2?a:s,i%4>=2,!0,e),u=Yt(t),(l=Ie(t,u))<h&&(c=0,d=Le(u),h=l)}Fe(t,d)}(t,h),hr(t),function(t,e){var r=e.toLowerCase();"lr"!==r&&"rl"!==r||Ne(t)}(t,a),Ke(t,{align:c,nodesep:g,edgesep:v,ranksep:m}),cr(t),ur(t),function(t,e){e.forEach((function(e){var r,n=t.getNode(e),o=n.data.originalEdge;o&&t.addEdge(o);for(var i=e;n.data.dummy;)r=t.getSuccessors(i)[0],t.removeNode(i),o.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===ee&&(o.data.x=n.data.x,o.data.y=n.data.y,o.data.width=n.data.width,o.data.height=n.data.height),i=r.id,n=t.getNode(i)}))}(t,b),ar(t),function(t,e){var r=e.toLowerCase();"bt"!==r&&"rl"!==r||function(t){t.getAllNodes().forEach((function(t){Se(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return Se(t)})),t.data.hasOwnProperty("y")&&Se(t.data)}))}(t),"lr"!==r&&"rl"!==r||(function(t){t.getAllNodes().forEach((function(t){ke(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return ke(t)})),t.data.hasOwnProperty("x")&&ke(t.data)}))}(t),Ne(t))}(t,a);var N=or(t),M=N.width,S=N.height;return ir(t),sr(t),function(t){t.getAllEdges().forEach((function(e){var r=e.data;if(r.reversed){t.removeEdge(e.id);var o=r.forwardName;delete r.reversed,delete r.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:n(n({},r),{forwardName:o})})}}))}(t),{width:M,height:S}},Je=["width","height","layer","fixorder"],Xe={width:0,height:0},Qe=["minlen","weight","width","height","labeloffset"],Ze={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},tr=["labelpos"],er=function(t){t.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var r=t.getNode(e.source),n={e,rank:(t.getNode(e.target).data.rank-r.data.rank)/2+r.data.rank};Ut(t,"edge-proxy",n,"_ep")}}))},rr=function(t){var e=0;return t.getAllNodes().forEach((function(r){var n,o;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(o=t.getNode(r.data.borderBottom))||void 0===o?void 0:o.data.rank,e=Math.max(e,r.data.maxRank||-1/0))})),e},nr=function(t){t.getAllNodes().forEach((function(e){"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},or=function(t,e){var r,n,o=0,i=0,a=e||{},s=a.marginx,u=void 0===s?0:s,d=a.marginy,h=void 0===d?0:d,c=function(t){if(t.data){var e=t.data.x,a=t.data.y,s=t.data.width,u=t.data.height;isNaN(e)||isNaN(s)||(void 0===r&&(r=e-s/2),r=Math.min(r,e-s/2),o=Math.max(o,e+s/2)),isNaN(a)||isNaN(u)||(void 0===n&&(n=a-u/2),n=Math.min(n,a-u/2),i=Math.max(i,a+u/2))}};return t.getAllNodes().forEach((function(t){c(t)})),t.getAllEdges().forEach((function(t){(null==t?void 0:t.data.hasOwnProperty("x"))&&c(t)})),r-=u,n-=h,t.getAllNodes().forEach((function(t){t.data.x-=r,t.data.y-=n})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){t.x-=r,t.y-=n})),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)})),{width:o-r+u,height:i-n+h}},ir=function(t){t.getAllEdges().forEach((function(e){var r,n,o=t.getNode(e.source),i=t.getNode(e.target);e.data.points?(r=e.data.points[0],n=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:i.data.x,y:i.data.y},n={x:o.data.x,y:o.data.y}),e.data.points.unshift(Kt(o.data,r)),e.data.points.push(Kt(i.data,n))}))},ar=function(t){t.getAllEdges().forEach((function(t){if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},sr=function(t){t.getAllEdges().forEach((function(t){var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},ur=function(t){t.getAllNodes().forEach((function(e){var r,n,o;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){var i=t.getNode(e.id),a=t.getNode(i.data.borderTop),s=t.getNode(i.data.borderBottom),u=t.getNode(i.data.borderLeft[(null===(n=i.data.borderLeft)||void 0===n?void 0:n.length)-1]),d=t.getNode(i.data.borderRight[(null===(o=i.data.borderRight)||void 0===o?void 0:o.length)-1]);i.data.width=Math.abs((null==d?void 0:d.data.x)-(null==u?void 0:u.data.x))||10,i.data.height=Math.abs((null==s?void 0:s.data.y)-(null==a?void 0:a.data.y))||10,i.data.x=((null==u?void 0:u.data.x)||0)+i.data.width/2,i.data.y=((null==a?void 0:a.data.y)||0)+i.data.height/2}})),t.getAllNodes().forEach((function(e){"border"===e.data.dummy&&t.removeNode(e.id)}))},dr=function(t){t.getAllEdges().forEach((function(e){if(e.source===e.target){var r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}}))},hr=function(t){var e=Yt(t);null==e||e.forEach((function(e){var r=0;null==e||e.forEach((function(e,n){var o,i=t.getNode(e);i.data.order=n+r,null===(o=i.data.selfEdges)||void 0===o||o.forEach((function(e){Ut(t,"selfedge",{width:e.data.width,height:e.data.height,rank:i.data.rank,order:n+ ++r,e},"_se")})),delete i.data.selfEdges}))}))},cr=function(t){t.getAllNodes().forEach((function(e){var r=t.getNode(e.id);if("selfedge"===r.data.dummy){var n=t.getNode(r.data.e.source),o=n.data.x+n.data.width/2,i=n.data.y,a=r.data.x-o,s=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}}))},lr=function(t,e){var r={};return null==e||e.forEach((function(e){void 0!==t[e]&&(r[e]=+t[e])})),r},fr=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(r){e[r.toLowerCase()]=t[r]})),e},gr={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="dagre",this.layoutNode=function(t){return!1!==t.data.layout},this.options=n(n({},gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericDagreLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericDagreLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericDagreLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,E,N,M,k,R,I,_,D,O,P,T,z,C,L,q,j,F,V,G,W=this;return a(this,(function(a){return o=n(n({},this.options),r),i=o.nodeSize,s=o.align,u=o.rankdir,d=void 0===u?"TB":u,h=o.ranksep,c=o.nodesep,f=o.ranksepFunc,g=o.nodesepFunc,p=o.edgeLabelSpace,v=o.nodeOrder,y=o.begin,m=o.controlPoints,w=o.radial,E=new l({tree:[]}),N=S(h||50,f),M=S(c||50,g),k=M,R=N,"LR"!==d&&"RL"!==d||(k=N,R=M),I=A(i,void 0),_=e.getAllNodes(),D=e.getAllEdges(),_.filter((function(t){return!1!==t.data.layout})).forEach((function(t){var e=I(t),r=R(t),n=e+2*k(t),o=e+2*r,i=t.data.layer;x(i)?E.addNode({id:t.id,data:{width:n,height:o,layer:i}}):E.addNode({id:t.id,data:{width:n,height:o}})})),D.forEach((function(t){W.layoutNode(E.getNode(t.source))&&W.layoutNode(E.getNode(t.target))&&E.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),function(t,e){var r,o,i=e.edgeLabelSpace,a=e.keepNodeOrder,s=e.prevGraph,u=e.rankdir,d=e.ranksep;!a&&s&&(o=s,(r=t).getAllNodes().forEach((function(t){var e=r.getNode(t.id),n=o.getNode(t.id);void 0!==n?(e.data.fixorder=n.data._order,delete n.data._order):delete e.data.fixorder})));var h=function(t){var e=new l({tree:[]});return t.getAllNodes().forEach((function(r){var o=fr(t.getNode(r.id).data),i=n(n({},Xe),o),a=lr(i,Je);e.hasNode(r.id)||e.addNode({id:r.id,data:n({},a)});var s=t.getParent(r.id);null==s||(e.hasNode(s.id)||e.addNode(n({},s)),e.setParent(r.id,s.id))})),t.getAllEdges().forEach((function(r){var n=fr(t.getEdge(r.id).data),o={};null==tr||tr.forEach((function(t){void 0!==n[t]&&(o[t]=n[t])})),e.addEdge({id:r.id,source:r.source,target:r.target,data:Object.assign({},Ze,lr(n,Qe),o)})})),e}(t);!1!==i&&(e.ranksep=function(t,e){var r=e.ranksep,n=void 0===r?0:r,o=e.rankdir;return t.getAllNodes().forEach((function(t){isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((function(t){var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===o||"BT"===o?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2}(h,{rankdir:u,ranksep:d}));try{Ye(h,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph\'s structure:\\n",t);throw t}!function(t,e){t.getAllNodes().forEach((function(r){var n,o=t.getNode(r.id);if(o){var i=e.getNode(r.id);o.data.x=i.data.x,o.data.y=i.data.y,o.data._order=i.data.order,o.data._rank=i.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(o.data.width=i.data.width,o.data.height=i.data.height)}})),t.getAllEdges().forEach((function(r){var n=t.getEdge(r.id),o=e.getEdge(r.id);n.data.points=o?o.data.points:[],o&&o.data.hasOwnProperty("x")&&(n.data.x=o.data.x,n.data.y=o.data.y)}))}(t,h)}(E,{prevGraph:null,edgeLabelSpace:p,keepNodeOrder:!!v,nodeOrder:v||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:d,nodesep:c,align:s}),O=[0,0],y&&(P=1/0,T=1/0,E.getAllNodes().forEach((function(t){P>t.data.x&&(P=t.data.x),T>t.data.y&&(T=t.data.y)})),E.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){P>t.x&&(P=t.x),T>t.y&&(T=t.y)}))})),O[0]=y[0]-P,O[1]=y[1]-T),z="LR"===d||"RL"===d,w||(C=new Set,L="BT"===d||"RL"===d?function(t,e){return e-t}:function(t,e){return t-e},E.getAllNodes().forEach((function(t){t.data.x=t.data.x+O[0],t.data.y=t.data.y+O[1],C.add(z?t.data.x:t.data.y)})),q=Array.from(C).sort(L),j=z?function(t,e){return t.x!==e.x}:function(t,e){return t.y!==e.y},F=z?function(t,e,r){var n=Math.max(e.y,r.y),o=Math.min(e.y,r.y);return t.filter((function(t){return t.y<=n&&t.y>=o}))}:function(t,e,r){var n=Math.max(e.x,r.x),o=Math.min(e.x,r.x);return t.filter((function(t){return t.x<=n&&t.x>=o}))},E.getAllEdges().forEach((function(t,e){var r;p&&m&&"loop"!==t.data.type&&(t.data.controlPoints=vr(null===(r=t.data.points)||void 0===r?void 0:r.map((function(t){var e=t.x,r=t.y;return{x:e+O[0],y:r+O[1]}})),E.getNode(t.source),E.getNode(t.target),q,z,j,F))}))),V=[],V=E.getAllNodes().map((function(t){return b(t)})),G=E.getAllEdges(),t&&(V.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),G.forEach((function(t){e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),[2,{nodes:V,edges:G}]}))}))},t}(),vr=function(t,e,r,n,o,i,a){var s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){var u=e.data,d=u.x,h=u.y,c=r.data,l=c.x,f=c.y;if(o&&(d=e.data.y,h=e.data.x,l=r.data.y,f=r.data.x),f!==h&&d!==l){var g=n.indexOf(h),p=n[g+1];if(p){var v=s[0],y=o?{x:(h+p)/2,y:(null==v?void 0:v.y)||l}:{x:(null==v?void 0:v.x)||l,y:(h+p)/2};v&&!i(v,y)||s.unshift(y)}var m=n.indexOf(f),w=Math.abs(m-g);if(1===w)(s=a(s,e.data,r.data)).length||s.push(o?{x:(h+f)/2,y:d}:{x:d,y:(h+f)/2});else if(w>1){var x=n[m-1];if(x){var E=s[s.length-1],b=o?{x:(f+x)/2,y:(null==E?void 0:E.y)||l}:{x:(null==E?void 0:E.x)||d,y:(f+x)/2};E&&!i(E,b)||s.push(b)}}}}return s};function yr(t){var e=0,r=0,n=0;if(t.length){for(var o=0;o<4;o++)(i=t[o])&&i.weight&&(e+=i.weight,r+=i.x*i.weight,n+=i.y*i.weight);t.x=r/e,t.y=n/e,t.weight=e}else{var i=t;t.x=i.data.x,t.y=i.data.y,t.weight=i.data.weight}}var mr=function(t,e,r,n,o,i){var a=i.x-t.x||.1,s=i.y-t.y||.1,u=n-e,d=a*a+s*s,h=Math.sqrt(d)*d;if(u*u*.81<d){var c=t.weight/h;return i.vx+=a*c,i.vy+=s*c,!0}if(t.length)return!1;t.data!==i&&(c=t.data.weight/h,i.vx+=a*c,i.vy+=s*c)},wr={maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},xr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=n(n({},wr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,E,b,N,M,S,k=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=this.formatOptions(o,e),d=u.width,h=u.height,c=u.nodeSize,f=u.getMass,g=u.nodeStrength,p=u.edgeStrength,v=u.linkDistance,y=i.map((function(t){return n(n({},t),{data:n(n({},t.data),{x:x(t.data.x)?t.data.x:Math.random()*d,y:x(t.data.y)?t.data.y:Math.random()*h,size:c(t)||30,mass:f(t),nodeStrength:g(t)})})})),m=s.map((function(t){return n(n({},t),{data:n(n({},t.data),{edgeStrength:p(t),linkDistance:v(t,e.getNode(t.source),e.getNode(t.target))})})})),(null==i?void 0:i.length)?(w={},i.forEach((function(t,e){w[t.id]={x:0,y:0}})),E=new l({nodes:y,edges:m}),this.formatCentripetal(u,E),b=u.maxIteration,N=u.minMovement,M=u.onTick,this.lastLayoutNodes=y,this.lastLayoutEdges=m,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=E,this.lastOptions=u,this.lastVelMap=w,"undefined"==typeof window?[2]:(S=0,[2,new Promise((function(r){k.timeInterval=window.setInterval((function(){i&&k.running||r({nodes:Sr(e,y),edges:s}),k.runOneStep(E,e,S,w,u),k.updatePosition(e,E,w,u),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),null==M||M({nodes:Sr(e,y),edges:s}),(++S>=b||k.judgingDistance<N)&&(window.clearInterval(k.timeInterval),r({nodes:Sr(e,y),edges:s}))}),0),k.running=!0}))])):(this.lastResult={nodes:[],edges:s},[2,{nodes:[],edges:s}])}))}))},t.prototype.formatOptions=function(t,e){var r=t,n=t.width,o=t.height,i=t.getMass;if(r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=o||"undefined"==typeof window?o:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),i||(r.getMass=function(t){var r=1;x(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);var n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),t.preventOverlap){var a=S(0,t.nodeSpacing);t.nodeSize?g(t.nodeSize)?r.nodeSize=function(e){var r=t.nodeSize;return Math.max(r[0],r[1])+a(e)}:r.nodeSize=function(e){return t.nodeSize+a(e)}:r.nodeSize=function(t){var e=((null==t?void 0:t.data)||{}).size;return e?g(e)?Math.max(e[0],e[1])+a(t):M(e)?Math.max(e.width,e.height)+a(t):e+a(t):10+a(t)}}return r.linkDistance=t.linkDistance?S(1,t.linkDistance):function(t){return 1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target))},r.nodeStrength=S(1,t.nodeStrength),r.edgeStrength=S(1,t.edgeStrength),t},t.prototype.formatCentripetal=function(t,e){var r,n=t.centripetalOptions,o=t.center,i=t.clusterNodeStrength,a=t.leafCluster,s=t.clustering,u=t.nodeClusterBy,d=e.getAllNodes(),h=n||{leaf:2,single:2,others:1,center:function(t){return{x:o[0],y:o[1]}}};"function"!=typeof i&&(t.clusterNodeStrength=function(t){return i});var c=[];if(a&&u&&(r=Er(e,u),c=Array.from(new Set(null==d?void 0:d.map((function(t){return t.data[u]}))))||[],t.centripetalOptions=Object.assign(h,{single:100,leaf:function(e){var n=r[e.id]||{},o=n.siblingLeaves,i=n.sameTypeLeaves;return(null==i?void 0:i.length)===(null==o?void 0:o.length)||1===(null==c?void 0:c.length)?1:t.clusterNodeStrength(e)},others:1,center:function(t){var n,o=e.getDegree(t.id,"both");if(!o)return{x:100,y:100};if(1===o){var i=(r[t.id]||{}).sameTypeLeaves,a=void 0===i?[]:i;1===a.length?n=void 0:a.length>1&&(n=Mr(a))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y}}})),s&&u){r||(r=Er(e,u)),c||(c=Array.from(new Set(d.map((function(t){return t.data[u]}))))),c=c.filter((function(t){return void 0!==t}));var l={};c.forEach((function(t){var r=d.filter((function(e){return e.data[u]===t})).map((function(t){return e.getNode(t.id)}));l[t]=Mr(r)})),t.centripetalOptions=Object.assign(h,{single:function(e){return t.clusterNodeStrength(e)},leaf:function(e){return t.clusterNodeStrength(e)},others:function(e){return t.clusterNodeStrength(e)},center:function(t){var e=l[t.data[u]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y}}})}var f=t.centripetalOptions||{},g=f.leaf,p=f.single,v=f.others;g&&"function"!=typeof g&&(t.centripetalOptions.leaf=function(){return g}),p&&"function"!=typeof p&&(t.centripetalOptions.single=function(){return p}),v&&"function"!=typeof v&&(t.centripetalOptions.others=function(){return v})},t.prototype.runOneStep=function(t,e,r,n,o){var i={},a=t.getAllNodes(),s=t.getAllEdges();if(null==a?void 0:a.length){var u=o.monitor;this.calRepulsive(t,i,o),s&&this.calAttractive(t,i),this.calGravity(t,e,i,o),this.updateVelocity(t,i,n,o),u&&u({energy:this.calTotalEnergy(i,a),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}},t.prototype.calTotalEnergy=function(t,e){if(!(null==e?void 0:e.length))return 0;var r=0;return e.forEach((function(e,n){var o=t[e.id].x,i=t[e.id].y,a=o*o+i*i,s=e.data.mass;r+=(void 0===s?1:s)*a*.5})),r},t.prototype.calRepulsive=function(t,e,r){var n=r.factor,o=r.coulombDisScale;!function(t,e,r,n){var o=e/r,i=t.getAllNodes(),a=i.map((function(t,e){var r=t.data,n=r.nodeStrength;return{x:r.x,y:r.y,size:r.size,index:e,vx:0,vy:0,weight:o*n}})),s=F(a,(function(t){return t.x}),(function(t){return t.y})).visitAfter(yr);a.forEach((function(t){!function(t,e){e.visit((function(e,r,n,o,i){return mr(e,r,n,o,i,t)}))}(t,s)})),a.map((function(t,e){var r=i[e],o=r.id,a=r.data.mass,s=void 0===a?1:a;n[o]={x:t.vx/s,y:t.vy/s}}))}(t,n,o*o,e)},t.prototype.calAttractive=function(t,e){t.getAllEdges().forEach((function(r,n){var o=r.source,i=r.target,a=t.getNode(o),s=t.getNode(i);if(a&&s){var u=s.data.x-a.data.x,d=s.data.y-a.data.y;u||d||(u=.01*Math.random(),d=.01*Math.random());var h=Math.sqrt(u*u+d*d),c=u/h,l=d/h,f=r.data||{},g=f.linkDistance,p=void 0===g?200:g,v=f.edgeStrength,y=(p-h)*(void 0===v?200:v),m=1/(a.data.mass||1),w=1/(s.data.mass||1),x=c*y,E=l*y;e[o].x-=x*m,e[o].y-=E*m,e[i].x+=x*w,e[i].y+=E*w}}))},t.prototype.calGravity=function(t,e,r,n){var o=n.getCenter,i=t.getAllNodes(),a=e.getAllNodes(),u=e.getAllEdges(),d=n.width,h=n.height,c=n.center,l=n.gravity,f=n.centripetalOptions;i&&i.forEach((function(n){var i=n.id,g=n.data,p=g.mass,v=g.x,y=g.y,m=e.getNode(i),w=0,E=0,b=l,N=t.getDegree(i,"in"),M=t.getDegree(i,"out"),S=t.getDegree(i,"both"),k=null==o?void 0:o(m,S);if(k){var A=s(k,3);w=v-A[0],E=y-A[1],b=A[2]}else w=v-c[0],E=y-c[1];if(b&&(r[i].x-=b*w/p,r[i].y-=b*E/p),f){var R=f.leaf,I=f.single,_=f.others,D=f.center,O=(null==D?void 0:D(m,a,u,d,h))||{x:0,y:0,centerStrength:0},P=O.x,T=O.y,z=O.centerStrength;if(!x(P)||!x(T))return;var C=(v-P)/p,L=(y-T)/p;if(z&&(r[i].x-=z*C,r[i].y-=z*L),0===S){var q=I(m);if(!q)return;return r[i].x-=q*C,void(r[i].y-=q*L)}if(0===N||0===M){var j=R(m,a,u);if(!j)return;return r[i].x-=j*C,void(r[i].y-=j*L)}var F=_(m);if(!F)return;r[i].x-=F*C,r[i].y-=F*L}}))},t.prototype.updateVelocity=function(t,e,r,n){var o=n.damping,i=n.maxSpeed,a=n.interval,s=t.getAllNodes();(null==s?void 0:s.length)&&s.forEach((function(t){var n=t.id,s=(r[n].x+e[n].x*a)*o||.01,u=(r[n].y+e[n].y*a)*o||.01,d=Math.sqrt(s*s+u*u);if(d>i){var h=i/d;s*=h,u*=h}r[n]={x:s,y:u}}))},t.prototype.updatePosition=function(t,e,r,n){var o=this,i=n.distanceThresholdMode,a=n.interval,s=e.getAllNodes();if(null==s?void 0:s.length){var u=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),s.forEach((function(n){var s=n.id,d=t.getNode(s);if(x(d.data.fx)&&x(d.data.fy))e.mergeNodeData(s,{x:d.data.fx,y:d.data.fy});else{var h=r[s].x*a,c=r[s].y*a;e.mergeNodeData(s,{x:n.data.x+h,y:n.data.y+c});var l=Math.sqrt(h*h+c*c);switch(i){case"max":o.judgingDistance<l&&(o.judgingDistance=l);break;case"min":o.judgingDistance>l&&(o.judgingDistance=l);break;default:u+=l}}})),i&&"mean"!==i||(this.judgingDistance=u/s.length)}else this.judgingDistance=0},t}(),Er=function(t,e){var r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};var n={};return r.forEach((function(r,o){1===t.getDegree(r.id,"both")&&(n[r.id]=br(t,"leaf",r,e))})),n},br=function(t,e,r,n){var o=t.getDegree(r.id,"in"),i=t.getDegree(r.id,"out"),a=r,s=[];return 0===o?(a=t.getSuccessors(r.id)[0],s=t.getNeighbors(a.id)):0===i&&(a=t.getPredecessors(r.id)[0],s=t.getNeighbors(a.id)),s=s.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")})),{coreNode:a,siblingLeaves:s,sameTypeLeaves:Nr(t,e,n,r,s)}},Nr=function(t,e,r,n,o){var i=n.data[r]||"",a=(null==o?void 0:o.filter((function(t){return t.data[r]===i})))||[];return"leaf"===e&&(a=a.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")}))),a},Mr=function(t){var e={x:0,y:0};t.forEach((function(t){var r=t.data,n=r.x,o=r.y;e.x+=n||0,e.y+=o||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},Sr=function(t,e){return e.map((function(e){var r=e.id,o=e.data,i=t.getNode(r);return n(n({},i),{data:n(n({},i.data),{x:o.x,y:o.y})})}))},kr=function(){function t(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}return t.prototype.distanceTo=function(t){var e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)},t.prototype.setPos=function(t,e){this.rx=t,this.ry=e},t.prototype.resetForce=function(){this.fx=0,this.fy=0},t.prototype.addForce=function(t){var e=t.rx-this.rx,r=t.ry-this.ry,n=Math.hypot(e,r);n=n<1e-4?1e-4:n;var o=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=o*e/n,this.fy+=o*r/n},t.prototype.in=function(t){return t.contains(this.rx,this.ry)},t.prototype.add=function(e){var r=this.mass+e.mass;return new t({rx:(this.rx*this.mass+e.rx*e.mass)/r,ry:(this.ry*this.mass+e.ry*e.mass)/r,mass:r,degree:this.degree+e.degree})},t}();const Ar=kr;const Rr=function(){function t(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}return t.prototype.getLength=function(){return this.length},t.prototype.contains=function(t,e){var r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r},t.prototype.NW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.NE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.SW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t.prototype.SE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t}(),Ir=function(){function t(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}return t.prototype.insert=function(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e},t.prototype._putBody=function(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))},t.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},t.prototype.updateForce=function(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))},t}();var _r={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Dr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2",this.options=n(n({},_r),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,x,E,N,M,S,k,A,I;return a(this,(function(a){if(o=e.getAllEdges(),i=e.getAllNodes(),s=this.formatOptions(r,i.length),u=s.width,d=s.height,h=s.prune,c=s.maxIteration,f=s.nodeSize,g=s.center,!(null==i?void 0:i.length)||1===i.length)return[2,R(e,t,g)];if(p=i.map((function(t){return b(t,[u,d])})),v=o.filter((function(t){return t.source!==t.target})),y=new l({nodes:p,edges:v}),m=this.getSizes(y,e,f),this.run(y,e,c,m,t,s),h){for(w=0;w<v.length;w+=1)x=v[w],E=x.source,N=x.target,M=y.getDegree(E),S=y.getDegree(E),M<=1?(k=y.getNode(N),y.mergeNodeData(E,{x:k.data.x,y:k.data.y})):S<=1&&(A=y.getNode(E),y.mergeNodeData(N,{x:A.data.x,y:A.data.y}));I=n(n({},s),{prune:!1,barnesHut:!1}),this.run(y,e,100,m,t,I)}return[2,{nodes:p,edges:o}]}))}))},t.prototype.getSizes=function(t,e,r){for(var n=t.getAllNodes(),o={},i=0;i<n.length;i+=1){var a=n[i],d=a.id,h=a.data;if(o[d]=10,x(h.size))o[d]=h.size;else if(g(h.size))isNaN(h.size[0])||(o[d]=Math.max(h.size[0])),isNaN(h.size[1])||(o[d]=Math.max(h.size[1]));else if(M(h.size))o[d]=Math.max(h.size.width,h.size.height);else if(N(r)){var c=r(e.getNode(d));g(c)?o[d]=Math.max.apply(Math,u([],s(c))):o[d]=c}else g(r)?o[d]=Math.max.apply(Math,u([],s(r))):x(r)&&(o[d]=r)}return o},t.prototype.formatOptions=function(t,e){void 0===t&&(t={});var r=n(n({},this.options),t),o=r.center,i=r.width,a=r.height,s=r.barnesHut,u=r.prune,d=r.maxIteration,h=r.kr,c=r.kg;return r.width=i||"undefined"==typeof window?i:window.innerWidth,r.height=a||"undefined"==typeof window?a:window.innerHeight,r.center=o||[r.width/2,r.height/2],void 0===s&&e>250&&(r.barnesHut=!0),void 0===u&&e>100&&(r.prune=!0),0!==d||u?0===d&&u&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)):(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)),h||(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),c||(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r},t.prototype.run=function(t,e,r,n,o,i){for(var a=i.kr,s=i.barnesHut,u=i.onTick,d=t.getAllNodes(),h=0,c=r,l={},f={},g={},p=0;p<d.length;p+=1){var v=d[p],y=v.data,m=v.id;if(l[m]=[0,0],s){var w={id:p,rx:y.x,ry:y.y,mass:1,g:a,degree:t.getDegree(m)};g[m]=new Ar(w)}}for(;c>0;)h=this.oneStep(t,{iter:c,preventOverlapIters:50,krPrime:100,sg:h,forces:l,preForces:f,bodies:g,sizes:n},i),c--,null==u||u({nodes:d,edges:e.getAllEdges()});return t},t.prototype.oneStep=function(t,e,r){for(var n=e.iter,o=e.preventOverlapIters,i=e.krPrime,a=e.sg,d=e.preForces,h=e.bodies,c=e.sizes,l=e.forces,f=r.preventOverlap,g=r.barnesHut,p=t.getAllNodes(),v=0;v<p.length;v+=1){var y=p[v].id;d[y]=u([],s(l[y])),l[y]=[0,0]}return l=this.getAttrForces(t,n,o,c,l,r),l=g&&(f&&n>o||!f)?this.getOptRepGraForces(t,l,h,r):this.getRepGraForces(t,n,o,l,i,c,r),this.updatePos(t,l,d,a,r)},t.prototype.getAttrForces=function(t,e,r,n,o,i){for(var a=i.preventOverlap,s=i.dissuadeHubs,u=i.mode,d=i.prune,h=t.getAllEdges(),c=0;c<h.length;c+=1){var l=h[c],f=l.source,g=l.target,p=t.getNode(f),v=t.getNode(g),y=t.getDegree(f),m=t.getDegree(g);if(!d||!(y<=1||m<=1)){var w=[v.data.x-p.data.x,v.data.y-p.data.y],x=Math.hypot(w[0],w[1]);x=x<1e-4?1e-4:x,w[0]=w[0]/x,w[1]=w[1]/x,a&&e<r&&(x=x-n[f]-n[g]);var E=x,b=E;"linlog"===u&&(b=E=Math.log(1+x)),s&&(E=x/y,b=x/m),a&&e<r&&x<=0?(E=0,b=0):a&&e<r&&x>0&&(E=x,b=x),o[f][0]+=E*w[0],o[g][0]-=b*w[0],o[f][1]+=E*w[1],o[g][1]-=b*w[1]}}return o},t.prototype.getOptRepGraForces=function(t,e,r,n){for(var o=n.kg,i=n.center,a=n.prune,s=t.getAllNodes(),u=s.length,d=9e10,h=-9e10,c=9e10,l=-9e10,f=0;f<u;f+=1){var g=s[f],p=g.id,v=g.data;a&&t.getDegree(p)<=1||(r[p].setPos(v.x,v.y),v.x>=h&&(h=v.x),v.x<=d&&(d=v.x),v.y>=l&&(l=v.y),v.y<=c&&(c=v.y))}var y=Math.max(h-d,l-c),m=new Rr({xmid:(h+d)/2,ymid:(l+c)/2,length:y,massCenter:i,mass:u}),w=new Ir(m);for(f=0;f<u;f+=1)p=s[f].id,a&&t.getDegree(p)<=1||r[p].in(m)&&w.insert(r[p]);for(f=0;f<u;f+=1){var x=s[f],E=(p=x.id,v=x.data,t.getDegree(p));if(!(a&&E<=1)){r[p].resetForce(),w.updateForce(r[p]),e[p][0]-=r[p].fx,e[p][1]-=r[p].fy;var b=[v.x-i[0],v.y-i[1]],N=Math.hypot(b[0],b[1]);N=N<1e-4?1e-4:N,b[0]=b[0]/N,b[1]=b[1]/N;var M=o*(E+1);e[p][0]-=M*b[0],e[p][1]-=M*b[1]}}return e},t.prototype.getRepGraForces=function(t,e,r,n,o,i,a){for(var s=a.preventOverlap,u=a.kr,d=a.kg,h=a.center,c=a.prune,l=t.getAllNodes(),f=l.length,g=0;g<f;g+=1){for(var p=l[g],v=t.getDegree(p.id),y=g+1;y<f;y+=1){var m=l[y],w=t.getDegree(m.id);if(!c||!(v<=1||w<=1)){var x=[m.data.x-p.data.x,m.data.y-p.data.y],E=Math.hypot(x[0],x[1]);E=E<1e-4?1e-4:E,x[0]=x[0]/E,x[1]=x[1]/E,s&&e<r&&(E=E-i[p.id]-i[m.id]);var b=u*(v+1)*(w+1)/E;s&&e<r&&E<0?b=o*(v+1)*(w+1):s&&e<r&&0===E?b=0:s&&e<r&&E>0&&(b=u*(v+1)*(w+1)/E),n[p.id][0]-=b*x[0],n[m.id][0]+=b*x[0],n[p.id][1]-=b*x[1],n[m.id][1]+=b*x[1]}}var N=[p.data.x-h[0],p.data.y-h[1]],M=Math.hypot(N[0],N[1]);N[0]=N[0]/M,N[1]=N[1]/M;var S=d*(v+1);n[p.id][0]-=S*N[0],n[p.id][1]-=S*N[1]}return n},t.prototype.updatePos=function(t,e,r,n,o){for(var i=o.ks,a=o.tao,s=o.prune,u=o.ksmax,d=t.getAllNodes(),h=d.length,c=[],l=[],f=0,g=0,p=n,v=0;v<h;v+=1){var y=d[v].id,m=t.getDegree(y);if(!(s&&m<=1)){var w=[e[y][0]-r[y][0],e[y][1]-r[y][1]],E=Math.hypot(w[0],w[1]),b=[e[y][0]+r[y][0],e[y][1]+r[y][1]],N=Math.hypot(b[0],b[1]);c[v]=E,l[v]=N/2,f+=(m+1)*c[v],g+=(m+1)*l[v]}}var M=p;for(p=a*g/f,0!==M&&(p=p>1.5*M?1.5*M:p),v=0;v<h;v+=1){var S=d[v],k=(y=S.id,S.data);if(m=t.getDegree(y),!(s&&m<=1||x(k.fx)&&x(k.fy))){var A=i*p/(1+p*Math.sqrt(c[v])),R=Math.hypot(e[y][0],e[y][1]),I=u/(R=R<1e-4?1e-4:R),_=(A=A>I?I:A)*e[y][0],D=A*e[y][1];t.mergeNodeData(y,{x:k.x+_,y:k.y+D})}}return p},t}(),Or={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=n(n({},Or),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericFruchtermanLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,x,E=this;return a(this,(function(a){return this.running?[2]:(o=this.formatOptions(r),i=o.width,s=o.height,u=o.center,d=o.clustering,h=o.nodeClusterBy,c=o.maxIteration,f=o.onTick,g=e.getAllNodes(),p=e.getAllEdges(),(null==g?void 0:g.length)?1===g.length?(t&&e.mergeNodeData(g[0].id,{x:u[0],y:u[1]}),v={nodes:[n(n({},g[0]),{data:n(n({},g[0].data),{x:u[0],y:u[1]})})],edges:p},this.lastResult=v,[2,v]):(y=g.map((function(t){return b(t,[i,s])})),m=new l({nodes:y,edges:p}),w={},d&&y.forEach((function(t){var e=t.data[h];w[e]||(w[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=y,this.lastLayoutEdges=p,this.lastAssign=t,this.lastGraph=m,this.lastOptions=o,this.lastClusterMap=w,"undefined"==typeof window?[2]:(x=0,[2,new Promise((function(r){E.timeInterval=window.setInterval((function(){E.running?(E.runOneStep(m,w,o),t&&y.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y})})),null==f||f({nodes:y,edges:p}),++x>=c&&(window.clearInterval(E.timeInterval),r({nodes:y,edges:p}))):r({nodes:y,edges:p})}),0),E.running=!0}))])):(v={nodes:[],edges:p},this.lastResult=v,[2,v]))}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=n(n({},this.options),t),r=e.clustering,o=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=r&&!!o,e},t.prototype.runOneStep=function(t,e,r){var n=r.height,o=r.width,i=r.gravity,a=r.center,s=r.speed,u=r.clustering,d=r.nodeClusterBy,h=r.clusterGravity,c=n*o,l=Math.sqrt(c)/10,f=t.getAllNodes(),g=c/(f.length+1),p=Math.sqrt(g),v={};if(this.applyCalculate(t,v,p,g),u){for(var y in e)e[y].cx=0,e[y].cy=0,e[y].count=0;for(var y in f.forEach((function(t){var r=t.data,n=e[r[d]];x(r.x)&&(n.cx+=r.x),x(r.y)&&(n.cy+=r.y),n.count++})),e)e[y].cx/=e[y].count,e[y].cy/=e[y].count;var m=h||i;f.forEach((function(t,r){var n=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=e[o[d]],a=Math.sqrt((o.x-i.cx)*(o.x-i.cx)+(o.y-i.cy)*(o.y-i.cy)),s=p*m;v[n].x-=s*(o.x-i.cx)/a,v[n].y-=s*(o.y-i.cy)/a}}))}f.forEach((function(t,e){var r=t.id,n=t.data;if(x(n.x)&&x(n.y)){var o=.01*p*i;v[r].x-=o*(n.x-a[0]),v[r].y-=o*(n.y-a[1])}})),f.forEach((function(e,r){var n=e.id,o=e.data;if(x(o.fx)&&x(o.fy))return o.x=o.fx,void(o.y=o.fy);if(x(o.x)&&x(o.y)){var i=Math.sqrt(v[n].x*v[n].x+v[n].y*v[n].y);if(i>0){var a=Math.min(l*(s/800),i);t.mergeNodeData(n,{x:o.x+v[n].x/i*a,y:o.y+v[n].y/i*a})}}}))},t.prototype.applyCalculate=function(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)},t.prototype.calRepulsive=function(t,e,r){var n=t.getAllNodes();n.forEach((function(t,o){var i=t.data,a=t.id;e[a]={x:0,y:0},n.forEach((function(t,n){var s=t.data,u=t.id;if(!(o<=n)&&x(i.x)&&x(s.x)&&x(i.y)&&x(s.y)){var d=i.x-s.x,h=i.y-s.y,c=d*d+h*h;0===c&&(c=1,d=.01,h=.01);var l=r/c,f=d*l,g=h*l;e[a].x+=f,e[a].y+=g,e[u].x-=f,e[u].y-=g}}))}))},t.prototype.calAttractive=function(t,e,r){t.getAllEdges().forEach((function(n){var o=n.source,i=n.target;if(o&&i&&o!==i){var a=t.getNode(o).data,s=t.getNode(i).data;if(x(s.x)&&x(a.x)&&x(s.y)&&x(a.y)){var u=s.x-a.x,d=s.y-a.y,h=Math.sqrt(u*u+d*d)/r,c=u*h,l=d*h;e[o].x+=c,e[o].y+=l,e[i].x-=c,e[i].y-=l}}}))},t}(),Tr={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},zr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="grid",this.options=n(n({},Tr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericGridLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericGridLayout(!0,t,e),[2]}))}))},t.prototype.genericGridLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,p,v,y,m,w,E,N,M,A,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.begin,s=void 0===i?[0,0]:i,u=o.condense,d=o.preventOverlapPadding,h=o.preventOverlap,c=o.rows,l=o.cols,f=o.nodeSpacing,p=o.nodeSize,v=o.width,y=o.height,m=o.position,w=o.sortBy,E=e.getAllNodes(),N=e.getAllEdges(),!(M=null==E?void 0:E.length)||1===M)return[2,R(e,t,s)];if(A=E.map((function(t){return b(t)})),"id"===w||P(w)&&void 0!==A[0].data[w]||(w="degree"),"degree"===w?A.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):"id"===w?A.sort((function(t,e){return x(e.id)&&x(t.id)?e.id-t.id:(""+t.id).localeCompare(""+e.id)})):A.sort((function(t,e){return e.data[w]-t.data[w]})),I=v||"undefined"==typeof window?v:window.innerWidth,_=y||"undefined"==typeof window?y:window.innerHeight,D=M,O={rows:c,cols:l},null!=c&&null!=l?(O.rows=c,O.cols=l):null!=c&&null==l?(O.rows=c,O.cols=Math.ceil(D/O.rows)):null==c&&null!=l?(O.cols=l,O.rows=Math.ceil(D/O.cols)):(T=Math.sqrt(D*_/I),O.rows=Math.round(T),O.cols=Math.round(I/_*T)),O.rows=Math.max(O.rows,1),O.cols=Math.max(O.cols,1),O.cols*O.rows>D)z=Cr(O),C=Lr(O),(z-1)*C>=D?Cr(O,z-1):(C-1)*z>=D&&Lr(O,C-1);else for(;O.cols*O.rows<D;)z=Cr(O),((C=Lr(O))+1)*z>=D?Lr(O,C+1):Cr(O,z+1);for(L=u?0:I/O.cols,q=u?0:_/O.rows,(h||f)&&(j=S(10,f),F=k(30,p,!1),A.forEach((function(t){t.data.x&&t.data.y||(t.data.x=0,t.data.y=0);var r,n,o=e.getNode(t.id),i=F(o)||30;g(i)?(r=i[0],n=i[1]):(r=i,n=i);var a=void 0!==j?j(t):d,s=r+a,u=n+a;L=Math.max(L,s),q=Math.max(q,u)}))),V={},G={row:0,col:0},W={},B=0;B<A.length;B++){if($=A[B],U=void 0,m&&(U=m(e.getNode($.id))),U&&(void 0!==U.row||void 0!==U.col)){if(void 0===(H={row:U.row,col:U.col}).col)for(H.col=0;qr(V,H);)H.col++;else if(void 0===H.row)for(H.row=0;qr(V,H);)H.row++;W[$.id]=H,jr(V,H)}Vr($,s,L,q,W,O,G,V)}return K={nodes:A,edges:N},t&&A.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,K]}))}))},t}(),Cr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.min(n,o):Math.min(n,o)===t.rows?t.rows=e:t.cols=e,r},Lr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.max(n,o):Math.max(n,o)===t.rows?t.rows=e:t.cols=e,r},qr=function(t,e){return t["c-"+e.row+"-"+e.col]||!1},jr=function(t,e){return t["c-"+e.row+"-"+e.col]=!0},Fr=function(t,e){var r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},Vr=function(t,e,r,n,o,i,a,s){var u,d,h=o[t.id];if(h)u=h.col*r+r/2+e[0],d=h.row*n+n/2+e[1];else{for(;qr(s,a);)Fr(i,a);u=a.col*r+r/2+e[0],d=a.row*n+n/2+e[1],jr(s,a),Fr(i,a)}t.data.x=u,t.data.y=d};const Gr=Object.prototype.toString;function Wr(t){return Gr.call(t).endsWith("Array]")}function Br(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!Wr(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]<a&&(a=t[s]);return a}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]>a&&(a=t[s]);return a}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,a=void 0===i?r.autoMinMax?n:0:i,s=r.max,u=void 0===s?r.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var d=(u-a)/(o-n),h=0;h<t.length;h++)e[h]=(t[h]-n)*d+a;return e}const $r=" ".repeat(2),Ur=" ".repeat(4);function Hr(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=e;return`${t.constructor.name} {\\n${$r}[\\n${Ur}${function(t,e,r,n,o){const{rows:i,columns:a}=t,s=Math.min(i,e),u=Math.min(a,r),d=[];if("auto"===o){o=!1;t:for(let e=0;e<s;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let e=0;e<s;e++){let r=[];for(let i=0;i<u;i++)r.push(Kr(t.get(e,i),n,o));d.push(`${r.join(" ")}`)}return u!==a&&(d[d.length-1]+=` ... ${a-r} more columns`),s!==i&&d.push(`... ${i-e} more rows`),d.join(`\\n${Ur}`)}(t,r,n,o,i)}\\n${$r}]\\n${$r}rows: ${t.rows}\\n${$r}columns: ${t.columns}\\n}`}function Kr(t,e,r){return(t>=0&&r?` ${Yr(t,e-1)}`:Yr(t,e)).padEnd(e)}function Yr(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function Jr(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function Xr(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function Qr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function Zr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function tn(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(rn("startRow",e),rn("endRow",r),rn("startColumn",n),rn("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function en(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function rn(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function nn(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class on{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new sn(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new sn(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new sn(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new sn(t,e)}static ones(t,e){return new sn(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new sn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)o.set(r,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let a=o-n,s=new sn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(i()*a);s.set(r,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let t=0;t<n;t++)o.set(t,t,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let e=0;e<o;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new sn(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return on.isMatrix(t)?t:new sn(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let a=o;a<e;a++){let e=t.get(r,a)-i*t.get(n,a);t.set(r,a,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new sn(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){Jr(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return sn.rowVector(this.getRow(t))}setRow(t,e){Jr(this,t),e=Qr(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){Jr(this,t),Jr(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){Xr(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return sn.columnVector(this.getColumn(t))}setColumn(t,e){Xr(this,t),e=Zr(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){Xr(this,t),Xr(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){Jr(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){Xr(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){nn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){nn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(Jr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){Jr(this,t),nn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(Jr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){Jr(this,t),nn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(Xr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){Xr(this,t),nn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(Xr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){Xr(this,t),nn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){on.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=sn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new sn(e,n),i=new Float64Array(r);for(let a=0;a<n;a++){for(let e=0;e<r;e++)i[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,a,e)}}return o}strassen2x2(t){t=sn.checkMatrix(t);let e=new sn(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),d=t.get(1,1),h=(r+u)*(n+d),c=(a+u)*n,l=r*(i-d),f=u*(s-n),g=(r+o)*d,p=h+f-g+(o-u)*(s+d),v=l+g,y=c+f,m=h-c+l+(a-r)*(n+i);return e.set(0,0,p),e.set(0,1,v),e.set(1,0,y),e.set(1,1,m),e}strassen3x3(t){t=sn.checkMatrix(t);let e=new sn(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),d=this.get(2,1),h=this.get(2,2),c=t.get(0,0),l=t.get(0,1),f=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),y=t.get(2,0),m=t.get(2,1),w=t.get(2,2),x=(r-i)*(-l+p),E=(-r+i+a)*(c-l+p),b=(i+a)*(-c+l),N=r*c,M=(-r+u+d)*(c-f+v),S=(-r+u)*(f-v),k=(u+d)*(-c+f),A=(-o+d+h)*(p+y-m),R=(o-h)*(p-m),I=o*y,_=(d+h)*(-y+m),D=(-o+a+s)*(v+y-w),O=(o-s)*(v-w),P=(a+s)*(-y+w),T=N+I+n*g,z=(r+n+o-i-a-d-h)*p+E+b+N+A+I+_,C=N+M+k+(r+n+o-a-s-u-d)*v+I+D+P,L=x+a*(-c+l+g-p-v-y+w)+E+N+I+D+O,q=x+E+b+N+s*m,j=I+D+O+P+i*f,F=N+M+S+d*(-c+f+g-p-v-y+m)+A+R+I,V=A+R+I+_+u*l,G=N+M+S+k+h*w;return e.set(0,0,T),e.set(0,1,z),e.set(0,2,C),e.set(1,0,L),e.set(1,1,q),e.set(1,2,j),e.set(2,0,F),e.set(2,1,V),e.set(2,2,G),e}mmulStrassen(t){t=sn.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function a(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=on.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${r} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let s=Math.max(r,o),u=Math.max(n,i);return e=a(e,s,u),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=a(e,n+1,o+1),r=a(r,n+1,o+1)):n%2==1?(e=a(e,n+1,o),r=a(r,n+1,o)):o%2==1&&(e=a(e,n,o+1),r=a(r,n,o+1));let i=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,s-1),d=r.subMatrix(0,i-1,0,s-1),h=e.subMatrix(0,i-1,s,e.columns-1),c=r.subMatrix(0,i-1,s,r.columns-1),l=e.subMatrix(i,e.rows-1,0,s-1),f=r.subMatrix(i,r.rows-1,0,s-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),p=r.subMatrix(i,r.rows-1,s,r.columns-1),v=t(on.add(u,g),on.add(d,p),i,s),y=t(on.add(l,g),d,i,s),m=t(u,on.sub(c,p),i,s),w=t(g,on.sub(f,d),i,s),x=t(on.add(u,h),p,i,s),E=t(on.sub(l,u),on.add(d,c),i,s),b=t(on.sub(h,g),on.add(f,p),i,s),N=on.add(v,w);N.sub(x),N.add(b);let M=on.add(m,x),S=on.add(y,w),k=on.sub(v,y);k.add(m),k.add(E);let A=on.zeros(2*N.rows,2*N.columns);return A=A.setSubMatrix(N,0,0),A=A.setSubMatrix(M,N.rows,0),A=A.setSubMatrix(S,0,N.columns),A=A.setSubMatrix(k,N.rows,N.columns),A.subMatrix(0,n-1,0,o-1)}(e,t=a(t,s,u),s,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new sn(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&Br(o,{min:e,max:r,output:o}),n.setRow(t,o)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new sn(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&Br(o,{min:e,max:r,output:o}),n.setColumn(t,o)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=sn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new sn(e*n,r*o);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<o;s++)i.set(n*a+r,o*e+s,this.get(a,e)*t.get(r,s));return i}kroneckerSum(t){if(t=sn.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(sn.eye(r,r)),o=sn.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new sn(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=an){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=an){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){tn(this,t,e,r,n);let o=new sn(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new sn(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new sn(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=sn.checkMatrix(t)).isEmpty())return this;tn(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){!function(t,e){if(!Wr(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!Wr(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new sn(t.length,e.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<e.length;t++){let i=e[t];r.set(n,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new sn(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=en(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=en(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=en(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=en(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Wr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<n;a++){let n=0,s=0,u=0;for(let e=0;e<o;e++)u=t.get(a,e)-r[a],n+=u,s+=u*u;e?i.push((s-n*n/o)/(o-1)):i.push((s-n*n/o)/o)}return i}(this,r,n);case"column":if(!Wr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<o;a++){let o=0,s=0,u=0;for(let e=0;e<n;e++)u=t.get(e,a)-r[a],o+=u,s+=u*u;e?i.push((s-o*o/n)/(n-1)):i.push((s-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let a=0,s=0,u=0;for(let e=0;e<n;e++)for(let n=0;n<o;n++)u=t.get(e,n)-r,a+=u,s+=u*u;return e?(s-a*a/i)/(i-1):(s-a*a/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Wr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!Wr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!Wr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!Wr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return Hr(this,t)}}function an(t,e){return t-e}on.prototype.klass="Matrix","undefined"!=typeof Symbol&&(on.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return Hr(this)}),on.random=on.rand,on.randomInt=on.randInt,on.diagonal=on.diag,on.prototype.diagonal=on.prototype.diag,on.identity=on.eye,on.prototype.negate=on.prototype.neg,on.prototype.tensorProduct=on.prototype.kroneckerProduct;class sn extends on{constructor(t,e){if(super(),sn.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Wr(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!r[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return Jr(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),Jr(this,t,!0),e=Float64Array.from(Qr(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){Xr(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),Xr(this,t,!0),e=Zr(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(on,sn);class un extends on{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function dn(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class hn{constructor(t,e={}){if((t=un.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=e;let s,u=Boolean(o),d=Boolean(i),h=!1;if(r<n)if(a){s=t.transpose(),r=s.rows,n=s.columns,h=!0;let e=u;u=d,d=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let c=Math.min(r,n),l=Math.min(r+1,n),f=new Float64Array(l),g=new sn(r,c),p=new sn(n,n),v=new Float64Array(n),y=new Float64Array(r),m=new Float64Array(l);for(let t=0;t<l;t++)m[t]=t;let w=Math.min(r-1,n),x=Math.max(0,Math.min(n-2,r)),E=Math.max(w,x);for(let t=0;t<E;t++){if(t<w){f[t]=0;for(let e=t;e<r;e++)f[t]=dn(f[t],s.get(e,t));if(0!==f[t]){s.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<r;e++)s.set(e,t,s.get(e,t)/f[t]);s.set(t,t,s.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<n;e++){if(t<w&&0!==f[t]){let n=0;for(let o=t;o<r;o++)n+=s.get(o,t)*s.get(o,e);n=-n/s.get(t,t);for(let o=t;o<r;o++)s.set(o,e,s.get(o,e)+n*s.get(o,t))}v[e]=s.get(t,e)}if(u&&t<w)for(let e=t;e<r;e++)g.set(e,t,s.get(e,t));if(t<x){v[t]=0;for(let e=t+1;e<n;e++)v[t]=dn(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<n;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<r&&0!==v[t]){for(let e=t+1;e<r;e++)y[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)y[e]+=v[r]*s.get(e,r);for(let e=t+1;e<n;e++){let n=-v[e]/v[t+1];for(let o=t+1;o<r;o++)s.set(o,e,s.get(o,e)+n*y[o])}}if(d)for(let e=t+1;e<n;e++)p.set(e,t,v[e])}}let b=Math.min(n,r+1);if(w<n&&(f[w]=s.get(w,w)),r<b&&(f[b-1]=0),x+1<b&&(v[x]=s.get(x,b-1)),v[b-1]=0,u){for(let t=w;t<c;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<c;e++){let n=0;for(let o=t;o<r;o++)n+=g.get(o,t)*g.get(o,e);n=-n/g.get(t,t);for(let o=t;o<r;o++)g.set(o,e,g.get(o,e)+n*g.get(o,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(d)for(let t=n-1;t>=0;t--){if(t<x&&0!==v[t])for(let e=t+1;e<n;e++){let r=0;for(let o=t+1;o<n;o++)r+=p.get(o,t)*p.get(o,e);r=-r/p.get(t+1,t);for(let o=t+1;o<n;o++)p.set(o,e,p.get(o,e)+r*p.get(o,t))}for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}let N=b-1,M=0,S=Number.EPSILON;for(;b>0;){let t,e;for(t=b-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===b-2)e=4;else{let r;for(r=b-1;r>=t&&r!==t;r--){let e=(r!==b?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(f[r])<=S*e){f[r]=0;break}}r===t?e=3:r===b-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[b-2];v[b-2]=0;for(let r=b-2;r>=t;r--){let o=dn(f[r],e),i=f[r]/o,a=e/o;if(f[r]=o,r!==t&&(e=-a*v[r-1],v[r-1]=i*v[r-1]),d)for(let t=0;t<n;t++)o=i*p.get(t,r)+a*p.get(t,b-1),p.set(t,b-1,-a*p.get(t,r)+i*p.get(t,b-1)),p.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<b;n++){let o=dn(f[n],e),i=f[n]/o,a=e/o;if(f[n]=o,e=-a*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g.get(e,n)+a*g.get(e,t-1),g.set(e,t-1,-a*g.get(e,n)+i*g.get(e,t-1)),g.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(f[b-1]),Math.abs(f[b-2]),Math.abs(v[b-2]),Math.abs(f[t]),Math.abs(v[t])),o=f[b-1]/e,i=f[b-2]/e,a=v[b-2]/e,s=f[t]/e,h=v[t]/e,c=((i+o)*(i-o)+a*a)/2,l=o*a*(o*a);let y=0;0===c&&0===l||(y=c<0?0-Math.sqrt(c*c+l):Math.sqrt(c*c+l),y=l/(c+y));let m=(s+o)*(s-o)+y,w=s*h;for(let e=t;e<b-1;e++){let o=dn(m,w);0===o&&(o=Number.MIN_VALUE);let i=m/o,a=w/o;if(e!==t&&(v[e-1]=o),m=i*f[e]+a*v[e],v[e]=i*v[e]-a*f[e],w=a*f[e+1],f[e+1]=i*f[e+1],d)for(let t=0;t<n;t++)o=i*p.get(t,e)+a*p.get(t,e+1),p.set(t,e+1,-a*p.get(t,e)+i*p.get(t,e+1)),p.set(t,e,o);if(o=dn(m,w),0===o&&(o=Number.MIN_VALUE),i=m/o,a=w/o,f[e]=o,m=i*v[e]+a*f[e+1],f[e+1]=-a*v[e]+i*f[e+1],w=a*v[e+1],v[e+1]=i*v[e+1],u&&e<r-1)for(let t=0;t<r;t++)o=i*g.get(t,e)+a*g.get(t,e+1),g.set(t,e+1,-a*g.get(t,e)+i*g.get(t,e+1)),g.set(t,e,o)}v[b-2]=m,M+=1;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,d))for(let e=0;e<=N;e++)p.set(e,t,-p.get(e,t));for(;t<N&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,d&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}M=0,b--}}if(h){let t=p;p=g,g=t}this.m=r,this.n=n,this.s=f,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,o=sn.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?o.set(t,t,0):o.set(t,t,1/this.s[t]);let i=this.U,a=this.rightSingularVectors,s=a.mmul(o),u=a.rows,d=i.rows,h=sn.zeros(u,d);for(let t=0;t<u;t++)for(let e=0;e<d;e++){let r=0;for(let o=0;o<n;o++)r+=s.get(t,o)*i.get(e,o);h.set(t,e,r)}return h.mmul(e)}solveForDiagonal(t){return this.solve(sn.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new sn(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,a=i.rows,s=i.columns,u=new sn(r,a);for(let t=0;t<r;t++)for(let e=0;e<a;e++){let r=0;for(let n=0;n<s;n++)r+=o.get(t,n)*i.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return sn.diag(this.s)}}var cn,ln={center:[0,0],linkDistance:50},fn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="mds",this.options=n(n({},ln),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericMDSLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericMDSLayout(!0,t,e),[2]}))}))},t.prototype.genericMDSLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,g,y;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=void 0===i?[0,0]:i,u=o.linkDistance,d=void 0===u?50:u,h=e.getAllNodes(),c=e.getAllEdges(),(null==h?void 0:h.length)&&1!==h.length?(l=v({nodes:h,edges:c},!1),f=p(l),gn(f),m=d,w=[],f.forEach((function(t){var e=[];t.forEach((function(t){e.push(t*m)})),w.push(e)})),g=pn(w),y=[],g.forEach((function(t,e){var r=b(h[e]);r.data.x=t[0]+s[0],r.data.y=t[1]+s[1],y.push(r)})),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:y,edges:c}]):[2,R(e,t,s)];var m,w}))}))},t}(),gn=function(t){var e=-999999;t.forEach((function(t){t.forEach((function(t){t!==1/0&&e<t&&(e=t)}))})),t.forEach((function(r,n){r.forEach((function(r,o){r===1/0&&(t[n][o]=e)}))}))},pn=function(t){var e=sn.mul(sn.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),o=e.mean();e.add(o).subRowVector(r).subColumnVector(n);var i=new hn(e),a=sn.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((function(t){return sn.mul([t],[a]).toJSON()[0].splice(0,2)}))},vn={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},yn=function(t,e,r,n,o,i){e.forEach((function(a,s){r[s]={x:0,y:0},e.forEach((function(e,u){if(s!==u&&o[s]===o[u]){var d=a.x-e.x,h=a.y-e.y,c=Math.sqrt(d*d+h*h);if(0===c){c=1;var l=s>u?1:-1;d=.01*l,h=.01*l}if(c<i(t[s])/2+i(t[u])/2){var f=n*n/c;r[s].x+=d/c*f,r[s].y+=h/c*f}}}))}))},mn=function(t,e,r,n,o,i,a,s){var u=i||a/10;return n&&e.forEach((function(e,r){var n=t[r].x-t[o].x,i=t[r].y-t[o].y,a=Math.sqrt(n*n+i*i),s=i/a,u=-n/a,d=Math.sqrt(e.x*e.x+e.y*e.y),h=Math.acos((s*e.x+u*e.y)/d);h>Math.PI/2&&(h-=Math.PI/2,s*=-1,u*=-1);var c=Math.cos(h)*d;e.x=s*c,e.y=u*c})),t.forEach((function(i,a){if(a!==o){var d=Math.sqrt(e[a].x*e[a].x+e[a].y*e[a].y);if(d>0&&a!==o){var h=Math.min(u*(r/800),d);if(i.x+=e[a].x/d*h,i.y+=e[a].y/d*h,n){var c=i.x-t[o].x,l=i.y-t[o].y,f=Math.sqrt(c*c+l*l);c=c/f*s[a],l=l/f*s[a],i.x=t[o].x+c,i.y=t[o].y+l}}}})),t},wn={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},xn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="radial",this.options=n(n({},wn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRadialLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRadialLayout(!0,t,e),[2]}))}))},t.prototype.genericRadialLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,d,h,c,l,f,g,y,m,w,x,E,N,M,S,k,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K,Y,J,X,Q,Z,tt,et;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,d=o.height,h=o.center,c=o.focusNode,l=o.unitRadius,f=o.nodeSize,g=o.nodeSpacing,y=o.strictRadial,m=o.preventOverlap,w=o.maxPreventOverlapIteration,x=o.sortBy,E=o.linkDistance,N=void 0===E?50:E,M=o.sortStrength,S=void 0===M?10:M,k=o.maxIteration,I=void 0===k?1e3:k,_=e.getAllNodes(),D=e.getAllEdges(),O=i||"undefined"==typeof window?i:window.innerWidth,T=d||"undefined"==typeof window?d:window.innerHeight,z=h||[O/2,T/2],!(null==_?void 0:_.length)||1===_.length)return[2,R(e,t,z)];if(C=_[0],P(c)){for(L=0;L<_.length;L++)if(_[L].id===c){C=_[L];break}}else C=c||_[0];return q=Nn(_,C.id),j=v({nodes:_,edges:D},!1),F=p(j),V=Sn(F,q),Mn(F,q,V+1),G=F[q],W=O-z[0]>z[0]?z[0]:O-z[0],B=T-z[1]>z[1]?z[1]:T-z[1],0===W&&(W=O/2),0===B&&(B=T/2),$=Math.min(W,B),U=Math.max.apply(Math,u([],s(G))),H=[],K=l||$/U,G.forEach((function(t,e){H[e]=t*K})),Y=En(_,F,N,H,K,x,S),J=bn(Y),X=function(t,e,r){try{var n=sn.mul(sn.pow(e,2),-.5),o=n.mean("row"),i=n.mean("column"),a=n.mean();n.add(a).subRowVector(o).subColumnVector(i);var s=new hn(n),u=sn.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((function(e){return sn.mul([e],[u]).toJSON()[0].splice(0,t)}))}catch(t){for(var d=[],h=0;h<e.length;h++){var c=Math.random()*r,l=Math.random()*r;d.push([c,l])}return d}}(N,Y,N),Q=X.map((function(t){var e=s(t,2),r=e[0],n=e[1];return{x:(isNaN(r)?Math.random()*N:r)-X[q][0],y:(isNaN(n)?Math.random()*N:n)-X[q][1]}})),this.run(I,Q,J,Y,H,q),m&&(Z=A(f,g),tt={nodes:_,nodeSizeFunc:Z,positions:Q,radii:H,height:T,width:O,strictRadial:Boolean(y),focusIdx:q,iterations:w||200,k:Q.length/4.5},Q=function(t,e){for(var r=n(n({},vn),e),o=r.positions,i=r.iterations,a=r.width,s=r.k,u=r.speed,d=void 0===u?100:u,h=r.strictRadial,c=r.focusIdx,l=r.radii,f=void 0===l?[]:l,g=r.nodeSizeFunc,p=t.getAllNodes(),v=[],y=a/10,m=0;m<i;m++)o.forEach((function(t,e){v[e]={x:0,y:0}})),yn(p,o,v,s,f,g),mn(o,v,d,h,c,y,a,f);return o}(e,tt)),et=[],Q.forEach((function(t,e){var r=b(_[e]);r.data.x=t.x+z[0],r.data.y=t.y+z[1],et.push(r)})),t&&et.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:et,edges:D}]}))}))},t.prototype.run=function(t,e,r,n,o,i){for(var a=0;a<=t;a++){var s=a/t;this.oneIteration(s,e,o,n,r,i)}},t.prototype.oneIteration=function(t,e,r,n,o,i){var a=1-t;e.forEach((function(s,u){var d=y(s,{x:0,y:0}),h=0===d?0:1/d;if(u!==i){var c=0,l=0,f=0;e.forEach((function(t,e){if(u!==e){var r=y(s,t),i=0===r?0:1/r,a=n[e][u];f+=o[u][e],c+=o[u][e]*(t.x+a*(s.x-t.x)*i),l+=o[u][e]*(t.y+a*(s.y-t.y)*i)}}));var g=0===r[u]?0:1/r[u];f*=a,f+=t*g*g,c*=a,c+=t*g*s.x*h,s.x=c/f,l*=a,l+=t*g*s.y*h,s.y=l/f}}))},t}(),En=function(t,e,r,n,o,i,a){if(!t)return[];var s=[];if(e){var u={};e.forEach((function(e,d){var h=[];e.forEach((function(e,s){var c,l;if(d===s)h.push(0);else if(n[d]===n[s])if("data"===i)h.push(e*(Math.abs(d-s)*a)/(n[d]/o));else if(i){var f=void 0,g=void 0;if(u[t[d].id])f=u[t[d].id];else{var p=("id"===i?t[d].id:null===(c=t[d].data)||void 0===c?void 0:c[i])||0;f=P(p)?p.charCodeAt(0):p,u[t[d].id]=f}u[t[s].id]?g=u[t[s].id]:(p=("id"===i?t[s].id:null===(l=t[s].data)||void 0===l?void 0:l[i])||0,g=P(p)?p.charCodeAt(0):p,u[t[s].id]=g),h.push(e*(Math.abs(f-g)*a)/(n[d]/o))}else h.push(e*r/(n[d]/o));else{var v=(r+o)/2;h.push(e*v)}})),s.push(h)}))}return s},bn=function(t){for(var e=t.length,r=t[0].length,n=[],o=0;o<e;o++){for(var i=[],a=0;a<r;a++)0!==t[o][a]?i.push(1/(t[o][a]*t[o][a])):i.push(0);n.push(i)}return n},Nn=function(t,e){var r=-1;return t.forEach((function(t,n){t.id===e&&(r=n)})),Math.max(r,0)},Mn=function(t,e,r){for(var n=t.length,o=0;o<n;o++)if(t[e][o]===1/0){t[e][o]=r,t[o][e]=r;for(var i=0;i<n;i++)t[o][i]!==1/0&&t[e][i]===1/0&&(t[e][i]=r+t[o][i],t[i][e]=r+t[o][i])}for(o=0;o<n;o++)if(o!==e)for(i=0;i<n;i++)if(t[o][i]===1/0){var a=Math.abs(t[e][o]-t[e][i]);a=0===a?1:a,t[o][i]=a}},Sn=function(t,e){for(var r=0,n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r},kn={center:[0,0],width:300,height:300},An=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="random",this.options=n(n({},kn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRandomLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRandomLayout(!0,t,e),[2]}))}))},t.prototype.genericRandomLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,d=e.getAllNodes(),h=s||"undefined"==typeof window?s:window.innerWidth,c=u||"undefined"==typeof window?u:window.innerHeight,l=i||[h/2,c/2],f=[],d&&d.forEach((function(t){f.push({id:t.id,data:{x:.9*(Math.random()-.5)*h+l[0],y:.9*(Math.random()-.5)*c+l[1]}})})),t&&f.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:f,edges:e.getAllEdges()}]}))}))},t}(),Rn={circular:_,concentric:z,mds:fn,random:An,grid:zr,radial:xn,force:xr,d3force:zt,fruchterman:Pr,forceAtlas2:Dr,dagre:pr};function In(){var t;(null===(t=cn)||void 0===t?void 0:t.stop)&&cn.stop()}function _n(t,e){return i(this,void 0,void 0,(function(){var r,n,o,i,s,u,d,h,c;return a(this,(function(a){switch(a.label){case 0:if(r=t.layout,n=r.id,o=r.options,i=r.iterations,s=t.nodes,u=t.edges,d=new l({nodes:s,edges:u}),!(h=Rn[n]))throw new Error("Unknown layout id: "+n);return[4,(cn=new h(o)).execute(d)];case 1:return c=a.sent(),!!(f=cn).tick&&!!f.stop&&(cn.stop(),c=cn.tick(i)),[2,[c,e]]}var f}))}))}addEventListener("message",(function(t){var r,n=t.data,o=n.type,i=n.method,a=n.id,s=n.params;"RPC"===o&&i&&((r=e[i])?Promise.resolve().then((function(){return r.apply(e,s)})):Promise.reject("No such method")).then((function(t){postMessage({type:"RPC",id:a,result:t})})).catch((function(t){var e={message:t};t.stack&&(e.message=t.message,e.stack=t.stack,e.name=t.name),postMessage({type:"RPC",id:a,error:e})}))})),postMessage({type:"RPC",method:"ready"});\n//# sourceMappingURL=11f9ed8e311b689f74d1.worker.js.map'])),{name:"[fullhash].worker.js"});return URL.revokeObjectURL(URL.createObjectURL(new Blob(['var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{calculateLayout:()=>_n,stopLayout:()=>In});var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function o(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function i(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function a(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function u(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}Object.create,Object.create;const d=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[],i=this._events["*"]||[],a=function(n){for(var o=n.length,i=0;i<o;i++)if(n[i]){var a=n[i],s=a.callback;a.once&&(n.splice(i,1),0===n.length&&delete e._events[t],o--,i--),s.apply(e,r)}};a(o),a(i)},t.prototype.off=function(t,e){if(t)if(e){for(var r=this._events[t]||[],n=r.length,o=0;o<n;o++)r[o].callback===e&&(r.splice(o,1),n--,o--);0===r.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function h(t,e,r,n){for(;t.length;){const o=t.shift();if(r(o))return!0;e.add(o.id),n(o.id).forEach((r=>{e.has(r.id)||(e.add(r.id),t.push(r))}))}return!1}function c(t,e,r,n){if(r(t))return!0;e.add(t.id);for(const o of n(t.id))if(!e.has(o.id)&&c(o,e,r,n))return!0;return!1}class l extends d{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const r=e.find((e=>e.type===t.type&&e.id===t.id&&e.propertyName===t.propertyName));r?r.newValue=t.newValue:e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const r=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),r=this.bothEdgesMap.get(t);r?.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((e=>{e.childrenMap.get(t)?.forEach((t=>{e.parentMap.delete(t.id)})),e.parentMap.delete(t),e.childrenMap.delete(t)})),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){const n=this.getNode(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateNodeDataProperty(t,e,r)}))}))}updateNodeData(...t){const e=t[0],r=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:o})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),o.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),o=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),o.delete(e),i.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.source,o=e;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:o})}))}updateEdgeTarget(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.target,o=e;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:o})}))}updateEdgeDataProperty(t,e,r){const n=this.getEdge(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}updateEdgeData(...t){const e=t[0],r=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:o})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateEdgeDataProperty(t,e,r)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const r=[],n=Array.isArray(t)?t:[t];for(;n.length;){const t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach((t=>{t.children?.forEach((r=>{this.setParent(r.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const r=this.treeIndices.get(e).childrenMap.get(t);return Array.from(r||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const r=[];let n,o=this.getNode(t);for(;n=this.getParent(o.id,e);)r.push(n),o=n;return r}setParent(t,e,r){this.checkTreeExistence(r);const n=this.treeIndices.get(r),o=this.getNode(t),i=n.parentMap.get(t),a=this.getNode(e);n.parentMap.set(t,a),i&&n.childrenMap.get(i.id)?.delete(o);let s=n.childrenMap.get(a.id);s||(s=new Set,n.childrenMap.set(a.id,s)),s.add(o),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:i?.id,newParentId:a.id})}))}dfsTree(t,e,r){return c(this.getNode(t),new Set,e,(t=>this.getChildren(t,r)))}bfsTree(t,e,r){return h([this.getNode(t)],new Set,e,(t=>this.getChildren(t,r)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return h([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return c(this.getNode(t),new Set,e,n)}clone(){const t=this.getAllNodes().map((t=>({...t,data:{...t.data}}))),e=this.getAllEdges().map((t=>({...t,data:{...t.data}}))),r=new l({nodes:t,edges:e});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},n)=>{const o=new Map;t.forEach(((t,e)=>{o.set(e,r.getNode(t.id))}));const i=new Map;e.forEach(((t,e)=>{i.set(e,new Set(Array.from(t).map((t=>r.getNode(t.id)))))})),r.treeIndices.set(n,{parentMap:o,childrenMap:i})})),r}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var f=/-(\\w)/g,g=(function(t){return t.replace(f,(function(t,e){return e?e.toUpperCase():""}))},Object.create(null),Array.isArray),p=function(t){for(var e=[],r=t.length,n=0;n<r;n+=1){e[n]=[];for(var o=0;o<r;o+=1)n===o?e[n][o]=0:0!==t[n][o]&&t[n][o]?e[n][o]=t[n][o]:e[n][o]=1/0}for(var i=0;i<r;i+=1)for(n=0;n<r;n+=1)for(o=0;o<r;o+=1)e[n][o]>e[n][i]+e[i][o]&&(e[n][o]=e[n][i]+e[i][o]);return e},v=function(t,e){var r=t.nodes,n=t.edges,o=[],i={};if(!r)throw new Error("invalid nodes data!");return r&&r.forEach((function(t,e){i[t.id]=e,o.push([])})),null==n||n.forEach((function(t){var r=t.source,n=t.target,a=i[r],s=i[n];void 0!==a&&void 0!==s&&(o[a][s]=1,e||(o[s][a]=1))})),o},y=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},m={}.toString;const w=function(t,e){return m.call(t)==="[object "+e+"]"},x=function(t){return w(t,"Number")};var E=function(t){if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var e=[];return t.forEach((function(t){e.push(t)})),e.map((function(t){return E(t)}))}if("object"==typeof t){var r={};return Object.keys(t).forEach((function(e){r[e]=E(t[e])})),r}return t},b=function(t,e){var r=E(t);return r.data=r.data||{},e&&(x(r.data.x)||(r.data.x=Math.random()*e[0]),x(r.data.y)||(r.data.y=Math.random()*e[1])),r};const N=function(t){return"function"==typeof t},M=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function S(t,e){return N(e)?e:x(e)?function(){return e}:function(){return t}}function k(t,e,r){return void 0===r&&(r=!0),e||0===e?N(e)?e:x(e)?function(){return e}:g(e)?function(){if(r){var n=Math.max.apply(Math,u([],s(e)));return isNaN(n)?t:n}return e}:M(e)?function(){if(r){var n=Math.max(e.width,e.height);return isNaN(n)?t:n}return[e.width,e.height]}:function(){return t}:function(e){var r=(e.data||{}).size;return r?g(r)?r[0]>r[1]?r[0]:r[1]:M(r)?r.width>r.height?r.width:r.height:r:t}}var A=function(t,e){var r;return r=x(e)?function(){return e}:N(e)?e:function(){return 0},t?g(t)?function(e){return(t[0]>t[1]?t[0]:t[1])+r(e)}:function(e){return t+r(e)}:function(t){var e,n;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return Math.max(t.data.bboxSize[0],t.data.bboxSize[1])+r(t);if(null===(n=t.data)||void 0===n?void 0:n.size){if(g(t.data.size))return Math.max(t.data.size[0],t.data.size[1])+r(t);var o=t.data.size;return M(o)?(o.width>o.height?o.width:o.height)+r(t):o+r(t)}return 10+r(t)}},R=function(t,e,r){var o=t.getAllNodes(),i=t.getAllEdges();return(null==o?void 0:o.length)?1===o.length?(e&&t.mergeNodeData(o[0].id,{x:r[0],y:r[1]}),{nodes:[n(n({},o[0]),{data:n(n({},o[0].data),{x:r[0],y:r[1]})})],edges:i}):void 0:{nodes:[],edges:i}},I={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},_=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="circular",this.options=n(n({},I),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericCircularLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericCircularLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericCircularLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,u,d,h,c,l,f,g,p,v,y,m,w,x,E,N,M,A,I,_,P,T,z,C,L,q,j,F,V,G,W,B,$,U;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,u=o.height,d=o.center,h=o.divisions,c=o.startAngle,l=void 0===c?0:c,f=o.endAngle,g=void 0===f?2*Math.PI:f,p=o.angleRatio,v=o.ordering,y=o.clockwise,m=o.nodeSpacing,w=o.nodeSize,x=e.getAllNodes(),E=e.getAllEdges(),N=s(O(i,u,d),3),M=N[0],A=N[1],I=N[2],!(_=null==x?void 0:x.length)||1===_)return[2,R(e,t,I)];for(P=(g-l)/_,T=o.radius,z=o.startRadius,C=o.endRadius,m?(L=S(10,m),q=k(10,w),j=-1/0,x.forEach((function(t){var e=q(t);j<e&&(j=e)})),F=0,x.forEach((function(t,e){F+=0===e?j||10:(L(t)||0)+(j||10)})),T=F/(2*Math.PI)):T||z||C?!z&&C?z=C:z&&!C&&(C=z):T=Math.min(A,M)/2,V=P*p,G=[],G="topology"===v?D(e,x):"topology-directed"===v?D(e,x,!0):"degree"===v?function(t,e){var r=[];return e.forEach((function(t,e){r.push(b(t))})),r.sort((function(e,r){return t.getDegree(e.id,"both")-t.getDegree(r.id,"both")})),r}(e,x):x.map((function(t){return b(t)})),W=Math.ceil(_/h),B=0;B<_;++B)($=T)||null===z||null===C||($=z+B*(C-z)/(_-1)),$||($=10+100*B/(_-1)),U=l+B%W*V+2*Math.PI/h*Math.floor(B/W),y||(U=g-B%W*V-2*Math.PI/h*Math.floor(B/W)),G[B].data.x=I[0]+Math.cos(U)*$,G[B].data.y=I[1]+Math.sin(U)*$;return t&&G.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:G,edges:E}]}))}))},t}(),D=function(t,e,r){void 0===r&&(r=!1);var n=[b(e[0])],o={},i=e.length;o[e[0].id]=!0;var a=0;return e.forEach((function(s,u){if(0!==u)if(u!==i-1&&t.getDegree(s.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(n[a].id,s.id)||o[s.id]){for(var d=r?t.getSuccessors(n[a].id):t.getNeighbors(n[a].id),h=!1,c=0;c<d.length;c++){var l=d[c];if(t.getDegree(l.id)===t.getDegree(s.id)&&!o[l.id]){n.push(b(l)),o[l.id]=!0,h=!0;break}}for(var f=0;!h&&(o[e[f].id]||(n.push(b(e[f])),o[e[f].id]=!0,h=!0),++f!==i););}else n.push(b(s)),o[s.id]=!0,a++})),n},O=function(t,e,r){var n=t,o=e,i=r;return n||"undefined"==typeof window||(n=window.innerWidth),o||"undefined"==typeof window||(o=window.innerHeight),i||(i=[n/2,o/2]),[n,o,i]};const P=function(t){return w(t,"String")};var T={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},z=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="concentric",this.options=n(n({},T),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericConcentricLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericConcentricLayout(!0,t,e),[2]}))}))},t.prototype.genericConcentricLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,p,v,y,m,w,E,S,k,A,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K,Y;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,d=o.sortBy,h=o.maxLevelDiff,c=o.sweep,l=o.clockwise,f=o.equidistant,p=o.preventOverlap,v=o.startAngle,y=void 0===v?1.5*Math.PI:v,m=o.nodeSize,w=o.nodeSpacing,E=e.getAllNodes(),S=e.getAllEdges(),k=s||"undefined"==typeof window?s:window.innerWidth,A=u||"undefined"==typeof window?u:window.innerHeight,I=i||[k/2,A/2],!(null==E?void 0:E.length)||1===E.length)return[2,R(e,t,I)];if(_=[],O=0,D=g(m)?Math.max(m[0],m[1]):m,g(w)?O=Math.max(w[0],w[1]):x(w)&&(O=w),E.forEach((function(t){var e=b(t);_.push(e);var r=D,n=e.data;g(n.size)?r=Math.max(n.size[0],n.size[1]):x(n.size)?r=n.size:M(n.size)&&(r=Math.max(n.size.width,n.size.height)),D=Math.max(D,r),N(w)&&(O=Math.max(w(t),O))})),T={},_.forEach((function(t,e){T[t.id]=e})),P(z=d)&&void 0!==_[0].data[z]||(z="degree"),"degree"===z?_.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):_.sort((function(t,e){return e.data[z]-t.data[z]})),C=_[0],L=(h||("degree"===z?e.getDegree(C.id,"both"):C.data[z]))/4,j=(q=[{nodes:[]}])[0],_.forEach((function(t){if(j.nodes.length>0){var r="degree"===z?Math.abs(e.getDegree(j.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(j.nodes[0].data[z]-t.data[z]);L&&r>=L&&(j={nodes:[]},q.push(j))}j.nodes.push(t)})),F=D+O,p||(V=q.length>0&&q[0].nodes.length>1,G=Math.min(k,A)/2-F,W=G/(q.length+(V?1:0)),F=Math.min(F,W)),B=0,q.forEach((function(t){var e=void 0===c?2*Math.PI-2*Math.PI/t.nodes.length:c;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&p){var r=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),o=Math.sqrt(F*F/(r*r+n*n));B=Math.max(o,B)}t.r=B,B+=F})),f){for($=0,U=0,H=0;H<q.length;H++)K=q[H],Y=(K.r||0)-U,$=Math.max($,Y);U=0,q.forEach((function(t,e){0===e&&(U=t.r||0),t.r=U,U+=$}))}return q.forEach((function(t){var e=t.dTheta||0,r=t.r||0;t.nodes.forEach((function(t,n){var o=y+(l?1:-1)*e*n;t.data.x=I[0]+r*Math.cos(o),t.data.y=I[1]+r*Math.sin(o)}))})),t&&_.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:_,edges:S}]}))}))},t}();function C(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i,a,s,u,d,h,c,l,f=t._root,g={data:n},p=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!f)return t._root=g,t;for(;f.length;)if((d=e>=(i=(p+y)/2))?p=i:y=i,(h=r>=(a=(v+m)/2))?v=a:m=a,o=f,!(f=f[c=h<<1|d]))return o[c]=g,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&r===u)return g.next=f,o?o[c]=g:t._root=g,t;do{o=o?o[c]=new Array(4):t._root=new Array(4),(d=e>=(i=(p+y)/2))?p=i:y=i,(h=r>=(a=(v+m)/2))?v=a:m=a}while((c=h<<1|d)==(l=(u>=a)<<1|s>=i));return o[l]=f,o[c]=g,t}function L(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function q(t){return t[0]}function j(t){return t[1]}function F(t,e,r){var n=new V(null==e?q:e,null==r?j:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function V(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function G(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var W=F.prototype=V.prototype;function B(t){return function(){return t}}function $(t){return 1e-6*(t()-.5)}W.copy=function(){var t,e,r=new V(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=G(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var o=0;o<4;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(4)}):n.target[o]=G(e));return r},W.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return C(this.cover(e,r),e,r,t)},W.addAll=function(t){var e,r,n,o,i=t.length,a=new Array(i),s=new Array(i),u=1/0,d=1/0,h=-1/0,c=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(a[r]=n,s[r]=o,n<u&&(u=n),n>h&&(h=n),o<d&&(d=o),o>c&&(c=o));if(u>h||d>c)return this;for(this.cover(u,d).cover(h,c),r=0;r<i;++r)C(this,a[r],s[r],t[r]);return this},W.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var a,s,u=o-r||1,d=this._root;r>t||t>=o||n>e||e>=i;)switch(s=(e<n)<<1|t<r,(a=new Array(4))[s]=d,d=a,u*=2,s){case 0:o=r+u,i=n+u;break;case 1:r=o-u,i=n+u;break;case 2:o=r+u,n=i-u;break;case 3:r=o-u,n=i-u}this._root&&this._root.length&&(this._root=d)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this},W.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},W.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},W.find=function(t,e,r){var n,o,i,a,s,u,d,h=this._x0,c=this._y0,l=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new L(p,h,c,l,f)),null==r?r=1/0:(h=t-r,c=e-r,l=t+r,f=e+r,r*=r);u=g.pop();)if(!(!(p=u.node)||(o=u.x0)>l||(i=u.y0)>f||(a=u.x1)<h||(s=u.y1)<c))if(p.length){var v=(o+a)/2,y=(i+s)/2;g.push(new L(p[3],v,y,a,s),new L(p[2],o,y,v,s),new L(p[1],v,i,a,y),new L(p[0],o,i,v,y)),(d=(e>=y)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-d],g[g.length-1-d]=u)}else{var m=t-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),x=m*m+w*w;if(x<r){var E=Math.sqrt(r=x);h=t-E,c=e-E,l=t+E,f=e+E,n=p.data}}return n},W.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,r,n,o,i,a,s,u,d,h,c,l,f=this._root,g=this._x0,p=this._y0,v=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((d=i>=(s=(g+v)/2))?g=s:v=s,(h=a>=(u=(p+y)/2))?p=u:y=u,e=f,!(f=f[c=h<<1|d]))return this;if(!f.length)break;(e[c+1&3]||e[c+2&3]||e[c+3&3])&&(r=e,l=c)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(o=f.next)&&delete f.next,n?(o?n.next=o:delete n.next,this):e?(o?e[c]=o:delete e[c],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[l]=f:this._root=f),this):(this._root=o,this)},W.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},W.root=function(){return this._root},W.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},W.visit=function(t){var e,r,n,o,i,a,s=[],u=this._root;for(u&&s.push(new L(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,n=e.x0,o=e.y0,i=e.x1,a=e.y1)&&u.length){var d=(n+i)/2,h=(o+a)/2;(r=u[3])&&s.push(new L(r,d,h,i,a)),(r=u[2])&&s.push(new L(r,n,h,d,a)),(r=u[1])&&s.push(new L(r,d,o,i,h)),(r=u[0])&&s.push(new L(r,n,o,d,h))}return this},W.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new L(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.x1,d=e.y1,h=(a+u)/2,c=(s+d)/2;(i=o[0])&&r.push(new L(i,a,s,h,c)),(i=o[1])&&r.push(new L(i,h,s,u,c)),(i=o[2])&&r.push(new L(i,a,c,h,d)),(i=o[3])&&r.push(new L(i,h,c,u,d))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},W.x=function(t){return arguments.length?(this._x=t,this):this._x},W.y=function(t){return arguments.length?(this._y=t,this):this._y};var U={value:()=>{}};function H(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new K(n)}function K(t){this._=t}function Y(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function J(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=U,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}K.prototype=H.prototype={constructor:K,on:function(t,e){var r,n,o=this._,i=(n=o,(t+"").trim().split(/^|\\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)o[r]=J(o[r],t.name,e);else if(null==e)for(r in o)o[r]=J(o[r],t.name,null);return this}for(;++a<s;)if((r=(t=i[a]).type)&&(r=Y(o[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new K(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};const X=H;var Q,Z,tt=0,et=0,rt=0,nt=1e3,ot=0,it=0,at=0,st="object"==typeof performance&&performance.now?performance:Date,ut="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function dt(){return it||(ut(ht),it=st.now()+at)}function ht(){it=0}function ct(){this._call=this._time=this._next=null}function lt(t,e,r){var n=new ct;return n.restart(t,e,r),n}function ft(){it=(ot=st.now())+at,tt=et=0;try{!function(){dt(),++tt;for(var t,e=Q;e;)(t=it-e._time)>=0&&e._call.call(void 0,t),e=e._next;--tt}()}finally{tt=0,function(){for(var t,e,r=Q,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:Q=e);Z=t,pt(n)}(),it=0}}function gt(){var t=st.now(),e=t-ot;e>nt&&(at-=e,ot=t)}function pt(t){tt||(et&&(et=clearTimeout(et)),t-it>24?(t<1/0&&(et=setTimeout(ft,t-st.now()-at)),rt&&(rt=clearInterval(rt))):(rt||(ot=st.now(),rt=setInterval(gt,nt)),tt=1,ut(ft)))}ct.prototype=lt.prototype={constructor:ct,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?dt():+r)+(null==e?0:+e),this._next||Z===this||(Z?Z._next=this:Q=this,Z=this),this._call=t,this._time=r,pt()},stop:function(){this._call&&(this._call=null,this._time=1/0,pt())}};const vt=1664525,yt=1013904223,mt=4294967296;function wt(t){return t.x}function xt(t){return t.y}var Et=10,bt=Math.PI*(3-Math.sqrt(5));function Nt(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,a=.6,s=new Map,u=lt(c),d=X("tick","end"),h=function(){let t=1;return()=>(t=(vt*t+yt)%mt)/mt}();function c(){l(),d.call("tick",e),r<n&&(u.stop(),d.call("end",e))}function l(n){var u,d,h=t.length;void 0===n&&(n=1);for(var c=0;c<n;++c)for(r+=(i-r)*o,s.forEach((function(t){t(r)})),u=0;u<h;++u)null==(d=t[u]).fx?d.x+=d.vx*=a:(d.x=d.fx,d.vx=0),null==d.fy?d.y+=d.vy*=a:(d.y=d.fy,d.vy=0);return e}function f(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var o=Et*Math.sqrt(.5+r),i=r*bt;e.x=o*Math.cos(i),e.y=o*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,h),e}return null==t&&(t=[]),f(),e={tick:l,restart:function(){return u.restart(c),e},stop:function(){return u.stop(),e},nodes:function(r){return arguments.length?(t=r,f(),s.forEach(g),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(h=t,s.forEach(g),e):h},force:function(t,r){return arguments.length>1?(null==r?s.delete(t):s.set(t,g(r)),e):s.get(t)},find:function(e,r,n){var o,i,a,s,u,d=0,h=t.length;for(null==n?n=1/0:n*=n,d=0;d<h;++d)(a=(o=e-(s=t[d]).x)*o+(i=r-s.y)*i)<n&&(u=s,n=a);return u},on:function(t,r){return arguments.length>1?(d.on(t,r),e):d.on(t)}}}function Mt(){var t,e,r,n,o,i=B(-30),a=1,s=1/0,u=.81;function d(r){var o,i=t.length,a=F(t,wt,xt).visitAfter(c);for(n=r,o=0;o<i;++o)e=t[o],a.visit(l)}function h(){if(t){var e,r,n=t.length;for(o=new Array(n),e=0;e<n;++e)r=t[e],o[r.index]=+i(r,e,t)}}function c(t){var e,r,n,i,a,s=0,u=0;if(t.length){for(n=i=a=0;a<4;++a)(e=t[a])&&(r=Math.abs(e.value))&&(s+=e.value,u+=r,n+=r*e.x,i+=r*e.y);t.x=n/u,t.y=i/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=o[e.data.index]}while(e=e.next)}t.value=s}function l(t,i,d,h){if(!t.value)return!0;var c=t.x-e.x,l=t.y-e.y,f=h-i,g=c*c+l*l;if(f*f/u<g)return g<s&&(0===c&&(g+=(c=$(r))*c),0===l&&(g+=(l=$(r))*l),g<a&&(g=Math.sqrt(a*g)),e.vx+=c*t.value*n/g,e.vy+=l*t.value*n/g),!0;if(!(t.length||g>=s)){(t.data!==e||t.next)&&(0===c&&(g+=(c=$(r))*c),0===l&&(g+=(l=$(r))*l),g<a&&(g=Math.sqrt(a*g)));do{t.data!==e&&(f=o[t.data.index]*n/g,e.vx+=c*f,e.vy+=l*f)}while(t=t.next)}}return d.initialize=function(e,n){t=e,r=n,h()},d.strength=function(t){return arguments.length?(i="function"==typeof t?t:B(+t),h(),d):i},d.distanceMin=function(t){return arguments.length?(a=t*t,d):Math.sqrt(a)},d.distanceMax=function(t){return arguments.length?(s=t*t,d):Math.sqrt(s)},d.theta=function(t){return arguments.length?(u=t*t,d):Math.sqrt(u)},d}function St(t){return t.index}function kt(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function At(t){var e,r,n,o,i,a,s=St,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},d=B(30),h=1;function c(n){for(var o=0,s=t.length;o<h;++o)for(var u,d,c,l,f,g,p,v=0;v<s;++v)d=(u=t[v]).source,l=(c=u.target).x+c.vx-d.x-d.vx||$(a),f=c.y+c.vy-d.y-d.vy||$(a),l*=g=((g=Math.sqrt(l*l+f*f))-r[v])/g*n*e[v],f*=g,c.vx-=l*(p=i[v]),c.vy-=f*p,d.vx+=l*(p=1-p),d.vy+=f*p}function l(){if(n){var a,u,d=n.length,h=t.length,c=new Map(n.map(((t,e)=>[s(t,e,n),t])));for(a=0,o=new Array(d);a<h;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=kt(c,u.source)),"object"!=typeof u.target&&(u.target=kt(c,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(a=0,i=new Array(h);a<h;++a)u=t[a],i[a]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);e=new Array(h),f(),r=new Array(h),g()}}function f(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+u(t[r],r,t)}function g(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+d(t[e],e,t)}return null==t&&(t=[]),c.initialize=function(t,e){n=t,a=e,l()},c.links=function(e){return arguments.length?(t=e,l(),c):t},c.id=function(t){return arguments.length?(s=t,c):s},c.iterations=function(t){return arguments.length?(h=+t,c):h},c.strength=function(t){return arguments.length?(u="function"==typeof t?t:B(+t),f(),c):u},c.distance=function(t){return arguments.length?(d="function"==typeof t?t:B(+t),g(),c):d},c}function Rt(t){return t.x+t.vx}function It(t){return t.y+t.vy}function _t(t){var e,r,n,o=1,i=1;function a(){for(var t,a,u,d,h,c,l,f=e.length,g=0;g<i;++g)for(a=F(e,Rt,It).visitAfter(s),t=0;t<f;++t)u=e[t],c=r[u.index],l=c*c,d=u.x+u.vx,h=u.y+u.vy,a.visit(p);function p(t,e,r,i,a){var s=t.data,f=t.r,g=c+f;if(!s)return e>d+g||i<d-g||r>h+g||a<h-g;if(s.index>u.index){var p=d-s.x-s.vx,v=h-s.y-s.vy,y=p*p+v*v;y<g*g&&(0===p&&(y+=(p=$(n))*p),0===v&&(y+=(v=$(n))*v),y=(g-(y=Math.sqrt(y)))/y*o,u.vx+=(p*=y)*(g=(f*=f)/(l+f)),u.vy+=(v*=y)*g,s.vx-=p*(g=1-g),s.vy-=v*g)}}}function s(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var n,o,i=e.length;for(r=new Array(i),n=0;n<i;++n)o=e[n],r[o.index]=+t(o,n,e)}}return"function"!=typeof t&&(t=B(null==t?1:+t)),a.initialize=function(t,r){e=t,n=r,u()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(o=+t,a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),u(),a):t},a}function Dt(t){var e,r,n,o=B(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=B(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:B(+t),a(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),a(),i):t},i}function Ot(t){var e,r,n,o=B(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=B(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:B(+t),a(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),a(),i):t},i}function Pt(){function t(t){return function(){return t}}var e,r=function(t){return t.cluster},n=t(1),o=t(-1),i=t(100),a=t(.1),u=[0,0],d=[],h={},c=[],l=100,f=100,g={none:{x:0,y:0}},p=[],v="force",y=!0,m=.1;function w(t){if(!y)return w;e.tick(),E();for(var n=0,o=d.length,i=void 0,a=t*m;n<o;++n)(i=d[n]).vx+=(g[r(i)].x-i.x)*a,i.vy+=(g[r(i)].y-i.y)*a}function x(){d&&function(){if(d&&d.length){if(void 0===r(d[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy(\'clusterAttr\') before calling .links()");var t,u,g,v,y,m=(t=[],u=[],g={},{},y=[],v=function(t){var e={};return t.forEach((function(t){var n=r(t);e[n]||(e[n]={count:0,sumforceNodeSize:0})})),t.forEach((function(t){var o=r(t),i=n(t),a=e[o];a.count=a.count+1,a.sumforceNodeSize=a.sumforceNodeSize+Math.PI*(i*i)*1.3,e[o]=a})),e}(d),y=function(t){var e={},n=[];return t.forEach((function(t){var n,o,i,a,s,u=(o=(n=t).source,i=n.target,(a=r(h[o]))<=(s=r(h[i]))?a+"~"+s:s+"~"+a),d=0;void 0!==e[u]&&(d=e[u]),d+=1,e[u]=d})),Object.entries(e).forEach((function(t){var e=s(t,2),r=e[0],o=e[1],i=r.split("~")[0],a=r.split("~")[1];void 0!==i&&void 0!==a&&n.push({source:i,target:a,count:o})})),n}(c),Object.keys(v).forEach((function(e,r){var n=v[e];t.push({id:e,size:n.count,r:Math.sqrt(n.sumforceNodeSize/Math.PI)}),g[e]=r})),y.forEach((function(t){var e=t.source,r=t.target,n=g[e],o=g[r];void 0!==n&&void 0!==o&&u.push({source:n,target:o,count:t.count})})),{nodes:t,links:u});e=Nt(m.nodes).force("x",Dt(l).strength(.1)).force("y",Ot(f).strength(.1)).force("collide",_t((function(t){return t.r})).iterations(4)).force("charge",Mt().strength(o)).force("links",At(m.nodes.length?m.links:[]).distance(i).strength(a)),p=e.nodes(),E()}}()}function E(){return g={none:{x:0,y:0}},p.forEach((function(t){g[t.id]={x:t.x-u[0],y:t.y-u[1]}})),g}return w.initialize=function(t){d=t,x()},w.template=function(t){return arguments.length?(v=t,x(),w):v},w.groupBy=function(t){return arguments.length?"string"==typeof t?(r=function(e){return e[t]},w):(r=t,w):r},w.enableGrouping=function(t){return arguments.length?(y=t,w):y},w.strength=function(t){return arguments.length?(m=t,w):m},w.centerX=function(t){return arguments.length?(l=t,w):l},w.centerY=function(t){return arguments.length?(f=t,w):f},w.nodes=function(t){return arguments.length?(function(t){h={},t.forEach((function(t){h[t.id]=t}))}(t||[]),d=t||[],w):d},w.links=function(t){return arguments.length?(c=t||[],x(),w):c},w.forceNodeSize=function(e){return arguments.length?(n="function"==typeof e?e:t(+e),x(),w):n},w.nodeSize=w.forceNodeSize,w.forceCharge=function(e){return arguments.length?(o="function"==typeof e?e:t(+e),x(),w):o},w.forceLinkDistance=function(e){return arguments.length?(i="function"==typeof e?e:t(+e),x(),w):i},w.forceLinkStrength=function(e){return arguments.length?(a="function"==typeof e?e:t(+e),x(),w):a},w.offset=function(t){return arguments.length?(u=t,w):u},w.getFocis=E,w}var Tt={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},zt=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="d3force",this.options=n(n({},Tt),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){var t;null===(t=this.forceSimulation)||void 0===t||t.stop()},t.prototype.tick=function(t){var e=this;void 0===t&&(t=1),this.forceSimulation.tick(t);var r={nodes:Ct(this.lastLayoutNodes),edges:Lt(this.lastLayoutEdges)};return this.lastAssign&&r.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,g,p,v,y,m,w,x,E,N,M,S,k,A,R,I,_,D,O=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=i.map((function(t){var e,r;return n(n({},b(t)),{x:null===(e=t.data)||void 0===e?void 0:e.x,y:null===(r=t.data)||void 0===r?void 0:r.y})})),d=s.map((function(t){return b(t)})),this.lastLayoutNodes=u,this.lastLayoutEdges=d,this.lastAssign=t,this.lastGraph=e,h=o.alphaMin,c=o.alphaDecay,l=o.alpha,f=o.nodeStrength,g=o.edgeStrength,p=o.linkDistance,v=o.clustering,y=o.clusterFociStrength,m=o.clusterEdgeDistance,w=o.clusterEdgeStrength,x=o.clusterNodeStrength,E=o.clusterNodeSize,N=o.collideStrength,M=void 0===N?1:N,S=o.center,k=void 0===S?[0,0]:S,A=o.preventOverlap,R=o.nodeSize,I=o.nodeSpacing,_=o.onTick,D=o.forceSimulation,[2,new Promise((function(r){if(D){v&&((i=Pt()).nodes(u),i.links(d)),D.nodes(u),d&&(s=At().id((function(t){return t.id})).links(d),g&&s.strength(g),p&&s.distance(p),D.force("link",s)),A&&O.overlapProcess(D,{nodeSize:R,nodeSpacing:I,collideStrength:M}),D.alpha(l).restart();var n=Ct(u),o=Lt(d);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:o})}else try{var i,a=Mt();if(f&&a.strength(f),D=Nt().nodes(u),v&&((i=Pt()).centerX(k[0]).centerY(k[1]).template("force").strength(y),d&&i.links(d),u&&i.nodes(u),i.forceLinkDistance(m).forceLinkStrength(w).forceCharge(x).forceNodeSize(E),D.force("group",i)),D.force("center",function(t,e){var r,n=1;function o(){var o,i,a=r.length,s=0,u=0;for(o=0;o<a;++o)s+=(i=r[o]).x,u+=i.y;for(s=(s/a-t)*n,u=(u/a-e)*n,o=0;o<a;++o)(i=r[o]).x-=s,i.y-=u}return null==t&&(t=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(n=+t,o):n},o}(k[0],k[1])).force("charge",a).alpha(l).alphaDecay(c).alphaMin(h),A&&O.overlapProcess(D,{nodeSize:R,nodeSpacing:I,collideStrength:M}),d){var s=At().id((function(t){return t.id})).links(d);g&&s.strength(g),p&&s.distance(p),D.force("link",s)}D.on("tick",(function(){var r=Ct(u);null==_||_({nodes:r,edges:Lt(d)}),t&&r.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}))})).on("end",(function(){var n=Ct(u);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:Lt(d)})}))}catch(t){console.warn(t)}O.forceSimulation=D}))]}))}))},t.prototype.overlapProcess=function(t,e){var r,n,o=e.nodeSize,i=e.nodeSpacing,a=e.collideStrength;if(n=x(i)?function(){return i}:N(i)?i:function(){return 0},o)if(N(o))r=function(t){return o(t)+n(t)};else if(g(o)){var s=(o[0]>o[1]?o[0]:o[1])/2;r=function(t){return s+n(t)}}else if(x(o)){var u=o/2;r=function(t){return u+n(t)}}else r=function(){return 10};else r=function(t){return t.size?g(t.size)?(t.size[0]>t.size[1]?t.size[0]:t.size[1])/2+n(t):M(t.size)?(t.size.width>t.size.height?t.size.width:t.size.height)/2+n(t):t.size/2+n(t):10+n(t)};t.force("collisionForce",_t(r).strength(a))},t}(),Ct=function(t){return t.map((function(t){var e=t.x,r=t.y,i=o(t,["x","y"]);return n(n({},i),{data:n(n({},i.data),{x:e,y:r})})}))},Lt=function(t){return t.map((function(t){var e=t.source,r=t.target,i=o(t,["source","target"]);return n(n({},i),{source:e.id,target:r.id})}))};var qt=function(t,e){if("next"!==t&&"prev"!==t)return e},jt=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(function(){function t(){var t={};t.prev=t,t.next=t.prev,this.shortcut=t}return t.prototype.dequeue=function(){var t=this.shortcut,e=t.prev;if(e&&e!==t)return jt(e),e},t.prototype.enqueue=function(t){var e=this.shortcut;t.prev&&t.next&&jt(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e},t.prototype.toString=function(){for(var t=[],e=this.shortcut,r=e.prev;r!==e;)t.push(JSON.stringify(r,qt)),r=null==r?void 0:r.prev;return"["+t.join(", ")+"]"},t}()),Vt=function(){return 1},Gt=function(t,e,r,o,i){var a,s,u=[];return t.hasNode(o.v)&&(null===(a=t.getRelatedEdges(o.v,"in"))||void 0===a||a.forEach((function(o){var a=o.data.weight,s=t.getNode(o.source);i&&u.push({v:o.source,w:o.target,in:0,out:0}),void 0===s.data.out&&(s.data.out=0),s.data.out-=a,Wt(e,r,n({v:s.id},s.data))})),null===(s=t.getRelatedEdges(o.v,"out"))||void 0===s||s.forEach((function(o){var i=o.data.weight,a=o.target,s=t.getNode(a);void 0===s.data.in&&(s.data.in=0),s.data.in-=i,Wt(e,r,n({v:s.id},s.data))})),t.removeNode(o.v)),i?u:void 0},Wt=function(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},Bt=function(t,e){var r="greedy"===e?function(t,e){var r;if(t.getAllNodes().length<=1)return[];var o=function(t,e){var r=new l,o=0,i=0;t.getAllNodes().forEach((function(t){r.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((function(t){var a=r.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target})),s=(null==e?void 0:e(t))||1;a?r.updateEdgeData(null==a?void 0:a.id,n(n({},a.data),{weight:a.data.weight+s})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:s}}),i=Math.max(i,r.getNode(t.source).data.out+=s),o=Math.max(o,r.getNode(t.target).data.in+=s)}));for(var a=[],s=i+o+3,u=0;u<s;u++)a.push(new Ft);var d=o+1;return r.getAllNodes().forEach((function(t){Wt(a,d,n({v:t.id},r.getNode(t.id).data))})),{buckets:a,zeroIdx:d,graph:r}}(t,function(t){return t.data.weight||1}||Vt);return null===(r=function(t,e,r){for(var n,o=[],i=e[e.length-1],a=e[0];t.getAllNodes().length;){for(;n=a.dequeue();)Gt(t,e,r,n);for(;n=i.dequeue();)Gt(t,e,r,n);if(t.getAllNodes().length)for(var s=e.length-2;s>0;--s)if(n=e[s].dequeue()){o=o.concat(Gt(t,e,r,n,!0));break}}return o}(o.graph,o.buckets,o.zeroIdx).map((function(e){return t.getRelatedEdges(e.v,"out").filter((function(t){return t.target===e.w}))})))||void 0===r?void 0:r.flat()}(t):$t(t);null==r||r.forEach((function(e){var r=e.data;t.removeEdge(e.id),r.forwardName=e.data.name,r.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:n({},r)})}))},$t=function(t){var e=[],r={},n={},o=function(i){n[i]||(n[i]=!0,r[i]=!0,t.getRelatedEdges(i,"out").forEach((function(t){r[t.target]?e.push(t):o(t.target)})),delete r[i])};return t.getAllNodes().forEach((function(t){return o(t.id)})),e},Ut=function(t,e,r,n){var o;do{o=""+n+Math.random()}while(t.hasNode(o));return r.dummy=e,t.addNode({id:o,data:r}),o},Ht=function(t){var e=new l;return t.getAllNodes().forEach((function(r){t.getChildren(r.id).length||e.addNode(n({},r))})),t.getAllEdges().forEach((function(t){e.addEdge(t)})),e},Kt=function(t,e){var r,n,o=Number(t.x),i=Number(t.y),a=Number(e.x)-o,s=Number(e.y)-i,u=Number(t.width)/2,d=Number(t.height)/2;return a||s?(Math.abs(s)*u>Math.abs(a)*d?(s<0&&(d=-d),r=d*a/s,n=d):(a<0&&(u=-u),r=u,n=u*s/a),{x:o+r,y:i+n}):{x:0,y:0}},Yt=function(t){for(var e=[],r=Xt(t)+1,n=0;n<r;n++)e.push([]);for(t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)})),n=0;n<r;n++)e[n]=e[n].sort((function(e,r){return n=t.getNode(e).data.order,o=t.getNode(r).data.order,Number(n)-Number(o);var n,o}));return e},Jt=function(t,e,r,n){var o={width:0,height:0};return x(r)&&x(n)&&(o.rank=r,o.order=n),Ut(t,"border",o,e)},Xt=function(t){var e;return t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)})),e||(e=0),e},Qt=function(t,e){return t.reduce((function(t,r){return e(t)>e(r)?r:t}))},Zt=function(t,e,r,n,o,i){n.includes(e.id)||(n.push(e.id),r||i.push(e.id),o(e.id).forEach((function(e){return Zt(t,e,r,n,o,i)})),r&&i.push(e.id))},te=function(t,e,r,n){var o=Array.isArray(e)?e:[e],i=function(e){return n?t.getSuccessors(e):t.getNeighbors(e)},a=[],s=[];return o.forEach((function(e){if(!t.hasNode(e.id))throw new Error("Graph does not have node: "+e);Zt(t,e,"post"===r,s,i,a)})),a},ee="edge-label",re=function(t){var e={},r=function(n){var o,i,a=t.getNode(n);return a?e[n]?a.data.rank:(e[n]=!0,null===(o=t.getRelatedEdges(n,"out"))||void 0===o||o.forEach((function(t){var e=r(t.target)-t.data.minlen;e&&(void 0===i||e<i)&&(i=e)})),i||(i=0),a.data.rank=i,i):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){return r(t.id)}))},ne=function(t,e){return t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen},oe=function(t,e){var r=function(n){e.getRelatedEdges(n,"both").forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ie=function(t,e){var r=function(n){var o;null===(o=e.getRelatedEdges(n,"both"))||void 0===o||o.forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||void 0===e.getNode(a).data.layer&&ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ae=function(t,e){return Qt(e.getAllEdges(),(function(r){return t.hasNode(r.source)!==t.hasNode(r.target)?ne(e,r):1/0}))},se=function(t,e,r){t.getAllNodes().forEach((function(t){var n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r}))},ue=function(t,e){var r=te(t,t.getAllNodes(),"post",!1);(r=r.slice(0,(null==r?void 0:r.length)-1)).forEach((function(r){de(t,e,r)}))},de=function(t,e,r){var n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find((function(t){return t.target===n||t.source===n})).data.cutvalue=he(t,e,r)},he=function(t,e,r){var n=t.getNode(r).data.parent,o=!0,i=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),a=0;return i||(o=!1,i=e.getRelatedEdges(n,"out").find((function(t){return t.target===r}))),a=i.data.weight,e.getRelatedEdges(r,"both").forEach((function(e){var i=e.source===r,s=i?e.target:e.source;if(s!==n){var u=i===o,d=e.data.weight;if(a+=u?d:-d,ye(t,r,s)){var h=t.getRelatedEdges(r,"both").find((function(t){return t.source===s||t.target===s})).data.cutvalue;a+=u?-h:h}}})),a},ce=function(t,e){void 0===e&&(e=t.getAllNodes()[0].id),le(t,{},1,e)},le=function(t,e,r,n,o){var i,a=r,s=r,u=t.getNode(n);return e[n]=!0,null===(i=t.getNeighbors(n))||void 0===i||i.forEach((function(r){e[r.id]||(s=le(t,e,s,r.id,n))})),u.data.low=a,u.data.lim=s++,o?u.data.parent=o:delete u.data.parent,s},fe=function(t){return t.getAllEdges().find((function(t){return t.data.cutvalue<0}))},ge=function(t,e,r){var n=r.source,o=r.target;e.getRelatedEdges(n,"out").find((function(t){return t.target===o}))||(n=r.target,o=r.source);var i=t.getNode(n),a=t.getNode(o),s=i,u=!1;i.data.lim>a.data.lim&&(s=a,u=!0);var d=e.getAllEdges().filter((function(e){return u===me(t.getNode(e.source),s)&&u!==me(t.getNode(e.target),s)}));return Qt(d,(function(t){return ne(e,t)}))},pe=function(t,e,r,n){var o=t.getRelatedEdges(r.source,"both").find((function(t){return t.source===r.target||t.target===r.target}));o&&t.removeEdge(o.id),t.addEdge({id:"e"+Math.random(),source:n.source,target:n.target,data:{}}),ce(t),ue(t,e),ve(t,e)},ve=function(t,e){var r=t.getAllNodes().find((function(t){return!t.data.parent})),n=te(t,r,"pre",!1);(n=n.slice(1)).forEach((function(r){var n=t.getNode(r).data.parent,o=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),i=!1;!o&&e.hasNode(n)&&(o=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),i=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(i?null==o?void 0:o.data.minlen:-(null==o?void 0:o.data.minlen))}))},ye=function(t,e,r){return t.getRelatedEdges(e,"both").find((function(t){return t.source===r||t.target===r}))},me=function(t,e){return e.data.low<=t.data.lim&&t.data.lim<=e.data.lim},we=re,xe=function(t){!function(t){var e=function(t){var e=new l;return t.getAllNodes().forEach((function(t){e.addNode(n({},t))})),t.getAllEdges().forEach((function(t){var r=e.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target}));r?e.updateEdgeData(null==r?void 0:r.id,n(n({},r.data),{weight:r.data.weight+t.data.weight||0,minlen:Math.max(r.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e}(t);re(e);var r,o,i=function(t){var e,r,n=new l({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);oe(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r);return n}(e);for(ce(i),ue(i,e);r=fe(i);)o=ge(i,e,r),pe(i,e,r,o)}(t)},Ee=function(t,e,r,n,o,i,a){var s=t.getChildren(a);if(null==s?void 0:s.length){var u=Jt(t,"_bt"),d=Jt(t,"_bb"),h=t.getNode(a);t.setParent(u,a),h.data.borderTop=u,t.setParent(d,a),h.data.borderBottom=d,null==s||s.forEach((function(s){Ee(t,e,r,n,o,i,s.id);var h=s.data.borderTop?s.data.borderTop:s.id,c=s.data.borderBottom?s.data.borderBottom:s.id,l=s.data.borderTop?n:2*n,f=h!==c?1:o-i[a]+1;t.addEdge({id:"e"+Math.random(),source:u,target:h,data:{minlen:f,weight:l,nestingEdge:!0}}),t.addEdge({id:"e"+Math.random(),source:c,target:d,data:{minlen:f,weight:l,nestingEdge:!0}})})),t.getParent(a)||t.addEdge({id:"e"+Math.random(),source:e,target:u,data:{weight:0,minlen:o+i[a]}})}else a!==e&&t.addEdge({id:"e"+Math.random(),source:e,target:a,data:{weight:0,minlen:r}})},be=function(t,e,r,n,o,i){var a={rank:i,borderType:e,width:0,height:0},s=o.data[e][i-1],u=Ut(t,"border",a,r);o.data[e][i]=u,t.setParent(u,n),s&&t.addEdge({id:"e"+Math.random(),source:s,target:u,data:{weight:1}})},Ne=function(t){t.getAllNodes().forEach((function(t){Me(t)})),t.getAllEdges().forEach((function(t){Me(t)}))},Me=function(t){var e=t.data.width;t.data.width=t.data.height,t.data.height=e},Se=function(t){(null==t?void 0:t.y)&&(t.y=-t.y)},ke=function(t){var e=t.x;t.x=t.y,t.y=e},Ae=function(t){for(var e={},r=t.getAllNodes(),n=r.map((function(t){var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),o=Math.max.apply(Math,u([],s(n))),i=[],a=0;a<o+1;a++)i.push([]);var d=r.sort((function(e,r){return t.getNode(e.id).data.rank-t.getNode(r.id).data.rank})),h=d.filter((function(e){return void 0!==t.getNode(e.id).data.fixorder})).sort((function(e,r){return t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder}));return null==h||h.forEach((function(r){isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0})),null==d||d.forEach((function(r){return t.dfsTree(r.id,(function(t){if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)}))})),i},Re=function(t,e,r){for(var n=function(t,e){return null==t?void 0:t.reduce((function(t,r,n){return t[r]=e[n],t}),{})}(r,r.map((function(t,e){return e}))),o=e.map((function(e){var r=t.getRelatedEdges(e,"out").map((function(t){return{pos:n[t.target]||0,weight:t.data.weight}}));return null==r?void 0:r.sort((function(t,e){return t.pos-e.pos}))})),i=o.flat().filter((function(t){return void 0!==t})),a=1;a<r.length;)a<<=1;var s=2*a-1;a-=1;var u=Array(s).fill(0,0,s),d=0;return null==i||i.forEach((function(t){if(t){var e=t.pos+a;u[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=u[e+1]),u[e=e-1>>1]+=t.weight;d+=t.weight*r}})),d},Ie=function(t,e){for(var r=0,n=1;n<(null==e?void 0:e.length);n+=1)r+=Re(t,e[n-1],e[n]);return r},_e=function(t,e){var r,n=0,o=0;t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/o,t.weight=o,t.i=Math.min(e.i,t.i),e.merged=!0};const De=function(t,e){var r,n,o,i={};return null==t||t.forEach((function(t,e){i[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};var r=i[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)})),null===(r=e.getAllEdges())||void 0===r||r.forEach((function(t){var e=i[t.source],r=i[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(i[t.target]))})),function(t){for(var e,r,n=[],o=function(){var o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach((function(t){return(e=o,function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&_e(e,t)})(t);var e})),null===(r=o.out)||void 0===r||r.forEach((function(e){return(r=o,function(e){e.in.push(r),0==--e.indegree&&t.push(e)})(e);var r}))};null==t?void 0:t.length;)o();var i=n.filter((function(t){return!t.merged})),a=["vs","i","barycenter","weight"];return i.map((function(t){var e={};return null==a||a.forEach((function(r){void 0!==t[r]&&(e[r]=t[r])})),e}))}(null===(o=(n=Object.values(i)).filter)||void 0===o?void 0:o.call(n,(function(t){return!t.indegree})))};var Oe=function(t,e,r){for(var n,o=r;e.length&&(n=e[e.length-1]).i<=o;)e.pop(),null==t||t.push(n.vs),o++;return o},Pe=function(t,e,r,n,o,i){var a,s,u,d,h=t.getChildren(e).map((function(t){return t.id})),c=t.getNode(e),l=c?c.data.borderLeft:void 0,f=c?c.data.borderRight:void 0,g={};l&&(h=null==h?void 0:h.filter((function(t){return t!==l&&t!==f})));var p=function(t,e){return e.map((function(e){var r=t.getRelatedEdges(e,"in");if(!(null==r?void 0:r.length))return{v:e};var n={sum:0,weight:0};return null==r||r.forEach((function(e){var r=t.getNode(e.source);n.sum+=e.data.weight*r.data.order,n.weight+=e.data.weight})),{v:e,barycenter:n.sum/n.weight,weight:n.weight}}))}(t,h||[]);null==p||p.forEach((function(e){var o;if(null===(o=t.getChildren(e.v))||void 0===o?void 0:o.length){var a=Pe(t,e.v,r,n,i);g[e.v]=a,a.hasOwnProperty("barycenter")&&ze(e,a)}}));var v=De(p,r);Te(v,g),null===(a=v.filter((function(t){return t.vs.length>0})))||void 0===a||a.forEach((function(e){var r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)}));var y=function(t,e,r,n){var o=function(t,e){var r={lhs:[],rhs:[]};return null==t||t.forEach((function(t){var e,o;o=(e=t).hasOwnProperty("fixorder")&&!isNaN(e.fixorder),(n?!o&&e.hasOwnProperty("barycenter"):o||e.hasOwnProperty("barycenter"))?r.lhs.push(t):r.rhs.push(t)})),r}(t),i=o.lhs,a=o.rhs.sort((function(t,e){return-t.i- -e.i})),s=[],u=0,d=0,h=0;null==i||i.sort(function(t,e){return function(r,n){if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i}}(!!e,!!r)),h=Oe(s,a,h),null==i||i.forEach((function(t){var e;h+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),u+=t.barycenter*t.weight,d+=t.weight,h=Oe(s,a,h)}));var c={vs:s.flat()};return d&&(c.barycenter=u/d,c.weight=d),c}(v,n,o,i);if(l&&(y.vs=[l,y.vs,f].flat(),null===(s=t.getPredecessors(l))||void 0===s?void 0:s.length)){var m=t.getNode((null===(u=t.getPredecessors(l))||void 0===u?void 0:u[0].id)||""),w=t.getNode((null===(d=t.getPredecessors(f))||void 0===d?void 0:d[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+w.data.order)/(y.weight+2),y.weight+=2}return y},Te=function(t,e){null==t||t.forEach((function(t){var r,n=null===(r=t.vs)||void 0===r?void 0:r.map((function(t){return e[t]?e[t].vs:t}));t.vs=n.flat()}))},ze=function(t,e){void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},Ce=function(t){if("object"!=typeof t||null===t)return t;var e,r;if(r=t,Array.isArray?Array.isArray(r):w(r,"Array")){e=[];for(var n=0,o=t.length;n<o;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=Ce(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=Ce(t[i]):e[i]=t[i];return e};const Le=Ce;var qe=function(t,e,r){return e.map((function(e){return function(t,e,r){var o=function(t){for(var e;t.hasNode(e="_root"+Math.random()););return e}(t),i=new l({tree:[{id:o,children:[],data:{}}]});return t.getAllNodes().forEach((function(a){var s=t.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(n({},a)),(null==s?void 0:s.id)&&!i.hasNode(null==s?void 0:s.id)&&i.addNode(n({},s)),i.setParent(a.id,(null==s?void 0:s.id)||o),t.getRelatedEdges(a.id,r).forEach((function(e){var r=e.source===a.id?e.target:e.source;i.hasNode(r)||i.addNode(n({},t.getNode(r)));var o=i.getRelatedEdges(r,"out").find((function(t){return t.target===a.id})),s=void 0!==o?o.data.weight:0;o?i.updateEdgeData(o.id,n(n({},o.data),{weight:e.data.weight+s})):i.addEdge({id:e.id,source:r,target:a.id,data:{weight:e.data.weight+s}})})),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,n(n({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))})),i}(t,e,r)}))},je=function(t,e,r,n){var o=new l;null==t||t.forEach((function(t){for(var i,a=t.getRoots()[0].id,s=Pe(t,a,o,e,r,n),u=0;u<(null===(i=s.vs)||void 0===i?void 0:i.length);u++){var d=t.getNode(s.vs[u]);d&&(d.data.order=u)}!function(t,e,r){var n,o={};null==r||r.forEach((function(r){for(var i,a,s=t.getParent(r);s;){if((i=t.getParent(s.id))?(a=o[i.id],o[i.id]=s.id):(a=n,n=s.id),a&&a!==s.id)return e.addNodes([{id:a,data:{}},{id:s.id,data:{}}]),void e.addEdge({id:"e"+a+"-"+s.id,source:a,target:s.id,data:{}});s=i}}))}(t,o,s.vs)}))},Fe=function(t,e){null==e||e.forEach((function(e){null==e||e.forEach((function(e,r){t.getNode(e).data.order=r}))}))},Ve=function(t,e){var r={};function n(e,n,o,i,a){for(var s,u,d,h=n;h<o;h++)d=e[h],(null===(s=t.getNode(d))||void 0===s?void 0:s.data.dummy)&&(null===(u=t.getPredecessors(d))||void 0===u||u.forEach((function(e){var n=t.getNode(e.id);n.data.dummy&&(n.data.order<i||n.data.order>a)&&We(r,e.id,d)})))}function o(t,e){var r=function(t){return JSON.stringify(t.slice(1))}(t);e.get(r)||(n.apply(void 0,u([],s(t))),e.set(r,!0))}return(null==e?void 0:e.length)&&e.reduce((function(e,r){var n,i=-1,a=0,s=new Map;return null==r||r.forEach((function(u,d){var h;if("border"===(null===(h=t.getNode(u))||void 0===h?void 0:h.data.dummy)){var c=t.getPredecessors(u)||[];c.length&&(n=t.getNode(c[0].id).data.order,o([r,a,d,i,n],s),a=d,i=n)}o([r,a,r.length,n,e.length],s)})),r})),r},Ge=function(t,e){var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find((function(e){return t.getNode(e.id).data.dummy}))},We=function(t,e,r){var n=e,o=r;if(n>o){var i=n;n=o,o=i}var a=t[n];a||(t[n]=a={}),a[o]=!0},Be=function(t,e,r){var n=e;return n>r&&(n=r),!!t[n]},$e=function(t,e,r,o,i,a){var s=new l,u=Ue(o,i,a);return null==e||e.forEach((function(e){var o;null==e||e.forEach((function(e){var i=r[e];if(s.hasNode(i)||s.addNode({id:i,data:{}}),o){var a=r[o],d=s.getRelatedEdges(a,"out").find((function(t){return t.target===i}));d?s.updateEdgeData(d.id,n(n({},d.data),{weight:Math.max(u(t,e,o),d.data.weight||0)})):s.addEdge({id:"e"+Math.random(),source:a,target:i,data:{weight:Math.max(u(t,e,o),0)}})}o=e}))})),s};var Ue=function(t,e,r){return function(n,o,i){var a=n.getNode(o),s=n.getNode(i),u=0,d=0;if(u+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":d=-a.data.width/2;break;case"r":d=a.data.width/2}if(d&&(u+=r?d:-d),d=0,u+=(a.data.dummy?e:t)/2,u+=(s.data.dummy?e:t)/2,u+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":d=s.data.width/2;break;case"r":d=-s.data.width/2}return d&&(u+=r?d:-d),d=0,u}},He=function(t,e){return t.getNode(e).data.width||0},Ke=function(t,e){var r,n=Ht(t);!function(t,e){var r=(e||{}).ranksep,n=void 0===r?0:r,o=Yt(t),i=0;null==o||o.forEach((function(e){var r=e.map((function(e){return t.getNode(e).data.height})),o=Math.max.apply(Math,u(u([],s(r)),[0]));null==e||e.forEach((function(e){t.getNode(e).data.y=i+o/2})),i+=o+n}))}(n,e);var o=function(t,e){var r=e||{},n=r.align,o=r.nodesep,i=void 0===o?0:o,a=r.edgesep,d=void 0===a?0:a,h=Yt(t),c=Object.assign(function(t,e){var r={};return(null==e?void 0:e.length)&&e.reduce((function(e,n){var o=0,i=0,a=e.length,s=null==n?void 0:n[(null==n?void 0:n.length)-1];return null==n||n.forEach((function(e,u){var d,h=Ge(t,e),c=h?t.getNode(h.id).data.order:a;(h||e===s)&&(null===(d=n.slice(i,u+1))||void 0===d||d.forEach((function(e){var n;null===(n=t.getPredecessors(e))||void 0===n||n.forEach((function(n){var i,a=t.getNode(n.id),s=a.data.order;!(s<o||c<s)||a.data.dummy&&(null===(i=t.getNode(e))||void 0===i?void 0:i.data.dummy)||We(r,n.id,e)}))})),i=u+1,o=c)})),n})),r}(t,h),Ve(t,h)),l={},f=[];["u","d"].forEach((function(e){f="u"===e?h:Object.values(h).reverse(),["l","r"].forEach((function(r){"r"===r&&(f=f.map((function(t){return Object.values(t).reverse()})));var n=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),o=function(t,e,r,n){var o={},i={},a={};return null==e||e.forEach((function(t){null==t||t.forEach((function(t,e){o[t]=t,i[t]=t,a[t]=e}))})),null==e||e.forEach((function(t){var e=-1;null==t||t.forEach((function(t){var s=n(t).map((function(t){return t.id}));if(s.length){s=s.sort((function(t,e){return a[t]-a[e]}));for(var u=(s.length-1)/2,d=Math.floor(u),h=Math.ceil(u);d<=h;++d){var c=s[d];i[t]===t&&e<a[c]&&!Be(r,t,c)&&(i[c]=t,i[t]=o[t]=o[c],e=a[c])}}}))})),{root:o,align:i}}(0,f,c,n),a=function(t,e,r,n,o,i,a){var s,u={},d=$e(t,e,r,o,i,a),h=a?"borderLeft":"borderRight",c=function(t,e){for(var r=d.getAllNodes(),n=r.pop(),o={};n;)o[n.id]?t(n.id):(o[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return c((function(t){u[t]=(d.getRelatedEdges(t,"in")||[]).reduce((function(t,e){return Math.max(t,(u[e.source]||0)+e.data.weight)}),0)}),d.getPredecessors.bind(d)),c((function(e){var r=(d.getRelatedEdges(e,"out")||[]).reduce((function(t,e){return Math.min(t,(u[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==h&&(u[e]=Math.max(u[e],r))}),d.getSuccessors.bind(d)),null===(s=Object.values(n))||void 0===s||s.forEach((function(t){u[t]=u[r[t]]})),u}(t,f,o.root,o.align,i,d,"r"===r);"r"===r&&Object.keys(a).forEach((function(t){return a[t]=-a[t]})),l[e+r]=a}))}));var g=function(t,e){return Qt(Object.values(e),(function(e){var r,n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach((function(r){var i=e[r],a=He(t,r)/2;n=Math.max(i+a,n),o=Math.min(i-a,o)})),n-o}))}(t,l);return g&&function(t,e){var r=Object.values(e),n=Math.min.apply(Math,u([],s(r))),o=Math.max.apply(Math,u([],s(r)));["u","d"].forEach((function(r){["l","r"].forEach((function(i){var a,d=r+i,h=t[d];if(h!==e){var c=Object.values(h);(a="l"===i?n-Math.min.apply(Math,u([],s(c))):o-Math.max.apply(Math,u([],s(c))))&&(t[d]={},Object.keys(h).forEach((function(e){t[d][e]=h[e]+a})))}}))}))}(l,g),function(t,e){var r={};return Object.keys(t.ul).forEach((function(n){if(e)r[n]=t[e.toLowerCase()][n];else{var o=Object.values(t).map((function(t){return t[n]}));r[n]=(o[0]+o[1])/2}})),r}(l,n)}(n,e);null===(r=Object.keys(o))||void 0===r||r.forEach((function(t){n.getNode(t).data.x=o[t]}))},Ye=function(t,e){var r=e.acyclicer,o=e.ranker,i=e.rankdir,a=void 0===i?"tb":i,d=e.nodeOrder,h=e.keepNodeOrder,c=e.align,f=e.nodesep,g=void 0===f?50:f,p=e.edgesep,v=void 0===p?20:p,y=e.ranksep,m=void 0===y?50:y;dr(t),Bt(t,r);var w=function(t){var e=Ut(t,"root",{},"_root"),r=function(t){var e={},r=function(n,o){var i=t.getChildren(n);null==i||i.forEach((function(t){return r(t.id,o+1)})),e[n]=o};return t.getRoots().forEach((function(t){return r(t.id,1)})),e}(t),n=Math.max.apply(Math,u([],s(Object.values(r))));Math.abs(n)===1/0&&(n=1);var o=n-1,i=2*o+1;t.getAllEdges().forEach((function(t){t.data.minlen*=i}));var a=function(t){var e=0;return t.getAllEdges().forEach((function(t){e+=t.data.weight})),e}(t)+1;return t.getRoots().forEach((function(n){Ee(t,e,i,a,o,r,n.id)})),{nestingRoot:e,nodeRankFactor:i}}(t),x=w.nestingRoot,E=w.nodeRankFactor;!function(t,e){switch(e){case"network-simplex":xe(t);break;case"tight-tree":default:!function(t){!function(t){var e,r={},n=function(o){var i,a,s=t.getNode(o);return s?r[o]?s.data.rank:(r[o]=!0,null===(i=t.getRelatedEdges(o,"out"))||void 0===i||i.forEach((function(t){var e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),(void 0===e||a<e)&&(e=a),s.data.rank=a,a):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){t&&n(t.id)})),void 0===e&&(e=0);var o={},i=function(e,r){var n,a=t.getNode(e),s=isNaN(a.data.layer)?r:a.data.layer;(void 0===a.data.rank||a.data.rank<s)&&(a.data.rank=s),o[e]||(o[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach((function(t){i(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((function(t){var r=t.data;r&&(isNaN(r.layer)?r.rank-=e:i(t.id,r.layer))}))}(t),function(t){var e,r,n=new l({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);ie(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r)}(t)}(t);break;case"longest-path":we(t)}}(Ht(t),o),er(t),function(t,e){void 0===e&&(e=0);var r=t.getAllNodes(),n=r.filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),o=Math.min.apply(Math,u([],s(n))),i=[];r.forEach((function(t){var e=(t.data.rank||0)-o;i[e]||(i[e]=[]),i[e].push(t.id)}));for(var a=0,d=0;d<i.length;d++){var h=i[d];void 0===h?d%e!=0&&(a-=1):a&&(null==h||h.forEach((function(e){var r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=a)})))}}(t,E),function(t,e){e&&t.removeNode(e),t.getAllEdges().forEach((function(e){e.data.nestingEdge&&t.removeEdge(e.id)}))}(t,x),function(t){var e=t.getAllNodes().filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),r=Math.min.apply(Math,u([],s(e)));t.getAllNodes().forEach((function(t){t.data.hasOwnProperty("rank")&&r!==1/0&&(t.data.rank-=r)}))}(t),rr(t),nr(t);var b=[];!function(t,e){t.getAllEdges().forEach((function(r){return function(t,e,r){var n=e.source,o=t.getNode(n).data.rank,i=e.target,a=t.getNode(i).data.rank,s=e.data.labelRank;if(a!==o+1){var u,d,h;for(t.removeEdge(e.id),h=0,++o;o<a;++h,++o)e.data.points=[],u=Ut(t,"edge",d={originalEdge:e,width:0,height:0,rank:o},"_d"),o===s&&(d.width=e.data.width,d.height=e.data.height,d.dummy=ee,d.labelpos=e.data.labelpos),t.addEdge({id:"e"+Math.random(),source:n,target:u,data:{weight:e.data.weight}}),0===h&&r.push(u),n=u;t.addEdge({id:"e"+Math.random(),source:n,target:i,data:{weight:e.data.weight}})}}(t,r,e)}))}(t,b),function(t,e){var r=function(t){var e={},r=0,n=function(o){var i=r;t.getChildren(o).forEach((function(t){return n(t.id)})),e[o]={low:i,lim:r++}};return t.getRoots().forEach((function(t){return n(t.id)})),e}(t);e.forEach((function(e){var n,o,i=e,a=t.getNode(i),s=a.data.originalEdge;if(s)for(var u=function(t,e,r,n){var o,i,a,s,u=[],d=[],h=Math.min(e[r].low,e[n].low),c=Math.max(e[r].lim,e[n].lim);a=r;do{a=null===(o=t.getParent(a))||void 0===o?void 0:o.id,u.push(a)}while(a&&(e[a].low>h||c>e[a].lim));for(s=a,a=n;a&&a!==s;)d.push(a),a=null===(i=t.getParent(a))||void 0===i?void 0:i.id;return{lca:s,path:u.concat(d.reverse())}}(t,r,s.source,s.target),d=u.path,h=u.lca,c=0,l=d[c],f=!0;i!==s.target;){if(a=t.getNode(i),f){for(;l!==h&&(null===(n=t.getNode(l))||void 0===n?void 0:n.data.maxRank)<a.data.rank;)l=d[++c];l===h&&(f=!1)}if(!f){for(;c<d.length-1&&(null===(o=t.getNode(d[c+1]))||void 0===o?void 0:o.data.minRank)<=a.data.rank;)c++;l=d[c]}t.hasNode(l)&&t.setParent(i,l),i=t.getSuccessors(i)[0].id}}))}(t,b),function(t){var e=function(r){var n=t.getChildren(r),o=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach((function(t){return e(t.id)})),o.data.hasOwnProperty("minRank")){o.data.borderLeft=[],o.data.borderRight=[];for(var i=o.data.minRank,a=o.data.maxRank+1;i<a;i+=1)be(t,"borderLeft","_bl",r,o,i),be(t,"borderRight","_br",r,o,i)}};t.getRoots().forEach((function(t){return e(t.id)}))}(t),h&&function(t,e){for(var r=t.getAllNodes().filter((function(e){var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)})).map((function(t){return t.data.rank})),n=Math.max.apply(Math,u([],s(r))),o=[],i=0;i<n+1;i++)o[i]=[];null==e||e.forEach((function(e){var r=t.getNode(e);r&&!r.data.dummy&&(isNaN(r.data.rank)||(r.data.fixorder=o[r.data.rank].length,o[r.data.rank].push(e)))}))}(t,d),function(t,e){for(var r=Xt(t),n=[],o=[],i=1;i<r+1;i++)n.push(i);for(i=r-1;i>-1;i--)o.push(i);var a=qe(t,n,"in"),s=qe(t,o,"out"),u=Ae(t);Fe(t,u);for(var d,h=Number.POSITIVE_INFINITY,c=(i=0,0);c<4;++i,++c)je(i%2?a:s,i%4>=2,!1,e),u=Yt(t),(l=Ie(t,u))<h&&(c=0,d=Le(u),h=l);for(u=Ae(t),Fe(t,u),i=0,c=0;c<4;++i,++c){var l;je(i%2?a:s,i%4>=2,!0,e),u=Yt(t),(l=Ie(t,u))<h&&(c=0,d=Le(u),h=l)}Fe(t,d)}(t,h),hr(t),function(t,e){var r=e.toLowerCase();"lr"!==r&&"rl"!==r||Ne(t)}(t,a),Ke(t,{align:c,nodesep:g,edgesep:v,ranksep:m}),cr(t),ur(t),function(t,e){e.forEach((function(e){var r,n=t.getNode(e),o=n.data.originalEdge;o&&t.addEdge(o);for(var i=e;n.data.dummy;)r=t.getSuccessors(i)[0],t.removeNode(i),o.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===ee&&(o.data.x=n.data.x,o.data.y=n.data.y,o.data.width=n.data.width,o.data.height=n.data.height),i=r.id,n=t.getNode(i)}))}(t,b),ar(t),function(t,e){var r=e.toLowerCase();"bt"!==r&&"rl"!==r||function(t){t.getAllNodes().forEach((function(t){Se(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return Se(t)})),t.data.hasOwnProperty("y")&&Se(t.data)}))}(t),"lr"!==r&&"rl"!==r||(function(t){t.getAllNodes().forEach((function(t){ke(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return ke(t)})),t.data.hasOwnProperty("x")&&ke(t.data)}))}(t),Ne(t))}(t,a);var N=or(t),M=N.width,S=N.height;return ir(t),sr(t),function(t){t.getAllEdges().forEach((function(e){var r=e.data;if(r.reversed){t.removeEdge(e.id);var o=r.forwardName;delete r.reversed,delete r.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:n(n({},r),{forwardName:o})})}}))}(t),{width:M,height:S}},Je=["width","height","layer","fixorder"],Xe={width:0,height:0},Qe=["minlen","weight","width","height","labeloffset"],Ze={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},tr=["labelpos"],er=function(t){t.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var r=t.getNode(e.source),n={e,rank:(t.getNode(e.target).data.rank-r.data.rank)/2+r.data.rank};Ut(t,"edge-proxy",n,"_ep")}}))},rr=function(t){var e=0;return t.getAllNodes().forEach((function(r){var n,o;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(o=t.getNode(r.data.borderBottom))||void 0===o?void 0:o.data.rank,e=Math.max(e,r.data.maxRank||-1/0))})),e},nr=function(t){t.getAllNodes().forEach((function(e){"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},or=function(t,e){var r,n,o=0,i=0,a=e||{},s=a.marginx,u=void 0===s?0:s,d=a.marginy,h=void 0===d?0:d,c=function(t){if(t.data){var e=t.data.x,a=t.data.y,s=t.data.width,u=t.data.height;isNaN(e)||isNaN(s)||(void 0===r&&(r=e-s/2),r=Math.min(r,e-s/2),o=Math.max(o,e+s/2)),isNaN(a)||isNaN(u)||(void 0===n&&(n=a-u/2),n=Math.min(n,a-u/2),i=Math.max(i,a+u/2))}};return t.getAllNodes().forEach((function(t){c(t)})),t.getAllEdges().forEach((function(t){(null==t?void 0:t.data.hasOwnProperty("x"))&&c(t)})),r-=u,n-=h,t.getAllNodes().forEach((function(t){t.data.x-=r,t.data.y-=n})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){t.x-=r,t.y-=n})),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)})),{width:o-r+u,height:i-n+h}},ir=function(t){t.getAllEdges().forEach((function(e){var r,n,o=t.getNode(e.source),i=t.getNode(e.target);e.data.points?(r=e.data.points[0],n=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:i.data.x,y:i.data.y},n={x:o.data.x,y:o.data.y}),e.data.points.unshift(Kt(o.data,r)),e.data.points.push(Kt(i.data,n))}))},ar=function(t){t.getAllEdges().forEach((function(t){if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},sr=function(t){t.getAllEdges().forEach((function(t){var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},ur=function(t){t.getAllNodes().forEach((function(e){var r,n,o;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){var i=t.getNode(e.id),a=t.getNode(i.data.borderTop),s=t.getNode(i.data.borderBottom),u=t.getNode(i.data.borderLeft[(null===(n=i.data.borderLeft)||void 0===n?void 0:n.length)-1]),d=t.getNode(i.data.borderRight[(null===(o=i.data.borderRight)||void 0===o?void 0:o.length)-1]);i.data.width=Math.abs((null==d?void 0:d.data.x)-(null==u?void 0:u.data.x))||10,i.data.height=Math.abs((null==s?void 0:s.data.y)-(null==a?void 0:a.data.y))||10,i.data.x=((null==u?void 0:u.data.x)||0)+i.data.width/2,i.data.y=((null==a?void 0:a.data.y)||0)+i.data.height/2}})),t.getAllNodes().forEach((function(e){"border"===e.data.dummy&&t.removeNode(e.id)}))},dr=function(t){t.getAllEdges().forEach((function(e){if(e.source===e.target){var r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}}))},hr=function(t){var e=Yt(t);null==e||e.forEach((function(e){var r=0;null==e||e.forEach((function(e,n){var o,i=t.getNode(e);i.data.order=n+r,null===(o=i.data.selfEdges)||void 0===o||o.forEach((function(e){Ut(t,"selfedge",{width:e.data.width,height:e.data.height,rank:i.data.rank,order:n+ ++r,e},"_se")})),delete i.data.selfEdges}))}))},cr=function(t){t.getAllNodes().forEach((function(e){var r=t.getNode(e.id);if("selfedge"===r.data.dummy){var n=t.getNode(r.data.e.source),o=n.data.x+n.data.width/2,i=n.data.y,a=r.data.x-o,s=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}}))},lr=function(t,e){var r={};return null==e||e.forEach((function(e){void 0!==t[e]&&(r[e]=+t[e])})),r},fr=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(r){e[r.toLowerCase()]=t[r]})),e},gr={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="dagre",this.layoutNode=function(t){return!1!==t.data.layout},this.options=n(n({},gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericDagreLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericDagreLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericDagreLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,E,N,M,k,R,I,_,D,O,P,T,z,C,L,q,j,F,V,G,W=this;return a(this,(function(a){return o=n(n({},this.options),r),i=o.nodeSize,s=o.align,u=o.rankdir,d=void 0===u?"TB":u,h=o.ranksep,c=o.nodesep,f=o.ranksepFunc,g=o.nodesepFunc,p=o.edgeLabelSpace,v=o.nodeOrder,y=o.begin,m=o.controlPoints,w=o.radial,E=new l({tree:[]}),N=S(h||50,f),M=S(c||50,g),k=M,R=N,"LR"!==d&&"RL"!==d||(k=N,R=M),I=A(i,void 0),_=e.getAllNodes(),D=e.getAllEdges(),_.filter((function(t){return!1!==t.data.layout})).forEach((function(t){var e=I(t),r=R(t),n=e+2*k(t),o=e+2*r,i=t.data.layer;x(i)?E.addNode({id:t.id,data:{width:n,height:o,layer:i}}):E.addNode({id:t.id,data:{width:n,height:o}})})),D.forEach((function(t){W.layoutNode(E.getNode(t.source))&&W.layoutNode(E.getNode(t.target))&&E.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),function(t,e){var r,o,i=e.edgeLabelSpace,a=e.keepNodeOrder,s=e.prevGraph,u=e.rankdir,d=e.ranksep;!a&&s&&(o=s,(r=t).getAllNodes().forEach((function(t){var e=r.getNode(t.id),n=o.getNode(t.id);void 0!==n?(e.data.fixorder=n.data._order,delete n.data._order):delete e.data.fixorder})));var h=function(t){var e=new l({tree:[]});return t.getAllNodes().forEach((function(r){var o=fr(t.getNode(r.id).data),i=n(n({},Xe),o),a=lr(i,Je);e.hasNode(r.id)||e.addNode({id:r.id,data:n({},a)});var s=t.getParent(r.id);null==s||(e.hasNode(s.id)||e.addNode(n({},s)),e.setParent(r.id,s.id))})),t.getAllEdges().forEach((function(r){var n=fr(t.getEdge(r.id).data),o={};null==tr||tr.forEach((function(t){void 0!==n[t]&&(o[t]=n[t])})),e.addEdge({id:r.id,source:r.source,target:r.target,data:Object.assign({},Ze,lr(n,Qe),o)})})),e}(t);!1!==i&&(e.ranksep=function(t,e){var r=e.ranksep,n=void 0===r?0:r,o=e.rankdir;return t.getAllNodes().forEach((function(t){isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((function(t){var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===o||"BT"===o?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2}(h,{rankdir:u,ranksep:d}));try{Ye(h,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph\'s structure:\\n",t);throw t}!function(t,e){t.getAllNodes().forEach((function(r){var n,o=t.getNode(r.id);if(o){var i=e.getNode(r.id);o.data.x=i.data.x,o.data.y=i.data.y,o.data._order=i.data.order,o.data._rank=i.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(o.data.width=i.data.width,o.data.height=i.data.height)}})),t.getAllEdges().forEach((function(r){var n=t.getEdge(r.id),o=e.getEdge(r.id);n.data.points=o?o.data.points:[],o&&o.data.hasOwnProperty("x")&&(n.data.x=o.data.x,n.data.y=o.data.y)}))}(t,h)}(E,{prevGraph:null,edgeLabelSpace:p,keepNodeOrder:!!v,nodeOrder:v||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:d,nodesep:c,align:s}),O=[0,0],y&&(P=1/0,T=1/0,E.getAllNodes().forEach((function(t){P>t.data.x&&(P=t.data.x),T>t.data.y&&(T=t.data.y)})),E.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){P>t.x&&(P=t.x),T>t.y&&(T=t.y)}))})),O[0]=y[0]-P,O[1]=y[1]-T),z="LR"===d||"RL"===d,w||(C=new Set,L="BT"===d||"RL"===d?function(t,e){return e-t}:function(t,e){return t-e},E.getAllNodes().forEach((function(t){t.data.x=t.data.x+O[0],t.data.y=t.data.y+O[1],C.add(z?t.data.x:t.data.y)})),q=Array.from(C).sort(L),j=z?function(t,e){return t.x!==e.x}:function(t,e){return t.y!==e.y},F=z?function(t,e,r){var n=Math.max(e.y,r.y),o=Math.min(e.y,r.y);return t.filter((function(t){return t.y<=n&&t.y>=o}))}:function(t,e,r){var n=Math.max(e.x,r.x),o=Math.min(e.x,r.x);return t.filter((function(t){return t.x<=n&&t.x>=o}))},E.getAllEdges().forEach((function(t,e){var r;p&&m&&"loop"!==t.data.type&&(t.data.controlPoints=vr(null===(r=t.data.points)||void 0===r?void 0:r.map((function(t){var e=t.x,r=t.y;return{x:e+O[0],y:r+O[1]}})),E.getNode(t.source),E.getNode(t.target),q,z,j,F))}))),V=[],V=E.getAllNodes().map((function(t){return b(t)})),G=E.getAllEdges(),t&&(V.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),G.forEach((function(t){e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),[2,{nodes:V,edges:G}]}))}))},t}(),vr=function(t,e,r,n,o,i,a){var s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){var u=e.data,d=u.x,h=u.y,c=r.data,l=c.x,f=c.y;if(o&&(d=e.data.y,h=e.data.x,l=r.data.y,f=r.data.x),f!==h&&d!==l){var g=n.indexOf(h),p=n[g+1];if(p){var v=s[0],y=o?{x:(h+p)/2,y:(null==v?void 0:v.y)||l}:{x:(null==v?void 0:v.x)||l,y:(h+p)/2};v&&!i(v,y)||s.unshift(y)}var m=n.indexOf(f),w=Math.abs(m-g);if(1===w)(s=a(s,e.data,r.data)).length||s.push(o?{x:(h+f)/2,y:d}:{x:d,y:(h+f)/2});else if(w>1){var x=n[m-1];if(x){var E=s[s.length-1],b=o?{x:(f+x)/2,y:(null==E?void 0:E.y)||l}:{x:(null==E?void 0:E.x)||d,y:(f+x)/2};E&&!i(E,b)||s.push(b)}}}}return s};function yr(t){var e=0,r=0,n=0;if(t.length){for(var o=0;o<4;o++)(i=t[o])&&i.weight&&(e+=i.weight,r+=i.x*i.weight,n+=i.y*i.weight);t.x=r/e,t.y=n/e,t.weight=e}else{var i=t;t.x=i.data.x,t.y=i.data.y,t.weight=i.data.weight}}var mr=function(t,e,r,n,o,i){var a=i.x-t.x||.1,s=i.y-t.y||.1,u=n-e,d=a*a+s*s,h=Math.sqrt(d)*d;if(u*u*.81<d){var c=t.weight/h;return i.vx+=a*c,i.vy+=s*c,!0}if(t.length)return!1;t.data!==i&&(c=t.data.weight/h,i.vx+=a*c,i.vy+=s*c)},wr={maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},xr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=n(n({},wr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,E,b,N,M,S,k=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=this.formatOptions(o,e),d=u.width,h=u.height,c=u.nodeSize,f=u.getMass,g=u.nodeStrength,p=u.edgeStrength,v=u.linkDistance,y=i.map((function(t){return n(n({},t),{data:n(n({},t.data),{x:x(t.data.x)?t.data.x:Math.random()*d,y:x(t.data.y)?t.data.y:Math.random()*h,size:c(t)||30,mass:f(t),nodeStrength:g(t)})})})),m=s.map((function(t){return n(n({},t),{data:n(n({},t.data),{edgeStrength:p(t),linkDistance:v(t,e.getNode(t.source),e.getNode(t.target))})})})),(null==i?void 0:i.length)?(w={},i.forEach((function(t,e){w[t.id]={x:0,y:0}})),E=new l({nodes:y,edges:m}),this.formatCentripetal(u,E),b=u.maxIteration,N=u.minMovement,M=u.onTick,this.lastLayoutNodes=y,this.lastLayoutEdges=m,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=E,this.lastOptions=u,this.lastVelMap=w,"undefined"==typeof window?[2]:(S=0,[2,new Promise((function(r){k.timeInterval=window.setInterval((function(){i&&k.running||r({nodes:Sr(e,y),edges:s}),k.runOneStep(E,e,S,w,u),k.updatePosition(e,E,w,u),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),null==M||M({nodes:Sr(e,y),edges:s}),(++S>=b||k.judgingDistance<N)&&(window.clearInterval(k.timeInterval),r({nodes:Sr(e,y),edges:s}))}),0),k.running=!0}))])):(this.lastResult={nodes:[],edges:s},[2,{nodes:[],edges:s}])}))}))},t.prototype.formatOptions=function(t,e){var r=t,n=t.width,o=t.height,i=t.getMass;if(r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=o||"undefined"==typeof window?o:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),i||(r.getMass=function(t){var r=1;x(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);var n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),t.preventOverlap){var a=S(0,t.nodeSpacing);t.nodeSize?g(t.nodeSize)?r.nodeSize=function(e){var r=t.nodeSize;return Math.max(r[0],r[1])+a(e)}:r.nodeSize=function(e){return t.nodeSize+a(e)}:r.nodeSize=function(t){var e=((null==t?void 0:t.data)||{}).size;return e?g(e)?Math.max(e[0],e[1])+a(t):M(e)?Math.max(e.width,e.height)+a(t):e+a(t):10+a(t)}}return r.linkDistance=t.linkDistance?S(1,t.linkDistance):function(t){return 1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target))},r.nodeStrength=S(1,t.nodeStrength),r.edgeStrength=S(1,t.edgeStrength),t},t.prototype.formatCentripetal=function(t,e){var r,n=t.centripetalOptions,o=t.center,i=t.clusterNodeStrength,a=t.leafCluster,s=t.clustering,u=t.nodeClusterBy,d=e.getAllNodes(),h=n||{leaf:2,single:2,others:1,center:function(t){return{x:o[0],y:o[1]}}};"function"!=typeof i&&(t.clusterNodeStrength=function(t){return i});var c=[];if(a&&u&&(r=Er(e,u),c=Array.from(new Set(null==d?void 0:d.map((function(t){return t.data[u]}))))||[],t.centripetalOptions=Object.assign(h,{single:100,leaf:function(e){var n=r[e.id]||{},o=n.siblingLeaves,i=n.sameTypeLeaves;return(null==i?void 0:i.length)===(null==o?void 0:o.length)||1===(null==c?void 0:c.length)?1:t.clusterNodeStrength(e)},others:1,center:function(t){var n,o=e.getDegree(t.id,"both");if(!o)return{x:100,y:100};if(1===o){var i=(r[t.id]||{}).sameTypeLeaves,a=void 0===i?[]:i;1===a.length?n=void 0:a.length>1&&(n=Mr(a))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y}}})),s&&u){r||(r=Er(e,u)),c||(c=Array.from(new Set(d.map((function(t){return t.data[u]}))))),c=c.filter((function(t){return void 0!==t}));var l={};c.forEach((function(t){var r=d.filter((function(e){return e.data[u]===t})).map((function(t){return e.getNode(t.id)}));l[t]=Mr(r)})),t.centripetalOptions=Object.assign(h,{single:function(e){return t.clusterNodeStrength(e)},leaf:function(e){return t.clusterNodeStrength(e)},others:function(e){return t.clusterNodeStrength(e)},center:function(t){var e=l[t.data[u]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y}}})}var f=t.centripetalOptions||{},g=f.leaf,p=f.single,v=f.others;g&&"function"!=typeof g&&(t.centripetalOptions.leaf=function(){return g}),p&&"function"!=typeof p&&(t.centripetalOptions.single=function(){return p}),v&&"function"!=typeof v&&(t.centripetalOptions.others=function(){return v})},t.prototype.runOneStep=function(t,e,r,n,o){var i={},a=t.getAllNodes(),s=t.getAllEdges();if(null==a?void 0:a.length){var u=o.monitor;this.calRepulsive(t,i,o),s&&this.calAttractive(t,i),this.calGravity(t,e,i,o),this.updateVelocity(t,i,n,o),u&&u({energy:this.calTotalEnergy(i,a),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}},t.prototype.calTotalEnergy=function(t,e){if(!(null==e?void 0:e.length))return 0;var r=0;return e.forEach((function(e,n){var o=t[e.id].x,i=t[e.id].y,a=o*o+i*i,s=e.data.mass;r+=(void 0===s?1:s)*a*.5})),r},t.prototype.calRepulsive=function(t,e,r){var n=r.factor,o=r.coulombDisScale;!function(t,e,r,n){var o=e/r,i=t.getAllNodes(),a=i.map((function(t,e){var r=t.data,n=r.nodeStrength;return{x:r.x,y:r.y,size:r.size,index:e,vx:0,vy:0,weight:o*n}})),s=F(a,(function(t){return t.x}),(function(t){return t.y})).visitAfter(yr);a.forEach((function(t){!function(t,e){e.visit((function(e,r,n,o,i){return mr(e,r,n,o,i,t)}))}(t,s)})),a.map((function(t,e){var r=i[e],o=r.id,a=r.data.mass,s=void 0===a?1:a;n[o]={x:t.vx/s,y:t.vy/s}}))}(t,n,o*o,e)},t.prototype.calAttractive=function(t,e){t.getAllEdges().forEach((function(r,n){var o=r.source,i=r.target,a=t.getNode(o),s=t.getNode(i);if(a&&s){var u=s.data.x-a.data.x,d=s.data.y-a.data.y;u||d||(u=.01*Math.random(),d=.01*Math.random());var h=Math.sqrt(u*u+d*d),c=u/h,l=d/h,f=r.data||{},g=f.linkDistance,p=void 0===g?200:g,v=f.edgeStrength,y=(p-h)*(void 0===v?200:v),m=1/(a.data.mass||1),w=1/(s.data.mass||1),x=c*y,E=l*y;e[o].x-=x*m,e[o].y-=E*m,e[i].x+=x*w,e[i].y+=E*w}}))},t.prototype.calGravity=function(t,e,r,n){var o=n.getCenter,i=t.getAllNodes(),a=e.getAllNodes(),u=e.getAllEdges(),d=n.width,h=n.height,c=n.center,l=n.gravity,f=n.centripetalOptions;i&&i.forEach((function(n){var i=n.id,g=n.data,p=g.mass,v=g.x,y=g.y,m=e.getNode(i),w=0,E=0,b=l,N=t.getDegree(i,"in"),M=t.getDegree(i,"out"),S=t.getDegree(i,"both"),k=null==o?void 0:o(m,S);if(k){var A=s(k,3);w=v-A[0],E=y-A[1],b=A[2]}else w=v-c[0],E=y-c[1];if(b&&(r[i].x-=b*w/p,r[i].y-=b*E/p),f){var R=f.leaf,I=f.single,_=f.others,D=f.center,O=(null==D?void 0:D(m,a,u,d,h))||{x:0,y:0,centerStrength:0},P=O.x,T=O.y,z=O.centerStrength;if(!x(P)||!x(T))return;var C=(v-P)/p,L=(y-T)/p;if(z&&(r[i].x-=z*C,r[i].y-=z*L),0===S){var q=I(m);if(!q)return;return r[i].x-=q*C,void(r[i].y-=q*L)}if(0===N||0===M){var j=R(m,a,u);if(!j)return;return r[i].x-=j*C,void(r[i].y-=j*L)}var F=_(m);if(!F)return;r[i].x-=F*C,r[i].y-=F*L}}))},t.prototype.updateVelocity=function(t,e,r,n){var o=n.damping,i=n.maxSpeed,a=n.interval,s=t.getAllNodes();(null==s?void 0:s.length)&&s.forEach((function(t){var n=t.id,s=(r[n].x+e[n].x*a)*o||.01,u=(r[n].y+e[n].y*a)*o||.01,d=Math.sqrt(s*s+u*u);if(d>i){var h=i/d;s*=h,u*=h}r[n]={x:s,y:u}}))},t.prototype.updatePosition=function(t,e,r,n){var o=this,i=n.distanceThresholdMode,a=n.interval,s=e.getAllNodes();if(null==s?void 0:s.length){var u=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),s.forEach((function(n){var s=n.id,d=t.getNode(s);if(x(d.data.fx)&&x(d.data.fy))e.mergeNodeData(s,{x:d.data.fx,y:d.data.fy});else{var h=r[s].x*a,c=r[s].y*a;e.mergeNodeData(s,{x:n.data.x+h,y:n.data.y+c});var l=Math.sqrt(h*h+c*c);switch(i){case"max":o.judgingDistance<l&&(o.judgingDistance=l);break;case"min":o.judgingDistance>l&&(o.judgingDistance=l);break;default:u+=l}}})),i&&"mean"!==i||(this.judgingDistance=u/s.length)}else this.judgingDistance=0},t}(),Er=function(t,e){var r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};var n={};return r.forEach((function(r,o){1===t.getDegree(r.id,"both")&&(n[r.id]=br(t,"leaf",r,e))})),n},br=function(t,e,r,n){var o=t.getDegree(r.id,"in"),i=t.getDegree(r.id,"out"),a=r,s=[];return 0===o?(a=t.getSuccessors(r.id)[0],s=t.getNeighbors(a.id)):0===i&&(a=t.getPredecessors(r.id)[0],s=t.getNeighbors(a.id)),s=s.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")})),{coreNode:a,siblingLeaves:s,sameTypeLeaves:Nr(t,e,n,r,s)}},Nr=function(t,e,r,n,o){var i=n.data[r]||"",a=(null==o?void 0:o.filter((function(t){return t.data[r]===i})))||[];return"leaf"===e&&(a=a.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")}))),a},Mr=function(t){var e={x:0,y:0};t.forEach((function(t){var r=t.data,n=r.x,o=r.y;e.x+=n||0,e.y+=o||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},Sr=function(t,e){return e.map((function(e){var r=e.id,o=e.data,i=t.getNode(r);return n(n({},i),{data:n(n({},i.data),{x:o.x,y:o.y})})}))},kr=function(){function t(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}return t.prototype.distanceTo=function(t){var e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)},t.prototype.setPos=function(t,e){this.rx=t,this.ry=e},t.prototype.resetForce=function(){this.fx=0,this.fy=0},t.prototype.addForce=function(t){var e=t.rx-this.rx,r=t.ry-this.ry,n=Math.hypot(e,r);n=n<1e-4?1e-4:n;var o=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=o*e/n,this.fy+=o*r/n},t.prototype.in=function(t){return t.contains(this.rx,this.ry)},t.prototype.add=function(e){var r=this.mass+e.mass;return new t({rx:(this.rx*this.mass+e.rx*e.mass)/r,ry:(this.ry*this.mass+e.ry*e.mass)/r,mass:r,degree:this.degree+e.degree})},t}();const Ar=kr;const Rr=function(){function t(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}return t.prototype.getLength=function(){return this.length},t.prototype.contains=function(t,e){var r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r},t.prototype.NW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.NE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.SW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t.prototype.SE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t}(),Ir=function(){function t(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}return t.prototype.insert=function(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e},t.prototype._putBody=function(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))},t.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},t.prototype.updateForce=function(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))},t}();var _r={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Dr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2",this.options=n(n({},_r),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,x,E,N,M,S,k,A,I;return a(this,(function(a){if(o=e.getAllEdges(),i=e.getAllNodes(),s=this.formatOptions(r,i.length),u=s.width,d=s.height,h=s.prune,c=s.maxIteration,f=s.nodeSize,g=s.center,!(null==i?void 0:i.length)||1===i.length)return[2,R(e,t,g)];if(p=i.map((function(t){return b(t,[u,d])})),v=o.filter((function(t){return t.source!==t.target})),y=new l({nodes:p,edges:v}),m=this.getSizes(y,e,f),this.run(y,e,c,m,t,s),h){for(w=0;w<v.length;w+=1)x=v[w],E=x.source,N=x.target,M=y.getDegree(E),S=y.getDegree(E),M<=1?(k=y.getNode(N),y.mergeNodeData(E,{x:k.data.x,y:k.data.y})):S<=1&&(A=y.getNode(E),y.mergeNodeData(N,{x:A.data.x,y:A.data.y}));I=n(n({},s),{prune:!1,barnesHut:!1}),this.run(y,e,100,m,t,I)}return[2,{nodes:p,edges:o}]}))}))},t.prototype.getSizes=function(t,e,r){for(var n=t.getAllNodes(),o={},i=0;i<n.length;i+=1){var a=n[i],d=a.id,h=a.data;if(o[d]=10,x(h.size))o[d]=h.size;else if(g(h.size))isNaN(h.size[0])||(o[d]=Math.max(h.size[0])),isNaN(h.size[1])||(o[d]=Math.max(h.size[1]));else if(M(h.size))o[d]=Math.max(h.size.width,h.size.height);else if(N(r)){var c=r(e.getNode(d));g(c)?o[d]=Math.max.apply(Math,u([],s(c))):o[d]=c}else g(r)?o[d]=Math.max.apply(Math,u([],s(r))):x(r)&&(o[d]=r)}return o},t.prototype.formatOptions=function(t,e){void 0===t&&(t={});var r=n(n({},this.options),t),o=r.center,i=r.width,a=r.height,s=r.barnesHut,u=r.prune,d=r.maxIteration,h=r.kr,c=r.kg;return r.width=i||"undefined"==typeof window?i:window.innerWidth,r.height=a||"undefined"==typeof window?a:window.innerHeight,r.center=o||[r.width/2,r.height/2],void 0===s&&e>250&&(r.barnesHut=!0),void 0===u&&e>100&&(r.prune=!0),0!==d||u?0===d&&u&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)):(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)),h||(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),c||(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r},t.prototype.run=function(t,e,r,n,o,i){for(var a=i.kr,s=i.barnesHut,u=i.onTick,d=t.getAllNodes(),h=0,c=r,l={},f={},g={},p=0;p<d.length;p+=1){var v=d[p],y=v.data,m=v.id;if(l[m]=[0,0],s){var w={id:p,rx:y.x,ry:y.y,mass:1,g:a,degree:t.getDegree(m)};g[m]=new Ar(w)}}for(;c>0;)h=this.oneStep(t,{iter:c,preventOverlapIters:50,krPrime:100,sg:h,forces:l,preForces:f,bodies:g,sizes:n},i),c--,null==u||u({nodes:d,edges:e.getAllEdges()});return t},t.prototype.oneStep=function(t,e,r){for(var n=e.iter,o=e.preventOverlapIters,i=e.krPrime,a=e.sg,d=e.preForces,h=e.bodies,c=e.sizes,l=e.forces,f=r.preventOverlap,g=r.barnesHut,p=t.getAllNodes(),v=0;v<p.length;v+=1){var y=p[v].id;d[y]=u([],s(l[y])),l[y]=[0,0]}return l=this.getAttrForces(t,n,o,c,l,r),l=g&&(f&&n>o||!f)?this.getOptRepGraForces(t,l,h,r):this.getRepGraForces(t,n,o,l,i,c,r),this.updatePos(t,l,d,a,r)},t.prototype.getAttrForces=function(t,e,r,n,o,i){for(var a=i.preventOverlap,s=i.dissuadeHubs,u=i.mode,d=i.prune,h=t.getAllEdges(),c=0;c<h.length;c+=1){var l=h[c],f=l.source,g=l.target,p=t.getNode(f),v=t.getNode(g),y=t.getDegree(f),m=t.getDegree(g);if(!d||!(y<=1||m<=1)){var w=[v.data.x-p.data.x,v.data.y-p.data.y],x=Math.hypot(w[0],w[1]);x=x<1e-4?1e-4:x,w[0]=w[0]/x,w[1]=w[1]/x,a&&e<r&&(x=x-n[f]-n[g]);var E=x,b=E;"linlog"===u&&(b=E=Math.log(1+x)),s&&(E=x/y,b=x/m),a&&e<r&&x<=0?(E=0,b=0):a&&e<r&&x>0&&(E=x,b=x),o[f][0]+=E*w[0],o[g][0]-=b*w[0],o[f][1]+=E*w[1],o[g][1]-=b*w[1]}}return o},t.prototype.getOptRepGraForces=function(t,e,r,n){for(var o=n.kg,i=n.center,a=n.prune,s=t.getAllNodes(),u=s.length,d=9e10,h=-9e10,c=9e10,l=-9e10,f=0;f<u;f+=1){var g=s[f],p=g.id,v=g.data;a&&t.getDegree(p)<=1||(r[p].setPos(v.x,v.y),v.x>=h&&(h=v.x),v.x<=d&&(d=v.x),v.y>=l&&(l=v.y),v.y<=c&&(c=v.y))}var y=Math.max(h-d,l-c),m=new Rr({xmid:(h+d)/2,ymid:(l+c)/2,length:y,massCenter:i,mass:u}),w=new Ir(m);for(f=0;f<u;f+=1)p=s[f].id,a&&t.getDegree(p)<=1||r[p].in(m)&&w.insert(r[p]);for(f=0;f<u;f+=1){var x=s[f],E=(p=x.id,v=x.data,t.getDegree(p));if(!(a&&E<=1)){r[p].resetForce(),w.updateForce(r[p]),e[p][0]-=r[p].fx,e[p][1]-=r[p].fy;var b=[v.x-i[0],v.y-i[1]],N=Math.hypot(b[0],b[1]);N=N<1e-4?1e-4:N,b[0]=b[0]/N,b[1]=b[1]/N;var M=o*(E+1);e[p][0]-=M*b[0],e[p][1]-=M*b[1]}}return e},t.prototype.getRepGraForces=function(t,e,r,n,o,i,a){for(var s=a.preventOverlap,u=a.kr,d=a.kg,h=a.center,c=a.prune,l=t.getAllNodes(),f=l.length,g=0;g<f;g+=1){for(var p=l[g],v=t.getDegree(p.id),y=g+1;y<f;y+=1){var m=l[y],w=t.getDegree(m.id);if(!c||!(v<=1||w<=1)){var x=[m.data.x-p.data.x,m.data.y-p.data.y],E=Math.hypot(x[0],x[1]);E=E<1e-4?1e-4:E,x[0]=x[0]/E,x[1]=x[1]/E,s&&e<r&&(E=E-i[p.id]-i[m.id]);var b=u*(v+1)*(w+1)/E;s&&e<r&&E<0?b=o*(v+1)*(w+1):s&&e<r&&0===E?b=0:s&&e<r&&E>0&&(b=u*(v+1)*(w+1)/E),n[p.id][0]-=b*x[0],n[m.id][0]+=b*x[0],n[p.id][1]-=b*x[1],n[m.id][1]+=b*x[1]}}var N=[p.data.x-h[0],p.data.y-h[1]],M=Math.hypot(N[0],N[1]);N[0]=N[0]/M,N[1]=N[1]/M;var S=d*(v+1);n[p.id][0]-=S*N[0],n[p.id][1]-=S*N[1]}return n},t.prototype.updatePos=function(t,e,r,n,o){for(var i=o.ks,a=o.tao,s=o.prune,u=o.ksmax,d=t.getAllNodes(),h=d.length,c=[],l=[],f=0,g=0,p=n,v=0;v<h;v+=1){var y=d[v].id,m=t.getDegree(y);if(!(s&&m<=1)){var w=[e[y][0]-r[y][0],e[y][1]-r[y][1]],E=Math.hypot(w[0],w[1]),b=[e[y][0]+r[y][0],e[y][1]+r[y][1]],N=Math.hypot(b[0],b[1]);c[v]=E,l[v]=N/2,f+=(m+1)*c[v],g+=(m+1)*l[v]}}var M=p;for(p=a*g/f,0!==M&&(p=p>1.5*M?1.5*M:p),v=0;v<h;v+=1){var S=d[v],k=(y=S.id,S.data);if(m=t.getDegree(y),!(s&&m<=1||x(k.fx)&&x(k.fy))){var A=i*p/(1+p*Math.sqrt(c[v])),R=Math.hypot(e[y][0],e[y][1]),I=u/(R=R<1e-4?1e-4:R),_=(A=A>I?I:A)*e[y][0],D=A*e[y][1];t.mergeNodeData(y,{x:k.x+_,y:k.y+D})}}return p},t}(),Or={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=n(n({},Or),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericFruchtermanLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,x,E=this;return a(this,(function(a){return this.running?[2]:(o=this.formatOptions(r),i=o.width,s=o.height,u=o.center,d=o.clustering,h=o.nodeClusterBy,c=o.maxIteration,f=o.onTick,g=e.getAllNodes(),p=e.getAllEdges(),(null==g?void 0:g.length)?1===g.length?(t&&e.mergeNodeData(g[0].id,{x:u[0],y:u[1]}),v={nodes:[n(n({},g[0]),{data:n(n({},g[0].data),{x:u[0],y:u[1]})})],edges:p},this.lastResult=v,[2,v]):(y=g.map((function(t){return b(t,[i,s])})),m=new l({nodes:y,edges:p}),w={},d&&y.forEach((function(t){var e=t.data[h];w[e]||(w[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=y,this.lastLayoutEdges=p,this.lastAssign=t,this.lastGraph=m,this.lastOptions=o,this.lastClusterMap=w,"undefined"==typeof window?[2]:(x=0,[2,new Promise((function(r){E.timeInterval=window.setInterval((function(){E.running?(E.runOneStep(m,w,o),t&&y.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y})})),null==f||f({nodes:y,edges:p}),++x>=c&&(window.clearInterval(E.timeInterval),r({nodes:y,edges:p}))):r({nodes:y,edges:p})}),0),E.running=!0}))])):(v={nodes:[],edges:p},this.lastResult=v,[2,v]))}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=n(n({},this.options),t),r=e.clustering,o=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=r&&!!o,e},t.prototype.runOneStep=function(t,e,r){var n=r.height,o=r.width,i=r.gravity,a=r.center,s=r.speed,u=r.clustering,d=r.nodeClusterBy,h=r.clusterGravity,c=n*o,l=Math.sqrt(c)/10,f=t.getAllNodes(),g=c/(f.length+1),p=Math.sqrt(g),v={};if(this.applyCalculate(t,v,p,g),u){for(var y in e)e[y].cx=0,e[y].cy=0,e[y].count=0;for(var y in f.forEach((function(t){var r=t.data,n=e[r[d]];x(r.x)&&(n.cx+=r.x),x(r.y)&&(n.cy+=r.y),n.count++})),e)e[y].cx/=e[y].count,e[y].cy/=e[y].count;var m=h||i;f.forEach((function(t,r){var n=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=e[o[d]],a=Math.sqrt((o.x-i.cx)*(o.x-i.cx)+(o.y-i.cy)*(o.y-i.cy)),s=p*m;v[n].x-=s*(o.x-i.cx)/a,v[n].y-=s*(o.y-i.cy)/a}}))}f.forEach((function(t,e){var r=t.id,n=t.data;if(x(n.x)&&x(n.y)){var o=.01*p*i;v[r].x-=o*(n.x-a[0]),v[r].y-=o*(n.y-a[1])}})),f.forEach((function(e,r){var n=e.id,o=e.data;if(x(o.fx)&&x(o.fy))return o.x=o.fx,void(o.y=o.fy);if(x(o.x)&&x(o.y)){var i=Math.sqrt(v[n].x*v[n].x+v[n].y*v[n].y);if(i>0){var a=Math.min(l*(s/800),i);t.mergeNodeData(n,{x:o.x+v[n].x/i*a,y:o.y+v[n].y/i*a})}}}))},t.prototype.applyCalculate=function(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)},t.prototype.calRepulsive=function(t,e,r){var n=t.getAllNodes();n.forEach((function(t,o){var i=t.data,a=t.id;e[a]={x:0,y:0},n.forEach((function(t,n){var s=t.data,u=t.id;if(!(o<=n)&&x(i.x)&&x(s.x)&&x(i.y)&&x(s.y)){var d=i.x-s.x,h=i.y-s.y,c=d*d+h*h;0===c&&(c=1,d=.01,h=.01);var l=r/c,f=d*l,g=h*l;e[a].x+=f,e[a].y+=g,e[u].x-=f,e[u].y-=g}}))}))},t.prototype.calAttractive=function(t,e,r){t.getAllEdges().forEach((function(n){var o=n.source,i=n.target;if(o&&i&&o!==i){var a=t.getNode(o).data,s=t.getNode(i).data;if(x(s.x)&&x(a.x)&&x(s.y)&&x(a.y)){var u=s.x-a.x,d=s.y-a.y,h=Math.sqrt(u*u+d*d)/r,c=u*h,l=d*h;e[o].x+=c,e[o].y+=l,e[i].x-=c,e[i].y-=l}}}))},t}(),Tr={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},zr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="grid",this.options=n(n({},Tr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericGridLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericGridLayout(!0,t,e),[2]}))}))},t.prototype.genericGridLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,p,v,y,m,w,E,N,M,A,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.begin,s=void 0===i?[0,0]:i,u=o.condense,d=o.preventOverlapPadding,h=o.preventOverlap,c=o.rows,l=o.cols,f=o.nodeSpacing,p=o.nodeSize,v=o.width,y=o.height,m=o.position,w=o.sortBy,E=e.getAllNodes(),N=e.getAllEdges(),!(M=null==E?void 0:E.length)||1===M)return[2,R(e,t,s)];if(A=E.map((function(t){return b(t)})),"id"===w||P(w)&&void 0!==A[0].data[w]||(w="degree"),"degree"===w?A.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):"id"===w?A.sort((function(t,e){return x(e.id)&&x(t.id)?e.id-t.id:(""+t.id).localeCompare(""+e.id)})):A.sort((function(t,e){return e.data[w]-t.data[w]})),I=v||"undefined"==typeof window?v:window.innerWidth,_=y||"undefined"==typeof window?y:window.innerHeight,D=M,O={rows:c,cols:l},null!=c&&null!=l?(O.rows=c,O.cols=l):null!=c&&null==l?(O.rows=c,O.cols=Math.ceil(D/O.rows)):null==c&&null!=l?(O.cols=l,O.rows=Math.ceil(D/O.cols)):(T=Math.sqrt(D*_/I),O.rows=Math.round(T),O.cols=Math.round(I/_*T)),O.rows=Math.max(O.rows,1),O.cols=Math.max(O.cols,1),O.cols*O.rows>D)z=Cr(O),C=Lr(O),(z-1)*C>=D?Cr(O,z-1):(C-1)*z>=D&&Lr(O,C-1);else for(;O.cols*O.rows<D;)z=Cr(O),((C=Lr(O))+1)*z>=D?Lr(O,C+1):Cr(O,z+1);for(L=u?0:I/O.cols,q=u?0:_/O.rows,(h||f)&&(j=S(10,f),F=k(30,p,!1),A.forEach((function(t){t.data.x&&t.data.y||(t.data.x=0,t.data.y=0);var r,n,o=e.getNode(t.id),i=F(o)||30;g(i)?(r=i[0],n=i[1]):(r=i,n=i);var a=void 0!==j?j(t):d,s=r+a,u=n+a;L=Math.max(L,s),q=Math.max(q,u)}))),V={},G={row:0,col:0},W={},B=0;B<A.length;B++){if($=A[B],U=void 0,m&&(U=m(e.getNode($.id))),U&&(void 0!==U.row||void 0!==U.col)){if(void 0===(H={row:U.row,col:U.col}).col)for(H.col=0;qr(V,H);)H.col++;else if(void 0===H.row)for(H.row=0;qr(V,H);)H.row++;W[$.id]=H,jr(V,H)}Vr($,s,L,q,W,O,G,V)}return K={nodes:A,edges:N},t&&A.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,K]}))}))},t}(),Cr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.min(n,o):Math.min(n,o)===t.rows?t.rows=e:t.cols=e,r},Lr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.max(n,o):Math.max(n,o)===t.rows?t.rows=e:t.cols=e,r},qr=function(t,e){return t["c-"+e.row+"-"+e.col]||!1},jr=function(t,e){return t["c-"+e.row+"-"+e.col]=!0},Fr=function(t,e){var r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},Vr=function(t,e,r,n,o,i,a,s){var u,d,h=o[t.id];if(h)u=h.col*r+r/2+e[0],d=h.row*n+n/2+e[1];else{for(;qr(s,a);)Fr(i,a);u=a.col*r+r/2+e[0],d=a.row*n+n/2+e[1],jr(s,a),Fr(i,a)}t.data.x=u,t.data.y=d};const Gr=Object.prototype.toString;function Wr(t){return Gr.call(t).endsWith("Array]")}function Br(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!Wr(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]<a&&(a=t[s]);return a}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]>a&&(a=t[s]);return a}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,a=void 0===i?r.autoMinMax?n:0:i,s=r.max,u=void 0===s?r.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var d=(u-a)/(o-n),h=0;h<t.length;h++)e[h]=(t[h]-n)*d+a;return e}const $r=" ".repeat(2),Ur=" ".repeat(4);function Hr(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=e;return`${t.constructor.name} {\\n${$r}[\\n${Ur}${function(t,e,r,n,o){const{rows:i,columns:a}=t,s=Math.min(i,e),u=Math.min(a,r),d=[];if("auto"===o){o=!1;t:for(let e=0;e<s;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let e=0;e<s;e++){let r=[];for(let i=0;i<u;i++)r.push(Kr(t.get(e,i),n,o));d.push(`${r.join(" ")}`)}return u!==a&&(d[d.length-1]+=` ... ${a-r} more columns`),s!==i&&d.push(`... ${i-e} more rows`),d.join(`\\n${Ur}`)}(t,r,n,o,i)}\\n${$r}]\\n${$r}rows: ${t.rows}\\n${$r}columns: ${t.columns}\\n}`}function Kr(t,e,r){return(t>=0&&r?` ${Yr(t,e-1)}`:Yr(t,e)).padEnd(e)}function Yr(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function Jr(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function Xr(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function Qr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function Zr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function tn(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(rn("startRow",e),rn("endRow",r),rn("startColumn",n),rn("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function en(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function rn(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function nn(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class on{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new sn(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new sn(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new sn(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new sn(t,e)}static ones(t,e){return new sn(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new sn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)o.set(r,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let a=o-n,s=new sn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(i()*a);s.set(r,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let t=0;t<n;t++)o.set(t,t,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let e=0;e<o;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new sn(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return on.isMatrix(t)?t:new sn(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let a=o;a<e;a++){let e=t.get(r,a)-i*t.get(n,a);t.set(r,a,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new sn(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){Jr(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return sn.rowVector(this.getRow(t))}setRow(t,e){Jr(this,t),e=Qr(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){Jr(this,t),Jr(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){Xr(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return sn.columnVector(this.getColumn(t))}setColumn(t,e){Xr(this,t),e=Zr(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){Xr(this,t),Xr(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){Jr(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){Xr(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){nn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){nn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(Jr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){Jr(this,t),nn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(Jr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){Jr(this,t),nn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(Xr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){Xr(this,t),nn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(Xr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){Xr(this,t),nn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){on.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=sn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new sn(e,n),i=new Float64Array(r);for(let a=0;a<n;a++){for(let e=0;e<r;e++)i[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,a,e)}}return o}strassen2x2(t){t=sn.checkMatrix(t);let e=new sn(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),d=t.get(1,1),h=(r+u)*(n+d),c=(a+u)*n,l=r*(i-d),f=u*(s-n),g=(r+o)*d,p=h+f-g+(o-u)*(s+d),v=l+g,y=c+f,m=h-c+l+(a-r)*(n+i);return e.set(0,0,p),e.set(0,1,v),e.set(1,0,y),e.set(1,1,m),e}strassen3x3(t){t=sn.checkMatrix(t);let e=new sn(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),d=this.get(2,1),h=this.get(2,2),c=t.get(0,0),l=t.get(0,1),f=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),y=t.get(2,0),m=t.get(2,1),w=t.get(2,2),x=(r-i)*(-l+p),E=(-r+i+a)*(c-l+p),b=(i+a)*(-c+l),N=r*c,M=(-r+u+d)*(c-f+v),S=(-r+u)*(f-v),k=(u+d)*(-c+f),A=(-o+d+h)*(p+y-m),R=(o-h)*(p-m),I=o*y,_=(d+h)*(-y+m),D=(-o+a+s)*(v+y-w),O=(o-s)*(v-w),P=(a+s)*(-y+w),T=N+I+n*g,z=(r+n+o-i-a-d-h)*p+E+b+N+A+I+_,C=N+M+k+(r+n+o-a-s-u-d)*v+I+D+P,L=x+a*(-c+l+g-p-v-y+w)+E+N+I+D+O,q=x+E+b+N+s*m,j=I+D+O+P+i*f,F=N+M+S+d*(-c+f+g-p-v-y+m)+A+R+I,V=A+R+I+_+u*l,G=N+M+S+k+h*w;return e.set(0,0,T),e.set(0,1,z),e.set(0,2,C),e.set(1,0,L),e.set(1,1,q),e.set(1,2,j),e.set(2,0,F),e.set(2,1,V),e.set(2,2,G),e}mmulStrassen(t){t=sn.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function a(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=on.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${r} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let s=Math.max(r,o),u=Math.max(n,i);return e=a(e,s,u),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=a(e,n+1,o+1),r=a(r,n+1,o+1)):n%2==1?(e=a(e,n+1,o),r=a(r,n+1,o)):o%2==1&&(e=a(e,n,o+1),r=a(r,n,o+1));let i=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,s-1),d=r.subMatrix(0,i-1,0,s-1),h=e.subMatrix(0,i-1,s,e.columns-1),c=r.subMatrix(0,i-1,s,r.columns-1),l=e.subMatrix(i,e.rows-1,0,s-1),f=r.subMatrix(i,r.rows-1,0,s-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),p=r.subMatrix(i,r.rows-1,s,r.columns-1),v=t(on.add(u,g),on.add(d,p),i,s),y=t(on.add(l,g),d,i,s),m=t(u,on.sub(c,p),i,s),w=t(g,on.sub(f,d),i,s),x=t(on.add(u,h),p,i,s),E=t(on.sub(l,u),on.add(d,c),i,s),b=t(on.sub(h,g),on.add(f,p),i,s),N=on.add(v,w);N.sub(x),N.add(b);let M=on.add(m,x),S=on.add(y,w),k=on.sub(v,y);k.add(m),k.add(E);let A=on.zeros(2*N.rows,2*N.columns);return A=A.setSubMatrix(N,0,0),A=A.setSubMatrix(M,N.rows,0),A=A.setSubMatrix(S,0,N.columns),A=A.setSubMatrix(k,N.rows,N.columns),A.subMatrix(0,n-1,0,o-1)}(e,t=a(t,s,u),s,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new sn(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&Br(o,{min:e,max:r,output:o}),n.setRow(t,o)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new sn(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&Br(o,{min:e,max:r,output:o}),n.setColumn(t,o)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=sn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new sn(e*n,r*o);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<o;s++)i.set(n*a+r,o*e+s,this.get(a,e)*t.get(r,s));return i}kroneckerSum(t){if(t=sn.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(sn.eye(r,r)),o=sn.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new sn(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=an){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=an){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){tn(this,t,e,r,n);let o=new sn(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new sn(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new sn(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=sn.checkMatrix(t)).isEmpty())return this;tn(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){!function(t,e){if(!Wr(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!Wr(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new sn(t.length,e.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<e.length;t++){let i=e[t];r.set(n,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new sn(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=en(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=en(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=en(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=en(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Wr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<n;a++){let n=0,s=0,u=0;for(let e=0;e<o;e++)u=t.get(a,e)-r[a],n+=u,s+=u*u;e?i.push((s-n*n/o)/(o-1)):i.push((s-n*n/o)/o)}return i}(this,r,n);case"column":if(!Wr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<o;a++){let o=0,s=0,u=0;for(let e=0;e<n;e++)u=t.get(e,a)-r[a],o+=u,s+=u*u;e?i.push((s-o*o/n)/(n-1)):i.push((s-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let a=0,s=0,u=0;for(let e=0;e<n;e++)for(let n=0;n<o;n++)u=t.get(e,n)-r,a+=u,s+=u*u;return e?(s-a*a/i)/(i-1):(s-a*a/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Wr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!Wr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!Wr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!Wr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return Hr(this,t)}}function an(t,e){return t-e}on.prototype.klass="Matrix","undefined"!=typeof Symbol&&(on.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return Hr(this)}),on.random=on.rand,on.randomInt=on.randInt,on.diagonal=on.diag,on.prototype.diagonal=on.prototype.diag,on.identity=on.eye,on.prototype.negate=on.prototype.neg,on.prototype.tensorProduct=on.prototype.kroneckerProduct;class sn extends on{constructor(t,e){if(super(),sn.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Wr(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!r[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return Jr(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),Jr(this,t,!0),e=Float64Array.from(Qr(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){Xr(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),Xr(this,t,!0),e=Zr(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(on,sn);class un extends on{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function dn(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class hn{constructor(t,e={}){if((t=un.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=e;let s,u=Boolean(o),d=Boolean(i),h=!1;if(r<n)if(a){s=t.transpose(),r=s.rows,n=s.columns,h=!0;let e=u;u=d,d=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let c=Math.min(r,n),l=Math.min(r+1,n),f=new Float64Array(l),g=new sn(r,c),p=new sn(n,n),v=new Float64Array(n),y=new Float64Array(r),m=new Float64Array(l);for(let t=0;t<l;t++)m[t]=t;let w=Math.min(r-1,n),x=Math.max(0,Math.min(n-2,r)),E=Math.max(w,x);for(let t=0;t<E;t++){if(t<w){f[t]=0;for(let e=t;e<r;e++)f[t]=dn(f[t],s.get(e,t));if(0!==f[t]){s.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<r;e++)s.set(e,t,s.get(e,t)/f[t]);s.set(t,t,s.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<n;e++){if(t<w&&0!==f[t]){let n=0;for(let o=t;o<r;o++)n+=s.get(o,t)*s.get(o,e);n=-n/s.get(t,t);for(let o=t;o<r;o++)s.set(o,e,s.get(o,e)+n*s.get(o,t))}v[e]=s.get(t,e)}if(u&&t<w)for(let e=t;e<r;e++)g.set(e,t,s.get(e,t));if(t<x){v[t]=0;for(let e=t+1;e<n;e++)v[t]=dn(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<n;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<r&&0!==v[t]){for(let e=t+1;e<r;e++)y[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)y[e]+=v[r]*s.get(e,r);for(let e=t+1;e<n;e++){let n=-v[e]/v[t+1];for(let o=t+1;o<r;o++)s.set(o,e,s.get(o,e)+n*y[o])}}if(d)for(let e=t+1;e<n;e++)p.set(e,t,v[e])}}let b=Math.min(n,r+1);if(w<n&&(f[w]=s.get(w,w)),r<b&&(f[b-1]=0),x+1<b&&(v[x]=s.get(x,b-1)),v[b-1]=0,u){for(let t=w;t<c;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<c;e++){let n=0;for(let o=t;o<r;o++)n+=g.get(o,t)*g.get(o,e);n=-n/g.get(t,t);for(let o=t;o<r;o++)g.set(o,e,g.get(o,e)+n*g.get(o,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(d)for(let t=n-1;t>=0;t--){if(t<x&&0!==v[t])for(let e=t+1;e<n;e++){let r=0;for(let o=t+1;o<n;o++)r+=p.get(o,t)*p.get(o,e);r=-r/p.get(t+1,t);for(let o=t+1;o<n;o++)p.set(o,e,p.get(o,e)+r*p.get(o,t))}for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}let N=b-1,M=0,S=Number.EPSILON;for(;b>0;){let t,e;for(t=b-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===b-2)e=4;else{let r;for(r=b-1;r>=t&&r!==t;r--){let e=(r!==b?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(f[r])<=S*e){f[r]=0;break}}r===t?e=3:r===b-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[b-2];v[b-2]=0;for(let r=b-2;r>=t;r--){let o=dn(f[r],e),i=f[r]/o,a=e/o;if(f[r]=o,r!==t&&(e=-a*v[r-1],v[r-1]=i*v[r-1]),d)for(let t=0;t<n;t++)o=i*p.get(t,r)+a*p.get(t,b-1),p.set(t,b-1,-a*p.get(t,r)+i*p.get(t,b-1)),p.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<b;n++){let o=dn(f[n],e),i=f[n]/o,a=e/o;if(f[n]=o,e=-a*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g.get(e,n)+a*g.get(e,t-1),g.set(e,t-1,-a*g.get(e,n)+i*g.get(e,t-1)),g.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(f[b-1]),Math.abs(f[b-2]),Math.abs(v[b-2]),Math.abs(f[t]),Math.abs(v[t])),o=f[b-1]/e,i=f[b-2]/e,a=v[b-2]/e,s=f[t]/e,h=v[t]/e,c=((i+o)*(i-o)+a*a)/2,l=o*a*(o*a);let y=0;0===c&&0===l||(y=c<0?0-Math.sqrt(c*c+l):Math.sqrt(c*c+l),y=l/(c+y));let m=(s+o)*(s-o)+y,w=s*h;for(let e=t;e<b-1;e++){let o=dn(m,w);0===o&&(o=Number.MIN_VALUE);let i=m/o,a=w/o;if(e!==t&&(v[e-1]=o),m=i*f[e]+a*v[e],v[e]=i*v[e]-a*f[e],w=a*f[e+1],f[e+1]=i*f[e+1],d)for(let t=0;t<n;t++)o=i*p.get(t,e)+a*p.get(t,e+1),p.set(t,e+1,-a*p.get(t,e)+i*p.get(t,e+1)),p.set(t,e,o);if(o=dn(m,w),0===o&&(o=Number.MIN_VALUE),i=m/o,a=w/o,f[e]=o,m=i*v[e]+a*f[e+1],f[e+1]=-a*v[e]+i*f[e+1],w=a*v[e+1],v[e+1]=i*v[e+1],u&&e<r-1)for(let t=0;t<r;t++)o=i*g.get(t,e)+a*g.get(t,e+1),g.set(t,e+1,-a*g.get(t,e)+i*g.get(t,e+1)),g.set(t,e,o)}v[b-2]=m,M+=1;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,d))for(let e=0;e<=N;e++)p.set(e,t,-p.get(e,t));for(;t<N&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,d&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}M=0,b--}}if(h){let t=p;p=g,g=t}this.m=r,this.n=n,this.s=f,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,o=sn.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?o.set(t,t,0):o.set(t,t,1/this.s[t]);let i=this.U,a=this.rightSingularVectors,s=a.mmul(o),u=a.rows,d=i.rows,h=sn.zeros(u,d);for(let t=0;t<u;t++)for(let e=0;e<d;e++){let r=0;for(let o=0;o<n;o++)r+=s.get(t,o)*i.get(e,o);h.set(t,e,r)}return h.mmul(e)}solveForDiagonal(t){return this.solve(sn.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new sn(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,a=i.rows,s=i.columns,u=new sn(r,a);for(let t=0;t<r;t++)for(let e=0;e<a;e++){let r=0;for(let n=0;n<s;n++)r+=o.get(t,n)*i.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return sn.diag(this.s)}}var cn,ln={center:[0,0],linkDistance:50},fn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="mds",this.options=n(n({},ln),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericMDSLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericMDSLayout(!0,t,e),[2]}))}))},t.prototype.genericMDSLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,g,y;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=void 0===i?[0,0]:i,u=o.linkDistance,d=void 0===u?50:u,h=e.getAllNodes(),c=e.getAllEdges(),(null==h?void 0:h.length)&&1!==h.length?(l=v({nodes:h,edges:c},!1),f=p(l),gn(f),m=d,w=[],f.forEach((function(t){var e=[];t.forEach((function(t){e.push(t*m)})),w.push(e)})),g=pn(w),y=[],g.forEach((function(t,e){var r=b(h[e]);r.data.x=t[0]+s[0],r.data.y=t[1]+s[1],y.push(r)})),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:y,edges:c}]):[2,R(e,t,s)];var m,w}))}))},t}(),gn=function(t){var e=-999999;t.forEach((function(t){t.forEach((function(t){t!==1/0&&e<t&&(e=t)}))})),t.forEach((function(r,n){r.forEach((function(r,o){r===1/0&&(t[n][o]=e)}))}))},pn=function(t){var e=sn.mul(sn.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),o=e.mean();e.add(o).subRowVector(r).subColumnVector(n);var i=new hn(e),a=sn.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((function(t){return sn.mul([t],[a]).toJSON()[0].splice(0,2)}))},vn={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},yn=function(t,e,r,n,o,i){e.forEach((function(a,s){r[s]={x:0,y:0},e.forEach((function(e,u){if(s!==u&&o[s]===o[u]){var d=a.x-e.x,h=a.y-e.y,c=Math.sqrt(d*d+h*h);if(0===c){c=1;var l=s>u?1:-1;d=.01*l,h=.01*l}if(c<i(t[s])/2+i(t[u])/2){var f=n*n/c;r[s].x+=d/c*f,r[s].y+=h/c*f}}}))}))},mn=function(t,e,r,n,o,i,a,s){var u=i||a/10;return n&&e.forEach((function(e,r){var n=t[r].x-t[o].x,i=t[r].y-t[o].y,a=Math.sqrt(n*n+i*i),s=i/a,u=-n/a,d=Math.sqrt(e.x*e.x+e.y*e.y),h=Math.acos((s*e.x+u*e.y)/d);h>Math.PI/2&&(h-=Math.PI/2,s*=-1,u*=-1);var c=Math.cos(h)*d;e.x=s*c,e.y=u*c})),t.forEach((function(i,a){if(a!==o){var d=Math.sqrt(e[a].x*e[a].x+e[a].y*e[a].y);if(d>0&&a!==o){var h=Math.min(u*(r/800),d);if(i.x+=e[a].x/d*h,i.y+=e[a].y/d*h,n){var c=i.x-t[o].x,l=i.y-t[o].y,f=Math.sqrt(c*c+l*l);c=c/f*s[a],l=l/f*s[a],i.x=t[o].x+c,i.y=t[o].y+l}}}})),t},wn={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},xn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="radial",this.options=n(n({},wn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRadialLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRadialLayout(!0,t,e),[2]}))}))},t.prototype.genericRadialLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,d,h,c,l,f,g,y,m,w,x,E,N,M,S,k,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K,Y,J,X,Q,Z,tt,et;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,d=o.height,h=o.center,c=o.focusNode,l=o.unitRadius,f=o.nodeSize,g=o.nodeSpacing,y=o.strictRadial,m=o.preventOverlap,w=o.maxPreventOverlapIteration,x=o.sortBy,E=o.linkDistance,N=void 0===E?50:E,M=o.sortStrength,S=void 0===M?10:M,k=o.maxIteration,I=void 0===k?1e3:k,_=e.getAllNodes(),D=e.getAllEdges(),O=i||"undefined"==typeof window?i:window.innerWidth,T=d||"undefined"==typeof window?d:window.innerHeight,z=h||[O/2,T/2],!(null==_?void 0:_.length)||1===_.length)return[2,R(e,t,z)];if(C=_[0],P(c)){for(L=0;L<_.length;L++)if(_[L].id===c){C=_[L];break}}else C=c||_[0];return q=Nn(_,C.id),j=v({nodes:_,edges:D},!1),F=p(j),V=Sn(F,q),Mn(F,q,V+1),G=F[q],W=O-z[0]>z[0]?z[0]:O-z[0],B=T-z[1]>z[1]?z[1]:T-z[1],0===W&&(W=O/2),0===B&&(B=T/2),$=Math.min(W,B),U=Math.max.apply(Math,u([],s(G))),H=[],K=l||$/U,G.forEach((function(t,e){H[e]=t*K})),Y=En(_,F,N,H,K,x,S),J=bn(Y),X=function(t,e,r){try{var n=sn.mul(sn.pow(e,2),-.5),o=n.mean("row"),i=n.mean("column"),a=n.mean();n.add(a).subRowVector(o).subColumnVector(i);var s=new hn(n),u=sn.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((function(e){return sn.mul([e],[u]).toJSON()[0].splice(0,t)}))}catch(t){for(var d=[],h=0;h<e.length;h++){var c=Math.random()*r,l=Math.random()*r;d.push([c,l])}return d}}(N,Y,N),Q=X.map((function(t){var e=s(t,2),r=e[0],n=e[1];return{x:(isNaN(r)?Math.random()*N:r)-X[q][0],y:(isNaN(n)?Math.random()*N:n)-X[q][1]}})),this.run(I,Q,J,Y,H,q),m&&(Z=A(f,g),tt={nodes:_,nodeSizeFunc:Z,positions:Q,radii:H,height:T,width:O,strictRadial:Boolean(y),focusIdx:q,iterations:w||200,k:Q.length/4.5},Q=function(t,e){for(var r=n(n({},vn),e),o=r.positions,i=r.iterations,a=r.width,s=r.k,u=r.speed,d=void 0===u?100:u,h=r.strictRadial,c=r.focusIdx,l=r.radii,f=void 0===l?[]:l,g=r.nodeSizeFunc,p=t.getAllNodes(),v=[],y=a/10,m=0;m<i;m++)o.forEach((function(t,e){v[e]={x:0,y:0}})),yn(p,o,v,s,f,g),mn(o,v,d,h,c,y,a,f);return o}(e,tt)),et=[],Q.forEach((function(t,e){var r=b(_[e]);r.data.x=t.x+z[0],r.data.y=t.y+z[1],et.push(r)})),t&&et.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:et,edges:D}]}))}))},t.prototype.run=function(t,e,r,n,o,i){for(var a=0;a<=t;a++){var s=a/t;this.oneIteration(s,e,o,n,r,i)}},t.prototype.oneIteration=function(t,e,r,n,o,i){var a=1-t;e.forEach((function(s,u){var d=y(s,{x:0,y:0}),h=0===d?0:1/d;if(u!==i){var c=0,l=0,f=0;e.forEach((function(t,e){if(u!==e){var r=y(s,t),i=0===r?0:1/r,a=n[e][u];f+=o[u][e],c+=o[u][e]*(t.x+a*(s.x-t.x)*i),l+=o[u][e]*(t.y+a*(s.y-t.y)*i)}}));var g=0===r[u]?0:1/r[u];f*=a,f+=t*g*g,c*=a,c+=t*g*s.x*h,s.x=c/f,l*=a,l+=t*g*s.y*h,s.y=l/f}}))},t}(),En=function(t,e,r,n,o,i,a){if(!t)return[];var s=[];if(e){var u={};e.forEach((function(e,d){var h=[];e.forEach((function(e,s){var c,l;if(d===s)h.push(0);else if(n[d]===n[s])if("data"===i)h.push(e*(Math.abs(d-s)*a)/(n[d]/o));else if(i){var f=void 0,g=void 0;if(u[t[d].id])f=u[t[d].id];else{var p=("id"===i?t[d].id:null===(c=t[d].data)||void 0===c?void 0:c[i])||0;f=P(p)?p.charCodeAt(0):p,u[t[d].id]=f}u[t[s].id]?g=u[t[s].id]:(p=("id"===i?t[s].id:null===(l=t[s].data)||void 0===l?void 0:l[i])||0,g=P(p)?p.charCodeAt(0):p,u[t[s].id]=g),h.push(e*(Math.abs(f-g)*a)/(n[d]/o))}else h.push(e*r/(n[d]/o));else{var v=(r+o)/2;h.push(e*v)}})),s.push(h)}))}return s},bn=function(t){for(var e=t.length,r=t[0].length,n=[],o=0;o<e;o++){for(var i=[],a=0;a<r;a++)0!==t[o][a]?i.push(1/(t[o][a]*t[o][a])):i.push(0);n.push(i)}return n},Nn=function(t,e){var r=-1;return t.forEach((function(t,n){t.id===e&&(r=n)})),Math.max(r,0)},Mn=function(t,e,r){for(var n=t.length,o=0;o<n;o++)if(t[e][o]===1/0){t[e][o]=r,t[o][e]=r;for(var i=0;i<n;i++)t[o][i]!==1/0&&t[e][i]===1/0&&(t[e][i]=r+t[o][i],t[i][e]=r+t[o][i])}for(o=0;o<n;o++)if(o!==e)for(i=0;i<n;i++)if(t[o][i]===1/0){var a=Math.abs(t[e][o]-t[e][i]);a=0===a?1:a,t[o][i]=a}},Sn=function(t,e){for(var r=0,n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r},kn={center:[0,0],width:300,height:300},An=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="random",this.options=n(n({},kn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRandomLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRandomLayout(!0,t,e),[2]}))}))},t.prototype.genericRandomLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,d=e.getAllNodes(),h=s||"undefined"==typeof window?s:window.innerWidth,c=u||"undefined"==typeof window?u:window.innerHeight,l=i||[h/2,c/2],f=[],d&&d.forEach((function(t){f.push({id:t.id,data:{x:.9*(Math.random()-.5)*h+l[0],y:.9*(Math.random()-.5)*c+l[1]}})})),t&&f.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:f,edges:e.getAllEdges()}]}))}))},t}(),Rn={circular:_,concentric:z,mds:fn,random:An,grid:zr,radial:xn,force:xr,d3force:zt,fruchterman:Pr,forceAtlas2:Dr,dagre:pr};function In(){var t;(null===(t=cn)||void 0===t?void 0:t.stop)&&cn.stop()}function _n(t,e){return i(this,void 0,void 0,(function(){var r,n,o,i,s,u,d,h,c;return a(this,(function(a){switch(a.label){case 0:if(r=t.layout,n=r.id,o=r.options,i=r.iterations,s=t.nodes,u=t.edges,d=new l({nodes:s,edges:u}),!(h=Rn[n]))throw new Error("Unknown layout id: "+n);return[4,(cn=new h(o)).execute(d)];case 1:return c=a.sent(),!!(f=cn).tick&&!!f.stop&&(cn.stop(),c=cn.tick(i)),[2,[c,e]]}var f}))}))}addEventListener("message",(function(t){var r,n=t.data,o=n.type,i=n.method,a=n.id,s=n.params;"RPC"===o&&i&&((r=e[i])?Promise.resolve().then((function(){return r.apply(e,s)})):Promise.reject("No such method")).then((function(t){postMessage({type:"RPC",id:a,result:t})})).catch((function(t){var e={message:t};t.stack&&(e.message=t.message,e.stack=t.stack,e.name=t.name),postMessage({type:"RPC",id:a,error:e})}))})),postMessage({type:"RPC",method:"ready"});\n//# sourceMappingURL=11f9ed8e311b689f74d1.worker.js.map']))),f(m,w),m}},331:p=>{p.exports=function(h,a){var f=0,w={};h.addEventListener("message",function(m){var E=m.data;if(E.type==="RPC")if(E.id){var R=w[E.id];R&&(delete w[E.id],E.error?R[1](Object.assign(Error(E.error.message),E.error)):R[0](E.result))}else{var H=document.createEvent("Event");H.initEvent(E.method,!1,!1),H.data=E.params,h.dispatchEvent(H)}}),a.forEach(function(m){h[m]=function(){var E=arguments;return new Promise(function(R,H){var gt=++f;w[gt]=[R,H],h.postMessage({type:"RPC",id:gt,method:m,params:[].slice.call(E)})})}})}}},Bu={};function si(p){var h=Bu[p];if(h!==void 0)return h.exports;var a=Bu[p]={exports:{}};return oc[p](a,a.exports,si),a.exports}si.n=p=>{var h=p&&p.__esModule?()=>p.default:()=>p;return si.d(h,{a:h}),h},si.d=(p,h)=>{for(var a in h)si.o(h,a)&&!si.o(p,a)&&Object.defineProperty(p,a,{enumerable:!0,get:h[a]})},si.o=(p,h)=>Object.prototype.hasOwnProperty.call(p,h);var Zr={};(()=>{si.d(Zr,{SB:()=>Ye,W1:()=>In,jA:()=>he,Vq:()=>Da,E9:()=>Qo,y7:()=>Ta,O2:()=>na,Me:()=>ia,AI:()=>ko,D4:()=>jo,_5:()=>Ei,y9:()=>uo,_A:()=>Qt,d9:()=>at,ul:()=>zr,qs:()=>ze,gl:()=>Me,jE:()=>pn,tO:()=>De,zJ:()=>re,h$:()=>$e,BI:()=>Pr,$y:()=>Yn,H0:()=>qr,kJ:()=>Zt,hY:()=>Ss,qR:()=>zs,i_:()=>As,nu:()=>ir,He:()=>be,A3:()=>br});var p=function(d,o){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])},p(d,o)};function h(d,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function t(){this.constructor=d}p(d,o),d.prototype=o===null?Object.create(o):(t.prototype=o.prototype,new t)}var a=function(){return a=Object.assign||function(d){for(var o,t=1,r=arguments.length;t<r;t++)for(var s in o=arguments[t])Object.prototype.hasOwnProperty.call(o,s)&&(d[s]=o[s]);return d},a.apply(this,arguments)};function f(d,o){var t={};for(var r in d)Object.prototype.hasOwnProperty.call(d,r)&&o.indexOf(r)<0&&(t[r]=d[r]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function"){var s=0;for(r=Object.getOwnPropertySymbols(d);s<r.length;s++)o.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(d,r[s])&&(t[r[s]]=d[r[s]])}return t}function w(d,o,t,r){return new(t||(t=Promise))(function(s,l){function y(A){try{N(r.next(A))}catch(_){l(_)}}function b(A){try{N(r.throw(A))}catch(_){l(_)}}function N(A){var _;A.done?s(A.value):(_=A.value,_ instanceof t?_:new t(function(F){F(_)})).then(y,b)}N((r=r.apply(d,o||[])).next())})}function m(d,o){var t,r,s,l,y={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return l={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function b(N){return function(A){return function(_){if(t)throw new TypeError("Generator is already executing.");for(;l&&(l=0,_[0]&&(y=0)),y;)try{if(t=1,r&&(s=2&_[0]?r.return:_[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,_[1])).done)return s;switch(r=0,s&&(_=[2&_[0],s.value]),_[0]){case 0:case 1:s=_;break;case 4:return y.label++,{value:_[1],done:!1};case 5:y.label++,r=_[1],_=[0];continue;case 7:_=y.ops.pop(),y.trys.pop();continue;default:if(!((s=(s=y.trys).length>0&&s[s.length-1])||_[0]!==6&&_[0]!==2)){y=0;continue}if(_[0]===3&&(!s||_[1]>s[0]&&_[1]<s[3])){y.label=_[1];break}if(_[0]===6&&y.label<s[1]){y.label=s[1],s=_;break}if(s&&y.label<s[2]){y.label=s[2],y.ops.push(_);break}s[2]&&y.ops.pop(),y.trys.pop();continue}_=o.call(d,y)}catch(F){_=[6,F],r=0}finally{t=s=0}if(5&_[0])throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}([N,A])}}}function E(d,o){var t=typeof Symbol=="function"&&d[Symbol.iterator];if(!t)return d;var r,s,l=t.call(d),y=[];try{for(;(o===void 0||o-- >0)&&!(r=l.next()).done;)y.push(r.value)}catch(b){s={error:b}}finally{try{r&&!r.done&&(t=l.return)&&t.call(l)}finally{if(s)throw s.error}}return y}function R(d,o,t){if(t||arguments.length===2)for(var r,s=0,l=o.length;s<l;s++)!r&&s in o||(r||(r=Array.prototype.slice.call(o,0,s)),r[s]=o[s]);return d.concat(r||Array.prototype.slice.call(o))}var H,gt,Ut=/-(\w)/g,Qt=(H=function(d){return d.replace(Ut,function(o,t){return t?t.toUpperCase():""})},gt=Object.create(null),function(d){return gt[d]||(gt[d]=H(d))}),Zt=Array.isArray,be=function(d){var o=parseFloat(d);return isNaN(o)?d:o},ie={}.toString;const Ze=function(d,o){return ie.call(d)==="[object "+o+"]"},me=function(d){return Ze(d,"Number")};var ze=function(d){for(var o=[],t=d.length,r=0;r<t;r+=1){o[r]=[];for(var s=0;s<t;s+=1)r===s?o[r][s]=0:d[r][s]!==0&&d[r][s]?o[r][s]=d[r][s]:o[r][s]=1/0}for(var l=0;l<t;l+=1)for(r=0;r<t;r+=1)for(s=0;s<t;s+=1)o[r][s]>o[r][l]+o[l][s]&&(o[r][s]=o[r][l]+o[l][s]);return o},re=function(d,o){var t=d.nodes,r=d.edges,s=[],l={};if(!t)throw new Error("invalid nodes data!");return t&&t.forEach(function(y,b){l[y.id]=b,s.push([])}),r==null||r.forEach(function(y){var b=y.source,N=y.target,A=l[b],_=l[N];A!==void 0&&_!==void 0&&(s[A][_]=1,o||(s[_][A]=1))}),s},ir=function(d,o){var t=[];return d.forEach(function(r){var s=[];r.forEach(function(l){s.push(l*o)}),t.push(s)}),t},sr=function(d,o){if(d&&d.children){for(var t=d.children.length-1;t>=0;t--)if(!sr(d.children[t],o))return}return!!o(d)},br=function(d,o){typeof o=="function"&&sr(d,o)},qr=function(d){var o=1/0,t=1/0,r=-1/0,s=-1/0;return d.forEach(function(l){var y=l.data.size;Zt(y)?y.length===1&&(y=[y[0],y[0]]):me(y)?y=[y,y]:(y===void 0||isNaN(y))&&(y=[30,30]);var b=[y[0]/2,y[1]/2],N=l.data.x-b[0],A=l.data.x+b[0],_=l.data.y-b[1],F=l.data.y+b[1];o>N&&(o=N),t>_&&(t=_),r<A&&(r=A),s<F&&(s=F)}),{minX:o,minY:t,maxX:r,maxY:s}},$e=function(d){var o={x:0,y:0};d.forEach(function(r){o.x+=r.data.x||0,o.y+=r.data.y||0});var t=d.length||1;return{x:o.x/t,y:o.y/t}},Xe=function(d,o,t){var r,s;return d==="source"?((r=t==null?void 0:t.find(function(l){return l.target===o.id}))===null||r===void 0?void 0:r.source)||{}:((s=t==null?void 0:t.find(function(l){return l.source===o.id}))===null||s===void 0?void 0:s.target)||{}},le=function(d,o,t){var r=[];switch(d){case"source":r=t==null?void 0:t.filter(function(l){return l.source===o.id}).map(function(l){return l.target});break;case"target":r=t==null?void 0:t.filter(function(l){return l.target===o.id}).map(function(l){return l.source});break;case"both":r=t==null?void 0:t.filter(function(l){return l.source===o.id}).map(function(l){return l.target}).concat(t==null?void 0:t.filter(function(l){return l.target===o.id}).map(function(l){return l.source}))}var s=new Set(r);return Array.from(s)},Pr=function(d,o,t,r,s,l){var y=s[o.id],b=y.in,N=y.out,A=o,_=[];b===0?(A=Xe("source",o,t),_=le("both",A,t).map(function(tt){return l[tt]})):N===0&&(A=Xe("target",o,t),_=le("both",A,t).map(function(tt){return l[tt]})),_=_.filter(function(tt){return s[tt.id]&&(s[tt.id].in===0||s[tt.id].out===0)});var F=function(tt,$,q,L,rt){var nt=q[$]||"",ct=(L==null?void 0:L.filter(function(Jt){return Jt[$]===nt}))||[];return tt==="leaf"&&(ct=ct.filter(function(Jt){var Yt,zt;return((Yt=rt[Jt.id])===null||Yt===void 0?void 0:Yt.in)===0||((zt=rt[Jt.id])===null||zt===void 0?void 0:zt.out)===0})),ct}(d,r,o,_,s);return{coreNode:A,relativeLeafNodes:_,sameTypeLeafNodes:F}},Yn=function(d,o){return Math.sqrt((d.x-o.x)*(d.x-o.x)+(d.y-o.y)*(d.y-o.y))},at=function(d){if(d===null)return d;if(d instanceof Date)return new Date(d.getTime());if(d instanceof Array){var o=[];return d.forEach(function(r){o.push(r)}),o.map(function(r){return at(r)})}if(typeof d=="object"){var t={};return Object.keys(d).forEach(function(r){t[r]=at(d[r])}),t}return d},zr=function(d,o){var t=at(d);return t.data=t.data||{},o&&(me(t.data.x)||(t.data.x=Math.random()*o[0]),me(t.data.y)||(t.data.y=Math.random()*o[1])),t};const Gr=function(d){return typeof d=="function"},dn=function(d){var o=typeof d;return d!==null&&o==="object"||o==="function"};function pn(d,o){return Gr(o)?o:me(o)?function(){return o}:function(){return d}}function De(d,o,t){return t===void 0&&(t=!0),o||o===0?Gr(o)?o:me(o)?function(){return o}:Zt(o)?function(){if(t){var r=Math.max.apply(Math,R([],E(o)));return isNaN(r)?d:r}return o}:dn(o)?function(){if(t){var r=Math.max(o.width,o.height);return isNaN(r)?d:r}return[o.width,o.height]}:function(){return d}:function(r){var s=(r.data||{}).size;return s?Zt(s)?s[0]>s[1]?s[0]:s[1]:dn(s)?s.width>s.height?s.width:s.height:s:d}}var Me=function(d,o){var t;return t=me(o)?function(){return o}:Gr(o)?o:function(){return 0},d?Zt(d)?function(r){return(d[0]>d[1]?d[0]:d[1])+t(r)}:function(r){return d+t(r)}:function(r){var s,l;if(!((s=r.data)===null||s===void 0)&&s.bboxSize)return Math.max(r.data.bboxSize[0],r.data.bboxSize[1])+t(r);if(!((l=r.data)===null||l===void 0)&&l.size){if(Zt(r.data.size))return Math.max(r.data.size[0],r.data.size[1])+t(r);var y=r.data.size;return dn(y)?(y.width>y.height?y.width:y.height)+t(r):y+t(r)}return 10+t(r)}},Ce=function(d,o,t){var r=d.getAllNodes(),s=d.getAllEdges();return r!=null&&r.length?r.length===1?(o&&d.mergeNodeData(r[0].id,{x:t[0],y:t[1]}),{nodes:[a(a({},r[0]),{data:a(a({},r[0].data),{x:t[0],y:t[1]})})],edges:s}):void 0:{nodes:[],edges:s}},mr={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},Ye=function(){function d(o){o===void 0&&(o={}),this.options=o,this.id="circular",this.options=a(a({},mr),o)}return d.prototype.execute=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return[2,this.genericCircularLayout(!1,o,t)]})})},d.prototype.assign=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){switch(r.label){case 0:return[4,this.genericCircularLayout(!0,o,t)];case 1:return r.sent(),[2]}})})},d.prototype.genericCircularLayout=function(o,t,r){return w(this,void 0,void 0,function(){var s,l,y,b,N,A,_,F,tt,$,q,L,rt,nt,ct,Jt,Yt,zt,bt,Ot,Xt,Wt,Z,wt,$t,Dt,ve,ge,ce,Ne,ke,xe,Le,Be,Ge;return m(this,function(de){if(s=a(a({},this.options),r),l=s.width,y=s.height,b=s.center,N=s.divisions,A=s.startAngle,_=A===void 0?0:A,F=s.endAngle,tt=F===void 0?2*Math.PI:F,$=s.angleRatio,q=s.ordering,L=s.clockwise,rt=s.nodeSpacing,nt=s.nodeSize,ct=t.getAllNodes(),Jt=t.getAllEdges(),Yt=E(Or(l,y,b),3),zt=Yt[0],bt=Yt[1],Ot=Yt[2],!(Xt=ct==null?void 0:ct.length)||Xt===1)return[2,Ce(t,o,Ot)];for(Wt=(tt-_)/Xt,Z=s.radius,wt=s.startRadius,$t=s.endRadius,rt?(Dt=pn(10,rt),ve=De(10,nt),ge=-1/0,ct.forEach(function(Fe){var er=ve(Fe);ge<er&&(ge=er)}),ce=0,ct.forEach(function(Fe,er){ce+=er===0?ge||10:(Dt(Fe)||0)+(ge||10)}),Z=ce/(2*Math.PI)):Z||wt||$t?!wt&&$t?wt=$t:wt&&!$t&&($t=wt):Z=Math.min(bt,zt)/2,Ne=Wt*$,ke=[],ke=q==="topology"?Ar(t,ct):q==="topology-directed"?Ar(t,ct,!0):q==="degree"?function(Fe,er){var je=[];return er.forEach(function(we,lr){je.push(zr(we))}),je.sort(function(we,lr){return Fe.getDegree(we.id,"both")-Fe.getDegree(lr.id,"both")}),je}(t,ct):ct.map(function(Fe){return zr(Fe)}),xe=Math.ceil(Xt/N),Le=0;Le<Xt;++Le)(Be=Z)||wt===null||$t===null||(Be=wt+Le*($t-wt)/(Xt-1)),Be||(Be=10+100*Le/(Xt-1)),Ge=_+Le%xe*Ne+2*Math.PI/N*Math.floor(Le/xe),L||(Ge=tt-Le%xe*Ne-2*Math.PI/N*Math.floor(Le/xe)),ke[Le].data.x=Ot[0]+Math.cos(Ge)*Be,ke[Le].data.y=Ot[1]+Math.sin(Ge)*Be;return o&&ke.forEach(function(Fe){t.mergeNodeData(Fe.id,{x:Fe.data.x,y:Fe.data.y})}),[2,{nodes:ke,edges:Jt}]})})},d}(),Ar=function(d,o,t){t===void 0&&(t=!1);var r=[zr(o[0])],s={},l=o.length;s[o[0].id]=!0;var y=0;return o.forEach(function(b,N){if(N!==0)if(N!==l-1&&d.getDegree(b.id,"both")===d.getDegree(o[N+1].id,"both")&&!d.areNeighbors(r[y].id,b.id)||s[b.id]){for(var A=t?d.getSuccessors(r[y].id):d.getNeighbors(r[y].id),_=!1,F=0;F<A.length;F++){var tt=A[F];if(d.getDegree(tt.id)===d.getDegree(b.id)&&!s[tt.id]){r.push(zr(tt)),s[tt.id]=!0,_=!0;break}}for(var $=0;!_&&(s[o[$].id]||(r.push(zr(o[$])),s[o[$].id]=!0,_=!0),++$!==l););}else r.push(zr(b)),s[b.id]=!0,y++}),r},Or=function(d,o,t){var r=d,s=o,l=t;return r||typeof window>"u"||(r=window.innerWidth),s||typeof window>"u"||(s=window.innerHeight),l||(l=[r/2,s/2]),[r,s,l]},Sr=si(913),kn=si.n(Sr),oo=si(617),Fr=si.n(oo),uo=function(d){function o(t,r,s){var l=d.call(this)||this;return l.graph=t,l.layout=r,l.options=s,l.spawnWorker(),l}return h(o,d),o.prototype.spawnWorker=function(){this.worker&&this.worker.terminate(),this.worker=Fr()(),this.running&&(this.running=!1,this.execute())},o.prototype.execute=function(){var t;return w(this,void 0,void 0,function(){var r,s,l,y;return m(this,function(b){switch(b.label){case 0:return this.running?[2,this]:(this.running=!0,(r=this.layout.options).onTick,s=f(r,["onTick"]),l={layout:{id:this.layout.id,options:s,iterations:(t=this.options)===null||t===void 0?void 0:t.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},y=new Float32Array([0]),[4,this.worker.calculateLayout(l,[y])]);case 1:return[2,E.apply(void 0,[b.sent(),1])[0]]}})})},o.prototype.stop=function(){return this.running=!1,this.worker.stopLayout(),this},o.prototype.kill=function(){this.worker&&this.worker.terminate()},o.prototype.isRunning=function(){return this.running},o}(kn());const Vn=function(d){return Ze(d,"String")};var Vo={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},In=function(){function d(o){o===void 0&&(o={}),this.options=o,this.id="concentric",this.options=a(a({},Vo),o)}return d.prototype.execute=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return[2,this.genericConcentricLayout(!1,o,t)]})})},d.prototype.assign=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return this.genericConcentricLayout(!0,o,t),[2]})})},d.prototype.genericConcentricLayout=function(o,t,r){return w(this,void 0,void 0,function(){var s,l,y,b,N,A,_,F,tt,$,q,L,rt,nt,ct,Jt,Yt,zt,bt,Ot,Xt,Wt,Z,wt,$t,Dt,ve,ge,ce,Ne,ke,xe,Le,Be,Ge,de,Fe,er;return m(this,function(je){if(s=a(a({},this.options),r),l=s.center,y=s.width,b=s.height,N=s.sortBy,A=s.maxLevelDiff,_=s.sweep,F=s.clockwise,tt=s.equidistant,$=s.preventOverlap,q=s.startAngle,L=q===void 0?1.5*Math.PI:q,rt=s.nodeSize,nt=s.nodeSpacing,ct=t.getAllNodes(),Jt=t.getAllEdges(),Yt=y||typeof window>"u"?y:window.innerWidth,zt=b||typeof window>"u"?b:window.innerHeight,bt=l||[Yt/2,zt/2],!(ct!=null&&ct.length)||ct.length===1)return[2,Ce(t,o,bt)];if(Ot=[],Wt=0,Xt=Zt(rt)?Math.max(rt[0],rt[1]):rt,Zt(nt)?Wt=Math.max(nt[0],nt[1]):me(nt)&&(Wt=nt),ct.forEach(function(we){var lr=zr(we);Ot.push(lr);var tn=Xt,Ir=lr.data;Zt(Ir.size)?tn=Math.max(Ir.size[0],Ir.size[1]):me(Ir.size)?tn=Ir.size:dn(Ir.size)&&(tn=Math.max(Ir.size.width,Ir.size.height)),Xt=Math.max(Xt,tn),Gr(nt)&&(Wt=Math.max(nt(we),Wt))}),Z={},Ot.forEach(function(we,lr){Z[we.id]=lr}),Vn(wt=N)&&Ot[0].data[wt]!==void 0||(wt="degree"),wt==="degree"?Ot.sort(function(we,lr){return t.getDegree(lr.id,"both")-t.getDegree(we.id,"both")}):Ot.sort(function(we,lr){return lr.data[wt]-we.data[wt]}),$t=Ot[0],Dt=(A||(wt==="degree"?t.getDegree($t.id,"both"):$t.data[wt]))/4,ge=(ve=[{nodes:[]}])[0],Ot.forEach(function(we){if(ge.nodes.length>0){var lr=Math.abs(wt==="degree"?t.getDegree(ge.nodes[0].id,"both")-t.getDegree(we.id,"both"):ge.nodes[0].data[wt]-we.data[wt]);Dt&&lr>=Dt&&(ge={nodes:[]},ve.push(ge))}ge.nodes.push(we)}),ce=Xt+Wt,$||(Ne=ve.length>0&&ve[0].nodes.length>1,ke=Math.min(Yt,zt)/2-ce,xe=ke/(ve.length+(Ne?1:0)),ce=Math.min(ce,xe)),Le=0,ve.forEach(function(we){var lr=_===void 0?2*Math.PI-2*Math.PI/we.nodes.length:_;if(we.dTheta=lr/Math.max(1,we.nodes.length-1),we.nodes.length>1&&$){var tn=Math.cos(we.dTheta)-Math.cos(0),Ir=Math.sin(we.dTheta)-Math.sin(0),ro=Math.sqrt(ce*ce/(tn*tn+Ir*Ir));Le=Math.max(ro,Le)}we.r=Le,Le+=ce}),tt){for(Be=0,Ge=0,de=0;de<ve.length;de++)Fe=ve[de],er=(Fe.r||0)-Ge,Be=Math.max(Be,er);Ge=0,ve.forEach(function(we,lr){lr===0&&(Ge=we.r||0),we.r=Ge,Ge+=Be})}return ve.forEach(function(we){var lr=we.dTheta||0,tn=we.r||0;we.nodes.forEach(function(Ir,ro){var Tr=L+(F?1:-1)*lr*ro;Ir.data.x=bt[0]+tn*Math.cos(Tr),Ir.data.y=bt[1]+tn*Math.sin(Tr)})}),o&&Ot.forEach(function(we){return t.mergeNodeData(we.id,{x:we.data.x,y:we.data.y})}),[2,{nodes:Ot,edges:Jt}]})})},d}();function Mn(d,o,t,r){if(isNaN(o)||isNaN(t))return d;var s,l,y,b,N,A,_,F,tt,$=d._root,q={data:r},L=d._x0,rt=d._y0,nt=d._x1,ct=d._y1;if(!$)return d._root=q,d;for(;$.length;)if((A=o>=(l=(L+nt)/2))?L=l:nt=l,(_=t>=(y=(rt+ct)/2))?rt=y:ct=y,s=$,!($=$[F=_<<1|A]))return s[F]=q,d;if(b=+d._x.call(null,$.data),N=+d._y.call(null,$.data),o===b&&t===N)return q.next=$,s?s[F]=q:d._root=q,d;do s=s?s[F]=new Array(4):d._root=new Array(4),(A=o>=(l=(L+nt)/2))?L=l:nt=l,(_=t>=(y=(rt+ct)/2))?rt=y:ct=y;while((F=_<<1|A)==(tt=(N>=y)<<1|b>=l));return s[tt]=$,s[F]=q,d}function Dr(d,o,t,r,s){this.node=d,this.x0=o,this.y0=t,this.x1=r,this.y1=s}function Ni(d){return d[0]}function ds(d){return d[1]}function qi(d,o,t){var r=new Wi(o==null?Ni:o,t==null?ds:t,NaN,NaN,NaN,NaN);return d==null?r:r.addAll(d)}function Wi(d,o,t,r,s,l){this._x=d,this._y=o,this._x0=t,this._y0=r,this._x1=s,this._y1=l,this._root=void 0}function qo(d){for(var o={data:d.data},t=o;d=d.next;)t=t.next={data:d.data};return o}var Ln=qi.prototype=Wi.prototype;function Pn(d){return function(){return d}}function Eo(d){return 1e-6*(d()-.5)}Ln.copy=function(){var d,o,t=new Wi(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return t;if(!r.length)return t._root=qo(r),t;for(d=[{source:r,target:t._root=new Array(4)}];r=d.pop();)for(var s=0;s<4;++s)(o=r.source[s])&&(o.length?d.push({source:o,target:r.target[s]=new Array(4)}):r.target[s]=qo(o));return t},Ln.add=function(d){const o=+this._x.call(null,d),t=+this._y.call(null,d);return Mn(this.cover(o,t),o,t,d)},Ln.addAll=function(d){var o,t,r,s,l=d.length,y=new Array(l),b=new Array(l),N=1/0,A=1/0,_=-1/0,F=-1/0;for(t=0;t<l;++t)isNaN(r=+this._x.call(null,o=d[t]))||isNaN(s=+this._y.call(null,o))||(y[t]=r,b[t]=s,r<N&&(N=r),r>_&&(_=r),s<A&&(A=s),s>F&&(F=s));if(N>_||A>F)return this;for(this.cover(N,A).cover(_,F),t=0;t<l;++t)Mn(this,y[t],b[t],d[t]);return this},Ln.cover=function(d,o){if(isNaN(d=+d)||isNaN(o=+o))return this;var t=this._x0,r=this._y0,s=this._x1,l=this._y1;if(isNaN(t))s=(t=Math.floor(d))+1,l=(r=Math.floor(o))+1;else{for(var y,b,N=s-t||1,A=this._root;t>d||d>=s||r>o||o>=l;)switch(b=(o<r)<<1|d<t,(y=new Array(4))[b]=A,A=y,N*=2,b){case 0:s=t+N,l=r+N;break;case 1:t=s-N,l=r+N;break;case 2:s=t+N,r=l-N;break;case 3:t=s-N,r=l-N}this._root&&this._root.length&&(this._root=A)}return this._x0=t,this._y0=r,this._x1=s,this._y1=l,this},Ln.data=function(){var d=[];return this.visit(function(o){if(!o.length)do d.push(o.data);while(o=o.next)}),d},Ln.extent=function(d){return arguments.length?this.cover(+d[0][0],+d[0][1]).cover(+d[1][0],+d[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Ln.find=function(d,o,t){var r,s,l,y,b,N,A,_=this._x0,F=this._y0,tt=this._x1,$=this._y1,q=[],L=this._root;for(L&&q.push(new Dr(L,_,F,tt,$)),t==null?t=1/0:(_=d-t,F=o-t,tt=d+t,$=o+t,t*=t);N=q.pop();)if(!(!(L=N.node)||(s=N.x0)>tt||(l=N.y0)>$||(y=N.x1)<_||(b=N.y1)<F))if(L.length){var rt=(s+y)/2,nt=(l+b)/2;q.push(new Dr(L[3],rt,nt,y,b),new Dr(L[2],s,nt,rt,b),new Dr(L[1],rt,l,y,nt),new Dr(L[0],s,l,rt,nt)),(A=(o>=nt)<<1|d>=rt)&&(N=q[q.length-1],q[q.length-1]=q[q.length-1-A],q[q.length-1-A]=N)}else{var ct=d-+this._x.call(null,L.data),Jt=o-+this._y.call(null,L.data),Yt=ct*ct+Jt*Jt;if(Yt<t){var zt=Math.sqrt(t=Yt);_=d-zt,F=o-zt,tt=d+zt,$=o+zt,r=L.data}}return r},Ln.remove=function(d){if(isNaN(l=+this._x.call(null,d))||isNaN(y=+this._y.call(null,d)))return this;var o,t,r,s,l,y,b,N,A,_,F,tt,$=this._root,q=this._x0,L=this._y0,rt=this._x1,nt=this._y1;if(!$)return this;if($.length)for(;;){if((A=l>=(b=(q+rt)/2))?q=b:rt=b,(_=y>=(N=(L+nt)/2))?L=N:nt=N,o=$,!($=$[F=_<<1|A]))return this;if(!$.length)break;(o[F+1&3]||o[F+2&3]||o[F+3&3])&&(t=o,tt=F)}for(;$.data!==d;)if(r=$,!($=$.next))return this;return(s=$.next)&&delete $.next,r?(s?r.next=s:delete r.next,this):o?(s?o[F]=s:delete o[F],($=o[0]||o[1]||o[2]||o[3])&&$===(o[3]||o[2]||o[1]||o[0])&&!$.length&&(t?t[tt]=$:this._root=$),this):(this._root=s,this)},Ln.removeAll=function(d){for(var o=0,t=d.length;o<t;++o)this.remove(d[o]);return this},Ln.root=function(){return this._root},Ln.size=function(){var d=0;return this.visit(function(o){if(!o.length)do++d;while(o=o.next)}),d},Ln.visit=function(d){var o,t,r,s,l,y,b=[],N=this._root;for(N&&b.push(new Dr(N,this._x0,this._y0,this._x1,this._y1));o=b.pop();)if(!d(N=o.node,r=o.x0,s=o.y0,l=o.x1,y=o.y1)&&N.length){var A=(r+l)/2,_=(s+y)/2;(t=N[3])&&b.push(new Dr(t,A,_,l,y)),(t=N[2])&&b.push(new Dr(t,r,_,A,y)),(t=N[1])&&b.push(new Dr(t,A,s,l,_)),(t=N[0])&&b.push(new Dr(t,r,s,A,_))}return this},Ln.visitAfter=function(d){var o,t=[],r=[];for(this._root&&t.push(new Dr(this._root,this._x0,this._y0,this._x1,this._y1));o=t.pop();){var s=o.node;if(s.length){var l,y=o.x0,b=o.y0,N=o.x1,A=o.y1,_=(y+N)/2,F=(b+A)/2;(l=s[0])&&t.push(new Dr(l,y,b,_,F)),(l=s[1])&&t.push(new Dr(l,_,b,N,F)),(l=s[2])&&t.push(new Dr(l,y,F,_,A)),(l=s[3])&&t.push(new Dr(l,_,F,N,A))}r.push(o)}for(;o=r.pop();)d(o.node,o.x0,o.y0,o.x1,o.y1);return this},Ln.x=function(d){return arguments.length?(this._x=d,this):this._x},Ln.y=function(d){return arguments.length?(this._y=d,this):this._y};var cs={value:()=>{}};function hs(){for(var d,o=0,t=arguments.length,r={};o<t;++o){if(!(d=arguments[o]+"")||d in r||/[\s.]/.test(d))throw new Error("illegal type: "+d);r[d]=[]}return new di(r)}function di(d){this._=d}function xa(d,o){for(var t,r=0,s=d.length;r<s;++r)if((t=d[r]).name===o)return t.value}function Co(d,o,t){for(var r=0,s=d.length;r<s;++r)if(d[r].name===o){d[r]=cs,d=d.slice(0,r).concat(d.slice(r+1));break}return t!=null&&d.push({name:o,value:t}),d}di.prototype=hs.prototype={constructor:di,on:function(d,o){var t,r,s=this._,l=(r=s,(d+"").trim().split(/^|\s+/).map(function(N){var A="",_=N.indexOf(".");if(_>=0&&(A=N.slice(_+1),N=N.slice(0,_)),N&&!r.hasOwnProperty(N))throw new Error("unknown type: "+N);return{type:N,name:A}})),y=-1,b=l.length;if(!(arguments.length<2)){if(o!=null&&typeof o!="function")throw new Error("invalid callback: "+o);for(;++y<b;)if(t=(d=l[y]).type)s[t]=Co(s[t],d.name,o);else if(o==null)for(t in s)s[t]=Co(s[t],d.name,null);return this}for(;++y<b;)if((t=(d=l[y]).type)&&(t=xa(s[t],d.name)))return t},copy:function(){var d={},o=this._;for(var t in o)d[t]=o[t].slice();return new di(d)},call:function(d,o){if((t=arguments.length-2)>0)for(var t,r,s=new Array(t),l=0;l<t;++l)s[l]=arguments[l+2];if(!this._.hasOwnProperty(d))throw new Error("unknown type: "+d);for(l=0,t=(r=this._[d]).length;l<t;++l)r[l].value.apply(o,s)},apply:function(d,o,t){if(!this._.hasOwnProperty(d))throw new Error("unknown type: "+d);for(var r=this._[d],s=0,l=r.length;s<l;++s)r[s].value.apply(o,t)}};const ba=hs;var Mi,Lo,xo=0,Do=0,$i=0,Ai=1e3,Si=0,ho=0,_i=0,bo=typeof performance=="object"&&performance.now?performance:Date,qa=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(d){setTimeout(d,17)};function Wo(){return ho||(qa(Wa),ho=bo.now()+_i)}function Wa(){ho=0}function $a(){this._call=this._time=this._next=null}function ls(d,o,t){var r=new $a;return r.restart(d,o,t),r}function Hi(){ho=(Si=bo.now())+_i,xo=Do=0;try{(function(){Wo(),++xo;for(var d,o=Mi;o;)(d=ho-o._time)>=0&&o._call.call(void 0,d),o=o._next;--xo})()}finally{xo=0,function(){for(var d,o,t=Mi,r=1/0;t;)t._call?(r>t._time&&(r=t._time),d=t,t=t._next):(o=t._next,t._next=null,t=d?d._next=o:Mi=o);Lo=d,Na(r)}(),ho=0}}function Ha(){var d=bo.now(),o=d-Si;o>Ai&&(_i-=o,Si=d)}function Na(d){xo||(Do&&(Do=clearTimeout(Do)),d-ho>24?(d<1/0&&(Do=setTimeout(Hi,d-bo.now()-_i)),$i&&($i=clearInterval($i))):($i||(Si=bo.now(),$i=setInterval(Ha,Ai)),xo=1,qa(Hi)))}$a.prototype=ls.prototype={constructor:$a,restart:function(d,o,t){if(typeof d!="function")throw new TypeError("callback is not a function");t=(t==null?Wo():+t)+(o==null?0:+o),this._next||Lo===this||(Lo?Lo._next=this:Mi=this,Lo=this),this._call=d,this._time=t,Na()},stop:function(){this._call&&(this._call=null,this._time=1/0,Na())}};const ci=1664525,An=1013904223,Xa=4294967296;function Os(d){return d.x}function No(d){return d.y}var Ma=10,Aa=Math.PI*(3-Math.sqrt(5));function qn(d){var o,t=1,r=.001,s=1-Math.pow(r,1/300),l=0,y=.6,b=new Map,N=ls(F),A=ba("tick","end"),_=function(){let L=1;return()=>(L=(ci*L+An)%Xa)/Xa}();function F(){tt(),A.call("tick",o),t<r&&(N.stop(),A.call("end",o))}function tt(L){var rt,nt,ct=d.length;L===void 0&&(L=1);for(var Jt=0;Jt<L;++Jt)for(t+=(l-t)*s,b.forEach(function(Yt){Yt(t)}),rt=0;rt<ct;++rt)(nt=d[rt]).fx==null?nt.x+=nt.vx*=y:(nt.x=nt.fx,nt.vx=0),nt.fy==null?nt.y+=nt.vy*=y:(nt.y=nt.fy,nt.vy=0);return o}function $(){for(var L,rt=0,nt=d.length;rt<nt;++rt){if((L=d[rt]).index=rt,L.fx!=null&&(L.x=L.fx),L.fy!=null&&(L.y=L.fy),isNaN(L.x)||isNaN(L.y)){var ct=Ma*Math.sqrt(.5+rt),Jt=rt*Aa;L.x=ct*Math.cos(Jt),L.y=ct*Math.sin(Jt)}(isNaN(L.vx)||isNaN(L.vy))&&(L.vx=L.vy=0)}}function q(L){return L.initialize&&L.initialize(d,_),L}return d==null&&(d=[]),$(),o={tick:tt,restart:function(){return N.restart(F),o},stop:function(){return N.stop(),o},nodes:function(L){return arguments.length?(d=L,$(),b.forEach(q),o):d},alpha:function(L){return arguments.length?(t=+L,o):t},alphaMin:function(L){return arguments.length?(r=+L,o):r},alphaDecay:function(L){return arguments.length?(s=+L,o):+s},alphaTarget:function(L){return arguments.length?(l=+L,o):l},velocityDecay:function(L){return arguments.length?(y=1-L,o):1-y},randomSource:function(L){return arguments.length?(_=L,b.forEach(q),o):_},force:function(L,rt){return arguments.length>1?(rt==null?b.delete(L):b.set(L,q(rt)),o):b.get(L)},find:function(L,rt,nt){var ct,Jt,Yt,zt,bt,Ot=0,Xt=d.length;for(nt==null?nt=1/0:nt*=nt,Ot=0;Ot<Xt;++Ot)(Yt=(ct=L-(zt=d[Ot]).x)*ct+(Jt=rt-zt.y)*Jt)<nt&&(bt=zt,nt=Yt);return bt},on:function(L,rt){return arguments.length>1?(A.on(L,rt),o):A.on(L)}}}function Sa(){var d,o,t,r,s,l=Pn(-30),y=1,b=1/0,N=.81;function A($){var q,L=d.length,rt=qi(d,Os,No).visitAfter(F);for(r=$,q=0;q<L;++q)o=d[q],rt.visit(tt)}function _(){if(d){var $,q,L=d.length;for(s=new Array(L),$=0;$<L;++$)q=d[$],s[q.index]=+l(q,$,d)}}function F($){var q,L,rt,nt,ct,Jt=0,Yt=0;if($.length){for(rt=nt=ct=0;ct<4;++ct)(q=$[ct])&&(L=Math.abs(q.value))&&(Jt+=q.value,Yt+=L,rt+=L*q.x,nt+=L*q.y);$.x=rt/Yt,$.y=nt/Yt}else{(q=$).x=q.data.x,q.y=q.data.y;do Jt+=s[q.data.index];while(q=q.next)}$.value=Jt}function tt($,q,L,rt){if(!$.value)return!0;var nt=$.x-o.x,ct=$.y-o.y,Jt=rt-q,Yt=nt*nt+ct*ct;if(Jt*Jt/N<Yt)return Yt<b&&(nt===0&&(Yt+=(nt=Eo(t))*nt),ct===0&&(Yt+=(ct=Eo(t))*ct),Yt<y&&(Yt=Math.sqrt(y*Yt)),o.vx+=nt*$.value*r/Yt,o.vy+=ct*$.value*r/Yt),!0;if(!($.length||Yt>=b)){($.data!==o||$.next)&&(nt===0&&(Yt+=(nt=Eo(t))*nt),ct===0&&(Yt+=(ct=Eo(t))*ct),Yt<y&&(Yt=Math.sqrt(y*Yt)));do $.data!==o&&(Jt=s[$.data.index]*r/Yt,o.vx+=nt*Jt,o.vy+=ct*Jt);while($=$.next)}}return A.initialize=function($,q){d=$,t=q,_()},A.strength=function($){return arguments.length?(l=typeof $=="function"?$:Pn(+$),_(),A):l},A.distanceMin=function($){return arguments.length?(y=$*$,A):Math.sqrt(y)},A.distanceMax=function($){return arguments.length?(b=$*$,A):Math.sqrt(b)},A.theta=function($){return arguments.length?(N=$*$,A):Math.sqrt(N)},A}function Xi(d){return d.index}function ki(d,o){var t=d.get(o);if(!t)throw new Error("node not found: "+o);return t}function hi(d){var o,t,r,s,l,y,b=Xi,N=function(L){return 1/Math.min(s[L.source.index],s[L.target.index])},A=Pn(30),_=1;function F(L){for(var rt=0,nt=d.length;rt<_;++rt)for(var ct,Jt,Yt,zt,bt,Ot,Xt,Wt=0;Wt<nt;++Wt)Jt=(ct=d[Wt]).source,zt=(Yt=ct.target).x+Yt.vx-Jt.x-Jt.vx||Eo(y),bt=Yt.y+Yt.vy-Jt.y-Jt.vy||Eo(y),zt*=Ot=((Ot=Math.sqrt(zt*zt+bt*bt))-t[Wt])/Ot*L*o[Wt],bt*=Ot,Yt.vx-=zt*(Xt=l[Wt]),Yt.vy-=bt*Xt,Jt.vx+=zt*(Xt=1-Xt),Jt.vy+=bt*Xt}function tt(){if(r){var L,rt,nt=r.length,ct=d.length,Jt=new Map(r.map((Yt,zt)=>[b(Yt,zt,r),Yt]));for(L=0,s=new Array(nt);L<ct;++L)(rt=d[L]).index=L,typeof rt.source!="object"&&(rt.source=ki(Jt,rt.source)),typeof rt.target!="object"&&(rt.target=ki(Jt,rt.target)),s[rt.source.index]=(s[rt.source.index]||0)+1,s[rt.target.index]=(s[rt.target.index]||0)+1;for(L=0,l=new Array(ct);L<ct;++L)rt=d[L],l[L]=s[rt.source.index]/(s[rt.source.index]+s[rt.target.index]);o=new Array(ct),$(),t=new Array(ct),q()}}function $(){if(r)for(var L=0,rt=d.length;L<rt;++L)o[L]=+N(d[L],L,d)}function q(){if(r)for(var L=0,rt=d.length;L<rt;++L)t[L]=+A(d[L],L,d)}return d==null&&(d=[]),F.initialize=function(L,rt){r=L,y=rt,tt()},F.links=function(L){return arguments.length?(d=L,tt(),F):d},F.id=function(L){return arguments.length?(b=L,F):b},F.iterations=function(L){return arguments.length?(_=+L,F):_},F.strength=function(L){return arguments.length?(N=typeof L=="function"?L:Pn(+L),$(),F):N},F.distance=function(L){return arguments.length?(A=typeof L=="function"?L:Pn(+L),q(),F):A},F}function v(d){return d.x+d.vx}function Bt(d){return d.y+d.vy}function z(d){var o,t,r,s=1,l=1;function y(){for(var A,_,F,tt,$,q,L,rt=o.length,nt=0;nt<l;++nt)for(_=qi(o,v,Bt).visitAfter(b),A=0;A<rt;++A)F=o[A],q=t[F.index],L=q*q,tt=F.x+F.vx,$=F.y+F.vy,_.visit(ct);function ct(Jt,Yt,zt,bt,Ot){var Xt=Jt.data,Wt=Jt.r,Z=q+Wt;if(!Xt)return Yt>tt+Z||bt<tt-Z||zt>$+Z||Ot<$-Z;if(Xt.index>F.index){var wt=tt-Xt.x-Xt.vx,$t=$-Xt.y-Xt.vy,Dt=wt*wt+$t*$t;Dt<Z*Z&&(wt===0&&(Dt+=(wt=Eo(r))*wt),$t===0&&(Dt+=($t=Eo(r))*$t),Dt=(Z-(Dt=Math.sqrt(Dt)))/Dt*s,F.vx+=(wt*=Dt)*(Z=(Wt*=Wt)/(L+Wt)),F.vy+=($t*=Dt)*Z,Xt.vx-=wt*(Z=1-Z),Xt.vy-=$t*Z)}}}function b(A){if(A.data)return A.r=t[A.data.index];for(var _=A.r=0;_<4;++_)A[_]&&A[_].r>A.r&&(A.r=A[_].r)}function N(){if(o){var A,_,F=o.length;for(t=new Array(F),A=0;A<F;++A)_=o[A],t[_.index]=+d(_,A,o)}}return typeof d!="function"&&(d=Pn(d==null?1:+d)),y.initialize=function(A,_){o=A,r=_,N()},y.iterations=function(A){return arguments.length?(l=+A,y):l},y.strength=function(A){return arguments.length?(s=+A,y):s},y.radius=function(A){return arguments.length?(d=typeof A=="function"?A:Pn(+A),N(),y):d},y}function Lt(d){var o,t,r,s=Pn(.1);function l(b){for(var N,A=0,_=o.length;A<_;++A)(N=o[A]).vx+=(r[A]-N.x)*t[A]*b}function y(){if(o){var b,N=o.length;for(t=new Array(N),r=new Array(N),b=0;b<N;++b)t[b]=isNaN(r[b]=+d(o[b],b,o))?0:+s(o[b],b,o)}}return typeof d!="function"&&(d=Pn(d==null?0:+d)),l.initialize=function(b){o=b,y()},l.strength=function(b){return arguments.length?(s=typeof b=="function"?b:Pn(+b),y(),l):s},l.x=function(b){return arguments.length?(d=typeof b=="function"?b:Pn(+b),y(),l):d},l}function Mt(d){var o,t,r,s=Pn(.1);function l(b){for(var N,A=0,_=o.length;A<_;++A)(N=o[A]).vy+=(r[A]-N.y)*t[A]*b}function y(){if(o){var b,N=o.length;for(t=new Array(N),r=new Array(N),b=0;b<N;++b)t[b]=isNaN(r[b]=+d(o[b],b,o))?0:+s(o[b],b,o)}}return typeof d!="function"&&(d=Pn(d==null?0:+d)),l.initialize=function(b){o=b,y()},l.strength=function(b){return arguments.length?(s=typeof b=="function"?b:Pn(+b),y(),l):s},l.y=function(b){return arguments.length?(d=typeof b=="function"?b:Pn(+b),y(),l):d},l}function te(){function d(zt){return function(){return zt}}var o,t=function(zt){return zt.cluster},r=d(1),s=d(-1),l=d(100),y=d(.1),b=[0,0],N=[],A={},_=[],F=100,tt=100,$={none:{x:0,y:0}},q=[],L="force",rt=!0,nt=.1;function ct(zt){if(!rt)return ct;o.tick(),Yt();for(var bt=0,Ot=N.length,Xt=void 0,Wt=zt*nt;bt<Ot;++bt)(Xt=N[bt]).vx+=($[t(Xt)].x-Xt.x)*Wt,Xt.vy+=($[t(Xt)].y-Xt.y)*Wt}function Jt(){N&&function(){if(N&&N.length){if(t(N[0])===void 0)throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy('clusterAttr') before calling .links()");var zt,bt,Ot,Xt,Wt,Z=(zt=[],bt=[],Ot={},Wt=[],Xt=function(wt){var $t={};return wt.forEach(function(Dt){var ve=t(Dt);$t[ve]||($t[ve]={count:0,sumforceNodeSize:0})}),wt.forEach(function(Dt){var ve=t(Dt),ge=r(Dt),ce=$t[ve];ce.count=ce.count+1,ce.sumforceNodeSize=ce.sumforceNodeSize+Math.PI*(ge*ge)*1.3,$t[ve]=ce}),$t}(N),Wt=function(wt){var $t={},Dt=[];return wt.forEach(function(ve){var ge,ce,Ne,ke,xe,Le=(ce=(ge=ve).source,Ne=ge.target,(ke=t(A[ce]))<=(xe=t(A[Ne]))?ke+"~"+xe:xe+"~"+ke),Be=0;$t[Le]!==void 0&&(Be=$t[Le]),Be+=1,$t[Le]=Be}),Object.entries($t).forEach(function(ve){var ge=E(ve,2),ce=ge[0],Ne=ge[1],ke=ce.split("~")[0],xe=ce.split("~")[1];ke!==void 0&&xe!==void 0&&Dt.push({source:ke,target:xe,count:Ne})}),Dt}(_),Object.keys(Xt).forEach(function(wt,$t){var Dt=Xt[wt];zt.push({id:wt,size:Dt.count,r:Math.sqrt(Dt.sumforceNodeSize/Math.PI)}),Ot[wt]=$t}),Wt.forEach(function(wt){var $t=wt.source,Dt=wt.target,ve=Ot[$t],ge=Ot[Dt];ve!==void 0&&ge!==void 0&&bt.push({source:ve,target:ge,count:wt.count})}),{nodes:zt,links:bt});o=qn(Z.nodes).force("x",Lt(F).strength(.1)).force("y",Mt(tt).strength(.1)).force("collide",z(function(wt){return wt.r}).iterations(4)).force("charge",Sa().strength(s)).force("links",hi(Z.nodes.length?Z.links:[]).distance(l).strength(y)),q=o.nodes(),Yt()}}()}function Yt(){return $={none:{x:0,y:0}},q.forEach(function(zt){$[zt.id]={x:zt.x-b[0],y:zt.y-b[1]}}),$}return ct.initialize=function(zt){N=zt,Jt()},ct.template=function(zt){return arguments.length?(L=zt,Jt(),ct):L},ct.groupBy=function(zt){return arguments.length?typeof zt=="string"?(t=function(bt){return bt[zt]},ct):(t=zt,ct):t},ct.enableGrouping=function(zt){return arguments.length?(rt=zt,ct):rt},ct.strength=function(zt){return arguments.length?(nt=zt,ct):nt},ct.centerX=function(zt){return arguments.length?(F=zt,ct):F},ct.centerY=function(zt){return arguments.length?(tt=zt,ct):tt},ct.nodes=function(zt){return arguments.length?(function(bt){A={},bt.forEach(function(Ot){A[Ot.id]=Ot})}(zt||[]),N=zt||[],ct):N},ct.links=function(zt){return arguments.length?(_=zt||[],Jt(),ct):_},ct.forceNodeSize=function(zt){return arguments.length?(r=typeof zt=="function"?zt:d(+zt),Jt(),ct):r},ct.nodeSize=ct.forceNodeSize,ct.forceCharge=function(zt){return arguments.length?(s=typeof zt=="function"?zt:d(+zt),Jt(),ct):s},ct.forceLinkDistance=function(zt){return arguments.length?(l=typeof zt=="function"?zt:d(+zt),Jt(),ct):l},ct.forceLinkStrength=function(zt){return arguments.length?(y=typeof zt=="function"?zt:d(+zt),Jt(),ct):y},ct.offset=function(zt){return arguments.length?(b=zt,ct):b},ct.getFocis=Yt,ct}var ue={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},he=function(){function d(o){o===void 0&&(o={}),this.options=o,this.id="d3force",this.options=a(a({},ue),o)}return d.prototype.execute=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return[2,this.genericForceLayout(!1,o,t)]})})},d.prototype.assign=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return this.genericForceLayout(!0,o,t),[2]})})},d.prototype.stop=function(){var o;(o=this.forceSimulation)===null||o===void 0||o.stop()},d.prototype.tick=function(o){var t=this;o===void 0&&(o=1),this.forceSimulation.tick(o);var r={nodes:pe(this.lastLayoutNodes),edges:ye(this.lastLayoutEdges)};return this.lastAssign&&r.nodes.forEach(function(s){return t.lastGraph.mergeNodeData(s.id,{x:s.data.x,y:s.data.y})}),r},d.prototype.genericForceLayout=function(o,t,r){return w(this,void 0,void 0,function(){var s,l,y,b,N,A,_,F,tt,$,q,L,rt,nt,ct,Jt,Yt,zt,bt,Ot,Xt,Wt,Z,wt,$t,Dt,ve=this;return m(this,function(ge){return s=a(a({},this.options),r),l=t.getAllNodes(),y=t.getAllEdges(),b=l.map(function(ce){var Ne,ke;return a(a({},zr(ce)),{x:(Ne=ce.data)===null||Ne===void 0?void 0:Ne.x,y:(ke=ce.data)===null||ke===void 0?void 0:ke.y})}),N=y.map(function(ce){return zr(ce)}),this.lastLayoutNodes=b,this.lastLayoutEdges=N,this.lastAssign=o,this.lastGraph=t,A=s.alphaMin,_=s.alphaDecay,F=s.alpha,tt=s.nodeStrength,$=s.edgeStrength,q=s.linkDistance,L=s.clustering,rt=s.clusterFociStrength,nt=s.clusterEdgeDistance,ct=s.clusterEdgeStrength,Jt=s.clusterNodeStrength,Yt=s.clusterNodeSize,zt=s.collideStrength,bt=zt===void 0?1:zt,Ot=s.center,Xt=Ot===void 0?[0,0]:Ot,Wt=s.preventOverlap,Z=s.nodeSize,wt=s.nodeSpacing,$t=s.onTick,Dt=s.forceSimulation,[2,new Promise(function(ce){if(Dt){L&&((xe=te()).nodes(b),xe.links(N)),Dt.nodes(b),N&&(Be=hi().id(function(Ge){return Ge.id}).links(N),$&&Be.strength($),q&&Be.distance(q),Dt.force("link",Be)),Wt&&ve.overlapProcess(Dt,{nodeSize:Z,nodeSpacing:wt,collideStrength:bt}),Dt.alpha(F).restart();var Ne=pe(b),ke=ye(N);o&&Ne.forEach(function(Ge){return t.mergeNodeData(Ge.id,{x:Ge.data.x,y:Ge.data.y})}),ce({nodes:Ne,edges:ke})}else try{var xe,Le=Sa();if(tt&&Le.strength(tt),Dt=qn().nodes(b),L&&((xe=te()).centerX(Xt[0]).centerY(Xt[1]).template("force").strength(rt),N&&xe.links(N),b&&xe.nodes(b),xe.forceLinkDistance(nt).forceLinkStrength(ct).forceCharge(Jt).forceNodeSize(Yt),Dt.force("group",xe)),Dt.force("center",function(Ge,de){var Fe,er=1;function je(){var we,lr,tn=Fe.length,Ir=0,ro=0;for(we=0;we<tn;++we)Ir+=(lr=Fe[we]).x,ro+=lr.y;for(Ir=(Ir/tn-Ge)*er,ro=(ro/tn-de)*er,we=0;we<tn;++we)(lr=Fe[we]).x-=Ir,lr.y-=ro}return Ge==null&&(Ge=0),de==null&&(de=0),je.initialize=function(we){Fe=we},je.x=function(we){return arguments.length?(Ge=+we,je):Ge},je.y=function(we){return arguments.length?(de=+we,je):de},je.strength=function(we){return arguments.length?(er=+we,je):er},je}(Xt[0],Xt[1])).force("charge",Le).alpha(F).alphaDecay(_).alphaMin(A),Wt&&ve.overlapProcess(Dt,{nodeSize:Z,nodeSpacing:wt,collideStrength:bt}),N){var Be=hi().id(function(Ge){return Ge.id}).links(N);$&&Be.strength($),q&&Be.distance(q),Dt.force("link",Be)}Dt.on("tick",function(){var Ge=pe(b);$t==null||$t({nodes:Ge,edges:ye(N)}),o&&Ge.forEach(function(de){return t.mergeNodeData(de.id,{x:de.data.x,y:de.data.y})})}).on("end",function(){var Ge=pe(b);o&&Ge.forEach(function(de){return t.mergeNodeData(de.id,{x:de.data.x,y:de.data.y})}),ce({nodes:Ge,edges:ye(N)})})}catch(Ge){console.warn(Ge)}ve.forceSimulation=Dt})]})})},d.prototype.overlapProcess=function(o,t){var r,s,l=t.nodeSize,y=t.nodeSpacing,b=t.collideStrength;if(s=me(y)?function(){return y}:Gr(y)?y:function(){return 0},l)if(Gr(l))r=function(_){return l(_)+s(_)};else if(Zt(l)){var N=(l[0]>l[1]?l[0]:l[1])/2;r=function(_){return N+s(_)}}else if(me(l)){var A=l/2;r=function(_){return A+s(_)}}else r=function(){return 10};else r=function(_){return _.size?Zt(_.size)?(_.size[0]>_.size[1]?_.size[0]:_.size[1])/2+s(_):dn(_.size)?(_.size.width>_.size.height?_.size.width:_.size.height)/2+s(_):_.size/2+s(_):10+s(_)};o.force("collisionForce",z(r).strength(b))},d}(),pe=function(d){return d.map(function(o){var t=o.x,r=o.y,s=f(o,["x","y"]);return a(a({},s),{data:a(a({},s.data),{x:t,y:r})})})},ye=function(d){return d.map(function(o){var t=o.source,r=o.target,s=f(o,["source","target"]);return a(a({},s),{source:t.id,target:r.id})})};const fe=function(){function d(){this._events={}}return d.prototype.on=function(o,t,r){return this._events[o]||(this._events[o]=[]),this._events[o].push({callback:t,once:!!r}),this},d.prototype.once=function(o,t){return this.on(o,t,!0)},d.prototype.emit=function(o){for(var t=this,r=[],s=1;s<arguments.length;s++)r[s-1]=arguments[s];var l=this._events[o]||[],y=this._events["*"]||[],b=function(N){for(var A=N.length,_=0;_<A;_++)if(N[_]){var F=N[_],tt=F.callback;F.once&&(N.splice(_,1),N.length===0&&delete t._events[o],A--,_--),tt.apply(t,r)}};b(l),b(y)},d.prototype.off=function(o,t){if(o)if(t){for(var r=this._events[o]||[],s=r.length,l=0;l<s;l++)r[l].callback===t&&(r.splice(l,1),s--,l--);r.length===0&&delete this._events[o]}else delete this._events[o];else this._events={};return this},d.prototype.getEvents=function(){return this._events},d}();function Je(d,o,t,r){for(;d.length;){const s=d.shift();if(t(s))return!0;o.add(s.id),r(s.id).forEach(l=>{o.has(l.id)||(o.add(l.id),d.push(l))})}return!1}function Qe(d,o,t,r){if(t(d))return!0;o.add(d.id);for(const s of r(d.id))if(!o.has(s.id)&&Qe(s,o,t,r))return!0;return!1}class ar extends fe{constructor(t){super();en(this,"nodeMap",new Map);en(this,"edgeMap",new Map);en(this,"inEdgesMap",new Map);en(this,"outEdgesMap",new Map);en(this,"bothEdgesMap",new Map);en(this,"treeIndices",new Map);en(this,"changes",[]);en(this,"batchCount",0);en(this,"onChanged",()=>{});en(this,"batch",t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()});t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}commit(){const t=this.changes;this.changes=[];const r={graph:this,changes:t};this.emit("changed",r),this.onChanged(r)}reduceChanges(t){let r=[];return t.forEach(s=>{switch(s.type){case"NodeRemoved":{let l=!1;r=r.filter(y=>{if(y.type==="NodeAdded"){const b=y.value.id===s.value.id;return b&&(l=!0),!b}return y.type==="NodeDataUpdated"?y.id!==s.value.id:y.type!=="TreeStructureChanged"||y.nodeId!==s.value.id}),l||r.push(s);break}case"EdgeRemoved":{let l=!1;r=r.filter(y=>{if(y.type==="EdgeAdded"){const b=y.value.id===s.value.id;return b&&(l=!0),!b}return y.type!=="EdgeDataUpdated"&&y.type!=="EdgeUpdated"||y.id!==s.value.id}),l||r.push(s);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const l=r.find(y=>y.type===s.type&&y.id===s.id&&y.propertyName===s.propertyName);l?l.newValue=s.newValue:r.push(s);break}case"TreeStructureDetached":r=r.filter(l=>l.type==="TreeStructureAttached"?l.treeKey!==s.treeKey:l.type!=="TreeStructureChanged"||l.treeKey!==s.treeKey),r.push(s);break;case"TreeStructureChanged":{const l=r.find(y=>y.type==="TreeStructureChanged"&&y.treeKey===s.treeKey&&y.nodeId===s.nodeId);l?l.newParentId=s.newParentId:r.push(s);break}default:r.push(s)}}),r}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,r){return this.getNeighbors(r).some(s=>s.id===t)}getNode(t){const r=this.nodeMap.get(t);if(!r)throw new Error("Node not found for id: "+t);return r}getRelatedEdges(t,r){if(this.checkNodeExistence(t),r==="in"){const s=this.inEdgesMap.get(t);return Array.from(s)}if(r==="out"){const s=this.outEdgesMap.get(t);return Array.from(s)}{const s=this.bothEdgesMap.get(t);return Array.from(s)}}getDegree(t,r){return this.getRelatedEdges(t,r).length}getSuccessors(t){const r=this.getRelatedEdges(t,"out").map(s=>this.getNode(s.target));return Array.from(new Set(r))}getPredecessors(t){const r=this.getRelatedEdges(t,"in").map(s=>this.getNode(s.source));return Array.from(new Set(r))}getNeighbors(t){const r=this.getPredecessors(t),s=this.getSuccessors(t);return Array.from(new Set([...r,...s]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach(r=>{r.childrenMap.set(t.id,new Set)}),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch(()=>{for(const r of t)this.doAddNode(r)})}addNode(t){this.addNodes([t])}doRemoveNode(t){const r=this.getNode(t),s=this.bothEdgesMap.get(t);s==null||s.forEach(l=>this.doRemoveEdge(l.id)),this.nodeMap.delete(t),this.treeIndices.forEach(l=>{var y;(y=l.childrenMap.get(t))==null||y.forEach(b=>{l.parentMap.delete(b.id)}),l.parentMap.delete(t),l.childrenMap.delete(t)}),this.changes.push({type:"NodeRemoved",value:r})}removeNodes(t){this.batch(()=>{t.forEach(r=>this.doRemoveNode(r))})}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,r,s){const l=this.getNode(t);this.batch(()=>{const y=l.data[r],b=s;l.data[r]=b,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:r,oldValue:y,newValue:b})})}mergeNodeData(t,r){this.batch(()=>{Object.entries(r).forEach(([s,l])=>{this.updateNodeDataProperty(t,s,l)})})}updateNodeData(...t){const r=t[0],s=this.getNode(r);if(typeof t[1]=="string")return void this.updateNodeDataProperty(r,t[1],t[2]);let l;if(typeof t[1]=="function"){const y=t[1];l=y(s.data)}else typeof t[1]=="object"&&(l=t[1]);this.batch(()=>{const y=s.data,b=l;s.data=l,this.changes.push({type:"NodeDataUpdated",id:r,oldValue:y,newValue:b})})}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const r=this.getEdge(t);return{edge:r,source:this.getNode(r.source),target:this.getNode(r.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const r=this.inEdgesMap.get(t.target),s=this.outEdgesMap.get(t.source),l=this.bothEdgesMap.get(t.source),y=this.bothEdgesMap.get(t.target);r.add(t),s.add(t),l.add(t),y.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch(()=>{for(const r of t)this.doAddEdge(r)})}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const r=this.getEdge(t),s=this.outEdgesMap.get(r.source),l=this.inEdgesMap.get(r.target),y=this.bothEdgesMap.get(r.source),b=this.bothEdgesMap.get(r.target);s.delete(r),l.delete(r),y.delete(r),b.delete(r),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:r})}removeEdges(t){this.batch(()=>{t.forEach(r=>this.doRemoveEdge(r))})}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,r){const s=this.getEdge(t);this.checkNodeExistence(r);const l=s.source,y=r;this.outEdgesMap.get(l).delete(s),this.bothEdgesMap.get(l).delete(s),this.outEdgesMap.get(y).add(s),this.bothEdgesMap.get(y).add(s),s.source=r,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:l,newValue:y})})}updateEdgeTarget(t,r){const s=this.getEdge(t);this.checkNodeExistence(r);const l=s.target,y=r;this.inEdgesMap.get(l).delete(s),this.bothEdgesMap.get(l).delete(s),this.inEdgesMap.get(y).add(s),this.bothEdgesMap.get(y).add(s),s.target=r,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:l,newValue:y})})}updateEdgeDataProperty(t,r,s){const l=this.getEdge(t);this.batch(()=>{const y=l.data[r],b=s;l.data[r]=b,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:r,oldValue:y,newValue:b})})}updateEdgeData(...t){const r=t[0],s=this.getEdge(r);if(typeof t[1]=="string")return void this.updateEdgeDataProperty(r,t[1],t[2]);let l;if(typeof t[1]=="function"){const y=t[1];l=y(s.data)}else typeof t[1]=="object"&&(l=t[1]);this.batch(()=>{const y=s.data,b=l;s.data=l,this.changes.push({type:"EdgeDataUpdated",id:r,oldValue:y,newValue:b})})}mergeEdgeData(t,r){this.batch(()=>{Object.entries(r).forEach(([s,l])=>{this.updateEdgeDataProperty(t,s,l)})})}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch(()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})}))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch(()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})})}addTree(t,r){this.batch(()=>{this.attachTreeStructure(r);const s=[],l=Array.isArray(t)?t:[t];for(;l.length;){const y=l.shift();s.push(y),y.children&&l.push(...y.children)}this.addNodes(s),s.forEach(y=>{var b;(b=y.children)==null||b.forEach(N=>{this.setParent(N.id,y.id,r)})})})}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter(r=>!this.getParent(r.id,t))}getChildren(t,r){this.checkNodeExistence(t),this.checkTreeExistence(r);const s=this.treeIndices.get(r).childrenMap.get(t);return Array.from(s||[])}getParent(t,r){return this.checkNodeExistence(t),this.checkTreeExistence(r),this.treeIndices.get(r).parentMap.get(t)||null}getAncestors(t,r){const s=[];let l,y=this.getNode(t);for(;l=this.getParent(y.id,r);)s.push(l),y=l;return s}setParent(t,r,s){var _;this.checkTreeExistence(s);const l=this.treeIndices.get(s),y=this.getNode(t),b=l.parentMap.get(t),N=this.getNode(r);l.parentMap.set(t,N),b&&((_=l.childrenMap.get(b.id))==null||_.delete(y));let A=l.childrenMap.get(N.id);A||(A=new Set,l.childrenMap.set(N.id,A)),A.add(y),this.batch(()=>{this.changes.push({type:"TreeStructureChanged",treeKey:s,nodeId:t,oldParentId:b==null?void 0:b.id,newParentId:N.id})})}dfsTree(t,r,s){return Qe(this.getNode(t),new Set,r,l=>this.getChildren(l,s))}bfsTree(t,r,s){return Je([this.getNode(t)],new Set,r,l=>this.getChildren(l,s))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,r,s="out"){const l={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[s];return Je([this.getNode(t)],new Set,r,l)}dfs(t,r,s="out"){const l={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[s];return Qe(this.getNode(t),new Set,r,l)}clone(){const t=this.getAllNodes().map(l=>({...l,data:{...l.data}})),r=this.getAllEdges().map(l=>({...l,data:{...l.data}})),s=new ar({nodes:t,edges:r});return this.treeIndices.forEach(({parentMap:l,childrenMap:y},b)=>{const N=new Map;l.forEach((_,F)=>{N.set(F,s.getNode(_.id))});const A=new Map;y.forEach((_,F)=>{A.set(F,new Set(Array.from(_).map(tt=>s.getNode(tt.id))))}),s.treeIndices.set(b,{parentMap:N,childrenMap:A})}),s}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var dr=function(d,o){if(d!=="next"&&d!=="prev")return o},_r=function(d){d.prev.next=d.next,d.next.prev=d.prev,delete d.next,delete d.prev},Te=function(d){function o(){return d!==null&&d.apply(this,arguments)||this}return h(o,d),o}(function(){function d(){var o={};o.prev=o,o.next=o.prev,this.shortcut=o}return d.prototype.dequeue=function(){var o=this.shortcut,t=o.prev;if(t&&t!==o)return _r(t),t},d.prototype.enqueue=function(o){var t=this.shortcut;o.prev&&o.next&&_r(o),o.next=t.next,t.next.prev=o,t.next=o,o.prev=t},d.prototype.toString=function(){for(var o=[],t=this.shortcut,r=t.prev;r!==t;)o.push(JSON.stringify(r,dr)),r=r==null?void 0:r.prev;return"["+o.join(", ")+"]"},d}()),yr=function(){return 1},Wr=function(d,o,t,r,s){var l,y,b=[];return d.hasNode(r.v)&&((l=d.getRelatedEdges(r.v,"in"))===null||l===void 0||l.forEach(function(N){var A=N.data.weight,_=d.getNode(N.source);s&&b.push({v:N.source,w:N.target,in:0,out:0}),_.data.out===void 0&&(_.data.out=0),_.data.out-=A,cn(o,t,a({v:_.id},_.data))}),(y=d.getRelatedEdges(r.v,"out"))===null||y===void 0||y.forEach(function(N){var A=N.data.weight,_=N.target,F=d.getNode(_);F.data.in===void 0&&(F.data.in=0),F.data.in-=A,cn(o,t,a({v:F.id},F.data))}),d.removeNode(r.v)),s?b:void 0},cn=function(d,o,t){t.out?t.in?d[t.out-t.in+o].enqueue(t):d[d.length-1].enqueue(t):d[0].enqueue(t)},Wn=function(d,o){var t=o==="greedy"?function(r,s){var l;if(r.getAllNodes().length<=1)return[];var y=function(b,N){var A=new ar,_=0,F=0;b.getAllNodes().forEach(function(rt){A.addNode({id:rt.id,data:{v:rt.id,in:0,out:0}})}),b.getAllEdges().forEach(function(rt){var nt=A.getRelatedEdges(rt.source,"out").find(function(Jt){return Jt.target===rt.target}),ct=(N==null?void 0:N(rt))||1;nt?A.updateEdgeData(nt==null?void 0:nt.id,a(a({},nt.data),{weight:nt.data.weight+ct})):A.addEdge({id:rt.id,source:rt.source,target:rt.target,data:{weight:ct}}),F=Math.max(F,A.getNode(rt.source).data.out+=ct),_=Math.max(_,A.getNode(rt.target).data.in+=ct)});for(var tt=[],$=F+_+3,q=0;q<$;q++)tt.push(new Te);var L=_+1;return A.getAllNodes().forEach(function(rt){cn(tt,L,a({v:rt.id},A.getNode(rt.id).data))}),{buckets:tt,zeroIdx:L,graph:A}}(r,function(b){return b.data.weight||1});return(l=function(b,N,A){for(var _,F=[],tt=N[N.length-1],$=N[0];b.getAllNodes().length;){for(;_=$.dequeue();)Wr(b,N,A,_);for(;_=tt.dequeue();)Wr(b,N,A,_);if(b.getAllNodes().length){for(var q=N.length-2;q>0;--q)if(_=N[q].dequeue()){F=F.concat(Wr(b,N,A,_,!0));break}}}return F}(y.graph,y.buckets,y.zeroIdx).map(function(b){return r.getRelatedEdges(b.v,"out").filter(function(N){return N.target===b.w})}))===null||l===void 0?void 0:l.flat()}(d):$r(d);t==null||t.forEach(function(r){var s=r.data;d.removeEdge(r.id),s.forwardName=r.data.name,s.reversed=!0,d.addEdge({id:r.id,source:r.target,target:r.source,data:a({},s)})})},$r=function(d){var o=[],t={},r={},s=function(l){r[l]||(r[l]=!0,t[l]=!0,d.getRelatedEdges(l,"out").forEach(function(y){t[y.target]?o.push(y):s(y.target)}),delete t[l])};return d.getAllNodes().forEach(function(l){return s(l.id)}),o},Hr=function(d,o,t,r){var s;do s=""+r+Math.random();while(d.hasNode(s));return t.dummy=o,d.addNode({id:s,data:t}),s},Dn=function(d){var o=new ar;return d.getAllNodes().forEach(function(t){d.getChildren(t.id).length||o.addNode(a({},t))}),d.getAllEdges().forEach(function(t){o.addEdge(t)}),o},yn=function(d,o){var t,r,s=Number(d.x),l=Number(d.y),y=Number(o.x)-s,b=Number(o.y)-l,N=Number(d.width)/2,A=Number(d.height)/2;return y||b?(Math.abs(b)*N>Math.abs(y)*A?(b<0&&(A=-A),t=A*y/b,r=A):(y<0&&(N=-N),t=N,r=N*b/y),{x:s+t,y:l+r}):{x:0,y:0}},zn=function(d){for(var o=[],t=Tn(d)+1,r=0;r<t;r++)o.push([]);for(d.getAllNodes().forEach(function(s){var l=s.data.rank;l!==void 0&&o[l]&&o[l].push(s.id)}),r=0;r<t;r++)o[r]=o[r].sort(function(s,l){return y=d.getNode(s).data.order,b=d.getNode(l).data.order,Number(y)-Number(b);var y,b});return o},lo=function(d,o,t,r){var s={width:0,height:0};return me(t)&&me(r)&&(s.rank=t,s.order=r),Hr(d,"border",s,o)},Tn=function(d){var o;return d.getAllNodes().forEach(function(t){var r=t.data.rank;r!==void 0&&(o===void 0||r>o)&&(o=r)}),o||(o=0),o},$n=function(d,o){return d.reduce(function(t,r){return o(t)>o(r)?r:t})},Xr=function(d,o,t,r,s,l){r.includes(o.id)||(r.push(o.id),t||l.push(o.id),s(o.id).forEach(function(y){return Xr(d,y,t,r,s,l)}),t&&l.push(o.id))},hn=function(d,o,t,r){var s=Array.isArray(o)?o:[o],l=function(N){return r?d.getSuccessors(N):d.getNeighbors(N)},y=[],b=[];return s.forEach(function(N){if(!d.hasNode(N.id))throw new Error("Graph does not have node: "+N);Xr(d,N,t==="post",b,l,y)}),y},Rn="edge-label",wn=function(d){var o={},t=function(r){var s,l,y=d.getNode(r);return y?o[r]?y.data.rank:(o[r]=!0,(s=d.getRelatedEdges(r,"out"))===null||s===void 0||s.forEach(function(b){var N=t(b.target)-b.data.minlen;N&&(l===void 0||N<l)&&(l=N)}),l||(l=0),y.data.rank=l,l):0};d.getAllNodes().filter(function(r){return d.getRelatedEdges(r.id,"in").length===0}).forEach(function(r){return t(r.id)})},On=function(d,o){return d.getNode(o.target).data.rank-d.getNode(o.source).data.rank-o.data.minlen},Kn=function(d,o){var t=function(r){o.getRelatedEdges(r,"both").forEach(function(s){var l=s.source,y=r===l?s.target:l;d.hasNode(y)||On(o,s)||(d.addNode({id:y,data:{}}),d.addEdge({id:s.id,source:r,target:y,data:{}}),t(y))})};return d.getAllNodes().forEach(function(r){return t(r.id)}),d.getAllNodes().length},io=function(d,o){var t=function(r){var s;(s=o.getRelatedEdges(r,"both"))===null||s===void 0||s.forEach(function(l){var y=l.source,b=r===y?l.target:y;d.hasNode(b)||o.getNode(b).data.layer===void 0&&On(o,l)||(d.addNode({id:b,data:{}}),d.addEdge({id:l.id,source:r,target:b,data:{}}),t(b))})};return d.getAllNodes().forEach(function(r){return t(r.id)}),d.getAllNodes().length},Mo=function(d,o){return $n(o.getAllEdges(),function(t){return d.hasNode(t.source)!==d.hasNode(t.target)?On(o,t):1/0})},Ao=function(d,o,t){d.getAllNodes().forEach(function(r){var s=o.getNode(r.id);s.data.rank||(s.data.rank=0),s.data.rank+=t})},ao=function(d,o){var t=hn(d,d.getAllNodes(),"post",!1);(t=t.slice(0,(t==null?void 0:t.length)-1)).forEach(function(r){Yr(d,o,r)})},Yr=function(d,o,t){var r=d.getNode(t).data.parent;d.getRelatedEdges(t,"both").find(function(s){return s.target===r||s.source===r}).data.cutvalue=ln(d,o,t)},ln=function(d,o,t){var r=d.getNode(t).data.parent,s=!0,l=o.getRelatedEdges(t,"out").find(function(b){return b.target===r}),y=0;return l||(s=!1,l=o.getRelatedEdges(r,"out").find(function(b){return b.target===t})),y=l.data.weight,o.getRelatedEdges(t,"both").forEach(function(b){var N=b.source===t,A=N?b.target:b.source;if(A!==r){var _=N===s,F=b.data.weight;if(y+=_?F:-F,Hn(d,t,A)){var tt=d.getRelatedEdges(t,"both").find(function($){return $.source===A||$.target===A}).data.cutvalue;y+=_?-tt:tt}}}),y},Jr=function(d,o){o===void 0&&(o=d.getAllNodes()[0].id),En(d,{},1,o)},En=function(d,o,t,r,s){var l,y=t,b=t,N=d.getNode(r);return o[r]=!0,(l=d.getNeighbors(r))===null||l===void 0||l.forEach(function(A){o[A.id]||(b=En(d,o,b,A.id,r))}),N.data.low=y,N.data.lim=b++,s?N.data.parent=s:delete N.data.parent,b},po=function(d){return d.getAllEdges().find(function(o){return o.data.cutvalue<0})},xn=function(d,o,t){var r=t.source,s=t.target;o.getRelatedEdges(r,"out").find(function(_){return _.target===s})||(r=t.target,s=t.source);var l=d.getNode(r),y=d.getNode(s),b=l,N=!1;l.data.lim>y.data.lim&&(b=y,N=!0);var A=o.getAllEdges().filter(function(_){return N===Gn(d.getNode(_.source),b)&&N!==Gn(d.getNode(_.target),b)});return $n(A,function(_){return On(o,_)})},Zn=function(d,o,t,r){var s=d.getRelatedEdges(t.source,"both").find(function(l){return l.source===t.target||l.target===t.target});s&&d.removeEdge(s.id),d.addEdge({id:"e"+Math.random(),source:r.source,target:r.target,data:{}}),Jr(d),ao(d,o),Cr(d,o)},Cr=function(d,o){var t=d.getAllNodes().find(function(s){return!s.data.parent}),r=hn(d,t,"pre",!1);(r=r.slice(1)).forEach(function(s){var l=d.getNode(s).data.parent,y=o.getRelatedEdges(s,"out").find(function(N){return N.target===l}),b=!1;!y&&o.hasNode(l)&&(y=o.getRelatedEdges(l,"out").find(function(N){return N.target===s}),b=!0),o.getNode(s).data.rank=(o.hasNode(l)&&o.getNode(l).data.rank||0)+(b?y==null?void 0:y.data.minlen:-(y==null?void 0:y.data.minlen))})},Hn=function(d,o,t){return d.getRelatedEdges(o,"both").find(function(r){return r.source===t||r.target===t})},Gn=function(d,o){return o.data.low<=d.data.lim&&d.data.lim<=o.data.lim},Kr=wn,Jn=function(d){(function(o){var t=function(y){var b=new ar;return y.getAllNodes().forEach(function(N){b.addNode(a({},N))}),y.getAllEdges().forEach(function(N){var A=b.getRelatedEdges(N.source,"out").find(function(_){return _.target===N.target});A?b.updateEdgeData(A==null?void 0:A.id,a(a({},A.data),{weight:A.data.weight+N.data.weight||0,minlen:Math.max(A.data.minlen,N.data.minlen||1)})):b.addEdge({id:N.id,source:N.source,target:N.target,data:{weight:N.data.weight||0,minlen:N.data.minlen||1}})}),b}(o);wn(t);var r,s,l=function(y){var b,N,A=new ar({tree:[]}),_=y.getAllNodes()[0],F=y.getAllNodes().length;for(A.addNode(_);Kn(A,y)<F;)b=Mo(A,y),N=A.hasNode(b.source)?On(y,b):-On(y,b),Ao(A,y,N);return A}(t);for(Jr(l),ao(l,t);r=po(l);)s=xn(l,t,r),Zn(l,t,r,s)})(d)},Sn=function(d,o,t,r,s,l,y){var b=d.getChildren(y);if(b!=null&&b.length){var N=lo(d,"_bt"),A=lo(d,"_bb"),_=d.getNode(y);d.setParent(N,y),_.data.borderTop=N,d.setParent(A,y),_.data.borderBottom=A,b==null||b.forEach(function(F){Sn(d,o,t,r,s,l,F.id);var tt=F.data.borderTop?F.data.borderTop:F.id,$=F.data.borderBottom?F.data.borderBottom:F.id,q=F.data.borderTop?r:2*r,L=tt!==$?1:s-l[y]+1;d.addEdge({id:"e"+Math.random(),source:N,target:tt,data:{minlen:L,weight:q,nestingEdge:!0}}),d.addEdge({id:"e"+Math.random(),source:$,target:A,data:{minlen:L,weight:q,nestingEdge:!0}})}),d.getParent(y)||d.addEdge({id:"e"+Math.random(),source:o,target:N,data:{weight:0,minlen:s+l[y]}})}else y!==o&&d.addEdge({id:"e"+Math.random(),source:o,target:y,data:{weight:0,minlen:t}})},bn=function(d,o,t,r,s,l){var y={rank:l,borderType:o,width:0,height:0},b=s.data[o][l-1],N=Hr(d,"border",y,t);s.data[o][l]=N,d.setParent(N,r),b&&d.addEdge({id:"e"+Math.random(),source:b,target:N,data:{weight:1}})},Qr=function(d){d.getAllNodes().forEach(function(o){_n(o)}),d.getAllEdges().forEach(function(o){_n(o)})},_n=function(d){var o=d.data.width;d.data.width=d.data.height,d.data.height=o},Vr=function(d){d!=null&&d.y&&(d.y=-d.y)},fn=function(d){var o=d.x;d.x=d.y,d.y=o},Qn=function(d){for(var o={},t=d.getAllNodes(),r=t.map(function(A){var _;return(_=A.data.rank)!==null&&_!==void 0?_:-1/0}),s=Math.max.apply(Math,R([],E(r))),l=[],y=0;y<s+1;y++)l.push([]);var b=t.sort(function(A,_){return d.getNode(A.id).data.rank-d.getNode(_.id).data.rank}),N=b.filter(function(A){return d.getNode(A.id).data.fixorder!==void 0}).sort(function(A,_){return d.getNode(A.id).data.fixorder-d.getNode(_.id).data.fixorder});return N==null||N.forEach(function(A){isNaN(d.getNode(A.id).data.rank)||l[d.getNode(A.id).data.rank].push(A.id),o[A.id]=!0}),b==null||b.forEach(function(A){return d.dfsTree(A.id,function(_){if(o.hasOwnProperty(_.id))return!0;o[_.id]=!0,isNaN(_.data.rank)||l[_.data.rank].push(_.id)})}),l},Ii=function(d,o,t){for(var r=function(_,F){return _==null?void 0:_.reduce(function(tt,$,q){return tt[$]=F[q],tt},{})}(t,t.map(function(_,F){return F})),s=o.map(function(_){var F=d.getRelatedEdges(_,"out").map(function(tt){return{pos:r[tt.target]||0,weight:tt.data.weight}});return F==null?void 0:F.sort(function(tt,$){return tt.pos-$.pos})}),l=s.flat().filter(function(_){return _!==void 0}),y=1;y<t.length;)y<<=1;var b=2*y-1;y-=1;var N=Array(b).fill(0,0,b),A=0;return l==null||l.forEach(function(_){if(_){var F=_.pos+y;N[F]+=_.weight;for(var tt=0;F>0;)F%2&&(tt+=N[F+1]),N[F=F-1>>1]+=_.weight;A+=_.weight*tt}}),A},Di=function(d,o){for(var t=0,r=1;r<(o==null?void 0:o.length);r+=1)t+=Ii(d,o[r-1],o[r]);return t},$o=function(d,o){var t,r=0,s=0;d.weight&&(r+=d.barycenter*d.weight,s+=d.weight),o.weight&&(r+=o.barycenter*o.weight,s+=o.weight),d.vs=(t=o.vs)===null||t===void 0?void 0:t.concat(d.vs),d.barycenter=r/s,d.weight=s,d.i=Math.min(o.i,d.i),o.merged=!0};const Ti=function(d,o){var t,r,s,l={};return d==null||d.forEach(function(y,b){l[y.v]={i:b,indegree:0,in:[],out:[],vs:[y.v]};var N=l[y.v];y.barycenter!==void 0&&(N.barycenter=y.barycenter,N.weight=y.weight)}),(t=o.getAllEdges())===null||t===void 0||t.forEach(function(y){var b=l[y.source],N=l[y.target];b!==void 0&&N!==void 0&&(N.indegree++,b.out.push(l[y.target]))}),function(y){for(var b,N,A=[],_=function(){var $=y.pop();A.push($),(b=$.in.reverse())===null||b===void 0||b.forEach(function(q){return(L=$,function(rt){rt.merged||(rt.barycenter===void 0||L.barycenter===void 0||rt.barycenter>=L.barycenter)&&$o(L,rt)})(q);var L}),(N=$.out)===null||N===void 0||N.forEach(function(q){return(L=$,function(rt){rt.in.push(L),--rt.indegree==0&&y.push(rt)})(q);var L})};y!=null&&y.length;)_();var F=A.filter(function($){return!$.merged}),tt=["vs","i","barycenter","weight"];return F.map(function($){var q={};return tt==null||tt.forEach(function(L){$[L]!==void 0&&(q[L]=$[L])}),q})}((s=(r=Object.values(l)).filter)===null||s===void 0?void 0:s.call(r,function(y){return!y.indegree}))};var li=function(d,o,t){for(var r,s=t;o.length&&(r=o[o.length-1]).i<=s;)o.pop(),d==null||d.push(r.vs),s++;return s},Po=function(d,o,t,r,s,l){var y,b,N,A,_=d.getChildren(o).map(function(Yt){return Yt.id}),F=d.getNode(o),tt=F?F.data.borderLeft:void 0,$=F?F.data.borderRight:void 0,q={};tt&&(_=_==null?void 0:_.filter(function(Yt){return Yt!==tt&&Yt!==$}));var L=function(Yt,zt){return zt.map(function(bt){var Ot=Yt.getRelatedEdges(bt,"in");if(!(Ot!=null&&Ot.length))return{v:bt};var Xt={sum:0,weight:0};return Ot==null||Ot.forEach(function(Wt){var Z=Yt.getNode(Wt.source);Xt.sum+=Wt.data.weight*Z.data.order,Xt.weight+=Wt.data.weight}),{v:bt,barycenter:Xt.sum/Xt.weight,weight:Xt.weight}})}(d,_||[]);L==null||L.forEach(function(Yt){var zt;if(!((zt=d.getChildren(Yt.v))===null||zt===void 0)&&zt.length){var bt=Po(d,Yt.v,t,r,l);q[Yt.v]=bt,bt.hasOwnProperty("barycenter")&&Ri(Yt,bt)}});var rt=Ti(L,t);Nn(rt,q),(y=rt.filter(function(Yt){return Yt.vs.length>0}))===null||y===void 0||y.forEach(function(Yt){var zt=d.getNode(Yt.vs[0]);zt&&(Yt.fixorder=zt.data.fixorder,Yt.order=zt.data.order)});var nt=function(Yt,zt,bt,Ot){var Xt=function(ce,Ne){var ke={lhs:[],rhs:[]};return ce==null||ce.forEach(function(xe){var Le,Be;Be=(Le=xe).hasOwnProperty("fixorder")&&!isNaN(Le.fixorder),(Ot?!Be&&Le.hasOwnProperty("barycenter"):Be||Le.hasOwnProperty("barycenter"))?ke.lhs.push(xe):ke.rhs.push(xe)}),ke}(Yt),Wt=Xt.lhs,Z=Xt.rhs.sort(function(ce,Ne){return-ce.i- -Ne.i}),wt=[],$t=0,Dt=0,ve=0;Wt==null||Wt.sort(function(ce,Ne){return function(ke,xe){if(ke.fixorder!==void 0&&xe.fixorder!==void 0)return ke.fixorder-xe.fixorder;if(ke.barycenter<xe.barycenter)return-1;if(ke.barycenter>xe.barycenter)return 1;if(Ne&&ke.order!==void 0&&xe.order!==void 0){if(ke.order<xe.order)return-1;if(ke.order>xe.order)return 1}return ce?xe.i-ke.i:ke.i-xe.i}}(!!zt,!!bt)),ve=li(wt,Z,ve),Wt==null||Wt.forEach(function(ce){var Ne;ve+=(Ne=ce.vs)===null||Ne===void 0?void 0:Ne.length,wt.push(ce.vs),$t+=ce.barycenter*ce.weight,Dt+=ce.weight,ve=li(wt,Z,ve)});var ge={vs:wt.flat()};return Dt&&(ge.barycenter=$t/Dt,ge.weight=Dt),ge}(rt,r,s,l);if(tt&&(nt.vs=[tt,nt.vs,$].flat(),(b=d.getPredecessors(tt))===null||b===void 0?void 0:b.length)){var ct=d.getNode(((N=d.getPredecessors(tt))===null||N===void 0?void 0:N[0].id)||""),Jt=d.getNode(((A=d.getPredecessors($))===null||A===void 0?void 0:A[0].id)||"");nt.hasOwnProperty("barycenter")||(nt.barycenter=0,nt.weight=0),nt.barycenter=(nt.barycenter*nt.weight+ct.data.order+Jt.data.order)/(nt.weight+2),nt.weight+=2}return nt},Nn=function(d,o){d==null||d.forEach(function(t){var r,s=(r=t.vs)===null||r===void 0?void 0:r.map(function(l){return o[l]?o[l].vs:l});t.vs=s.flat()})},Ri=function(d,o){d.barycenter!==void 0?(d.barycenter=(d.barycenter*d.weight+o.barycenter*o.weight)/(d.weight+o.weight),d.weight+=o.weight):(d.barycenter=o.barycenter,d.weight=o.weight)},zo=function(d){if(typeof d!="object"||d===null)return d;var o,t;if(t=d,Array.isArray?Array.isArray(t):Ze(t,"Array")){o=[];for(var r=0,s=d.length;r<s;r++)typeof d[r]=="object"&&d[r]!=null?o[r]=zo(d[r]):o[r]=d[r]}else for(var l in o={},d)typeof d[l]=="object"&&d[l]!=null?o[l]=zo(d[l]):o[l]=d[l];return o};const vo=zo;var fi=function(d,o,t){return o.map(function(r){return function(s,l,y){var b=function(A){for(var _;A.hasNode(_="_root"+Math.random()););return _}(s),N=new ar({tree:[{id:b,children:[],data:{}}]});return s.getAllNodes().forEach(function(A){var _=s.getParent(A.id);(A.data.rank===l||A.data.minRank<=l&&l<=A.data.maxRank)&&(N.hasNode(A.id)||N.addNode(a({},A)),(_==null?void 0:_.id)&&!N.hasNode(_==null?void 0:_.id)&&N.addNode(a({},_)),N.setParent(A.id,(_==null?void 0:_.id)||b),s.getRelatedEdges(A.id,y).forEach(function(F){var tt=F.source===A.id?F.target:F.source;N.hasNode(tt)||N.addNode(a({},s.getNode(tt)));var $=N.getRelatedEdges(tt,"out").find(function(L){return L.target===A.id}),q=$!==void 0?$.data.weight:0;$?N.updateEdgeData($.id,a(a({},$.data),{weight:F.data.weight+q})):N.addEdge({id:F.id,source:tt,target:A.id,data:{weight:F.data.weight+q}})}),A.data.hasOwnProperty("minRank")&&N.updateNodeData(A.id,a(a({},A.data),{borderLeft:A.data.borderLeft[l],borderRight:A.data.borderRight[l]})))}),N}(d,r,t)})},_a=function(d,o,t,r){var s=new ar;d==null||d.forEach(function(l){for(var y,b=l.getRoots()[0].id,N=Po(l,b,s,o,t,r),A=0;A<((y=N.vs)===null||y===void 0?void 0:y.length);A++){var _=l.getNode(N.vs[A]);_&&(_.data.order=A)}(function(F,tt,$){var q,L={};$==null||$.forEach(function(rt){for(var nt,ct,Jt=F.getParent(rt);Jt;){if((nt=F.getParent(Jt.id))?(ct=L[nt.id],L[nt.id]=Jt.id):(ct=q,q=Jt.id),ct&&ct!==Jt.id)return tt.addNodes([{id:ct,data:{}},{id:Jt.id,data:{}}]),void tt.addEdge({id:"e"+ct+"-"+Jt.id,source:ct,target:Jt.id,data:{}});Jt=nt}})})(l,s,N.vs)})},Ho=function(d,o){o==null||o.forEach(function(t){t==null||t.forEach(function(r,s){d.getNode(r).data.order=s})})},Xo=function(d,o){var t={};function r(l,y,b,N,A){for(var _,F,tt,$=y;$<b;$++)tt=l[$],!((_=d.getNode(tt))===null||_===void 0)&&_.data.dummy&&((F=d.getPredecessors(tt))===null||F===void 0||F.forEach(function(q){var L=d.getNode(q.id);L.data.dummy&&(L.data.order<N||L.data.order>A)&&gi(t,q.id,tt)}))}function s(l,y){var b=function(N){return JSON.stringify(N.slice(1))}(l);y.get(b)||(r.apply(void 0,R([],E(l))),y.set(b,!0))}return o!=null&&o.length&&o.reduce(function(l,y){var b,N=-1,A=0,_=new Map;return y==null||y.forEach(function(F,tt){var $;if((($=d.getNode(F))===null||$===void 0?void 0:$.data.dummy)==="border"){var q=d.getPredecessors(F)||[];q.length&&(b=d.getNode(q[0].id).data.order,s([y,A,tt,N,b],_),A=tt,N=b)}s([y,A,y.length,b,l.length],_)}),y}),t},Yi=function(d,o){var t,r;if(!((t=d.getNode(o))===null||t===void 0)&&t.data.dummy)return(r=d.getPredecessors(o))===null||r===void 0?void 0:r.find(function(s){return d.getNode(s.id).data.dummy})},gi=function(d,o,t){var r=o,s=t;if(r>s){var l=r;r=s,s=l}var y=d[r];y||(d[r]=y={}),y[s]=!0},Ki=function(d,o,t){var r=o;return r>t&&(r=t),!!d[r]},fs=function(d,o,t,r,s,l){var y=new ar,b=Yo(r,s,l);return o==null||o.forEach(function(N){var A;N==null||N.forEach(function(_){var F=t[_];if(y.hasNode(F)||y.addNode({id:F,data:{}}),A){var tt=t[A],$=y.getRelatedEdges(tt,"out").find(function(q){return q.target===F});$?y.updateEdgeData($.id,a(a({},$.data),{weight:Math.max(b(d,_,A),$.data.weight||0)})):y.addEdge({id:"e"+Math.random(),source:tt,target:F,data:{weight:Math.max(b(d,_,A),0)}})}A=_})}),y},Yo=function(d,o,t){return function(r,s,l){var y=r.getNode(s),b=r.getNode(l),N=0,A=0;if(N+=y.data.width/2,y.data.hasOwnProperty("labelpos"))switch((y.data.labelpos||"").toLowerCase()){case"l":A=-y.data.width/2;break;case"r":A=y.data.width/2}if(A&&(N+=t?A:-A),A=0,N+=(y.data.dummy?o:d)/2,N+=(b.data.dummy?o:d)/2,N+=b.data.width/2,b.data.labelpos)switch((b.data.labelpos||"").toLowerCase()){case"l":A=b.data.width/2;break;case"r":A=-b.data.width/2}return A&&(N+=t?A:-A),A=0,N}},Zi=function(d,o){return d.getNode(o).data.width||0},mo=function(d,o){var t,r=Dn(d);(function(l,y){var b=(y||{}).ranksep,N=b===void 0?0:b,A=zn(l),_=0;A==null||A.forEach(function(F){var tt=F.map(function(q){return l.getNode(q).data.height}),$=Math.max.apply(Math,R(R([],E(tt)),[0]));F==null||F.forEach(function(q){l.getNode(q).data.y=_+$/2}),_+=$+N})})(r,o);var s=function(l,y){var b=y||{},N=b.align,A=b.nodesep,_=A===void 0?0:A,F=b.edgesep,tt=F===void 0?0:F,$=zn(l),q=Object.assign(function(ct,Jt){var Yt={};return Jt!=null&&Jt.length&&Jt.reduce(function(zt,bt){var Ot=0,Xt=0,Wt=zt.length,Z=bt==null?void 0:bt[(bt==null?void 0:bt.length)-1];return bt==null||bt.forEach(function(wt,$t){var Dt,ve=Yi(ct,wt),ge=ve?ct.getNode(ve.id).data.order:Wt;(ve||wt===Z)&&((Dt=bt.slice(Xt,$t+1))===null||Dt===void 0||Dt.forEach(function(ce){var Ne;(Ne=ct.getPredecessors(ce))===null||Ne===void 0||Ne.forEach(function(ke){var xe,Le=ct.getNode(ke.id),Be=Le.data.order;!(Be<Ot||ge<Be)||Le.data.dummy&&((xe=ct.getNode(ce))===null||xe===void 0?void 0:xe.data.dummy)||gi(Yt,ke.id,ce)})}),Xt=$t+1,Ot=ge)}),bt}),Yt}(l,$),Xo(l,$)),L={},rt=[];["u","d"].forEach(function(ct){rt=ct==="u"?$:Object.values($).reverse(),["l","r"].forEach(function(Jt){Jt==="r"&&(rt=rt.map(function(Ot){return Object.values(Ot).reverse()}));var Yt=(ct==="u"?l.getPredecessors:l.getSuccessors).bind(l),zt=function(Ot,Xt,Wt,Z){var wt={},$t={},Dt={};return Xt==null||Xt.forEach(function(ve){ve==null||ve.forEach(function(ge,ce){wt[ge]=ge,$t[ge]=ge,Dt[ge]=ce})}),Xt==null||Xt.forEach(function(ve){var ge=-1;ve==null||ve.forEach(function(ce){var Ne=Z(ce).map(function(Ge){return Ge.id});if(Ne.length){Ne=Ne.sort(function(Ge,de){return Dt[Ge]-Dt[de]});for(var ke=(Ne.length-1)/2,xe=Math.floor(ke),Le=Math.ceil(ke);xe<=Le;++xe){var Be=Ne[xe];$t[ce]===ce&&ge<Dt[Be]&&!Ki(Wt,ce,Be)&&($t[Be]=ce,$t[ce]=wt[ce]=wt[Be],ge=Dt[Be])}}})}),{root:wt,align:$t}}(0,rt,q,Yt),bt=function(Ot,Xt,Wt,Z,wt,$t,Dt){var ve,ge={},ce=fs(Ot,Xt,Wt,wt,$t,Dt),Ne=Dt?"borderLeft":"borderRight",ke=function(xe,Le){for(var Be=ce.getAllNodes(),Ge=Be.pop(),de={};Ge;)de[Ge.id]?xe(Ge.id):(de[Ge.id]=!0,Be.push(Ge),Be=Be.concat(Le(Ge.id))),Ge=Be.pop()};return ke(function(xe){ge[xe]=(ce.getRelatedEdges(xe,"in")||[]).reduce(function(Le,Be){return Math.max(Le,(ge[Be.source]||0)+Be.data.weight)},0)},ce.getPredecessors.bind(ce)),ke(function(xe){var Le=(ce.getRelatedEdges(xe,"out")||[]).reduce(function(Ge,de){return Math.min(Ge,(ge[de.target]||0)-de.data.weight)},Number.POSITIVE_INFINITY),Be=Ot.getNode(xe);Le!==Number.POSITIVE_INFINITY&&Be.data.borderType!==Ne&&(ge[xe]=Math.max(ge[xe],Le))},ce.getSuccessors.bind(ce)),(ve=Object.values(Z))===null||ve===void 0||ve.forEach(function(xe){ge[xe]=ge[Wt[xe]]}),ge}(l,rt,zt.root,zt.align,_,tt,Jt==="r");Jt==="r"&&Object.keys(bt).forEach(function(Ot){return bt[Ot]=-bt[Ot]}),L[ct+Jt]=bt})});var nt=function(ct,Jt){return $n(Object.values(Jt),function(Yt){var zt,bt=Number.NEGATIVE_INFINITY,Ot=Number.POSITIVE_INFINITY;return(zt=Object.keys(Yt))===null||zt===void 0||zt.forEach(function(Xt){var Wt=Yt[Xt],Z=Zi(ct,Xt)/2;bt=Math.max(Wt+Z,bt),Ot=Math.min(Wt-Z,Ot)}),bt-Ot})}(l,L);return nt&&function(ct,Jt){var Yt=Object.values(Jt),zt=Math.min.apply(Math,R([],E(Yt))),bt=Math.max.apply(Math,R([],E(Yt)));["u","d"].forEach(function(Ot){["l","r"].forEach(function(Xt){var Wt,Z=Ot+Xt,wt=ct[Z];if(wt!==Jt){var $t=Object.values(wt);(Wt=Xt==="l"?zt-Math.min.apply(Math,R([],E($t))):bt-Math.max.apply(Math,R([],E($t))))&&(ct[Z]={},Object.keys(wt).forEach(function(Dt){ct[Z][Dt]=wt[Dt]+Wt}))}})})}(L,nt),function(ct,Jt){var Yt={};return Object.keys(ct.ul).forEach(function(zt){if(Jt)Yt[zt]=ct[Jt.toLowerCase()][zt];else{var bt=Object.values(ct).map(function(Ot){return Ot[zt]});Yt[zt]=(bt[0]+bt[1])/2}}),Yt}(L,N)}(r,o);(t=Object.keys(s))===null||t===void 0||t.forEach(function(l){r.getNode(l).data.x=s[l]})},Ya=function(d,o){var t=o.acyclicer,r=o.ranker,s=o.rankdir,l=s===void 0?"tb":s,y=o.nodeOrder,b=o.keepNodeOrder,N=o.align,A=o.nodesep,_=A===void 0?50:A,F=o.edgesep,tt=F===void 0?20:F,$=o.ranksep,q=$===void 0?50:$;Za(d),Wn(d,t);var L=function(bt){var Ot=Hr(bt,"root",{},"_root"),Xt=function(Dt){var ve={},ge=function(ce,Ne){var ke=Dt.getChildren(ce);ke==null||ke.forEach(function(xe){return ge(xe.id,Ne+1)}),ve[ce]=Ne};return Dt.getRoots().forEach(function(ce){return ge(ce.id,1)}),ve}(bt),Wt=Math.max.apply(Math,R([],E(Object.values(Xt))));Math.abs(Wt)===1/0&&(Wt=1);var Z=Wt-1,wt=2*Z+1;bt.getAllEdges().forEach(function(Dt){Dt.data.minlen*=wt});var $t=function(Dt){var ve=0;return Dt.getAllEdges().forEach(function(ge){ve+=ge.data.weight}),ve}(bt)+1;return bt.getRoots().forEach(function(Dt){Sn(bt,Ot,wt,$t,Z,Xt,Dt.id)}),{nestingRoot:Ot,nodeRankFactor:wt}}(d),rt=L.nestingRoot,nt=L.nodeRankFactor;(function(bt,Ot){switch(Ot){case"network-simplex":Jn(bt);break;case"tight-tree":default:(function(Xt){(function(Wt){var Z,wt={},$t=function(ge){var ce,Ne,ke=Wt.getNode(ge);return ke?wt[ge]?ke.data.rank:(wt[ge]=!0,(ce=Wt.getRelatedEdges(ge,"out"))===null||ce===void 0||ce.forEach(function(xe){var Le=$t(xe.target)-xe.data.minlen;Le&&(Ne===void 0||Le<Ne)&&(Ne=Le)}),Ne||(Ne=0),(Z===void 0||Ne<Z)&&(Z=Ne),ke.data.rank=Ne,Ne):0};Wt.getAllNodes().filter(function(ge){return Wt.getRelatedEdges(ge.id,"in").length===0}).forEach(function(ge){ge&&$t(ge.id)}),Z===void 0&&(Z=0);var Dt={},ve=function(ge,ce){var Ne,ke=Wt.getNode(ge),xe=isNaN(ke.data.layer)?ce:ke.data.layer;(ke.data.rank===void 0||ke.data.rank<xe)&&(ke.data.rank=xe),Dt[ge]||(Dt[ge]=!0,(Ne=Wt.getRelatedEdges(ge,"out"))===null||Ne===void 0||Ne.forEach(function(Le){ve(Le.target,xe+Le.data.minlen)}))};Wt.getAllNodes().forEach(function(ge){var ce=ge.data;ce&&(isNaN(ce.layer)?ce.rank-=Z:ve(ge.id,ce.layer))})})(Xt),function(Wt){var Z,wt,$t=new ar({tree:[]}),Dt=Wt.getAllNodes()[0],ve=Wt.getAllNodes().length;for($t.addNode(Dt);io($t,Wt)<ve;)Z=Mo($t,Wt),wt=$t.hasNode(Z.source)?On(Wt,Z):-On(Wt,Z),Ao($t,Wt,wt)}(Xt)})(bt);break;case"longest-path":Kr(bt)}})(Dn(d),r),gs(d),function(bt,Ot){Ot===void 0&&(Ot=0);var Xt=bt.getAllNodes(),Wt=Xt.filter(function(ge){return ge.data.rank!==void 0}).map(function(ge){return ge.data.rank}),Z=Math.min.apply(Math,R([],E(Wt))),wt=[];Xt.forEach(function(ge){var ce=(ge.data.rank||0)-Z;wt[ce]||(wt[ce]=[]),wt[ce].push(ge.id)});for(var $t=0,Dt=0;Dt<wt.length;Dt++){var ve=wt[Dt];ve===void 0?Dt%Ot!=0&&($t-=1):$t&&(ve==null||ve.forEach(function(ge){var ce=bt.getNode(ge);ce&&(ce.data.rank=ce.data.rank||0,ce.data.rank+=$t)}))}}(d,nt),function(bt,Ot){Ot&&bt.removeNode(Ot),bt.getAllEdges().forEach(function(Xt){Xt.data.nestingEdge&&bt.removeEdge(Xt.id)})}(d,rt),function(bt){var Ot=bt.getAllNodes().filter(function(Wt){return Wt.data.rank!==void 0}).map(function(Wt){return Wt.data.rank}),Xt=Math.min.apply(Math,R([],E(Ot)));bt.getAllNodes().forEach(function(Wt){Wt.data.hasOwnProperty("rank")&&Xt!==1/0&&(Wt.data.rank-=Xt)})}(d),ps(d),vs(d);var ct=[];(function(bt,Ot){bt.getAllEdges().forEach(function(Xt){return function(Wt,Z,wt){var $t=Z.source,Dt=Wt.getNode($t).data.rank,ve=Z.target,ge=Wt.getNode(ve).data.rank,ce=Z.data.labelRank;if(ge!==Dt+1){var Ne,ke,xe;for(Wt.removeEdge(Z.id),xe=0,++Dt;Dt<ge;++xe,++Dt)Z.data.points=[],Ne=Hr(Wt,"edge",ke={originalEdge:Z,width:0,height:0,rank:Dt},"_d"),Dt===ce&&(ke.width=Z.data.width,ke.height=Z.data.height,ke.dummy=Rn,ke.labelpos=Z.data.labelpos),Wt.addEdge({id:"e"+Math.random(),source:$t,target:Ne,data:{weight:Z.data.weight}}),xe===0&&wt.push(Ne),$t=Ne;Wt.addEdge({id:"e"+Math.random(),source:$t,target:ve,data:{weight:Z.data.weight}})}}(bt,Xt,Ot)})})(d,ct),function(bt,Ot){var Xt=function(Wt){var Z={},wt=0,$t=function(Dt){var ve=wt;Wt.getChildren(Dt).forEach(function(ge){return $t(ge.id)}),Z[Dt]={low:ve,lim:wt++}};return Wt.getRoots().forEach(function(Dt){return $t(Dt.id)}),Z}(bt);Ot.forEach(function(Wt){var Z,wt,$t=Wt,Dt=bt.getNode($t),ve=Dt.data.originalEdge;if(ve)for(var ge=function(Be,Ge,de,Fe){var er,je,we,lr,tn=[],Ir=[],ro=Math.min(Ge[de].low,Ge[Fe].low),Tr=Math.max(Ge[de].lim,Ge[Fe].lim);we=de;do we=(er=Be.getParent(we))===null||er===void 0?void 0:er.id,tn.push(we);while(we&&(Ge[we].low>ro||Tr>Ge[we].lim));for(lr=we,we=Fe;we&&we!==lr;)Ir.push(we),we=(je=Be.getParent(we))===null||je===void 0?void 0:je.id;return{lca:lr,path:tn.concat(Ir.reverse())}}(bt,Xt,ve.source,ve.target),ce=ge.path,Ne=ge.lca,ke=0,xe=ce[ke],Le=!0;$t!==ve.target;){if(Dt=bt.getNode($t),Le){for(;xe!==Ne&&((Z=bt.getNode(xe))===null||Z===void 0?void 0:Z.data.maxRank)<Dt.data.rank;)xe=ce[++ke];xe===Ne&&(Le=!1)}if(!Le){for(;ke<ce.length-1&&((wt=bt.getNode(ce[ke+1]))===null||wt===void 0?void 0:wt.data.minRank)<=Dt.data.rank;)ke++;xe=ce[ke]}bt.hasNode(xe)&&bt.setParent($t,xe),$t=bt.getSuccessors($t)[0].id}})}(d,ct),function(bt){var Ot=function(Xt){var Wt=bt.getChildren(Xt),Z=bt.getNode(Xt);if(Wt!=null&&Wt.length&&Wt.forEach(function(Dt){return Ot(Dt.id)}),Z.data.hasOwnProperty("minRank")){Z.data.borderLeft=[],Z.data.borderRight=[];for(var wt=Z.data.minRank,$t=Z.data.maxRank+1;wt<$t;wt+=1)bn(bt,"borderLeft","_bl",Xt,Z,wt),bn(bt,"borderRight","_br",Xt,Z,wt)}};bt.getRoots().forEach(function(Xt){return Ot(Xt.id)})}(d),b&&function(bt,Ot){for(var Xt=bt.getAllNodes().filter(function($t){var Dt;return!(!((Dt=bt.getChildren($t.id))===null||Dt===void 0)&&Dt.length)}).map(function($t){return $t.data.rank}),Wt=Math.max.apply(Math,R([],E(Xt))),Z=[],wt=0;wt<Wt+1;wt++)Z[wt]=[];Ot==null||Ot.forEach(function($t){var Dt=bt.getNode($t);Dt&&!Dt.data.dummy&&(isNaN(Dt.data.rank)||(Dt.data.fixorder=Z[Dt.data.rank].length,Z[Dt.data.rank].push($t)))})}(d,y),function(bt,Ot){for(var Xt=Tn(bt),Wt=[],Z=[],wt=1;wt<Xt+1;wt++)Wt.push(wt);for(wt=Xt-1;wt>-1;wt--)Z.push(wt);var $t=fi(bt,Wt,"in"),Dt=fi(bt,Z,"out"),ve=Qn(bt);Ho(bt,ve);for(var ge,ce=Number.POSITIVE_INFINITY,Ne=(wt=0,0);Ne<4;++wt,++Ne)_a(wt%2?$t:Dt,wt%4>=2,!1,Ot),ve=zn(bt),(ke=Di(bt,ve))<ce&&(Ne=0,ge=vo(ve),ce=ke);for(ve=Qn(bt),Ho(bt,ve),wt=0,Ne=0;Ne<4;++wt,++Ne){var ke;_a(wt%2?$t:Dt,wt%4>=2,!0,Ot),ve=zn(bt),(ke=Di(bt,ve))<ce&&(Ne=0,ge=vo(ve),ce=ke)}Ho(bt,ge)}(d,b),Cs(d),function(bt,Ot){var Xt=Ot.toLowerCase();Xt!=="lr"&&Xt!=="rl"||Qr(bt)}(d,l),mo(d,{align:N,nodesep:_,edgesep:tt,ranksep:q}),Es(d),Qi(d),function(bt,Ot){Ot.forEach(function(Xt){var Wt,Z=bt.getNode(Xt),wt=Z.data.originalEdge;wt&&bt.addEdge(wt);for(var $t=Xt;Z.data.dummy;)Wt=bt.getSuccessors($t)[0],bt.removeNode($t),wt.data.points.push({x:Z.data.x,y:Z.data.y}),Z.data.dummy===Rn&&(wt.data.x=Z.data.x,wt.data.y=Z.data.y,wt.data.width=Z.data.width,wt.data.height=Z.data.height),$t=Wt.id,Z=bt.getNode($t)})}(d,ct),ws(d),function(bt,Ot){var Xt=Ot.toLowerCase();Xt!=="bt"&&Xt!=="rl"||function(Wt){Wt.getAllNodes().forEach(function(Z){Vr(Z.data)}),Wt.getAllEdges().forEach(function(Z){var wt;(wt=Z.data.points)===null||wt===void 0||wt.forEach(function($t){return Vr($t)}),Z.data.hasOwnProperty("y")&&Vr(Z.data)})}(bt),Xt!=="lr"&&Xt!=="rl"||(function(Wt){Wt.getAllNodes().forEach(function(Z){fn(Z.data)}),Wt.getAllEdges().forEach(function(Z){var wt;(wt=Z.data.points)===null||wt===void 0||wt.forEach(function($t){return fn($t)}),Z.data.hasOwnProperty("x")&&fn(Z.data)})}(bt),Qr(bt))}(d,l);var Jt=ms(d),Yt=Jt.width,zt=Jt.height;return ys(d),Ka(d),function(bt){bt.getAllEdges().forEach(function(Ot){var Xt=Ot.data;if(Xt.reversed){bt.removeEdge(Ot.id);var Wt=Xt.forwardName;delete Xt.reversed,delete Xt.forwardName,bt.addEdge({id:Ot.id,source:Ot.target,target:Ot.source,data:a(a({},Xt),{forwardName:Wt})})}})}(d),{width:Yt,height:zt}},Go=["width","height","layer","fixorder"],Ji={width:0,height:0},pi=["minlen","weight","width","height","labeloffset"],ka={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Ia=["labelpos"],gs=function(d){d.getAllEdges().forEach(function(o){if(o.data.width&&o.data.height){var t=d.getNode(o.source),r={e:o,rank:(d.getNode(o.target).data.rank-t.data.rank)/2+t.data.rank};Hr(d,"edge-proxy",r,"_ep")}})},ps=function(d){var o=0;return d.getAllNodes().forEach(function(t){var r,s;t.data.borderTop&&(t.data.minRank=(r=d.getNode(t.data.borderTop))===null||r===void 0?void 0:r.data.rank,t.data.maxRank=(s=d.getNode(t.data.borderBottom))===null||s===void 0?void 0:s.data.rank,o=Math.max(o,t.data.maxRank||-1/0))}),o},vs=function(d){d.getAllNodes().forEach(function(o){o.data.dummy==="edge-proxy"&&(d.getEdge(o.data.e.id).data.labelRank=o.data.rank,d.removeNode(o.id))})},ms=function(d,o){var t,r,s=0,l=0,y=o||{},b=y.marginx,N=b===void 0?0:b,A=y.marginy,_=A===void 0?0:A,F=function(tt){if(tt.data){var $=tt.data.x,q=tt.data.y,L=tt.data.width,rt=tt.data.height;isNaN($)||isNaN(L)||(t===void 0&&(t=$-L/2),t=Math.min(t,$-L/2),s=Math.max(s,$+L/2)),isNaN(q)||isNaN(rt)||(r===void 0&&(r=q-rt/2),r=Math.min(r,q-rt/2),l=Math.max(l,q+rt/2))}};return d.getAllNodes().forEach(function(tt){F(tt)}),d.getAllEdges().forEach(function(tt){tt!=null&&tt.data.hasOwnProperty("x")&&F(tt)}),t-=N,r-=_,d.getAllNodes().forEach(function(tt){tt.data.x-=t,tt.data.y-=r}),d.getAllEdges().forEach(function(tt){var $;($=tt.data.points)===null||$===void 0||$.forEach(function(q){q.x-=t,q.y-=r}),tt.data.hasOwnProperty("x")&&(tt.data.x-=t),tt.data.hasOwnProperty("y")&&(tt.data.y-=r)}),{width:s-t+N,height:l-r+_}},ys=function(d){d.getAllEdges().forEach(function(o){var t,r,s=d.getNode(o.source),l=d.getNode(o.target);o.data.points?(t=o.data.points[0],r=o.data.points[o.data.points.length-1]):(o.data.points=[],t={x:l.data.x,y:l.data.y},r={x:s.data.x,y:s.data.y}),o.data.points.unshift(yn(s.data,t)),o.data.points.push(yn(l.data,r))})},ws=function(d){d.getAllEdges().forEach(function(o){if(o.data.hasOwnProperty("x"))switch(o.data.labelpos!=="l"&&o.data.labelpos!=="r"||(o.data.width-=o.data.labeloffset),o.data.labelpos){case"l":o.data.x-=o.data.width/2+o.data.labeloffset;break;case"r":o.data.x+=o.data.width/2+o.data.labeloffset}})},Ka=function(d){d.getAllEdges().forEach(function(o){var t;o.data.reversed&&((t=o.data.points)===null||t===void 0||t.reverse())})},Qi=function(d){d.getAllNodes().forEach(function(o){var t,r,s;if(!((t=d.getChildren(o.id))===null||t===void 0)&&t.length){var l=d.getNode(o.id),y=d.getNode(l.data.borderTop),b=d.getNode(l.data.borderBottom),N=d.getNode(l.data.borderLeft[((r=l.data.borderLeft)===null||r===void 0?void 0:r.length)-1]),A=d.getNode(l.data.borderRight[((s=l.data.borderRight)===null||s===void 0?void 0:s.length)-1]);l.data.width=Math.abs((A==null?void 0:A.data.x)-(N==null?void 0:N.data.x))||10,l.data.height=Math.abs((b==null?void 0:b.data.y)-(y==null?void 0:y.data.y))||10,l.data.x=((N==null?void 0:N.data.x)||0)+l.data.width/2,l.data.y=((y==null?void 0:y.data.y)||0)+l.data.height/2}}),d.getAllNodes().forEach(function(o){o.data.dummy==="border"&&d.removeNode(o.id)})},Za=function(d){d.getAllEdges().forEach(function(o){if(o.source===o.target){var t=d.getNode(o.source);t.data.selfEdges||(t.data.selfEdges=[]),t.data.selfEdges.push(o),d.removeEdge(o.id)}})},Cs=function(d){var o=zn(d);o==null||o.forEach(function(t){var r=0;t==null||t.forEach(function(s,l){var y,b=d.getNode(s);b.data.order=l+r,(y=b.data.selfEdges)===null||y===void 0||y.forEach(function(N){Hr(d,"selfedge",{width:N.data.width,height:N.data.height,rank:b.data.rank,order:l+ ++r,e:N},"_se")}),delete b.data.selfEdges})})},Es=function(d){d.getAllNodes().forEach(function(o){var t=d.getNode(o.id);if(t.data.dummy==="selfedge"){var r=d.getNode(t.data.e.source),s=r.data.x+r.data.width/2,l=r.data.y,y=t.data.x-s,b=r.data.height/2;d.hasEdge(t.data.e.id)?d.updateEdgeData(t.data.e.id,t.data.e.data):d.addEdge({id:t.data.e.id,source:t.data.e.source,target:t.data.e.target,data:t.data.e.data}),d.removeNode(o.id),t.data.e.data.points=[{x:s+2*y/3,y:l-b},{x:s+5*y/6,y:l-b},{y:l,x:s+y},{x:s+5*y/6,y:l+b},{x:s+2*y/3,y:l+b}],t.data.e.data.x=t.data.x,t.data.e.data.y=t.data.y}})},Ja=function(d,o){var t={};return o==null||o.forEach(function(r){d[r]!==void 0&&(t[r]=+d[r])}),t},Ko=function(d){d===void 0&&(d={});var o={};return Object.keys(d).forEach(function(t){o[t.toLowerCase()]=d[t]}),o},Ls={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},Da=function(){function d(o){o===void 0&&(o={}),this.options=o,this.id="dagre",this.layoutNode=function(t){return t.data.layout!==!1},this.options=a(a({},Ls),o)}return d.prototype.execute=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return[2,this.genericDagreLayout(!1,o,t)]})})},d.prototype.assign=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){switch(r.label){case 0:return[4,this.genericDagreLayout(!0,o,t)];case 1:return r.sent(),[2]}})})},d.prototype.genericDagreLayout=function(o,t,r){return w(this,void 0,void 0,function(){var s,l,y,b,N,A,_,F,tt,$,q,L,rt,nt,ct,Jt,Yt,zt,bt,Ot,Xt,Wt,Z,wt,$t,Dt,ve,ge,ce,Ne,ke,xe,Le,Be=this;return m(this,function(Ge){return s=a(a({},this.options),r),l=s.nodeSize,y=s.align,b=s.rankdir,N=b===void 0?"TB":b,A=s.ranksep,_=s.nodesep,F=s.ranksepFunc,tt=s.nodesepFunc,$=s.edgeLabelSpace,q=s.nodeOrder,L=s.begin,rt=s.controlPoints,nt=s.radial,ct=new ar({tree:[]}),Jt=pn(A||50,F),Yt=pn(_||50,tt),zt=Yt,bt=Jt,N!=="LR"&&N!=="RL"||(zt=Jt,bt=Yt),Ot=Me(l,void 0),Xt=t.getAllNodes(),Wt=t.getAllEdges(),Xt.filter(function(de){return de.data.layout!==!1}).forEach(function(de){var Fe=Ot(de),er=bt(de),je=Fe+2*zt(de),we=Fe+2*er,lr=de.data.layer;me(lr)?ct.addNode({id:de.id,data:{width:je,height:we,layer:lr}}):ct.addNode({id:de.id,data:{width:je,height:we}})}),Wt.forEach(function(de){Be.layoutNode(ct.getNode(de.source))&&Be.layoutNode(ct.getNode(de.target))&&ct.addEdge({id:de.id,source:de.source,target:de.target,data:{weight:de.data.weight||1}})}),function(de,Fe){var er,je,we=Fe.edgeLabelSpace,lr=Fe.keepNodeOrder,tn=Fe.prevGraph,Ir=Fe.rankdir,ro=Fe.ranksep;!lr&&tn&&(je=tn,(er=de).getAllNodes().forEach(function(Nr){var fr=er.getNode(Nr.id),vr=je.getNode(Nr.id);vr!==void 0?(fr.data.fixorder=vr.data._order,delete vr.data._order):delete fr.data.fixorder}));var Tr=function(Nr){var fr=new ar({tree:[]});return Nr.getAllNodes().forEach(function(vr){var sn=Ko(Nr.getNode(vr.id).data),jr=a(a({},Ji),sn),Lr=Ja(jr,Go);fr.hasNode(vr.id)||fr.addNode({id:vr.id,data:a({},Lr)});var Fn=Nr.getParent(vr.id);Fn==null||(fr.hasNode(Fn.id)||fr.addNode(a({},Fn)),fr.setParent(vr.id,Fn.id))}),Nr.getAllEdges().forEach(function(vr){var sn=Ko(Nr.getEdge(vr.id).data),jr={};Ia==null||Ia.forEach(function(Lr){sn[Lr]!==void 0&&(jr[Lr]=sn[Lr])}),fr.addEdge({id:vr.id,source:vr.source,target:vr.target,data:Object.assign({},ka,Ja(sn,pi),jr)})}),fr}(de);we!==!1&&(Fe.ranksep=function(Nr,fr){var vr=fr.ranksep,sn=vr===void 0?0:vr,jr=fr.rankdir;return Nr.getAllNodes().forEach(function(Lr){isNaN(Lr.data.layer)||Lr.data.layer||(Lr.data.layer=0)}),Nr.getAllEdges().forEach(function(Lr){var Fn;Lr.data.minlen*=2,((Fn=Lr.data.labelpos)===null||Fn===void 0?void 0:Fn.toLowerCase())!=="c"&&(jr==="TB"||jr==="BT"?Lr.data.width+=Lr.data.labeloffset:Lr.data.height+=Lr.data.labeloffset)}),sn/2}(Tr,{rankdir:Ir,ranksep:ro}));try{Ya(Tr,Fe)}catch(Nr){if(Nr.message==="Not possible to find intersection inside of the rectangle")return void console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,Nr);throw Nr}(function(Nr,fr){Nr.getAllNodes().forEach(function(vr){var sn,jr=Nr.getNode(vr.id);if(jr){var Lr=fr.getNode(vr.id);jr.data.x=Lr.data.x,jr.data.y=Lr.data.y,jr.data._order=Lr.data.order,jr.data._rank=Lr.data.rank,!((sn=fr.getChildren(vr.id))===null||sn===void 0)&&sn.length&&(jr.data.width=Lr.data.width,jr.data.height=Lr.data.height)}}),Nr.getAllEdges().forEach(function(vr){var sn=Nr.getEdge(vr.id),jr=fr.getEdge(vr.id);sn.data.points=jr?jr.data.points:[],jr&&jr.data.hasOwnProperty("x")&&(sn.data.x=jr.data.x,sn.data.y=jr.data.y)})})(de,Tr)}(ct,{prevGraph:null,edgeLabelSpace:$,keepNodeOrder:!!q,nodeOrder:q||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:N,nodesep:_,align:y}),Z=[0,0],L&&(wt=1/0,$t=1/0,ct.getAllNodes().forEach(function(de){wt>de.data.x&&(wt=de.data.x),$t>de.data.y&&($t=de.data.y)}),ct.getAllEdges().forEach(function(de){var Fe;(Fe=de.data.points)===null||Fe===void 0||Fe.forEach(function(er){wt>er.x&&(wt=er.x),$t>er.y&&($t=er.y)})}),Z[0]=L[0]-wt,Z[1]=L[1]-$t),Dt=N==="LR"||N==="RL",nt||(ve=new Set,ge=N==="BT"||N==="RL"?function(de,Fe){return Fe-de}:function(de,Fe){return de-Fe},ct.getAllNodes().forEach(function(de){de.data.x=de.data.x+Z[0],de.data.y=de.data.y+Z[1],ve.add(Dt?de.data.x:de.data.y)}),ce=Array.from(ve).sort(ge),Ne=Dt?function(de,Fe){return de.x!==Fe.x}:function(de,Fe){return de.y!==Fe.y},ke=Dt?function(de,Fe,er){var je=Math.max(Fe.y,er.y),we=Math.min(Fe.y,er.y);return de.filter(function(lr){return lr.y<=je&&lr.y>=we})}:function(de,Fe,er){var je=Math.max(Fe.x,er.x),we=Math.min(Fe.x,er.x);return de.filter(function(lr){return lr.x<=je&&lr.x>=we})},ct.getAllEdges().forEach(function(de,Fe){var er;$&&rt&&de.data.type!=="loop"&&(de.data.controlPoints=Oi((er=de.data.points)===null||er===void 0?void 0:er.map(function(je){var we=je.x,lr=je.y;return{x:we+Z[0],y:lr+Z[1]}}),ct.getNode(de.source),ct.getNode(de.target),ce,Dt,Ne,ke))})),xe=[],xe=ct.getAllNodes().map(function(de){return zr(de)}),Le=ct.getAllEdges(),o&&(xe.forEach(function(de){t.mergeNodeData(de.id,{x:de.data.x,y:de.data.y})}),Le.forEach(function(de){t.mergeEdgeData(de.id,{controlPoints:de.data.controlPoints})})),[2,{nodes:xe,edges:Le}]})})},d}(),Oi=function(d,o,t,r,s,l,y){var b=(d==null?void 0:d.slice(1,d.length-1))||[];if(o&&t){var N=o.data,A=N.x,_=N.y,F=t.data,tt=F.x,$=F.y;if(s&&(A=o.data.y,_=o.data.x,tt=t.data.y,$=t.data.x),$!==_&&A!==tt){var q=r.indexOf(_),L=r[q+1];if(L){var rt=b[0],nt=s?{x:(_+L)/2,y:(rt==null?void 0:rt.y)||tt}:{x:(rt==null?void 0:rt.x)||tt,y:(_+L)/2};rt&&!l(rt,nt)||b.unshift(nt)}var ct=r.indexOf($),Jt=Math.abs(ct-q);if(Jt===1)(b=y(b,o.data,t.data)).length||b.push(s?{x:(_+$)/2,y:A}:{x:A,y:(_+$)/2});else if(Jt>1){var Yt=r[ct-1];if(Yt){var zt=b[b.length-1],bt=s?{x:($+Yt)/2,y:(zt==null?void 0:zt.y)||tt}:{x:(zt==null?void 0:zt.x)||A,y:($+Yt)/2};zt&&!l(zt,bt)||b.push(bt)}}}}return b};function ta(d){var o=0,t=0,r=0;if(d.length){for(var s=0;s<4;s++)(l=d[s])&&l.weight&&(o+=l.weight,t+=l.x*l.weight,r+=l.y*l.weight);d.x=t/o,d.y=r/o,d.weight=o}else{var l=d;d.x=l.data.x,d.y=l.data.y,d.weight=l.data.weight}}var Ps=function(d,o,t,r,s,l){var y=l.x-d.x||.1,b=l.y-d.y||.1,N=r-o,A=y*y+b*b,_=Math.sqrt(A)*A;if(N*N*.81<A){var F=d.weight/_;return l.vx+=y*F,l.vy+=b*F,!0}if(d.length)return!1;d.data!==l&&(F=d.data.weight/_,l.vx+=y*F,l.vy+=b*F)},xs={maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},Ta=function(){function d(o){o===void 0&&(o={}),this.options=o,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=a(a({},xs),o)}return d.prototype.execute=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return[2,this.genericForceLayout(!1,o,t)]})})},d.prototype.assign=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return this.genericForceLayout(!0,o,t),[2]})})},d.prototype.stop=function(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1},d.prototype.tick=function(o){var t=this;if(o===void 0&&(o=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<o;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var s={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&s.nodes.forEach(function(l){return t.lastGraph.mergeNodeData(l.id,{x:l.data.x,y:l.data.y})}),s},d.prototype.genericForceLayout=function(o,t,r){return w(this,void 0,void 0,function(){var s,l,y,b,N,A,_,F,tt,$,q,L,rt,nt,ct,Jt,Yt,zt,bt,Ot=this;return m(this,function(Xt){return s=a(a({},this.options),r),l=t.getAllNodes(),y=t.getAllEdges(),b=this.formatOptions(s,t),N=b.width,A=b.height,_=b.nodeSize,F=b.getMass,tt=b.nodeStrength,$=b.edgeStrength,q=b.linkDistance,L=l.map(function(Wt){return a(a({},Wt),{data:a(a({},Wt.data),{x:me(Wt.data.x)?Wt.data.x:Math.random()*N,y:me(Wt.data.y)?Wt.data.y:Math.random()*A,size:_(Wt)||30,mass:F(Wt),nodeStrength:tt(Wt)})})}),rt=y.map(function(Wt){return a(a({},Wt),{data:a(a({},Wt.data),{edgeStrength:$(Wt),linkDistance:q(Wt,t.getNode(Wt.source),t.getNode(Wt.target))})})}),l!=null&&l.length?(nt={},l.forEach(function(Wt,Z){nt[Wt.id]={x:0,y:0}}),ct=new ar({nodes:L,edges:rt}),this.formatCentripetal(b,ct),Jt=b.maxIteration,Yt=b.minMovement,zt=b.onTick,this.lastLayoutNodes=L,this.lastLayoutEdges=rt,this.lastAssign=o,this.lastGraph=t,this.lastCalcGraph=ct,this.lastOptions=b,this.lastVelMap=nt,typeof window>"u"?[2]:(bt=0,[2,new Promise(function(Wt){Ot.timeInterval=window.setInterval(function(){l&&Ot.running||Wt({nodes:Ns(t,L),edges:y}),Ot.runOneStep(ct,t,bt,nt,b),Ot.updatePosition(t,ct,nt,b),o&&L.forEach(function(Z){return t.mergeNodeData(Z.id,{x:Z.data.x,y:Z.data.y})}),zt==null||zt({nodes:Ns(t,L),edges:y}),(++bt>=Jt||Ot.judgingDistance<Yt)&&(window.clearInterval(Ot.timeInterval),Wt({nodes:Ns(t,L),edges:y}))},0),Ot.running=!0})])):(this.lastResult={nodes:[],edges:y},[2,{nodes:[],edges:y}])})})},d.prototype.formatOptions=function(o,t){var r=o,s=o.width,l=o.height,y=o.getMass;if(r.width=s||typeof window>"u"?s:window.innerWidth,r.height=l||typeof window>"u"?l:window.innerHeight,o.center||(r.center=[r.width/2,r.height/2]),y||(r.getMass=function(N){var A=1;me(N==null?void 0:N.data.mass)&&(A=N==null?void 0:N.data.mass);var _=t.getDegree(N.id,"both");return!_||_<5?A:5*_*A}),o.preventOverlap){var b=pn(0,o.nodeSpacing);o.nodeSize?Zt(o.nodeSize)?r.nodeSize=function(N){var A=o.nodeSize;return Math.max(A[0],A[1])+b(N)}:r.nodeSize=function(N){return o.nodeSize+b(N)}:r.nodeSize=function(N){var A=((N==null?void 0:N.data)||{}).size;return A?Zt(A)?Math.max(A[0],A[1])+b(N):dn(A)?Math.max(A.width,A.height)+b(N):A+b(N):10+b(N)}}return r.linkDistance=o.linkDistance?pn(1,o.linkDistance):function(N){return 1+r.nodeSize(t.getNode(N.source))+r.nodeSize(t.getNode(N.target))},r.nodeStrength=pn(1,o.nodeStrength),r.edgeStrength=pn(1,o.edgeStrength),o},d.prototype.formatCentripetal=function(o,t){var r,s=o.centripetalOptions,l=o.center,y=o.clusterNodeStrength,b=o.leafCluster,N=o.clustering,A=o.nodeClusterBy,_=t.getAllNodes(),F=s||{leaf:2,single:2,others:1,center:function(ct){return{x:l[0],y:l[1]}}};typeof y!="function"&&(o.clusterNodeStrength=function(ct){return y});var tt=[];if(b&&A&&(r=to(t,A),tt=Array.from(new Set(_==null?void 0:_.map(function(ct){return ct.data[A]})))||[],o.centripetalOptions=Object.assign(F,{single:100,leaf:function(ct){var Jt=r[ct.id]||{},Yt=Jt.siblingLeaves,zt=Jt.sameTypeLeaves;return(zt==null?void 0:zt.length)===(Yt==null?void 0:Yt.length)||(tt==null?void 0:tt.length)===1?1:o.clusterNodeStrength(ct)},others:1,center:function(ct){var Jt,Yt=t.getDegree(ct.id,"both");if(!Yt)return{x:100,y:100};if(Yt===1){var zt=(r[ct.id]||{}).sameTypeLeaves,bt=zt===void 0?[]:zt;bt.length===1?Jt=void 0:bt.length>1&&(Jt=ra(bt))}else Jt=void 0;return{x:Jt==null?void 0:Jt.x,y:Jt==null?void 0:Jt.y}}})),N&&A){r||(r=to(t,A)),tt||(tt=Array.from(new Set(_.map(function(ct){return ct.data[A]})))),tt=tt.filter(function(ct){return ct!==void 0});var $={};tt.forEach(function(ct){var Jt=_.filter(function(Yt){return Yt.data[A]===ct}).map(function(Yt){return t.getNode(Yt.id)});$[ct]=ra(Jt)}),o.centripetalOptions=Object.assign(F,{single:function(ct){return o.clusterNodeStrength(ct)},leaf:function(ct){return o.clusterNodeStrength(ct)},others:function(ct){return o.clusterNodeStrength(ct)},center:function(ct){var Jt=$[ct.data[A]];return{x:Jt==null?void 0:Jt.x,y:Jt==null?void 0:Jt.y}}})}var q=o.centripetalOptions||{},L=q.leaf,rt=q.single,nt=q.others;L&&typeof L!="function"&&(o.centripetalOptions.leaf=function(){return L}),rt&&typeof rt!="function"&&(o.centripetalOptions.single=function(){return rt}),nt&&typeof nt!="function"&&(o.centripetalOptions.others=function(){return nt})},d.prototype.runOneStep=function(o,t,r,s,l){var y={},b=o.getAllNodes(),N=o.getAllEdges();if(b!=null&&b.length){var A=l.monitor;this.calRepulsive(o,y,l),N&&this.calAttractive(o,y),this.calGravity(o,t,y,l),this.updateVelocity(o,y,s,l),A&&A({energy:this.calTotalEnergy(y,b),nodes:t.getAllNodes(),edges:t.getAllEdges(),iterations:r})}},d.prototype.calTotalEnergy=function(o,t){if(!(t!=null&&t.length))return 0;var r=0;return t.forEach(function(s,l){var y=o[s.id].x,b=o[s.id].y,N=y*y+b*b,A=s.data.mass;r+=(A===void 0?1:A)*N*.5}),r},d.prototype.calRepulsive=function(o,t,r){var s=r.factor,l=r.coulombDisScale;(function(y,b,N,A){var _=b/N,F=y.getAllNodes(),tt=F.map(function(q,L){var rt=q.data,nt=rt.nodeStrength;return{x:rt.x,y:rt.y,size:rt.size,index:L,vx:0,vy:0,weight:_*nt}}),$=qi(tt,function(q){return q.x},function(q){return q.y}).visitAfter(ta);tt.forEach(function(q){(function(L,rt){rt.visit(function(nt,ct,Jt,Yt,zt){return Ps(nt,ct,Jt,Yt,zt,L)})})(q,$)}),tt.map(function(q,L){var rt=F[L],nt=rt.id,ct=rt.data.mass,Jt=ct===void 0?1:ct;A[nt]={x:q.vx/Jt,y:q.vy/Jt}})})(o,s,l*l,t)},d.prototype.calAttractive=function(o,t){o.getAllEdges().forEach(function(r,s){var l=r.source,y=r.target,b=o.getNode(l),N=o.getNode(y);if(b&&N){var A=N.data.x-b.data.x,_=N.data.y-b.data.y;A||_||(A=.01*Math.random(),_=.01*Math.random());var F=Math.sqrt(A*A+_*_),tt=A/F,$=_/F,q=r.data||{},L=q.linkDistance,rt=L===void 0?200:L,nt=q.edgeStrength,ct=(rt-F)*(nt===void 0?200:nt),Jt=1/(b.data.mass||1),Yt=1/(N.data.mass||1),zt=tt*ct,bt=$*ct;t[l].x-=zt*Jt,t[l].y-=bt*Jt,t[y].x+=zt*Yt,t[y].y+=bt*Yt}})},d.prototype.calGravity=function(o,t,r,s){var l=s.getCenter,y=o.getAllNodes(),b=t.getAllNodes(),N=t.getAllEdges(),A=s.width,_=s.height,F=s.center,tt=s.gravity,$=s.centripetalOptions;y&&y.forEach(function(q){var L=q.id,rt=q.data,nt=rt.mass,ct=rt.x,Jt=rt.y,Yt=t.getNode(L),zt=0,bt=0,Ot=tt,Xt=o.getDegree(L,"in"),Wt=o.getDegree(L,"out"),Z=o.getDegree(L,"both"),wt=l==null?void 0:l(Yt,Z);if(wt){var $t=E(wt,3);zt=ct-$t[0],bt=Jt-$t[1],Ot=$t[2]}else zt=ct-F[0],bt=Jt-F[1];if(Ot&&(r[L].x-=Ot*zt/nt,r[L].y-=Ot*bt/nt),$){var Dt=$.leaf,ve=$.single,ge=$.others,ce=$.center,Ne=(ce==null?void 0:ce(Yt,b,N,A,_))||{x:0,y:0,centerStrength:0},ke=Ne.x,xe=Ne.y,Le=Ne.centerStrength;if(!me(ke)||!me(xe))return;var Be=(ct-ke)/nt,Ge=(Jt-xe)/nt;if(Le&&(r[L].x-=Le*Be,r[L].y-=Le*Ge),Z===0){var de=ve(Yt);return de?(r[L].x-=de*Be,void(r[L].y-=de*Ge)):void 0}if(Xt===0||Wt===0){var Fe=Dt(Yt,b,N);return Fe?(r[L].x-=Fe*Be,void(r[L].y-=Fe*Ge)):void 0}var er=ge(Yt);if(!er)return;r[L].x-=er*Be,r[L].y-=er*Ge}})},d.prototype.updateVelocity=function(o,t,r,s){var l=s.damping,y=s.maxSpeed,b=s.interval,N=o.getAllNodes();N!=null&&N.length&&N.forEach(function(A){var _=A.id,F=(r[_].x+t[_].x*b)*l||.01,tt=(r[_].y+t[_].y*b)*l||.01,$=Math.sqrt(F*F+tt*tt);if($>y){var q=y/$;F*=q,tt*=q}r[_]={x:F,y:tt}})},d.prototype.updatePosition=function(o,t,r,s){var l=this,y=s.distanceThresholdMode,b=s.interval,N=t.getAllNodes();if(N!=null&&N.length){var A=0;y==="max"?this.judgingDistance=-1/0:y==="min"&&(this.judgingDistance=1/0),N.forEach(function(_){var F=_.id,tt=o.getNode(F);if(me(tt.data.fx)&&me(tt.data.fy))t.mergeNodeData(F,{x:tt.data.fx,y:tt.data.fy});else{var $=r[F].x*b,q=r[F].y*b;t.mergeNodeData(F,{x:_.data.x+$,y:_.data.y+q});var L=Math.sqrt($*$+q*q);switch(y){case"max":l.judgingDistance<L&&(l.judgingDistance=L);break;case"min":l.judgingDistance>L&&(l.judgingDistance=L);break;default:A+=L}}}),y&&y!=="mean"||(this.judgingDistance=A/N.length)}else this.judgingDistance=0},d}(),to=function(d,o){var t=d.getAllNodes();if(!(t!=null&&t.length))return{};var r={};return t.forEach(function(s,l){d.getDegree(s.id,"both")===1&&(r[s.id]=ea(d,"leaf",s,o))}),r},ea=function(d,o,t,r){var s=d.getDegree(t.id,"in"),l=d.getDegree(t.id,"out"),y=t,b=[];return s===0?(y=d.getSuccessors(t.id)[0],b=d.getNeighbors(y.id)):l===0&&(y=d.getPredecessors(t.id)[0],b=d.getNeighbors(y.id)),b=b.filter(function(N){return d.getDegree(N.id,"in")===0||d.getDegree(N.id,"out")===0}),{coreNode:y,siblingLeaves:b,sameTypeLeaves:bs(d,o,r,t,b)}},bs=function(d,o,t,r,s){var l=r.data[t]||"",y=(s==null?void 0:s.filter(function(b){return b.data[t]===l}))||[];return o==="leaf"&&(y=y.filter(function(b){return d.getDegree(b.id,"in")===0||d.getDegree(b.id,"out")===0})),y},ra=function(d){var o={x:0,y:0};d.forEach(function(r){var s=r.data,l=s.x,y=s.y;o.x+=l||0,o.y+=y||0});var t=d.length||1;return{x:o.x/t,y:o.y/t}},Ns=function(d,o){return o.map(function(t){var r=t.id,s=t.data,l=d.getNode(r);return a(a({},l),{data:a(a({},l.data),{x:s.x,y:s.y})})})},Zo=function(){function d(o){this.id=o.id||0,this.rx=o.rx,this.ry=o.ry,this.fx=0,this.fy=0,this.mass=o.mass,this.degree=o.degree,this.g=o.g||0}return d.prototype.distanceTo=function(o){var t=this.rx-o.rx,r=this.ry-o.ry;return Math.hypot(t,r)},d.prototype.setPos=function(o,t){this.rx=o,this.ry=t},d.prototype.resetForce=function(){this.fx=0,this.fy=0},d.prototype.addForce=function(o){var t=o.rx-this.rx,r=o.ry-this.ry,s=Math.hypot(t,r);s=s<1e-4?1e-4:s;var l=this.g*(this.degree+1)*(o.degree+1)/s;this.fx+=l*t/s,this.fy+=l*r/s},d.prototype.in=function(o){return o.contains(this.rx,this.ry)},d.prototype.add=function(o){var t=this.mass+o.mass;return new d({rx:(this.rx*this.mass+o.rx*o.mass)/t,ry:(this.ry*this.mass+o.ry*o.mass)/t,mass:t,degree:this.degree+o.degree})},d}();const Jo=Zo,So=function(){function d(o){this.xmid=o.xmid,this.ymid=o.ymid,this.length=o.length,this.massCenter=o.massCenter||[0,0],this.mass=o.mass||1}return d.prototype.getLength=function(){return this.length},d.prototype.contains=function(o,t){var r=this.length/2;return o<=this.xmid+r&&o>=this.xmid-r&&t<=this.ymid+r&&t>=this.ymid-r},d.prototype.NW=function(){return new d({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},d.prototype.NE=function(){return new d({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},d.prototype.SW=function(){return new d({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},d.prototype.SE=function(){return new d({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},d}(),Qa=function(){function d(o){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,o!=null&&(this.quad=o)}return d.prototype.insert=function(o){this.body!=null?this._isExternal()?(this.quad&&(this.NW=new d(this.quad.NW()),this.NE=new d(this.quad.NE()),this.SW=new d(this.quad.SW()),this.SE=new d(this.quad.SE())),this._putBody(this.body),this._putBody(o),this.body=this.body.add(o)):(this.body=this.body.add(o),this._putBody(o)):this.body=o},d.prototype._putBody=function(o){this.quad&&(o.in(this.quad.NW())&&this.NW?this.NW.insert(o):o.in(this.quad.NE())&&this.NE?this.NE.insert(o):o.in(this.quad.SW())&&this.SW?this.SW.insert(o):o.in(this.quad.SE())&&this.SE&&this.SE.insert(o))},d.prototype._isExternal=function(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null},d.prototype.updateForce=function(o){this.body!=null&&o!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(o)<this.theta?o.addForce(this.body):(this.NW&&this.NW.updateForce(o),this.NE&&this.NE.updateForce(o),this.SW&&this.SW.updateForce(o),this.SE&&this.SE.updateForce(o)))},d}();var vi={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Qo=function(){function d(o){o===void 0&&(o={}),this.options=o,this.id="forceAtlas2",this.options=a(a({},vi),o)}return d.prototype.execute=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return[2,this.genericForceAtlas2Layout(!1,o,t)]})})},d.prototype.assign=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return this.genericForceAtlas2Layout(!0,o,t),[2]})})},d.prototype.genericForceAtlas2Layout=function(o,t,r){return w(this,void 0,void 0,function(){var s,l,y,b,N,A,_,F,tt,$,q,L,rt,nt,ct,Jt,Yt,zt,bt,Ot,Xt,Wt;return m(this,function(Z){if(s=t.getAllEdges(),l=t.getAllNodes(),y=this.formatOptions(r,l.length),b=y.width,N=y.height,A=y.prune,_=y.maxIteration,F=y.nodeSize,tt=y.center,!(l!=null&&l.length)||l.length===1)return[2,Ce(t,o,tt)];if($=l.map(function(wt){return zr(wt,[b,N])}),q=s.filter(function(wt){return wt.source!==wt.target}),L=new ar({nodes:$,edges:q}),rt=this.getSizes(L,t,F),this.run(L,t,_,rt,o,y),A){for(nt=0;nt<q.length;nt+=1)ct=q[nt],Jt=ct.source,Yt=ct.target,zt=L.getDegree(Jt),bt=L.getDegree(Jt),zt<=1?(Ot=L.getNode(Yt),L.mergeNodeData(Jt,{x:Ot.data.x,y:Ot.data.y})):bt<=1&&(Xt=L.getNode(Jt),L.mergeNodeData(Yt,{x:Xt.data.x,y:Xt.data.y}));Wt=a(a({},y),{prune:!1,barnesHut:!1}),this.run(L,t,100,rt,o,Wt)}return[2,{nodes:$,edges:s}]})})},d.prototype.getSizes=function(o,t,r){for(var s=o.getAllNodes(),l={},y=0;y<s.length;y+=1){var b=s[y],N=b.id,A=b.data;if(l[N]=10,me(A.size))l[N]=A.size;else if(Zt(A.size))isNaN(A.size[0])||(l[N]=Math.max(A.size[0])),isNaN(A.size[1])||(l[N]=Math.max(A.size[1]));else if(dn(A.size))l[N]=Math.max(A.size.width,A.size.height);else if(Gr(r)){var _=r(t.getNode(N));Zt(_)?l[N]=Math.max.apply(Math,R([],E(_))):l[N]=_}else Zt(r)?l[N]=Math.max.apply(Math,R([],E(r))):me(r)&&(l[N]=r)}return l},d.prototype.formatOptions=function(o,t){o===void 0&&(o={});var r=a(a({},this.options),o),s=r.center,l=r.width,y=r.height,b=r.barnesHut,N=r.prune,A=r.maxIteration,_=r.kr,F=r.kg;return r.width=l||typeof window>"u"?l:window.innerWidth,r.height=y||typeof window>"u"?y:window.innerHeight,r.center=s||[r.width/2,r.height/2],b===void 0&&t>250&&(r.barnesHut=!0),N===void 0&&t>100&&(r.prune=!0),A!==0||N?A===0&&N&&(r.maxIteration=100,t<=200&&t>100?r.maxIteration=500:t>200&&(r.maxIteration=950)):(r.maxIteration=250,t<=200&&t>100?r.maxIteration=1e3:t>200&&(r.maxIteration=1200)),_||(r.kr=50,t>100&&t<=500?r.kr=20:t>500&&(r.kr=1)),F||(r.kg=20,t>100&&t<=500?r.kg=10:t>500&&(r.kg=1)),r},d.prototype.run=function(o,t,r,s,l,y){for(var b=y.kr,N=y.barnesHut,A=y.onTick,_=o.getAllNodes(),F=0,tt=r,$={},q={},L={},rt=0;rt<_.length;rt+=1){var nt=_[rt],ct=nt.data,Jt=nt.id;if($[Jt]=[0,0],N){var Yt={id:rt,rx:ct.x,ry:ct.y,mass:1,g:b,degree:o.getDegree(Jt)};L[Jt]=new Jo(Yt)}}for(;tt>0;)F=this.oneStep(o,{iter:tt,preventOverlapIters:50,krPrime:100,sg:F,forces:$,preForces:q,bodies:L,sizes:s},y),tt--,A==null||A({nodes:_,edges:t.getAllEdges()});return o},d.prototype.oneStep=function(o,t,r){for(var s=t.iter,l=t.preventOverlapIters,y=t.krPrime,b=t.sg,N=t.preForces,A=t.bodies,_=t.sizes,F=t.forces,tt=r.preventOverlap,$=r.barnesHut,q=o.getAllNodes(),L=0;L<q.length;L+=1){var rt=q[L].id;N[rt]=R([],E(F[rt])),F[rt]=[0,0]}return F=this.getAttrForces(o,s,l,_,F,r),F=$&&(tt&&s>l||!tt)?this.getOptRepGraForces(o,F,A,r):this.getRepGraForces(o,s,l,F,y,_,r),this.updatePos(o,F,N,b,r)},d.prototype.getAttrForces=function(o,t,r,s,l,y){for(var b=y.preventOverlap,N=y.dissuadeHubs,A=y.mode,_=y.prune,F=o.getAllEdges(),tt=0;tt<F.length;tt+=1){var $=F[tt],q=$.source,L=$.target,rt=o.getNode(q),nt=o.getNode(L),ct=o.getDegree(q),Jt=o.getDegree(L);if(!_||!(ct<=1||Jt<=1)){var Yt=[nt.data.x-rt.data.x,nt.data.y-rt.data.y],zt=Math.hypot(Yt[0],Yt[1]);zt=zt<1e-4?1e-4:zt,Yt[0]=Yt[0]/zt,Yt[1]=Yt[1]/zt,b&&t<r&&(zt=zt-s[q]-s[L]);var bt=zt,Ot=bt;A==="linlog"&&(Ot=bt=Math.log(1+zt)),N&&(bt=zt/ct,Ot=zt/Jt),b&&t<r&&zt<=0?(bt=0,Ot=0):b&&t<r&&zt>0&&(bt=zt,Ot=zt),l[q][0]+=bt*Yt[0],l[L][0]-=Ot*Yt[0],l[q][1]+=bt*Yt[1],l[L][1]-=Ot*Yt[1]}}return l},d.prototype.getOptRepGraForces=function(o,t,r,s){for(var l=s.kg,y=s.center,b=s.prune,N=o.getAllNodes(),A=N.length,_=9e10,F=-9e10,tt=9e10,$=-9e10,q=0;q<A;q+=1){var L=N[q],rt=L.id,nt=L.data;b&&o.getDegree(rt)<=1||(r[rt].setPos(nt.x,nt.y),nt.x>=F&&(F=nt.x),nt.x<=_&&(_=nt.x),nt.y>=$&&($=nt.y),nt.y<=tt&&(tt=nt.y))}var ct=Math.max(F-_,$-tt),Jt=new So({xmid:(F+_)/2,ymid:($+tt)/2,length:ct,massCenter:y,mass:A}),Yt=new Qa(Jt);for(q=0;q<A;q+=1)rt=N[q].id,b&&o.getDegree(rt)<=1||r[rt].in(Jt)&&Yt.insert(r[rt]);for(q=0;q<A;q+=1){var zt=N[q],bt=(rt=zt.id,nt=zt.data,o.getDegree(rt));if(!(b&&bt<=1)){r[rt].resetForce(),Yt.updateForce(r[rt]),t[rt][0]-=r[rt].fx,t[rt][1]-=r[rt].fy;var Ot=[nt.x-y[0],nt.y-y[1]],Xt=Math.hypot(Ot[0],Ot[1]);Xt=Xt<1e-4?1e-4:Xt,Ot[0]=Ot[0]/Xt,Ot[1]=Ot[1]/Xt;var Wt=l*(bt+1);t[rt][0]-=Wt*Ot[0],t[rt][1]-=Wt*Ot[1]}}return t},d.prototype.getRepGraForces=function(o,t,r,s,l,y,b){for(var N=b.preventOverlap,A=b.kr,_=b.kg,F=b.center,tt=b.prune,$=o.getAllNodes(),q=$.length,L=0;L<q;L+=1){for(var rt=$[L],nt=o.getDegree(rt.id),ct=L+1;ct<q;ct+=1){var Jt=$[ct],Yt=o.getDegree(Jt.id);if(!tt||!(nt<=1||Yt<=1)){var zt=[Jt.data.x-rt.data.x,Jt.data.y-rt.data.y],bt=Math.hypot(zt[0],zt[1]);bt=bt<1e-4?1e-4:bt,zt[0]=zt[0]/bt,zt[1]=zt[1]/bt,N&&t<r&&(bt=bt-y[rt.id]-y[Jt.id]);var Ot=A*(nt+1)*(Yt+1)/bt;N&&t<r&&bt<0?Ot=l*(nt+1)*(Yt+1):N&&t<r&&bt===0?Ot=0:N&&t<r&&bt>0&&(Ot=A*(nt+1)*(Yt+1)/bt),s[rt.id][0]-=Ot*zt[0],s[Jt.id][0]+=Ot*zt[0],s[rt.id][1]-=Ot*zt[1],s[Jt.id][1]+=Ot*zt[1]}}var Xt=[rt.data.x-F[0],rt.data.y-F[1]],Wt=Math.hypot(Xt[0],Xt[1]);Xt[0]=Xt[0]/Wt,Xt[1]=Xt[1]/Wt;var Z=_*(nt+1);s[rt.id][0]-=Z*Xt[0],s[rt.id][1]-=Z*Xt[1]}return s},d.prototype.updatePos=function(o,t,r,s,l){for(var y=l.ks,b=l.tao,N=l.prune,A=l.ksmax,_=o.getAllNodes(),F=_.length,tt=[],$=[],q=0,L=0,rt=s,nt=0;nt<F;nt+=1){var ct=_[nt].id,Jt=o.getDegree(ct);if(!(N&&Jt<=1)){var Yt=[t[ct][0]-r[ct][0],t[ct][1]-r[ct][1]],zt=Math.hypot(Yt[0],Yt[1]),bt=[t[ct][0]+r[ct][0],t[ct][1]+r[ct][1]],Ot=Math.hypot(bt[0],bt[1]);tt[nt]=zt,$[nt]=Ot/2,q+=(Jt+1)*tt[nt],L+=(Jt+1)*$[nt]}}var Xt=rt;for(rt=b*L/q,Xt!==0&&(rt=rt>1.5*Xt?1.5*Xt:rt),nt=0;nt<F;nt+=1){var Wt=_[nt],Z=(ct=Wt.id,Wt.data);if(Jt=o.getDegree(ct),!(N&&Jt<=1||me(Z.fx)&&me(Z.fy))){var wt=y*rt/(1+rt*Math.sqrt(tt[nt])),$t=Math.hypot(t[ct][0],t[ct][1]),Dt=A/($t=$t<1e-4?1e-4:$t),ve=(wt=wt>Dt?Dt:wt)*t[ct][0],ge=wt*t[ct][1];o.mergeNodeData(ct,{x:Z.x+ve,y:Z.y+ge})}}return rt},d}(),Ra={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},na=function(){function d(o){o===void 0&&(o={}),this.options=o,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=a(a({},Ra),o)}return d.prototype.execute=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return[2,this.genericFruchtermanLayout(!1,o,t)]})})},d.prototype.assign=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return this.genericFruchtermanLayout(!0,o,t),[2]})})},d.prototype.stop=function(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1},d.prototype.tick=function(o){var t=this;if(o===void 0&&(o=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;r<o;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var s={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&s.nodes.forEach(function(l){return t.lastGraph.mergeNodeData(l.id,{x:l.data.x,y:l.data.y})}),s},d.prototype.genericFruchtermanLayout=function(o,t,r){return w(this,void 0,void 0,function(){var s,l,y,b,N,A,_,F,tt,$,q,L,rt,nt,ct,Jt=this;return m(this,function(Yt){return this.running?[2]:(s=this.formatOptions(r),l=s.width,y=s.height,b=s.center,N=s.clustering,A=s.nodeClusterBy,_=s.maxIteration,F=s.onTick,tt=t.getAllNodes(),$=t.getAllEdges(),tt!=null&&tt.length?tt.length===1?(o&&t.mergeNodeData(tt[0].id,{x:b[0],y:b[1]}),q={nodes:[a(a({},tt[0]),{data:a(a({},tt[0].data),{x:b[0],y:b[1]})})],edges:$},this.lastResult=q,[2,q]):(L=tt.map(function(zt){return zr(zt,[l,y])}),rt=new ar({nodes:L,edges:$}),nt={},N&&L.forEach(function(zt){var bt=zt.data[A];nt[bt]||(nt[bt]={name:bt,cx:0,cy:0,count:0})}),this.lastLayoutNodes=L,this.lastLayoutEdges=$,this.lastAssign=o,this.lastGraph=rt,this.lastOptions=s,this.lastClusterMap=nt,typeof window>"u"?[2]:(ct=0,[2,new Promise(function(zt){Jt.timeInterval=window.setInterval(function(){Jt.running?(Jt.runOneStep(rt,nt,s),o&&L.forEach(function(bt){var Ot=bt.id,Xt=bt.data;return t.mergeNodeData(Ot,{x:Xt.x,y:Xt.y})}),F==null||F({nodes:L,edges:$}),++ct>=_&&(window.clearInterval(Jt.timeInterval),zt({nodes:L,edges:$}))):zt({nodes:L,edges:$})},0),Jt.running=!0})])):(q={nodes:[],edges:$},this.lastResult=q,[2,q]))})})},d.prototype.formatOptions=function(o){o===void 0&&(o={});var t=a(a({},this.options),o),r=t.clustering,s=t.nodeClusterBy,l=t.center,y=t.width,b=t.height;return t.width=y||typeof window>"u"?y:window.innerWidth,t.height=b||typeof window>"u"?b:window.innerHeight,t.center=l||[t.width/2,t.height/2],t.clustering=r&&!!s,t},d.prototype.runOneStep=function(o,t,r){var s=r.height,l=r.width,y=r.gravity,b=r.center,N=r.speed,A=r.clustering,_=r.nodeClusterBy,F=r.clusterGravity,tt=s*l,$=Math.sqrt(tt)/10,q=o.getAllNodes(),L=tt/(q.length+1),rt=Math.sqrt(L),nt={};if(this.applyCalculate(o,nt,rt,L),A){for(var ct in t)t[ct].cx=0,t[ct].cy=0,t[ct].count=0;for(var ct in q.forEach(function(zt){var bt=zt.data,Ot=t[bt[_]];me(bt.x)&&(Ot.cx+=bt.x),me(bt.y)&&(Ot.cy+=bt.y),Ot.count++}),t)t[ct].cx/=t[ct].count,t[ct].cy/=t[ct].count;var Jt=F||y;q.forEach(function(Yt,zt){var bt=Yt.id,Ot=Yt.data;if(me(Ot.x)&&me(Ot.y)){var Xt=t[Ot[_]],Wt=Math.sqrt((Ot.x-Xt.cx)*(Ot.x-Xt.cx)+(Ot.y-Xt.cy)*(Ot.y-Xt.cy)),Z=rt*Jt;nt[bt].x-=Z*(Ot.x-Xt.cx)/Wt,nt[bt].y-=Z*(Ot.y-Xt.cy)/Wt}})}q.forEach(function(Yt,zt){var bt=Yt.id,Ot=Yt.data;if(me(Ot.x)&&me(Ot.y)){var Xt=.01*rt*y;nt[bt].x-=Xt*(Ot.x-b[0]),nt[bt].y-=Xt*(Ot.y-b[1])}}),q.forEach(function(Yt,zt){var bt=Yt.id,Ot=Yt.data;if(me(Ot.fx)&&me(Ot.fy))return Ot.x=Ot.fx,void(Ot.y=Ot.fy);if(me(Ot.x)&&me(Ot.y)){var Xt=Math.sqrt(nt[bt].x*nt[bt].x+nt[bt].y*nt[bt].y);if(Xt>0){var Wt=Math.min($*(N/800),Xt);o.mergeNodeData(bt,{x:Ot.x+nt[bt].x/Xt*Wt,y:Ot.y+nt[bt].y/Xt*Wt})}}})},d.prototype.applyCalculate=function(o,t,r,s){this.calRepulsive(o,t,s),this.calAttractive(o,t,r)},d.prototype.calRepulsive=function(o,t,r){var s=o.getAllNodes();s.forEach(function(l,y){var b=l.data,N=l.id;t[N]={x:0,y:0},s.forEach(function(A,_){var F=A.data,tt=A.id;if(!(y<=_)&&me(b.x)&&me(F.x)&&me(b.y)&&me(F.y)){var $=b.x-F.x,q=b.y-F.y,L=$*$+q*q;L===0&&(L=1,$=.01,q=.01);var rt=r/L,nt=$*rt,ct=q*rt;t[N].x+=nt,t[N].y+=ct,t[tt].x-=nt,t[tt].y-=ct}})})},d.prototype.calAttractive=function(o,t,r){o.getAllEdges().forEach(function(s){var l=s.source,y=s.target;if(l&&y&&l!==y){var b=o.getNode(l).data,N=o.getNode(y).data;if(me(N.x)&&me(b.x)&&me(N.y)&&me(b.y)){var A=N.x-b.x,_=N.y-b.y,F=Math.sqrt(A*A+_*_)/r,tt=A*F,$=_*F;t[l].x+=tt,t[l].y+=$,t[y].x-=tt,t[y].y-=$}}})},d}(),oa={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},ia=function(){function d(o){o===void 0&&(o={}),this.options=o,this.id="grid",this.options=a(a({},oa),o)}return d.prototype.execute=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return[2,this.genericGridLayout(!1,o,t)]})})},d.prototype.assign=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return this.genericGridLayout(!0,o,t),[2]})})},d.prototype.genericGridLayout=function(o,t,r){return w(this,void 0,void 0,function(){var s,l,y,b,N,A,_,F,tt,$,q,L,rt,nt,ct,Jt,Yt,zt,bt,Ot,Xt,Wt,Z,wt,$t,Dt,ve,ge,ce,Ne,ke,xe,Le,Be,Ge,de,Fe;return m(this,function(er){if(s=a(a({},this.options),r),l=s.begin,y=l===void 0?[0,0]:l,b=s.condense,N=s.preventOverlapPadding,A=s.preventOverlap,_=s.rows,F=s.cols,tt=s.nodeSpacing,$=s.nodeSize,q=s.width,L=s.height,rt=s.position,nt=s.sortBy,ct=t.getAllNodes(),Jt=t.getAllEdges(),!(Yt=ct==null?void 0:ct.length)||Yt===1)return[2,Ce(t,o,y)];if(zt=ct.map(function(je){return zr(je)}),nt==="id"||Vn(nt)&&zt[0].data[nt]!==void 0||(nt="degree"),nt==="degree"?zt.sort(function(je,we){return t.getDegree(we.id,"both")-t.getDegree(je.id,"both")}):nt==="id"?zt.sort(function(je,we){return me(we.id)&&me(je.id)?we.id-je.id:(""+je.id).localeCompare(""+we.id)}):zt.sort(function(je,we){return we.data[nt]-je.data[nt]}),bt=q||typeof window>"u"?q:window.innerWidth,Ot=L||typeof window>"u"?L:window.innerHeight,Xt=Yt,Wt={rows:_,cols:F},_!=null&&F!=null?(Wt.rows=_,Wt.cols=F):_!=null&&F==null?(Wt.rows=_,Wt.cols=Math.ceil(Xt/Wt.rows)):_==null&&F!=null?(Wt.cols=F,Wt.rows=Math.ceil(Xt/Wt.cols)):(Z=Math.sqrt(Xt*Ot/bt),Wt.rows=Math.round(Z),Wt.cols=Math.round(bt/Ot*Z)),Wt.rows=Math.max(Wt.rows,1),Wt.cols=Math.max(Wt.cols,1),Wt.cols*Wt.rows>Xt)wt=ti(Wt),$t=Ci(Wt),(wt-1)*$t>=Xt?ti(Wt,wt-1):($t-1)*wt>=Xt&&Ci(Wt,$t-1);else for(;Wt.cols*Wt.rows<Xt;)wt=ti(Wt),(($t=Ci(Wt))+1)*wt>=Xt?Ci(Wt,$t+1):ti(Wt,wt+1);for(Dt=b?0:bt/Wt.cols,ve=b?0:Ot/Wt.rows,(A||tt)&&(ge=pn(10,tt),ce=De(30,$,!1),zt.forEach(function(je){je.data.x&&je.data.y||(je.data.x=0,je.data.y=0);var we,lr,tn=t.getNode(je.id),Ir=ce(tn)||30;Zt(Ir)?(we=Ir[0],lr=Ir[1]):(we=Ir,lr=Ir);var ro=ge!==void 0?ge(je):N,Tr=we+ro,Nr=lr+ro;Dt=Math.max(Dt,Tr),ve=Math.max(ve,Nr)})),Ne={},ke={row:0,col:0},xe={},Le=0;Le<zt.length;Le++){if(Be=zt[Le],Ge=void 0,rt&&(Ge=rt(t.getNode(Be.id))),Ge&&(Ge.row!==void 0||Ge.col!==void 0)){if((de={row:Ge.row,col:Ge.col}).col===void 0)for(de.col=0;aa(Ne,de);)de.col++;else if(de.row===void 0)for(de.row=0;aa(Ne,de);)de.row++;xe[Be.id]=de,To(Ne,de)}Ms(Be,y,Dt,ve,xe,Wt,ke,Ne)}return Fe={nodes:zt,edges:Jt},o&&zt.forEach(function(je){t.mergeNodeData(je.id,{x:je.data.x,y:je.data.y})}),[2,Fe]})})},d}(),ti=function(d,o){var t,r=d.rows||5,s=d.cols||5;return o==null?t=Math.min(r,s):Math.min(r,s)===d.rows?d.rows=o:d.cols=o,t},Ci=function(d,o){var t,r=d.rows||5,s=d.cols||5;return o==null?t=Math.max(r,s):Math.max(r,s)===d.rows?d.rows=o:d.cols=o,t},aa=function(d,o){return d["c-"+o.row+"-"+o.col]||!1},To=function(d,o){return d["c-"+o.row+"-"+o.col]=!0},ts=function(d,o){var t=d.cols||5;o.col++,o.col>=t&&(o.col=0,o.row++)},Ms=function(d,o,t,r,s,l,y,b){var N,A,_=s[d.id];if(_)N=_.col*t+t/2+o[0],A=_.row*r+r/2+o[1];else{for(;aa(b,y);)ts(l,y);N=y.col*t+t/2+o[0],A=y.row*r+r/2+o[1],To(b,y),ts(l,y)}d.data.x=N,d.data.y=A};const Oa=Object.prototype.toString;function eo(d){return Oa.call(d).endsWith("Array]")}function Ca(d){var o,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!eo(d))throw new TypeError("input must be an array");if(d.length===0)throw new TypeError("input must not be empty");if(t.output!==void 0){if(!eo(t.output))throw new TypeError("output option must be an array if specified");o=t.output}else o=new Array(d.length);var r=function(F){var tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!eo(F))throw new TypeError("input must be an array");if(F.length===0)throw new TypeError("input must not be empty");var $=tt.fromIndex,q=$===void 0?0:$,L=tt.toIndex,rt=L===void 0?F.length:L;if(q<0||q>=F.length||!Number.isInteger(q))throw new Error("fromIndex must be a positive integer smaller than length");if(rt<=q||rt>F.length||!Number.isInteger(rt))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var nt=F[q],ct=q+1;ct<rt;ct++)F[ct]<nt&&(nt=F[ct]);return nt}(d),s=function(F){var tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!eo(F))throw new TypeError("input must be an array");if(F.length===0)throw new TypeError("input must not be empty");var $=tt.fromIndex,q=$===void 0?0:$,L=tt.toIndex,rt=L===void 0?F.length:L;if(q<0||q>=F.length||!Number.isInteger(q))throw new Error("fromIndex must be a positive integer smaller than length");if(rt<=q||rt>F.length||!Number.isInteger(rt))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var nt=F[q],ct=q+1;ct<rt;ct++)F[ct]>nt&&(nt=F[ct]);return nt}(d);if(r===s)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var l=t.min,y=l===void 0?t.autoMinMax?r:0:l,b=t.max,N=b===void 0?t.autoMinMax?s:1:b;if(y>=N)throw new RangeError("min option must be smaller than max option");for(var A=(N-y)/(s-r),_=0;_<d.length;_++)o[_]=(d[_]-r)*A+y;return o}const sa=" ".repeat(2),es=" ".repeat(4);function La(d,o={}){const{maxRows:t=15,maxColumns:r=10,maxNumSize:s=8,padMinus:l="auto"}=o;return`${d.constructor.name} {
${sa}[
${es}${function(y,b,N,A,_){const{rows:F,columns:tt}=y,$=Math.min(F,b),q=Math.min(tt,N),L=[];if(_==="auto"){_=!1;t:for(let rt=0;rt<$;rt++)for(let nt=0;nt<q;nt++)if(y.get(rt,nt)<0){_=!0;break t}}for(let rt=0;rt<$;rt++){let nt=[];for(let ct=0;ct<q;ct++)nt.push(Pa(y.get(rt,ct),A,_));L.push(`${nt.join(" ")}`)}return q!==tt&&(L[L.length-1]+=` ... ${tt-N} more columns`),$!==F&&L.push(`... ${F-b} more rows`),L.join(`
${es}`)}(d,t,r,s,l)}
${sa}]
${sa}rows: ${d.rows}
${sa}columns: ${d.columns}
}`}function Pa(d,o,t){return(d>=0&&t?` ${rs(d,o-1)}`:rs(d,o)).padEnd(o)}function rs(d,o){let t=d.toString();if(t.length<=o)return t;let r=d.toFixed(o);if(r.length>o&&(r=d.toFixed(Math.max(0,o-(r.length-o)))),r.length<=o&&!r.startsWith("0.000")&&!r.startsWith("-0.000"))return r;let s=d.toExponential(o);return s.length>o&&(s=d.toExponential(Math.max(0,o-(s.length-o)))),s.slice(0)}function yo(d,o,t){let r=t?d.rows:d.rows-1;if(o<0||o>r)throw new RangeError("Row index out of range")}function fo(d,o,t){let r=t?d.columns:d.columns-1;if(o<0||o>r)throw new RangeError("Column index out of range")}function ei(d,o){if(o.to1DArray&&(o=o.to1DArray()),o.length!==d.columns)throw new RangeError("vector size must be the same as the number of columns");return o}function mi(d,o){if(o.to1DArray&&(o=o.to1DArray()),o.length!==d.rows)throw new RangeError("vector size must be the same as the number of rows");return o}function ua(d,o,t,r,s){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(Li("startRow",o),Li("endRow",t),Li("startColumn",r),Li("endColumn",s),o>t||r>s||o<0||o>=d.rows||t<0||t>=d.rows||r<0||r>=d.columns||s<0||s>=d.columns)throw new RangeError("Submatrix indices are out of range")}function da(d,o=0){let t=[];for(let r=0;r<d;r++)t.push(o);return t}function Li(d,o){if(typeof o!="number")throw new TypeError(`${d} must be a number`)}function Fo(d){if(d.isEmpty())throw new Error("Empty matrix has no elements to index")}class kr{static from1DArray(o,t,r){if(o*t!==r.length)throw new RangeError("data length does not match given dimensions");let s=new ur(o,t);for(let l=0;l<o;l++)for(let y=0;y<t;y++)s.set(l,y,r[l*t+y]);return s}static rowVector(o){let t=new ur(1,o.length);for(let r=0;r<o.length;r++)t.set(0,r,o[r]);return t}static columnVector(o){let t=new ur(o.length,1);for(let r=0;r<o.length;r++)t.set(r,0,o[r]);return t}static zeros(o,t){return new ur(o,t)}static ones(o,t){return new ur(o,t).fill(1)}static rand(o,t,r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{random:s=Math.random}=r;let l=new ur(o,t);for(let y=0;y<o;y++)for(let b=0;b<t;b++)l.set(y,b,s());return l}static randInt(o,t,r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{min:s=0,max:l=1e3,random:y=Math.random}=r;if(!Number.isInteger(s))throw new TypeError("min must be an integer");if(!Number.isInteger(l))throw new TypeError("max must be an integer");if(s>=l)throw new RangeError("min must be smaller than max");let b=l-s,N=new ur(o,t);for(let A=0;A<o;A++)for(let _=0;_<t;_++){let F=s+Math.round(y()*b);N.set(A,_,F)}return N}static eye(o,t,r){t===void 0&&(t=o),r===void 0&&(r=1);let s=Math.min(o,t),l=this.zeros(o,t);for(let y=0;y<s;y++)l.set(y,y,r);return l}static diag(o,t,r){let s=o.length;t===void 0&&(t=s),r===void 0&&(r=t);let l=Math.min(s,t,r),y=this.zeros(t,r);for(let b=0;b<l;b++)y.set(b,b,o[b]);return y}static min(o,t){o=this.checkMatrix(o),t=this.checkMatrix(t);let r=o.rows,s=o.columns,l=new ur(r,s);for(let y=0;y<r;y++)for(let b=0;b<s;b++)l.set(y,b,Math.min(o.get(y,b),t.get(y,b)));return l}static max(o,t){o=this.checkMatrix(o),t=this.checkMatrix(t);let r=o.rows,s=o.columns,l=new this(r,s);for(let y=0;y<r;y++)for(let b=0;b<s;b++)l.set(y,b,Math.max(o.get(y,b),t.get(y,b)));return l}static checkMatrix(o){return kr.isMatrix(o)?o:new ur(o)}static isMatrix(o){return o!=null&&o.klass==="Matrix"}get size(){return this.rows*this.columns}apply(o){if(typeof o!="function")throw new TypeError("callback must be a function");for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)o.call(this,t,r);return this}to1DArray(){let o=[];for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)o.push(this.get(t,r));return o}to2DArray(){let o=[];for(let t=0;t<this.rows;t++){o.push([]);for(let r=0;r<this.columns;r++)o[t].push(this.get(t,r))}return o}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let o=0;o<this.rows;o++)for(let t=0;t<=o;t++)if(this.get(o,t)!==this.get(t,o))return!1;return!0}return!1}isEchelonForm(){let o=0,t=0,r=-1,s=!0,l=!1;for(;o<this.rows&&s;){for(t=0,l=!1;t<this.columns&&l===!1;)this.get(o,t)===0?t++:this.get(o,t)===1&&t>r?(l=!0,r=t):(s=!1,l=!0);o++}return s}isReducedEchelonForm(){let o=0,t=0,r=-1,s=!0,l=!1;for(;o<this.rows&&s;){for(t=0,l=!1;t<this.columns&&l===!1;)this.get(o,t)===0?t++:this.get(o,t)===1&&t>r?(l=!0,r=t):(s=!1,l=!0);for(let y=t+1;y<this.rows;y++)this.get(o,y)!==0&&(s=!1);o++}return s}echelonForm(){let o=this.clone(),t=0,r=0;for(;t<o.rows&&r<o.columns;){let s=t;for(let l=t;l<o.rows;l++)o.get(l,r)>o.get(s,r)&&(s=l);if(o.get(s,r)===0)r++;else{o.swapRows(t,s);let l=o.get(t,r);for(let y=r;y<o.columns;y++)o.set(t,y,o.get(t,y)/l);for(let y=t+1;y<o.rows;y++){let b=o.get(y,r)/o.get(t,r);o.set(y,r,0);for(let N=r+1;N<o.columns;N++)o.set(y,N,o.get(y,N)-o.get(t,N)*b)}t++,r++}}return o}reducedEchelonForm(){let o=this.echelonForm(),t=o.columns,r=o.rows,s=r-1;for(;s>=0;)if(o.maxRow(s)===0)s--;else{let l=0,y=!1;for(;l<r&&y===!1;)o.get(s,l)===1?y=!0:l++;for(let b=0;b<s;b++){let N=o.get(b,l);for(let A=l;A<t;A++){let _=o.get(b,A)-N*o.get(s,A);o.set(b,A,_)}}s--}return o}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(o={}){if(typeof o!="object")throw new TypeError("options must be an object");const{rows:t=1,columns:r=1}=o;if(!Number.isInteger(t)||t<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let s=new ur(this.rows*t,this.columns*r);for(let l=0;l<t;l++)for(let y=0;y<r;y++)s.setSubMatrix(this,this.rows*l,this.columns*y);return s}fill(o){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,o);return this}neg(){return this.mulS(-1)}getRow(o){yo(this,o);let t=[];for(let r=0;r<this.columns;r++)t.push(this.get(o,r));return t}getRowVector(o){return ur.rowVector(this.getRow(o))}setRow(o,t){yo(this,o),t=ei(this,t);for(let r=0;r<this.columns;r++)this.set(o,r,t[r]);return this}swapRows(o,t){yo(this,o),yo(this,t);for(let r=0;r<this.columns;r++){let s=this.get(o,r);this.set(o,r,this.get(t,r)),this.set(t,r,s)}return this}getColumn(o){fo(this,o);let t=[];for(let r=0;r<this.rows;r++)t.push(this.get(r,o));return t}getColumnVector(o){return ur.columnVector(this.getColumn(o))}setColumn(o,t){fo(this,o),t=mi(this,t);for(let r=0;r<this.rows;r++)this.set(r,o,t[r]);return this}swapColumns(o,t){fo(this,o),fo(this,t);for(let r=0;r<this.rows;r++){let s=this.get(r,o);this.set(r,o,this.get(r,t)),this.set(r,t,s)}return this}addRowVector(o){o=ei(this,o);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)+o[r]);return this}subRowVector(o){o=ei(this,o);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)-o[r]);return this}mulRowVector(o){o=ei(this,o);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*o[r]);return this}divRowVector(o){o=ei(this,o);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)/o[r]);return this}addColumnVector(o){o=mi(this,o);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)+o[t]);return this}subColumnVector(o){o=mi(this,o);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)-o[t]);return this}mulColumnVector(o){o=mi(this,o);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*o[t]);return this}divColumnVector(o){o=mi(this,o);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)/o[t]);return this}mulRow(o,t){yo(this,o);for(let r=0;r<this.columns;r++)this.set(o,r,this.get(o,r)*t);return this}mulColumn(o,t){fo(this,o);for(let r=0;r<this.rows;r++)this.set(r,o,this.get(r,o)*t);return this}max(o){if(this.isEmpty())return NaN;switch(o){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)>t[r]&&(t[r]=this.get(r,s));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)>t[s]&&(t[s]=this.get(r,s));return t}case void 0:{let t=this.get(0,0);for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)>t&&(t=this.get(r,s));return t}default:throw new Error(`invalid option: ${o}`)}}maxIndex(){Fo(this);let o=this.get(0,0),t=[0,0];for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)>o&&(o=this.get(r,s),t[0]=r,t[1]=s);return t}min(o){if(this.isEmpty())return NaN;switch(o){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)<t[r]&&(t[r]=this.get(r,s));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)<t[s]&&(t[s]=this.get(r,s));return t}case void 0:{let t=this.get(0,0);for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)<t&&(t=this.get(r,s));return t}default:throw new Error(`invalid option: ${o}`)}}minIndex(){Fo(this);let o=this.get(0,0),t=[0,0];for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)<o&&(o=this.get(r,s),t[0]=r,t[1]=s);return t}maxRow(o){if(yo(this,o),this.isEmpty())return NaN;let t=this.get(o,0);for(let r=1;r<this.columns;r++)this.get(o,r)>t&&(t=this.get(o,r));return t}maxRowIndex(o){yo(this,o),Fo(this);let t=this.get(o,0),r=[o,0];for(let s=1;s<this.columns;s++)this.get(o,s)>t&&(t=this.get(o,s),r[1]=s);return r}minRow(o){if(yo(this,o),this.isEmpty())return NaN;let t=this.get(o,0);for(let r=1;r<this.columns;r++)this.get(o,r)<t&&(t=this.get(o,r));return t}minRowIndex(o){yo(this,o),Fo(this);let t=this.get(o,0),r=[o,0];for(let s=1;s<this.columns;s++)this.get(o,s)<t&&(t=this.get(o,s),r[1]=s);return r}maxColumn(o){if(fo(this,o),this.isEmpty())return NaN;let t=this.get(0,o);for(let r=1;r<this.rows;r++)this.get(r,o)>t&&(t=this.get(r,o));return t}maxColumnIndex(o){fo(this,o),Fo(this);let t=this.get(0,o),r=[0,o];for(let s=1;s<this.rows;s++)this.get(s,o)>t&&(t=this.get(s,o),r[0]=s);return r}minColumn(o){if(fo(this,o),this.isEmpty())return NaN;let t=this.get(0,o);for(let r=1;r<this.rows;r++)this.get(r,o)<t&&(t=this.get(r,o));return t}minColumnIndex(o){fo(this,o),Fo(this);let t=this.get(0,o),r=[0,o];for(let s=1;s<this.rows;s++)this.get(s,o)<t&&(t=this.get(s,o),r[0]=s);return r}diag(){let o=Math.min(this.rows,this.columns),t=[];for(let r=0;r<o;r++)t.push(this.get(r,r));return t}norm(o="frobenius"){let t=0;if(o==="max")return this.max();if(o==="frobenius"){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)t+=this.get(r,s)*this.get(r,s);return Math.sqrt(t)}throw new RangeError(`unknown norm type: ${o}`)}cumulativeSum(){let o=0;for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)o+=this.get(t,r),this.set(t,r,o);return this}dot(o){kr.isMatrix(o)&&(o=o.to1DArray());let t=this.to1DArray();if(t.length!==o.length)throw new RangeError("vectors do not have the same size");let r=0;for(let s=0;s<t.length;s++)r+=t[s]*o[s];return r}mmul(o){o=ur.checkMatrix(o);let t=this.rows,r=this.columns,s=o.columns,l=new ur(t,s),y=new Float64Array(r);for(let b=0;b<s;b++){for(let N=0;N<r;N++)y[N]=o.get(N,b);for(let N=0;N<t;N++){let A=0;for(let _=0;_<r;_++)A+=this.get(N,_)*y[_];l.set(N,b,A)}}return l}strassen2x2(o){o=ur.checkMatrix(o);let t=new ur(2,2);const r=this.get(0,0),s=o.get(0,0),l=this.get(0,1),y=o.get(0,1),b=this.get(1,0),N=o.get(1,0),A=this.get(1,1),_=o.get(1,1),F=(r+A)*(s+_),tt=(b+A)*s,$=r*(y-_),q=A*(N-s),L=(r+l)*_,rt=F+q-L+(l-A)*(N+_),nt=$+L,ct=tt+q,Jt=F-tt+$+(b-r)*(s+y);return t.set(0,0,rt),t.set(0,1,nt),t.set(1,0,ct),t.set(1,1,Jt),t}strassen3x3(o){o=ur.checkMatrix(o);let t=new ur(3,3);const r=this.get(0,0),s=this.get(0,1),l=this.get(0,2),y=this.get(1,0),b=this.get(1,1),N=this.get(1,2),A=this.get(2,0),_=this.get(2,1),F=this.get(2,2),tt=o.get(0,0),$=o.get(0,1),q=o.get(0,2),L=o.get(1,0),rt=o.get(1,1),nt=o.get(1,2),ct=o.get(2,0),Jt=o.get(2,1),Yt=o.get(2,2),zt=(r-y)*(-$+rt),bt=(-r+y+b)*(tt-$+rt),Ot=(y+b)*(-tt+$),Xt=r*tt,Wt=(-r+A+_)*(tt-q+nt),Z=(-r+A)*(q-nt),wt=(A+_)*(-tt+q),$t=(-l+_+F)*(rt+ct-Jt),Dt=(l-F)*(rt-Jt),ve=l*ct,ge=(_+F)*(-ct+Jt),ce=(-l+b+N)*(nt+ct-Yt),Ne=(l-N)*(nt-Yt),ke=(b+N)*(-ct+Yt),xe=Xt+ve+s*L,Le=(r+s+l-y-b-_-F)*rt+bt+Ot+Xt+$t+ve+ge,Be=Xt+Wt+wt+(r+s+l-b-N-A-_)*nt+ve+ce+ke,Ge=zt+b*(-tt+$+L-rt-nt-ct+Yt)+bt+Xt+ve+ce+Ne,de=zt+bt+Ot+Xt+N*Jt,Fe=ve+ce+Ne+ke+y*q,er=Xt+Wt+Z+_*(-tt+q+L-rt-nt-ct+Jt)+$t+Dt+ve,je=$t+Dt+ve+ge+A*$,we=Xt+Wt+Z+wt+F*Yt;return t.set(0,0,xe),t.set(0,1,Le),t.set(0,2,Be),t.set(1,0,Ge),t.set(1,1,de),t.set(1,2,Fe),t.set(2,0,er),t.set(2,1,je),t.set(2,2,we),t}mmulStrassen(o){o=ur.checkMatrix(o);let t=this.clone(),r=t.rows,s=t.columns,l=o.rows,y=o.columns;function b(_,F,tt){let $=_.rows,q=_.columns;if($===F&&q===tt)return _;{let L=kr.zeros(F,tt);return L=L.setSubMatrix(_,0,0),L}}s!==l&&console.warn(`Multiplying ${r} x ${s} and ${l} x ${y} matrix: dimensions do not match.`);let N=Math.max(r,l),A=Math.max(s,y);return t=b(t,N,A),function _(F,tt,$,q){if($<=512||q<=512)return F.mmul(tt);$%2==1&&q%2==1?(F=b(F,$+1,q+1),tt=b(tt,$+1,q+1)):$%2==1?(F=b(F,$+1,q),tt=b(tt,$+1,q)):q%2==1&&(F=b(F,$,q+1),tt=b(tt,$,q+1));let L=parseInt(F.rows/2,10),rt=parseInt(F.columns/2,10),nt=F.subMatrix(0,L-1,0,rt-1),ct=tt.subMatrix(0,L-1,0,rt-1),Jt=F.subMatrix(0,L-1,rt,F.columns-1),Yt=tt.subMatrix(0,L-1,rt,tt.columns-1),zt=F.subMatrix(L,F.rows-1,0,rt-1),bt=tt.subMatrix(L,tt.rows-1,0,rt-1),Ot=F.subMatrix(L,F.rows-1,rt,F.columns-1),Xt=tt.subMatrix(L,tt.rows-1,rt,tt.columns-1),Wt=_(kr.add(nt,Ot),kr.add(ct,Xt),L,rt),Z=_(kr.add(zt,Ot),ct,L,rt),wt=_(nt,kr.sub(Yt,Xt),L,rt),$t=_(Ot,kr.sub(bt,ct),L,rt),Dt=_(kr.add(nt,Jt),Xt,L,rt),ve=_(kr.sub(zt,nt),kr.add(ct,Yt),L,rt),ge=_(kr.sub(Jt,Ot),kr.add(bt,Xt),L,rt),ce=kr.add(Wt,$t);ce.sub(Dt),ce.add(ge);let Ne=kr.add(wt,Dt),ke=kr.add(Z,$t),xe=kr.sub(Wt,Z);xe.add(wt),xe.add(ve);let Le=kr.zeros(2*ce.rows,2*ce.columns);return Le=Le.setSubMatrix(ce,0,0),Le=Le.setSubMatrix(Ne,ce.rows,0),Le=Le.setSubMatrix(ke,0,ce.columns),Le=Le.setSubMatrix(xe,ce.rows,ce.columns),Le.subMatrix(0,$-1,0,q-1)}(t,o=b(o,N,A),N,A)}scaleRows(o={}){if(typeof o!="object")throw new TypeError("options must be an object");const{min:t=0,max:r=1}=o;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(t>=r)throw new RangeError("min must be smaller than max");let s=new ur(this.rows,this.columns);for(let l=0;l<this.rows;l++){const y=this.getRow(l);y.length>0&&Ca(y,{min:t,max:r,output:y}),s.setRow(l,y)}return s}scaleColumns(o={}){if(typeof o!="object")throw new TypeError("options must be an object");const{min:t=0,max:r=1}=o;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(t>=r)throw new RangeError("min must be smaller than max");let s=new ur(this.rows,this.columns);for(let l=0;l<this.columns;l++){const y=this.getColumn(l);y.length&&Ca(y,{min:t,max:r,output:y}),s.setColumn(l,y)}return s}flipRows(){const o=Math.ceil(this.columns/2);for(let t=0;t<this.rows;t++)for(let r=0;r<o;r++){let s=this.get(t,r),l=this.get(t,this.columns-1-r);this.set(t,r,l),this.set(t,this.columns-1-r,s)}return this}flipColumns(){const o=Math.ceil(this.rows/2);for(let t=0;t<this.columns;t++)for(let r=0;r<o;r++){let s=this.get(r,t),l=this.get(this.rows-1-r,t);this.set(r,t,l),this.set(this.rows-1-r,t,s)}return this}kroneckerProduct(o){o=ur.checkMatrix(o);let t=this.rows,r=this.columns,s=o.rows,l=o.columns,y=new ur(t*s,r*l);for(let b=0;b<t;b++)for(let N=0;N<r;N++)for(let A=0;A<s;A++)for(let _=0;_<l;_++)y.set(s*b+A,l*N+_,this.get(b,N)*o.get(A,_));return y}kroneckerSum(o){if(o=ur.checkMatrix(o),!this.isSquare()||!o.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let t=this.rows,r=o.rows,s=this.kroneckerProduct(ur.eye(r,r)),l=ur.eye(t,t).kroneckerProduct(o);return s.add(l)}transpose(){let o=new ur(this.columns,this.rows);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)o.set(r,t,this.get(t,r));return o}sortRows(o=za){for(let t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(o));return this}sortColumns(o=za){for(let t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(o));return this}subMatrix(o,t,r,s){ua(this,o,t,r,s);let l=new ur(t-o+1,s-r+1);for(let y=o;y<=t;y++)for(let b=r;b<=s;b++)l.set(y-o,b-r,this.get(y,b));return l}subMatrixRow(o,t,r){if(t===void 0&&(t=0),r===void 0&&(r=this.columns-1),t>r||t<0||t>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let s=new ur(o.length,r-t+1);for(let l=0;l<o.length;l++)for(let y=t;y<=r;y++){if(o[l]<0||o[l]>=this.rows)throw new RangeError(`Row index out of range: ${o[l]}`);s.set(l,y-t,this.get(o[l],y))}return s}subMatrixColumn(o,t,r){if(t===void 0&&(t=0),r===void 0&&(r=this.rows-1),t>r||t<0||t>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let s=new ur(r-t+1,o.length);for(let l=0;l<o.length;l++)for(let y=t;y<=r;y++){if(o[l]<0||o[l]>=this.columns)throw new RangeError(`Column index out of range: ${o[l]}`);s.set(y-t,l,this.get(y,o[l]))}return s}setSubMatrix(o,t,r){if((o=ur.checkMatrix(o)).isEmpty())return this;ua(this,t,t+o.rows-1,r,r+o.columns-1);for(let s=0;s<o.rows;s++)for(let l=0;l<o.columns;l++)this.set(t+s,r+l,o.get(s,l));return this}selection(o,t){(function(s,l){if(!eo(l))throw new TypeError("row indices must be an array");for(let y=0;y<l.length;y++)if(l[y]<0||l[y]>=s.rows)throw new RangeError("row indices are out of range")})(this,o),function(s,l){if(!eo(l))throw new TypeError("column indices must be an array");for(let y=0;y<l.length;y++)if(l[y]<0||l[y]>=s.columns)throw new RangeError("column indices are out of range")}(this,t);let r=new ur(o.length,t.length);for(let s=0;s<o.length;s++){let l=o[s];for(let y=0;y<t.length;y++){let b=t[y];r.set(s,y,this.get(l,b))}}return r}trace(){let o=Math.min(this.rows,this.columns),t=0;for(let r=0;r<o;r++)t+=this.get(r,r);return t}clone(){let o=new ur(this.rows,this.columns);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)o.set(t,r,this.get(t,r));return o}sum(o){switch(o){case"row":return function(t){let r=da(t.rows);for(let s=0;s<t.rows;++s)for(let l=0;l<t.columns;++l)r[s]+=t.get(s,l);return r}(this);case"column":return function(t){let r=da(t.columns);for(let s=0;s<t.rows;++s)for(let l=0;l<t.columns;++l)r[l]+=t.get(s,l);return r}(this);case void 0:return function(t){let r=0;for(let s=0;s<t.rows;s++)for(let l=0;l<t.columns;l++)r+=t.get(s,l);return r}(this);default:throw new Error(`invalid option: ${o}`)}}product(o){switch(o){case"row":return function(t){let r=da(t.rows,1);for(let s=0;s<t.rows;++s)for(let l=0;l<t.columns;++l)r[s]*=t.get(s,l);return r}(this);case"column":return function(t){let r=da(t.columns,1);for(let s=0;s<t.rows;++s)for(let l=0;l<t.columns;++l)r[l]*=t.get(s,l);return r}(this);case void 0:return function(t){let r=1;for(let s=0;s<t.rows;s++)for(let l=0;l<t.columns;l++)r*=t.get(s,l);return r}(this);default:throw new Error(`invalid option: ${o}`)}}mean(o){const t=this.sum(o);switch(o){case"row":for(let r=0;r<this.rows;r++)t[r]/=this.columns;return t;case"column":for(let r=0;r<this.columns;r++)t[r]/=this.rows;return t;case void 0:return t/this.size;default:throw new Error(`invalid option: ${o}`)}}variance(o,t={}){if(typeof o=="object"&&(t=o,o=void 0),typeof t!="object")throw new TypeError("options must be an object");const{unbiased:r=!0,mean:s=this.mean(o)}=t;if(typeof r!="boolean")throw new TypeError("unbiased must be a boolean");switch(o){case"row":if(!eo(s))throw new TypeError("mean must be an array");return function(l,y,b){const N=l.rows,A=l.columns,_=[];for(let F=0;F<N;F++){let tt=0,$=0,q=0;for(let L=0;L<A;L++)q=l.get(F,L)-b[F],tt+=q,$+=q*q;y?_.push(($-tt*tt/A)/(A-1)):_.push(($-tt*tt/A)/A)}return _}(this,r,s);case"column":if(!eo(s))throw new TypeError("mean must be an array");return function(l,y,b){const N=l.rows,A=l.columns,_=[];for(let F=0;F<A;F++){let tt=0,$=0,q=0;for(let L=0;L<N;L++)q=l.get(L,F)-b[F],tt+=q,$+=q*q;y?_.push(($-tt*tt/N)/(N-1)):_.push(($-tt*tt/N)/N)}return _}(this,r,s);case void 0:if(typeof s!="number")throw new TypeError("mean must be a number");return function(l,y,b){const N=l.rows,A=l.columns,_=N*A;let F=0,tt=0,$=0;for(let q=0;q<N;q++)for(let L=0;L<A;L++)$=l.get(q,L)-b,F+=$,tt+=$*$;return y?(tt-F*F/_)/(_-1):(tt-F*F/_)/_}(this,r,s);default:throw new Error(`invalid option: ${o}`)}}standardDeviation(o,t){typeof o=="object"&&(t=o,o=void 0);const r=this.variance(o,t);if(o===void 0)return Math.sqrt(r);for(let s=0;s<r.length;s++)r[s]=Math.sqrt(r[s]);return r}center(o,t={}){if(typeof o=="object"&&(t=o,o=void 0),typeof t!="object")throw new TypeError("options must be an object");const{center:r=this.mean(o)}=t;switch(o){case"row":if(!eo(r))throw new TypeError("center must be an array");return function(s,l){for(let y=0;y<s.rows;y++)for(let b=0;b<s.columns;b++)s.set(y,b,s.get(y,b)-l[y])}(this,r),this;case"column":if(!eo(r))throw new TypeError("center must be an array");return function(s,l){for(let y=0;y<s.rows;y++)for(let b=0;b<s.columns;b++)s.set(y,b,s.get(y,b)-l[b])}(this,r),this;case void 0:if(typeof r!="number")throw new TypeError("center must be a number");return function(s,l){for(let y=0;y<s.rows;y++)for(let b=0;b<s.columns;b++)s.set(y,b,s.get(y,b)-l)}(this,r),this;default:throw new Error(`invalid option: ${o}`)}}scale(o,t={}){if(typeof o=="object"&&(t=o,o=void 0),typeof t!="object")throw new TypeError("options must be an object");let r=t.scale;switch(o){case"row":if(r===void 0)r=function(s){const l=[];for(let y=0;y<s.rows;y++){let b=0;for(let N=0;N<s.columns;N++)b+=Math.pow(s.get(y,N),2)/(s.columns-1);l.push(Math.sqrt(b))}return l}(this);else if(!eo(r))throw new TypeError("scale must be an array");return function(s,l){for(let y=0;y<s.rows;y++)for(let b=0;b<s.columns;b++)s.set(y,b,s.get(y,b)/l[y])}(this,r),this;case"column":if(r===void 0)r=function(s){const l=[];for(let y=0;y<s.columns;y++){let b=0;for(let N=0;N<s.rows;N++)b+=Math.pow(s.get(N,y),2)/(s.rows-1);l.push(Math.sqrt(b))}return l}(this);else if(!eo(r))throw new TypeError("scale must be an array");return function(s,l){for(let y=0;y<s.rows;y++)for(let b=0;b<s.columns;b++)s.set(y,b,s.get(y,b)/l[b])}(this,r),this;case void 0:if(r===void 0)r=function(s){const l=s.size-1;let y=0;for(let b=0;b<s.columns;b++)for(let N=0;N<s.rows;N++)y+=Math.pow(s.get(N,b),2)/l;return Math.sqrt(y)}(this);else if(typeof r!="number")throw new TypeError("scale must be a number");return function(s,l){for(let y=0;y<s.rows;y++)for(let b=0;b<s.columns;b++)s.set(y,b,s.get(y,b)/l)}(this,r),this;default:throw new Error(`invalid option: ${o}`)}}toString(o){return La(this,o)}}function za(d,o){return d-o}kr.prototype.klass="Matrix",typeof Symbol<"u"&&(kr.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return La(this)}),kr.random=kr.rand,kr.randomInt=kr.randInt,kr.diagonal=kr.diag,kr.prototype.diagonal=kr.prototype.diag,kr.identity=kr.eye,kr.prototype.negate=kr.prototype.neg,kr.prototype.tensorProduct=kr.prototype.kroneckerProduct;class ur extends kr{constructor(o,t){if(super(),ur.isMatrix(o))return o.clone();if(Number.isInteger(o)&&o>=0){if(this.data=[],!(Number.isInteger(t)&&t>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<o;r++)this.data.push(new Float64Array(t))}else{if(!eo(o))throw new TypeError("First argument must be a positive number or an array");{const r=o;if(typeof(t=(o=r.length)?r[0].length:0)!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let s=0;s<o;s++){if(r[s].length!==t)throw new RangeError("Inconsistent array dimensions");if(!r[s].every(l=>typeof l=="number"))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[s]))}}}this.rows=o,this.columns=t}set(o,t,r){return this.data[o][t]=r,this}get(o,t){return this.data[o][t]}removeRow(o){return yo(this,o),this.data.splice(o,1),this.rows-=1,this}addRow(o,t){return t===void 0&&(t=o,o=this.rows),yo(this,o,!0),t=Float64Array.from(ei(this,t)),this.data.splice(o,0,t),this.rows+=1,this}removeColumn(o){fo(this,o);for(let t=0;t<this.rows;t++){const r=new Float64Array(this.columns-1);for(let s=0;s<o;s++)r[s]=this.data[t][s];for(let s=o+1;s<this.columns;s++)r[s-1]=this.data[t][s];this.data[t]=r}return this.columns-=1,this}addColumn(o,t){t===void 0&&(t=o,o=this.columns),fo(this,o,!0),t=mi(this,t);for(let r=0;r<this.rows;r++){const s=new Float64Array(this.columns+1);let l=0;for(;l<o;l++)s[l]=this.data[r][l];for(s[l++]=t[r];l<this.columns+1;l++)s[l]=this.data[r][l-1];this.data[r]=s}return this.columns+=1,this}}(function(d,o){d.prototype.add=function(t){return typeof t=="number"?this.addS(t):this.addM(t)},d.prototype.addS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)+t);return this},d.prototype.addM=function(t){if(t=o.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)+t.get(r,s));return this},d.add=function(t,r){return new o(t).add(r)},d.prototype.sub=function(t){return typeof t=="number"?this.subS(t):this.subM(t)},d.prototype.subS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)-t);return this},d.prototype.subM=function(t){if(t=o.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)-t.get(r,s));return this},d.sub=function(t,r){return new o(t).sub(r)},d.prototype.subtract=d.prototype.sub,d.prototype.subtractS=d.prototype.subS,d.prototype.subtractM=d.prototype.subM,d.subtract=d.sub,d.prototype.mul=function(t){return typeof t=="number"?this.mulS(t):this.mulM(t)},d.prototype.mulS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)*t);return this},d.prototype.mulM=function(t){if(t=o.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)*t.get(r,s));return this},d.mul=function(t,r){return new o(t).mul(r)},d.prototype.multiply=d.prototype.mul,d.prototype.multiplyS=d.prototype.mulS,d.prototype.multiplyM=d.prototype.mulM,d.multiply=d.mul,d.prototype.div=function(t){return typeof t=="number"?this.divS(t):this.divM(t)},d.prototype.divS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)/t);return this},d.prototype.divM=function(t){if(t=o.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)/t.get(r,s));return this},d.div=function(t,r){return new o(t).div(r)},d.prototype.divide=d.prototype.div,d.prototype.divideS=d.prototype.divS,d.prototype.divideM=d.prototype.divM,d.divide=d.div,d.prototype.mod=function(t){return typeof t=="number"?this.modS(t):this.modM(t)},d.prototype.modS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)%t);return this},d.prototype.modM=function(t){if(t=o.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)%t.get(r,s));return this},d.mod=function(t,r){return new o(t).mod(r)},d.prototype.modulus=d.prototype.mod,d.prototype.modulusS=d.prototype.modS,d.prototype.modulusM=d.prototype.modM,d.modulus=d.mod,d.prototype.and=function(t){return typeof t=="number"?this.andS(t):this.andM(t)},d.prototype.andS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)&t);return this},d.prototype.andM=function(t){if(t=o.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)&t.get(r,s));return this},d.and=function(t,r){return new o(t).and(r)},d.prototype.or=function(t){return typeof t=="number"?this.orS(t):this.orM(t)},d.prototype.orS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)|t);return this},d.prototype.orM=function(t){if(t=o.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)|t.get(r,s));return this},d.or=function(t,r){return new o(t).or(r)},d.prototype.xor=function(t){return typeof t=="number"?this.xorS(t):this.xorM(t)},d.prototype.xorS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)^t);return this},d.prototype.xorM=function(t){if(t=o.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)^t.get(r,s));return this},d.xor=function(t,r){return new o(t).xor(r)},d.prototype.leftShift=function(t){return typeof t=="number"?this.leftShiftS(t):this.leftShiftM(t)},d.prototype.leftShiftS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)<<t);return this},d.prototype.leftShiftM=function(t){if(t=o.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)<<t.get(r,s));return this},d.leftShift=function(t,r){return new o(t).leftShift(r)},d.prototype.signPropagatingRightShift=function(t){return typeof t=="number"?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},d.prototype.signPropagatingRightShiftS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)>>t);return this},d.prototype.signPropagatingRightShiftM=function(t){if(t=o.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)>>t.get(r,s));return this},d.signPropagatingRightShift=function(t,r){return new o(t).signPropagatingRightShift(r)},d.prototype.rightShift=function(t){return typeof t=="number"?this.rightShiftS(t):this.rightShiftM(t)},d.prototype.rightShiftS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)>>>t);return this},d.prototype.rightShiftM=function(t){if(t=o.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,this.get(r,s)>>>t.get(r,s));return this},d.rightShift=function(t,r){return new o(t).rightShift(r)},d.prototype.zeroFillRightShift=d.prototype.rightShift,d.prototype.zeroFillRightShiftS=d.prototype.rightShiftS,d.prototype.zeroFillRightShiftM=d.prototype.rightShiftM,d.zeroFillRightShift=d.rightShift,d.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,~this.get(t,r));return this},d.not=function(t){return new o(t).not()},d.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.abs(this.get(t,r)));return this},d.abs=function(t){return new o(t).abs()},d.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.acos(this.get(t,r)));return this},d.acos=function(t){return new o(t).acos()},d.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.acosh(this.get(t,r)));return this},d.acosh=function(t){return new o(t).acosh()},d.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.asin(this.get(t,r)));return this},d.asin=function(t){return new o(t).asin()},d.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.asinh(this.get(t,r)));return this},d.asinh=function(t){return new o(t).asinh()},d.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.atan(this.get(t,r)));return this},d.atan=function(t){return new o(t).atan()},d.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.atanh(this.get(t,r)));return this},d.atanh=function(t){return new o(t).atanh()},d.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.cbrt(this.get(t,r)));return this},d.cbrt=function(t){return new o(t).cbrt()},d.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.ceil(this.get(t,r)));return this},d.ceil=function(t){return new o(t).ceil()},d.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.clz32(this.get(t,r)));return this},d.clz32=function(t){return new o(t).clz32()},d.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.cos(this.get(t,r)));return this},d.cos=function(t){return new o(t).cos()},d.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.cosh(this.get(t,r)));return this},d.cosh=function(t){return new o(t).cosh()},d.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.exp(this.get(t,r)));return this},d.exp=function(t){return new o(t).exp()},d.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.expm1(this.get(t,r)));return this},d.expm1=function(t){return new o(t).expm1()},d.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.floor(this.get(t,r)));return this},d.floor=function(t){return new o(t).floor()},d.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.fround(this.get(t,r)));return this},d.fround=function(t){return new o(t).fround()},d.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log(this.get(t,r)));return this},d.log=function(t){return new o(t).log()},d.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log1p(this.get(t,r)));return this},d.log1p=function(t){return new o(t).log1p()},d.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log10(this.get(t,r)));return this},d.log10=function(t){return new o(t).log10()},d.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log2(this.get(t,r)));return this},d.log2=function(t){return new o(t).log2()},d.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.round(this.get(t,r)));return this},d.round=function(t){return new o(t).round()},d.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sign(this.get(t,r)));return this},d.sign=function(t){return new o(t).sign()},d.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sin(this.get(t,r)));return this},d.sin=function(t){return new o(t).sin()},d.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sinh(this.get(t,r)));return this},d.sinh=function(t){return new o(t).sinh()},d.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sqrt(this.get(t,r)));return this},d.sqrt=function(t){return new o(t).sqrt()},d.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.tan(this.get(t,r)));return this},d.tan=function(t){return new o(t).tan()},d.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.tanh(this.get(t,r)));return this},d.tanh=function(t){return new o(t).tanh()},d.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.trunc(this.get(t,r)));return this},d.trunc=function(t){return new o(t).trunc()},d.pow=function(t,r){return new o(t).pow(r)},d.prototype.pow=function(t){return typeof t=="number"?this.powS(t):this.powM(t)},d.prototype.powS=function(t){for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,Math.pow(this.get(r,s),t));return this},d.prototype.powM=function(t){if(t=o.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.set(r,s,Math.pow(this.get(r,s),t.get(r,s)));return this}})(kr,ur);class ca extends kr{constructor(o){super(),this.data=o,this.rows=o.length,this.columns=o[0].length}set(o,t,r){return this.data[o][t]=r,this}get(o,t){return this.data[o][t]}}function _o(d,o){let t=0;return Math.abs(d)>Math.abs(o)?(t=o/d,Math.abs(d)*Math.sqrt(1+t*t)):o!==0?(t=d/o,Math.abs(o)*Math.sqrt(1+t*t)):0}class ns{constructor(o,t={}){if((o=ca.checkMatrix(o)).isEmpty())throw new Error("Matrix must be non-empty");let r=o.rows,s=o.columns;const{computeLeftSingularVectors:l=!0,computeRightSingularVectors:y=!0,autoTranspose:b=!1}=t;let N,A=Boolean(l),_=Boolean(y),F=!1;if(r<s)if(b){N=o.transpose(),r=N.rows,s=N.columns,F=!0;let Z=A;A=_,_=Z}else N=o.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else N=o.clone();let tt=Math.min(r,s),$=Math.min(r+1,s),q=new Float64Array($),L=new ur(r,tt),rt=new ur(s,s),nt=new Float64Array(s),ct=new Float64Array(r),Jt=new Float64Array($);for(let Z=0;Z<$;Z++)Jt[Z]=Z;let Yt=Math.min(r-1,s),zt=Math.max(0,Math.min(s-2,r)),bt=Math.max(Yt,zt);for(let Z=0;Z<bt;Z++){if(Z<Yt){q[Z]=0;for(let wt=Z;wt<r;wt++)q[Z]=_o(q[Z],N.get(wt,Z));if(q[Z]!==0){N.get(Z,Z)<0&&(q[Z]=-q[Z]);for(let wt=Z;wt<r;wt++)N.set(wt,Z,N.get(wt,Z)/q[Z]);N.set(Z,Z,N.get(Z,Z)+1)}q[Z]=-q[Z]}for(let wt=Z+1;wt<s;wt++){if(Z<Yt&&q[Z]!==0){let $t=0;for(let Dt=Z;Dt<r;Dt++)$t+=N.get(Dt,Z)*N.get(Dt,wt);$t=-$t/N.get(Z,Z);for(let Dt=Z;Dt<r;Dt++)N.set(Dt,wt,N.get(Dt,wt)+$t*N.get(Dt,Z))}nt[wt]=N.get(Z,wt)}if(A&&Z<Yt)for(let wt=Z;wt<r;wt++)L.set(wt,Z,N.get(wt,Z));if(Z<zt){nt[Z]=0;for(let wt=Z+1;wt<s;wt++)nt[Z]=_o(nt[Z],nt[wt]);if(nt[Z]!==0){nt[Z+1]<0&&(nt[Z]=0-nt[Z]);for(let wt=Z+1;wt<s;wt++)nt[wt]/=nt[Z];nt[Z+1]+=1}if(nt[Z]=-nt[Z],Z+1<r&&nt[Z]!==0){for(let wt=Z+1;wt<r;wt++)ct[wt]=0;for(let wt=Z+1;wt<r;wt++)for(let $t=Z+1;$t<s;$t++)ct[wt]+=nt[$t]*N.get(wt,$t);for(let wt=Z+1;wt<s;wt++){let $t=-nt[wt]/nt[Z+1];for(let Dt=Z+1;Dt<r;Dt++)N.set(Dt,wt,N.get(Dt,wt)+$t*ct[Dt])}}if(_)for(let wt=Z+1;wt<s;wt++)rt.set(wt,Z,nt[wt])}}let Ot=Math.min(s,r+1);if(Yt<s&&(q[Yt]=N.get(Yt,Yt)),r<Ot&&(q[Ot-1]=0),zt+1<Ot&&(nt[zt]=N.get(zt,Ot-1)),nt[Ot-1]=0,A){for(let Z=Yt;Z<tt;Z++){for(let wt=0;wt<r;wt++)L.set(wt,Z,0);L.set(Z,Z,1)}for(let Z=Yt-1;Z>=0;Z--)if(q[Z]!==0){for(let wt=Z+1;wt<tt;wt++){let $t=0;for(let Dt=Z;Dt<r;Dt++)$t+=L.get(Dt,Z)*L.get(Dt,wt);$t=-$t/L.get(Z,Z);for(let Dt=Z;Dt<r;Dt++)L.set(Dt,wt,L.get(Dt,wt)+$t*L.get(Dt,Z))}for(let wt=Z;wt<r;wt++)L.set(wt,Z,-L.get(wt,Z));L.set(Z,Z,1+L.get(Z,Z));for(let wt=0;wt<Z-1;wt++)L.set(wt,Z,0)}else{for(let wt=0;wt<r;wt++)L.set(wt,Z,0);L.set(Z,Z,1)}}if(_)for(let Z=s-1;Z>=0;Z--){if(Z<zt&&nt[Z]!==0)for(let wt=Z+1;wt<s;wt++){let $t=0;for(let Dt=Z+1;Dt<s;Dt++)$t+=rt.get(Dt,Z)*rt.get(Dt,wt);$t=-$t/rt.get(Z+1,Z);for(let Dt=Z+1;Dt<s;Dt++)rt.set(Dt,wt,rt.get(Dt,wt)+$t*rt.get(Dt,Z))}for(let wt=0;wt<s;wt++)rt.set(wt,Z,0);rt.set(Z,Z,1)}let Xt=Ot-1,Wt=Number.EPSILON;for(;Ot>0;){let Z,wt;for(Z=Ot-2;Z>=-1&&Z!==-1;Z--){const $t=Number.MIN_VALUE+Wt*Math.abs(q[Z]+Math.abs(q[Z+1]));if(Math.abs(nt[Z])<=$t||Number.isNaN(nt[Z])){nt[Z]=0;break}}if(Z===Ot-2)wt=4;else{let $t;for($t=Ot-1;$t>=Z&&$t!==Z;$t--){let Dt=($t!==Ot?Math.abs(nt[$t]):0)+($t!==Z+1?Math.abs(nt[$t-1]):0);if(Math.abs(q[$t])<=Wt*Dt){q[$t]=0;break}}$t===Z?wt=3:$t===Ot-1?wt=1:(wt=2,Z=$t)}switch(Z++,wt){case 1:{let $t=nt[Ot-2];nt[Ot-2]=0;for(let Dt=Ot-2;Dt>=Z;Dt--){let ve=_o(q[Dt],$t),ge=q[Dt]/ve,ce=$t/ve;if(q[Dt]=ve,Dt!==Z&&($t=-ce*nt[Dt-1],nt[Dt-1]=ge*nt[Dt-1]),_)for(let Ne=0;Ne<s;Ne++)ve=ge*rt.get(Ne,Dt)+ce*rt.get(Ne,Ot-1),rt.set(Ne,Ot-1,-ce*rt.get(Ne,Dt)+ge*rt.get(Ne,Ot-1)),rt.set(Ne,Dt,ve)}break}case 2:{let $t=nt[Z-1];nt[Z-1]=0;for(let Dt=Z;Dt<Ot;Dt++){let ve=_o(q[Dt],$t),ge=q[Dt]/ve,ce=$t/ve;if(q[Dt]=ve,$t=-ce*nt[Dt],nt[Dt]=ge*nt[Dt],A)for(let Ne=0;Ne<r;Ne++)ve=ge*L.get(Ne,Dt)+ce*L.get(Ne,Z-1),L.set(Ne,Z-1,-ce*L.get(Ne,Dt)+ge*L.get(Ne,Z-1)),L.set(Ne,Dt,ve)}break}case 3:{const $t=Math.max(Math.abs(q[Ot-1]),Math.abs(q[Ot-2]),Math.abs(nt[Ot-2]),Math.abs(q[Z]),Math.abs(nt[Z])),Dt=q[Ot-1]/$t,ve=q[Ot-2]/$t,ge=nt[Ot-2]/$t,ce=q[Z]/$t,Ne=nt[Z]/$t,ke=((ve+Dt)*(ve-Dt)+ge*ge)/2,xe=Dt*ge*(Dt*ge);let Le=0;ke===0&&xe===0||(Le=ke<0?0-Math.sqrt(ke*ke+xe):Math.sqrt(ke*ke+xe),Le=xe/(ke+Le));let Be=(ce+Dt)*(ce-Dt)+Le,Ge=ce*Ne;for(let de=Z;de<Ot-1;de++){let Fe=_o(Be,Ge);Fe===0&&(Fe=Number.MIN_VALUE);let er=Be/Fe,je=Ge/Fe;if(de!==Z&&(nt[de-1]=Fe),Be=er*q[de]+je*nt[de],nt[de]=er*nt[de]-je*q[de],Ge=je*q[de+1],q[de+1]=er*q[de+1],_)for(let we=0;we<s;we++)Fe=er*rt.get(we,de)+je*rt.get(we,de+1),rt.set(we,de+1,-je*rt.get(we,de)+er*rt.get(we,de+1)),rt.set(we,de,Fe);if(Fe=_o(Be,Ge),Fe===0&&(Fe=Number.MIN_VALUE),er=Be/Fe,je=Ge/Fe,q[de]=Fe,Be=er*nt[de]+je*q[de+1],q[de+1]=-je*nt[de]+er*q[de+1],Ge=je*nt[de+1],nt[de+1]=er*nt[de+1],A&&de<r-1)for(let we=0;we<r;we++)Fe=er*L.get(we,de)+je*L.get(we,de+1),L.set(we,de+1,-je*L.get(we,de)+er*L.get(we,de+1)),L.set(we,de,Fe)}nt[Ot-2]=Be;break}case 4:if(q[Z]<=0&&(q[Z]=q[Z]<0?-q[Z]:0,_))for(let $t=0;$t<=Xt;$t++)rt.set($t,Z,-rt.get($t,Z));for(;Z<Xt&&!(q[Z]>=q[Z+1]);){let $t=q[Z];if(q[Z]=q[Z+1],q[Z+1]=$t,_&&Z<s-1)for(let Dt=0;Dt<s;Dt++)$t=rt.get(Dt,Z+1),rt.set(Dt,Z+1,rt.get(Dt,Z)),rt.set(Dt,Z,$t);if(A&&Z<r-1)for(let Dt=0;Dt<r;Dt++)$t=L.get(Dt,Z+1),L.set(Dt,Z+1,L.get(Dt,Z)),L.set(Dt,Z,$t);Z++}Ot--}}if(F){let Z=rt;rt=L,L=Z}this.m=r,this.n=s,this.s=q,this.U=L,this.V=rt}solve(o){let t=o,r=this.threshold,s=this.s.length,l=ur.zeros(s,s);for(let tt=0;tt<s;tt++)Math.abs(this.s[tt])<=r?l.set(tt,tt,0):l.set(tt,tt,1/this.s[tt]);let y=this.U,b=this.rightSingularVectors,N=b.mmul(l),A=b.rows,_=y.rows,F=ur.zeros(A,_);for(let tt=0;tt<A;tt++)for(let $=0;$<_;$++){let q=0;for(let L=0;L<s;L++)q+=N.get(tt,L)*y.get($,L);F.set(tt,$,q)}return F.mmul(t)}solveForDiagonal(o){return this.solve(ur.diag(o))}inverse(){let o=this.V,t=this.threshold,r=o.rows,s=o.columns,l=new ur(r,this.s.length);for(let _=0;_<r;_++)for(let F=0;F<s;F++)Math.abs(this.s[F])>t&&l.set(_,F,o.get(_,F)/this.s[F]);let y=this.U,b=y.rows,N=y.columns,A=new ur(r,b);for(let _=0;_<r;_++)for(let F=0;F<b;F++){let tt=0;for(let $=0;$<N;$++)tt+=l.get(_,$)*y.get(F,$);A.set(_,F,tt)}return A}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let o=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,t=0,r=this.s;for(let s=0,l=r.length;s<l;s++)r[s]>o&&t++;return t}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return ur.diag(this.s)}}var ha={center:[0,0],linkDistance:50},ko=function(){function d(o){o===void 0&&(o={}),this.options=o,this.id="mds",this.options=a(a({},ha),o)}return d.prototype.execute=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return[2,this.genericMDSLayout(!1,o,t)]})})},d.prototype.assign=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return this.genericMDSLayout(!0,o,t),[2]})})},d.prototype.genericMDSLayout=function(o,t,r){return w(this,void 0,void 0,function(){var s,l,y,b,N,A,_,F,tt,$,q,L;return m(this,function(rt){return s=a(a({},this.options),r),l=s.center,y=l===void 0?[0,0]:l,b=s.linkDistance,N=b===void 0?50:b,A=t.getAllNodes(),_=t.getAllEdges(),(A==null?void 0:A.length)&&A.length!==1?(F=re({nodes:A,edges:_},!1),tt=ze(F),Pi(tt),$=ir(tt,N),q=yi($),L=[],q.forEach(function(nt,ct){var Jt=zr(A[ct]);Jt.data.x=nt[0]+y[0],Jt.data.y=nt[1]+y[1],L.push(Jt)}),o&&L.forEach(function(nt){return t.mergeNodeData(nt.id,{x:nt.data.x,y:nt.data.y})}),[2,{nodes:L,edges:_}]):[2,Ce(t,o,y)]})})},d}(),Pi=function(d){var o=-999999;d.forEach(function(t){t.forEach(function(r){r!==1/0&&o<r&&(o=r)})}),d.forEach(function(t,r){t.forEach(function(s,l){s===1/0&&(d[r][l]=o)})})},yi=function(d){var o=ur.mul(ur.pow(d,2),-.5),t=o.mean("row"),r=o.mean("column"),s=o.mean();o.add(s).subRowVector(t).subColumnVector(r);var l=new ns(o),y=ur.sqrt(l.diagonalMatrix).diagonal();return l.leftSingularVectors.toJSON().map(function(b){return ur.mul([b],[y]).toJSON()[0].splice(0,2)})},la={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},wi=function(d,o,t,r,s,l){o.forEach(function(y,b){t[b]={x:0,y:0},o.forEach(function(N,A){if(b!==A&&s[b]===s[A]){var _=y.x-N.x,F=y.y-N.y,tt=Math.sqrt(_*_+F*F);if(tt===0){tt=1;var $=b>A?1:-1;_=.01*$,F=.01*$}if(tt<l(d[b])/2+l(d[A])/2){var q=r*r/tt;t[b].x+=_/tt*q,t[b].y+=F/tt*q}}})})},ri=function(d,o,t,r,s,l,y,b){var N=l||y/10;return r&&o.forEach(function(A,_){var F=d[_].x-d[s].x,tt=d[_].y-d[s].y,$=Math.sqrt(F*F+tt*tt),q=tt/$,L=-F/$,rt=Math.sqrt(A.x*A.x+A.y*A.y),nt=Math.acos((q*A.x+L*A.y)/rt);nt>Math.PI/2&&(nt-=Math.PI/2,q*=-1,L*=-1);var ct=Math.cos(nt)*rt;A.x=q*ct,A.y=L*ct}),d.forEach(function(A,_){if(_!==s){var F=Math.sqrt(o[_].x*o[_].x+o[_].y*o[_].y);if(F>0&&_!==s){var tt=Math.min(N*(t/800),F);if(A.x+=o[_].x/F*tt,A.y+=o[_].y/F*tt,r){var $=A.x-d[s].x,q=A.y-d[s].y,L=Math.sqrt($*$+q*q);$=$/L*b[_],q=q/L*b[_],A.x=d[s].x+$,A.y=d[s].y+q}}}}),d},ni={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},jo=function(){function d(o){o===void 0&&(o={}),this.options=o,this.id="radial",this.options=a(a({},ni),o)}return d.prototype.execute=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return[2,this.genericRadialLayout(!1,o,t)]})})},d.prototype.assign=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return this.genericRadialLayout(!0,o,t),[2]})})},d.prototype.genericRadialLayout=function(o,t,r){return w(this,void 0,void 0,function(){var s,l,y,b,N,A,_,F,tt,$,q,L,rt,nt,ct,Jt,Yt,zt,bt,Ot,Xt,Wt,Z,wt,$t,Dt,ve,ge,ce,Ne,ke,xe,Le,Be,Ge,de,Fe,er,je,we,lr,tn,Ir;return m(this,function(ro){if(s=a(a({},this.options),r),l=s.width,y=s.height,b=s.center,N=s.focusNode,A=s.unitRadius,_=s.nodeSize,F=s.nodeSpacing,tt=s.strictRadial,$=s.preventOverlap,q=s.maxPreventOverlapIteration,L=s.sortBy,rt=s.linkDistance,nt=rt===void 0?50:rt,ct=s.sortStrength,Jt=ct===void 0?10:ct,Yt=s.maxIteration,zt=Yt===void 0?1e3:Yt,bt=t.getAllNodes(),Ot=t.getAllEdges(),Xt=l||typeof window>"u"?l:window.innerWidth,Wt=y||typeof window>"u"?y:window.innerHeight,Z=b||[Xt/2,Wt/2],!(bt!=null&&bt.length)||bt.length===1)return[2,Ce(t,o,Z)];if(wt=bt[0],Vn(N)){for($t=0;$t<bt.length;$t++)if(bt[$t].id===N){wt=bt[$t];break}}else wt=N||bt[0];return Dt=ga(bt,wt.id),ve=re({nodes:bt,edges:Ot},!1),ge=ze(ve),ce=is(ge,Dt),os(ge,Dt,ce+1),Ne=ge[Dt],ke=Xt-Z[0]>Z[0]?Z[0]:Xt-Z[0],xe=Wt-Z[1]>Z[1]?Z[1]:Wt-Z[1],ke===0&&(ke=Xt/2),xe===0&&(xe=Wt/2),Le=Math.min(ke,xe),Be=Math.max.apply(Math,R([],E(Ne))),Ge=[],de=A||Le/Be,Ne.forEach(function(Tr,Nr){Ge[Nr]=Tr*de}),Fe=zi(bt,ge,nt,Ge,de,L,Jt),er=fa(Fe),je=function(Tr,Nr,fr){try{var vr=ur.mul(ur.pow(Nr,2),-.5),sn=vr.mean("row"),jr=vr.mean("column"),Lr=vr.mean();vr.add(Lr).subRowVector(sn).subColumnVector(jr);var Fn=new ns(vr),vn=ur.sqrt(Fn.diagonalMatrix).diagonal();return Fn.leftSingularVectors.toJSON().map(function(Uo){return ur.mul([Uo],[vn]).toJSON()[0].splice(0,Tr)})}catch{for(var wr=[],on=0;on<Nr.length;on++){var tr=Math.random()*fr,pa=Math.random()*fr;wr.push([tr,pa])}return wr}}(nt,Fe,nt),we=je.map(function(Tr){var Nr=E(Tr,2),fr=Nr[0],vr=Nr[1];return{x:(isNaN(fr)?Math.random()*nt:fr)-je[Dt][0],y:(isNaN(vr)?Math.random()*nt:vr)-je[Dt][1]}}),this.run(zt,we,er,Fe,Ge,Dt),$&&(lr=Me(_,F),tn={nodes:bt,nodeSizeFunc:lr,positions:we,radii:Ge,height:Wt,width:Xt,strictRadial:Boolean(tt),focusIdx:Dt,iterations:q||200,k:we.length/4.5},we=function(Tr,Nr){for(var fr=a(a({},la),Nr),vr=fr.positions,sn=fr.iterations,jr=fr.width,Lr=fr.k,Fn=fr.speed,vn=Fn===void 0?100:Fn,wr=fr.strictRadial,on=fr.focusIdx,tr=fr.radii,pa=tr===void 0?[]:tr,Uo=fr.nodeSizeFunc,_s=Tr.getAllNodes(),Ga=[],as=jr/10,ss=0;ss<sn;ss++)vr.forEach(function(Y,Tt){Ga[Tt]={x:0,y:0}}),wi(_s,vr,Ga,Lr,pa,Uo),ri(vr,Ga,vn,wr,on,as,jr,pa);return vr}(t,tn)),Ir=[],we.forEach(function(Tr,Nr){var fr=zr(bt[Nr]);fr.data.x=Tr.x+Z[0],fr.data.y=Tr.y+Z[1],Ir.push(fr)}),o&&Ir.forEach(function(Tr){return t.mergeNodeData(Tr.id,{x:Tr.data.x,y:Tr.data.y})}),[2,{nodes:Ir,edges:Ot}]})})},d.prototype.run=function(o,t,r,s,l,y){for(var b=0;b<=o;b++){var N=b/o;this.oneIteration(N,t,l,s,r,y)}},d.prototype.oneIteration=function(o,t,r,s,l,y){var b=1-o;t.forEach(function(N,A){var _=Yn(N,{x:0,y:0}),F=_===0?0:1/_;if(A!==y){var tt=0,$=0,q=0;t.forEach(function(rt,nt){if(A!==nt){var ct=Yn(N,rt),Jt=ct===0?0:1/ct,Yt=s[nt][A];q+=l[A][nt],tt+=l[A][nt]*(rt.x+Yt*(N.x-rt.x)*Jt),$+=l[A][nt]*(rt.y+Yt*(N.y-rt.y)*Jt)}});var L=r[A]===0?0:1/r[A];q*=b,q+=o*L*L,tt*=b,tt+=o*L*N.x*F,N.x=tt/q,$*=b,$+=o*L*N.y*F,N.y=$/q}})},d}(),zi=function(d,o,t,r,s,l,y){if(!d)return[];var b=[];if(o){var N={};o.forEach(function(A,_){var F=[];A.forEach(function(tt,$){var q,L;if(_===$)F.push(0);else if(r[_]===r[$])if(l==="data")F.push(tt*(Math.abs(_-$)*y)/(r[_]/s));else if(l){var rt=void 0,nt=void 0;if(N[d[_].id])rt=N[d[_].id];else{var ct=(l==="id"?d[_].id:(q=d[_].data)===null||q===void 0?void 0:q[l])||0;rt=Vn(ct)?ct.charCodeAt(0):ct,N[d[_].id]=rt}N[d[$].id]?nt=N[d[$].id]:(ct=(l==="id"?d[$].id:(L=d[$].data)===null||L===void 0?void 0:L[l])||0,nt=Vn(ct)?ct.charCodeAt(0):ct,N[d[$].id]=nt),F.push(tt*(Math.abs(rt-nt)*y)/(r[_]/s))}else F.push(tt*t/(r[_]/s));else{var Jt=(t+s)/2;F.push(tt*Jt)}}),b.push(F)})}return b},fa=function(d){for(var o=d.length,t=d[0].length,r=[],s=0;s<o;s++){for(var l=[],y=0;y<t;y++)d[s][y]!==0?l.push(1/(d[s][y]*d[s][y])):l.push(0);r.push(l)}return r},ga=function(d,o){var t=-1;return d.forEach(function(r,s){r.id===o&&(t=s)}),Math.max(t,0)},os=function(d,o,t){for(var r=d.length,s=0;s<r;s++)if(d[o][s]===1/0){d[o][s]=t,d[s][o]=t;for(var l=0;l<r;l++)d[s][l]!==1/0&&d[o][l]===1/0&&(d[o][l]=t+d[s][l],d[l][o]=t+d[s][l])}for(s=0;s<r;s++)if(s!==o){for(l=0;l<r;l++)if(d[s][l]===1/0){var y=Math.abs(d[o][s]-d[o][l]);y=y===0?1:y,d[s][l]=y}}},is=function(d,o){for(var t=0,r=0;r<d[o].length;r++)d[o][r]!==1/0&&(t=d[o][r]>t?d[o][r]:t);return t},Gi={center:[0,0],width:300,height:300},Ei=function(){function d(o){o===void 0&&(o={}),this.options=o,this.id="random",this.options=a(a({},Gi),o)}return d.prototype.execute=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return[2,this.genericRandomLayout(!1,o,t)]})})},d.prototype.assign=function(o,t){return w(this,void 0,void 0,function(){return m(this,function(r){return this.genericRandomLayout(!0,o,t),[2]})})},d.prototype.genericRandomLayout=function(o,t,r){return w(this,void 0,void 0,function(){var s,l,y,b,N,A,_,F,tt;return m(this,function($){return s=a(a({},this.options),r),l=s.center,y=s.width,b=s.height,N=t.getAllNodes(),A=y||typeof window>"u"?y:window.innerWidth,_=b||typeof window>"u"?b:window.innerHeight,F=l||[A/2,_/2],tt=[],N&&N.forEach(function(q){tt.push({id:q.id,data:{x:.9*(Math.random()-.5)*A+F[0],y:.9*(Math.random()-.5)*_+F[1]}})}),o&&tt.forEach(function(q){return t.mergeNodeData(q.id,{x:q.data.x,y:q.data.y})}),[2,{nodes:tt,edges:t.getAllEdges()}]})})},d}(),As={circular:Ye,concentric:In,mds:ko,random:Ei,grid:ia,radial:jo,force:Ta,d3force:he,fruchterman:na,forceAtlas2:Qo,dagre:Da};function zs(d,o){As[d]=o}function Ss(d){return!!d.tick&&!!d.stop}})();Zr.SB;Zr.W1;Zr.jA;Zr.Vq;var ic=Zr.E9,ac=Zr.y7,sc=Zr.O2;Zr.Me;Zr.AI;Zr.D4;Zr._5;Zr.y9;Zr._A;Zr.d9;Zr.ul;Zr.qs;Zr.gl;Zr.jE;Zr.tO;Zr.zJ;Zr.h$;Zr.BI;Zr.$y;Zr.H0;Zr.kJ;Zr.hY;Zr.qR;Zr.i_;Zr.nu;Zr.He;Zr.A3;function cd(p,h,a){const f=[],w=[];return Object.keys(h).forEach(m=>{a&&a(h[m]),f.push(h[m].x,h[m].y)}),p.edges().forEach(m=>{const E=p.source(m),R=p.target(m);w.push(h[E].x,h[E].y,h[R].x,h[R].y)}),{nodes:f,edges:w}}function Vs(p){const h=[],a=[],f={};return p.nodes.forEach(({id:w,data:{x:m,y:E}})=>{f[w]={x:m,y:E},h.push(m,E)}),p.edges.forEach(({source:w,target:m})=>{const E=f[w].x,R=f[w].y,H=f[m].x,gt=f[m].y;a.push(E,R,H,gt)}),{nodes:h,edges:a}}function lu(p,h){const a=[];return h.forEach(([f,w])=>{a.push(p[f*2],p[f*2+1],p[w*2],p[w*2+1])}),{nodes:p,edges:a}}var Bn=(p=>(p.GRAPHOLOGY="graphology",p.ANTV_LAYOUT="@antv/layout",p.ANTV_LAYOUT_WASM_SINGLETHREAD="@antv/layout-wasm - singlethread",p.ANTV_LAYOUT_WASM_MULTITHREADS="@antv/layout-wasm - multithreads",p.ANTV_LAYOUT_GPU="@antv/layout-gpu",p))(Bn||{});const Br=800;var fu=(p,h,a)=>new Promise((f,w)=>{var m=H=>{try{R(a.next(H))}catch(gt){w(gt)}},E=H=>{try{R(a.throw(H))}catch(gt){w(gt)}},R=H=>H.done?f(H.value):Promise.resolve(H.value).then(m,E);R((a=a.apply(p,h)).next())});const gu=100,pu=1,vu=1;function uc(p,h){return fu(this,arguments,function*(a,{iterations:f}){const w=nc(a,{settings:{barnesHutOptimize:!1,strongGravityMode:!1,gravity:pu,scalingRatio:vu,slowDown:1},iterations:f||gu,getEdgeWeight:"weight"});return cd(a,w)})}function dc(p,h){return fu(this,arguments,function*(a,{iterations:f}){const m=yield new ic({kr:vu,kg:pu,ks:.1,maxIteration:f||gu,width:Br,height:Br,center:[Br/2,Br/2]}).execute(a);return Vs(m)})}function Vu(p,h,a){return fu(this,arguments,function*({nodes:f,edges:w,masses:m,weights:E},{iterations:R},{forceatlas2:H}){const{nodes:gt}=yield H({nodes:f.length,edges:w,positions:f,masses:m,weights:E,iterations:R||gu,ka:1,kg:pu,kr:vu,speed:.1,prevent_overlapping:!1,node_radius:10,kr_prime:10,strong_gravity:!1,lin_log:!1,dissuade_hubs:!1,center:[Br/2,Br/2]});return lu(gt,w)})}/*! For license information please see index.esm.js.LICENSE.txt */var cc={737:(p,h,a)=>{var f=a(68).default;function w(){p.exports=w=function(){return m},p.exports.__esModule=!0,p.exports.default=p.exports;var m={},E=Object.prototype,R=E.hasOwnProperty,H=Object.defineProperty||function(De,Me,Ce){De[Me]=Ce.value},gt=typeof Symbol=="function"?Symbol:{},Ut=gt.iterator||"@@iterator",Qt=gt.asyncIterator||"@@asyncIterator",Zt=gt.toStringTag||"@@toStringTag";function be(De,Me,Ce){return Object.defineProperty(De,Me,{value:Ce,enumerable:!0,configurable:!0,writable:!0}),De[Me]}try{be({},"")}catch{be=function(Me,Ce,mr){return Me[Ce]=mr}}function ie(De,Me,Ce,mr){var Ye=Me&&Me.prototype instanceof ze?Me:ze,Ar=Object.create(Ye.prototype),Or=new Gr(mr||[]);return H(Ar,"_invoke",{value:Pr(De,Ce,Or)}),Ar}function Ze(De,Me,Ce){try{return{type:"normal",arg:De.call(Me,Ce)}}catch(mr){return{type:"throw",arg:mr}}}m.wrap=ie;var me={};function ze(){}function re(){}function ir(){}var sr={};be(sr,Ut,function(){return this});var br=Object.getPrototypeOf,qr=br&&br(br(dn([])));qr&&qr!==E&&R.call(qr,Ut)&&(sr=qr);var $e=ir.prototype=ze.prototype=Object.create(sr);function Xe(De){["next","throw","return"].forEach(function(Me){be(De,Me,function(Ce){return this._invoke(Me,Ce)})})}function le(De,Me){function Ce(Ye,Ar,Or,Sr){var kn=Ze(De[Ye],De,Ar);if(kn.type!=="throw"){var oo=kn.arg,Fr=oo.value;return Fr&&f(Fr)=="object"&&R.call(Fr,"__await")?Me.resolve(Fr.__await).then(function(uo){Ce("next",uo,Or,Sr)},function(uo){Ce("throw",uo,Or,Sr)}):Me.resolve(Fr).then(function(uo){oo.value=uo,Or(oo)},function(uo){return Ce("throw",uo,Or,Sr)})}Sr(kn.arg)}var mr;H(this,"_invoke",{value:function(Ye,Ar){function Or(){return new Me(function(Sr,kn){Ce(Ye,Ar,Sr,kn)})}return mr=mr?mr.then(Or,Or):Or()}})}function Pr(De,Me,Ce){var mr="suspendedStart";return function(Ye,Ar){if(mr==="executing")throw new Error("Generator is already running");if(mr==="completed"){if(Ye==="throw")throw Ar;return{value:void 0,done:!0}}for(Ce.method=Ye,Ce.arg=Ar;;){var Or=Ce.delegate;if(Or){var Sr=Yn(Or,Ce);if(Sr){if(Sr===me)continue;return Sr}}if(Ce.method==="next")Ce.sent=Ce._sent=Ce.arg;else if(Ce.method==="throw"){if(mr==="suspendedStart")throw mr="completed",Ce.arg;Ce.dispatchException(Ce.arg)}else Ce.method==="return"&&Ce.abrupt("return",Ce.arg);mr="executing";var kn=Ze(De,Me,Ce);if(kn.type==="normal"){if(mr=Ce.done?"completed":"suspendedYield",kn.arg===me)continue;return{value:kn.arg,done:Ce.done}}kn.type==="throw"&&(mr="completed",Ce.method="throw",Ce.arg=kn.arg)}}}function Yn(De,Me){var Ce=Me.method,mr=De.iterator[Ce];if(mr===void 0)return Me.delegate=null,Ce==="throw"&&De.iterator.return&&(Me.method="return",Me.arg=void 0,Yn(De,Me),Me.method==="throw")||Ce!=="return"&&(Me.method="throw",Me.arg=new TypeError("The iterator does not provide a '"+Ce+"' method")),me;var Ye=Ze(mr,De.iterator,Me.arg);if(Ye.type==="throw")return Me.method="throw",Me.arg=Ye.arg,Me.delegate=null,me;var Ar=Ye.arg;return Ar?Ar.done?(Me[De.resultName]=Ar.value,Me.next=De.nextLoc,Me.method!=="return"&&(Me.method="next",Me.arg=void 0),Me.delegate=null,me):Ar:(Me.method="throw",Me.arg=new TypeError("iterator result is not an object"),Me.delegate=null,me)}function at(De){var Me={tryLoc:De[0]};1 in De&&(Me.catchLoc=De[1]),2 in De&&(Me.finallyLoc=De[2],Me.afterLoc=De[3]),this.tryEntries.push(Me)}function zr(De){var Me=De.completion||{};Me.type="normal",delete Me.arg,De.completion=Me}function Gr(De){this.tryEntries=[{tryLoc:"root"}],De.forEach(at,this),this.reset(!0)}function dn(De){if(De){var Me=De[Ut];if(Me)return Me.call(De);if(typeof De.next=="function")return De;if(!isNaN(De.length)){var Ce=-1,mr=function Ye(){for(;++Ce<De.length;)if(R.call(De,Ce))return Ye.value=De[Ce],Ye.done=!1,Ye;return Ye.value=void 0,Ye.done=!0,Ye};return mr.next=mr}}return{next:pn}}function pn(){return{value:void 0,done:!0}}return re.prototype=ir,H($e,"constructor",{value:ir,configurable:!0}),H(ir,"constructor",{value:re,configurable:!0}),re.displayName=be(ir,Zt,"GeneratorFunction"),m.isGeneratorFunction=function(De){var Me=typeof De=="function"&&De.constructor;return!!Me&&(Me===re||(Me.displayName||Me.name)==="GeneratorFunction")},m.mark=function(De){return Object.setPrototypeOf?Object.setPrototypeOf(De,ir):(De.__proto__=ir,be(De,Zt,"GeneratorFunction")),De.prototype=Object.create($e),De},m.awrap=function(De){return{__await:De}},Xe(le.prototype),be(le.prototype,Qt,function(){return this}),m.AsyncIterator=le,m.async=function(De,Me,Ce,mr,Ye){Ye===void 0&&(Ye=Promise);var Ar=new le(ie(De,Me,Ce,mr),Ye);return m.isGeneratorFunction(Me)?Ar:Ar.next().then(function(Or){return Or.done?Or.value:Ar.next()})},Xe($e),be($e,Zt,"Generator"),be($e,Ut,function(){return this}),be($e,"toString",function(){return"[object Generator]"}),m.keys=function(De){var Me=Object(De),Ce=[];for(var mr in Me)Ce.push(mr);return Ce.reverse(),function Ye(){for(;Ce.length;){var Ar=Ce.pop();if(Ar in Me)return Ye.value=Ar,Ye.done=!1,Ye}return Ye.done=!0,Ye}},m.values=dn,Gr.prototype={constructor:Gr,reset:function(De){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(zr),!De)for(var Me in this)Me.charAt(0)==="t"&&R.call(this,Me)&&!isNaN(+Me.slice(1))&&(this[Me]=void 0)},stop:function(){this.done=!0;var De=this.tryEntries[0].completion;if(De.type==="throw")throw De.arg;return this.rval},dispatchException:function(De){if(this.done)throw De;var Me=this;function Ce(kn,oo){return Ar.type="throw",Ar.arg=De,Me.next=kn,oo&&(Me.method="next",Me.arg=void 0),!!oo}for(var mr=this.tryEntries.length-1;mr>=0;--mr){var Ye=this.tryEntries[mr],Ar=Ye.completion;if(Ye.tryLoc==="root")return Ce("end");if(Ye.tryLoc<=this.prev){var Or=R.call(Ye,"catchLoc"),Sr=R.call(Ye,"finallyLoc");if(Or&&Sr){if(this.prev<Ye.catchLoc)return Ce(Ye.catchLoc,!0);if(this.prev<Ye.finallyLoc)return Ce(Ye.finallyLoc)}else if(Or){if(this.prev<Ye.catchLoc)return Ce(Ye.catchLoc,!0)}else{if(!Sr)throw new Error("try statement without catch or finally");if(this.prev<Ye.finallyLoc)return Ce(Ye.finallyLoc)}}}},abrupt:function(De,Me){for(var Ce=this.tryEntries.length-1;Ce>=0;--Ce){var mr=this.tryEntries[Ce];if(mr.tryLoc<=this.prev&&R.call(mr,"finallyLoc")&&this.prev<mr.finallyLoc){var Ye=mr;break}}Ye&&(De==="break"||De==="continue")&&Ye.tryLoc<=Me&&Me<=Ye.finallyLoc&&(Ye=null);var Ar=Ye?Ye.completion:{};return Ar.type=De,Ar.arg=Me,Ye?(this.method="next",this.next=Ye.finallyLoc,me):this.complete(Ar)},complete:function(De,Me){if(De.type==="throw")throw De.arg;return De.type==="break"||De.type==="continue"?this.next=De.arg:De.type==="return"?(this.rval=this.arg=De.arg,this.method="return",this.next="end"):De.type==="normal"&&Me&&(this.next=Me),me},finish:function(De){for(var Me=this.tryEntries.length-1;Me>=0;--Me){var Ce=this.tryEntries[Me];if(Ce.finallyLoc===De)return this.complete(Ce.completion,Ce.afterLoc),zr(Ce),me}},catch:function(De){for(var Me=this.tryEntries.length-1;Me>=0;--Me){var Ce=this.tryEntries[Me];if(Ce.tryLoc===De){var mr=Ce.completion;if(mr.type==="throw"){var Ye=mr.arg;zr(Ce)}return Ye}}throw new Error("illegal catch attempt")},delegateYield:function(De,Me,Ce){return this.delegate={iterator:dn(De),resultName:Me,nextLoc:Ce},this.method==="next"&&(this.arg=void 0),me}},m}p.exports=w,p.exports.__esModule=!0,p.exports.default=p.exports},68:p=>{function h(a){return p.exports=h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},p.exports.__esModule=!0,p.exports.default=p.exports,h(a)}p.exports=h,p.exports.__esModule=!0,p.exports.default=p.exports},279:(p,h,a)=>{var f=a(737)();p.exports=f;try{regeneratorRuntime=f}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=f:Function("r","regeneratorRuntime = r")(f)}},861:(p,h,a)=>{var f=a(250).Symbol;p.exports=f},823:(p,h,a)=>{var f=a(861),w=a(339),m=a(151),E=f?f.toStringTag:void 0;p.exports=function(R){return R==null?R===void 0?"[object Undefined]":"[object Null]":E&&E in Object(R)?w(R):m(R)}},448:(p,h,a)=>{var f=a(823),w=a(52),m=a(440),E={};E["[object Float32Array]"]=E["[object Float64Array]"]=E["[object Int8Array]"]=E["[object Int16Array]"]=E["[object Int32Array]"]=E["[object Uint8Array]"]=E["[object Uint8ClampedArray]"]=E["[object Uint16Array]"]=E["[object Uint32Array]"]=!0,E["[object Arguments]"]=E["[object Array]"]=E["[object ArrayBuffer]"]=E["[object Boolean]"]=E["[object DataView]"]=E["[object Date]"]=E["[object Error]"]=E["[object Function]"]=E["[object Map]"]=E["[object Number]"]=E["[object Object]"]=E["[object RegExp]"]=E["[object Set]"]=E["[object String]"]=E["[object WeakMap]"]=!1,p.exports=function(R){return m(R)&&w(R.length)&&!!E[f(R)]}},525:p=>{p.exports=function(h){return function(a){return h(a)}}},302:(p,h,a)=>{var f=typeof a.g=="object"&&a.g&&a.g.Object===Object&&a.g;p.exports=f},490:(p,h,a)=>{var f=a(540)(Object.getPrototypeOf,Object);p.exports=f},339:(p,h,a)=>{var f=a(861),w=Object.prototype,m=w.hasOwnProperty,E=w.toString,R=f?f.toStringTag:void 0;p.exports=function(H){var gt=m.call(H,R),Ut=H[R];try{H[R]=void 0;var Qt=!0}catch{}var Zt=E.call(H);return Qt&&(gt?H[R]=Ut:delete H[R]),Zt}},690:(p,h,a)=>{p=a.nmd(p);var f=a(302),w=h&&!h.nodeType&&h,m=w&&p&&!p.nodeType&&p,E=m&&m.exports===w&&f.process,R=function(){try{return m&&m.require&&m.require("util").types||E&&E.binding&&E.binding("util")}catch{}}();p.exports=R},151:p=>{var h=Object.prototype.toString;p.exports=function(a){return h.call(a)}},540:p=>{p.exports=function(h,a){return function(f){return h(a(f))}}},250:(p,h,a)=>{var f=a(302),w=typeof self=="object"&&self&&self.Object===Object&&self,m=f||w||Function("return this")();p.exports=m},589:p=>{var h=Array.isArray;p.exports=h},52:p=>{p.exports=function(h){return typeof h=="number"&&h>-1&&h%1==0&&h<=9007199254740991}},224:(p,h,a)=>{var f=a(823),w=a(440);p.exports=function(m){return typeof m=="number"||w(m)&&f(m)=="[object Number]"}},440:p=>{p.exports=function(h){return h!=null&&typeof h=="object"}},256:(p,h,a)=>{var f=a(823),w=a(490),m=a(440),E=Function.prototype,R=Object.prototype,H=E.toString,gt=R.hasOwnProperty,Ut=H.call(Object);p.exports=function(Qt){if(!m(Qt)||f(Qt)!="[object Object]")return!1;var Zt=w(Qt);if(Zt===null)return!0;var be=gt.call(Zt,"constructor")&&Zt.constructor;return typeof be=="function"&&be instanceof be&&H.call(be)==Ut}},922:(p,h,a)=>{var f=a(448),w=a(525),m=a(690),E=m&&m.isTypedArray,R=E?w(E):f;p.exports=R},919:function(p){p.exports=function(){var h=function(Y){return Y instanceof Uint8Array||Y instanceof Uint16Array||Y instanceof Uint32Array||Y instanceof Int8Array||Y instanceof Int16Array||Y instanceof Int32Array||Y instanceof Float32Array||Y instanceof Float64Array||Y instanceof Uint8ClampedArray},a=function(Y,Tt){for(var ee=Object.keys(Tt),Ae=0;Ae<ee.length;++Ae)Y[ee[Ae]]=Tt[ee[Ae]];return Y},f=`
`;function w(Y){var Tt=new Error("(regl) "+Y);throw console.error(Tt),Tt}function m(Y,Tt){Y||w(Tt)}function E(Y){return Y?": "+Y:""}function R(Y,Tt){switch(Tt){case"number":return typeof Y=="number";case"object":return typeof Y=="object";case"string":return typeof Y=="string";case"boolean":return typeof Y=="boolean";case"function":return typeof Y=="function";case"undefined":return Y===void 0;case"symbol":return typeof Y=="symbol"}}function H(Y,Tt,ee){Tt.indexOf(Y)<0&&w("invalid value"+E(ee)+". must be one of: "+Tt)}var gt=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Ut(Y,Tt){for(Y+="";Y.length<Tt;)Y=" "+Y;return Y}function Qt(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Zt(Y,Tt){this.number=Y,this.line=Tt,this.errors=[]}function be(Y,Tt,ee){this.file=Y,this.line=Tt,this.message=ee}function ie(){var Y=new Error,Tt=(Y.stack||Y).toString(),ee=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Tt);if(ee)return ee[1];var Ae=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Tt);return Ae?Ae[1]:"unknown"}function Ze(){var Y=new Error,Tt=(Y.stack||Y).toString(),ee=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Tt);if(ee)return ee[1];var Ae=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Tt);return Ae?Ae[1]:"unknown"}function me(Y,Tt){var ee,Ae=Y.split(`
`),Se=1,Re=0,_e={unknown:new Qt,0:new Qt};_e.unknown.name=_e[0].name=Tt||ie(),_e.unknown.lines.push(new Zt(0,""));for(var He=0;He<Ae.length;++He){var Ve=Ae[He],Pe=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Ve);if(Pe)switch(Pe[1]){case"line":var Oe=/(\d+)(\s+\d+)?/.exec(Pe[2]);Oe&&(Se=0|Oe[1],Oe[2]&&((Re=0|Oe[2])in _e||(_e[Re]=new Qt)));break;case"define":var We=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Pe[2]);We&&(_e[Re].name=We[1]?(ee=We[2],typeof atob<"u"?atob(ee):"base64:"+ee):We[2])}_e[Re].lines.push(new Zt(Se++,Ve))}return Object.keys(_e).forEach(function(nr){var or=_e[nr];or.lines.forEach(function(gr){or.index[gr.number]=gr})}),_e}function ze(Y){Y._commandRef=ie()}function re(Y,Tt){var ee=Ze();w(Y+" in command "+(Tt||ie())+(ee==="unknown"?"":" called from "+ee))}function ir(Y,Tt,ee,Ae){R(Y,Tt)||re("invalid parameter type"+E(ee)+". expected "+Tt+", got "+typeof Y,Ae||ie())}var sr=33071,br=32819,qr=32820,$e=33635,Xe=34042,le={};function Pr(Y,Tt){return Y===qr||Y===br||Y===$e?2:Y===Xe?4:le[Y]*Tt}function Yn(Y){return!(Y&Y-1||!Y)}le[5120]=le[5121]=1,le[5122]=le[5123]=le[36193]=le[$e]=le[br]=le[qr]=2,le[5124]=le[5125]=le[5126]=le[Xe]=4;var at=a(m,{optional:function(Y){Y()},raise:w,commandRaise:re,command:function(Y,Tt,ee){Y||re(Tt,ee||ie())},parameter:function(Y,Tt,ee){Y in Tt||w("unknown parameter ("+Y+")"+E(ee)+". possible values: "+Object.keys(Tt).join())},commandParameter:function(Y,Tt,ee,Ae){Y in Tt||re("unknown parameter ("+Y+")"+E(ee)+". possible values: "+Object.keys(Tt).join(),Ae||ie())},constructor:function(Y){Object.keys(Y).forEach(function(Tt){gt.indexOf(Tt)<0&&w('invalid regl constructor argument "'+Tt+'". must be one of '+gt)})},type:function(Y,Tt,ee){R(Y,Tt)||w("invalid parameter type"+E(ee)+". expected "+Tt+", got "+typeof Y)},commandType:ir,isTypedArray:function(Y,Tt){h(Y)||w("invalid parameter type"+E(Tt)+". must be a typed array")},nni:function(Y,Tt){Y>=0&&(0|Y)===Y||w("invalid parameter type, ("+Y+")"+E(Tt)+". must be a nonnegative integer")},oneOf:H,shaderError:function(Y,Tt,ee,Ae,Se){if(!Y.getShaderParameter(Tt,Y.COMPILE_STATUS)){var Re=Y.getShaderInfoLog(Tt),_e=Ae===Y.FRAGMENT_SHADER?"fragment":"vertex";ir(ee,"string",_e+" shader source must be a string",Se);var He=me(ee,Se),Ve=function(Pe){var Oe=[];return Pe.split(`
`).forEach(function(We){if(!(We.length<5)){var nr=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(We);nr?Oe.push(new be(0|nr[1],0|nr[2],nr[3].trim())):We.length>0&&Oe.push(new be("unknown",0,We))}}),Oe}(Re);(function(Pe,Oe){Oe.forEach(function(We){var nr=Pe[We.file];if(nr){var or=nr.index[We.line];if(or)return or.errors.push(We),void(nr.hasErrors=!0)}Pe.unknown.hasErrors=!0,Pe.unknown.lines[0].errors.push(We)})})(He,Ve),Object.keys(He).forEach(function(Pe){var Oe=He[Pe];if(Oe.hasErrors){var We=[""],nr=[""];or("file number "+Pe+": "+Oe.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Oe.lines.forEach(function(gr){if(gr.errors.length>0){or(Ut(gr.number,4)+"|  ","background-color:yellow; font-weight:bold"),or(gr.line+f,"color:red; background-color:yellow; font-weight:bold");var cr=0;gr.errors.forEach(function(c){var i=c.message,e=/^\s*'(.*)'\s*:\s*(.*)$/.exec(i);if(e){var n=e[1];i=e[2],n==="assign"&&(n="="),cr=Math.max(gr.line.indexOf(n,cr),0)}else cr=0;or(Ut("| ",6)),or(Ut("^^^",cr+3)+f,"font-weight:bold"),or(Ut("| ",6)),or(i+f,"font-weight:bold")}),or(Ut("| ",6)+f)}else or(Ut(gr.number,4)+"|  "),or(gr.line+f,"color:red")}),typeof document>"u"||window.chrome?console.log(We.join("")):(nr[0]=We.join("%c"),console.log.apply(console,nr))}function or(gr,cr){We.push(gr),nr.push(cr||"")}}),m.raise("Error compiling "+_e+" shader, "+He[0].name)}},linkError:function(Y,Tt,ee,Ae,Se){if(!Y.getProgramParameter(Tt,Y.LINK_STATUS)){var Re=Y.getProgramInfoLog(Tt),_e=me(ee,Se),He='Error linking program with vertex shader, "'+me(Ae,Se)[0].name+'", and fragment shader "'+_e[0].name+'"';typeof document<"u"?console.log("%c"+He+`
%c`+Re,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(He+f+Re),m.raise(He)}},callSite:Ze,saveCommandRef:ze,saveDrawInfo:function(Y,Tt,ee,Ae){function Se(Ve){return Ve?Ae.id(Ve):0}function Re(Ve,Pe){Object.keys(Pe).forEach(function(Oe){Ve[Ae.id(Oe)]=!0})}ze(Y),Y._fragId=Se(Y.static.frag),Y._vertId=Se(Y.static.vert);var _e=Y._uniformSet={};Re(_e,Tt.static),Re(_e,Tt.dynamic);var He=Y._attributeSet={};Re(He,ee.static),Re(He,ee.dynamic),Y._hasCount="count"in Y.static||"count"in Y.dynamic||"elements"in Y.static||"elements"in Y.dynamic},framebufferFormat:function(Y,Tt,ee){Y.texture?H(Y.texture._texture.internalformat,Tt,"unsupported texture format for attachment"):H(Y.renderbuffer._renderbuffer.format,ee,"unsupported renderbuffer format for attachment")},guessCommand:ie,texture2D:function(Y,Tt,ee){var Ae,Se=Tt.width,Re=Tt.height,_e=Tt.channels;m(Se>0&&Se<=ee.maxTextureSize&&Re>0&&Re<=ee.maxTextureSize,"invalid texture shape"),Y.wrapS===sr&&Y.wrapT===sr||m(Yn(Se)&&Yn(Re),"incompatible wrap mode for texture, both width and height must be power of 2"),Tt.mipmask===1?Se!==1&&Re!==1&&m(Y.minFilter!==9984&&Y.minFilter!==9986&&Y.minFilter!==9985&&Y.minFilter!==9987,"min filter requires mipmap"):(m(Yn(Se)&&Yn(Re),"texture must be a square power of 2 to support mipmapping"),m(Tt.mipmask===(Se<<1)-1,"missing or incomplete mipmap data")),Tt.type===5126&&(ee.extensions.indexOf("oes_texture_float_linear")<0&&m(Y.minFilter===9728&&Y.magFilter===9728,"filter not supported, must enable oes_texture_float_linear"),m(!Y.genMipmaps,"mipmap generation not supported with float textures"));var He=Tt.images;for(Ae=0;Ae<16;++Ae)if(He[Ae]){var Ve=Se>>Ae,Pe=Re>>Ae;m(Tt.mipmask&1<<Ae,"missing mipmap data");var Oe=He[Ae];if(m(Oe.width===Ve&&Oe.height===Pe,"invalid shape for mip images"),m(Oe.format===Tt.format&&Oe.internalformat===Tt.internalformat&&Oe.type===Tt.type,"incompatible type for mip image"),!Oe.compressed)if(Oe.data){var We=Math.ceil(Pr(Oe.type,_e)*Ve/Oe.unpackAlignment)*Oe.unpackAlignment;m(Oe.data.byteLength===We*Pe,"invalid data for image, buffer size is inconsistent with image format")}else Oe.element||Oe.copy}else Y.genMipmaps||m((Tt.mipmask&1<<Ae)==0,"extra mipmap data");Tt.compressed&&m(!Y.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(Y,Tt,ee,Ae){var Se=Y.width,Re=Y.height,_e=Y.channels;m(Se>0&&Se<=Ae.maxTextureSize&&Re>0&&Re<=Ae.maxTextureSize,"invalid texture shape"),m(Se===Re,"cube map must be square"),m(Tt.wrapS===sr&&Tt.wrapT===sr,"wrap mode not supported by cube map");for(var He=0;He<ee.length;++He){var Ve=ee[He];m(Ve.width===Se&&Ve.height===Re,"inconsistent cube map face shape"),Tt.genMipmaps&&(m(!Ve.compressed,"can not generate mipmap for compressed textures"),m(Ve.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Pe=Ve.images,Oe=0;Oe<16;++Oe){var We=Pe[Oe];if(We){var nr=Se>>Oe,or=Re>>Oe;m(Ve.mipmask&1<<Oe,"missing mipmap data"),m(We.width===nr&&We.height===or,"invalid shape for mip images"),m(We.format===Y.format&&We.internalformat===Y.internalformat&&We.type===Y.type,"incompatible type for mip image"),We.compressed||(We.data?m(We.data.byteLength===nr*or*Math.max(Pr(We.type,_e),We.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):We.element||We.copy)}}}}}),zr=0;function Gr(Y,Tt){this.id=zr++,this.type=Y,this.data=Tt}function dn(Y){return Y.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function pn(Y){if(Y.length===0)return[];var Tt=Y.charAt(0),ee=Y.charAt(Y.length-1);if(Y.length>1&&Tt===ee&&(Tt==='"'||Tt==="'"))return['"'+dn(Y.substr(1,Y.length-2))+'"'];var Ae=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(Y);if(Ae)return pn(Y.substr(0,Ae.index)).concat(pn(Ae[1])).concat(pn(Y.substr(Ae.index+Ae[0].length)));var Se=Y.split(".");if(Se.length===1)return['"'+dn(Y)+'"'];for(var Re=[],_e=0;_e<Se.length;++_e)Re=Re.concat(pn(Se[_e]));return Re}function De(Y){return"["+pn(Y).join("][")+"]"}var Me={DynamicVariable:Gr,define:function(Y,Tt){return new Gr(Y,De(Tt+""))},isDynamic:function(Y){return typeof Y=="function"&&!Y._reglType||Y instanceof Gr},unbox:function Y(Tt,ee){return typeof Tt=="function"?new Gr(0,Tt):typeof Tt=="number"||typeof Tt=="boolean"?new Gr(5,Tt):Array.isArray(Tt)?new Gr(6,Tt.map((Ae,Se)=>Y(Ae,ee+"["+Se+"]"))):Tt instanceof Gr?Tt:void at(!1,"invalid option type in uniform "+ee)},accessor:De},Ce={next:typeof requestAnimationFrame=="function"?function(Y){return requestAnimationFrame(Y)}:function(Y){return setTimeout(Y,16)},cancel:typeof cancelAnimationFrame=="function"?function(Y){return cancelAnimationFrame(Y)}:clearTimeout},mr=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Ye(Y){return typeof Y=="string"?Y.split():(at(Array.isArray(Y),"invalid extension array"),Y)}function Ar(Y){return typeof Y=="string"?(at(typeof document<"u","not supported outside of DOM"),document.querySelector(Y)):Y}function Or(Y){var Tt,ee,Ae,Se,Re,_e=Y||{},He={},Ve=[],Pe=[],Oe=typeof window>"u"?1:window.devicePixelRatio,We=!1,nr=function(cr){cr&&at.raise(cr)},or=function(){};if(typeof _e=="string"?(at(typeof document<"u","selector queries only supported in DOM enviroments"),Tt=document.querySelector(_e),at(Tt,"invalid query string for element")):typeof _e=="object"?typeof(Re=_e).nodeName=="string"&&typeof Re.appendChild=="function"&&typeof Re.getBoundingClientRect=="function"?Tt=_e:function(cr){return typeof cr.drawArrays=="function"||typeof cr.drawElements=="function"}(_e)?Ae=(Se=_e).canvas:(at.constructor(_e),"gl"in _e?Se=_e.gl:"canvas"in _e?Ae=Ar(_e.canvas):"container"in _e&&(ee=Ar(_e.container)),"attributes"in _e&&(He=_e.attributes,at.type(He,"object","invalid context attributes")),"extensions"in _e&&(Ve=Ye(_e.extensions)),"optionalExtensions"in _e&&(Pe=Ye(_e.optionalExtensions)),"onDone"in _e&&(at.type(_e.onDone,"function","invalid or missing onDone callback"),nr=_e.onDone),"profile"in _e&&(We=!!_e.profile),"pixelRatio"in _e&&(Oe=+_e.pixelRatio,at(Oe>0,"invalid pixel ratio"))):at.raise("invalid arguments to regl"),Tt&&(Tt.nodeName.toLowerCase()==="canvas"?Ae=Tt:ee=Tt),!Se){if(!Ae){at(typeof document<"u","must manually specify webgl context outside of DOM environments");var gr=function(cr,c,i){var e,n=document.createElement("canvas");function u(){var g=window.innerWidth,x=window.innerHeight;if(cr!==document.body){var M=cr.getBoundingClientRect();g=M.right-M.left,x=M.bottom-M.top}n.width=i*g,n.height=i*x,a(n.style,{width:g+"px",height:x+"px"})}return a(n.style,{border:0,margin:0,padding:0,top:0,left:0}),cr.appendChild(n),cr===document.body&&(n.style.position="absolute",a(cr.style,{margin:0,padding:0})),cr!==document.body&&typeof ResizeObserver=="function"?(e=new ResizeObserver(function(){setTimeout(u)})).observe(cr):window.addEventListener("resize",u,!1),u(),{canvas:n,onDestroy:function(){e?e.disconnect():window.removeEventListener("resize",u),cr.removeChild(n)}}}(ee||document.body,0,Oe);if(!gr)return null;Ae=gr.canvas,or=gr.onDestroy}He.premultipliedAlpha===void 0&&(He.premultipliedAlpha=!0),Se=function(cr,c){function i(e){try{return cr.getContext(e,c)}catch{return null}}return i("webgl")||i("experimental-webgl")||i("webgl-experimental")}(Ae,He)}return Se?{gl:Se,canvas:Ae,container:ee,extensions:Ve,optionalExtensions:Pe,pixelRatio:Oe,profile:We,onDone:nr,onDestroy:or}:(or(),nr("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Sr(Y,Tt){for(var ee=Array(Y),Ae=0;Ae<Y;++Ae)ee[Ae]=Tt(Ae);return ee}function kn(Y){var Tt,ee;return Tt=(Y>65535)<<4,Tt|=ee=((Y>>>=Tt)>255)<<3,Tt|=ee=((Y>>>=ee)>15)<<2,(Tt|=ee=((Y>>>=ee)>3)<<1)|(Y>>>=ee)>>1}function oo(){var Y=Sr(8,function(){return[]});function Tt(Ae){var Se=function(_e){for(var He=16;He<=268435456;He*=16)if(_e<=He)return He;return 0}(Ae),Re=Y[kn(Se)>>2];return Re.length>0?Re.pop():new ArrayBuffer(Se)}function ee(Ae){Y[kn(Ae.byteLength)>>2].push(Ae)}return{alloc:Tt,free:ee,allocType:function(Ae,Se){var Re=null;switch(Ae){case 5120:Re=new Int8Array(Tt(Se),0,Se);break;case 5121:Re=new Uint8Array(Tt(Se),0,Se);break;case 5122:Re=new Int16Array(Tt(2*Se),0,Se);break;case 5123:Re=new Uint16Array(Tt(2*Se),0,Se);break;case 5124:Re=new Int32Array(Tt(4*Se),0,Se);break;case 5125:Re=new Uint32Array(Tt(4*Se),0,Se);break;case 5126:Re=new Float32Array(Tt(4*Se),0,Se);break;default:return null}return Re.length!==Se?Re.subarray(0,Se):Re},freeType:function(Ae){ee(Ae.buffer)}}}var Fr=oo();Fr.zero=oo();var uo=3553,Vn=6408,Vo=5126,In=36160;function Mn(Y){return!!Y&&typeof Y=="object"&&Array.isArray(Y.shape)&&Array.isArray(Y.stride)&&typeof Y.offset=="number"&&Y.shape.length===Y.stride.length&&(Array.isArray(Y.data)||h(Y.data))}var Dr=function(Y){return Object.keys(Y).map(function(Tt){return Y[Tt]})},Ni={shape:function(Y){for(var Tt=[],ee=Y;ee.length;ee=ee[0])Tt.push(ee.length);return Tt},flatten:function(Y,Tt,ee,Ae){var Se=1;if(Tt.length)for(var Re=0;Re<Tt.length;++Re)Se*=Tt[Re];else Se=0;var _e=Ae||Fr.allocType(ee,Se);switch(Tt.length){case 0:break;case 1:(function(He,Ve,Pe){for(var Oe=0;Oe<Ve;++Oe)Pe[Oe]=He[Oe]})(Y,Tt[0],_e);break;case 2:(function(He,Ve,Pe,Oe){for(var We=0,nr=0;nr<Ve;++nr)for(var or=He[nr],gr=0;gr<Pe;++gr)Oe[We++]=or[gr]})(Y,Tt[0],Tt[1],_e);break;case 3:ds(Y,Tt[0],Tt[1],Tt[2],_e,0);break;default:qi(Y,Tt,0,_e,0)}return _e}};function ds(Y,Tt,ee,Ae,Se,Re){for(var _e=Re,He=0;He<Tt;++He)for(var Ve=Y[He],Pe=0;Pe<ee;++Pe)for(var Oe=Ve[Pe],We=0;We<Ae;++We)Se[_e++]=Oe[We]}function qi(Y,Tt,ee,Ae,Se){for(var Re=1,_e=ee+1;_e<Tt.length;++_e)Re*=Tt[_e];var He=Tt[ee];if(Tt.length-ee==4){var Ve=Tt[ee+1],Pe=Tt[ee+2],Oe=Tt[ee+3];for(_e=0;_e<He;++_e)ds(Y[_e],Ve,Pe,Oe,Ae,Se),Se+=Re}else for(_e=0;_e<He;++_e)qi(Y[_e],Tt,ee+1,Ae,Se),Se+=Re}var Wi={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},qo={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Ln={dynamic:35048,stream:35040,static:35044},Pn=Ni.flatten,Eo=Ni.shape,cs=35044,hs=35040,di=5121,xa=5126,Co=[];function ba(Y){return 0|Wi[Object.prototype.toString.call(Y)]}function Mi(Y,Tt){for(var ee=0;ee<Tt.length;++ee)Y[ee]=Tt[ee]}function Lo(Y,Tt,ee,Ae,Se,Re,_e){for(var He=0,Ve=0;Ve<ee;++Ve)for(var Pe=0;Pe<Ae;++Pe)Y[He++]=Tt[Se*Ve+Re*Pe+_e]}Co[5120]=1,Co[5122]=2,Co[5124]=4,Co[5121]=1,Co[5123]=2,Co[5125]=4,Co[5126]=4;var xo={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Do=0,$i=1,Ai=4,Si=5120,ho=5121,_i=5122,bo=5123,qa=5124,Wo=5125,Wa=34963,$a=35040,ls=35044,Hi=new Float32Array(1),Ha=new Uint32Array(Hi.buffer),Na=5123;function ci(Y){for(var Tt=Fr.allocType(Na,Y.length),ee=0;ee<Y.length;++ee)if(isNaN(Y[ee]))Tt[ee]=65535;else if(Y[ee]===1/0)Tt[ee]=31744;else if(Y[ee]===-1/0)Tt[ee]=64512;else{Hi[0]=Y[ee];var Ae=Ha[0],Se=Ae>>>31<<15,Re=(Ae<<1>>>24)-127,_e=Ae>>13&1023;if(Re<-24)Tt[ee]=Se;else if(Re<-14){var He=-14-Re;Tt[ee]=Se+(_e+1024>>He)}else Tt[ee]=Re>15?Se+31744:Se+(Re+15<<10)+_e}return Tt}function An(Y){return Array.isArray(Y)||h(Y)}var Xa=function(Y){return!(Y&Y-1||!Y)},Os=34467,No=3553,Ma=34067,Aa=34069,qn=6408,Sa=6406,Xi=6407,ki=6409,hi=6410,v=32854,Bt=32855,z=36194,Lt=32819,Mt=32820,te=33635,ue=34042,he=6402,pe=34041,ye=35904,fe=35906,Je=36193,Qe=33776,ar=33777,dr=33778,_r=33779,Te=35986,yr=35987,Wr=34798,cn=35840,Wn=35841,$r=35842,Hr=35843,Dn=36196,yn=5121,zn=5123,lo=5125,Tn=5126,$n=10242,Xr=10243,hn=10497,Rn=33071,wn=33648,On=10240,Kn=10241,io=9728,Mo=9729,Ao=9984,ao=9985,Yr=9986,ln=9987,Jr=33170,En=4352,po=4353,xn=4354,Zn=34046,Cr=3317,Hn=37440,Gn=37441,Kr=37443,Jn=37444,Sn=33984,bn=[Ao,Yr,ao,ln],Qr=[0,ki,hi,Xi,qn],_n={};function Vr(Y){return"[object "+Y+"]"}_n[ki]=_n[Sa]=_n[he]=1,_n[pe]=_n[hi]=2,_n[Xi]=_n[ye]=3,_n[qn]=_n[fe]=4;var fn=Vr("HTMLCanvasElement"),Qn=Vr("OffscreenCanvas"),Ii=Vr("CanvasRenderingContext2D"),Di=Vr("ImageBitmap"),$o=Vr("HTMLImageElement"),Ti=Vr("HTMLVideoElement"),li=Object.keys(Wi).concat([fn,Qn,Ii,Di,$o,Ti]),Po=[];Po[yn]=1,Po[Tn]=4,Po[Je]=2,Po[zn]=2,Po[lo]=4;var Nn=[];function Ri(Y){return Array.isArray(Y)&&(Y.length===0||typeof Y[0]=="number")}function zo(Y){return!!Array.isArray(Y)&&!(Y.length===0||!An(Y[0]))}function vo(Y){return Object.prototype.toString.call(Y)}function fi(Y){return vo(Y)===fn}function _a(Y){return vo(Y)===Qn}function Ho(Y){if(!Y)return!1;var Tt=vo(Y);return li.indexOf(Tt)>=0||Ri(Y)||zo(Y)||Mn(Y)}function Xo(Y){return 0|Wi[Object.prototype.toString.call(Y)]}function Yi(Y,Tt){return Fr.allocType(Y.type===Je?Tn:Y.type,Tt)}function gi(Y,Tt){Y.type===Je?(Y.data=ci(Tt),Fr.freeType(Tt)):Y.data=Tt}function Ki(Y,Tt,ee,Ae,Se,Re){var _e;if(_e=Nn[Y]!==void 0?Nn[Y]:_n[Y]*Po[Tt],Re&&(_e*=6),Se){for(var He=0,Ve=ee;Ve>=1;)He+=_e*Ve*Ve,Ve/=2;return He}return _e*ee*Ae}function fs(Y,Tt,ee,Ae,Se,Re,_e){var He={"don't care":En,"dont care":En,nice:xn,fast:po},Ve={repeat:hn,clamp:Rn,mirror:wn},Pe={nearest:io,linear:Mo},Oe=a({mipmap:ln,"nearest mipmap nearest":Ao,"linear mipmap nearest":ao,"nearest mipmap linear":Yr,"linear mipmap linear":ln},Pe),We={none:0,browser:Jn},nr={uint8:yn,rgba4:Lt,rgb565:te,"rgb5 a1":Mt},or={alpha:Sa,luminance:ki,"luminance alpha":hi,rgb:Xi,rgba:qn,rgba4:v,"rgb5 a1":Bt,rgb565:z},gr={};Tt.ext_srgb&&(or.srgb=ye,or.srgba=fe),Tt.oes_texture_float&&(nr.float32=nr.float=Tn),Tt.oes_texture_half_float&&(nr.float16=nr["half float"]=Je),Tt.webgl_depth_texture&&(a(or,{depth:he,"depth stencil":pe}),a(nr,{uint16:zn,uint32:lo,"depth stencil":ue})),Tt.webgl_compressed_texture_s3tc&&a(gr,{"rgb s3tc dxt1":Qe,"rgba s3tc dxt1":ar,"rgba s3tc dxt3":dr,"rgba s3tc dxt5":_r}),Tt.webgl_compressed_texture_atc&&a(gr,{"rgb atc":Te,"rgba atc explicit alpha":yr,"rgba atc interpolated alpha":Wr}),Tt.webgl_compressed_texture_pvrtc&&a(gr,{"rgb pvrtc 4bppv1":cn,"rgb pvrtc 2bppv1":Wn,"rgba pvrtc 4bppv1":$r,"rgba pvrtc 2bppv1":Hr}),Tt.webgl_compressed_texture_etc1&&(gr["rgb etc1"]=Dn);var cr=Array.prototype.slice.call(Y.getParameter(Os));Object.keys(gr).forEach(function(I){var P=gr[I];cr.indexOf(P)>=0&&(or[I]=P)});var c=Object.keys(or);ee.textureFormats=c;var i=[];Object.keys(or).forEach(function(I){var P=or[I];i[P]=I});var e=[];Object.keys(nr).forEach(function(I){var P=nr[I];e[P]=I});var n=[];Object.keys(Pe).forEach(function(I){var P=Pe[I];n[P]=I});var u=[];Object.keys(Oe).forEach(function(I){var P=Oe[I];u[P]=I});var g=[];Object.keys(Ve).forEach(function(I){var P=Ve[I];g[P]=I});var x=c.reduce(function(I,P){var C=or[P];return C===ki||C===Sa||C===ki||C===hi||C===he||C===pe||Tt.ext_srgb&&(C===ye||C===fe)?I[C]=C:C===Bt||P.indexOf("rgba")>=0?I[C]=qn:I[C]=Xi,I},{});function M(){this.internalformat=qn,this.format=qn,this.type=yn,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Jn,this.width=0,this.height=0,this.channels=0}function S(I,P){I.internalformat=P.internalformat,I.format=P.format,I.type=P.type,I.compressed=P.compressed,I.premultiplyAlpha=P.premultiplyAlpha,I.flipY=P.flipY,I.unpackAlignment=P.unpackAlignment,I.colorSpace=P.colorSpace,I.width=P.width,I.height=P.height,I.channels=P.channels}function T(I,P){if(typeof P=="object"&&P){if("premultiplyAlpha"in P&&(at.type(P.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),I.premultiplyAlpha=P.premultiplyAlpha),"flipY"in P&&(at.type(P.flipY,"boolean","invalid texture flip"),I.flipY=P.flipY),"alignment"in P&&(at.oneOf(P.alignment,[1,2,4,8],"invalid texture unpack alignment"),I.unpackAlignment=P.alignment),"colorSpace"in P&&(at.parameter(P.colorSpace,We,"invalid colorSpace"),I.colorSpace=We[P.colorSpace]),"type"in P){var C=P.type;at(Tt.oes_texture_float||!(C==="float"||C==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),at(Tt.oes_texture_half_float||!(C==="half float"||C==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),at(Tt.webgl_depth_texture||!(C==="uint16"||C==="uint32"||C==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),at.parameter(C,nr,"invalid texture type"),I.type=nr[C]}var O=I.width,ut=I.height,xt=I.channels,G=!1;"shape"in P?(at(Array.isArray(P.shape)&&P.shape.length>=2,"shape must be an array"),O=P.shape[0],ut=P.shape[1],P.shape.length===3&&(xt=P.shape[2],at(xt>0&&xt<=4,"invalid number of channels"),G=!0),at(O>=0&&O<=ee.maxTextureSize,"invalid width"),at(ut>=0&&ut<=ee.maxTextureSize,"invalid height")):("radius"in P&&(O=ut=P.radius,at(O>=0&&O<=ee.maxTextureSize,"invalid radius")),"width"in P&&(O=P.width,at(O>=0&&O<=ee.maxTextureSize,"invalid width")),"height"in P&&(ut=P.height,at(ut>=0&&ut<=ee.maxTextureSize,"invalid height")),"channels"in P&&(xt=P.channels,at(xt>0&&xt<=4,"invalid number of channels"),G=!0)),I.width=0|O,I.height=0|ut,I.channels=0|xt;var U=!1;if("format"in P){var lt=P.format;at(Tt.webgl_depth_texture||!(lt==="depth"||lt==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),at.parameter(lt,or,"invalid texture format");var it=I.internalformat=or[lt];I.format=x[it],lt in nr&&("type"in P||(I.type=nr[lt])),lt in gr&&(I.compressed=!0),U=!0}!G&&U?I.channels=_n[I.format]:G&&!U?I.channels!==Qr[I.format]&&(I.format=I.internalformat=Qr[I.channels]):U&&G&&at(I.channels===_n[I.format],"number of channels inconsistent with specified format")}}function k(I){Y.pixelStorei(Hn,I.flipY),Y.pixelStorei(Gn,I.premultiplyAlpha),Y.pixelStorei(Kr,I.colorSpace),Y.pixelStorei(Cr,I.unpackAlignment)}function B(){M.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Q(I,P){var C=null;if(Ho(P)?C=P:P&&(at.type(P,"object","invalid pixel data type"),T(I,P),"x"in P&&(I.xOffset=0|P.x),"y"in P&&(I.yOffset=0|P.y),Ho(P.data)&&(C=P.data)),at(!I.compressed||C instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),P.copy){at(!C,"can not specify copy and data field for the same texture");var O=Se.viewportWidth,ut=Se.viewportHeight;I.width=I.width||O-I.xOffset,I.height=I.height||ut-I.yOffset,I.needsCopy=!0,at(I.xOffset>=0&&I.xOffset<O&&I.yOffset>=0&&I.yOffset<ut&&I.width>0&&I.width<=O&&I.height>0&&I.height<=ut,"copy texture read out of bounds")}else if(C){if(h(C))I.channels=I.channels||4,I.data=C,"type"in P||I.type!==yn||(I.type=Xo(C));else if(Ri(C))I.channels=I.channels||4,function(J,Et){var kt=Et.length;switch(J.type){case yn:case zn:case lo:case Tn:var oe=Fr.allocType(J.type,kt);oe.set(Et),J.data=oe;break;case Je:J.data=ci(Et);break;default:at.raise("unsupported texture type, must specify a typed array")}}(I,C),I.alignment=1,I.needsFree=!0;else if(Mn(C)){var xt=C.data;Array.isArray(xt)||I.type!==yn||(I.type=Xo(xt));var G,U,lt,it,ft,Rt,Gt=C.shape,ht=C.stride;Gt.length===3?(lt=Gt[2],Rt=ht[2]):(at(Gt.length===2,"invalid ndarray pixel data, must be 2 or 3D"),lt=1,Rt=1),G=Gt[0],U=Gt[1],it=ht[0],ft=ht[1],I.alignment=1,I.width=G,I.height=U,I.channels=lt,I.format=I.internalformat=Qr[lt],I.needsFree=!0,function(J,Et,kt,oe,Ee,Ie){for(var Ue=J.width,hr=J.height,pr=J.channels,Mr=Yi(J,Ue*hr*pr),Er=0,Ke=0;Ke<hr;++Ke)for(var Ur=0;Ur<Ue;++Ur)for(var mn=0;mn<pr;++mn)Mr[Er++]=Et[kt*Ur+oe*Ke+Ee*mn+Ie];gi(J,Mr)}(I,xt,it,ft,Rt,C.offset)}else if(fi(C)||_a(C)||vo(C)===Ii)fi(C)||_a(C)?I.element=C:I.element=C.canvas,I.width=I.element.width,I.height=I.element.height,I.channels=4;else if(function(J){return vo(J)===Di}(C))I.element=C,I.width=C.width,I.height=C.height,I.channels=4;else if(function(J){return vo(J)===$o}(C))I.element=C,I.width=C.naturalWidth,I.height=C.naturalHeight,I.channels=4;else if(function(J){return vo(J)===Ti}(C))I.element=C,I.width=C.videoWidth,I.height=C.videoHeight,I.channels=4;else if(zo(C)){var St=I.width||C[0].length,_t=I.height||C.length,ae=I.channels;ae=An(C[0][0])?ae||C[0][0].length:ae||1;for(var jt=Ni.shape(C),Ft=1,se=0;se<jt.length;++se)Ft*=jt[se];var Vt=Yi(I,Ft);Ni.flatten(C,jt,"",Vt),gi(I,Vt),I.alignment=1,I.width=St,I.height=_t,I.channels=ae,I.format=I.internalformat=Qr[ae],I.needsFree=!0}}else I.width=I.width||1,I.height=I.height||1,I.channels=I.channels||4;I.type===Tn?at(ee.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):I.type===Je&&at(ee.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function et(I,P,C){var O=I.element,ut=I.data,xt=I.internalformat,G=I.format,U=I.type,lt=I.width,it=I.height;k(I),O?Y.texImage2D(P,C,G,G,U,O):I.compressed?Y.compressedTexImage2D(P,C,xt,lt,it,0,ut):I.needsCopy?(Ae(),Y.copyTexImage2D(P,C,G,I.xOffset,I.yOffset,lt,it,0)):Y.texImage2D(P,C,G,lt,it,0,G,U,ut||null)}function K(I,P,C,O,ut){var xt=I.element,G=I.data,U=I.internalformat,lt=I.format,it=I.type,ft=I.width,Rt=I.height;k(I),xt?Y.texSubImage2D(P,ut,C,O,lt,it,xt):I.compressed?Y.compressedTexSubImage2D(P,ut,C,O,U,ft,Rt,G):I.needsCopy?(Ae(),Y.copyTexSubImage2D(P,ut,C,O,I.xOffset,I.yOffset,ft,Rt)):Y.texSubImage2D(P,ut,C,O,ft,Rt,lt,it,G)}var j=[];function dt(){return j.pop()||new B}function ot(I){I.needsFree&&Fr.freeType(I.data),B.call(I),j.push(I)}function pt(){M.call(this),this.genMipmaps=!1,this.mipmapHint=En,this.mipmask=0,this.images=Array(16)}function ne(I,P,C){var O=I.images[0]=dt();I.mipmask=1,O.width=I.width=P,O.height=I.height=C,O.channels=I.channels=4}function Kt(I,P){var C=null;if(Ho(P))S(C=I.images[0]=dt(),I),Q(C,P),I.mipmask=1;else if(T(I,P),Array.isArray(P.mipmap))for(var O=P.mipmap,ut=0;ut<O.length;++ut)S(C=I.images[ut]=dt(),I),C.width>>=ut,C.height>>=ut,Q(C,O[ut]),I.mipmask|=1<<ut;else S(C=I.images[0]=dt(),I),Q(C,P),I.mipmask=1;S(I,I.images[0]),!I.compressed||I.internalformat!==Qe&&I.internalformat!==ar&&I.internalformat!==dr&&I.internalformat!==_r||at(I.width%4==0&&I.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function qt(I,P){for(var C=I.images,O=0;O<C.length;++O){if(!C[O])return;et(C[O],P,O)}}var Nt=[];function Pt(){var I=Nt.pop()||new pt;M.call(I),I.mipmask=0;for(var P=0;P<16;++P)I.images[P]=null;return I}function Ht(I){for(var P=I.images,C=0;C<P.length;++C)P[C]&&ot(P[C]),P[C]=null;Nt.push(I)}function Ct(){this.minFilter=io,this.magFilter=io,this.wrapS=Rn,this.wrapT=Rn,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=En}function V(I,P){if("min"in P){var C=P.min;at.parameter(C,Oe),I.minFilter=Oe[C],bn.indexOf(I.minFilter)>=0&&!("faces"in P)&&(I.genMipmaps=!0)}if("mag"in P){var O=P.mag;at.parameter(O,Pe),I.magFilter=Pe[O]}var ut=I.wrapS,xt=I.wrapT;if("wrap"in P){var G=P.wrap;typeof G=="string"?(at.parameter(G,Ve),ut=xt=Ve[G]):Array.isArray(G)&&(at.parameter(G[0],Ve),at.parameter(G[1],Ve),ut=Ve[G[0]],xt=Ve[G[1]])}else{if("wrapS"in P){var U=P.wrapS;at.parameter(U,Ve),ut=Ve[U]}if("wrapT"in P){var lt=P.wrapT;at.parameter(lt,Ve),xt=Ve[lt]}}if(I.wrapS=ut,I.wrapT=xt,"anisotropic"in P){var it=P.anisotropic;at(typeof it=="number"&&it>=1&&it<=ee.maxAnisotropic,"aniso samples must be between 1 and "),I.anisotropic=P.anisotropic}if("mipmap"in P){var ft=!1;switch(typeof P.mipmap){case"string":at.parameter(P.mipmap,He,"invalid mipmap hint"),I.mipmapHint=He[P.mipmap],I.genMipmaps=!0,ft=!0;break;case"boolean":ft=I.genMipmaps=P.mipmap;break;case"object":at(Array.isArray(P.mipmap),"invalid mipmap type"),I.genMipmaps=!1,ft=!0;break;default:at.raise("invalid mipmap type")}ft&&!("min"in P)&&(I.minFilter=Ao)}}function st(I,P){Y.texParameteri(P,Kn,I.minFilter),Y.texParameteri(P,On,I.magFilter),Y.texParameteri(P,$n,I.wrapS),Y.texParameteri(P,Xr,I.wrapT),Tt.ext_texture_filter_anisotropic&&Y.texParameteri(P,Zn,I.anisotropic),I.genMipmaps&&(Y.hint(Jr,I.mipmapHint),Y.generateMipmap(P))}var It=0,mt={},X=ee.maxTextureUnits,D=Array(X).map(function(){return null});function W(I){M.call(this),this.mipmask=0,this.internalformat=qn,this.id=It++,this.refCount=1,this.target=I,this.texture=Y.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Ct,_e.profile&&(this.stats={size:0})}function vt(I){Y.activeTexture(Sn),Y.bindTexture(I.target,I.texture)}function yt(){var I=D[0];I?Y.bindTexture(I.target,I.texture):Y.bindTexture(No,null)}function At(I){var P=I.texture;at(P,"must not double destroy texture");var C=I.unit,O=I.target;C>=0&&(Y.activeTexture(Sn+C),Y.bindTexture(O,null),D[C]=null),Y.deleteTexture(P),I.texture=null,I.params=null,I.pixels=null,I.refCount=0,delete mt[I.id],Re.textureCount--}return a(W.prototype,{bind:function(){var I=this;I.bindCount+=1;var P=I.unit;if(P<0){for(var C=0;C<X;++C){var O=D[C];if(O){if(O.bindCount>0)continue;O.unit=-1}D[C]=I,P=C;break}P>=X&&at.raise("insufficient number of texture units"),_e.profile&&Re.maxTextureUnits<P+1&&(Re.maxTextureUnits=P+1),I.unit=P,Y.activeTexture(Sn+P),Y.bindTexture(I.target,I.texture)}return P},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&At(this)}}),_e.profile&&(Re.getTotalTextureSize=function(){var I=0;return Object.keys(mt).forEach(function(P){I+=mt[P].stats.size}),I}),{create2D:function(I,P){var C=new W(No);function O(ut,xt){var G=C.texInfo;Ct.call(G);var U=Pt();return typeof ut=="number"?ne(U,0|ut,typeof xt=="number"?0|xt:0|ut):ut?(at.type(ut,"object","invalid arguments to regl.texture"),V(G,ut),Kt(U,ut)):ne(U,1,1),G.genMipmaps&&(U.mipmask=(U.width<<1)-1),C.mipmask=U.mipmask,S(C,U),at.texture2D(G,U,ee),C.internalformat=U.internalformat,O.width=U.width,O.height=U.height,vt(C),qt(U,No),st(G,No),yt(),Ht(U),_e.profile&&(C.stats.size=Ki(C.internalformat,C.type,U.width,U.height,G.genMipmaps,!1)),O.format=i[C.internalformat],O.type=e[C.type],O.mag=n[G.magFilter],O.min=u[G.minFilter],O.wrapS=g[G.wrapS],O.wrapT=g[G.wrapT],O}return mt[C.id]=C,Re.textureCount++,O(I,P),O.subimage=function(ut,xt,G,U){at(!!ut,"must specify image data");var lt=0|xt,it=0|G,ft=0|U,Rt=dt();return S(Rt,C),Rt.width=0,Rt.height=0,Q(Rt,ut),Rt.width=Rt.width||(C.width>>ft)-lt,Rt.height=Rt.height||(C.height>>ft)-it,at(C.type===Rt.type&&C.format===Rt.format&&C.internalformat===Rt.internalformat,"incompatible format for texture.subimage"),at(lt>=0&&it>=0&&lt+Rt.width<=C.width&&it+Rt.height<=C.height,"texture.subimage write out of bounds"),at(C.mipmask&1<<ft,"missing mipmap data"),at(Rt.data||Rt.element||Rt.needsCopy,"missing image data"),vt(C),K(Rt,No,lt,it,ft),yt(),ot(Rt),O},O.resize=function(ut,xt){var G=0|ut,U=0|xt||G;if(G===C.width&&U===C.height)return O;O.width=C.width=G,O.height=C.height=U,vt(C);for(var lt=0;C.mipmask>>lt;++lt){var it=G>>lt,ft=U>>lt;if(!it||!ft)break;Y.texImage2D(No,lt,C.format,it,ft,0,C.format,C.type,null)}return yt(),_e.profile&&(C.stats.size=Ki(C.internalformat,C.type,G,U,!1,!1)),O},O._reglType="texture2d",O._texture=C,_e.profile&&(O.stats=C.stats),O.destroy=function(){C.decRef()},O},createCube:function(I,P,C,O,ut,xt){var G=new W(Ma);mt[G.id]=G,Re.cubeCount++;var U=new Array(6);function lt(it,ft,Rt,Gt,ht,St){var _t,ae=G.texInfo;for(Ct.call(ae),_t=0;_t<6;++_t)U[_t]=Pt();if(typeof it!="number"&&it)if(typeof it=="object")if(ft)Kt(U[0],it),Kt(U[1],ft),Kt(U[2],Rt),Kt(U[3],Gt),Kt(U[4],ht),Kt(U[5],St);else if(V(ae,it),T(G,it),"faces"in it){var jt=it.faces;for(at(Array.isArray(jt)&&jt.length===6,"cube faces must be a length 6 array"),_t=0;_t<6;++_t)at(typeof jt[_t]=="object"&&!!jt[_t],"invalid input for cube map face"),S(U[_t],G),Kt(U[_t],jt[_t])}else for(_t=0;_t<6;++_t)Kt(U[_t],it);else at.raise("invalid arguments to cube map");else{var Ft=0|it||1;for(_t=0;_t<6;++_t)ne(U[_t],Ft,Ft)}for(S(G,U[0]),ee.npotTextureCube||at(Xa(G.width)&&Xa(G.height),"your browser does not support non power or two texture dimensions"),ae.genMipmaps?G.mipmask=(U[0].width<<1)-1:G.mipmask=U[0].mipmask,at.textureCube(G,ae,U,ee),G.internalformat=U[0].internalformat,lt.width=U[0].width,lt.height=U[0].height,vt(G),_t=0;_t<6;++_t)qt(U[_t],Aa+_t);for(st(ae,Ma),yt(),_e.profile&&(G.stats.size=Ki(G.internalformat,G.type,lt.width,lt.height,ae.genMipmaps,!0)),lt.format=i[G.internalformat],lt.type=e[G.type],lt.mag=n[ae.magFilter],lt.min=u[ae.minFilter],lt.wrapS=g[ae.wrapS],lt.wrapT=g[ae.wrapT],_t=0;_t<6;++_t)Ht(U[_t]);return lt}return lt(I,P,C,O,ut,xt),lt.subimage=function(it,ft,Rt,Gt,ht){at(!!ft,"must specify image data"),at(typeof it=="number"&&it===(0|it)&&it>=0&&it<6,"invalid face");var St=0|Rt,_t=0|Gt,ae=0|ht,jt=dt();return S(jt,G),jt.width=0,jt.height=0,Q(jt,ft),jt.width=jt.width||(G.width>>ae)-St,jt.height=jt.height||(G.height>>ae)-_t,at(G.type===jt.type&&G.format===jt.format&&G.internalformat===jt.internalformat,"incompatible format for texture.subimage"),at(St>=0&&_t>=0&&St+jt.width<=G.width&&_t+jt.height<=G.height,"texture.subimage write out of bounds"),at(G.mipmask&1<<ae,"missing mipmap data"),at(jt.data||jt.element||jt.needsCopy,"missing image data"),vt(G),K(jt,Aa+it,St,_t,ae),yt(),ot(jt),lt},lt.resize=function(it){var ft=0|it;if(ft!==G.width){lt.width=G.width=ft,lt.height=G.height=ft,vt(G);for(var Rt=0;Rt<6;++Rt)for(var Gt=0;G.mipmask>>Gt;++Gt)Y.texImage2D(Aa+Rt,Gt,G.format,ft>>Gt,ft>>Gt,0,G.format,G.type,null);return yt(),_e.profile&&(G.stats.size=Ki(G.internalformat,G.type,lt.width,lt.height,!1,!0)),lt}},lt._reglType="textureCube",lt._texture=G,_e.profile&&(lt.stats=G.stats),lt.destroy=function(){G.decRef()},lt},clear:function(){for(var I=0;I<X;++I)Y.activeTexture(Sn+I),Y.bindTexture(No,null),D[I]=null;Dr(mt).forEach(At),Re.cubeCount=0,Re.textureCount=0},getTexture:function(I){return null},restore:function(){for(var I=0;I<X;++I){var P=D[I];P&&(P.bindCount=0,P.unit=-1,D[I]=null)}Dr(mt).forEach(function(C){C.texture=Y.createTexture(),Y.bindTexture(C.target,C.texture);for(var O=0;O<32;++O)if((C.mipmask&1<<O)!=0)if(C.target===No)Y.texImage2D(No,O,C.internalformat,C.width>>O,C.height>>O,0,C.internalformat,C.type,null);else for(var ut=0;ut<6;++ut)Y.texImage2D(Aa+ut,O,C.internalformat,C.width>>O,C.height>>O,0,C.internalformat,C.type,null);st(C.texInfo,C.target)})},refresh:function(){for(var I=0;I<X;++I){var P=D[I];P&&(P.bindCount=0,P.unit=-1,D[I]=null),Y.activeTexture(Sn+I),Y.bindTexture(No,null),Y.bindTexture(Ma,null)}}}}Nn[v]=2,Nn[Bt]=2,Nn[z]=2,Nn[pe]=4,Nn[Qe]=.5,Nn[ar]=.5,Nn[dr]=1,Nn[_r]=1,Nn[Te]=.5,Nn[yr]=1,Nn[Wr]=1,Nn[cn]=.5,Nn[Wn]=.25,Nn[$r]=.5,Nn[Hr]=.25,Nn[Dn]=.5;var Yo=36161,Zi=32854,mo=[];function Ya(Y,Tt,ee){return mo[Y]*Tt*ee}mo[32854]=2,mo[32855]=2,mo[36194]=2,mo[33189]=2,mo[36168]=1,mo[34041]=4,mo[35907]=4,mo[34836]=16,mo[34842]=8,mo[34843]=6;var Go=36160,Ji=36161,pi=3553,ka=34069,Ia=36064,gs=36096,ps=36128,vs=33306,ms=36053,ys=6402,ws=[6407,6408],Ka=[];Ka[6408]=4,Ka[6407]=3;var Qi=[];Qi[5121]=1,Qi[5126]=4,Qi[36193]=2;var Za=33189,Cs=36168,Es=34041,Ja=[32854,32855,36194,35907,34842,34843,34836],Ko={};Ko[ms]="complete",Ko[36054]="incomplete attachment",Ko[36057]="incomplete dimensions",Ko[36055]="incomplete, missing attachment",Ko[36061]="unsupported";var Ls=5126,Da=34962;function Oi(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Ls,this.offset=0,this.stride=0,this.divisor=0}var ta=35632,Ps=35633,xs=35718,Ta=35721,to=6408,ea=5121,bs=3333,ra=5126;function Ns(Y,Tt,ee,Ae,Se,Re,_e){function He(Ve){var Pe;Tt.next===null?(at(Se.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Pe=ea):(at(Tt.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Pe=Tt.next.colorAttachments[0].texture._texture.type,Re.oes_texture_float?(at(Pe===ea||Pe===ra,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Pe===ra&&at(_e.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):at(Pe===ea,"Reading from a framebuffer is only allowed for the type 'uint8'"));var Oe=0,We=0,nr=Ae.framebufferWidth,or=Ae.framebufferHeight,gr=null;h(Ve)?gr=Ve:Ve&&(at.type(Ve,"object","invalid arguments to regl.read()"),Oe=0|Ve.x,We=0|Ve.y,at(Oe>=0&&Oe<Ae.framebufferWidth,"invalid x offset for regl.read"),at(We>=0&&We<Ae.framebufferHeight,"invalid y offset for regl.read"),nr=0|(Ve.width||Ae.framebufferWidth-Oe),or=0|(Ve.height||Ae.framebufferHeight-We),gr=Ve.data||null),gr&&(Pe===ea?at(gr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Pe===ra&&at(gr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),at(nr>0&&nr+Oe<=Ae.framebufferWidth,"invalid width for read pixels"),at(or>0&&or+We<=Ae.framebufferHeight,"invalid height for read pixels"),ee();var cr=nr*or*4;return gr||(Pe===ea?gr=new Uint8Array(cr):Pe===ra&&(gr=gr||new Float32Array(cr))),at.isTypedArray(gr,"data buffer for regl.read() must be a typedarray"),at(gr.byteLength>=cr,"data buffer for regl.read() too small"),Y.pixelStorei(bs,4),Y.readPixels(Oe,We,nr,or,to,Pe,gr),gr}return function(Ve){return Ve&&"framebuffer"in Ve?function(Pe){var Oe;return Tt.setFBO({framebuffer:Pe.framebuffer},function(){Oe=He(Pe)}),Oe}(Ve):He(Ve)}}function Zo(Y){return Array.prototype.slice.call(Y)}function Jo(Y){return Zo(Y).join("")}var So="xyzw".split(""),Qa=5121,vi=1,Qo=2,Ra=0,na=1,oa=2,ia=3,ti=4,Ci=5,aa=6,To="dither",ts="blend.enable",Ms="blend.color",Oa="blend.equation",eo="blend.func",Ca="depth.enable",sa="depth.func",es="depth.range",La="depth.mask",Pa="colorMask",rs="cull.enable",yo="cull.face",fo="frontFace",ei="lineWidth",mi="polygonOffset.enable",ua="polygonOffset.offset",da="sample.alpha",Li="sample.enable",Fo="sample.coverage",kr="stencil.enable",za="stencil.mask",ur="stencil.func",ca="stencil.opFront",_o="stencil.opBack",ns="scissor.enable",ha="scissor.box",ko="viewport",Pi="profile",yi="framebuffer",la="vert",wi="frag",ri="elements",ni="primitive",jo="count",zi="offset",fa="instances",ga="vao",os="Width",is="Height",Gi=yi+os,Ei=yi+is,As=ko+os,zs=ko+is,Ss="drawingBuffer",d=Ss+os,o=Ss+is,t=[eo,Oa,ur,ca,_o,Fo,ko,ha,ua],r=34962,s=34963,l=3553,y=34067,b=2884,N=3042,A=3024,_=2960,F=2929,tt=3089,$=32823,q=32926,L=32928,rt=5126,nt=35664,ct=35665,Jt=35666,Yt=5124,zt=35667,bt=35668,Ot=35669,Xt=35670,Wt=35671,Z=35672,wt=35673,$t=35674,Dt=35675,ve=35676,ge=35678,ce=35680,Ne=4,ke=1028,xe=1029,Le=2304,Be=2305,Ge=32775,de=32776,Fe=519,er=7680,je=0,we=1,lr=32774,tn=513,Ir=36160,ro=36064,Tr={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Nr=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],fr={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},vr={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},sn={frag:35632,vert:35633},jr={cw:Le,ccw:Be};function Lr(Y){return Array.isArray(Y)||h(Y)||Mn(Y)}function Fn(Y){return Y.sort(function(Tt,ee){return Tt===ko?-1:ee===ko?1:Tt<ee?-1:1})}function vn(Y,Tt,ee,Ae){this.thisDep=Y,this.contextDep=Tt,this.propDep=ee,this.append=Ae}function wr(Y){return Y&&!(Y.thisDep||Y.contextDep||Y.propDep)}function on(Y){return new vn(!1,!1,!1,Y)}function tr(Y,Tt){var ee=Y.type;if(ee===Ra){var Ae=Y.data.length;return new vn(!0,Ae>=1,Ae>=2,Tt)}if(ee===ti){var Se=Y.data;return new vn(Se.thisDep,Se.contextDep,Se.propDep,Tt)}if(ee===Ci)return new vn(!1,!1,!1,Tt);if(ee===aa){for(var Re=!1,_e=!1,He=!1,Ve=0;Ve<Y.data.length;++Ve){var Pe=Y.data[Ve];if(Pe.type===na)He=!0;else if(Pe.type===oa)_e=!0;else if(Pe.type===ia)Re=!0;else if(Pe.type===Ra){Re=!0;var Oe=Pe.data;Oe>=1&&(_e=!0),Oe>=2&&(He=!0)}else Pe.type===ti&&(Re=Re||Pe.data.thisDep,_e=_e||Pe.data.contextDep,He=He||Pe.data.propDep)}return new vn(Re,_e,He,Tt)}return new vn(ee===ia,ee===oa,ee===na,Tt)}var pa=new vn(!1,!1,!1,function(){});function Uo(Y,Tt,ee,Ae,Se,Re,_e,He,Ve,Pe,Oe,We,nr,or,gr){var cr=Pe.Record,c={add:32774,subtract:32778,"reverse subtract":32779};ee.ext_blend_minmax&&(c.min=Ge,c.max=de);var i=ee.angle_instanced_arrays,e=ee.webgl_draw_buffers,n={dirty:!0,profile:gr.profile},u={},g=[],x={},M={};function S(X){return X.replace(".","_")}function T(X,D,W){var vt=S(X);g.push(X),u[vt]=n[vt]=!!W,x[vt]=D}function k(X,D,W){var vt=S(X);g.push(X),Array.isArray(W)?(n[vt]=W.slice(),u[vt]=W.slice()):n[vt]=u[vt]=W,M[vt]=D}T(To,A),T(ts,N),k(Ms,"blendColor",[0,0,0,0]),k(Oa,"blendEquationSeparate",[lr,lr]),k(eo,"blendFuncSeparate",[we,je,we,je]),T(Ca,F,!0),k(sa,"depthFunc",tn),k(es,"depthRange",[0,1]),k(La,"depthMask",!0),k(Pa,Pa,[!0,!0,!0,!0]),T(rs,b),k(yo,"cullFace",xe),k(fo,fo,Be),k(ei,ei,1),T(mi,$),k(ua,"polygonOffset",[0,0]),T(da,q),T(Li,L),k(Fo,"sampleCoverage",[1,!1]),T(kr,_),k(za,"stencilMask",-1),k(ur,"stencilFunc",[Fe,0,-1]),k(ca,"stencilOpSeparate",[ke,er,er,er]),k(_o,"stencilOpSeparate",[xe,er,er,er]),T(ns,tt),k(ha,"scissor",[0,0,Y.drawingBufferWidth,Y.drawingBufferHeight]),k(ko,ko,[0,0,Y.drawingBufferWidth,Y.drawingBufferHeight]);var B={gl:Y,context:nr,strings:Tt,next:u,current:n,draw:We,elements:Re,buffer:Se,shader:Oe,attributes:Pe.state,vao:Pe,uniforms:Ve,framebuffer:He,extensions:ee,timer:or,isBufferArgs:Lr},Q={primTypes:xo,compareFuncs:fr,blendFuncs:Tr,blendEquations:c,stencilOps:vr,glTypes:qo,orientationType:jr};at.optional(function(){B.isArrayLike=An}),e&&(Q.backBuffer=[xe],Q.drawBuffer=Sr(Ae.maxDrawbuffers,function(X){return X===0?[0]:Sr(X,function(D){return ro+D})}));var et=0;function K(){var X=function(){var O=0,ut=[],xt=[];function G(){var ft=[],Rt=[];return a(function(){ft.push.apply(ft,Zo(arguments))},{def:function(){var Gt="v"+O++;return Rt.push(Gt),arguments.length>0&&(ft.push(Gt,"="),ft.push.apply(ft,Zo(arguments)),ft.push(";")),Gt},toString:function(){return Jo([Rt.length>0?"var "+Rt.join(",")+";":"",Jo(ft)])}})}function U(){var ft=G(),Rt=G(),Gt=ft.toString,ht=Rt.toString;function St(_t,ae){Rt(_t,ae,"=",ft.def(_t,ae),";")}return a(function(){ft.apply(ft,Zo(arguments))},{def:ft.def,entry:ft,exit:Rt,save:St,set:function(_t,ae,jt){St(_t,ae),ft(_t,ae,"=",jt,";")},toString:function(){return Gt()+ht()}})}var lt=G(),it={};return{global:lt,link:function(ft){for(var Rt=0;Rt<xt.length;++Rt)if(xt[Rt]===ft)return ut[Rt];var Gt="g"+O++;return ut.push(Gt),xt.push(ft),Gt},block:G,proc:function(ft,Rt){var Gt=[];function ht(){var jt="a"+Gt.length;return Gt.push(jt),jt}Rt=Rt||0;for(var St=0;St<Rt;++St)ht();var _t=U(),ae=_t.toString;return it[ft]=a(_t,{arg:ht,toString:function(){return Jo(["function(",Gt.join(),"){",ae(),"}"])}})},scope:U,cond:function(){var ft=Jo(arguments),Rt=U(),Gt=U(),ht=Rt.toString,St=Gt.toString;return a(Rt,{then:function(){return Rt.apply(Rt,Zo(arguments)),this},else:function(){return Gt.apply(Gt,Zo(arguments)),this},toString:function(){var _t=St();return _t&&(_t="else{"+_t+"}"),Jo(["if(",ft,"){",ht(),"}",_t])}})},compile:function(){var ft=['"use strict";',lt,"return {"];Object.keys(it).forEach(function(Gt){ft.push('"',Gt,'":',it[Gt].toString(),",")}),ft.push("}");var Rt=Jo(ft).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`);return Function.apply(null,ut.concat(Rt)).apply(null,xt)}}}(),D=X.link,W=X.global;X.id=et++,X.batchId="0";var vt=D(B),yt=X.shared={props:"a0"};Object.keys(B).forEach(function(O){yt[O]=W.def(vt,".",O)}),at.optional(function(){X.CHECK=D(at),X.commandStr=at.guessCommand(),X.command=D(X.commandStr),X.assert=function(O,ut,xt){O("if(!(",ut,"))",this.CHECK,".commandRaise(",D(xt),",",this.command,");")},Q.invalidBlendCombinations=Nr});var At=X.next={},I=X.current={};Object.keys(M).forEach(function(O){Array.isArray(n[O])&&(At[O]=W.def(yt.next,".",O),I[O]=W.def(yt.current,".",O))});var P=X.constants={};Object.keys(Q).forEach(function(O){P[O]=W.def(JSON.stringify(Q[O]))}),X.invoke=function(O,ut){switch(ut.type){case Ra:var xt=["this",yt.context,yt.props,X.batchId];return O.def(D(ut.data),".call(",xt.slice(0,Math.max(ut.data.length+1,4)),")");case na:return O.def(yt.props,ut.data);case oa:return O.def(yt.context,ut.data);case ia:return O.def("this",ut.data);case ti:return ut.data.append(X,O),ut.data.ref;case Ci:return ut.data.toString();case aa:return ut.data.map(function(G){return X.invoke(O,G)})}},X.attribCache={};var C={};return X.scopeAttrib=function(O){var ut=Tt.id(O);if(ut in C)return C[ut];var xt=Pe.scope[ut];return xt||(xt=Pe.scope[ut]=new cr),C[ut]=D(xt)},X}function j(X,D,W,vt,yt){var At=X.static,I=X.dynamic;at.optional(function(){var ht=[yi,la,wi,ri,ni,zi,jo,fa,Pi,ga].concat(g);function St(_t){Object.keys(_t).forEach(function(ae){at.command(ht.indexOf(ae)>=0,'unknown parameter "'+ae+'"',yt.commandStr)})}St(At),St(I)});var P=function(ht,St){var _t=ht.static;if(typeof _t[wi]=="string"&&typeof _t[la]=="string"){if(Object.keys(St.dynamic).length>0)return null;var ae=St.static,jt=Object.keys(ae);if(jt.length>0&&typeof ae[jt[0]]=="number"){for(var Ft=[],se=0;se<jt.length;++se)at(typeof ae[jt[se]]=="number","must specify all vertex attribute locations when using vaos"),Ft.push([0|ae[jt[se]],jt[se]]);return Ft}}return null}(X,D),C=function(ht,St){var _t=ht.static,ae=ht.dynamic;if(yi in _t){var jt=_t[yi];return jt?(jt=He.getFramebuffer(jt),at.command(jt,"invalid framebuffer object"),on(function(se,Vt){var J=se.link(jt),Et=se.shared;Vt.set(Et.framebuffer,".next",J);var kt=Et.context;return Vt.set(kt,"."+Gi,J+".width"),Vt.set(kt,"."+Ei,J+".height"),J})):on(function(se,Vt){var J=se.shared;Vt.set(J.framebuffer,".next","null");var Et=J.context;return Vt.set(Et,"."+Gi,Et+"."+d),Vt.set(Et,"."+Ei,Et+"."+o),"null"})}if(yi in ae){var Ft=ae[yi];return tr(Ft,function(se,Vt){var J=se.invoke(Vt,Ft),Et=se.shared,kt=Et.framebuffer,oe=Vt.def(kt,".getFramebuffer(",J,")");at.optional(function(){se.assert(Vt,"!"+J+"||"+oe,"invalid framebuffer object")}),Vt.set(kt,".next",oe);var Ee=Et.context;return Vt.set(Ee,"."+Gi,oe+"?"+oe+".width:"+Ee+"."+d),Vt.set(Ee,"."+Ei,oe+"?"+oe+".height:"+Ee+"."+o),oe})}return null}(X),O=function(ht,St,_t){var ae=ht.static,jt=ht.dynamic;function Ft(J){if(J in ae){var Et=ae[J];at.commandType(Et,"object","invalid "+J,_t.commandStr);var kt,oe,Ee=!0,Ie=0|Et.x,Ue=0|Et.y;return"width"in Et?(kt=0|Et.width,at.command(kt>=0,"invalid "+J,_t.commandStr)):Ee=!1,"height"in Et?(oe=0|Et.height,at.command(oe>=0,"invalid "+J,_t.commandStr)):Ee=!1,new vn(!Ee&&St&&St.thisDep,!Ee&&St&&St.contextDep,!Ee&&St&&St.propDep,function(Mr,Er){var Ke=Mr.shared.context,Ur=kt;"width"in Et||(Ur=Er.def(Ke,".",Gi,"-",Ie));var mn=oe;return"height"in Et||(mn=Er.def(Ke,".",Ei,"-",Ue)),[Ie,Ue,Ur,mn]})}if(J in jt){var hr=jt[J],pr=tr(hr,function(Mr,Er){var Ke=Mr.invoke(Er,hr);at.optional(function(){Mr.assert(Er,Ke+"&&typeof "+Ke+'==="object"',"invalid "+J)});var Ur=Mr.shared.context,mn=Er.def(Ke,".x|0"),Bo=Er.def(Ke,".y|0"),oi=Er.def('"width" in ',Ke,"?",Ke,".width|0:","(",Ur,".",Gi,"-",mn,")"),Fa=Er.def('"height" in ',Ke,"?",Ke,".height|0:","(",Ur,".",Ei,"-",Bo,")");return at.optional(function(){Mr.assert(Er,oi+">=0&&"+Fa+">=0","invalid "+J)}),[mn,Bo,oi,Fa]});return St&&(pr.thisDep=pr.thisDep||St.thisDep,pr.contextDep=pr.contextDep||St.contextDep,pr.propDep=pr.propDep||St.propDep),pr}return St?new vn(St.thisDep,St.contextDep,St.propDep,function(Mr,Er){var Ke=Mr.shared.context;return[0,0,Er.def(Ke,".",Gi),Er.def(Ke,".",Ei)]}):null}var se=Ft(ko);if(se){var Vt=se;se=new vn(se.thisDep,se.contextDep,se.propDep,function(J,Et){var kt=Vt.append(J,Et),oe=J.shared.context;return Et.set(oe,"."+As,kt[2]),Et.set(oe,"."+zs,kt[3]),kt})}return{viewport:se,scissor_box:Ft(ha)}}(X,C,yt),ut=function(ht,St){var _t=ht.static,ae=ht.dynamic,jt=function(){if(ri in _t){var Vt=_t[ri];Lr(Vt)?Vt=Re.getElements(Re.create(Vt,!0)):Vt&&(Vt=Re.getElements(Vt),at.command(Vt,"invalid elements",St.commandStr));var J=on(function(kt,oe){if(Vt){var Ee=kt.link(Vt);return kt.ELEMENTS=Ee,Ee}return kt.ELEMENTS=null,null});return J.value=Vt,J}if(ri in ae){var Et=ae[ri];return tr(Et,function(kt,oe){var Ee=kt.shared,Ie=Ee.isBufferArgs,Ue=Ee.elements,hr=kt.invoke(oe,Et),pr=oe.def("null"),Mr=oe.def(Ie,"(",hr,")"),Er=kt.cond(Mr).then(pr,"=",Ue,".createStream(",hr,");").else(pr,"=",Ue,".getElements(",hr,");");return at.optional(function(){kt.assert(Er.else,"!"+hr+"||"+pr,"invalid elements")}),oe.entry(Er),oe.exit(kt.cond(Mr).then(Ue,".destroyStream(",pr,");")),kt.ELEMENTS=pr,pr})}return null}();function Ft(Vt,J){if(Vt in _t){var Et=0|_t[Vt];return at.command(!J||Et>=0,"invalid "+Vt,St.commandStr),on(function(oe,Ee){return J&&(oe.OFFSET=Et),Et})}if(Vt in ae){var kt=ae[Vt];return tr(kt,function(oe,Ee){var Ie=oe.invoke(Ee,kt);return J&&(oe.OFFSET=Ie,at.optional(function(){oe.assert(Ee,Ie+">=0","invalid "+Vt)})),Ie})}return J&&jt?on(function(oe,Ee){return oe.OFFSET="0",0}):null}var se=Ft(zi,!0);return{elements:jt,primitive:function(){if(ni in _t){var Vt=_t[ni];return at.commandParameter(Vt,xo,"invalid primitve",St.commandStr),on(function(Et,kt){return xo[Vt]})}if(ni in ae){var J=ae[ni];return tr(J,function(Et,kt){var oe=Et.constants.primTypes,Ee=Et.invoke(kt,J);return at.optional(function(){Et.assert(kt,Ee+" in "+oe,"invalid primitive, must be one of "+Object.keys(xo))}),kt.def(oe,"[",Ee,"]")})}return jt?wr(jt)?jt.value?on(function(Et,kt){return kt.def(Et.ELEMENTS,".primType")}):on(function(){return Ne}):new vn(jt.thisDep,jt.contextDep,jt.propDep,function(Et,kt){var oe=Et.ELEMENTS;return kt.def(oe,"?",oe,".primType:",Ne)}):null}(),count:function(){if(jo in _t){var Vt=0|_t[jo];return at.command(typeof Vt=="number"&&Vt>=0,"invalid vertex count",St.commandStr),on(function(){return Vt})}if(jo in ae){var J=ae[jo];return tr(J,function(oe,Ee){var Ie=oe.invoke(Ee,J);return at.optional(function(){oe.assert(Ee,"typeof "+Ie+'==="number"&&'+Ie+">=0&&"+Ie+"===("+Ie+"|0)","invalid vertex count")}),Ie})}if(jt){if(wr(jt)){if(jt)return se?new vn(se.thisDep,se.contextDep,se.propDep,function(oe,Ee){var Ie=Ee.def(oe.ELEMENTS,".vertCount-",oe.OFFSET);return at.optional(function(){oe.assert(Ee,Ie+">=0","invalid vertex offset/element buffer too small")}),Ie}):on(function(oe,Ee){return Ee.def(oe.ELEMENTS,".vertCount")});var Et=on(function(){return-1});return at.optional(function(){Et.MISSING=!0}),Et}var kt=new vn(jt.thisDep||se.thisDep,jt.contextDep||se.contextDep,jt.propDep||se.propDep,function(oe,Ee){var Ie=oe.ELEMENTS;return oe.OFFSET?Ee.def(Ie,"?",Ie,".vertCount-",oe.OFFSET,":-1"):Ee.def(Ie,"?",Ie,".vertCount:-1")});return at.optional(function(){kt.DYNAMIC=!0}),kt}return null}(),instances:Ft(fa,!1),offset:se}}(X,yt),xt=function(ht,St){var _t=ht.static,ae=ht.dynamic,jt={};return g.forEach(function(Ft){var se=S(Ft);function Vt(J,Et){if(Ft in _t){var kt=J(_t[Ft]);jt[se]=on(function(){return kt})}else if(Ft in ae){var oe=ae[Ft];jt[se]=tr(oe,function(Ee,Ie){return Et(Ee,Ie,Ee.invoke(Ie,oe))})}}switch(Ft){case rs:case ts:case To:case kr:case Ca:case ns:case mi:case da:case Li:case La:return Vt(function(J){return at.commandType(J,"boolean",Ft,St.commandStr),J},function(J,Et,kt){return at.optional(function(){J.assert(Et,"typeof "+kt+'==="boolean"',"invalid flag "+Ft,J.commandStr)}),kt});case sa:return Vt(function(J){return at.commandParameter(J,fr,"invalid "+Ft,St.commandStr),fr[J]},function(J,Et,kt){var oe=J.constants.compareFuncs;return at.optional(function(){J.assert(Et,kt+" in "+oe,"invalid "+Ft+", must be one of "+Object.keys(fr))}),Et.def(oe,"[",kt,"]")});case es:return Vt(function(J){return at.command(An(J)&&J.length===2&&typeof J[0]=="number"&&typeof J[1]=="number"&&J[0]<=J[1],"depth range is 2d array",St.commandStr),J},function(J,Et,kt){return at.optional(function(){J.assert(Et,J.shared.isArrayLike+"("+kt+")&&"+kt+".length===2&&typeof "+kt+'[0]==="number"&&typeof '+kt+'[1]==="number"&&'+kt+"[0]<="+kt+"[1]","depth range must be a 2d array")}),[Et.def("+",kt,"[0]"),Et.def("+",kt,"[1]")]});case eo:return Vt(function(J){at.commandType(J,"object","blend.func",St.commandStr);var Et="srcRGB"in J?J.srcRGB:J.src,kt="srcAlpha"in J?J.srcAlpha:J.src,oe="dstRGB"in J?J.dstRGB:J.dst,Ee="dstAlpha"in J?J.dstAlpha:J.dst;return at.commandParameter(Et,Tr,se+".srcRGB",St.commandStr),at.commandParameter(kt,Tr,se+".srcAlpha",St.commandStr),at.commandParameter(oe,Tr,se+".dstRGB",St.commandStr),at.commandParameter(Ee,Tr,se+".dstAlpha",St.commandStr),at.command(Nr.indexOf(Et+", "+oe)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+Et+", "+oe+")",St.commandStr),[Tr[Et],Tr[oe],Tr[kt],Tr[Ee]]},function(J,Et,kt){var oe=J.constants.blendFuncs;function Ee(Mr,Er){var Ke=Et.def('"',Mr,Er,'" in ',kt,"?",kt,".",Mr,Er,":",kt,".",Mr);return at.optional(function(){J.assert(Et,Ke+" in "+oe,"invalid "+Ft+"."+Mr+Er+", must be one of "+Object.keys(Tr))}),Ke}at.optional(function(){J.assert(Et,kt+"&&typeof "+kt+'==="object"',"invalid blend func, must be an object")});var Ie=Ee("src","RGB"),Ue=Ee("dst","RGB");at.optional(function(){var Mr=J.constants.invalidBlendCombinations;J.assert(Et,Mr+".indexOf("+Ie+'+", "+'+Ue+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var hr=Et.def(oe,"[",Ie,"]"),pr=Et.def(oe,"[",Ee("src","Alpha"),"]");return[hr,Et.def(oe,"[",Ue,"]"),pr,Et.def(oe,"[",Ee("dst","Alpha"),"]")]});case Oa:return Vt(function(J){return typeof J=="string"?(at.commandParameter(J,c,"invalid "+Ft,St.commandStr),[c[J],c[J]]):typeof J=="object"?(at.commandParameter(J.rgb,c,Ft+".rgb",St.commandStr),at.commandParameter(J.alpha,c,Ft+".alpha",St.commandStr),[c[J.rgb],c[J.alpha]]):void at.commandRaise("invalid blend.equation",St.commandStr)},function(J,Et,kt){var oe=J.constants.blendEquations,Ee=Et.def(),Ie=Et.def(),Ue=J.cond("typeof ",kt,'==="string"');return at.optional(function(){function hr(pr,Mr,Er){J.assert(pr,Er+" in "+oe,"invalid "+Mr+", must be one of "+Object.keys(c))}hr(Ue.then,Ft,kt),J.assert(Ue.else,kt+"&&typeof "+kt+'==="object"',"invalid "+Ft),hr(Ue.else,Ft+".rgb",kt+".rgb"),hr(Ue.else,Ft+".alpha",kt+".alpha")}),Ue.then(Ee,"=",Ie,"=",oe,"[",kt,"];"),Ue.else(Ee,"=",oe,"[",kt,".rgb];",Ie,"=",oe,"[",kt,".alpha];"),Et(Ue),[Ee,Ie]});case Ms:return Vt(function(J){return at.command(An(J)&&J.length===4,"blend.color must be a 4d array",St.commandStr),Sr(4,function(Et){return+J[Et]})},function(J,Et,kt){return at.optional(function(){J.assert(Et,J.shared.isArrayLike+"("+kt+")&&"+kt+".length===4","blend.color must be a 4d array")}),Sr(4,function(oe){return Et.def("+",kt,"[",oe,"]")})});case za:return Vt(function(J){return at.commandType(J,"number",se,St.commandStr),0|J},function(J,Et,kt){return at.optional(function(){J.assert(Et,"typeof "+kt+'==="number"',"invalid stencil.mask")}),Et.def(kt,"|0")});case ur:return Vt(function(J){at.commandType(J,"object",se,St.commandStr);var Et=J.cmp||"keep",kt=J.ref||0,oe="mask"in J?J.mask:-1;return at.commandParameter(Et,fr,Ft+".cmp",St.commandStr),at.commandType(kt,"number",Ft+".ref",St.commandStr),at.commandType(oe,"number",Ft+".mask",St.commandStr),[fr[Et],kt,oe]},function(J,Et,kt){var oe=J.constants.compareFuncs;return at.optional(function(){function Ee(){J.assert(Et,Array.prototype.join.call(arguments,""),"invalid stencil.func")}Ee(kt+"&&typeof ",kt,'==="object"'),Ee('!("cmp" in ',kt,")||(",kt,".cmp in ",oe,")")}),[Et.def('"cmp" in ',kt,"?",oe,"[",kt,".cmp]",":",er),Et.def(kt,".ref|0"),Et.def('"mask" in ',kt,"?",kt,".mask|0:-1")]});case ca:case _o:return Vt(function(J){at.commandType(J,"object",se,St.commandStr);var Et=J.fail||"keep",kt=J.zfail||"keep",oe=J.zpass||"keep";return at.commandParameter(Et,vr,Ft+".fail",St.commandStr),at.commandParameter(kt,vr,Ft+".zfail",St.commandStr),at.commandParameter(oe,vr,Ft+".zpass",St.commandStr),[Ft===_o?xe:ke,vr[Et],vr[kt],vr[oe]]},function(J,Et,kt){var oe=J.constants.stencilOps;function Ee(Ie){return at.optional(function(){J.assert(Et,'!("'+Ie+'" in '+kt+")||("+kt+"."+Ie+" in "+oe+")","invalid "+Ft+"."+Ie+", must be one of "+Object.keys(vr))}),Et.def('"',Ie,'" in ',kt,"?",oe,"[",kt,".",Ie,"]:",er)}return at.optional(function(){J.assert(Et,kt+"&&typeof "+kt+'==="object"',"invalid "+Ft)}),[Ft===_o?xe:ke,Ee("fail"),Ee("zfail"),Ee("zpass")]});case ua:return Vt(function(J){at.commandType(J,"object",se,St.commandStr);var Et=0|J.factor,kt=0|J.units;return at.commandType(Et,"number",se+".factor",St.commandStr),at.commandType(kt,"number",se+".units",St.commandStr),[Et,kt]},function(J,Et,kt){return at.optional(function(){J.assert(Et,kt+"&&typeof "+kt+'==="object"',"invalid "+Ft)}),[Et.def(kt,".factor|0"),Et.def(kt,".units|0")]});case yo:return Vt(function(J){var Et=0;return J==="front"?Et=ke:J==="back"&&(Et=xe),at.command(!!Et,se,St.commandStr),Et},function(J,Et,kt){return at.optional(function(){J.assert(Et,kt+'==="front"||'+kt+'==="back"',"invalid cull.face")}),Et.def(kt,'==="front"?',ke,":",xe)});case ei:return Vt(function(J){return at.command(typeof J=="number"&&J>=Ae.lineWidthDims[0]&&J<=Ae.lineWidthDims[1],"invalid line width, must be a positive number between "+Ae.lineWidthDims[0]+" and "+Ae.lineWidthDims[1],St.commandStr),J},function(J,Et,kt){return at.optional(function(){J.assert(Et,"typeof "+kt+'==="number"&&'+kt+">="+Ae.lineWidthDims[0]+"&&"+kt+"<="+Ae.lineWidthDims[1],"invalid line width")}),kt});case fo:return Vt(function(J){return at.commandParameter(J,jr,se,St.commandStr),jr[J]},function(J,Et,kt){return at.optional(function(){J.assert(Et,kt+'==="cw"||'+kt+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),Et.def(kt+'==="cw"?'+Le+":"+Be)});case Pa:return Vt(function(J){return at.command(An(J)&&J.length===4,"color.mask must be length 4 array",St.commandStr),J.map(function(Et){return!!Et})},function(J,Et,kt){return at.optional(function(){J.assert(Et,J.shared.isArrayLike+"("+kt+")&&"+kt+".length===4","invalid color.mask")}),Sr(4,function(oe){return"!!"+kt+"["+oe+"]"})});case Fo:return Vt(function(J){at.command(typeof J=="object"&&J,se,St.commandStr);var Et="value"in J?J.value:1,kt=!!J.invert;return at.command(typeof Et=="number"&&Et>=0&&Et<=1,"sample.coverage.value must be a number between 0 and 1",St.commandStr),[Et,kt]},function(J,Et,kt){return at.optional(function(){J.assert(Et,kt+"&&typeof "+kt+'==="object"',"invalid sample.coverage")}),[Et.def('"value" in ',kt,"?+",kt,".value:1"),Et.def("!!",kt,".invert")]})}}),jt}(X,yt),G=function(ht,St,_t){var ae=ht.static,jt=ht.dynamic;function Ft(kt){if(kt in ae){var oe=Tt.id(ae[kt]);at.optional(function(){Oe.shader(sn[kt],oe,at.guessCommand())});var Ee=on(function(){return oe});return Ee.id=oe,Ee}if(kt in jt){var Ie=jt[kt];return tr(Ie,function(Ue,hr){var pr=Ue.invoke(hr,Ie),Mr=hr.def(Ue.shared.strings,".id(",pr,")");return at.optional(function(){hr(Ue.shared.shader,".shader(",sn[kt],",",Mr,",",Ue.command,");")}),Mr})}return null}var se,Vt=Ft(wi),J=Ft(la),Et=null;return wr(Vt)&&wr(J)?(Et=Oe.program(J.id,Vt.id,null,_t),se=on(function(kt,oe){return kt.link(Et)})):se=new vn(Vt&&Vt.thisDep||J&&J.thisDep,Vt&&Vt.contextDep||J&&J.contextDep,Vt&&Vt.propDep||J&&J.propDep,function(kt,oe){var Ee,Ie=kt.shared.shader;Ee=Vt?Vt.append(kt,oe):oe.def(Ie,".",wi);var Ue=Ie+".program("+(J?J.append(kt,oe):oe.def(Ie,".",la))+","+Ee;return at.optional(function(){Ue+=","+kt.command}),oe.def(Ue+")")}),{frag:Vt,vert:J,progVar:se,program:Et}}(X,0,P);function U(ht){var St=O[ht];St&&(xt[ht]=St)}U(ko),U(S(ha));var lt=Object.keys(xt).length>0,it={framebuffer:C,draw:ut,shader:G,state:xt,dirty:lt,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(it.profile=function(ht){var St,_t=ht.static,ae=ht.dynamic;if(Pi in _t){var jt=!!_t[Pi];(St=on(function(se,Vt){return jt})).enable=jt}else if(Pi in ae){var Ft=ae[Pi];St=tr(Ft,function(se,Vt){return se.invoke(Vt,Ft)})}return St}(X),it.uniforms=function(ht,St){var _t=ht.static,ae=ht.dynamic,jt={};return Object.keys(_t).forEach(function(Ft){var se,Vt=_t[Ft];if(typeof Vt=="number"||typeof Vt=="boolean")se=on(function(){return Vt});else if(typeof Vt=="function"){var J=Vt._reglType;J==="texture2d"||J==="textureCube"?se=on(function(Et){return Et.link(Vt)}):J==="framebuffer"||J==="framebufferCube"?(at.command(Vt.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Ft+'"',St.commandStr),se=on(function(Et){return Et.link(Vt.color[0])})):at.commandRaise('invalid data for uniform "'+Ft+'"',St.commandStr)}else An(Vt)?se=on(function(Et){return Et.global.def("[",Sr(Vt.length,function(kt){return at.command(typeof Vt[kt]=="number"||typeof Vt[kt]=="boolean","invalid uniform "+Ft,Et.commandStr),Vt[kt]}),"]")}):at.commandRaise('invalid or missing data for uniform "'+Ft+'"',St.commandStr);se.value=Vt,jt[Ft]=se}),Object.keys(ae).forEach(function(Ft){var se=ae[Ft];jt[Ft]=tr(se,function(Vt,J){return Vt.invoke(J,se)})}),jt}(W,yt),it.drawVAO=it.scopeVAO=function(ht,St){var _t=ht.static,ae=ht.dynamic;if(ga in _t){var jt=_t[ga];return jt!==null&&Pe.getVAO(jt)===null&&(jt=Pe.createVAO(jt)),on(function(se){return se.link(Pe.getVAO(jt))})}if(ga in ae){var Ft=ae[ga];return tr(Ft,function(se,Vt){var J=se.invoke(Vt,Ft);return Vt.def(se.shared.vao+".getVAO("+J+")")})}return null}(X),!it.drawVAO&&G.program&&!P&&ee.angle_instanced_arrays){var ft=!0,Rt=G.program.attributes.map(function(ht){var St=D.static[ht];return ft=ft&&!!St,St});if(ft&&Rt.length>0){var Gt=Pe.getVAO(Pe.createVAO(Rt));it.drawVAO=new vn(null,null,null,function(ht,St){return ht.link(Gt)}),it.useVAO=!0}}return P?it.useVAO=!0:it.attributes=function(ht,St){var _t=ht.static,ae=ht.dynamic,jt={};return Object.keys(_t).forEach(function(Ft){var se=_t[Ft],Vt=Tt.id(Ft),J=new cr;if(Lr(se))J.state=vi,J.buffer=Se.getBuffer(Se.create(se,r,!1,!0)),J.type=0;else{var Et=Se.getBuffer(se);if(Et)J.state=vi,J.buffer=Et,J.type=0;else if(at.command(typeof se=="object"&&se,"invalid data for attribute "+Ft,St.commandStr),"constant"in se){var kt=se.constant;J.buffer="null",J.state=Qo,typeof kt=="number"?J.x=kt:(at.command(An(kt)&&kt.length>0&&kt.length<=4,"invalid constant for attribute "+Ft,St.commandStr),So.forEach(function(Mr,Er){Er<kt.length&&(J[Mr]=kt[Er])}))}else{Et=Lr(se.buffer)?Se.getBuffer(Se.create(se.buffer,r,!1,!0)):Se.getBuffer(se.buffer),at.command(!!Et,'missing buffer for attribute "'+Ft+'"',St.commandStr);var oe=0|se.offset;at.command(oe>=0,'invalid offset for attribute "'+Ft+'"',St.commandStr);var Ee=0|se.stride;at.command(Ee>=0&&Ee<256,'invalid stride for attribute "'+Ft+'", must be integer betweeen [0, 255]',St.commandStr);var Ie=0|se.size;at.command(!("size"in se)||Ie>0&&Ie<=4,'invalid size for attribute "'+Ft+'", must be 1,2,3,4',St.commandStr);var Ue=!!se.normalized,hr=0;"type"in se&&(at.commandParameter(se.type,qo,"invalid type for attribute "+Ft,St.commandStr),hr=qo[se.type]);var pr=0|se.divisor;"divisor"in se&&(at.command(pr===0||i,'cannot specify divisor for attribute "'+Ft+'", instancing not supported',St.commandStr),at.command(pr>=0,'invalid divisor for attribute "'+Ft+'"',St.commandStr)),at.optional(function(){var Mr=St.commandStr,Er=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(se).forEach(function(Ke){at.command(Er.indexOf(Ke)>=0,'unknown parameter "'+Ke+'" for attribute pointer "'+Ft+'" (valid parameters are '+Er+")",Mr)})}),J.buffer=Et,J.state=vi,J.size=Ie,J.normalized=Ue,J.type=hr||Et.dtype,J.offset=oe,J.stride=Ee,J.divisor=pr}}jt[Ft]=on(function(Mr,Er){var Ke=Mr.attribCache;if(Vt in Ke)return Ke[Vt];var Ur={isStream:!1};return Object.keys(J).forEach(function(mn){Ur[mn]=J[mn]}),J.buffer&&(Ur.buffer=Mr.link(J.buffer),Ur.type=Ur.type||Ur.buffer+".dtype"),Ke[Vt]=Ur,Ur})}),Object.keys(ae).forEach(function(Ft){var se=ae[Ft];jt[Ft]=tr(se,function(Vt,J){var Et=Vt.invoke(J,se),kt=Vt.shared,oe=Vt.constants,Ee=kt.isBufferArgs,Ie=kt.buffer;at.optional(function(){Vt.assert(J,Et+"&&(typeof "+Et+'==="object"||typeof '+Et+'==="function")&&('+Ee+"("+Et+")||"+Ie+".getBuffer("+Et+")||"+Ie+".getBuffer("+Et+".buffer)||"+Ee+"("+Et+'.buffer)||("constant" in '+Et+"&&(typeof "+Et+'.constant==="number"||'+kt.isArrayLike+"("+Et+".constant))))",'invalid dynamic attribute "'+Ft+'"')});var Ue={isStream:J.def(!1)},hr=new cr;hr.state=vi,Object.keys(hr).forEach(function(Ke){Ue[Ke]=J.def(""+hr[Ke])});var pr=Ue.buffer,Mr=Ue.type;function Er(Ke){J(Ue[Ke],"=",Et,".",Ke,"|0;")}return J("if(",Ee,"(",Et,")){",Ue.isStream,"=true;",pr,"=",Ie,".createStream(",r,",",Et,");",Mr,"=",pr,".dtype;","}else{",pr,"=",Ie,".getBuffer(",Et,");","if(",pr,"){",Mr,"=",pr,".dtype;",'}else if("constant" in ',Et,"){",Ue.state,"=",Qo,";","if(typeof "+Et+'.constant === "number"){',Ue[So[0]],"=",Et,".constant;",So.slice(1).map(function(Ke){return Ue[Ke]}).join("="),"=0;","}else{",So.map(function(Ke,Ur){return Ue[Ke]+"="+Et+".constant.length>"+Ur+"?"+Et+".constant["+Ur+"]:0;"}).join(""),"}}else{","if(",Ee,"(",Et,".buffer)){",pr,"=",Ie,".createStream(",r,",",Et,".buffer);","}else{",pr,"=",Ie,".getBuffer(",Et,".buffer);","}",Mr,'="type" in ',Et,"?",oe.glTypes,"[",Et,".type]:",pr,".dtype;",Ue.normalized,"=!!",Et,".normalized;"),Er("size"),Er("offset"),Er("stride"),Er("divisor"),J("}}"),J.exit("if(",Ue.isStream,"){",Ie,".destroyStream(",pr,");","}"),Ue})}),jt}(D,yt),it.context=function(ht){var St=ht.static,_t=ht.dynamic,ae={};return Object.keys(St).forEach(function(jt){var Ft=St[jt];ae[jt]=on(function(se,Vt){return typeof Ft=="number"||typeof Ft=="boolean"?""+Ft:se.link(Ft)})}),Object.keys(_t).forEach(function(jt){var Ft=_t[jt];ae[jt]=tr(Ft,function(se,Vt){return se.invoke(Vt,Ft)})}),ae}(vt),it}function dt(X,D,W){var vt=X.shared.context,yt=X.scope();Object.keys(W).forEach(function(At){D.save(vt,"."+At);var I=W[At].append(X,D);Array.isArray(I)?yt(vt,".",At,"=[",I.join(),"];"):yt(vt,".",At,"=",I,";")}),D(yt)}function ot(X,D,W,vt){var yt,At=X.shared,I=At.gl,P=At.framebuffer;e&&(yt=D.def(At.extensions,".webgl_draw_buffers"));var C,O=X.constants,ut=O.drawBuffer,xt=O.backBuffer;C=W?W.append(X,D):D.def(P,".next"),vt||D("if(",C,"!==",P,".cur){"),D("if(",C,"){",I,".bindFramebuffer(",Ir,",",C,".framebuffer);"),e&&D(yt,".drawBuffersWEBGL(",ut,"[",C,".colorAttachments.length]);"),D("}else{",I,".bindFramebuffer(",Ir,",null);"),e&&D(yt,".drawBuffersWEBGL(",xt,");"),D("}",P,".cur=",C,";"),vt||D("}")}function pt(X,D,W){var vt=X.shared,yt=vt.gl,At=X.current,I=X.next,P=vt.current,C=vt.next,O=X.cond(P,".dirty");g.forEach(function(ut){var xt,G,U=S(ut);if(!(U in W.state))if(U in I){xt=I[U],G=At[U];var lt=Sr(n[U].length,function(ft){return O.def(xt,"[",ft,"]")});O(X.cond(lt.map(function(ft,Rt){return ft+"!=="+G+"["+Rt+"]"}).join("||")).then(yt,".",M[U],"(",lt,");",lt.map(function(ft,Rt){return G+"["+Rt+"]="+ft}).join(";"),";"))}else{xt=O.def(C,".",U);var it=X.cond(xt,"!==",P,".",U);O(it),U in x?it(X.cond(xt).then(yt,".enable(",x[U],");").else(yt,".disable(",x[U],");"),P,".",U,"=",xt,";"):it(yt,".",M[U],"(",xt,");",P,".",U,"=",xt,";")}}),Object.keys(W.state).length===0&&O(P,".dirty=false;"),D(O)}function ne(X,D,W,vt){var yt=X.shared,At=X.current,I=yt.current,P=yt.gl;Fn(Object.keys(W)).forEach(function(C){var O=W[C];if(!vt||vt(O)){var ut=O.append(X,D);if(x[C]){var xt=x[C];wr(O)?D(P,ut?".enable(":".disable(",xt,");"):D(X.cond(ut).then(P,".enable(",xt,");").else(P,".disable(",xt,");")),D(I,".",C,"=",ut,";")}else if(An(ut)){var G=At[C];D(P,".",M[C],"(",ut,");",ut.map(function(U,lt){return G+"["+lt+"]="+U}).join(";"),";")}else D(P,".",M[C],"(",ut,");",I,".",C,"=",ut,";")}})}function Kt(X,D){i&&(X.instancing=D.def(X.shared.extensions,".angle_instanced_arrays"))}function qt(X,D,W,vt,yt){var At,I,P,C=X.shared,O=X.stats,ut=C.current,xt=C.timer,G=W.profile;function U(){return typeof performance>"u"?"Date.now()":"performance.now()"}function lt(ht){ht(At=D.def(),"=",U(),";"),typeof yt=="string"?ht(O,".count+=",yt,";"):ht(O,".count++;"),or&&(vt?ht(I=D.def(),"=",xt,".getNumPendingQueries();"):ht(xt,".beginQuery(",O,");"))}function it(ht){ht(O,".cpuTime+=",U(),"-",At,";"),or&&(vt?ht(xt,".pushScopeStats(",I,",",xt,".getNumPendingQueries(),",O,");"):ht(xt,".endQuery();"))}function ft(ht){var St=D.def(ut,".profile");D(ut,".profile=",ht,";"),D.exit(ut,".profile=",St,";")}if(G){if(wr(G))return void(G.enable?(lt(D),it(D.exit),ft("true")):ft("false"));ft(P=G.append(X,D))}else P=D.def(ut,".profile");var Rt=X.block();lt(Rt),D("if(",P,"){",Rt,"}");var Gt=X.block();it(Gt),D.exit("if(",P,"){",Gt,"}")}function Nt(X,D,W,vt,yt){var At=X.shared;vt.forEach(function(I){var P,C=I.name,O=W.attributes[C];if(O){if(!yt(O))return;P=O.append(X,D)}else{if(!yt(pa))return;var ut=X.scopeAttrib(C);at.optional(function(){X.assert(D,ut+".state","missing attribute "+C)}),P={},Object.keys(new cr).forEach(function(xt){P[xt]=D.def(ut,".",xt)})}(function(xt,G,U){var lt=At.gl,it=D.def(xt,".location"),ft=D.def(At.attributes,"[",it,"]"),Rt=U.state,Gt=U.buffer,ht=[U.x,U.y,U.z,U.w],St=["buffer","normalized","offset","stride"];function _t(){D("if(!",ft,".buffer){",lt,".enableVertexAttribArray(",it,");}");var jt,Ft=U.type;if(jt=U.size?D.def(U.size,"||",G):G,D("if(",ft,".type!==",Ft,"||",ft,".size!==",jt,"||",St.map(function(Vt){return ft+"."+Vt+"!=="+U[Vt]}).join("||"),"){",lt,".bindBuffer(",r,",",Gt,".buffer);",lt,".vertexAttribPointer(",[it,jt,Ft,U.normalized,U.stride,U.offset],");",ft,".type=",Ft,";",ft,".size=",jt,";",St.map(function(Vt){return ft+"."+Vt+"="+U[Vt]+";"}).join(""),"}"),i){var se=U.divisor;D("if(",ft,".divisor!==",se,"){",X.instancing,".vertexAttribDivisorANGLE(",[it,se],");",ft,".divisor=",se,";}")}}function ae(){D("if(",ft,".buffer){",lt,".disableVertexAttribArray(",it,");",ft,".buffer=null;","}if(",So.map(function(jt,Ft){return ft+"."+jt+"!=="+ht[Ft]}).join("||"),"){",lt,".vertexAttrib4f(",it,",",ht,");",So.map(function(jt,Ft){return ft+"."+jt+"="+ht[Ft]+";"}).join(""),"}")}Rt===vi?_t():Rt===Qo?ae():(D("if(",Rt,"===",vi,"){"),_t(),D("}else{"),ae(),D("}"))})(X.link(I),function(xt){switch(xt){case nt:case zt:case Wt:return 2;case ct:case bt:case Z:return 3;case Jt:case Ot:case wt:return 4;default:return 1}}(I.info.type),P)})}function Pt(X,D,W,vt,yt){for(var At,I=X.shared,P=I.gl,C=0;C<vt.length;++C){var O,ut=vt[C],xt=ut.name,G=ut.info.type,U=W.uniforms[xt],lt=X.link(ut)+".location";if(U){if(!yt(U))continue;if(wr(U)){var it=U.value;if(at.command(it!=null,'missing uniform "'+xt+'"',X.commandStr),G===ge||G===ce){at.command(typeof it=="function"&&(G===ge&&(it._reglType==="texture2d"||it._reglType==="framebuffer")||G===ce&&(it._reglType==="textureCube"||it._reglType==="framebufferCube")),"invalid texture for uniform "+xt,X.commandStr);var ft=X.link(it._texture||it.color[0]._texture);D(P,".uniform1i(",lt,",",ft+".bind());"),D.exit(ft,".unbind();")}else if(G===$t||G===Dt||G===ve){at.optional(function(){at.command(An(it),"invalid matrix for uniform "+xt,X.commandStr),at.command(G===$t&&it.length===4||G===Dt&&it.length===9||G===ve&&it.length===16,"invalid length for matrix uniform "+xt,X.commandStr)});var Rt=X.global.def("new Float32Array(["+Array.prototype.slice.call(it)+"])"),Gt=2;G===Dt?Gt=3:G===ve&&(Gt=4),D(P,".uniformMatrix",Gt,"fv(",lt,",false,",Rt,");")}else{switch(G){case rt:at.commandType(it,"number","uniform "+xt,X.commandStr),At="1f";break;case nt:at.command(An(it)&&it.length===2,"uniform "+xt,X.commandStr),At="2f";break;case ct:at.command(An(it)&&it.length===3,"uniform "+xt,X.commandStr),At="3f";break;case Jt:at.command(An(it)&&it.length===4,"uniform "+xt,X.commandStr),At="4f";break;case Xt:at.commandType(it,"boolean","uniform "+xt,X.commandStr),At="1i";break;case Yt:at.commandType(it,"number","uniform "+xt,X.commandStr),At="1i";break;case Wt:case zt:at.command(An(it)&&it.length===2,"uniform "+xt,X.commandStr),At="2i";break;case Z:case bt:at.command(An(it)&&it.length===3,"uniform "+xt,X.commandStr),At="3i";break;case wt:case Ot:at.command(An(it)&&it.length===4,"uniform "+xt,X.commandStr),At="4i"}D(P,".uniform",At,"(",lt,",",An(it)?Array.prototype.slice.call(it):it,");")}continue}O=U.append(X,D)}else{if(!yt(pa))continue;O=D.def(I.uniforms,"[",Tt.id(xt),"]")}G===ge?(at(!Array.isArray(O),"must specify a scalar prop for textures"),D("if(",O,"&&",O,'._reglType==="framebuffer"){',O,"=",O,".color[0];","}")):G===ce&&(at(!Array.isArray(O),"must specify a scalar prop for cube maps"),D("if(",O,"&&",O,'._reglType==="framebufferCube"){',O,"=",O,".color[0];","}")),at.optional(function(){function jt(J,Et){X.assert(D,J,'bad data or missing for uniform "'+xt+'".  '+Et)}function Ft(J){at(!Array.isArray(O),"must not specify an array type for uniform"),jt("typeof "+O+'==="'+J+'"',"invalid type, expected "+J)}function se(J,Et){Array.isArray(O)?at(O.length===J,"must have length "+J):jt(I.isArrayLike+"("+O+")&&"+O+".length==="+J,"invalid vector, should have length "+J,X.commandStr)}function Vt(J){at(!Array.isArray(O),"must not specify a value type"),jt("typeof "+O+'==="function"&&'+O+'._reglType==="texture'+(J===l?"2d":"Cube")+'"',"invalid texture type",X.commandStr)}switch(G){case Yt:Ft("number");break;case zt:se(2);break;case bt:se(3);break;case Ot:se(4);break;case rt:Ft("number");break;case nt:se(2);break;case ct:se(3);break;case Jt:se(4);break;case Xt:Ft("boolean");break;case Wt:se(2);break;case Z:se(3);break;case wt:case $t:se(4);break;case Dt:se(9);break;case ve:se(16);break;case ge:Vt(l);break;case ce:Vt(y)}});var ht=1;switch(G){case ge:case ce:var St=D.def(O,"._texture");D(P,".uniform1i(",lt,",",St,".bind());"),D.exit(St,".unbind();");continue;case Yt:case Xt:At="1i";break;case zt:case Wt:At="2i",ht=2;break;case bt:case Z:At="3i",ht=3;break;case Ot:case wt:At="4i",ht=4;break;case rt:At="1f";break;case nt:At="2f",ht=2;break;case ct:At="3f",ht=3;break;case Jt:At="4f",ht=4;break;case $t:At="Matrix2fv";break;case Dt:At="Matrix3fv";break;case ve:At="Matrix4fv"}if(D(P,".uniform",At,"(",lt,","),At.charAt(0)==="M"){var _t=Math.pow(G-$t+2,2),ae=X.global.def("new Float32Array(",_t,")");Array.isArray(O)?D("false,(",Sr(_t,function(jt){return ae+"["+jt+"]="+O[jt]}),",",ae,")"):D("false,(Array.isArray(",O,")||",O," instanceof Float32Array)?",O,":(",Sr(_t,function(jt){return ae+"["+jt+"]="+O+"["+jt+"]"}),",",ae,")")}else ht>1?D(Sr(ht,function(jt){return Array.isArray(O)?O[jt]:O+"["+jt+"]"})):(at(!Array.isArray(O),"uniform value must not be an array"),D(O));D(");")}}function Ht(X,D,W,vt){var yt=X.shared,At=yt.gl,I=yt.draw,P=vt.draw,C=function(){var ht,St=P.elements,_t=D;return St?((St.contextDep&&vt.contextDynamic||St.propDep)&&(_t=W),ht=St.append(X,_t)):ht=_t.def(I,".",ri),ht&&_t("if("+ht+")"+At+".bindBuffer("+s+","+ht+".buffer.buffer);"),ht}();function O(ht){var St=P[ht];return St?St.contextDep&&vt.contextDynamic||St.propDep?St.append(X,W):St.append(X,D):D.def(I,".",ht)}var ut,xt,G=O(ni),U=O(zi),lt=function(){var ht,St=P.count,_t=D;return St?((St.contextDep&&vt.contextDynamic||St.propDep)&&(_t=W),ht=St.append(X,_t),at.optional(function(){St.MISSING&&X.assert(D,"false","missing vertex count"),St.DYNAMIC&&X.assert(_t,ht+">=0","missing vertex count")})):(ht=_t.def(I,".",jo),at.optional(function(){X.assert(_t,ht+">=0","missing vertex count")})),ht}();if(typeof lt=="number"){if(lt===0)return}else W("if(",lt,"){"),W.exit("}");i&&(ut=O(fa),xt=X.instancing);var it=C+".type",ft=P.elements&&wr(P.elements);function Rt(){function ht(){W(xt,".drawElementsInstancedANGLE(",[G,lt,it,U+"<<(("+it+"-"+Qa+")>>1)",ut],");")}function St(){W(xt,".drawArraysInstancedANGLE(",[G,U,lt,ut],");")}C?ft?ht():(W("if(",C,"){"),ht(),W("}else{"),St(),W("}")):St()}function Gt(){function ht(){W(At+".drawElements("+[G,lt,it,U+"<<(("+it+"-"+Qa+")>>1)"]+");")}function St(){W(At+".drawArrays("+[G,U,lt]+");")}C?ft?ht():(W("if(",C,"){"),ht(),W("}else{"),St(),W("}")):St()}i&&(typeof ut!="number"||ut>=0)?typeof ut=="string"?(W("if(",ut,">0){"),Rt(),W("}else if(",ut,"<0){"),Gt(),W("}")):Rt():Gt()}function Ct(X,D,W,vt,yt){var At=K(),I=At.proc("body",yt);return at.optional(function(){At.commandStr=D.commandStr,At.command=At.link(D.commandStr)}),i&&(At.instancing=I.def(At.shared.extensions,".angle_instanced_arrays")),X(At,I,W,vt),At.compile().body}function V(X,D,W,vt){Kt(X,D),W.useVAO?W.drawVAO?D(X.shared.vao,".setVAO(",W.drawVAO.append(X,D),");"):D(X.shared.vao,".setVAO(",X.shared.vao,".targetVAO);"):(D(X.shared.vao,".setVAO(null);"),Nt(X,D,W,vt.attributes,function(){return!0})),Pt(X,D,W,vt.uniforms,function(){return!0}),Ht(X,D,D,W)}function st(X,D,W,vt){function yt(){return!0}X.batchId="a1",Kt(X,D),Nt(X,D,W,vt.attributes,yt),Pt(X,D,W,vt.uniforms,yt),Ht(X,D,D,W)}function It(X,D,W,vt){Kt(X,D);var yt=W.contextDep,At=D.def(),I=D.def();X.shared.props=I,X.batchId=At;var P=X.scope(),C=X.scope();function O(it){return it.contextDep&&yt||it.propDep}function ut(it){return!O(it)}if(D(P.entry,"for(",At,"=0;",At,"<","a1",";++",At,"){",I,"=","a0","[",At,"];",C,"}",P.exit),W.needsContext&&dt(X,C,W.context),W.needsFramebuffer&&ot(X,C,W.framebuffer),ne(X,C,W.state,O),W.profile&&O(W.profile)&&qt(X,C,W,!1,!0),vt)W.useVAO?W.drawVAO?O(W.drawVAO)?C(X.shared.vao,".setVAO(",W.drawVAO.append(X,C),");"):P(X.shared.vao,".setVAO(",W.drawVAO.append(X,P),");"):P(X.shared.vao,".setVAO(",X.shared.vao,".targetVAO);"):(P(X.shared.vao,".setVAO(null);"),Nt(X,P,W,vt.attributes,ut),Nt(X,C,W,vt.attributes,O)),Pt(X,P,W,vt.uniforms,ut),Pt(X,C,W,vt.uniforms,O),Ht(X,P,C,W);else{var xt=X.global.def("{}"),G=W.shader.progVar.append(X,C),U=C.def(G,".id"),lt=C.def(xt,"[",U,"]");C(X.shared.gl,".useProgram(",G,".program);","if(!",lt,"){",lt,"=",xt,"[",U,"]=",X.link(function(it){return Ct(st,X,W,it,2)}),"(",G,");}",lt,".call(this,a0[",At,"],",At,");")}}function mt(X,D,W){var vt=D.static[W];if(vt&&function(ut){if(typeof ut=="object"&&!An(ut)){for(var xt=Object.keys(ut),G=0;G<xt.length;++G)if(Me.isDynamic(ut[xt[G]]))return!0;return!1}}(vt)){var yt=X.global,At=Object.keys(vt),I=!1,P=!1,C=!1,O=X.global.def("{}");At.forEach(function(ut){var xt=vt[ut];if(Me.isDynamic(xt)){typeof xt=="function"&&(xt=vt[ut]=Me.unbox(xt));var G=tr(xt,null);I=I||G.thisDep,C=C||G.propDep,P=P||G.contextDep}else{switch(yt(O,".",ut,"="),typeof xt){case"number":yt(xt);break;case"string":yt('"',xt,'"');break;case"object":Array.isArray(xt)&&yt("[",xt.join(),"]");break;default:yt(X.link(xt))}yt(";")}}),D.dynamic[W]=new Me.DynamicVariable(ti,{thisDep:I,contextDep:P,propDep:C,ref:O,append:function(ut,xt){At.forEach(function(G){var U=vt[G];if(Me.isDynamic(U)){var lt=ut.invoke(xt,U);xt(O,".",G,"=",lt,";")}})}}),delete D.static[W]}}return{next:u,current:n,procs:function(){var X=K(),D=X.proc("poll"),W=X.proc("refresh"),vt=X.block();D(vt),W(vt);var yt,At=X.shared,I=At.gl,P=At.next,C=At.current;vt(C,".dirty=false;"),ot(X,D),ot(X,W,null,!0),i&&(yt=X.link(i)),ee.oes_vertex_array_object&&W(X.link(ee.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var O=0;O<Ae.maxAttributes;++O){var ut=W.def(At.attributes,"[",O,"]"),xt=X.cond(ut,".buffer");xt.then(I,".enableVertexAttribArray(",O,");",I,".bindBuffer(",r,",",ut,".buffer.buffer);",I,".vertexAttribPointer(",O,",",ut,".size,",ut,".type,",ut,".normalized,",ut,".stride,",ut,".offset);").else(I,".disableVertexAttribArray(",O,");",I,".vertexAttrib4f(",O,",",ut,".x,",ut,".y,",ut,".z,",ut,".w);",ut,".buffer=null;"),W(xt),i&&W(yt,".vertexAttribDivisorANGLE(",O,",",ut,".divisor);")}return W(X.shared.vao,".currentVAO=null;",X.shared.vao,".setVAO(",X.shared.vao,".targetVAO);"),Object.keys(x).forEach(function(G){var U=x[G],lt=vt.def(P,".",G),it=X.block();it("if(",lt,"){",I,".enable(",U,")}else{",I,".disable(",U,")}",C,".",G,"=",lt,";"),W(it),D("if(",lt,"!==",C,".",G,"){",it,"}")}),Object.keys(M).forEach(function(G){var U,lt,it=M[G],ft=n[G],Rt=X.block();if(Rt(I,".",it,"("),An(ft)){var Gt=ft.length;U=X.global.def(P,".",G),lt=X.global.def(C,".",G),Rt(Sr(Gt,function(ht){return U+"["+ht+"]"}),");",Sr(Gt,function(ht){return lt+"["+ht+"]="+U+"["+ht+"];"}).join("")),D("if(",Sr(Gt,function(ht){return U+"["+ht+"]!=="+lt+"["+ht+"]"}).join("||"),"){",Rt,"}")}else U=vt.def(P,".",G),lt=vt.def(C,".",G),Rt(U,");",C,".",G,"=",U,";"),D("if(",U,"!==",lt,"){",Rt,"}");W(Rt)}),X.compile()}(),compile:function(X,D,W,vt,yt){var At=K();At.stats=At.link(yt),Object.keys(D.static).forEach(function(P){mt(At,D,P)}),t.forEach(function(P){mt(At,X,P)});var I=j(X,D,W,vt,At);return function(P,C){var O=P.proc("draw",1);Kt(P,O),dt(P,O,C.context),ot(P,O,C.framebuffer),pt(P,O,C),ne(P,O,C.state),qt(P,O,C,!1,!0);var ut=C.shader.progVar.append(P,O);if(O(P.shared.gl,".useProgram(",ut,".program);"),C.shader.program)V(P,O,C,C.shader.program);else{O(P.shared.vao,".setVAO(null);");var xt=P.global.def("{}"),G=O.def(ut,".id"),U=O.def(xt,"[",G,"]");O(P.cond(U).then(U,".call(this,a0);").else(U,"=",xt,"[",G,"]=",P.link(function(lt){return Ct(V,P,C,lt,1)}),"(",ut,");",U,".call(this,a0);"))}Object.keys(C.state).length>0&&O(P.shared.current,".dirty=true;")}(At,I),function(P,C){var O=P.proc("scope",3);P.batchId="a2";var ut=P.shared,xt=ut.current;function G(U){var lt=C.shader[U];lt&&O.set(ut.shader,"."+U,lt.append(P,O))}dt(P,O,C.context),C.framebuffer&&C.framebuffer.append(P,O),Fn(Object.keys(C.state)).forEach(function(U){var lt=C.state[U].append(P,O);An(lt)?lt.forEach(function(it,ft){O.set(P.next[U],"["+ft+"]",it)}):O.set(ut.next,"."+U,lt)}),qt(P,O,C,!0,!0),[ri,zi,jo,fa,ni].forEach(function(U){var lt=C.draw[U];lt&&O.set(ut.draw,"."+U,""+lt.append(P,O))}),Object.keys(C.uniforms).forEach(function(U){var lt=C.uniforms[U].append(P,O);Array.isArray(lt)&&(lt="["+lt.join()+"]"),O.set(ut.uniforms,"["+Tt.id(U)+"]",lt)}),Object.keys(C.attributes).forEach(function(U){var lt=C.attributes[U].append(P,O),it=P.scopeAttrib(U);Object.keys(new cr).forEach(function(ft){O.set(it,"."+ft,lt[ft])})}),C.scopeVAO&&O.set(ut.vao,".targetVAO",C.scopeVAO.append(P,O)),G(la),G(wi),Object.keys(C.state).length>0&&(O(xt,".dirty=true;"),O.exit(xt,".dirty=true;")),O("a1(",P.shared.context,",a0,",P.batchId,");")}(At,I),function(P,C){var O=P.proc("batch",2);P.batchId="0",Kt(P,O);var ut=!1,xt=!0;Object.keys(C.context).forEach(function(St){ut=ut||C.context[St].propDep}),ut||(dt(P,O,C.context),xt=!1);var G=C.framebuffer,U=!1;function lt(St){return St.contextDep&&ut||St.propDep}G?(G.propDep?ut=U=!0:G.contextDep&&ut&&(U=!0),U||ot(P,O,G)):ot(P,O,null),C.state.viewport&&C.state.viewport.propDep&&(ut=!0),pt(P,O,C),ne(P,O,C.state,function(St){return!lt(St)}),C.profile&&lt(C.profile)||qt(P,O,C,!1,"a1"),C.contextDep=ut,C.needsContext=xt,C.needsFramebuffer=U;var it=C.shader.progVar;if(it.contextDep&&ut||it.propDep)It(P,O,C,null);else{var ft=it.append(P,O);if(O(P.shared.gl,".useProgram(",ft,".program);"),C.shader.program)It(P,O,C,C.shader.program);else{O(P.shared.vao,".setVAO(null);");var Rt=P.global.def("{}"),Gt=O.def(ft,".id"),ht=O.def(Rt,"[",Gt,"]");O(P.cond(ht).then(ht,".call(this,a0,a1);").else(ht,"=",Rt,"[",Gt,"]=",P.link(function(St){return Ct(It,P,C,St,2)}),"(",ft,");",ht,".call(this,a0,a1);"))}}Object.keys(C.state).length>0&&O(P.shared.current,".dirty=true;")}(At,I),a(At.compile(),{destroy:function(){I.shader.program.destroy()}})}}}var _s=function(Y,Tt){if(!Tt.ext_disjoint_timer_query)return null;var ee=[];function Ae(nr){ee.push(nr)}var Se=[];function Re(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var _e=[];function He(nr){_e.push(nr)}var Ve=[];function Pe(nr,or,gr){var cr=_e.pop()||new Re;cr.startQueryIndex=nr,cr.endQueryIndex=or,cr.sum=0,cr.stats=gr,Ve.push(cr)}var Oe=[],We=[];return{beginQuery:function(nr){var or=ee.pop()||Tt.ext_disjoint_timer_query.createQueryEXT();Tt.ext_disjoint_timer_query.beginQueryEXT(35007,or),Se.push(or),Pe(Se.length-1,Se.length,nr)},endQuery:function(){Tt.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:Pe,update:function(){var nr,or,gr=Se.length;if(gr!==0){We.length=Math.max(We.length,gr+1),Oe.length=Math.max(Oe.length,gr+1),Oe[0]=0,We[0]=0;var cr=0;for(nr=0,or=0;or<Se.length;++or){var c=Se[or];Tt.ext_disjoint_timer_query.getQueryObjectEXT(c,34919)?(cr+=Tt.ext_disjoint_timer_query.getQueryObjectEXT(c,34918),Ae(c)):Se[nr++]=c,Oe[or+1]=cr,We[or+1]=nr}for(Se.length=nr,nr=0,or=0;or<Ve.length;++or){var i=Ve[or],e=i.startQueryIndex,n=i.endQueryIndex;i.sum+=Oe[n]-Oe[e];var u=We[e],g=We[n];g===u?(i.stats.gpuTime+=i.sum/1e6,He(i)):(i.startQueryIndex=u,i.endQueryIndex=g,Ve[nr++]=i)}Ve.length=nr}},getNumPendingQueries:function(){return Se.length},clear:function(){ee.push.apply(ee,Se);for(var nr=0;nr<ee.length;nr++)Tt.ext_disjoint_timer_query.deleteQueryEXT(ee[nr]);Se.length=0,ee.length=0},restore:function(){Se.length=0,ee.length=0}}},Ga="webglcontextlost",as="webglcontextrestored";function ss(Y,Tt){for(var ee=0;ee<Y.length;++ee)if(Y[ee]===Tt)return ee;return-1}return function(Y){var Tt=Or(Y);if(!Tt)return null;var ee=Tt.gl,Ae=ee.getContextAttributes(),Se=ee.isContextLost(),Re=function(D,W){var vt={};function yt(P){at.type(P,"string","extension name must be string");var C,O=P.toLowerCase();try{C=vt[O]=D.getExtension(O)}catch{}return!!C}for(var At=0;At<W.extensions.length;++At){var I=W.extensions[At];if(!yt(I))return W.onDestroy(),W.onDone('"'+I+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return W.optionalExtensions.forEach(yt),{extensions:vt,restore:function(){Object.keys(vt).forEach(function(P){if(vt[P]&&!yt(P))throw new Error("(regl): error restoring extension "+P)})}}}(ee,Tt);if(!Re)return null;var _e,He,Ve=(_e={"":0},He=[""],{id:function(D){var W=_e[D];return W||(W=_e[D]=He.length,He.push(D),W)},str:function(D){return He[D]}}),Pe={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},Oe=Re.extensions,We=_s(0,Oe),nr=mr(),or=ee.drawingBufferWidth,gr=ee.drawingBufferHeight,cr={tick:0,time:0,viewportWidth:or,viewportHeight:gr,framebufferWidth:or,framebufferHeight:gr,drawingBufferWidth:or,drawingBufferHeight:gr,pixelRatio:Tt.pixelRatio},c=function(D,W){var vt=1;W.ext_texture_filter_anisotropic&&(vt=D.getParameter(34047));var yt=1,At=1;W.webgl_draw_buffers&&(yt=D.getParameter(34852),At=D.getParameter(36063));var I=!!W.oes_texture_float;if(I){var P=D.createTexture();D.bindTexture(uo,P),D.texImage2D(uo,0,Vn,1,1,0,Vn,Vo,null);var C=D.createFramebuffer();if(D.bindFramebuffer(In,C),D.framebufferTexture2D(In,36064,uo,P,0),D.bindTexture(uo,null),D.checkFramebufferStatus(In)!==36053)I=!1;else{D.viewport(0,0,1,1),D.clearColor(1,0,0,1),D.clear(16384);var O=Fr.allocType(Vo,4);D.readPixels(0,0,1,1,Vn,Vo,O),D.getError()?I=!1:(D.deleteFramebuffer(C),D.deleteTexture(P),I=O[0]===1),Fr.freeType(O)}}var ut=!0;if(typeof navigator>"u"||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var xt=D.createTexture(),G=Fr.allocType(5121,36);D.activeTexture(33984),D.bindTexture(34067,xt),D.texImage2D(34069,0,Vn,3,3,0,Vn,5121,G),Fr.freeType(G),D.bindTexture(34067,null),D.deleteTexture(xt),ut=!D.getError()}return{colorBits:[D.getParameter(3410),D.getParameter(3411),D.getParameter(3412),D.getParameter(3413)],depthBits:D.getParameter(3414),stencilBits:D.getParameter(3415),subpixelBits:D.getParameter(3408),extensions:Object.keys(W).filter(function(U){return!!W[U]}),maxAnisotropic:vt,maxDrawbuffers:yt,maxColorAttachments:At,pointSizeDims:D.getParameter(33901),lineWidthDims:D.getParameter(33902),maxViewportDims:D.getParameter(3386),maxCombinedTextureUnits:D.getParameter(35661),maxCubeMapSize:D.getParameter(34076),maxRenderbufferSize:D.getParameter(34024),maxTextureUnits:D.getParameter(34930),maxTextureSize:D.getParameter(3379),maxAttributes:D.getParameter(34921),maxVertexUniforms:D.getParameter(36347),maxVertexTextureUnits:D.getParameter(35660),maxVaryingVectors:D.getParameter(36348),maxFragmentUniforms:D.getParameter(36349),glsl:D.getParameter(35724),renderer:D.getParameter(7937),vendor:D.getParameter(7936),version:D.getParameter(7938),readFloat:I,npotTextureCube:ut}}(ee,Oe),i=function(D,W,vt,yt){var At=0,I={};function P(G){this.id=At++,this.buffer=D.createBuffer(),this.type=G,this.usage=cs,this.byteLength=0,this.dimension=1,this.dtype=di,this.persistentData=null,vt.profile&&(this.stats={size:0})}P.prototype.bind=function(){D.bindBuffer(this.type,this.buffer)},P.prototype.destroy=function(){xt(this)};var C=[];function O(G,U,lt){G.byteLength=U.byteLength,D.bufferData(G.type,U,lt)}function ut(G,U,lt,it,ft,Rt){var Gt,ht;if(G.usage=lt,Array.isArray(U)){if(G.dtype=it||xa,U.length>0)if(Array.isArray(U[0])){Gt=Eo(U);for(var St=1,_t=1;_t<Gt.length;++_t)St*=Gt[_t];G.dimension=St,O(G,ht=Pn(U,Gt,G.dtype),lt),Rt?G.persistentData=ht:Fr.freeType(ht)}else if(typeof U[0]=="number"){G.dimension=ft;var ae=Fr.allocType(G.dtype,U.length);Mi(ae,U),O(G,ae,lt),Rt?G.persistentData=ae:Fr.freeType(ae)}else h(U[0])?(G.dimension=U[0].length,G.dtype=it||ba(U[0])||xa,O(G,ht=Pn(U,[U.length,U[0].length],G.dtype),lt),Rt?G.persistentData=ht:Fr.freeType(ht)):at.raise("invalid buffer data")}else if(h(U))G.dtype=it||ba(U),G.dimension=ft,O(G,U,lt),Rt&&(G.persistentData=new Uint8Array(new Uint8Array(U.buffer)));else if(Mn(U)){Gt=U.shape;var jt=U.stride,Ft=U.offset,se=0,Vt=0,J=0,Et=0;Gt.length===1?(se=Gt[0],Vt=1,J=jt[0],Et=0):Gt.length===2?(se=Gt[0],Vt=Gt[1],J=jt[0],Et=jt[1]):at.raise("invalid shape"),G.dtype=it||ba(U.data)||xa,G.dimension=Vt;var kt=Fr.allocType(G.dtype,se*Vt);Lo(kt,U.data,se,Vt,J,Et,Ft),O(G,kt,lt),Rt?G.persistentData=kt:Fr.freeType(kt)}else U instanceof ArrayBuffer?(G.dtype=di,G.dimension=ft,O(G,U,lt),Rt&&(G.persistentData=new Uint8Array(new Uint8Array(U)))):at.raise("invalid buffer data")}function xt(G){W.bufferCount--,yt(G);var U=G.buffer;at(U,"buffer must not be deleted already"),D.deleteBuffer(U),G.buffer=null,delete I[G.id]}return vt.profile&&(W.getTotalBufferSize=function(){var G=0;return Object.keys(I).forEach(function(U){G+=I[U].stats.size}),G}),{create:function(G,U,lt,it){W.bufferCount++;var ft=new P(U);function Rt(ht){var St=cs,_t=null,ae=0,jt=0,Ft=1;return Array.isArray(ht)||h(ht)||Mn(ht)||ht instanceof ArrayBuffer?_t=ht:typeof ht=="number"?ae=0|ht:ht&&(at.type(ht,"object","buffer arguments must be an object, a number or an array"),"data"in ht&&(at(_t===null||Array.isArray(_t)||h(_t)||Mn(_t),"invalid data for buffer"),_t=ht.data),"usage"in ht&&(at.parameter(ht.usage,Ln,"invalid buffer usage"),St=Ln[ht.usage]),"type"in ht&&(at.parameter(ht.type,qo,"invalid buffer type"),jt=qo[ht.type]),"dimension"in ht&&(at.type(ht.dimension,"number","invalid dimension"),Ft=0|ht.dimension),"length"in ht&&(at.nni(ae,"buffer length must be a nonnegative integer"),ae=0|ht.length)),ft.bind(),_t?ut(ft,_t,St,jt,Ft,it):(ae&&D.bufferData(ft.type,ae,St),ft.dtype=jt||di,ft.usage=St,ft.dimension=Ft,ft.byteLength=ae),vt.profile&&(ft.stats.size=ft.byteLength*Co[ft.dtype]),Rt}function Gt(ht,St){at(St+ht.byteLength<=ft.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+ht.byteLength+" starting from offset "+St+" to a buffer of size "+ft.byteLength),D.bufferSubData(ft.type,St,ht)}return I[ft.id]=ft,lt||Rt(G),Rt._reglType="buffer",Rt._buffer=ft,Rt.subdata=function(ht,St){var _t,ae=0|(St||0);if(ft.bind(),h(ht)||ht instanceof ArrayBuffer)Gt(ht,ae);else if(Array.isArray(ht)){if(ht.length>0)if(typeof ht[0]=="number"){var jt=Fr.allocType(ft.dtype,ht.length);Mi(jt,ht),Gt(jt,ae),Fr.freeType(jt)}else if(Array.isArray(ht[0])||h(ht[0])){_t=Eo(ht);var Ft=Pn(ht,_t,ft.dtype);Gt(Ft,ae),Fr.freeType(Ft)}else at.raise("invalid buffer data")}else if(Mn(ht)){_t=ht.shape;var se=ht.stride,Vt=0,J=0,Et=0,kt=0;_t.length===1?(Vt=_t[0],J=1,Et=se[0],kt=0):_t.length===2?(Vt=_t[0],J=_t[1],Et=se[0],kt=se[1]):at.raise("invalid shape");var oe=Array.isArray(ht.data)?ft.dtype:ba(ht.data),Ee=Fr.allocType(oe,Vt*J);Lo(Ee,ht.data,Vt,J,Et,kt,ht.offset),Gt(Ee,ae),Fr.freeType(Ee)}else at.raise("invalid data for buffer subdata");return Rt},vt.profile&&(Rt.stats=ft.stats),Rt.destroy=function(){xt(ft)},Rt},createStream:function(G,U){var lt=C.pop();return lt||(lt=new P(G)),lt.bind(),ut(lt,U,hs,0,1,!1),lt},destroyStream:function(G){C.push(G)},clear:function(){Dr(I).forEach(xt),C.forEach(xt)},getBuffer:function(G){return G&&G._buffer instanceof P?G._buffer:null},restore:function(){Dr(I).forEach(function(G){G.buffer=D.createBuffer(),D.bindBuffer(G.type,G.buffer),D.bufferData(G.type,G.persistentData||G.byteLength,G.usage)})},_initBuffer:ut}}(ee,Pe,Tt,function(D){return e.destroyBuffer(D)}),e=function(D,W,vt,yt,At){for(var I=vt.maxAttributes,P=new Array(I),C=0;C<I;++C)P[C]=new Oi;var O=0,ut={},xt={Record:Oi,scope:{},state:P,currentVAO:null,targetVAO:null,restore:G()?function(){G()&&Dr(ut).forEach(function(it){it.refresh()})}:function(){},createVAO:function(it){var ft=new lt;function Rt(Gt){at(Array.isArray(Gt),"arguments to vertex array constructor must be an array"),at(Gt.length<I,"too many attributes"),at(Gt.length>0,"must specify at least one attribute");var ht={},St=ft.attributes;St.length=Gt.length;for(var _t=0;_t<Gt.length;++_t){var ae,jt=Gt[_t],Ft=St[_t]=new Oi,se=jt.data||jt;Array.isArray(se)||h(se)||Mn(se)?(ft.buffers[_t]&&(ae=ft.buffers[_t],h(se)&&ae._buffer.byteLength>=se.byteLength?ae.subdata(se):(ae.destroy(),ft.buffers[_t]=null)),ft.buffers[_t]||(ae=ft.buffers[_t]=At.create(jt,Da,!1,!0)),Ft.buffer=At.getBuffer(ae),Ft.size=0|Ft.buffer.dimension,Ft.normalized=!1,Ft.type=Ft.buffer.dtype,Ft.offset=0,Ft.stride=0,Ft.divisor=0,Ft.state=1,ht[_t]=1):At.getBuffer(jt)?(Ft.buffer=At.getBuffer(jt),Ft.size=0|Ft.buffer.dimension,Ft.normalized=!1,Ft.type=Ft.buffer.dtype,Ft.offset=0,Ft.stride=0,Ft.divisor=0,Ft.state=1):At.getBuffer(jt.buffer)?(Ft.buffer=At.getBuffer(jt.buffer),Ft.size=0|(+jt.size||Ft.buffer.dimension),Ft.normalized=!!jt.normalized||!1,"type"in jt?(at.parameter(jt.type,qo,"invalid buffer type"),Ft.type=qo[jt.type]):Ft.type=Ft.buffer.dtype,Ft.offset=0|(jt.offset||0),Ft.stride=0|(jt.stride||0),Ft.divisor=0|(jt.divisor||0),Ft.state=1,at(Ft.size>=1&&Ft.size<=4,"size must be between 1 and 4"),at(Ft.offset>=0,"invalid offset"),at(Ft.stride>=0&&Ft.stride<=255,"stride must be between 0 and 255"),at(Ft.divisor>=0,"divisor must be positive"),at(!Ft.divisor||!!W.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in jt?(at(_t>0,"first attribute must not be a constant"),Ft.x=+jt.x||0,Ft.y=+jt.y||0,Ft.z=+jt.z||0,Ft.w=+jt.w||0,Ft.state=2):at(!1,"invalid attribute spec for location "+_t)}for(var Vt=0;Vt<ft.buffers.length;++Vt)!ht[Vt]&&ft.buffers[Vt]&&(ft.buffers[Vt].destroy(),ft.buffers[Vt]=null);return ft.refresh(),Rt}return yt.vaoCount+=1,Rt.destroy=function(){for(var Gt=0;Gt<ft.buffers.length;++Gt)ft.buffers[Gt]&&ft.buffers[Gt].destroy();ft.buffers.length=0,ft.destroy()},Rt._vao=ft,Rt._reglType="vao",Rt(it)},getVAO:function(it){return typeof it=="function"&&it._vao?it._vao:null},destroyBuffer:function(it){for(var ft=0;ft<P.length;++ft){var Rt=P[ft];Rt.buffer===it&&(D.disableVertexAttribArray(ft),Rt.buffer=null)}},setVAO:G()?function(it){if(it!==xt.currentVAO){var ft=G();it?ft.bindVertexArrayOES(it.vao):ft.bindVertexArrayOES(null),xt.currentVAO=it}}:function(it){if(it!==xt.currentVAO){if(it)it.bindAttrs();else for(var ft=U(),Rt=0;Rt<P.length;++Rt){var Gt=P[Rt];Gt.buffer?(D.enableVertexAttribArray(Rt),D.vertexAttribPointer(Rt,Gt.size,Gt.type,Gt.normalized,Gt.stride,Gt.offfset),ft&&Gt.divisor&&ft.vertexAttribDivisorANGLE(Rt,Gt.divisor)):(D.disableVertexAttribArray(Rt),D.vertexAttrib4f(Rt,Gt.x,Gt.y,Gt.z,Gt.w))}xt.currentVAO=it}},clear:G()?function(){Dr(ut).forEach(function(it){it.destroy()})}:function(){}};function G(){return W.oes_vertex_array_object}function U(){return W.angle_instanced_arrays}function lt(){this.id=++O,this.attributes=[];var it=G();this.vao=it?it.createVertexArrayOES():null,ut[this.id]=this,this.buffers=[]}return lt.prototype.bindAttrs=function(){for(var it=U(),ft=this.attributes,Rt=0;Rt<ft.length;++Rt){var Gt=ft[Rt];Gt.buffer?(D.enableVertexAttribArray(Rt),D.bindBuffer(Da,Gt.buffer.buffer),D.vertexAttribPointer(Rt,Gt.size,Gt.type,Gt.normalized,Gt.stride,Gt.offset),it&&Gt.divisor&&it.vertexAttribDivisorANGLE(Rt,Gt.divisor)):(D.disableVertexAttribArray(Rt),D.vertexAttrib4f(Rt,Gt.x,Gt.y,Gt.z,Gt.w))}for(var ht=ft.length;ht<I;++ht)D.disableVertexAttribArray(ht)},lt.prototype.refresh=function(){var it=G();it&&(it.bindVertexArrayOES(this.vao),this.bindAttrs(),xt.currentVAO=this)},lt.prototype.destroy=function(){if(this.vao){var it=G();this===xt.currentVAO&&(xt.currentVAO=null,it.bindVertexArrayOES(null)),it.deleteVertexArrayOES(this.vao),this.vao=null}ut[this.id]&&(delete ut[this.id],yt.vaoCount-=1)},xt}(ee,Oe,c,Pe,i),n=function(D,W,vt,yt){var At={},I=0,P={uint8:ho,uint16:bo};function C(G){this.id=I++,At[this.id]=this,this.buffer=G,this.primType=Ai,this.vertCount=0,this.type=0}W.oes_element_index_uint&&(P.uint32=Wo),C.prototype.bind=function(){this.buffer.bind()};var O=[];function ut(G,U,lt,it,ft,Rt,Gt){var ht;if(G.buffer.bind(),U){var St=Gt;Gt||h(U)&&(!Mn(U)||h(U.data))||(St=W.oes_element_index_uint?Wo:bo),vt._initBuffer(G.buffer,U,lt,St,3)}else D.bufferData(Wa,Rt,lt),G.buffer.dtype=ht||ho,G.buffer.usage=lt,G.buffer.dimension=3,G.buffer.byteLength=Rt;if(ht=Gt,!Gt){switch(G.buffer.dtype){case ho:case Si:ht=ho;break;case bo:case _i:ht=bo;break;case Wo:case qa:ht=Wo;break;default:at.raise("unsupported type for element array")}G.buffer.dtype=ht}G.type=ht,at(ht!==Wo||!!W.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var _t=ft;_t<0&&(_t=G.buffer.byteLength,ht===bo?_t>>=1:ht===Wo&&(_t>>=2)),G.vertCount=_t;var ae=it;if(it<0){ae=Ai;var jt=G.buffer.dimension;jt===1&&(ae=Do),jt===2&&(ae=$i),jt===3&&(ae=Ai)}G.primType=ae}function xt(G){yt.elementsCount--,at(G.buffer!==null,"must not double destroy elements"),delete At[G.id],G.buffer.destroy(),G.buffer=null}return{create:function(G,U){var lt=vt.create(null,Wa,!0),it=new C(lt._buffer);function ft(Rt){if(Rt)if(typeof Rt=="number")lt(Rt),it.primType=Ai,it.vertCount=0|Rt,it.type=ho;else{var Gt=null,ht=ls,St=-1,_t=-1,ae=0,jt=0;Array.isArray(Rt)||h(Rt)||Mn(Rt)?Gt=Rt:(at.type(Rt,"object","invalid arguments for elements"),"data"in Rt&&(Gt=Rt.data,at(Array.isArray(Gt)||h(Gt)||Mn(Gt),"invalid data for element buffer")),"usage"in Rt&&(at.parameter(Rt.usage,Ln,"invalid element buffer usage"),ht=Ln[Rt.usage]),"primitive"in Rt&&(at.parameter(Rt.primitive,xo,"invalid element buffer primitive"),St=xo[Rt.primitive]),"count"in Rt&&(at(typeof Rt.count=="number"&&Rt.count>=0,"invalid vertex count for elements"),_t=0|Rt.count),"type"in Rt&&(at.parameter(Rt.type,P,"invalid buffer type"),jt=P[Rt.type]),"length"in Rt?ae=0|Rt.length:(ae=_t,jt===bo||jt===_i?ae*=2:jt!==Wo&&jt!==qa||(ae*=4))),ut(it,Gt,ht,St,_t,ae,jt)}else lt(),it.primType=Ai,it.vertCount=0,it.type=ho;return ft}return yt.elementsCount++,ft(G),ft._reglType="elements",ft._elements=it,ft.subdata=function(Rt,Gt){return lt.subdata(Rt,Gt),ft},ft.destroy=function(){xt(it)},ft},createStream:function(G){var U=O.pop();return U||(U=new C(vt.create(null,Wa,!0,!1)._buffer)),ut(U,G,$a,-1,-1,0,0),U},destroyStream:function(G){O.push(G)},getElements:function(G){return typeof G=="function"&&G._elements instanceof C?G._elements:null},clear:function(){Dr(At).forEach(xt)}}}(ee,Oe,i,Pe),u=function(D,W,vt,yt){var At={},I={};function P(it,ft,Rt,Gt){this.name=it,this.id=ft,this.location=Rt,this.info=Gt}function C(it,ft){for(var Rt=0;Rt<it.length;++Rt)if(it[Rt].id===ft.id)return void(it[Rt].location=ft.location);it.push(ft)}function O(it,ft,Rt){var Gt=it===ta?At:I,ht=Gt[ft];if(!ht){var St=W.str(ft);ht=D.createShader(it),D.shaderSource(ht,St),D.compileShader(ht),at.shaderError(D,ht,St,it,Rt),Gt[ft]=ht}return ht}var ut={},xt=[],G=0;function U(it,ft){this.id=G++,this.fragId=it,this.vertId=ft,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,yt.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function lt(it,ft,Rt){var Gt,ht,St=O(ta,it.fragId),_t=O(Ps,it.vertId),ae=it.program=D.createProgram();if(D.attachShader(ae,St),D.attachShader(ae,_t),Rt)for(Gt=0;Gt<Rt.length;++Gt){var jt=Rt[Gt];D.bindAttribLocation(ae,jt[0],jt[1])}D.linkProgram(ae),at.linkError(D,ae,W.str(it.fragId),W.str(it.vertId),ft);var Ft=D.getProgramParameter(ae,xs);yt.profile&&(it.stats.uniformsCount=Ft);var se=it.uniforms;for(Gt=0;Gt<Ft;++Gt)if(ht=D.getActiveUniform(ae,Gt))if(ht.size>1)for(var Vt=0;Vt<ht.size;++Vt){var J=ht.name.replace("[0]","["+Vt+"]");C(se,new P(J,W.id(J),D.getUniformLocation(ae,J),ht))}else C(se,new P(ht.name,W.id(ht.name),D.getUniformLocation(ae,ht.name),ht));var Et=D.getProgramParameter(ae,Ta);yt.profile&&(it.stats.attributesCount=Et);var kt=it.attributes;for(Gt=0;Gt<Et;++Gt)(ht=D.getActiveAttrib(ae,Gt))&&C(kt,new P(ht.name,W.id(ht.name),D.getAttribLocation(ae,ht.name),ht))}return yt.profile&&(vt.getMaxUniformsCount=function(){var it=0;return xt.forEach(function(ft){ft.stats.uniformsCount>it&&(it=ft.stats.uniformsCount)}),it},vt.getMaxAttributesCount=function(){var it=0;return xt.forEach(function(ft){ft.stats.attributesCount>it&&(it=ft.stats.attributesCount)}),it}),{clear:function(){var it=D.deleteShader.bind(D);Dr(At).forEach(it),At={},Dr(I).forEach(it),I={},xt.forEach(function(ft){D.deleteProgram(ft.program)}),xt.length=0,ut={},vt.shaderCount=0},program:function(it,ft,Rt,Gt){at.command(it>=0,"missing vertex shader",Rt),at.command(ft>=0,"missing fragment shader",Rt);var ht=ut[ft];ht||(ht=ut[ft]={});var St=ht[it];if(St&&(St.refCount++,!Gt))return St;var _t=new U(ft,it);return vt.shaderCount++,lt(_t,Rt,Gt),St||(ht[it]=_t),xt.push(_t),a(_t,{destroy:function(){if(_t.refCount--,_t.refCount<=0){D.deleteProgram(_t.program);var ae=xt.indexOf(_t);xt.splice(ae,1),vt.shaderCount--}ht[_t.vertId].refCount<=0&&(D.deleteShader(I[_t.vertId]),delete I[_t.vertId],delete ut[_t.fragId][_t.vertId]),Object.keys(ut[_t.fragId]).length||(D.deleteShader(At[_t.fragId]),delete At[_t.fragId],delete ut[_t.fragId])}})},restore:function(){At={},I={};for(var it=0;it<xt.length;++it)lt(xt[it],null,xt[it].attributes.map(function(ft){return[ft.location,ft.name]}))},shader:O,frag:-1,vert:-1}}(ee,Ve,Pe,Tt),g=fs(ee,Oe,c,function(){S.procs.poll()},cr,Pe,Tt),x=function(D,W,vt,yt,At){var I={rgba4:Zi,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};W.ext_srgb&&(I.srgba=35907),W.ext_color_buffer_half_float&&(I.rgba16f=34842,I.rgb16f=34843),W.webgl_color_buffer_float&&(I.rgba32f=34836);var P=[];Object.keys(I).forEach(function(G){var U=I[G];P[U]=G});var C=0,O={};function ut(G){this.id=C++,this.refCount=1,this.renderbuffer=G,this.format=Zi,this.width=0,this.height=0,At.profile&&(this.stats={size:0})}function xt(G){var U=G.renderbuffer;at(U,"must not double destroy renderbuffer"),D.bindRenderbuffer(Yo,null),D.deleteRenderbuffer(U),G.renderbuffer=null,G.refCount=0,delete O[G.id],yt.renderbufferCount--}return ut.prototype.decRef=function(){--this.refCount<=0&&xt(this)},At.profile&&(yt.getTotalRenderbufferSize=function(){var G=0;return Object.keys(O).forEach(function(U){G+=O[U].stats.size}),G}),{create:function(G,U){var lt=new ut(D.createRenderbuffer());function it(ft,Rt){var Gt=0,ht=0,St=Zi;if(typeof ft=="object"&&ft){var _t=ft;if("shape"in _t){var ae=_t.shape;at(Array.isArray(ae)&&ae.length>=2,"invalid renderbuffer shape"),Gt=0|ae[0],ht=0|ae[1]}else"radius"in _t&&(Gt=ht=0|_t.radius),"width"in _t&&(Gt=0|_t.width),"height"in _t&&(ht=0|_t.height);"format"in _t&&(at.parameter(_t.format,I,"invalid renderbuffer format"),St=I[_t.format])}else typeof ft=="number"?(Gt=0|ft,ht=typeof Rt=="number"?0|Rt:Gt):ft?at.raise("invalid arguments to renderbuffer constructor"):Gt=ht=1;if(at(Gt>0&&ht>0&&Gt<=vt.maxRenderbufferSize&&ht<=vt.maxRenderbufferSize,"invalid renderbuffer size"),Gt!==lt.width||ht!==lt.height||St!==lt.format)return it.width=lt.width=Gt,it.height=lt.height=ht,lt.format=St,D.bindRenderbuffer(Yo,lt.renderbuffer),D.renderbufferStorage(Yo,St,Gt,ht),at(D.getError()===0,"invalid render buffer format"),At.profile&&(lt.stats.size=Ya(lt.format,lt.width,lt.height)),it.format=P[lt.format],it}return O[lt.id]=lt,yt.renderbufferCount++,it(G,U),it.resize=function(ft,Rt){var Gt=0|ft,ht=0|Rt||Gt;return Gt===lt.width&&ht===lt.height||(at(Gt>0&&ht>0&&Gt<=vt.maxRenderbufferSize&&ht<=vt.maxRenderbufferSize,"invalid renderbuffer size"),it.width=lt.width=Gt,it.height=lt.height=ht,D.bindRenderbuffer(Yo,lt.renderbuffer),D.renderbufferStorage(Yo,lt.format,Gt,ht),at(D.getError()===0,"invalid render buffer format"),At.profile&&(lt.stats.size=Ya(lt.format,lt.width,lt.height))),it},it._reglType="renderbuffer",it._renderbuffer=lt,At.profile&&(it.stats=lt.stats),it.destroy=function(){lt.decRef()},it},clear:function(){Dr(O).forEach(xt)},restore:function(){Dr(O).forEach(function(G){G.renderbuffer=D.createRenderbuffer(),D.bindRenderbuffer(Yo,G.renderbuffer),D.renderbufferStorage(Yo,G.format,G.width,G.height)}),D.bindRenderbuffer(Yo,null)}}}(ee,Oe,c,Pe,Tt),M=function(D,W,vt,yt,At,I){var P={cur:null,next:null,dirty:!1,setFBO:null},C=["rgba"],O=["rgba4","rgb565","rgb5 a1"];W.ext_srgb&&O.push("srgba"),W.ext_color_buffer_half_float&&O.push("rgba16f","rgb16f"),W.webgl_color_buffer_float&&O.push("rgba32f");var ut=["uint8"];function xt(Vt,J,Et){this.target=Vt,this.texture=J,this.renderbuffer=Et;var kt=0,oe=0;J?(kt=J.width,oe=J.height):Et&&(kt=Et.width,oe=Et.height),this.width=kt,this.height=oe}function G(Vt){Vt&&(Vt.texture&&Vt.texture._texture.decRef(),Vt.renderbuffer&&Vt.renderbuffer._renderbuffer.decRef())}function U(Vt,J,Et){if(Vt)if(Vt.texture){var kt=Vt.texture._texture,oe=Math.max(1,kt.width),Ee=Math.max(1,kt.height);at(oe===J&&Ee===Et,"inconsistent width/height for supplied texture"),kt.refCount+=1}else{var Ie=Vt.renderbuffer._renderbuffer;at(Ie.width===J&&Ie.height===Et,"inconsistent width/height for renderbuffer"),Ie.refCount+=1}}function lt(Vt,J){J&&(J.texture?D.framebufferTexture2D(Go,Vt,J.target,J.texture._texture.texture,0):D.framebufferRenderbuffer(Go,Vt,Ji,J.renderbuffer._renderbuffer.renderbuffer))}function it(Vt){var J=pi,Et=null,kt=null,oe=Vt;typeof Vt=="object"&&(oe=Vt.data,"target"in Vt&&(J=0|Vt.target)),at.type(oe,"function","invalid attachment data");var Ee=oe._reglType;return Ee==="texture2d"?(Et=oe,at(J===pi)):Ee==="textureCube"?(Et=oe,at(J>=ka&&J<ka+6,"invalid cube map target")):Ee==="renderbuffer"?(kt=oe,J=Ji):at.raise("invalid regl object for attachment"),new xt(J,Et,kt)}function ft(Vt,J,Et,kt,oe){if(Et){var Ee=yt.create2D({width:Vt,height:J,format:kt,type:oe});return Ee._texture.refCount=0,new xt(pi,Ee,null)}var Ie=At.create({width:Vt,height:J,format:kt});return Ie._renderbuffer.refCount=0,new xt(Ji,null,Ie)}function Rt(Vt){return Vt&&(Vt.texture||Vt.renderbuffer)}function Gt(Vt,J,Et){Vt&&(Vt.texture?Vt.texture.resize(J,Et):Vt.renderbuffer&&Vt.renderbuffer.resize(J,Et),Vt.width=J,Vt.height=Et)}W.oes_texture_half_float&&ut.push("half float","float16"),W.oes_texture_float&&ut.push("float","float32");var ht=0,St={};function _t(){this.id=ht++,St[this.id]=this,this.framebuffer=D.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function ae(Vt){Vt.colorAttachments.forEach(G),G(Vt.depthAttachment),G(Vt.stencilAttachment),G(Vt.depthStencilAttachment)}function jt(Vt){var J=Vt.framebuffer;at(J,"must not double destroy framebuffer"),D.deleteFramebuffer(J),Vt.framebuffer=null,I.framebufferCount--,delete St[Vt.id]}function Ft(Vt){var J;D.bindFramebuffer(Go,Vt.framebuffer);var Et=Vt.colorAttachments;for(J=0;J<Et.length;++J)lt(Ia+J,Et[J]);for(J=Et.length;J<vt.maxColorAttachments;++J)D.framebufferTexture2D(Go,Ia+J,pi,null,0);D.framebufferTexture2D(Go,vs,pi,null,0),D.framebufferTexture2D(Go,gs,pi,null,0),D.framebufferTexture2D(Go,ps,pi,null,0),lt(gs,Vt.depthAttachment),lt(ps,Vt.stencilAttachment),lt(vs,Vt.depthStencilAttachment);var kt=D.checkFramebufferStatus(Go);D.isContextLost()||kt===ms||at.raise("framebuffer configuration not supported, status = "+Ko[kt]),D.bindFramebuffer(Go,P.next?P.next.framebuffer:null),P.cur=P.next,D.getError()}function se(Vt,J){var Et=new _t;function kt(oe,Ee){var Ie;at(P.next!==Et,"can not update framebuffer which is currently in use");var Ue=0,hr=0,pr=!0,Mr=!0,Er=null,Ke=!0,Ur="rgba",mn="uint8",Bo=1,oi=null,Fa=null,qs=null,Ws=!1;if(typeof oe=="number")Ue=0|oe,hr=0|Ee||Ue;else if(oe){at.type(oe,"object","invalid arguments for framebuffer");var Rr=oe;if("shape"in Rr){var $s=Rr.shape;at(Array.isArray($s)&&$s.length>=2,"invalid shape for framebuffer"),Ue=$s[0],hr=$s[1]}else"radius"in Rr&&(Ue=hr=Rr.radius),"width"in Rr&&(Ue=Rr.width),"height"in Rr&&(hr=Rr.height);("color"in Rr||"colors"in Rr)&&(Er=Rr.color||Rr.colors,Array.isArray(Er)&&at(Er.length===1||W.webgl_draw_buffers,"multiple render targets not supported")),Er||("colorCount"in Rr&&(Bo=0|Rr.colorCount,at(Bo>0,"invalid color buffer count")),"colorTexture"in Rr&&(Ke=!!Rr.colorTexture,Ur="rgba4"),"colorType"in Rr&&(mn=Rr.colorType,Ke?(at(W.oes_texture_float||!(mn==="float"||mn==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),at(W.oes_texture_half_float||!(mn==="half float"||mn==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):mn==="half float"||mn==="float16"?(at(W.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Ur="rgba16f"):mn!=="float"&&mn!=="float32"||(at(W.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Ur="rgba32f"),at.oneOf(mn,ut,"invalid color type")),"colorFormat"in Rr&&(Ur=Rr.colorFormat,C.indexOf(Ur)>=0?Ke=!0:O.indexOf(Ur)>=0?Ke=!1:Ke?at.oneOf(Rr.colorFormat,C,"invalid color format for texture"):at.oneOf(Rr.colorFormat,O,"invalid color format for renderbuffer"))),("depthTexture"in Rr||"depthStencilTexture"in Rr)&&(Ws=!(!Rr.depthTexture&&!Rr.depthStencilTexture),at(!Ws||W.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Rr&&(typeof Rr.depth=="boolean"?pr=Rr.depth:(oi=Rr.depth,Mr=!1)),"stencil"in Rr&&(typeof Rr.stencil=="boolean"?Mr=Rr.stencil:(Fa=Rr.stencil,pr=!1)),"depthStencil"in Rr&&(typeof Rr.depthStencil=="boolean"?pr=Mr=Rr.depthStencil:(qs=Rr.depthStencil,pr=!1,Mr=!1))}else Ue=hr=1;var Xn=null,Fi=null,ja=null,ji=null;if(Array.isArray(Er))Xn=Er.map(it);else if(Er)Xn=[it(Er)];else for(Xn=new Array(Bo),Ie=0;Ie<Bo;++Ie)Xn[Ie]=ft(Ue,hr,Ke,Ur,mn);at(W.webgl_draw_buffers||Xn.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),at(Xn.length<=vt.maxColorAttachments,"too many color attachments, not supported"),Ue=Ue||Xn[0].width,hr=hr||Xn[0].height,oi?Fi=it(oi):pr&&!Mr&&(Fi=ft(Ue,hr,Ws,"depth","uint32")),Fa?ja=it(Fa):Mr&&!pr&&(ja=ft(Ue,hr,!1,"stencil","uint8")),qs?ji=it(qs):!oi&&!Fa&&Mr&&pr&&(ji=ft(Ue,hr,Ws,"depth stencil","depth stencil")),at(!!oi+!!Fa+!!qs<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var ou=null;for(Ie=0;Ie<Xn.length;++Ie)if(U(Xn[Ie],Ue,hr),at(!Xn[Ie]||Xn[Ie].texture&&ws.indexOf(Xn[Ie].texture._texture.format)>=0||Xn[Ie].renderbuffer&&Ja.indexOf(Xn[Ie].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Ie+" is invalid"),Xn[Ie]&&Xn[Ie].texture){var zu=Ka[Xn[Ie].texture._texture.format]*Qi[Xn[Ie].texture._texture.type];ou===null?ou=zu:at(ou===zu,"all color attachments much have the same number of bits per pixel.")}return U(Fi,Ue,hr),at(!Fi||Fi.texture&&Fi.texture._texture.format===ys||Fi.renderbuffer&&Fi.renderbuffer._renderbuffer.format===Za,"invalid depth attachment for framebuffer object"),U(ja,Ue,hr),at(!ja||ja.renderbuffer&&ja.renderbuffer._renderbuffer.format===Cs,"invalid stencil attachment for framebuffer object"),U(ji,Ue,hr),at(!ji||ji.texture&&ji.texture._texture.format===Es||ji.renderbuffer&&ji.renderbuffer._renderbuffer.format===Es,"invalid depth-stencil attachment for framebuffer object"),ae(Et),Et.width=Ue,Et.height=hr,Et.colorAttachments=Xn,Et.depthAttachment=Fi,Et.stencilAttachment=ja,Et.depthStencilAttachment=ji,kt.color=Xn.map(Rt),kt.depth=Rt(Fi),kt.stencil=Rt(ja),kt.depthStencil=Rt(ji),kt.width=Et.width,kt.height=Et.height,Ft(Et),kt}return I.framebufferCount++,kt(Vt,J),a(kt,{resize:function(oe,Ee){at(P.next!==Et,"can not resize a framebuffer which is currently in use");var Ie=Math.max(0|oe,1),Ue=Math.max(0|Ee||Ie,1);if(Ie===Et.width&&Ue===Et.height)return kt;for(var hr=Et.colorAttachments,pr=0;pr<hr.length;++pr)Gt(hr[pr],Ie,Ue);return Gt(Et.depthAttachment,Ie,Ue),Gt(Et.stencilAttachment,Ie,Ue),Gt(Et.depthStencilAttachment,Ie,Ue),Et.width=kt.width=Ie,Et.height=kt.height=Ue,Ft(Et),kt},_reglType:"framebuffer",_framebuffer:Et,destroy:function(){jt(Et),ae(Et)},use:function(oe){P.setFBO({framebuffer:kt},oe)}})}return a(P,{getFramebuffer:function(Vt){if(typeof Vt=="function"&&Vt._reglType==="framebuffer"){var J=Vt._framebuffer;if(J instanceof _t)return J}return null},create:se,createCube:function(Vt){var J=Array(6);function Et(kt){var oe;at(J.indexOf(P.next)<0,"can not update framebuffer which is currently in use");var Ee,Ie={color:null},Ue=0,hr=null,pr="rgba",Mr="uint8",Er=1;if(typeof kt=="number")Ue=0|kt;else if(kt){at.type(kt,"object","invalid arguments for framebuffer");var Ke=kt;if("shape"in Ke){var Ur=Ke.shape;at(Array.isArray(Ur)&&Ur.length>=2,"invalid shape for framebuffer"),at(Ur[0]===Ur[1],"cube framebuffer must be square"),Ue=Ur[0]}else"radius"in Ke&&(Ue=0|Ke.radius),"width"in Ke?(Ue=0|Ke.width,"height"in Ke&&at(Ke.height===Ue,"must be square")):"height"in Ke&&(Ue=0|Ke.height);("color"in Ke||"colors"in Ke)&&(hr=Ke.color||Ke.colors,Array.isArray(hr)&&at(hr.length===1||W.webgl_draw_buffers,"multiple render targets not supported")),hr||("colorCount"in Ke&&(Er=0|Ke.colorCount,at(Er>0,"invalid color buffer count")),"colorType"in Ke&&(at.oneOf(Ke.colorType,ut,"invalid color type"),Mr=Ke.colorType),"colorFormat"in Ke&&(pr=Ke.colorFormat,at.oneOf(Ke.colorFormat,C,"invalid color format for texture"))),"depth"in Ke&&(Ie.depth=Ke.depth),"stencil"in Ke&&(Ie.stencil=Ke.stencil),"depthStencil"in Ke&&(Ie.depthStencil=Ke.depthStencil)}else Ue=1;if(hr)if(Array.isArray(hr))for(Ee=[],oe=0;oe<hr.length;++oe)Ee[oe]=hr[oe];else Ee=[hr];else{Ee=Array(Er);var mn={radius:Ue,format:pr,type:Mr};for(oe=0;oe<Er;++oe)Ee[oe]=yt.createCube(mn)}for(Ie.color=Array(Ee.length),oe=0;oe<Ee.length;++oe){var Bo=Ee[oe];at(typeof Bo=="function"&&Bo._reglType==="textureCube","invalid cube map"),Ue=Ue||Bo.width,at(Bo.width===Ue&&Bo.height===Ue,"invalid cube map shape"),Ie.color[oe]={target:ka,data:Ee[oe]}}for(oe=0;oe<6;++oe){for(var oi=0;oi<Ee.length;++oi)Ie.color[oi].target=ka+oe;oe>0&&(Ie.depth=J[0].depth,Ie.stencil=J[0].stencil,Ie.depthStencil=J[0].depthStencil),J[oe]?J[oe](Ie):J[oe]=se(Ie)}return a(Et,{width:Ue,height:Ue,color:Ee})}return Et(Vt),a(Et,{faces:J,resize:function(kt){var oe,Ee=0|kt;if(at(Ee>0&&Ee<=vt.maxCubeMapSize,"invalid radius for cube fbo"),Ee===Et.width)return Et;var Ie=Et.color;for(oe=0;oe<Ie.length;++oe)Ie[oe].resize(Ee);for(oe=0;oe<6;++oe)J[oe].resize(Ee);return Et.width=Et.height=Ee,Et},_reglType:"framebufferCube",destroy:function(){J.forEach(function(kt){kt.destroy()})}})},clear:function(){Dr(St).forEach(jt)},restore:function(){P.cur=null,P.next=null,P.dirty=!0,Dr(St).forEach(function(Vt){Vt.framebuffer=D.createFramebuffer(),Ft(Vt)})}})}(ee,Oe,c,g,x,Pe),S=Uo(ee,Ve,Oe,c,i,n,0,M,{},e,u,{elements:null,primitive:4,count:-1,offset:0,instances:-1},cr,We,Tt),T=Ns(ee,M,S.procs.poll,cr,Ae,Oe,c),k=S.next,B=ee.canvas,Q=[],et=[],K=[],j=[Tt.onDestroy],dt=null;function ot(){if(Q.length===0)return We&&We.update(),void(dt=null);dt=Ce.next(ot),st();for(var D=Q.length-1;D>=0;--D){var W=Q[D];W&&W(cr,null,0)}ee.flush(),We&&We.update()}function pt(){!dt&&Q.length>0&&(dt=Ce.next(ot))}function ne(){dt&&(Ce.cancel(ot),dt=null)}function Kt(D){D.preventDefault(),Se=!0,ne(),et.forEach(function(W){W()})}function qt(D){ee.getError(),Se=!1,Re.restore(),u.restore(),i.restore(),g.restore(),x.restore(),M.restore(),e.restore(),We&&We.restore(),S.procs.refresh(),pt(),K.forEach(function(W){W()})}function Nt(D){function W(U,lt){var it={},ft={};return Object.keys(U).forEach(function(Rt){var Gt=U[Rt];if(Me.isDynamic(Gt))ft[Rt]=Me.unbox(Gt,Rt);else{if(lt&&Array.isArray(Gt)){for(var ht=0;ht<Gt.length;++ht)if(Me.isDynamic(Gt[ht]))return void(ft[Rt]=Me.unbox(Gt,Rt))}it[Rt]=Gt}}),{dynamic:ft,static:it}}at(!!D,"invalid args to regl({...})"),at.type(D,"object","invalid args to regl({...})");var vt=W(D.context||{},!0),yt=W(D.uniforms||{},!0),At=W(D.attributes||{},!1),I=W(function(U){var lt=a({},U);function it(ft){if(ft in lt){var Rt=lt[ft];delete lt[ft],Object.keys(Rt).forEach(function(Gt){lt[ft+"."+Gt]=Rt[Gt]})}}return delete lt.uniforms,delete lt.attributes,delete lt.context,delete lt.vao,"stencil"in lt&&lt.stencil.op&&(lt.stencil.opBack=lt.stencil.opFront=lt.stencil.op,delete lt.stencil.op),it("blend"),it("depth"),it("cull"),it("stencil"),it("polygonOffset"),it("scissor"),it("sample"),"vao"in U&&(lt.vao=U.vao),lt}(D),!1),P={gpuTime:0,cpuTime:0,count:0},C=S.compile(I,At,yt,vt,P),O=C.draw,ut=C.batch,xt=C.scope,G=[];return a(function(U,lt){var it;if(Se&&at.raise("context lost"),typeof U=="function")return xt.call(this,null,U,0);if(typeof lt=="function")if(typeof U=="number")for(it=0;it<U;++it)xt.call(this,null,lt,it);else{if(!Array.isArray(U))return xt.call(this,U,lt,0);for(it=0;it<U.length;++it)xt.call(this,U[it],lt,it)}else if(typeof U=="number"){if(U>0)return ut.call(this,function(ft){for(;G.length<ft;)G.push(null);return G}(0|U),0|U)}else{if(!Array.isArray(U))return O.call(this,U);if(U.length)return ut.call(this,U,U.length)}},{stats:P,destroy:function(){C.destroy()}})}B&&(B.addEventListener(Ga,Kt,!1),B.addEventListener(as,qt,!1));var Pt=M.setFBO=Nt({framebuffer:Me.define.call(null,1,"framebuffer")});function Ht(D,W){var vt=0;S.procs.poll();var yt=W.color;yt&&(ee.clearColor(+yt[0]||0,+yt[1]||0,+yt[2]||0,+yt[3]||0),vt|=16384),"depth"in W&&(ee.clearDepth(+W.depth),vt|=256),"stencil"in W&&(ee.clearStencil(0|W.stencil),vt|=1024),at(!!vt,"called regl.clear with no buffer specified"),ee.clear(vt)}function Ct(D){return at.type(D,"function","regl.frame() callback must be a function"),Q.push(D),pt(),{cancel:function(){var W=ss(Q,D);at(W>=0,"cannot cancel a frame twice"),Q[W]=function vt(){var yt=ss(Q,vt);Q[yt]=Q[Q.length-1],Q.length-=1,Q.length<=0&&ne()}}}}function V(){var D=k.viewport,W=k.scissor_box;D[0]=D[1]=W[0]=W[1]=0,cr.viewportWidth=cr.framebufferWidth=cr.drawingBufferWidth=D[2]=W[2]=ee.drawingBufferWidth,cr.viewportHeight=cr.framebufferHeight=cr.drawingBufferHeight=D[3]=W[3]=ee.drawingBufferHeight}function st(){cr.tick+=1,cr.time=mt(),V(),S.procs.poll()}function It(){g.refresh(),V(),S.procs.refresh(),We&&We.update()}function mt(){return(mr()-nr)/1e3}It();var X=a(Nt,{clear:function(D){if(at(typeof D=="object"&&D,"regl.clear() takes an object as input"),"framebuffer"in D)if(D.framebuffer&&D.framebuffer_reglType==="framebufferCube")for(var W=0;W<6;++W)Pt(a({framebuffer:D.framebuffer.faces[W]},D),Ht);else Pt(D,Ht);else Ht(0,D)},prop:Me.define.bind(null,1),context:Me.define.bind(null,2),this:Me.define.bind(null,3),draw:Nt({}),buffer:function(D){return i.create(D,34962,!1,!1)},elements:function(D){return n.create(D,!1)},texture:g.create2D,cube:g.createCube,renderbuffer:x.create,framebuffer:M.create,framebufferCube:M.createCube,vao:e.createVAO,attributes:Ae,frame:Ct,on:function(D,W){var vt;switch(at.type(W,"function","listener callback must be a function"),D){case"frame":return Ct(W);case"lost":vt=et;break;case"restore":vt=K;break;case"destroy":vt=j;break;default:at.raise("invalid event, must be one of frame,lost,restore,destroy")}return vt.push(W),{cancel:function(){for(var yt=0;yt<vt.length;++yt)if(vt[yt]===W)return vt[yt]=vt[vt.length-1],void vt.pop()}}},limits:c,hasExtension:function(D){return c.extensions.indexOf(D.toLowerCase())>=0},read:T,destroy:function(){Q.length=0,ne(),B&&(B.removeEventListener(Ga,Kt),B.removeEventListener(as,qt)),u.clear(),M.clear(),x.clear(),g.clear(),n.clear(),i.clear(),e.clear(),We&&We.clear(),j.forEach(function(D){D()})},_gl:ee,_refresh:It,poll:function(){st(),We&&We.update()},now:mt,stats:Pe});return Tt.onDone(null,X),X}}()}},qu={};function Un(p){var h=qu[p];if(h!==void 0)return h.exports;var a=qu[p]={id:p,loaded:!1,exports:{}};return cc[p].call(a.exports,a,a.exports,Un),a.loaded=!0,a.exports}Un.n=p=>{var h=p&&p.__esModule?()=>p.default:()=>p;return Un.d(h,{a:h}),h},Un.d=(p,h)=>{for(var a in h)Un.o(h,a)&&!Un.o(p,a)&&Object.defineProperty(p,a,{enumerable:!0,get:h[a]})},Un.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),Un.o=(p,h)=>Object.prototype.hasOwnProperty.call(p,h),Un.nmd=p=>(p.paths=[],p.children||(p.children=[]),p);var mu={};(()=>{Un.d(mu,{O:()=>Xi,I:()=>hi});var p={913:v=>{var Bt=Object.prototype.hasOwnProperty,z="~";function Lt(){}function Mt(pe,ye,fe){this.fn=pe,this.context=ye,this.once=fe||!1}function te(pe,ye,fe,Je,Qe){if(typeof fe!="function")throw new TypeError("The listener must be a function");var ar=new Mt(fe,Je||pe,Qe),dr=z?z+ye:ye;return pe._events[dr]?pe._events[dr].fn?pe._events[dr]=[pe._events[dr],ar]:pe._events[dr].push(ar):(pe._events[dr]=ar,pe._eventsCount++),pe}function ue(pe,ye){--pe._eventsCount==0?pe._events=new Lt:delete pe._events[ye]}function he(){this._events=new Lt,this._eventsCount=0}Object.create&&(Lt.prototype=Object.create(null),new Lt().__proto__||(z=!1)),he.prototype.eventNames=function(){var pe,ye,fe=[];if(this._eventsCount===0)return fe;for(ye in pe=this._events)Bt.call(pe,ye)&&fe.push(z?ye.slice(1):ye);return Object.getOwnPropertySymbols?fe.concat(Object.getOwnPropertySymbols(pe)):fe},he.prototype.listeners=function(pe){var ye=z?z+pe:pe,fe=this._events[ye];if(!fe)return[];if(fe.fn)return[fe.fn];for(var Je=0,Qe=fe.length,ar=new Array(Qe);Je<Qe;Je++)ar[Je]=fe[Je].fn;return ar},he.prototype.listenerCount=function(pe){var ye=z?z+pe:pe,fe=this._events[ye];return fe?fe.fn?1:fe.length:0},he.prototype.emit=function(pe,ye,fe,Je,Qe,ar){var dr=z?z+pe:pe;if(!this._events[dr])return!1;var _r,Te,yr=this._events[dr],Wr=arguments.length;if(yr.fn){switch(yr.once&&this.removeListener(pe,yr.fn,void 0,!0),Wr){case 1:return yr.fn.call(yr.context),!0;case 2:return yr.fn.call(yr.context,ye),!0;case 3:return yr.fn.call(yr.context,ye,fe),!0;case 4:return yr.fn.call(yr.context,ye,fe,Je),!0;case 5:return yr.fn.call(yr.context,ye,fe,Je,Qe),!0;case 6:return yr.fn.call(yr.context,ye,fe,Je,Qe,ar),!0}for(Te=1,_r=new Array(Wr-1);Te<Wr;Te++)_r[Te-1]=arguments[Te];yr.fn.apply(yr.context,_r)}else{var cn,Wn=yr.length;for(Te=0;Te<Wn;Te++)switch(yr[Te].once&&this.removeListener(pe,yr[Te].fn,void 0,!0),Wr){case 1:yr[Te].fn.call(yr[Te].context);break;case 2:yr[Te].fn.call(yr[Te].context,ye);break;case 3:yr[Te].fn.call(yr[Te].context,ye,fe);break;case 4:yr[Te].fn.call(yr[Te].context,ye,fe,Je);break;default:if(!_r)for(cn=1,_r=new Array(Wr-1);cn<Wr;cn++)_r[cn-1]=arguments[cn];yr[Te].fn.apply(yr[Te].context,_r)}}return!0},he.prototype.on=function(pe,ye,fe){return te(this,pe,ye,fe,!1)},he.prototype.once=function(pe,ye,fe){return te(this,pe,ye,fe,!0)},he.prototype.removeListener=function(pe,ye,fe,Je){var Qe=z?z+pe:pe;if(!this._events[Qe])return this;if(!ye)return ue(this,Qe),this;var ar=this._events[Qe];if(ar.fn)ar.fn!==ye||Je&&!ar.once||fe&&ar.context!==fe||ue(this,Qe);else{for(var dr=0,_r=[],Te=ar.length;dr<Te;dr++)(ar[dr].fn!==ye||Je&&!ar[dr].once||fe&&ar[dr].context!==fe)&&_r.push(ar[dr]);_r.length?this._events[Qe]=_r.length===1?_r[0]:_r:ue(this,Qe)}return this},he.prototype.removeAllListeners=function(pe){var ye;return pe?(ye=z?z+pe:pe,this._events[ye]&&ue(this,ye)):(this._events=new Lt,this._eventsCount=0),this},he.prototype.off=he.prototype.removeListener,he.prototype.addListener=he.prototype.on,he.prefixed=z,he.EventEmitter=he,v.exports=he},617:(v,Bt,z)=>{var Lt=z(331),Mt=["stopLayout","calculateLayout"];v.exports=function(){var te=new Worker(URL.createObjectURL(new Blob(['var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{calculateLayout:()=>_n,stopLayout:()=>In});var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function o(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function i(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function a(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function u(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}Object.create,Object.create;const d=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[],i=this._events["*"]||[],a=function(n){for(var o=n.length,i=0;i<o;i++)if(n[i]){var a=n[i],s=a.callback;a.once&&(n.splice(i,1),0===n.length&&delete e._events[t],o--,i--),s.apply(e,r)}};a(o),a(i)},t.prototype.off=function(t,e){if(t)if(e){for(var r=this._events[t]||[],n=r.length,o=0;o<n;o++)r[o].callback===e&&(r.splice(o,1),n--,o--);0===r.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function h(t,e,r,n){for(;t.length;){const o=t.shift();if(r(o))return!0;e.add(o.id),n(o.id).forEach((r=>{e.has(r.id)||(e.add(r.id),t.push(r))}))}return!1}function c(t,e,r,n){if(r(t))return!0;e.add(t.id);for(const o of n(t.id))if(!e.has(o.id)&&c(o,e,r,n))return!0;return!1}class l extends d{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const r=e.find((e=>e.type===t.type&&e.id===t.id&&e.propertyName===t.propertyName));r?r.newValue=t.newValue:e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const r=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),r=this.bothEdgesMap.get(t);r?.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((e=>{e.childrenMap.get(t)?.forEach((t=>{e.parentMap.delete(t.id)})),e.parentMap.delete(t),e.childrenMap.delete(t)})),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){const n=this.getNode(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateNodeDataProperty(t,e,r)}))}))}updateNodeData(...t){const e=t[0],r=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:o})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),o.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),o=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),o.delete(e),i.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.source,o=e;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:o})}))}updateEdgeTarget(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.target,o=e;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:o})}))}updateEdgeDataProperty(t,e,r){const n=this.getEdge(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}updateEdgeData(...t){const e=t[0],r=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:o})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateEdgeDataProperty(t,e,r)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const r=[],n=Array.isArray(t)?t:[t];for(;n.length;){const t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach((t=>{t.children?.forEach((r=>{this.setParent(r.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const r=this.treeIndices.get(e).childrenMap.get(t);return Array.from(r||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const r=[];let n,o=this.getNode(t);for(;n=this.getParent(o.id,e);)r.push(n),o=n;return r}setParent(t,e,r){this.checkTreeExistence(r);const n=this.treeIndices.get(r),o=this.getNode(t),i=n.parentMap.get(t),a=this.getNode(e);n.parentMap.set(t,a),i&&n.childrenMap.get(i.id)?.delete(o);let s=n.childrenMap.get(a.id);s||(s=new Set,n.childrenMap.set(a.id,s)),s.add(o),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:i?.id,newParentId:a.id})}))}dfsTree(t,e,r){return c(this.getNode(t),new Set,e,(t=>this.getChildren(t,r)))}bfsTree(t,e,r){return h([this.getNode(t)],new Set,e,(t=>this.getChildren(t,r)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return h([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return c(this.getNode(t),new Set,e,n)}clone(){const t=this.getAllNodes().map((t=>({...t,data:{...t.data}}))),e=this.getAllEdges().map((t=>({...t,data:{...t.data}}))),r=new l({nodes:t,edges:e});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},n)=>{const o=new Map;t.forEach(((t,e)=>{o.set(e,r.getNode(t.id))}));const i=new Map;e.forEach(((t,e)=>{i.set(e,new Set(Array.from(t).map((t=>r.getNode(t.id)))))})),r.treeIndices.set(n,{parentMap:o,childrenMap:i})})),r}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var f=/-(\\w)/g,g=(function(t){return t.replace(f,(function(t,e){return e?e.toUpperCase():""}))},Object.create(null),Array.isArray),p=function(t){for(var e=[],r=t.length,n=0;n<r;n+=1){e[n]=[];for(var o=0;o<r;o+=1)n===o?e[n][o]=0:0!==t[n][o]&&t[n][o]?e[n][o]=t[n][o]:e[n][o]=1/0}for(var i=0;i<r;i+=1)for(n=0;n<r;n+=1)for(o=0;o<r;o+=1)e[n][o]>e[n][i]+e[i][o]&&(e[n][o]=e[n][i]+e[i][o]);return e},v=function(t,e){var r=t.nodes,n=t.edges,o=[],i={};if(!r)throw new Error("invalid nodes data!");return r&&r.forEach((function(t,e){i[t.id]=e,o.push([])})),null==n||n.forEach((function(t){var r=t.source,n=t.target,a=i[r],s=i[n];void 0!==a&&void 0!==s&&(o[a][s]=1,e||(o[s][a]=1))})),o},y=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},m={}.toString;const w=function(t,e){return m.call(t)==="[object "+e+"]"},x=function(t){return w(t,"Number")};var E=function(t){if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var e=[];return t.forEach((function(t){e.push(t)})),e.map((function(t){return E(t)}))}if("object"==typeof t){var r={};return Object.keys(t).forEach((function(e){r[e]=E(t[e])})),r}return t},b=function(t,e){var r=E(t);return r.data=r.data||{},e&&(x(r.data.x)||(r.data.x=Math.random()*e[0]),x(r.data.y)||(r.data.y=Math.random()*e[1])),r};const N=function(t){return"function"==typeof t},M=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function S(t,e){return N(e)?e:x(e)?function(){return e}:function(){return t}}function k(t,e,r){return void 0===r&&(r=!0),e||0===e?N(e)?e:x(e)?function(){return e}:g(e)?function(){if(r){var n=Math.max.apply(Math,u([],s(e)));return isNaN(n)?t:n}return e}:M(e)?function(){if(r){var n=Math.max(e.width,e.height);return isNaN(n)?t:n}return[e.width,e.height]}:function(){return t}:function(e){var r=(e.data||{}).size;return r?g(r)?r[0]>r[1]?r[0]:r[1]:M(r)?r.width>r.height?r.width:r.height:r:t}}var A=function(t,e){var r;return r=x(e)?function(){return e}:N(e)?e:function(){return 0},t?g(t)?function(e){return(t[0]>t[1]?t[0]:t[1])+r(e)}:function(e){return t+r(e)}:function(t){var e,n;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return Math.max(t.data.bboxSize[0],t.data.bboxSize[1])+r(t);if(null===(n=t.data)||void 0===n?void 0:n.size){if(g(t.data.size))return Math.max(t.data.size[0],t.data.size[1])+r(t);var o=t.data.size;return M(o)?(o.width>o.height?o.width:o.height)+r(t):o+r(t)}return 10+r(t)}},R=function(t,e,r){var o=t.getAllNodes(),i=t.getAllEdges();return(null==o?void 0:o.length)?1===o.length?(e&&t.mergeNodeData(o[0].id,{x:r[0],y:r[1]}),{nodes:[n(n({},o[0]),{data:n(n({},o[0].data),{x:r[0],y:r[1]})})],edges:i}):void 0:{nodes:[],edges:i}},I={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},_=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="circular",this.options=n(n({},I),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericCircularLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericCircularLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericCircularLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,u,d,h,c,l,f,g,p,v,y,m,w,x,E,N,M,A,I,_,P,T,z,C,L,q,j,F,V,G,W,B,$,U;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,u=o.height,d=o.center,h=o.divisions,c=o.startAngle,l=void 0===c?0:c,f=o.endAngle,g=void 0===f?2*Math.PI:f,p=o.angleRatio,v=o.ordering,y=o.clockwise,m=o.nodeSpacing,w=o.nodeSize,x=e.getAllNodes(),E=e.getAllEdges(),N=s(O(i,u,d),3),M=N[0],A=N[1],I=N[2],!(_=null==x?void 0:x.length)||1===_)return[2,R(e,t,I)];for(P=(g-l)/_,T=o.radius,z=o.startRadius,C=o.endRadius,m?(L=S(10,m),q=k(10,w),j=-1/0,x.forEach((function(t){var e=q(t);j<e&&(j=e)})),F=0,x.forEach((function(t,e){F+=0===e?j||10:(L(t)||0)+(j||10)})),T=F/(2*Math.PI)):T||z||C?!z&&C?z=C:z&&!C&&(C=z):T=Math.min(A,M)/2,V=P*p,G=[],G="topology"===v?D(e,x):"topology-directed"===v?D(e,x,!0):"degree"===v?function(t,e){var r=[];return e.forEach((function(t,e){r.push(b(t))})),r.sort((function(e,r){return t.getDegree(e.id,"both")-t.getDegree(r.id,"both")})),r}(e,x):x.map((function(t){return b(t)})),W=Math.ceil(_/h),B=0;B<_;++B)($=T)||null===z||null===C||($=z+B*(C-z)/(_-1)),$||($=10+100*B/(_-1)),U=l+B%W*V+2*Math.PI/h*Math.floor(B/W),y||(U=g-B%W*V-2*Math.PI/h*Math.floor(B/W)),G[B].data.x=I[0]+Math.cos(U)*$,G[B].data.y=I[1]+Math.sin(U)*$;return t&&G.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:G,edges:E}]}))}))},t}(),D=function(t,e,r){void 0===r&&(r=!1);var n=[b(e[0])],o={},i=e.length;o[e[0].id]=!0;var a=0;return e.forEach((function(s,u){if(0!==u)if(u!==i-1&&t.getDegree(s.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(n[a].id,s.id)||o[s.id]){for(var d=r?t.getSuccessors(n[a].id):t.getNeighbors(n[a].id),h=!1,c=0;c<d.length;c++){var l=d[c];if(t.getDegree(l.id)===t.getDegree(s.id)&&!o[l.id]){n.push(b(l)),o[l.id]=!0,h=!0;break}}for(var f=0;!h&&(o[e[f].id]||(n.push(b(e[f])),o[e[f].id]=!0,h=!0),++f!==i););}else n.push(b(s)),o[s.id]=!0,a++})),n},O=function(t,e,r){var n=t,o=e,i=r;return n||"undefined"==typeof window||(n=window.innerWidth),o||"undefined"==typeof window||(o=window.innerHeight),i||(i=[n/2,o/2]),[n,o,i]};const P=function(t){return w(t,"String")};var T={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},z=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="concentric",this.options=n(n({},T),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericConcentricLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericConcentricLayout(!0,t,e),[2]}))}))},t.prototype.genericConcentricLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,p,v,y,m,w,E,S,k,A,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K,Y;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,d=o.sortBy,h=o.maxLevelDiff,c=o.sweep,l=o.clockwise,f=o.equidistant,p=o.preventOverlap,v=o.startAngle,y=void 0===v?1.5*Math.PI:v,m=o.nodeSize,w=o.nodeSpacing,E=e.getAllNodes(),S=e.getAllEdges(),k=s||"undefined"==typeof window?s:window.innerWidth,A=u||"undefined"==typeof window?u:window.innerHeight,I=i||[k/2,A/2],!(null==E?void 0:E.length)||1===E.length)return[2,R(e,t,I)];if(_=[],O=0,D=g(m)?Math.max(m[0],m[1]):m,g(w)?O=Math.max(w[0],w[1]):x(w)&&(O=w),E.forEach((function(t){var e=b(t);_.push(e);var r=D,n=e.data;g(n.size)?r=Math.max(n.size[0],n.size[1]):x(n.size)?r=n.size:M(n.size)&&(r=Math.max(n.size.width,n.size.height)),D=Math.max(D,r),N(w)&&(O=Math.max(w(t),O))})),T={},_.forEach((function(t,e){T[t.id]=e})),P(z=d)&&void 0!==_[0].data[z]||(z="degree"),"degree"===z?_.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):_.sort((function(t,e){return e.data[z]-t.data[z]})),C=_[0],L=(h||("degree"===z?e.getDegree(C.id,"both"):C.data[z]))/4,j=(q=[{nodes:[]}])[0],_.forEach((function(t){if(j.nodes.length>0){var r="degree"===z?Math.abs(e.getDegree(j.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(j.nodes[0].data[z]-t.data[z]);L&&r>=L&&(j={nodes:[]},q.push(j))}j.nodes.push(t)})),F=D+O,p||(V=q.length>0&&q[0].nodes.length>1,G=Math.min(k,A)/2-F,W=G/(q.length+(V?1:0)),F=Math.min(F,W)),B=0,q.forEach((function(t){var e=void 0===c?2*Math.PI-2*Math.PI/t.nodes.length:c;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&p){var r=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),o=Math.sqrt(F*F/(r*r+n*n));B=Math.max(o,B)}t.r=B,B+=F})),f){for($=0,U=0,H=0;H<q.length;H++)K=q[H],Y=(K.r||0)-U,$=Math.max($,Y);U=0,q.forEach((function(t,e){0===e&&(U=t.r||0),t.r=U,U+=$}))}return q.forEach((function(t){var e=t.dTheta||0,r=t.r||0;t.nodes.forEach((function(t,n){var o=y+(l?1:-1)*e*n;t.data.x=I[0]+r*Math.cos(o),t.data.y=I[1]+r*Math.sin(o)}))})),t&&_.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:_,edges:S}]}))}))},t}();function C(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i,a,s,u,d,h,c,l,f=t._root,g={data:n},p=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!f)return t._root=g,t;for(;f.length;)if((d=e>=(i=(p+y)/2))?p=i:y=i,(h=r>=(a=(v+m)/2))?v=a:m=a,o=f,!(f=f[c=h<<1|d]))return o[c]=g,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&r===u)return g.next=f,o?o[c]=g:t._root=g,t;do{o=o?o[c]=new Array(4):t._root=new Array(4),(d=e>=(i=(p+y)/2))?p=i:y=i,(h=r>=(a=(v+m)/2))?v=a:m=a}while((c=h<<1|d)==(l=(u>=a)<<1|s>=i));return o[l]=f,o[c]=g,t}function L(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function q(t){return t[0]}function j(t){return t[1]}function F(t,e,r){var n=new V(null==e?q:e,null==r?j:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function V(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function G(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var W=F.prototype=V.prototype;function B(t){return function(){return t}}function $(t){return 1e-6*(t()-.5)}W.copy=function(){var t,e,r=new V(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=G(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var o=0;o<4;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(4)}):n.target[o]=G(e));return r},W.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return C(this.cover(e,r),e,r,t)},W.addAll=function(t){var e,r,n,o,i=t.length,a=new Array(i),s=new Array(i),u=1/0,d=1/0,h=-1/0,c=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(a[r]=n,s[r]=o,n<u&&(u=n),n>h&&(h=n),o<d&&(d=o),o>c&&(c=o));if(u>h||d>c)return this;for(this.cover(u,d).cover(h,c),r=0;r<i;++r)C(this,a[r],s[r],t[r]);return this},W.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var a,s,u=o-r||1,d=this._root;r>t||t>=o||n>e||e>=i;)switch(s=(e<n)<<1|t<r,(a=new Array(4))[s]=d,d=a,u*=2,s){case 0:o=r+u,i=n+u;break;case 1:r=o-u,i=n+u;break;case 2:o=r+u,n=i-u;break;case 3:r=o-u,n=i-u}this._root&&this._root.length&&(this._root=d)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this},W.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},W.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},W.find=function(t,e,r){var n,o,i,a,s,u,d,h=this._x0,c=this._y0,l=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new L(p,h,c,l,f)),null==r?r=1/0:(h=t-r,c=e-r,l=t+r,f=e+r,r*=r);u=g.pop();)if(!(!(p=u.node)||(o=u.x0)>l||(i=u.y0)>f||(a=u.x1)<h||(s=u.y1)<c))if(p.length){var v=(o+a)/2,y=(i+s)/2;g.push(new L(p[3],v,y,a,s),new L(p[2],o,y,v,s),new L(p[1],v,i,a,y),new L(p[0],o,i,v,y)),(d=(e>=y)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-d],g[g.length-1-d]=u)}else{var m=t-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),x=m*m+w*w;if(x<r){var E=Math.sqrt(r=x);h=t-E,c=e-E,l=t+E,f=e+E,n=p.data}}return n},W.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,r,n,o,i,a,s,u,d,h,c,l,f=this._root,g=this._x0,p=this._y0,v=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((d=i>=(s=(g+v)/2))?g=s:v=s,(h=a>=(u=(p+y)/2))?p=u:y=u,e=f,!(f=f[c=h<<1|d]))return this;if(!f.length)break;(e[c+1&3]||e[c+2&3]||e[c+3&3])&&(r=e,l=c)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(o=f.next)&&delete f.next,n?(o?n.next=o:delete n.next,this):e?(o?e[c]=o:delete e[c],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[l]=f:this._root=f),this):(this._root=o,this)},W.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},W.root=function(){return this._root},W.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},W.visit=function(t){var e,r,n,o,i,a,s=[],u=this._root;for(u&&s.push(new L(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,n=e.x0,o=e.y0,i=e.x1,a=e.y1)&&u.length){var d=(n+i)/2,h=(o+a)/2;(r=u[3])&&s.push(new L(r,d,h,i,a)),(r=u[2])&&s.push(new L(r,n,h,d,a)),(r=u[1])&&s.push(new L(r,d,o,i,h)),(r=u[0])&&s.push(new L(r,n,o,d,h))}return this},W.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new L(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.x1,d=e.y1,h=(a+u)/2,c=(s+d)/2;(i=o[0])&&r.push(new L(i,a,s,h,c)),(i=o[1])&&r.push(new L(i,h,s,u,c)),(i=o[2])&&r.push(new L(i,a,c,h,d)),(i=o[3])&&r.push(new L(i,h,c,u,d))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},W.x=function(t){return arguments.length?(this._x=t,this):this._x},W.y=function(t){return arguments.length?(this._y=t,this):this._y};var U={value:()=>{}};function H(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new K(n)}function K(t){this._=t}function Y(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function J(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=U,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}K.prototype=H.prototype={constructor:K,on:function(t,e){var r,n,o=this._,i=(n=o,(t+"").trim().split(/^|\\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)o[r]=J(o[r],t.name,e);else if(null==e)for(r in o)o[r]=J(o[r],t.name,null);return this}for(;++a<s;)if((r=(t=i[a]).type)&&(r=Y(o[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new K(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};const X=H;var Q,Z,tt=0,et=0,rt=0,nt=1e3,ot=0,it=0,at=0,st="object"==typeof performance&&performance.now?performance:Date,ut="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function dt(){return it||(ut(ht),it=st.now()+at)}function ht(){it=0}function ct(){this._call=this._time=this._next=null}function lt(t,e,r){var n=new ct;return n.restart(t,e,r),n}function ft(){it=(ot=st.now())+at,tt=et=0;try{!function(){dt(),++tt;for(var t,e=Q;e;)(t=it-e._time)>=0&&e._call.call(void 0,t),e=e._next;--tt}()}finally{tt=0,function(){for(var t,e,r=Q,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:Q=e);Z=t,pt(n)}(),it=0}}function gt(){var t=st.now(),e=t-ot;e>nt&&(at-=e,ot=t)}function pt(t){tt||(et&&(et=clearTimeout(et)),t-it>24?(t<1/0&&(et=setTimeout(ft,t-st.now()-at)),rt&&(rt=clearInterval(rt))):(rt||(ot=st.now(),rt=setInterval(gt,nt)),tt=1,ut(ft)))}ct.prototype=lt.prototype={constructor:ct,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?dt():+r)+(null==e?0:+e),this._next||Z===this||(Z?Z._next=this:Q=this,Z=this),this._call=t,this._time=r,pt()},stop:function(){this._call&&(this._call=null,this._time=1/0,pt())}};const vt=1664525,yt=1013904223,mt=4294967296;function wt(t){return t.x}function xt(t){return t.y}var Et=10,bt=Math.PI*(3-Math.sqrt(5));function Nt(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,a=.6,s=new Map,u=lt(c),d=X("tick","end"),h=function(){let t=1;return()=>(t=(vt*t+yt)%mt)/mt}();function c(){l(),d.call("tick",e),r<n&&(u.stop(),d.call("end",e))}function l(n){var u,d,h=t.length;void 0===n&&(n=1);for(var c=0;c<n;++c)for(r+=(i-r)*o,s.forEach((function(t){t(r)})),u=0;u<h;++u)null==(d=t[u]).fx?d.x+=d.vx*=a:(d.x=d.fx,d.vx=0),null==d.fy?d.y+=d.vy*=a:(d.y=d.fy,d.vy=0);return e}function f(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var o=Et*Math.sqrt(.5+r),i=r*bt;e.x=o*Math.cos(i),e.y=o*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,h),e}return null==t&&(t=[]),f(),e={tick:l,restart:function(){return u.restart(c),e},stop:function(){return u.stop(),e},nodes:function(r){return arguments.length?(t=r,f(),s.forEach(g),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(h=t,s.forEach(g),e):h},force:function(t,r){return arguments.length>1?(null==r?s.delete(t):s.set(t,g(r)),e):s.get(t)},find:function(e,r,n){var o,i,a,s,u,d=0,h=t.length;for(null==n?n=1/0:n*=n,d=0;d<h;++d)(a=(o=e-(s=t[d]).x)*o+(i=r-s.y)*i)<n&&(u=s,n=a);return u},on:function(t,r){return arguments.length>1?(d.on(t,r),e):d.on(t)}}}function Mt(){var t,e,r,n,o,i=B(-30),a=1,s=1/0,u=.81;function d(r){var o,i=t.length,a=F(t,wt,xt).visitAfter(c);for(n=r,o=0;o<i;++o)e=t[o],a.visit(l)}function h(){if(t){var e,r,n=t.length;for(o=new Array(n),e=0;e<n;++e)r=t[e],o[r.index]=+i(r,e,t)}}function c(t){var e,r,n,i,a,s=0,u=0;if(t.length){for(n=i=a=0;a<4;++a)(e=t[a])&&(r=Math.abs(e.value))&&(s+=e.value,u+=r,n+=r*e.x,i+=r*e.y);t.x=n/u,t.y=i/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=o[e.data.index]}while(e=e.next)}t.value=s}function l(t,i,d,h){if(!t.value)return!0;var c=t.x-e.x,l=t.y-e.y,f=h-i,g=c*c+l*l;if(f*f/u<g)return g<s&&(0===c&&(g+=(c=$(r))*c),0===l&&(g+=(l=$(r))*l),g<a&&(g=Math.sqrt(a*g)),e.vx+=c*t.value*n/g,e.vy+=l*t.value*n/g),!0;if(!(t.length||g>=s)){(t.data!==e||t.next)&&(0===c&&(g+=(c=$(r))*c),0===l&&(g+=(l=$(r))*l),g<a&&(g=Math.sqrt(a*g)));do{t.data!==e&&(f=o[t.data.index]*n/g,e.vx+=c*f,e.vy+=l*f)}while(t=t.next)}}return d.initialize=function(e,n){t=e,r=n,h()},d.strength=function(t){return arguments.length?(i="function"==typeof t?t:B(+t),h(),d):i},d.distanceMin=function(t){return arguments.length?(a=t*t,d):Math.sqrt(a)},d.distanceMax=function(t){return arguments.length?(s=t*t,d):Math.sqrt(s)},d.theta=function(t){return arguments.length?(u=t*t,d):Math.sqrt(u)},d}function St(t){return t.index}function kt(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function At(t){var e,r,n,o,i,a,s=St,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},d=B(30),h=1;function c(n){for(var o=0,s=t.length;o<h;++o)for(var u,d,c,l,f,g,p,v=0;v<s;++v)d=(u=t[v]).source,l=(c=u.target).x+c.vx-d.x-d.vx||$(a),f=c.y+c.vy-d.y-d.vy||$(a),l*=g=((g=Math.sqrt(l*l+f*f))-r[v])/g*n*e[v],f*=g,c.vx-=l*(p=i[v]),c.vy-=f*p,d.vx+=l*(p=1-p),d.vy+=f*p}function l(){if(n){var a,u,d=n.length,h=t.length,c=new Map(n.map(((t,e)=>[s(t,e,n),t])));for(a=0,o=new Array(d);a<h;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=kt(c,u.source)),"object"!=typeof u.target&&(u.target=kt(c,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(a=0,i=new Array(h);a<h;++a)u=t[a],i[a]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);e=new Array(h),f(),r=new Array(h),g()}}function f(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+u(t[r],r,t)}function g(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+d(t[e],e,t)}return null==t&&(t=[]),c.initialize=function(t,e){n=t,a=e,l()},c.links=function(e){return arguments.length?(t=e,l(),c):t},c.id=function(t){return arguments.length?(s=t,c):s},c.iterations=function(t){return arguments.length?(h=+t,c):h},c.strength=function(t){return arguments.length?(u="function"==typeof t?t:B(+t),f(),c):u},c.distance=function(t){return arguments.length?(d="function"==typeof t?t:B(+t),g(),c):d},c}function Rt(t){return t.x+t.vx}function It(t){return t.y+t.vy}function _t(t){var e,r,n,o=1,i=1;function a(){for(var t,a,u,d,h,c,l,f=e.length,g=0;g<i;++g)for(a=F(e,Rt,It).visitAfter(s),t=0;t<f;++t)u=e[t],c=r[u.index],l=c*c,d=u.x+u.vx,h=u.y+u.vy,a.visit(p);function p(t,e,r,i,a){var s=t.data,f=t.r,g=c+f;if(!s)return e>d+g||i<d-g||r>h+g||a<h-g;if(s.index>u.index){var p=d-s.x-s.vx,v=h-s.y-s.vy,y=p*p+v*v;y<g*g&&(0===p&&(y+=(p=$(n))*p),0===v&&(y+=(v=$(n))*v),y=(g-(y=Math.sqrt(y)))/y*o,u.vx+=(p*=y)*(g=(f*=f)/(l+f)),u.vy+=(v*=y)*g,s.vx-=p*(g=1-g),s.vy-=v*g)}}}function s(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var n,o,i=e.length;for(r=new Array(i),n=0;n<i;++n)o=e[n],r[o.index]=+t(o,n,e)}}return"function"!=typeof t&&(t=B(null==t?1:+t)),a.initialize=function(t,r){e=t,n=r,u()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(o=+t,a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),u(),a):t},a}function Dt(t){var e,r,n,o=B(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=B(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:B(+t),a(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),a(),i):t},i}function Ot(t){var e,r,n,o=B(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=B(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:B(+t),a(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),a(),i):t},i}function Pt(){function t(t){return function(){return t}}var e,r=function(t){return t.cluster},n=t(1),o=t(-1),i=t(100),a=t(.1),u=[0,0],d=[],h={},c=[],l=100,f=100,g={none:{x:0,y:0}},p=[],v="force",y=!0,m=.1;function w(t){if(!y)return w;e.tick(),E();for(var n=0,o=d.length,i=void 0,a=t*m;n<o;++n)(i=d[n]).vx+=(g[r(i)].x-i.x)*a,i.vy+=(g[r(i)].y-i.y)*a}function x(){d&&function(){if(d&&d.length){if(void 0===r(d[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy(\'clusterAttr\') before calling .links()");var t,u,g,v,y,m=(t=[],u=[],g={},{},y=[],v=function(t){var e={};return t.forEach((function(t){var n=r(t);e[n]||(e[n]={count:0,sumforceNodeSize:0})})),t.forEach((function(t){var o=r(t),i=n(t),a=e[o];a.count=a.count+1,a.sumforceNodeSize=a.sumforceNodeSize+Math.PI*(i*i)*1.3,e[o]=a})),e}(d),y=function(t){var e={},n=[];return t.forEach((function(t){var n,o,i,a,s,u=(o=(n=t).source,i=n.target,(a=r(h[o]))<=(s=r(h[i]))?a+"~"+s:s+"~"+a),d=0;void 0!==e[u]&&(d=e[u]),d+=1,e[u]=d})),Object.entries(e).forEach((function(t){var e=s(t,2),r=e[0],o=e[1],i=r.split("~")[0],a=r.split("~")[1];void 0!==i&&void 0!==a&&n.push({source:i,target:a,count:o})})),n}(c),Object.keys(v).forEach((function(e,r){var n=v[e];t.push({id:e,size:n.count,r:Math.sqrt(n.sumforceNodeSize/Math.PI)}),g[e]=r})),y.forEach((function(t){var e=t.source,r=t.target,n=g[e],o=g[r];void 0!==n&&void 0!==o&&u.push({source:n,target:o,count:t.count})})),{nodes:t,links:u});e=Nt(m.nodes).force("x",Dt(l).strength(.1)).force("y",Ot(f).strength(.1)).force("collide",_t((function(t){return t.r})).iterations(4)).force("charge",Mt().strength(o)).force("links",At(m.nodes.length?m.links:[]).distance(i).strength(a)),p=e.nodes(),E()}}()}function E(){return g={none:{x:0,y:0}},p.forEach((function(t){g[t.id]={x:t.x-u[0],y:t.y-u[1]}})),g}return w.initialize=function(t){d=t,x()},w.template=function(t){return arguments.length?(v=t,x(),w):v},w.groupBy=function(t){return arguments.length?"string"==typeof t?(r=function(e){return e[t]},w):(r=t,w):r},w.enableGrouping=function(t){return arguments.length?(y=t,w):y},w.strength=function(t){return arguments.length?(m=t,w):m},w.centerX=function(t){return arguments.length?(l=t,w):l},w.centerY=function(t){return arguments.length?(f=t,w):f},w.nodes=function(t){return arguments.length?(function(t){h={},t.forEach((function(t){h[t.id]=t}))}(t||[]),d=t||[],w):d},w.links=function(t){return arguments.length?(c=t||[],x(),w):c},w.forceNodeSize=function(e){return arguments.length?(n="function"==typeof e?e:t(+e),x(),w):n},w.nodeSize=w.forceNodeSize,w.forceCharge=function(e){return arguments.length?(o="function"==typeof e?e:t(+e),x(),w):o},w.forceLinkDistance=function(e){return arguments.length?(i="function"==typeof e?e:t(+e),x(),w):i},w.forceLinkStrength=function(e){return arguments.length?(a="function"==typeof e?e:t(+e),x(),w):a},w.offset=function(t){return arguments.length?(u=t,w):u},w.getFocis=E,w}var Tt={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},zt=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="d3force",this.options=n(n({},Tt),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){var t;null===(t=this.forceSimulation)||void 0===t||t.stop()},t.prototype.tick=function(t){var e=this;void 0===t&&(t=1),this.forceSimulation.tick(t);var r={nodes:Ct(this.lastLayoutNodes),edges:Lt(this.lastLayoutEdges)};return this.lastAssign&&r.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,g,p,v,y,m,w,x,E,N,M,S,k,A,R,I,_,D,O=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=i.map((function(t){var e,r;return n(n({},b(t)),{x:null===(e=t.data)||void 0===e?void 0:e.x,y:null===(r=t.data)||void 0===r?void 0:r.y})})),d=s.map((function(t){return b(t)})),this.lastLayoutNodes=u,this.lastLayoutEdges=d,this.lastAssign=t,this.lastGraph=e,h=o.alphaMin,c=o.alphaDecay,l=o.alpha,f=o.nodeStrength,g=o.edgeStrength,p=o.linkDistance,v=o.clustering,y=o.clusterFociStrength,m=o.clusterEdgeDistance,w=o.clusterEdgeStrength,x=o.clusterNodeStrength,E=o.clusterNodeSize,N=o.collideStrength,M=void 0===N?1:N,S=o.center,k=void 0===S?[0,0]:S,A=o.preventOverlap,R=o.nodeSize,I=o.nodeSpacing,_=o.onTick,D=o.forceSimulation,[2,new Promise((function(r){if(D){v&&((i=Pt()).nodes(u),i.links(d)),D.nodes(u),d&&(s=At().id((function(t){return t.id})).links(d),g&&s.strength(g),p&&s.distance(p),D.force("link",s)),A&&O.overlapProcess(D,{nodeSize:R,nodeSpacing:I,collideStrength:M}),D.alpha(l).restart();var n=Ct(u),o=Lt(d);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:o})}else try{var i,a=Mt();if(f&&a.strength(f),D=Nt().nodes(u),v&&((i=Pt()).centerX(k[0]).centerY(k[1]).template("force").strength(y),d&&i.links(d),u&&i.nodes(u),i.forceLinkDistance(m).forceLinkStrength(w).forceCharge(x).forceNodeSize(E),D.force("group",i)),D.force("center",function(t,e){var r,n=1;function o(){var o,i,a=r.length,s=0,u=0;for(o=0;o<a;++o)s+=(i=r[o]).x,u+=i.y;for(s=(s/a-t)*n,u=(u/a-e)*n,o=0;o<a;++o)(i=r[o]).x-=s,i.y-=u}return null==t&&(t=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(n=+t,o):n},o}(k[0],k[1])).force("charge",a).alpha(l).alphaDecay(c).alphaMin(h),A&&O.overlapProcess(D,{nodeSize:R,nodeSpacing:I,collideStrength:M}),d){var s=At().id((function(t){return t.id})).links(d);g&&s.strength(g),p&&s.distance(p),D.force("link",s)}D.on("tick",(function(){var r=Ct(u);null==_||_({nodes:r,edges:Lt(d)}),t&&r.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}))})).on("end",(function(){var n=Ct(u);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:Lt(d)})}))}catch(t){console.warn(t)}O.forceSimulation=D}))]}))}))},t.prototype.overlapProcess=function(t,e){var r,n,o=e.nodeSize,i=e.nodeSpacing,a=e.collideStrength;if(n=x(i)?function(){return i}:N(i)?i:function(){return 0},o)if(N(o))r=function(t){return o(t)+n(t)};else if(g(o)){var s=(o[0]>o[1]?o[0]:o[1])/2;r=function(t){return s+n(t)}}else if(x(o)){var u=o/2;r=function(t){return u+n(t)}}else r=function(){return 10};else r=function(t){return t.size?g(t.size)?(t.size[0]>t.size[1]?t.size[0]:t.size[1])/2+n(t):M(t.size)?(t.size.width>t.size.height?t.size.width:t.size.height)/2+n(t):t.size/2+n(t):10+n(t)};t.force("collisionForce",_t(r).strength(a))},t}(),Ct=function(t){return t.map((function(t){var e=t.x,r=t.y,i=o(t,["x","y"]);return n(n({},i),{data:n(n({},i.data),{x:e,y:r})})}))},Lt=function(t){return t.map((function(t){var e=t.source,r=t.target,i=o(t,["source","target"]);return n(n({},i),{source:e.id,target:r.id})}))};var qt=function(t,e){if("next"!==t&&"prev"!==t)return e},jt=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(function(){function t(){var t={};t.prev=t,t.next=t.prev,this.shortcut=t}return t.prototype.dequeue=function(){var t=this.shortcut,e=t.prev;if(e&&e!==t)return jt(e),e},t.prototype.enqueue=function(t){var e=this.shortcut;t.prev&&t.next&&jt(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e},t.prototype.toString=function(){for(var t=[],e=this.shortcut,r=e.prev;r!==e;)t.push(JSON.stringify(r,qt)),r=null==r?void 0:r.prev;return"["+t.join(", ")+"]"},t}()),Vt=function(){return 1},Gt=function(t,e,r,o,i){var a,s,u=[];return t.hasNode(o.v)&&(null===(a=t.getRelatedEdges(o.v,"in"))||void 0===a||a.forEach((function(o){var a=o.data.weight,s=t.getNode(o.source);i&&u.push({v:o.source,w:o.target,in:0,out:0}),void 0===s.data.out&&(s.data.out=0),s.data.out-=a,Wt(e,r,n({v:s.id},s.data))})),null===(s=t.getRelatedEdges(o.v,"out"))||void 0===s||s.forEach((function(o){var i=o.data.weight,a=o.target,s=t.getNode(a);void 0===s.data.in&&(s.data.in=0),s.data.in-=i,Wt(e,r,n({v:s.id},s.data))})),t.removeNode(o.v)),i?u:void 0},Wt=function(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},Bt=function(t,e){var r="greedy"===e?function(t,e){var r;if(t.getAllNodes().length<=1)return[];var o=function(t,e){var r=new l,o=0,i=0;t.getAllNodes().forEach((function(t){r.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((function(t){var a=r.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target})),s=(null==e?void 0:e(t))||1;a?r.updateEdgeData(null==a?void 0:a.id,n(n({},a.data),{weight:a.data.weight+s})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:s}}),i=Math.max(i,r.getNode(t.source).data.out+=s),o=Math.max(o,r.getNode(t.target).data.in+=s)}));for(var a=[],s=i+o+3,u=0;u<s;u++)a.push(new Ft);var d=o+1;return r.getAllNodes().forEach((function(t){Wt(a,d,n({v:t.id},r.getNode(t.id).data))})),{buckets:a,zeroIdx:d,graph:r}}(t,function(t){return t.data.weight||1}||Vt);return null===(r=function(t,e,r){for(var n,o=[],i=e[e.length-1],a=e[0];t.getAllNodes().length;){for(;n=a.dequeue();)Gt(t,e,r,n);for(;n=i.dequeue();)Gt(t,e,r,n);if(t.getAllNodes().length)for(var s=e.length-2;s>0;--s)if(n=e[s].dequeue()){o=o.concat(Gt(t,e,r,n,!0));break}}return o}(o.graph,o.buckets,o.zeroIdx).map((function(e){return t.getRelatedEdges(e.v,"out").filter((function(t){return t.target===e.w}))})))||void 0===r?void 0:r.flat()}(t):$t(t);null==r||r.forEach((function(e){var r=e.data;t.removeEdge(e.id),r.forwardName=e.data.name,r.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:n({},r)})}))},$t=function(t){var e=[],r={},n={},o=function(i){n[i]||(n[i]=!0,r[i]=!0,t.getRelatedEdges(i,"out").forEach((function(t){r[t.target]?e.push(t):o(t.target)})),delete r[i])};return t.getAllNodes().forEach((function(t){return o(t.id)})),e},Ut=function(t,e,r,n){var o;do{o=""+n+Math.random()}while(t.hasNode(o));return r.dummy=e,t.addNode({id:o,data:r}),o},Ht=function(t){var e=new l;return t.getAllNodes().forEach((function(r){t.getChildren(r.id).length||e.addNode(n({},r))})),t.getAllEdges().forEach((function(t){e.addEdge(t)})),e},Kt=function(t,e){var r,n,o=Number(t.x),i=Number(t.y),a=Number(e.x)-o,s=Number(e.y)-i,u=Number(t.width)/2,d=Number(t.height)/2;return a||s?(Math.abs(s)*u>Math.abs(a)*d?(s<0&&(d=-d),r=d*a/s,n=d):(a<0&&(u=-u),r=u,n=u*s/a),{x:o+r,y:i+n}):{x:0,y:0}},Yt=function(t){for(var e=[],r=Xt(t)+1,n=0;n<r;n++)e.push([]);for(t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)})),n=0;n<r;n++)e[n]=e[n].sort((function(e,r){return n=t.getNode(e).data.order,o=t.getNode(r).data.order,Number(n)-Number(o);var n,o}));return e},Jt=function(t,e,r,n){var o={width:0,height:0};return x(r)&&x(n)&&(o.rank=r,o.order=n),Ut(t,"border",o,e)},Xt=function(t){var e;return t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)})),e||(e=0),e},Qt=function(t,e){return t.reduce((function(t,r){return e(t)>e(r)?r:t}))},Zt=function(t,e,r,n,o,i){n.includes(e.id)||(n.push(e.id),r||i.push(e.id),o(e.id).forEach((function(e){return Zt(t,e,r,n,o,i)})),r&&i.push(e.id))},te=function(t,e,r,n){var o=Array.isArray(e)?e:[e],i=function(e){return n?t.getSuccessors(e):t.getNeighbors(e)},a=[],s=[];return o.forEach((function(e){if(!t.hasNode(e.id))throw new Error("Graph does not have node: "+e);Zt(t,e,"post"===r,s,i,a)})),a},ee="edge-label",re=function(t){var e={},r=function(n){var o,i,a=t.getNode(n);return a?e[n]?a.data.rank:(e[n]=!0,null===(o=t.getRelatedEdges(n,"out"))||void 0===o||o.forEach((function(t){var e=r(t.target)-t.data.minlen;e&&(void 0===i||e<i)&&(i=e)})),i||(i=0),a.data.rank=i,i):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){return r(t.id)}))},ne=function(t,e){return t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen},oe=function(t,e){var r=function(n){e.getRelatedEdges(n,"both").forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ie=function(t,e){var r=function(n){var o;null===(o=e.getRelatedEdges(n,"both"))||void 0===o||o.forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||void 0===e.getNode(a).data.layer&&ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ae=function(t,e){return Qt(e.getAllEdges(),(function(r){return t.hasNode(r.source)!==t.hasNode(r.target)?ne(e,r):1/0}))},se=function(t,e,r){t.getAllNodes().forEach((function(t){var n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r}))},ue=function(t,e){var r=te(t,t.getAllNodes(),"post",!1);(r=r.slice(0,(null==r?void 0:r.length)-1)).forEach((function(r){de(t,e,r)}))},de=function(t,e,r){var n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find((function(t){return t.target===n||t.source===n})).data.cutvalue=he(t,e,r)},he=function(t,e,r){var n=t.getNode(r).data.parent,o=!0,i=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),a=0;return i||(o=!1,i=e.getRelatedEdges(n,"out").find((function(t){return t.target===r}))),a=i.data.weight,e.getRelatedEdges(r,"both").forEach((function(e){var i=e.source===r,s=i?e.target:e.source;if(s!==n){var u=i===o,d=e.data.weight;if(a+=u?d:-d,ye(t,r,s)){var h=t.getRelatedEdges(r,"both").find((function(t){return t.source===s||t.target===s})).data.cutvalue;a+=u?-h:h}}})),a},ce=function(t,e){void 0===e&&(e=t.getAllNodes()[0].id),le(t,{},1,e)},le=function(t,e,r,n,o){var i,a=r,s=r,u=t.getNode(n);return e[n]=!0,null===(i=t.getNeighbors(n))||void 0===i||i.forEach((function(r){e[r.id]||(s=le(t,e,s,r.id,n))})),u.data.low=a,u.data.lim=s++,o?u.data.parent=o:delete u.data.parent,s},fe=function(t){return t.getAllEdges().find((function(t){return t.data.cutvalue<0}))},ge=function(t,e,r){var n=r.source,o=r.target;e.getRelatedEdges(n,"out").find((function(t){return t.target===o}))||(n=r.target,o=r.source);var i=t.getNode(n),a=t.getNode(o),s=i,u=!1;i.data.lim>a.data.lim&&(s=a,u=!0);var d=e.getAllEdges().filter((function(e){return u===me(t.getNode(e.source),s)&&u!==me(t.getNode(e.target),s)}));return Qt(d,(function(t){return ne(e,t)}))},pe=function(t,e,r,n){var o=t.getRelatedEdges(r.source,"both").find((function(t){return t.source===r.target||t.target===r.target}));o&&t.removeEdge(o.id),t.addEdge({id:"e"+Math.random(),source:n.source,target:n.target,data:{}}),ce(t),ue(t,e),ve(t,e)},ve=function(t,e){var r=t.getAllNodes().find((function(t){return!t.data.parent})),n=te(t,r,"pre",!1);(n=n.slice(1)).forEach((function(r){var n=t.getNode(r).data.parent,o=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),i=!1;!o&&e.hasNode(n)&&(o=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),i=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(i?null==o?void 0:o.data.minlen:-(null==o?void 0:o.data.minlen))}))},ye=function(t,e,r){return t.getRelatedEdges(e,"both").find((function(t){return t.source===r||t.target===r}))},me=function(t,e){return e.data.low<=t.data.lim&&t.data.lim<=e.data.lim},we=re,xe=function(t){!function(t){var e=function(t){var e=new l;return t.getAllNodes().forEach((function(t){e.addNode(n({},t))})),t.getAllEdges().forEach((function(t){var r=e.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target}));r?e.updateEdgeData(null==r?void 0:r.id,n(n({},r.data),{weight:r.data.weight+t.data.weight||0,minlen:Math.max(r.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e}(t);re(e);var r,o,i=function(t){var e,r,n=new l({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);oe(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r);return n}(e);for(ce(i),ue(i,e);r=fe(i);)o=ge(i,e,r),pe(i,e,r,o)}(t)},Ee=function(t,e,r,n,o,i,a){var s=t.getChildren(a);if(null==s?void 0:s.length){var u=Jt(t,"_bt"),d=Jt(t,"_bb"),h=t.getNode(a);t.setParent(u,a),h.data.borderTop=u,t.setParent(d,a),h.data.borderBottom=d,null==s||s.forEach((function(s){Ee(t,e,r,n,o,i,s.id);var h=s.data.borderTop?s.data.borderTop:s.id,c=s.data.borderBottom?s.data.borderBottom:s.id,l=s.data.borderTop?n:2*n,f=h!==c?1:o-i[a]+1;t.addEdge({id:"e"+Math.random(),source:u,target:h,data:{minlen:f,weight:l,nestingEdge:!0}}),t.addEdge({id:"e"+Math.random(),source:c,target:d,data:{minlen:f,weight:l,nestingEdge:!0}})})),t.getParent(a)||t.addEdge({id:"e"+Math.random(),source:e,target:u,data:{weight:0,minlen:o+i[a]}})}else a!==e&&t.addEdge({id:"e"+Math.random(),source:e,target:a,data:{weight:0,minlen:r}})},be=function(t,e,r,n,o,i){var a={rank:i,borderType:e,width:0,height:0},s=o.data[e][i-1],u=Ut(t,"border",a,r);o.data[e][i]=u,t.setParent(u,n),s&&t.addEdge({id:"e"+Math.random(),source:s,target:u,data:{weight:1}})},Ne=function(t){t.getAllNodes().forEach((function(t){Me(t)})),t.getAllEdges().forEach((function(t){Me(t)}))},Me=function(t){var e=t.data.width;t.data.width=t.data.height,t.data.height=e},Se=function(t){(null==t?void 0:t.y)&&(t.y=-t.y)},ke=function(t){var e=t.x;t.x=t.y,t.y=e},Ae=function(t){for(var e={},r=t.getAllNodes(),n=r.map((function(t){var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),o=Math.max.apply(Math,u([],s(n))),i=[],a=0;a<o+1;a++)i.push([]);var d=r.sort((function(e,r){return t.getNode(e.id).data.rank-t.getNode(r.id).data.rank})),h=d.filter((function(e){return void 0!==t.getNode(e.id).data.fixorder})).sort((function(e,r){return t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder}));return null==h||h.forEach((function(r){isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0})),null==d||d.forEach((function(r){return t.dfsTree(r.id,(function(t){if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)}))})),i},Re=function(t,e,r){for(var n=function(t,e){return null==t?void 0:t.reduce((function(t,r,n){return t[r]=e[n],t}),{})}(r,r.map((function(t,e){return e}))),o=e.map((function(e){var r=t.getRelatedEdges(e,"out").map((function(t){return{pos:n[t.target]||0,weight:t.data.weight}}));return null==r?void 0:r.sort((function(t,e){return t.pos-e.pos}))})),i=o.flat().filter((function(t){return void 0!==t})),a=1;a<r.length;)a<<=1;var s=2*a-1;a-=1;var u=Array(s).fill(0,0,s),d=0;return null==i||i.forEach((function(t){if(t){var e=t.pos+a;u[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=u[e+1]),u[e=e-1>>1]+=t.weight;d+=t.weight*r}})),d},Ie=function(t,e){for(var r=0,n=1;n<(null==e?void 0:e.length);n+=1)r+=Re(t,e[n-1],e[n]);return r},_e=function(t,e){var r,n=0,o=0;t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/o,t.weight=o,t.i=Math.min(e.i,t.i),e.merged=!0};const De=function(t,e){var r,n,o,i={};return null==t||t.forEach((function(t,e){i[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};var r=i[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)})),null===(r=e.getAllEdges())||void 0===r||r.forEach((function(t){var e=i[t.source],r=i[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(i[t.target]))})),function(t){for(var e,r,n=[],o=function(){var o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach((function(t){return(e=o,function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&_e(e,t)})(t);var e})),null===(r=o.out)||void 0===r||r.forEach((function(e){return(r=o,function(e){e.in.push(r),0==--e.indegree&&t.push(e)})(e);var r}))};null==t?void 0:t.length;)o();var i=n.filter((function(t){return!t.merged})),a=["vs","i","barycenter","weight"];return i.map((function(t){var e={};return null==a||a.forEach((function(r){void 0!==t[r]&&(e[r]=t[r])})),e}))}(null===(o=(n=Object.values(i)).filter)||void 0===o?void 0:o.call(n,(function(t){return!t.indegree})))};var Oe=function(t,e,r){for(var n,o=r;e.length&&(n=e[e.length-1]).i<=o;)e.pop(),null==t||t.push(n.vs),o++;return o},Pe=function(t,e,r,n,o,i){var a,s,u,d,h=t.getChildren(e).map((function(t){return t.id})),c=t.getNode(e),l=c?c.data.borderLeft:void 0,f=c?c.data.borderRight:void 0,g={};l&&(h=null==h?void 0:h.filter((function(t){return t!==l&&t!==f})));var p=function(t,e){return e.map((function(e){var r=t.getRelatedEdges(e,"in");if(!(null==r?void 0:r.length))return{v:e};var n={sum:0,weight:0};return null==r||r.forEach((function(e){var r=t.getNode(e.source);n.sum+=e.data.weight*r.data.order,n.weight+=e.data.weight})),{v:e,barycenter:n.sum/n.weight,weight:n.weight}}))}(t,h||[]);null==p||p.forEach((function(e){var o;if(null===(o=t.getChildren(e.v))||void 0===o?void 0:o.length){var a=Pe(t,e.v,r,n,i);g[e.v]=a,a.hasOwnProperty("barycenter")&&ze(e,a)}}));var v=De(p,r);Te(v,g),null===(a=v.filter((function(t){return t.vs.length>0})))||void 0===a||a.forEach((function(e){var r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)}));var y=function(t,e,r,n){var o=function(t,e){var r={lhs:[],rhs:[]};return null==t||t.forEach((function(t){var e,o;o=(e=t).hasOwnProperty("fixorder")&&!isNaN(e.fixorder),(n?!o&&e.hasOwnProperty("barycenter"):o||e.hasOwnProperty("barycenter"))?r.lhs.push(t):r.rhs.push(t)})),r}(t),i=o.lhs,a=o.rhs.sort((function(t,e){return-t.i- -e.i})),s=[],u=0,d=0,h=0;null==i||i.sort(function(t,e){return function(r,n){if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i}}(!!e,!!r)),h=Oe(s,a,h),null==i||i.forEach((function(t){var e;h+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),u+=t.barycenter*t.weight,d+=t.weight,h=Oe(s,a,h)}));var c={vs:s.flat()};return d&&(c.barycenter=u/d,c.weight=d),c}(v,n,o,i);if(l&&(y.vs=[l,y.vs,f].flat(),null===(s=t.getPredecessors(l))||void 0===s?void 0:s.length)){var m=t.getNode((null===(u=t.getPredecessors(l))||void 0===u?void 0:u[0].id)||""),w=t.getNode((null===(d=t.getPredecessors(f))||void 0===d?void 0:d[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+w.data.order)/(y.weight+2),y.weight+=2}return y},Te=function(t,e){null==t||t.forEach((function(t){var r,n=null===(r=t.vs)||void 0===r?void 0:r.map((function(t){return e[t]?e[t].vs:t}));t.vs=n.flat()}))},ze=function(t,e){void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},Ce=function(t){if("object"!=typeof t||null===t)return t;var e,r;if(r=t,Array.isArray?Array.isArray(r):w(r,"Array")){e=[];for(var n=0,o=t.length;n<o;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=Ce(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=Ce(t[i]):e[i]=t[i];return e};const Le=Ce;var qe=function(t,e,r){return e.map((function(e){return function(t,e,r){var o=function(t){for(var e;t.hasNode(e="_root"+Math.random()););return e}(t),i=new l({tree:[{id:o,children:[],data:{}}]});return t.getAllNodes().forEach((function(a){var s=t.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(n({},a)),(null==s?void 0:s.id)&&!i.hasNode(null==s?void 0:s.id)&&i.addNode(n({},s)),i.setParent(a.id,(null==s?void 0:s.id)||o),t.getRelatedEdges(a.id,r).forEach((function(e){var r=e.source===a.id?e.target:e.source;i.hasNode(r)||i.addNode(n({},t.getNode(r)));var o=i.getRelatedEdges(r,"out").find((function(t){return t.target===a.id})),s=void 0!==o?o.data.weight:0;o?i.updateEdgeData(o.id,n(n({},o.data),{weight:e.data.weight+s})):i.addEdge({id:e.id,source:r,target:a.id,data:{weight:e.data.weight+s}})})),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,n(n({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))})),i}(t,e,r)}))},je=function(t,e,r,n){var o=new l;null==t||t.forEach((function(t){for(var i,a=t.getRoots()[0].id,s=Pe(t,a,o,e,r,n),u=0;u<(null===(i=s.vs)||void 0===i?void 0:i.length);u++){var d=t.getNode(s.vs[u]);d&&(d.data.order=u)}!function(t,e,r){var n,o={};null==r||r.forEach((function(r){for(var i,a,s=t.getParent(r);s;){if((i=t.getParent(s.id))?(a=o[i.id],o[i.id]=s.id):(a=n,n=s.id),a&&a!==s.id)return e.addNodes([{id:a,data:{}},{id:s.id,data:{}}]),void e.addEdge({id:"e"+a+"-"+s.id,source:a,target:s.id,data:{}});s=i}}))}(t,o,s.vs)}))},Fe=function(t,e){null==e||e.forEach((function(e){null==e||e.forEach((function(e,r){t.getNode(e).data.order=r}))}))},Ve=function(t,e){var r={};function n(e,n,o,i,a){for(var s,u,d,h=n;h<o;h++)d=e[h],(null===(s=t.getNode(d))||void 0===s?void 0:s.data.dummy)&&(null===(u=t.getPredecessors(d))||void 0===u||u.forEach((function(e){var n=t.getNode(e.id);n.data.dummy&&(n.data.order<i||n.data.order>a)&&We(r,e.id,d)})))}function o(t,e){var r=function(t){return JSON.stringify(t.slice(1))}(t);e.get(r)||(n.apply(void 0,u([],s(t))),e.set(r,!0))}return(null==e?void 0:e.length)&&e.reduce((function(e,r){var n,i=-1,a=0,s=new Map;return null==r||r.forEach((function(u,d){var h;if("border"===(null===(h=t.getNode(u))||void 0===h?void 0:h.data.dummy)){var c=t.getPredecessors(u)||[];c.length&&(n=t.getNode(c[0].id).data.order,o([r,a,d,i,n],s),a=d,i=n)}o([r,a,r.length,n,e.length],s)})),r})),r},Ge=function(t,e){var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find((function(e){return t.getNode(e.id).data.dummy}))},We=function(t,e,r){var n=e,o=r;if(n>o){var i=n;n=o,o=i}var a=t[n];a||(t[n]=a={}),a[o]=!0},Be=function(t,e,r){var n=e;return n>r&&(n=r),!!t[n]},$e=function(t,e,r,o,i,a){var s=new l,u=Ue(o,i,a);return null==e||e.forEach((function(e){var o;null==e||e.forEach((function(e){var i=r[e];if(s.hasNode(i)||s.addNode({id:i,data:{}}),o){var a=r[o],d=s.getRelatedEdges(a,"out").find((function(t){return t.target===i}));d?s.updateEdgeData(d.id,n(n({},d.data),{weight:Math.max(u(t,e,o),d.data.weight||0)})):s.addEdge({id:"e"+Math.random(),source:a,target:i,data:{weight:Math.max(u(t,e,o),0)}})}o=e}))})),s};var Ue=function(t,e,r){return function(n,o,i){var a=n.getNode(o),s=n.getNode(i),u=0,d=0;if(u+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":d=-a.data.width/2;break;case"r":d=a.data.width/2}if(d&&(u+=r?d:-d),d=0,u+=(a.data.dummy?e:t)/2,u+=(s.data.dummy?e:t)/2,u+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":d=s.data.width/2;break;case"r":d=-s.data.width/2}return d&&(u+=r?d:-d),d=0,u}},He=function(t,e){return t.getNode(e).data.width||0},Ke=function(t,e){var r,n=Ht(t);!function(t,e){var r=(e||{}).ranksep,n=void 0===r?0:r,o=Yt(t),i=0;null==o||o.forEach((function(e){var r=e.map((function(e){return t.getNode(e).data.height})),o=Math.max.apply(Math,u(u([],s(r)),[0]));null==e||e.forEach((function(e){t.getNode(e).data.y=i+o/2})),i+=o+n}))}(n,e);var o=function(t,e){var r=e||{},n=r.align,o=r.nodesep,i=void 0===o?0:o,a=r.edgesep,d=void 0===a?0:a,h=Yt(t),c=Object.assign(function(t,e){var r={};return(null==e?void 0:e.length)&&e.reduce((function(e,n){var o=0,i=0,a=e.length,s=null==n?void 0:n[(null==n?void 0:n.length)-1];return null==n||n.forEach((function(e,u){var d,h=Ge(t,e),c=h?t.getNode(h.id).data.order:a;(h||e===s)&&(null===(d=n.slice(i,u+1))||void 0===d||d.forEach((function(e){var n;null===(n=t.getPredecessors(e))||void 0===n||n.forEach((function(n){var i,a=t.getNode(n.id),s=a.data.order;!(s<o||c<s)||a.data.dummy&&(null===(i=t.getNode(e))||void 0===i?void 0:i.data.dummy)||We(r,n.id,e)}))})),i=u+1,o=c)})),n})),r}(t,h),Ve(t,h)),l={},f=[];["u","d"].forEach((function(e){f="u"===e?h:Object.values(h).reverse(),["l","r"].forEach((function(r){"r"===r&&(f=f.map((function(t){return Object.values(t).reverse()})));var n=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),o=function(t,e,r,n){var o={},i={},a={};return null==e||e.forEach((function(t){null==t||t.forEach((function(t,e){o[t]=t,i[t]=t,a[t]=e}))})),null==e||e.forEach((function(t){var e=-1;null==t||t.forEach((function(t){var s=n(t).map((function(t){return t.id}));if(s.length){s=s.sort((function(t,e){return a[t]-a[e]}));for(var u=(s.length-1)/2,d=Math.floor(u),h=Math.ceil(u);d<=h;++d){var c=s[d];i[t]===t&&e<a[c]&&!Be(r,t,c)&&(i[c]=t,i[t]=o[t]=o[c],e=a[c])}}}))})),{root:o,align:i}}(0,f,c,n),a=function(t,e,r,n,o,i,a){var s,u={},d=$e(t,e,r,o,i,a),h=a?"borderLeft":"borderRight",c=function(t,e){for(var r=d.getAllNodes(),n=r.pop(),o={};n;)o[n.id]?t(n.id):(o[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return c((function(t){u[t]=(d.getRelatedEdges(t,"in")||[]).reduce((function(t,e){return Math.max(t,(u[e.source]||0)+e.data.weight)}),0)}),d.getPredecessors.bind(d)),c((function(e){var r=(d.getRelatedEdges(e,"out")||[]).reduce((function(t,e){return Math.min(t,(u[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==h&&(u[e]=Math.max(u[e],r))}),d.getSuccessors.bind(d)),null===(s=Object.values(n))||void 0===s||s.forEach((function(t){u[t]=u[r[t]]})),u}(t,f,o.root,o.align,i,d,"r"===r);"r"===r&&Object.keys(a).forEach((function(t){return a[t]=-a[t]})),l[e+r]=a}))}));var g=function(t,e){return Qt(Object.values(e),(function(e){var r,n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach((function(r){var i=e[r],a=He(t,r)/2;n=Math.max(i+a,n),o=Math.min(i-a,o)})),n-o}))}(t,l);return g&&function(t,e){var r=Object.values(e),n=Math.min.apply(Math,u([],s(r))),o=Math.max.apply(Math,u([],s(r)));["u","d"].forEach((function(r){["l","r"].forEach((function(i){var a,d=r+i,h=t[d];if(h!==e){var c=Object.values(h);(a="l"===i?n-Math.min.apply(Math,u([],s(c))):o-Math.max.apply(Math,u([],s(c))))&&(t[d]={},Object.keys(h).forEach((function(e){t[d][e]=h[e]+a})))}}))}))}(l,g),function(t,e){var r={};return Object.keys(t.ul).forEach((function(n){if(e)r[n]=t[e.toLowerCase()][n];else{var o=Object.values(t).map((function(t){return t[n]}));r[n]=(o[0]+o[1])/2}})),r}(l,n)}(n,e);null===(r=Object.keys(o))||void 0===r||r.forEach((function(t){n.getNode(t).data.x=o[t]}))},Ye=function(t,e){var r=e.acyclicer,o=e.ranker,i=e.rankdir,a=void 0===i?"tb":i,d=e.nodeOrder,h=e.keepNodeOrder,c=e.align,f=e.nodesep,g=void 0===f?50:f,p=e.edgesep,v=void 0===p?20:p,y=e.ranksep,m=void 0===y?50:y;dr(t),Bt(t,r);var w=function(t){var e=Ut(t,"root",{},"_root"),r=function(t){var e={},r=function(n,o){var i=t.getChildren(n);null==i||i.forEach((function(t){return r(t.id,o+1)})),e[n]=o};return t.getRoots().forEach((function(t){return r(t.id,1)})),e}(t),n=Math.max.apply(Math,u([],s(Object.values(r))));Math.abs(n)===1/0&&(n=1);var o=n-1,i=2*o+1;t.getAllEdges().forEach((function(t){t.data.minlen*=i}));var a=function(t){var e=0;return t.getAllEdges().forEach((function(t){e+=t.data.weight})),e}(t)+1;return t.getRoots().forEach((function(n){Ee(t,e,i,a,o,r,n.id)})),{nestingRoot:e,nodeRankFactor:i}}(t),x=w.nestingRoot,E=w.nodeRankFactor;!function(t,e){switch(e){case"network-simplex":xe(t);break;case"tight-tree":default:!function(t){!function(t){var e,r={},n=function(o){var i,a,s=t.getNode(o);return s?r[o]?s.data.rank:(r[o]=!0,null===(i=t.getRelatedEdges(o,"out"))||void 0===i||i.forEach((function(t){var e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),(void 0===e||a<e)&&(e=a),s.data.rank=a,a):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){t&&n(t.id)})),void 0===e&&(e=0);var o={},i=function(e,r){var n,a=t.getNode(e),s=isNaN(a.data.layer)?r:a.data.layer;(void 0===a.data.rank||a.data.rank<s)&&(a.data.rank=s),o[e]||(o[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach((function(t){i(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((function(t){var r=t.data;r&&(isNaN(r.layer)?r.rank-=e:i(t.id,r.layer))}))}(t),function(t){var e,r,n=new l({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);ie(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r)}(t)}(t);break;case"longest-path":we(t)}}(Ht(t),o),er(t),function(t,e){void 0===e&&(e=0);var r=t.getAllNodes(),n=r.filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),o=Math.min.apply(Math,u([],s(n))),i=[];r.forEach((function(t){var e=(t.data.rank||0)-o;i[e]||(i[e]=[]),i[e].push(t.id)}));for(var a=0,d=0;d<i.length;d++){var h=i[d];void 0===h?d%e!=0&&(a-=1):a&&(null==h||h.forEach((function(e){var r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=a)})))}}(t,E),function(t,e){e&&t.removeNode(e),t.getAllEdges().forEach((function(e){e.data.nestingEdge&&t.removeEdge(e.id)}))}(t,x),function(t){var e=t.getAllNodes().filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),r=Math.min.apply(Math,u([],s(e)));t.getAllNodes().forEach((function(t){t.data.hasOwnProperty("rank")&&r!==1/0&&(t.data.rank-=r)}))}(t),rr(t),nr(t);var b=[];!function(t,e){t.getAllEdges().forEach((function(r){return function(t,e,r){var n=e.source,o=t.getNode(n).data.rank,i=e.target,a=t.getNode(i).data.rank,s=e.data.labelRank;if(a!==o+1){var u,d,h;for(t.removeEdge(e.id),h=0,++o;o<a;++h,++o)e.data.points=[],u=Ut(t,"edge",d={originalEdge:e,width:0,height:0,rank:o},"_d"),o===s&&(d.width=e.data.width,d.height=e.data.height,d.dummy=ee,d.labelpos=e.data.labelpos),t.addEdge({id:"e"+Math.random(),source:n,target:u,data:{weight:e.data.weight}}),0===h&&r.push(u),n=u;t.addEdge({id:"e"+Math.random(),source:n,target:i,data:{weight:e.data.weight}})}}(t,r,e)}))}(t,b),function(t,e){var r=function(t){var e={},r=0,n=function(o){var i=r;t.getChildren(o).forEach((function(t){return n(t.id)})),e[o]={low:i,lim:r++}};return t.getRoots().forEach((function(t){return n(t.id)})),e}(t);e.forEach((function(e){var n,o,i=e,a=t.getNode(i),s=a.data.originalEdge;if(s)for(var u=function(t,e,r,n){var o,i,a,s,u=[],d=[],h=Math.min(e[r].low,e[n].low),c=Math.max(e[r].lim,e[n].lim);a=r;do{a=null===(o=t.getParent(a))||void 0===o?void 0:o.id,u.push(a)}while(a&&(e[a].low>h||c>e[a].lim));for(s=a,a=n;a&&a!==s;)d.push(a),a=null===(i=t.getParent(a))||void 0===i?void 0:i.id;return{lca:s,path:u.concat(d.reverse())}}(t,r,s.source,s.target),d=u.path,h=u.lca,c=0,l=d[c],f=!0;i!==s.target;){if(a=t.getNode(i),f){for(;l!==h&&(null===(n=t.getNode(l))||void 0===n?void 0:n.data.maxRank)<a.data.rank;)l=d[++c];l===h&&(f=!1)}if(!f){for(;c<d.length-1&&(null===(o=t.getNode(d[c+1]))||void 0===o?void 0:o.data.minRank)<=a.data.rank;)c++;l=d[c]}t.hasNode(l)&&t.setParent(i,l),i=t.getSuccessors(i)[0].id}}))}(t,b),function(t){var e=function(r){var n=t.getChildren(r),o=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach((function(t){return e(t.id)})),o.data.hasOwnProperty("minRank")){o.data.borderLeft=[],o.data.borderRight=[];for(var i=o.data.minRank,a=o.data.maxRank+1;i<a;i+=1)be(t,"borderLeft","_bl",r,o,i),be(t,"borderRight","_br",r,o,i)}};t.getRoots().forEach((function(t){return e(t.id)}))}(t),h&&function(t,e){for(var r=t.getAllNodes().filter((function(e){var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)})).map((function(t){return t.data.rank})),n=Math.max.apply(Math,u([],s(r))),o=[],i=0;i<n+1;i++)o[i]=[];null==e||e.forEach((function(e){var r=t.getNode(e);r&&!r.data.dummy&&(isNaN(r.data.rank)||(r.data.fixorder=o[r.data.rank].length,o[r.data.rank].push(e)))}))}(t,d),function(t,e){for(var r=Xt(t),n=[],o=[],i=1;i<r+1;i++)n.push(i);for(i=r-1;i>-1;i--)o.push(i);var a=qe(t,n,"in"),s=qe(t,o,"out"),u=Ae(t);Fe(t,u);for(var d,h=Number.POSITIVE_INFINITY,c=(i=0,0);c<4;++i,++c)je(i%2?a:s,i%4>=2,!1,e),u=Yt(t),(l=Ie(t,u))<h&&(c=0,d=Le(u),h=l);for(u=Ae(t),Fe(t,u),i=0,c=0;c<4;++i,++c){var l;je(i%2?a:s,i%4>=2,!0,e),u=Yt(t),(l=Ie(t,u))<h&&(c=0,d=Le(u),h=l)}Fe(t,d)}(t,h),hr(t),function(t,e){var r=e.toLowerCase();"lr"!==r&&"rl"!==r||Ne(t)}(t,a),Ke(t,{align:c,nodesep:g,edgesep:v,ranksep:m}),cr(t),ur(t),function(t,e){e.forEach((function(e){var r,n=t.getNode(e),o=n.data.originalEdge;o&&t.addEdge(o);for(var i=e;n.data.dummy;)r=t.getSuccessors(i)[0],t.removeNode(i),o.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===ee&&(o.data.x=n.data.x,o.data.y=n.data.y,o.data.width=n.data.width,o.data.height=n.data.height),i=r.id,n=t.getNode(i)}))}(t,b),ar(t),function(t,e){var r=e.toLowerCase();"bt"!==r&&"rl"!==r||function(t){t.getAllNodes().forEach((function(t){Se(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return Se(t)})),t.data.hasOwnProperty("y")&&Se(t.data)}))}(t),"lr"!==r&&"rl"!==r||(function(t){t.getAllNodes().forEach((function(t){ke(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return ke(t)})),t.data.hasOwnProperty("x")&&ke(t.data)}))}(t),Ne(t))}(t,a);var N=or(t),M=N.width,S=N.height;return ir(t),sr(t),function(t){t.getAllEdges().forEach((function(e){var r=e.data;if(r.reversed){t.removeEdge(e.id);var o=r.forwardName;delete r.reversed,delete r.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:n(n({},r),{forwardName:o})})}}))}(t),{width:M,height:S}},Je=["width","height","layer","fixorder"],Xe={width:0,height:0},Qe=["minlen","weight","width","height","labeloffset"],Ze={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},tr=["labelpos"],er=function(t){t.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var r=t.getNode(e.source),n={e,rank:(t.getNode(e.target).data.rank-r.data.rank)/2+r.data.rank};Ut(t,"edge-proxy",n,"_ep")}}))},rr=function(t){var e=0;return t.getAllNodes().forEach((function(r){var n,o;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(o=t.getNode(r.data.borderBottom))||void 0===o?void 0:o.data.rank,e=Math.max(e,r.data.maxRank||-1/0))})),e},nr=function(t){t.getAllNodes().forEach((function(e){"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},or=function(t,e){var r,n,o=0,i=0,a=e||{},s=a.marginx,u=void 0===s?0:s,d=a.marginy,h=void 0===d?0:d,c=function(t){if(t.data){var e=t.data.x,a=t.data.y,s=t.data.width,u=t.data.height;isNaN(e)||isNaN(s)||(void 0===r&&(r=e-s/2),r=Math.min(r,e-s/2),o=Math.max(o,e+s/2)),isNaN(a)||isNaN(u)||(void 0===n&&(n=a-u/2),n=Math.min(n,a-u/2),i=Math.max(i,a+u/2))}};return t.getAllNodes().forEach((function(t){c(t)})),t.getAllEdges().forEach((function(t){(null==t?void 0:t.data.hasOwnProperty("x"))&&c(t)})),r-=u,n-=h,t.getAllNodes().forEach((function(t){t.data.x-=r,t.data.y-=n})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){t.x-=r,t.y-=n})),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)})),{width:o-r+u,height:i-n+h}},ir=function(t){t.getAllEdges().forEach((function(e){var r,n,o=t.getNode(e.source),i=t.getNode(e.target);e.data.points?(r=e.data.points[0],n=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:i.data.x,y:i.data.y},n={x:o.data.x,y:o.data.y}),e.data.points.unshift(Kt(o.data,r)),e.data.points.push(Kt(i.data,n))}))},ar=function(t){t.getAllEdges().forEach((function(t){if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},sr=function(t){t.getAllEdges().forEach((function(t){var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},ur=function(t){t.getAllNodes().forEach((function(e){var r,n,o;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){var i=t.getNode(e.id),a=t.getNode(i.data.borderTop),s=t.getNode(i.data.borderBottom),u=t.getNode(i.data.borderLeft[(null===(n=i.data.borderLeft)||void 0===n?void 0:n.length)-1]),d=t.getNode(i.data.borderRight[(null===(o=i.data.borderRight)||void 0===o?void 0:o.length)-1]);i.data.width=Math.abs((null==d?void 0:d.data.x)-(null==u?void 0:u.data.x))||10,i.data.height=Math.abs((null==s?void 0:s.data.y)-(null==a?void 0:a.data.y))||10,i.data.x=((null==u?void 0:u.data.x)||0)+i.data.width/2,i.data.y=((null==a?void 0:a.data.y)||0)+i.data.height/2}})),t.getAllNodes().forEach((function(e){"border"===e.data.dummy&&t.removeNode(e.id)}))},dr=function(t){t.getAllEdges().forEach((function(e){if(e.source===e.target){var r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}}))},hr=function(t){var e=Yt(t);null==e||e.forEach((function(e){var r=0;null==e||e.forEach((function(e,n){var o,i=t.getNode(e);i.data.order=n+r,null===(o=i.data.selfEdges)||void 0===o||o.forEach((function(e){Ut(t,"selfedge",{width:e.data.width,height:e.data.height,rank:i.data.rank,order:n+ ++r,e},"_se")})),delete i.data.selfEdges}))}))},cr=function(t){t.getAllNodes().forEach((function(e){var r=t.getNode(e.id);if("selfedge"===r.data.dummy){var n=t.getNode(r.data.e.source),o=n.data.x+n.data.width/2,i=n.data.y,a=r.data.x-o,s=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}}))},lr=function(t,e){var r={};return null==e||e.forEach((function(e){void 0!==t[e]&&(r[e]=+t[e])})),r},fr=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(r){e[r.toLowerCase()]=t[r]})),e},gr={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="dagre",this.layoutNode=function(t){return!1!==t.data.layout},this.options=n(n({},gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericDagreLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericDagreLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericDagreLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,E,N,M,k,R,I,_,D,O,P,T,z,C,L,q,j,F,V,G,W=this;return a(this,(function(a){return o=n(n({},this.options),r),i=o.nodeSize,s=o.align,u=o.rankdir,d=void 0===u?"TB":u,h=o.ranksep,c=o.nodesep,f=o.ranksepFunc,g=o.nodesepFunc,p=o.edgeLabelSpace,v=o.nodeOrder,y=o.begin,m=o.controlPoints,w=o.radial,E=new l({tree:[]}),N=S(h||50,f),M=S(c||50,g),k=M,R=N,"LR"!==d&&"RL"!==d||(k=N,R=M),I=A(i,void 0),_=e.getAllNodes(),D=e.getAllEdges(),_.filter((function(t){return!1!==t.data.layout})).forEach((function(t){var e=I(t),r=R(t),n=e+2*k(t),o=e+2*r,i=t.data.layer;x(i)?E.addNode({id:t.id,data:{width:n,height:o,layer:i}}):E.addNode({id:t.id,data:{width:n,height:o}})})),D.forEach((function(t){W.layoutNode(E.getNode(t.source))&&W.layoutNode(E.getNode(t.target))&&E.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),function(t,e){var r,o,i=e.edgeLabelSpace,a=e.keepNodeOrder,s=e.prevGraph,u=e.rankdir,d=e.ranksep;!a&&s&&(o=s,(r=t).getAllNodes().forEach((function(t){var e=r.getNode(t.id),n=o.getNode(t.id);void 0!==n?(e.data.fixorder=n.data._order,delete n.data._order):delete e.data.fixorder})));var h=function(t){var e=new l({tree:[]});return t.getAllNodes().forEach((function(r){var o=fr(t.getNode(r.id).data),i=n(n({},Xe),o),a=lr(i,Je);e.hasNode(r.id)||e.addNode({id:r.id,data:n({},a)});var s=t.getParent(r.id);null==s||(e.hasNode(s.id)||e.addNode(n({},s)),e.setParent(r.id,s.id))})),t.getAllEdges().forEach((function(r){var n=fr(t.getEdge(r.id).data),o={};null==tr||tr.forEach((function(t){void 0!==n[t]&&(o[t]=n[t])})),e.addEdge({id:r.id,source:r.source,target:r.target,data:Object.assign({},Ze,lr(n,Qe),o)})})),e}(t);!1!==i&&(e.ranksep=function(t,e){var r=e.ranksep,n=void 0===r?0:r,o=e.rankdir;return t.getAllNodes().forEach((function(t){isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((function(t){var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===o||"BT"===o?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2}(h,{rankdir:u,ranksep:d}));try{Ye(h,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph\'s structure:\\n",t);throw t}!function(t,e){t.getAllNodes().forEach((function(r){var n,o=t.getNode(r.id);if(o){var i=e.getNode(r.id);o.data.x=i.data.x,o.data.y=i.data.y,o.data._order=i.data.order,o.data._rank=i.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(o.data.width=i.data.width,o.data.height=i.data.height)}})),t.getAllEdges().forEach((function(r){var n=t.getEdge(r.id),o=e.getEdge(r.id);n.data.points=o?o.data.points:[],o&&o.data.hasOwnProperty("x")&&(n.data.x=o.data.x,n.data.y=o.data.y)}))}(t,h)}(E,{prevGraph:null,edgeLabelSpace:p,keepNodeOrder:!!v,nodeOrder:v||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:d,nodesep:c,align:s}),O=[0,0],y&&(P=1/0,T=1/0,E.getAllNodes().forEach((function(t){P>t.data.x&&(P=t.data.x),T>t.data.y&&(T=t.data.y)})),E.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){P>t.x&&(P=t.x),T>t.y&&(T=t.y)}))})),O[0]=y[0]-P,O[1]=y[1]-T),z="LR"===d||"RL"===d,w||(C=new Set,L="BT"===d||"RL"===d?function(t,e){return e-t}:function(t,e){return t-e},E.getAllNodes().forEach((function(t){t.data.x=t.data.x+O[0],t.data.y=t.data.y+O[1],C.add(z?t.data.x:t.data.y)})),q=Array.from(C).sort(L),j=z?function(t,e){return t.x!==e.x}:function(t,e){return t.y!==e.y},F=z?function(t,e,r){var n=Math.max(e.y,r.y),o=Math.min(e.y,r.y);return t.filter((function(t){return t.y<=n&&t.y>=o}))}:function(t,e,r){var n=Math.max(e.x,r.x),o=Math.min(e.x,r.x);return t.filter((function(t){return t.x<=n&&t.x>=o}))},E.getAllEdges().forEach((function(t,e){var r;p&&m&&"loop"!==t.data.type&&(t.data.controlPoints=vr(null===(r=t.data.points)||void 0===r?void 0:r.map((function(t){var e=t.x,r=t.y;return{x:e+O[0],y:r+O[1]}})),E.getNode(t.source),E.getNode(t.target),q,z,j,F))}))),V=[],V=E.getAllNodes().map((function(t){return b(t)})),G=E.getAllEdges(),t&&(V.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),G.forEach((function(t){e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),[2,{nodes:V,edges:G}]}))}))},t}(),vr=function(t,e,r,n,o,i,a){var s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){var u=e.data,d=u.x,h=u.y,c=r.data,l=c.x,f=c.y;if(o&&(d=e.data.y,h=e.data.x,l=r.data.y,f=r.data.x),f!==h&&d!==l){var g=n.indexOf(h),p=n[g+1];if(p){var v=s[0],y=o?{x:(h+p)/2,y:(null==v?void 0:v.y)||l}:{x:(null==v?void 0:v.x)||l,y:(h+p)/2};v&&!i(v,y)||s.unshift(y)}var m=n.indexOf(f),w=Math.abs(m-g);if(1===w)(s=a(s,e.data,r.data)).length||s.push(o?{x:(h+f)/2,y:d}:{x:d,y:(h+f)/2});else if(w>1){var x=n[m-1];if(x){var E=s[s.length-1],b=o?{x:(f+x)/2,y:(null==E?void 0:E.y)||l}:{x:(null==E?void 0:E.x)||d,y:(f+x)/2};E&&!i(E,b)||s.push(b)}}}}return s};function yr(t){var e=0,r=0,n=0;if(t.length){for(var o=0;o<4;o++)(i=t[o])&&i.weight&&(e+=i.weight,r+=i.x*i.weight,n+=i.y*i.weight);t.x=r/e,t.y=n/e,t.weight=e}else{var i=t;t.x=i.data.x,t.y=i.data.y,t.weight=i.data.weight}}var mr=function(t,e,r,n,o,i){var a=i.x-t.x||.1,s=i.y-t.y||.1,u=n-e,d=a*a+s*s,h=Math.sqrt(d)*d;if(u*u*.81<d){var c=t.weight/h;return i.vx+=a*c,i.vy+=s*c,!0}if(t.length)return!1;t.data!==i&&(c=t.data.weight/h,i.vx+=a*c,i.vy+=s*c)},wr={maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},xr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=n(n({},wr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,E,b,N,M,S,k=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=this.formatOptions(o,e),d=u.width,h=u.height,c=u.nodeSize,f=u.getMass,g=u.nodeStrength,p=u.edgeStrength,v=u.linkDistance,y=i.map((function(t){return n(n({},t),{data:n(n({},t.data),{x:x(t.data.x)?t.data.x:Math.random()*d,y:x(t.data.y)?t.data.y:Math.random()*h,size:c(t)||30,mass:f(t),nodeStrength:g(t)})})})),m=s.map((function(t){return n(n({},t),{data:n(n({},t.data),{edgeStrength:p(t),linkDistance:v(t,e.getNode(t.source),e.getNode(t.target))})})})),(null==i?void 0:i.length)?(w={},i.forEach((function(t,e){w[t.id]={x:0,y:0}})),E=new l({nodes:y,edges:m}),this.formatCentripetal(u,E),b=u.maxIteration,N=u.minMovement,M=u.onTick,this.lastLayoutNodes=y,this.lastLayoutEdges=m,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=E,this.lastOptions=u,this.lastVelMap=w,"undefined"==typeof window?[2]:(S=0,[2,new Promise((function(r){k.timeInterval=window.setInterval((function(){i&&k.running||r({nodes:Sr(e,y),edges:s}),k.runOneStep(E,e,S,w,u),k.updatePosition(e,E,w,u),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),null==M||M({nodes:Sr(e,y),edges:s}),(++S>=b||k.judgingDistance<N)&&(window.clearInterval(k.timeInterval),r({nodes:Sr(e,y),edges:s}))}),0),k.running=!0}))])):(this.lastResult={nodes:[],edges:s},[2,{nodes:[],edges:s}])}))}))},t.prototype.formatOptions=function(t,e){var r=t,n=t.width,o=t.height,i=t.getMass;if(r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=o||"undefined"==typeof window?o:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),i||(r.getMass=function(t){var r=1;x(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);var n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),t.preventOverlap){var a=S(0,t.nodeSpacing);t.nodeSize?g(t.nodeSize)?r.nodeSize=function(e){var r=t.nodeSize;return Math.max(r[0],r[1])+a(e)}:r.nodeSize=function(e){return t.nodeSize+a(e)}:r.nodeSize=function(t){var e=((null==t?void 0:t.data)||{}).size;return e?g(e)?Math.max(e[0],e[1])+a(t):M(e)?Math.max(e.width,e.height)+a(t):e+a(t):10+a(t)}}return r.linkDistance=t.linkDistance?S(1,t.linkDistance):function(t){return 1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target))},r.nodeStrength=S(1,t.nodeStrength),r.edgeStrength=S(1,t.edgeStrength),t},t.prototype.formatCentripetal=function(t,e){var r,n=t.centripetalOptions,o=t.center,i=t.clusterNodeStrength,a=t.leafCluster,s=t.clustering,u=t.nodeClusterBy,d=e.getAllNodes(),h=n||{leaf:2,single:2,others:1,center:function(t){return{x:o[0],y:o[1]}}};"function"!=typeof i&&(t.clusterNodeStrength=function(t){return i});var c=[];if(a&&u&&(r=Er(e,u),c=Array.from(new Set(null==d?void 0:d.map((function(t){return t.data[u]}))))||[],t.centripetalOptions=Object.assign(h,{single:100,leaf:function(e){var n=r[e.id]||{},o=n.siblingLeaves,i=n.sameTypeLeaves;return(null==i?void 0:i.length)===(null==o?void 0:o.length)||1===(null==c?void 0:c.length)?1:t.clusterNodeStrength(e)},others:1,center:function(t){var n,o=e.getDegree(t.id,"both");if(!o)return{x:100,y:100};if(1===o){var i=(r[t.id]||{}).sameTypeLeaves,a=void 0===i?[]:i;1===a.length?n=void 0:a.length>1&&(n=Mr(a))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y}}})),s&&u){r||(r=Er(e,u)),c||(c=Array.from(new Set(d.map((function(t){return t.data[u]}))))),c=c.filter((function(t){return void 0!==t}));var l={};c.forEach((function(t){var r=d.filter((function(e){return e.data[u]===t})).map((function(t){return e.getNode(t.id)}));l[t]=Mr(r)})),t.centripetalOptions=Object.assign(h,{single:function(e){return t.clusterNodeStrength(e)},leaf:function(e){return t.clusterNodeStrength(e)},others:function(e){return t.clusterNodeStrength(e)},center:function(t){var e=l[t.data[u]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y}}})}var f=t.centripetalOptions||{},g=f.leaf,p=f.single,v=f.others;g&&"function"!=typeof g&&(t.centripetalOptions.leaf=function(){return g}),p&&"function"!=typeof p&&(t.centripetalOptions.single=function(){return p}),v&&"function"!=typeof v&&(t.centripetalOptions.others=function(){return v})},t.prototype.runOneStep=function(t,e,r,n,o){var i={},a=t.getAllNodes(),s=t.getAllEdges();if(null==a?void 0:a.length){var u=o.monitor;this.calRepulsive(t,i,o),s&&this.calAttractive(t,i),this.calGravity(t,e,i,o),this.updateVelocity(t,i,n,o),u&&u({energy:this.calTotalEnergy(i,a),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}},t.prototype.calTotalEnergy=function(t,e){if(!(null==e?void 0:e.length))return 0;var r=0;return e.forEach((function(e,n){var o=t[e.id].x,i=t[e.id].y,a=o*o+i*i,s=e.data.mass;r+=(void 0===s?1:s)*a*.5})),r},t.prototype.calRepulsive=function(t,e,r){var n=r.factor,o=r.coulombDisScale;!function(t,e,r,n){var o=e/r,i=t.getAllNodes(),a=i.map((function(t,e){var r=t.data,n=r.nodeStrength;return{x:r.x,y:r.y,size:r.size,index:e,vx:0,vy:0,weight:o*n}})),s=F(a,(function(t){return t.x}),(function(t){return t.y})).visitAfter(yr);a.forEach((function(t){!function(t,e){e.visit((function(e,r,n,o,i){return mr(e,r,n,o,i,t)}))}(t,s)})),a.map((function(t,e){var r=i[e],o=r.id,a=r.data.mass,s=void 0===a?1:a;n[o]={x:t.vx/s,y:t.vy/s}}))}(t,n,o*o,e)},t.prototype.calAttractive=function(t,e){t.getAllEdges().forEach((function(r,n){var o=r.source,i=r.target,a=t.getNode(o),s=t.getNode(i);if(a&&s){var u=s.data.x-a.data.x,d=s.data.y-a.data.y;u||d||(u=.01*Math.random(),d=.01*Math.random());var h=Math.sqrt(u*u+d*d),c=u/h,l=d/h,f=r.data||{},g=f.linkDistance,p=void 0===g?200:g,v=f.edgeStrength,y=(p-h)*(void 0===v?200:v),m=1/(a.data.mass||1),w=1/(s.data.mass||1),x=c*y,E=l*y;e[o].x-=x*m,e[o].y-=E*m,e[i].x+=x*w,e[i].y+=E*w}}))},t.prototype.calGravity=function(t,e,r,n){var o=n.getCenter,i=t.getAllNodes(),a=e.getAllNodes(),u=e.getAllEdges(),d=n.width,h=n.height,c=n.center,l=n.gravity,f=n.centripetalOptions;i&&i.forEach((function(n){var i=n.id,g=n.data,p=g.mass,v=g.x,y=g.y,m=e.getNode(i),w=0,E=0,b=l,N=t.getDegree(i,"in"),M=t.getDegree(i,"out"),S=t.getDegree(i,"both"),k=null==o?void 0:o(m,S);if(k){var A=s(k,3);w=v-A[0],E=y-A[1],b=A[2]}else w=v-c[0],E=y-c[1];if(b&&(r[i].x-=b*w/p,r[i].y-=b*E/p),f){var R=f.leaf,I=f.single,_=f.others,D=f.center,O=(null==D?void 0:D(m,a,u,d,h))||{x:0,y:0,centerStrength:0},P=O.x,T=O.y,z=O.centerStrength;if(!x(P)||!x(T))return;var C=(v-P)/p,L=(y-T)/p;if(z&&(r[i].x-=z*C,r[i].y-=z*L),0===S){var q=I(m);if(!q)return;return r[i].x-=q*C,void(r[i].y-=q*L)}if(0===N||0===M){var j=R(m,a,u);if(!j)return;return r[i].x-=j*C,void(r[i].y-=j*L)}var F=_(m);if(!F)return;r[i].x-=F*C,r[i].y-=F*L}}))},t.prototype.updateVelocity=function(t,e,r,n){var o=n.damping,i=n.maxSpeed,a=n.interval,s=t.getAllNodes();(null==s?void 0:s.length)&&s.forEach((function(t){var n=t.id,s=(r[n].x+e[n].x*a)*o||.01,u=(r[n].y+e[n].y*a)*o||.01,d=Math.sqrt(s*s+u*u);if(d>i){var h=i/d;s*=h,u*=h}r[n]={x:s,y:u}}))},t.prototype.updatePosition=function(t,e,r,n){var o=this,i=n.distanceThresholdMode,a=n.interval,s=e.getAllNodes();if(null==s?void 0:s.length){var u=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),s.forEach((function(n){var s=n.id,d=t.getNode(s);if(x(d.data.fx)&&x(d.data.fy))e.mergeNodeData(s,{x:d.data.fx,y:d.data.fy});else{var h=r[s].x*a,c=r[s].y*a;e.mergeNodeData(s,{x:n.data.x+h,y:n.data.y+c});var l=Math.sqrt(h*h+c*c);switch(i){case"max":o.judgingDistance<l&&(o.judgingDistance=l);break;case"min":o.judgingDistance>l&&(o.judgingDistance=l);break;default:u+=l}}})),i&&"mean"!==i||(this.judgingDistance=u/s.length)}else this.judgingDistance=0},t}(),Er=function(t,e){var r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};var n={};return r.forEach((function(r,o){1===t.getDegree(r.id,"both")&&(n[r.id]=br(t,"leaf",r,e))})),n},br=function(t,e,r,n){var o=t.getDegree(r.id,"in"),i=t.getDegree(r.id,"out"),a=r,s=[];return 0===o?(a=t.getSuccessors(r.id)[0],s=t.getNeighbors(a.id)):0===i&&(a=t.getPredecessors(r.id)[0],s=t.getNeighbors(a.id)),s=s.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")})),{coreNode:a,siblingLeaves:s,sameTypeLeaves:Nr(t,e,n,r,s)}},Nr=function(t,e,r,n,o){var i=n.data[r]||"",a=(null==o?void 0:o.filter((function(t){return t.data[r]===i})))||[];return"leaf"===e&&(a=a.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")}))),a},Mr=function(t){var e={x:0,y:0};t.forEach((function(t){var r=t.data,n=r.x,o=r.y;e.x+=n||0,e.y+=o||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},Sr=function(t,e){return e.map((function(e){var r=e.id,o=e.data,i=t.getNode(r);return n(n({},i),{data:n(n({},i.data),{x:o.x,y:o.y})})}))},kr=function(){function t(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}return t.prototype.distanceTo=function(t){var e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)},t.prototype.setPos=function(t,e){this.rx=t,this.ry=e},t.prototype.resetForce=function(){this.fx=0,this.fy=0},t.prototype.addForce=function(t){var e=t.rx-this.rx,r=t.ry-this.ry,n=Math.hypot(e,r);n=n<1e-4?1e-4:n;var o=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=o*e/n,this.fy+=o*r/n},t.prototype.in=function(t){return t.contains(this.rx,this.ry)},t.prototype.add=function(e){var r=this.mass+e.mass;return new t({rx:(this.rx*this.mass+e.rx*e.mass)/r,ry:(this.ry*this.mass+e.ry*e.mass)/r,mass:r,degree:this.degree+e.degree})},t}();const Ar=kr;const Rr=function(){function t(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}return t.prototype.getLength=function(){return this.length},t.prototype.contains=function(t,e){var r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r},t.prototype.NW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.NE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.SW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t.prototype.SE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t}(),Ir=function(){function t(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}return t.prototype.insert=function(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e},t.prototype._putBody=function(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))},t.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},t.prototype.updateForce=function(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))},t}();var _r={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Dr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2",this.options=n(n({},_r),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,x,E,N,M,S,k,A,I;return a(this,(function(a){if(o=e.getAllEdges(),i=e.getAllNodes(),s=this.formatOptions(r,i.length),u=s.width,d=s.height,h=s.prune,c=s.maxIteration,f=s.nodeSize,g=s.center,!(null==i?void 0:i.length)||1===i.length)return[2,R(e,t,g)];if(p=i.map((function(t){return b(t,[u,d])})),v=o.filter((function(t){return t.source!==t.target})),y=new l({nodes:p,edges:v}),m=this.getSizes(y,e,f),this.run(y,e,c,m,t,s),h){for(w=0;w<v.length;w+=1)x=v[w],E=x.source,N=x.target,M=y.getDegree(E),S=y.getDegree(E),M<=1?(k=y.getNode(N),y.mergeNodeData(E,{x:k.data.x,y:k.data.y})):S<=1&&(A=y.getNode(E),y.mergeNodeData(N,{x:A.data.x,y:A.data.y}));I=n(n({},s),{prune:!1,barnesHut:!1}),this.run(y,e,100,m,t,I)}return[2,{nodes:p,edges:o}]}))}))},t.prototype.getSizes=function(t,e,r){for(var n=t.getAllNodes(),o={},i=0;i<n.length;i+=1){var a=n[i],d=a.id,h=a.data;if(o[d]=10,x(h.size))o[d]=h.size;else if(g(h.size))isNaN(h.size[0])||(o[d]=Math.max(h.size[0])),isNaN(h.size[1])||(o[d]=Math.max(h.size[1]));else if(M(h.size))o[d]=Math.max(h.size.width,h.size.height);else if(N(r)){var c=r(e.getNode(d));g(c)?o[d]=Math.max.apply(Math,u([],s(c))):o[d]=c}else g(r)?o[d]=Math.max.apply(Math,u([],s(r))):x(r)&&(o[d]=r)}return o},t.prototype.formatOptions=function(t,e){void 0===t&&(t={});var r=n(n({},this.options),t),o=r.center,i=r.width,a=r.height,s=r.barnesHut,u=r.prune,d=r.maxIteration,h=r.kr,c=r.kg;return r.width=i||"undefined"==typeof window?i:window.innerWidth,r.height=a||"undefined"==typeof window?a:window.innerHeight,r.center=o||[r.width/2,r.height/2],void 0===s&&e>250&&(r.barnesHut=!0),void 0===u&&e>100&&(r.prune=!0),0!==d||u?0===d&&u&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)):(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)),h||(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),c||(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r},t.prototype.run=function(t,e,r,n,o,i){for(var a=i.kr,s=i.barnesHut,u=i.onTick,d=t.getAllNodes(),h=0,c=r,l={},f={},g={},p=0;p<d.length;p+=1){var v=d[p],y=v.data,m=v.id;if(l[m]=[0,0],s){var w={id:p,rx:y.x,ry:y.y,mass:1,g:a,degree:t.getDegree(m)};g[m]=new Ar(w)}}for(;c>0;)h=this.oneStep(t,{iter:c,preventOverlapIters:50,krPrime:100,sg:h,forces:l,preForces:f,bodies:g,sizes:n},i),c--,null==u||u({nodes:d,edges:e.getAllEdges()});return t},t.prototype.oneStep=function(t,e,r){for(var n=e.iter,o=e.preventOverlapIters,i=e.krPrime,a=e.sg,d=e.preForces,h=e.bodies,c=e.sizes,l=e.forces,f=r.preventOverlap,g=r.barnesHut,p=t.getAllNodes(),v=0;v<p.length;v+=1){var y=p[v].id;d[y]=u([],s(l[y])),l[y]=[0,0]}return l=this.getAttrForces(t,n,o,c,l,r),l=g&&(f&&n>o||!f)?this.getOptRepGraForces(t,l,h,r):this.getRepGraForces(t,n,o,l,i,c,r),this.updatePos(t,l,d,a,r)},t.prototype.getAttrForces=function(t,e,r,n,o,i){for(var a=i.preventOverlap,s=i.dissuadeHubs,u=i.mode,d=i.prune,h=t.getAllEdges(),c=0;c<h.length;c+=1){var l=h[c],f=l.source,g=l.target,p=t.getNode(f),v=t.getNode(g),y=t.getDegree(f),m=t.getDegree(g);if(!d||!(y<=1||m<=1)){var w=[v.data.x-p.data.x,v.data.y-p.data.y],x=Math.hypot(w[0],w[1]);x=x<1e-4?1e-4:x,w[0]=w[0]/x,w[1]=w[1]/x,a&&e<r&&(x=x-n[f]-n[g]);var E=x,b=E;"linlog"===u&&(b=E=Math.log(1+x)),s&&(E=x/y,b=x/m),a&&e<r&&x<=0?(E=0,b=0):a&&e<r&&x>0&&(E=x,b=x),o[f][0]+=E*w[0],o[g][0]-=b*w[0],o[f][1]+=E*w[1],o[g][1]-=b*w[1]}}return o},t.prototype.getOptRepGraForces=function(t,e,r,n){for(var o=n.kg,i=n.center,a=n.prune,s=t.getAllNodes(),u=s.length,d=9e10,h=-9e10,c=9e10,l=-9e10,f=0;f<u;f+=1){var g=s[f],p=g.id,v=g.data;a&&t.getDegree(p)<=1||(r[p].setPos(v.x,v.y),v.x>=h&&(h=v.x),v.x<=d&&(d=v.x),v.y>=l&&(l=v.y),v.y<=c&&(c=v.y))}var y=Math.max(h-d,l-c),m=new Rr({xmid:(h+d)/2,ymid:(l+c)/2,length:y,massCenter:i,mass:u}),w=new Ir(m);for(f=0;f<u;f+=1)p=s[f].id,a&&t.getDegree(p)<=1||r[p].in(m)&&w.insert(r[p]);for(f=0;f<u;f+=1){var x=s[f],E=(p=x.id,v=x.data,t.getDegree(p));if(!(a&&E<=1)){r[p].resetForce(),w.updateForce(r[p]),e[p][0]-=r[p].fx,e[p][1]-=r[p].fy;var b=[v.x-i[0],v.y-i[1]],N=Math.hypot(b[0],b[1]);N=N<1e-4?1e-4:N,b[0]=b[0]/N,b[1]=b[1]/N;var M=o*(E+1);e[p][0]-=M*b[0],e[p][1]-=M*b[1]}}return e},t.prototype.getRepGraForces=function(t,e,r,n,o,i,a){for(var s=a.preventOverlap,u=a.kr,d=a.kg,h=a.center,c=a.prune,l=t.getAllNodes(),f=l.length,g=0;g<f;g+=1){for(var p=l[g],v=t.getDegree(p.id),y=g+1;y<f;y+=1){var m=l[y],w=t.getDegree(m.id);if(!c||!(v<=1||w<=1)){var x=[m.data.x-p.data.x,m.data.y-p.data.y],E=Math.hypot(x[0],x[1]);E=E<1e-4?1e-4:E,x[0]=x[0]/E,x[1]=x[1]/E,s&&e<r&&(E=E-i[p.id]-i[m.id]);var b=u*(v+1)*(w+1)/E;s&&e<r&&E<0?b=o*(v+1)*(w+1):s&&e<r&&0===E?b=0:s&&e<r&&E>0&&(b=u*(v+1)*(w+1)/E),n[p.id][0]-=b*x[0],n[m.id][0]+=b*x[0],n[p.id][1]-=b*x[1],n[m.id][1]+=b*x[1]}}var N=[p.data.x-h[0],p.data.y-h[1]],M=Math.hypot(N[0],N[1]);N[0]=N[0]/M,N[1]=N[1]/M;var S=d*(v+1);n[p.id][0]-=S*N[0],n[p.id][1]-=S*N[1]}return n},t.prototype.updatePos=function(t,e,r,n,o){for(var i=o.ks,a=o.tao,s=o.prune,u=o.ksmax,d=t.getAllNodes(),h=d.length,c=[],l=[],f=0,g=0,p=n,v=0;v<h;v+=1){var y=d[v].id,m=t.getDegree(y);if(!(s&&m<=1)){var w=[e[y][0]-r[y][0],e[y][1]-r[y][1]],E=Math.hypot(w[0],w[1]),b=[e[y][0]+r[y][0],e[y][1]+r[y][1]],N=Math.hypot(b[0],b[1]);c[v]=E,l[v]=N/2,f+=(m+1)*c[v],g+=(m+1)*l[v]}}var M=p;for(p=a*g/f,0!==M&&(p=p>1.5*M?1.5*M:p),v=0;v<h;v+=1){var S=d[v],k=(y=S.id,S.data);if(m=t.getDegree(y),!(s&&m<=1||x(k.fx)&&x(k.fy))){var A=i*p/(1+p*Math.sqrt(c[v])),R=Math.hypot(e[y][0],e[y][1]),I=u/(R=R<1e-4?1e-4:R),_=(A=A>I?I:A)*e[y][0],D=A*e[y][1];t.mergeNodeData(y,{x:k.x+_,y:k.y+D})}}return p},t}(),Or={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=n(n({},Or),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericFruchtermanLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,x,E=this;return a(this,(function(a){return this.running?[2]:(o=this.formatOptions(r),i=o.width,s=o.height,u=o.center,d=o.clustering,h=o.nodeClusterBy,c=o.maxIteration,f=o.onTick,g=e.getAllNodes(),p=e.getAllEdges(),(null==g?void 0:g.length)?1===g.length?(t&&e.mergeNodeData(g[0].id,{x:u[0],y:u[1]}),v={nodes:[n(n({},g[0]),{data:n(n({},g[0].data),{x:u[0],y:u[1]})})],edges:p},this.lastResult=v,[2,v]):(y=g.map((function(t){return b(t,[i,s])})),m=new l({nodes:y,edges:p}),w={},d&&y.forEach((function(t){var e=t.data[h];w[e]||(w[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=y,this.lastLayoutEdges=p,this.lastAssign=t,this.lastGraph=m,this.lastOptions=o,this.lastClusterMap=w,"undefined"==typeof window?[2]:(x=0,[2,new Promise((function(r){E.timeInterval=window.setInterval((function(){E.running?(E.runOneStep(m,w,o),t&&y.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y})})),null==f||f({nodes:y,edges:p}),++x>=c&&(window.clearInterval(E.timeInterval),r({nodes:y,edges:p}))):r({nodes:y,edges:p})}),0),E.running=!0}))])):(v={nodes:[],edges:p},this.lastResult=v,[2,v]))}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=n(n({},this.options),t),r=e.clustering,o=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=r&&!!o,e},t.prototype.runOneStep=function(t,e,r){var n=r.height,o=r.width,i=r.gravity,a=r.center,s=r.speed,u=r.clustering,d=r.nodeClusterBy,h=r.clusterGravity,c=n*o,l=Math.sqrt(c)/10,f=t.getAllNodes(),g=c/(f.length+1),p=Math.sqrt(g),v={};if(this.applyCalculate(t,v,p,g),u){for(var y in e)e[y].cx=0,e[y].cy=0,e[y].count=0;for(var y in f.forEach((function(t){var r=t.data,n=e[r[d]];x(r.x)&&(n.cx+=r.x),x(r.y)&&(n.cy+=r.y),n.count++})),e)e[y].cx/=e[y].count,e[y].cy/=e[y].count;var m=h||i;f.forEach((function(t,r){var n=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=e[o[d]],a=Math.sqrt((o.x-i.cx)*(o.x-i.cx)+(o.y-i.cy)*(o.y-i.cy)),s=p*m;v[n].x-=s*(o.x-i.cx)/a,v[n].y-=s*(o.y-i.cy)/a}}))}f.forEach((function(t,e){var r=t.id,n=t.data;if(x(n.x)&&x(n.y)){var o=.01*p*i;v[r].x-=o*(n.x-a[0]),v[r].y-=o*(n.y-a[1])}})),f.forEach((function(e,r){var n=e.id,o=e.data;if(x(o.fx)&&x(o.fy))return o.x=o.fx,void(o.y=o.fy);if(x(o.x)&&x(o.y)){var i=Math.sqrt(v[n].x*v[n].x+v[n].y*v[n].y);if(i>0){var a=Math.min(l*(s/800),i);t.mergeNodeData(n,{x:o.x+v[n].x/i*a,y:o.y+v[n].y/i*a})}}}))},t.prototype.applyCalculate=function(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)},t.prototype.calRepulsive=function(t,e,r){var n=t.getAllNodes();n.forEach((function(t,o){var i=t.data,a=t.id;e[a]={x:0,y:0},n.forEach((function(t,n){var s=t.data,u=t.id;if(!(o<=n)&&x(i.x)&&x(s.x)&&x(i.y)&&x(s.y)){var d=i.x-s.x,h=i.y-s.y,c=d*d+h*h;0===c&&(c=1,d=.01,h=.01);var l=r/c,f=d*l,g=h*l;e[a].x+=f,e[a].y+=g,e[u].x-=f,e[u].y-=g}}))}))},t.prototype.calAttractive=function(t,e,r){t.getAllEdges().forEach((function(n){var o=n.source,i=n.target;if(o&&i&&o!==i){var a=t.getNode(o).data,s=t.getNode(i).data;if(x(s.x)&&x(a.x)&&x(s.y)&&x(a.y)){var u=s.x-a.x,d=s.y-a.y,h=Math.sqrt(u*u+d*d)/r,c=u*h,l=d*h;e[o].x+=c,e[o].y+=l,e[i].x-=c,e[i].y-=l}}}))},t}(),Tr={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},zr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="grid",this.options=n(n({},Tr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericGridLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericGridLayout(!0,t,e),[2]}))}))},t.prototype.genericGridLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,p,v,y,m,w,E,N,M,A,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.begin,s=void 0===i?[0,0]:i,u=o.condense,d=o.preventOverlapPadding,h=o.preventOverlap,c=o.rows,l=o.cols,f=o.nodeSpacing,p=o.nodeSize,v=o.width,y=o.height,m=o.position,w=o.sortBy,E=e.getAllNodes(),N=e.getAllEdges(),!(M=null==E?void 0:E.length)||1===M)return[2,R(e,t,s)];if(A=E.map((function(t){return b(t)})),"id"===w||P(w)&&void 0!==A[0].data[w]||(w="degree"),"degree"===w?A.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):"id"===w?A.sort((function(t,e){return x(e.id)&&x(t.id)?e.id-t.id:(""+t.id).localeCompare(""+e.id)})):A.sort((function(t,e){return e.data[w]-t.data[w]})),I=v||"undefined"==typeof window?v:window.innerWidth,_=y||"undefined"==typeof window?y:window.innerHeight,D=M,O={rows:c,cols:l},null!=c&&null!=l?(O.rows=c,O.cols=l):null!=c&&null==l?(O.rows=c,O.cols=Math.ceil(D/O.rows)):null==c&&null!=l?(O.cols=l,O.rows=Math.ceil(D/O.cols)):(T=Math.sqrt(D*_/I),O.rows=Math.round(T),O.cols=Math.round(I/_*T)),O.rows=Math.max(O.rows,1),O.cols=Math.max(O.cols,1),O.cols*O.rows>D)z=Cr(O),C=Lr(O),(z-1)*C>=D?Cr(O,z-1):(C-1)*z>=D&&Lr(O,C-1);else for(;O.cols*O.rows<D;)z=Cr(O),((C=Lr(O))+1)*z>=D?Lr(O,C+1):Cr(O,z+1);for(L=u?0:I/O.cols,q=u?0:_/O.rows,(h||f)&&(j=S(10,f),F=k(30,p,!1),A.forEach((function(t){t.data.x&&t.data.y||(t.data.x=0,t.data.y=0);var r,n,o=e.getNode(t.id),i=F(o)||30;g(i)?(r=i[0],n=i[1]):(r=i,n=i);var a=void 0!==j?j(t):d,s=r+a,u=n+a;L=Math.max(L,s),q=Math.max(q,u)}))),V={},G={row:0,col:0},W={},B=0;B<A.length;B++){if($=A[B],U=void 0,m&&(U=m(e.getNode($.id))),U&&(void 0!==U.row||void 0!==U.col)){if(void 0===(H={row:U.row,col:U.col}).col)for(H.col=0;qr(V,H);)H.col++;else if(void 0===H.row)for(H.row=0;qr(V,H);)H.row++;W[$.id]=H,jr(V,H)}Vr($,s,L,q,W,O,G,V)}return K={nodes:A,edges:N},t&&A.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,K]}))}))},t}(),Cr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.min(n,o):Math.min(n,o)===t.rows?t.rows=e:t.cols=e,r},Lr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.max(n,o):Math.max(n,o)===t.rows?t.rows=e:t.cols=e,r},qr=function(t,e){return t["c-"+e.row+"-"+e.col]||!1},jr=function(t,e){return t["c-"+e.row+"-"+e.col]=!0},Fr=function(t,e){var r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},Vr=function(t,e,r,n,o,i,a,s){var u,d,h=o[t.id];if(h)u=h.col*r+r/2+e[0],d=h.row*n+n/2+e[1];else{for(;qr(s,a);)Fr(i,a);u=a.col*r+r/2+e[0],d=a.row*n+n/2+e[1],jr(s,a),Fr(i,a)}t.data.x=u,t.data.y=d};const Gr=Object.prototype.toString;function Wr(t){return Gr.call(t).endsWith("Array]")}function Br(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!Wr(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]<a&&(a=t[s]);return a}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]>a&&(a=t[s]);return a}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,a=void 0===i?r.autoMinMax?n:0:i,s=r.max,u=void 0===s?r.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var d=(u-a)/(o-n),h=0;h<t.length;h++)e[h]=(t[h]-n)*d+a;return e}const $r=" ".repeat(2),Ur=" ".repeat(4);function Hr(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=e;return`${t.constructor.name} {\\n${$r}[\\n${Ur}${function(t,e,r,n,o){const{rows:i,columns:a}=t,s=Math.min(i,e),u=Math.min(a,r),d=[];if("auto"===o){o=!1;t:for(let e=0;e<s;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let e=0;e<s;e++){let r=[];for(let i=0;i<u;i++)r.push(Kr(t.get(e,i),n,o));d.push(`${r.join(" ")}`)}return u!==a&&(d[d.length-1]+=` ... ${a-r} more columns`),s!==i&&d.push(`... ${i-e} more rows`),d.join(`\\n${Ur}`)}(t,r,n,o,i)}\\n${$r}]\\n${$r}rows: ${t.rows}\\n${$r}columns: ${t.columns}\\n}`}function Kr(t,e,r){return(t>=0&&r?` ${Yr(t,e-1)}`:Yr(t,e)).padEnd(e)}function Yr(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function Jr(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function Xr(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function Qr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function Zr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function tn(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(rn("startRow",e),rn("endRow",r),rn("startColumn",n),rn("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function en(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function rn(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function nn(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class on{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new sn(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new sn(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new sn(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new sn(t,e)}static ones(t,e){return new sn(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new sn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)o.set(r,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let a=o-n,s=new sn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(i()*a);s.set(r,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let t=0;t<n;t++)o.set(t,t,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let e=0;e<o;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new sn(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return on.isMatrix(t)?t:new sn(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let a=o;a<e;a++){let e=t.get(r,a)-i*t.get(n,a);t.set(r,a,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new sn(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){Jr(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return sn.rowVector(this.getRow(t))}setRow(t,e){Jr(this,t),e=Qr(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){Jr(this,t),Jr(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){Xr(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return sn.columnVector(this.getColumn(t))}setColumn(t,e){Xr(this,t),e=Zr(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){Xr(this,t),Xr(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){Jr(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){Xr(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){nn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){nn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(Jr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){Jr(this,t),nn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(Jr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){Jr(this,t),nn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(Xr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){Xr(this,t),nn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(Xr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){Xr(this,t),nn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){on.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=sn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new sn(e,n),i=new Float64Array(r);for(let a=0;a<n;a++){for(let e=0;e<r;e++)i[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,a,e)}}return o}strassen2x2(t){t=sn.checkMatrix(t);let e=new sn(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),d=t.get(1,1),h=(r+u)*(n+d),c=(a+u)*n,l=r*(i-d),f=u*(s-n),g=(r+o)*d,p=h+f-g+(o-u)*(s+d),v=l+g,y=c+f,m=h-c+l+(a-r)*(n+i);return e.set(0,0,p),e.set(0,1,v),e.set(1,0,y),e.set(1,1,m),e}strassen3x3(t){t=sn.checkMatrix(t);let e=new sn(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),d=this.get(2,1),h=this.get(2,2),c=t.get(0,0),l=t.get(0,1),f=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),y=t.get(2,0),m=t.get(2,1),w=t.get(2,2),x=(r-i)*(-l+p),E=(-r+i+a)*(c-l+p),b=(i+a)*(-c+l),N=r*c,M=(-r+u+d)*(c-f+v),S=(-r+u)*(f-v),k=(u+d)*(-c+f),A=(-o+d+h)*(p+y-m),R=(o-h)*(p-m),I=o*y,_=(d+h)*(-y+m),D=(-o+a+s)*(v+y-w),O=(o-s)*(v-w),P=(a+s)*(-y+w),T=N+I+n*g,z=(r+n+o-i-a-d-h)*p+E+b+N+A+I+_,C=N+M+k+(r+n+o-a-s-u-d)*v+I+D+P,L=x+a*(-c+l+g-p-v-y+w)+E+N+I+D+O,q=x+E+b+N+s*m,j=I+D+O+P+i*f,F=N+M+S+d*(-c+f+g-p-v-y+m)+A+R+I,V=A+R+I+_+u*l,G=N+M+S+k+h*w;return e.set(0,0,T),e.set(0,1,z),e.set(0,2,C),e.set(1,0,L),e.set(1,1,q),e.set(1,2,j),e.set(2,0,F),e.set(2,1,V),e.set(2,2,G),e}mmulStrassen(t){t=sn.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function a(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=on.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${r} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let s=Math.max(r,o),u=Math.max(n,i);return e=a(e,s,u),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=a(e,n+1,o+1),r=a(r,n+1,o+1)):n%2==1?(e=a(e,n+1,o),r=a(r,n+1,o)):o%2==1&&(e=a(e,n,o+1),r=a(r,n,o+1));let i=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,s-1),d=r.subMatrix(0,i-1,0,s-1),h=e.subMatrix(0,i-1,s,e.columns-1),c=r.subMatrix(0,i-1,s,r.columns-1),l=e.subMatrix(i,e.rows-1,0,s-1),f=r.subMatrix(i,r.rows-1,0,s-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),p=r.subMatrix(i,r.rows-1,s,r.columns-1),v=t(on.add(u,g),on.add(d,p),i,s),y=t(on.add(l,g),d,i,s),m=t(u,on.sub(c,p),i,s),w=t(g,on.sub(f,d),i,s),x=t(on.add(u,h),p,i,s),E=t(on.sub(l,u),on.add(d,c),i,s),b=t(on.sub(h,g),on.add(f,p),i,s),N=on.add(v,w);N.sub(x),N.add(b);let M=on.add(m,x),S=on.add(y,w),k=on.sub(v,y);k.add(m),k.add(E);let A=on.zeros(2*N.rows,2*N.columns);return A=A.setSubMatrix(N,0,0),A=A.setSubMatrix(M,N.rows,0),A=A.setSubMatrix(S,0,N.columns),A=A.setSubMatrix(k,N.rows,N.columns),A.subMatrix(0,n-1,0,o-1)}(e,t=a(t,s,u),s,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new sn(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&Br(o,{min:e,max:r,output:o}),n.setRow(t,o)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new sn(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&Br(o,{min:e,max:r,output:o}),n.setColumn(t,o)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=sn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new sn(e*n,r*o);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<o;s++)i.set(n*a+r,o*e+s,this.get(a,e)*t.get(r,s));return i}kroneckerSum(t){if(t=sn.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(sn.eye(r,r)),o=sn.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new sn(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=an){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=an){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){tn(this,t,e,r,n);let o=new sn(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new sn(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new sn(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=sn.checkMatrix(t)).isEmpty())return this;tn(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){!function(t,e){if(!Wr(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!Wr(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new sn(t.length,e.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<e.length;t++){let i=e[t];r.set(n,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new sn(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=en(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=en(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=en(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=en(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Wr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<n;a++){let n=0,s=0,u=0;for(let e=0;e<o;e++)u=t.get(a,e)-r[a],n+=u,s+=u*u;e?i.push((s-n*n/o)/(o-1)):i.push((s-n*n/o)/o)}return i}(this,r,n);case"column":if(!Wr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<o;a++){let o=0,s=0,u=0;for(let e=0;e<n;e++)u=t.get(e,a)-r[a],o+=u,s+=u*u;e?i.push((s-o*o/n)/(n-1)):i.push((s-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let a=0,s=0,u=0;for(let e=0;e<n;e++)for(let n=0;n<o;n++)u=t.get(e,n)-r,a+=u,s+=u*u;return e?(s-a*a/i)/(i-1):(s-a*a/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Wr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!Wr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!Wr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!Wr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return Hr(this,t)}}function an(t,e){return t-e}on.prototype.klass="Matrix","undefined"!=typeof Symbol&&(on.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return Hr(this)}),on.random=on.rand,on.randomInt=on.randInt,on.diagonal=on.diag,on.prototype.diagonal=on.prototype.diag,on.identity=on.eye,on.prototype.negate=on.prototype.neg,on.prototype.tensorProduct=on.prototype.kroneckerProduct;class sn extends on{constructor(t,e){if(super(),sn.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Wr(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!r[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return Jr(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),Jr(this,t,!0),e=Float64Array.from(Qr(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){Xr(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),Xr(this,t,!0),e=Zr(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(on,sn);class un extends on{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function dn(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class hn{constructor(t,e={}){if((t=un.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=e;let s,u=Boolean(o),d=Boolean(i),h=!1;if(r<n)if(a){s=t.transpose(),r=s.rows,n=s.columns,h=!0;let e=u;u=d,d=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let c=Math.min(r,n),l=Math.min(r+1,n),f=new Float64Array(l),g=new sn(r,c),p=new sn(n,n),v=new Float64Array(n),y=new Float64Array(r),m=new Float64Array(l);for(let t=0;t<l;t++)m[t]=t;let w=Math.min(r-1,n),x=Math.max(0,Math.min(n-2,r)),E=Math.max(w,x);for(let t=0;t<E;t++){if(t<w){f[t]=0;for(let e=t;e<r;e++)f[t]=dn(f[t],s.get(e,t));if(0!==f[t]){s.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<r;e++)s.set(e,t,s.get(e,t)/f[t]);s.set(t,t,s.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<n;e++){if(t<w&&0!==f[t]){let n=0;for(let o=t;o<r;o++)n+=s.get(o,t)*s.get(o,e);n=-n/s.get(t,t);for(let o=t;o<r;o++)s.set(o,e,s.get(o,e)+n*s.get(o,t))}v[e]=s.get(t,e)}if(u&&t<w)for(let e=t;e<r;e++)g.set(e,t,s.get(e,t));if(t<x){v[t]=0;for(let e=t+1;e<n;e++)v[t]=dn(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<n;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<r&&0!==v[t]){for(let e=t+1;e<r;e++)y[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)y[e]+=v[r]*s.get(e,r);for(let e=t+1;e<n;e++){let n=-v[e]/v[t+1];for(let o=t+1;o<r;o++)s.set(o,e,s.get(o,e)+n*y[o])}}if(d)for(let e=t+1;e<n;e++)p.set(e,t,v[e])}}let b=Math.min(n,r+1);if(w<n&&(f[w]=s.get(w,w)),r<b&&(f[b-1]=0),x+1<b&&(v[x]=s.get(x,b-1)),v[b-1]=0,u){for(let t=w;t<c;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<c;e++){let n=0;for(let o=t;o<r;o++)n+=g.get(o,t)*g.get(o,e);n=-n/g.get(t,t);for(let o=t;o<r;o++)g.set(o,e,g.get(o,e)+n*g.get(o,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(d)for(let t=n-1;t>=0;t--){if(t<x&&0!==v[t])for(let e=t+1;e<n;e++){let r=0;for(let o=t+1;o<n;o++)r+=p.get(o,t)*p.get(o,e);r=-r/p.get(t+1,t);for(let o=t+1;o<n;o++)p.set(o,e,p.get(o,e)+r*p.get(o,t))}for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}let N=b-1,M=0,S=Number.EPSILON;for(;b>0;){let t,e;for(t=b-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===b-2)e=4;else{let r;for(r=b-1;r>=t&&r!==t;r--){let e=(r!==b?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(f[r])<=S*e){f[r]=0;break}}r===t?e=3:r===b-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[b-2];v[b-2]=0;for(let r=b-2;r>=t;r--){let o=dn(f[r],e),i=f[r]/o,a=e/o;if(f[r]=o,r!==t&&(e=-a*v[r-1],v[r-1]=i*v[r-1]),d)for(let t=0;t<n;t++)o=i*p.get(t,r)+a*p.get(t,b-1),p.set(t,b-1,-a*p.get(t,r)+i*p.get(t,b-1)),p.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<b;n++){let o=dn(f[n],e),i=f[n]/o,a=e/o;if(f[n]=o,e=-a*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g.get(e,n)+a*g.get(e,t-1),g.set(e,t-1,-a*g.get(e,n)+i*g.get(e,t-1)),g.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(f[b-1]),Math.abs(f[b-2]),Math.abs(v[b-2]),Math.abs(f[t]),Math.abs(v[t])),o=f[b-1]/e,i=f[b-2]/e,a=v[b-2]/e,s=f[t]/e,h=v[t]/e,c=((i+o)*(i-o)+a*a)/2,l=o*a*(o*a);let y=0;0===c&&0===l||(y=c<0?0-Math.sqrt(c*c+l):Math.sqrt(c*c+l),y=l/(c+y));let m=(s+o)*(s-o)+y,w=s*h;for(let e=t;e<b-1;e++){let o=dn(m,w);0===o&&(o=Number.MIN_VALUE);let i=m/o,a=w/o;if(e!==t&&(v[e-1]=o),m=i*f[e]+a*v[e],v[e]=i*v[e]-a*f[e],w=a*f[e+1],f[e+1]=i*f[e+1],d)for(let t=0;t<n;t++)o=i*p.get(t,e)+a*p.get(t,e+1),p.set(t,e+1,-a*p.get(t,e)+i*p.get(t,e+1)),p.set(t,e,o);if(o=dn(m,w),0===o&&(o=Number.MIN_VALUE),i=m/o,a=w/o,f[e]=o,m=i*v[e]+a*f[e+1],f[e+1]=-a*v[e]+i*f[e+1],w=a*v[e+1],v[e+1]=i*v[e+1],u&&e<r-1)for(let t=0;t<r;t++)o=i*g.get(t,e)+a*g.get(t,e+1),g.set(t,e+1,-a*g.get(t,e)+i*g.get(t,e+1)),g.set(t,e,o)}v[b-2]=m,M+=1;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,d))for(let e=0;e<=N;e++)p.set(e,t,-p.get(e,t));for(;t<N&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,d&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}M=0,b--}}if(h){let t=p;p=g,g=t}this.m=r,this.n=n,this.s=f,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,o=sn.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?o.set(t,t,0):o.set(t,t,1/this.s[t]);let i=this.U,a=this.rightSingularVectors,s=a.mmul(o),u=a.rows,d=i.rows,h=sn.zeros(u,d);for(let t=0;t<u;t++)for(let e=0;e<d;e++){let r=0;for(let o=0;o<n;o++)r+=s.get(t,o)*i.get(e,o);h.set(t,e,r)}return h.mmul(e)}solveForDiagonal(t){return this.solve(sn.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new sn(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,a=i.rows,s=i.columns,u=new sn(r,a);for(let t=0;t<r;t++)for(let e=0;e<a;e++){let r=0;for(let n=0;n<s;n++)r+=o.get(t,n)*i.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return sn.diag(this.s)}}var cn,ln={center:[0,0],linkDistance:50},fn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="mds",this.options=n(n({},ln),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericMDSLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericMDSLayout(!0,t,e),[2]}))}))},t.prototype.genericMDSLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,g,y;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=void 0===i?[0,0]:i,u=o.linkDistance,d=void 0===u?50:u,h=e.getAllNodes(),c=e.getAllEdges(),(null==h?void 0:h.length)&&1!==h.length?(l=v({nodes:h,edges:c},!1),f=p(l),gn(f),m=d,w=[],f.forEach((function(t){var e=[];t.forEach((function(t){e.push(t*m)})),w.push(e)})),g=pn(w),y=[],g.forEach((function(t,e){var r=b(h[e]);r.data.x=t[0]+s[0],r.data.y=t[1]+s[1],y.push(r)})),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:y,edges:c}]):[2,R(e,t,s)];var m,w}))}))},t}(),gn=function(t){var e=-999999;t.forEach((function(t){t.forEach((function(t){t!==1/0&&e<t&&(e=t)}))})),t.forEach((function(r,n){r.forEach((function(r,o){r===1/0&&(t[n][o]=e)}))}))},pn=function(t){var e=sn.mul(sn.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),o=e.mean();e.add(o).subRowVector(r).subColumnVector(n);var i=new hn(e),a=sn.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((function(t){return sn.mul([t],[a]).toJSON()[0].splice(0,2)}))},vn={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},yn=function(t,e,r,n,o,i){e.forEach((function(a,s){r[s]={x:0,y:0},e.forEach((function(e,u){if(s!==u&&o[s]===o[u]){var d=a.x-e.x,h=a.y-e.y,c=Math.sqrt(d*d+h*h);if(0===c){c=1;var l=s>u?1:-1;d=.01*l,h=.01*l}if(c<i(t[s])/2+i(t[u])/2){var f=n*n/c;r[s].x+=d/c*f,r[s].y+=h/c*f}}}))}))},mn=function(t,e,r,n,o,i,a,s){var u=i||a/10;return n&&e.forEach((function(e,r){var n=t[r].x-t[o].x,i=t[r].y-t[o].y,a=Math.sqrt(n*n+i*i),s=i/a,u=-n/a,d=Math.sqrt(e.x*e.x+e.y*e.y),h=Math.acos((s*e.x+u*e.y)/d);h>Math.PI/2&&(h-=Math.PI/2,s*=-1,u*=-1);var c=Math.cos(h)*d;e.x=s*c,e.y=u*c})),t.forEach((function(i,a){if(a!==o){var d=Math.sqrt(e[a].x*e[a].x+e[a].y*e[a].y);if(d>0&&a!==o){var h=Math.min(u*(r/800),d);if(i.x+=e[a].x/d*h,i.y+=e[a].y/d*h,n){var c=i.x-t[o].x,l=i.y-t[o].y,f=Math.sqrt(c*c+l*l);c=c/f*s[a],l=l/f*s[a],i.x=t[o].x+c,i.y=t[o].y+l}}}})),t},wn={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},xn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="radial",this.options=n(n({},wn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRadialLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRadialLayout(!0,t,e),[2]}))}))},t.prototype.genericRadialLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,d,h,c,l,f,g,y,m,w,x,E,N,M,S,k,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K,Y,J,X,Q,Z,tt,et;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,d=o.height,h=o.center,c=o.focusNode,l=o.unitRadius,f=o.nodeSize,g=o.nodeSpacing,y=o.strictRadial,m=o.preventOverlap,w=o.maxPreventOverlapIteration,x=o.sortBy,E=o.linkDistance,N=void 0===E?50:E,M=o.sortStrength,S=void 0===M?10:M,k=o.maxIteration,I=void 0===k?1e3:k,_=e.getAllNodes(),D=e.getAllEdges(),O=i||"undefined"==typeof window?i:window.innerWidth,T=d||"undefined"==typeof window?d:window.innerHeight,z=h||[O/2,T/2],!(null==_?void 0:_.length)||1===_.length)return[2,R(e,t,z)];if(C=_[0],P(c)){for(L=0;L<_.length;L++)if(_[L].id===c){C=_[L];break}}else C=c||_[0];return q=Nn(_,C.id),j=v({nodes:_,edges:D},!1),F=p(j),V=Sn(F,q),Mn(F,q,V+1),G=F[q],W=O-z[0]>z[0]?z[0]:O-z[0],B=T-z[1]>z[1]?z[1]:T-z[1],0===W&&(W=O/2),0===B&&(B=T/2),$=Math.min(W,B),U=Math.max.apply(Math,u([],s(G))),H=[],K=l||$/U,G.forEach((function(t,e){H[e]=t*K})),Y=En(_,F,N,H,K,x,S),J=bn(Y),X=function(t,e,r){try{var n=sn.mul(sn.pow(e,2),-.5),o=n.mean("row"),i=n.mean("column"),a=n.mean();n.add(a).subRowVector(o).subColumnVector(i);var s=new hn(n),u=sn.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((function(e){return sn.mul([e],[u]).toJSON()[0].splice(0,t)}))}catch(t){for(var d=[],h=0;h<e.length;h++){var c=Math.random()*r,l=Math.random()*r;d.push([c,l])}return d}}(N,Y,N),Q=X.map((function(t){var e=s(t,2),r=e[0],n=e[1];return{x:(isNaN(r)?Math.random()*N:r)-X[q][0],y:(isNaN(n)?Math.random()*N:n)-X[q][1]}})),this.run(I,Q,J,Y,H,q),m&&(Z=A(f,g),tt={nodes:_,nodeSizeFunc:Z,positions:Q,radii:H,height:T,width:O,strictRadial:Boolean(y),focusIdx:q,iterations:w||200,k:Q.length/4.5},Q=function(t,e){for(var r=n(n({},vn),e),o=r.positions,i=r.iterations,a=r.width,s=r.k,u=r.speed,d=void 0===u?100:u,h=r.strictRadial,c=r.focusIdx,l=r.radii,f=void 0===l?[]:l,g=r.nodeSizeFunc,p=t.getAllNodes(),v=[],y=a/10,m=0;m<i;m++)o.forEach((function(t,e){v[e]={x:0,y:0}})),yn(p,o,v,s,f,g),mn(o,v,d,h,c,y,a,f);return o}(e,tt)),et=[],Q.forEach((function(t,e){var r=b(_[e]);r.data.x=t.x+z[0],r.data.y=t.y+z[1],et.push(r)})),t&&et.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:et,edges:D}]}))}))},t.prototype.run=function(t,e,r,n,o,i){for(var a=0;a<=t;a++){var s=a/t;this.oneIteration(s,e,o,n,r,i)}},t.prototype.oneIteration=function(t,e,r,n,o,i){var a=1-t;e.forEach((function(s,u){var d=y(s,{x:0,y:0}),h=0===d?0:1/d;if(u!==i){var c=0,l=0,f=0;e.forEach((function(t,e){if(u!==e){var r=y(s,t),i=0===r?0:1/r,a=n[e][u];f+=o[u][e],c+=o[u][e]*(t.x+a*(s.x-t.x)*i),l+=o[u][e]*(t.y+a*(s.y-t.y)*i)}}));var g=0===r[u]?0:1/r[u];f*=a,f+=t*g*g,c*=a,c+=t*g*s.x*h,s.x=c/f,l*=a,l+=t*g*s.y*h,s.y=l/f}}))},t}(),En=function(t,e,r,n,o,i,a){if(!t)return[];var s=[];if(e){var u={};e.forEach((function(e,d){var h=[];e.forEach((function(e,s){var c,l;if(d===s)h.push(0);else if(n[d]===n[s])if("data"===i)h.push(e*(Math.abs(d-s)*a)/(n[d]/o));else if(i){var f=void 0,g=void 0;if(u[t[d].id])f=u[t[d].id];else{var p=("id"===i?t[d].id:null===(c=t[d].data)||void 0===c?void 0:c[i])||0;f=P(p)?p.charCodeAt(0):p,u[t[d].id]=f}u[t[s].id]?g=u[t[s].id]:(p=("id"===i?t[s].id:null===(l=t[s].data)||void 0===l?void 0:l[i])||0,g=P(p)?p.charCodeAt(0):p,u[t[s].id]=g),h.push(e*(Math.abs(f-g)*a)/(n[d]/o))}else h.push(e*r/(n[d]/o));else{var v=(r+o)/2;h.push(e*v)}})),s.push(h)}))}return s},bn=function(t){for(var e=t.length,r=t[0].length,n=[],o=0;o<e;o++){for(var i=[],a=0;a<r;a++)0!==t[o][a]?i.push(1/(t[o][a]*t[o][a])):i.push(0);n.push(i)}return n},Nn=function(t,e){var r=-1;return t.forEach((function(t,n){t.id===e&&(r=n)})),Math.max(r,0)},Mn=function(t,e,r){for(var n=t.length,o=0;o<n;o++)if(t[e][o]===1/0){t[e][o]=r,t[o][e]=r;for(var i=0;i<n;i++)t[o][i]!==1/0&&t[e][i]===1/0&&(t[e][i]=r+t[o][i],t[i][e]=r+t[o][i])}for(o=0;o<n;o++)if(o!==e)for(i=0;i<n;i++)if(t[o][i]===1/0){var a=Math.abs(t[e][o]-t[e][i]);a=0===a?1:a,t[o][i]=a}},Sn=function(t,e){for(var r=0,n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r},kn={center:[0,0],width:300,height:300},An=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="random",this.options=n(n({},kn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRandomLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRandomLayout(!0,t,e),[2]}))}))},t.prototype.genericRandomLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,d=e.getAllNodes(),h=s||"undefined"==typeof window?s:window.innerWidth,c=u||"undefined"==typeof window?u:window.innerHeight,l=i||[h/2,c/2],f=[],d&&d.forEach((function(t){f.push({id:t.id,data:{x:.9*(Math.random()-.5)*h+l[0],y:.9*(Math.random()-.5)*c+l[1]}})})),t&&f.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:f,edges:e.getAllEdges()}]}))}))},t}(),Rn={circular:_,concentric:z,mds:fn,random:An,grid:zr,radial:xn,force:xr,d3force:zt,fruchterman:Pr,forceAtlas2:Dr,dagre:pr};function In(){var t;(null===(t=cn)||void 0===t?void 0:t.stop)&&cn.stop()}function _n(t,e){return i(this,void 0,void 0,(function(){var r,n,o,i,s,u,d,h,c;return a(this,(function(a){switch(a.label){case 0:if(r=t.layout,n=r.id,o=r.options,i=r.iterations,s=t.nodes,u=t.edges,d=new l({nodes:s,edges:u}),!(h=Rn[n]))throw new Error("Unknown layout id: "+n);return[4,(cn=new h(o)).execute(d)];case 1:return c=a.sent(),!!(f=cn).tick&&!!f.stop&&(cn.stop(),c=cn.tick(i)),[2,[c,e]]}var f}))}))}addEventListener("message",(function(t){var r,n=t.data,o=n.type,i=n.method,a=n.id,s=n.params;"RPC"===o&&i&&((r=e[i])?Promise.resolve().then((function(){return r.apply(e,s)})):Promise.reject("No such method")).then((function(t){postMessage({type:"RPC",id:a,result:t})})).catch((function(t){var e={message:t};t.stack&&(e.message=t.message,e.stack=t.stack,e.name=t.name),postMessage({type:"RPC",id:a,error:e})}))})),postMessage({type:"RPC",method:"ready"});\n//# sourceMappingURL=11f9ed8e311b689f74d1.worker.js.map'])),{name:"[fullhash].worker.js"});return URL.revokeObjectURL(URL.createObjectURL(new Blob(['var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{calculateLayout:()=>_n,stopLayout:()=>In});var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function o(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function i(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function a(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function u(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}Object.create,Object.create;const d=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[],i=this._events["*"]||[],a=function(n){for(var o=n.length,i=0;i<o;i++)if(n[i]){var a=n[i],s=a.callback;a.once&&(n.splice(i,1),0===n.length&&delete e._events[t],o--,i--),s.apply(e,r)}};a(o),a(i)},t.prototype.off=function(t,e){if(t)if(e){for(var r=this._events[t]||[],n=r.length,o=0;o<n;o++)r[o].callback===e&&(r.splice(o,1),n--,o--);0===r.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function h(t,e,r,n){for(;t.length;){const o=t.shift();if(r(o))return!0;e.add(o.id),n(o.id).forEach((r=>{e.has(r.id)||(e.add(r.id),t.push(r))}))}return!1}function c(t,e,r,n){if(r(t))return!0;e.add(t.id);for(const o of n(t.id))if(!e.has(o.id)&&c(o,e,r,n))return!0;return!1}class l extends d{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const r=e.find((e=>e.type===t.type&&e.id===t.id&&e.propertyName===t.propertyName));r?r.newValue=t.newValue:e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const r=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),r=this.bothEdgesMap.get(t);r?.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((e=>{e.childrenMap.get(t)?.forEach((t=>{e.parentMap.delete(t.id)})),e.parentMap.delete(t),e.childrenMap.delete(t)})),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){const n=this.getNode(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateNodeDataProperty(t,e,r)}))}))}updateNodeData(...t){const e=t[0],r=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:o})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),o.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),o=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),o.delete(e),i.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.source,o=e;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:o})}))}updateEdgeTarget(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.target,o=e;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:o})}))}updateEdgeDataProperty(t,e,r){const n=this.getEdge(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}updateEdgeData(...t){const e=t[0],r=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:o})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateEdgeDataProperty(t,e,r)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const r=[],n=Array.isArray(t)?t:[t];for(;n.length;){const t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach((t=>{t.children?.forEach((r=>{this.setParent(r.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const r=this.treeIndices.get(e).childrenMap.get(t);return Array.from(r||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const r=[];let n,o=this.getNode(t);for(;n=this.getParent(o.id,e);)r.push(n),o=n;return r}setParent(t,e,r){this.checkTreeExistence(r);const n=this.treeIndices.get(r),o=this.getNode(t),i=n.parentMap.get(t),a=this.getNode(e);n.parentMap.set(t,a),i&&n.childrenMap.get(i.id)?.delete(o);let s=n.childrenMap.get(a.id);s||(s=new Set,n.childrenMap.set(a.id,s)),s.add(o),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:i?.id,newParentId:a.id})}))}dfsTree(t,e,r){return c(this.getNode(t),new Set,e,(t=>this.getChildren(t,r)))}bfsTree(t,e,r){return h([this.getNode(t)],new Set,e,(t=>this.getChildren(t,r)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return h([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return c(this.getNode(t),new Set,e,n)}clone(){const t=this.getAllNodes().map((t=>({...t,data:{...t.data}}))),e=this.getAllEdges().map((t=>({...t,data:{...t.data}}))),r=new l({nodes:t,edges:e});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},n)=>{const o=new Map;t.forEach(((t,e)=>{o.set(e,r.getNode(t.id))}));const i=new Map;e.forEach(((t,e)=>{i.set(e,new Set(Array.from(t).map((t=>r.getNode(t.id)))))})),r.treeIndices.set(n,{parentMap:o,childrenMap:i})})),r}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var f=/-(\\w)/g,g=(function(t){return t.replace(f,(function(t,e){return e?e.toUpperCase():""}))},Object.create(null),Array.isArray),p=function(t){for(var e=[],r=t.length,n=0;n<r;n+=1){e[n]=[];for(var o=0;o<r;o+=1)n===o?e[n][o]=0:0!==t[n][o]&&t[n][o]?e[n][o]=t[n][o]:e[n][o]=1/0}for(var i=0;i<r;i+=1)for(n=0;n<r;n+=1)for(o=0;o<r;o+=1)e[n][o]>e[n][i]+e[i][o]&&(e[n][o]=e[n][i]+e[i][o]);return e},v=function(t,e){var r=t.nodes,n=t.edges,o=[],i={};if(!r)throw new Error("invalid nodes data!");return r&&r.forEach((function(t,e){i[t.id]=e,o.push([])})),null==n||n.forEach((function(t){var r=t.source,n=t.target,a=i[r],s=i[n];void 0!==a&&void 0!==s&&(o[a][s]=1,e||(o[s][a]=1))})),o},y=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},m={}.toString;const w=function(t,e){return m.call(t)==="[object "+e+"]"},x=function(t){return w(t,"Number")};var E=function(t){if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var e=[];return t.forEach((function(t){e.push(t)})),e.map((function(t){return E(t)}))}if("object"==typeof t){var r={};return Object.keys(t).forEach((function(e){r[e]=E(t[e])})),r}return t},b=function(t,e){var r=E(t);return r.data=r.data||{},e&&(x(r.data.x)||(r.data.x=Math.random()*e[0]),x(r.data.y)||(r.data.y=Math.random()*e[1])),r};const N=function(t){return"function"==typeof t},M=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function S(t,e){return N(e)?e:x(e)?function(){return e}:function(){return t}}function k(t,e,r){return void 0===r&&(r=!0),e||0===e?N(e)?e:x(e)?function(){return e}:g(e)?function(){if(r){var n=Math.max.apply(Math,u([],s(e)));return isNaN(n)?t:n}return e}:M(e)?function(){if(r){var n=Math.max(e.width,e.height);return isNaN(n)?t:n}return[e.width,e.height]}:function(){return t}:function(e){var r=(e.data||{}).size;return r?g(r)?r[0]>r[1]?r[0]:r[1]:M(r)?r.width>r.height?r.width:r.height:r:t}}var A=function(t,e){var r;return r=x(e)?function(){return e}:N(e)?e:function(){return 0},t?g(t)?function(e){return(t[0]>t[1]?t[0]:t[1])+r(e)}:function(e){return t+r(e)}:function(t){var e,n;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return Math.max(t.data.bboxSize[0],t.data.bboxSize[1])+r(t);if(null===(n=t.data)||void 0===n?void 0:n.size){if(g(t.data.size))return Math.max(t.data.size[0],t.data.size[1])+r(t);var o=t.data.size;return M(o)?(o.width>o.height?o.width:o.height)+r(t):o+r(t)}return 10+r(t)}},R=function(t,e,r){var o=t.getAllNodes(),i=t.getAllEdges();return(null==o?void 0:o.length)?1===o.length?(e&&t.mergeNodeData(o[0].id,{x:r[0],y:r[1]}),{nodes:[n(n({},o[0]),{data:n(n({},o[0].data),{x:r[0],y:r[1]})})],edges:i}):void 0:{nodes:[],edges:i}},I={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},_=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="circular",this.options=n(n({},I),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericCircularLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericCircularLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericCircularLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,u,d,h,c,l,f,g,p,v,y,m,w,x,E,N,M,A,I,_,P,T,z,C,L,q,j,F,V,G,W,B,$,U;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,u=o.height,d=o.center,h=o.divisions,c=o.startAngle,l=void 0===c?0:c,f=o.endAngle,g=void 0===f?2*Math.PI:f,p=o.angleRatio,v=o.ordering,y=o.clockwise,m=o.nodeSpacing,w=o.nodeSize,x=e.getAllNodes(),E=e.getAllEdges(),N=s(O(i,u,d),3),M=N[0],A=N[1],I=N[2],!(_=null==x?void 0:x.length)||1===_)return[2,R(e,t,I)];for(P=(g-l)/_,T=o.radius,z=o.startRadius,C=o.endRadius,m?(L=S(10,m),q=k(10,w),j=-1/0,x.forEach((function(t){var e=q(t);j<e&&(j=e)})),F=0,x.forEach((function(t,e){F+=0===e?j||10:(L(t)||0)+(j||10)})),T=F/(2*Math.PI)):T||z||C?!z&&C?z=C:z&&!C&&(C=z):T=Math.min(A,M)/2,V=P*p,G=[],G="topology"===v?D(e,x):"topology-directed"===v?D(e,x,!0):"degree"===v?function(t,e){var r=[];return e.forEach((function(t,e){r.push(b(t))})),r.sort((function(e,r){return t.getDegree(e.id,"both")-t.getDegree(r.id,"both")})),r}(e,x):x.map((function(t){return b(t)})),W=Math.ceil(_/h),B=0;B<_;++B)($=T)||null===z||null===C||($=z+B*(C-z)/(_-1)),$||($=10+100*B/(_-1)),U=l+B%W*V+2*Math.PI/h*Math.floor(B/W),y||(U=g-B%W*V-2*Math.PI/h*Math.floor(B/W)),G[B].data.x=I[0]+Math.cos(U)*$,G[B].data.y=I[1]+Math.sin(U)*$;return t&&G.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:G,edges:E}]}))}))},t}(),D=function(t,e,r){void 0===r&&(r=!1);var n=[b(e[0])],o={},i=e.length;o[e[0].id]=!0;var a=0;return e.forEach((function(s,u){if(0!==u)if(u!==i-1&&t.getDegree(s.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(n[a].id,s.id)||o[s.id]){for(var d=r?t.getSuccessors(n[a].id):t.getNeighbors(n[a].id),h=!1,c=0;c<d.length;c++){var l=d[c];if(t.getDegree(l.id)===t.getDegree(s.id)&&!o[l.id]){n.push(b(l)),o[l.id]=!0,h=!0;break}}for(var f=0;!h&&(o[e[f].id]||(n.push(b(e[f])),o[e[f].id]=!0,h=!0),++f!==i););}else n.push(b(s)),o[s.id]=!0,a++})),n},O=function(t,e,r){var n=t,o=e,i=r;return n||"undefined"==typeof window||(n=window.innerWidth),o||"undefined"==typeof window||(o=window.innerHeight),i||(i=[n/2,o/2]),[n,o,i]};const P=function(t){return w(t,"String")};var T={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},z=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="concentric",this.options=n(n({},T),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericConcentricLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericConcentricLayout(!0,t,e),[2]}))}))},t.prototype.genericConcentricLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,p,v,y,m,w,E,S,k,A,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K,Y;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,d=o.sortBy,h=o.maxLevelDiff,c=o.sweep,l=o.clockwise,f=o.equidistant,p=o.preventOverlap,v=o.startAngle,y=void 0===v?1.5*Math.PI:v,m=o.nodeSize,w=o.nodeSpacing,E=e.getAllNodes(),S=e.getAllEdges(),k=s||"undefined"==typeof window?s:window.innerWidth,A=u||"undefined"==typeof window?u:window.innerHeight,I=i||[k/2,A/2],!(null==E?void 0:E.length)||1===E.length)return[2,R(e,t,I)];if(_=[],O=0,D=g(m)?Math.max(m[0],m[1]):m,g(w)?O=Math.max(w[0],w[1]):x(w)&&(O=w),E.forEach((function(t){var e=b(t);_.push(e);var r=D,n=e.data;g(n.size)?r=Math.max(n.size[0],n.size[1]):x(n.size)?r=n.size:M(n.size)&&(r=Math.max(n.size.width,n.size.height)),D=Math.max(D,r),N(w)&&(O=Math.max(w(t),O))})),T={},_.forEach((function(t,e){T[t.id]=e})),P(z=d)&&void 0!==_[0].data[z]||(z="degree"),"degree"===z?_.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):_.sort((function(t,e){return e.data[z]-t.data[z]})),C=_[0],L=(h||("degree"===z?e.getDegree(C.id,"both"):C.data[z]))/4,j=(q=[{nodes:[]}])[0],_.forEach((function(t){if(j.nodes.length>0){var r="degree"===z?Math.abs(e.getDegree(j.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(j.nodes[0].data[z]-t.data[z]);L&&r>=L&&(j={nodes:[]},q.push(j))}j.nodes.push(t)})),F=D+O,p||(V=q.length>0&&q[0].nodes.length>1,G=Math.min(k,A)/2-F,W=G/(q.length+(V?1:0)),F=Math.min(F,W)),B=0,q.forEach((function(t){var e=void 0===c?2*Math.PI-2*Math.PI/t.nodes.length:c;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&p){var r=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),o=Math.sqrt(F*F/(r*r+n*n));B=Math.max(o,B)}t.r=B,B+=F})),f){for($=0,U=0,H=0;H<q.length;H++)K=q[H],Y=(K.r||0)-U,$=Math.max($,Y);U=0,q.forEach((function(t,e){0===e&&(U=t.r||0),t.r=U,U+=$}))}return q.forEach((function(t){var e=t.dTheta||0,r=t.r||0;t.nodes.forEach((function(t,n){var o=y+(l?1:-1)*e*n;t.data.x=I[0]+r*Math.cos(o),t.data.y=I[1]+r*Math.sin(o)}))})),t&&_.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:_,edges:S}]}))}))},t}();function C(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i,a,s,u,d,h,c,l,f=t._root,g={data:n},p=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!f)return t._root=g,t;for(;f.length;)if((d=e>=(i=(p+y)/2))?p=i:y=i,(h=r>=(a=(v+m)/2))?v=a:m=a,o=f,!(f=f[c=h<<1|d]))return o[c]=g,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&r===u)return g.next=f,o?o[c]=g:t._root=g,t;do{o=o?o[c]=new Array(4):t._root=new Array(4),(d=e>=(i=(p+y)/2))?p=i:y=i,(h=r>=(a=(v+m)/2))?v=a:m=a}while((c=h<<1|d)==(l=(u>=a)<<1|s>=i));return o[l]=f,o[c]=g,t}function L(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function q(t){return t[0]}function j(t){return t[1]}function F(t,e,r){var n=new V(null==e?q:e,null==r?j:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function V(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function G(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var W=F.prototype=V.prototype;function B(t){return function(){return t}}function $(t){return 1e-6*(t()-.5)}W.copy=function(){var t,e,r=new V(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=G(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var o=0;o<4;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(4)}):n.target[o]=G(e));return r},W.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return C(this.cover(e,r),e,r,t)},W.addAll=function(t){var e,r,n,o,i=t.length,a=new Array(i),s=new Array(i),u=1/0,d=1/0,h=-1/0,c=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(a[r]=n,s[r]=o,n<u&&(u=n),n>h&&(h=n),o<d&&(d=o),o>c&&(c=o));if(u>h||d>c)return this;for(this.cover(u,d).cover(h,c),r=0;r<i;++r)C(this,a[r],s[r],t[r]);return this},W.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var a,s,u=o-r||1,d=this._root;r>t||t>=o||n>e||e>=i;)switch(s=(e<n)<<1|t<r,(a=new Array(4))[s]=d,d=a,u*=2,s){case 0:o=r+u,i=n+u;break;case 1:r=o-u,i=n+u;break;case 2:o=r+u,n=i-u;break;case 3:r=o-u,n=i-u}this._root&&this._root.length&&(this._root=d)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this},W.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},W.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},W.find=function(t,e,r){var n,o,i,a,s,u,d,h=this._x0,c=this._y0,l=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new L(p,h,c,l,f)),null==r?r=1/0:(h=t-r,c=e-r,l=t+r,f=e+r,r*=r);u=g.pop();)if(!(!(p=u.node)||(o=u.x0)>l||(i=u.y0)>f||(a=u.x1)<h||(s=u.y1)<c))if(p.length){var v=(o+a)/2,y=(i+s)/2;g.push(new L(p[3],v,y,a,s),new L(p[2],o,y,v,s),new L(p[1],v,i,a,y),new L(p[0],o,i,v,y)),(d=(e>=y)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-d],g[g.length-1-d]=u)}else{var m=t-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),x=m*m+w*w;if(x<r){var E=Math.sqrt(r=x);h=t-E,c=e-E,l=t+E,f=e+E,n=p.data}}return n},W.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,r,n,o,i,a,s,u,d,h,c,l,f=this._root,g=this._x0,p=this._y0,v=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((d=i>=(s=(g+v)/2))?g=s:v=s,(h=a>=(u=(p+y)/2))?p=u:y=u,e=f,!(f=f[c=h<<1|d]))return this;if(!f.length)break;(e[c+1&3]||e[c+2&3]||e[c+3&3])&&(r=e,l=c)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(o=f.next)&&delete f.next,n?(o?n.next=o:delete n.next,this):e?(o?e[c]=o:delete e[c],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[l]=f:this._root=f),this):(this._root=o,this)},W.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},W.root=function(){return this._root},W.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},W.visit=function(t){var e,r,n,o,i,a,s=[],u=this._root;for(u&&s.push(new L(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,n=e.x0,o=e.y0,i=e.x1,a=e.y1)&&u.length){var d=(n+i)/2,h=(o+a)/2;(r=u[3])&&s.push(new L(r,d,h,i,a)),(r=u[2])&&s.push(new L(r,n,h,d,a)),(r=u[1])&&s.push(new L(r,d,o,i,h)),(r=u[0])&&s.push(new L(r,n,o,d,h))}return this},W.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new L(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.x1,d=e.y1,h=(a+u)/2,c=(s+d)/2;(i=o[0])&&r.push(new L(i,a,s,h,c)),(i=o[1])&&r.push(new L(i,h,s,u,c)),(i=o[2])&&r.push(new L(i,a,c,h,d)),(i=o[3])&&r.push(new L(i,h,c,u,d))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},W.x=function(t){return arguments.length?(this._x=t,this):this._x},W.y=function(t){return arguments.length?(this._y=t,this):this._y};var U={value:()=>{}};function H(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new K(n)}function K(t){this._=t}function Y(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function J(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=U,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}K.prototype=H.prototype={constructor:K,on:function(t,e){var r,n,o=this._,i=(n=o,(t+"").trim().split(/^|\\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)o[r]=J(o[r],t.name,e);else if(null==e)for(r in o)o[r]=J(o[r],t.name,null);return this}for(;++a<s;)if((r=(t=i[a]).type)&&(r=Y(o[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new K(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};const X=H;var Q,Z,tt=0,et=0,rt=0,nt=1e3,ot=0,it=0,at=0,st="object"==typeof performance&&performance.now?performance:Date,ut="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function dt(){return it||(ut(ht),it=st.now()+at)}function ht(){it=0}function ct(){this._call=this._time=this._next=null}function lt(t,e,r){var n=new ct;return n.restart(t,e,r),n}function ft(){it=(ot=st.now())+at,tt=et=0;try{!function(){dt(),++tt;for(var t,e=Q;e;)(t=it-e._time)>=0&&e._call.call(void 0,t),e=e._next;--tt}()}finally{tt=0,function(){for(var t,e,r=Q,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:Q=e);Z=t,pt(n)}(),it=0}}function gt(){var t=st.now(),e=t-ot;e>nt&&(at-=e,ot=t)}function pt(t){tt||(et&&(et=clearTimeout(et)),t-it>24?(t<1/0&&(et=setTimeout(ft,t-st.now()-at)),rt&&(rt=clearInterval(rt))):(rt||(ot=st.now(),rt=setInterval(gt,nt)),tt=1,ut(ft)))}ct.prototype=lt.prototype={constructor:ct,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?dt():+r)+(null==e?0:+e),this._next||Z===this||(Z?Z._next=this:Q=this,Z=this),this._call=t,this._time=r,pt()},stop:function(){this._call&&(this._call=null,this._time=1/0,pt())}};const vt=1664525,yt=1013904223,mt=4294967296;function wt(t){return t.x}function xt(t){return t.y}var Et=10,bt=Math.PI*(3-Math.sqrt(5));function Nt(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,a=.6,s=new Map,u=lt(c),d=X("tick","end"),h=function(){let t=1;return()=>(t=(vt*t+yt)%mt)/mt}();function c(){l(),d.call("tick",e),r<n&&(u.stop(),d.call("end",e))}function l(n){var u,d,h=t.length;void 0===n&&(n=1);for(var c=0;c<n;++c)for(r+=(i-r)*o,s.forEach((function(t){t(r)})),u=0;u<h;++u)null==(d=t[u]).fx?d.x+=d.vx*=a:(d.x=d.fx,d.vx=0),null==d.fy?d.y+=d.vy*=a:(d.y=d.fy,d.vy=0);return e}function f(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var o=Et*Math.sqrt(.5+r),i=r*bt;e.x=o*Math.cos(i),e.y=o*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,h),e}return null==t&&(t=[]),f(),e={tick:l,restart:function(){return u.restart(c),e},stop:function(){return u.stop(),e},nodes:function(r){return arguments.length?(t=r,f(),s.forEach(g),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(h=t,s.forEach(g),e):h},force:function(t,r){return arguments.length>1?(null==r?s.delete(t):s.set(t,g(r)),e):s.get(t)},find:function(e,r,n){var o,i,a,s,u,d=0,h=t.length;for(null==n?n=1/0:n*=n,d=0;d<h;++d)(a=(o=e-(s=t[d]).x)*o+(i=r-s.y)*i)<n&&(u=s,n=a);return u},on:function(t,r){return arguments.length>1?(d.on(t,r),e):d.on(t)}}}function Mt(){var t,e,r,n,o,i=B(-30),a=1,s=1/0,u=.81;function d(r){var o,i=t.length,a=F(t,wt,xt).visitAfter(c);for(n=r,o=0;o<i;++o)e=t[o],a.visit(l)}function h(){if(t){var e,r,n=t.length;for(o=new Array(n),e=0;e<n;++e)r=t[e],o[r.index]=+i(r,e,t)}}function c(t){var e,r,n,i,a,s=0,u=0;if(t.length){for(n=i=a=0;a<4;++a)(e=t[a])&&(r=Math.abs(e.value))&&(s+=e.value,u+=r,n+=r*e.x,i+=r*e.y);t.x=n/u,t.y=i/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=o[e.data.index]}while(e=e.next)}t.value=s}function l(t,i,d,h){if(!t.value)return!0;var c=t.x-e.x,l=t.y-e.y,f=h-i,g=c*c+l*l;if(f*f/u<g)return g<s&&(0===c&&(g+=(c=$(r))*c),0===l&&(g+=(l=$(r))*l),g<a&&(g=Math.sqrt(a*g)),e.vx+=c*t.value*n/g,e.vy+=l*t.value*n/g),!0;if(!(t.length||g>=s)){(t.data!==e||t.next)&&(0===c&&(g+=(c=$(r))*c),0===l&&(g+=(l=$(r))*l),g<a&&(g=Math.sqrt(a*g)));do{t.data!==e&&(f=o[t.data.index]*n/g,e.vx+=c*f,e.vy+=l*f)}while(t=t.next)}}return d.initialize=function(e,n){t=e,r=n,h()},d.strength=function(t){return arguments.length?(i="function"==typeof t?t:B(+t),h(),d):i},d.distanceMin=function(t){return arguments.length?(a=t*t,d):Math.sqrt(a)},d.distanceMax=function(t){return arguments.length?(s=t*t,d):Math.sqrt(s)},d.theta=function(t){return arguments.length?(u=t*t,d):Math.sqrt(u)},d}function St(t){return t.index}function kt(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function At(t){var e,r,n,o,i,a,s=St,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},d=B(30),h=1;function c(n){for(var o=0,s=t.length;o<h;++o)for(var u,d,c,l,f,g,p,v=0;v<s;++v)d=(u=t[v]).source,l=(c=u.target).x+c.vx-d.x-d.vx||$(a),f=c.y+c.vy-d.y-d.vy||$(a),l*=g=((g=Math.sqrt(l*l+f*f))-r[v])/g*n*e[v],f*=g,c.vx-=l*(p=i[v]),c.vy-=f*p,d.vx+=l*(p=1-p),d.vy+=f*p}function l(){if(n){var a,u,d=n.length,h=t.length,c=new Map(n.map(((t,e)=>[s(t,e,n),t])));for(a=0,o=new Array(d);a<h;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=kt(c,u.source)),"object"!=typeof u.target&&(u.target=kt(c,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(a=0,i=new Array(h);a<h;++a)u=t[a],i[a]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);e=new Array(h),f(),r=new Array(h),g()}}function f(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+u(t[r],r,t)}function g(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+d(t[e],e,t)}return null==t&&(t=[]),c.initialize=function(t,e){n=t,a=e,l()},c.links=function(e){return arguments.length?(t=e,l(),c):t},c.id=function(t){return arguments.length?(s=t,c):s},c.iterations=function(t){return arguments.length?(h=+t,c):h},c.strength=function(t){return arguments.length?(u="function"==typeof t?t:B(+t),f(),c):u},c.distance=function(t){return arguments.length?(d="function"==typeof t?t:B(+t),g(),c):d},c}function Rt(t){return t.x+t.vx}function It(t){return t.y+t.vy}function _t(t){var e,r,n,o=1,i=1;function a(){for(var t,a,u,d,h,c,l,f=e.length,g=0;g<i;++g)for(a=F(e,Rt,It).visitAfter(s),t=0;t<f;++t)u=e[t],c=r[u.index],l=c*c,d=u.x+u.vx,h=u.y+u.vy,a.visit(p);function p(t,e,r,i,a){var s=t.data,f=t.r,g=c+f;if(!s)return e>d+g||i<d-g||r>h+g||a<h-g;if(s.index>u.index){var p=d-s.x-s.vx,v=h-s.y-s.vy,y=p*p+v*v;y<g*g&&(0===p&&(y+=(p=$(n))*p),0===v&&(y+=(v=$(n))*v),y=(g-(y=Math.sqrt(y)))/y*o,u.vx+=(p*=y)*(g=(f*=f)/(l+f)),u.vy+=(v*=y)*g,s.vx-=p*(g=1-g),s.vy-=v*g)}}}function s(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var n,o,i=e.length;for(r=new Array(i),n=0;n<i;++n)o=e[n],r[o.index]=+t(o,n,e)}}return"function"!=typeof t&&(t=B(null==t?1:+t)),a.initialize=function(t,r){e=t,n=r,u()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(o=+t,a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),u(),a):t},a}function Dt(t){var e,r,n,o=B(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=B(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:B(+t),a(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),a(),i):t},i}function Ot(t){var e,r,n,o=B(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=B(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:B(+t),a(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:B(+e),a(),i):t},i}function Pt(){function t(t){return function(){return t}}var e,r=function(t){return t.cluster},n=t(1),o=t(-1),i=t(100),a=t(.1),u=[0,0],d=[],h={},c=[],l=100,f=100,g={none:{x:0,y:0}},p=[],v="force",y=!0,m=.1;function w(t){if(!y)return w;e.tick(),E();for(var n=0,o=d.length,i=void 0,a=t*m;n<o;++n)(i=d[n]).vx+=(g[r(i)].x-i.x)*a,i.vy+=(g[r(i)].y-i.y)*a}function x(){d&&function(){if(d&&d.length){if(void 0===r(d[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy(\'clusterAttr\') before calling .links()");var t,u,g,v,y,m=(t=[],u=[],g={},{},y=[],v=function(t){var e={};return t.forEach((function(t){var n=r(t);e[n]||(e[n]={count:0,sumforceNodeSize:0})})),t.forEach((function(t){var o=r(t),i=n(t),a=e[o];a.count=a.count+1,a.sumforceNodeSize=a.sumforceNodeSize+Math.PI*(i*i)*1.3,e[o]=a})),e}(d),y=function(t){var e={},n=[];return t.forEach((function(t){var n,o,i,a,s,u=(o=(n=t).source,i=n.target,(a=r(h[o]))<=(s=r(h[i]))?a+"~"+s:s+"~"+a),d=0;void 0!==e[u]&&(d=e[u]),d+=1,e[u]=d})),Object.entries(e).forEach((function(t){var e=s(t,2),r=e[0],o=e[1],i=r.split("~")[0],a=r.split("~")[1];void 0!==i&&void 0!==a&&n.push({source:i,target:a,count:o})})),n}(c),Object.keys(v).forEach((function(e,r){var n=v[e];t.push({id:e,size:n.count,r:Math.sqrt(n.sumforceNodeSize/Math.PI)}),g[e]=r})),y.forEach((function(t){var e=t.source,r=t.target,n=g[e],o=g[r];void 0!==n&&void 0!==o&&u.push({source:n,target:o,count:t.count})})),{nodes:t,links:u});e=Nt(m.nodes).force("x",Dt(l).strength(.1)).force("y",Ot(f).strength(.1)).force("collide",_t((function(t){return t.r})).iterations(4)).force("charge",Mt().strength(o)).force("links",At(m.nodes.length?m.links:[]).distance(i).strength(a)),p=e.nodes(),E()}}()}function E(){return g={none:{x:0,y:0}},p.forEach((function(t){g[t.id]={x:t.x-u[0],y:t.y-u[1]}})),g}return w.initialize=function(t){d=t,x()},w.template=function(t){return arguments.length?(v=t,x(),w):v},w.groupBy=function(t){return arguments.length?"string"==typeof t?(r=function(e){return e[t]},w):(r=t,w):r},w.enableGrouping=function(t){return arguments.length?(y=t,w):y},w.strength=function(t){return arguments.length?(m=t,w):m},w.centerX=function(t){return arguments.length?(l=t,w):l},w.centerY=function(t){return arguments.length?(f=t,w):f},w.nodes=function(t){return arguments.length?(function(t){h={},t.forEach((function(t){h[t.id]=t}))}(t||[]),d=t||[],w):d},w.links=function(t){return arguments.length?(c=t||[],x(),w):c},w.forceNodeSize=function(e){return arguments.length?(n="function"==typeof e?e:t(+e),x(),w):n},w.nodeSize=w.forceNodeSize,w.forceCharge=function(e){return arguments.length?(o="function"==typeof e?e:t(+e),x(),w):o},w.forceLinkDistance=function(e){return arguments.length?(i="function"==typeof e?e:t(+e),x(),w):i},w.forceLinkStrength=function(e){return arguments.length?(a="function"==typeof e?e:t(+e),x(),w):a},w.offset=function(t){return arguments.length?(u=t,w):u},w.getFocis=E,w}var Tt={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},zt=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="d3force",this.options=n(n({},Tt),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){var t;null===(t=this.forceSimulation)||void 0===t||t.stop()},t.prototype.tick=function(t){var e=this;void 0===t&&(t=1),this.forceSimulation.tick(t);var r={nodes:Ct(this.lastLayoutNodes),edges:Lt(this.lastLayoutEdges)};return this.lastAssign&&r.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,g,p,v,y,m,w,x,E,N,M,S,k,A,R,I,_,D,O=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=i.map((function(t){var e,r;return n(n({},b(t)),{x:null===(e=t.data)||void 0===e?void 0:e.x,y:null===(r=t.data)||void 0===r?void 0:r.y})})),d=s.map((function(t){return b(t)})),this.lastLayoutNodes=u,this.lastLayoutEdges=d,this.lastAssign=t,this.lastGraph=e,h=o.alphaMin,c=o.alphaDecay,l=o.alpha,f=o.nodeStrength,g=o.edgeStrength,p=o.linkDistance,v=o.clustering,y=o.clusterFociStrength,m=o.clusterEdgeDistance,w=o.clusterEdgeStrength,x=o.clusterNodeStrength,E=o.clusterNodeSize,N=o.collideStrength,M=void 0===N?1:N,S=o.center,k=void 0===S?[0,0]:S,A=o.preventOverlap,R=o.nodeSize,I=o.nodeSpacing,_=o.onTick,D=o.forceSimulation,[2,new Promise((function(r){if(D){v&&((i=Pt()).nodes(u),i.links(d)),D.nodes(u),d&&(s=At().id((function(t){return t.id})).links(d),g&&s.strength(g),p&&s.distance(p),D.force("link",s)),A&&O.overlapProcess(D,{nodeSize:R,nodeSpacing:I,collideStrength:M}),D.alpha(l).restart();var n=Ct(u),o=Lt(d);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:o})}else try{var i,a=Mt();if(f&&a.strength(f),D=Nt().nodes(u),v&&((i=Pt()).centerX(k[0]).centerY(k[1]).template("force").strength(y),d&&i.links(d),u&&i.nodes(u),i.forceLinkDistance(m).forceLinkStrength(w).forceCharge(x).forceNodeSize(E),D.force("group",i)),D.force("center",function(t,e){var r,n=1;function o(){var o,i,a=r.length,s=0,u=0;for(o=0;o<a;++o)s+=(i=r[o]).x,u+=i.y;for(s=(s/a-t)*n,u=(u/a-e)*n,o=0;o<a;++o)(i=r[o]).x-=s,i.y-=u}return null==t&&(t=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(n=+t,o):n},o}(k[0],k[1])).force("charge",a).alpha(l).alphaDecay(c).alphaMin(h),A&&O.overlapProcess(D,{nodeSize:R,nodeSpacing:I,collideStrength:M}),d){var s=At().id((function(t){return t.id})).links(d);g&&s.strength(g),p&&s.distance(p),D.force("link",s)}D.on("tick",(function(){var r=Ct(u);null==_||_({nodes:r,edges:Lt(d)}),t&&r.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}))})).on("end",(function(){var n=Ct(u);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:Lt(d)})}))}catch(t){console.warn(t)}O.forceSimulation=D}))]}))}))},t.prototype.overlapProcess=function(t,e){var r,n,o=e.nodeSize,i=e.nodeSpacing,a=e.collideStrength;if(n=x(i)?function(){return i}:N(i)?i:function(){return 0},o)if(N(o))r=function(t){return o(t)+n(t)};else if(g(o)){var s=(o[0]>o[1]?o[0]:o[1])/2;r=function(t){return s+n(t)}}else if(x(o)){var u=o/2;r=function(t){return u+n(t)}}else r=function(){return 10};else r=function(t){return t.size?g(t.size)?(t.size[0]>t.size[1]?t.size[0]:t.size[1])/2+n(t):M(t.size)?(t.size.width>t.size.height?t.size.width:t.size.height)/2+n(t):t.size/2+n(t):10+n(t)};t.force("collisionForce",_t(r).strength(a))},t}(),Ct=function(t){return t.map((function(t){var e=t.x,r=t.y,i=o(t,["x","y"]);return n(n({},i),{data:n(n({},i.data),{x:e,y:r})})}))},Lt=function(t){return t.map((function(t){var e=t.source,r=t.target,i=o(t,["source","target"]);return n(n({},i),{source:e.id,target:r.id})}))};var qt=function(t,e){if("next"!==t&&"prev"!==t)return e},jt=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(function(){function t(){var t={};t.prev=t,t.next=t.prev,this.shortcut=t}return t.prototype.dequeue=function(){var t=this.shortcut,e=t.prev;if(e&&e!==t)return jt(e),e},t.prototype.enqueue=function(t){var e=this.shortcut;t.prev&&t.next&&jt(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e},t.prototype.toString=function(){for(var t=[],e=this.shortcut,r=e.prev;r!==e;)t.push(JSON.stringify(r,qt)),r=null==r?void 0:r.prev;return"["+t.join(", ")+"]"},t}()),Vt=function(){return 1},Gt=function(t,e,r,o,i){var a,s,u=[];return t.hasNode(o.v)&&(null===(a=t.getRelatedEdges(o.v,"in"))||void 0===a||a.forEach((function(o){var a=o.data.weight,s=t.getNode(o.source);i&&u.push({v:o.source,w:o.target,in:0,out:0}),void 0===s.data.out&&(s.data.out=0),s.data.out-=a,Wt(e,r,n({v:s.id},s.data))})),null===(s=t.getRelatedEdges(o.v,"out"))||void 0===s||s.forEach((function(o){var i=o.data.weight,a=o.target,s=t.getNode(a);void 0===s.data.in&&(s.data.in=0),s.data.in-=i,Wt(e,r,n({v:s.id},s.data))})),t.removeNode(o.v)),i?u:void 0},Wt=function(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},Bt=function(t,e){var r="greedy"===e?function(t,e){var r;if(t.getAllNodes().length<=1)return[];var o=function(t,e){var r=new l,o=0,i=0;t.getAllNodes().forEach((function(t){r.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((function(t){var a=r.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target})),s=(null==e?void 0:e(t))||1;a?r.updateEdgeData(null==a?void 0:a.id,n(n({},a.data),{weight:a.data.weight+s})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:s}}),i=Math.max(i,r.getNode(t.source).data.out+=s),o=Math.max(o,r.getNode(t.target).data.in+=s)}));for(var a=[],s=i+o+3,u=0;u<s;u++)a.push(new Ft);var d=o+1;return r.getAllNodes().forEach((function(t){Wt(a,d,n({v:t.id},r.getNode(t.id).data))})),{buckets:a,zeroIdx:d,graph:r}}(t,function(t){return t.data.weight||1}||Vt);return null===(r=function(t,e,r){for(var n,o=[],i=e[e.length-1],a=e[0];t.getAllNodes().length;){for(;n=a.dequeue();)Gt(t,e,r,n);for(;n=i.dequeue();)Gt(t,e,r,n);if(t.getAllNodes().length)for(var s=e.length-2;s>0;--s)if(n=e[s].dequeue()){o=o.concat(Gt(t,e,r,n,!0));break}}return o}(o.graph,o.buckets,o.zeroIdx).map((function(e){return t.getRelatedEdges(e.v,"out").filter((function(t){return t.target===e.w}))})))||void 0===r?void 0:r.flat()}(t):$t(t);null==r||r.forEach((function(e){var r=e.data;t.removeEdge(e.id),r.forwardName=e.data.name,r.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:n({},r)})}))},$t=function(t){var e=[],r={},n={},o=function(i){n[i]||(n[i]=!0,r[i]=!0,t.getRelatedEdges(i,"out").forEach((function(t){r[t.target]?e.push(t):o(t.target)})),delete r[i])};return t.getAllNodes().forEach((function(t){return o(t.id)})),e},Ut=function(t,e,r,n){var o;do{o=""+n+Math.random()}while(t.hasNode(o));return r.dummy=e,t.addNode({id:o,data:r}),o},Ht=function(t){var e=new l;return t.getAllNodes().forEach((function(r){t.getChildren(r.id).length||e.addNode(n({},r))})),t.getAllEdges().forEach((function(t){e.addEdge(t)})),e},Kt=function(t,e){var r,n,o=Number(t.x),i=Number(t.y),a=Number(e.x)-o,s=Number(e.y)-i,u=Number(t.width)/2,d=Number(t.height)/2;return a||s?(Math.abs(s)*u>Math.abs(a)*d?(s<0&&(d=-d),r=d*a/s,n=d):(a<0&&(u=-u),r=u,n=u*s/a),{x:o+r,y:i+n}):{x:0,y:0}},Yt=function(t){for(var e=[],r=Xt(t)+1,n=0;n<r;n++)e.push([]);for(t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)})),n=0;n<r;n++)e[n]=e[n].sort((function(e,r){return n=t.getNode(e).data.order,o=t.getNode(r).data.order,Number(n)-Number(o);var n,o}));return e},Jt=function(t,e,r,n){var o={width:0,height:0};return x(r)&&x(n)&&(o.rank=r,o.order=n),Ut(t,"border",o,e)},Xt=function(t){var e;return t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)})),e||(e=0),e},Qt=function(t,e){return t.reduce((function(t,r){return e(t)>e(r)?r:t}))},Zt=function(t,e,r,n,o,i){n.includes(e.id)||(n.push(e.id),r||i.push(e.id),o(e.id).forEach((function(e){return Zt(t,e,r,n,o,i)})),r&&i.push(e.id))},te=function(t,e,r,n){var o=Array.isArray(e)?e:[e],i=function(e){return n?t.getSuccessors(e):t.getNeighbors(e)},a=[],s=[];return o.forEach((function(e){if(!t.hasNode(e.id))throw new Error("Graph does not have node: "+e);Zt(t,e,"post"===r,s,i,a)})),a},ee="edge-label",re=function(t){var e={},r=function(n){var o,i,a=t.getNode(n);return a?e[n]?a.data.rank:(e[n]=!0,null===(o=t.getRelatedEdges(n,"out"))||void 0===o||o.forEach((function(t){var e=r(t.target)-t.data.minlen;e&&(void 0===i||e<i)&&(i=e)})),i||(i=0),a.data.rank=i,i):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){return r(t.id)}))},ne=function(t,e){return t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen},oe=function(t,e){var r=function(n){e.getRelatedEdges(n,"both").forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ie=function(t,e){var r=function(n){var o;null===(o=e.getRelatedEdges(n,"both"))||void 0===o||o.forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||void 0===e.getNode(a).data.layer&&ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ae=function(t,e){return Qt(e.getAllEdges(),(function(r){return t.hasNode(r.source)!==t.hasNode(r.target)?ne(e,r):1/0}))},se=function(t,e,r){t.getAllNodes().forEach((function(t){var n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r}))},ue=function(t,e){var r=te(t,t.getAllNodes(),"post",!1);(r=r.slice(0,(null==r?void 0:r.length)-1)).forEach((function(r){de(t,e,r)}))},de=function(t,e,r){var n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find((function(t){return t.target===n||t.source===n})).data.cutvalue=he(t,e,r)},he=function(t,e,r){var n=t.getNode(r).data.parent,o=!0,i=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),a=0;return i||(o=!1,i=e.getRelatedEdges(n,"out").find((function(t){return t.target===r}))),a=i.data.weight,e.getRelatedEdges(r,"both").forEach((function(e){var i=e.source===r,s=i?e.target:e.source;if(s!==n){var u=i===o,d=e.data.weight;if(a+=u?d:-d,ye(t,r,s)){var h=t.getRelatedEdges(r,"both").find((function(t){return t.source===s||t.target===s})).data.cutvalue;a+=u?-h:h}}})),a},ce=function(t,e){void 0===e&&(e=t.getAllNodes()[0].id),le(t,{},1,e)},le=function(t,e,r,n,o){var i,a=r,s=r,u=t.getNode(n);return e[n]=!0,null===(i=t.getNeighbors(n))||void 0===i||i.forEach((function(r){e[r.id]||(s=le(t,e,s,r.id,n))})),u.data.low=a,u.data.lim=s++,o?u.data.parent=o:delete u.data.parent,s},fe=function(t){return t.getAllEdges().find((function(t){return t.data.cutvalue<0}))},ge=function(t,e,r){var n=r.source,o=r.target;e.getRelatedEdges(n,"out").find((function(t){return t.target===o}))||(n=r.target,o=r.source);var i=t.getNode(n),a=t.getNode(o),s=i,u=!1;i.data.lim>a.data.lim&&(s=a,u=!0);var d=e.getAllEdges().filter((function(e){return u===me(t.getNode(e.source),s)&&u!==me(t.getNode(e.target),s)}));return Qt(d,(function(t){return ne(e,t)}))},pe=function(t,e,r,n){var o=t.getRelatedEdges(r.source,"both").find((function(t){return t.source===r.target||t.target===r.target}));o&&t.removeEdge(o.id),t.addEdge({id:"e"+Math.random(),source:n.source,target:n.target,data:{}}),ce(t),ue(t,e),ve(t,e)},ve=function(t,e){var r=t.getAllNodes().find((function(t){return!t.data.parent})),n=te(t,r,"pre",!1);(n=n.slice(1)).forEach((function(r){var n=t.getNode(r).data.parent,o=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),i=!1;!o&&e.hasNode(n)&&(o=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),i=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(i?null==o?void 0:o.data.minlen:-(null==o?void 0:o.data.minlen))}))},ye=function(t,e,r){return t.getRelatedEdges(e,"both").find((function(t){return t.source===r||t.target===r}))},me=function(t,e){return e.data.low<=t.data.lim&&t.data.lim<=e.data.lim},we=re,xe=function(t){!function(t){var e=function(t){var e=new l;return t.getAllNodes().forEach((function(t){e.addNode(n({},t))})),t.getAllEdges().forEach((function(t){var r=e.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target}));r?e.updateEdgeData(null==r?void 0:r.id,n(n({},r.data),{weight:r.data.weight+t.data.weight||0,minlen:Math.max(r.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e}(t);re(e);var r,o,i=function(t){var e,r,n=new l({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);oe(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r);return n}(e);for(ce(i),ue(i,e);r=fe(i);)o=ge(i,e,r),pe(i,e,r,o)}(t)},Ee=function(t,e,r,n,o,i,a){var s=t.getChildren(a);if(null==s?void 0:s.length){var u=Jt(t,"_bt"),d=Jt(t,"_bb"),h=t.getNode(a);t.setParent(u,a),h.data.borderTop=u,t.setParent(d,a),h.data.borderBottom=d,null==s||s.forEach((function(s){Ee(t,e,r,n,o,i,s.id);var h=s.data.borderTop?s.data.borderTop:s.id,c=s.data.borderBottom?s.data.borderBottom:s.id,l=s.data.borderTop?n:2*n,f=h!==c?1:o-i[a]+1;t.addEdge({id:"e"+Math.random(),source:u,target:h,data:{minlen:f,weight:l,nestingEdge:!0}}),t.addEdge({id:"e"+Math.random(),source:c,target:d,data:{minlen:f,weight:l,nestingEdge:!0}})})),t.getParent(a)||t.addEdge({id:"e"+Math.random(),source:e,target:u,data:{weight:0,minlen:o+i[a]}})}else a!==e&&t.addEdge({id:"e"+Math.random(),source:e,target:a,data:{weight:0,minlen:r}})},be=function(t,e,r,n,o,i){var a={rank:i,borderType:e,width:0,height:0},s=o.data[e][i-1],u=Ut(t,"border",a,r);o.data[e][i]=u,t.setParent(u,n),s&&t.addEdge({id:"e"+Math.random(),source:s,target:u,data:{weight:1}})},Ne=function(t){t.getAllNodes().forEach((function(t){Me(t)})),t.getAllEdges().forEach((function(t){Me(t)}))},Me=function(t){var e=t.data.width;t.data.width=t.data.height,t.data.height=e},Se=function(t){(null==t?void 0:t.y)&&(t.y=-t.y)},ke=function(t){var e=t.x;t.x=t.y,t.y=e},Ae=function(t){for(var e={},r=t.getAllNodes(),n=r.map((function(t){var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),o=Math.max.apply(Math,u([],s(n))),i=[],a=0;a<o+1;a++)i.push([]);var d=r.sort((function(e,r){return t.getNode(e.id).data.rank-t.getNode(r.id).data.rank})),h=d.filter((function(e){return void 0!==t.getNode(e.id).data.fixorder})).sort((function(e,r){return t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder}));return null==h||h.forEach((function(r){isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0})),null==d||d.forEach((function(r){return t.dfsTree(r.id,(function(t){if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)}))})),i},Re=function(t,e,r){for(var n=function(t,e){return null==t?void 0:t.reduce((function(t,r,n){return t[r]=e[n],t}),{})}(r,r.map((function(t,e){return e}))),o=e.map((function(e){var r=t.getRelatedEdges(e,"out").map((function(t){return{pos:n[t.target]||0,weight:t.data.weight}}));return null==r?void 0:r.sort((function(t,e){return t.pos-e.pos}))})),i=o.flat().filter((function(t){return void 0!==t})),a=1;a<r.length;)a<<=1;var s=2*a-1;a-=1;var u=Array(s).fill(0,0,s),d=0;return null==i||i.forEach((function(t){if(t){var e=t.pos+a;u[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=u[e+1]),u[e=e-1>>1]+=t.weight;d+=t.weight*r}})),d},Ie=function(t,e){for(var r=0,n=1;n<(null==e?void 0:e.length);n+=1)r+=Re(t,e[n-1],e[n]);return r},_e=function(t,e){var r,n=0,o=0;t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/o,t.weight=o,t.i=Math.min(e.i,t.i),e.merged=!0};const De=function(t,e){var r,n,o,i={};return null==t||t.forEach((function(t,e){i[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};var r=i[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)})),null===(r=e.getAllEdges())||void 0===r||r.forEach((function(t){var e=i[t.source],r=i[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(i[t.target]))})),function(t){for(var e,r,n=[],o=function(){var o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach((function(t){return(e=o,function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&_e(e,t)})(t);var e})),null===(r=o.out)||void 0===r||r.forEach((function(e){return(r=o,function(e){e.in.push(r),0==--e.indegree&&t.push(e)})(e);var r}))};null==t?void 0:t.length;)o();var i=n.filter((function(t){return!t.merged})),a=["vs","i","barycenter","weight"];return i.map((function(t){var e={};return null==a||a.forEach((function(r){void 0!==t[r]&&(e[r]=t[r])})),e}))}(null===(o=(n=Object.values(i)).filter)||void 0===o?void 0:o.call(n,(function(t){return!t.indegree})))};var Oe=function(t,e,r){for(var n,o=r;e.length&&(n=e[e.length-1]).i<=o;)e.pop(),null==t||t.push(n.vs),o++;return o},Pe=function(t,e,r,n,o,i){var a,s,u,d,h=t.getChildren(e).map((function(t){return t.id})),c=t.getNode(e),l=c?c.data.borderLeft:void 0,f=c?c.data.borderRight:void 0,g={};l&&(h=null==h?void 0:h.filter((function(t){return t!==l&&t!==f})));var p=function(t,e){return e.map((function(e){var r=t.getRelatedEdges(e,"in");if(!(null==r?void 0:r.length))return{v:e};var n={sum:0,weight:0};return null==r||r.forEach((function(e){var r=t.getNode(e.source);n.sum+=e.data.weight*r.data.order,n.weight+=e.data.weight})),{v:e,barycenter:n.sum/n.weight,weight:n.weight}}))}(t,h||[]);null==p||p.forEach((function(e){var o;if(null===(o=t.getChildren(e.v))||void 0===o?void 0:o.length){var a=Pe(t,e.v,r,n,i);g[e.v]=a,a.hasOwnProperty("barycenter")&&ze(e,a)}}));var v=De(p,r);Te(v,g),null===(a=v.filter((function(t){return t.vs.length>0})))||void 0===a||a.forEach((function(e){var r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)}));var y=function(t,e,r,n){var o=function(t,e){var r={lhs:[],rhs:[]};return null==t||t.forEach((function(t){var e,o;o=(e=t).hasOwnProperty("fixorder")&&!isNaN(e.fixorder),(n?!o&&e.hasOwnProperty("barycenter"):o||e.hasOwnProperty("barycenter"))?r.lhs.push(t):r.rhs.push(t)})),r}(t),i=o.lhs,a=o.rhs.sort((function(t,e){return-t.i- -e.i})),s=[],u=0,d=0,h=0;null==i||i.sort(function(t,e){return function(r,n){if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i}}(!!e,!!r)),h=Oe(s,a,h),null==i||i.forEach((function(t){var e;h+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),u+=t.barycenter*t.weight,d+=t.weight,h=Oe(s,a,h)}));var c={vs:s.flat()};return d&&(c.barycenter=u/d,c.weight=d),c}(v,n,o,i);if(l&&(y.vs=[l,y.vs,f].flat(),null===(s=t.getPredecessors(l))||void 0===s?void 0:s.length)){var m=t.getNode((null===(u=t.getPredecessors(l))||void 0===u?void 0:u[0].id)||""),w=t.getNode((null===(d=t.getPredecessors(f))||void 0===d?void 0:d[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+w.data.order)/(y.weight+2),y.weight+=2}return y},Te=function(t,e){null==t||t.forEach((function(t){var r,n=null===(r=t.vs)||void 0===r?void 0:r.map((function(t){return e[t]?e[t].vs:t}));t.vs=n.flat()}))},ze=function(t,e){void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},Ce=function(t){if("object"!=typeof t||null===t)return t;var e,r;if(r=t,Array.isArray?Array.isArray(r):w(r,"Array")){e=[];for(var n=0,o=t.length;n<o;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=Ce(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=Ce(t[i]):e[i]=t[i];return e};const Le=Ce;var qe=function(t,e,r){return e.map((function(e){return function(t,e,r){var o=function(t){for(var e;t.hasNode(e="_root"+Math.random()););return e}(t),i=new l({tree:[{id:o,children:[],data:{}}]});return t.getAllNodes().forEach((function(a){var s=t.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(n({},a)),(null==s?void 0:s.id)&&!i.hasNode(null==s?void 0:s.id)&&i.addNode(n({},s)),i.setParent(a.id,(null==s?void 0:s.id)||o),t.getRelatedEdges(a.id,r).forEach((function(e){var r=e.source===a.id?e.target:e.source;i.hasNode(r)||i.addNode(n({},t.getNode(r)));var o=i.getRelatedEdges(r,"out").find((function(t){return t.target===a.id})),s=void 0!==o?o.data.weight:0;o?i.updateEdgeData(o.id,n(n({},o.data),{weight:e.data.weight+s})):i.addEdge({id:e.id,source:r,target:a.id,data:{weight:e.data.weight+s}})})),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,n(n({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))})),i}(t,e,r)}))},je=function(t,e,r,n){var o=new l;null==t||t.forEach((function(t){for(var i,a=t.getRoots()[0].id,s=Pe(t,a,o,e,r,n),u=0;u<(null===(i=s.vs)||void 0===i?void 0:i.length);u++){var d=t.getNode(s.vs[u]);d&&(d.data.order=u)}!function(t,e,r){var n,o={};null==r||r.forEach((function(r){for(var i,a,s=t.getParent(r);s;){if((i=t.getParent(s.id))?(a=o[i.id],o[i.id]=s.id):(a=n,n=s.id),a&&a!==s.id)return e.addNodes([{id:a,data:{}},{id:s.id,data:{}}]),void e.addEdge({id:"e"+a+"-"+s.id,source:a,target:s.id,data:{}});s=i}}))}(t,o,s.vs)}))},Fe=function(t,e){null==e||e.forEach((function(e){null==e||e.forEach((function(e,r){t.getNode(e).data.order=r}))}))},Ve=function(t,e){var r={};function n(e,n,o,i,a){for(var s,u,d,h=n;h<o;h++)d=e[h],(null===(s=t.getNode(d))||void 0===s?void 0:s.data.dummy)&&(null===(u=t.getPredecessors(d))||void 0===u||u.forEach((function(e){var n=t.getNode(e.id);n.data.dummy&&(n.data.order<i||n.data.order>a)&&We(r,e.id,d)})))}function o(t,e){var r=function(t){return JSON.stringify(t.slice(1))}(t);e.get(r)||(n.apply(void 0,u([],s(t))),e.set(r,!0))}return(null==e?void 0:e.length)&&e.reduce((function(e,r){var n,i=-1,a=0,s=new Map;return null==r||r.forEach((function(u,d){var h;if("border"===(null===(h=t.getNode(u))||void 0===h?void 0:h.data.dummy)){var c=t.getPredecessors(u)||[];c.length&&(n=t.getNode(c[0].id).data.order,o([r,a,d,i,n],s),a=d,i=n)}o([r,a,r.length,n,e.length],s)})),r})),r},Ge=function(t,e){var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find((function(e){return t.getNode(e.id).data.dummy}))},We=function(t,e,r){var n=e,o=r;if(n>o){var i=n;n=o,o=i}var a=t[n];a||(t[n]=a={}),a[o]=!0},Be=function(t,e,r){var n=e;return n>r&&(n=r),!!t[n]},$e=function(t,e,r,o,i,a){var s=new l,u=Ue(o,i,a);return null==e||e.forEach((function(e){var o;null==e||e.forEach((function(e){var i=r[e];if(s.hasNode(i)||s.addNode({id:i,data:{}}),o){var a=r[o],d=s.getRelatedEdges(a,"out").find((function(t){return t.target===i}));d?s.updateEdgeData(d.id,n(n({},d.data),{weight:Math.max(u(t,e,o),d.data.weight||0)})):s.addEdge({id:"e"+Math.random(),source:a,target:i,data:{weight:Math.max(u(t,e,o),0)}})}o=e}))})),s};var Ue=function(t,e,r){return function(n,o,i){var a=n.getNode(o),s=n.getNode(i),u=0,d=0;if(u+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":d=-a.data.width/2;break;case"r":d=a.data.width/2}if(d&&(u+=r?d:-d),d=0,u+=(a.data.dummy?e:t)/2,u+=(s.data.dummy?e:t)/2,u+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":d=s.data.width/2;break;case"r":d=-s.data.width/2}return d&&(u+=r?d:-d),d=0,u}},He=function(t,e){return t.getNode(e).data.width||0},Ke=function(t,e){var r,n=Ht(t);!function(t,e){var r=(e||{}).ranksep,n=void 0===r?0:r,o=Yt(t),i=0;null==o||o.forEach((function(e){var r=e.map((function(e){return t.getNode(e).data.height})),o=Math.max.apply(Math,u(u([],s(r)),[0]));null==e||e.forEach((function(e){t.getNode(e).data.y=i+o/2})),i+=o+n}))}(n,e);var o=function(t,e){var r=e||{},n=r.align,o=r.nodesep,i=void 0===o?0:o,a=r.edgesep,d=void 0===a?0:a,h=Yt(t),c=Object.assign(function(t,e){var r={};return(null==e?void 0:e.length)&&e.reduce((function(e,n){var o=0,i=0,a=e.length,s=null==n?void 0:n[(null==n?void 0:n.length)-1];return null==n||n.forEach((function(e,u){var d,h=Ge(t,e),c=h?t.getNode(h.id).data.order:a;(h||e===s)&&(null===(d=n.slice(i,u+1))||void 0===d||d.forEach((function(e){var n;null===(n=t.getPredecessors(e))||void 0===n||n.forEach((function(n){var i,a=t.getNode(n.id),s=a.data.order;!(s<o||c<s)||a.data.dummy&&(null===(i=t.getNode(e))||void 0===i?void 0:i.data.dummy)||We(r,n.id,e)}))})),i=u+1,o=c)})),n})),r}(t,h),Ve(t,h)),l={},f=[];["u","d"].forEach((function(e){f="u"===e?h:Object.values(h).reverse(),["l","r"].forEach((function(r){"r"===r&&(f=f.map((function(t){return Object.values(t).reverse()})));var n=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),o=function(t,e,r,n){var o={},i={},a={};return null==e||e.forEach((function(t){null==t||t.forEach((function(t,e){o[t]=t,i[t]=t,a[t]=e}))})),null==e||e.forEach((function(t){var e=-1;null==t||t.forEach((function(t){var s=n(t).map((function(t){return t.id}));if(s.length){s=s.sort((function(t,e){return a[t]-a[e]}));for(var u=(s.length-1)/2,d=Math.floor(u),h=Math.ceil(u);d<=h;++d){var c=s[d];i[t]===t&&e<a[c]&&!Be(r,t,c)&&(i[c]=t,i[t]=o[t]=o[c],e=a[c])}}}))})),{root:o,align:i}}(0,f,c,n),a=function(t,e,r,n,o,i,a){var s,u={},d=$e(t,e,r,o,i,a),h=a?"borderLeft":"borderRight",c=function(t,e){for(var r=d.getAllNodes(),n=r.pop(),o={};n;)o[n.id]?t(n.id):(o[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return c((function(t){u[t]=(d.getRelatedEdges(t,"in")||[]).reduce((function(t,e){return Math.max(t,(u[e.source]||0)+e.data.weight)}),0)}),d.getPredecessors.bind(d)),c((function(e){var r=(d.getRelatedEdges(e,"out")||[]).reduce((function(t,e){return Math.min(t,(u[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==h&&(u[e]=Math.max(u[e],r))}),d.getSuccessors.bind(d)),null===(s=Object.values(n))||void 0===s||s.forEach((function(t){u[t]=u[r[t]]})),u}(t,f,o.root,o.align,i,d,"r"===r);"r"===r&&Object.keys(a).forEach((function(t){return a[t]=-a[t]})),l[e+r]=a}))}));var g=function(t,e){return Qt(Object.values(e),(function(e){var r,n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach((function(r){var i=e[r],a=He(t,r)/2;n=Math.max(i+a,n),o=Math.min(i-a,o)})),n-o}))}(t,l);return g&&function(t,e){var r=Object.values(e),n=Math.min.apply(Math,u([],s(r))),o=Math.max.apply(Math,u([],s(r)));["u","d"].forEach((function(r){["l","r"].forEach((function(i){var a,d=r+i,h=t[d];if(h!==e){var c=Object.values(h);(a="l"===i?n-Math.min.apply(Math,u([],s(c))):o-Math.max.apply(Math,u([],s(c))))&&(t[d]={},Object.keys(h).forEach((function(e){t[d][e]=h[e]+a})))}}))}))}(l,g),function(t,e){var r={};return Object.keys(t.ul).forEach((function(n){if(e)r[n]=t[e.toLowerCase()][n];else{var o=Object.values(t).map((function(t){return t[n]}));r[n]=(o[0]+o[1])/2}})),r}(l,n)}(n,e);null===(r=Object.keys(o))||void 0===r||r.forEach((function(t){n.getNode(t).data.x=o[t]}))},Ye=function(t,e){var r=e.acyclicer,o=e.ranker,i=e.rankdir,a=void 0===i?"tb":i,d=e.nodeOrder,h=e.keepNodeOrder,c=e.align,f=e.nodesep,g=void 0===f?50:f,p=e.edgesep,v=void 0===p?20:p,y=e.ranksep,m=void 0===y?50:y;dr(t),Bt(t,r);var w=function(t){var e=Ut(t,"root",{},"_root"),r=function(t){var e={},r=function(n,o){var i=t.getChildren(n);null==i||i.forEach((function(t){return r(t.id,o+1)})),e[n]=o};return t.getRoots().forEach((function(t){return r(t.id,1)})),e}(t),n=Math.max.apply(Math,u([],s(Object.values(r))));Math.abs(n)===1/0&&(n=1);var o=n-1,i=2*o+1;t.getAllEdges().forEach((function(t){t.data.minlen*=i}));var a=function(t){var e=0;return t.getAllEdges().forEach((function(t){e+=t.data.weight})),e}(t)+1;return t.getRoots().forEach((function(n){Ee(t,e,i,a,o,r,n.id)})),{nestingRoot:e,nodeRankFactor:i}}(t),x=w.nestingRoot,E=w.nodeRankFactor;!function(t,e){switch(e){case"network-simplex":xe(t);break;case"tight-tree":default:!function(t){!function(t){var e,r={},n=function(o){var i,a,s=t.getNode(o);return s?r[o]?s.data.rank:(r[o]=!0,null===(i=t.getRelatedEdges(o,"out"))||void 0===i||i.forEach((function(t){var e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),(void 0===e||a<e)&&(e=a),s.data.rank=a,a):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){t&&n(t.id)})),void 0===e&&(e=0);var o={},i=function(e,r){var n,a=t.getNode(e),s=isNaN(a.data.layer)?r:a.data.layer;(void 0===a.data.rank||a.data.rank<s)&&(a.data.rank=s),o[e]||(o[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach((function(t){i(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((function(t){var r=t.data;r&&(isNaN(r.layer)?r.rank-=e:i(t.id,r.layer))}))}(t),function(t){var e,r,n=new l({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);ie(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r)}(t)}(t);break;case"longest-path":we(t)}}(Ht(t),o),er(t),function(t,e){void 0===e&&(e=0);var r=t.getAllNodes(),n=r.filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),o=Math.min.apply(Math,u([],s(n))),i=[];r.forEach((function(t){var e=(t.data.rank||0)-o;i[e]||(i[e]=[]),i[e].push(t.id)}));for(var a=0,d=0;d<i.length;d++){var h=i[d];void 0===h?d%e!=0&&(a-=1):a&&(null==h||h.forEach((function(e){var r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=a)})))}}(t,E),function(t,e){e&&t.removeNode(e),t.getAllEdges().forEach((function(e){e.data.nestingEdge&&t.removeEdge(e.id)}))}(t,x),function(t){var e=t.getAllNodes().filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),r=Math.min.apply(Math,u([],s(e)));t.getAllNodes().forEach((function(t){t.data.hasOwnProperty("rank")&&r!==1/0&&(t.data.rank-=r)}))}(t),rr(t),nr(t);var b=[];!function(t,e){t.getAllEdges().forEach((function(r){return function(t,e,r){var n=e.source,o=t.getNode(n).data.rank,i=e.target,a=t.getNode(i).data.rank,s=e.data.labelRank;if(a!==o+1){var u,d,h;for(t.removeEdge(e.id),h=0,++o;o<a;++h,++o)e.data.points=[],u=Ut(t,"edge",d={originalEdge:e,width:0,height:0,rank:o},"_d"),o===s&&(d.width=e.data.width,d.height=e.data.height,d.dummy=ee,d.labelpos=e.data.labelpos),t.addEdge({id:"e"+Math.random(),source:n,target:u,data:{weight:e.data.weight}}),0===h&&r.push(u),n=u;t.addEdge({id:"e"+Math.random(),source:n,target:i,data:{weight:e.data.weight}})}}(t,r,e)}))}(t,b),function(t,e){var r=function(t){var e={},r=0,n=function(o){var i=r;t.getChildren(o).forEach((function(t){return n(t.id)})),e[o]={low:i,lim:r++}};return t.getRoots().forEach((function(t){return n(t.id)})),e}(t);e.forEach((function(e){var n,o,i=e,a=t.getNode(i),s=a.data.originalEdge;if(s)for(var u=function(t,e,r,n){var o,i,a,s,u=[],d=[],h=Math.min(e[r].low,e[n].low),c=Math.max(e[r].lim,e[n].lim);a=r;do{a=null===(o=t.getParent(a))||void 0===o?void 0:o.id,u.push(a)}while(a&&(e[a].low>h||c>e[a].lim));for(s=a,a=n;a&&a!==s;)d.push(a),a=null===(i=t.getParent(a))||void 0===i?void 0:i.id;return{lca:s,path:u.concat(d.reverse())}}(t,r,s.source,s.target),d=u.path,h=u.lca,c=0,l=d[c],f=!0;i!==s.target;){if(a=t.getNode(i),f){for(;l!==h&&(null===(n=t.getNode(l))||void 0===n?void 0:n.data.maxRank)<a.data.rank;)l=d[++c];l===h&&(f=!1)}if(!f){for(;c<d.length-1&&(null===(o=t.getNode(d[c+1]))||void 0===o?void 0:o.data.minRank)<=a.data.rank;)c++;l=d[c]}t.hasNode(l)&&t.setParent(i,l),i=t.getSuccessors(i)[0].id}}))}(t,b),function(t){var e=function(r){var n=t.getChildren(r),o=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach((function(t){return e(t.id)})),o.data.hasOwnProperty("minRank")){o.data.borderLeft=[],o.data.borderRight=[];for(var i=o.data.minRank,a=o.data.maxRank+1;i<a;i+=1)be(t,"borderLeft","_bl",r,o,i),be(t,"borderRight","_br",r,o,i)}};t.getRoots().forEach((function(t){return e(t.id)}))}(t),h&&function(t,e){for(var r=t.getAllNodes().filter((function(e){var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)})).map((function(t){return t.data.rank})),n=Math.max.apply(Math,u([],s(r))),o=[],i=0;i<n+1;i++)o[i]=[];null==e||e.forEach((function(e){var r=t.getNode(e);r&&!r.data.dummy&&(isNaN(r.data.rank)||(r.data.fixorder=o[r.data.rank].length,o[r.data.rank].push(e)))}))}(t,d),function(t,e){for(var r=Xt(t),n=[],o=[],i=1;i<r+1;i++)n.push(i);for(i=r-1;i>-1;i--)o.push(i);var a=qe(t,n,"in"),s=qe(t,o,"out"),u=Ae(t);Fe(t,u);for(var d,h=Number.POSITIVE_INFINITY,c=(i=0,0);c<4;++i,++c)je(i%2?a:s,i%4>=2,!1,e),u=Yt(t),(l=Ie(t,u))<h&&(c=0,d=Le(u),h=l);for(u=Ae(t),Fe(t,u),i=0,c=0;c<4;++i,++c){var l;je(i%2?a:s,i%4>=2,!0,e),u=Yt(t),(l=Ie(t,u))<h&&(c=0,d=Le(u),h=l)}Fe(t,d)}(t,h),hr(t),function(t,e){var r=e.toLowerCase();"lr"!==r&&"rl"!==r||Ne(t)}(t,a),Ke(t,{align:c,nodesep:g,edgesep:v,ranksep:m}),cr(t),ur(t),function(t,e){e.forEach((function(e){var r,n=t.getNode(e),o=n.data.originalEdge;o&&t.addEdge(o);for(var i=e;n.data.dummy;)r=t.getSuccessors(i)[0],t.removeNode(i),o.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===ee&&(o.data.x=n.data.x,o.data.y=n.data.y,o.data.width=n.data.width,o.data.height=n.data.height),i=r.id,n=t.getNode(i)}))}(t,b),ar(t),function(t,e){var r=e.toLowerCase();"bt"!==r&&"rl"!==r||function(t){t.getAllNodes().forEach((function(t){Se(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return Se(t)})),t.data.hasOwnProperty("y")&&Se(t.data)}))}(t),"lr"!==r&&"rl"!==r||(function(t){t.getAllNodes().forEach((function(t){ke(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return ke(t)})),t.data.hasOwnProperty("x")&&ke(t.data)}))}(t),Ne(t))}(t,a);var N=or(t),M=N.width,S=N.height;return ir(t),sr(t),function(t){t.getAllEdges().forEach((function(e){var r=e.data;if(r.reversed){t.removeEdge(e.id);var o=r.forwardName;delete r.reversed,delete r.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:n(n({},r),{forwardName:o})})}}))}(t),{width:M,height:S}},Je=["width","height","layer","fixorder"],Xe={width:0,height:0},Qe=["minlen","weight","width","height","labeloffset"],Ze={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},tr=["labelpos"],er=function(t){t.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var r=t.getNode(e.source),n={e,rank:(t.getNode(e.target).data.rank-r.data.rank)/2+r.data.rank};Ut(t,"edge-proxy",n,"_ep")}}))},rr=function(t){var e=0;return t.getAllNodes().forEach((function(r){var n,o;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(o=t.getNode(r.data.borderBottom))||void 0===o?void 0:o.data.rank,e=Math.max(e,r.data.maxRank||-1/0))})),e},nr=function(t){t.getAllNodes().forEach((function(e){"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},or=function(t,e){var r,n,o=0,i=0,a=e||{},s=a.marginx,u=void 0===s?0:s,d=a.marginy,h=void 0===d?0:d,c=function(t){if(t.data){var e=t.data.x,a=t.data.y,s=t.data.width,u=t.data.height;isNaN(e)||isNaN(s)||(void 0===r&&(r=e-s/2),r=Math.min(r,e-s/2),o=Math.max(o,e+s/2)),isNaN(a)||isNaN(u)||(void 0===n&&(n=a-u/2),n=Math.min(n,a-u/2),i=Math.max(i,a+u/2))}};return t.getAllNodes().forEach((function(t){c(t)})),t.getAllEdges().forEach((function(t){(null==t?void 0:t.data.hasOwnProperty("x"))&&c(t)})),r-=u,n-=h,t.getAllNodes().forEach((function(t){t.data.x-=r,t.data.y-=n})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){t.x-=r,t.y-=n})),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)})),{width:o-r+u,height:i-n+h}},ir=function(t){t.getAllEdges().forEach((function(e){var r,n,o=t.getNode(e.source),i=t.getNode(e.target);e.data.points?(r=e.data.points[0],n=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:i.data.x,y:i.data.y},n={x:o.data.x,y:o.data.y}),e.data.points.unshift(Kt(o.data,r)),e.data.points.push(Kt(i.data,n))}))},ar=function(t){t.getAllEdges().forEach((function(t){if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},sr=function(t){t.getAllEdges().forEach((function(t){var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},ur=function(t){t.getAllNodes().forEach((function(e){var r,n,o;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){var i=t.getNode(e.id),a=t.getNode(i.data.borderTop),s=t.getNode(i.data.borderBottom),u=t.getNode(i.data.borderLeft[(null===(n=i.data.borderLeft)||void 0===n?void 0:n.length)-1]),d=t.getNode(i.data.borderRight[(null===(o=i.data.borderRight)||void 0===o?void 0:o.length)-1]);i.data.width=Math.abs((null==d?void 0:d.data.x)-(null==u?void 0:u.data.x))||10,i.data.height=Math.abs((null==s?void 0:s.data.y)-(null==a?void 0:a.data.y))||10,i.data.x=((null==u?void 0:u.data.x)||0)+i.data.width/2,i.data.y=((null==a?void 0:a.data.y)||0)+i.data.height/2}})),t.getAllNodes().forEach((function(e){"border"===e.data.dummy&&t.removeNode(e.id)}))},dr=function(t){t.getAllEdges().forEach((function(e){if(e.source===e.target){var r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}}))},hr=function(t){var e=Yt(t);null==e||e.forEach((function(e){var r=0;null==e||e.forEach((function(e,n){var o,i=t.getNode(e);i.data.order=n+r,null===(o=i.data.selfEdges)||void 0===o||o.forEach((function(e){Ut(t,"selfedge",{width:e.data.width,height:e.data.height,rank:i.data.rank,order:n+ ++r,e},"_se")})),delete i.data.selfEdges}))}))},cr=function(t){t.getAllNodes().forEach((function(e){var r=t.getNode(e.id);if("selfedge"===r.data.dummy){var n=t.getNode(r.data.e.source),o=n.data.x+n.data.width/2,i=n.data.y,a=r.data.x-o,s=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}}))},lr=function(t,e){var r={};return null==e||e.forEach((function(e){void 0!==t[e]&&(r[e]=+t[e])})),r},fr=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(r){e[r.toLowerCase()]=t[r]})),e},gr={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="dagre",this.layoutNode=function(t){return!1!==t.data.layout},this.options=n(n({},gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericDagreLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericDagreLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericDagreLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,E,N,M,k,R,I,_,D,O,P,T,z,C,L,q,j,F,V,G,W=this;return a(this,(function(a){return o=n(n({},this.options),r),i=o.nodeSize,s=o.align,u=o.rankdir,d=void 0===u?"TB":u,h=o.ranksep,c=o.nodesep,f=o.ranksepFunc,g=o.nodesepFunc,p=o.edgeLabelSpace,v=o.nodeOrder,y=o.begin,m=o.controlPoints,w=o.radial,E=new l({tree:[]}),N=S(h||50,f),M=S(c||50,g),k=M,R=N,"LR"!==d&&"RL"!==d||(k=N,R=M),I=A(i,void 0),_=e.getAllNodes(),D=e.getAllEdges(),_.filter((function(t){return!1!==t.data.layout})).forEach((function(t){var e=I(t),r=R(t),n=e+2*k(t),o=e+2*r,i=t.data.layer;x(i)?E.addNode({id:t.id,data:{width:n,height:o,layer:i}}):E.addNode({id:t.id,data:{width:n,height:o}})})),D.forEach((function(t){W.layoutNode(E.getNode(t.source))&&W.layoutNode(E.getNode(t.target))&&E.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),function(t,e){var r,o,i=e.edgeLabelSpace,a=e.keepNodeOrder,s=e.prevGraph,u=e.rankdir,d=e.ranksep;!a&&s&&(o=s,(r=t).getAllNodes().forEach((function(t){var e=r.getNode(t.id),n=o.getNode(t.id);void 0!==n?(e.data.fixorder=n.data._order,delete n.data._order):delete e.data.fixorder})));var h=function(t){var e=new l({tree:[]});return t.getAllNodes().forEach((function(r){var o=fr(t.getNode(r.id).data),i=n(n({},Xe),o),a=lr(i,Je);e.hasNode(r.id)||e.addNode({id:r.id,data:n({},a)});var s=t.getParent(r.id);null==s||(e.hasNode(s.id)||e.addNode(n({},s)),e.setParent(r.id,s.id))})),t.getAllEdges().forEach((function(r){var n=fr(t.getEdge(r.id).data),o={};null==tr||tr.forEach((function(t){void 0!==n[t]&&(o[t]=n[t])})),e.addEdge({id:r.id,source:r.source,target:r.target,data:Object.assign({},Ze,lr(n,Qe),o)})})),e}(t);!1!==i&&(e.ranksep=function(t,e){var r=e.ranksep,n=void 0===r?0:r,o=e.rankdir;return t.getAllNodes().forEach((function(t){isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((function(t){var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===o||"BT"===o?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2}(h,{rankdir:u,ranksep:d}));try{Ye(h,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph\'s structure:\\n",t);throw t}!function(t,e){t.getAllNodes().forEach((function(r){var n,o=t.getNode(r.id);if(o){var i=e.getNode(r.id);o.data.x=i.data.x,o.data.y=i.data.y,o.data._order=i.data.order,o.data._rank=i.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(o.data.width=i.data.width,o.data.height=i.data.height)}})),t.getAllEdges().forEach((function(r){var n=t.getEdge(r.id),o=e.getEdge(r.id);n.data.points=o?o.data.points:[],o&&o.data.hasOwnProperty("x")&&(n.data.x=o.data.x,n.data.y=o.data.y)}))}(t,h)}(E,{prevGraph:null,edgeLabelSpace:p,keepNodeOrder:!!v,nodeOrder:v||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:d,nodesep:c,align:s}),O=[0,0],y&&(P=1/0,T=1/0,E.getAllNodes().forEach((function(t){P>t.data.x&&(P=t.data.x),T>t.data.y&&(T=t.data.y)})),E.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){P>t.x&&(P=t.x),T>t.y&&(T=t.y)}))})),O[0]=y[0]-P,O[1]=y[1]-T),z="LR"===d||"RL"===d,w||(C=new Set,L="BT"===d||"RL"===d?function(t,e){return e-t}:function(t,e){return t-e},E.getAllNodes().forEach((function(t){t.data.x=t.data.x+O[0],t.data.y=t.data.y+O[1],C.add(z?t.data.x:t.data.y)})),q=Array.from(C).sort(L),j=z?function(t,e){return t.x!==e.x}:function(t,e){return t.y!==e.y},F=z?function(t,e,r){var n=Math.max(e.y,r.y),o=Math.min(e.y,r.y);return t.filter((function(t){return t.y<=n&&t.y>=o}))}:function(t,e,r){var n=Math.max(e.x,r.x),o=Math.min(e.x,r.x);return t.filter((function(t){return t.x<=n&&t.x>=o}))},E.getAllEdges().forEach((function(t,e){var r;p&&m&&"loop"!==t.data.type&&(t.data.controlPoints=vr(null===(r=t.data.points)||void 0===r?void 0:r.map((function(t){var e=t.x,r=t.y;return{x:e+O[0],y:r+O[1]}})),E.getNode(t.source),E.getNode(t.target),q,z,j,F))}))),V=[],V=E.getAllNodes().map((function(t){return b(t)})),G=E.getAllEdges(),t&&(V.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),G.forEach((function(t){e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),[2,{nodes:V,edges:G}]}))}))},t}(),vr=function(t,e,r,n,o,i,a){var s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){var u=e.data,d=u.x,h=u.y,c=r.data,l=c.x,f=c.y;if(o&&(d=e.data.y,h=e.data.x,l=r.data.y,f=r.data.x),f!==h&&d!==l){var g=n.indexOf(h),p=n[g+1];if(p){var v=s[0],y=o?{x:(h+p)/2,y:(null==v?void 0:v.y)||l}:{x:(null==v?void 0:v.x)||l,y:(h+p)/2};v&&!i(v,y)||s.unshift(y)}var m=n.indexOf(f),w=Math.abs(m-g);if(1===w)(s=a(s,e.data,r.data)).length||s.push(o?{x:(h+f)/2,y:d}:{x:d,y:(h+f)/2});else if(w>1){var x=n[m-1];if(x){var E=s[s.length-1],b=o?{x:(f+x)/2,y:(null==E?void 0:E.y)||l}:{x:(null==E?void 0:E.x)||d,y:(f+x)/2};E&&!i(E,b)||s.push(b)}}}}return s};function yr(t){var e=0,r=0,n=0;if(t.length){for(var o=0;o<4;o++)(i=t[o])&&i.weight&&(e+=i.weight,r+=i.x*i.weight,n+=i.y*i.weight);t.x=r/e,t.y=n/e,t.weight=e}else{var i=t;t.x=i.data.x,t.y=i.data.y,t.weight=i.data.weight}}var mr=function(t,e,r,n,o,i){var a=i.x-t.x||.1,s=i.y-t.y||.1,u=n-e,d=a*a+s*s,h=Math.sqrt(d)*d;if(u*u*.81<d){var c=t.weight/h;return i.vx+=a*c,i.vy+=s*c,!0}if(t.length)return!1;t.data!==i&&(c=t.data.weight/h,i.vx+=a*c,i.vy+=s*c)},wr={maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},xr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=n(n({},wr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,E,b,N,M,S,k=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=this.formatOptions(o,e),d=u.width,h=u.height,c=u.nodeSize,f=u.getMass,g=u.nodeStrength,p=u.edgeStrength,v=u.linkDistance,y=i.map((function(t){return n(n({},t),{data:n(n({},t.data),{x:x(t.data.x)?t.data.x:Math.random()*d,y:x(t.data.y)?t.data.y:Math.random()*h,size:c(t)||30,mass:f(t),nodeStrength:g(t)})})})),m=s.map((function(t){return n(n({},t),{data:n(n({},t.data),{edgeStrength:p(t),linkDistance:v(t,e.getNode(t.source),e.getNode(t.target))})})})),(null==i?void 0:i.length)?(w={},i.forEach((function(t,e){w[t.id]={x:0,y:0}})),E=new l({nodes:y,edges:m}),this.formatCentripetal(u,E),b=u.maxIteration,N=u.minMovement,M=u.onTick,this.lastLayoutNodes=y,this.lastLayoutEdges=m,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=E,this.lastOptions=u,this.lastVelMap=w,"undefined"==typeof window?[2]:(S=0,[2,new Promise((function(r){k.timeInterval=window.setInterval((function(){i&&k.running||r({nodes:Sr(e,y),edges:s}),k.runOneStep(E,e,S,w,u),k.updatePosition(e,E,w,u),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),null==M||M({nodes:Sr(e,y),edges:s}),(++S>=b||k.judgingDistance<N)&&(window.clearInterval(k.timeInterval),r({nodes:Sr(e,y),edges:s}))}),0),k.running=!0}))])):(this.lastResult={nodes:[],edges:s},[2,{nodes:[],edges:s}])}))}))},t.prototype.formatOptions=function(t,e){var r=t,n=t.width,o=t.height,i=t.getMass;if(r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=o||"undefined"==typeof window?o:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),i||(r.getMass=function(t){var r=1;x(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);var n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),t.preventOverlap){var a=S(0,t.nodeSpacing);t.nodeSize?g(t.nodeSize)?r.nodeSize=function(e){var r=t.nodeSize;return Math.max(r[0],r[1])+a(e)}:r.nodeSize=function(e){return t.nodeSize+a(e)}:r.nodeSize=function(t){var e=((null==t?void 0:t.data)||{}).size;return e?g(e)?Math.max(e[0],e[1])+a(t):M(e)?Math.max(e.width,e.height)+a(t):e+a(t):10+a(t)}}return r.linkDistance=t.linkDistance?S(1,t.linkDistance):function(t){return 1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target))},r.nodeStrength=S(1,t.nodeStrength),r.edgeStrength=S(1,t.edgeStrength),t},t.prototype.formatCentripetal=function(t,e){var r,n=t.centripetalOptions,o=t.center,i=t.clusterNodeStrength,a=t.leafCluster,s=t.clustering,u=t.nodeClusterBy,d=e.getAllNodes(),h=n||{leaf:2,single:2,others:1,center:function(t){return{x:o[0],y:o[1]}}};"function"!=typeof i&&(t.clusterNodeStrength=function(t){return i});var c=[];if(a&&u&&(r=Er(e,u),c=Array.from(new Set(null==d?void 0:d.map((function(t){return t.data[u]}))))||[],t.centripetalOptions=Object.assign(h,{single:100,leaf:function(e){var n=r[e.id]||{},o=n.siblingLeaves,i=n.sameTypeLeaves;return(null==i?void 0:i.length)===(null==o?void 0:o.length)||1===(null==c?void 0:c.length)?1:t.clusterNodeStrength(e)},others:1,center:function(t){var n,o=e.getDegree(t.id,"both");if(!o)return{x:100,y:100};if(1===o){var i=(r[t.id]||{}).sameTypeLeaves,a=void 0===i?[]:i;1===a.length?n=void 0:a.length>1&&(n=Mr(a))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y}}})),s&&u){r||(r=Er(e,u)),c||(c=Array.from(new Set(d.map((function(t){return t.data[u]}))))),c=c.filter((function(t){return void 0!==t}));var l={};c.forEach((function(t){var r=d.filter((function(e){return e.data[u]===t})).map((function(t){return e.getNode(t.id)}));l[t]=Mr(r)})),t.centripetalOptions=Object.assign(h,{single:function(e){return t.clusterNodeStrength(e)},leaf:function(e){return t.clusterNodeStrength(e)},others:function(e){return t.clusterNodeStrength(e)},center:function(t){var e=l[t.data[u]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y}}})}var f=t.centripetalOptions||{},g=f.leaf,p=f.single,v=f.others;g&&"function"!=typeof g&&(t.centripetalOptions.leaf=function(){return g}),p&&"function"!=typeof p&&(t.centripetalOptions.single=function(){return p}),v&&"function"!=typeof v&&(t.centripetalOptions.others=function(){return v})},t.prototype.runOneStep=function(t,e,r,n,o){var i={},a=t.getAllNodes(),s=t.getAllEdges();if(null==a?void 0:a.length){var u=o.monitor;this.calRepulsive(t,i,o),s&&this.calAttractive(t,i),this.calGravity(t,e,i,o),this.updateVelocity(t,i,n,o),u&&u({energy:this.calTotalEnergy(i,a),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}},t.prototype.calTotalEnergy=function(t,e){if(!(null==e?void 0:e.length))return 0;var r=0;return e.forEach((function(e,n){var o=t[e.id].x,i=t[e.id].y,a=o*o+i*i,s=e.data.mass;r+=(void 0===s?1:s)*a*.5})),r},t.prototype.calRepulsive=function(t,e,r){var n=r.factor,o=r.coulombDisScale;!function(t,e,r,n){var o=e/r,i=t.getAllNodes(),a=i.map((function(t,e){var r=t.data,n=r.nodeStrength;return{x:r.x,y:r.y,size:r.size,index:e,vx:0,vy:0,weight:o*n}})),s=F(a,(function(t){return t.x}),(function(t){return t.y})).visitAfter(yr);a.forEach((function(t){!function(t,e){e.visit((function(e,r,n,o,i){return mr(e,r,n,o,i,t)}))}(t,s)})),a.map((function(t,e){var r=i[e],o=r.id,a=r.data.mass,s=void 0===a?1:a;n[o]={x:t.vx/s,y:t.vy/s}}))}(t,n,o*o,e)},t.prototype.calAttractive=function(t,e){t.getAllEdges().forEach((function(r,n){var o=r.source,i=r.target,a=t.getNode(o),s=t.getNode(i);if(a&&s){var u=s.data.x-a.data.x,d=s.data.y-a.data.y;u||d||(u=.01*Math.random(),d=.01*Math.random());var h=Math.sqrt(u*u+d*d),c=u/h,l=d/h,f=r.data||{},g=f.linkDistance,p=void 0===g?200:g,v=f.edgeStrength,y=(p-h)*(void 0===v?200:v),m=1/(a.data.mass||1),w=1/(s.data.mass||1),x=c*y,E=l*y;e[o].x-=x*m,e[o].y-=E*m,e[i].x+=x*w,e[i].y+=E*w}}))},t.prototype.calGravity=function(t,e,r,n){var o=n.getCenter,i=t.getAllNodes(),a=e.getAllNodes(),u=e.getAllEdges(),d=n.width,h=n.height,c=n.center,l=n.gravity,f=n.centripetalOptions;i&&i.forEach((function(n){var i=n.id,g=n.data,p=g.mass,v=g.x,y=g.y,m=e.getNode(i),w=0,E=0,b=l,N=t.getDegree(i,"in"),M=t.getDegree(i,"out"),S=t.getDegree(i,"both"),k=null==o?void 0:o(m,S);if(k){var A=s(k,3);w=v-A[0],E=y-A[1],b=A[2]}else w=v-c[0],E=y-c[1];if(b&&(r[i].x-=b*w/p,r[i].y-=b*E/p),f){var R=f.leaf,I=f.single,_=f.others,D=f.center,O=(null==D?void 0:D(m,a,u,d,h))||{x:0,y:0,centerStrength:0},P=O.x,T=O.y,z=O.centerStrength;if(!x(P)||!x(T))return;var C=(v-P)/p,L=(y-T)/p;if(z&&(r[i].x-=z*C,r[i].y-=z*L),0===S){var q=I(m);if(!q)return;return r[i].x-=q*C,void(r[i].y-=q*L)}if(0===N||0===M){var j=R(m,a,u);if(!j)return;return r[i].x-=j*C,void(r[i].y-=j*L)}var F=_(m);if(!F)return;r[i].x-=F*C,r[i].y-=F*L}}))},t.prototype.updateVelocity=function(t,e,r,n){var o=n.damping,i=n.maxSpeed,a=n.interval,s=t.getAllNodes();(null==s?void 0:s.length)&&s.forEach((function(t){var n=t.id,s=(r[n].x+e[n].x*a)*o||.01,u=(r[n].y+e[n].y*a)*o||.01,d=Math.sqrt(s*s+u*u);if(d>i){var h=i/d;s*=h,u*=h}r[n]={x:s,y:u}}))},t.prototype.updatePosition=function(t,e,r,n){var o=this,i=n.distanceThresholdMode,a=n.interval,s=e.getAllNodes();if(null==s?void 0:s.length){var u=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),s.forEach((function(n){var s=n.id,d=t.getNode(s);if(x(d.data.fx)&&x(d.data.fy))e.mergeNodeData(s,{x:d.data.fx,y:d.data.fy});else{var h=r[s].x*a,c=r[s].y*a;e.mergeNodeData(s,{x:n.data.x+h,y:n.data.y+c});var l=Math.sqrt(h*h+c*c);switch(i){case"max":o.judgingDistance<l&&(o.judgingDistance=l);break;case"min":o.judgingDistance>l&&(o.judgingDistance=l);break;default:u+=l}}})),i&&"mean"!==i||(this.judgingDistance=u/s.length)}else this.judgingDistance=0},t}(),Er=function(t,e){var r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};var n={};return r.forEach((function(r,o){1===t.getDegree(r.id,"both")&&(n[r.id]=br(t,"leaf",r,e))})),n},br=function(t,e,r,n){var o=t.getDegree(r.id,"in"),i=t.getDegree(r.id,"out"),a=r,s=[];return 0===o?(a=t.getSuccessors(r.id)[0],s=t.getNeighbors(a.id)):0===i&&(a=t.getPredecessors(r.id)[0],s=t.getNeighbors(a.id)),s=s.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")})),{coreNode:a,siblingLeaves:s,sameTypeLeaves:Nr(t,e,n,r,s)}},Nr=function(t,e,r,n,o){var i=n.data[r]||"",a=(null==o?void 0:o.filter((function(t){return t.data[r]===i})))||[];return"leaf"===e&&(a=a.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")}))),a},Mr=function(t){var e={x:0,y:0};t.forEach((function(t){var r=t.data,n=r.x,o=r.y;e.x+=n||0,e.y+=o||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},Sr=function(t,e){return e.map((function(e){var r=e.id,o=e.data,i=t.getNode(r);return n(n({},i),{data:n(n({},i.data),{x:o.x,y:o.y})})}))},kr=function(){function t(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}return t.prototype.distanceTo=function(t){var e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)},t.prototype.setPos=function(t,e){this.rx=t,this.ry=e},t.prototype.resetForce=function(){this.fx=0,this.fy=0},t.prototype.addForce=function(t){var e=t.rx-this.rx,r=t.ry-this.ry,n=Math.hypot(e,r);n=n<1e-4?1e-4:n;var o=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=o*e/n,this.fy+=o*r/n},t.prototype.in=function(t){return t.contains(this.rx,this.ry)},t.prototype.add=function(e){var r=this.mass+e.mass;return new t({rx:(this.rx*this.mass+e.rx*e.mass)/r,ry:(this.ry*this.mass+e.ry*e.mass)/r,mass:r,degree:this.degree+e.degree})},t}();const Ar=kr;const Rr=function(){function t(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}return t.prototype.getLength=function(){return this.length},t.prototype.contains=function(t,e){var r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r},t.prototype.NW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.NE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.SW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t.prototype.SE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t}(),Ir=function(){function t(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}return t.prototype.insert=function(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e},t.prototype._putBody=function(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))},t.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},t.prototype.updateForce=function(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))},t}();var _r={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Dr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2",this.options=n(n({},_r),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,x,E,N,M,S,k,A,I;return a(this,(function(a){if(o=e.getAllEdges(),i=e.getAllNodes(),s=this.formatOptions(r,i.length),u=s.width,d=s.height,h=s.prune,c=s.maxIteration,f=s.nodeSize,g=s.center,!(null==i?void 0:i.length)||1===i.length)return[2,R(e,t,g)];if(p=i.map((function(t){return b(t,[u,d])})),v=o.filter((function(t){return t.source!==t.target})),y=new l({nodes:p,edges:v}),m=this.getSizes(y,e,f),this.run(y,e,c,m,t,s),h){for(w=0;w<v.length;w+=1)x=v[w],E=x.source,N=x.target,M=y.getDegree(E),S=y.getDegree(E),M<=1?(k=y.getNode(N),y.mergeNodeData(E,{x:k.data.x,y:k.data.y})):S<=1&&(A=y.getNode(E),y.mergeNodeData(N,{x:A.data.x,y:A.data.y}));I=n(n({},s),{prune:!1,barnesHut:!1}),this.run(y,e,100,m,t,I)}return[2,{nodes:p,edges:o}]}))}))},t.prototype.getSizes=function(t,e,r){for(var n=t.getAllNodes(),o={},i=0;i<n.length;i+=1){var a=n[i],d=a.id,h=a.data;if(o[d]=10,x(h.size))o[d]=h.size;else if(g(h.size))isNaN(h.size[0])||(o[d]=Math.max(h.size[0])),isNaN(h.size[1])||(o[d]=Math.max(h.size[1]));else if(M(h.size))o[d]=Math.max(h.size.width,h.size.height);else if(N(r)){var c=r(e.getNode(d));g(c)?o[d]=Math.max.apply(Math,u([],s(c))):o[d]=c}else g(r)?o[d]=Math.max.apply(Math,u([],s(r))):x(r)&&(o[d]=r)}return o},t.prototype.formatOptions=function(t,e){void 0===t&&(t={});var r=n(n({},this.options),t),o=r.center,i=r.width,a=r.height,s=r.barnesHut,u=r.prune,d=r.maxIteration,h=r.kr,c=r.kg;return r.width=i||"undefined"==typeof window?i:window.innerWidth,r.height=a||"undefined"==typeof window?a:window.innerHeight,r.center=o||[r.width/2,r.height/2],void 0===s&&e>250&&(r.barnesHut=!0),void 0===u&&e>100&&(r.prune=!0),0!==d||u?0===d&&u&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)):(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)),h||(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),c||(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r},t.prototype.run=function(t,e,r,n,o,i){for(var a=i.kr,s=i.barnesHut,u=i.onTick,d=t.getAllNodes(),h=0,c=r,l={},f={},g={},p=0;p<d.length;p+=1){var v=d[p],y=v.data,m=v.id;if(l[m]=[0,0],s){var w={id:p,rx:y.x,ry:y.y,mass:1,g:a,degree:t.getDegree(m)};g[m]=new Ar(w)}}for(;c>0;)h=this.oneStep(t,{iter:c,preventOverlapIters:50,krPrime:100,sg:h,forces:l,preForces:f,bodies:g,sizes:n},i),c--,null==u||u({nodes:d,edges:e.getAllEdges()});return t},t.prototype.oneStep=function(t,e,r){for(var n=e.iter,o=e.preventOverlapIters,i=e.krPrime,a=e.sg,d=e.preForces,h=e.bodies,c=e.sizes,l=e.forces,f=r.preventOverlap,g=r.barnesHut,p=t.getAllNodes(),v=0;v<p.length;v+=1){var y=p[v].id;d[y]=u([],s(l[y])),l[y]=[0,0]}return l=this.getAttrForces(t,n,o,c,l,r),l=g&&(f&&n>o||!f)?this.getOptRepGraForces(t,l,h,r):this.getRepGraForces(t,n,o,l,i,c,r),this.updatePos(t,l,d,a,r)},t.prototype.getAttrForces=function(t,e,r,n,o,i){for(var a=i.preventOverlap,s=i.dissuadeHubs,u=i.mode,d=i.prune,h=t.getAllEdges(),c=0;c<h.length;c+=1){var l=h[c],f=l.source,g=l.target,p=t.getNode(f),v=t.getNode(g),y=t.getDegree(f),m=t.getDegree(g);if(!d||!(y<=1||m<=1)){var w=[v.data.x-p.data.x,v.data.y-p.data.y],x=Math.hypot(w[0],w[1]);x=x<1e-4?1e-4:x,w[0]=w[0]/x,w[1]=w[1]/x,a&&e<r&&(x=x-n[f]-n[g]);var E=x,b=E;"linlog"===u&&(b=E=Math.log(1+x)),s&&(E=x/y,b=x/m),a&&e<r&&x<=0?(E=0,b=0):a&&e<r&&x>0&&(E=x,b=x),o[f][0]+=E*w[0],o[g][0]-=b*w[0],o[f][1]+=E*w[1],o[g][1]-=b*w[1]}}return o},t.prototype.getOptRepGraForces=function(t,e,r,n){for(var o=n.kg,i=n.center,a=n.prune,s=t.getAllNodes(),u=s.length,d=9e10,h=-9e10,c=9e10,l=-9e10,f=0;f<u;f+=1){var g=s[f],p=g.id,v=g.data;a&&t.getDegree(p)<=1||(r[p].setPos(v.x,v.y),v.x>=h&&(h=v.x),v.x<=d&&(d=v.x),v.y>=l&&(l=v.y),v.y<=c&&(c=v.y))}var y=Math.max(h-d,l-c),m=new Rr({xmid:(h+d)/2,ymid:(l+c)/2,length:y,massCenter:i,mass:u}),w=new Ir(m);for(f=0;f<u;f+=1)p=s[f].id,a&&t.getDegree(p)<=1||r[p].in(m)&&w.insert(r[p]);for(f=0;f<u;f+=1){var x=s[f],E=(p=x.id,v=x.data,t.getDegree(p));if(!(a&&E<=1)){r[p].resetForce(),w.updateForce(r[p]),e[p][0]-=r[p].fx,e[p][1]-=r[p].fy;var b=[v.x-i[0],v.y-i[1]],N=Math.hypot(b[0],b[1]);N=N<1e-4?1e-4:N,b[0]=b[0]/N,b[1]=b[1]/N;var M=o*(E+1);e[p][0]-=M*b[0],e[p][1]-=M*b[1]}}return e},t.prototype.getRepGraForces=function(t,e,r,n,o,i,a){for(var s=a.preventOverlap,u=a.kr,d=a.kg,h=a.center,c=a.prune,l=t.getAllNodes(),f=l.length,g=0;g<f;g+=1){for(var p=l[g],v=t.getDegree(p.id),y=g+1;y<f;y+=1){var m=l[y],w=t.getDegree(m.id);if(!c||!(v<=1||w<=1)){var x=[m.data.x-p.data.x,m.data.y-p.data.y],E=Math.hypot(x[0],x[1]);E=E<1e-4?1e-4:E,x[0]=x[0]/E,x[1]=x[1]/E,s&&e<r&&(E=E-i[p.id]-i[m.id]);var b=u*(v+1)*(w+1)/E;s&&e<r&&E<0?b=o*(v+1)*(w+1):s&&e<r&&0===E?b=0:s&&e<r&&E>0&&(b=u*(v+1)*(w+1)/E),n[p.id][0]-=b*x[0],n[m.id][0]+=b*x[0],n[p.id][1]-=b*x[1],n[m.id][1]+=b*x[1]}}var N=[p.data.x-h[0],p.data.y-h[1]],M=Math.hypot(N[0],N[1]);N[0]=N[0]/M,N[1]=N[1]/M;var S=d*(v+1);n[p.id][0]-=S*N[0],n[p.id][1]-=S*N[1]}return n},t.prototype.updatePos=function(t,e,r,n,o){for(var i=o.ks,a=o.tao,s=o.prune,u=o.ksmax,d=t.getAllNodes(),h=d.length,c=[],l=[],f=0,g=0,p=n,v=0;v<h;v+=1){var y=d[v].id,m=t.getDegree(y);if(!(s&&m<=1)){var w=[e[y][0]-r[y][0],e[y][1]-r[y][1]],E=Math.hypot(w[0],w[1]),b=[e[y][0]+r[y][0],e[y][1]+r[y][1]],N=Math.hypot(b[0],b[1]);c[v]=E,l[v]=N/2,f+=(m+1)*c[v],g+=(m+1)*l[v]}}var M=p;for(p=a*g/f,0!==M&&(p=p>1.5*M?1.5*M:p),v=0;v<h;v+=1){var S=d[v],k=(y=S.id,S.data);if(m=t.getDegree(y),!(s&&m<=1||x(k.fx)&&x(k.fy))){var A=i*p/(1+p*Math.sqrt(c[v])),R=Math.hypot(e[y][0],e[y][1]),I=u/(R=R<1e-4?1e-4:R),_=(A=A>I?I:A)*e[y][0],D=A*e[y][1];t.mergeNodeData(y,{x:k.x+_,y:k.y+D})}}return p},t}(),Or={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=n(n({},Or),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),n},t.prototype.genericFruchtermanLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,f,g,p,v,y,m,w,x,E=this;return a(this,(function(a){return this.running?[2]:(o=this.formatOptions(r),i=o.width,s=o.height,u=o.center,d=o.clustering,h=o.nodeClusterBy,c=o.maxIteration,f=o.onTick,g=e.getAllNodes(),p=e.getAllEdges(),(null==g?void 0:g.length)?1===g.length?(t&&e.mergeNodeData(g[0].id,{x:u[0],y:u[1]}),v={nodes:[n(n({},g[0]),{data:n(n({},g[0].data),{x:u[0],y:u[1]})})],edges:p},this.lastResult=v,[2,v]):(y=g.map((function(t){return b(t,[i,s])})),m=new l({nodes:y,edges:p}),w={},d&&y.forEach((function(t){var e=t.data[h];w[e]||(w[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=y,this.lastLayoutEdges=p,this.lastAssign=t,this.lastGraph=m,this.lastOptions=o,this.lastClusterMap=w,"undefined"==typeof window?[2]:(x=0,[2,new Promise((function(r){E.timeInterval=window.setInterval((function(){E.running?(E.runOneStep(m,w,o),t&&y.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y})})),null==f||f({nodes:y,edges:p}),++x>=c&&(window.clearInterval(E.timeInterval),r({nodes:y,edges:p}))):r({nodes:y,edges:p})}),0),E.running=!0}))])):(v={nodes:[],edges:p},this.lastResult=v,[2,v]))}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=n(n({},this.options),t),r=e.clustering,o=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=r&&!!o,e},t.prototype.runOneStep=function(t,e,r){var n=r.height,o=r.width,i=r.gravity,a=r.center,s=r.speed,u=r.clustering,d=r.nodeClusterBy,h=r.clusterGravity,c=n*o,l=Math.sqrt(c)/10,f=t.getAllNodes(),g=c/(f.length+1),p=Math.sqrt(g),v={};if(this.applyCalculate(t,v,p,g),u){for(var y in e)e[y].cx=0,e[y].cy=0,e[y].count=0;for(var y in f.forEach((function(t){var r=t.data,n=e[r[d]];x(r.x)&&(n.cx+=r.x),x(r.y)&&(n.cy+=r.y),n.count++})),e)e[y].cx/=e[y].count,e[y].cy/=e[y].count;var m=h||i;f.forEach((function(t,r){var n=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=e[o[d]],a=Math.sqrt((o.x-i.cx)*(o.x-i.cx)+(o.y-i.cy)*(o.y-i.cy)),s=p*m;v[n].x-=s*(o.x-i.cx)/a,v[n].y-=s*(o.y-i.cy)/a}}))}f.forEach((function(t,e){var r=t.id,n=t.data;if(x(n.x)&&x(n.y)){var o=.01*p*i;v[r].x-=o*(n.x-a[0]),v[r].y-=o*(n.y-a[1])}})),f.forEach((function(e,r){var n=e.id,o=e.data;if(x(o.fx)&&x(o.fy))return o.x=o.fx,void(o.y=o.fy);if(x(o.x)&&x(o.y)){var i=Math.sqrt(v[n].x*v[n].x+v[n].y*v[n].y);if(i>0){var a=Math.min(l*(s/800),i);t.mergeNodeData(n,{x:o.x+v[n].x/i*a,y:o.y+v[n].y/i*a})}}}))},t.prototype.applyCalculate=function(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)},t.prototype.calRepulsive=function(t,e,r){var n=t.getAllNodes();n.forEach((function(t,o){var i=t.data,a=t.id;e[a]={x:0,y:0},n.forEach((function(t,n){var s=t.data,u=t.id;if(!(o<=n)&&x(i.x)&&x(s.x)&&x(i.y)&&x(s.y)){var d=i.x-s.x,h=i.y-s.y,c=d*d+h*h;0===c&&(c=1,d=.01,h=.01);var l=r/c,f=d*l,g=h*l;e[a].x+=f,e[a].y+=g,e[u].x-=f,e[u].y-=g}}))}))},t.prototype.calAttractive=function(t,e,r){t.getAllEdges().forEach((function(n){var o=n.source,i=n.target;if(o&&i&&o!==i){var a=t.getNode(o).data,s=t.getNode(i).data;if(x(s.x)&&x(a.x)&&x(s.y)&&x(a.y)){var u=s.x-a.x,d=s.y-a.y,h=Math.sqrt(u*u+d*d)/r,c=u*h,l=d*h;e[o].x+=c,e[o].y+=l,e[i].x-=c,e[i].y-=l}}}))},t}(),Tr={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},zr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="grid",this.options=n(n({},Tr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericGridLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericGridLayout(!0,t,e),[2]}))}))},t.prototype.genericGridLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,p,v,y,m,w,E,N,M,A,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.begin,s=void 0===i?[0,0]:i,u=o.condense,d=o.preventOverlapPadding,h=o.preventOverlap,c=o.rows,l=o.cols,f=o.nodeSpacing,p=o.nodeSize,v=o.width,y=o.height,m=o.position,w=o.sortBy,E=e.getAllNodes(),N=e.getAllEdges(),!(M=null==E?void 0:E.length)||1===M)return[2,R(e,t,s)];if(A=E.map((function(t){return b(t)})),"id"===w||P(w)&&void 0!==A[0].data[w]||(w="degree"),"degree"===w?A.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):"id"===w?A.sort((function(t,e){return x(e.id)&&x(t.id)?e.id-t.id:(""+t.id).localeCompare(""+e.id)})):A.sort((function(t,e){return e.data[w]-t.data[w]})),I=v||"undefined"==typeof window?v:window.innerWidth,_=y||"undefined"==typeof window?y:window.innerHeight,D=M,O={rows:c,cols:l},null!=c&&null!=l?(O.rows=c,O.cols=l):null!=c&&null==l?(O.rows=c,O.cols=Math.ceil(D/O.rows)):null==c&&null!=l?(O.cols=l,O.rows=Math.ceil(D/O.cols)):(T=Math.sqrt(D*_/I),O.rows=Math.round(T),O.cols=Math.round(I/_*T)),O.rows=Math.max(O.rows,1),O.cols=Math.max(O.cols,1),O.cols*O.rows>D)z=Cr(O),C=Lr(O),(z-1)*C>=D?Cr(O,z-1):(C-1)*z>=D&&Lr(O,C-1);else for(;O.cols*O.rows<D;)z=Cr(O),((C=Lr(O))+1)*z>=D?Lr(O,C+1):Cr(O,z+1);for(L=u?0:I/O.cols,q=u?0:_/O.rows,(h||f)&&(j=S(10,f),F=k(30,p,!1),A.forEach((function(t){t.data.x&&t.data.y||(t.data.x=0,t.data.y=0);var r,n,o=e.getNode(t.id),i=F(o)||30;g(i)?(r=i[0],n=i[1]):(r=i,n=i);var a=void 0!==j?j(t):d,s=r+a,u=n+a;L=Math.max(L,s),q=Math.max(q,u)}))),V={},G={row:0,col:0},W={},B=0;B<A.length;B++){if($=A[B],U=void 0,m&&(U=m(e.getNode($.id))),U&&(void 0!==U.row||void 0!==U.col)){if(void 0===(H={row:U.row,col:U.col}).col)for(H.col=0;qr(V,H);)H.col++;else if(void 0===H.row)for(H.row=0;qr(V,H);)H.row++;W[$.id]=H,jr(V,H)}Vr($,s,L,q,W,O,G,V)}return K={nodes:A,edges:N},t&&A.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,K]}))}))},t}(),Cr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.min(n,o):Math.min(n,o)===t.rows?t.rows=e:t.cols=e,r},Lr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.max(n,o):Math.max(n,o)===t.rows?t.rows=e:t.cols=e,r},qr=function(t,e){return t["c-"+e.row+"-"+e.col]||!1},jr=function(t,e){return t["c-"+e.row+"-"+e.col]=!0},Fr=function(t,e){var r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},Vr=function(t,e,r,n,o,i,a,s){var u,d,h=o[t.id];if(h)u=h.col*r+r/2+e[0],d=h.row*n+n/2+e[1];else{for(;qr(s,a);)Fr(i,a);u=a.col*r+r/2+e[0],d=a.row*n+n/2+e[1],jr(s,a),Fr(i,a)}t.data.x=u,t.data.y=d};const Gr=Object.prototype.toString;function Wr(t){return Gr.call(t).endsWith("Array]")}function Br(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!Wr(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]<a&&(a=t[s]);return a}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Wr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]>a&&(a=t[s]);return a}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,a=void 0===i?r.autoMinMax?n:0:i,s=r.max,u=void 0===s?r.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var d=(u-a)/(o-n),h=0;h<t.length;h++)e[h]=(t[h]-n)*d+a;return e}const $r=" ".repeat(2),Ur=" ".repeat(4);function Hr(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=e;return`${t.constructor.name} {\\n${$r}[\\n${Ur}${function(t,e,r,n,o){const{rows:i,columns:a}=t,s=Math.min(i,e),u=Math.min(a,r),d=[];if("auto"===o){o=!1;t:for(let e=0;e<s;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let e=0;e<s;e++){let r=[];for(let i=0;i<u;i++)r.push(Kr(t.get(e,i),n,o));d.push(`${r.join(" ")}`)}return u!==a&&(d[d.length-1]+=` ... ${a-r} more columns`),s!==i&&d.push(`... ${i-e} more rows`),d.join(`\\n${Ur}`)}(t,r,n,o,i)}\\n${$r}]\\n${$r}rows: ${t.rows}\\n${$r}columns: ${t.columns}\\n}`}function Kr(t,e,r){return(t>=0&&r?` ${Yr(t,e-1)}`:Yr(t,e)).padEnd(e)}function Yr(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function Jr(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function Xr(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function Qr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function Zr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function tn(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(rn("startRow",e),rn("endRow",r),rn("startColumn",n),rn("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function en(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function rn(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function nn(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class on{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new sn(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new sn(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new sn(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new sn(t,e)}static ones(t,e){return new sn(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new sn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)o.set(r,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let a=o-n,s=new sn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(i()*a);s.set(r,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let t=0;t<n;t++)o.set(t,t,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let e=0;e<o;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new sn(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return on.isMatrix(t)?t:new sn(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let a=o;a<e;a++){let e=t.get(r,a)-i*t.get(n,a);t.set(r,a,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new sn(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){Jr(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return sn.rowVector(this.getRow(t))}setRow(t,e){Jr(this,t),e=Qr(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){Jr(this,t),Jr(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){Xr(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return sn.columnVector(this.getColumn(t))}setColumn(t,e){Xr(this,t),e=Zr(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){Xr(this,t),Xr(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=Qr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=Zr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){Jr(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){Xr(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){nn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){nn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(Jr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){Jr(this,t),nn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(Jr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){Jr(this,t),nn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(Xr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){Xr(this,t),nn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(Xr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){Xr(this,t),nn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){on.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=sn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new sn(e,n),i=new Float64Array(r);for(let a=0;a<n;a++){for(let e=0;e<r;e++)i[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,a,e)}}return o}strassen2x2(t){t=sn.checkMatrix(t);let e=new sn(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),d=t.get(1,1),h=(r+u)*(n+d),c=(a+u)*n,l=r*(i-d),f=u*(s-n),g=(r+o)*d,p=h+f-g+(o-u)*(s+d),v=l+g,y=c+f,m=h-c+l+(a-r)*(n+i);return e.set(0,0,p),e.set(0,1,v),e.set(1,0,y),e.set(1,1,m),e}strassen3x3(t){t=sn.checkMatrix(t);let e=new sn(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),d=this.get(2,1),h=this.get(2,2),c=t.get(0,0),l=t.get(0,1),f=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),y=t.get(2,0),m=t.get(2,1),w=t.get(2,2),x=(r-i)*(-l+p),E=(-r+i+a)*(c-l+p),b=(i+a)*(-c+l),N=r*c,M=(-r+u+d)*(c-f+v),S=(-r+u)*(f-v),k=(u+d)*(-c+f),A=(-o+d+h)*(p+y-m),R=(o-h)*(p-m),I=o*y,_=(d+h)*(-y+m),D=(-o+a+s)*(v+y-w),O=(o-s)*(v-w),P=(a+s)*(-y+w),T=N+I+n*g,z=(r+n+o-i-a-d-h)*p+E+b+N+A+I+_,C=N+M+k+(r+n+o-a-s-u-d)*v+I+D+P,L=x+a*(-c+l+g-p-v-y+w)+E+N+I+D+O,q=x+E+b+N+s*m,j=I+D+O+P+i*f,F=N+M+S+d*(-c+f+g-p-v-y+m)+A+R+I,V=A+R+I+_+u*l,G=N+M+S+k+h*w;return e.set(0,0,T),e.set(0,1,z),e.set(0,2,C),e.set(1,0,L),e.set(1,1,q),e.set(1,2,j),e.set(2,0,F),e.set(2,1,V),e.set(2,2,G),e}mmulStrassen(t){t=sn.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function a(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=on.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${r} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let s=Math.max(r,o),u=Math.max(n,i);return e=a(e,s,u),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=a(e,n+1,o+1),r=a(r,n+1,o+1)):n%2==1?(e=a(e,n+1,o),r=a(r,n+1,o)):o%2==1&&(e=a(e,n,o+1),r=a(r,n,o+1));let i=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,s-1),d=r.subMatrix(0,i-1,0,s-1),h=e.subMatrix(0,i-1,s,e.columns-1),c=r.subMatrix(0,i-1,s,r.columns-1),l=e.subMatrix(i,e.rows-1,0,s-1),f=r.subMatrix(i,r.rows-1,0,s-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),p=r.subMatrix(i,r.rows-1,s,r.columns-1),v=t(on.add(u,g),on.add(d,p),i,s),y=t(on.add(l,g),d,i,s),m=t(u,on.sub(c,p),i,s),w=t(g,on.sub(f,d),i,s),x=t(on.add(u,h),p,i,s),E=t(on.sub(l,u),on.add(d,c),i,s),b=t(on.sub(h,g),on.add(f,p),i,s),N=on.add(v,w);N.sub(x),N.add(b);let M=on.add(m,x),S=on.add(y,w),k=on.sub(v,y);k.add(m),k.add(E);let A=on.zeros(2*N.rows,2*N.columns);return A=A.setSubMatrix(N,0,0),A=A.setSubMatrix(M,N.rows,0),A=A.setSubMatrix(S,0,N.columns),A=A.setSubMatrix(k,N.rows,N.columns),A.subMatrix(0,n-1,0,o-1)}(e,t=a(t,s,u),s,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new sn(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&Br(o,{min:e,max:r,output:o}),n.setRow(t,o)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new sn(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&Br(o,{min:e,max:r,output:o}),n.setColumn(t,o)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=sn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new sn(e*n,r*o);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<o;s++)i.set(n*a+r,o*e+s,this.get(a,e)*t.get(r,s));return i}kroneckerSum(t){if(t=sn.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(sn.eye(r,r)),o=sn.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new sn(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=an){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=an){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){tn(this,t,e,r,n);let o=new sn(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new sn(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new sn(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=sn.checkMatrix(t)).isEmpty())return this;tn(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){!function(t,e){if(!Wr(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!Wr(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new sn(t.length,e.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<e.length;t++){let i=e[t];r.set(n,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new sn(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=en(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=en(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=en(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=en(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Wr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<n;a++){let n=0,s=0,u=0;for(let e=0;e<o;e++)u=t.get(a,e)-r[a],n+=u,s+=u*u;e?i.push((s-n*n/o)/(o-1)):i.push((s-n*n/o)/o)}return i}(this,r,n);case"column":if(!Wr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<o;a++){let o=0,s=0,u=0;for(let e=0;e<n;e++)u=t.get(e,a)-r[a],o+=u,s+=u*u;e?i.push((s-o*o/n)/(n-1)):i.push((s-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let a=0,s=0,u=0;for(let e=0;e<n;e++)for(let n=0;n<o;n++)u=t.get(e,n)-r,a+=u,s+=u*u;return e?(s-a*a/i)/(i-1):(s-a*a/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Wr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!Wr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!Wr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!Wr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return Hr(this,t)}}function an(t,e){return t-e}on.prototype.klass="Matrix","undefined"!=typeof Symbol&&(on.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return Hr(this)}),on.random=on.rand,on.randomInt=on.randInt,on.diagonal=on.diag,on.prototype.diagonal=on.prototype.diag,on.identity=on.eye,on.prototype.negate=on.prototype.neg,on.prototype.tensorProduct=on.prototype.kroneckerProduct;class sn extends on{constructor(t,e){if(super(),sn.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Wr(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!r[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return Jr(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),Jr(this,t,!0),e=Float64Array.from(Qr(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){Xr(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),Xr(this,t,!0),e=Zr(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(on,sn);class un extends on{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function dn(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class hn{constructor(t,e={}){if((t=un.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=e;let s,u=Boolean(o),d=Boolean(i),h=!1;if(r<n)if(a){s=t.transpose(),r=s.rows,n=s.columns,h=!0;let e=u;u=d,d=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let c=Math.min(r,n),l=Math.min(r+1,n),f=new Float64Array(l),g=new sn(r,c),p=new sn(n,n),v=new Float64Array(n),y=new Float64Array(r),m=new Float64Array(l);for(let t=0;t<l;t++)m[t]=t;let w=Math.min(r-1,n),x=Math.max(0,Math.min(n-2,r)),E=Math.max(w,x);for(let t=0;t<E;t++){if(t<w){f[t]=0;for(let e=t;e<r;e++)f[t]=dn(f[t],s.get(e,t));if(0!==f[t]){s.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<r;e++)s.set(e,t,s.get(e,t)/f[t]);s.set(t,t,s.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<n;e++){if(t<w&&0!==f[t]){let n=0;for(let o=t;o<r;o++)n+=s.get(o,t)*s.get(o,e);n=-n/s.get(t,t);for(let o=t;o<r;o++)s.set(o,e,s.get(o,e)+n*s.get(o,t))}v[e]=s.get(t,e)}if(u&&t<w)for(let e=t;e<r;e++)g.set(e,t,s.get(e,t));if(t<x){v[t]=0;for(let e=t+1;e<n;e++)v[t]=dn(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<n;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<r&&0!==v[t]){for(let e=t+1;e<r;e++)y[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)y[e]+=v[r]*s.get(e,r);for(let e=t+1;e<n;e++){let n=-v[e]/v[t+1];for(let o=t+1;o<r;o++)s.set(o,e,s.get(o,e)+n*y[o])}}if(d)for(let e=t+1;e<n;e++)p.set(e,t,v[e])}}let b=Math.min(n,r+1);if(w<n&&(f[w]=s.get(w,w)),r<b&&(f[b-1]=0),x+1<b&&(v[x]=s.get(x,b-1)),v[b-1]=0,u){for(let t=w;t<c;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<c;e++){let n=0;for(let o=t;o<r;o++)n+=g.get(o,t)*g.get(o,e);n=-n/g.get(t,t);for(let o=t;o<r;o++)g.set(o,e,g.get(o,e)+n*g.get(o,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(d)for(let t=n-1;t>=0;t--){if(t<x&&0!==v[t])for(let e=t+1;e<n;e++){let r=0;for(let o=t+1;o<n;o++)r+=p.get(o,t)*p.get(o,e);r=-r/p.get(t+1,t);for(let o=t+1;o<n;o++)p.set(o,e,p.get(o,e)+r*p.get(o,t))}for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}let N=b-1,M=0,S=Number.EPSILON;for(;b>0;){let t,e;for(t=b-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===b-2)e=4;else{let r;for(r=b-1;r>=t&&r!==t;r--){let e=(r!==b?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(f[r])<=S*e){f[r]=0;break}}r===t?e=3:r===b-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[b-2];v[b-2]=0;for(let r=b-2;r>=t;r--){let o=dn(f[r],e),i=f[r]/o,a=e/o;if(f[r]=o,r!==t&&(e=-a*v[r-1],v[r-1]=i*v[r-1]),d)for(let t=0;t<n;t++)o=i*p.get(t,r)+a*p.get(t,b-1),p.set(t,b-1,-a*p.get(t,r)+i*p.get(t,b-1)),p.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<b;n++){let o=dn(f[n],e),i=f[n]/o,a=e/o;if(f[n]=o,e=-a*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g.get(e,n)+a*g.get(e,t-1),g.set(e,t-1,-a*g.get(e,n)+i*g.get(e,t-1)),g.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(f[b-1]),Math.abs(f[b-2]),Math.abs(v[b-2]),Math.abs(f[t]),Math.abs(v[t])),o=f[b-1]/e,i=f[b-2]/e,a=v[b-2]/e,s=f[t]/e,h=v[t]/e,c=((i+o)*(i-o)+a*a)/2,l=o*a*(o*a);let y=0;0===c&&0===l||(y=c<0?0-Math.sqrt(c*c+l):Math.sqrt(c*c+l),y=l/(c+y));let m=(s+o)*(s-o)+y,w=s*h;for(let e=t;e<b-1;e++){let o=dn(m,w);0===o&&(o=Number.MIN_VALUE);let i=m/o,a=w/o;if(e!==t&&(v[e-1]=o),m=i*f[e]+a*v[e],v[e]=i*v[e]-a*f[e],w=a*f[e+1],f[e+1]=i*f[e+1],d)for(let t=0;t<n;t++)o=i*p.get(t,e)+a*p.get(t,e+1),p.set(t,e+1,-a*p.get(t,e)+i*p.get(t,e+1)),p.set(t,e,o);if(o=dn(m,w),0===o&&(o=Number.MIN_VALUE),i=m/o,a=w/o,f[e]=o,m=i*v[e]+a*f[e+1],f[e+1]=-a*v[e]+i*f[e+1],w=a*v[e+1],v[e+1]=i*v[e+1],u&&e<r-1)for(let t=0;t<r;t++)o=i*g.get(t,e)+a*g.get(t,e+1),g.set(t,e+1,-a*g.get(t,e)+i*g.get(t,e+1)),g.set(t,e,o)}v[b-2]=m,M+=1;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,d))for(let e=0;e<=N;e++)p.set(e,t,-p.get(e,t));for(;t<N&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,d&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}M=0,b--}}if(h){let t=p;p=g,g=t}this.m=r,this.n=n,this.s=f,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,o=sn.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?o.set(t,t,0):o.set(t,t,1/this.s[t]);let i=this.U,a=this.rightSingularVectors,s=a.mmul(o),u=a.rows,d=i.rows,h=sn.zeros(u,d);for(let t=0;t<u;t++)for(let e=0;e<d;e++){let r=0;for(let o=0;o<n;o++)r+=s.get(t,o)*i.get(e,o);h.set(t,e,r)}return h.mmul(e)}solveForDiagonal(t){return this.solve(sn.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new sn(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,a=i.rows,s=i.columns,u=new sn(r,a);for(let t=0;t<r;t++)for(let e=0;e<a;e++){let r=0;for(let n=0;n<s;n++)r+=o.get(t,n)*i.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return sn.diag(this.s)}}var cn,ln={center:[0,0],linkDistance:50},fn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="mds",this.options=n(n({},ln),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericMDSLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericMDSLayout(!0,t,e),[2]}))}))},t.prototype.genericMDSLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f,g,y;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=void 0===i?[0,0]:i,u=o.linkDistance,d=void 0===u?50:u,h=e.getAllNodes(),c=e.getAllEdges(),(null==h?void 0:h.length)&&1!==h.length?(l=v({nodes:h,edges:c},!1),f=p(l),gn(f),m=d,w=[],f.forEach((function(t){var e=[];t.forEach((function(t){e.push(t*m)})),w.push(e)})),g=pn(w),y=[],g.forEach((function(t,e){var r=b(h[e]);r.data.x=t[0]+s[0],r.data.y=t[1]+s[1],y.push(r)})),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:y,edges:c}]):[2,R(e,t,s)];var m,w}))}))},t}(),gn=function(t){var e=-999999;t.forEach((function(t){t.forEach((function(t){t!==1/0&&e<t&&(e=t)}))})),t.forEach((function(r,n){r.forEach((function(r,o){r===1/0&&(t[n][o]=e)}))}))},pn=function(t){var e=sn.mul(sn.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),o=e.mean();e.add(o).subRowVector(r).subColumnVector(n);var i=new hn(e),a=sn.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((function(t){return sn.mul([t],[a]).toJSON()[0].splice(0,2)}))},vn={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},yn=function(t,e,r,n,o,i){e.forEach((function(a,s){r[s]={x:0,y:0},e.forEach((function(e,u){if(s!==u&&o[s]===o[u]){var d=a.x-e.x,h=a.y-e.y,c=Math.sqrt(d*d+h*h);if(0===c){c=1;var l=s>u?1:-1;d=.01*l,h=.01*l}if(c<i(t[s])/2+i(t[u])/2){var f=n*n/c;r[s].x+=d/c*f,r[s].y+=h/c*f}}}))}))},mn=function(t,e,r,n,o,i,a,s){var u=i||a/10;return n&&e.forEach((function(e,r){var n=t[r].x-t[o].x,i=t[r].y-t[o].y,a=Math.sqrt(n*n+i*i),s=i/a,u=-n/a,d=Math.sqrt(e.x*e.x+e.y*e.y),h=Math.acos((s*e.x+u*e.y)/d);h>Math.PI/2&&(h-=Math.PI/2,s*=-1,u*=-1);var c=Math.cos(h)*d;e.x=s*c,e.y=u*c})),t.forEach((function(i,a){if(a!==o){var d=Math.sqrt(e[a].x*e[a].x+e[a].y*e[a].y);if(d>0&&a!==o){var h=Math.min(u*(r/800),d);if(i.x+=e[a].x/d*h,i.y+=e[a].y/d*h,n){var c=i.x-t[o].x,l=i.y-t[o].y,f=Math.sqrt(c*c+l*l);c=c/f*s[a],l=l/f*s[a],i.x=t[o].x+c,i.y=t[o].y+l}}}})),t},wn={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},xn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="radial",this.options=n(n({},wn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRadialLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRadialLayout(!0,t,e),[2]}))}))},t.prototype.genericRadialLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,d,h,c,l,f,g,y,m,w,x,E,N,M,S,k,I,_,D,O,T,z,C,L,q,j,F,V,G,W,B,$,U,H,K,Y,J,X,Q,Z,tt,et;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,d=o.height,h=o.center,c=o.focusNode,l=o.unitRadius,f=o.nodeSize,g=o.nodeSpacing,y=o.strictRadial,m=o.preventOverlap,w=o.maxPreventOverlapIteration,x=o.sortBy,E=o.linkDistance,N=void 0===E?50:E,M=o.sortStrength,S=void 0===M?10:M,k=o.maxIteration,I=void 0===k?1e3:k,_=e.getAllNodes(),D=e.getAllEdges(),O=i||"undefined"==typeof window?i:window.innerWidth,T=d||"undefined"==typeof window?d:window.innerHeight,z=h||[O/2,T/2],!(null==_?void 0:_.length)||1===_.length)return[2,R(e,t,z)];if(C=_[0],P(c)){for(L=0;L<_.length;L++)if(_[L].id===c){C=_[L];break}}else C=c||_[0];return q=Nn(_,C.id),j=v({nodes:_,edges:D},!1),F=p(j),V=Sn(F,q),Mn(F,q,V+1),G=F[q],W=O-z[0]>z[0]?z[0]:O-z[0],B=T-z[1]>z[1]?z[1]:T-z[1],0===W&&(W=O/2),0===B&&(B=T/2),$=Math.min(W,B),U=Math.max.apply(Math,u([],s(G))),H=[],K=l||$/U,G.forEach((function(t,e){H[e]=t*K})),Y=En(_,F,N,H,K,x,S),J=bn(Y),X=function(t,e,r){try{var n=sn.mul(sn.pow(e,2),-.5),o=n.mean("row"),i=n.mean("column"),a=n.mean();n.add(a).subRowVector(o).subColumnVector(i);var s=new hn(n),u=sn.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((function(e){return sn.mul([e],[u]).toJSON()[0].splice(0,t)}))}catch(t){for(var d=[],h=0;h<e.length;h++){var c=Math.random()*r,l=Math.random()*r;d.push([c,l])}return d}}(N,Y,N),Q=X.map((function(t){var e=s(t,2),r=e[0],n=e[1];return{x:(isNaN(r)?Math.random()*N:r)-X[q][0],y:(isNaN(n)?Math.random()*N:n)-X[q][1]}})),this.run(I,Q,J,Y,H,q),m&&(Z=A(f,g),tt={nodes:_,nodeSizeFunc:Z,positions:Q,radii:H,height:T,width:O,strictRadial:Boolean(y),focusIdx:q,iterations:w||200,k:Q.length/4.5},Q=function(t,e){for(var r=n(n({},vn),e),o=r.positions,i=r.iterations,a=r.width,s=r.k,u=r.speed,d=void 0===u?100:u,h=r.strictRadial,c=r.focusIdx,l=r.radii,f=void 0===l?[]:l,g=r.nodeSizeFunc,p=t.getAllNodes(),v=[],y=a/10,m=0;m<i;m++)o.forEach((function(t,e){v[e]={x:0,y:0}})),yn(p,o,v,s,f,g),mn(o,v,d,h,c,y,a,f);return o}(e,tt)),et=[],Q.forEach((function(t,e){var r=b(_[e]);r.data.x=t.x+z[0],r.data.y=t.y+z[1],et.push(r)})),t&&et.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:et,edges:D}]}))}))},t.prototype.run=function(t,e,r,n,o,i){for(var a=0;a<=t;a++){var s=a/t;this.oneIteration(s,e,o,n,r,i)}},t.prototype.oneIteration=function(t,e,r,n,o,i){var a=1-t;e.forEach((function(s,u){var d=y(s,{x:0,y:0}),h=0===d?0:1/d;if(u!==i){var c=0,l=0,f=0;e.forEach((function(t,e){if(u!==e){var r=y(s,t),i=0===r?0:1/r,a=n[e][u];f+=o[u][e],c+=o[u][e]*(t.x+a*(s.x-t.x)*i),l+=o[u][e]*(t.y+a*(s.y-t.y)*i)}}));var g=0===r[u]?0:1/r[u];f*=a,f+=t*g*g,c*=a,c+=t*g*s.x*h,s.x=c/f,l*=a,l+=t*g*s.y*h,s.y=l/f}}))},t}(),En=function(t,e,r,n,o,i,a){if(!t)return[];var s=[];if(e){var u={};e.forEach((function(e,d){var h=[];e.forEach((function(e,s){var c,l;if(d===s)h.push(0);else if(n[d]===n[s])if("data"===i)h.push(e*(Math.abs(d-s)*a)/(n[d]/o));else if(i){var f=void 0,g=void 0;if(u[t[d].id])f=u[t[d].id];else{var p=("id"===i?t[d].id:null===(c=t[d].data)||void 0===c?void 0:c[i])||0;f=P(p)?p.charCodeAt(0):p,u[t[d].id]=f}u[t[s].id]?g=u[t[s].id]:(p=("id"===i?t[s].id:null===(l=t[s].data)||void 0===l?void 0:l[i])||0,g=P(p)?p.charCodeAt(0):p,u[t[s].id]=g),h.push(e*(Math.abs(f-g)*a)/(n[d]/o))}else h.push(e*r/(n[d]/o));else{var v=(r+o)/2;h.push(e*v)}})),s.push(h)}))}return s},bn=function(t){for(var e=t.length,r=t[0].length,n=[],o=0;o<e;o++){for(var i=[],a=0;a<r;a++)0!==t[o][a]?i.push(1/(t[o][a]*t[o][a])):i.push(0);n.push(i)}return n},Nn=function(t,e){var r=-1;return t.forEach((function(t,n){t.id===e&&(r=n)})),Math.max(r,0)},Mn=function(t,e,r){for(var n=t.length,o=0;o<n;o++)if(t[e][o]===1/0){t[e][o]=r,t[o][e]=r;for(var i=0;i<n;i++)t[o][i]!==1/0&&t[e][i]===1/0&&(t[e][i]=r+t[o][i],t[i][e]=r+t[o][i])}for(o=0;o<n;o++)if(o!==e)for(i=0;i<n;i++)if(t[o][i]===1/0){var a=Math.abs(t[e][o]-t[e][i]);a=0===a?1:a,t[o][i]=a}},Sn=function(t,e){for(var r=0,n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r},kn={center:[0,0],width:300,height:300},An=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="random",this.options=n(n({},kn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRandomLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRandomLayout(!0,t,e),[2]}))}))},t.prototype.genericRandomLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,d,h,c,l,f;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,d=e.getAllNodes(),h=s||"undefined"==typeof window?s:window.innerWidth,c=u||"undefined"==typeof window?u:window.innerHeight,l=i||[h/2,c/2],f=[],d&&d.forEach((function(t){f.push({id:t.id,data:{x:.9*(Math.random()-.5)*h+l[0],y:.9*(Math.random()-.5)*c+l[1]}})})),t&&f.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:f,edges:e.getAllEdges()}]}))}))},t}(),Rn={circular:_,concentric:z,mds:fn,random:An,grid:zr,radial:xn,force:xr,d3force:zt,fruchterman:Pr,forceAtlas2:Dr,dagre:pr};function In(){var t;(null===(t=cn)||void 0===t?void 0:t.stop)&&cn.stop()}function _n(t,e){return i(this,void 0,void 0,(function(){var r,n,o,i,s,u,d,h,c;return a(this,(function(a){switch(a.label){case 0:if(r=t.layout,n=r.id,o=r.options,i=r.iterations,s=t.nodes,u=t.edges,d=new l({nodes:s,edges:u}),!(h=Rn[n]))throw new Error("Unknown layout id: "+n);return[4,(cn=new h(o)).execute(d)];case 1:return c=a.sent(),!!(f=cn).tick&&!!f.stop&&(cn.stop(),c=cn.tick(i)),[2,[c,e]]}var f}))}))}addEventListener("message",(function(t){var r,n=t.data,o=n.type,i=n.method,a=n.id,s=n.params;"RPC"===o&&i&&((r=e[i])?Promise.resolve().then((function(){return r.apply(e,s)})):Promise.reject("No such method")).then((function(t){postMessage({type:"RPC",id:a,result:t})})).catch((function(t){var e={message:t};t.stack&&(e.message=t.message,e.stack=t.stack,e.name=t.name),postMessage({type:"RPC",id:a,error:e})}))})),postMessage({type:"RPC",method:"ready"});\n//# sourceMappingURL=11f9ed8e311b689f74d1.worker.js.map']))),Lt(te,Mt),te}},331:v=>{v.exports=function(Bt,z){var Lt=0,Mt={};Bt.addEventListener("message",function(te){var ue=te.data;if(ue.type==="RPC")if(ue.id){var he=Mt[ue.id];he&&(delete Mt[ue.id],ue.error?he[1](Object.assign(Error(ue.error.message),ue.error)):he[0](ue.result))}else{var pe=document.createEvent("Event");pe.initEvent(ue.method,!1,!1),pe.data=ue.params,Bt.dispatchEvent(pe)}}),z.forEach(function(te){Bt[te]=function(){var ue=arguments;return new Promise(function(he,pe){var ye=++Lt;Mt[ye]=[he,pe],Bt.postMessage({type:"RPC",id:ye,method:te,params:[].slice.call(ue)})})}})}}},h={};function a(v){var Bt=h[v];if(Bt!==void 0)return Bt.exports;var z=h[v]={exports:{}};return p[v](z,z.exports,a),z.exports}a.n=v=>{var Bt=v&&v.__esModule?()=>v.default:()=>v;return a.d(Bt,{a:Bt}),Bt},a.d=(v,Bt)=>{for(var z in Bt)a.o(Bt,z)&&!a.o(v,z)&&Object.defineProperty(v,z,{enumerable:!0,get:Bt[z]})},a.o=(v,Bt)=>Object.prototype.hasOwnProperty.call(v,Bt);var f={};(()=>{a.d(f,{SB:()=>Ao,W1:()=>Hn,jA:()=>Da,Vq:()=>L,E9:()=>ve,y7:()=>Jt,O2:()=>ce,Me:()=>ke,AI:()=>as,D4:()=>Re,_5:()=>nr,y9:()=>xn,_A:()=>Je,d9:()=>$n,ul:()=>Xr,qs:()=>yr,gl:()=>Kn,jE:()=>wn,tO:()=>On,zJ:()=>Wr,h$:()=>Dn,BI:()=>lo,$y:()=>Tn,H0:()=>Hr,kJ:()=>Qe,hY:()=>cr,qR:()=>gr,i_:()=>or,nu:()=>cn,He:()=>ar,A3:()=>$r});var v=function(c,i){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var u in n)Object.prototype.hasOwnProperty.call(n,u)&&(e[u]=n[u])},v(c,i)};function Bt(c,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function e(){this.constructor=c}v(c,i),c.prototype=i===null?Object.create(i):(e.prototype=i.prototype,new e)}var z=function(){return z=Object.assign||function(c){for(var i,e=1,n=arguments.length;e<n;e++)for(var u in i=arguments[e])Object.prototype.hasOwnProperty.call(i,u)&&(c[u]=i[u]);return c},z.apply(this,arguments)};function Lt(c,i){var e={};for(var n in c)Object.prototype.hasOwnProperty.call(c,n)&&i.indexOf(n)<0&&(e[n]=c[n]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function"){var u=0;for(n=Object.getOwnPropertySymbols(c);u<n.length;u++)i.indexOf(n[u])<0&&Object.prototype.propertyIsEnumerable.call(c,n[u])&&(e[n[u]]=c[n[u]])}return e}function Mt(c,i,e,n){return new(e||(e=Promise))(function(u,g){function x(T){try{S(n.next(T))}catch(k){g(k)}}function M(T){try{S(n.throw(T))}catch(k){g(k)}}function S(T){var k;T.done?u(T.value):(k=T.value,k instanceof e?k:new e(function(B){B(k)})).then(x,M)}S((n=n.apply(c,i||[])).next())})}function te(c,i){var e,n,u,g,x={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return g={next:M(0),throw:M(1),return:M(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function M(S){return function(T){return function(k){if(e)throw new TypeError("Generator is already executing.");for(;g&&(g=0,k[0]&&(x=0)),x;)try{if(e=1,n&&(u=2&k[0]?n.return:k[0]?n.throw||((u=n.return)&&u.call(n),0):n.next)&&!(u=u.call(n,k[1])).done)return u;switch(n=0,u&&(k=[2&k[0],u.value]),k[0]){case 0:case 1:u=k;break;case 4:return x.label++,{value:k[1],done:!1};case 5:x.label++,n=k[1],k=[0];continue;case 7:k=x.ops.pop(),x.trys.pop();continue;default:if(!((u=(u=x.trys).length>0&&u[u.length-1])||k[0]!==6&&k[0]!==2)){x=0;continue}if(k[0]===3&&(!u||k[1]>u[0]&&k[1]<u[3])){x.label=k[1];break}if(k[0]===6&&x.label<u[1]){x.label=u[1],u=k;break}if(u&&x.label<u[2]){x.label=u[2],x.ops.push(k);break}u[2]&&x.ops.pop(),x.trys.pop();continue}k=i.call(c,x)}catch(B){k=[6,B],n=0}finally{e=u=0}if(5&k[0])throw k[1];return{value:k[0]?k[1]:void 0,done:!0}}([S,T])}}}function ue(c,i){var e=typeof Symbol=="function"&&c[Symbol.iterator];if(!e)return c;var n,u,g=e.call(c),x=[];try{for(;(i===void 0||i-- >0)&&!(n=g.next()).done;)x.push(n.value)}catch(M){u={error:M}}finally{try{n&&!n.done&&(e=g.return)&&e.call(g)}finally{if(u)throw u.error}}return x}function he(c,i,e){if(e||arguments.length===2)for(var n,u=0,g=i.length;u<g;u++)!n&&u in i||(n||(n=Array.prototype.slice.call(i,0,u)),n[u]=i[u]);return c.concat(n||Array.prototype.slice.call(i))}var pe,ye,fe=/-(\w)/g,Je=(pe=function(c){return c.replace(fe,function(i,e){return e?e.toUpperCase():""})},ye=Object.create(null),function(c){return ye[c]||(ye[c]=pe(c))}),Qe=Array.isArray,ar=function(c){var i=parseFloat(c);return isNaN(i)?c:i},dr={}.toString;const _r=function(c,i){return dr.call(c)==="[object "+i+"]"},Te=function(c){return _r(c,"Number")};var yr=function(c){for(var i=[],e=c.length,n=0;n<e;n+=1){i[n]=[];for(var u=0;u<e;u+=1)n===u?i[n][u]=0:c[n][u]!==0&&c[n][u]?i[n][u]=c[n][u]:i[n][u]=1/0}for(var g=0;g<e;g+=1)for(n=0;n<e;n+=1)for(u=0;u<e;u+=1)i[n][u]>i[n][g]+i[g][u]&&(i[n][u]=i[n][g]+i[g][u]);return i},Wr=function(c,i){var e=c.nodes,n=c.edges,u=[],g={};if(!e)throw new Error("invalid nodes data!");return e&&e.forEach(function(x,M){g[x.id]=M,u.push([])}),n==null||n.forEach(function(x){var M=x.source,S=x.target,T=g[M],k=g[S];T!==void 0&&k!==void 0&&(u[T][k]=1,i||(u[k][T]=1))}),u},cn=function(c,i){var e=[];return c.forEach(function(n){var u=[];n.forEach(function(g){u.push(g*i)}),e.push(u)}),e},Wn=function(c,i){if(c&&c.children){for(var e=c.children.length-1;e>=0;e--)if(!Wn(c.children[e],i))return}return!!i(c)},$r=function(c,i){typeof i=="function"&&Wn(c,i)},Hr=function(c){var i=1/0,e=1/0,n=-1/0,u=-1/0;return c.forEach(function(g){var x=g.data.size;Qe(x)?x.length===1&&(x=[x[0],x[0]]):Te(x)?x=[x,x]:(x===void 0||isNaN(x))&&(x=[30,30]);var M=[x[0]/2,x[1]/2],S=g.data.x-M[0],T=g.data.x+M[0],k=g.data.y-M[1],B=g.data.y+M[1];i>S&&(i=S),e>k&&(e=k),n<T&&(n=T),u<B&&(u=B)}),{minX:i,minY:e,maxX:n,maxY:u}},Dn=function(c){var i={x:0,y:0};c.forEach(function(n){i.x+=n.data.x||0,i.y+=n.data.y||0});var e=c.length||1;return{x:i.x/e,y:i.y/e}},yn=function(c,i,e){var n,u;return c==="source"?((n=e==null?void 0:e.find(function(g){return g.target===i.id}))===null||n===void 0?void 0:n.source)||{}:((u=e==null?void 0:e.find(function(g){return g.source===i.id}))===null||u===void 0?void 0:u.target)||{}},zn=function(c,i,e){var n=[];switch(c){case"source":n=e==null?void 0:e.filter(function(g){return g.source===i.id}).map(function(g){return g.target});break;case"target":n=e==null?void 0:e.filter(function(g){return g.target===i.id}).map(function(g){return g.source});break;case"both":n=e==null?void 0:e.filter(function(g){return g.source===i.id}).map(function(g){return g.target}).concat(e==null?void 0:e.filter(function(g){return g.target===i.id}).map(function(g){return g.source}))}var u=new Set(n);return Array.from(u)},lo=function(c,i,e,n,u,g){var x=u[i.id],M=x.in,S=x.out,T=i,k=[];M===0?(T=yn("source",i,e),k=zn("both",T,e).map(function(Q){return g[Q]})):S===0&&(T=yn("target",i,e),k=zn("both",T,e).map(function(Q){return g[Q]})),k=k.filter(function(Q){return u[Q.id]&&(u[Q.id].in===0||u[Q.id].out===0)});var B=function(Q,et,K,j,dt){var ot=K[et]||"",pt=(j==null?void 0:j.filter(function(ne){return ne[et]===ot}))||[];return Q==="leaf"&&(pt=pt.filter(function(ne){var Kt,qt;return((Kt=dt[ne.id])===null||Kt===void 0?void 0:Kt.in)===0||((qt=dt[ne.id])===null||qt===void 0?void 0:qt.out)===0})),pt}(c,n,i,k,u);return{coreNode:T,relativeLeafNodes:k,sameTypeLeafNodes:B}},Tn=function(c,i){return Math.sqrt((c.x-i.x)*(c.x-i.x)+(c.y-i.y)*(c.y-i.y))},$n=function(c){if(c===null)return c;if(c instanceof Date)return new Date(c.getTime());if(c instanceof Array){var i=[];return c.forEach(function(n){i.push(n)}),i.map(function(n){return $n(n)})}if(typeof c=="object"){var e={};return Object.keys(c).forEach(function(n){e[n]=$n(c[n])}),e}return c},Xr=function(c,i){var e=$n(c);return e.data=e.data||{},i&&(Te(e.data.x)||(e.data.x=Math.random()*i[0]),Te(e.data.y)||(e.data.y=Math.random()*i[1])),e};const hn=function(c){return typeof c=="function"},Rn=function(c){var i=typeof c;return c!==null&&i==="object"||i==="function"};function wn(c,i){return hn(i)?i:Te(i)?function(){return i}:function(){return c}}function On(c,i,e){return e===void 0&&(e=!0),i||i===0?hn(i)?i:Te(i)?function(){return i}:Qe(i)?function(){if(e){var n=Math.max.apply(Math,he([],ue(i)));return isNaN(n)?c:n}return i}:Rn(i)?function(){if(e){var n=Math.max(i.width,i.height);return isNaN(n)?c:n}return[i.width,i.height]}:function(){return c}:function(n){var u=(n.data||{}).size;return u?Qe(u)?u[0]>u[1]?u[0]:u[1]:Rn(u)?u.width>u.height?u.width:u.height:u:c}}var Kn=function(c,i){var e;return e=Te(i)?function(){return i}:hn(i)?i:function(){return 0},c?Qe(c)?function(n){return(c[0]>c[1]?c[0]:c[1])+e(n)}:function(n){return c+e(n)}:function(n){var u,g;if(!((u=n.data)===null||u===void 0)&&u.bboxSize)return Math.max(n.data.bboxSize[0],n.data.bboxSize[1])+e(n);if(!((g=n.data)===null||g===void 0)&&g.size){if(Qe(n.data.size))return Math.max(n.data.size[0],n.data.size[1])+e(n);var x=n.data.size;return Rn(x)?(x.width>x.height?x.width:x.height)+e(n):x+e(n)}return 10+e(n)}},io=function(c,i,e){var n=c.getAllNodes(),u=c.getAllEdges();return n!=null&&n.length?n.length===1?(i&&c.mergeNodeData(n[0].id,{x:e[0],y:e[1]}),{nodes:[z(z({},n[0]),{data:z(z({},n[0].data),{x:e[0],y:e[1]})})],edges:u}):void 0:{nodes:[],edges:u}},Mo={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},Ao=function(){function c(i){i===void 0&&(i={}),this.options=i,this.id="circular",this.options=z(z({},Mo),i)}return c.prototype.execute=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return[2,this.genericCircularLayout(!1,i,e)]})})},c.prototype.assign=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){switch(n.label){case 0:return[4,this.genericCircularLayout(!0,i,e)];case 1:return n.sent(),[2]}})})},c.prototype.genericCircularLayout=function(i,e,n){return Mt(this,void 0,void 0,function(){var u,g,x,M,S,T,k,B,Q,et,K,j,dt,ot,pt,ne,Kt,qt,Nt,Pt,Ht,Ct,V,st,It,mt,X,D,W,vt,yt,At,I,P,C;return te(this,function(O){if(u=z(z({},this.options),n),g=u.width,x=u.height,M=u.center,S=u.divisions,T=u.startAngle,k=T===void 0?0:T,B=u.endAngle,Q=B===void 0?2*Math.PI:B,et=u.angleRatio,K=u.ordering,j=u.clockwise,dt=u.nodeSpacing,ot=u.nodeSize,pt=e.getAllNodes(),ne=e.getAllEdges(),Kt=ue(Yr(g,x,M),3),qt=Kt[0],Nt=Kt[1],Pt=Kt[2],!(Ht=pt==null?void 0:pt.length)||Ht===1)return[2,io(e,i,Pt)];for(Ct=(Q-k)/Ht,V=u.radius,st=u.startRadius,It=u.endRadius,dt?(mt=wn(10,dt),X=On(10,ot),D=-1/0,pt.forEach(function(ut){var xt=X(ut);D<xt&&(D=xt)}),W=0,pt.forEach(function(ut,xt){W+=xt===0?D||10:(mt(ut)||0)+(D||10)}),V=W/(2*Math.PI)):V||st||It?!st&&It?st=It:st&&!It&&(It=st):V=Math.min(Nt,qt)/2,vt=Ct*et,yt=[],yt=K==="topology"?ao(e,pt):K==="topology-directed"?ao(e,pt,!0):K==="degree"?function(ut,xt){var G=[];return xt.forEach(function(U,lt){G.push(Xr(U))}),G.sort(function(U,lt){return ut.getDegree(U.id,"both")-ut.getDegree(lt.id,"both")}),G}(e,pt):pt.map(function(ut){return Xr(ut)}),At=Math.ceil(Ht/S),I=0;I<Ht;++I)(P=V)||st===null||It===null||(P=st+I*(It-st)/(Ht-1)),P||(P=10+100*I/(Ht-1)),C=k+I%At*vt+2*Math.PI/S*Math.floor(I/At),j||(C=Q-I%At*vt-2*Math.PI/S*Math.floor(I/At)),yt[I].data.x=Pt[0]+Math.cos(C)*P,yt[I].data.y=Pt[1]+Math.sin(C)*P;return i&&yt.forEach(function(ut){e.mergeNodeData(ut.id,{x:ut.data.x,y:ut.data.y})}),[2,{nodes:yt,edges:ne}]})})},c}(),ao=function(c,i,e){e===void 0&&(e=!1);var n=[Xr(i[0])],u={},g=i.length;u[i[0].id]=!0;var x=0;return i.forEach(function(M,S){if(S!==0)if(S!==g-1&&c.getDegree(M.id,"both")===c.getDegree(i[S+1].id,"both")&&!c.areNeighbors(n[x].id,M.id)||u[M.id]){for(var T=e?c.getSuccessors(n[x].id):c.getNeighbors(n[x].id),k=!1,B=0;B<T.length;B++){var Q=T[B];if(c.getDegree(Q.id)===c.getDegree(M.id)&&!u[Q.id]){n.push(Xr(Q)),u[Q.id]=!0,k=!0;break}}for(var et=0;!k&&(u[i[et].id]||(n.push(Xr(i[et])),u[i[et].id]=!0,k=!0),++et!==g););}else n.push(Xr(M)),u[M.id]=!0,x++}),n},Yr=function(c,i,e){var n=c,u=i,g=e;return n||typeof window>"u"||(n=window.innerWidth),u||typeof window>"u"||(u=window.innerHeight),g||(g=[n/2,u/2]),[n,u,g]},ln=a(913),Jr=a.n(ln),En=a(617),po=a.n(En),xn=function(c){function i(e,n,u){var g=c.call(this)||this;return g.graph=e,g.layout=n,g.options=u,g.spawnWorker(),g}return Bt(i,c),i.prototype.spawnWorker=function(){this.worker&&this.worker.terminate(),this.worker=po()(),this.running&&(this.running=!1,this.execute())},i.prototype.execute=function(){var e;return Mt(this,void 0,void 0,function(){var n,u,g,x;return te(this,function(M){switch(M.label){case 0:return this.running?[2,this]:(this.running=!0,(n=this.layout.options).onTick,u=Lt(n,["onTick"]),g={layout:{id:this.layout.id,options:u,iterations:(e=this.options)===null||e===void 0?void 0:e.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},x=new Float32Array([0]),[4,this.worker.calculateLayout(g,[x])]);case 1:return[2,ue.apply(void 0,[M.sent(),1])[0]]}})})},i.prototype.stop=function(){return this.running=!1,this.worker.stopLayout(),this},i.prototype.kill=function(){this.worker&&this.worker.terminate()},i.prototype.isRunning=function(){return this.running},i}(Jr());const Zn=function(c){return _r(c,"String")};var Cr={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},Hn=function(){function c(i){i===void 0&&(i={}),this.options=i,this.id="concentric",this.options=z(z({},Cr),i)}return c.prototype.execute=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return[2,this.genericConcentricLayout(!1,i,e)]})})},c.prototype.assign=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return this.genericConcentricLayout(!0,i,e),[2]})})},c.prototype.genericConcentricLayout=function(i,e,n){return Mt(this,void 0,void 0,function(){var u,g,x,M,S,T,k,B,Q,et,K,j,dt,ot,pt,ne,Kt,qt,Nt,Pt,Ht,Ct,V,st,It,mt,X,D,W,vt,yt,At,I,P,C,O,ut,xt;return te(this,function(G){if(u=z(z({},this.options),n),g=u.center,x=u.width,M=u.height,S=u.sortBy,T=u.maxLevelDiff,k=u.sweep,B=u.clockwise,Q=u.equidistant,et=u.preventOverlap,K=u.startAngle,j=K===void 0?1.5*Math.PI:K,dt=u.nodeSize,ot=u.nodeSpacing,pt=e.getAllNodes(),ne=e.getAllEdges(),Kt=x||typeof window>"u"?x:window.innerWidth,qt=M||typeof window>"u"?M:window.innerHeight,Nt=g||[Kt/2,qt/2],!(pt!=null&&pt.length)||pt.length===1)return[2,io(e,i,Nt)];if(Pt=[],Ct=0,Ht=Qe(dt)?Math.max(dt[0],dt[1]):dt,Qe(ot)?Ct=Math.max(ot[0],ot[1]):Te(ot)&&(Ct=ot),pt.forEach(function(U){var lt=Xr(U);Pt.push(lt);var it=Ht,ft=lt.data;Qe(ft.size)?it=Math.max(ft.size[0],ft.size[1]):Te(ft.size)?it=ft.size:Rn(ft.size)&&(it=Math.max(ft.size.width,ft.size.height)),Ht=Math.max(Ht,it),hn(ot)&&(Ct=Math.max(ot(U),Ct))}),V={},Pt.forEach(function(U,lt){V[U.id]=lt}),Zn(st=S)&&Pt[0].data[st]!==void 0||(st="degree"),st==="degree"?Pt.sort(function(U,lt){return e.getDegree(lt.id,"both")-e.getDegree(U.id,"both")}):Pt.sort(function(U,lt){return lt.data[st]-U.data[st]}),It=Pt[0],mt=(T||(st==="degree"?e.getDegree(It.id,"both"):It.data[st]))/4,D=(X=[{nodes:[]}])[0],Pt.forEach(function(U){if(D.nodes.length>0){var lt=Math.abs(st==="degree"?e.getDegree(D.nodes[0].id,"both")-e.getDegree(U.id,"both"):D.nodes[0].data[st]-U.data[st]);mt&&lt>=mt&&(D={nodes:[]},X.push(D))}D.nodes.push(U)}),W=Ht+Ct,et||(vt=X.length>0&&X[0].nodes.length>1,yt=Math.min(Kt,qt)/2-W,At=yt/(X.length+(vt?1:0)),W=Math.min(W,At)),I=0,X.forEach(function(U){var lt=k===void 0?2*Math.PI-2*Math.PI/U.nodes.length:k;if(U.dTheta=lt/Math.max(1,U.nodes.length-1),U.nodes.length>1&&et){var it=Math.cos(U.dTheta)-Math.cos(0),ft=Math.sin(U.dTheta)-Math.sin(0),Rt=Math.sqrt(W*W/(it*it+ft*ft));I=Math.max(Rt,I)}U.r=I,I+=W}),Q){for(P=0,C=0,O=0;O<X.length;O++)ut=X[O],xt=(ut.r||0)-C,P=Math.max(P,xt);C=0,X.forEach(function(U,lt){lt===0&&(C=U.r||0),U.r=C,C+=P})}return X.forEach(function(U){var lt=U.dTheta||0,it=U.r||0;U.nodes.forEach(function(ft,Rt){var Gt=j+(B?1:-1)*lt*Rt;ft.data.x=Nt[0]+it*Math.cos(Gt),ft.data.y=Nt[1]+it*Math.sin(Gt)})}),i&&Pt.forEach(function(U){return e.mergeNodeData(U.id,{x:U.data.x,y:U.data.y})}),[2,{nodes:Pt,edges:ne}]})})},c}();function Gn(c,i,e,n){if(isNaN(i)||isNaN(e))return c;var u,g,x,M,S,T,k,B,Q,et=c._root,K={data:n},j=c._x0,dt=c._y0,ot=c._x1,pt=c._y1;if(!et)return c._root=K,c;for(;et.length;)if((T=i>=(g=(j+ot)/2))?j=g:ot=g,(k=e>=(x=(dt+pt)/2))?dt=x:pt=x,u=et,!(et=et[B=k<<1|T]))return u[B]=K,c;if(M=+c._x.call(null,et.data),S=+c._y.call(null,et.data),i===M&&e===S)return K.next=et,u?u[B]=K:c._root=K,c;do u=u?u[B]=new Array(4):c._root=new Array(4),(T=i>=(g=(j+ot)/2))?j=g:ot=g,(k=e>=(x=(dt+pt)/2))?dt=x:pt=x;while((B=k<<1|T)==(Q=(S>=x)<<1|M>=g));return u[Q]=et,u[B]=K,c}function Kr(c,i,e,n,u){this.node=c,this.x0=i,this.y0=e,this.x1=n,this.y1=u}function Jn(c){return c[0]}function Sn(c){return c[1]}function bn(c,i,e){var n=new Qr(i==null?Jn:i,e==null?Sn:e,NaN,NaN,NaN,NaN);return c==null?n:n.addAll(c)}function Qr(c,i,e,n,u,g){this._x=c,this._y=i,this._x0=e,this._y0=n,this._x1=u,this._y1=g,this._root=void 0}function _n(c){for(var i={data:c.data},e=i;c=c.next;)e=e.next={data:c.data};return i}var Vr=bn.prototype=Qr.prototype;function fn(c){return function(){return c}}function Qn(c){return 1e-6*(c()-.5)}Vr.copy=function(){var c,i,e=new Qr(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return e;if(!n.length)return e._root=_n(n),e;for(c=[{source:n,target:e._root=new Array(4)}];n=c.pop();)for(var u=0;u<4;++u)(i=n.source[u])&&(i.length?c.push({source:i,target:n.target[u]=new Array(4)}):n.target[u]=_n(i));return e},Vr.add=function(c){const i=+this._x.call(null,c),e=+this._y.call(null,c);return Gn(this.cover(i,e),i,e,c)},Vr.addAll=function(c){var i,e,n,u,g=c.length,x=new Array(g),M=new Array(g),S=1/0,T=1/0,k=-1/0,B=-1/0;for(e=0;e<g;++e)isNaN(n=+this._x.call(null,i=c[e]))||isNaN(u=+this._y.call(null,i))||(x[e]=n,M[e]=u,n<S&&(S=n),n>k&&(k=n),u<T&&(T=u),u>B&&(B=u));if(S>k||T>B)return this;for(this.cover(S,T).cover(k,B),e=0;e<g;++e)Gn(this,x[e],M[e],c[e]);return this},Vr.cover=function(c,i){if(isNaN(c=+c)||isNaN(i=+i))return this;var e=this._x0,n=this._y0,u=this._x1,g=this._y1;if(isNaN(e))u=(e=Math.floor(c))+1,g=(n=Math.floor(i))+1;else{for(var x,M,S=u-e||1,T=this._root;e>c||c>=u||n>i||i>=g;)switch(M=(i<n)<<1|c<e,(x=new Array(4))[M]=T,T=x,S*=2,M){case 0:u=e+S,g=n+S;break;case 1:e=u-S,g=n+S;break;case 2:u=e+S,n=g-S;break;case 3:e=u-S,n=g-S}this._root&&this._root.length&&(this._root=T)}return this._x0=e,this._y0=n,this._x1=u,this._y1=g,this},Vr.data=function(){var c=[];return this.visit(function(i){if(!i.length)do c.push(i.data);while(i=i.next)}),c},Vr.extent=function(c){return arguments.length?this.cover(+c[0][0],+c[0][1]).cover(+c[1][0],+c[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Vr.find=function(c,i,e){var n,u,g,x,M,S,T,k=this._x0,B=this._y0,Q=this._x1,et=this._y1,K=[],j=this._root;for(j&&K.push(new Kr(j,k,B,Q,et)),e==null?e=1/0:(k=c-e,B=i-e,Q=c+e,et=i+e,e*=e);S=K.pop();)if(!(!(j=S.node)||(u=S.x0)>Q||(g=S.y0)>et||(x=S.x1)<k||(M=S.y1)<B))if(j.length){var dt=(u+x)/2,ot=(g+M)/2;K.push(new Kr(j[3],dt,ot,x,M),new Kr(j[2],u,ot,dt,M),new Kr(j[1],dt,g,x,ot),new Kr(j[0],u,g,dt,ot)),(T=(i>=ot)<<1|c>=dt)&&(S=K[K.length-1],K[K.length-1]=K[K.length-1-T],K[K.length-1-T]=S)}else{var pt=c-+this._x.call(null,j.data),ne=i-+this._y.call(null,j.data),Kt=pt*pt+ne*ne;if(Kt<e){var qt=Math.sqrt(e=Kt);k=c-qt,B=i-qt,Q=c+qt,et=i+qt,n=j.data}}return n},Vr.remove=function(c){if(isNaN(g=+this._x.call(null,c))||isNaN(x=+this._y.call(null,c)))return this;var i,e,n,u,g,x,M,S,T,k,B,Q,et=this._root,K=this._x0,j=this._y0,dt=this._x1,ot=this._y1;if(!et)return this;if(et.length)for(;;){if((T=g>=(M=(K+dt)/2))?K=M:dt=M,(k=x>=(S=(j+ot)/2))?j=S:ot=S,i=et,!(et=et[B=k<<1|T]))return this;if(!et.length)break;(i[B+1&3]||i[B+2&3]||i[B+3&3])&&(e=i,Q=B)}for(;et.data!==c;)if(n=et,!(et=et.next))return this;return(u=et.next)&&delete et.next,n?(u?n.next=u:delete n.next,this):i?(u?i[B]=u:delete i[B],(et=i[0]||i[1]||i[2]||i[3])&&et===(i[3]||i[2]||i[1]||i[0])&&!et.length&&(e?e[Q]=et:this._root=et),this):(this._root=u,this)},Vr.removeAll=function(c){for(var i=0,e=c.length;i<e;++i)this.remove(c[i]);return this},Vr.root=function(){return this._root},Vr.size=function(){var c=0;return this.visit(function(i){if(!i.length)do++c;while(i=i.next)}),c},Vr.visit=function(c){var i,e,n,u,g,x,M=[],S=this._root;for(S&&M.push(new Kr(S,this._x0,this._y0,this._x1,this._y1));i=M.pop();)if(!c(S=i.node,n=i.x0,u=i.y0,g=i.x1,x=i.y1)&&S.length){var T=(n+g)/2,k=(u+x)/2;(e=S[3])&&M.push(new Kr(e,T,k,g,x)),(e=S[2])&&M.push(new Kr(e,n,k,T,x)),(e=S[1])&&M.push(new Kr(e,T,u,g,k)),(e=S[0])&&M.push(new Kr(e,n,u,T,k))}return this},Vr.visitAfter=function(c){var i,e=[],n=[];for(this._root&&e.push(new Kr(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var u=i.node;if(u.length){var g,x=i.x0,M=i.y0,S=i.x1,T=i.y1,k=(x+S)/2,B=(M+T)/2;(g=u[0])&&e.push(new Kr(g,x,M,k,B)),(g=u[1])&&e.push(new Kr(g,k,M,S,B)),(g=u[2])&&e.push(new Kr(g,x,B,k,T)),(g=u[3])&&e.push(new Kr(g,k,B,S,T))}n.push(i)}for(;i=n.pop();)c(i.node,i.x0,i.y0,i.x1,i.y1);return this},Vr.x=function(c){return arguments.length?(this._x=c,this):this._x},Vr.y=function(c){return arguments.length?(this._y=c,this):this._y};var Ii={value:()=>{}};function Di(){for(var c,i=0,e=arguments.length,n={};i<e;++i){if(!(c=arguments[i]+"")||c in n||/[\s.]/.test(c))throw new Error("illegal type: "+c);n[c]=[]}return new $o(n)}function $o(c){this._=c}function Ti(c,i){for(var e,n=0,u=c.length;n<u;++n)if((e=c[n]).name===i)return e.value}function li(c,i,e){for(var n=0,u=c.length;n<u;++n)if(c[n].name===i){c[n]=Ii,c=c.slice(0,n).concat(c.slice(n+1));break}return e!=null&&c.push({name:i,value:e}),c}$o.prototype=Di.prototype={constructor:$o,on:function(c,i){var e,n,u=this._,g=(n=u,(c+"").trim().split(/^|\s+/).map(function(S){var T="",k=S.indexOf(".");if(k>=0&&(T=S.slice(k+1),S=S.slice(0,k)),S&&!n.hasOwnProperty(S))throw new Error("unknown type: "+S);return{type:S,name:T}})),x=-1,M=g.length;if(!(arguments.length<2)){if(i!=null&&typeof i!="function")throw new Error("invalid callback: "+i);for(;++x<M;)if(e=(c=g[x]).type)u[e]=li(u[e],c.name,i);else if(i==null)for(e in u)u[e]=li(u[e],c.name,null);return this}for(;++x<M;)if((e=(c=g[x]).type)&&(e=Ti(u[e],c.name)))return e},copy:function(){var c={},i=this._;for(var e in i)c[e]=i[e].slice();return new $o(c)},call:function(c,i){if((e=arguments.length-2)>0)for(var e,n,u=new Array(e),g=0;g<e;++g)u[g]=arguments[g+2];if(!this._.hasOwnProperty(c))throw new Error("unknown type: "+c);for(g=0,e=(n=this._[c]).length;g<e;++g)n[g].value.apply(i,u)},apply:function(c,i,e){if(!this._.hasOwnProperty(c))throw new Error("unknown type: "+c);for(var n=this._[c],u=0,g=n.length;u<g;++u)n[u].value.apply(i,e)}};const Po=Di;var Nn,Ri,zo=0,vo=0,fi=0,_a=1e3,Ho=0,Xo=0,Yi=0,gi=typeof performance=="object"&&performance.now?performance:Date,Ki=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(c){setTimeout(c,17)};function fs(){return Xo||(Ki(Yo),Xo=gi.now()+Yi)}function Yo(){Xo=0}function Zi(){this._call=this._time=this._next=null}function mo(c,i,e){var n=new Zi;return n.restart(c,i,e),n}function Ya(){Xo=(Ho=gi.now())+Yi,zo=vo=0;try{(function(){fs(),++zo;for(var c,i=Nn;i;)(c=Xo-i._time)>=0&&i._call.call(void 0,c),i=i._next;--zo})()}finally{zo=0,function(){for(var c,i,e=Nn,n=1/0;e;)e._call?(n>e._time&&(n=e._time),c=e,e=e._next):(i=e._next,e._next=null,e=c?c._next=i:Nn=i);Ri=c,Ji(n)}(),Xo=0}}function Go(){var c=gi.now(),i=c-Ho;i>_a&&(Yi-=i,Ho=c)}function Ji(c){zo||(vo&&(vo=clearTimeout(vo)),c-Xo>24?(c<1/0&&(vo=setTimeout(Ya,c-gi.now()-Yi)),fi&&(fi=clearInterval(fi))):(fi||(Ho=gi.now(),fi=setInterval(Go,_a)),zo=1,Ki(Ya)))}Zi.prototype=mo.prototype={constructor:Zi,restart:function(c,i,e){if(typeof c!="function")throw new TypeError("callback is not a function");e=(e==null?fs():+e)+(i==null?0:+i),this._next||Ri===this||(Ri?Ri._next=this:Nn=this,Ri=this),this._call=c,this._time=e,Ji()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ji())}};const pi=1664525,ka=1013904223,Ia=4294967296;function gs(c){return c.x}function ps(c){return c.y}var vs=10,ms=Math.PI*(3-Math.sqrt(5));function ys(c){var i,e=1,n=.001,u=1-Math.pow(n,1/300),g=0,x=.6,M=new Map,S=mo(B),T=Po("tick","end"),k=function(){let j=1;return()=>(j=(pi*j+ka)%Ia)/Ia}();function B(){Q(),T.call("tick",i),e<n&&(S.stop(),T.call("end",i))}function Q(j){var dt,ot,pt=c.length;j===void 0&&(j=1);for(var ne=0;ne<j;++ne)for(e+=(g-e)*u,M.forEach(function(Kt){Kt(e)}),dt=0;dt<pt;++dt)(ot=c[dt]).fx==null?ot.x+=ot.vx*=x:(ot.x=ot.fx,ot.vx=0),ot.fy==null?ot.y+=ot.vy*=x:(ot.y=ot.fy,ot.vy=0);return i}function et(){for(var j,dt=0,ot=c.length;dt<ot;++dt){if((j=c[dt]).index=dt,j.fx!=null&&(j.x=j.fx),j.fy!=null&&(j.y=j.fy),isNaN(j.x)||isNaN(j.y)){var pt=vs*Math.sqrt(.5+dt),ne=dt*ms;j.x=pt*Math.cos(ne),j.y=pt*Math.sin(ne)}(isNaN(j.vx)||isNaN(j.vy))&&(j.vx=j.vy=0)}}function K(j){return j.initialize&&j.initialize(c,k),j}return c==null&&(c=[]),et(),i={tick:Q,restart:function(){return S.restart(B),i},stop:function(){return S.stop(),i},nodes:function(j){return arguments.length?(c=j,et(),M.forEach(K),i):c},alpha:function(j){return arguments.length?(e=+j,i):e},alphaMin:function(j){return arguments.length?(n=+j,i):n},alphaDecay:function(j){return arguments.length?(u=+j,i):+u},alphaTarget:function(j){return arguments.length?(g=+j,i):g},velocityDecay:function(j){return arguments.length?(x=1-j,i):1-x},randomSource:function(j){return arguments.length?(k=j,M.forEach(K),i):k},force:function(j,dt){return arguments.length>1?(dt==null?M.delete(j):M.set(j,K(dt)),i):M.get(j)},find:function(j,dt,ot){var pt,ne,Kt,qt,Nt,Pt=0,Ht=c.length;for(ot==null?ot=1/0:ot*=ot,Pt=0;Pt<Ht;++Pt)(Kt=(pt=j-(qt=c[Pt]).x)*pt+(ne=dt-qt.y)*ne)<ot&&(Nt=qt,ot=Kt);return Nt},on:function(j,dt){return arguments.length>1?(T.on(j,dt),i):T.on(j)}}}function ws(){var c,i,e,n,u,g=fn(-30),x=1,M=1/0,S=.81;function T(et){var K,j=c.length,dt=bn(c,gs,ps).visitAfter(B);for(n=et,K=0;K<j;++K)i=c[K],dt.visit(Q)}function k(){if(c){var et,K,j=c.length;for(u=new Array(j),et=0;et<j;++et)K=c[et],u[K.index]=+g(K,et,c)}}function B(et){var K,j,dt,ot,pt,ne=0,Kt=0;if(et.length){for(dt=ot=pt=0;pt<4;++pt)(K=et[pt])&&(j=Math.abs(K.value))&&(ne+=K.value,Kt+=j,dt+=j*K.x,ot+=j*K.y);et.x=dt/Kt,et.y=ot/Kt}else{(K=et).x=K.data.x,K.y=K.data.y;do ne+=u[K.data.index];while(K=K.next)}et.value=ne}function Q(et,K,j,dt){if(!et.value)return!0;var ot=et.x-i.x,pt=et.y-i.y,ne=dt-K,Kt=ot*ot+pt*pt;if(ne*ne/S<Kt)return Kt<M&&(ot===0&&(Kt+=(ot=Qn(e))*ot),pt===0&&(Kt+=(pt=Qn(e))*pt),Kt<x&&(Kt=Math.sqrt(x*Kt)),i.vx+=ot*et.value*n/Kt,i.vy+=pt*et.value*n/Kt),!0;if(!(et.length||Kt>=M)){(et.data!==i||et.next)&&(ot===0&&(Kt+=(ot=Qn(e))*ot),pt===0&&(Kt+=(pt=Qn(e))*pt),Kt<x&&(Kt=Math.sqrt(x*Kt)));do et.data!==i&&(ne=u[et.data.index]*n/Kt,i.vx+=ot*ne,i.vy+=pt*ne);while(et=et.next)}}return T.initialize=function(et,K){c=et,e=K,k()},T.strength=function(et){return arguments.length?(g=typeof et=="function"?et:fn(+et),k(),T):g},T.distanceMin=function(et){return arguments.length?(x=et*et,T):Math.sqrt(x)},T.distanceMax=function(et){return arguments.length?(M=et*et,T):Math.sqrt(M)},T.theta=function(et){return arguments.length?(S=et*et,T):Math.sqrt(S)},T}function Ka(c){return c.index}function Qi(c,i){var e=c.get(i);if(!e)throw new Error("node not found: "+i);return e}function Za(c){var i,e,n,u,g,x,M=Ka,S=function(j){return 1/Math.min(u[j.source.index],u[j.target.index])},T=fn(30),k=1;function B(j){for(var dt=0,ot=c.length;dt<k;++dt)for(var pt,ne,Kt,qt,Nt,Pt,Ht,Ct=0;Ct<ot;++Ct)ne=(pt=c[Ct]).source,qt=(Kt=pt.target).x+Kt.vx-ne.x-ne.vx||Qn(x),Nt=Kt.y+Kt.vy-ne.y-ne.vy||Qn(x),qt*=Pt=((Pt=Math.sqrt(qt*qt+Nt*Nt))-e[Ct])/Pt*j*i[Ct],Nt*=Pt,Kt.vx-=qt*(Ht=g[Ct]),Kt.vy-=Nt*Ht,ne.vx+=qt*(Ht=1-Ht),ne.vy+=Nt*Ht}function Q(){if(n){var j,dt,ot=n.length,pt=c.length,ne=new Map(n.map((Kt,qt)=>[M(Kt,qt,n),Kt]));for(j=0,u=new Array(ot);j<pt;++j)(dt=c[j]).index=j,typeof dt.source!="object"&&(dt.source=Qi(ne,dt.source)),typeof dt.target!="object"&&(dt.target=Qi(ne,dt.target)),u[dt.source.index]=(u[dt.source.index]||0)+1,u[dt.target.index]=(u[dt.target.index]||0)+1;for(j=0,g=new Array(pt);j<pt;++j)dt=c[j],g[j]=u[dt.source.index]/(u[dt.source.index]+u[dt.target.index]);i=new Array(pt),et(),e=new Array(pt),K()}}function et(){if(n)for(var j=0,dt=c.length;j<dt;++j)i[j]=+S(c[j],j,c)}function K(){if(n)for(var j=0,dt=c.length;j<dt;++j)e[j]=+T(c[j],j,c)}return c==null&&(c=[]),B.initialize=function(j,dt){n=j,x=dt,Q()},B.links=function(j){return arguments.length?(c=j,Q(),B):c},B.id=function(j){return arguments.length?(M=j,B):M},B.iterations=function(j){return arguments.length?(k=+j,B):k},B.strength=function(j){return arguments.length?(S=typeof j=="function"?j:fn(+j),et(),B):S},B.distance=function(j){return arguments.length?(T=typeof j=="function"?j:fn(+j),K(),B):T},B}function Cs(c){return c.x+c.vx}function Es(c){return c.y+c.vy}function Ja(c){var i,e,n,u=1,g=1;function x(){for(var T,k,B,Q,et,K,j,dt=i.length,ot=0;ot<g;++ot)for(k=bn(i,Cs,Es).visitAfter(M),T=0;T<dt;++T)B=i[T],K=e[B.index],j=K*K,Q=B.x+B.vx,et=B.y+B.vy,k.visit(pt);function pt(ne,Kt,qt,Nt,Pt){var Ht=ne.data,Ct=ne.r,V=K+Ct;if(!Ht)return Kt>Q+V||Nt<Q-V||qt>et+V||Pt<et-V;if(Ht.index>B.index){var st=Q-Ht.x-Ht.vx,It=et-Ht.y-Ht.vy,mt=st*st+It*It;mt<V*V&&(st===0&&(mt+=(st=Qn(n))*st),It===0&&(mt+=(It=Qn(n))*It),mt=(V-(mt=Math.sqrt(mt)))/mt*u,B.vx+=(st*=mt)*(V=(Ct*=Ct)/(j+Ct)),B.vy+=(It*=mt)*V,Ht.vx-=st*(V=1-V),Ht.vy-=It*V)}}}function M(T){if(T.data)return T.r=e[T.data.index];for(var k=T.r=0;k<4;++k)T[k]&&T[k].r>T.r&&(T.r=T[k].r)}function S(){if(i){var T,k,B=i.length;for(e=new Array(B),T=0;T<B;++T)k=i[T],e[k.index]=+c(k,T,i)}}return typeof c!="function"&&(c=fn(c==null?1:+c)),x.initialize=function(T,k){i=T,n=k,S()},x.iterations=function(T){return arguments.length?(g=+T,x):g},x.strength=function(T){return arguments.length?(u=+T,x):u},x.radius=function(T){return arguments.length?(c=typeof T=="function"?T:fn(+T),S(),x):c},x}function Ko(){function c(qt){return function(){return qt}}var i,e=function(qt){return qt.cluster},n=c(1),u=c(-1),g=c(100),x=c(.1),M=[0,0],S=[],T={},k=[],B=100,Q=100,et={none:{x:0,y:0}},K=[],j="force",dt=!0,ot=.1;function pt(qt){if(!dt)return pt;i.tick(),Kt();for(var Nt=0,Pt=S.length,Ht=void 0,Ct=qt*ot;Nt<Pt;++Nt)(Ht=S[Nt]).vx+=(et[e(Ht)].x-Ht.x)*Ct,Ht.vy+=(et[e(Ht)].y-Ht.y)*Ct}function ne(){S&&function(){if(S&&S.length){if(e(S[0])===void 0)throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy('clusterAttr') before calling .links()");var qt,Nt,Pt,Ht,Ct,V=(qt=[],Nt=[],Pt={},Ct=[],Ht=function(st){var It={};return st.forEach(function(mt){var X=e(mt);It[X]||(It[X]={count:0,sumforceNodeSize:0})}),st.forEach(function(mt){var X=e(mt),D=n(mt),W=It[X];W.count=W.count+1,W.sumforceNodeSize=W.sumforceNodeSize+Math.PI*(D*D)*1.3,It[X]=W}),It}(S),Ct=function(st){var It={},mt=[];return st.forEach(function(X){var D,W,vt,yt,At,I=(W=(D=X).source,vt=D.target,(yt=e(T[W]))<=(At=e(T[vt]))?yt+"~"+At:At+"~"+yt),P=0;It[I]!==void 0&&(P=It[I]),P+=1,It[I]=P}),Object.entries(It).forEach(function(X){var D=ue(X,2),W=D[0],vt=D[1],yt=W.split("~")[0],At=W.split("~")[1];yt!==void 0&&At!==void 0&&mt.push({source:yt,target:At,count:vt})}),mt}(k),Object.keys(Ht).forEach(function(st,It){var mt=Ht[st];qt.push({id:st,size:mt.count,r:Math.sqrt(mt.sumforceNodeSize/Math.PI)}),Pt[st]=It}),Ct.forEach(function(st){var It=st.source,mt=st.target,X=Pt[It],D=Pt[mt];X!==void 0&&D!==void 0&&Nt.push({source:X,target:D,count:st.count})}),{nodes:qt,links:Nt});i=ys(V.nodes).force("x",function(st){var It,mt,X,D=fn(.1);function W(yt){for(var At,I=0,P=It.length;I<P;++I)(At=It[I]).vx+=(X[I]-At.x)*mt[I]*yt}function vt(){if(It){var yt,At=It.length;for(mt=new Array(At),X=new Array(At),yt=0;yt<At;++yt)mt[yt]=isNaN(X[yt]=+st(It[yt],yt,It))?0:+D(It[yt],yt,It)}}return typeof st!="function"&&(st=fn(st==null?0:+st)),W.initialize=function(yt){It=yt,vt()},W.strength=function(yt){return arguments.length?(D=typeof yt=="function"?yt:fn(+yt),vt(),W):D},W.x=function(yt){return arguments.length?(st=typeof yt=="function"?yt:fn(+yt),vt(),W):st},W}(B).strength(.1)).force("y",function(st){var It,mt,X,D=fn(.1);function W(yt){for(var At,I=0,P=It.length;I<P;++I)(At=It[I]).vy+=(X[I]-At.y)*mt[I]*yt}function vt(){if(It){var yt,At=It.length;for(mt=new Array(At),X=new Array(At),yt=0;yt<At;++yt)mt[yt]=isNaN(X[yt]=+st(It[yt],yt,It))?0:+D(It[yt],yt,It)}}return typeof st!="function"&&(st=fn(st==null?0:+st)),W.initialize=function(yt){It=yt,vt()},W.strength=function(yt){return arguments.length?(D=typeof yt=="function"?yt:fn(+yt),vt(),W):D},W.y=function(yt){return arguments.length?(st=typeof yt=="function"?yt:fn(+yt),vt(),W):st},W}(Q).strength(.1)).force("collide",Ja(function(st){return st.r}).iterations(4)).force("charge",ws().strength(u)).force("links",Za(V.nodes.length?V.links:[]).distance(g).strength(x)),K=i.nodes(),Kt()}}()}function Kt(){return et={none:{x:0,y:0}},K.forEach(function(qt){et[qt.id]={x:qt.x-M[0],y:qt.y-M[1]}}),et}return pt.initialize=function(qt){S=qt,ne()},pt.template=function(qt){return arguments.length?(j=qt,ne(),pt):j},pt.groupBy=function(qt){return arguments.length?typeof qt=="string"?(e=function(Nt){return Nt[qt]},pt):(e=qt,pt):e},pt.enableGrouping=function(qt){return arguments.length?(dt=qt,pt):dt},pt.strength=function(qt){return arguments.length?(ot=qt,pt):ot},pt.centerX=function(qt){return arguments.length?(B=qt,pt):B},pt.centerY=function(qt){return arguments.length?(Q=qt,pt):Q},pt.nodes=function(qt){return arguments.length?(function(Nt){T={},Nt.forEach(function(Pt){T[Pt.id]=Pt})}(qt||[]),S=qt||[],pt):S},pt.links=function(qt){return arguments.length?(k=qt||[],ne(),pt):k},pt.forceNodeSize=function(qt){return arguments.length?(n=typeof qt=="function"?qt:c(+qt),ne(),pt):n},pt.nodeSize=pt.forceNodeSize,pt.forceCharge=function(qt){return arguments.length?(u=typeof qt=="function"?qt:c(+qt),ne(),pt):u},pt.forceLinkDistance=function(qt){return arguments.length?(g=typeof qt=="function"?qt:c(+qt),ne(),pt):g},pt.forceLinkStrength=function(qt){return arguments.length?(x=typeof qt=="function"?qt:c(+qt),ne(),pt):x},pt.offset=function(qt){return arguments.length?(M=qt,pt):M},pt.getFocis=Kt,pt}var Ls={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},Da=function(){function c(i){i===void 0&&(i={}),this.options=i,this.id="d3force",this.options=z(z({},Ls),i)}return c.prototype.execute=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return[2,this.genericForceLayout(!1,i,e)]})})},c.prototype.assign=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return this.genericForceLayout(!0,i,e),[2]})})},c.prototype.stop=function(){var i;(i=this.forceSimulation)===null||i===void 0||i.stop()},c.prototype.tick=function(i){var e=this;i===void 0&&(i=1),this.forceSimulation.tick(i);var n={nodes:Oi(this.lastLayoutNodes),edges:ta(this.lastLayoutEdges)};return this.lastAssign&&n.nodes.forEach(function(u){return e.lastGraph.mergeNodeData(u.id,{x:u.data.x,y:u.data.y})}),n},c.prototype.genericForceLayout=function(i,e,n){return Mt(this,void 0,void 0,function(){var u,g,x,M,S,T,k,B,Q,et,K,j,dt,ot,pt,ne,Kt,qt,Nt,Pt,Ht,Ct,V,st,It,mt,X=this;return te(this,function(D){return u=z(z({},this.options),n),g=e.getAllNodes(),x=e.getAllEdges(),M=g.map(function(W){var vt,yt;return z(z({},Xr(W)),{x:(vt=W.data)===null||vt===void 0?void 0:vt.x,y:(yt=W.data)===null||yt===void 0?void 0:yt.y})}),S=x.map(function(W){return Xr(W)}),this.lastLayoutNodes=M,this.lastLayoutEdges=S,this.lastAssign=i,this.lastGraph=e,T=u.alphaMin,k=u.alphaDecay,B=u.alpha,Q=u.nodeStrength,et=u.edgeStrength,K=u.linkDistance,j=u.clustering,dt=u.clusterFociStrength,ot=u.clusterEdgeDistance,pt=u.clusterEdgeStrength,ne=u.clusterNodeStrength,Kt=u.clusterNodeSize,qt=u.collideStrength,Nt=qt===void 0?1:qt,Pt=u.center,Ht=Pt===void 0?[0,0]:Pt,Ct=u.preventOverlap,V=u.nodeSize,st=u.nodeSpacing,It=u.onTick,mt=u.forceSimulation,[2,new Promise(function(W){if(mt){j&&((At=Ko()).nodes(M),At.links(S)),mt.nodes(M),S&&(P=Za().id(function(C){return C.id}).links(S),et&&P.strength(et),K&&P.distance(K),mt.force("link",P)),Ct&&X.overlapProcess(mt,{nodeSize:V,nodeSpacing:st,collideStrength:Nt}),mt.alpha(B).restart();var vt=Oi(M),yt=ta(S);i&&vt.forEach(function(C){return e.mergeNodeData(C.id,{x:C.data.x,y:C.data.y})}),W({nodes:vt,edges:yt})}else try{var At,I=ws();if(Q&&I.strength(Q),mt=ys().nodes(M),j&&((At=Ko()).centerX(Ht[0]).centerY(Ht[1]).template("force").strength(dt),S&&At.links(S),M&&At.nodes(M),At.forceLinkDistance(ot).forceLinkStrength(pt).forceCharge(ne).forceNodeSize(Kt),mt.force("group",At)),mt.force("center",function(C,O){var ut,xt=1;function G(){var U,lt,it=ut.length,ft=0,Rt=0;for(U=0;U<it;++U)ft+=(lt=ut[U]).x,Rt+=lt.y;for(ft=(ft/it-C)*xt,Rt=(Rt/it-O)*xt,U=0;U<it;++U)(lt=ut[U]).x-=ft,lt.y-=Rt}return C==null&&(C=0),O==null&&(O=0),G.initialize=function(U){ut=U},G.x=function(U){return arguments.length?(C=+U,G):C},G.y=function(U){return arguments.length?(O=+U,G):O},G.strength=function(U){return arguments.length?(xt=+U,G):xt},G}(Ht[0],Ht[1])).force("charge",I).alpha(B).alphaDecay(k).alphaMin(T),Ct&&X.overlapProcess(mt,{nodeSize:V,nodeSpacing:st,collideStrength:Nt}),S){var P=Za().id(function(C){return C.id}).links(S);et&&P.strength(et),K&&P.distance(K),mt.force("link",P)}mt.on("tick",function(){var C=Oi(M);It==null||It({nodes:C,edges:ta(S)}),i&&C.forEach(function(O){return e.mergeNodeData(O.id,{x:O.data.x,y:O.data.y})})}).on("end",function(){var C=Oi(M);i&&C.forEach(function(O){return e.mergeNodeData(O.id,{x:O.data.x,y:O.data.y})}),W({nodes:C,edges:ta(S)})})}catch(C){console.warn(C)}X.forceSimulation=mt})]})})},c.prototype.overlapProcess=function(i,e){var n,u,g=e.nodeSize,x=e.nodeSpacing,M=e.collideStrength;if(u=Te(x)?function(){return x}:hn(x)?x:function(){return 0},g)if(hn(g))n=function(k){return g(k)+u(k)};else if(Qe(g)){var S=(g[0]>g[1]?g[0]:g[1])/2;n=function(k){return S+u(k)}}else if(Te(g)){var T=g/2;n=function(k){return T+u(k)}}else n=function(){return 10};else n=function(k){return k.size?Qe(k.size)?(k.size[0]>k.size[1]?k.size[0]:k.size[1])/2+u(k):Rn(k.size)?(k.size.width>k.size.height?k.size.width:k.size.height)/2+u(k):k.size/2+u(k):10+u(k)};i.force("collisionForce",Ja(n).strength(M))},c}(),Oi=function(c){return c.map(function(i){var e=i.x,n=i.y,u=Lt(i,["x","y"]);return z(z({},u),{data:z(z({},u.data),{x:e,y:n})})})},ta=function(c){return c.map(function(i){var e=i.source,n=i.target,u=Lt(i,["source","target"]);return z(z({},u),{source:e.id,target:n.id})})};const Ps=function(){function c(){this._events={}}return c.prototype.on=function(i,e,n){return this._events[i]||(this._events[i]=[]),this._events[i].push({callback:e,once:!!n}),this},c.prototype.once=function(i,e){return this.on(i,e,!0)},c.prototype.emit=function(i){for(var e=this,n=[],u=1;u<arguments.length;u++)n[u-1]=arguments[u];var g=this._events[i]||[],x=this._events["*"]||[],M=function(S){for(var T=S.length,k=0;k<T;k++)if(S[k]){var B=S[k],Q=B.callback;B.once&&(S.splice(k,1),S.length===0&&delete e._events[i],T--,k--),Q.apply(e,n)}};M(g),M(x)},c.prototype.off=function(i,e){if(i)if(e){for(var n=this._events[i]||[],u=n.length,g=0;g<u;g++)n[g].callback===e&&(n.splice(g,1),u--,g--);n.length===0&&delete this._events[i]}else delete this._events[i];else this._events={};return this},c.prototype.getEvents=function(){return this._events},c}();function xs(c,i,e,n){for(;c.length;){const u=c.shift();if(e(u))return!0;i.add(u.id),n(u.id).forEach(g=>{i.has(g.id)||(i.add(g.id),c.push(g))})}return!1}function Ta(c,i,e,n){if(e(c))return!0;i.add(c.id);for(const u of n(c.id))if(!i.has(u.id)&&Ta(u,i,e,n))return!0;return!1}class to extends Ps{constructor(e){super();en(this,"nodeMap",new Map);en(this,"edgeMap",new Map);en(this,"inEdgesMap",new Map);en(this,"outEdgesMap",new Map);en(this,"bothEdgesMap",new Map);en(this,"treeIndices",new Map);en(this,"changes",[]);en(this,"batchCount",0);en(this,"onChanged",()=>{});en(this,"batch",e=>{this.batchCount+=1,e(),this.batchCount-=1,this.batchCount||this.commit()});e&&(e.nodes&&this.addNodes(e.nodes),e.edges&&this.addEdges(e.edges),e.tree&&this.addTree(e.tree),e.onChanged&&(this.onChanged=e.onChanged))}commit(){const e=this.changes;this.changes=[];const n={graph:this,changes:e};this.emit("changed",n),this.onChanged(n)}reduceChanges(e){let n=[];return e.forEach(u=>{switch(u.type){case"NodeRemoved":{let g=!1;n=n.filter(x=>{if(x.type==="NodeAdded"){const M=x.value.id===u.value.id;return M&&(g=!0),!M}return x.type==="NodeDataUpdated"?x.id!==u.value.id:x.type!=="TreeStructureChanged"||x.nodeId!==u.value.id}),g||n.push(u);break}case"EdgeRemoved":{let g=!1;n=n.filter(x=>{if(x.type==="EdgeAdded"){const M=x.value.id===u.value.id;return M&&(g=!0),!M}return x.type!=="EdgeDataUpdated"&&x.type!=="EdgeUpdated"||x.id!==u.value.id}),g||n.push(u);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const g=n.find(x=>x.type===u.type&&x.id===u.id&&x.propertyName===u.propertyName);g?g.newValue=u.newValue:n.push(u);break}case"TreeStructureDetached":n=n.filter(g=>g.type==="TreeStructureAttached"?g.treeKey!==u.treeKey:g.type!=="TreeStructureChanged"||g.treeKey!==u.treeKey),n.push(u);break;case"TreeStructureChanged":{const g=n.find(x=>x.type==="TreeStructureChanged"&&x.treeKey===u.treeKey&&x.nodeId===u.nodeId);g?g.newParentId=u.newParentId:n.push(u);break}default:n.push(u)}}),n}checkNodeExistence(e){this.getNode(e)}hasNode(e){return this.nodeMap.has(e)}areNeighbors(e,n){return this.getNeighbors(n).some(u=>u.id===e)}getNode(e){const n=this.nodeMap.get(e);if(!n)throw new Error("Node not found for id: "+e);return n}getRelatedEdges(e,n){if(this.checkNodeExistence(e),n==="in"){const u=this.inEdgesMap.get(e);return Array.from(u)}if(n==="out"){const u=this.outEdgesMap.get(e);return Array.from(u)}{const u=this.bothEdgesMap.get(e);return Array.from(u)}}getDegree(e,n){return this.getRelatedEdges(e,n).length}getSuccessors(e){const n=this.getRelatedEdges(e,"out").map(u=>this.getNode(u.target));return Array.from(new Set(n))}getPredecessors(e){const n=this.getRelatedEdges(e,"in").map(u=>this.getNode(u.source));return Array.from(new Set(n))}getNeighbors(e){const n=this.getPredecessors(e),u=this.getSuccessors(e);return Array.from(new Set([...n,...u]))}doAddNode(e){if(this.hasNode(e.id))throw new Error("Node already exists: "+e.id);this.nodeMap.set(e.id,e),this.inEdgesMap.set(e.id,new Set),this.outEdgesMap.set(e.id,new Set),this.bothEdgesMap.set(e.id,new Set),this.treeIndices.forEach(n=>{n.childrenMap.set(e.id,new Set)}),this.changes.push({type:"NodeAdded",value:e})}addNodes(e){this.batch(()=>{for(const n of e)this.doAddNode(n)})}addNode(e){this.addNodes([e])}doRemoveNode(e){const n=this.getNode(e),u=this.bothEdgesMap.get(e);u==null||u.forEach(g=>this.doRemoveEdge(g.id)),this.nodeMap.delete(e),this.treeIndices.forEach(g=>{var x;(x=g.childrenMap.get(e))==null||x.forEach(M=>{g.parentMap.delete(M.id)}),g.parentMap.delete(e),g.childrenMap.delete(e)}),this.changes.push({type:"NodeRemoved",value:n})}removeNodes(e){this.batch(()=>{e.forEach(n=>this.doRemoveNode(n))})}removeNode(e){this.removeNodes([e])}updateNodeDataProperty(e,n,u){const g=this.getNode(e);this.batch(()=>{const x=g.data[n],M=u;g.data[n]=M,this.changes.push({type:"NodeDataUpdated",id:e,propertyName:n,oldValue:x,newValue:M})})}mergeNodeData(e,n){this.batch(()=>{Object.entries(n).forEach(([u,g])=>{this.updateNodeDataProperty(e,u,g)})})}updateNodeData(...e){const n=e[0],u=this.getNode(n);if(typeof e[1]=="string")return void this.updateNodeDataProperty(n,e[1],e[2]);let g;if(typeof e[1]=="function"){const x=e[1];g=x(u.data)}else typeof e[1]=="object"&&(g=e[1]);this.batch(()=>{const x=u.data,M=g;u.data=g,this.changes.push({type:"NodeDataUpdated",id:n,oldValue:x,newValue:M})})}checkEdgeExistence(e){if(!this.hasEdge(e))throw new Error("Edge not found for id: "+e)}hasEdge(e){return this.edgeMap.has(e)}getEdge(e){return this.checkEdgeExistence(e),this.edgeMap.get(e)}getEdgeDetail(e){const n=this.getEdge(e);return{edge:n,source:this.getNode(n.source),target:this.getNode(n.target)}}doAddEdge(e){if(this.hasEdge(e.id))throw new Error("Edge already exists: "+e.id);this.checkNodeExistence(e.source),this.checkNodeExistence(e.target),this.edgeMap.set(e.id,e);const n=this.inEdgesMap.get(e.target),u=this.outEdgesMap.get(e.source),g=this.bothEdgesMap.get(e.source),x=this.bothEdgesMap.get(e.target);n.add(e),u.add(e),g.add(e),x.add(e),this.changes.push({type:"EdgeAdded",value:e})}addEdges(e){this.batch(()=>{for(const n of e)this.doAddEdge(n)})}addEdge(e){this.addEdges([e])}doRemoveEdge(e){const n=this.getEdge(e),u=this.outEdgesMap.get(n.source),g=this.inEdgesMap.get(n.target),x=this.bothEdgesMap.get(n.source),M=this.bothEdgesMap.get(n.target);u.delete(n),g.delete(n),x.delete(n),M.delete(n),this.edgeMap.delete(e),this.changes.push({type:"EdgeRemoved",value:n})}removeEdges(e){this.batch(()=>{e.forEach(n=>this.doRemoveEdge(n))})}removeEdge(e){this.removeEdges([e])}updateEdgeSource(e,n){const u=this.getEdge(e);this.checkNodeExistence(n);const g=u.source,x=n;this.outEdgesMap.get(g).delete(u),this.bothEdgesMap.get(g).delete(u),this.outEdgesMap.get(x).add(u),this.bothEdgesMap.get(x).add(u),u.source=n,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:e,propertyName:"source",oldValue:g,newValue:x})})}updateEdgeTarget(e,n){const u=this.getEdge(e);this.checkNodeExistence(n);const g=u.target,x=n;this.inEdgesMap.get(g).delete(u),this.bothEdgesMap.get(g).delete(u),this.inEdgesMap.get(x).add(u),this.bothEdgesMap.get(x).add(u),u.target=n,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:e,propertyName:"target",oldValue:g,newValue:x})})}updateEdgeDataProperty(e,n,u){const g=this.getEdge(e);this.batch(()=>{const x=g.data[n],M=u;g.data[n]=M,this.changes.push({type:"EdgeDataUpdated",id:e,propertyName:n,oldValue:x,newValue:M})})}updateEdgeData(...e){const n=e[0],u=this.getEdge(n);if(typeof e[1]=="string")return void this.updateEdgeDataProperty(n,e[1],e[2]);let g;if(typeof e[1]=="function"){const x=e[1];g=x(u.data)}else typeof e[1]=="object"&&(g=e[1]);this.batch(()=>{const x=u.data,M=g;u.data=g,this.changes.push({type:"EdgeDataUpdated",id:n,oldValue:x,newValue:M})})}mergeEdgeData(e,n){this.batch(()=>{Object.entries(n).forEach(([u,g])=>{this.updateEdgeDataProperty(e,u,g)})})}checkTreeExistence(e){if(!this.hasTreeStructure(e))throw new Error("Tree structure not found for treeKey: "+e)}hasTreeStructure(e){return this.treeIndices.has(e)}attachTreeStructure(e){this.treeIndices.has(e)||(this.treeIndices.set(e,{parentMap:new Map,childrenMap:new Map}),this.batch(()=>{this.changes.push({type:"TreeStructureAttached",treeKey:e})}))}detachTreeStructure(e){this.checkTreeExistence(e),this.treeIndices.delete(e),this.batch(()=>{this.changes.push({type:"TreeStructureDetached",treeKey:e})})}addTree(e,n){this.batch(()=>{this.attachTreeStructure(n);const u=[],g=Array.isArray(e)?e:[e];for(;g.length;){const x=g.shift();u.push(x),x.children&&g.push(...x.children)}this.addNodes(u),u.forEach(x=>{var M;(M=x.children)==null||M.forEach(S=>{this.setParent(S.id,x.id,n)})})})}getRoots(e){return this.checkTreeExistence(e),this.getAllNodes().filter(n=>!this.getParent(n.id,e))}getChildren(e,n){this.checkNodeExistence(e),this.checkTreeExistence(n);const u=this.treeIndices.get(n).childrenMap.get(e);return Array.from(u||[])}getParent(e,n){return this.checkNodeExistence(e),this.checkTreeExistence(n),this.treeIndices.get(n).parentMap.get(e)||null}getAncestors(e,n){const u=[];let g,x=this.getNode(e);for(;g=this.getParent(x.id,n);)u.push(g),x=g;return u}setParent(e,n,u){var k;this.checkTreeExistence(u);const g=this.treeIndices.get(u),x=this.getNode(e),M=g.parentMap.get(e),S=this.getNode(n);g.parentMap.set(e,S),M&&((k=g.childrenMap.get(M.id))==null||k.delete(x));let T=g.childrenMap.get(S.id);T||(T=new Set,g.childrenMap.set(S.id,T)),T.add(x),this.batch(()=>{this.changes.push({type:"TreeStructureChanged",treeKey:u,nodeId:e,oldParentId:M==null?void 0:M.id,newParentId:S.id})})}dfsTree(e,n,u){return Ta(this.getNode(e),new Set,n,g=>this.getChildren(g,u))}bfsTree(e,n,u){return xs([this.getNode(e)],new Set,n,g=>this.getChildren(g,u))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(e,n,u="out"){const g={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[u];return xs([this.getNode(e)],new Set,n,g)}dfs(e,n,u="out"){const g={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[u];return Ta(this.getNode(e),new Set,n,g)}clone(){const e=this.getAllNodes().map(g=>({...g,data:{...g.data}})),n=this.getAllEdges().map(g=>({...g,data:{...g.data}})),u=new to({nodes:e,edges:n});return this.treeIndices.forEach(({parentMap:g,childrenMap:x},M)=>{const S=new Map;g.forEach((k,B)=>{S.set(B,u.getNode(k.id))});const T=new Map;x.forEach((k,B)=>{T.set(B,new Set(Array.from(k).map(Q=>u.getNode(Q.id))))}),u.treeIndices.set(M,{parentMap:S,childrenMap:T})}),u}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var ea=function(c,i){if(c!=="next"&&c!=="prev")return i},bs=function(c){c.prev.next=c.next,c.next.prev=c.prev,delete c.next,delete c.prev},ra=function(c){function i(){return c!==null&&c.apply(this,arguments)||this}return Bt(i,c),i}(function(){function c(){var i={};i.prev=i,i.next=i.prev,this.shortcut=i}return c.prototype.dequeue=function(){var i=this.shortcut,e=i.prev;if(e&&e!==i)return bs(e),e},c.prototype.enqueue=function(i){var e=this.shortcut;i.prev&&i.next&&bs(i),i.next=e.next,e.next.prev=i,e.next=i,i.prev=e},c.prototype.toString=function(){for(var i=[],e=this.shortcut,n=e.prev;n!==e;)i.push(JSON.stringify(n,ea)),n=n==null?void 0:n.prev;return"["+i.join(", ")+"]"},c}()),Ns=function(){return 1},Zo=function(c,i,e,n,u){var g,x,M=[];return c.hasNode(n.v)&&((g=c.getRelatedEdges(n.v,"in"))===null||g===void 0||g.forEach(function(S){var T=S.data.weight,k=c.getNode(S.source);u&&M.push({v:S.source,w:S.target,in:0,out:0}),k.data.out===void 0&&(k.data.out=0),k.data.out-=T,Jo(i,e,z({v:k.id},k.data))}),(x=c.getRelatedEdges(n.v,"out"))===null||x===void 0||x.forEach(function(S){var T=S.data.weight,k=S.target,B=c.getNode(k);B.data.in===void 0&&(B.data.in=0),B.data.in-=T,Jo(i,e,z({v:B.id},B.data))}),c.removeNode(n.v)),u?M:void 0},Jo=function(c,i,e){e.out?e.in?c[e.out-e.in+i].enqueue(e):c[c.length-1].enqueue(e):c[0].enqueue(e)},So=function(c,i,e,n){var u;do u=""+n+Math.random();while(c.hasNode(u));return e.dummy=i,c.addNode({id:u,data:e}),u},Qa=function(c){var i=new to;return c.getAllNodes().forEach(function(e){c.getChildren(e.id).length||i.addNode(z({},e))}),c.getAllEdges().forEach(function(e){i.addEdge(e)}),i},vi=function(c,i){var e,n,u=Number(c.x),g=Number(c.y),x=Number(i.x)-u,M=Number(i.y)-g,S=Number(c.width)/2,T=Number(c.height)/2;return x||M?(Math.abs(M)*S>Math.abs(x)*T?(M<0&&(T=-T),e=T*x/M,n=T):(x<0&&(S=-S),e=S,n=S*M/x),{x:u+e,y:g+n}):{x:0,y:0}},Qo=function(c){for(var i=[],e=na(c)+1,n=0;n<e;n++)i.push([]);for(c.getAllNodes().forEach(function(u){var g=u.data.rank;g!==void 0&&i[g]&&i[g].push(u.id)}),n=0;n<e;n++)i[n]=i[n].sort(function(u,g){return x=c.getNode(u).data.order,M=c.getNode(g).data.order,Number(x)-Number(M);var x,M});return i},Ra=function(c,i,e,n){var u={width:0,height:0};return Te(e)&&Te(n)&&(u.rank=e,u.order=n),So(c,"border",u,i)},na=function(c){var i;return c.getAllNodes().forEach(function(e){var n=e.data.rank;n!==void 0&&(i===void 0||n>i)&&(i=n)}),i||(i=0),i},oa=function(c,i){return c.reduce(function(e,n){return i(e)>i(n)?n:e})},ia=function(c,i,e,n,u,g){n.includes(i.id)||(n.push(i.id),e||g.push(i.id),u(i.id).forEach(function(x){return ia(c,x,e,n,u,g)}),e&&g.push(i.id))},ti=function(c,i,e,n){var u=Array.isArray(i)?i:[i],g=function(S){return n?c.getSuccessors(S):c.getNeighbors(S)},x=[],M=[];return u.forEach(function(S){if(!c.hasNode(S.id))throw new Error("Graph does not have node: "+S);ia(c,S,e==="post",M,g,x)}),x},Ci="edge-label",aa=function(c){var i={},e=function(n){var u,g,x=c.getNode(n);return x?i[n]?x.data.rank:(i[n]=!0,(u=c.getRelatedEdges(n,"out"))===null||u===void 0||u.forEach(function(M){var S=e(M.target)-M.data.minlen;S&&(g===void 0||S<g)&&(g=S)}),g||(g=0),x.data.rank=g,g):0};c.getAllNodes().filter(function(n){return c.getRelatedEdges(n.id,"in").length===0}).forEach(function(n){return e(n.id)})},To=function(c,i){return c.getNode(i.target).data.rank-c.getNode(i.source).data.rank-i.data.minlen},ts=function(c,i){var e=function(n){i.getRelatedEdges(n,"both").forEach(function(u){var g=u.source,x=n===g?u.target:g;c.hasNode(x)||To(i,u)||(c.addNode({id:x,data:{}}),c.addEdge({id:u.id,source:n,target:x,data:{}}),e(x))})};return c.getAllNodes().forEach(function(n){return e(n.id)}),c.getAllNodes().length},Ms=function(c,i){var e=function(n){var u;(u=i.getRelatedEdges(n,"both"))===null||u===void 0||u.forEach(function(g){var x=g.source,M=n===x?g.target:x;c.hasNode(M)||i.getNode(M).data.layer===void 0&&To(i,g)||(c.addNode({id:M,data:{}}),c.addEdge({id:g.id,source:n,target:M,data:{}}),e(M))})};return c.getAllNodes().forEach(function(n){return e(n.id)}),c.getAllNodes().length},Oa=function(c,i){return oa(i.getAllEdges(),function(e){return c.hasNode(e.source)!==c.hasNode(e.target)?To(i,e):1/0})},eo=function(c,i,e){c.getAllNodes().forEach(function(n){var u=i.getNode(n.id);u.data.rank||(u.data.rank=0),u.data.rank+=e})},Ca=function(c,i){var e=ti(c,c.getAllNodes(),"post",!1);(e=e.slice(0,(e==null?void 0:e.length)-1)).forEach(function(n){sa(c,i,n)})},sa=function(c,i,e){var n=c.getNode(e).data.parent;c.getRelatedEdges(e,"both").find(function(u){return u.target===n||u.source===n}).data.cutvalue=es(c,i,e)},es=function(c,i,e){var n=c.getNode(e).data.parent,u=!0,g=i.getRelatedEdges(e,"out").find(function(M){return M.target===n}),x=0;return g||(u=!1,g=i.getRelatedEdges(n,"out").find(function(M){return M.target===e})),x=g.data.weight,i.getRelatedEdges(e,"both").forEach(function(M){var S=M.source===e,T=S?M.target:M.source;if(T!==n){var k=S===u,B=M.data.weight;if(x+=k?B:-B,mi(c,e,T)){var Q=c.getRelatedEdges(e,"both").find(function(et){return et.source===T||et.target===T}).data.cutvalue;x+=k?-Q:Q}}}),x},La=function(c,i){i===void 0&&(i=c.getAllNodes()[0].id),Pa(c,{},1,i)},Pa=function(c,i,e,n,u){var g,x=e,M=e,S=c.getNode(n);return i[n]=!0,(g=c.getNeighbors(n))===null||g===void 0||g.forEach(function(T){i[T.id]||(M=Pa(c,i,M,T.id,n))}),S.data.low=x,S.data.lim=M++,u?S.data.parent=u:delete S.data.parent,M},rs=function(c){return c.getAllEdges().find(function(i){return i.data.cutvalue<0})},yo=function(c,i,e){var n=e.source,u=e.target;i.getRelatedEdges(n,"out").find(function(k){return k.target===u})||(n=e.target,u=e.source);var g=c.getNode(n),x=c.getNode(u),M=g,S=!1;g.data.lim>x.data.lim&&(M=x,S=!0);var T=i.getAllEdges().filter(function(k){return S===ua(c.getNode(k.source),M)&&S!==ua(c.getNode(k.target),M)});return oa(T,function(k){return To(i,k)})},fo=function(c,i,e,n){var u=c.getRelatedEdges(e.source,"both").find(function(g){return g.source===e.target||g.target===e.target});u&&c.removeEdge(u.id),c.addEdge({id:"e"+Math.random(),source:n.source,target:n.target,data:{}}),La(c),Ca(c,i),ei(c,i)},ei=function(c,i){var e=c.getAllNodes().find(function(u){return!u.data.parent}),n=ti(c,e,"pre",!1);(n=n.slice(1)).forEach(function(u){var g=c.getNode(u).data.parent,x=i.getRelatedEdges(u,"out").find(function(S){return S.target===g}),M=!1;!x&&i.hasNode(g)&&(x=i.getRelatedEdges(g,"out").find(function(S){return S.target===u}),M=!0),i.getNode(u).data.rank=(i.hasNode(g)&&i.getNode(g).data.rank||0)+(M?x==null?void 0:x.data.minlen:-(x==null?void 0:x.data.minlen))})},mi=function(c,i,e){return c.getRelatedEdges(i,"both").find(function(n){return n.source===e||n.target===e})},ua=function(c,i){return i.data.low<=c.data.lim&&c.data.lim<=i.data.lim},da=aa,Li=function(c,i,e,n,u,g,x){var M=c.getChildren(x);if(M!=null&&M.length){var S=Ra(c,"_bt"),T=Ra(c,"_bb"),k=c.getNode(x);c.setParent(S,x),k.data.borderTop=S,c.setParent(T,x),k.data.borderBottom=T,M==null||M.forEach(function(B){Li(c,i,e,n,u,g,B.id);var Q=B.data.borderTop?B.data.borderTop:B.id,et=B.data.borderBottom?B.data.borderBottom:B.id,K=B.data.borderTop?n:2*n,j=Q!==et?1:u-g[x]+1;c.addEdge({id:"e"+Math.random(),source:S,target:Q,data:{minlen:j,weight:K,nestingEdge:!0}}),c.addEdge({id:"e"+Math.random(),source:et,target:T,data:{minlen:j,weight:K,nestingEdge:!0}})}),c.getParent(x)||c.addEdge({id:"e"+Math.random(),source:i,target:S,data:{weight:0,minlen:u+g[x]}})}else x!==i&&c.addEdge({id:"e"+Math.random(),source:i,target:x,data:{weight:0,minlen:e}})},Fo=function(c,i,e,n,u,g){var x={rank:g,borderType:i,width:0,height:0},M=u.data[i][g-1],S=So(c,"border",x,e);u.data[i][g]=S,c.setParent(S,n),M&&c.addEdge({id:"e"+Math.random(),source:M,target:S,data:{weight:1}})},kr=function(c){c.getAllNodes().forEach(function(i){za(i)}),c.getAllEdges().forEach(function(i){za(i)})},za=function(c){var i=c.data.width;c.data.width=c.data.height,c.data.height=i},ur=function(c){c!=null&&c.y&&(c.y=-c.y)},ca=function(c){var i=c.x;c.x=c.y,c.y=i},_o=function(c){for(var i={},e=c.getAllNodes(),n=e.map(function(T){var k;return(k=T.data.rank)!==null&&k!==void 0?k:-1/0}),u=Math.max.apply(Math,he([],ue(n))),g=[],x=0;x<u+1;x++)g.push([]);var M=e.sort(function(T,k){return c.getNode(T.id).data.rank-c.getNode(k.id).data.rank}),S=M.filter(function(T){return c.getNode(T.id).data.fixorder!==void 0}).sort(function(T,k){return c.getNode(T.id).data.fixorder-c.getNode(k.id).data.fixorder});return S==null||S.forEach(function(T){isNaN(c.getNode(T.id).data.rank)||g[c.getNode(T.id).data.rank].push(T.id),i[T.id]=!0}),M==null||M.forEach(function(T){return c.dfsTree(T.id,function(k){if(i.hasOwnProperty(k.id))return!0;i[k.id]=!0,isNaN(k.data.rank)||g[k.data.rank].push(k.id)})}),g},ns=function(c,i,e){for(var n=function(k,B){return k==null?void 0:k.reduce(function(Q,et,K){return Q[et]=B[K],Q},{})}(e,e.map(function(k,B){return B})),u=i.map(function(k){var B=c.getRelatedEdges(k,"out").map(function(Q){return{pos:n[Q.target]||0,weight:Q.data.weight}});return B==null?void 0:B.sort(function(Q,et){return Q.pos-et.pos})}),g=u.flat().filter(function(k){return k!==void 0}),x=1;x<e.length;)x<<=1;var M=2*x-1;x-=1;var S=Array(M).fill(0,0,M),T=0;return g==null||g.forEach(function(k){if(k){var B=k.pos+x;S[B]+=k.weight;for(var Q=0;B>0;)B%2&&(Q+=S[B+1]),S[B=B-1>>1]+=k.weight;T+=k.weight*Q}}),T},ha=function(c,i){for(var e=0,n=1;n<(i==null?void 0:i.length);n+=1)e+=ns(c,i[n-1],i[n]);return e},ko=function(c,i,e){for(var n,u=e;i.length&&(n=i[i.length-1]).i<=u;)i.pop(),c==null||c.push(n.vs),u++;return u},Pi=function(c,i,e,n,u,g){var x,M,S,T,k=c.getChildren(i).map(function(Kt){return Kt.id}),B=c.getNode(i),Q=B?B.data.borderLeft:void 0,et=B?B.data.borderRight:void 0,K={};Q&&(k=k==null?void 0:k.filter(function(Kt){return Kt!==Q&&Kt!==et}));var j=function(Kt,qt){return qt.map(function(Nt){var Pt=Kt.getRelatedEdges(Nt,"in");if(!(Pt!=null&&Pt.length))return{v:Nt};var Ht={sum:0,weight:0};return Pt==null||Pt.forEach(function(Ct){var V=Kt.getNode(Ct.source);Ht.sum+=Ct.data.weight*V.data.order,Ht.weight+=Ct.data.weight}),{v:Nt,barycenter:Ht.sum/Ht.weight,weight:Ht.weight}})}(c,k||[]);j==null||j.forEach(function(Kt){var qt;if(!((qt=c.getChildren(Kt.v))===null||qt===void 0)&&qt.length){var Nt=Pi(c,Kt.v,e,n,g);K[Kt.v]=Nt,Nt.hasOwnProperty("barycenter")&&la(Kt,Nt)}});var dt=function(Kt,qt){var Nt,Pt,Ht,Ct={};return Kt==null||Kt.forEach(function(V,st){Ct[V.v]={i:st,indegree:0,in:[],out:[],vs:[V.v]};var It=Ct[V.v];V.barycenter!==void 0&&(It.barycenter=V.barycenter,It.weight=V.weight)}),(Nt=qt.getAllEdges())===null||Nt===void 0||Nt.forEach(function(V){var st=Ct[V.source],It=Ct[V.target];st!==void 0&&It!==void 0&&(It.indegree++,st.out.push(Ct[V.target]))}),function(V){for(var st,It,mt=[],X=function(){var vt=V.pop();mt.push(vt),(st=vt.in.reverse())===null||st===void 0||st.forEach(function(yt){return(At=vt,function(I){I.merged||(I.barycenter===void 0||At.barycenter===void 0||I.barycenter>=At.barycenter)&&function(P,C){var O,ut=0,xt=0;P.weight&&(ut+=P.barycenter*P.weight,xt+=P.weight),C.weight&&(ut+=C.barycenter*C.weight,xt+=C.weight),P.vs=(O=C.vs)===null||O===void 0?void 0:O.concat(P.vs),P.barycenter=ut/xt,P.weight=xt,P.i=Math.min(C.i,P.i),C.merged=!0}(At,I)})(yt);var At}),(It=vt.out)===null||It===void 0||It.forEach(function(yt){return(At=vt,function(I){I.in.push(At),--I.indegree==0&&V.push(I)})(yt);var At})};V!=null&&V.length;)X();var D=mt.filter(function(vt){return!vt.merged}),W=["vs","i","barycenter","weight"];return D.map(function(vt){var yt={};return W==null||W.forEach(function(At){vt[At]!==void 0&&(yt[At]=vt[At])}),yt})}((Ht=(Pt=Object.values(Ct)).filter)===null||Ht===void 0?void 0:Ht.call(Pt,function(V){return!V.indegree}))}(j,e);yi(dt,K),(x=dt.filter(function(Kt){return Kt.vs.length>0}))===null||x===void 0||x.forEach(function(Kt){var qt=c.getNode(Kt.vs[0]);qt&&(Kt.fixorder=qt.data.fixorder,Kt.order=qt.data.order)});var ot=function(Kt,qt,Nt,Pt){var Ht=function(W,vt){var yt={lhs:[],rhs:[]};return W==null||W.forEach(function(At){var I,P;P=(I=At).hasOwnProperty("fixorder")&&!isNaN(I.fixorder),(Pt?!P&&I.hasOwnProperty("barycenter"):P||I.hasOwnProperty("barycenter"))?yt.lhs.push(At):yt.rhs.push(At)}),yt}(Kt),Ct=Ht.lhs,V=Ht.rhs.sort(function(W,vt){return-W.i- -vt.i}),st=[],It=0,mt=0,X=0;Ct==null||Ct.sort(function(W,vt){return function(yt,At){if(yt.fixorder!==void 0&&At.fixorder!==void 0)return yt.fixorder-At.fixorder;if(yt.barycenter<At.barycenter)return-1;if(yt.barycenter>At.barycenter)return 1;if(vt&&yt.order!==void 0&&At.order!==void 0){if(yt.order<At.order)return-1;if(yt.order>At.order)return 1}return W?At.i-yt.i:yt.i-At.i}}(!!qt,!!Nt)),X=ko(st,V,X),Ct==null||Ct.forEach(function(W){var vt;X+=(vt=W.vs)===null||vt===void 0?void 0:vt.length,st.push(W.vs),It+=W.barycenter*W.weight,mt+=W.weight,X=ko(st,V,X)});var D={vs:st.flat()};return mt&&(D.barycenter=It/mt,D.weight=mt),D}(dt,n,u,g);if(Q&&(ot.vs=[Q,ot.vs,et].flat(),(M=c.getPredecessors(Q))===null||M===void 0?void 0:M.length)){var pt=c.getNode(((S=c.getPredecessors(Q))===null||S===void 0?void 0:S[0].id)||""),ne=c.getNode(((T=c.getPredecessors(et))===null||T===void 0?void 0:T[0].id)||"");ot.hasOwnProperty("barycenter")||(ot.barycenter=0,ot.weight=0),ot.barycenter=(ot.barycenter*ot.weight+pt.data.order+ne.data.order)/(ot.weight+2),ot.weight+=2}return ot},yi=function(c,i){c==null||c.forEach(function(e){var n,u=(n=e.vs)===null||n===void 0?void 0:n.map(function(g){return i[g]?i[g].vs:g});e.vs=u.flat()})},la=function(c,i){c.barycenter!==void 0?(c.barycenter=(c.barycenter*c.weight+i.barycenter*i.weight)/(c.weight+i.weight),c.weight+=i.weight):(c.barycenter=i.barycenter,c.weight=i.weight)},wi=function(c){if(typeof c!="object"||c===null)return c;var i,e;if(e=c,Array.isArray?Array.isArray(e):_r(e,"Array")){i=[];for(var n=0,u=c.length;n<u;n++)typeof c[n]=="object"&&c[n]!=null?i[n]=wi(c[n]):i[n]=c[n]}else for(var g in i={},c)typeof c[g]=="object"&&c[g]!=null?i[g]=wi(c[g]):i[g]=c[g];return i};const ri=wi;var ni=function(c,i,e){return i.map(function(n){return function(u,g,x){var M=function(T){for(var k;T.hasNode(k="_root"+Math.random()););return k}(u),S=new to({tree:[{id:M,children:[],data:{}}]});return u.getAllNodes().forEach(function(T){var k=u.getParent(T.id);(T.data.rank===g||T.data.minRank<=g&&g<=T.data.maxRank)&&(S.hasNode(T.id)||S.addNode(z({},T)),(k==null?void 0:k.id)&&!S.hasNode(k==null?void 0:k.id)&&S.addNode(z({},k)),S.setParent(T.id,(k==null?void 0:k.id)||M),u.getRelatedEdges(T.id,x).forEach(function(B){var Q=B.source===T.id?B.target:B.source;S.hasNode(Q)||S.addNode(z({},u.getNode(Q)));var et=S.getRelatedEdges(Q,"out").find(function(j){return j.target===T.id}),K=et!==void 0?et.data.weight:0;et?S.updateEdgeData(et.id,z(z({},et.data),{weight:B.data.weight+K})):S.addEdge({id:B.id,source:Q,target:T.id,data:{weight:B.data.weight+K}})}),T.data.hasOwnProperty("minRank")&&S.updateNodeData(T.id,z(z({},T.data),{borderLeft:T.data.borderLeft[g],borderRight:T.data.borderRight[g]})))}),S}(c,n,e)})},jo=function(c,i,e,n){var u=new to;c==null||c.forEach(function(g){for(var x,M=g.getRoots()[0].id,S=Pi(g,M,u,i,e,n),T=0;T<((x=S.vs)===null||x===void 0?void 0:x.length);T++){var k=g.getNode(S.vs[T]);k&&(k.data.order=T)}(function(B,Q,et){var K,j={};et==null||et.forEach(function(dt){for(var ot,pt,ne=B.getParent(dt);ne;){if((ot=B.getParent(ne.id))?(pt=j[ot.id],j[ot.id]=ne.id):(pt=K,K=ne.id),pt&&pt!==ne.id)return Q.addNodes([{id:pt,data:{}},{id:ne.id,data:{}}]),void Q.addEdge({id:"e"+pt+"-"+ne.id,source:pt,target:ne.id,data:{}});ne=ot}})})(g,u,S.vs)})},zi=function(c,i){i==null||i.forEach(function(e){e==null||e.forEach(function(n,u){c.getNode(n).data.order=u})})},fa=function(c,i,e){var n=i,u=e;if(n>u){var g=n;n=u,u=g}var x=c[n];x||(c[n]=x={}),x[u]=!0},ga=function(c,i,e){var n=i;return n>e&&(n=e),!!c[n]},os=function(c,i,e,n,u,g){var x=new to,M=is(n,u,g);return i==null||i.forEach(function(S){var T;S==null||S.forEach(function(k){var B=e[k];if(x.hasNode(B)||x.addNode({id:B,data:{}}),T){var Q=e[T],et=x.getRelatedEdges(Q,"out").find(function(K){return K.target===B});et?x.updateEdgeData(et.id,z(z({},et.data),{weight:Math.max(M(c,k,T),et.data.weight||0)})):x.addEdge({id:"e"+Math.random(),source:Q,target:B,data:{weight:Math.max(M(c,k,T),0)}})}T=k})}),x},is=function(c,i,e){return function(n,u,g){var x=n.getNode(u),M=n.getNode(g),S=0,T=0;if(S+=x.data.width/2,x.data.hasOwnProperty("labelpos"))switch((x.data.labelpos||"").toLowerCase()){case"l":T=-x.data.width/2;break;case"r":T=x.data.width/2}if(T&&(S+=e?T:-T),T=0,S+=(x.data.dummy?i:c)/2,S+=(M.data.dummy?i:c)/2,S+=M.data.width/2,M.data.labelpos)switch((M.data.labelpos||"").toLowerCase()){case"l":T=M.data.width/2;break;case"r":T=-M.data.width/2}return T&&(S+=e?T:-T),T=0,S}},Gi=function(c,i){var e=i.acyclicer,n=i.ranker,u=i.rankdir,g=u===void 0?"tb":u,x=i.nodeOrder,M=i.keepNodeOrder,S=i.align,T=i.nodesep,k=T===void 0?50:T,B=i.edgesep,Q=B===void 0?20:B,et=i.ranksep,K=et===void 0?50:et;A(c),function(Nt,Pt){var Ht=Pt==="greedy"?function(Ct,V){var st;if(Ct.getAllNodes().length<=1)return[];var It=function(mt,X){var D=new to,W=0,vt=0;mt.getAllNodes().forEach(function(C){D.addNode({id:C.id,data:{v:C.id,in:0,out:0}})}),mt.getAllEdges().forEach(function(C){var O=D.getRelatedEdges(C.source,"out").find(function(xt){return xt.target===C.target}),ut=(X==null?void 0:X(C))||1;O?D.updateEdgeData(O==null?void 0:O.id,z(z({},O.data),{weight:O.data.weight+ut})):D.addEdge({id:C.id,source:C.source,target:C.target,data:{weight:ut}}),vt=Math.max(vt,D.getNode(C.source).data.out+=ut),W=Math.max(W,D.getNode(C.target).data.in+=ut)});for(var yt=[],At=vt+W+3,I=0;I<At;I++)yt.push(new ra);var P=W+1;return D.getAllNodes().forEach(function(C){Jo(yt,P,z({v:C.id},D.getNode(C.id).data))}),{buckets:yt,zeroIdx:P,graph:D}}(Ct,function(mt){return mt.data.weight||1});return(st=function(mt,X,D){for(var W,vt=[],yt=X[X.length-1],At=X[0];mt.getAllNodes().length;){for(;W=At.dequeue();)Zo(mt,X,D,W);for(;W=yt.dequeue();)Zo(mt,X,D,W);if(mt.getAllNodes().length){for(var I=X.length-2;I>0;--I)if(W=X[I].dequeue()){vt=vt.concat(Zo(mt,X,D,W,!0));break}}}return vt}(It.graph,It.buckets,It.zeroIdx).map(function(mt){return Ct.getRelatedEdges(mt.v,"out").filter(function(X){return X.target===mt.w})}))===null||st===void 0?void 0:st.flat()}(Nt):function(Ct){var V=[],st={},It={},mt=function(X){It[X]||(It[X]=!0,st[X]=!0,Ct.getRelatedEdges(X,"out").forEach(function(D){st[D.target]?V.push(D):mt(D.target)}),delete st[X])};return Ct.getAllNodes().forEach(function(X){return mt(X.id)}),V}(Nt);Ht==null||Ht.forEach(function(Ct){var V=Ct.data;Nt.removeEdge(Ct.id),V.forwardName=Ct.data.name,V.reversed=!0,Nt.addEdge({id:Ct.id,source:Ct.target,target:Ct.source,data:z({},V)})})}(c,e);var j=function(Nt){var Pt=So(Nt,"root",{},"_root"),Ht=function(mt){var X={},D=function(W,vt){var yt=mt.getChildren(W);yt==null||yt.forEach(function(At){return D(At.id,vt+1)}),X[W]=vt};return mt.getRoots().forEach(function(W){return D(W.id,1)}),X}(Nt),Ct=Math.max.apply(Math,he([],ue(Object.values(Ht))));Math.abs(Ct)===1/0&&(Ct=1);var V=Ct-1,st=2*V+1;Nt.getAllEdges().forEach(function(mt){mt.data.minlen*=st});var It=function(mt){var X=0;return mt.getAllEdges().forEach(function(D){X+=D.data.weight}),X}(Nt)+1;return Nt.getRoots().forEach(function(mt){Li(Nt,Pt,st,It,V,Ht,mt.id)}),{nestingRoot:Pt,nodeRankFactor:st}}(c),dt=j.nestingRoot,ot=j.nodeRankFactor;(function(Nt,Pt){switch(Pt){case"network-simplex":(function(Ht){(function(Ct){var V=function(X){var D=new to;return X.getAllNodes().forEach(function(W){D.addNode(z({},W))}),X.getAllEdges().forEach(function(W){var vt=D.getRelatedEdges(W.source,"out").find(function(yt){return yt.target===W.target});vt?D.updateEdgeData(vt==null?void 0:vt.id,z(z({},vt.data),{weight:vt.data.weight+W.data.weight||0,minlen:Math.max(vt.data.minlen,W.data.minlen||1)})):D.addEdge({id:W.id,source:W.source,target:W.target,data:{weight:W.data.weight||0,minlen:W.data.minlen||1}})}),D}(Ct);aa(V);var st,It,mt=function(X){var D,W,vt=new to({tree:[]}),yt=X.getAllNodes()[0],At=X.getAllNodes().length;for(vt.addNode(yt);ts(vt,X)<At;)D=Oa(vt,X),W=vt.hasNode(D.source)?To(X,D):-To(X,D),eo(vt,X,W);return vt}(V);for(La(mt),Ca(mt,V);st=rs(mt);)It=yo(mt,V,st),fo(mt,V,st,It)})(Ht)})(Nt);break;case"tight-tree":default:(function(Ht){(function(Ct){var V,st={},It=function(D){var W,vt,yt=Ct.getNode(D);return yt?st[D]?yt.data.rank:(st[D]=!0,(W=Ct.getRelatedEdges(D,"out"))===null||W===void 0||W.forEach(function(At){var I=It(At.target)-At.data.minlen;I&&(vt===void 0||I<vt)&&(vt=I)}),vt||(vt=0),(V===void 0||vt<V)&&(V=vt),yt.data.rank=vt,vt):0};Ct.getAllNodes().filter(function(D){return Ct.getRelatedEdges(D.id,"in").length===0}).forEach(function(D){D&&It(D.id)}),V===void 0&&(V=0);var mt={},X=function(D,W){var vt,yt=Ct.getNode(D),At=isNaN(yt.data.layer)?W:yt.data.layer;(yt.data.rank===void 0||yt.data.rank<At)&&(yt.data.rank=At),mt[D]||(mt[D]=!0,(vt=Ct.getRelatedEdges(D,"out"))===null||vt===void 0||vt.forEach(function(I){X(I.target,At+I.data.minlen)}))};Ct.getAllNodes().forEach(function(D){var W=D.data;W&&(isNaN(W.layer)?W.rank-=V:X(D.id,W.layer))})})(Ht),function(Ct){var V,st,It=new to({tree:[]}),mt=Ct.getAllNodes()[0],X=Ct.getAllNodes().length;for(It.addNode(mt);Ms(It,Ct)<X;)V=Oa(It,Ct),st=It.hasNode(V.source)?To(Ct,V):-To(Ct,V),eo(It,Ct,st)}(Ht)})(Nt);break;case"longest-path":da(Nt)}})(Qa(c),n),o(c),function(Nt,Pt){Pt===void 0&&(Pt=0);var Ht=Nt.getAllNodes(),Ct=Ht.filter(function(D){return D.data.rank!==void 0}).map(function(D){return D.data.rank}),V=Math.min.apply(Math,he([],ue(Ct))),st=[];Ht.forEach(function(D){var W=(D.data.rank||0)-V;st[W]||(st[W]=[]),st[W].push(D.id)});for(var It=0,mt=0;mt<st.length;mt++){var X=st[mt];X===void 0?mt%Pt!=0&&(It-=1):It&&(X==null||X.forEach(function(D){var W=Nt.getNode(D);W&&(W.data.rank=W.data.rank||0,W.data.rank+=It)}))}}(c,ot),function(Nt,Pt){Pt&&Nt.removeNode(Pt),Nt.getAllEdges().forEach(function(Ht){Ht.data.nestingEdge&&Nt.removeEdge(Ht.id)})}(c,dt),function(Nt){var Pt=Nt.getAllNodes().filter(function(Ct){return Ct.data.rank!==void 0}).map(function(Ct){return Ct.data.rank}),Ht=Math.min.apply(Math,he([],ue(Pt)));Nt.getAllNodes().forEach(function(Ct){Ct.data.hasOwnProperty("rank")&&Ht!==1/0&&(Ct.data.rank-=Ht)})}(c),t(c),r(c);var pt=[];(function(Nt,Pt){Nt.getAllEdges().forEach(function(Ht){return function(Ct,V,st){var It=V.source,mt=Ct.getNode(It).data.rank,X=V.target,D=Ct.getNode(X).data.rank,W=V.data.labelRank;if(D!==mt+1){var vt,yt,At;for(Ct.removeEdge(V.id),At=0,++mt;mt<D;++At,++mt)V.data.points=[],vt=So(Ct,"edge",yt={originalEdge:V,width:0,height:0,rank:mt},"_d"),mt===W&&(yt.width=V.data.width,yt.height=V.data.height,yt.dummy=Ci,yt.labelpos=V.data.labelpos),Ct.addEdge({id:"e"+Math.random(),source:It,target:vt,data:{weight:V.data.weight}}),At===0&&st.push(vt),It=vt;Ct.addEdge({id:"e"+Math.random(),source:It,target:X,data:{weight:V.data.weight}})}}(Nt,Ht,Pt)})})(c,pt),function(Nt,Pt){var Ht=function(Ct){var V={},st=0,It=function(mt){var X=st;Ct.getChildren(mt).forEach(function(D){return It(D.id)}),V[mt]={low:X,lim:st++}};return Ct.getRoots().forEach(function(mt){return It(mt.id)}),V}(Nt);Pt.forEach(function(Ct){var V,st,It=Ct,mt=Nt.getNode(It),X=mt.data.originalEdge;if(X)for(var D=function(P,C,O,ut){var xt,G,U,lt,it=[],ft=[],Rt=Math.min(C[O].low,C[ut].low),Gt=Math.max(C[O].lim,C[ut].lim);U=O;do U=(xt=P.getParent(U))===null||xt===void 0?void 0:xt.id,it.push(U);while(U&&(C[U].low>Rt||Gt>C[U].lim));for(lt=U,U=ut;U&&U!==lt;)ft.push(U),U=(G=P.getParent(U))===null||G===void 0?void 0:G.id;return{lca:lt,path:it.concat(ft.reverse())}}(Nt,Ht,X.source,X.target),W=D.path,vt=D.lca,yt=0,At=W[yt],I=!0;It!==X.target;){if(mt=Nt.getNode(It),I){for(;At!==vt&&((V=Nt.getNode(At))===null||V===void 0?void 0:V.data.maxRank)<mt.data.rank;)At=W[++yt];At===vt&&(I=!1)}if(!I){for(;yt<W.length-1&&((st=Nt.getNode(W[yt+1]))===null||st===void 0?void 0:st.data.minRank)<=mt.data.rank;)yt++;At=W[yt]}Nt.hasNode(At)&&Nt.setParent(It,At),It=Nt.getSuccessors(It)[0].id}})}(c,pt),function(Nt){var Pt=function(Ht){var Ct=Nt.getChildren(Ht),V=Nt.getNode(Ht);if(Ct!=null&&Ct.length&&Ct.forEach(function(mt){return Pt(mt.id)}),V.data.hasOwnProperty("minRank")){V.data.borderLeft=[],V.data.borderRight=[];for(var st=V.data.minRank,It=V.data.maxRank+1;st<It;st+=1)Fo(Nt,"borderLeft","_bl",Ht,V,st),Fo(Nt,"borderRight","_br",Ht,V,st)}};Nt.getRoots().forEach(function(Ht){return Pt(Ht.id)})}(c),M&&function(Nt,Pt){for(var Ht=Nt.getAllNodes().filter(function(It){var mt;return!(!((mt=Nt.getChildren(It.id))===null||mt===void 0)&&mt.length)}).map(function(It){return It.data.rank}),Ct=Math.max.apply(Math,he([],ue(Ht))),V=[],st=0;st<Ct+1;st++)V[st]=[];Pt==null||Pt.forEach(function(It){var mt=Nt.getNode(It);mt&&!mt.data.dummy&&(isNaN(mt.data.rank)||(mt.data.fixorder=V[mt.data.rank].length,V[mt.data.rank].push(It)))})}(c,x),function(Nt,Pt){for(var Ht=na(Nt),Ct=[],V=[],st=1;st<Ht+1;st++)Ct.push(st);for(st=Ht-1;st>-1;st--)V.push(st);var It=ni(Nt,Ct,"in"),mt=ni(Nt,V,"out"),X=_o(Nt);zi(Nt,X);for(var D,W=Number.POSITIVE_INFINITY,vt=(st=0,0);vt<4;++st,++vt)jo(st%2?It:mt,st%4>=2,!1,Pt),X=Qo(Nt),(yt=ha(Nt,X))<W&&(vt=0,D=ri(X),W=yt);for(X=_o(Nt),zi(Nt,X),st=0,vt=0;vt<4;++st,++vt){var yt;jo(st%2?It:mt,st%4>=2,!0,Pt),X=Qo(Nt),(yt=ha(Nt,X))<W&&(vt=0,D=ri(X),W=yt)}zi(Nt,D)}(c,M),_(c),function(Nt,Pt){var Ht=Pt.toLowerCase();Ht!=="lr"&&Ht!=="rl"||kr(Nt)}(c,g),function(Nt,Pt){var Ht,Ct=Qa(Nt);(function(st,It){var mt=(It||{}).ranksep,X=mt===void 0?0:mt,D=Qo(st),W=0;D==null||D.forEach(function(vt){var yt=vt.map(function(I){return st.getNode(I).data.height}),At=Math.max.apply(Math,he(he([],ue(yt)),[0]));vt==null||vt.forEach(function(I){st.getNode(I).data.y=W+At/2}),W+=At+X})})(Ct,Pt);var V=function(st,It){var mt=It||{},X=mt.align,D=mt.nodesep,W=D===void 0?0:D,vt=mt.edgesep,yt=vt===void 0?0:vt,At=Qo(st),I=Object.assign(function(ut,xt){var G={};return xt!=null&&xt.length&&xt.reduce(function(U,lt){var it=0,ft=0,Rt=U.length,Gt=lt==null?void 0:lt[(lt==null?void 0:lt.length)-1];return lt==null||lt.forEach(function(ht,St){var _t,ae=function(Ft,se){var Vt,J;if(!((Vt=Ft.getNode(se))===null||Vt===void 0)&&Vt.data.dummy)return(J=Ft.getPredecessors(se))===null||J===void 0?void 0:J.find(function(Et){return Ft.getNode(Et.id).data.dummy})}(ut,ht),jt=ae?ut.getNode(ae.id).data.order:Rt;(ae||ht===Gt)&&((_t=lt.slice(ft,St+1))===null||_t===void 0||_t.forEach(function(Ft){var se;(se=ut.getPredecessors(Ft))===null||se===void 0||se.forEach(function(Vt){var J,Et=ut.getNode(Vt.id),kt=Et.data.order;!(kt<it||jt<kt)||Et.data.dummy&&((J=ut.getNode(Ft))===null||J===void 0?void 0:J.data.dummy)||fa(G,Vt.id,Ft)})}),ft=St+1,it=jt)}),lt}),G}(st,At),function(ut,xt){var G={};function U(it,ft,Rt,Gt,ht){for(var St,_t,ae,jt=ft;jt<Rt;jt++)ae=it[jt],!((St=ut.getNode(ae))===null||St===void 0)&&St.data.dummy&&((_t=ut.getPredecessors(ae))===null||_t===void 0||_t.forEach(function(Ft){var se=ut.getNode(Ft.id);se.data.dummy&&(se.data.order<Gt||se.data.order>ht)&&fa(G,Ft.id,ae)}))}function lt(it,ft){var Rt=function(Gt){return JSON.stringify(Gt.slice(1))}(it);ft.get(Rt)||(U.apply(void 0,he([],ue(it))),ft.set(Rt,!0))}return xt!=null&&xt.length&&xt.reduce(function(it,ft){var Rt,Gt=-1,ht=0,St=new Map;return ft==null||ft.forEach(function(_t,ae){var jt;if(((jt=ut.getNode(_t))===null||jt===void 0?void 0:jt.data.dummy)==="border"){var Ft=ut.getPredecessors(_t)||[];Ft.length&&(Rt=ut.getNode(Ft[0].id).data.order,lt([ft,ht,ae,Gt,Rt],St),ht=ae,Gt=Rt)}lt([ft,ht,ft.length,Rt,it.length],St)}),ft}),G}(st,At)),P={},C=[];["u","d"].forEach(function(ut){C=ut==="u"?At:Object.values(At).reverse(),["l","r"].forEach(function(xt){xt==="r"&&(C=C.map(function(it){return Object.values(it).reverse()}));var G=(ut==="u"?st.getPredecessors:st.getSuccessors).bind(st),U=function(it,ft,Rt,Gt){var ht={},St={},_t={};return ft==null||ft.forEach(function(ae){ae==null||ae.forEach(function(jt,Ft){ht[jt]=jt,St[jt]=jt,_t[jt]=Ft})}),ft==null||ft.forEach(function(ae){var jt=-1;ae==null||ae.forEach(function(Ft){var se=Gt(Ft).map(function(oe){return oe.id});if(se.length){se=se.sort(function(oe,Ee){return _t[oe]-_t[Ee]});for(var Vt=(se.length-1)/2,J=Math.floor(Vt),Et=Math.ceil(Vt);J<=Et;++J){var kt=se[J];St[Ft]===Ft&&jt<_t[kt]&&!ga(Rt,Ft,kt)&&(St[kt]=Ft,St[Ft]=ht[Ft]=ht[kt],jt=_t[kt])}}})}),{root:ht,align:St}}(0,C,I,G),lt=function(it,ft,Rt,Gt,ht,St,_t){var ae,jt={},Ft=os(it,ft,Rt,ht,St,_t),se=_t?"borderLeft":"borderRight",Vt=function(J,Et){for(var kt=Ft.getAllNodes(),oe=kt.pop(),Ee={};oe;)Ee[oe.id]?J(oe.id):(Ee[oe.id]=!0,kt.push(oe),kt=kt.concat(Et(oe.id))),oe=kt.pop()};return Vt(function(J){jt[J]=(Ft.getRelatedEdges(J,"in")||[]).reduce(function(Et,kt){return Math.max(Et,(jt[kt.source]||0)+kt.data.weight)},0)},Ft.getPredecessors.bind(Ft)),Vt(function(J){var Et=(Ft.getRelatedEdges(J,"out")||[]).reduce(function(oe,Ee){return Math.min(oe,(jt[Ee.target]||0)-Ee.data.weight)},Number.POSITIVE_INFINITY),kt=it.getNode(J);Et!==Number.POSITIVE_INFINITY&&kt.data.borderType!==se&&(jt[J]=Math.max(jt[J],Et))},Ft.getSuccessors.bind(Ft)),(ae=Object.values(Gt))===null||ae===void 0||ae.forEach(function(J){jt[J]=jt[Rt[J]]}),jt}(st,C,U.root,U.align,W,yt,xt==="r");xt==="r"&&Object.keys(lt).forEach(function(it){return lt[it]=-lt[it]}),P[ut+xt]=lt})});var O=function(ut,xt){return oa(Object.values(xt),function(G){var U,lt=Number.NEGATIVE_INFINITY,it=Number.POSITIVE_INFINITY;return(U=Object.keys(G))===null||U===void 0||U.forEach(function(ft){var Rt=G[ft],Gt=function(ht,St){return ht.getNode(St).data.width||0}(ut,ft)/2;lt=Math.max(Rt+Gt,lt),it=Math.min(Rt-Gt,it)}),lt-it})}(st,P);return O&&function(ut,xt){var G=Object.values(xt),U=Math.min.apply(Math,he([],ue(G))),lt=Math.max.apply(Math,he([],ue(G)));["u","d"].forEach(function(it){["l","r"].forEach(function(ft){var Rt,Gt=it+ft,ht=ut[Gt];if(ht!==xt){var St=Object.values(ht);(Rt=ft==="l"?U-Math.min.apply(Math,he([],ue(St))):lt-Math.max.apply(Math,he([],ue(St))))&&(ut[Gt]={},Object.keys(ht).forEach(function(_t){ut[Gt][_t]=ht[_t]+Rt}))}})})}(P,O),function(ut,xt){var G={};return Object.keys(ut.ul).forEach(function(U){if(xt)G[U]=ut[xt.toLowerCase()][U];else{var lt=Object.values(ut).map(function(it){return it[U]});G[U]=(lt[0]+lt[1])/2}}),G}(P,X)}(Ct,Pt);(Ht=Object.keys(V))===null||Ht===void 0||Ht.forEach(function(st){Ct.getNode(st).data.x=V[st]})}(c,{align:S,nodesep:k,edgesep:Q,ranksep:K}),F(c),N(c),function(Nt,Pt){Pt.forEach(function(Ht){var Ct,V=Nt.getNode(Ht),st=V.data.originalEdge;st&&Nt.addEdge(st);for(var It=Ht;V.data.dummy;)Ct=Nt.getSuccessors(It)[0],Nt.removeNode(It),st.data.points.push({x:V.data.x,y:V.data.y}),V.data.dummy===Ci&&(st.data.x=V.data.x,st.data.y=V.data.y,st.data.width=V.data.width,st.data.height=V.data.height),It=Ct.id,V=Nt.getNode(It)})}(c,pt),y(c),function(Nt,Pt){var Ht=Pt.toLowerCase();Ht!=="bt"&&Ht!=="rl"||function(Ct){Ct.getAllNodes().forEach(function(V){ur(V.data)}),Ct.getAllEdges().forEach(function(V){var st;(st=V.data.points)===null||st===void 0||st.forEach(function(It){return ur(It)}),V.data.hasOwnProperty("y")&&ur(V.data)})}(Nt),Ht!=="lr"&&Ht!=="rl"||(function(Ct){Ct.getAllNodes().forEach(function(V){ca(V.data)}),Ct.getAllEdges().forEach(function(V){var st;(st=V.data.points)===null||st===void 0||st.forEach(function(It){return ca(It)}),V.data.hasOwnProperty("x")&&ca(V.data)})}(Nt),kr(Nt))}(c,g);var ne=s(c),Kt=ne.width,qt=ne.height;return l(c),b(c),function(Nt){Nt.getAllEdges().forEach(function(Pt){var Ht=Pt.data;if(Ht.reversed){Nt.removeEdge(Pt.id);var Ct=Ht.forwardName;delete Ht.reversed,delete Ht.forwardName,Nt.addEdge({id:Pt.id,source:Pt.target,target:Pt.source,data:z(z({},Ht),{forwardName:Ct})})}})}(c),{width:Kt,height:qt}},Ei=["width","height","layer","fixorder"],As={width:0,height:0},zs=["minlen","weight","width","height","labeloffset"],Ss={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},d=["labelpos"],o=function(c){c.getAllEdges().forEach(function(i){if(i.data.width&&i.data.height){var e=c.getNode(i.source),n={e:i,rank:(c.getNode(i.target).data.rank-e.data.rank)/2+e.data.rank};So(c,"edge-proxy",n,"_ep")}})},t=function(c){var i=0;return c.getAllNodes().forEach(function(e){var n,u;e.data.borderTop&&(e.data.minRank=(n=c.getNode(e.data.borderTop))===null||n===void 0?void 0:n.data.rank,e.data.maxRank=(u=c.getNode(e.data.borderBottom))===null||u===void 0?void 0:u.data.rank,i=Math.max(i,e.data.maxRank||-1/0))}),i},r=function(c){c.getAllNodes().forEach(function(i){i.data.dummy==="edge-proxy"&&(c.getEdge(i.data.e.id).data.labelRank=i.data.rank,c.removeNode(i.id))})},s=function(c,i){var e,n,u=0,g=0,x=i||{},M=x.marginx,S=M===void 0?0:M,T=x.marginy,k=T===void 0?0:T,B=function(Q){if(Q.data){var et=Q.data.x,K=Q.data.y,j=Q.data.width,dt=Q.data.height;isNaN(et)||isNaN(j)||(e===void 0&&(e=et-j/2),e=Math.min(e,et-j/2),u=Math.max(u,et+j/2)),isNaN(K)||isNaN(dt)||(n===void 0&&(n=K-dt/2),n=Math.min(n,K-dt/2),g=Math.max(g,K+dt/2))}};return c.getAllNodes().forEach(function(Q){B(Q)}),c.getAllEdges().forEach(function(Q){Q!=null&&Q.data.hasOwnProperty("x")&&B(Q)}),e-=S,n-=k,c.getAllNodes().forEach(function(Q){Q.data.x-=e,Q.data.y-=n}),c.getAllEdges().forEach(function(Q){var et;(et=Q.data.points)===null||et===void 0||et.forEach(function(K){K.x-=e,K.y-=n}),Q.data.hasOwnProperty("x")&&(Q.data.x-=e),Q.data.hasOwnProperty("y")&&(Q.data.y-=n)}),{width:u-e+S,height:g-n+k}},l=function(c){c.getAllEdges().forEach(function(i){var e,n,u=c.getNode(i.source),g=c.getNode(i.target);i.data.points?(e=i.data.points[0],n=i.data.points[i.data.points.length-1]):(i.data.points=[],e={x:g.data.x,y:g.data.y},n={x:u.data.x,y:u.data.y}),i.data.points.unshift(vi(u.data,e)),i.data.points.push(vi(g.data,n))})},y=function(c){c.getAllEdges().forEach(function(i){if(i.data.hasOwnProperty("x"))switch(i.data.labelpos!=="l"&&i.data.labelpos!=="r"||(i.data.width-=i.data.labeloffset),i.data.labelpos){case"l":i.data.x-=i.data.width/2+i.data.labeloffset;break;case"r":i.data.x+=i.data.width/2+i.data.labeloffset}})},b=function(c){c.getAllEdges().forEach(function(i){var e;i.data.reversed&&((e=i.data.points)===null||e===void 0||e.reverse())})},N=function(c){c.getAllNodes().forEach(function(i){var e,n,u;if(!((e=c.getChildren(i.id))===null||e===void 0)&&e.length){var g=c.getNode(i.id),x=c.getNode(g.data.borderTop),M=c.getNode(g.data.borderBottom),S=c.getNode(g.data.borderLeft[((n=g.data.borderLeft)===null||n===void 0?void 0:n.length)-1]),T=c.getNode(g.data.borderRight[((u=g.data.borderRight)===null||u===void 0?void 0:u.length)-1]);g.data.width=Math.abs((T==null?void 0:T.data.x)-(S==null?void 0:S.data.x))||10,g.data.height=Math.abs((M==null?void 0:M.data.y)-(x==null?void 0:x.data.y))||10,g.data.x=((S==null?void 0:S.data.x)||0)+g.data.width/2,g.data.y=((x==null?void 0:x.data.y)||0)+g.data.height/2}}),c.getAllNodes().forEach(function(i){i.data.dummy==="border"&&c.removeNode(i.id)})},A=function(c){c.getAllEdges().forEach(function(i){if(i.source===i.target){var e=c.getNode(i.source);e.data.selfEdges||(e.data.selfEdges=[]),e.data.selfEdges.push(i),c.removeEdge(i.id)}})},_=function(c){var i=Qo(c);i==null||i.forEach(function(e){var n=0;e==null||e.forEach(function(u,g){var x,M=c.getNode(u);M.data.order=g+n,(x=M.data.selfEdges)===null||x===void 0||x.forEach(function(S){So(c,"selfedge",{width:S.data.width,height:S.data.height,rank:M.data.rank,order:g+ ++n,e:S},"_se")}),delete M.data.selfEdges})})},F=function(c){c.getAllNodes().forEach(function(i){var e=c.getNode(i.id);if(e.data.dummy==="selfedge"){var n=c.getNode(e.data.e.source),u=n.data.x+n.data.width/2,g=n.data.y,x=e.data.x-u,M=n.data.height/2;c.hasEdge(e.data.e.id)?c.updateEdgeData(e.data.e.id,e.data.e.data):c.addEdge({id:e.data.e.id,source:e.data.e.source,target:e.data.e.target,data:e.data.e.data}),c.removeNode(i.id),e.data.e.data.points=[{x:u+2*x/3,y:g-M},{x:u+5*x/6,y:g-M},{y:g,x:u+x},{x:u+5*x/6,y:g+M},{x:u+2*x/3,y:g+M}],e.data.e.data.x=e.data.x,e.data.e.data.y=e.data.y}})},tt=function(c,i){var e={};return i==null||i.forEach(function(n){c[n]!==void 0&&(e[n]=+c[n])}),e},$=function(c){c===void 0&&(c={});var i={};return Object.keys(c).forEach(function(e){i[e.toLowerCase()]=c[e]}),i},q={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},L=function(){function c(i){i===void 0&&(i={}),this.options=i,this.id="dagre",this.layoutNode=function(e){return e.data.layout!==!1},this.options=z(z({},q),i)}return c.prototype.execute=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return[2,this.genericDagreLayout(!1,i,e)]})})},c.prototype.assign=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){switch(n.label){case 0:return[4,this.genericDagreLayout(!0,i,e)];case 1:return n.sent(),[2]}})})},c.prototype.genericDagreLayout=function(i,e,n){return Mt(this,void 0,void 0,function(){var u,g,x,M,S,T,k,B,Q,et,K,j,dt,ot,pt,ne,Kt,qt,Nt,Pt,Ht,Ct,V,st,It,mt,X,D,W,vt,yt,At,I,P=this;return te(this,function(C){return u=z(z({},this.options),n),g=u.nodeSize,x=u.align,M=u.rankdir,S=M===void 0?"TB":M,T=u.ranksep,k=u.nodesep,B=u.ranksepFunc,Q=u.nodesepFunc,et=u.edgeLabelSpace,K=u.nodeOrder,j=u.begin,dt=u.controlPoints,ot=u.radial,pt=new to({tree:[]}),ne=wn(T||50,B),Kt=wn(k||50,Q),qt=Kt,Nt=ne,S!=="LR"&&S!=="RL"||(qt=ne,Nt=Kt),Pt=Kn(g,void 0),Ht=e.getAllNodes(),Ct=e.getAllEdges(),Ht.filter(function(O){return O.data.layout!==!1}).forEach(function(O){var ut=Pt(O),xt=Nt(O),G=ut+2*qt(O),U=ut+2*xt,lt=O.data.layer;Te(lt)?pt.addNode({id:O.id,data:{width:G,height:U,layer:lt}}):pt.addNode({id:O.id,data:{width:G,height:U}})}),Ct.forEach(function(O){P.layoutNode(pt.getNode(O.source))&&P.layoutNode(pt.getNode(O.target))&&pt.addEdge({id:O.id,source:O.source,target:O.target,data:{weight:O.data.weight||1}})}),function(O,ut){var xt,G,U=ut.edgeLabelSpace,lt=ut.keepNodeOrder,it=ut.prevGraph,ft=ut.rankdir,Rt=ut.ranksep;!lt&&it&&(G=it,(xt=O).getAllNodes().forEach(function(ht){var St=xt.getNode(ht.id),_t=G.getNode(ht.id);_t!==void 0?(St.data.fixorder=_t.data._order,delete _t.data._order):delete St.data.fixorder}));var Gt=function(ht){var St=new to({tree:[]});return ht.getAllNodes().forEach(function(_t){var ae=$(ht.getNode(_t.id).data),jt=z(z({},As),ae),Ft=tt(jt,Ei);St.hasNode(_t.id)||St.addNode({id:_t.id,data:z({},Ft)});var se=ht.getParent(_t.id);se==null||(St.hasNode(se.id)||St.addNode(z({},se)),St.setParent(_t.id,se.id))}),ht.getAllEdges().forEach(function(_t){var ae=$(ht.getEdge(_t.id).data),jt={};d==null||d.forEach(function(Ft){ae[Ft]!==void 0&&(jt[Ft]=ae[Ft])}),St.addEdge({id:_t.id,source:_t.source,target:_t.target,data:Object.assign({},Ss,tt(ae,zs),jt)})}),St}(O);U!==!1&&(ut.ranksep=function(ht,St){var _t=St.ranksep,ae=_t===void 0?0:_t,jt=St.rankdir;return ht.getAllNodes().forEach(function(Ft){isNaN(Ft.data.layer)||Ft.data.layer||(Ft.data.layer=0)}),ht.getAllEdges().forEach(function(Ft){var se;Ft.data.minlen*=2,((se=Ft.data.labelpos)===null||se===void 0?void 0:se.toLowerCase())!=="c"&&(jt==="TB"||jt==="BT"?Ft.data.width+=Ft.data.labeloffset:Ft.data.height+=Ft.data.labeloffset)}),ae/2}(Gt,{rankdir:ft,ranksep:Rt}));try{Gi(Gt,ut)}catch(ht){if(ht.message==="Not possible to find intersection inside of the rectangle")return void console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,ht);throw ht}(function(ht,St){ht.getAllNodes().forEach(function(_t){var ae,jt=ht.getNode(_t.id);if(jt){var Ft=St.getNode(_t.id);jt.data.x=Ft.data.x,jt.data.y=Ft.data.y,jt.data._order=Ft.data.order,jt.data._rank=Ft.data.rank,!((ae=St.getChildren(_t.id))===null||ae===void 0)&&ae.length&&(jt.data.width=Ft.data.width,jt.data.height=Ft.data.height)}}),ht.getAllEdges().forEach(function(_t){var ae=ht.getEdge(_t.id),jt=St.getEdge(_t.id);ae.data.points=jt?jt.data.points:[],jt&&jt.data.hasOwnProperty("x")&&(ae.data.x=jt.data.x,ae.data.y=jt.data.y)})})(O,Gt)}(pt,{prevGraph:null,edgeLabelSpace:et,keepNodeOrder:!!K,nodeOrder:K||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:S,nodesep:k,align:x}),V=[0,0],j&&(st=1/0,It=1/0,pt.getAllNodes().forEach(function(O){st>O.data.x&&(st=O.data.x),It>O.data.y&&(It=O.data.y)}),pt.getAllEdges().forEach(function(O){var ut;(ut=O.data.points)===null||ut===void 0||ut.forEach(function(xt){st>xt.x&&(st=xt.x),It>xt.y&&(It=xt.y)})}),V[0]=j[0]-st,V[1]=j[1]-It),mt=S==="LR"||S==="RL",ot||(X=new Set,D=S==="BT"||S==="RL"?function(O,ut){return ut-O}:function(O,ut){return O-ut},pt.getAllNodes().forEach(function(O){O.data.x=O.data.x+V[0],O.data.y=O.data.y+V[1],X.add(mt?O.data.x:O.data.y)}),W=Array.from(X).sort(D),vt=mt?function(O,ut){return O.x!==ut.x}:function(O,ut){return O.y!==ut.y},yt=mt?function(O,ut,xt){var G=Math.max(ut.y,xt.y),U=Math.min(ut.y,xt.y);return O.filter(function(lt){return lt.y<=G&&lt.y>=U})}:function(O,ut,xt){var G=Math.max(ut.x,xt.x),U=Math.min(ut.x,xt.x);return O.filter(function(lt){return lt.x<=G&&lt.x>=U})},pt.getAllEdges().forEach(function(O,ut){var xt;et&&dt&&O.data.type!=="loop"&&(O.data.controlPoints=rt((xt=O.data.points)===null||xt===void 0?void 0:xt.map(function(G){var U=G.x,lt=G.y;return{x:U+V[0],y:lt+V[1]}}),pt.getNode(O.source),pt.getNode(O.target),W,mt,vt,yt))})),At=[],At=pt.getAllNodes().map(function(O){return Xr(O)}),I=pt.getAllEdges(),i&&(At.forEach(function(O){e.mergeNodeData(O.id,{x:O.data.x,y:O.data.y})}),I.forEach(function(O){e.mergeEdgeData(O.id,{controlPoints:O.data.controlPoints})})),[2,{nodes:At,edges:I}]})})},c}(),rt=function(c,i,e,n,u,g,x){var M=(c==null?void 0:c.slice(1,c.length-1))||[];if(i&&e){var S=i.data,T=S.x,k=S.y,B=e.data,Q=B.x,et=B.y;if(u&&(T=i.data.y,k=i.data.x,Q=e.data.y,et=e.data.x),et!==k&&T!==Q){var K=n.indexOf(k),j=n[K+1];if(j){var dt=M[0],ot=u?{x:(k+j)/2,y:(dt==null?void 0:dt.y)||Q}:{x:(dt==null?void 0:dt.x)||Q,y:(k+j)/2};dt&&!g(dt,ot)||M.unshift(ot)}var pt=n.indexOf(et),ne=Math.abs(pt-K);if(ne===1)(M=x(M,i.data,e.data)).length||M.push(u?{x:(k+et)/2,y:T}:{x:T,y:(k+et)/2});else if(ne>1){var Kt=n[pt-1];if(Kt){var qt=M[M.length-1],Nt=u?{x:(et+Kt)/2,y:(qt==null?void 0:qt.y)||Q}:{x:(qt==null?void 0:qt.x)||T,y:(et+Kt)/2};qt&&!g(qt,Nt)||M.push(Nt)}}}}return M};function nt(c){var i=0,e=0,n=0;if(c.length){for(var u=0;u<4;u++)(g=c[u])&&g.weight&&(i+=g.weight,e+=g.x*g.weight,n+=g.y*g.weight);c.x=e/i,c.y=n/i,c.weight=i}else{var g=c;c.x=g.data.x,c.y=g.data.y,c.weight=g.data.weight}}var ct={maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},Jt=function(){function c(i){i===void 0&&(i={}),this.options=i,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=z(z({},ct),i)}return c.prototype.execute=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return[2,this.genericForceLayout(!1,i,e)]})})},c.prototype.assign=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return this.genericForceLayout(!0,i,e),[2]})})},c.prototype.stop=function(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1},c.prototype.tick=function(i){var e=this;if(i===void 0&&(i=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var n=0;(this.judgingDistance>this.lastOptions.minMovement||n<1)&&n<i;n++)this.runOneStep(this.lastCalcGraph,this.lastGraph,n,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var u={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&u.nodes.forEach(function(g){return e.lastGraph.mergeNodeData(g.id,{x:g.data.x,y:g.data.y})}),u},c.prototype.genericForceLayout=function(i,e,n){return Mt(this,void 0,void 0,function(){var u,g,x,M,S,T,k,B,Q,et,K,j,dt,ot,pt,ne,Kt,qt,Nt,Pt=this;return te(this,function(Ht){return u=z(z({},this.options),n),g=e.getAllNodes(),x=e.getAllEdges(),M=this.formatOptions(u,e),S=M.width,T=M.height,k=M.nodeSize,B=M.getMass,Q=M.nodeStrength,et=M.edgeStrength,K=M.linkDistance,j=g.map(function(Ct){return z(z({},Ct),{data:z(z({},Ct.data),{x:Te(Ct.data.x)?Ct.data.x:Math.random()*S,y:Te(Ct.data.y)?Ct.data.y:Math.random()*T,size:k(Ct)||30,mass:B(Ct),nodeStrength:Q(Ct)})})}),dt=x.map(function(Ct){return z(z({},Ct),{data:z(z({},Ct.data),{edgeStrength:et(Ct),linkDistance:K(Ct,e.getNode(Ct.source),e.getNode(Ct.target))})})}),g!=null&&g.length?(ot={},g.forEach(function(Ct,V){ot[Ct.id]={x:0,y:0}}),pt=new to({nodes:j,edges:dt}),this.formatCentripetal(M,pt),ne=M.maxIteration,Kt=M.minMovement,qt=M.onTick,this.lastLayoutNodes=j,this.lastLayoutEdges=dt,this.lastAssign=i,this.lastGraph=e,this.lastCalcGraph=pt,this.lastOptions=M,this.lastVelMap=ot,typeof window>"u"?[2]:(Nt=0,[2,new Promise(function(Ct){Pt.timeInterval=window.setInterval(function(){g&&Pt.running||Ct({nodes:Xt(e,j),edges:x}),Pt.runOneStep(pt,e,Nt,ot,M),Pt.updatePosition(e,pt,ot,M),i&&j.forEach(function(V){return e.mergeNodeData(V.id,{x:V.data.x,y:V.data.y})}),qt==null||qt({nodes:Xt(e,j),edges:x}),(++Nt>=ne||Pt.judgingDistance<Kt)&&(window.clearInterval(Pt.timeInterval),Ct({nodes:Xt(e,j),edges:x}))},0),Pt.running=!0})])):(this.lastResult={nodes:[],edges:x},[2,{nodes:[],edges:x}])})})},c.prototype.formatOptions=function(i,e){var n=i,u=i.width,g=i.height,x=i.getMass;if(n.width=u||typeof window>"u"?u:window.innerWidth,n.height=g||typeof window>"u"?g:window.innerHeight,i.center||(n.center=[n.width/2,n.height/2]),x||(n.getMass=function(S){var T=1;Te(S==null?void 0:S.data.mass)&&(T=S==null?void 0:S.data.mass);var k=e.getDegree(S.id,"both");return!k||k<5?T:5*k*T}),i.preventOverlap){var M=wn(0,i.nodeSpacing);i.nodeSize?Qe(i.nodeSize)?n.nodeSize=function(S){var T=i.nodeSize;return Math.max(T[0],T[1])+M(S)}:n.nodeSize=function(S){return i.nodeSize+M(S)}:n.nodeSize=function(S){var T=((S==null?void 0:S.data)||{}).size;return T?Qe(T)?Math.max(T[0],T[1])+M(S):Rn(T)?Math.max(T.width,T.height)+M(S):T+M(S):10+M(S)}}return n.linkDistance=i.linkDistance?wn(1,i.linkDistance):function(S){return 1+n.nodeSize(e.getNode(S.source))+n.nodeSize(e.getNode(S.target))},n.nodeStrength=wn(1,i.nodeStrength),n.edgeStrength=wn(1,i.edgeStrength),i},c.prototype.formatCentripetal=function(i,e){var n,u=i.centripetalOptions,g=i.center,x=i.clusterNodeStrength,M=i.leafCluster,S=i.clustering,T=i.nodeClusterBy,k=e.getAllNodes(),B=u||{leaf:2,single:2,others:1,center:function(pt){return{x:g[0],y:g[1]}}};typeof x!="function"&&(i.clusterNodeStrength=function(pt){return x});var Q=[];if(M&&T&&(n=Yt(e,T),Q=Array.from(new Set(k==null?void 0:k.map(function(pt){return pt.data[T]})))||[],i.centripetalOptions=Object.assign(B,{single:100,leaf:function(pt){var ne=n[pt.id]||{},Kt=ne.siblingLeaves,qt=ne.sameTypeLeaves;return(qt==null?void 0:qt.length)===(Kt==null?void 0:Kt.length)||(Q==null?void 0:Q.length)===1?1:i.clusterNodeStrength(pt)},others:1,center:function(pt){var ne,Kt=e.getDegree(pt.id,"both");if(!Kt)return{x:100,y:100};if(Kt===1){var qt=(n[pt.id]||{}).sameTypeLeaves,Nt=qt===void 0?[]:qt;Nt.length===1?ne=void 0:Nt.length>1&&(ne=Ot(Nt))}else ne=void 0;return{x:ne==null?void 0:ne.x,y:ne==null?void 0:ne.y}}})),S&&T){n||(n=Yt(e,T)),Q||(Q=Array.from(new Set(k.map(function(pt){return pt.data[T]})))),Q=Q.filter(function(pt){return pt!==void 0});var et={};Q.forEach(function(pt){var ne=k.filter(function(Kt){return Kt.data[T]===pt}).map(function(Kt){return e.getNode(Kt.id)});et[pt]=Ot(ne)}),i.centripetalOptions=Object.assign(B,{single:function(pt){return i.clusterNodeStrength(pt)},leaf:function(pt){return i.clusterNodeStrength(pt)},others:function(pt){return i.clusterNodeStrength(pt)},center:function(pt){var ne=et[pt.data[T]];return{x:ne==null?void 0:ne.x,y:ne==null?void 0:ne.y}}})}var K=i.centripetalOptions||{},j=K.leaf,dt=K.single,ot=K.others;j&&typeof j!="function"&&(i.centripetalOptions.leaf=function(){return j}),dt&&typeof dt!="function"&&(i.centripetalOptions.single=function(){return dt}),ot&&typeof ot!="function"&&(i.centripetalOptions.others=function(){return ot})},c.prototype.runOneStep=function(i,e,n,u,g){var x={},M=i.getAllNodes(),S=i.getAllEdges();if(M!=null&&M.length){var T=g.monitor;this.calRepulsive(i,x,g),S&&this.calAttractive(i,x),this.calGravity(i,e,x,g),this.updateVelocity(i,x,u,g),T&&T({energy:this.calTotalEnergy(x,M),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:n})}},c.prototype.calTotalEnergy=function(i,e){if(!(e!=null&&e.length))return 0;var n=0;return e.forEach(function(u,g){var x=i[u.id].x,M=i[u.id].y,S=x*x+M*M,T=u.data.mass;n+=(T===void 0?1:T)*S*.5}),n},c.prototype.calRepulsive=function(i,e,n){var u=n.factor,g=n.coulombDisScale;(function(x,M,S,T){var k=M/S,B=x.getAllNodes(),Q=B.map(function(K,j){var dt=K.data,ot=dt.nodeStrength;return{x:dt.x,y:dt.y,size:dt.size,index:j,vx:0,vy:0,weight:k*ot}}),et=bn(Q,function(K){return K.x},function(K){return K.y}).visitAfter(nt);Q.forEach(function(K){(function(j,dt){dt.visit(function(ot,pt,ne,Kt,qt){return function(Nt,Pt,Ht,Ct,V,st){var It=st.x-Nt.x||.1,mt=st.y-Nt.y||.1,X=Ct-Pt,D=It*It+mt*mt,W=Math.sqrt(D)*D;if(X*X*.81<D){var vt=Nt.weight/W;return st.vx+=It*vt,st.vy+=mt*vt,!0}if(Nt.length)return!1;Nt.data!==st&&(vt=Nt.data.weight/W,st.vx+=It*vt,st.vy+=mt*vt)}(ot,pt,0,Kt,0,j)})})(K,et)}),Q.map(function(K,j){var dt=B[j],ot=dt.id,pt=dt.data.mass,ne=pt===void 0?1:pt;T[ot]={x:K.vx/ne,y:K.vy/ne}})})(i,u,g*g,e)},c.prototype.calAttractive=function(i,e){i.getAllEdges().forEach(function(n,u){var g=n.source,x=n.target,M=i.getNode(g),S=i.getNode(x);if(M&&S){var T=S.data.x-M.data.x,k=S.data.y-M.data.y;T||k||(T=.01*Math.random(),k=.01*Math.random());var B=Math.sqrt(T*T+k*k),Q=T/B,et=k/B,K=n.data||{},j=K.linkDistance,dt=j===void 0?200:j,ot=K.edgeStrength,pt=(dt-B)*(ot===void 0?200:ot),ne=1/(M.data.mass||1),Kt=1/(S.data.mass||1),qt=Q*pt,Nt=et*pt;e[g].x-=qt*ne,e[g].y-=Nt*ne,e[x].x+=qt*Kt,e[x].y+=Nt*Kt}})},c.prototype.calGravity=function(i,e,n,u){var g=u.getCenter,x=i.getAllNodes(),M=e.getAllNodes(),S=e.getAllEdges(),T=u.width,k=u.height,B=u.center,Q=u.gravity,et=u.centripetalOptions;x&&x.forEach(function(K){var j=K.id,dt=K.data,ot=dt.mass,pt=dt.x,ne=dt.y,Kt=e.getNode(j),qt=0,Nt=0,Pt=Q,Ht=i.getDegree(j,"in"),Ct=i.getDegree(j,"out"),V=i.getDegree(j,"both"),st=g==null?void 0:g(Kt,V);if(st){var It=ue(st,3);qt=pt-It[0],Nt=ne-It[1],Pt=It[2]}else qt=pt-B[0],Nt=ne-B[1];if(Pt&&(n[j].x-=Pt*qt/ot,n[j].y-=Pt*Nt/ot),et){var mt=et.leaf,X=et.single,D=et.others,W=et.center,vt=(W==null?void 0:W(Kt,M,S,T,k))||{x:0,y:0,centerStrength:0},yt=vt.x,At=vt.y,I=vt.centerStrength;if(!Te(yt)||!Te(At))return;var P=(pt-yt)/ot,C=(ne-At)/ot;if(I&&(n[j].x-=I*P,n[j].y-=I*C),V===0){var O=X(Kt);return O?(n[j].x-=O*P,void(n[j].y-=O*C)):void 0}if(Ht===0||Ct===0){var ut=mt(Kt,M,S);return ut?(n[j].x-=ut*P,void(n[j].y-=ut*C)):void 0}var xt=D(Kt);if(!xt)return;n[j].x-=xt*P,n[j].y-=xt*C}})},c.prototype.updateVelocity=function(i,e,n,u){var g=u.damping,x=u.maxSpeed,M=u.interval,S=i.getAllNodes();S!=null&&S.length&&S.forEach(function(T){var k=T.id,B=(n[k].x+e[k].x*M)*g||.01,Q=(n[k].y+e[k].y*M)*g||.01,et=Math.sqrt(B*B+Q*Q);if(et>x){var K=x/et;B*=K,Q*=K}n[k]={x:B,y:Q}})},c.prototype.updatePosition=function(i,e,n,u){var g=this,x=u.distanceThresholdMode,M=u.interval,S=e.getAllNodes();if(S!=null&&S.length){var T=0;x==="max"?this.judgingDistance=-1/0:x==="min"&&(this.judgingDistance=1/0),S.forEach(function(k){var B=k.id,Q=i.getNode(B);if(Te(Q.data.fx)&&Te(Q.data.fy))e.mergeNodeData(B,{x:Q.data.fx,y:Q.data.fy});else{var et=n[B].x*M,K=n[B].y*M;e.mergeNodeData(B,{x:k.data.x+et,y:k.data.y+K});var j=Math.sqrt(et*et+K*K);switch(x){case"max":g.judgingDistance<j&&(g.judgingDistance=j);break;case"min":g.judgingDistance>j&&(g.judgingDistance=j);break;default:T+=j}}}),x&&x!=="mean"||(this.judgingDistance=T/S.length)}else this.judgingDistance=0},c}(),Yt=function(c,i){var e=c.getAllNodes();if(!(e!=null&&e.length))return{};var n={};return e.forEach(function(u,g){c.getDegree(u.id,"both")===1&&(n[u.id]=zt(c,"leaf",u,i))}),n},zt=function(c,i,e,n){var u=c.getDegree(e.id,"in"),g=c.getDegree(e.id,"out"),x=e,M=[];return u===0?(x=c.getSuccessors(e.id)[0],M=c.getNeighbors(x.id)):g===0&&(x=c.getPredecessors(e.id)[0],M=c.getNeighbors(x.id)),M=M.filter(function(S){return c.getDegree(S.id,"in")===0||c.getDegree(S.id,"out")===0}),{coreNode:x,siblingLeaves:M,sameTypeLeaves:bt(c,i,n,e,M)}},bt=function(c,i,e,n,u){var g=n.data[e]||"",x=(u==null?void 0:u.filter(function(M){return M.data[e]===g}))||[];return i==="leaf"&&(x=x.filter(function(M){return c.getDegree(M.id,"in")===0||c.getDegree(M.id,"out")===0})),x},Ot=function(c){var i={x:0,y:0};c.forEach(function(n){var u=n.data,g=u.x,x=u.y;i.x+=g||0,i.y+=x||0});var e=c.length||1;return{x:i.x/e,y:i.y/e}},Xt=function(c,i){return i.map(function(e){var n=e.id,u=e.data,g=c.getNode(n);return z(z({},g),{data:z(z({},g.data),{x:u.x,y:u.y})})})},Wt=function(){function c(i){this.id=i.id||0,this.rx=i.rx,this.ry=i.ry,this.fx=0,this.fy=0,this.mass=i.mass,this.degree=i.degree,this.g=i.g||0}return c.prototype.distanceTo=function(i){var e=this.rx-i.rx,n=this.ry-i.ry;return Math.hypot(e,n)},c.prototype.setPos=function(i,e){this.rx=i,this.ry=e},c.prototype.resetForce=function(){this.fx=0,this.fy=0},c.prototype.addForce=function(i){var e=i.rx-this.rx,n=i.ry-this.ry,u=Math.hypot(e,n);u=u<1e-4?1e-4:u;var g=this.g*(this.degree+1)*(i.degree+1)/u;this.fx+=g*e/u,this.fy+=g*n/u},c.prototype.in=function(i){return i.contains(this.rx,this.ry)},c.prototype.add=function(i){var e=this.mass+i.mass;return new c({rx:(this.rx*this.mass+i.rx*i.mass)/e,ry:(this.ry*this.mass+i.ry*i.mass)/e,mass:e,degree:this.degree+i.degree})},c}();const Z=Wt,wt=function(){function c(i){this.xmid=i.xmid,this.ymid=i.ymid,this.length=i.length,this.massCenter=i.massCenter||[0,0],this.mass=i.mass||1}return c.prototype.getLength=function(){return this.length},c.prototype.contains=function(i,e){var n=this.length/2;return i<=this.xmid+n&&i>=this.xmid-n&&e<=this.ymid+n&&e>=this.ymid-n},c.prototype.NW=function(){return new c({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},c.prototype.NE=function(){return new c({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},c.prototype.SW=function(){return new c({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},c.prototype.SE=function(){return new c({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},c}(),$t=function(){function c(i){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,i!=null&&(this.quad=i)}return c.prototype.insert=function(i){this.body!=null?this._isExternal()?(this.quad&&(this.NW=new c(this.quad.NW()),this.NE=new c(this.quad.NE()),this.SW=new c(this.quad.SW()),this.SE=new c(this.quad.SE())),this._putBody(this.body),this._putBody(i),this.body=this.body.add(i)):(this.body=this.body.add(i),this._putBody(i)):this.body=i},c.prototype._putBody=function(i){this.quad&&(i.in(this.quad.NW())&&this.NW?this.NW.insert(i):i.in(this.quad.NE())&&this.NE?this.NE.insert(i):i.in(this.quad.SW())&&this.SW?this.SW.insert(i):i.in(this.quad.SE())&&this.SE&&this.SE.insert(i))},c.prototype._isExternal=function(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null},c.prototype.updateForce=function(i){this.body!=null&&i!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(i)<this.theta?i.addForce(this.body):(this.NW&&this.NW.updateForce(i),this.NE&&this.NE.updateForce(i),this.SW&&this.SW.updateForce(i),this.SE&&this.SE.updateForce(i)))},c}();var Dt={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},ve=function(){function c(i){i===void 0&&(i={}),this.options=i,this.id="forceAtlas2",this.options=z(z({},Dt),i)}return c.prototype.execute=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return[2,this.genericForceAtlas2Layout(!1,i,e)]})})},c.prototype.assign=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return this.genericForceAtlas2Layout(!0,i,e),[2]})})},c.prototype.genericForceAtlas2Layout=function(i,e,n){return Mt(this,void 0,void 0,function(){var u,g,x,M,S,T,k,B,Q,et,K,j,dt,ot,pt,ne,Kt,qt,Nt,Pt,Ht,Ct;return te(this,function(V){if(u=e.getAllEdges(),g=e.getAllNodes(),x=this.formatOptions(n,g.length),M=x.width,S=x.height,T=x.prune,k=x.maxIteration,B=x.nodeSize,Q=x.center,!(g!=null&&g.length)||g.length===1)return[2,io(e,i,Q)];if(et=g.map(function(st){return Xr(st,[M,S])}),K=u.filter(function(st){return st.source!==st.target}),j=new to({nodes:et,edges:K}),dt=this.getSizes(j,e,B),this.run(j,e,k,dt,i,x),T){for(ot=0;ot<K.length;ot+=1)pt=K[ot],ne=pt.source,Kt=pt.target,qt=j.getDegree(ne),Nt=j.getDegree(ne),qt<=1?(Pt=j.getNode(Kt),j.mergeNodeData(ne,{x:Pt.data.x,y:Pt.data.y})):Nt<=1&&(Ht=j.getNode(ne),j.mergeNodeData(Kt,{x:Ht.data.x,y:Ht.data.y}));Ct=z(z({},x),{prune:!1,barnesHut:!1}),this.run(j,e,100,dt,i,Ct)}return[2,{nodes:et,edges:u}]})})},c.prototype.getSizes=function(i,e,n){for(var u=i.getAllNodes(),g={},x=0;x<u.length;x+=1){var M=u[x],S=M.id,T=M.data;if(g[S]=10,Te(T.size))g[S]=T.size;else if(Qe(T.size))isNaN(T.size[0])||(g[S]=Math.max(T.size[0])),isNaN(T.size[1])||(g[S]=Math.max(T.size[1]));else if(Rn(T.size))g[S]=Math.max(T.size.width,T.size.height);else if(hn(n)){var k=n(e.getNode(S));Qe(k)?g[S]=Math.max.apply(Math,he([],ue(k))):g[S]=k}else Qe(n)?g[S]=Math.max.apply(Math,he([],ue(n))):Te(n)&&(g[S]=n)}return g},c.prototype.formatOptions=function(i,e){i===void 0&&(i={});var n=z(z({},this.options),i),u=n.center,g=n.width,x=n.height,M=n.barnesHut,S=n.prune,T=n.maxIteration,k=n.kr,B=n.kg;return n.width=g||typeof window>"u"?g:window.innerWidth,n.height=x||typeof window>"u"?x:window.innerHeight,n.center=u||[n.width/2,n.height/2],M===void 0&&e>250&&(n.barnesHut=!0),S===void 0&&e>100&&(n.prune=!0),T!==0||S?T===0&&S&&(n.maxIteration=100,e<=200&&e>100?n.maxIteration=500:e>200&&(n.maxIteration=950)):(n.maxIteration=250,e<=200&&e>100?n.maxIteration=1e3:e>200&&(n.maxIteration=1200)),k||(n.kr=50,e>100&&e<=500?n.kr=20:e>500&&(n.kr=1)),B||(n.kg=20,e>100&&e<=500?n.kg=10:e>500&&(n.kg=1)),n},c.prototype.run=function(i,e,n,u,g,x){for(var M=x.kr,S=x.barnesHut,T=x.onTick,k=i.getAllNodes(),B=0,Q=n,et={},K={},j={},dt=0;dt<k.length;dt+=1){var ot=k[dt],pt=ot.data,ne=ot.id;if(et[ne]=[0,0],S){var Kt={id:dt,rx:pt.x,ry:pt.y,mass:1,g:M,degree:i.getDegree(ne)};j[ne]=new Z(Kt)}}for(;Q>0;)B=this.oneStep(i,{iter:Q,preventOverlapIters:50,krPrime:100,sg:B,forces:et,preForces:K,bodies:j,sizes:u},x),Q--,T==null||T({nodes:k,edges:e.getAllEdges()});return i},c.prototype.oneStep=function(i,e,n){for(var u=e.iter,g=e.preventOverlapIters,x=e.krPrime,M=e.sg,S=e.preForces,T=e.bodies,k=e.sizes,B=e.forces,Q=n.preventOverlap,et=n.barnesHut,K=i.getAllNodes(),j=0;j<K.length;j+=1){var dt=K[j].id;S[dt]=he([],ue(B[dt])),B[dt]=[0,0]}return B=this.getAttrForces(i,u,g,k,B,n),B=et&&(Q&&u>g||!Q)?this.getOptRepGraForces(i,B,T,n):this.getRepGraForces(i,u,g,B,x,k,n),this.updatePos(i,B,S,M,n)},c.prototype.getAttrForces=function(i,e,n,u,g,x){for(var M=x.preventOverlap,S=x.dissuadeHubs,T=x.mode,k=x.prune,B=i.getAllEdges(),Q=0;Q<B.length;Q+=1){var et=B[Q],K=et.source,j=et.target,dt=i.getNode(K),ot=i.getNode(j),pt=i.getDegree(K),ne=i.getDegree(j);if(!k||!(pt<=1||ne<=1)){var Kt=[ot.data.x-dt.data.x,ot.data.y-dt.data.y],qt=Math.hypot(Kt[0],Kt[1]);qt=qt<1e-4?1e-4:qt,Kt[0]=Kt[0]/qt,Kt[1]=Kt[1]/qt,M&&e<n&&(qt=qt-u[K]-u[j]);var Nt=qt,Pt=Nt;T==="linlog"&&(Pt=Nt=Math.log(1+qt)),S&&(Nt=qt/pt,Pt=qt/ne),M&&e<n&&qt<=0?(Nt=0,Pt=0):M&&e<n&&qt>0&&(Nt=qt,Pt=qt),g[K][0]+=Nt*Kt[0],g[j][0]-=Pt*Kt[0],g[K][1]+=Nt*Kt[1],g[j][1]-=Pt*Kt[1]}}return g},c.prototype.getOptRepGraForces=function(i,e,n,u){for(var g=u.kg,x=u.center,M=u.prune,S=i.getAllNodes(),T=S.length,k=9e10,B=-9e10,Q=9e10,et=-9e10,K=0;K<T;K+=1){var j=S[K],dt=j.id,ot=j.data;M&&i.getDegree(dt)<=1||(n[dt].setPos(ot.x,ot.y),ot.x>=B&&(B=ot.x),ot.x<=k&&(k=ot.x),ot.y>=et&&(et=ot.y),ot.y<=Q&&(Q=ot.y))}var pt=Math.max(B-k,et-Q),ne=new wt({xmid:(B+k)/2,ymid:(et+Q)/2,length:pt,massCenter:x,mass:T}),Kt=new $t(ne);for(K=0;K<T;K+=1)dt=S[K].id,M&&i.getDegree(dt)<=1||n[dt].in(ne)&&Kt.insert(n[dt]);for(K=0;K<T;K+=1){var qt=S[K],Nt=(dt=qt.id,ot=qt.data,i.getDegree(dt));if(!(M&&Nt<=1)){n[dt].resetForce(),Kt.updateForce(n[dt]),e[dt][0]-=n[dt].fx,e[dt][1]-=n[dt].fy;var Pt=[ot.x-x[0],ot.y-x[1]],Ht=Math.hypot(Pt[0],Pt[1]);Ht=Ht<1e-4?1e-4:Ht,Pt[0]=Pt[0]/Ht,Pt[1]=Pt[1]/Ht;var Ct=g*(Nt+1);e[dt][0]-=Ct*Pt[0],e[dt][1]-=Ct*Pt[1]}}return e},c.prototype.getRepGraForces=function(i,e,n,u,g,x,M){for(var S=M.preventOverlap,T=M.kr,k=M.kg,B=M.center,Q=M.prune,et=i.getAllNodes(),K=et.length,j=0;j<K;j+=1){for(var dt=et[j],ot=i.getDegree(dt.id),pt=j+1;pt<K;pt+=1){var ne=et[pt],Kt=i.getDegree(ne.id);if(!Q||!(ot<=1||Kt<=1)){var qt=[ne.data.x-dt.data.x,ne.data.y-dt.data.y],Nt=Math.hypot(qt[0],qt[1]);Nt=Nt<1e-4?1e-4:Nt,qt[0]=qt[0]/Nt,qt[1]=qt[1]/Nt,S&&e<n&&(Nt=Nt-x[dt.id]-x[ne.id]);var Pt=T*(ot+1)*(Kt+1)/Nt;S&&e<n&&Nt<0?Pt=g*(ot+1)*(Kt+1):S&&e<n&&Nt===0?Pt=0:S&&e<n&&Nt>0&&(Pt=T*(ot+1)*(Kt+1)/Nt),u[dt.id][0]-=Pt*qt[0],u[ne.id][0]+=Pt*qt[0],u[dt.id][1]-=Pt*qt[1],u[ne.id][1]+=Pt*qt[1]}}var Ht=[dt.data.x-B[0],dt.data.y-B[1]],Ct=Math.hypot(Ht[0],Ht[1]);Ht[0]=Ht[0]/Ct,Ht[1]=Ht[1]/Ct;var V=k*(ot+1);u[dt.id][0]-=V*Ht[0],u[dt.id][1]-=V*Ht[1]}return u},c.prototype.updatePos=function(i,e,n,u,g){for(var x=g.ks,M=g.tao,S=g.prune,T=g.ksmax,k=i.getAllNodes(),B=k.length,Q=[],et=[],K=0,j=0,dt=u,ot=0;ot<B;ot+=1){var pt=k[ot].id,ne=i.getDegree(pt);if(!(S&&ne<=1)){var Kt=[e[pt][0]-n[pt][0],e[pt][1]-n[pt][1]],qt=Math.hypot(Kt[0],Kt[1]),Nt=[e[pt][0]+n[pt][0],e[pt][1]+n[pt][1]],Pt=Math.hypot(Nt[0],Nt[1]);Q[ot]=qt,et[ot]=Pt/2,K+=(ne+1)*Q[ot],j+=(ne+1)*et[ot]}}var Ht=dt;for(dt=M*j/K,Ht!==0&&(dt=dt>1.5*Ht?1.5*Ht:dt),ot=0;ot<B;ot+=1){var Ct=k[ot],V=(pt=Ct.id,Ct.data);if(ne=i.getDegree(pt),!(S&&ne<=1||Te(V.fx)&&Te(V.fy))){var st=x*dt/(1+dt*Math.sqrt(Q[ot])),It=Math.hypot(e[pt][0],e[pt][1]),mt=T/(It=It<1e-4?1e-4:It),X=(st=st>mt?mt:st)*e[pt][0],D=st*e[pt][1];i.mergeNodeData(pt,{x:V.x+X,y:V.y+D})}}return dt},c}(),ge={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},ce=function(){function c(i){i===void 0&&(i={}),this.options=i,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=z(z({},ge),i)}return c.prototype.execute=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return[2,this.genericFruchtermanLayout(!1,i,e)]})})},c.prototype.assign=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return this.genericFruchtermanLayout(!0,i,e),[2]})})},c.prototype.stop=function(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1},c.prototype.tick=function(i){var e=this;if(i===void 0&&(i=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var n=0;n<i;n++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var u={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&u.nodes.forEach(function(g){return e.lastGraph.mergeNodeData(g.id,{x:g.data.x,y:g.data.y})}),u},c.prototype.genericFruchtermanLayout=function(i,e,n){return Mt(this,void 0,void 0,function(){var u,g,x,M,S,T,k,B,Q,et,K,j,dt,ot,pt,ne=this;return te(this,function(Kt){return this.running?[2]:(u=this.formatOptions(n),g=u.width,x=u.height,M=u.center,S=u.clustering,T=u.nodeClusterBy,k=u.maxIteration,B=u.onTick,Q=e.getAllNodes(),et=e.getAllEdges(),Q!=null&&Q.length?Q.length===1?(i&&e.mergeNodeData(Q[0].id,{x:M[0],y:M[1]}),K={nodes:[z(z({},Q[0]),{data:z(z({},Q[0].data),{x:M[0],y:M[1]})})],edges:et},this.lastResult=K,[2,K]):(j=Q.map(function(qt){return Xr(qt,[g,x])}),dt=new to({nodes:j,edges:et}),ot={},S&&j.forEach(function(qt){var Nt=qt.data[T];ot[Nt]||(ot[Nt]={name:Nt,cx:0,cy:0,count:0})}),this.lastLayoutNodes=j,this.lastLayoutEdges=et,this.lastAssign=i,this.lastGraph=dt,this.lastOptions=u,this.lastClusterMap=ot,typeof window>"u"?[2]:(pt=0,[2,new Promise(function(qt){ne.timeInterval=window.setInterval(function(){ne.running?(ne.runOneStep(dt,ot,u),i&&j.forEach(function(Nt){var Pt=Nt.id,Ht=Nt.data;return e.mergeNodeData(Pt,{x:Ht.x,y:Ht.y})}),B==null||B({nodes:j,edges:et}),++pt>=k&&(window.clearInterval(ne.timeInterval),qt({nodes:j,edges:et}))):qt({nodes:j,edges:et})},0),ne.running=!0})])):(K={nodes:[],edges:et},this.lastResult=K,[2,K]))})})},c.prototype.formatOptions=function(i){i===void 0&&(i={});var e=z(z({},this.options),i),n=e.clustering,u=e.nodeClusterBy,g=e.center,x=e.width,M=e.height;return e.width=x||typeof window>"u"?x:window.innerWidth,e.height=M||typeof window>"u"?M:window.innerHeight,e.center=g||[e.width/2,e.height/2],e.clustering=n&&!!u,e},c.prototype.runOneStep=function(i,e,n){var u=n.height,g=n.width,x=n.gravity,M=n.center,S=n.speed,T=n.clustering,k=n.nodeClusterBy,B=n.clusterGravity,Q=u*g,et=Math.sqrt(Q)/10,K=i.getAllNodes(),j=Q/(K.length+1),dt=Math.sqrt(j),ot={};if(this.applyCalculate(i,ot,dt,j),T){for(var pt in e)e[pt].cx=0,e[pt].cy=0,e[pt].count=0;for(var pt in K.forEach(function(qt){var Nt=qt.data,Pt=e[Nt[k]];Te(Nt.x)&&(Pt.cx+=Nt.x),Te(Nt.y)&&(Pt.cy+=Nt.y),Pt.count++}),e)e[pt].cx/=e[pt].count,e[pt].cy/=e[pt].count;var ne=B||x;K.forEach(function(Kt,qt){var Nt=Kt.id,Pt=Kt.data;if(Te(Pt.x)&&Te(Pt.y)){var Ht=e[Pt[k]],Ct=Math.sqrt((Pt.x-Ht.cx)*(Pt.x-Ht.cx)+(Pt.y-Ht.cy)*(Pt.y-Ht.cy)),V=dt*ne;ot[Nt].x-=V*(Pt.x-Ht.cx)/Ct,ot[Nt].y-=V*(Pt.y-Ht.cy)/Ct}})}K.forEach(function(Kt,qt){var Nt=Kt.id,Pt=Kt.data;if(Te(Pt.x)&&Te(Pt.y)){var Ht=.01*dt*x;ot[Nt].x-=Ht*(Pt.x-M[0]),ot[Nt].y-=Ht*(Pt.y-M[1])}}),K.forEach(function(Kt,qt){var Nt=Kt.id,Pt=Kt.data;if(Te(Pt.fx)&&Te(Pt.fy))return Pt.x=Pt.fx,void(Pt.y=Pt.fy);if(Te(Pt.x)&&Te(Pt.y)){var Ht=Math.sqrt(ot[Nt].x*ot[Nt].x+ot[Nt].y*ot[Nt].y);if(Ht>0){var Ct=Math.min(et*(S/800),Ht);i.mergeNodeData(Nt,{x:Pt.x+ot[Nt].x/Ht*Ct,y:Pt.y+ot[Nt].y/Ht*Ct})}}})},c.prototype.applyCalculate=function(i,e,n,u){this.calRepulsive(i,e,u),this.calAttractive(i,e,n)},c.prototype.calRepulsive=function(i,e,n){var u=i.getAllNodes();u.forEach(function(g,x){var M=g.data,S=g.id;e[S]={x:0,y:0},u.forEach(function(T,k){var B=T.data,Q=T.id;if(!(x<=k)&&Te(M.x)&&Te(B.x)&&Te(M.y)&&Te(B.y)){var et=M.x-B.x,K=M.y-B.y,j=et*et+K*K;j===0&&(j=1,et=.01,K=.01);var dt=n/j,ot=et*dt,pt=K*dt;e[S].x+=ot,e[S].y+=pt,e[Q].x-=ot,e[Q].y-=pt}})})},c.prototype.calAttractive=function(i,e,n){i.getAllEdges().forEach(function(u){var g=u.source,x=u.target;if(g&&x&&g!==x){var M=i.getNode(g).data,S=i.getNode(x).data;if(Te(S.x)&&Te(M.x)&&Te(S.y)&&Te(M.y)){var T=S.x-M.x,k=S.y-M.y,B=Math.sqrt(T*T+k*k)/n,Q=T*B,et=k*B;e[g].x+=Q,e[g].y+=et,e[x].x-=Q,e[x].y-=et}}})},c}(),Ne={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},ke=function(){function c(i){i===void 0&&(i={}),this.options=i,this.id="grid",this.options=z(z({},Ne),i)}return c.prototype.execute=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return[2,this.genericGridLayout(!1,i,e)]})})},c.prototype.assign=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return this.genericGridLayout(!0,i,e),[2]})})},c.prototype.genericGridLayout=function(i,e,n){return Mt(this,void 0,void 0,function(){var u,g,x,M,S,T,k,B,Q,et,K,j,dt,ot,pt,ne,Kt,qt,Nt,Pt,Ht,Ct,V,st,It,mt,X,D,W,vt,yt,At,I,P,C,O,ut;return te(this,function(xt){if(u=z(z({},this.options),n),g=u.begin,x=g===void 0?[0,0]:g,M=u.condense,S=u.preventOverlapPadding,T=u.preventOverlap,k=u.rows,B=u.cols,Q=u.nodeSpacing,et=u.nodeSize,K=u.width,j=u.height,dt=u.position,ot=u.sortBy,pt=e.getAllNodes(),ne=e.getAllEdges(),!(Kt=pt==null?void 0:pt.length)||Kt===1)return[2,io(e,i,x)];if(qt=pt.map(function(G){return Xr(G)}),ot==="id"||Zn(ot)&&qt[0].data[ot]!==void 0||(ot="degree"),ot==="degree"?qt.sort(function(G,U){return e.getDegree(U.id,"both")-e.getDegree(G.id,"both")}):ot==="id"?qt.sort(function(G,U){return Te(U.id)&&Te(G.id)?U.id-G.id:(""+G.id).localeCompare(""+U.id)}):qt.sort(function(G,U){return U.data[ot]-G.data[ot]}),Nt=K||typeof window>"u"?K:window.innerWidth,Pt=j||typeof window>"u"?j:window.innerHeight,Ht=Kt,Ct={rows:k,cols:B},k!=null&&B!=null?(Ct.rows=k,Ct.cols=B):k!=null&&B==null?(Ct.rows=k,Ct.cols=Math.ceil(Ht/Ct.rows)):k==null&&B!=null?(Ct.cols=B,Ct.rows=Math.ceil(Ht/Ct.cols)):(V=Math.sqrt(Ht*Pt/Nt),Ct.rows=Math.round(V),Ct.cols=Math.round(Nt/Pt*V)),Ct.rows=Math.max(Ct.rows,1),Ct.cols=Math.max(Ct.cols,1),Ct.cols*Ct.rows>Ht)st=xe(Ct),It=Le(Ct),(st-1)*It>=Ht?xe(Ct,st-1):(It-1)*st>=Ht&&Le(Ct,It-1);else for(;Ct.cols*Ct.rows<Ht;)st=xe(Ct),((It=Le(Ct))+1)*st>=Ht?Le(Ct,It+1):xe(Ct,st+1);for(mt=M?0:Nt/Ct.cols,X=M?0:Pt/Ct.rows,(T||Q)&&(D=wn(10,Q),W=On(30,et,!1),qt.forEach(function(G){G.data.x&&G.data.y||(G.data.x=0,G.data.y=0);var U,lt,it=e.getNode(G.id),ft=W(it)||30;Qe(ft)?(U=ft[0],lt=ft[1]):(U=ft,lt=ft);var Rt=D!==void 0?D(G):S,Gt=U+Rt,ht=lt+Rt;mt=Math.max(mt,Gt),X=Math.max(X,ht)})),vt={},yt={row:0,col:0},At={},I=0;I<qt.length;I++){if(P=qt[I],C=void 0,dt&&(C=dt(e.getNode(P.id))),C&&(C.row!==void 0||C.col!==void 0)){if((O={row:C.row,col:C.col}).col===void 0)for(O.col=0;Be(vt,O);)O.col++;else if(O.row===void 0)for(O.row=0;Be(vt,O);)O.row++;At[P.id]=O,Ge(vt,O)}Fe(P,x,mt,X,At,Ct,yt,vt)}return ut={nodes:qt,edges:ne},i&&qt.forEach(function(G){e.mergeNodeData(G.id,{x:G.data.x,y:G.data.y})}),[2,ut]})})},c}(),xe=function(c,i){var e,n=c.rows||5,u=c.cols||5;return i==null?e=Math.min(n,u):Math.min(n,u)===c.rows?c.rows=i:c.cols=i,e},Le=function(c,i){var e,n=c.rows||5,u=c.cols||5;return i==null?e=Math.max(n,u):Math.max(n,u)===c.rows?c.rows=i:c.cols=i,e},Be=function(c,i){return c["c-"+i.row+"-"+i.col]||!1},Ge=function(c,i){return c["c-"+i.row+"-"+i.col]=!0},de=function(c,i){var e=c.cols||5;i.col++,i.col>=e&&(i.col=0,i.row++)},Fe=function(c,i,e,n,u,g,x,M){var S,T,k=u[c.id];if(k)S=k.col*e+e/2+i[0],T=k.row*n+n/2+i[1];else{for(;Be(M,x);)de(g,x);S=x.col*e+e/2+i[0],T=x.row*n+n/2+i[1],Ge(M,x),de(g,x)}c.data.x=S,c.data.y=T};const er=Object.prototype.toString;function je(c){return er.call(c).endsWith("Array]")}function we(c){var i,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!je(c))throw new TypeError("input must be an array");if(c.length===0)throw new TypeError("input must not be empty");if(e.output!==void 0){if(!je(e.output))throw new TypeError("output option must be an array if specified");i=e.output}else i=new Array(c.length);var n=function(B){var Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!je(B))throw new TypeError("input must be an array");if(B.length===0)throw new TypeError("input must not be empty");var et=Q.fromIndex,K=et===void 0?0:et,j=Q.toIndex,dt=j===void 0?B.length:j;if(K<0||K>=B.length||!Number.isInteger(K))throw new Error("fromIndex must be a positive integer smaller than length");if(dt<=K||dt>B.length||!Number.isInteger(dt))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var ot=B[K],pt=K+1;pt<dt;pt++)B[pt]<ot&&(ot=B[pt]);return ot}(c),u=function(B){var Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!je(B))throw new TypeError("input must be an array");if(B.length===0)throw new TypeError("input must not be empty");var et=Q.fromIndex,K=et===void 0?0:et,j=Q.toIndex,dt=j===void 0?B.length:j;if(K<0||K>=B.length||!Number.isInteger(K))throw new Error("fromIndex must be a positive integer smaller than length");if(dt<=K||dt>B.length||!Number.isInteger(dt))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var ot=B[K],pt=K+1;pt<dt;pt++)B[pt]>ot&&(ot=B[pt]);return ot}(c);if(n===u)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var g=e.min,x=g===void 0?e.autoMinMax?n:0:g,M=e.max,S=M===void 0?e.autoMinMax?u:1:M;if(x>=S)throw new RangeError("min option must be smaller than max option");for(var T=(S-x)/(u-n),k=0;k<c.length;k++)i[k]=(c[k]-n)*T+x;return i}const lr=" ".repeat(2),tn=" ".repeat(4);function Ir(c,i={}){const{maxRows:e=15,maxColumns:n=10,maxNumSize:u=8,padMinus:g="auto"}=i;return`${c.constructor.name} {
${lr}[
${tn}${function(x,M,S,T,k){const{rows:B,columns:Q}=x,et=Math.min(B,M),K=Math.min(Q,S),j=[];if(k==="auto"){k=!1;t:for(let dt=0;dt<et;dt++)for(let ot=0;ot<K;ot++)if(x.get(dt,ot)<0){k=!0;break t}}for(let dt=0;dt<et;dt++){let ot=[];for(let pt=0;pt<K;pt++)ot.push(ro(x.get(dt,pt),T,k));j.push(`${ot.join(" ")}`)}return K!==Q&&(j[j.length-1]+=` ... ${Q-S} more columns`),et!==B&&j.push(`... ${B-M} more rows`),j.join(`
${tn}`)}(c,e,n,u,g)}
${lr}]
${lr}rows: ${c.rows}
${lr}columns: ${c.columns}
}`}function ro(c,i,e){return(c>=0&&e?` ${Tr(c,i-1)}`:Tr(c,i)).padEnd(i)}function Tr(c,i){let e=c.toString();if(e.length<=i)return e;let n=c.toFixed(i);if(n.length>i&&(n=c.toFixed(Math.max(0,i-(n.length-i)))),n.length<=i&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let u=c.toExponential(i);return u.length>i&&(u=c.toExponential(Math.max(0,i-(u.length-i)))),u.slice(0)}function Nr(c,i,e){let n=e?c.rows:c.rows-1;if(i<0||i>n)throw new RangeError("Row index out of range")}function fr(c,i,e){let n=e?c.columns:c.columns-1;if(i<0||i>n)throw new RangeError("Column index out of range")}function vr(c,i){if(i.to1DArray&&(i=i.to1DArray()),i.length!==c.columns)throw new RangeError("vector size must be the same as the number of columns");return i}function sn(c,i){if(i.to1DArray&&(i=i.to1DArray()),i.length!==c.rows)throw new RangeError("vector size must be the same as the number of rows");return i}function jr(c,i,e,n,u){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(Fn("startRow",i),Fn("endRow",e),Fn("startColumn",n),Fn("endColumn",u),i>e||n>u||i<0||i>=c.rows||e<0||e>=c.rows||n<0||n>=c.columns||u<0||u>=c.columns)throw new RangeError("Submatrix indices are out of range")}function Lr(c,i=0){let e=[];for(let n=0;n<c;n++)e.push(i);return e}function Fn(c,i){if(typeof i!="number")throw new TypeError(`${c} must be a number`)}function vn(c){if(c.isEmpty())throw new Error("Empty matrix has no elements to index")}class wr{static from1DArray(i,e,n){if(i*e!==n.length)throw new RangeError("data length does not match given dimensions");let u=new tr(i,e);for(let g=0;g<i;g++)for(let x=0;x<e;x++)u.set(g,x,n[g*e+x]);return u}static rowVector(i){let e=new tr(1,i.length);for(let n=0;n<i.length;n++)e.set(0,n,i[n]);return e}static columnVector(i){let e=new tr(i.length,1);for(let n=0;n<i.length;n++)e.set(n,0,i[n]);return e}static zeros(i,e){return new tr(i,e)}static ones(i,e){return new tr(i,e).fill(1)}static rand(i,e,n={}){if(typeof n!="object")throw new TypeError("options must be an object");const{random:u=Math.random}=n;let g=new tr(i,e);for(let x=0;x<i;x++)for(let M=0;M<e;M++)g.set(x,M,u());return g}static randInt(i,e,n={}){if(typeof n!="object")throw new TypeError("options must be an object");const{min:u=0,max:g=1e3,random:x=Math.random}=n;if(!Number.isInteger(u))throw new TypeError("min must be an integer");if(!Number.isInteger(g))throw new TypeError("max must be an integer");if(u>=g)throw new RangeError("min must be smaller than max");let M=g-u,S=new tr(i,e);for(let T=0;T<i;T++)for(let k=0;k<e;k++){let B=u+Math.round(x()*M);S.set(T,k,B)}return S}static eye(i,e,n){e===void 0&&(e=i),n===void 0&&(n=1);let u=Math.min(i,e),g=this.zeros(i,e);for(let x=0;x<u;x++)g.set(x,x,n);return g}static diag(i,e,n){let u=i.length;e===void 0&&(e=u),n===void 0&&(n=e);let g=Math.min(u,e,n),x=this.zeros(e,n);for(let M=0;M<g;M++)x.set(M,M,i[M]);return x}static min(i,e){i=this.checkMatrix(i),e=this.checkMatrix(e);let n=i.rows,u=i.columns,g=new tr(n,u);for(let x=0;x<n;x++)for(let M=0;M<u;M++)g.set(x,M,Math.min(i.get(x,M),e.get(x,M)));return g}static max(i,e){i=this.checkMatrix(i),e=this.checkMatrix(e);let n=i.rows,u=i.columns,g=new this(n,u);for(let x=0;x<n;x++)for(let M=0;M<u;M++)g.set(x,M,Math.max(i.get(x,M),e.get(x,M)));return g}static checkMatrix(i){return wr.isMatrix(i)?i:new tr(i)}static isMatrix(i){return i!=null&&i.klass==="Matrix"}get size(){return this.rows*this.columns}apply(i){if(typeof i!="function")throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)i.call(this,e,n);return this}to1DArray(){let i=[];for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)i.push(this.get(e,n));return i}to2DArray(){let i=[];for(let e=0;e<this.rows;e++){i.push([]);for(let n=0;n<this.columns;n++)i[e].push(this.get(e,n))}return i}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let i=0;i<this.rows;i++)for(let e=0;e<=i;e++)if(this.get(i,e)!==this.get(e,i))return!1;return!0}return!1}isEchelonForm(){let i=0,e=0,n=-1,u=!0,g=!1;for(;i<this.rows&&u;){for(e=0,g=!1;e<this.columns&&g===!1;)this.get(i,e)===0?e++:this.get(i,e)===1&&e>n?(g=!0,n=e):(u=!1,g=!0);i++}return u}isReducedEchelonForm(){let i=0,e=0,n=-1,u=!0,g=!1;for(;i<this.rows&&u;){for(e=0,g=!1;e<this.columns&&g===!1;)this.get(i,e)===0?e++:this.get(i,e)===1&&e>n?(g=!0,n=e):(u=!1,g=!0);for(let x=e+1;x<this.rows;x++)this.get(i,x)!==0&&(u=!1);i++}return u}echelonForm(){let i=this.clone(),e=0,n=0;for(;e<i.rows&&n<i.columns;){let u=e;for(let g=e;g<i.rows;g++)i.get(g,n)>i.get(u,n)&&(u=g);if(i.get(u,n)===0)n++;else{i.swapRows(e,u);let g=i.get(e,n);for(let x=n;x<i.columns;x++)i.set(e,x,i.get(e,x)/g);for(let x=e+1;x<i.rows;x++){let M=i.get(x,n)/i.get(e,n);i.set(x,n,0);for(let S=n+1;S<i.columns;S++)i.set(x,S,i.get(x,S)-i.get(e,S)*M)}e++,n++}}return i}reducedEchelonForm(){let i=this.echelonForm(),e=i.columns,n=i.rows,u=n-1;for(;u>=0;)if(i.maxRow(u)===0)u--;else{let g=0,x=!1;for(;g<n&&x===!1;)i.get(u,g)===1?x=!0:g++;for(let M=0;M<u;M++){let S=i.get(M,g);for(let T=g;T<e;T++){let k=i.get(M,T)-S*i.get(u,T);i.set(M,T,k)}}u--}return i}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(i={}){if(typeof i!="object")throw new TypeError("options must be an object");const{rows:e=1,columns:n=1}=i;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(n)||n<=0)throw new TypeError("columns must be a positive integer");let u=new tr(this.rows*e,this.columns*n);for(let g=0;g<e;g++)for(let x=0;x<n;x++)u.setSubMatrix(this,this.rows*g,this.columns*x);return u}fill(i){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,i);return this}neg(){return this.mulS(-1)}getRow(i){Nr(this,i);let e=[];for(let n=0;n<this.columns;n++)e.push(this.get(i,n));return e}getRowVector(i){return tr.rowVector(this.getRow(i))}setRow(i,e){Nr(this,i),e=vr(this,e);for(let n=0;n<this.columns;n++)this.set(i,n,e[n]);return this}swapRows(i,e){Nr(this,i),Nr(this,e);for(let n=0;n<this.columns;n++){let u=this.get(i,n);this.set(i,n,this.get(e,n)),this.set(e,n,u)}return this}getColumn(i){fr(this,i);let e=[];for(let n=0;n<this.rows;n++)e.push(this.get(n,i));return e}getColumnVector(i){return tr.columnVector(this.getColumn(i))}setColumn(i,e){fr(this,i),e=sn(this,e);for(let n=0;n<this.rows;n++)this.set(n,i,e[n]);return this}swapColumns(i,e){fr(this,i),fr(this,e);for(let n=0;n<this.rows;n++){let u=this.get(n,i);this.set(n,i,this.get(n,e)),this.set(n,e,u)}return this}addRowVector(i){i=vr(this,i);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+i[n]);return this}subRowVector(i){i=vr(this,i);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-i[n]);return this}mulRowVector(i){i=vr(this,i);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*i[n]);return this}divRowVector(i){i=vr(this,i);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/i[n]);return this}addColumnVector(i){i=sn(this,i);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+i[e]);return this}subColumnVector(i){i=sn(this,i);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-i[e]);return this}mulColumnVector(i){i=sn(this,i);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*i[e]);return this}divColumnVector(i){i=sn(this,i);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/i[e]);return this}mulRow(i,e){Nr(this,i);for(let n=0;n<this.columns;n++)this.set(i,n,this.get(i,n)*e);return this}mulColumn(i,e){fr(this,i);for(let n=0;n<this.rows;n++)this.set(n,i,this.get(n,i)*e);return this}max(i){if(this.isEmpty())return NaN;switch(i){case"row":{const e=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.get(n,u)>e[n]&&(e[n]=this.get(n,u));return e}case"column":{const e=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.get(n,u)>e[u]&&(e[u]=this.get(n,u));return e}case void 0:{let e=this.get(0,0);for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.get(n,u)>e&&(e=this.get(n,u));return e}default:throw new Error(`invalid option: ${i}`)}}maxIndex(){vn(this);let i=this.get(0,0),e=[0,0];for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.get(n,u)>i&&(i=this.get(n,u),e[0]=n,e[1]=u);return e}min(i){if(this.isEmpty())return NaN;switch(i){case"row":{const e=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.get(n,u)<e[n]&&(e[n]=this.get(n,u));return e}case"column":{const e=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.get(n,u)<e[u]&&(e[u]=this.get(n,u));return e}case void 0:{let e=this.get(0,0);for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.get(n,u)<e&&(e=this.get(n,u));return e}default:throw new Error(`invalid option: ${i}`)}}minIndex(){vn(this);let i=this.get(0,0),e=[0,0];for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.get(n,u)<i&&(i=this.get(n,u),e[0]=n,e[1]=u);return e}maxRow(i){if(Nr(this,i),this.isEmpty())return NaN;let e=this.get(i,0);for(let n=1;n<this.columns;n++)this.get(i,n)>e&&(e=this.get(i,n));return e}maxRowIndex(i){Nr(this,i),vn(this);let e=this.get(i,0),n=[i,0];for(let u=1;u<this.columns;u++)this.get(i,u)>e&&(e=this.get(i,u),n[1]=u);return n}minRow(i){if(Nr(this,i),this.isEmpty())return NaN;let e=this.get(i,0);for(let n=1;n<this.columns;n++)this.get(i,n)<e&&(e=this.get(i,n));return e}minRowIndex(i){Nr(this,i),vn(this);let e=this.get(i,0),n=[i,0];for(let u=1;u<this.columns;u++)this.get(i,u)<e&&(e=this.get(i,u),n[1]=u);return n}maxColumn(i){if(fr(this,i),this.isEmpty())return NaN;let e=this.get(0,i);for(let n=1;n<this.rows;n++)this.get(n,i)>e&&(e=this.get(n,i));return e}maxColumnIndex(i){fr(this,i),vn(this);let e=this.get(0,i),n=[0,i];for(let u=1;u<this.rows;u++)this.get(u,i)>e&&(e=this.get(u,i),n[0]=u);return n}minColumn(i){if(fr(this,i),this.isEmpty())return NaN;let e=this.get(0,i);for(let n=1;n<this.rows;n++)this.get(n,i)<e&&(e=this.get(n,i));return e}minColumnIndex(i){fr(this,i),vn(this);let e=this.get(0,i),n=[0,i];for(let u=1;u<this.rows;u++)this.get(u,i)<e&&(e=this.get(u,i),n[0]=u);return n}diag(){let i=Math.min(this.rows,this.columns),e=[];for(let n=0;n<i;n++)e.push(this.get(n,n));return e}norm(i="frobenius"){let e=0;if(i==="max")return this.max();if(i==="frobenius"){for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)e+=this.get(n,u)*this.get(n,u);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${i}`)}cumulativeSum(){let i=0;for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)i+=this.get(e,n),this.set(e,n,i);return this}dot(i){wr.isMatrix(i)&&(i=i.to1DArray());let e=this.to1DArray();if(e.length!==i.length)throw new RangeError("vectors do not have the same size");let n=0;for(let u=0;u<e.length;u++)n+=e[u]*i[u];return n}mmul(i){i=tr.checkMatrix(i);let e=this.rows,n=this.columns,u=i.columns,g=new tr(e,u),x=new Float64Array(n);for(let M=0;M<u;M++){for(let S=0;S<n;S++)x[S]=i.get(S,M);for(let S=0;S<e;S++){let T=0;for(let k=0;k<n;k++)T+=this.get(S,k)*x[k];g.set(S,M,T)}}return g}strassen2x2(i){i=tr.checkMatrix(i);let e=new tr(2,2);const n=this.get(0,0),u=i.get(0,0),g=this.get(0,1),x=i.get(0,1),M=this.get(1,0),S=i.get(1,0),T=this.get(1,1),k=i.get(1,1),B=(n+T)*(u+k),Q=(M+T)*u,et=n*(x-k),K=T*(S-u),j=(n+g)*k,dt=B+K-j+(g-T)*(S+k),ot=et+j,pt=Q+K,ne=B-Q+et+(M-n)*(u+x);return e.set(0,0,dt),e.set(0,1,ot),e.set(1,0,pt),e.set(1,1,ne),e}strassen3x3(i){i=tr.checkMatrix(i);let e=new tr(3,3);const n=this.get(0,0),u=this.get(0,1),g=this.get(0,2),x=this.get(1,0),M=this.get(1,1),S=this.get(1,2),T=this.get(2,0),k=this.get(2,1),B=this.get(2,2),Q=i.get(0,0),et=i.get(0,1),K=i.get(0,2),j=i.get(1,0),dt=i.get(1,1),ot=i.get(1,2),pt=i.get(2,0),ne=i.get(2,1),Kt=i.get(2,2),qt=(n-x)*(-et+dt),Nt=(-n+x+M)*(Q-et+dt),Pt=(x+M)*(-Q+et),Ht=n*Q,Ct=(-n+T+k)*(Q-K+ot),V=(-n+T)*(K-ot),st=(T+k)*(-Q+K),It=(-g+k+B)*(dt+pt-ne),mt=(g-B)*(dt-ne),X=g*pt,D=(k+B)*(-pt+ne),W=(-g+M+S)*(ot+pt-Kt),vt=(g-S)*(ot-Kt),yt=(M+S)*(-pt+Kt),At=Ht+X+u*j,I=(n+u+g-x-M-k-B)*dt+Nt+Pt+Ht+It+X+D,P=Ht+Ct+st+(n+u+g-M-S-T-k)*ot+X+W+yt,C=qt+M*(-Q+et+j-dt-ot-pt+Kt)+Nt+Ht+X+W+vt,O=qt+Nt+Pt+Ht+S*ne,ut=X+W+vt+yt+x*K,xt=Ht+Ct+V+k*(-Q+K+j-dt-ot-pt+ne)+It+mt+X,G=It+mt+X+D+T*et,U=Ht+Ct+V+st+B*Kt;return e.set(0,0,At),e.set(0,1,I),e.set(0,2,P),e.set(1,0,C),e.set(1,1,O),e.set(1,2,ut),e.set(2,0,xt),e.set(2,1,G),e.set(2,2,U),e}mmulStrassen(i){i=tr.checkMatrix(i);let e=this.clone(),n=e.rows,u=e.columns,g=i.rows,x=i.columns;function M(k,B,Q){let et=k.rows,K=k.columns;if(et===B&&K===Q)return k;{let j=wr.zeros(B,Q);return j=j.setSubMatrix(k,0,0),j}}u!==g&&console.warn(`Multiplying ${n} x ${u} and ${g} x ${x} matrix: dimensions do not match.`);let S=Math.max(n,g),T=Math.max(u,x);return e=M(e,S,T),function k(B,Q,et,K){if(et<=512||K<=512)return B.mmul(Q);et%2==1&&K%2==1?(B=M(B,et+1,K+1),Q=M(Q,et+1,K+1)):et%2==1?(B=M(B,et+1,K),Q=M(Q,et+1,K)):K%2==1&&(B=M(B,et,K+1),Q=M(Q,et,K+1));let j=parseInt(B.rows/2,10),dt=parseInt(B.columns/2,10),ot=B.subMatrix(0,j-1,0,dt-1),pt=Q.subMatrix(0,j-1,0,dt-1),ne=B.subMatrix(0,j-1,dt,B.columns-1),Kt=Q.subMatrix(0,j-1,dt,Q.columns-1),qt=B.subMatrix(j,B.rows-1,0,dt-1),Nt=Q.subMatrix(j,Q.rows-1,0,dt-1),Pt=B.subMatrix(j,B.rows-1,dt,B.columns-1),Ht=Q.subMatrix(j,Q.rows-1,dt,Q.columns-1),Ct=k(wr.add(ot,Pt),wr.add(pt,Ht),j,dt),V=k(wr.add(qt,Pt),pt,j,dt),st=k(ot,wr.sub(Kt,Ht),j,dt),It=k(Pt,wr.sub(Nt,pt),j,dt),mt=k(wr.add(ot,ne),Ht,j,dt),X=k(wr.sub(qt,ot),wr.add(pt,Kt),j,dt),D=k(wr.sub(ne,Pt),wr.add(Nt,Ht),j,dt),W=wr.add(Ct,It);W.sub(mt),W.add(D);let vt=wr.add(st,mt),yt=wr.add(V,It),At=wr.sub(Ct,V);At.add(st),At.add(X);let I=wr.zeros(2*W.rows,2*W.columns);return I=I.setSubMatrix(W,0,0),I=I.setSubMatrix(vt,W.rows,0),I=I.setSubMatrix(yt,0,W.columns),I=I.setSubMatrix(At,W.rows,W.columns),I.subMatrix(0,et-1,0,K-1)}(e,i=M(i,S,T),S,T)}scaleRows(i={}){if(typeof i!="object")throw new TypeError("options must be an object");const{min:e=0,max:n=1}=i;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(e>=n)throw new RangeError("min must be smaller than max");let u=new tr(this.rows,this.columns);for(let g=0;g<this.rows;g++){const x=this.getRow(g);x.length>0&&we(x,{min:e,max:n,output:x}),u.setRow(g,x)}return u}scaleColumns(i={}){if(typeof i!="object")throw new TypeError("options must be an object");const{min:e=0,max:n=1}=i;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(e>=n)throw new RangeError("min must be smaller than max");let u=new tr(this.rows,this.columns);for(let g=0;g<this.columns;g++){const x=this.getColumn(g);x.length&&we(x,{min:e,max:n,output:x}),u.setColumn(g,x)}return u}flipRows(){const i=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let n=0;n<i;n++){let u=this.get(e,n),g=this.get(e,this.columns-1-n);this.set(e,n,g),this.set(e,this.columns-1-n,u)}return this}flipColumns(){const i=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let n=0;n<i;n++){let u=this.get(n,e),g=this.get(this.rows-1-n,e);this.set(n,e,g),this.set(this.rows-1-n,e,u)}return this}kroneckerProduct(i){i=tr.checkMatrix(i);let e=this.rows,n=this.columns,u=i.rows,g=i.columns,x=new tr(e*u,n*g);for(let M=0;M<e;M++)for(let S=0;S<n;S++)for(let T=0;T<u;T++)for(let k=0;k<g;k++)x.set(u*M+T,g*S+k,this.get(M,S)*i.get(T,k));return x}kroneckerSum(i){if(i=tr.checkMatrix(i),!this.isSquare()||!i.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,n=i.rows,u=this.kroneckerProduct(tr.eye(n,n)),g=tr.eye(e,e).kroneckerProduct(i);return u.add(g)}transpose(){let i=new tr(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)i.set(n,e,this.get(e,n));return i}sortRows(i=on){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(i));return this}sortColumns(i=on){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(i));return this}subMatrix(i,e,n,u){jr(this,i,e,n,u);let g=new tr(e-i+1,u-n+1);for(let x=i;x<=e;x++)for(let M=n;M<=u;M++)g.set(x-i,M-n,this.get(x,M));return g}subMatrixRow(i,e,n){if(e===void 0&&(e=0),n===void 0&&(n=this.columns-1),e>n||e<0||e>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");let u=new tr(i.length,n-e+1);for(let g=0;g<i.length;g++)for(let x=e;x<=n;x++){if(i[g]<0||i[g]>=this.rows)throw new RangeError(`Row index out of range: ${i[g]}`);u.set(g,x-e,this.get(i[g],x))}return u}subMatrixColumn(i,e,n){if(e===void 0&&(e=0),n===void 0&&(n=this.rows-1),e>n||e<0||e>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");let u=new tr(n-e+1,i.length);for(let g=0;g<i.length;g++)for(let x=e;x<=n;x++){if(i[g]<0||i[g]>=this.columns)throw new RangeError(`Column index out of range: ${i[g]}`);u.set(x-e,g,this.get(x,i[g]))}return u}setSubMatrix(i,e,n){if((i=tr.checkMatrix(i)).isEmpty())return this;jr(this,e,e+i.rows-1,n,n+i.columns-1);for(let u=0;u<i.rows;u++)for(let g=0;g<i.columns;g++)this.set(e+u,n+g,i.get(u,g));return this}selection(i,e){(function(u,g){if(!je(g))throw new TypeError("row indices must be an array");for(let x=0;x<g.length;x++)if(g[x]<0||g[x]>=u.rows)throw new RangeError("row indices are out of range")})(this,i),function(u,g){if(!je(g))throw new TypeError("column indices must be an array");for(let x=0;x<g.length;x++)if(g[x]<0||g[x]>=u.columns)throw new RangeError("column indices are out of range")}(this,e);let n=new tr(i.length,e.length);for(let u=0;u<i.length;u++){let g=i[u];for(let x=0;x<e.length;x++){let M=e[x];n.set(u,x,this.get(g,M))}}return n}trace(){let i=Math.min(this.rows,this.columns),e=0;for(let n=0;n<i;n++)e+=this.get(n,n);return e}clone(){let i=new tr(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)i.set(e,n,this.get(e,n));return i}sum(i){switch(i){case"row":return function(e){let n=Lr(e.rows);for(let u=0;u<e.rows;++u)for(let g=0;g<e.columns;++g)n[u]+=e.get(u,g);return n}(this);case"column":return function(e){let n=Lr(e.columns);for(let u=0;u<e.rows;++u)for(let g=0;g<e.columns;++g)n[g]+=e.get(u,g);return n}(this);case void 0:return function(e){let n=0;for(let u=0;u<e.rows;u++)for(let g=0;g<e.columns;g++)n+=e.get(u,g);return n}(this);default:throw new Error(`invalid option: ${i}`)}}product(i){switch(i){case"row":return function(e){let n=Lr(e.rows,1);for(let u=0;u<e.rows;++u)for(let g=0;g<e.columns;++g)n[u]*=e.get(u,g);return n}(this);case"column":return function(e){let n=Lr(e.columns,1);for(let u=0;u<e.rows;++u)for(let g=0;g<e.columns;++g)n[g]*=e.get(u,g);return n}(this);case void 0:return function(e){let n=1;for(let u=0;u<e.rows;u++)for(let g=0;g<e.columns;g++)n*=e.get(u,g);return n}(this);default:throw new Error(`invalid option: ${i}`)}}mean(i){const e=this.sum(i);switch(i){case"row":for(let n=0;n<this.rows;n++)e[n]/=this.columns;return e;case"column":for(let n=0;n<this.columns;n++)e[n]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${i}`)}}variance(i,e={}){if(typeof i=="object"&&(e=i,i=void 0),typeof e!="object")throw new TypeError("options must be an object");const{unbiased:n=!0,mean:u=this.mean(i)}=e;if(typeof n!="boolean")throw new TypeError("unbiased must be a boolean");switch(i){case"row":if(!je(u))throw new TypeError("mean must be an array");return function(g,x,M){const S=g.rows,T=g.columns,k=[];for(let B=0;B<S;B++){let Q=0,et=0,K=0;for(let j=0;j<T;j++)K=g.get(B,j)-M[B],Q+=K,et+=K*K;x?k.push((et-Q*Q/T)/(T-1)):k.push((et-Q*Q/T)/T)}return k}(this,n,u);case"column":if(!je(u))throw new TypeError("mean must be an array");return function(g,x,M){const S=g.rows,T=g.columns,k=[];for(let B=0;B<T;B++){let Q=0,et=0,K=0;for(let j=0;j<S;j++)K=g.get(j,B)-M[B],Q+=K,et+=K*K;x?k.push((et-Q*Q/S)/(S-1)):k.push((et-Q*Q/S)/S)}return k}(this,n,u);case void 0:if(typeof u!="number")throw new TypeError("mean must be a number");return function(g,x,M){const S=g.rows,T=g.columns,k=S*T;let B=0,Q=0,et=0;for(let K=0;K<S;K++)for(let j=0;j<T;j++)et=g.get(K,j)-M,B+=et,Q+=et*et;return x?(Q-B*B/k)/(k-1):(Q-B*B/k)/k}(this,n,u);default:throw new Error(`invalid option: ${i}`)}}standardDeviation(i,e){typeof i=="object"&&(e=i,i=void 0);const n=this.variance(i,e);if(i===void 0)return Math.sqrt(n);for(let u=0;u<n.length;u++)n[u]=Math.sqrt(n[u]);return n}center(i,e={}){if(typeof i=="object"&&(e=i,i=void 0),typeof e!="object")throw new TypeError("options must be an object");const{center:n=this.mean(i)}=e;switch(i){case"row":if(!je(n))throw new TypeError("center must be an array");return function(u,g){for(let x=0;x<u.rows;x++)for(let M=0;M<u.columns;M++)u.set(x,M,u.get(x,M)-g[x])}(this,n),this;case"column":if(!je(n))throw new TypeError("center must be an array");return function(u,g){for(let x=0;x<u.rows;x++)for(let M=0;M<u.columns;M++)u.set(x,M,u.get(x,M)-g[M])}(this,n),this;case void 0:if(typeof n!="number")throw new TypeError("center must be a number");return function(u,g){for(let x=0;x<u.rows;x++)for(let M=0;M<u.columns;M++)u.set(x,M,u.get(x,M)-g)}(this,n),this;default:throw new Error(`invalid option: ${i}`)}}scale(i,e={}){if(typeof i=="object"&&(e=i,i=void 0),typeof e!="object")throw new TypeError("options must be an object");let n=e.scale;switch(i){case"row":if(n===void 0)n=function(u){const g=[];for(let x=0;x<u.rows;x++){let M=0;for(let S=0;S<u.columns;S++)M+=Math.pow(u.get(x,S),2)/(u.columns-1);g.push(Math.sqrt(M))}return g}(this);else if(!je(n))throw new TypeError("scale must be an array");return function(u,g){for(let x=0;x<u.rows;x++)for(let M=0;M<u.columns;M++)u.set(x,M,u.get(x,M)/g[x])}(this,n),this;case"column":if(n===void 0)n=function(u){const g=[];for(let x=0;x<u.columns;x++){let M=0;for(let S=0;S<u.rows;S++)M+=Math.pow(u.get(S,x),2)/(u.rows-1);g.push(Math.sqrt(M))}return g}(this);else if(!je(n))throw new TypeError("scale must be an array");return function(u,g){for(let x=0;x<u.rows;x++)for(let M=0;M<u.columns;M++)u.set(x,M,u.get(x,M)/g[M])}(this,n),this;case void 0:if(n===void 0)n=function(u){const g=u.size-1;let x=0;for(let M=0;M<u.columns;M++)for(let S=0;S<u.rows;S++)x+=Math.pow(u.get(S,M),2)/g;return Math.sqrt(x)}(this);else if(typeof n!="number")throw new TypeError("scale must be a number");return function(u,g){for(let x=0;x<u.rows;x++)for(let M=0;M<u.columns;M++)u.set(x,M,u.get(x,M)/g)}(this,n),this;default:throw new Error(`invalid option: ${i}`)}}toString(i){return Ir(this,i)}}function on(c,i){return c-i}wr.prototype.klass="Matrix",typeof Symbol<"u"&&(wr.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return Ir(this)}),wr.random=wr.rand,wr.randomInt=wr.randInt,wr.diagonal=wr.diag,wr.prototype.diagonal=wr.prototype.diag,wr.identity=wr.eye,wr.prototype.negate=wr.prototype.neg,wr.prototype.tensorProduct=wr.prototype.kroneckerProduct;class tr extends wr{constructor(i,e){if(super(),tr.isMatrix(i))return i.clone();if(Number.isInteger(i)&&i>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let n=0;n<i;n++)this.data.push(new Float64Array(e))}else{if(!je(i))throw new TypeError("First argument must be a positive number or an array");{const n=i;if(typeof(e=(i=n.length)?n[0].length:0)!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let u=0;u<i;u++){if(n[u].length!==e)throw new RangeError("Inconsistent array dimensions");if(!n[u].every(g=>typeof g=="number"))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(n[u]))}}}this.rows=i,this.columns=e}set(i,e,n){return this.data[i][e]=n,this}get(i,e){return this.data[i][e]}removeRow(i){return Nr(this,i),this.data.splice(i,1),this.rows-=1,this}addRow(i,e){return e===void 0&&(e=i,i=this.rows),Nr(this,i,!0),e=Float64Array.from(vr(this,e)),this.data.splice(i,0,e),this.rows+=1,this}removeColumn(i){fr(this,i);for(let e=0;e<this.rows;e++){const n=new Float64Array(this.columns-1);for(let u=0;u<i;u++)n[u]=this.data[e][u];for(let u=i+1;u<this.columns;u++)n[u-1]=this.data[e][u];this.data[e]=n}return this.columns-=1,this}addColumn(i,e){e===void 0&&(e=i,i=this.columns),fr(this,i,!0),e=sn(this,e);for(let n=0;n<this.rows;n++){const u=new Float64Array(this.columns+1);let g=0;for(;g<i;g++)u[g]=this.data[n][g];for(u[g++]=e[n];g<this.columns+1;g++)u[g]=this.data[n][g-1];this.data[n]=u}return this.columns+=1,this}}(function(c,i){c.prototype.add=function(e){return typeof e=="number"?this.addS(e):this.addM(e)},c.prototype.addS=function(e){for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)+e);return this},c.prototype.addM=function(e){if(e=i.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)+e.get(n,u));return this},c.add=function(e,n){return new i(e).add(n)},c.prototype.sub=function(e){return typeof e=="number"?this.subS(e):this.subM(e)},c.prototype.subS=function(e){for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)-e);return this},c.prototype.subM=function(e){if(e=i.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)-e.get(n,u));return this},c.sub=function(e,n){return new i(e).sub(n)},c.prototype.subtract=c.prototype.sub,c.prototype.subtractS=c.prototype.subS,c.prototype.subtractM=c.prototype.subM,c.subtract=c.sub,c.prototype.mul=function(e){return typeof e=="number"?this.mulS(e):this.mulM(e)},c.prototype.mulS=function(e){for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)*e);return this},c.prototype.mulM=function(e){if(e=i.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)*e.get(n,u));return this},c.mul=function(e,n){return new i(e).mul(n)},c.prototype.multiply=c.prototype.mul,c.prototype.multiplyS=c.prototype.mulS,c.prototype.multiplyM=c.prototype.mulM,c.multiply=c.mul,c.prototype.div=function(e){return typeof e=="number"?this.divS(e):this.divM(e)},c.prototype.divS=function(e){for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)/e);return this},c.prototype.divM=function(e){if(e=i.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)/e.get(n,u));return this},c.div=function(e,n){return new i(e).div(n)},c.prototype.divide=c.prototype.div,c.prototype.divideS=c.prototype.divS,c.prototype.divideM=c.prototype.divM,c.divide=c.div,c.prototype.mod=function(e){return typeof e=="number"?this.modS(e):this.modM(e)},c.prototype.modS=function(e){for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)%e);return this},c.prototype.modM=function(e){if(e=i.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)%e.get(n,u));return this},c.mod=function(e,n){return new i(e).mod(n)},c.prototype.modulus=c.prototype.mod,c.prototype.modulusS=c.prototype.modS,c.prototype.modulusM=c.prototype.modM,c.modulus=c.mod,c.prototype.and=function(e){return typeof e=="number"?this.andS(e):this.andM(e)},c.prototype.andS=function(e){for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)&e);return this},c.prototype.andM=function(e){if(e=i.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)&e.get(n,u));return this},c.and=function(e,n){return new i(e).and(n)},c.prototype.or=function(e){return typeof e=="number"?this.orS(e):this.orM(e)},c.prototype.orS=function(e){for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)|e);return this},c.prototype.orM=function(e){if(e=i.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)|e.get(n,u));return this},c.or=function(e,n){return new i(e).or(n)},c.prototype.xor=function(e){return typeof e=="number"?this.xorS(e):this.xorM(e)},c.prototype.xorS=function(e){for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)^e);return this},c.prototype.xorM=function(e){if(e=i.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)^e.get(n,u));return this},c.xor=function(e,n){return new i(e).xor(n)},c.prototype.leftShift=function(e){return typeof e=="number"?this.leftShiftS(e):this.leftShiftM(e)},c.prototype.leftShiftS=function(e){for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)<<e);return this},c.prototype.leftShiftM=function(e){if(e=i.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)<<e.get(n,u));return this},c.leftShift=function(e,n){return new i(e).leftShift(n)},c.prototype.signPropagatingRightShift=function(e){return typeof e=="number"?this.signPropagatingRightShiftS(e):this.signPropagatingRightShiftM(e)},c.prototype.signPropagatingRightShiftS=function(e){for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)>>e);return this},c.prototype.signPropagatingRightShiftM=function(e){if(e=i.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)>>e.get(n,u));return this},c.signPropagatingRightShift=function(e,n){return new i(e).signPropagatingRightShift(n)},c.prototype.rightShift=function(e){return typeof e=="number"?this.rightShiftS(e):this.rightShiftM(e)},c.prototype.rightShiftS=function(e){for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)>>>e);return this},c.prototype.rightShiftM=function(e){if(e=i.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,this.get(n,u)>>>e.get(n,u));return this},c.rightShift=function(e,n){return new i(e).rightShift(n)},c.prototype.zeroFillRightShift=c.prototype.rightShift,c.prototype.zeroFillRightShiftS=c.prototype.rightShiftS,c.prototype.zeroFillRightShiftM=c.prototype.rightShiftM,c.zeroFillRightShift=c.rightShift,c.prototype.not=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,~this.get(e,n));return this},c.not=function(e){return new i(e).not()},c.prototype.abs=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.abs(this.get(e,n)));return this},c.abs=function(e){return new i(e).abs()},c.prototype.acos=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.acos(this.get(e,n)));return this},c.acos=function(e){return new i(e).acos()},c.prototype.acosh=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.acosh(this.get(e,n)));return this},c.acosh=function(e){return new i(e).acosh()},c.prototype.asin=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.asin(this.get(e,n)));return this},c.asin=function(e){return new i(e).asin()},c.prototype.asinh=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.asinh(this.get(e,n)));return this},c.asinh=function(e){return new i(e).asinh()},c.prototype.atan=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.atan(this.get(e,n)));return this},c.atan=function(e){return new i(e).atan()},c.prototype.atanh=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.atanh(this.get(e,n)));return this},c.atanh=function(e){return new i(e).atanh()},c.prototype.cbrt=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.cbrt(this.get(e,n)));return this},c.cbrt=function(e){return new i(e).cbrt()},c.prototype.ceil=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.ceil(this.get(e,n)));return this},c.ceil=function(e){return new i(e).ceil()},c.prototype.clz32=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.clz32(this.get(e,n)));return this},c.clz32=function(e){return new i(e).clz32()},c.prototype.cos=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.cos(this.get(e,n)));return this},c.cos=function(e){return new i(e).cos()},c.prototype.cosh=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.cosh(this.get(e,n)));return this},c.cosh=function(e){return new i(e).cosh()},c.prototype.exp=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.exp(this.get(e,n)));return this},c.exp=function(e){return new i(e).exp()},c.prototype.expm1=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.expm1(this.get(e,n)));return this},c.expm1=function(e){return new i(e).expm1()},c.prototype.floor=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.floor(this.get(e,n)));return this},c.floor=function(e){return new i(e).floor()},c.prototype.fround=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.fround(this.get(e,n)));return this},c.fround=function(e){return new i(e).fround()},c.prototype.log=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.log(this.get(e,n)));return this},c.log=function(e){return new i(e).log()},c.prototype.log1p=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.log1p(this.get(e,n)));return this},c.log1p=function(e){return new i(e).log1p()},c.prototype.log10=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.log10(this.get(e,n)));return this},c.log10=function(e){return new i(e).log10()},c.prototype.log2=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.log2(this.get(e,n)));return this},c.log2=function(e){return new i(e).log2()},c.prototype.round=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.round(this.get(e,n)));return this},c.round=function(e){return new i(e).round()},c.prototype.sign=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.sign(this.get(e,n)));return this},c.sign=function(e){return new i(e).sign()},c.prototype.sin=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.sin(this.get(e,n)));return this},c.sin=function(e){return new i(e).sin()},c.prototype.sinh=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.sinh(this.get(e,n)));return this},c.sinh=function(e){return new i(e).sinh()},c.prototype.sqrt=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.sqrt(this.get(e,n)));return this},c.sqrt=function(e){return new i(e).sqrt()},c.prototype.tan=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.tan(this.get(e,n)));return this},c.tan=function(e){return new i(e).tan()},c.prototype.tanh=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.tanh(this.get(e,n)));return this},c.tanh=function(e){return new i(e).tanh()},c.prototype.trunc=function(){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.trunc(this.get(e,n)));return this},c.trunc=function(e){return new i(e).trunc()},c.pow=function(e,n){return new i(e).pow(n)},c.prototype.pow=function(e){return typeof e=="number"?this.powS(e):this.powM(e)},c.prototype.powS=function(e){for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,Math.pow(this.get(n,u),e));return this},c.prototype.powM=function(e){if(e=i.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let n=0;n<this.rows;n++)for(let u=0;u<this.columns;u++)this.set(n,u,Math.pow(this.get(n,u),e.get(n,u)));return this}})(wr,tr);class pa extends wr{constructor(i){super(),this.data=i,this.rows=i.length,this.columns=i[0].length}set(i,e,n){return this.data[i][e]=n,this}get(i,e){return this.data[i][e]}}function Uo(c,i){let e=0;return Math.abs(c)>Math.abs(i)?(e=i/c,Math.abs(c)*Math.sqrt(1+e*e)):i!==0?(e=c/i,Math.abs(i)*Math.sqrt(1+e*e)):0}class _s{constructor(i,e={}){if((i=pa.checkMatrix(i)).isEmpty())throw new Error("Matrix must be non-empty");let n=i.rows,u=i.columns;const{computeLeftSingularVectors:g=!0,computeRightSingularVectors:x=!0,autoTranspose:M=!1}=e;let S,T=Boolean(g),k=Boolean(x),B=!1;if(n<u)if(M){S=i.transpose(),n=S.rows,u=S.columns,B=!0;let V=T;T=k,k=V}else S=i.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else S=i.clone();let Q=Math.min(n,u),et=Math.min(n+1,u),K=new Float64Array(et),j=new tr(n,Q),dt=new tr(u,u),ot=new Float64Array(u),pt=new Float64Array(n),ne=new Float64Array(et);for(let V=0;V<et;V++)ne[V]=V;let Kt=Math.min(n-1,u),qt=Math.max(0,Math.min(u-2,n)),Nt=Math.max(Kt,qt);for(let V=0;V<Nt;V++){if(V<Kt){K[V]=0;for(let st=V;st<n;st++)K[V]=Uo(K[V],S.get(st,V));if(K[V]!==0){S.get(V,V)<0&&(K[V]=-K[V]);for(let st=V;st<n;st++)S.set(st,V,S.get(st,V)/K[V]);S.set(V,V,S.get(V,V)+1)}K[V]=-K[V]}for(let st=V+1;st<u;st++){if(V<Kt&&K[V]!==0){let It=0;for(let mt=V;mt<n;mt++)It+=S.get(mt,V)*S.get(mt,st);It=-It/S.get(V,V);for(let mt=V;mt<n;mt++)S.set(mt,st,S.get(mt,st)+It*S.get(mt,V))}ot[st]=S.get(V,st)}if(T&&V<Kt)for(let st=V;st<n;st++)j.set(st,V,S.get(st,V));if(V<qt){ot[V]=0;for(let st=V+1;st<u;st++)ot[V]=Uo(ot[V],ot[st]);if(ot[V]!==0){ot[V+1]<0&&(ot[V]=0-ot[V]);for(let st=V+1;st<u;st++)ot[st]/=ot[V];ot[V+1]+=1}if(ot[V]=-ot[V],V+1<n&&ot[V]!==0){for(let st=V+1;st<n;st++)pt[st]=0;for(let st=V+1;st<n;st++)for(let It=V+1;It<u;It++)pt[st]+=ot[It]*S.get(st,It);for(let st=V+1;st<u;st++){let It=-ot[st]/ot[V+1];for(let mt=V+1;mt<n;mt++)S.set(mt,st,S.get(mt,st)+It*pt[mt])}}if(k)for(let st=V+1;st<u;st++)dt.set(st,V,ot[st])}}let Pt=Math.min(u,n+1);if(Kt<u&&(K[Kt]=S.get(Kt,Kt)),n<Pt&&(K[Pt-1]=0),qt+1<Pt&&(ot[qt]=S.get(qt,Pt-1)),ot[Pt-1]=0,T){for(let V=Kt;V<Q;V++){for(let st=0;st<n;st++)j.set(st,V,0);j.set(V,V,1)}for(let V=Kt-1;V>=0;V--)if(K[V]!==0){for(let st=V+1;st<Q;st++){let It=0;for(let mt=V;mt<n;mt++)It+=j.get(mt,V)*j.get(mt,st);It=-It/j.get(V,V);for(let mt=V;mt<n;mt++)j.set(mt,st,j.get(mt,st)+It*j.get(mt,V))}for(let st=V;st<n;st++)j.set(st,V,-j.get(st,V));j.set(V,V,1+j.get(V,V));for(let st=0;st<V-1;st++)j.set(st,V,0)}else{for(let st=0;st<n;st++)j.set(st,V,0);j.set(V,V,1)}}if(k)for(let V=u-1;V>=0;V--){if(V<qt&&ot[V]!==0)for(let st=V+1;st<u;st++){let It=0;for(let mt=V+1;mt<u;mt++)It+=dt.get(mt,V)*dt.get(mt,st);It=-It/dt.get(V+1,V);for(let mt=V+1;mt<u;mt++)dt.set(mt,st,dt.get(mt,st)+It*dt.get(mt,V))}for(let st=0;st<u;st++)dt.set(st,V,0);dt.set(V,V,1)}let Ht=Pt-1,Ct=Number.EPSILON;for(;Pt>0;){let V,st;for(V=Pt-2;V>=-1&&V!==-1;V--){const It=Number.MIN_VALUE+Ct*Math.abs(K[V]+Math.abs(K[V+1]));if(Math.abs(ot[V])<=It||Number.isNaN(ot[V])){ot[V]=0;break}}if(V===Pt-2)st=4;else{let It;for(It=Pt-1;It>=V&&It!==V;It--){let mt=(It!==Pt?Math.abs(ot[It]):0)+(It!==V+1?Math.abs(ot[It-1]):0);if(Math.abs(K[It])<=Ct*mt){K[It]=0;break}}It===V?st=3:It===Pt-1?st=1:(st=2,V=It)}switch(V++,st){case 1:{let It=ot[Pt-2];ot[Pt-2]=0;for(let mt=Pt-2;mt>=V;mt--){let X=Uo(K[mt],It),D=K[mt]/X,W=It/X;if(K[mt]=X,mt!==V&&(It=-W*ot[mt-1],ot[mt-1]=D*ot[mt-1]),k)for(let vt=0;vt<u;vt++)X=D*dt.get(vt,mt)+W*dt.get(vt,Pt-1),dt.set(vt,Pt-1,-W*dt.get(vt,mt)+D*dt.get(vt,Pt-1)),dt.set(vt,mt,X)}break}case 2:{let It=ot[V-1];ot[V-1]=0;for(let mt=V;mt<Pt;mt++){let X=Uo(K[mt],It),D=K[mt]/X,W=It/X;if(K[mt]=X,It=-W*ot[mt],ot[mt]=D*ot[mt],T)for(let vt=0;vt<n;vt++)X=D*j.get(vt,mt)+W*j.get(vt,V-1),j.set(vt,V-1,-W*j.get(vt,mt)+D*j.get(vt,V-1)),j.set(vt,mt,X)}break}case 3:{const It=Math.max(Math.abs(K[Pt-1]),Math.abs(K[Pt-2]),Math.abs(ot[Pt-2]),Math.abs(K[V]),Math.abs(ot[V])),mt=K[Pt-1]/It,X=K[Pt-2]/It,D=ot[Pt-2]/It,W=K[V]/It,vt=ot[V]/It,yt=((X+mt)*(X-mt)+D*D)/2,At=mt*D*(mt*D);let I=0;yt===0&&At===0||(I=yt<0?0-Math.sqrt(yt*yt+At):Math.sqrt(yt*yt+At),I=At/(yt+I));let P=(W+mt)*(W-mt)+I,C=W*vt;for(let O=V;O<Pt-1;O++){let ut=Uo(P,C);ut===0&&(ut=Number.MIN_VALUE);let xt=P/ut,G=C/ut;if(O!==V&&(ot[O-1]=ut),P=xt*K[O]+G*ot[O],ot[O]=xt*ot[O]-G*K[O],C=G*K[O+1],K[O+1]=xt*K[O+1],k)for(let U=0;U<u;U++)ut=xt*dt.get(U,O)+G*dt.get(U,O+1),dt.set(U,O+1,-G*dt.get(U,O)+xt*dt.get(U,O+1)),dt.set(U,O,ut);if(ut=Uo(P,C),ut===0&&(ut=Number.MIN_VALUE),xt=P/ut,G=C/ut,K[O]=ut,P=xt*ot[O]+G*K[O+1],K[O+1]=-G*ot[O]+xt*K[O+1],C=G*ot[O+1],ot[O+1]=xt*ot[O+1],T&&O<n-1)for(let U=0;U<n;U++)ut=xt*j.get(U,O)+G*j.get(U,O+1),j.set(U,O+1,-G*j.get(U,O)+xt*j.get(U,O+1)),j.set(U,O,ut)}ot[Pt-2]=P;break}case 4:if(K[V]<=0&&(K[V]=K[V]<0?-K[V]:0,k))for(let It=0;It<=Ht;It++)dt.set(It,V,-dt.get(It,V));for(;V<Ht&&!(K[V]>=K[V+1]);){let It=K[V];if(K[V]=K[V+1],K[V+1]=It,k&&V<u-1)for(let mt=0;mt<u;mt++)It=dt.get(mt,V+1),dt.set(mt,V+1,dt.get(mt,V)),dt.set(mt,V,It);if(T&&V<n-1)for(let mt=0;mt<n;mt++)It=j.get(mt,V+1),j.set(mt,V+1,j.get(mt,V)),j.set(mt,V,It);V++}Pt--}}if(B){let V=dt;dt=j,j=V}this.m=n,this.n=u,this.s=K,this.U=j,this.V=dt}solve(i){let e=i,n=this.threshold,u=this.s.length,g=tr.zeros(u,u);for(let Q=0;Q<u;Q++)Math.abs(this.s[Q])<=n?g.set(Q,Q,0):g.set(Q,Q,1/this.s[Q]);let x=this.U,M=this.rightSingularVectors,S=M.mmul(g),T=M.rows,k=x.rows,B=tr.zeros(T,k);for(let Q=0;Q<T;Q++)for(let et=0;et<k;et++){let K=0;for(let j=0;j<u;j++)K+=S.get(Q,j)*x.get(et,j);B.set(Q,et,K)}return B.mmul(e)}solveForDiagonal(i){return this.solve(tr.diag(i))}inverse(){let i=this.V,e=this.threshold,n=i.rows,u=i.columns,g=new tr(n,this.s.length);for(let k=0;k<n;k++)for(let B=0;B<u;B++)Math.abs(this.s[B])>e&&g.set(k,B,i.get(k,B)/this.s[B]);let x=this.U,M=x.rows,S=x.columns,T=new tr(n,M);for(let k=0;k<n;k++)for(let B=0;B<M;B++){let Q=0;for(let et=0;et<S;et++)Q+=g.get(k,et)*x.get(B,et);T.set(k,B,Q)}return T}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let i=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,n=this.s;for(let u=0,g=n.length;u<g;u++)n[u]>i&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return tr.diag(this.s)}}var Ga={center:[0,0],linkDistance:50},as=function(){function c(i){i===void 0&&(i={}),this.options=i,this.id="mds",this.options=z(z({},Ga),i)}return c.prototype.execute=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return[2,this.genericMDSLayout(!1,i,e)]})})},c.prototype.assign=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return this.genericMDSLayout(!0,i,e),[2]})})},c.prototype.genericMDSLayout=function(i,e,n){return Mt(this,void 0,void 0,function(){var u,g,x,M,S,T,k,B,Q,et,K,j;return te(this,function(dt){return u=z(z({},this.options),n),g=u.center,x=g===void 0?[0,0]:g,M=u.linkDistance,S=M===void 0?50:M,T=e.getAllNodes(),k=e.getAllEdges(),(T==null?void 0:T.length)&&T.length!==1?(B=Wr({nodes:T,edges:k},!1),Q=yr(B),ss(Q),et=cn(Q,S),K=Y(et),j=[],K.forEach(function(ot,pt){var ne=Xr(T[pt]);ne.data.x=ot[0]+x[0],ne.data.y=ot[1]+x[1],j.push(ne)}),i&&j.forEach(function(ot){return e.mergeNodeData(ot.id,{x:ot.data.x,y:ot.data.y})}),[2,{nodes:j,edges:k}]):[2,io(e,i,x)]})})},c}(),ss=function(c){var i=-999999;c.forEach(function(e){e.forEach(function(n){n!==1/0&&i<n&&(i=n)})}),c.forEach(function(e,n){e.forEach(function(u,g){u===1/0&&(c[n][g]=i)})})},Y=function(c){var i=tr.mul(tr.pow(c,2),-.5),e=i.mean("row"),n=i.mean("column"),u=i.mean();i.add(u).subRowVector(e).subColumnVector(n);var g=new _s(i),x=tr.sqrt(g.diagonalMatrix).diagonal();return g.leftSingularVectors.toJSON().map(function(M){return tr.mul([M],[x]).toJSON()[0].splice(0,2)})},Tt={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},ee=function(c,i,e,n,u,g){i.forEach(function(x,M){e[M]={x:0,y:0},i.forEach(function(S,T){if(M!==T&&u[M]===u[T]){var k=x.x-S.x,B=x.y-S.y,Q=Math.sqrt(k*k+B*B);if(Q===0){Q=1;var et=M>T?1:-1;k=.01*et,B=.01*et}if(Q<g(c[M])/2+g(c[T])/2){var K=n*n/Q;e[M].x+=k/Q*K,e[M].y+=B/Q*K}}})})},Ae=function(c,i,e,n,u,g,x,M){var S=g||x/10;return n&&i.forEach(function(T,k){var B=c[k].x-c[u].x,Q=c[k].y-c[u].y,et=Math.sqrt(B*B+Q*Q),K=Q/et,j=-B/et,dt=Math.sqrt(T.x*T.x+T.y*T.y),ot=Math.acos((K*T.x+j*T.y)/dt);ot>Math.PI/2&&(ot-=Math.PI/2,K*=-1,j*=-1);var pt=Math.cos(ot)*dt;T.x=K*pt,T.y=j*pt}),c.forEach(function(T,k){if(k!==u){var B=Math.sqrt(i[k].x*i[k].x+i[k].y*i[k].y);if(B>0&&k!==u){var Q=Math.min(S*(e/800),B);if(T.x+=i[k].x/B*Q,T.y+=i[k].y/B*Q,n){var et=T.x-c[u].x,K=T.y-c[u].y,j=Math.sqrt(et*et+K*K);et=et/j*M[k],K=K/j*M[k],T.x=c[u].x+et,T.y=c[u].y+K}}}}),c},Se={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},Re=function(){function c(i){i===void 0&&(i={}),this.options=i,this.id="radial",this.options=z(z({},Se),i)}return c.prototype.execute=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return[2,this.genericRadialLayout(!1,i,e)]})})},c.prototype.assign=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return this.genericRadialLayout(!0,i,e),[2]})})},c.prototype.genericRadialLayout=function(i,e,n){return Mt(this,void 0,void 0,function(){var u,g,x,M,S,T,k,B,Q,et,K,j,dt,ot,pt,ne,Kt,qt,Nt,Pt,Ht,Ct,V,st,It,mt,X,D,W,vt,yt,At,I,P,C,O,ut,xt,G,U,lt,it,ft;return te(this,function(Rt){if(u=z(z({},this.options),n),g=u.width,x=u.height,M=u.center,S=u.focusNode,T=u.unitRadius,k=u.nodeSize,B=u.nodeSpacing,Q=u.strictRadial,et=u.preventOverlap,K=u.maxPreventOverlapIteration,j=u.sortBy,dt=u.linkDistance,ot=dt===void 0?50:dt,pt=u.sortStrength,ne=pt===void 0?10:pt,Kt=u.maxIteration,qt=Kt===void 0?1e3:Kt,Nt=e.getAllNodes(),Pt=e.getAllEdges(),Ht=g||typeof window>"u"?g:window.innerWidth,Ct=x||typeof window>"u"?x:window.innerHeight,V=M||[Ht/2,Ct/2],!(Nt!=null&&Nt.length)||Nt.length===1)return[2,io(e,i,V)];if(st=Nt[0],Zn(S)){for(It=0;It<Nt.length;It++)if(Nt[It].id===S){st=Nt[It];break}}else st=S||Nt[0];return mt=Ve(Nt,st.id),X=Wr({nodes:Nt,edges:Pt},!1),D=yr(X),W=Oe(D,mt),Pe(D,mt,W+1),vt=D[mt],yt=Ht-V[0]>V[0]?V[0]:Ht-V[0],At=Ct-V[1]>V[1]?V[1]:Ct-V[1],yt===0&&(yt=Ht/2),At===0&&(At=Ct/2),I=Math.min(yt,At),P=Math.max.apply(Math,he([],ue(vt))),C=[],O=T||I/P,vt.forEach(function(Gt,ht){C[ht]=Gt*O}),ut=_e(Nt,D,ot,C,O,j,ne),xt=He(ut),G=function(Gt,ht,St){try{var _t=tr.mul(tr.pow(ht,2),-.5),ae=_t.mean("row"),jt=_t.mean("column"),Ft=_t.mean();_t.add(Ft).subRowVector(ae).subColumnVector(jt);var se=new _s(_t),Vt=tr.sqrt(se.diagonalMatrix).diagonal();return se.leftSingularVectors.toJSON().map(function(Ee){return tr.mul([Ee],[Vt]).toJSON()[0].splice(0,Gt)})}catch{for(var J=[],Et=0;Et<ht.length;Et++){var kt=Math.random()*St,oe=Math.random()*St;J.push([kt,oe])}return J}}(ot,ut,ot),U=G.map(function(Gt){var ht=ue(Gt,2),St=ht[0],_t=ht[1];return{x:(isNaN(St)?Math.random()*ot:St)-G[mt][0],y:(isNaN(_t)?Math.random()*ot:_t)-G[mt][1]}}),this.run(qt,U,xt,ut,C,mt),et&&(lt=Kn(k,B),it={nodes:Nt,nodeSizeFunc:lt,positions:U,radii:C,height:Ct,width:Ht,strictRadial:Boolean(Q),focusIdx:mt,iterations:K||200,k:U.length/4.5},U=function(Gt,ht){for(var St=z(z({},Tt),ht),_t=St.positions,ae=St.iterations,jt=St.width,Ft=St.k,se=St.speed,Vt=se===void 0?100:se,J=St.strictRadial,Et=St.focusIdx,kt=St.radii,oe=kt===void 0?[]:kt,Ee=St.nodeSizeFunc,Ie=Gt.getAllNodes(),Ue=[],hr=jt/10,pr=0;pr<ae;pr++)_t.forEach(function(Mr,Er){Ue[Er]={x:0,y:0}}),ee(Ie,_t,Ue,Ft,oe,Ee),Ae(_t,Ue,Vt,J,Et,hr,jt,oe);return _t}(e,it)),ft=[],U.forEach(function(Gt,ht){var St=Xr(Nt[ht]);St.data.x=Gt.x+V[0],St.data.y=Gt.y+V[1],ft.push(St)}),i&&ft.forEach(function(Gt){return e.mergeNodeData(Gt.id,{x:Gt.data.x,y:Gt.data.y})}),[2,{nodes:ft,edges:Pt}]})})},c.prototype.run=function(i,e,n,u,g,x){for(var M=0;M<=i;M++){var S=M/i;this.oneIteration(S,e,g,u,n,x)}},c.prototype.oneIteration=function(i,e,n,u,g,x){var M=1-i;e.forEach(function(S,T){var k=Tn(S,{x:0,y:0}),B=k===0?0:1/k;if(T!==x){var Q=0,et=0,K=0;e.forEach(function(dt,ot){if(T!==ot){var pt=Tn(S,dt),ne=pt===0?0:1/pt,Kt=u[ot][T];K+=g[T][ot],Q+=g[T][ot]*(dt.x+Kt*(S.x-dt.x)*ne),et+=g[T][ot]*(dt.y+Kt*(S.y-dt.y)*ne)}});var j=n[T]===0?0:1/n[T];K*=M,K+=i*j*j,Q*=M,Q+=i*j*S.x*B,S.x=Q/K,et*=M,et+=i*j*S.y*B,S.y=et/K}})},c}(),_e=function(c,i,e,n,u,g,x){if(!c)return[];var M=[];if(i){var S={};i.forEach(function(T,k){var B=[];T.forEach(function(Q,et){var K,j;if(k===et)B.push(0);else if(n[k]===n[et])if(g==="data")B.push(Q*(Math.abs(k-et)*x)/(n[k]/u));else if(g){var dt=void 0,ot=void 0;if(S[c[k].id])dt=S[c[k].id];else{var pt=(g==="id"?c[k].id:(K=c[k].data)===null||K===void 0?void 0:K[g])||0;dt=Zn(pt)?pt.charCodeAt(0):pt,S[c[k].id]=dt}S[c[et].id]?ot=S[c[et].id]:(pt=(g==="id"?c[et].id:(j=c[et].data)===null||j===void 0?void 0:j[g])||0,ot=Zn(pt)?pt.charCodeAt(0):pt,S[c[et].id]=ot),B.push(Q*(Math.abs(dt-ot)*x)/(n[k]/u))}else B.push(Q*e/(n[k]/u));else{var ne=(e+u)/2;B.push(Q*ne)}}),M.push(B)})}return M},He=function(c){for(var i=c.length,e=c[0].length,n=[],u=0;u<i;u++){for(var g=[],x=0;x<e;x++)c[u][x]!==0?g.push(1/(c[u][x]*c[u][x])):g.push(0);n.push(g)}return n},Ve=function(c,i){var e=-1;return c.forEach(function(n,u){n.id===i&&(e=u)}),Math.max(e,0)},Pe=function(c,i,e){for(var n=c.length,u=0;u<n;u++)if(c[i][u]===1/0){c[i][u]=e,c[u][i]=e;for(var g=0;g<n;g++)c[u][g]!==1/0&&c[i][g]===1/0&&(c[i][g]=e+c[u][g],c[g][i]=e+c[u][g])}for(u=0;u<n;u++)if(u!==i){for(g=0;g<n;g++)if(c[u][g]===1/0){var x=Math.abs(c[i][u]-c[i][g]);x=x===0?1:x,c[u][g]=x}}},Oe=function(c,i){for(var e=0,n=0;n<c[i].length;n++)c[i][n]!==1/0&&(e=c[i][n]>e?c[i][n]:e);return e},We={center:[0,0],width:300,height:300},nr=function(){function c(i){i===void 0&&(i={}),this.options=i,this.id="random",this.options=z(z({},We),i)}return c.prototype.execute=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return[2,this.genericRandomLayout(!1,i,e)]})})},c.prototype.assign=function(i,e){return Mt(this,void 0,void 0,function(){return te(this,function(n){return this.genericRandomLayout(!0,i,e),[2]})})},c.prototype.genericRandomLayout=function(i,e,n){return Mt(this,void 0,void 0,function(){var u,g,x,M,S,T,k,B,Q;return te(this,function(et){return u=z(z({},this.options),n),g=u.center,x=u.width,M=u.height,S=e.getAllNodes(),T=x||typeof window>"u"?x:window.innerWidth,k=M||typeof window>"u"?M:window.innerHeight,B=g||[T/2,k/2],Q=[],S&&S.forEach(function(K){Q.push({id:K.id,data:{x:.9*(Math.random()-.5)*T+B[0],y:.9*(Math.random()-.5)*k+B[1]}})}),i&&Q.forEach(function(K){return e.mergeNodeData(K.id,{x:K.data.x,y:K.data.y})}),[2,{nodes:Q,edges:e.getAllEdges()}]})})},c}(),or={circular:Ao,concentric:Hn,mds:as,random:nr,grid:ke,radial:Re,force:Jt,d3force:Da,fruchterman:ce,forceAtlas2:ve,dagre:L};function gr(c,i){or[c]=i}function cr(c){return!!c.tick&&!!c.stop}})();var w=f.ul,m=f.jE,E=f.qR,R=function(){return R=Object.assign||function(v){for(var Bt,z=1,Lt=arguments.length;z<Lt;z++)for(var Mt in Bt=arguments[z])Object.prototype.hasOwnProperty.call(Bt,Mt)&&(v[Mt]=Bt[Mt]);return v},R.apply(this,arguments)};function H(v,Bt,z,Lt){return new(z||(z=Promise))(function(Mt,te){function ue(ye){try{pe(Lt.next(ye))}catch(fe){te(fe)}}function he(ye){try{pe(Lt.throw(ye))}catch(fe){te(fe)}}function pe(ye){var fe;ye.done?Mt(ye.value):(fe=ye.value,fe instanceof z?fe:new z(function(Je){Je(fe)})).then(ue,he)}pe((Lt=Lt.apply(v,Bt||[])).next())})}function gt(v,Bt){var z,Lt,Mt,te,ue={label:0,sent:function(){if(1&Mt[0])throw Mt[1];return Mt[1]},trys:[],ops:[]};return te={next:he(0),throw:he(1),return:he(2)},typeof Symbol=="function"&&(te[Symbol.iterator]=function(){return this}),te;function he(pe){return function(ye){return function(fe){if(z)throw new TypeError("Generator is already executing.");for(;te&&(te=0,fe[0]&&(ue=0)),ue;)try{if(z=1,Lt&&(Mt=2&fe[0]?Lt.return:fe[0]?Lt.throw||((Mt=Lt.return)&&Mt.call(Lt),0):Lt.next)&&!(Mt=Mt.call(Lt,fe[1])).done)return Mt;switch(Lt=0,Mt&&(fe=[2&fe[0],Mt.value]),fe[0]){case 0:case 1:Mt=fe;break;case 4:return ue.label++,{value:fe[1],done:!1};case 5:ue.label++,Lt=fe[1],fe=[0];continue;case 7:fe=ue.ops.pop(),ue.trys.pop();continue;default:if(!((Mt=(Mt=ue.trys).length>0&&Mt[Mt.length-1])||fe[0]!==6&&fe[0]!==2)){ue=0;continue}if(fe[0]===3&&(!Mt||fe[1]>Mt[0]&&fe[1]<Mt[3])){ue.label=fe[1];break}if(fe[0]===6&&ue.label<Mt[1]){ue.label=Mt[1],Mt=fe;break}if(Mt&&ue.label<Mt[2]){ue.label=Mt[2],ue.ops.push(fe);break}Mt[2]&&ue.ops.pop(),ue.trys.pop();continue}fe=Bt.call(v,ue)}catch(Je){fe=[6,Je],Lt=0}finally{z=Mt=0}if(5&fe[0])throw fe[1];return{value:fe[0]?fe[1]:void 0,done:!0}}([pe,ye])}}}function Ut(v,Bt,z,Lt,Mt,te,ue){try{var he=v[te](ue),pe=he.value}catch(ye){return void z(ye)}he.done?Bt(pe):Promise.resolve(pe).then(Lt,Mt)}function Qt(v){return function(){var Bt=this,z=arguments;return new Promise(function(Lt,Mt){var te=v.apply(Bt,z);function ue(pe){Ut(te,Lt,Mt,ue,he,"next",pe)}function he(pe){Ut(te,Lt,Mt,ue,he,"throw",pe)}ue(void 0)})}}function Zt(v){return Zt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Bt){return typeof Bt}:function(Bt){return Bt&&typeof Symbol=="function"&&Bt.constructor===Symbol&&Bt!==Symbol.prototype?"symbol":typeof Bt},Zt(v)}function be(v){var Bt=function(z,Lt){if(Zt(z)!=="object"||z===null)return z;var Mt=z[Symbol.toPrimitive];if(Mt!==void 0){var te=Mt.call(z,"string");if(Zt(te)!=="object")return te;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(z)}(v);return Zt(Bt)==="symbol"?Bt:String(Bt)}function ie(v,Bt,z){return(Bt=be(Bt))in v?Object.defineProperty(v,Bt,{value:z,enumerable:!0,configurable:!0,writable:!0}):v[Bt]=z,v}function Ze(v,Bt){if(!(v instanceof Bt))throw new TypeError("Cannot call a class as a function")}function me(v,Bt){for(var z=0;z<Bt.length;z++){var Lt=Bt[z];Lt.enumerable=Lt.enumerable||!1,Lt.configurable=!0,"value"in Lt&&(Lt.writable=!0),Object.defineProperty(v,be(Lt.key),Lt)}}function ze(v,Bt,z){return Bt&&me(v.prototype,Bt),z&&me(v,z),Object.defineProperty(v,"prototype",{writable:!1}),v}var re,ir=Un(922),sr=Un.n(ir),br=Un(224),qr=Un.n(br),$e=Un(589),Xe=Un.n($e),le=Un(279),Pr=Un.n(le),Yn=1;function at(){return Yn++}(function(v){v[v.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",v[v.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",v[v.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",v[v.POINTS=0]="POINTS",v[v.LINES=1]="LINES",v[v.LINE_LOOP=2]="LINE_LOOP",v[v.LINE_STRIP=3]="LINE_STRIP",v[v.TRIANGLES=4]="TRIANGLES",v[v.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",v[v.TRIANGLE_FAN=6]="TRIANGLE_FAN",v[v.ZERO=0]="ZERO",v[v.ONE=1]="ONE",v[v.SRC_COLOR=768]="SRC_COLOR",v[v.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",v[v.SRC_ALPHA=770]="SRC_ALPHA",v[v.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",v[v.DST_ALPHA=772]="DST_ALPHA",v[v.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",v[v.DST_COLOR=774]="DST_COLOR",v[v.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",v[v.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",v[v.FUNC_ADD=32774]="FUNC_ADD",v[v.BLEND_EQUATION=32777]="BLEND_EQUATION",v[v.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",v[v.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",v[v.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",v[v.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",v[v.MAX_EXT=32776]="MAX_EXT",v[v.MIN_EXT=32775]="MIN_EXT",v[v.BLEND_DST_RGB=32968]="BLEND_DST_RGB",v[v.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",v[v.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",v[v.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",v[v.CONSTANT_COLOR=32769]="CONSTANT_COLOR",v[v.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",v[v.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",v[v.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",v[v.BLEND_COLOR=32773]="BLEND_COLOR",v[v.ARRAY_BUFFER=34962]="ARRAY_BUFFER",v[v.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",v[v.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",v[v.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",v[v.STREAM_DRAW=35040]="STREAM_DRAW",v[v.STATIC_DRAW=35044]="STATIC_DRAW",v[v.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",v[v.BUFFER_SIZE=34660]="BUFFER_SIZE",v[v.BUFFER_USAGE=34661]="BUFFER_USAGE",v[v.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",v[v.FRONT=1028]="FRONT",v[v.BACK=1029]="BACK",v[v.FRONT_AND_BACK=1032]="FRONT_AND_BACK",v[v.CULL_FACE=2884]="CULL_FACE",v[v.BLEND=3042]="BLEND",v[v.DITHER=3024]="DITHER",v[v.STENCIL_TEST=2960]="STENCIL_TEST",v[v.DEPTH_TEST=2929]="DEPTH_TEST",v[v.SCISSOR_TEST=3089]="SCISSOR_TEST",v[v.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",v[v.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",v[v.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",v[v.NO_ERROR=0]="NO_ERROR",v[v.INVALID_ENUM=1280]="INVALID_ENUM",v[v.INVALID_VALUE=1281]="INVALID_VALUE",v[v.INVALID_OPERATION=1282]="INVALID_OPERATION",v[v.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",v[v.CW=2304]="CW",v[v.CCW=2305]="CCW",v[v.LINE_WIDTH=2849]="LINE_WIDTH",v[v.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",v[v.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",v[v.CULL_FACE_MODE=2885]="CULL_FACE_MODE",v[v.FRONT_FACE=2886]="FRONT_FACE",v[v.DEPTH_RANGE=2928]="DEPTH_RANGE",v[v.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",v[v.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",v[v.DEPTH_FUNC=2932]="DEPTH_FUNC",v[v.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",v[v.STENCIL_FUNC=2962]="STENCIL_FUNC",v[v.STENCIL_FAIL=2964]="STENCIL_FAIL",v[v.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",v[v.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",v[v.STENCIL_REF=2967]="STENCIL_REF",v[v.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",v[v.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",v[v.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",v[v.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",v[v.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",v[v.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",v[v.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",v[v.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",v[v.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",v[v.VIEWPORT=2978]="VIEWPORT",v[v.SCISSOR_BOX=3088]="SCISSOR_BOX",v[v.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",v[v.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",v[v.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",v[v.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",v[v.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",v[v.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",v[v.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",v[v.RED_BITS=3410]="RED_BITS",v[v.GREEN_BITS=3411]="GREEN_BITS",v[v.BLUE_BITS=3412]="BLUE_BITS",v[v.ALPHA_BITS=3413]="ALPHA_BITS",v[v.DEPTH_BITS=3414]="DEPTH_BITS",v[v.STENCIL_BITS=3415]="STENCIL_BITS",v[v.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",v[v.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",v[v.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",v[v.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",v[v.SAMPLES=32937]="SAMPLES",v[v.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",v[v.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",v[v.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",v[v.DONT_CARE=4352]="DONT_CARE",v[v.FASTEST=4353]="FASTEST",v[v.NICEST=4354]="NICEST",v[v.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",v[v.BYTE=5120]="BYTE",v[v.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",v[v.SHORT=5122]="SHORT",v[v.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",v[v.INT=5124]="INT",v[v.UNSIGNED_INT=5125]="UNSIGNED_INT",v[v.FLOAT=5126]="FLOAT",v[v.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",v[v.ALPHA=6406]="ALPHA",v[v.RGB=6407]="RGB",v[v.RGBA=6408]="RGBA",v[v.LUMINANCE=6409]="LUMINANCE",v[v.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",v[v.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",v[v.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",v[v.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",v[v.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",v[v.VERTEX_SHADER=35633]="VERTEX_SHADER",v[v.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",v[v.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",v[v.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",v[v.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",v[v.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",v[v.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",v[v.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",v[v.SHADER_TYPE=35663]="SHADER_TYPE",v[v.DELETE_STATUS=35712]="DELETE_STATUS",v[v.LINK_STATUS=35714]="LINK_STATUS",v[v.VALIDATE_STATUS=35715]="VALIDATE_STATUS",v[v.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",v[v.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",v[v.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",v[v.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",v[v.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",v[v.NEVER=512]="NEVER",v[v.LESS=513]="LESS",v[v.EQUAL=514]="EQUAL",v[v.LEQUAL=515]="LEQUAL",v[v.GREATER=516]="GREATER",v[v.NOTEQUAL=517]="NOTEQUAL",v[v.GEQUAL=518]="GEQUAL",v[v.ALWAYS=519]="ALWAYS",v[v.KEEP=7680]="KEEP",v[v.REPLACE=7681]="REPLACE",v[v.INCR=7682]="INCR",v[v.DECR=7683]="DECR",v[v.INVERT=5386]="INVERT",v[v.INCR_WRAP=34055]="INCR_WRAP",v[v.DECR_WRAP=34056]="DECR_WRAP",v[v.VENDOR=7936]="VENDOR",v[v.RENDERER=7937]="RENDERER",v[v.VERSION=7938]="VERSION",v[v.NEAREST=9728]="NEAREST",v[v.LINEAR=9729]="LINEAR",v[v.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",v[v.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",v[v.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",v[v.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",v[v.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",v[v.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",v[v.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",v[v.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",v[v.TEXTURE_2D=3553]="TEXTURE_2D",v[v.TEXTURE=5890]="TEXTURE",v[v.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",v[v.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",v[v.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",v[v.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",v[v.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",v[v.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",v[v.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",v[v.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",v[v.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",v[v.TEXTURE0=33984]="TEXTURE0",v[v.TEXTURE1=33985]="TEXTURE1",v[v.TEXTURE2=33986]="TEXTURE2",v[v.TEXTURE3=33987]="TEXTURE3",v[v.TEXTURE4=33988]="TEXTURE4",v[v.TEXTURE5=33989]="TEXTURE5",v[v.TEXTURE6=33990]="TEXTURE6",v[v.TEXTURE7=33991]="TEXTURE7",v[v.TEXTURE8=33992]="TEXTURE8",v[v.TEXTURE9=33993]="TEXTURE9",v[v.TEXTURE10=33994]="TEXTURE10",v[v.TEXTURE11=33995]="TEXTURE11",v[v.TEXTURE12=33996]="TEXTURE12",v[v.TEXTURE13=33997]="TEXTURE13",v[v.TEXTURE14=33998]="TEXTURE14",v[v.TEXTURE15=33999]="TEXTURE15",v[v.TEXTURE16=34e3]="TEXTURE16",v[v.TEXTURE17=34001]="TEXTURE17",v[v.TEXTURE18=34002]="TEXTURE18",v[v.TEXTURE19=34003]="TEXTURE19",v[v.TEXTURE20=34004]="TEXTURE20",v[v.TEXTURE21=34005]="TEXTURE21",v[v.TEXTURE22=34006]="TEXTURE22",v[v.TEXTURE23=34007]="TEXTURE23",v[v.TEXTURE24=34008]="TEXTURE24",v[v.TEXTURE25=34009]="TEXTURE25",v[v.TEXTURE26=34010]="TEXTURE26",v[v.TEXTURE27=34011]="TEXTURE27",v[v.TEXTURE28=34012]="TEXTURE28",v[v.TEXTURE29=34013]="TEXTURE29",v[v.TEXTURE30=34014]="TEXTURE30",v[v.TEXTURE31=34015]="TEXTURE31",v[v.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",v[v.REPEAT=10497]="REPEAT",v[v.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",v[v.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",v[v.FLOAT_VEC2=35664]="FLOAT_VEC2",v[v.FLOAT_VEC3=35665]="FLOAT_VEC3",v[v.FLOAT_VEC4=35666]="FLOAT_VEC4",v[v.INT_VEC2=35667]="INT_VEC2",v[v.INT_VEC3=35668]="INT_VEC3",v[v.INT_VEC4=35669]="INT_VEC4",v[v.BOOL=35670]="BOOL",v[v.BOOL_VEC2=35671]="BOOL_VEC2",v[v.BOOL_VEC3=35672]="BOOL_VEC3",v[v.BOOL_VEC4=35673]="BOOL_VEC4",v[v.FLOAT_MAT2=35674]="FLOAT_MAT2",v[v.FLOAT_MAT3=35675]="FLOAT_MAT3",v[v.FLOAT_MAT4=35676]="FLOAT_MAT4",v[v.SAMPLER_2D=35678]="SAMPLER_2D",v[v.SAMPLER_CUBE=35680]="SAMPLER_CUBE",v[v.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",v[v.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",v[v.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",v[v.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",v[v.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",v[v.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",v[v.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",v[v.COMPILE_STATUS=35713]="COMPILE_STATUS",v[v.LOW_FLOAT=36336]="LOW_FLOAT",v[v.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",v[v.HIGH_FLOAT=36338]="HIGH_FLOAT",v[v.LOW_INT=36339]="LOW_INT",v[v.MEDIUM_INT=36340]="MEDIUM_INT",v[v.HIGH_INT=36341]="HIGH_INT",v[v.FRAMEBUFFER=36160]="FRAMEBUFFER",v[v.RENDERBUFFER=36161]="RENDERBUFFER",v[v.RGBA4=32854]="RGBA4",v[v.RGB5_A1=32855]="RGB5_A1",v[v.RGB565=36194]="RGB565",v[v.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",v[v.STENCIL_INDEX=6401]="STENCIL_INDEX",v[v.STENCIL_INDEX8=36168]="STENCIL_INDEX8",v[v.DEPTH_STENCIL=34041]="DEPTH_STENCIL",v[v.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",v[v.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",v[v.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",v[v.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",v[v.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",v[v.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",v[v.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",v[v.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",v[v.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",v[v.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",v[v.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",v[v.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",v[v.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",v[v.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",v[v.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",v[v.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",v[v.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",v[v.NONE=0]="NONE",v[v.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",v[v.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",v[v.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",v[v.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",v[v.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",v[v.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",v[v.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",v[v.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",v[v.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",v[v.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",v[v.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",v[v.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",v[v.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",v[v.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",v[v.COPY_SRC=1]="COPY_SRC",v[v.COPY_DST=2]="COPY_DST",v[v.SAMPLED=4]="SAMPLED",v[v.STORAGE=8]="STORAGE",v[v.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(re||(re={}));var zr,Gr,dn,pn,De=function(){function v(){Ze(this,v),this.config=void 0}return ze(v,[{key:"get",value:function(){return this.config}},{key:"set",value:function(Bt){this.config=Bt}}]),v}();function Me(){if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Ce(v,Bt){var z=Object.keys(v);if(Object.getOwnPropertySymbols){var Lt=Object.getOwnPropertySymbols(v);Bt&&(Lt=Lt.filter(function(Mt){return Object.getOwnPropertyDescriptor(v,Mt).enumerable})),z.push.apply(z,Lt)}return z}function mr(v){for(var Bt=1;Bt<arguments.length;Bt++){var z=arguments[Bt]!=null?arguments[Bt]:{};Bt%2?Ce(Object(z),!0).forEach(function(Lt){ie(v,Lt,z[Lt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(z)):Ce(Object(z)).forEach(function(Lt){Object.defineProperty(v,Lt,Object.getOwnPropertyDescriptor(z,Lt))})}return v}typeof navigator<"u"&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),function(v){v.Void="Void",v.Boolean="Boolean",v.Float="Float",v.Uint32="Uint32",v.Int32="Int32",v.Vector="Vector",v.Vector2Float="vec2<f32>",v.Vector3Float="vec3<f32>",v.Vector4Float="vec4<f32>",v.Vector2Boolean="vec2<bool>",v.Vector3Boolean="vec3<bool>",v.Vector4Boolean="vec4<bool>",v.Vector2Uint="vec2<u32>",v.Vector3Uint="vec3<u32>",v.Vector4Uint="vec4<u32>",v.Vector2Int="vec2<i32>",v.Vector3Int="vec3<i32>",v.Vector4Int="vec4<i32>",v.Matrix="Matrix",v.Matrix3x3Float="mat3x3<f32>",v.Matrix4x4Float="mat4x4<i32>",v.Struct="Struct",v.FloatArray="Float[]",v.Vector4FloatArray="vec4<f32>[]"}(zr||(zr={})),function(v){v.Program="Program",v.Identifier="Identifier",v.VariableDeclaration="VariableDeclaration",v.BlockStatement="BlockStatement",v.ReturnStatement="ReturnStatement",v.FunctionDeclaration="FunctionDeclaration",v.VariableDeclarator="VariableDeclarator",v.AssignmentExpression="AssignmentExpression",v.LogicalExpression="LogicalExpression",v.BinaryExpression="BinaryExpression",v.ArrayExpression="ArrayExpression",v.UnaryExpression="UnaryExpression",v.UpdateExpression="UpdateExpression",v.FunctionExpression="FunctionExpression",v.MemberExpression="MemberExpression",v.ConditionalExpression="ConditionalExpression",v.ExpressionStatement="ExpressionStatement",v.CallExpression="CallExpression",v.NumThreadStatement="NumThreadStatement",v.StorageStatement="StorageStatement",v.DoWhileStatement="DoWhileStatement",v.WhileStatement="WhileStatement",v.ForStatement="ForStatement",v.BreakStatement="BreakStatement",v.ContinueStatement="ContinueStatement",v.IfStatement="IfStatement",v.ImportedFunctionStatement="ImportedFunctionStatement"}(Gr||(Gr={})),function(v){v.Input="Input",v.Output="Output",v.Uniform="Uniform",v.Workgroup="Workgroup",v.UniformConstant="UniformConstant",v.Image="Image",v.StorageBuffer="StorageBuffer",v.Private="Private",v.Function="Function"}(dn||(dn={})),function(v){v.GLSL100="GLSL100",v.GLSL450="GLSL450",v.WGSL="WGSL"}(pn||(pn={}));var Ye,Ar,Or,Sr,kn,oo,Fr,uo,Vn,Vo,In,Mn,Dr,Ni,ds=function(){function v(Mt,te){Ze(this,v),this.engine=Mt,this.configService=te,this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}var Bt,z,Lt;return ze(v,[{key:"init",value:function(){var Mt=this.configService.get(),te=Mt.canvas,ue=Mt.engineOptions;this.initPromise=this.engine.init(mr({canvas:te||Me(),antialiasing:!1},ue))}},{key:"setBundle",value:function(Mt){this.compiledBundle=JSON.parse(JSON.stringify(Mt))}},{key:"setDispatch",value:function(Mt){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=Mt),this}},{key:"setMaxIteration",value:function(Mt){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=Mt),this}},{key:"setBinding",value:function(Mt,te){var ue=this;if(typeof Mt=="string"){var he=qr()(te)||sr()(te)||Xe()(te);if(this.compiledBundle&&this.compiledBundle.context){var pe=this.compiledBundle.context.defines.find(function(fe){return fe.name===Mt});if(pe)return pe.value=te,this;var ye=this.compiledBundle.context.uniforms.find(function(fe){return fe.name===Mt});ye&&(he?(ye.data=te,ye.isReferer=!1,ye.storageClass===dn.Uniform?this.model&&this.model.updateUniform(Mt,te):this.model&&this.model.updateBuffer(Mt,te)):(ye.isReferer=!0,ye.data=te))}}else Object.keys(Mt).forEach(function(fe){ue.setBinding(fe,Mt[fe])});return this}},{key:"execute",value:(Lt=Qt(Pr().mark(function Mt(){var te,ue,he=this,pe=arguments;return Pr().wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:if(te=pe.length>0&&pe[0]!==void 0?pe[0]:1,!this.dirty){ye.next=6;break}return this.compiledBundle.context&&(te>1?this.compiledBundle.context.maxIteration=te:this.compiledBundle.context.maxIteration++),ye.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter(function(fe){return fe.isReferer}).forEach(function(fe){var Je=fe.data,Qe=fe.name;he.model.confirmInput(Je.model,Qe)}),ue=0;ue<te;ue++)this.model.run();return this.engine.endFrame(),ye.abrupt("return",this);case 12:case"end":return ye.stop()}},Mt,this)})),function(){return Lt.apply(this,arguments)})},{key:"getOutput",value:(z=Qt(Pr().mark(function Mt(){return Pr().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.abrupt("return",this.model.readData());case 1:case"end":return te.stop()}},Mt,this)})),function(){return z.apply(this,arguments)})},{key:"compile",value:(Bt=Qt(Pr().mark(function Mt(){var te,ue,he;return Pr().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return pe.next=2,this.initPromise;case 2:return te=mr({},this.compiledBundle.context),ue=this.engine.supportWebGPU?this.engine.useWGSL?pn.WGSL:pn.GLSL450:pn.GLSL100,he=this.compiledBundle.shaders[ue],te.defines.filter(function(ye){return ye.runtime}).forEach(function(ye){var fe="".concat("__DefineValuePlaceholder__").concat(ye.name);he=he.replace(fe,"".concat(ye.value))}),te.shader=he,te.uniforms.forEach(function(ye){if(!ye.data&&ye.storageClass===dn.StorageBuffer){var fe=1;ye.type===zr.FloatArray?fe=1:ye.type===zr.Vector4FloatArray&&(fe=4),ye.data=new Float32Array(te.output.length*fe).fill(0)}}),this.compiledBundle.context=te,pe.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=pe.sent;case 12:case"end":return pe.stop()}},Mt,this)})),function(){return Bt.apply(this,arguments)})}]),v}(),qi=Un(919),Wi=Un.n(qi),qo=function(){function v(Bt,z){Ze(this,v),this.attribute=void 0,this.buffer=void 0;var Lt=z.buffer,Mt=z.offset,te=z.stride,ue=z.normalized,he=z.size,pe=z.divisor;this.buffer=Lt,this.attribute={buffer:Lt.get(),offset:Mt||0,stride:te||0,normalized:ue||!1,divisor:pe||0},he&&(this.attribute.size=he)}return ze(v,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(Bt){this.buffer.subData(Bt)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),v}(),Ln=(ie(Ye={},re.POINTS,"points"),ie(Ye,re.LINES,"lines"),ie(Ye,re.LINE_LOOP,"line loop"),ie(Ye,re.LINE_STRIP,"line strip"),ie(Ye,re.TRIANGLES,"triangles"),ie(Ye,re.TRIANGLE_FAN,"triangle fan"),ie(Ye,re.TRIANGLE_STRIP,"triangle strip"),Ye),Pn=(ie(Ar={},re.STATIC_DRAW,"static"),ie(Ar,re.DYNAMIC_DRAW,"dynamic"),ie(Ar,re.STREAM_DRAW,"stream"),Ar),Eo=(ie(Or={},re.BYTE,"int8"),ie(Or,re.UNSIGNED_INT,"int16"),ie(Or,re.INT,"int32"),ie(Or,re.UNSIGNED_BYTE,"uint8"),ie(Or,re.UNSIGNED_SHORT,"uint16"),ie(Or,re.UNSIGNED_INT,"uint32"),ie(Or,re.FLOAT,"float"),Or),cs=(ie(Sr={},re.ALPHA,"alpha"),ie(Sr,re.LUMINANCE,"luminance"),ie(Sr,re.LUMINANCE_ALPHA,"luminance alpha"),ie(Sr,re.RGB,"rgb"),ie(Sr,re.RGBA,"rgba"),ie(Sr,re.RGBA4,"rgba4"),ie(Sr,re.RGB5_A1,"rgb5 a1"),ie(Sr,re.RGB565,"rgb565"),ie(Sr,re.DEPTH_COMPONENT,"depth"),ie(Sr,re.DEPTH_STENCIL,"depth stencil"),Sr),hs=(ie(kn={},re.DONT_CARE,"dont care"),ie(kn,re.NICEST,"nice"),ie(kn,re.FASTEST,"fast"),kn),di=(ie(oo={},re.NEAREST,"nearest"),ie(oo,re.LINEAR,"linear"),ie(oo,re.LINEAR_MIPMAP_LINEAR,"mipmap"),ie(oo,re.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),ie(oo,re.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),ie(oo,re.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),oo),xa=(ie(Fr={},re.REPEAT,"repeat"),ie(Fr,re.CLAMP_TO_EDGE,"clamp"),ie(Fr,re.MIRRORED_REPEAT,"mirror"),Fr),Co=(ie(uo={},re.NONE,"none"),ie(uo,re.BROWSER_DEFAULT_WEBGL,"browser"),uo),ba=(ie(Vn={},re.NEVER,"never"),ie(Vn,re.ALWAYS,"always"),ie(Vn,re.LESS,"less"),ie(Vn,re.LEQUAL,"lequal"),ie(Vn,re.GREATER,"greater"),ie(Vn,re.GEQUAL,"gequal"),ie(Vn,re.EQUAL,"equal"),ie(Vn,re.NOTEQUAL,"notequal"),Vn),Mi=(ie(Vo={},re.FUNC_ADD,"add"),ie(Vo,re.MIN_EXT,"min"),ie(Vo,re.MAX_EXT,"max"),ie(Vo,re.FUNC_SUBTRACT,"subtract"),ie(Vo,re.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Vo),Lo=(ie(In={},re.ZERO,"zero"),ie(In,re.ONE,"one"),ie(In,re.SRC_COLOR,"src color"),ie(In,re.ONE_MINUS_SRC_COLOR,"one minus src color"),ie(In,re.SRC_ALPHA,"src alpha"),ie(In,re.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),ie(In,re.DST_COLOR,"dst color"),ie(In,re.ONE_MINUS_DST_COLOR,"one minus dst color"),ie(In,re.DST_ALPHA,"dst alpha"),ie(In,re.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),ie(In,re.CONSTANT_COLOR,"constant color"),ie(In,re.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),ie(In,re.CONSTANT_ALPHA,"constant alpha"),ie(In,re.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),ie(In,re.SRC_ALPHA_SATURATE,"src alpha saturate"),In),xo=(ie(Mn={},re.NEVER,"never"),ie(Mn,re.ALWAYS,"always"),ie(Mn,re.LESS,"less"),ie(Mn,re.LEQUAL,"lequal"),ie(Mn,re.GREATER,"greater"),ie(Mn,re.GEQUAL,"gequal"),ie(Mn,re.EQUAL,"equal"),ie(Mn,re.NOTEQUAL,"notequal"),Mn),Do=(ie(Dr={},re.ZERO,"zero"),ie(Dr,re.KEEP,"keep"),ie(Dr,re.REPLACE,"replace"),ie(Dr,re.INVERT,"invert"),ie(Dr,re.INCR,"increment"),ie(Dr,re.DECR,"decrement"),ie(Dr,re.INCR_WRAP,"increment wrap"),ie(Dr,re.DECR_WRAP,"decrement wrap"),Dr),$i=(ie(Ni={},re.FRONT,"front"),ie(Ni,re.BACK,"back"),Ni),Ai=function(){function v(Bt,z){Ze(this,v),this.buffer=void 0;var Lt=z.data,Mt=z.usage,te=z.type;this.buffer=Bt.buffer({data:Lt,usage:Pn[Mt||re.STATIC_DRAW],type:Eo[te||re.UNSIGNED_BYTE]})}return ze(v,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(Bt){var z=Bt.data,Lt=Bt.offset;this.buffer.subdata(z,Lt)}}]),v}();function Si(v,Bt){(Bt==null||Bt>v.length)&&(Bt=v.length);for(var z=0,Lt=new Array(Bt);z<Bt;z++)Lt[z]=v[z];return Lt}function ho(v,Bt){var z=Object.keys(v);if(Object.getOwnPropertySymbols){var Lt=Object.getOwnPropertySymbols(v);Bt&&(Lt=Lt.filter(function(Mt){return Object.getOwnPropertyDescriptor(v,Mt).enumerable})),z.push.apply(z,Lt)}return z}function _i(v){for(var Bt=1;Bt<arguments.length;Bt++){var z=arguments[Bt]!=null?arguments[Bt]:{};Bt%2?ho(Object(z),!0).forEach(function(Lt){ie(v,Lt,z[Lt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(z)):ho(Object(z)).forEach(function(Lt){Object.defineProperty(v,Lt,Object.getOwnPropertyDescriptor(z,Lt))})}return v}var bo=0,qa=function(){function v(z,Lt){var Mt=this;Ze(this,v),this.reGl=z,this.context=Lt,this.entity=at(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var te={};this.context.uniforms.forEach(function(fe){var Je=fe.name,Qe=fe.type,ar=fe.data,dr=fe.isReferer,_r=fe.storageClass;if(_r===dn.StorageBuffer){if(dr)Mt.textureCache[Je]={data:void 0},te["".concat(Je,"Size")]=function(){return ar.compiledBundle.context.output.textureSize};else{Mt.textureCache[Je]=Mt.calcDataTexture(Je,Qe,ar);var Te=Mt.textureCache[Je],yr=Te.textureWidth,Wr=Te.isOutput;te["".concat(Je,"Size")]=[yr,yr],Wr&&(Mt.outputTextureName=Je,Mt.context.needPingpong&&(Mt.outputTextureName="".concat(Je,"Output"),Mt.textureCache[Mt.outputTextureName]=Mt.calcDataTexture(Je,Qe,ar)))}te[Je]=function(){return Mt.textureCache[Je].texture}}else if(_r===dn.Uniform){if(ar&&(Array.isArray(ar)||sr()(ar))&&ar.length>16)throw new Error("invalid data type ".concat(Qe));te[Je]=function(){return fe.data}}});var ue=this.getOuputDataTexture(),he=ue.textureWidth,pe=ue.texelCount;te.u_OutputTextureSize=[he,he],te.u_OutputTexelCount=pe,this.context.output.textureSize=[he,he];var ye={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(this.context.shader),uniforms:te,vert:`attribute vec3 a_Position;
attribute vec2 a_TexCoord;

varying vec2 v_TexCoord;

void main() {
  gl_Position = vec4(a_Position, 1.0);
  v_TexCoord = a_TexCoord;
}`,primitive:"triangle strip",count:4};this.computeCommand=this.reGl(ye)}var Bt;return ze(v,[{key:"run",value:function(){var z=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use(function(){z.computeCommand()})}},{key:"readData",value:(Bt=Qt(Pr().mark(function z(){var Lt,Mt,te,ue,he,pe,ye,fe,Je=this;return Pr().wrap(function(Qe){for(;;)switch(Qe.prev=Qe.next){case 0:if(this.reGl({framebuffer:this.texFBO})(function(){Lt=Je.reGl.read()}),!Lt){Qe.next=6;break}if(Mt=this.getOuputDataTexture(),te=Mt.originalDataLength,ue=Mt.elementsPerTexel,he=Mt.typedArrayConstructor,pe=he===void 0?Float32Array:he,ye=[],ue!==4)for(fe=0;fe<Lt.length;fe+=4)ue===1?ye.push(Lt[fe]):ue===2?ye.push(Lt[fe],Lt[fe+1]):ye.push(Lt[fe],Lt[fe+1],Lt[fe+2]);else ye=Lt;return Qe.abrupt("return",new pe(ye.slice(0,te)));case 6:return Qe.abrupt("return",new Float32Array);case 7:case"end":return Qe.stop()}},z,this)})),function(){return Bt.apply(this,arguments)})},{key:"confirmInput",value:function(z,Lt){var Mt;this.entity===z.entity?(this.dynamicPingpong=!0,Mt=this):Mt=z,this.textureCache[Lt].id=Mt.getOuputDataTexture().id,this.textureCache[Lt].texture=Mt.getOuputDataTexture().texture}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(z,Lt){var Mt=this.context.uniforms.find(function(pe){return pe.name===z});if(Mt){var te=this.calcDataTexture(z,Mt.type,Lt),ue=te.texture,he=te.data;this.textureCache[z].data=he,this.textureCache[z].texture=ue}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var z=this.context.output.name;this.textureCache[z].id=this.getOuputDataTexture().id,this.textureCache[z].texture=this.getOuputDataTexture().texture}var Lt=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=Lt}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var z=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=z}},{key:"cloneDataTexture",value:function(z){var Lt=z.data,Mt=z.textureWidth;return _i(_i({},z),{},{id:bo++,texture:this.reGl.texture({width:Mt,height:Mt,data:Lt,type:"float"})})}},{key:"calcDataTexture",value:function(z,Lt,Mt){var te=1;Lt===zr.Vector4FloatArray&&(te=4);for(var ue=[],he=0;he<Mt.length;he+=te)te===1?ue.push(Mt[he],0,0,0):te===2?ue.push(Mt[he],Mt[he+1],0,0):te===3?ue.push(Mt[he],Mt[he+1],Mt[he+2],0):te===4&&ue.push(Mt[he],Mt[he+1],Mt[he+2],Mt[he+3]);var pe,ye=Mt.length,fe=Math.ceil(ye/te),Je=Math.ceil(Math.sqrt(fe)),Qe=Je*Je;fe<Qe&&ue.push.apply(ue,function(dr){if(Array.isArray(dr))return Si(dr)}(pe=new Array(4*(Qe-fe)).fill(0))||function(dr){if(typeof Symbol<"u"&&dr[Symbol.iterator]!=null||dr["@@iterator"]!=null)return Array.from(dr)}(pe)||function(dr,_r){if(dr){if(typeof dr=="string")return Si(dr,_r);var Te=Object.prototype.toString.call(dr).slice(8,-1);return Te==="Object"&&dr.constructor&&(Te=dr.constructor.name),Te==="Map"||Te==="Set"?Array.from(dr):Te==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Te)?Si(dr,_r):void 0}}(pe)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}());var ar=this.reGl.texture({width:Je,height:Je,data:ue,type:"float"});return{id:bo++,data:ue,originalDataLength:ye,typedArrayConstructor:sr()(Mt)?Mt.constructor:void 0,textureWidth:Je,texture:ar,texelCount:fe,elementsPerTexel:te,isOutput:z===this.context.output.name}}}]),v}(),Wo=function(){function v(Bt,z){Ze(this,v),this.elements=void 0;var Lt=z.data,Mt=z.usage,te=z.type,ue=z.count;this.elements=Bt.elements({data:Lt,usage:Pn[Mt||re.STATIC_DRAW],type:Eo[te||re.UNSIGNED_BYTE],count:ue})}return ze(v,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(Bt){var z=Bt.data;this.elements.subdata(z)}},{key:"destroy",value:function(){this.elements.destroy()}}]),v}(),Wa=function(){function v(Bt,z){Ze(this,v),this.framebuffer=void 0;var Lt=z.width,Mt=z.height,te=z.color,ue=z.colors,he=(z.depth,z.stencil,{width:Lt,height:Mt});Array.isArray(ue)&&(he.colors=ue.map(function(pe){return pe.get()})),te&&typeof te!="boolean"&&(he.color=te.get()),this.framebuffer=Bt.framebuffer(he)}return ze(v,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(Bt){var z=Bt.width,Lt=Bt.height;this.framebuffer.resize(z,Lt)}}]),v}(),$a=Un(256),ls=Un.n($a);function Hi(v){var Bt={};return Object.keys(v).forEach(function(z){Ha(z,v[z],Bt,"")}),Bt}function Ha(v,Bt,z,Lt){Bt===null||typeof Bt=="number"||typeof Bt=="boolean"||Array.isArray(Bt)&&typeof Bt[0]=="number"||sr()(Bt)||Bt===""||Bt.resize!==void 0?z["".concat(Lt&&Lt+".").concat(v)]=Bt:(ls()(Bt)&&Object.keys(Bt).forEach(function(Mt){Ha(Mt,Bt[Mt],z,"".concat(Lt&&Lt+".").concat(v))}),Array.isArray(Bt)&&Bt.forEach(function(Mt,te){Object.keys(Mt).forEach(function(ue){Ha(ue,Mt[ue],z,"".concat(Lt&&Lt+".").concat(v,"[").concat(te,"]"))})}))}function Na(v,Bt){var z=Object.keys(v);if(Object.getOwnPropertySymbols){var Lt=Object.getOwnPropertySymbols(v);Bt&&(Lt=Lt.filter(function(Mt){return Object.getOwnPropertyDescriptor(v,Mt).enumerable})),z.push.apply(z,Lt)}return z}function ci(v){for(var Bt=1;Bt<arguments.length;Bt++){var z=arguments[Bt]!=null?arguments[Bt]:{};Bt%2?Na(Object(z),!0).forEach(function(Lt){ie(v,Lt,z[Lt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(z)):Na(Object(z)).forEach(function(Lt){Object.defineProperty(v,Lt,Object.getOwnPropertyDescriptor(z,Lt))})}return v}var An=function(){function v(Bt,z){Ze(this,v),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=Bt;var Lt=z.vs,Mt=z.fs,te=z.defines,ue=z.attributes,he=z.uniforms,pe=z.primitive,ye=z.count,fe=z.elements,Je=z.depth,Qe=z.blend,ar=z.stencil,dr=z.cull,_r=z.instances,Te=z.scissor,yr=z.viewport,Wr={};he&&(this.uniforms=Hi(he),Object.keys(he).forEach(function(Hr){Wr[Hr]=Bt.prop(Hr)}));var cn={};Object.keys(ue).forEach(function(Hr){cn[Hr]=ue[Hr].get()});var Wn=te&&this.generateDefines(te)||"",$r={attributes:cn,frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(Wn,`
`).concat(Mt),uniforms:Wr,vert:`
`.concat(Wn,`
`).concat(Lt),primitive:Ln[pe===void 0?re.TRIANGLES:pe]};_r&&($r.instances=_r),ye&&($r.count=ye),fe&&($r.elements=fe.get()),Te&&($r.scissor=Te),yr&&($r.viewport=yr),this.initDepthDrawParams({depth:Je},$r),this.initBlendDrawParams({blend:Qe},$r),this.initStencilDrawParams({stencil:ar},$r),this.initCullDrawParams({cull:dr},$r),this.drawCommand=Bt($r)}return ze(v,[{key:"addUniforms",value:function(Bt){this.uniforms=ci(ci({},this.uniforms),Hi(Bt))}},{key:"draw",value:function(Bt){var z=ci(ci({},this.uniforms),Hi(Bt.uniforms||{})),Lt={};Object.keys(z).forEach(function(Mt){var te=Zt(z[Mt]);te==="boolean"||te==="number"||Array.isArray(z[Mt])||z[Mt].BYTES_PER_ELEMENT?Lt[Mt]=z[Mt]:te==="string"||(Lt[Mt]=z[Mt].get())}),this.drawCommand(Lt)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(Bt,z){var Lt=Bt.depth;Lt&&(z.depth={enable:Lt.enable===void 0||!!Lt.enable,mask:Lt.mask===void 0||!!Lt.mask,func:ba[Lt.func||re.LESS],range:Lt.range||[0,1]})}},{key:"initBlendDrawParams",value:function(Bt,z){var Lt=Bt.blend;if(Lt){var Mt=Lt.enable,te=Lt.func,ue=Lt.equation,he=Lt.color,pe=he===void 0?[0,0,0,0]:he;z.blend={enable:!!Mt,func:{srcRGB:Lo[te&&te.srcRGB||re.SRC_ALPHA],srcAlpha:Lo[te&&te.srcAlpha||re.SRC_ALPHA],dstRGB:Lo[te&&te.dstRGB||re.ONE_MINUS_SRC_ALPHA],dstAlpha:Lo[te&&te.dstAlpha||re.ONE_MINUS_SRC_ALPHA]},equation:{rgb:Mi[ue&&ue.rgb||re.FUNC_ADD],alpha:Mi[ue&&ue.alpha||re.FUNC_ADD]},color:pe}}}},{key:"initStencilDrawParams",value:function(Bt,z){var Lt=Bt.stencil;if(Lt){var Mt=Lt.enable,te=Lt.mask,ue=te===void 0?-1:te,he=Lt.func,pe=he===void 0?{cmp:re.ALWAYS,ref:0,mask:-1}:he,ye=Lt.opFront,fe=ye===void 0?{fail:re.KEEP,zfail:re.KEEP,zpass:re.KEEP}:ye,Je=Lt.opBack,Qe=Je===void 0?{fail:re.KEEP,zfail:re.KEEP,zpass:re.KEEP}:Je;z.stencil={enable:!!Mt,mask:ue,func:ci(ci({},pe),{},{cmp:xo[pe.cmp]}),opFront:{fail:Do[fe.fail],zfail:Do[fe.zfail],zpass:Do[fe.zpass]},opBack:{fail:Do[Qe.fail],zfail:Do[Qe.zfail],zpass:Do[Qe.zpass]}}}}},{key:"initCullDrawParams",value:function(Bt,z){var Lt=Bt.cull;if(Lt){var Mt=Lt.enable,te=Lt.face,ue=te===void 0?re.BACK:te;z.cull={enable:!!Mt,face:$i[ue]}}}},{key:"generateDefines",value:function(Bt){return Object.keys(Bt).map(function(z){return"#define ".concat(z," ").concat(Number(Bt[z]))}).join(`
`)}}]),v}(),Xa=function(){function v(Bt,z){Ze(this,v),this.texture=void 0,this.width=void 0,this.height=void 0;var Lt=z.data,Mt=z.type,te=Mt===void 0?re.UNSIGNED_BYTE:Mt,ue=z.width,he=z.height,pe=z.flipY,ye=pe!==void 0&&pe,fe=z.format,Je=fe===void 0?re.RGBA:fe,Qe=z.mipmap,ar=Qe!==void 0&&Qe,dr=z.wrapS,_r=dr===void 0?re.CLAMP_TO_EDGE:dr,Te=z.wrapT,yr=Te===void 0?re.CLAMP_TO_EDGE:Te,Wr=z.aniso,cn=Wr===void 0?0:Wr,Wn=z.alignment,$r=Wn===void 0?1:Wn,Hr=z.premultiplyAlpha,Dn=Hr!==void 0&&Hr,yn=z.mag,zn=yn===void 0?re.NEAREST:yn,lo=z.min,Tn=lo===void 0?re.NEAREST:lo,$n=z.colorSpace,Xr=$n===void 0?re.BROWSER_DEFAULT_WEBGL:$n;this.width=ue,this.height=he;var hn={width:ue,height:he,type:Eo[te],format:cs[Je],wrapS:xa[_r],wrapT:xa[yr],mag:di[zn],min:di[Tn],alignment:$r,flipY:ye,colorSpace:Co[Xr],premultiplyAlpha:Dn,aniso:cn};Lt&&(hn.data=Lt),typeof ar=="number"?hn.mipmap=hs[ar]:typeof ar=="boolean"&&(hn.mipmap=ar),this.texture=Bt.texture(hn)}return ze(v,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(Bt){var z=Bt.width,Lt=Bt.height;this.texture.resize(z,Lt),this.width=z,this.height=Lt}},{key:"destroy",value:function(){this.texture.destroy()}}]),v}(),Os=function(){function v(){var z=this;Ze(this,v),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=function(){var Lt=Qt(Pr().mark(function Mt(te){return Pr().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:if(!te.uniforms){ue.next=3;break}return ue.next=3,Promise.all(Object.keys(te.uniforms).map(function(){var he=Qt(Pr().mark(function pe(ye){var fe;return Pr().wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:if(!te.uniforms[ye]||te.uniforms[ye].load===void 0){Je.next=5;break}return Je.next=3,te.uniforms[ye].load();case 3:fe=Je.sent,te.uniforms[ye]=fe;case 5:case"end":return Je.stop()}},pe)}));return function(pe){return he.apply(this,arguments)}}()));case 3:return ue.abrupt("return",new An(z.gl,te));case 4:case"end":return ue.stop()}},Mt)}));return function(Mt){return Lt.apply(this,arguments)}}(),this.createAttribute=function(Lt){return new qo(z.gl,Lt)},this.createBuffer=function(Lt){return new Ai(z.gl,Lt)},this.createElements=function(Lt){return new Wo(z.gl,Lt)},this.createTexture2D=function(Lt){return new Xa(z.gl,Lt)},this.createFramebuffer=function(Lt){return new Wa(z.gl,Lt)},this.useFramebuffer=function(Lt,Mt){z.gl({framebuffer:Lt?Lt.get():null})(Mt)},this.createComputeModel=function(){var Lt=Qt(Pr().mark(function Mt(te){return Pr().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return ue.abrupt("return",new qa(z.gl,te));case 1:case"end":return ue.stop()}},Mt)}));return function(Mt){return Lt.apply(this,arguments)}}(),this.clear=function(Lt){var Mt=Lt.color,te=Lt.depth,ue=Lt.stencil,he=Lt.framebuffer,pe=he===void 0?null:he,ye={color:Mt,depth:te,stencil:ue};ye.framebuffer=pe===null?pe:pe.get(),z.gl.clear(ye)},this.setScissor=function(Lt){z.gl&&z.gl._gl&&(Lt.enable&&Lt.box?(z.gl._gl.enable(re.SCISSOR_TEST),z.gl._gl.scissor(Lt.box.x,Lt.box.y,Lt.box.width,Lt.box.height)):z.gl._gl.disable(re.SCISSOR_TEST),z.gl._refresh())},this.viewport=function(Lt){var Mt=Lt.x,te=Lt.y,ue=Lt.width,he=Lt.height;z.gl&&z.gl._gl&&(z.gl._gl.viewport(Mt,te,ue,he),z.gl._refresh())},this.readPixels=function(Lt){var Mt=Lt.framebuffer,te={x:Lt.x,y:Lt.y,width:Lt.width,height:Lt.height};return Mt&&(te.framebuffer=Mt.get()),z.gl.read(te)},this.getCanvas=function(){return z.$canvas},this.getGLContext=function(){return z.gl._gl},this.destroy=function(){z.gl&&(z.gl.destroy(),z.inited=!1)}}var Bt;return ze(v,[{key:"init",value:(Bt=Qt(Pr().mark(function z(Lt){return Pr().wrap(function(Mt){for(;;)switch(Mt.prev=Mt.next){case 0:if(!this.inited){Mt.next=2;break}return Mt.abrupt("return");case 2:return this.$canvas=Lt.canvas,Mt.next=5,new Promise(function(te,ue){Wi()({canvas:Lt.canvas,attributes:{alpha:!0,antialias:Lt.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(he,pe){!he&&pe||ue(he),te(pe)}})});case 5:this.gl=Mt.sent,this.inited=!0;case 7:case"end":return Mt.stop()}},z,this)})),function(z){return Bt.apply(this,arguments)})},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),v}(),No=function(){function v(){Ze(this,v),this.engine=void 0,this.configService=new De}return ze(v,[{key:"setConfig",value:function(Bt){this.configService.set(Bt)}},{key:"setEngine",value:function(Bt){this.engine=Bt}},{key:"createEntity",value:function(){return at()}},{key:"createKernel",value:function(Bt){var z=new ds(this.engine,this.configService);return typeof Bt=="string"?z.setBundle(JSON.parse(Bt)):z.setBundle(Bt),z.init(),z}},{key:"destroy",value:function(){this.engine.destroy()}}],[{key:"create",value:function(){var Bt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},z=new v;return z.setConfig(Bt),z.setEngine(new Os),z}}]),v}(),Ma=function(v){for(var Bt=[],z=v.length,Lt=v[0].length,Mt=function(ue){v.forEach(function(he,pe){if(Bt.push(he[ue]),pe===z-1)for(;Bt.length%4!=0;)Bt.push(0)})},te=0;te<Lt;te++)Mt(te);return new Float32Array(Bt)},Aa={}.toString;const qn=function(v){return function(Bt,z){return Aa.call(Bt)==="[object "+z+"]"}(v,"Number")};var Sa={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Xi=function(){function v(Bt){Bt===void 0&&(Bt={}),this.options=Bt,this.id="fruchtermanGPU",this.options=R(R({},Sa),Bt)}return v.prototype.execute=function(Bt,z){return H(this,void 0,void 0,function(){return gt(this,function(Lt){return[2,this.genericFruchtermanLayout(!1,Bt,z)]})})},v.prototype.assign=function(Bt,z){return H(this,void 0,void 0,function(){return gt(this,function(Lt){return this.genericFruchtermanLayout(!0,Bt,z),[2]})})},v.prototype.genericFruchtermanLayout=function(Bt,z,Lt){return H(this,void 0,void 0,function(){var Mt,te,ue,he,pe,ye,fe,Je,Qe,ar,dr,_r,Te,yr,Wr,cn,Wn,$r,Hr,Dn,yn,zn,lo,Tn,$n,Xr,hn,Rn,wn,On;return gt(this,function(Kn){switch(Kn.label){case 0:if(Mt=this.formatOptions(Lt),te=Mt.width,ue=Mt.height,he=Mt.center,pe=Mt.clustering,ye=Mt.clusterGravity,fe=Mt.nodeClusterBy,Je=Mt.maxIteration,Qe=Mt.gravity,ar=Mt.speed,dr=z.getAllNodes(),_r=z.getAllEdges(),!(dr!=null&&dr.length))return[2,{nodes:[],edges:_r}];if(dr.length===1)return Bt&&z.mergeNodeData(dr[0].id,{x:he[0],y:he[1]}),[2,{nodes:[R(R({},dr[0]),{data:R(R({},dr[0].data),{x:he[0],y:he[1]})})],edges:_r}];for(Te=dr.map(function(Yr){return w(Yr,[te,ue])}),yr=ue*te,Wr=Math.sqrt(yr)/10,cn=yr/(Te.length+1),Wn=Math.sqrt(cn),Mo=[],Ao=(io=[fe]).length,ao={},Te.forEach(function(Yr){io.forEach(function(ln,Jr){if(ao[Yr[ln]]===void 0&&(ao[Yr[ln]]=Object.keys(ao).length),Mo.push(ao[Yr[ln]]),Jr===Ao-1)for(;Mo.length%4!=0;)Mo.push(0)})}),$r={array:new Float32Array(Mo),count:Object.keys(ao).length},Hr=$r.array,Dn=$r.count,Te.forEach(function(Yr,ln){var Jr=0,En=0;qn(Yr.data.fx)&&qn(Yr.data.fy)&&(Jr=Yr.data.fx||.001,En=Yr.data.fy||.001),Hr[4*ln+1]=Jr,Hr[4*ln+2]=En}),yn=Te.length,zn=function(Yr,ln){var Jr=[],En=[],po={},xn=0;for(xn=0;xn<Yr.length;xn++){var Zn=Yr[xn];po[Zn.id]=xn,Jr.push(Zn.data.x),Jr.push(Zn.data.y),Jr.push(0),Jr.push(0),En.push([])}for(xn=0;xn<ln.length;xn++){var Cr=ln[xn],Hn=Cr.source,Gn=Cr.target;isNaN(po[Hn])||isNaN(po[Gn])||(En[po[Hn]].push(po[Gn]),En[po[Gn]].push(po[Hn]))}var Kr=0;for(xn=0;xn<Yr.length;xn++){var Jn=Jr.length,Sn=En[xn],bn=Sn.length;Jr[4*xn+2]=Jn,Jr[4*xn+3]=bn,Kr=Math.max(Kr,bn);for(var Qr=0;Qr<bn;++Qr){var _n=Sn[Qr];Jr.push(+_n)}}for(;Jr.length%4!=0;)Jr.push(0);return{maxEdgePerVetex:Kr,array:new Float32Array(Jr)}}(Te,_r),lo=zn.maxEdgePerVetex,Tn=zn.array,$n=No.create({engineOptions:{supportCompute:!0}}),Xr=[],wn=0;wn<Dn;wn++)Xr.push(0,0,0,0);hn=$n.createKernel('{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([yn,1,1]).setBinding({u_Data:Tn,u_K:Wn,u_K2:cn,u_Gravity:Qe,u_ClusterGravity:ye||Qe||1,u_Speed:ar,u_MaxDisplace:Wr,u_Clustering:pe?1:0,u_Center:he,u_AttributeArray:Hr,u_ClusterCenters:Xr,MAX_EDGE_PER_VERTEX:lo,VERTEX_COUNT:yn}),pe&&(Rn=$n.createKernel('{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([Dn,1,1]).setBinding({u_Data:Tn,u_NodeAttributes:Hr,u_ClusterCenters:Xr,VERTEX_COUNT:yn,CLUSTER_COUNT:Dn})),wn=0,Kn.label=1;case 1:return wn<Je?[4,hn.execute()]:[3,6];case 2:return Kn.sent(),pe?(Rn.setBinding({u_Data:hn}),[4,Rn.execute()]):[3,4];case 3:Kn.sent(),hn.setBinding({u_ClusterCenters:Rn}),Kn.label=4;case 4:hn.setBinding({u_MaxDisplace:Wr*=.99}),Kn.label=5;case 5:return wn++,[3,1];case 6:return[4,hn.getOutput()];case 7:return On=Kn.sent(),Te.forEach(function(Yr,ln){Yr.data.x=On[4*ln],Yr.data.y=On[4*ln+1]}),Bt&&Te.forEach(function(Yr){var ln=Yr.id,Jr=Yr.data;return z.mergeNodeData(ln,{x:Jr.x,y:Jr.y})}),[2,{nodes:Te,edges:_r}]}var io,Mo,Ao,ao})})},v.prototype.formatOptions=function(Bt){Bt===void 0&&(Bt={});var z=R(R({},this.options),Bt),Lt=z.clustering,Mt=z.nodeClusterBy,te=z.center,ue=z.width,he=z.height;return z.width=ue||typeof window>"u"?ue:window.innerWidth,z.height=he||typeof window>"u"?he:window.innerHeight,z.center=te||[z.width/2,z.height/2],z.clustering=Lt&&!!Mt,z},v}(),ki={linkDistance:1,nodeStrength:1e3,maxIteration:1e3,edgeStrength:200,coulombDisScale:.005,damping:.9,maxSpeed:1e3,minMovement:.5,interval:.02,factor:1,gravity:10},hi=function(){function v(Bt){Bt===void 0&&(Bt={}),this.options=Bt,this.id="gforce",this.options=R(R({},ki),Bt)}return v.prototype.execute=function(Bt,z){return H(this,void 0,void 0,function(){return gt(this,function(Lt){return[2,this.genericForceLayout(!1,Bt,z)]})})},v.prototype.assign=function(Bt,z){return H(this,void 0,void 0,function(){return gt(this,function(Lt){return this.genericForceLayout(!0,Bt,z),[2]})})},v.prototype.genericForceLayout=function(Bt,z,Lt){return H(this,void 0,void 0,function(){var Mt,te,ue,he,pe,ye,fe,Je,Qe,ar,dr,_r,Te,yr,Wr,cn,Wn,$r,Hr,Dn,yn,zn,lo,Tn,$n,Xr,hn,Rn,wn,On,Kn,io,Mo,Ao,ao,Yr,ln,Jr,En,po,xn;return gt(this,function(Zn){switch(Zn.label){case 0:if(Mt=this.formatOptions(Lt,z),te=Mt.width,ue=Mt.height,he=Mt.center,pe=Mt.gravity,ye=Mt.linkDistance,fe=Mt.edgeStrength,Je=Mt.getMass,Qe=Mt.getCenter,ar=Mt.nodeStrength,dr=Mt.damping,_r=Mt.maxSpeed,Te=Mt.minMovement,yr=Mt.coulombDisScale,Wr=Mt.factor,cn=Mt.interval,Wn=Mt.maxIteration,$r=z.getAllNodes(),Hr=z.getAllEdges(),!($r!=null&&$r.length))return[2,{nodes:[],edges:Hr}];if($r.length===1)return Bt&&z.mergeNodeData($r[0].id,{x:he[0],y:he[1]}),[2,{nodes:[R(R({},$r[0]),{data:R(R({},$r[0].data),{x:he[0],y:he[1]})})],edges:Hr}];for((Dn=$r.map(function(Cr){return w(Cr,[te,ue])})).forEach(function(Cr,Hn){qn(Cr.data.x)||(Cr.data.x=Math.random()*te),qn(Cr.data.y)||(Cr.data.y=Math.random()*ue)}),yn=Dn.length,zn=function(Cr,Hn,Gn,Kr){var Jn=[],Sn=[],bn={},Qr=0;for(Qr=0;Qr<Cr.length;Qr++){var _n=Cr[Qr];bn[_n.id]=Qr,Jn.push(_n.data.x),Jn.push(_n.data.y),Jn.push(0),Jn.push(0),Sn.push([])}for(Qr=0;Qr<Hn.length;Qr++){var Vr=Hn[Qr],fn=Vr.source,Qn=Vr.target;Sn[bn[fn]].push(bn[Qn]),Sn[bn[fn]].push(Gn(Vr)),Sn[bn[fn]].push(Kr(Vr)),Sn[bn[fn]].push(0),Sn[bn[Qn]].push(bn[fn]),Sn[bn[Qn]].push(Gn(Vr)),Sn[bn[Qn]].push(Kr(Vr)),Sn[bn[Qn]].push(0)}var Ii=0;for(Qr=0;Qr<Cr.length;Qr++){var Di=Jn.length,$o=Sn[Qr],Ti=$o.length;Jn[4*Qr+2]=Di+1048576*Ti/4,Jn[4*Qr+3]=0,Ii=Math.max(Ii,Ti/4);for(var li=0;li<Ti;++li){var Po=$o[li];Jn.push(+Po)}}for(;Jn.length%4!=0;)Jn.push(0);return{maxEdgePerVetex:Ii,array:new Float32Array(Jn)}}(Dn,Hr,ye,fe),lo=zn.maxEdgePerVetex,Tn=zn.array,$n=[],Xr=[],hn=[],Rn=[],wn=[],On=[],Kn=[],io=Dn.map(function(Cr){return z.getDegree(Cr.id,"both")}),Dn.forEach(function(Cr,Hn){$n.push(Je(Cr)),Xr.push(ar(Cr));var Gn=[he[0],he[1],pe];if(Qe){var Kr=Qe(Cr,io[Hn]);Kr&&qn(Kr[0])&&qn(Kr[1])&&qn(Kr[2])&&(Gn=Kr)}hn.push(Gn[0]),Rn.push(Gn[1]),wn.push(Gn[2]),qn(Cr.data.fx)&&qn(Cr.data.fy)?(On.push(Cr.data.fx||.001),Kn.push(Cr.data.fy||.001)):(On.push(0),Kn.push(0))}),Mo=Ma([$n,io,Xr,On]),Ao=Ma([hn,Rn,wn,Kn]),ao=No.create({engineOptions:{supportCompute:!0}}),Yr=[],Tn.forEach(function(Cr){Yr.push(Cr)}),En=0;En<4;En++)Yr.push(0);ln=ao.createKernel('{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_damping;\\nuniform float u_maxSpeed;\\nuniform float u_minMovement;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nuniform float u_coulombDisScale;\\nuniform float u_factor;\\nuniform sampler2D u_NodeAttributeArray1;\\nuniform vec2 u_NodeAttributeArray1Size;\\nvec4 getDatau_NodeAttributeArray1(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray1, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray1(float address1D) {\\n  return getDatau_NodeAttributeArray1(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray1Size));\\n}\\nvec4 getDatau_NodeAttributeArray1(int address1D) {\\n  return getDatau_NodeAttributeArray1(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributeArray2;\\nuniform vec2 u_NodeAttributeArray2Size;\\nvec4 getDatau_NodeAttributeArray2(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray2, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray2(float address1D) {\\n  return getDatau_NodeAttributeArray2(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray2Size));\\n}\\nvec4 getDatau_NodeAttributeArray2(int address1D) {\\n  return getDatau_NodeAttributeArray2(float(address1D));\\n}\\nuniform float u_interval;\\nivec2 unpack_float(float packedValue) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = getDatau_NodeAttributeArray1(i);\\nvec4 attributesj = getDatau_NodeAttributeArray1(j);\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nvec4 movement = getDatau_AveMovement(0.0);\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < u_minMovement)) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes1 = getDatau_NodeAttributeArray1(i);\\nvec4 nodeAttributes2 = getDatau_NodeAttributeArray2(i);\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = u_interval * u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > u_maxSpeed) {float param2 = u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0));}else {float distx = vx * u_interval;\\nfloat disty = vy * u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\ngl_FragColor = vec4(vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"SHIFT_20","type":"Float","value":1048576,"runtime":false}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_damping","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_maxSpeed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_minMovement","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_coulombDisScale","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_factor","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray1","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray2","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_interval","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([yn,1,1]).setBinding({u_Data:Tn,u_damping:dr,u_maxSpeed:_r,u_minMovement:Te,u_coulombDisScale:yr,u_factor:Wr,u_NodeAttributeArray1:Mo,u_NodeAttributeArray2:Ao,MAX_EDGE_PER_VERTEX:lo,VERTEX_COUNT:yn,u_AveMovement:Yr,u_interval:cn}),Jr=ao.createKernel('{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_iter;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = getDatau_Data(j);\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngl_FragColor = vec4(vec4(movement, 0.0, 0.0, 0.0));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_iter","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_AveMovement","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([1,1,1]).setBinding({u_Data:Tn,VERTEX_COUNT:yn,u_AveMovement:[0,0,0,0]}),En=0,Zn.label=1;case 1:return En<Wn?[4,ln.execute()]:[3,5];case 2:return Zn.sent(),Jr.setBinding({u_Data:ln}),[4,Jr.execute()];case 3:Zn.sent(),po=Math.max(.02,cn-.002*En),ln.setBinding({u_interval:po,u_AveMovement:Jr}),Zn.label=4;case 4:return En++,[3,1];case 5:return[4,ln.getOutput()];case 6:return xn=Zn.sent(),Dn.forEach(function(Cr,Hn){Cr.data.x=xn[4*Hn],Cr.data.y=xn[4*Hn+1]}),Bt&&Dn.forEach(function(Cr){var Hn=Cr.id,Gn=Cr.data;return z.mergeNodeData(Hn,{x:Gn.x,y:Gn.y})}),[2,{nodes:Dn,edges:Hr}]}})})},v.prototype.formatOptions=function(Bt,z){Bt===void 0&&(Bt={});var Lt=R(R({},this.options),Bt),Mt=Bt.width,te=Bt.height,ue=Bt.getMass;return Lt.width=Mt||typeof window>"u"?Mt:window.innerWidth,Lt.height=te||typeof window>"u"?te:window.innerHeight,Bt.center||(Lt.center=[Lt.width/2,Lt.height/2]),ue||(Lt.getMass=function(he){var pe=1;qn(he==null?void 0:he.data.mass)&&(pe=he==null?void 0:he.data.mass);var ye=z.getDegree(he.id,"both");return!ye||ye<5?pe:5*ye*pe}),Lt.linkDistance=m(1,Bt.linkDistance),Lt.nodeStrength=m(1,Bt.nodeStrength),Lt.edgeStrength=m(1,Bt.edgeStrength),Lt},v}();E("fruchtermanGPU",Xi),E("gforce",hi)})();var hc=mu.O,lc=mu.I,yu=(p,h,a)=>new Promise((f,w)=>{var m=H=>{try{R(a.next(H))}catch(gt){w(gt)}},E=H=>{try{R(a.throw(H))}catch(gt){w(gt)}},R=H=>H.done?f(H.value):Promise.resolve(H.value).then(m,E);R((a=a.apply(p,h)).next())});const wu=100,Eu=10,xu=200,bu=200,Nu=1e3,Mu=1e3,Au=.9,Su=1,_u=.005,ku=.02,Iu=.4;function fc(p,h){return yu(this,arguments,function*(a,{iterations:f}){const m=yield new ac({factor:Su,gravity:Eu,linkDistance:xu,edgeStrength:bu,nodeStrength:Nu,coulombDisScale:_u,damping:Au,maxSpeed:Mu,minMovement:Iu,interval:ku,preventOverlap:!0,maxIteration:f||wu,width:Br,height:Br,center:[Br/2,Br/2]}).execute(a);return Vs(m)})}function gc(p,h){return yu(this,arguments,function*(a,{iterations:f}){const m=yield new lc({factor:Su,gravity:Eu,linkDistance:xu,edgeStrength:bu,nodeStrength:Nu,coulombDisScale:_u,damping:Au,maxSpeed:Mu,minMovement:Iu,interval:ku,maxIteration:f||wu,center:[Br/2,Br/2]}).execute(a);return Vs(m)})}function Wu(p,h,a){return yu(this,arguments,function*({nodes:f,edges:w,masses:m,weights:E},{iterations:R},{force2:H}){const{nodes:gt}=yield H({nodes:f.length,edges:w,positions:f,masses:m,weights:E,iterations:R||wu,edge_strength:bu,link_distance:xu,node_strength:Nu,coulomb_dis_scale:_u,kg:Eu,factor:Su,interval:ku,damping:Au,center:[Br/2,Br/2],max_speed:Mu,min_movement:Iu});return lu(gt,w)})}function pc(p,h,a,f){const w=ie=>Math.sqrt(ie.reduce((Ze,me)=>Ze+me*me,0)),m=a.width,E=a.height,R=m*E,H=a.C*Math.sqrt(R/(p+1)),gt=ie=>ie*ie/H,Ut=ie=>H*H/ie,Qt=new Float32Array(p*2).map((ie,Ze)=>Ze%2===0?(Math.random()*m-m/2)/2:(Math.random()*E-E/2)/2);let Zt=m/10;const be=ie=>ie/(a.iterations+1);for(let ie=0;ie<a.iterations;ie++){const Ze=[];for(let me=0;me<p;me++){const ze=me*2,re=[Qt[ze+0],Qt[ze+1]];Ze[me]=[0,0];for(let ir=0;ir<p;ir++){const sr=me*2,br=[Qt[sr+0],Qt[sr+1]];if(me!==ir){const qr=[re[0]-br[0],re[1]-br[1]],$e=w(qr);if($e!==0||$e>1e3*H){const Xe=Ut($e);Ze[me][0]+=qr[0]/$e*Xe,Ze[me][1]+=qr[1]/$e*Xe}}}}for(let me=0;me<h.length/3;me++){const ze=me*3,re=h[ze+0],ir=re*2,sr=h[ze+1],br=sr*2,qr=h[ze+2],$e=[Qt[ir+0]-Qt[br+0],Qt[ir+1]-Qt[br+1]],Xe=w($e);if(Xe!==0||Xe>1e3*H){const le=gt(Xe),Pr=Math.pow(qr,a.edgeWeightInfluence);Ze[re][0]-=$e[0]/Xe*le*Pr,Ze[re][1]-=$e[1]/Xe*le*Pr,Ze[sr][0]+=$e[0]/Xe*le*Pr,Ze[sr][1]+=$e[1]/Xe*le*Pr}}for(let me=0;me<p;me++){const ze=me*2,re=[Qt[ze+0],Qt[ze+1]],ir=Ze[me],sr=w(re),br=.01*H*a.gravity*sr;ir[0]-=br*re[0]/sr,ir[1]-=br*re[1]/sr,ir[0]*=a.speed,ir[1]*=a.speed;const qr=w(ir);if(qr!==0){const $e=Math.min(qr,Zt*a.speed),Xe=re[0]+ir[0]/qr*$e,le=re[1]+ir[1]/qr*$e;Qt[ze+0]=Math.min(m/2,Math.max(-m/2,Xe)),Qt[ze+1]=Math.min(E/2,Math.max(-E/2,le))}}Zt=be(Zt),(ie===a.iterations-1||ie%a.skipUpdates+1===0)&&(f==null||f(Qt,ie))}return Qt}var vc=Object.defineProperty,mc=Object.defineProperties,yc=Object.getOwnPropertyDescriptors,$u=Object.getOwnPropertySymbols,wc=Object.prototype.hasOwnProperty,Ec=Object.prototype.propertyIsEnumerable,Hu=(p,h,a)=>h in p?vc(p,h,{enumerable:!0,configurable:!0,writable:!0,value:a}):p[h]=a,xc=(p,h)=>{for(var a in h||(h={}))wc.call(h,a)&&Hu(p,a,h[a]);if($u)for(var a of $u(h))Ec.call(h,a)&&Hu(p,a,h[a]);return p},bc=(p,h)=>mc(p,yc(h));const Nc=p=>{const h=(p==null?void 0:p.iterations)||10,a=(p==null?void 0:p.edgeWeightInfluence)||1,f=(p==null?void 0:p.C)||1,w=(p==null?void 0:p.speed)||1,m=(p==null?void 0:p.gravity)||10,E=(p==null?void 0:p.skipUpdates)||0,R=(p==null?void 0:p.width)||1,H=(p==null?void 0:p.height)||1;return{iterations:h,edgeWeightInfluence:a,C:f,speed:w,gravity:m,skipUpdates:E,width:R,height:H}},Mc=(p,h="weight")=>{const a=p.nodes(),f=p.edges(),w=p.edges().reduce((E,R,H)=>{const gt=H*3;return E[gt+0]=a.indexOf(p.source(R)),E[gt+1]=a.indexOf(p.target(R)),E[gt+2]=p.getEdgeAttribute(R,h)||1,E},new Float32Array(f.length*3)),m=E=>a.reduce((R,H,gt)=>{const Ut=gt*2;return bc(xc({},R),{[H]:{x:E[Ut+0],y:E[Ut+1]}})},{});return[w,a.length,m]};var Ac=Object.defineProperty,Xu=Object.getOwnPropertySymbols,Sc=Object.prototype.hasOwnProperty,_c=Object.prototype.propertyIsEnumerable,Yu=(p,h,a)=>h in p?Ac(p,h,{enumerable:!0,configurable:!0,writable:!0,value:a}):p[h]=a,Ku=(p,h)=>{for(var a in h||(h={}))Sc.call(h,a)&&Yu(p,a,h[a]);if(Xu)for(var a of Xu(h))_c.call(h,a)&&Yu(p,a,h[a]);return p};function hd(p,h,a){const f=Nc(a||{}),[w,m,E]=Mc(h,a==null?void 0:a.weightAttribute),H=pc(m,w,f,p?gt=>{h.updateEachNodeAttributes((Ut,Qt)=>Ku(Ku({},Qt),E(gt)[Ut]),{attributes:["x","y"]})}:void 0);if(!p)return E(H)}const ld=(p,h)=>hd(!1,p,h);ld.assign=(p,h)=>hd(!0,p,h);var Zs=(p,h,a)=>new Promise((f,w)=>{var m=H=>{try{R(a.next(H))}catch(gt){w(gt)}},E=H=>{try{R(a.throw(H))}catch(gt){w(gt)}},R=H=>H.done?f(H.value):Promise.resolve(H.value).then(m,E);R((a=a.apply(p,h)).next())});const Js=5,Qs=1,tu=5e3;function kc(p,h){return Zs(this,arguments,function*(a,{iterations:f}){const w=ld(a,{height:Br,width:Br,iterations:f||tu,speed:Js,gravity:Qs,C:1,edgeWeightInfluence:0});return cd(a,w,m=>{m.x=m.x+Br/2,m.y=m.y+Br/2})})}function Ic(p,h){return Zs(this,arguments,function*(a,{iterations:f}){const m=yield new sc({height:Br,width:Br,center:[Br/2,Br/2],gravity:Qs,speed:Js,maxIteration:f||tu}).execute(a);return Vs(m)})}function Dc(p,h){return Zs(this,arguments,function*(a,{iterations:f}){const m=yield new hc({height:Br,width:Br,center:[Br/2,Br/2],gravity:Qs,speed:Js,maxIteration:f||tu}).execute(a);return Vs(m)})}function Zu(p,h,a){return Zs(this,arguments,function*({nodes:f,edges:w,masses:m,weights:E},{iterations:R},{fruchterman:H}){const gt=Br*Br,Ut=Math.sqrt(gt)/10,Qt=gt/(f.length+1),Zt=Math.sqrt(Qt),{nodes:be}=yield H({nodes:f.length,edges:w,positions:f,masses:m,weights:E,iterations:R||tu,ka:Zt,kg:Qs,kr:.01,speed:Js,interval:.99,damping:Ut,center:[Br/2,Br/2]});return lu(be,w)})}var Du={exports:{}},Ds=typeof Reflect=="object"?Reflect:null,Ju=Ds&&typeof Ds.apply=="function"?Ds.apply:function(h,a,f){return Function.prototype.apply.call(h,a,f)},Ys;Ds&&typeof Ds.ownKeys=="function"?Ys=Ds.ownKeys:Object.getOwnPropertySymbols?Ys=function(h){return Object.getOwnPropertyNames(h).concat(Object.getOwnPropertySymbols(h))}:Ys=function(h){return Object.getOwnPropertyNames(h)};function Tc(p){console&&console.warn&&console.warn(p)}var fd=Number.isNaN||function(h){return h!==h};function gn(){gn.init.call(this)}Du.exports=gn;Du.exports.once=Lc;gn.EventEmitter=gn;gn.prototype._events=void 0;gn.prototype._eventsCount=0;gn.prototype._maxListeners=void 0;var Qu=10;function eu(p){if(typeof p!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof p)}Object.defineProperty(gn,"defaultMaxListeners",{enumerable:!0,get:function(){return Qu},set:function(p){if(typeof p!="number"||p<0||fd(p))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+p+".");Qu=p}});gn.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};gn.prototype.setMaxListeners=function(h){if(typeof h!="number"||h<0||fd(h))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+h+".");return this._maxListeners=h,this};function gd(p){return p._maxListeners===void 0?gn.defaultMaxListeners:p._maxListeners}gn.prototype.getMaxListeners=function(){return gd(this)};gn.prototype.emit=function(h){for(var a=[],f=1;f<arguments.length;f++)a.push(arguments[f]);var w=h==="error",m=this._events;if(m!==void 0)w=w&&m.error===void 0;else if(!w)return!1;if(w){var E;if(a.length>0&&(E=a[0]),E instanceof Error)throw E;var R=new Error("Unhandled error."+(E?" ("+E.message+")":""));throw R.context=E,R}var H=m[h];if(H===void 0)return!1;if(typeof H=="function")Ju(H,this,a);else for(var gt=H.length,Ut=wd(H,gt),f=0;f<gt;++f)Ju(Ut[f],this,a);return!0};function pd(p,h,a,f){var w,m,E;if(eu(a),m=p._events,m===void 0?(m=p._events=Object.create(null),p._eventsCount=0):(m.newListener!==void 0&&(p.emit("newListener",h,a.listener?a.listener:a),m=p._events),E=m[h]),E===void 0)E=m[h]=a,++p._eventsCount;else if(typeof E=="function"?E=m[h]=f?[a,E]:[E,a]:f?E.unshift(a):E.push(a),w=gd(p),w>0&&E.length>w&&!E.warned){E.warned=!0;var R=new Error("Possible EventEmitter memory leak detected. "+E.length+" "+String(h)+" listeners added. Use emitter.setMaxListeners() to increase limit");R.name="MaxListenersExceededWarning",R.emitter=p,R.type=h,R.count=E.length,Tc(R)}return p}gn.prototype.addListener=function(h,a){return pd(this,h,a,!1)};gn.prototype.on=gn.prototype.addListener;gn.prototype.prependListener=function(h,a){return pd(this,h,a,!0)};function Rc(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function vd(p,h,a){var f={fired:!1,wrapFn:void 0,target:p,type:h,listener:a},w=Rc.bind(f);return w.listener=a,f.wrapFn=w,w}gn.prototype.once=function(h,a){return eu(a),this.on(h,vd(this,h,a)),this};gn.prototype.prependOnceListener=function(h,a){return eu(a),this.prependListener(h,vd(this,h,a)),this};gn.prototype.removeListener=function(h,a){var f,w,m,E,R;if(eu(a),w=this._events,w===void 0)return this;if(f=w[h],f===void 0)return this;if(f===a||f.listener===a)--this._eventsCount===0?this._events=Object.create(null):(delete w[h],w.removeListener&&this.emit("removeListener",h,f.listener||a));else if(typeof f!="function"){for(m=-1,E=f.length-1;E>=0;E--)if(f[E]===a||f[E].listener===a){R=f[E].listener,m=E;break}if(m<0)return this;m===0?f.shift():Oc(f,m),f.length===1&&(w[h]=f[0]),w.removeListener!==void 0&&this.emit("removeListener",h,R||a)}return this};gn.prototype.off=gn.prototype.removeListener;gn.prototype.removeAllListeners=function(h){var a,f,w;if(f=this._events,f===void 0)return this;if(f.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):f[h]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete f[h]),this;if(arguments.length===0){var m=Object.keys(f),E;for(w=0;w<m.length;++w)E=m[w],E!=="removeListener"&&this.removeAllListeners(E);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(a=f[h],typeof a=="function")this.removeListener(h,a);else if(a!==void 0)for(w=a.length-1;w>=0;w--)this.removeListener(h,a[w]);return this};function md(p,h,a){var f=p._events;if(f===void 0)return[];var w=f[h];return w===void 0?[]:typeof w=="function"?a?[w.listener||w]:[w]:a?Cc(w):wd(w,w.length)}gn.prototype.listeners=function(h){return md(this,h,!0)};gn.prototype.rawListeners=function(h){return md(this,h,!1)};gn.listenerCount=function(p,h){return typeof p.listenerCount=="function"?p.listenerCount(h):yd.call(p,h)};gn.prototype.listenerCount=yd;function yd(p){var h=this._events;if(h!==void 0){var a=h[p];if(typeof a=="function")return 1;if(a!==void 0)return a.length}return 0}gn.prototype.eventNames=function(){return this._eventsCount>0?Ys(this._events):[]};function wd(p,h){for(var a=new Array(h),f=0;f<h;++f)a[f]=p[f];return a}function Oc(p,h){for(;h+1<p.length;h++)p[h]=p[h+1];p.pop()}function Cc(p){for(var h=new Array(p.length),a=0;a<h.length;++a)h[a]=p[a].listener||p[a];return h}function Lc(p,h){return new Promise(function(a,f){function w(E){p.removeListener(h,m),f(E)}function m(){typeof p.removeListener=="function"&&p.removeListener("error",w),a([].slice.call(arguments))}Ed(p,h,m,{once:!0}),h!=="error"&&Pc(p,w,{once:!0})})}function Pc(p,h,a){typeof p.on=="function"&&Ed(p,"error",h,a)}function Ed(p,h,a,f){if(typeof p.on=="function")f.once?p.once(h,a):p.on(h,a);else if(typeof p.addEventListener=="function")p.addEventListener(h,function w(m){f.once&&p.removeEventListener(h,w),a(m)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof p)}function Vi(p){if(typeof p!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=p}typeof Symbol<"u"&&(Vi.prototype[Symbol.iterator]=function(){return this});Vi.of=function(){var p=arguments,h=p.length,a=0;return new Vi(function(){return a>=h?{done:!0}:{done:!1,value:p[a++]}})};Vi.empty=function(){var p=new Vi(function(){return{done:!0}});return p};Vi.fromSequence=function(p){var h=0,a=p.length;return new Vi(function(){return h>=a?{done:!0}:{done:!1,value:p[h++]}})};Vi.is=function(p){return p instanceof Vi?!0:typeof p=="object"&&p!==null&&typeof p.next=="function"};var Oo=Vi,Tu={};Tu.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u";Tu.SYMBOL_SUPPORT=typeof Symbol<"u";var zc=Oo,xd=Tu,Gc=xd.ARRAY_BUFFER_SUPPORT,Fc=xd.SYMBOL_SUPPORT;function jc(p){return typeof p=="string"||Array.isArray(p)||Gc&&ArrayBuffer.isView(p)?zc.fromSequence(p):typeof p!="object"||p===null?null:Fc&&typeof p[Symbol.iterator]=="function"?p[Symbol.iterator]():typeof p.next=="function"?p:null}var bd=function(h){var a=jc(h);if(!a)throw new Error("obliterator: target is not iterable nor a valid iterator.");return a},Uc=bd,Nd=function(h,a){for(var f=arguments.length>1?a:1/0,w=f!==1/0?new Array(f):[],m,E=0,R=Uc(h);;){if(E===f)return w;if(m=R.next(),m.done)return E!==a&&(w.length=E),w;w[E++]=m.value}},Bc=Oo,Vc=bd,ya=function(){var h=arguments,a=null,f=-1;return new Bc(function(){var m=null;do{if(a===null){if(f++,f>=h.length)return{done:!0};a=Vc(h[f])}if(m=a.next(),m.done===!0){a=null;continue}break}while(!0);return m})};function qc(){const p=arguments[0];for(let h=1,a=arguments.length;h<a;h++)if(!!arguments[h])for(const f in arguments[h])p[f]=arguments[h][f];return p}let so=qc;typeof Object.assign=="function"&&(so=Object.assign);function ui(p,h,a,f){const w=p._nodes.get(h);let m=null;return w&&(f==="mixed"?m=w.out&&w.out[a]||w.undirected&&w.undirected[a]:f==="directed"?m=w.out&&w.out[a]:m=w.undirected&&w.undirected[a]),m}function go(p){return typeof p=="object"&&p!==null&&p.constructor===Object}function Md(p){let h;for(h in p)return!1;return!0}function ai(p,h,a){Object.defineProperty(p,h,{enumerable:!1,configurable:!1,writable:!0,value:a})}function bi(p,h,a){const f={enumerable:!0,configurable:!0};typeof a=="function"?f.get=a:(f.value=a,f.writable=!1),Object.defineProperty(p,h,f)}function td(p){return!(!go(p)||p.attributes&&!Array.isArray(p.attributes))}function Wc(){let p=Math.floor(Math.random()*256)&255;return()=>p++}class Ru extends Error{constructor(h){super(),this.name="GraphError",this.message=h}}class rr extends Ru{constructor(h){super(h),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,rr.prototype.constructor)}}class qe extends Ru{constructor(h){super(h),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,qe.prototype.constructor)}}class xr extends Ru{constructor(h){super(h),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,xr.prototype.constructor)}}function Ad(p,h){this.key=p,this.attributes=h,this.clear()}Ad.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function Sd(p,h){this.key=p,this.attributes=h,this.clear()}Sd.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function _d(p,h){this.key=p,this.attributes=h,this.clear()}_d.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function Ts(p,h,a,f,w){this.key=h,this.attributes=w,this.undirected=p,this.source=a,this.target=f}Ts.prototype.attach=function(){let p="out",h="in";this.undirected&&(p=h="undirected");const a=this.source.key,f=this.target.key;this.source[p][f]=this,!(this.undirected&&a===f)&&(this.target[h][a]=this)};Ts.prototype.attachMulti=function(){let p="out",h="in";const a=this.source.key,f=this.target.key;this.undirected&&(p=h="undirected");const w=this.source[p],m=w[f];if(typeof m>"u"){w[f]=this,this.undirected&&a===f||(this.target[h][a]=this);return}m.previous=this,this.next=m,w[f]=this,this.target[h][a]=this};Ts.prototype.detach=function(){const p=this.source.key,h=this.target.key;let a="out",f="in";this.undirected&&(a=f="undirected"),delete this.source[a][h],delete this.target[f][p]};Ts.prototype.detachMulti=function(){const p=this.source.key,h=this.target.key;let a="out",f="in";this.undirected&&(a=f="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[a][h],delete this.target[f][p]):(this.next.previous=void 0,this.source[a][h]=this.next,this.target[f][p]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const kd=0,Id=1,$c=2,Dd=3;function wa(p,h,a,f,w,m,E){let R,H,gt,Ut;if(f=""+f,a===kd){if(R=p._nodes.get(f),!R)throw new qe(`Graph.${h}: could not find the "${f}" node in the graph.`);gt=w,Ut=m}else if(a===Dd){if(w=""+w,H=p._edges.get(w),!H)throw new qe(`Graph.${h}: could not find the "${w}" edge in the graph.`);const Qt=H.source.key,Zt=H.target.key;if(f===Qt)R=H.target;else if(f===Zt)R=H.source;else throw new qe(`Graph.${h}: the "${f}" node is not attached to the "${w}" edge (${Qt}, ${Zt}).`);gt=m,Ut=E}else{if(H=p._edges.get(f),!H)throw new qe(`Graph.${h}: could not find the "${f}" edge in the graph.`);a===Id?R=H.source:R=H.target,gt=w,Ut=m}return[R,gt,Ut]}function Hc(p,h,a){p.prototype[h]=function(f,w,m){const[E,R]=wa(this,h,a,f,w,m);return E.attributes[R]}}function Xc(p,h,a){p.prototype[h]=function(f,w){const[m]=wa(this,h,a,f,w);return m.attributes}}function Yc(p,h,a){p.prototype[h]=function(f,w,m){const[E,R]=wa(this,h,a,f,w,m);return E.attributes.hasOwnProperty(R)}}function Kc(p,h,a){p.prototype[h]=function(f,w,m,E){const[R,H,gt]=wa(this,h,a,f,w,m,E);return R.attributes[H]=gt,this.emit("nodeAttributesUpdated",{key:R.key,type:"set",attributes:R.attributes,name:H}),this}}function Zc(p,h,a){p.prototype[h]=function(f,w,m,E){const[R,H,gt]=wa(this,h,a,f,w,m,E);if(typeof gt!="function")throw new rr(`Graph.${h}: updater should be a function.`);const Ut=R.attributes,Qt=gt(Ut[H]);return Ut[H]=Qt,this.emit("nodeAttributesUpdated",{key:R.key,type:"set",attributes:R.attributes,name:H}),this}}function Jc(p,h,a){p.prototype[h]=function(f,w,m){const[E,R]=wa(this,h,a,f,w,m);return delete E.attributes[R],this.emit("nodeAttributesUpdated",{key:E.key,type:"remove",attributes:E.attributes,name:R}),this}}function Qc(p,h,a){p.prototype[h]=function(f,w,m){const[E,R]=wa(this,h,a,f,w,m);if(!go(R))throw new rr(`Graph.${h}: provided attributes are not a plain object.`);return E.attributes=R,this.emit("nodeAttributesUpdated",{key:E.key,type:"replace",attributes:E.attributes}),this}}function th(p,h,a){p.prototype[h]=function(f,w,m){const[E,R]=wa(this,h,a,f,w,m);if(!go(R))throw new rr(`Graph.${h}: provided attributes are not a plain object.`);return so(E.attributes,R),this.emit("nodeAttributesUpdated",{key:E.key,type:"merge",attributes:E.attributes,data:R}),this}}function eh(p,h,a){p.prototype[h]=function(f,w,m){const[E,R]=wa(this,h,a,f,w,m);if(typeof R!="function")throw new rr(`Graph.${h}: provided updater is not a function.`);return E.attributes=R(E.attributes),this.emit("nodeAttributesUpdated",{key:E.key,type:"update",attributes:E.attributes}),this}}const rh=[{name:p=>`get${p}Attribute`,attacher:Hc},{name:p=>`get${p}Attributes`,attacher:Xc},{name:p=>`has${p}Attribute`,attacher:Yc},{name:p=>`set${p}Attribute`,attacher:Kc},{name:p=>`update${p}Attribute`,attacher:Zc},{name:p=>`remove${p}Attribute`,attacher:Jc},{name:p=>`replace${p}Attributes`,attacher:Qc},{name:p=>`merge${p}Attributes`,attacher:th},{name:p=>`update${p}Attributes`,attacher:eh}];function nh(p){rh.forEach(function({name:h,attacher:a}){a(p,h("Node"),kd),a(p,h("Source"),Id),a(p,h("Target"),$c),a(p,h("Opposite"),Dd)})}function oh(p,h,a){p.prototype[h]=function(f,w){let m;if(this.type!=="mixed"&&a!=="mixed"&&a!==this.type)throw new xr(`Graph.${h}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new xr(`Graph.${h}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const E=""+f,R=""+w;if(w=arguments[2],m=ui(this,E,R,a),!m)throw new qe(`Graph.${h}: could not find an edge for the given path ("${E}" - "${R}").`)}else{if(a!=="mixed")throw new xr(`Graph.${h}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(f=""+f,m=this._edges.get(f),!m)throw new qe(`Graph.${h}: could not find the "${f}" edge in the graph.`)}return m.attributes[w]}}function ih(p,h,a){p.prototype[h]=function(f){let w;if(this.type!=="mixed"&&a!=="mixed"&&a!==this.type)throw new xr(`Graph.${h}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new xr(`Graph.${h}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const m=""+f,E=""+arguments[1];if(w=ui(this,m,E,a),!w)throw new qe(`Graph.${h}: could not find an edge for the given path ("${m}" - "${E}").`)}else{if(a!=="mixed")throw new xr(`Graph.${h}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(f=""+f,w=this._edges.get(f),!w)throw new qe(`Graph.${h}: could not find the "${f}" edge in the graph.`)}return w.attributes}}function ah(p,h,a){p.prototype[h]=function(f,w){let m;if(this.type!=="mixed"&&a!=="mixed"&&a!==this.type)throw new xr(`Graph.${h}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new xr(`Graph.${h}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const E=""+f,R=""+w;if(w=arguments[2],m=ui(this,E,R,a),!m)throw new qe(`Graph.${h}: could not find an edge for the given path ("${E}" - "${R}").`)}else{if(a!=="mixed")throw new xr(`Graph.${h}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(f=""+f,m=this._edges.get(f),!m)throw new qe(`Graph.${h}: could not find the "${f}" edge in the graph.`)}return m.attributes.hasOwnProperty(w)}}function sh(p,h,a){p.prototype[h]=function(f,w,m){let E;if(this.type!=="mixed"&&a!=="mixed"&&a!==this.type)throw new xr(`Graph.${h}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new xr(`Graph.${h}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const R=""+f,H=""+w;if(w=arguments[2],m=arguments[3],E=ui(this,R,H,a),!E)throw new qe(`Graph.${h}: could not find an edge for the given path ("${R}" - "${H}").`)}else{if(a!=="mixed")throw new xr(`Graph.${h}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(f=""+f,E=this._edges.get(f),!E)throw new qe(`Graph.${h}: could not find the "${f}" edge in the graph.`)}return E.attributes[w]=m,this.emit("edgeAttributesUpdated",{key:E.key,type:"set",attributes:E.attributes,name:w}),this}}function uh(p,h,a){p.prototype[h]=function(f,w,m){let E;if(this.type!=="mixed"&&a!=="mixed"&&a!==this.type)throw new xr(`Graph.${h}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new xr(`Graph.${h}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const R=""+f,H=""+w;if(w=arguments[2],m=arguments[3],E=ui(this,R,H,a),!E)throw new qe(`Graph.${h}: could not find an edge for the given path ("${R}" - "${H}").`)}else{if(a!=="mixed")throw new xr(`Graph.${h}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(f=""+f,E=this._edges.get(f),!E)throw new qe(`Graph.${h}: could not find the "${f}" edge in the graph.`)}if(typeof m!="function")throw new rr(`Graph.${h}: updater should be a function.`);return E.attributes[w]=m(E.attributes[w]),this.emit("edgeAttributesUpdated",{key:E.key,type:"set",attributes:E.attributes,name:w}),this}}function dh(p,h,a){p.prototype[h]=function(f,w){let m;if(this.type!=="mixed"&&a!=="mixed"&&a!==this.type)throw new xr(`Graph.${h}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new xr(`Graph.${h}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const E=""+f,R=""+w;if(w=arguments[2],m=ui(this,E,R,a),!m)throw new qe(`Graph.${h}: could not find an edge for the given path ("${E}" - "${R}").`)}else{if(a!=="mixed")throw new xr(`Graph.${h}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(f=""+f,m=this._edges.get(f),!m)throw new qe(`Graph.${h}: could not find the "${f}" edge in the graph.`)}return delete m.attributes[w],this.emit("edgeAttributesUpdated",{key:m.key,type:"remove",attributes:m.attributes,name:w}),this}}function ch(p,h,a){p.prototype[h]=function(f,w){let m;if(this.type!=="mixed"&&a!=="mixed"&&a!==this.type)throw new xr(`Graph.${h}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new xr(`Graph.${h}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const E=""+f,R=""+w;if(w=arguments[2],m=ui(this,E,R,a),!m)throw new qe(`Graph.${h}: could not find an edge for the given path ("${E}" - "${R}").`)}else{if(a!=="mixed")throw new xr(`Graph.${h}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(f=""+f,m=this._edges.get(f),!m)throw new qe(`Graph.${h}: could not find the "${f}" edge in the graph.`)}if(!go(w))throw new rr(`Graph.${h}: provided attributes are not a plain object.`);return m.attributes=w,this.emit("edgeAttributesUpdated",{key:m.key,type:"replace",attributes:m.attributes}),this}}function hh(p,h,a){p.prototype[h]=function(f,w){let m;if(this.type!=="mixed"&&a!=="mixed"&&a!==this.type)throw new xr(`Graph.${h}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new xr(`Graph.${h}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const E=""+f,R=""+w;if(w=arguments[2],m=ui(this,E,R,a),!m)throw new qe(`Graph.${h}: could not find an edge for the given path ("${E}" - "${R}").`)}else{if(a!=="mixed")throw new xr(`Graph.${h}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(f=""+f,m=this._edges.get(f),!m)throw new qe(`Graph.${h}: could not find the "${f}" edge in the graph.`)}if(!go(w))throw new rr(`Graph.${h}: provided attributes are not a plain object.`);return so(m.attributes,w),this.emit("edgeAttributesUpdated",{key:m.key,type:"merge",attributes:m.attributes,data:w}),this}}function lh(p,h,a){p.prototype[h]=function(f,w){let m;if(this.type!=="mixed"&&a!=="mixed"&&a!==this.type)throw new xr(`Graph.${h}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new xr(`Graph.${h}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const E=""+f,R=""+w;if(w=arguments[2],m=ui(this,E,R,a),!m)throw new qe(`Graph.${h}: could not find an edge for the given path ("${E}" - "${R}").`)}else{if(a!=="mixed")throw new xr(`Graph.${h}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(f=""+f,m=this._edges.get(f),!m)throw new qe(`Graph.${h}: could not find the "${f}" edge in the graph.`)}if(typeof w!="function")throw new rr(`Graph.${h}: provided updater is not a function.`);return m.attributes=w(m.attributes),this.emit("edgeAttributesUpdated",{key:m.key,type:"update",attributes:m.attributes}),this}}const fh=[{name:p=>`get${p}Attribute`,attacher:oh},{name:p=>`get${p}Attributes`,attacher:ih},{name:p=>`has${p}Attribute`,attacher:ah},{name:p=>`set${p}Attribute`,attacher:sh},{name:p=>`update${p}Attribute`,attacher:uh},{name:p=>`remove${p}Attribute`,attacher:dh},{name:p=>`replace${p}Attributes`,attacher:ch},{name:p=>`merge${p}Attributes`,attacher:hh},{name:p=>`update${p}Attributes`,attacher:lh}];function gh(p){fh.forEach(function({name:h,attacher:a}){a(p,h("Edge"),"mixed"),a(p,h("DirectedEdge"),"directed"),a(p,h("UndirectedEdge"),"undirected")})}const ph=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function vh(p,h,a,f){let w=!1;for(const m in h){if(m===f)continue;const E=h[m];if(w=a(E.key,E.attributes,E.source.key,E.target.key,E.source.attributes,E.target.attributes,E.undirected),p&&w)return E.key}}function mh(p,h,a,f){let w,m,E,R=!1;for(const H in h)if(H!==f){w=h[H];do{if(m=w.source,E=w.target,R=a(w.key,w.attributes,m.key,E.key,m.attributes,E.attributes,w.undirected),p&&R)return w.key;w=w.next}while(w!==void 0)}}function au(p,h){const a=Object.keys(p),f=a.length;let w,m=0;return new Oo(function(){do if(w)w=w.next;else{if(m>=f)return{done:!0};const R=a[m++];if(R===h){w=void 0;continue}w=p[R]}while(!w);return{done:!1,value:{edge:w.key,attributes:w.attributes,source:w.source.key,target:w.target.key,sourceAttributes:w.source.attributes,targetAttributes:w.target.attributes,undirected:w.undirected}}})}function yh(p,h,a,f){const w=h[a];if(!w)return;const m=w.source,E=w.target;if(f(w.key,w.attributes,m.key,E.key,m.attributes,E.attributes,w.undirected)&&p)return w.key}function wh(p,h,a,f){let w=h[a];if(!w)return;let m=!1;do{if(m=f(w.key,w.attributes,w.source.key,w.target.key,w.source.attributes,w.target.attributes,w.undirected),p&&m)return w.key;w=w.next}while(w!==void 0)}function su(p,h){let a=p[h];return a.next!==void 0?new Oo(function(){if(!a)return{done:!0};const f={edge:a.key,attributes:a.attributes,source:a.source.key,target:a.target.key,sourceAttributes:a.source.attributes,targetAttributes:a.target.attributes,undirected:a.undirected};return a=a.next,{done:!1,value:f}}):Oo.of({edge:a.key,attributes:a.attributes,source:a.source.key,target:a.target.key,sourceAttributes:a.source.attributes,targetAttributes:a.target.attributes,undirected:a.undirected})}function Eh(p,h){if(p.size===0)return[];if(h==="mixed"||h===p.type)return typeof Array.from=="function"?Array.from(p._edges.keys()):Nd(p._edges.keys(),p._edges.size);const a=h==="undirected"?p.undirectedSize:p.directedSize,f=new Array(a),w=h==="undirected",m=p._edges.values();let E=0,R,H;for(;R=m.next(),R.done!==!0;)H=R.value,H.undirected===w&&(f[E++]=H.key);return f}function Td(p,h,a,f){if(h.size===0)return;const w=a!=="mixed"&&a!==h.type,m=a==="undirected";let E,R,H=!1;const gt=h._edges.values();for(;E=gt.next(),E.done!==!0;){if(R=E.value,w&&R.undirected!==m)continue;const{key:Ut,attributes:Qt,source:Zt,target:be}=R;if(H=f(Ut,Qt,Zt.key,be.key,Zt.attributes,be.attributes,R.undirected),p&&H)return Ut}}function xh(p,h){if(p.size===0)return Oo.empty();const a=h!=="mixed"&&h!==p.type,f=h==="undirected",w=p._edges.values();return new Oo(function(){let E,R;for(;;){if(E=w.next(),E.done)return E;if(R=E.value,!(a&&R.undirected!==f))break}return{value:{edge:R.key,attributes:R.attributes,source:R.source.key,target:R.target.key,sourceAttributes:R.source.attributes,targetAttributes:R.target.attributes,undirected:R.undirected},done:!1}})}function Ou(p,h,a,f,w,m){const E=h?mh:vh;let R;if(a!=="undirected"&&(f!=="out"&&(R=E(p,w.in,m),p&&R)||f!=="in"&&(R=E(p,w.out,m,f?void 0:w.key),p&&R))||a!=="directed"&&(R=E(p,w.undirected,m),p&&R))return R}function bh(p,h,a,f){const w=[];return Ou(!1,p,h,a,f,function(m){w.push(m)}),w}function Nh(p,h,a){let f=Oo.empty();return p!=="undirected"&&(h!=="out"&&typeof a.in<"u"&&(f=ya(f,au(a.in))),h!=="in"&&typeof a.out<"u"&&(f=ya(f,au(a.out,h?void 0:a.key)))),p!=="directed"&&typeof a.undirected<"u"&&(f=ya(f,au(a.undirected))),f}function Cu(p,h,a,f,w,m,E){const R=a?wh:yh;let H;if(h!=="undirected"&&(typeof w.in<"u"&&f!=="out"&&(H=R(p,w.in,m,E),p&&H)||typeof w.out<"u"&&f!=="in"&&(f||w.key!==m)&&(H=R(p,w.out,m,E),p&&H))||h!=="directed"&&typeof w.undirected<"u"&&(H=R(p,w.undirected,m,E),p&&H))return H}function Mh(p,h,a,f,w){const m=[];return Cu(!1,p,h,a,f,w,function(E){m.push(E)}),m}function Ah(p,h,a,f){let w=Oo.empty();return p!=="undirected"&&(typeof a.in<"u"&&h!=="out"&&f in a.in&&(w=ya(w,su(a.in,f))),typeof a.out<"u"&&h!=="in"&&f in a.out&&(h||a.key!==f)&&(w=ya(w,su(a.out,f)))),p!=="directed"&&typeof a.undirected<"u"&&f in a.undirected&&(w=ya(w,su(a.undirected,f))),w}function Sh(p,h){const{name:a,type:f,direction:w}=h;p.prototype[a]=function(m,E){if(f!=="mixed"&&this.type!=="mixed"&&f!==this.type)return[];if(!arguments.length)return Eh(this,f);if(arguments.length===1){m=""+m;const R=this._nodes.get(m);if(typeof R>"u")throw new qe(`Graph.${a}: could not find the "${m}" node in the graph.`);return bh(this.multi,f==="mixed"?this.type:f,w,R)}if(arguments.length===2){m=""+m,E=""+E;const R=this._nodes.get(m);if(!R)throw new qe(`Graph.${a}:  could not find the "${m}" source node in the graph.`);if(!this._nodes.has(E))throw new qe(`Graph.${a}:  could not find the "${E}" target node in the graph.`);return Mh(f,this.multi,w,R,E)}throw new rr(`Graph.${a}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function _h(p,h){const{name:a,type:f,direction:w}=h,m="forEach"+a[0].toUpperCase()+a.slice(1,-1);p.prototype[m]=function(gt,Ut,Qt){if(!(f!=="mixed"&&this.type!=="mixed"&&f!==this.type)){if(arguments.length===1)return Qt=gt,Td(!1,this,f,Qt);if(arguments.length===2){gt=""+gt,Qt=Ut;const Zt=this._nodes.get(gt);if(typeof Zt>"u")throw new qe(`Graph.${m}: could not find the "${gt}" node in the graph.`);return Ou(!1,this.multi,f==="mixed"?this.type:f,w,Zt,Qt)}if(arguments.length===3){gt=""+gt,Ut=""+Ut;const Zt=this._nodes.get(gt);if(!Zt)throw new qe(`Graph.${m}:  could not find the "${gt}" source node in the graph.`);if(!this._nodes.has(Ut))throw new qe(`Graph.${m}:  could not find the "${Ut}" target node in the graph.`);return Cu(!1,f,this.multi,w,Zt,Ut,Qt)}throw new rr(`Graph.${m}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const E="map"+a[0].toUpperCase()+a.slice(1);p.prototype[E]=function(){const gt=Array.prototype.slice.call(arguments),Ut=gt.pop();let Qt;if(gt.length===0){let Zt=0;f!=="directed"&&(Zt+=this.undirectedSize),f!=="undirected"&&(Zt+=this.directedSize),Qt=new Array(Zt);let be=0;gt.push((ie,Ze,me,ze,re,ir,sr)=>{Qt[be++]=Ut(ie,Ze,me,ze,re,ir,sr)})}else Qt=[],gt.push((Zt,be,ie,Ze,me,ze,re)=>{Qt.push(Ut(Zt,be,ie,Ze,me,ze,re))});return this[m].apply(this,gt),Qt};const R="filter"+a[0].toUpperCase()+a.slice(1);p.prototype[R]=function(){const gt=Array.prototype.slice.call(arguments),Ut=gt.pop(),Qt=[];return gt.push((Zt,be,ie,Ze,me,ze,re)=>{Ut(Zt,be,ie,Ze,me,ze,re)&&Qt.push(Zt)}),this[m].apply(this,gt),Qt};const H="reduce"+a[0].toUpperCase()+a.slice(1);p.prototype[H]=function(){let gt=Array.prototype.slice.call(arguments);if(gt.length<2||gt.length>4)throw new rr(`Graph.${H}: invalid number of arguments (expecting 2, 3 or 4 and got ${gt.length}).`);if(typeof gt[gt.length-1]=="function"&&typeof gt[gt.length-2]!="function")throw new rr(`Graph.${H}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let Ut,Qt;gt.length===2?(Ut=gt[0],Qt=gt[1],gt=[]):gt.length===3?(Ut=gt[1],Qt=gt[2],gt=[gt[0]]):gt.length===4&&(Ut=gt[2],Qt=gt[3],gt=[gt[0],gt[1]]);let Zt=Qt;return gt.push((be,ie,Ze,me,ze,re,ir)=>{Zt=Ut(Zt,be,ie,Ze,me,ze,re,ir)}),this[m].apply(this,gt),Zt}}function kh(p,h){const{name:a,type:f,direction:w}=h,m="find"+a[0].toUpperCase()+a.slice(1,-1);p.prototype[m]=function(H,gt,Ut){if(f!=="mixed"&&this.type!=="mixed"&&f!==this.type)return!1;if(arguments.length===1)return Ut=H,Td(!0,this,f,Ut);if(arguments.length===2){H=""+H,Ut=gt;const Qt=this._nodes.get(H);if(typeof Qt>"u")throw new qe(`Graph.${m}: could not find the "${H}" node in the graph.`);return Ou(!0,this.multi,f==="mixed"?this.type:f,w,Qt,Ut)}if(arguments.length===3){H=""+H,gt=""+gt;const Qt=this._nodes.get(H);if(!Qt)throw new qe(`Graph.${m}:  could not find the "${H}" source node in the graph.`);if(!this._nodes.has(gt))throw new qe(`Graph.${m}:  could not find the "${gt}" target node in the graph.`);return Cu(!0,f,this.multi,w,Qt,gt,Ut)}throw new rr(`Graph.${m}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const E="some"+a[0].toUpperCase()+a.slice(1,-1);p.prototype[E]=function(){const H=Array.prototype.slice.call(arguments),gt=H.pop();return H.push((Qt,Zt,be,ie,Ze,me,ze)=>gt(Qt,Zt,be,ie,Ze,me,ze)),!!this[m].apply(this,H)};const R="every"+a[0].toUpperCase()+a.slice(1,-1);p.prototype[R]=function(){const H=Array.prototype.slice.call(arguments),gt=H.pop();return H.push((Qt,Zt,be,ie,Ze,me,ze)=>!gt(Qt,Zt,be,ie,Ze,me,ze)),!this[m].apply(this,H)}}function Ih(p,h){const{name:a,type:f,direction:w}=h,m=a.slice(0,-1)+"Entries";p.prototype[m]=function(E,R){if(f!=="mixed"&&this.type!=="mixed"&&f!==this.type)return Oo.empty();if(!arguments.length)return xh(this,f);if(arguments.length===1){E=""+E;const H=this._nodes.get(E);if(!H)throw new qe(`Graph.${m}: could not find the "${E}" node in the graph.`);return Nh(f,w,H)}if(arguments.length===2){E=""+E,R=""+R;const H=this._nodes.get(E);if(!H)throw new qe(`Graph.${m}:  could not find the "${E}" source node in the graph.`);if(!this._nodes.has(R))throw new qe(`Graph.${m}:  could not find the "${R}" target node in the graph.`);return Ah(f,w,H,R)}throw new rr(`Graph.${m}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Dh(p){ph.forEach(h=>{Sh(p,h),_h(p,h),kh(p,h),Ih(p,h)})}const Th=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function ru(){this.A=null,this.B=null}ru.prototype.wrap=function(p){this.A===null?this.A=p:this.B===null&&(this.B=p)};ru.prototype.has=function(p){return this.A!==null&&p in this.A||this.B!==null&&p in this.B};function Fs(p,h,a,f,w){for(const m in f){const E=f[m],R=E.source,H=E.target,gt=R===a?H:R;if(h&&h.has(gt.key))continue;const Ut=w(gt.key,gt.attributes);if(p&&Ut)return gt.key}}function Lu(p,h,a,f,w){if(h!=="mixed"){if(h==="undirected")return Fs(p,null,f,f.undirected,w);if(typeof a=="string")return Fs(p,null,f,f[a],w)}const m=new ru;let E;if(h!=="undirected"){if(a!=="out"){if(E=Fs(p,null,f,f.in,w),p&&E)return E;m.wrap(f.in)}if(a!=="in"){if(E=Fs(p,m,f,f.out,w),p&&E)return E;m.wrap(f.out)}}if(h!=="directed"&&(E=Fs(p,m,f,f.undirected,w),p&&E))return E}function Rh(p,h,a){if(p!=="mixed"){if(p==="undirected")return Object.keys(a.undirected);if(typeof h=="string")return Object.keys(a[h])}const f=[];return Lu(!1,p,h,a,function(w){f.push(w)}),f}function js(p,h,a){const f=Object.keys(a),w=f.length;let m=0;return new Oo(function(){let R=null;do{if(m>=w)return p&&p.wrap(a),{done:!0};const H=a[f[m++]],gt=H.source,Ut=H.target;if(R=gt===h?Ut:gt,p&&p.has(R.key)){R=null;continue}}while(R===null);return{done:!1,value:{neighbor:R.key,attributes:R.attributes}}})}function Oh(p,h,a){if(p!=="mixed"){if(p==="undirected")return js(null,a,a.undirected);if(typeof h=="string")return js(null,a,a[h])}let f=Oo.empty();const w=new ru;return p!=="undirected"&&(h!=="out"&&(f=ya(f,js(w,a,a.in))),h!=="in"&&(f=ya(f,js(w,a,a.out)))),p!=="directed"&&(f=ya(f,js(w,a,a.undirected))),f}function Ch(p,h){const{name:a,type:f,direction:w}=h;p.prototype[a]=function(m){if(f!=="mixed"&&this.type!=="mixed"&&f!==this.type)return[];m=""+m;const E=this._nodes.get(m);if(typeof E>"u")throw new qe(`Graph.${a}: could not find the "${m}" node in the graph.`);return Rh(f==="mixed"?this.type:f,w,E)}}function Lh(p,h){const{name:a,type:f,direction:w}=h,m="forEach"+a[0].toUpperCase()+a.slice(1,-1);p.prototype[m]=function(gt,Ut){if(f!=="mixed"&&this.type!=="mixed"&&f!==this.type)return;gt=""+gt;const Qt=this._nodes.get(gt);if(typeof Qt>"u")throw new qe(`Graph.${m}: could not find the "${gt}" node in the graph.`);Lu(!1,f==="mixed"?this.type:f,w,Qt,Ut)};const E="map"+a[0].toUpperCase()+a.slice(1);p.prototype[E]=function(gt,Ut){const Qt=[];return this[m](gt,(Zt,be)=>{Qt.push(Ut(Zt,be))}),Qt};const R="filter"+a[0].toUpperCase()+a.slice(1);p.prototype[R]=function(gt,Ut){const Qt=[];return this[m](gt,(Zt,be)=>{Ut(Zt,be)&&Qt.push(Zt)}),Qt};const H="reduce"+a[0].toUpperCase()+a.slice(1);p.prototype[H]=function(gt,Ut,Qt){if(arguments.length<3)throw new rr(`Graph.${H}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let Zt=Qt;return this[m](gt,(be,ie)=>{Zt=Ut(Zt,be,ie)}),Zt}}function Ph(p,h){const{name:a,type:f,direction:w}=h,m=a[0].toUpperCase()+a.slice(1,-1),E="find"+m;p.prototype[E]=function(gt,Ut){if(f!=="mixed"&&this.type!=="mixed"&&f!==this.type)return;gt=""+gt;const Qt=this._nodes.get(gt);if(typeof Qt>"u")throw new qe(`Graph.${E}: could not find the "${gt}" node in the graph.`);return Lu(!0,f==="mixed"?this.type:f,w,Qt,Ut)};const R="some"+m;p.prototype[R]=function(gt,Ut){return!!this[E](gt,Ut)};const H="every"+m;p.prototype[H]=function(gt,Ut){return!this[E](gt,(Zt,be)=>!Ut(Zt,be))}}function zh(p,h){const{name:a,type:f,direction:w}=h,m=a.slice(0,-1)+"Entries";p.prototype[m]=function(E){if(f!=="mixed"&&this.type!=="mixed"&&f!==this.type)return Oo.empty();E=""+E;const R=this._nodes.get(E);if(typeof R>"u")throw new qe(`Graph.${m}: could not find the "${E}" node in the graph.`);return Oh(f==="mixed"?this.type:f,w,R)}}function Gh(p){Th.forEach(h=>{Ch(p,h),Lh(p,h),Ph(p,h),zh(p,h)})}function Xs(p,h,a,f,w){const m=f._nodes.values(),E=f.type;let R,H,gt,Ut,Qt,Zt,be;for(;R=m.next(),R.done!==!0;){let ie=!1;if(H=R.value,E!=="undirected"){Ut=H.out;for(gt in Ut){Qt=Ut[gt];do{if(Zt=Qt.target,ie=!0,be=w(H.key,Zt.key,H.attributes,Zt.attributes,Qt.key,Qt.attributes,Qt.undirected),p&&be)return Qt;Qt=Qt.next}while(Qt)}}if(E!=="directed"){Ut=H.undirected;for(gt in Ut)if(!(h&&H.key>gt)){Qt=Ut[gt];do{if(Zt=Qt.target,Zt.key!==gt&&(Zt=Qt.source),ie=!0,be=w(H.key,Zt.key,H.attributes,Zt.attributes,Qt.key,Qt.attributes,Qt.undirected),p&&be)return Qt;Qt=Qt.next}while(Qt)}}if(a&&!ie&&(be=w(H.key,null,H.attributes,null,null,null,null),p&&be))return null}}function Fh(p,h){const a={key:p};return Md(h.attributes)||(a.attributes=so({},h.attributes)),a}function jh(p,h,a){const f={key:h,source:a.source.key,target:a.target.key};return Md(a.attributes)||(f.attributes=so({},a.attributes)),p==="mixed"&&a.undirected&&(f.undirected=!0),f}function Uh(p){if(!go(p))throw new rr('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in p))throw new rr("Graph.import: serialized node is missing its key.");if("attributes"in p&&(!go(p.attributes)||p.attributes===null))throw new rr("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function Bh(p){if(!go(p))throw new rr('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in p))throw new rr("Graph.import: serialized edge is missing its source.");if(!("target"in p))throw new rr("Graph.import: serialized edge is missing its target.");if("attributes"in p&&(!go(p.attributes)||p.attributes===null))throw new rr("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in p&&typeof p.undirected!="boolean")throw new rr("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const Vh=Wc(),qh=new Set(["directed","undirected","mixed"]),ed=new Set(["domain","_events","_eventsCount","_maxListeners"]),Wh=[{name:p=>`${p}Edge`,generateKey:!0},{name:p=>`${p}DirectedEdge`,generateKey:!0,type:"directed"},{name:p=>`${p}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:p=>`${p}EdgeWithKey`},{name:p=>`${p}DirectedEdgeWithKey`,type:"directed"},{name:p=>`${p}UndirectedEdgeWithKey`,type:"undirected"}],$h={allowSelfLoops:!0,multi:!1,type:"mixed"};function Hh(p,h,a){if(a&&!go(a))throw new rr(`Graph.addNode: invalid attributes. Expecting an object but got "${a}"`);if(h=""+h,a=a||{},p._nodes.has(h))throw new xr(`Graph.addNode: the "${h}" node already exist in the graph.`);const f=new p.NodeDataClass(h,a);return p._nodes.set(h,f),p.emit("nodeAdded",{key:h,attributes:a}),f}function rd(p,h,a){const f=new p.NodeDataClass(h,a);return p._nodes.set(h,f),p.emit("nodeAdded",{key:h,attributes:a}),f}function Rd(p,h,a,f,w,m,E,R){if(!f&&p.type==="undirected")throw new xr(`Graph.${h}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(f&&p.type==="directed")throw new xr(`Graph.${h}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(R&&!go(R))throw new rr(`Graph.${h}: invalid attributes. Expecting an object but got "${R}"`);if(m=""+m,E=""+E,R=R||{},!p.allowSelfLoops&&m===E)throw new xr(`Graph.${h}: source & target are the same ("${m}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const H=p._nodes.get(m),gt=p._nodes.get(E);if(!H)throw new qe(`Graph.${h}: source node "${m}" not found.`);if(!gt)throw new qe(`Graph.${h}: target node "${E}" not found.`);const Ut={key:null,undirected:f,source:m,target:E,attributes:R};if(a)w=p._edgeKeyGenerator();else if(w=""+w,p._edges.has(w))throw new xr(`Graph.${h}: the "${w}" edge already exists in the graph.`);if(!p.multi&&(f?typeof H.undirected[E]<"u":typeof H.out[E]<"u"))throw new xr(`Graph.${h}: an edge linking "${m}" to "${E}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const Qt=new Ts(f,w,H,gt,R);p._edges.set(w,Qt);const Zt=m===E;return f?(H.undirectedDegree++,gt.undirectedDegree++,Zt&&(H.undirectedLoops++,p._undirectedSelfLoopCount++)):(H.outDegree++,gt.inDegree++,Zt&&(H.directedLoops++,p._directedSelfLoopCount++)),p.multi?Qt.attachMulti():Qt.attach(),f?p._undirectedSize++:p._directedSize++,Ut.key=w,p.emit("edgeAdded",Ut),w}function Xh(p,h,a,f,w,m,E,R,H){if(!f&&p.type==="undirected")throw new xr(`Graph.${h}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(f&&p.type==="directed")throw new xr(`Graph.${h}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(R){if(H){if(typeof R!="function")throw new rr(`Graph.${h}: invalid updater function. Expecting a function but got "${R}"`)}else if(!go(R))throw new rr(`Graph.${h}: invalid attributes. Expecting an object but got "${R}"`)}m=""+m,E=""+E;let gt;if(H&&(gt=R,R=void 0),!p.allowSelfLoops&&m===E)throw new xr(`Graph.${h}: source & target are the same ("${m}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let Ut=p._nodes.get(m),Qt=p._nodes.get(E),Zt,be;if(!a&&(Zt=p._edges.get(w),Zt)){if((Zt.source.key!==m||Zt.target.key!==E)&&(!f||Zt.source.key!==E||Zt.target.key!==m))throw new xr(`Graph.${h}: inconsistency detected when attempting to merge the "${w}" edge with "${m}" source & "${E}" target vs. ("${Zt.source.key}", "${Zt.target.key}").`);be=Zt}if(!be&&!p.multi&&Ut&&(be=f?Ut.undirected[E]:Ut.out[E]),be){const re=[be.key,!1,!1,!1];if(H?!gt:!R)return re;if(H){const ir=be.attributes;be.attributes=gt(ir),p.emit("edgeAttributesUpdated",{type:"replace",key:be.key,attributes:be.attributes})}else so(be.attributes,R),p.emit("edgeAttributesUpdated",{type:"merge",key:be.key,attributes:be.attributes,data:R});return re}R=R||{},H&&gt&&(R=gt(R));const ie={key:null,undirected:f,source:m,target:E,attributes:R};if(a)w=p._edgeKeyGenerator();else if(w=""+w,p._edges.has(w))throw new xr(`Graph.${h}: the "${w}" edge already exists in the graph.`);let Ze=!1,me=!1;Ut||(Ut=rd(p,m,{}),Ze=!0,m===E&&(Qt=Ut,me=!0)),Qt||(Qt=rd(p,E,{}),me=!0),Zt=new Ts(f,w,Ut,Qt,R),p._edges.set(w,Zt);const ze=m===E;return f?(Ut.undirectedDegree++,Qt.undirectedDegree++,ze&&(Ut.undirectedLoops++,p._undirectedSelfLoopCount++)):(Ut.outDegree++,Qt.inDegree++,ze&&(Ut.directedLoops++,p._directedSelfLoopCount++)),p.multi?Zt.attachMulti():Zt.attach(),f?p._undirectedSize++:p._directedSize++,ie.key=w,p.emit("edgeAdded",ie),[w,!0,Ze,me]}function ks(p,h){p._edges.delete(h.key);const{source:a,target:f,attributes:w}=h,m=h.undirected,E=a===f;m?(a.undirectedDegree--,f.undirectedDegree--,E&&(a.undirectedLoops--,p._undirectedSelfLoopCount--)):(a.outDegree--,f.inDegree--,E&&(a.directedLoops--,p._directedSelfLoopCount--)),p.multi?h.detachMulti():h.detach(),m?p._undirectedSize--:p._directedSize--,p.emit("edgeDropped",{key:h.key,attributes:w,source:a.key,target:f.key,undirected:m})}class un extends Du.exports.EventEmitter{constructor(h){if(super(),h=so({},$h,h),typeof h.multi!="boolean")throw new rr(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${h.multi}".`);if(!qh.has(h.type))throw new rr(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${h.type}".`);if(typeof h.allowSelfLoops!="boolean")throw new rr(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${h.allowSelfLoops}".`);const a=h.type==="mixed"?Ad:h.type==="directed"?Sd:_d;ai(this,"NodeDataClass",a);const f="geid_"+Vh()+"_";let w=0;const m=()=>{let E;do E=f+w++;while(this._edges.has(E));return E};ai(this,"_attributes",{}),ai(this,"_nodes",new Map),ai(this,"_edges",new Map),ai(this,"_directedSize",0),ai(this,"_undirectedSize",0),ai(this,"_directedSelfLoopCount",0),ai(this,"_undirectedSelfLoopCount",0),ai(this,"_edgeKeyGenerator",m),ai(this,"_options",h),ed.forEach(E=>ai(this,E,this[E])),bi(this,"order",()=>this._nodes.size),bi(this,"size",()=>this._edges.size),bi(this,"directedSize",()=>this._directedSize),bi(this,"undirectedSize",()=>this._undirectedSize),bi(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),bi(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),bi(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),bi(this,"multi",this._options.multi),bi(this,"type",this._options.type),bi(this,"allowSelfLoops",this._options.allowSelfLoops),bi(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(h){return this._nodes.has(""+h)}hasDirectedEdge(h,a){if(this.type==="undirected")return!1;if(arguments.length===1){const f=""+h,w=this._edges.get(f);return!!w&&!w.undirected}else if(arguments.length===2){h=""+h,a=""+a;const f=this._nodes.get(h);return f?f.out.hasOwnProperty(a):!1}throw new rr(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(h,a){if(this.type==="directed")return!1;if(arguments.length===1){const f=""+h,w=this._edges.get(f);return!!w&&w.undirected}else if(arguments.length===2){h=""+h,a=""+a;const f=this._nodes.get(h);return f?f.undirected.hasOwnProperty(a):!1}throw new rr(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(h,a){if(arguments.length===1){const f=""+h;return this._edges.has(f)}else if(arguments.length===2){h=""+h,a=""+a;const f=this._nodes.get(h);return f?typeof f.out<"u"&&f.out.hasOwnProperty(a)||typeof f.undirected<"u"&&f.undirected.hasOwnProperty(a):!1}throw new rr(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(h,a){if(this.type==="undirected")return;if(h=""+h,a=""+a,this.multi)throw new xr("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const f=this._nodes.get(h);if(!f)throw new qe(`Graph.directedEdge: could not find the "${h}" source node in the graph.`);if(!this._nodes.has(a))throw new qe(`Graph.directedEdge: could not find the "${a}" target node in the graph.`);const w=f.out&&f.out[a]||void 0;if(w)return w.key}undirectedEdge(h,a){if(this.type==="directed")return;if(h=""+h,a=""+a,this.multi)throw new xr("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const f=this._nodes.get(h);if(!f)throw new qe(`Graph.undirectedEdge: could not find the "${h}" source node in the graph.`);if(!this._nodes.has(a))throw new qe(`Graph.undirectedEdge: could not find the "${a}" target node in the graph.`);const w=f.undirected&&f.undirected[a]||void 0;if(w)return w.key}edge(h,a){if(this.multi)throw new xr("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");h=""+h,a=""+a;const f=this._nodes.get(h);if(!f)throw new qe(`Graph.edge: could not find the "${h}" source node in the graph.`);if(!this._nodes.has(a))throw new qe(`Graph.edge: could not find the "${a}" target node in the graph.`);const w=f.out&&f.out[a]||f.undirected&&f.undirected[a]||void 0;if(w)return w.key}areDirectedNeighbors(h,a){h=""+h,a=""+a;const f=this._nodes.get(h);if(!f)throw new qe(`Graph.areDirectedNeighbors: could not find the "${h}" node in the graph.`);return this.type==="undirected"?!1:a in f.in||a in f.out}areOutNeighbors(h,a){h=""+h,a=""+a;const f=this._nodes.get(h);if(!f)throw new qe(`Graph.areOutNeighbors: could not find the "${h}" node in the graph.`);return this.type==="undirected"?!1:a in f.out}areInNeighbors(h,a){h=""+h,a=""+a;const f=this._nodes.get(h);if(!f)throw new qe(`Graph.areInNeighbors: could not find the "${h}" node in the graph.`);return this.type==="undirected"?!1:a in f.in}areUndirectedNeighbors(h,a){h=""+h,a=""+a;const f=this._nodes.get(h);if(!f)throw new qe(`Graph.areUndirectedNeighbors: could not find the "${h}" node in the graph.`);return this.type==="directed"?!1:a in f.undirected}areNeighbors(h,a){h=""+h,a=""+a;const f=this._nodes.get(h);if(!f)throw new qe(`Graph.areNeighbors: could not find the "${h}" node in the graph.`);return this.type!=="undirected"&&(a in f.in||a in f.out)||this.type!=="directed"&&a in f.undirected}areInboundNeighbors(h,a){h=""+h,a=""+a;const f=this._nodes.get(h);if(!f)throw new qe(`Graph.areInboundNeighbors: could not find the "${h}" node in the graph.`);return this.type!=="undirected"&&a in f.in||this.type!=="directed"&&a in f.undirected}areOutboundNeighbors(h,a){h=""+h,a=""+a;const f=this._nodes.get(h);if(!f)throw new qe(`Graph.areOutboundNeighbors: could not find the "${h}" node in the graph.`);return this.type!=="undirected"&&a in f.out||this.type!=="directed"&&a in f.undirected}inDegree(h){h=""+h;const a=this._nodes.get(h);if(!a)throw new qe(`Graph.inDegree: could not find the "${h}" node in the graph.`);return this.type==="undirected"?0:a.inDegree}outDegree(h){h=""+h;const a=this._nodes.get(h);if(!a)throw new qe(`Graph.outDegree: could not find the "${h}" node in the graph.`);return this.type==="undirected"?0:a.outDegree}directedDegree(h){h=""+h;const a=this._nodes.get(h);if(!a)throw new qe(`Graph.directedDegree: could not find the "${h}" node in the graph.`);return this.type==="undirected"?0:a.inDegree+a.outDegree}undirectedDegree(h){h=""+h;const a=this._nodes.get(h);if(!a)throw new qe(`Graph.undirectedDegree: could not find the "${h}" node in the graph.`);return this.type==="directed"?0:a.undirectedDegree}inboundDegree(h){h=""+h;const a=this._nodes.get(h);if(!a)throw new qe(`Graph.inboundDegree: could not find the "${h}" node in the graph.`);let f=0;return this.type!=="directed"&&(f+=a.undirectedDegree),this.type!=="undirected"&&(f+=a.inDegree),f}outboundDegree(h){h=""+h;const a=this._nodes.get(h);if(!a)throw new qe(`Graph.outboundDegree: could not find the "${h}" node in the graph.`);let f=0;return this.type!=="directed"&&(f+=a.undirectedDegree),this.type!=="undirected"&&(f+=a.outDegree),f}degree(h){h=""+h;const a=this._nodes.get(h);if(!a)throw new qe(`Graph.degree: could not find the "${h}" node in the graph.`);let f=0;return this.type!=="directed"&&(f+=a.undirectedDegree),this.type!=="undirected"&&(f+=a.inDegree+a.outDegree),f}inDegreeWithoutSelfLoops(h){h=""+h;const a=this._nodes.get(h);if(!a)throw new qe(`Graph.inDegreeWithoutSelfLoops: could not find the "${h}" node in the graph.`);return this.type==="undirected"?0:a.inDegree-a.directedLoops}outDegreeWithoutSelfLoops(h){h=""+h;const a=this._nodes.get(h);if(!a)throw new qe(`Graph.outDegreeWithoutSelfLoops: could not find the "${h}" node in the graph.`);return this.type==="undirected"?0:a.outDegree-a.directedLoops}directedDegreeWithoutSelfLoops(h){h=""+h;const a=this._nodes.get(h);if(!a)throw new qe(`Graph.directedDegreeWithoutSelfLoops: could not find the "${h}" node in the graph.`);return this.type==="undirected"?0:a.inDegree+a.outDegree-a.directedLoops*2}undirectedDegreeWithoutSelfLoops(h){h=""+h;const a=this._nodes.get(h);if(!a)throw new qe(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${h}" node in the graph.`);return this.type==="directed"?0:a.undirectedDegree-a.undirectedLoops*2}inboundDegreeWithoutSelfLoops(h){h=""+h;const a=this._nodes.get(h);if(!a)throw new qe(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${h}" node in the graph.`);let f=0,w=0;return this.type!=="directed"&&(f+=a.undirectedDegree,w+=a.undirectedLoops*2),this.type!=="undirected"&&(f+=a.inDegree,w+=a.directedLoops),f-w}outboundDegreeWithoutSelfLoops(h){h=""+h;const a=this._nodes.get(h);if(!a)throw new qe(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${h}" node in the graph.`);let f=0,w=0;return this.type!=="directed"&&(f+=a.undirectedDegree,w+=a.undirectedLoops*2),this.type!=="undirected"&&(f+=a.outDegree,w+=a.directedLoops),f-w}degreeWithoutSelfLoops(h){h=""+h;const a=this._nodes.get(h);if(!a)throw new qe(`Graph.degreeWithoutSelfLoops: could not find the "${h}" node in the graph.`);let f=0,w=0;return this.type!=="directed"&&(f+=a.undirectedDegree,w+=a.undirectedLoops*2),this.type!=="undirected"&&(f+=a.inDegree+a.outDegree,w+=a.directedLoops*2),f-w}source(h){h=""+h;const a=this._edges.get(h);if(!a)throw new qe(`Graph.source: could not find the "${h}" edge in the graph.`);return a.source.key}target(h){h=""+h;const a=this._edges.get(h);if(!a)throw new qe(`Graph.target: could not find the "${h}" edge in the graph.`);return a.target.key}extremities(h){h=""+h;const a=this._edges.get(h);if(!a)throw new qe(`Graph.extremities: could not find the "${h}" edge in the graph.`);return[a.source.key,a.target.key]}opposite(h,a){h=""+h,a=""+a;const f=this._edges.get(a);if(!f)throw new qe(`Graph.opposite: could not find the "${a}" edge in the graph.`);const w=f.source.key,m=f.target.key;if(h===w)return m;if(h===m)return w;throw new qe(`Graph.opposite: the "${h}" node is not attached to the "${a}" edge (${w}, ${m}).`)}hasExtremity(h,a){h=""+h,a=""+a;const f=this._edges.get(h);if(!f)throw new qe(`Graph.hasExtremity: could not find the "${h}" edge in the graph.`);return f.source.key===a||f.target.key===a}isUndirected(h){h=""+h;const a=this._edges.get(h);if(!a)throw new qe(`Graph.isUndirected: could not find the "${h}" edge in the graph.`);return a.undirected}isDirected(h){h=""+h;const a=this._edges.get(h);if(!a)throw new qe(`Graph.isDirected: could not find the "${h}" edge in the graph.`);return!a.undirected}isSelfLoop(h){h=""+h;const a=this._edges.get(h);if(!a)throw new qe(`Graph.isSelfLoop: could not find the "${h}" edge in the graph.`);return a.source===a.target}addNode(h,a){return Hh(this,h,a).key}mergeNode(h,a){if(a&&!go(a))throw new rr(`Graph.mergeNode: invalid attributes. Expecting an object but got "${a}"`);h=""+h,a=a||{};let f=this._nodes.get(h);return f?(a&&(so(f.attributes,a),this.emit("nodeAttributesUpdated",{type:"merge",key:h,attributes:f.attributes,data:a})),[h,!1]):(f=new this.NodeDataClass(h,a),this._nodes.set(h,f),this.emit("nodeAdded",{key:h,attributes:a}),[h,!0])}updateNode(h,a){if(a&&typeof a!="function")throw new rr(`Graph.updateNode: invalid updater function. Expecting a function but got "${a}"`);h=""+h;let f=this._nodes.get(h);if(f){if(a){const m=f.attributes;f.attributes=a(m),this.emit("nodeAttributesUpdated",{type:"replace",key:h,attributes:f.attributes})}return[h,!1]}const w=a?a({}):{};return f=new this.NodeDataClass(h,w),this._nodes.set(h,f),this.emit("nodeAdded",{key:h,attributes:w}),[h,!0]}dropNode(h){h=""+h;const a=this._nodes.get(h);if(!a)throw new qe(`Graph.dropNode: could not find the "${h}" node in the graph.`);let f;if(this.type!=="undirected"){for(const w in a.out){f=a.out[w];do ks(this,f),f=f.next;while(f)}for(const w in a.in){f=a.in[w];do ks(this,f),f=f.next;while(f)}}if(this.type!=="directed")for(const w in a.undirected){f=a.undirected[w];do ks(this,f),f=f.next;while(f)}this._nodes.delete(h),this.emit("nodeDropped",{key:h,attributes:a.attributes})}dropEdge(h){let a;if(arguments.length>1){const f=""+arguments[0],w=""+arguments[1];if(a=ui(this,f,w,this.type),!a)throw new qe(`Graph.dropEdge: could not find the "${f}" -> "${w}" edge in the graph.`)}else if(h=""+h,a=this._edges.get(h),!a)throw new qe(`Graph.dropEdge: could not find the "${h}" edge in the graph.`);return ks(this,a),this}dropDirectedEdge(h,a){if(arguments.length<2)throw new xr("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new xr("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");h=""+h,a=""+a;const f=ui(this,h,a,"directed");if(!f)throw new qe(`Graph.dropDirectedEdge: could not find a "${h}" -> "${a}" edge in the graph.`);return ks(this,f),this}dropUndirectedEdge(h,a){if(arguments.length<2)throw new xr("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new xr("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const f=ui(this,h,a,"undirected");if(!f)throw new qe(`Graph.dropUndirectedEdge: could not find a "${h}" -> "${a}" edge in the graph.`);return ks(this,f),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const h=this._nodes.values();let a;for(;a=h.next(),a.done!==!0;)a.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(h){return this._attributes[h]}getAttributes(){return this._attributes}hasAttribute(h){return this._attributes.hasOwnProperty(h)}setAttribute(h,a){return this._attributes[h]=a,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:h}),this}updateAttribute(h,a){if(typeof a!="function")throw new rr("Graph.updateAttribute: updater should be a function.");const f=this._attributes[h];return this._attributes[h]=a(f),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:h}),this}removeAttribute(h){return delete this._attributes[h],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:h}),this}replaceAttributes(h){if(!go(h))throw new rr("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=h,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(h){if(!go(h))throw new rr("Graph.mergeAttributes: provided attributes are not a plain object.");return so(this._attributes,h),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:h}),this}updateAttributes(h){if(typeof h!="function")throw new rr("Graph.updateAttributes: provided updater is not a function.");return this._attributes=h(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(h,a){if(typeof h!="function")throw new rr("Graph.updateEachNodeAttributes: expecting an updater function.");if(a&&!td(a))throw new rr("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const f=this._nodes.values();let w,m;for(;w=f.next(),w.done!==!0;)m=w.value,m.attributes=h(m.key,m.attributes);this.emit("eachNodeAttributesUpdated",{hints:a||null})}updateEachEdgeAttributes(h,a){if(typeof h!="function")throw new rr("Graph.updateEachEdgeAttributes: expecting an updater function.");if(a&&!td(a))throw new rr("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const f=this._edges.values();let w,m,E,R;for(;w=f.next(),w.done!==!0;)m=w.value,E=m.source,R=m.target,m.attributes=h(m.key,m.attributes,E.key,R.key,E.attributes,R.attributes,m.undirected);this.emit("eachEdgeAttributesUpdated",{hints:a||null})}forEachAdjacencyEntry(h){if(typeof h!="function")throw new rr("Graph.forEachAdjacencyEntry: expecting a callback.");Xs(!1,!1,!1,this,h)}forEachAdjacencyEntryWithOrphans(h){if(typeof h!="function")throw new rr("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");Xs(!1,!1,!0,this,h)}forEachAssymetricAdjacencyEntry(h){if(typeof h!="function")throw new rr("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");Xs(!1,!0,!1,this,h)}forEachAssymetricAdjacencyEntryWithOrphans(h){if(typeof h!="function")throw new rr("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");Xs(!1,!0,!0,this,h)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):Nd(this._nodes.keys(),this._nodes.size)}forEachNode(h){if(typeof h!="function")throw new rr("Graph.forEachNode: expecting a callback.");const a=this._nodes.values();let f,w;for(;f=a.next(),f.done!==!0;)w=f.value,h(w.key,w.attributes)}findNode(h){if(typeof h!="function")throw new rr("Graph.findNode: expecting a callback.");const a=this._nodes.values();let f,w;for(;f=a.next(),f.done!==!0;)if(w=f.value,h(w.key,w.attributes))return w.key}mapNodes(h){if(typeof h!="function")throw new rr("Graph.mapNode: expecting a callback.");const a=this._nodes.values();let f,w;const m=new Array(this.order);let E=0;for(;f=a.next(),f.done!==!0;)w=f.value,m[E++]=h(w.key,w.attributes);return m}someNode(h){if(typeof h!="function")throw new rr("Graph.someNode: expecting a callback.");const a=this._nodes.values();let f,w;for(;f=a.next(),f.done!==!0;)if(w=f.value,h(w.key,w.attributes))return!0;return!1}everyNode(h){if(typeof h!="function")throw new rr("Graph.everyNode: expecting a callback.");const a=this._nodes.values();let f,w;for(;f=a.next(),f.done!==!0;)if(w=f.value,!h(w.key,w.attributes))return!1;return!0}filterNodes(h){if(typeof h!="function")throw new rr("Graph.filterNodes: expecting a callback.");const a=this._nodes.values();let f,w;const m=[];for(;f=a.next(),f.done!==!0;)w=f.value,h(w.key,w.attributes)&&m.push(w.key);return m}reduceNodes(h,a){if(typeof h!="function")throw new rr("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new rr("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let f=a;const w=this._nodes.values();let m,E;for(;m=w.next(),m.done!==!0;)E=m.value,f=h(f,E.key,E.attributes);return f}nodeEntries(){const h=this._nodes.values();return new Oo(()=>{const a=h.next();if(a.done)return a;const f=a.value;return{value:{node:f.key,attributes:f.attributes},done:!1}})}export(){const h=new Array(this._nodes.size);let a=0;this._nodes.forEach((w,m)=>{h[a++]=Fh(m,w)});const f=new Array(this._edges.size);return a=0,this._edges.forEach((w,m)=>{f[a++]=jh(this.type,m,w)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:h,edges:f}}import(h,a=!1){if(h instanceof un)return h.forEachNode((H,gt)=>{a?this.mergeNode(H,gt):this.addNode(H,gt)}),h.forEachEdge((H,gt,Ut,Qt,Zt,be,ie)=>{a?ie?this.mergeUndirectedEdgeWithKey(H,Ut,Qt,gt):this.mergeDirectedEdgeWithKey(H,Ut,Qt,gt):ie?this.addUndirectedEdgeWithKey(H,Ut,Qt,gt):this.addDirectedEdgeWithKey(H,Ut,Qt,gt)}),this;if(!go(h))throw new rr("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(h.attributes){if(!go(h.attributes))throw new rr("Graph.import: invalid attributes. Expecting a plain object.");a?this.mergeAttributes(h.attributes):this.replaceAttributes(h.attributes)}let f,w,m,E,R;if(h.nodes){if(m=h.nodes,!Array.isArray(m))throw new rr("Graph.import: invalid nodes. Expecting an array.");for(f=0,w=m.length;f<w;f++){E=m[f],Uh(E);const{key:H,attributes:gt}=E;a?this.mergeNode(H,gt):this.addNode(H,gt)}}if(h.edges){let H=!1;if(this.type==="undirected"&&(H=!0),m=h.edges,!Array.isArray(m))throw new rr("Graph.import: invalid edges. Expecting an array.");for(f=0,w=m.length;f<w;f++){R=m[f],Bh(R);const{source:gt,target:Ut,attributes:Qt,undirected:Zt=H}=R;let be;"key"in R?(be=a?Zt?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:Zt?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,be.call(this,R.key,gt,Ut,Qt)):(be=a?Zt?this.mergeUndirectedEdge:this.mergeDirectedEdge:Zt?this.addUndirectedEdge:this.addDirectedEdge,be.call(this,gt,Ut,Qt))}}return this}nullCopy(h){const a=new un(so({},this._options,h));return a.replaceAttributes(so({},this.getAttributes())),a}emptyCopy(h){const a=this.nullCopy(h);return this._nodes.forEach((f,w)=>{const m=so({},f.attributes);f=new a.NodeDataClass(w,m),a._nodes.set(w,f)}),a}copy(h){if(h=h||{},typeof h.type=="string"&&h.type!==this.type&&h.type!=="mixed")throw new xr(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${h.type}" because this would mean losing information about the current graph.`);if(typeof h.multi=="boolean"&&h.multi!==this.multi&&h.multi!==!0)throw new xr("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof h.allowSelfLoops=="boolean"&&h.allowSelfLoops!==this.allowSelfLoops&&h.allowSelfLoops!==!0)throw new xr("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const a=this.emptyCopy(h),f=this._edges.values();let w,m;for(;w=f.next(),w.done!==!0;)m=w.value,Rd(a,"copy",!1,m.undirected,m.key,m.source.key,m.target.key,so({},m.attributes));return a}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const h={};this._nodes.forEach((m,E)=>{h[E]=m.attributes});const a={},f={};this._edges.forEach((m,E)=>{const R=m.undirected?"--":"->";let H="",gt=m.source.key,Ut=m.target.key,Qt;m.undirected&&gt>Ut&&(Qt=gt,gt=Ut,Ut=Qt);const Zt=`(${gt})${R}(${Ut})`;E.startsWith("geid_")?this.multi&&(typeof f[Zt]>"u"?f[Zt]=0:f[Zt]++,H+=`${f[Zt]}. `):H+=`[${E}]: `,H+=Zt,a[H]=m.attributes});const w={};for(const m in this)this.hasOwnProperty(m)&&!ed.has(m)&&typeof this[m]!="function"&&typeof m!="symbol"&&(w[m]=this[m]);return w.attributes=this._attributes,w.nodes=h,w.edges=a,ai(w,"constructor",this.constructor),w}}typeof Symbol<"u"&&(un.prototype[Symbol.for("nodejs.util.inspect.custom")]=un.prototype.inspect);Wh.forEach(p=>{["add","merge","update"].forEach(h=>{const a=p.name(h),f=h==="add"?Rd:Xh;p.generateKey?un.prototype[a]=function(w,m,E){return f(this,a,!0,(p.type||this.type)==="undirected",null,w,m,E,h==="update")}:un.prototype[a]=function(w,m,E,R){return f(this,a,!1,(p.type||this.type)==="undirected",w,m,E,R,h==="update")}})});nh(un);gh(un);Dh(un);Gh(un);class Od extends un{constructor(h){const a=so({type:"directed"},h);if("multi"in a&&a.multi!==!1)throw new rr("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(a.type!=="directed")throw new rr('DirectedGraph.from: inconsistent "'+a.type+'" type in given options!');super(a)}}class Cd extends un{constructor(h){const a=so({type:"undirected"},h);if("multi"in a&&a.multi!==!1)throw new rr("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(a.type!=="undirected")throw new rr('UndirectedGraph.from: inconsistent "'+a.type+'" type in given options!');super(a)}}class Ld extends un{constructor(h){const a=so({multi:!0},h);if("multi"in a&&a.multi!==!0)throw new rr("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(a)}}class Pd extends un{constructor(h){const a=so({type:"directed",multi:!0},h);if("multi"in a&&a.multi!==!0)throw new rr("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(a.type!=="directed")throw new rr('MultiDirectedGraph.from: inconsistent "'+a.type+'" type in given options!');super(a)}}class zd extends un{constructor(h){const a=so({type:"undirected",multi:!0},h);if("multi"in a&&a.multi!==!0)throw new rr("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(a.type!=="undirected")throw new rr('MultiUndirectedGraph.from: inconsistent "'+a.type+'" type in given options!');super(a)}}function Rs(p){p.from=function(h,a){const f=so({},h.options,a),w=new p(f);return w.import(h),w}}Rs(un);Rs(Od);Rs(Cd);Rs(Ld);Rs(Pd);Rs(zd);un.Graph=un;un.DirectedGraph=Od;un.UndirectedGraph=Cd;un.MultiGraph=Ld;un.MultiDirectedGraph=Pd;un.MultiUndirectedGraph=zd;un.InvalidArgumentsGraphError=rr;un.NotFoundGraphError=qe;un.UsageGraphError=xr;var Yh="*",Kh=function(){function p(){this._events={}}return p.prototype.on=function(h,a,f){return this._events[h]||(this._events[h]=[]),this._events[h].push({callback:a,once:!!f}),this},p.prototype.once=function(h,a){return this.on(h,a,!0)},p.prototype.emit=function(h){for(var a=this,f=[],w=1;w<arguments.length;w++)f[w-1]=arguments[w];var m=this._events[h]||[],E=this._events[Yh]||[],R=function(H){for(var gt=H.length,Ut=0;Ut<gt;Ut++)if(!!H[Ut]){var Qt=H[Ut],Zt=Qt.callback,be=Qt.once;be&&(H.splice(Ut,1),H.length===0&&delete a._events[h],gt--,Ut--),Zt.apply(a,f)}};R(m),R(E)},p.prototype.off=function(h,a){if(!h)this._events={};else if(!a)delete this._events[h];else{for(var f=this._events[h]||[],w=f.length,m=0;m<w;m++)f[m].callback===a&&(f.splice(m,1),w--,m--);f.length===0&&delete this._events[h]}return this},p.prototype.getEvents=function(){return this._events},p}();function nd(p,h,a,f){for(;p.length;){const w=p.shift();if(a(w))return!0;h.add(w.id),f(w.id).forEach(E=>{h.has(E.id)||(h.add(E.id),p.push(E))})}return!1}function du(p,h,a,f){if(a(p))return!0;h.add(p.id);for(const m of f(p.id))if(!h.has(m.id)&&du(m,h,a,f))return!0;return!1}class nu extends Kh{constructor(a){super();en(this,"nodeMap",new Map);en(this,"edgeMap",new Map);en(this,"inEdgesMap",new Map);en(this,"outEdgesMap",new Map);en(this,"bothEdgesMap",new Map);en(this,"treeIndices",new Map);en(this,"changes",[]);en(this,"batchCount",0);en(this,"onChanged",()=>{});en(this,"batch",a=>{this.batchCount+=1,a(),this.batchCount-=1,this.batchCount||this.commit()});a&&(a.nodes&&this.addNodes(a.nodes),a.edges&&this.addEdges(a.edges),a.tree&&this.addTree(a.tree),a.onChanged&&(this.onChanged=a.onChanged))}commit(){const a=this.changes;this.changes=[];const f={graph:this,changes:a};this.emit("changed",f),this.onChanged(f)}reduceChanges(a){let f=[];return a.forEach(w=>{switch(w.type){case"NodeRemoved":{let m=!1;f=f.filter(E=>{if(E.type==="NodeAdded"){const R=E.value.id===w.value.id;return R&&(m=!0),!R}else{if(E.type==="NodeDataUpdated")return E.id!==w.value.id;if(E.type==="TreeStructureChanged")return E.nodeId!==w.value.id}return!0}),m||f.push(w);break}case"EdgeRemoved":{let m=!1;f=f.filter(E=>{if(E.type==="EdgeAdded"){const R=E.value.id===w.value.id;return R&&(m=!0),!R}else if(E.type==="EdgeDataUpdated"||E.type==="EdgeUpdated")return E.id!==w.value.id;return!0}),m||f.push(w);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const m=f.find(E=>E.type===w.type&&E.id===w.id&&E.propertyName===w.propertyName);m?m.newValue=w.newValue:f.push(w);break}case"TreeStructureDetached":{f=f.filter(m=>m.type==="TreeStructureAttached"||m.type==="TreeStructureChanged"?m.treeKey!==w.treeKey:!0),f.push(w);break}case"TreeStructureChanged":{const m=f.find(E=>E.type==="TreeStructureChanged"&&E.treeKey===w.treeKey&&E.nodeId===w.nodeId);m?m.newParentId=w.newParentId:f.push(w);break}default:f.push(w);break}}),f}checkNodeExistence(a){this.getNode(a)}hasNode(a){return this.nodeMap.has(a)}areNeighbors(a,f){return this.getNeighbors(f).some(w=>w.id===a)}getNode(a){const f=this.nodeMap.get(a);if(!f)throw new Error("Node not found for id: "+a);return f}getRelatedEdges(a,f){if(this.checkNodeExistence(a),f==="in"){const w=this.inEdgesMap.get(a);return Array.from(w)}else if(f==="out"){const w=this.outEdgesMap.get(a);return Array.from(w)}else{const w=this.bothEdgesMap.get(a);return Array.from(w)}}getDegree(a,f){return this.getRelatedEdges(a,f).length}getSuccessors(a){const w=this.getRelatedEdges(a,"out").map(m=>this.getNode(m.target));return Array.from(new Set(w))}getPredecessors(a){const w=this.getRelatedEdges(a,"in").map(m=>this.getNode(m.source));return Array.from(new Set(w))}getNeighbors(a){const f=this.getPredecessors(a),w=this.getSuccessors(a);return Array.from(new Set([...f,...w]))}doAddNode(a){if(this.hasNode(a.id))throw new Error("Node already exists: "+a.id);this.nodeMap.set(a.id,a),this.inEdgesMap.set(a.id,new Set),this.outEdgesMap.set(a.id,new Set),this.bothEdgesMap.set(a.id,new Set),this.treeIndices.forEach(f=>{f.childrenMap.set(a.id,new Set)}),this.changes.push({type:"NodeAdded",value:a})}addNodes(a){this.batch(()=>{for(const f of a)this.doAddNode(f)})}addNode(a){this.addNodes([a])}doRemoveNode(a){const f=this.getNode(a),w=this.bothEdgesMap.get(a);w==null||w.forEach(m=>this.doRemoveEdge(m.id)),this.nodeMap.delete(a),this.treeIndices.forEach(m=>{var E;(E=m.childrenMap.get(a))==null||E.forEach(R=>{m.parentMap.delete(R.id)}),m.parentMap.delete(a),m.childrenMap.delete(a)}),this.changes.push({type:"NodeRemoved",value:f})}removeNodes(a){this.batch(()=>{a.forEach(f=>this.doRemoveNode(f))})}removeNode(a){this.removeNodes([a])}updateNodeDataProperty(a,f,w){const m=this.getNode(a);this.batch(()=>{const E=m.data[f],R=w;m.data[f]=R,this.changes.push({type:"NodeDataUpdated",id:a,propertyName:f,oldValue:E,newValue:R})})}mergeNodeData(a,f){this.batch(()=>{Object.entries(f).forEach(([w,m])=>{this.updateNodeDataProperty(a,w,m)})})}updateNodeData(...a){const f=a[0],w=this.getNode(f);if(typeof a[1]=="string"){this.updateNodeDataProperty(f,a[1],a[2]);return}let m;if(typeof a[1]=="function"){const E=a[1];m=E(w.data)}else typeof a[1]=="object"&&(m=a[1]);this.batch(()=>{const E=w.data,R=m;w.data=m,this.changes.push({type:"NodeDataUpdated",id:f,oldValue:E,newValue:R})})}checkEdgeExistence(a){if(!this.hasEdge(a))throw new Error("Edge not found for id: "+a)}hasEdge(a){return this.edgeMap.has(a)}getEdge(a){return this.checkEdgeExistence(a),this.edgeMap.get(a)}getEdgeDetail(a){const f=this.getEdge(a);return{edge:f,source:this.getNode(f.source),target:this.getNode(f.target)}}doAddEdge(a){if(this.hasEdge(a.id))throw new Error("Edge already exists: "+a.id);this.checkNodeExistence(a.source),this.checkNodeExistence(a.target),this.edgeMap.set(a.id,a);const f=this.inEdgesMap.get(a.target),w=this.outEdgesMap.get(a.source),m=this.bothEdgesMap.get(a.source),E=this.bothEdgesMap.get(a.target);f.add(a),w.add(a),m.add(a),E.add(a),this.changes.push({type:"EdgeAdded",value:a})}addEdges(a){this.batch(()=>{for(const f of a)this.doAddEdge(f)})}addEdge(a){this.addEdges([a])}doRemoveEdge(a){const f=this.getEdge(a),w=this.outEdgesMap.get(f.source),m=this.inEdgesMap.get(f.target),E=this.bothEdgesMap.get(f.source),R=this.bothEdgesMap.get(f.target);w.delete(f),m.delete(f),E.delete(f),R.delete(f),this.edgeMap.delete(a),this.changes.push({type:"EdgeRemoved",value:f})}removeEdges(a){this.batch(()=>{a.forEach(f=>this.doRemoveEdge(f))})}removeEdge(a){this.removeEdges([a])}updateEdgeSource(a,f){const w=this.getEdge(a);this.checkNodeExistence(f);const m=w.source,E=f;this.outEdgesMap.get(m).delete(w),this.bothEdgesMap.get(m).delete(w),this.outEdgesMap.get(E).add(w),this.bothEdgesMap.get(E).add(w),w.source=f,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:a,propertyName:"source",oldValue:m,newValue:E})})}updateEdgeTarget(a,f){const w=this.getEdge(a);this.checkNodeExistence(f);const m=w.target,E=f;this.inEdgesMap.get(m).delete(w),this.bothEdgesMap.get(m).delete(w),this.inEdgesMap.get(E).add(w),this.bothEdgesMap.get(E).add(w),w.target=f,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:a,propertyName:"target",oldValue:m,newValue:E})})}updateEdgeDataProperty(a,f,w){const m=this.getEdge(a);this.batch(()=>{const E=m.data[f],R=w;m.data[f]=R,this.changes.push({type:"EdgeDataUpdated",id:a,propertyName:f,oldValue:E,newValue:R})})}updateEdgeData(...a){const f=a[0],w=this.getEdge(f);if(typeof a[1]=="string"){this.updateEdgeDataProperty(f,a[1],a[2]);return}let m;if(typeof a[1]=="function"){const E=a[1];m=E(w.data)}else typeof a[1]=="object"&&(m=a[1]);this.batch(()=>{const E=w.data,R=m;w.data=m,this.changes.push({type:"EdgeDataUpdated",id:f,oldValue:E,newValue:R})})}mergeEdgeData(a,f){this.batch(()=>{Object.entries(f).forEach(([w,m])=>{this.updateEdgeDataProperty(a,w,m)})})}checkTreeExistence(a){if(!this.hasTreeStructure(a))throw new Error("Tree structure not found for treeKey: "+a)}hasTreeStructure(a){return this.treeIndices.has(a)}attachTreeStructure(a){this.treeIndices.has(a)||(this.treeIndices.set(a,{parentMap:new Map,childrenMap:new Map}),this.batch(()=>{this.changes.push({type:"TreeStructureAttached",treeKey:a})}))}detachTreeStructure(a){this.checkTreeExistence(a),this.treeIndices.delete(a),this.batch(()=>{this.changes.push({type:"TreeStructureDetached",treeKey:a})})}addTree(a,f){this.batch(()=>{this.attachTreeStructure(f);const w=[],m=Array.isArray(a)?a:[a];for(;m.length;){const E=m.shift();w.push(E),E.children&&m.push(...E.children)}this.addNodes(w),w.forEach(E=>{var R;(R=E.children)==null||R.forEach(H=>{this.setParent(H.id,E.id,f)})})})}getRoots(a){return this.checkTreeExistence(a),this.getAllNodes().filter(f=>!this.getParent(f.id,a))}getChildren(a,f){this.checkNodeExistence(a),this.checkTreeExistence(f);const m=this.treeIndices.get(f).childrenMap.get(a);return Array.from(m||[])}getParent(a,f){return this.checkNodeExistence(a),this.checkTreeExistence(f),this.treeIndices.get(f).parentMap.get(a)||null}getAncestors(a,f){const w=[];let m=this.getNode(a),E;for(;E=this.getParent(m.id,f);)w.push(E),m=E;return w}setParent(a,f,w){var Ut;this.checkTreeExistence(w);const m=this.treeIndices.get(w),E=this.getNode(a),R=m.parentMap.get(a),H=this.getNode(f);m.parentMap.set(a,H),R&&((Ut=m.childrenMap.get(R.id))==null||Ut.delete(E));let gt=m.childrenMap.get(H.id);gt||(gt=new Set,m.childrenMap.set(H.id,gt)),gt.add(E),this.batch(()=>{this.changes.push({type:"TreeStructureChanged",treeKey:w,nodeId:a,oldParentId:R==null?void 0:R.id,newParentId:H.id})})}dfsTree(a,f,w){const m=E=>this.getChildren(E,w);return du(this.getNode(a),new Set,f,m)}bfsTree(a,f,w){const m=E=>this.getChildren(E,w);return nd([this.getNode(a)],new Set,f,m)}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(a,f,w="out"){const m={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[w];return nd([this.getNode(a)],new Set,f,m)}dfs(a,f,w="out"){const m={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[w];return du(this.getNode(a),new Set,f,m)}clone(){const a=this.getAllNodes().map(m=>({...m,data:{...m.data}})),f=this.getAllEdges().map(m=>({...m,data:{...m.data}})),w=new nu({nodes:a,edges:f});return this.treeIndices.forEach(({parentMap:m,childrenMap:E},R)=>{const H=new Map;m.forEach((Ut,Qt)=>{H.set(Qt,w.getNode(Ut.id))});const gt=new Map;E.forEach((Ut,Qt)=>{gt.set(Qt,new Set(Array.from(Ut).map(Zt=>w.getNode(Zt.id))))}),w.treeIndices.set(R,{parentMap:H,childrenMap:gt})}),w}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var Gd=function(h){return h!==null&&typeof h=="function"&&typeof h.prototype=="object"&&typeof h.prototype.addUndirectedEdgeWithKey=="function"&&typeof h.prototype.dropNode=="function"},Zh=Gd,Jh=function(p,h){if(!Zh(p))throw new Error("graphology-generators/random/clusters: invalid Graph constructor.");h=h||{};var a="clusterDensity"in h?h.clusterDensity:.5,f=h.rng||Math.random,w=h.order,m=h.size,E=h.clusters;if(typeof a!="number"||a>1||a<0)throw new Error("graphology-generators/random/clusters: `clusterDensity` option should be a number between 0 and 1.");if(typeof f!="function")throw new Error("graphology-generators/random/clusters: `rng` option should be a function.");if(typeof w!="number"||w<=0)throw new Error("graphology-generators/random/clusters: `order` option should be a positive number.");if(typeof m!="number"||m<=0)throw new Error("graphology-generators/random/clusters: `size` option should be a positive number.");if(typeof E!="number"||E<=0)throw new Error("graphology-generators/random/clusters: `clusters` option should be a positive number.");var R=new p;if(!w)return R;var H=new Array(E),gt,Ut,Qt;for(Qt=0;Qt<E;Qt++)H[Qt]=[];for(Qt=0;Qt<w;Qt++)gt=f()*E|0,R.addNode(Qt,{cluster:gt}),H[gt].push(Qt);if(!m)return R;var Zt,be,ie;for(Qt=0;Qt<m;Qt++){if(f()<1-a){Zt=f()*w|0;do be=f()*w|0;while(Zt===be)}else{if(gt=f()*E|0,Ut=H[gt],ie=Ut.length,!ie||ie<2)continue;Zt=Ut[f()*ie|0];do be=Ut[f()*ie|0];while(Zt===be)}R.multi?R.addEdge(Zt,be):R.mergeEdge(Zt,be)}return R},Ea={},Qh=cu,tl=function(h){if(!Qh(h))throw new Error("graphology-metrics/simple-size: the given graph is not a valid graphology instance.");if(!h.multi)return h.size;var a=0,f=0;function w(){a++}function m(){f++}return h.forEachNode(function(E){h.type!=="directed"&&h.forEachUndirectedNeighbor(E,w),h.type!=="undirected"&&h.forEachOutNeighbor(E,m)}),a/2+f},el=cu,rl=tl;function nl(p,h){return 2*h/(p*(p-1))}function ol(p,h){return h/(p*(p-1))}function il(p,h){var a=p*(p-1);return h/(a+a/2)}function Va(p,h,a){var f,w;if(arguments.length>3){if(f=a,w=arguments[3],typeof f!="number"||f<0)throw new Error("graphology-metrics/density: given order is not a valid number.");if(typeof w!="number"||w<0)throw new Error("graphology-metrics/density: given size is not a valid number.")}else{if(!el(a))throw new Error("graphology-metrics/density: given graph is not a valid graphology instance.");f=a.order,w=a.size,a.multi&&h===!1&&(w=rl(a))}if(f<2)return 0;p===null&&(p=a.type),h===null&&(h=a.multi);var m;return p==="undirected"?m=nl:p==="directed"?m=ol:m=il,m(f,w)}Ea.abstractDensity=Va;Ea.density=Va.bind(null,null,null);Ea.directedDensity=Va.bind(null,"directed",!1);Ea.undirectedDensity=Va.bind(null,"undirected",!1);Ea.mixedDensity=Va.bind(null,"mixed",!1);Ea.multiDirectedDensity=Va.bind(null,"directed",!0);Ea.multiUndirectedDensity=Va.bind(null,"undirected",!0);Ea.multiMixedDensity=Va.bind(null,"mixed",!0);var Fd=Gd,jd=Ea.abstractDensity;function al(p,h){if(!Fd(p))throw new Error("graphology-generators/random/erdos-renyi: invalid Graph constructor.");var a=h.order,f=h.probability,w=h.rng||Math.random,m=new p;if(typeof h.approximateSize=="number"&&(f=jd(m.type,!1,a,h.approximateSize)),typeof a!="number"||a<=0)throw new Error("graphology-generators/random/erdos-renyi: invalid `order`. Should be a positive number.");if(typeof f!="number"||f<0||f>1)throw new Error("graphology-generators/random/erdos-renyi: invalid `probability`. Should be a number between 0 and 1. Or maybe you gave an `approximateSize` exceeding the graph's density.");if(typeof w!="function")throw new Error("graphology-generators/random/erdos-renyi: invalid `rng`. Should be a function.");var E,R;for(E=0;E<a;E++)m.addNode(E);if(f<=0)return m;for(E=0;E<a;E++)for(R=E+1;R<a;R++)m.type!=="directed"&&w()<f&&m.addUndirectedEdge(E,R),m.type!=="undirected"&&(w()<f&&m.addDirectedEdge(E,R),w()<f&&m.addDirectedEdge(R,E));return m}function sl(p,h){if(!Fd(p))throw new Error("graphology-generators/random/erdos-renyi: invalid Graph constructor.");var a=h.order,f=h.probability,w=h.rng||Math.random,m=new p;if(typeof h.approximateSize=="number"&&(f=jd(m.type,!1,a,h.approximateSize)),typeof a!="number"||a<=0)throw new Error("graphology-generators/random/erdos-renyi: invalid `order`. Should be a positive number.");if(typeof f!="number"||f<0||f>1)throw new Error("graphology-generators/random/erdos-renyi: invalid `probability`. Should be a number between 0 and 1. Or maybe you gave an `approximateSize` exceeding the graph's density.");if(typeof w!="function")throw new Error("graphology-generators/random/erdos-renyi: invalid `rng`. Should be a function.");for(var E=0;E<a;E++)m.addNode(E);if(f<=0)return m;var R=-1,H=Math.log(1-f),gt,Ut;if(m.type!=="undirected")for(Ut=0;Ut<a;){for(gt=Math.log(1-w()),R+=1+(gt/H|0),Ut===R&&R++;Ut<a&&a<=R;)R-=a,Ut++,Ut===R&&R++;Ut<a&&m.addDirectedEdge(Ut,R)}if(R=-1,m.type!=="directed")for(Ut=1;Ut<a;){for(gt=Math.log(1-w()),R+=1+(gt/H|0);R>=Ut&&Ut<a;)R-=Ut,Ut++;Ut<a&&m.addUndirectedEdge(Ut,R)}return m}al.sparse=sl;var ul=Jh,od=(p,h,a)=>new Promise((f,w)=>{var m=H=>{try{R(a.next(H))}catch(gt){w(gt)}},E=H=>{try{R(a.throw(H))}catch(gt){w(gt)}},R=H=>H.done?f(H.value):Promise.resolve(H.value).then(m,E);R((a=a.apply(p,h)).next())});const dl=()=>od(void 0,null,function*(){const p={},h=()=>{const Ut=ul(un,{order:1e3,size:2e3,clusters:5});Ut.edges().forEach(function(be,ie){Ut.setEdgeAttribute(be,"weight",1)}),Ut.nodes().forEach(function(be){Ut.setNodeAttribute(be,"x",Math.random()*Br),Ut.setNodeAttribute(be,"y",Math.random()*Br)});const Qt=cl(Ut),Zt=id(Ut);return{desc:"Creates a graph with the desired number of nodes & edges and having a given number of clusters. Generated by Graphology Generators.",[Bn.GRAPHOLOGY]:Ut,[Bn.ANTV_LAYOUT]:Qt,[Bn.ANTV_LAYOUT_GPU]:Qt,[Bn.ANTV_LAYOUT_WASM_SINGLETHREAD]:Zt,[Bn.ANTV_LAYOUT_WASM_MULTITHREADS]:Zt}},a=(H,gt)=>()=>od(void 0,null,function*(){const Qt=yield(yield fetch(H)).json(),Zt=[],be=[],ie=new Set;Qt.nodes.forEach(re=>{ie.has(re.id)||(ie.add(re.id),re.x===void 0&&(re.x=Math.random()*Br),re.y===void 0&&(re.y=Math.random()*Br),Zt.push({id:re.id,data:{x:re.x,y:re.y}}))}),Qt.edges.forEach((re,ir)=>{re.id===void 0&&(re.id=`e${ir}`),re.weight===void 0||re.weight===null?re.weight=1:re.weight=Number(re.weight),be.push({id:re.id,source:re.source,target:re.target,data:{weight:re.weight}})});const Ze=new nu({nodes:Zt,edges:be}),me=hl(Ze),ze=id(me);return{desc:gt,[Bn.GRAPHOLOGY]:me,[Bn.ANTV_LAYOUT]:Ze,[Bn.ANTV_LAYOUT_GPU]:Ze,[Bn.ANTV_LAYOUT_WASM_SINGLETHREAD]:ze,[Bn.ANTV_LAYOUT_WASM_MULTITHREADS]:ze}}),[f,w,m,E,R]=yield Promise.all([h(),a("https://gw.alipayobjects.com/os/antvdemo/assets/data/relations.json",'A small dataset of "relations" between people.')(),a("https://gw.alipayobjects.com/os/basement_prod/da5a1b47-37d6-44d7-8d10-f3e046dabf82.json","Netscience with 1589 nodes & 2742 edges.")(),a("https://gw.alipayobjects.com/os/basement_prod/0b9730ff-0850-46ff-84d0-1d4afecd43e6.json","Eva with 8322 nodes & 5421 edges.")(),a("https://gw.alipayobjects.com/os/basement_prod/7bacd7d1-4119-4ac1-8be3-4c4b9bcbc25f.json","A dataset for regions on earth.")()]);return p["random-clusters"]=f,p.relations=w,p.netscience=m,p.eva=E,p.regions=R,p}),cl=p=>new nu({nodes:p.nodes().map(h=>({id:h,data:{x:p.getNodeAttribute(h,"x"),y:p.getNodeAttribute(h,"y")}})),edges:p.edges().map(h=>({id:h,source:p.source(h),target:p.target(h),data:{weight:p.getEdgeAttribute(h,"weight")}}))}),hl=p=>{const h=new un;return p.getAllNodes().forEach(({id:a,data:{x:f,y:w}})=>{h.hasNode(a)||h.addNode(a,{x:f,y:w})}),p.getAllEdges().forEach(({source:a,target:f,data:{weight:w}})=>{h.addEdge(a,f,{weight:w})}),h},id=p=>{const h=[],a=[],f=[],w=[],m={};return p.nodes().forEach((E,R)=>{m[E]=R,h.push(p.getNodeAttribute(E,"x"),p.getNodeAttribute(E,"y")),a.push(1)}),p.edges().forEach(E=>{const R=p.getEdgeAttribute(E,"weight"),H=m[p.source(E)],gt=m[p.target(E)];H!==void 0&&gt!==void 0&&(f.push([gt,H]),w.push(R),a[H]+=R,a[gt]+=R)}),{nodes:h,masses:a,edges:f,weights:w}};var Us=(p,h,a)=>new Promise((f,w)=>{var m=H=>{try{R(a.next(H))}catch(gt){w(gt)}},E=H=>{try{R(a.throw(H))}catch(gt){w(gt)}},R=H=>H.done?f(H.value):Promise.resolve(H.value).then(m,E);R((a=a.apply(p,h)).next())});const Pu=[{name:Bn.GRAPHOLOGY},{name:Bn.ANTV_LAYOUT},{name:Bn.ANTV_LAYOUT_WASM_SINGLETHREAD},{name:Bn.ANTV_LAYOUT_WASM_MULTITHREADS},{name:Bn.ANTV_LAYOUT_GPU}],ad=document.getElementById("mask"),ll=document.getElementById("iterations"),uu=document.getElementById("dataset"),fl=document.getElementById("dataset-desc"),gl=document.getElementById("layout"),pl=document.getElementById("run"),Is=Pu.map(({name:p})=>document.getElementById(p).getContext("2d")),sd=Pu.map((p,h)=>Is[h].canvas.parentElement.querySelector("span")),vl=Pu.map(({name:p},h)=>{const a=document.getElementById(p+"_checkbox");return a.onchange=()=>{Is[h].canvas.parentElement.style.display=a.checked?"block":"none"},a}),ml=()=>Us(globalThis,null,function*(){const p=yield window.layoutWASM.initThreads(!1),h=yield window.layoutWASM.initThreads(!0);return[p,h]}),yl=(p,h,a,f,w,m)=>Us(globalThis,null,function*(){const E=performance.now(),{nodes:R,edges:H}=yield a(f,w,m);h.innerHTML=`${(performance.now()-E).toFixed(2)}ms`,Vd(p,R,H)});Us(globalThis,null,function*(){console.time("Load datasets");const p=yield dl();uu.onchange=()=>{fl.innerHTML=p[uu.value].desc},console.timeEnd("Load datasets"),console.time("Init WASM threads");const[h,a]=yield ml();console.timeEnd("Init WASM threads");const f=[{name:Bn.GRAPHOLOGY,methods:{forceatlas2:uc,fruchterman:kc}},{name:Bn.ANTV_LAYOUT,methods:{forceatlas2:dc,force2:fc,fruchterman:Ic}},{name:Bn.ANTV_LAYOUT_WASM_SINGLETHREAD,methods:{forceatlas2:Vu,force2:Wu,fruchterman:Zu}},{name:Bn.ANTV_LAYOUT_WASM_MULTITHREADS,methods:{forceatlas2:Vu,force2:Wu,fruchterman:Zu}},{name:Bn.ANTV_LAYOUT_GPU,methods:{force2:gc,fruchterman:Dc}}];pl.onclick=()=>Us(this,null,function*(){ad.style.display="flex";const w=p[uu.value],m=gl.value;yield Promise.all(f.map((E,R)=>Us(this,[E,R],function*({name:H,methods:gt},Ut){gt[m]&&vl[Ut].checked?yield yl(Is[Ut],sd[Ut],gt[m],w[H],{iterations:parseInt(ll.value)},H===Bn.ANTV_LAYOUT_WASM_MULTITHREADS?a:h):(Is[Ut].clearRect(0,0,Is[Ut].canvas.width,Is[Ut].canvas.height),sd[Ut].innerHTML="not implemented.")}))),ad.style.display="none"})});
