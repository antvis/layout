(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerpolicy&&(i.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?i.credentials="include":a.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();if(typeof window>"u"){self.addEventListener("install",()=>self.skipWaiting()),self.addEventListener("activate",t=>t.waitUntil(self.clients.claim()));async function e(t){if(t.cache==="only-if-cached"&&t.mode!=="same-origin")return;t.mode==="no-cors"&&(t=new Request(t.url,{cache:t.cache,credentials:"omit",headers:t.headers,integrity:t.integrity,destination:t.destination,keepalive:t.keepalive,method:t.method,mode:t.mode,redirect:t.redirect,referrer:t.referrer,referrerPolicy:t.referrerPolicy,signal:t.signal}));let r=await fetch(t).catch(a=>console.error(a));if(r.status===0)return r;const n=new Headers(r.headers);return n.set("Cross-Origin-Embedder-Policy","credentialless"),n.set("Cross-Origin-Opener-Policy","same-origin"),new Response(r.body,{status:r.status,statusText:r.statusText,headers:n})}self.addEventListener("fetch",function(t){t.respondWith(e(t.request))})}else(async function(){if(window.crossOriginIsolated!==!1)return;let e=await navigator.serviceWorker.register(window.document.currentScript.src).catch(t=>console.error("COOP/COEP Service Worker failed to register:",t));e&&(console.log("COOP/COEP Service Worker registered",e.scope),e.addEventListener("updatefound",()=>{console.log("Reloading page to make use of updated COOP/COEP Service Worker."),window.location.reload()}),e.active&&!navigator.serviceWorker.controller&&(console.log("Reloading page to make use of COOP/COEP Service Worker."),window.location.reload()))})();function fy(e,t,r){const[n,a]=[e.canvas.width/2,e.canvas.height/2];e.clearRect(0,0,e.canvas.width,e.canvas.height);for(let i=0;i<r.length;i+=4)e.moveTo(r[i]+n,r[i+1]+a),e.lineTo(r[i+2]+n,r[i+3]+a),e.strokeStyle="grey",e.lineWidth=1,e.stroke();for(let i=0;i<t.length;i+=2)e.beginPath(),e.arc(t[i]+n,t[i+1]+a,5,0,2*Math.PI,!1),e.fillStyle="red",e.fill(),e.stroke()}var Oi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},hs=function(t){return t!==null&&typeof t=="object"&&typeof t.addUndirectedEdgeWithKey=="function"&&typeof t.dropNode=="function"&&typeof t.multi=="boolean"},Ia={};function cy(e){return typeof e!="number"||isNaN(e)?1:e}function dy(e,t){var r={},n=function(o){return typeof o>"u"?t:o};typeof t=="function"&&(n=t);var a=function(o){return n(o[e])},i=function(){return n(void 0)};return typeof e=="string"?(r.fromAttributes=a,r.fromGraph=function(o,s){return a(o.getNodeAttributes(s))},r.fromEntry=function(o,s){return a(s)}):typeof e=="function"?(r.fromAttributes=function(){throw new Error("graphology-utils/getters/createNodeValueGetter: irrelevant usage.")},r.fromGraph=function(o,s){return n(e(s,o.getNodeAttributes(s)))},r.fromEntry=function(o,s){return n(e(o,s))}):(r.fromAttributes=i,r.fromGraph=i,r.fromEntry=i),r}function nd(e,t){var r={},n=function(o){return typeof o>"u"?t:o};typeof t=="function"&&(n=t);var a=function(o){return n(o[e])},i=function(){return n(void 0)};return typeof e=="string"?(r.fromAttributes=a,r.fromGraph=function(o,s){return a(o.getEdgeAttributes(s))},r.fromEntry=function(o,s){return a(s)},r.fromPartialEntry=r.fromEntry,r.fromMinimalEntry=r.fromEntry):typeof e=="function"?(r.fromAttributes=function(){throw new Error("graphology-utils/getters/createEdgeValueGetter: irrelevant usage.")},r.fromGraph=function(o,s){var f=o.extremities(s);return n(e(s,o.getEdgeAttributes(s),f[0],f[1],o.getNodeAttributes(f[0]),o.getNodeAttributes(f[1]),o.isUndirected(s)))},r.fromEntry=function(o,s,f,c,d,h,y){return n(e(o,s,f,c,d,h,y))},r.fromPartialEntry=function(o,s,f,c){return n(e(o,s,f,c))},r.fromMinimalEntry=function(o,s){return n(e(o,s))}):(r.fromAttributes=i,r.fromGraph=i,r.fromEntry=i,r.fromMinimalEntry=i),r}Ia.createNodeValueGetter=dy;Ia.createEdgeValueGetter=nd;Ia.createEdgeWeightGetter=function(e){return nd(e,cy)};var Ct=0,_t=1,it=2,at=3,Ur=4,Mr=5,ot=6,qf=7,ma=8,Qf=9,hy=0,ly=1,py=2,$t=0,ur=1,Yt=2,vn=3,qr=4,wt=5,er=6,Sr=7,Rr=8,Zf=3,mr=10,vy=3,Xt=9,Xo=10,yy=function(t,r,n){var a,i,o,s,f,c,d,h,y,C,L=r.length,k=n.length,U=t.adjustSizes,B=t.barnesHutTheta*t.barnesHutTheta,q,se,fe,de,Ze,Oe,Ge,K=[];for(o=0;o<L;o+=mr)r[o+Ur]=r[o+it],r[o+Mr]=r[o+at],r[o+it]=0,r[o+at]=0;if(t.outboundAttractionDistribution){for(q=0,o=0;o<L;o+=mr)q+=r[o+ot];q/=L/mr}if(t.barnesHutOptimize){var Mt=1/0,Dt=-1/0,Rt=1/0,Pt=-1/0,vt,we,he;for(o=0;o<L;o+=mr)Mt=Math.min(Mt,r[o+Ct]),Dt=Math.max(Dt,r[o+Ct]),Rt=Math.min(Rt,r[o+_t]),Pt=Math.max(Pt,r[o+_t]);var Ee=Dt-Mt,Fe=Pt-Rt;for(Ee>Fe?(Rt-=(Ee-Fe)/2,Pt=Rt+Ee):(Mt-=(Fe-Ee)/2,Dt=Mt+Fe),K[0+$t]=-1,K[0+ur]=(Mt+Dt)/2,K[0+Yt]=(Rt+Pt)/2,K[0+vn]=Math.max(Dt-Mt,Pt-Rt),K[0+qr]=-1,K[0+wt]=-1,K[0+er]=0,K[0+Sr]=0,K[0+Rr]=0,a=1,o=0;o<L;o+=mr)for(i=0,he=Zf;;)if(K[i+wt]>=0){r[o+Ct]<K[i+ur]?r[o+_t]<K[i+Yt]?vt=K[i+wt]:vt=K[i+wt]+Xt:r[o+_t]<K[i+Yt]?vt=K[i+wt]+Xt*2:vt=K[i+wt]+Xt*3,K[i+Sr]=(K[i+Sr]*K[i+er]+r[o+Ct]*r[o+ot])/(K[i+er]+r[o+ot]),K[i+Rr]=(K[i+Rr]*K[i+er]+r[o+_t]*r[o+ot])/(K[i+er]+r[o+ot]),K[i+er]+=r[o+ot],i=vt;continue}else if(K[i+$t]<0){K[i+$t]=o;break}else{if(K[i+wt]=a*Xt,h=K[i+vn]/2,y=K[i+wt],K[y+$t]=-1,K[y+ur]=K[i+ur]-h,K[y+Yt]=K[i+Yt]-h,K[y+vn]=h,K[y+qr]=y+Xt,K[y+wt]=-1,K[y+er]=0,K[y+Sr]=0,K[y+Rr]=0,y+=Xt,K[y+$t]=-1,K[y+ur]=K[i+ur]-h,K[y+Yt]=K[i+Yt]+h,K[y+vn]=h,K[y+qr]=y+Xt,K[y+wt]=-1,K[y+er]=0,K[y+Sr]=0,K[y+Rr]=0,y+=Xt,K[y+$t]=-1,K[y+ur]=K[i+ur]+h,K[y+Yt]=K[i+Yt]-h,K[y+vn]=h,K[y+qr]=y+Xt,K[y+wt]=-1,K[y+er]=0,K[y+Sr]=0,K[y+Rr]=0,y+=Xt,K[y+$t]=-1,K[y+ur]=K[i+ur]+h,K[y+Yt]=K[i+Yt]+h,K[y+vn]=h,K[y+qr]=K[i+qr],K[y+wt]=-1,K[y+er]=0,K[y+Sr]=0,K[y+Rr]=0,a+=4,r[K[i+$t]+Ct]<K[i+ur]?r[K[i+$t]+_t]<K[i+Yt]?vt=K[i+wt]:vt=K[i+wt]+Xt:r[K[i+$t]+_t]<K[i+Yt]?vt=K[i+wt]+Xt*2:vt=K[i+wt]+Xt*3,K[i+er]=r[K[i+$t]+ot],K[i+Sr]=r[K[i+$t]+Ct],K[i+Rr]=r[K[i+$t]+_t],K[vt+$t]=K[i+$t],K[i+$t]=-1,r[o+Ct]<K[i+ur]?r[o+_t]<K[i+Yt]?we=K[i+wt]:we=K[i+wt]+Xt:r[o+_t]<K[i+Yt]?we=K[i+wt]+Xt*2:we=K[i+wt]+Xt*3,vt===we)if(he--){i=vt;continue}else{he=Zf;break}K[we+$t]=o;break}}if(t.barnesHutOptimize)for(se=t.scalingRatio,o=0;o<L;o+=mr)for(i=0;;)if(K[i+wt]>=0)if(Oe=Math.pow(r[o+Ct]-K[i+Sr],2)+Math.pow(r[o+_t]-K[i+Rr],2),C=K[i+vn],4*C*C/Oe<B){if(fe=r[o+Ct]-K[i+Sr],de=r[o+_t]-K[i+Rr],U===!0?Oe>0?(Ge=se*r[o+ot]*K[i+er]/Oe,r[o+it]+=fe*Ge,r[o+at]+=de*Ge):Oe<0&&(Ge=-se*r[o+ot]*K[i+er]/Math.sqrt(Oe),r[o+it]+=fe*Ge,r[o+at]+=de*Ge):Oe>0&&(Ge=se*r[o+ot]*K[i+er]/Oe,r[o+it]+=fe*Ge,r[o+at]+=de*Ge),i=K[i+qr],i<0)break;continue}else{i=K[i+wt];continue}else{if(c=K[i+$t],c>=0&&c!==o&&(fe=r[o+Ct]-r[c+Ct],de=r[o+_t]-r[c+_t],Oe=fe*fe+de*de,U===!0?Oe>0?(Ge=se*r[o+ot]*r[c+ot]/Oe,r[o+it]+=fe*Ge,r[o+at]+=de*Ge):Oe<0&&(Ge=-se*r[o+ot]*r[c+ot]/Math.sqrt(Oe),r[o+it]+=fe*Ge,r[o+at]+=de*Ge):Oe>0&&(Ge=se*r[o+ot]*r[c+ot]/Oe,r[o+it]+=fe*Ge,r[o+at]+=de*Ge)),i=K[i+qr],i<0)break;continue}else for(se=t.scalingRatio,s=0;s<L;s+=mr)for(f=0;f<s;f+=mr)fe=r[s+Ct]-r[f+Ct],de=r[s+_t]-r[f+_t],U===!0?(Oe=Math.sqrt(fe*fe+de*de)-r[s+ma]-r[f+ma],Oe>0?(Ge=se*r[s+ot]*r[f+ot]/Oe/Oe,r[s+it]+=fe*Ge,r[s+at]+=de*Ge,r[f+it]+=fe*Ge,r[f+at]+=de*Ge):Oe<0&&(Ge=100*se*r[s+ot]*r[f+ot],r[s+it]+=fe*Ge,r[s+at]+=de*Ge,r[f+it]-=fe*Ge,r[f+at]-=de*Ge)):(Oe=Math.sqrt(fe*fe+de*de),Oe>0&&(Ge=se*r[s+ot]*r[f+ot]/Oe/Oe,r[s+it]+=fe*Ge,r[s+at]+=de*Ge,r[f+it]-=fe*Ge,r[f+at]-=de*Ge));for(y=t.gravity/t.scalingRatio,se=t.scalingRatio,o=0;o<L;o+=mr)Ge=0,fe=r[o+Ct],de=r[o+_t],Oe=Math.sqrt(Math.pow(fe,2)+Math.pow(de,2)),t.strongGravityMode?Oe>0&&(Ge=se*r[o+ot]*y):Oe>0&&(Ge=se*r[o+ot]*y/Oe),r[o+it]-=fe*Ge,r[o+at]-=de*Ge;for(se=1*(t.outboundAttractionDistribution?q:1),d=0;d<k;d+=vy)s=n[d+hy],f=n[d+ly],h=n[d+py],Ze=Math.pow(h,t.edgeWeightInfluence),fe=r[s+Ct]-r[f+Ct],de=r[s+_t]-r[f+_t],U===!0?(Oe=Math.sqrt(fe*fe+de*de)-r[s+ma]-r[f+ma],t.linLogMode?t.outboundAttractionDistribution?Oe>0&&(Ge=-se*Ze*Math.log(1+Oe)/Oe/r[s+ot]):Oe>0&&(Ge=-se*Ze*Math.log(1+Oe)/Oe):t.outboundAttractionDistribution?Oe>0&&(Ge=-se*Ze/r[s+ot]):Oe>0&&(Ge=-se*Ze)):(Oe=Math.sqrt(Math.pow(fe,2)+Math.pow(de,2)),t.linLogMode?t.outboundAttractionDistribution?Oe>0&&(Ge=-se*Ze*Math.log(1+Oe)/Oe/r[s+ot]):Oe>0&&(Ge=-se*Ze*Math.log(1+Oe)/Oe):t.outboundAttractionDistribution?(Oe=1,Ge=-se*Ze/r[s+ot]):(Oe=1,Ge=-se*Ze)),Oe>0&&(r[s+it]+=fe*Ge,r[s+at]+=de*Ge,r[f+it]-=fe*Ge,r[f+at]-=de*Ge);var Me,Pe,st,ht,Lt,Qt;if(U===!0)for(o=0;o<L;o+=mr)r[o+Qf]!==1&&(Me=Math.sqrt(Math.pow(r[o+it],2)+Math.pow(r[o+at],2)),Me>Xo&&(r[o+it]=r[o+it]*Xo/Me,r[o+at]=r[o+at]*Xo/Me),Pe=r[o+ot]*Math.sqrt((r[o+Ur]-r[o+it])*(r[o+Ur]-r[o+it])+(r[o+Mr]-r[o+at])*(r[o+Mr]-r[o+at])),st=Math.sqrt((r[o+Ur]+r[o+it])*(r[o+Ur]+r[o+it])+(r[o+Mr]+r[o+at])*(r[o+Mr]+r[o+at]))/2,ht=.1*Math.log(1+st)/(1+Math.sqrt(Pe)),Lt=r[o+Ct]+r[o+it]*(ht/t.slowDown),r[o+Ct]=Lt,Qt=r[o+_t]+r[o+at]*(ht/t.slowDown),r[o+_t]=Qt);else for(o=0;o<L;o+=mr)r[o+Qf]!==1&&(Pe=r[o+ot]*Math.sqrt((r[o+Ur]-r[o+it])*(r[o+Ur]-r[o+it])+(r[o+Mr]-r[o+at])*(r[o+Mr]-r[o+at])),st=Math.sqrt((r[o+Ur]+r[o+it])*(r[o+Ur]+r[o+it])+(r[o+Mr]+r[o+at])*(r[o+Mr]+r[o+at]))/2,ht=r[o+qf]*Math.log(1+st)/(1+Math.sqrt(Pe)),r[o+qf]=Math.min(1,Math.sqrt(ht*(Math.pow(r[o+it],2)+Math.pow(r[o+at],2))/(1+Math.sqrt(Pe)))),Lt=r[o+Ct]+r[o+it]*(ht/t.slowDown),r[o+Ct]=Lt,Qt=r[o+_t]+r[o+at]*(ht/t.slowDown),r[o+_t]=Qt);return{}},Zr={},Ci=10,Jf=3;Zr.assign=function(e){e=e||{};var t=Array.prototype.slice.call(arguments).slice(1),r,n,a;for(r=0,a=t.length;r<a;r++)if(!!t[r])for(n in t[r])e[n]=t[r][n];return e};Zr.validateSettings=function(e){return"linLogMode"in e&&typeof e.linLogMode!="boolean"?{message:"the `linLogMode` setting should be a boolean."}:"outboundAttractionDistribution"in e&&typeof e.outboundAttractionDistribution!="boolean"?{message:"the `outboundAttractionDistribution` setting should be a boolean."}:"adjustSizes"in e&&typeof e.adjustSizes!="boolean"?{message:"the `adjustSizes` setting should be a boolean."}:"edgeWeightInfluence"in e&&typeof e.edgeWeightInfluence!="number"?{message:"the `edgeWeightInfluence` setting should be a number."}:"scalingRatio"in e&&!(typeof e.scalingRatio=="number"&&e.scalingRatio>=0)?{message:"the `scalingRatio` setting should be a number >= 0."}:"strongGravityMode"in e&&typeof e.strongGravityMode!="boolean"?{message:"the `strongGravityMode` setting should be a boolean."}:"gravity"in e&&!(typeof e.gravity=="number"&&e.gravity>=0)?{message:"the `gravity` setting should be a number >= 0."}:"slowDown"in e&&!(typeof e.slowDown=="number"||e.slowDown>=0)?{message:"the `slowDown` setting should be a number >= 0."}:"barnesHutOptimize"in e&&typeof e.barnesHutOptimize!="boolean"?{message:"the `barnesHutOptimize` setting should be a boolean."}:"barnesHutTheta"in e&&!(typeof e.barnesHutTheta=="number"&&e.barnesHutTheta>=0)?{message:"the `barnesHutTheta` setting should be a number >= 0."}:null};Zr.graphToByteArrays=function(e,t){var r=e.order,n=e.size,a={},i,o=new Float32Array(r*Ci),s=new Float32Array(n*Jf);return i=0,e.forEachNode(function(f,c){a[f]=i,o[i]=c.x,o[i+1]=c.y,o[i+2]=0,o[i+3]=0,o[i+4]=0,o[i+5]=0,o[i+6]=1,o[i+7]=1,o[i+8]=c.size||1,o[i+9]=c.fixed?1:0,i+=Ci}),i=0,e.forEachEdge(function(f,c,d,h,y,C,L){var k=a[d],U=a[h];o[k+6]+=1,o[U+6]+=1,s[i]=k,s[i+1]=U,s[i+2]=t(f,c,d,h,y,C,L),i+=Jf}),{nodes:o,edges:s}};Zr.assignLayoutChanges=function(e,t,r){var n=0;e.updateEachNodeAttributes(function(a,i){return i.x=t[n],i.y=t[n+1],n+=Ci,r?r(a,i):i})};Zr.readGraphPositions=function(e,t){var r=0;e.forEachNode(function(n,a){t[r]=a.x,t[r+1]=a.y,r+=Ci})};Zr.collectLayoutChanges=function(e,t,r){for(var n=e.nodes(),a={},i=0,o=0,s=t.length;i<s;i+=Ci){if(r){var f=Object.assign({},e.getNodeAttributes(n[o]));f.x=t[i],f.y=t[i+1],f=r(n[o],f),a[n[o]]={x:f.x,y:f.y}}else a[n[o]]={x:t[i],y:t[i+1]};o++}return a};Zr.createWorker=function(t){var r=window.URL||window.webkitURL,n=t.toString(),a=r.createObjectURL(new Blob(["("+n+").call(this);"],{type:"text/javascript"})),i=new Worker(a);return r.revokeObjectURL(a),i};var my={linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:1,scalingRatio:1,strongGravityMode:!1,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5},Ey=hs,_y=Ia.createEdgeWeightGetter,by=yy,Ti=Zr,gy=my;function id(e,t,r){if(!Ey(t))throw new Error("graphology-layout-forceatlas2: the given graph is not a valid graphology instance.");typeof r=="number"&&(r={iterations:r});var n=r.iterations;if(typeof n!="number")throw new Error("graphology-layout-forceatlas2: invalid number of iterations.");if(n<=0)throw new Error("graphology-layout-forceatlas2: you should provide a positive number of iterations.");var a=_y(r.getEdgeWeight).fromEntry,i=typeof r.outputReducer=="function"?r.outputReducer:null,o=Ti.assign({},gy,r.settings),s=Ti.validateSettings(o);if(s)throw new Error("graphology-layout-forceatlas2: "+s.message);var f=Ti.graphToByteArrays(t,a),c;for(c=0;c<n;c++)by(o,f.nodes,f.edges);if(e){Ti.assignLayoutChanges(t,f.nodes,i);return}return Ti.collectLayoutChanges(t,f.nodes)}function Ay(e){var t=typeof e=="number"?e:e.order;return{barnesHutOptimize:t>2e3,strongGravityMode:!0,gravity:.05,scalingRatio:10,slowDown:1+Math.log(t)}}var ls=id.bind(null,!1);ls.assign=id.bind(null,!0);ls.inferSettings=Ay;var Ty=ls;class ps{constructor(){this.nodes=[],this.edges=[],this.combos=[],this.comboEdges=[],this.hiddenNodes=[],this.hiddenEdges=[],this.hiddenCombos=[],this.vedges=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=()=>{}}layout(t){return this.init(t),this.execute(!0)}init(t){this.nodes=t.nodes||[],this.edges=t.edges||[],this.combos=t.combos||[],this.comboEdges=t.comboEdges||[],this.hiddenNodes=t.hiddenNodes||[],this.hiddenEdges=t.hiddenEdges||[],this.hiddenCombos=t.hiddenCombos||[],this.vedges=t.vedges||[]}execute(t){}executeWithWorker(){}getDefaultCfg(){return{}}updateCfg(t){t&&Object.assign(this,t)}getType(){return"base"}destroy(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0}}const rs=Array.isArray,nt=e=>typeof e=="number",vs=e=>e!==null&&typeof e=="object",Or=(e,t)=>{const r=e[t];return vs(r)?r.cell:r},wy=(e,t)=>{const r={};return e.forEach(n=>{r[n.id]={in:0,out:0,all:0}}),t&&t.forEach(n=>{const a=Or(n,"source"),i=Or(n,"target");a&&(r[a].out+=1,r[a].all+=1),i&&(r[i].in+=1,r[i].all+=1)}),r},ec=e=>{const t={x:0,y:0};e.forEach(n=>{t.x+=n.x||0,t.y+=n.y||0});const r=e.length||1;return{x:t.x/r,y:t.y/r}},tc=(e,t,r)=>{var n,a;return e==="source"?((n=r==null?void 0:r.find(i=>i.target===t.id))===null||n===void 0?void 0:n.source)||{}:((a=r==null?void 0:r.find(i=>i.source===t.id))===null||a===void 0?void 0:a.target)||{}},rc=(e,t,r)=>{let n=[];switch(e){case"source":n=r==null?void 0:r.filter(i=>i.source===t.id).map(i=>i.target);break;case"target":n=r==null?void 0:r.filter(i=>i.target===t.id).map(i=>i.source);break;case"both":n=r==null?void 0:r.filter(i=>i.source===t.id).map(i=>i.target).concat(r==null?void 0:r.filter(i=>i.target===t.id).map(i=>i.source));break}const a=new Set(n);return Array.from(a)},Sy=(e,t,r,n,a)=>{const i=r[t]||"";let o=(n==null?void 0:n.filter(s=>s[t]===i))||[];return e==="leaf"&&(o=o.filter(s=>{var f,c;return((f=a[s.id])===null||f===void 0?void 0:f.in)===0||((c=a[s.id])===null||c===void 0?void 0:c.out)===0})),o},Ry=(e,t,r,n,a,i)=>{const{in:o,out:s}=a[t.id];let f=t,c=[];o===0?(f=tc("source",t,r),c=rc("both",f,r).map(h=>i[h])):s===0&&(f=tc("target",t,r),c=rc("both",f,r).map(h=>i[h])),c=c.filter(h=>a[h.id]&&(a[h.id].in===0||a[h.id].out===0));const d=Sy(e,n,t,c,a);return{coreNode:f,relativeLeafNodes:c,sameTypeLeafNodes:d}},Ly=e=>typeof e=="function";function xy(e){const t=+this._x.call(null,e),r=+this._y.call(null,e);return ad(this.cover(t,r),t,r,e)}function ad(e,t,r,n){if(isNaN(t)||isNaN(r))return e;var a,i=e._root,o={data:n},s=e._x0,f=e._y0,c=e._x1,d=e._y1,h,y,C,L,k,U,B,q;if(!i)return e._root=o,e;for(;i.length;)if((k=t>=(h=(s+c)/2))?s=h:c=h,(U=r>=(y=(f+d)/2))?f=y:d=y,a=i,!(i=i[B=U<<1|k]))return a[B]=o,e;if(C=+e._x.call(null,i.data),L=+e._y.call(null,i.data),t===C&&r===L)return o.next=i,a?a[B]=o:e._root=o,e;do a=a?a[B]=new Array(4):e._root=new Array(4),(k=t>=(h=(s+c)/2))?s=h:c=h,(U=r>=(y=(f+d)/2))?f=y:d=y;while((B=U<<1|k)===(q=(L>=y)<<1|C>=h));return a[q]=i,a[B]=o,e}function Ny(e){var t,r,n=e.length,a,i,o=new Array(n),s=new Array(n),f=1/0,c=1/0,d=-1/0,h=-1/0;for(r=0;r<n;++r)isNaN(a=+this._x.call(null,t=e[r]))||isNaN(i=+this._y.call(null,t))||(o[r]=a,s[r]=i,a<f&&(f=a),a>d&&(d=a),i<c&&(c=i),i>h&&(h=i));if(f>d||c>h)return this;for(this.cover(f,c).cover(d,h),r=0;r<n;++r)ad(this,o[r],s[r],e[r]);return this}function Oy(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var r=this._x0,n=this._y0,a=this._x1,i=this._y1;if(isNaN(r))a=(r=Math.floor(e))+1,i=(n=Math.floor(t))+1;else{for(var o=a-r||1,s=this._root,f,c;r>e||e>=a||n>t||t>=i;)switch(c=(t<n)<<1|e<r,f=new Array(4),f[c]=s,s=f,o*=2,c){case 0:a=r+o,i=n+o;break;case 1:r=a-o,i=n+o;break;case 2:a=r+o,n=i-o;break;case 3:r=a-o,n=i-o;break}this._root&&this._root.length&&(this._root=s)}return this._x0=r,this._y0=n,this._x1=a,this._y1=i,this}function Iy(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Cy(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Kt(e,t,r,n,a){this.node=e,this.x0=t,this.y0=r,this.x1=n,this.y1=a}function Dy(e,t,r){var n,a=this._x0,i=this._y0,o,s,f,c,d=this._x1,h=this._y1,y=[],C=this._root,L,k;for(C&&y.push(new Kt(C,a,i,d,h)),r==null?r=1/0:(a=e-r,i=t-r,d=e+r,h=t+r,r*=r);L=y.pop();)if(!(!(C=L.node)||(o=L.x0)>d||(s=L.y0)>h||(f=L.x1)<a||(c=L.y1)<i))if(C.length){var U=(o+f)/2,B=(s+c)/2;y.push(new Kt(C[3],U,B,f,c),new Kt(C[2],o,B,U,c),new Kt(C[1],U,s,f,B),new Kt(C[0],o,s,U,B)),(k=(t>=B)<<1|e>=U)&&(L=y[y.length-1],y[y.length-1]=y[y.length-1-k],y[y.length-1-k]=L)}else{var q=e-+this._x.call(null,C.data),se=t-+this._y.call(null,C.data),fe=q*q+se*se;if(fe<r){var de=Math.sqrt(r=fe);a=e-de,i=t-de,d=e+de,h=t+de,n=C.data}}return n}function Gy(e){if(isNaN(d=+this._x.call(null,e))||isNaN(h=+this._y.call(null,e)))return this;var t,r=this._root,n,a,i,o=this._x0,s=this._y0,f=this._x1,c=this._y1,d,h,y,C,L,k,U,B;if(!r)return this;if(r.length)for(;;){if((L=d>=(y=(o+f)/2))?o=y:f=y,(k=h>=(C=(s+c)/2))?s=C:c=C,t=r,!(r=r[U=k<<1|L]))return this;if(!r.length)break;(t[U+1&3]||t[U+2&3]||t[U+3&3])&&(n=t,B=U)}for(;r.data!==e;)if(a=r,!(r=r.next))return this;return(i=r.next)&&delete r.next,a?(i?a.next=i:delete a.next,this):t?(i?t[U]=i:delete t[U],(r=t[0]||t[1]||t[2]||t[3])&&r===(t[3]||t[2]||t[1]||t[0])&&!r.length&&(n?n[B]=r:this._root=r),this):(this._root=i,this)}function Fy(e){for(var t=0,r=e.length;t<r;++t)this.remove(e[t]);return this}function Uy(){return this._root}function My(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Py(e){var t=[],r,n=this._root,a,i,o,s,f;for(n&&t.push(new Kt(n,this._x0,this._y0,this._x1,this._y1));r=t.pop();)if(!e(n=r.node,i=r.x0,o=r.y0,s=r.x1,f=r.y1)&&n.length){var c=(i+s)/2,d=(o+f)/2;(a=n[3])&&t.push(new Kt(a,c,d,s,f)),(a=n[2])&&t.push(new Kt(a,i,d,c,f)),(a=n[1])&&t.push(new Kt(a,c,o,s,d)),(a=n[0])&&t.push(new Kt(a,i,o,c,d))}return this}function ky(e){var t=[],r=[],n;for(this._root&&t.push(new Kt(this._root,this._x0,this._y0,this._x1,this._y1));n=t.pop();){var a=n.node;if(a.length){var i,o=n.x0,s=n.y0,f=n.x1,c=n.y1,d=(o+f)/2,h=(s+c)/2;(i=a[0])&&t.push(new Kt(i,o,s,d,h)),(i=a[1])&&t.push(new Kt(i,d,s,f,h)),(i=a[2])&&t.push(new Kt(i,o,h,d,c)),(i=a[3])&&t.push(new Kt(i,d,h,f,c))}r.push(n)}for(;n=r.pop();)e(n.node,n.x0,n.y0,n.x1,n.y1);return this}function By(e){return e[0]}function jy(e){return arguments.length?(this._x=e,this):this._x}function $y(e){return e[1]}function Hy(e){return arguments.length?(this._y=e,this):this._y}function od(e,t,r){var n=new ys(t==null?By:t,r==null?$y:r,NaN,NaN,NaN,NaN);return e==null?n:n.addAll(e)}function ys(e,t,r,n,a,i){this._x=e,this._y=t,this._x0=r,this._y0=n,this._x1=a,this._y1=i,this._root=void 0}function nc(e){for(var t={data:e.data},r=t;e=e.next;)r=r.next={data:e.data};return t}var qt=od.prototype=ys.prototype;qt.copy=function(){var e=new ys(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,r,n;if(!t)return e;if(!t.length)return e._root=nc(t),e;for(r=[{source:t,target:e._root=new Array(4)}];t=r.pop();)for(var a=0;a<4;++a)(n=t.source[a])&&(n.length?r.push({source:n,target:t.target[a]=new Array(4)}):t.target[a]=nc(n));return e};qt.add=xy;qt.addAll=Ny;qt.cover=Oy;qt.data=Iy;qt.extent=Cy;qt.find=Dy;qt.remove=Gy;qt.removeAll=Fy;qt.root=Uy;qt.size=My;qt.visit=Py;qt.visitAfter=ky;qt.x=jy;qt.y=Hy;const Vy=.81,ic=.1;function Xy(e,t,r,n,a){const i=r/n,o=e.map((f,c)=>{const d=t[f.id],{data:h,x:y,y:C,size:L}=d,{nodeStrength:k}=h.layout.force;return{x:y,y:C,size:L,index:c,vx:0,vy:0,weight:i*k}}),s=od(o,f=>f.x,f=>f.y).visitAfter(Wy);return o.forEach(f=>{Yy(f,s)}),o.map((f,c)=>{const d=t[e[c].id],{mass:h=1}=d.data.layout.force;a[2*c]=f.vx/h,a[2*c+1]=f.vy/h}),a}function Wy(e){let t=0,r=0,n=0;if(e.length){for(let a=0;a<4;a++){const i=e[a];i&&i.weight&&(t+=i.weight,r+=i.x*i.weight,n+=i.y*i.weight)}e.x=r/t,e.y=n/t,e.weight=t}else{const a=e;e.x=a.data.x,e.y=a.data.y,e.weight=a.data.weight}}const zy=(e,t,r,n,a,i)=>{const o=i.x-e.x||ic,s=i.y-e.y||ic,f=n-t,c=o*o+s*s,d=Math.sqrt(c)*c;if(f*f*Vy<c){const h=e.weight/d;return i.vx+=o*h,i.vy+=s*h,!0}if(e.length)return!1;if(e.data!==i){const h=e.data.weight/d;i.vx+=o*h,i.vy+=s*h}};function Yy(e,t){t.visit((r,n,a,i,o)=>zy(r,n,a,i,o,e))}const Wo=(e,t)=>{let r;return e?nt(e)?r=n=>e:r=e:r=n=>t||1,r};class Ky extends ps{constructor(t){super(),this.maxIteration=1e3,this.workerEnabled=!1,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=500,this.minMovement=.4,this.interval=.02,this.factor=1,this.linkDistance=200,this.gravity=0,this.clusterNodeStrength=20,this.preventOverlap=!0,this.distanceThresholdMode="mean",this.tick=()=>{},this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.judgingDistance=0,this.centripetalOptions={leaf:2,single:2,others:1,center:n=>({x:this.width/2,y:this.height/2})};const{getMass:r}=t;this.propsGetMass=r,this.updateCfg(t)}getCentripetalOptions(){const{leafCluster:t,clustering:r,nodeClusterBy:n,nodes:a,nodeMap:i,clusterNodeStrength:o}=this,s=C=>typeof o=="function"?o(C):o;let f={},c;if(t){c=this.getSameTypeLeafMap()||{};const C=Array.from(new Set(a==null?void 0:a.map(L=>L[n])))||[];f={single:100,leaf:(L,k,U)=>{const{relativeLeafNodes:B,sameTypeLeafNodes:q}=c[L.id]||{};return(q==null?void 0:q.length)===(B==null?void 0:B.length)||(C==null?void 0:C.length)===1?1:s(L)},others:1,center:(L,k,U)=>{var B;const{degree:q}=((B=L.data)===null||B===void 0?void 0:B.layout)||{};if(!q)return{x:100,y:100};let se;if(q===1){const{sameTypeLeafNodes:fe=[]}=c[L.id]||{};fe.length===1?se=void 0:fe.length>1&&(se=ec(fe))}else se=void 0;return{x:se==null?void 0:se.x,y:se==null?void 0:se.y}}}}if(r){c||(c=this.getSameTypeLeafMap());const C=Array.from(new Set(a.map((k,U)=>k[n]))).filter(k=>k!==void 0),L={};C.forEach(k=>{const U=a.filter(B=>B[n]===k).map(B=>i[B.id]);L[k]=ec(U)}),f={single:k=>s(k),leaf:k=>s(k),others:k=>s(k),center:(k,U,B)=>{const q=L[k[n]];return{x:q==null?void 0:q.x,y:q==null?void 0:q.y}}}}this.centripetalOptions=Object.assign(Object.assign({},this.centripetalOptions),f);const{leaf:d,single:h,others:y}=this.centripetalOptions;d&&typeof d!="function"&&(this.centripetalOptions.leaf=()=>d),h&&typeof h!="function"&&(this.centripetalOptions.single=()=>h),y&&typeof y!="function"&&(this.centripetalOptions.others=()=>y)}updateCfg(t){t&&Object.assign(this,t)}getDefaultCfg(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}}execute(){const t=this;t.stop();const{nodes:r,edges:n,defSpringLen:a}=t;if(t.judgingDistance=0,!r||r.length===0){t.onLayoutEnd([]);return}!t.width&&typeof window<"u"&&(t.width=window.innerWidth),!t.height&&typeof window<"u"&&(t.height=window.innerHeight),t.center||(t.center=[t.width/2,t.height/2]);const i=t.center;if(r.length===1){r[0].x=i[0],r[0].y=i[1],t.onLayoutEnd([Object.assign({},r[0])]);return}t.degreesMap=wy(r,n),t.propsGetMass?t.getMass=t.propsGetMass:t.getMass=d=>{let h=1;nt(d.mass)&&(h=d.mass);const y=t.degreesMap[d.id].all;return!y||y<5?h:y*5*h};const o=t.nodeSize;let s;if(t.preventOverlap){const d=t.nodeSpacing;let h;nt(d)?h=()=>d:Ly(d)?h=d:h=()=>0,o?rs(o)?s=y=>Math.max(o[0],o[1])+h(y):s=y=>o+h(y):s=y=>y.size?rs(y.size)?Math.max(y.size[0],y.size[1])+h(y):vs(y.size)?Math.max(y.size.width,y.size.height)+h(y):y.size+h(y):10+h(y)}t.nodeSize=s,t.linkDistance=Wo(t.linkDistance,1),t.nodeStrength=Wo(t.nodeStrength,1),t.edgeStrength=Wo(t.edgeStrength,1);const f={},c={};r.forEach((d,h)=>{nt(d.x)||(d.x=Math.random()*t.width),nt(d.y)||(d.y=Math.random()*t.height);const y=t.degreesMap[d.id];f[d.id]=Object.assign(Object.assign({},d),{data:Object.assign(Object.assign({},d.data),{size:t.nodeSize(d)||30,layout:{inDegree:y.in,outDegree:y.out,degree:y.all,tDegree:y.in,sDegree:y.out,force:{mass:t.getMass(d),nodeStrength:t.nodeStrength(d)}}})}),c[d.id]=h}),t.nodeMap=f,t.nodeIdxMap=c,t.edgeInfos=[],n==null||n.forEach(d=>{const h=f[d.source],y=f[d.target];!h||!y?elf.edgeInfos.push({}):t.edgeInfos.push({edgeStrength:t.edgeStrength(d),linkDistance:a?a(Object.assign(Object.assign({},d),{source:h,target:y}),h,y):t.linkDistance(d,h,y)||1+(o(h)+o(h)||0)/2})}),this.getCentripetalOptions(),t.onLayoutEnd=t.onLayoutEnd||(()=>{}),t.run()}run(){const t=this,{maxIteration:r,nodes:n,workerEnabled:a,minMovement:i,animate:o,nodeMap:s}=t;if(!n)return;const f=[];n.forEach((h,y)=>{f[2*y]=0,f[2*y+1]=0});const c=r;if(a||!o){for(let h=0;(t.judgingDistance>i||h<1)&&h<c;h++)t.runOneStep(h,f);t.onLayoutEnd(Object.values(s))}else{if(typeof window>"u")return;let h=0;this.timeInterval=window.setInterval(()=>{!n||(t.runOneStep(h,f),h++,(h>=c||t.judgingDistance<i)&&(t.onLayoutEnd(Object.values(s)),window.clearInterval(t.timeInterval)))},0)}}runOneStep(t,r){var n;const a=this,{nodes:i,edges:o,nodeMap:s,monitor:f}=a,c=[];if(!(i!=null&&i.length))return;a.calRepulsive(c),o&&a.calAttractive(c),a.calGravity(c);const d=a.interval;if(a.updateVelocity(c,r,d),a.updatePosition(r,d),(n=a.tick)===null||n===void 0||n.call(a),f){const h=this.calTotalEnergy(c);f({energy:h,nodes:i,edges:o,iterations:t})}}calTotalEnergy(t){const{nodes:r,nodeMap:n}=this;if(!(r!=null&&r.length))return 0;let a=0;return r.forEach((i,o)=>{const s=t[2*o],f=t[2*o+1],c=s*s+f*f,{mass:d=1}=n[i.id].data.layout.force;a+=d*c*.5}),a}calRepulsive(t){const r=this,{nodes:n,nodeMap:a,factor:i,coulombDisScale:o}=r;r.nodeSize,Xy(n,a,i,o*o,t)}calAttractive(t){const r=this,{edges:n,nodeMap:a,nodeIdxMap:i,edgeInfos:o}=r;r.nodeSize,n.forEach((s,f)=>{const c=Or(s,"source"),d=Or(s,"target"),h=a[c],y=a[d];if(!h||!y)return;let C=y.x-h.x,L=y.y-h.y;!C&&!L&&(C=Math.random()*.01,L=Math.random()*.01);const k=Math.sqrt(C*C+L*L),U=C/k,B=L/k,{linkDistance:q=200,edgeStrength:se=200}=o[f]||{},de=(q-k)*se,Ze=h.data.layout.force.mass||1,Oe=y.data.layout.force.mass||1,Ge=1/Ze,K=1/Oe,Mt=U*de,Dt=B*de,Rt=2*i[c],Pt=2*i[d];t[Rt]-=Mt*Ge,t[Rt+1]-=Dt*Ge,t[Pt]+=Mt*K,t[Pt+1]+=Dt*K})}calGravity(t){var r;const n=this,{nodes:a,edges:i=[],nodeMap:o,width:s,height:f,center:c,gravity:d,degreesMap:h,centripetalOptions:y}=n;if(!a)return;const C=a.length;for(let L=0;L<C;L++){const k=2*L,U=o[a[L].id],{mass:B=1}=U.data.layout.force;let q=0,se=0,fe=d;const{in:de,out:Ze,all:Oe}=h[U.id],Ge=(r=n.getCenter)===null||r===void 0?void 0:r.call(n,U,Oe);if(Ge){const[K,Mt,Dt]=Ge;q=U.x-K,se=U.y-Mt,fe=Dt}else q=U.x-c[0],se=U.y-c[1];if(fe&&(t[k]-=fe*q/B,t[k+1]-=fe*se/B),y){const{leaf:K,single:Mt,others:Dt,center:Rt}=y,{x:Pt,y:vt,centerStrength:we}=(Rt==null?void 0:Rt(U,a,i,s,f))||{x:0,y:0,centerStrength:0};if(!nt(Pt)||!nt(vt))continue;const he=(U.x-Pt)/B,Ee=(U.y-vt)/B;if(we&&(t[k]-=we*he,t[k+1]-=we*Ee),Oe===0){const Me=Mt(U);if(!Me)continue;t[k]-=Me*he,t[k+1]-=Me*Ee;continue}if(de===0||Ze===0){const Me=K(U,a,i);if(!Me)continue;t[k]-=Me*he,t[k+1]-=Me*Ee;continue}const Fe=Dt(U);if(!Fe)continue;t[k]-=Fe*he,t[k+1]-=Fe*Ee}}}updateVelocity(t,r,n){const a=this,{nodes:i,damping:o,maxSpeed:s}=a;!(i!=null&&i.length)||i.forEach((f,c)=>{let d=(r[2*c]+t[2*c]*n)*o||.01,h=(r[2*c+1]+t[2*c+1]*n)*o||.01;const y=Math.sqrt(d*d+h*h);if(y>s){const C=s/y;d=C*d,h=C*h}r[2*c]=d,r[2*c+1]=h})}updatePosition(t,r){const n=this,{nodes:a,distanceThresholdMode:i,nodeMap:o}=n;if(!(a!=null&&a.length)){this.judgingDistance=0;return}let s=0;i==="max"?n.judgingDistance=-1/0:i==="min"&&(n.judgingDistance=1/0),a.forEach((f,c)=>{const d=o[f.id];if(nt(f.fx)&&nt(f.fy)){f.x=f.fx,f.y=f.fy,d.x=f.x,d.y=f.y;return}const h=t[2*c]*r,y=t[2*c+1]*r;f.x+=h,f.y+=y,d.x=f.x,d.y=f.y;const C=Math.sqrt(h*h+y*y);switch(i){case"max":n.judgingDistance<C&&(n.judgingDistance=C);break;case"min":n.judgingDistance>C&&(n.judgingDistance=C);break;default:s=s+C;break}}),(!i||i==="mean")&&(n.judgingDistance=s/a.length)}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval)}destroy(){const t=this;t.stop(),t.tick=null,t.nodes=null,t.edges=null,t.destroyed=!0}getType(){return"force2"}getSameTypeLeafMap(){const{nodeClusterBy:t,nodes:r,edges:n,nodeMap:a,degreesMap:i}=this;if(!(r!=null&&r.length))return;const o={};return r.forEach((s,f)=>{i[s.id].all===1&&(o[s.id]=Ry("leaf",s,n,t,i,a))}),o}}var Kn;(function(e){e.DEFAULT_EDGE_NAME="\0",e.GRAPH_NODE="\0",e.EDGE_KEY_DELIM=""})(Kn||(Kn={}));function ac(e,t){var r=e.get(t)||0;e.set(t,r+1)}function oc(e,t){var r=e.get(t);r!==void 0&&(r=r-1,r>0?e.set(t,r):e.delete(t))}function sd(e,t,r,n){var a=String(t),i=String(r);if(!e&&a>i){var o=a;a=i,i=o}return a+Kn.EDGE_KEY_DELIM+i+Kn.EDGE_KEY_DELIM+(n===void 0?Kn.DEFAULT_EDGE_NAME:n)}function sc(e,t,r,n){var a=String(t),i=String(r),o={v:t,w:r};if(!e&&a>i){var s=o.v;o.v=o.w,o.w=s}return n!==void 0&&(o.name=n),o}function zo(e,t){return sd(e,t.v,t.w,t.name)}function uc(e){return typeof e=="function"}var qy=function(t){return t.nodes().map(function(r){var n=t.node(r),a=t.parent(r),i={id:r,value:n,parent:a};return i.value===void 0&&delete i.value,i.parent===void 0&&delete i.parent,i})},Qy=function(t){return t.edges().map(function(r){var n=t.edge(r),a={v:r.v,w:r.w,value:n,name:r.name};return a.name===void 0&&delete a.name,a.value===void 0&&delete a.value,a})},Zy=function(t){var r={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:qy(t),edges:Qy(t),value:t.graph()};return r.value===void 0&&delete r.value,r},Jy=function(t){var r=new ud(t.options);return t.value!==void 0&&r.setGraph(t.value),t.nodes.forEach(function(n){r.setNode(n.id,n.value),n.parent&&r.setParent(n.id,n.parent)}),t.edges.forEach(function(n){r.setEdge(n.v,n.w,n.value,n.name)}),r};function fc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fc(Object(r),!0).forEach(function(n){em(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fc(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function em(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tm(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dc(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function rm(e,t,r){return t&&dc(e.prototype,t),r&&dc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var nm={compound:!1,multigraph:!1,directed:!0},ud=function(){function e(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};tm(this,e),this.directed=!0,this.multigraph=!1,this.compound=!1,this.GRAPH_NODE=Kn.GRAPH_NODE,this.label=void 0,this.nodeCountNum=0,this.edgeCountNum=0,this.defaultNodeLabelFn=function(){},this.defaultEdgeLabelFn=function(){},this.parentMap=void 0,this.childrenMap=void 0,this.nodesLabelMap=new Map,this.inEdgesMap=new Map,this.outEdgesMap=new Map,this.predecessorsMap=new Map,this.successorsMap=new Map,this.edgesMap=new Map,this.edgesLabelsMap=new Map,this.isDirected=function(){return t.directed},this.isMultigraph=function(){return t.multigraph},this.isCompound=function(){return t.compound},this.setGraph=function(a){return t.label=a,t},this.graph=function(){return t.label},this.setDefaultNodeLabel=function(a){return uc(a)?t.defaultNodeLabelFn=a:t.defaultNodeLabelFn=function(){return a},t},this.nodeCount=function(){return t.nodeCountNum},this.node=function(a){return t.nodesLabelMap.get(a)},this.nodes=function(){return Array.from(t.nodesLabelMap.keys())},this.sources=function(){return t.nodes().filter(function(a){var i;return!(!((i=t.inEdgesMap.get(a))===null||i===void 0)&&i.size)})},this.sinks=function(){return t.nodes().filter(function(a){var i;return!(!((i=t.outEdgesMap.get(a))===null||i===void 0)&&i.size)})},this.setNodes=function(a,i){return a.map(function(o){return t.setNode(o,i)}),t},this.hasNode=function(a){return t.nodesLabelMap.has(a)},this.checkCompound=function(){if(!t.isCompound())throw new Error("Cannot construct parent-children relations in a non-compound graph")},this.parent=function(a){if(t.isCompound()){var i,o=(i=t.parentMap)===null||i===void 0?void 0:i.get(a);if(o!==t.GRAPH_NODE)return o}},this.removeFromParentsChildList=function(a){var i=t.parentMap.get(a);t.childrenMap.get(i).delete(a)},this.setParent=function(a,i){var o,s;t.checkCompound();for(var f=i===void 0?t.GRAPH_NODE:i,c=t.parent(f);c;){if(a===c)throw new Error("Setting "+i+" as parent of "+a+" would create a cycle");c=t.parent(c)}i&&t.setNode(i),t.setNode(a),t.removeFromParentsChildList(a),(o=t.parentMap)===null||o===void 0||o.set(a,f);var d=t.childrenMap.get(f);return d.set(a,!0),(s=t.childrenMap)===null||s===void 0||s.set(f,d),t},this.children=function(a){var i=a===void 0?t.GRAPH_NODE:a;if(t.isCompound()){var o,s=(o=t.childrenMap)===null||o===void 0?void 0:o.get(i);return s?Array.from(s.keys()):void 0}if(i===t.GRAPH_NODE)return t.nodes();if(a&&t.hasNode(a))return[]},this.predecessors=function(a){var i=t.predecessorsMap.get(a);return i?Array.from(i.keys()):void 0},this.successors=function(a){var i=t.successorsMap.get(a);return i?Array.from(i.keys()):void 0},this.neighbors=function(a){var i;if(!!t.hasNode(a))return Array.from(new Set((i=t.predecessors(a))===null||i===void 0?void 0:i.concat(t.successors(a))))},this.isLeaf=function(a){var i;if(t.isDirected()){var o;return!(!((o=t.successors(a))===null||o===void 0)&&o.length)}return!(!((i=t.neighbors(a))===null||i===void 0)&&i.length)},this.filterNodes=function(a){var i=t.directed,o=t.multigraph,s=t.compound,f=new e({directed:i,multigraph:o,compound:s});if(f.setGraph(t.graph()),t.nodes().forEach(function(d){a(d)&&f.setNode(d,t.node(d))}),t.edges().forEach(function(d){f.hasNode(d.v)&&f.hasNode(d.w)&&f.setEdgeObj(d,t.edge(d))}),s){var c=function(h){for(var y=t.parent(h);y!==void 0&&!f.hasNode(y);)y=t.parent(y);return y};f.nodes().forEach(function(d){f.setParent(d,c(d))})}return f},this.setDefaultEdgeLabel=function(a){return uc(a)?t.defaultEdgeLabelFn=a:t.defaultEdgeLabelFn=function(){return a},t},this.edgeCount=function(){return t.edgeCountNum},this.setEdgeObj=function(a,i){return t.setEdge(a.v,a.w,i,a.name)},this.setPath=function(a,i){return a.reduce(function(o,s){return t.setEdge(o,s,i),s}),t},this.edgeFromArgs=function(a,i,o){return t.edge({v:a,w:i,name:o})},this.edge=function(a){return t.edgesLabelsMap.get(zo(t.isDirected(),a))},this.hasEdge=function(a,i,o){return t.edgesLabelsMap.has(zo(t.isDirected(),{v:a,w:i,name:o}))},this.removeEdgeObj=function(a){var i=a.v,o=a.w,s=a.name;return t.removeEdge(i,o,s)},this.edges=function(){return Array.from(t.edgesMap.values())},this.inEdges=function(a,i){var o=t.inEdgesMap.get(a);if(o)return Array.from(o.values()).filter(function(s){return!i||s.v===i})},this.outEdges=function(a,i){var o=t.outEdgesMap.get(a);if(o)return Array.from(o.values()).filter(function(s){return!i||s.w===i})},this.nodeEdges=function(a,i){var o;if(!!t.hasNode(a))return(o=t.inEdges(a,i))===null||o===void 0?void 0:o.concat(t.outEdges(a,i))},this.toJSON=function(){return Zy(t)},this.nodeInDegree=function(a){var i=t.inEdgesMap.get(a);return i?i.size:0},this.nodeOutDegree=function(a){var i=t.outEdgesMap.get(a);return i?i.size:0},this.nodeDegree=function(a){return t.nodeInDegree(a)+t.nodeOutDegree(a)},this.source=function(a){return a.v},this.target=function(a){return a.w};var n=cc(cc({},nm),r);this.compound=n.compound,this.directed=n.directed,this.multigraph=n.multigraph,this.compound&&(this.parentMap=new Map,this.childrenMap=new Map)}return rm(e,[{key:"setNode",value:function(r,n){var a=this.nodesLabelMap,i=this.defaultNodeLabelFn,o=this.isCompound,s=this.parentMap,f=this.childrenMap,c=this.inEdgesMap,d=this.outEdgesMap,h=this.predecessorsMap,y=this.successorsMap;if(a.has(r))return n!==void 0&&a.set(r,n),this;if(a.set(r,n||i(r)),o()){var C;s==null||s.set(r,this.GRAPH_NODE),f==null||f.set(r,new Map),f!=null&&f.has(this.GRAPH_NODE)||f==null||f.set(this.GRAPH_NODE,new Map),f==null||(C=f.get(this.GRAPH_NODE))===null||C===void 0||C.set(r,!0)}return[c,d,h,y].forEach(function(L){return L.set(r,new Map)}),this.nodeCountNum+=1,this}},{key:"removeNode",value:function(r){var n=this;if(this.hasNode(r)){var a=function(U){n.removeEdge(U.v,U.w,U.name)},i=this.inEdgesMap,o=this.outEdgesMap,s=this.predecessorsMap,f=this.successorsMap,c=this.nodesLabelMap;if(this.isCompound()){var d,h,y;this.removeFromParentsChildList(r),(d=this.parentMap)===null||d===void 0||d.delete(r),(h=this.children(r))===null||h===void 0||h.forEach(function(k){return n.setParent(k)}),(y=this.childrenMap)===null||y===void 0||y.delete(r)}var C=i.get(r),L=o.get(r);Array.from(C.values()).forEach(function(k){return a(k)}),Array.from(L.values()).forEach(function(k){return a(k)}),c.delete(r),i.delete(r),o.delete(r),s.delete(r),f.delete(r),this.nodeCountNum-=1}return this}},{key:"setEdge",value:function(r,n,a,i){var o,s,f=sc(this.isDirected(),r,n,i),c=zo(this.isDirected(),f),d=f.v,h=f.w;if(this.edgesLabelsMap.has(c))return this.edgesLabelsMap.set(c,a),this;if(i!==void 0&&!this.isMultigraph())throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(d),this.setNode(h),this.edgesLabelsMap.set(c,a||this.defaultEdgeLabelFn(d,h,i)),Object.freeze(f),this.edgesMap.set(c,f);var y=this.predecessorsMap.get(h),C=this.successorsMap.get(d);return ac(y,d),ac(C,h),(o=this.inEdgesMap.get(h))===null||o===void 0||o.set(c,f),(s=this.outEdgesMap.get(d))===null||s===void 0||s.set(c,f),this.edgeCountNum+=1,this}},{key:"removeEdge",value:function(r,n,a){var i=sd(this.isDirected(),r,n,a),o=this.edgesMap.get(i);if(o){var s=sc(this.isDirected(),r,n,a),f=s.v,c=s.w;this.edgesLabelsMap.delete(i),this.edgesMap.delete(i);var d=this.predecessorsMap.get(c),h=this.successorsMap.get(f);oc(d,f),oc(h,c),this.inEdgesMap.get(c).delete(i),this.outEdgesMap.get(f).delete(i),this.edgeCountNum-=1}return this}}]),e}();ud.fromJSON=Jy;var hc,lc,pc,vc;(function(e){e[e.META=0]="META",e[e.NODE=1]="NODE",e[e.BRIDGE=2]="BRIDGE"})(hc||(hc={})),function(e){e[e.INCLUDE=0]="INCLUDE",e[e.EXCLUDE=1]="EXCLUDE",e[e.UNSPECIFIED=2]="UNSPECIFIED"}(lc||(lc={})),function(e){e[e.META=0]="META",e[e.CORE=1]="CORE",e[e.BRIDGE=2]="BRIDGE"}(pc||(pc={})),function(e){e[e.META=0]="META",e[e.OP=1]="OP",e[e.SERIES=2]="SERIES"}(vc||(vc={}));var Ea=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ms(e,t){return e(t={exports:{}},t.exports),t.exports}var im=function(){this.__data__=[],this.size=0},ri=function(e,t){return e===t||e!=e&&t!=t},Ca=function(e,t){for(var r=e.length;r--;)if(ri(e[r][0],t))return r;return-1},am=Array.prototype.splice,om=function(e){var t=this.__data__,r=Ca(t,e);return!(r<0)&&(r==t.length-1?t.pop():am.call(t,r,1),--this.size,!0)},sm=function(e){var t=this.__data__,r=Ca(t,e);return r<0?void 0:t[r][1]},um=function(e){return Ca(this.__data__,e)>-1},fm=function(e,t){var r=this.__data__,n=Ca(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function $n(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}$n.prototype.clear=im,$n.prototype.delete=om,$n.prototype.get=sm,$n.prototype.has=um,$n.prototype.set=fm;var Da=$n,cm=function(){this.__data__=new Da,this.size=0},dm=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},hm=function(e){return this.__data__.get(e)},lm=function(e){return this.__data__.has(e)},fd=typeof Ea=="object"&&Ea&&Ea.Object===Object&&Ea,pm=typeof self=="object"&&self&&self.Object===Object&&self,br=fd||pm||Function("return this")(),lr=br.Symbol,cd=Object.prototype,vm=cd.hasOwnProperty,ym=cd.toString,wi=lr?lr.toStringTag:void 0,mm=function(e){var t=vm.call(e,wi),r=e[wi];try{e[wi]=void 0;var n=!0}catch{}var a=ym.call(e);return n&&(t?e[wi]=r:delete e[wi]),a},Em=Object.prototype.toString,_m=function(e){return Em.call(e)},yc=lr?lr.toStringTag:void 0,Jr=function(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":yc&&yc in Object(e)?mm(e):_m(e)},tr=function(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")},mc,Mi=function(e){if(!tr(e))return!1;var t=Jr(e);return t=="[object Function]"||t=="[object GeneratorFunction]"||t=="[object AsyncFunction]"||t=="[object Proxy]"},Yo=br["__core-js_shared__"],Ec=(mc=/[^.]+$/.exec(Yo&&Yo.keys&&Yo.keys.IE_PROTO||""))?"Symbol(src)_1."+mc:"",bm=function(e){return!!Ec&&Ec in e},gm=Function.prototype.toString,gn=function(e){if(e!=null){try{return gm.call(e)}catch{}try{return e+""}catch{}}return""},Am=/^\[object .+?Constructor\]$/,Tm=Function.prototype,wm=Object.prototype,Sm=Tm.toString,Rm=wm.hasOwnProperty,Lm=RegExp("^"+Sm.call(Rm).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xm=function(e){return!(!tr(e)||bm(e))&&(Mi(e)?Lm:Am).test(gn(e))},Nm=function(e,t){return e==null?void 0:e[t]},An=function(e,t){var r=Nm(e,t);return xm(r)?r:void 0},Di=An(br,"Map"),Gi=An(Object,"create"),Om=function(){this.__data__=Gi?Gi(null):{},this.size=0},Im=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Cm=Object.prototype.hasOwnProperty,Dm=function(e){var t=this.__data__;if(Gi){var r=t[e];return r==="__lodash_hash_undefined__"?void 0:r}return Cm.call(t,e)?t[e]:void 0},Gm=Object.prototype.hasOwnProperty,Fm=function(e){var t=this.__data__;return Gi?t[e]!==void 0:Gm.call(t,e)},Um=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Gi&&t===void 0?"__lodash_hash_undefined__":t,this};function Hn(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Hn.prototype.clear=Om,Hn.prototype.delete=Im,Hn.prototype.get=Dm,Hn.prototype.has=Fm,Hn.prototype.set=Um;var _c=Hn,Mm=function(){this.size=0,this.__data__={hash:new _c,map:new(Di||Da),string:new _c}},Pm=function(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null},Ga=function(e,t){var r=e.__data__;return Pm(t)?r[typeof t=="string"?"string":"hash"]:r.map},km=function(e){var t=Ga(this,e).delete(e);return this.size-=t?1:0,t},Bm=function(e){return Ga(this,e).get(e)},jm=function(e){return Ga(this,e).has(e)},$m=function(e,t){var r=Ga(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function Vn(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Vn.prototype.clear=Mm,Vn.prototype.delete=km,Vn.prototype.get=Bm,Vn.prototype.has=jm,Vn.prototype.set=$m;var Fa=Vn,Hm=function(e,t){var r=this.__data__;if(r instanceof Da){var n=r.__data__;if(!Di||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Fa(n)}return r.set(e,t),this.size=r.size,this};function Xn(e){var t=this.__data__=new Da(e);this.size=t.size}Xn.prototype.clear=cm,Xn.prototype.delete=dm,Xn.prototype.get=hm,Xn.prototype.has=lm,Xn.prototype.set=Hm;var qn=Xn,Es=function(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e},Sa=function(){try{var e=An(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Ua=function(e,t,r){t=="__proto__"&&Sa?Sa(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},Vm=Object.prototype.hasOwnProperty,Ma=function(e,t,r){var n=e[t];Vm.call(e,t)&&ri(n,r)&&(r!==void 0||t in e)||Ua(e,t,r)},Pi=function(e,t,r,n){var a=!r;r||(r={});for(var i=-1,o=t.length;++i<o;){var s=t[i],f=n?n(r[s],e[s],s,r,e):void 0;f===void 0&&(f=e[s]),a?Ua(r,s,f):Ma(r,s,f)}return r},Xm=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n},_r=function(e){return e!=null&&typeof e=="object"},bc=function(e){return _r(e)&&Jr(e)=="[object Arguments]"},dd=Object.prototype,Wm=dd.hasOwnProperty,zm=dd.propertyIsEnumerable,ei=bc(function(){return arguments}())?bc:function(e){return _r(e)&&Wm.call(e,"callee")&&!zm.call(e,"callee")},St=Array.isArray,Ym=function(){return!1},En=ms(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r?br.Buffer:void 0,i=(a?a.isBuffer:void 0)||Ym;e.exports=i}),Km=/^(?:0|[1-9]\d*)$/,Pa=function(e,t){var r=typeof e;return!!(t=t==null?9007199254740991:t)&&(r=="number"||r!="symbol"&&Km.test(e))&&e>-1&&e%1==0&&e<t},_s=function(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=9007199254740991},lt={};lt["[object Float32Array]"]=lt["[object Float64Array]"]=lt["[object Int8Array]"]=lt["[object Int16Array]"]=lt["[object Int32Array]"]=lt["[object Uint8Array]"]=lt["[object Uint8ClampedArray]"]=lt["[object Uint16Array]"]=lt["[object Uint32Array]"]=!0,lt["[object Arguments]"]=lt["[object Array]"]=lt["[object ArrayBuffer]"]=lt["[object Boolean]"]=lt["[object DataView]"]=lt["[object Date]"]=lt["[object Error]"]=lt["[object Function]"]=lt["[object Map]"]=lt["[object Number]"]=lt["[object Object]"]=lt["[object RegExp]"]=lt["[object Set]"]=lt["[object String]"]=lt["[object WeakMap]"]=!1;var qm=function(e){return _r(e)&&_s(e.length)&&!!lt[Jr(e)]},ka=function(e){return function(t){return e(t)}},ti=ms(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r&&fd.process,i=function(){try{var o=n&&n.require&&n.require("util").types;return o||a&&a.binding&&a.binding("util")}catch{}}();e.exports=i}),gc=ti&&ti.isTypedArray,ki=gc?ka(gc):qm,Qm=Object.prototype.hasOwnProperty,hd=function(e,t){var r=St(e),n=!r&&ei(e),a=!r&&!n&&En(e),i=!r&&!n&&!a&&ki(e),o=r||n||a||i,s=o?Xm(e.length,String):[],f=s.length;for(var c in e)!t&&!Qm.call(e,c)||o&&(c=="length"||a&&(c=="offset"||c=="parent")||i&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||Pa(c,f))||s.push(c);return s},Zm=Object.prototype,Ba=function(e){var t=e&&e.constructor;return e===(typeof t=="function"&&t.prototype||Zm)},ld=function(e,t){return function(r){return e(t(r))}},Jm=ld(Object.keys,Object),eE=Object.prototype.hasOwnProperty,bs=function(e){if(!Ba(e))return Jm(e);var t=[];for(var r in Object(e))eE.call(e,r)&&r!="constructor"&&t.push(r);return t},jr=function(e){return e!=null&&_s(e.length)&&!Mi(e)},en=function(e){return jr(e)?hd(e):bs(e)},tE=function(e,t){return e&&Pi(t,en(t),e)},rE=function(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t},nE=Object.prototype.hasOwnProperty,iE=function(e){if(!tr(e))return rE(e);var t=Ba(e),r=[];for(var n in e)(n!="constructor"||!t&&nE.call(e,n))&&r.push(n);return r},Tn=function(e){return jr(e)?hd(e,!0):iE(e)},aE=function(e,t){return e&&Pi(t,Tn(t),e)},pd=ms(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r?br.Buffer:void 0,i=a?a.allocUnsafe:void 0;e.exports=function(o,s){if(s)return o.slice();var f=o.length,c=i?i(f):new o.constructor(f);return o.copy(c),c}}),vd=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t},yd=function(e,t){for(var r=-1,n=e==null?0:e.length,a=0,i=[];++r<n;){var o=e[r];t(o,r,e)&&(i[a++]=o)}return i},md=function(){return[]},oE=Object.prototype.propertyIsEnumerable,Ac=Object.getOwnPropertySymbols,gs=Ac?function(e){return e==null?[]:(e=Object(e),yd(Ac(e),function(t){return oE.call(e,t)}))}:md,sE=function(e,t){return Pi(e,gs(e),t)},As=function(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e},ja=ld(Object.getPrototypeOf,Object),Ed=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)As(t,gs(e)),e=ja(e);return t}:md,uE=function(e,t){return Pi(e,Ed(e),t)},_d=function(e,t,r){var n=t(e);return St(e)?n:As(n,r(e))},ns=function(e){return _d(e,en,gs)},fE=function(e){return _d(e,Tn,Ed)},is=An(br,"DataView"),as=An(br,"Promise"),Qn=An(br,"Set"),os=An(br,"WeakMap"),cE=gn(is),dE=gn(Di),hE=gn(as),lE=gn(Qn),pE=gn(os),mn=Jr;(is&&mn(new is(new ArrayBuffer(1)))!="[object DataView]"||Di&&mn(new Di)!="[object Map]"||as&&mn(as.resolve())!="[object Promise]"||Qn&&mn(new Qn)!="[object Set]"||os&&mn(new os)!="[object WeakMap]")&&(mn=function(e){var t=Jr(e),r=t=="[object Object]"?e.constructor:void 0,n=r?gn(r):"";if(n)switch(n){case cE:return"[object DataView]";case dE:return"[object Map]";case hE:return"[object Promise]";case lE:return"[object Set]";case pE:return"[object WeakMap]"}return t});var _n=mn,vE=Object.prototype.hasOwnProperty,yE=function(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&vE.call(e,"index")&&(r.index=e.index,r.input=e.input),r},Ra=br.Uint8Array,Ts=function(e){var t=new e.constructor(e.byteLength);return new Ra(t).set(new Ra(e)),t},mE=function(e,t){var r=t?Ts(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)},EE=/\w*$/,_E=function(e){var t=new e.constructor(e.source,EE.exec(e));return t.lastIndex=e.lastIndex,t},Tc=lr?lr.prototype:void 0,wc=Tc?Tc.valueOf:void 0,bE=function(e){return wc?Object(wc.call(e)):{}},bd=function(e,t){var r=t?Ts(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},gE=function(e,t,r){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return Ts(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return mE(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return bd(e,r);case"[object Map]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return _E(e);case"[object Set]":return new n;case"[object Symbol]":return bE(e)}},Sc=Object.create,gd=function(){function e(){}return function(t){if(!tr(t))return{};if(Sc)return Sc(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),Ad=function(e){return typeof e.constructor!="function"||Ba(e)?{}:gd(ja(e))},AE=function(e){return _r(e)&&_n(e)=="[object Map]"},Rc=ti&&ti.isMap,TE=Rc?ka(Rc):AE,wE=function(e){return _r(e)&&_n(e)=="[object Set]"},Lc=ti&&ti.isSet,SE=Lc?ka(Lc):wE,dt={};dt["[object Arguments]"]=dt["[object Array]"]=dt["[object ArrayBuffer]"]=dt["[object DataView]"]=dt["[object Boolean]"]=dt["[object Date]"]=dt["[object Float32Array]"]=dt["[object Float64Array]"]=dt["[object Int8Array]"]=dt["[object Int16Array]"]=dt["[object Int32Array]"]=dt["[object Map]"]=dt["[object Number]"]=dt["[object Object]"]=dt["[object RegExp]"]=dt["[object Set]"]=dt["[object String]"]=dt["[object Symbol]"]=dt["[object Uint8Array]"]=dt["[object Uint8ClampedArray]"]=dt["[object Uint16Array]"]=dt["[object Uint32Array]"]=!0,dt["[object Error]"]=dt["[object Function]"]=dt["[object WeakMap]"]=!1;var Td=function e(t,r,n,a,i,o){var s,f=1&r,c=2&r,d=4&r;if(n&&(s=i?n(t,a,i,o):n(t)),s!==void 0)return s;if(!tr(t))return t;var h=St(t);if(h){if(s=yE(t),!f)return vd(t,s)}else{var y=_n(t),C=y=="[object Function]"||y=="[object GeneratorFunction]";if(En(t))return pd(t,f);if(y=="[object Object]"||y=="[object Arguments]"||C&&!i){if(s=c||C?{}:Ad(t),!f)return c?uE(t,aE(s,t)):sE(t,tE(s,t))}else{if(!dt[y])return i?t:{};s=gE(t,y,f)}}o||(o=new qn);var L=o.get(t);if(L)return L;o.set(t,s),SE(t)?t.forEach(function(U){s.add(e(U,r,n,U,t,o))}):TE(t)&&t.forEach(function(U,B){s.set(B,e(U,r,n,B,t,o))});var k=h?void 0:(d?c?fE:ns:c?Tn:en)(t);return Es(k||t,function(U,B){k&&(U=t[B=U]),Ma(s,B,e(U,r,n,B,t,o))}),s},RE=function(e){return Td(e,4)},ws=function(e){return function(){return e}},Ss=function(e){return function(t,r,n){for(var a=-1,i=Object(t),o=n(t),s=o.length;s--;){var f=o[e?s:++a];if(r(i[f],f,i)===!1)break}return t}}(),Rs=function(e,t){return e&&Ss(e,t,en)},$a=function(e,t){return function(r,n){if(r==null)return r;if(!jr(r))return e(r,n);for(var a=r.length,i=t?a:-1,o=Object(r);(t?i--:++i<a)&&n(o[i],i,o)!==!1;);return r}}(Rs),wn=function(e){return e},wd=function(e){return typeof e=="function"?e:wn},Sd=function(e,t){return(St(e)?Es:$a)(e,wd(t))},Rd=Sd,LE=function(e,t){var r=[];return $a(e,function(n,a,i){t(n,a,i)&&r.push(n)}),r},xE=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},NE=function(e){return this.__data__.has(e)};function Aa(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Fa;++t<r;)this.add(e[t])}Aa.prototype.add=Aa.prototype.push=xE,Aa.prototype.has=NE;var Ld=Aa,OE=function(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1},xd=function(e,t){return e.has(t)},Nd=function(e,t,r,n,a,i){var o=1&r,s=e.length,f=t.length;if(s!=f&&!(o&&f>s))return!1;var c=i.get(e),d=i.get(t);if(c&&d)return c==t&&d==e;var h=-1,y=!0,C=2&r?new Ld:void 0;for(i.set(e,t),i.set(t,e);++h<s;){var L=e[h],k=t[h];if(n)var U=o?n(k,L,h,t,e,i):n(L,k,h,e,t,i);if(U!==void 0){if(U)continue;y=!1;break}if(C){if(!OE(t,function(B,q){if(!xd(C,q)&&(L===B||a(L,B,r,n,i)))return C.push(q)})){y=!1;break}}else if(L!==k&&!a(L,k,r,n,i)){y=!1;break}}return i.delete(e),i.delete(t),y},IE=function(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r},Ls=function(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r},xc=lr?lr.prototype:void 0,Ko=xc?xc.valueOf:void 0,CE=function(e,t,r,n,a,i,o){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!i(new Ra(e),new Ra(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return ri(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=IE;case"[object Set]":var f=1&n;if(s||(s=Ls),e.size!=t.size&&!f)return!1;var c=o.get(e);if(c)return c==t;n|=2,o.set(e,t);var d=Nd(s(e),s(t),n,a,i,o);return o.delete(e),d;case"[object Symbol]":if(Ko)return Ko.call(e)==Ko.call(t)}return!1},DE=Object.prototype.hasOwnProperty,GE=function(e,t,r,n,a,i){var o=1&r,s=ns(e),f=s.length;if(f!=ns(t).length&&!o)return!1;for(var c=f;c--;){var d=s[c];if(!(o?d in t:DE.call(t,d)))return!1}var h=i.get(e),y=i.get(t);if(h&&y)return h==t&&y==e;var C=!0;i.set(e,t),i.set(t,e);for(var L=o;++c<f;){var k=e[d=s[c]],U=t[d];if(n)var B=o?n(U,k,d,t,e,i):n(k,U,d,e,t,i);if(!(B===void 0?k===U||a(k,U,r,n,i):B)){C=!1;break}L||(L=d=="constructor")}if(C&&!L){var q=e.constructor,se=t.constructor;q==se||!("constructor"in e)||!("constructor"in t)||typeof q=="function"&&q instanceof q&&typeof se=="function"&&se instanceof se||(C=!1)}return i.delete(e),i.delete(t),C},Nc=Object.prototype.hasOwnProperty,FE=function(e,t,r,n,a,i){var o=St(e),s=St(t),f=o?"[object Array]":_n(e),c=s?"[object Array]":_n(t),d=(f=f=="[object Arguments]"?"[object Object]":f)=="[object Object]",h=(c=c=="[object Arguments]"?"[object Object]":c)=="[object Object]",y=f==c;if(y&&En(e)){if(!En(t))return!1;o=!0,d=!1}if(y&&!d)return i||(i=new qn),o||ki(e)?Nd(e,t,r,n,a,i):CE(e,t,f,r,n,a,i);if(!(1&r)){var C=d&&Nc.call(e,"__wrapped__"),L=h&&Nc.call(t,"__wrapped__");if(C||L){var k=C?e.value():e,U=L?t.value():t;return i||(i=new qn),a(k,U,r,n,i)}}return!!y&&(i||(i=new qn),GE(e,t,r,n,a,i))},Od=function e(t,r,n,a,i){return t===r||(t==null||r==null||!_r(t)&&!_r(r)?t!=t&&r!=r:FE(t,r,n,a,e,i))},UE=function(e,t,r,n){var a=r.length,i=a,o=!n;if(e==null)return!i;for(e=Object(e);a--;){var s=r[a];if(o&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++a<i;){var f=(s=r[a])[0],c=e[f],d=s[1];if(o&&s[2]){if(c===void 0&&!(f in e))return!1}else{var h=new qn;if(n)var y=n(c,d,f,e,t,h);if(!(y===void 0?Od(d,c,3,n,h):y))return!1}}return!0},Id=function(e){return e==e&&!tr(e)},ME=function(e){for(var t=en(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,Id(a)]}return t},Cd=function(e,t){return function(r){return r!=null&&r[e]===t&&(t!==void 0||e in Object(r))}},PE=function(e){var t=ME(e);return t.length==1&&t[0][2]?Cd(t[0][0],t[0][1]):function(r){return r===e||UE(r,e,t)}},bn=function(e){return typeof e=="symbol"||_r(e)&&Jr(e)=="[object Symbol]"},kE=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,BE=/^\w*$/,xs=function(e,t){if(St(e))return!1;var r=typeof e;return!(r!="number"&&r!="symbol"&&r!="boolean"&&e!=null&&!bn(e))||BE.test(e)||!kE.test(e)||t!=null&&e in Object(t)};function Ns(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError("Expected a function");var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var o=e.apply(this,n);return r.cache=i.set(a,o)||i,o};return r.cache=new(Ns.Cache||Fa),r}Ns.Cache=Fa;var jE=Ns,$E=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,HE=/\\(\\)?/g,VE=function(e){var t=jE(e,function(n){return r.size===500&&r.clear(),n}),r=t.cache;return t}(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace($E,function(r,n,a,i){t.push(a?i.replace(HE,"$1"):n||r)}),t}),Zn=function(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a},Oc=lr?lr.prototype:void 0,Ic=Oc?Oc.toString:void 0,XE=function e(t){if(typeof t=="string")return t;if(St(t))return Zn(t,e)+"";if(bn(t))return Ic?Ic.call(t):"";var r=t+"";return r=="0"&&1/t==-1/0?"-0":r},Dd=function(e){return e==null?"":XE(e)},Ha=function(e,t){return St(e)?e:xs(e,t)?[e]:VE(Dd(e))},Bi=function(e){if(typeof e=="string"||bn(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t},Va=function(e,t){for(var r=0,n=(t=Ha(t,e)).length;e!=null&&r<n;)e=e[Bi(t[r++])];return r&&r==n?e:void 0},WE=function(e,t,r){var n=e==null?void 0:Va(e,t);return n===void 0?r:n},zE=function(e,t){return e!=null&&t in Object(e)},Gd=function(e,t,r){for(var n=-1,a=(t=Ha(t,e)).length,i=!1;++n<a;){var o=Bi(t[n]);if(!(i=e!=null&&r(e,o)))break;e=e[o]}return i||++n!=a?i:!!(a=e==null?0:e.length)&&_s(a)&&Pa(o,a)&&(St(e)||ei(e))},Fd=function(e,t){return e!=null&&Gd(e,t,zE)},YE=function(e,t){return xs(e)&&Id(t)?Cd(Bi(e),t):function(r){var n=WE(r,e);return n===void 0&&n===t?Fd(r,e):Od(t,n,3)}},Ud=function(e){return function(t){return t==null?void 0:t[e]}},KE=function(e){return function(t){return Va(t,e)}},qE=function(e){return xs(e)?Ud(Bi(e)):KE(e)},$r=function(e){return typeof e=="function"?e:e==null?wn:typeof e=="object"?St(e)?YE(e[0],e[1]):PE(e):qE(e)},Md=function(e,t){return(St(e)?yd:LE)(e,$r(t))},QE=Object.prototype.hasOwnProperty,ZE=function(e,t){return e!=null&&QE.call(e,t)},Pd=function(e,t){return e!=null&&Gd(e,t,ZE)},JE=Object.prototype.hasOwnProperty,e_=function(e){if(e==null)return!0;if(jr(e)&&(St(e)||typeof e=="string"||typeof e.splice=="function"||En(e)||ki(e)||ei(e)))return!e.length;var t=_n(e);if(t=="[object Map]"||t=="[object Set]")return!e.size;if(Ba(e))return!bs(e).length;for(var r in e)if(JE.call(e,r))return!1;return!0},kd=function(e){return e===void 0},Bd=function(e,t){var r=-1,n=jr(e)?Array(e.length):[];return $a(e,function(a,i,o){n[++r]=t(a,i,o)}),n},jd=function(e,t){return(St(e)?Zn:Bd)(e,$r(t))},t_=function(e,t,r,n){var a=-1,i=e==null?0:e.length;for(n&&i&&(r=e[++a]);++a<i;)r=t(r,e[a],a,e);return r},r_=function(e,t,r,n,a){return a(e,function(i,o,s){r=n?(n=!1,i):t(r,i,o,s)}),r},$d=function(e,t,r){var n=St(e)?t_:r_,a=arguments.length<3;return n(e,$r(t),r,a,$a)},n_=function(e){return typeof e=="string"||!St(e)&&_r(e)&&Jr(e)=="[object String]"},i_=Ud("length"),a_=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),o_=function(e){return a_.test(e)},s_="[\\ud800-\\udfff]",ss="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",us="\\ud83c[\\udffb-\\udfff]",Hd="[^\\ud800-\\udfff]",Vd="(?:\\ud83c[\\udde6-\\uddff]){2}",Xd="[\\ud800-\\udbff][\\udc00-\\udfff]",Cc="(?:"+ss+"|"+us+")?",u_="[\\ufe0e\\ufe0f]?"+Cc+("(?:\\u200d(?:"+[Hd,Vd,Xd].join("|")+")[\\ufe0e\\ufe0f]?"+Cc+")*"),f_="(?:"+[Hd+ss+"?",ss,Vd,Xd,s_].join("|")+")",Dc=RegExp(us+"(?="+us+")|"+f_+u_,"g"),c_=function(e){for(var t=Dc.lastIndex=0;Dc.test(e);)++t;return t},d_=function(e){return o_(e)?c_(e):i_(e)},h_=function(e){if(e==null)return 0;if(jr(e))return n_(e)?d_(e):e.length;var t=_n(e);return t=="[object Map]"||t=="[object Set]"?e.size:bs(e).length},l_=function(e,t,r){var n=St(e),a=n||En(e)||ki(e);if(t=$r(t),r==null){var i=e&&e.constructor;r=a?n?new i:[]:tr(e)&&Mi(i)?gd(ja(e)):{}}return(a?Es:Rs)(e,function(o,s,f){return t(r,o,s,f)}),r},Gc=lr?lr.isConcatSpreadable:void 0,p_=function(e){return St(e)||ei(e)||!!(Gc&&e&&e[Gc])},Os=function e(t,r,n,a,i){var o=-1,s=t.length;for(n||(n=p_),i||(i=[]);++o<s;){var f=t[o];r>0&&n(f)?r>1?e(f,r-1,n,a,i):As(i,f):a||(i[i.length]=f)}return i},v_=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},Fc=Math.max,Wd=function(e,t,r){return t=Fc(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=Fc(n.length-t,0),o=Array(i);++a<i;)o[a]=n[t+a];a=-1;for(var s=Array(t+1);++a<t;)s[a]=n[a];return s[t]=r(o),v_(e,this,s)}},y_=Sa?function(e,t){return Sa(e,"toString",{configurable:!0,enumerable:!1,value:ws(t),writable:!0})}:wn,m_=Date.now,zd=function(e){var t=0,r=0;return function(){var n=m_(),a=16-(n-r);if(r=n,a>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(y_),Xa=function(e,t){return zd(Wd(e,t,wn),e+"")},Yd=function(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1},E_=function(e){return e!=e},__=function(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1},b_=function(e,t,r){return t==t?__(e,t,r):Yd(e,E_,r)},g_=function(e,t){return!!(e!=null&&e.length)&&b_(e,t,0)>-1},A_=function(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1},T_=function(){},w_=Qn&&1/Ls(new Qn([,-0]))[1]==1/0?function(e){return new Qn(e)}:T_,S_=function(e,t,r){var n=-1,a=g_,i=e.length,o=!0,s=[],f=s;if(r)o=!1,a=A_;else if(i>=200){var c=t?null:w_(e);if(c)return Ls(c);o=!1,a=xd,f=new Ld}else f=t?[]:s;e:for(;++n<i;){var d=e[n],h=t?t(d):d;if(d=r||d!==0?d:0,o&&h==h){for(var y=f.length;y--;)if(f[y]===h)continue e;t&&f.push(h),s.push(d)}else a(f,h,r)||(f!==s&&f.push(h),s.push(d))}return s},Kd=function(e){return _r(e)&&jr(e)},R_=Xa(function(e){return S_(Os(e,1,Kd,!0))}),L_=function(e,t){return Zn(t,function(r){return e[r]})},La,qd=function(e){return e==null?[]:L_(e,en(e))};try{La={clone:RE,constant:ws,each:Rd,filter:Md,has:Pd,isArray:St,isEmpty:e_,isFunction:Mi,isUndefined:kd,keys:en,map:jd,reduce:$d,size:h_,transform:l_,union:R_,values:qd}}catch{}La||(La=window._);var Le=La,Is=tt;function tt(e){this._isDirected=!Le.has(e,"directed")||e.directed,this._isMultigraph=!!Le.has(e,"multigraph")&&e.multigraph,this._isCompound=!!Le.has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=Le.constant(void 0),this._defaultEdgeLabelFn=Le.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function Uc(e,t){e[t]?e[t]++:e[t]=1}function Mc(e,t){--e[t]||delete e[t]}function Ii(e,t,r,n){var a=""+t,i=""+r;if(!e&&a>i){var o=a;a=i,i=o}return a+""+i+""+(Le.isUndefined(n)?"\0":n)}function x_(e,t,r,n){var a=""+t,i=""+r;if(!e&&a>i){var o=a;a=i,i=o}var s={v:a,w:i};return n&&(s.name=n),s}function qo(e,t){return Ii(e,t.v,t.w,t.name)}tt.prototype._nodeCount=0,tt.prototype._edgeCount=0,tt.prototype.isDirected=function(){return this._isDirected},tt.prototype.isMultigraph=function(){return this._isMultigraph},tt.prototype.isCompound=function(){return this._isCompound},tt.prototype.setGraph=function(e){return this._label=e,this},tt.prototype.graph=function(){return this._label},tt.prototype.setDefaultNodeLabel=function(e){return Le.isFunction(e)||(e=Le.constant(e)),this._defaultNodeLabelFn=e,this},tt.prototype.nodeCount=function(){return this._nodeCount},tt.prototype.nodes=function(){return Le.keys(this._nodes)},tt.prototype.sources=function(){var e=this;return Le.filter(this.nodes(),function(t){return Le.isEmpty(e._in[t])})},tt.prototype.sinks=function(){var e=this;return Le.filter(this.nodes(),function(t){return Le.isEmpty(e._out[t])})},tt.prototype.setNodes=function(e,t){var r=arguments,n=this;return Le.each(e,function(a){r.length>1?n.setNode(a,t):n.setNode(a)}),this},tt.prototype.setNode=function(e,t){return Le.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]="\0",this._children[e]={},this._children["\0"][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},tt.prototype.node=function(e){return this._nodes[e]},tt.prototype.hasNode=function(e){return Le.has(this._nodes,e)},tt.prototype.removeNode=function(e){var t=this;if(Le.has(this._nodes,e)){var r=function(n){t.removeEdge(t._edgeObjs[n])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],Le.each(this.children(e),function(n){t.setParent(n)}),delete this._children[e]),Le.each(Le.keys(this._in[e]),r),delete this._in[e],delete this._preds[e],Le.each(Le.keys(this._out[e]),r),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},tt.prototype.setParent=function(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(Le.isUndefined(t))t="\0";else{for(var r=t+="";!Le.isUndefined(r);r=this.parent(r))if(r===e)throw new Error("Setting "+t+" as parent of "+e+" would create a cycle");this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this},tt.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},tt.prototype.parent=function(e){if(this._isCompound){var t=this._parent[e];if(t!=="\0")return t}},tt.prototype.children=function(e){if(Le.isUndefined(e)&&(e="\0"),this._isCompound){var t=this._children[e];if(t)return Le.keys(t)}else{if(e==="\0")return this.nodes();if(this.hasNode(e))return[]}},tt.prototype.predecessors=function(e){var t=this._preds[e];if(t)return Le.keys(t)},tt.prototype.successors=function(e){var t=this._sucs[e];if(t)return Le.keys(t)},tt.prototype.neighbors=function(e){var t=this.predecessors(e);if(t)return Le.union(t,this.successors(e))},tt.prototype.isLeaf=function(e){return(this.isDirected()?this.successors(e):this.neighbors(e)).length===0},tt.prototype.filterNodes=function(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var r=this;Le.each(this._nodes,function(i,o){e(o)&&t.setNode(o,i)}),Le.each(this._edgeObjs,function(i){t.hasNode(i.v)&&t.hasNode(i.w)&&t.setEdge(i,r.edge(i))});var n={};function a(i){var o=r.parent(i);return o===void 0||t.hasNode(o)?(n[i]=o,o):o in n?n[o]:a(o)}return this._isCompound&&Le.each(t.nodes(),function(i){t.setParent(i,a(i))}),t},tt.prototype.setDefaultEdgeLabel=function(e){return Le.isFunction(e)||(e=Le.constant(e)),this._defaultEdgeLabelFn=e,this},tt.prototype.edgeCount=function(){return this._edgeCount},tt.prototype.edges=function(){return Le.values(this._edgeObjs)},tt.prototype.setPath=function(e,t){var r=this,n=arguments;return Le.reduce(e,function(a,i){return n.length>1?r.setEdge(a,i,t):r.setEdge(a,i),i}),this},tt.prototype.setEdge=function(){var e,t,r,n,a=!1,i=arguments[0];typeof i=="object"&&i!==null&&"v"in i?(e=i.v,t=i.w,r=i.name,arguments.length===2&&(n=arguments[1],a=!0)):(e=i,t=arguments[1],r=arguments[3],arguments.length>2&&(n=arguments[2],a=!0)),e=""+e,t=""+t,Le.isUndefined(r)||(r=""+r);var o=Ii(this._isDirected,e,t,r);if(Le.has(this._edgeLabels,o))return a&&(this._edgeLabels[o]=n),this;if(!Le.isUndefined(r)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[o]=a?n:this._defaultEdgeLabelFn(e,t,r);var s=x_(this._isDirected,e,t,r);return e=s.v,t=s.w,Object.freeze(s),this._edgeObjs[o]=s,Uc(this._preds[t],e),Uc(this._sucs[e],t),this._in[t][o]=s,this._out[e][o]=s,this._edgeCount++,this},tt.prototype.edge=function(e,t,r){var n=arguments.length===1?qo(this._isDirected,arguments[0]):Ii(this._isDirected,e,t,r);return this._edgeLabels[n]},tt.prototype.hasEdge=function(e,t,r){var n=arguments.length===1?qo(this._isDirected,arguments[0]):Ii(this._isDirected,e,t,r);return Le.has(this._edgeLabels,n)},tt.prototype.removeEdge=function(e,t,r){var n=arguments.length===1?qo(this._isDirected,arguments[0]):Ii(this._isDirected,e,t,r),a=this._edgeObjs[n];return a&&(e=a.v,t=a.w,delete this._edgeLabels[n],delete this._edgeObjs[n],Mc(this._preds[t],e),Mc(this._sucs[e],t),delete this._in[t][n],delete this._out[e][n],this._edgeCount--),this},tt.prototype.inEdges=function(e,t){var r=this._in[e];if(r){var n=Le.values(r);return t?Le.filter(n,function(a){return a.v===t}):n}},tt.prototype.outEdges=function(e,t){var r=this._out[e];if(r){var n=Le.values(r);return t?Le.filter(n,function(a){return a.w===t}):n}},tt.prototype.nodeEdges=function(e,t){var r=this.inEdges(e,t);if(r)return r.concat(this.outEdges(e,t))};var Pc={Graph:Is,version:"2.1.8"},N_={write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:O_(e),edges:I_(e)};return Le.isUndefined(e.graph())||(t.value=Le.clone(e.graph())),t},read:function(e){var t=new Is(e.options).setGraph(e.value);return Le.each(e.nodes,function(r){t.setNode(r.v,r.value),r.parent&&t.setParent(r.v,r.parent)}),Le.each(e.edges,function(r){t.setEdge({v:r.v,w:r.w,name:r.name},r.value)}),t}};function O_(e){return Le.map(e.nodes(),function(t){var r=e.node(t),n=e.parent(t),a={v:t};return Le.isUndefined(r)||(a.value=r),Le.isUndefined(n)||(a.parent=n),a})}function I_(e){return Le.map(e.edges(),function(t){var r=e.edge(t),n={v:t.v,w:t.w};return Le.isUndefined(t.name)||(n.name=t.name),Le.isUndefined(r)||(n.value=r),n})}var C_=function(e){var t,r={},n=[];function a(i){Le.has(r,i)||(r[i]=!0,t.push(i),Le.each(e.successors(i),a),Le.each(e.predecessors(i),a))}return Le.each(e.nodes(),function(i){t=[],a(i),t.length&&n.push(t)}),n},Qd=dr;function dr(){this._arr=[],this._keyIndices={}}dr.prototype.size=function(){return this._arr.length},dr.prototype.keys=function(){return this._arr.map(function(e){return e.key})},dr.prototype.has=function(e){return Le.has(this._keyIndices,e)},dr.prototype.priority=function(e){var t=this._keyIndices[e];if(t!==void 0)return this._arr[t].priority},dr.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},dr.prototype.add=function(e,t){var r=this._keyIndices;if(e=String(e),!Le.has(r,e)){var n=this._arr,a=n.length;return r[e]=a,n.push({key:e,priority:t}),this._decrease(a),!0}return!1},dr.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},dr.prototype.decrease=function(e,t){var r=this._keyIndices[e];if(t>this._arr[r].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[r].priority+" New: "+t);this._arr[r].priority=t,this._decrease(r)},dr.prototype._heapify=function(e){var t=this._arr,r=2*e,n=r+1,a=e;r<t.length&&(a=t[r].priority<t[a].priority?r:a,n<t.length&&(a=t[n].priority<t[a].priority?n:a),a!==e&&(this._swap(e,a),this._heapify(a)))},dr.prototype._decrease=function(e){for(var t,r=this._arr,n=r[e].priority;e!==0&&!(r[t=e>>1].priority<n);)this._swap(e,t),e=t},dr.prototype._swap=function(e,t){var r=this._arr,n=this._keyIndices,a=r[e],i=r[t];r[e]=i,r[t]=a,n[i.key]=e,n[a.key]=t};var Zd=function(e,t,r,n){return function(a,i,o,s){var f,c,d={},h=new Qd,y=function(C){var L=C.v!==f?C.v:C.w,k=d[L],U=o(C),B=c.distance+U;if(U<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+C+" Weight: "+U);B<k.distance&&(k.distance=B,k.predecessor=f,h.decrease(L,B))};for(a.nodes().forEach(function(C){var L=C===i?0:Number.POSITIVE_INFINITY;d[C]={distance:L},h.add(C,L)});h.size()>0&&(f=h.removeMin(),(c=d[f]).distance!==Number.POSITIVE_INFINITY);)s(f).forEach(y);return d}(e,String(t),r||D_,n||function(a){return e.outEdges(a)})},D_=Le.constant(1),G_=function(e,t,r){return Le.transform(e.nodes(),function(n,a){n[a]=Zd(e,a,t,r)},{})},Jd=function(e){var t=0,r=[],n={},a=[];function i(o){var s=n[o]={onStack:!0,lowlink:t,index:t++};if(r.push(o),e.successors(o).forEach(function(d){Le.has(n,d)?n[d].onStack&&(s.lowlink=Math.min(s.lowlink,n[d].index)):(i(d),s.lowlink=Math.min(s.lowlink,n[d].lowlink))}),s.lowlink===s.index){var f,c=[];do f=r.pop(),n[f].onStack=!1,c.push(f);while(o!==f);a.push(c)}}return e.nodes().forEach(function(o){Le.has(n,o)||i(o)}),a},F_=function(e){return Le.filter(Jd(e),function(t){return t.length>1||t.length===1&&e.hasEdge(t[0],t[0])})},U_=function(e,t,r){return function(n,a,i){var o={},s=n.nodes();return s.forEach(function(f){o[f]={},o[f][f]={distance:0},s.forEach(function(c){f!==c&&(o[f][c]={distance:Number.POSITIVE_INFINITY})}),i(f).forEach(function(c){var d=c.v===f?c.w:c.v,h=a(c);o[f][d]={distance:h,predecessor:f}})}),s.forEach(function(f){var c=o[f];s.forEach(function(d){var h=o[d];s.forEach(function(y){var C=h[f],L=c[y],k=h[y],U=C.distance+L.distance;U<k.distance&&(k.distance=U,k.predecessor=L.predecessor)})})}),o}(e,t||M_,r||function(n){return e.outEdges(n)})},M_=Le.constant(1),Qo=eh;function eh(e){var t={},r={},n=[];if(Le.each(e.sinks(),function a(i){if(Le.has(r,i))throw new xa;Le.has(t,i)||(r[i]=!0,t[i]=!0,Le.each(e.predecessors(i),a),delete r[i],n.push(i))}),Le.size(t)!==e.nodeCount())throw new xa;return n}function xa(){}eh.CycleException=xa,xa.prototype=new Error;var kc=function(e,t,r){Le.isArray(t)||(t=[t]);var n=(e.isDirected()?e.successors:e.neighbors).bind(e),a=[],i={};return Le.each(t,function(o){if(!e.hasNode(o))throw new Error("Graph does not have node: "+o);th(e,o,r==="post",i,n,a)}),a};function th(e,t,r,n,a,i){Le.has(n,t)||(n[t]=!0,r||i.push(t),Le.each(a(t),function(o){th(e,o,r,n,a,i)}),r&&i.push(t))}var Na,P_={Graph:Pc.Graph,json:N_,alg:{components:C_,dijkstra:Zd,dijkstraAll:G_,findCycles:F_,floydWarshall:U_,isAcyclic:function(e){try{Qo(e)}catch(t){if(t instanceof Qo.CycleException)return!1;throw t}return!0},postorder:function(e,t){return kc(e,t,"post")},preorder:function(e,t){return kc(e,t,"pre")},prim:function(e,t){var r,n=new Is,a={},i=new Qd;function o(f){var c=f.v===r?f.w:f.v,d=i.priority(c);if(d!==void 0){var h=t(f);h<d&&(a[c]=r,i.decrease(c,h))}}if(e.nodeCount()===0)return n;Le.each(e.nodes(),function(f){i.add(f,Number.POSITIVE_INFINITY),n.setNode(f)}),i.decrease(e.nodes()[0],0);for(var s=!1;i.size()>0;){if(r=i.removeMin(),Le.has(a,r))n.setEdge(r,a[r]);else{if(s)throw new Error("Input graph is not connected: "+e);s=!0}e.nodeEdges(r).forEach(o)}return n},tarjan:Jd,topsort:Qo},version:Pc.version};try{Na=P_}catch{}Na||(Na=window.graphlib);var Cr=Na,k_=function(e){return Td(e,5)},Fi=function(e,t,r){if(!tr(r))return!1;var n=typeof t;return!!(n=="number"?jr(r)&&Pa(t,r.length):n=="string"&&t in r)&&ri(r[t],e)},rh=Object.prototype,B_=rh.hasOwnProperty,j_=Xa(function(e,t){e=Object(e);var r=-1,n=t.length,a=n>2?t[2]:void 0;for(a&&Fi(t[0],t[1],a)&&(n=1);++r<n;)for(var i=t[r],o=Tn(i),s=-1,f=o.length;++s<f;){var c=o[s],d=e[c];(d===void 0||ri(d,rh[c])&&!B_.call(e,c))&&(e[c]=i[c])}return e}),$_=function(e){return function(t,r,n){var a=Object(t);if(!jr(t)){var i=$r(r);t=en(t),r=function(s){return i(a[s],s,a)}}var o=e(t,r,n);return o>-1?a[i?t[o]:o]:void 0}},H_=/^\s+|\s+$/g,V_=/^[-+]0x[0-9a-f]+$/i,X_=/^0b[01]+$/i,W_=/^0o[0-7]+$/i,z_=parseInt,Y_=function(e){if(typeof e=="number")return e;if(bn(e))return NaN;if(tr(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=tr(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(H_,"");var r=X_.test(e);return r||W_.test(e)?z_(e.slice(2),r?2:8):V_.test(e)?NaN:+e},Ta=function(e){return e?(e=Y_(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:e===0?e:0},K_=function(e){var t=Ta(e),r=t%1;return t==t?r?t-r:t:0},q_=Math.max,Q_=$_(function(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:K_(r);return a<0&&(a=q_(n+a,0)),Yd(e,$r(t),a)}),nh=function(e){return e!=null&&e.length?Os(e,1):[]},Z_=function(e,t){return e==null?e:Ss(e,wd(t),Tn)},J_=function(e){var t=e==null?0:e.length;return t?e[t-1]:void 0},e0=function(e,t){var r={};return t=$r(t),Rs(e,function(n,a,i){Ua(r,a,t(n,a,i))}),r},Cs=function(e,t,r){for(var n=-1,a=e.length;++n<a;){var i=e[n],o=t(i);if(o!=null&&(s===void 0?o==o&&!bn(o):r(o,s)))var s=o,f=i}return f},t0=function(e,t){return e>t},r0=function(e){return e&&e.length?Cs(e,wn,t0):void 0},fs=function(e,t,r){(r!==void 0&&!ri(e[t],r)||r===void 0&&!(t in e))&&Ua(e,t,r)},n0=Function.prototype,i0=Object.prototype,ih=n0.toString,a0=i0.hasOwnProperty,o0=ih.call(Object),s0=function(e){if(!_r(e)||Jr(e)!="[object Object]")return!1;var t=ja(e);if(t===null)return!0;var r=a0.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&ih.call(r)==o0},cs=function(e,t){if((t!=="constructor"||typeof e[t]!="function")&&t!="__proto__")return e[t]},u0=function(e){return Pi(e,Tn(e))},f0=function(e,t,r,n,a,i,o){var s=cs(e,r),f=cs(t,r),c=o.get(f);if(c)fs(e,r,c);else{var d=i?i(s,f,r+"",e,t,o):void 0,h=d===void 0;if(h){var y=St(f),C=!y&&En(f),L=!y&&!C&&ki(f);d=f,y||C||L?St(s)?d=s:Kd(s)?d=vd(s):C?(h=!1,d=pd(f,!0)):L?(h=!1,d=bd(f,!0)):d=[]:s0(f)||ei(f)?(d=s,ei(s)?d=u0(s):tr(s)&&!Mi(s)||(d=Ad(f))):h=!1}h&&(o.set(f,d),a(d,f,n,i,o),o.delete(f)),fs(e,r,d)}},c0=function e(t,r,n,a,i){t!==r&&Ss(r,function(o,s){if(i||(i=new qn),tr(o))f0(t,r,s,n,e,a,i);else{var f=a?a(cs(t,s),o,s+"",t,r,i):void 0;f===void 0&&(f=o),fs(t,s,f)}},Tn)},d0=function(e){return Xa(function(t,r){var n=-1,a=r.length,i=a>1?r[a-1]:void 0,o=a>2?r[2]:void 0;for(i=e.length>3&&typeof i=="function"?(a--,i):void 0,o&&Fi(r[0],r[1],o)&&(i=a<3?void 0:i,a=1),t=Object(t);++n<a;){var s=r[n];s&&e(t,s,n,i)}return t})}(function(e,t,r){c0(e,t,r)}),ah=function(e,t){return e<t},h0=function(e){return e&&e.length?Cs(e,wn,ah):void 0},l0=function(e,t){return e&&e.length?Cs(e,$r(t),ah):void 0},p0=function(){return br.Date.now()},v0=function(e,t,r,n){if(!tr(e))return e;for(var a=-1,i=(t=Ha(t,e)).length,o=i-1,s=e;s!=null&&++a<i;){var f=Bi(t[a]),c=r;if(f==="__proto__"||f==="constructor"||f==="prototype")return e;if(a!=o){var d=s[f];(c=n?n(d,f,s):void 0)===void 0&&(c=tr(d)?d:Pa(t[a+1])?[]:{})}Ma(s,f,c),s=s[f]}return e},y0=function(e,t,r){for(var n=-1,a=t.length,i={};++n<a;){var o=t[n],s=Va(e,o);r(s,o)&&v0(i,Ha(o,e),s)}return i},m0=function(e,t){return y0(e,t,function(r,n){return Fd(e,n)})},E0=function(e){return zd(Wd(e,void 0,nh),e+"")}(function(e,t){return e==null?{}:m0(e,t)}),_0=Math.ceil,b0=Math.max,g0=function(e,t,r,n){for(var a=-1,i=b0(_0((t-e)/(r||1)),0),o=Array(i);i--;)o[n?i:++a]=e,e+=r;return o},A0=function(e){return function(t,r,n){return n&&typeof n!="number"&&Fi(t,r,n)&&(r=n=void 0),t=Ta(t),r===void 0?(r=t,t=0):r=Ta(r),n=n===void 0?t<r?1:-1:Ta(n),g0(t,r,n,e)}}(),T0=function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e},w0=function(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e==e,i=bn(e),o=t!==void 0,s=t===null,f=t==t,c=bn(t);if(!s&&!c&&!i&&e>t||i&&o&&f&&!s&&!c||n&&o&&f||!r&&f||!a)return 1;if(!n&&!i&&!c&&e<t||c&&r&&a&&!n&&!i||s&&r&&a||!o&&a||!f)return-1}return 0},S0=function(e,t,r){for(var n=-1,a=e.criteria,i=t.criteria,o=a.length,s=r.length;++n<o;){var f=w0(a[n],i[n]);if(f)return n>=s?f:f*(r[n]=="desc"?-1:1)}return e.index-t.index},R0=function(e,t,r){t=t.length?Zn(t,function(i){return St(i)?function(o){return Va(o,i.length===1?i[0]:i)}:i}):[wn];var n=-1;t=Zn(t,ka($r));var a=Bd(e,function(i,o,s){return{criteria:Zn(t,function(f){return f(i)}),index:++n,value:i}});return T0(a,function(i,o){return S0(i,o,r)})},L0=Xa(function(e,t){if(e==null)return[];var r=t.length;return r>1&&Fi(e,t[0],t[1])?t=[]:r>2&&Fi(t[0],t[1],t[2])&&(t=[t[0]]),R0(e,Os(t,1),[])}),x0=0,N0=function(e){var t=++x0;return Dd(e)+t},O0=function(e,t,r){for(var n=-1,a=e.length,i=t.length,o={};++n<a;){var s=n<i?t[n]:void 0;r(o,e[n],s)}return o},Oa,I0=function(e,t){return O0(e||[],t||[],Ma)};try{Oa={cloneDeep:k_,constant:ws,defaults:j_,each:Rd,filter:Md,find:Q_,flatten:nh,forEach:Sd,forIn:Z_,has:Pd,isUndefined:kd,last:J_,map:jd,mapValues:e0,max:r0,merge:d0,min:h0,minBy:l0,now:p0,pick:E0,range:A0,reduce:$d,sortBy:L0,uniqueId:N0,values:qd,zipObject:I0}}catch{}Oa||(Oa=window._);var C0=Oa;Cr.Graph;C0.constant(1);Cr.Graph;Cr.Graph;Cr.alg.preorder;Cr.alg.postorder;Cr.Graph;Cr.Graph;Cr.Graph;Cr.Graph;Cr.Graph;const D0=800;class G0 extends ps{constructor(t){super(),this.maxIteration=1e3,this.workerEnabled=!1,this.gravity=10,this.speed=5,this.clustering=!1,this.clusterGravity=10,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.onLayoutEnd=()=>{},this.tick=()=>{},this.animate=!0,this.updateCfg(t)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10,animate:!0}}execute(){var t,r;const n=this,a=n.nodes;if(n.timeInterval!==void 0&&typeof window<"u"&&window.clearInterval(n.timeInterval),!a||a.length===0){(t=n.onLayoutEnd)===null||t===void 0||t.call(n);return}!n.width&&typeof window<"u"&&(n.width=window.innerWidth),!n.height&&typeof window<"u"&&(n.height=window.innerHeight),n.center||(n.center=[n.width/2,n.height/2]);const i=n.center;if(a.length===1){a[0].x=i[0],a[0].y=i[1],(r=n.onLayoutEnd)===null||r===void 0||r.call(n);return}const o={},s={};return a.forEach((f,c)=>{nt(f.x)||(f.x=Math.random()*this.width),nt(f.y)||(f.y=Math.random()*this.height),o[f.id]=f,s[f.id]=c}),n.nodeMap=o,n.nodeIdxMap=s,n.run()}run(){var t;const r=this,n=r.nodes;if(!n)return;const{edges:a,maxIteration:i,workerEnabled:o,clustering:s,animate:f}=r,c={};if(s&&n.forEach(d=>{c[d.cluster]===void 0&&(c[d.cluster]={name:d.cluster,cx:0,cy:0,count:0})}),o||!f){for(let d=0;d<i;d++)r.runOneStep(c);(t=r.onLayoutEnd)===null||t===void 0||t.call(r)}else{if(typeof window>"u")return;let d=0;this.timeInterval=window.setInterval(()=>{var h;r.runOneStep(c),d++,d>=i&&((h=r.onLayoutEnd)===null||h===void 0||h.call(r),window.clearInterval(r.timeInterval))},0)}return{nodes:n,edges:a}}runOneStep(t){var r;const n=this,a=n.nodes;if(!a)return;const{edges:i,center:o,gravity:s,speed:f,clustering:c}=n,d=n.height*n.width,h=Math.sqrt(d)/10,y=d/(a.length+1),C=Math.sqrt(y),L=[];if(a.forEach((k,U)=>{L[U]={x:0,y:0}}),n.applyCalculate(a,i,L,C,y),c){for(const U in t)t[U].cx=0,t[U].cy=0,t[U].count=0;a.forEach(U=>{const B=t[U.cluster];nt(U.x)&&(B.cx+=U.x),nt(U.y)&&(B.cy+=U.y),B.count++});for(const U in t)t[U].cx/=t[U].count,t[U].cy/=t[U].count;const k=n.clusterGravity||s;a.forEach((U,B)=>{if(!nt(U.x)||!nt(U.y))return;const q=t[U.cluster],se=Math.sqrt((U.x-q.cx)*(U.x-q.cx)+(U.y-q.cy)*(U.y-q.cy)),fe=C*k;L[B].x-=fe*(U.x-q.cx)/se,L[B].y-=fe*(U.y-q.cy)/se})}a.forEach((k,U)=>{if(!nt(k.x)||!nt(k.y))return;const B=.01*C*s;L[U].x-=B*(k.x-o[0]),L[U].y-=B*(k.y-o[1])}),a.forEach((k,U)=>{if(nt(k.fx)&&nt(k.fy)){k.x=k.fx,k.y=k.fy;return}if(!nt(k.x)||!nt(k.y))return;const B=Math.sqrt(L[U].x*L[U].x+L[U].y*L[U].y);if(B>0){const q=Math.min(h*(f/D0),B);k.x+=L[U].x/B*q,k.y+=L[U].y/B*q}}),(r=n.tick)===null||r===void 0||r.call(n)}applyCalculate(t,r,n,a,i){const o=this;o.calRepulsive(t,n,i),r&&o.calAttractive(r,n,a)}calRepulsive(t,r,n){t.forEach((a,i)=>{r[i]={x:0,y:0},t.forEach((o,s)=>{if(i===s||!nt(a.x)||!nt(o.x)||!nt(a.y)||!nt(o.y))return;let f=a.x-o.x,c=a.y-o.y,d=f*f+c*c;if(d===0){d=1;const y=i>s?1:-1;f=.01*y,c=.01*y}const h=n/d;r[i].x+=f*h,r[i].y+=c*h})})}calAttractive(t,r,n){t.forEach(a=>{const i=Or(a,"source"),o=Or(a,"target");if(!i||!o)return;const s=this.nodeIdxMap[i],f=this.nodeIdxMap[o];if(s===f)return;const c=this.nodeMap[i],d=this.nodeMap[o];if(!nt(d.x)||!nt(c.x)||!nt(d.y)||!nt(c.y))return;const h=d.x-c.x,y=d.y-c.y,C=Math.sqrt(h*h+y*y),L=C*C/n;r[f].x-=h/C*L,r[f].y-=y/C*L,r[s].x+=h/C*L,r[s].y+=y/C*L})}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval)}destroy(){const t=this;t.stop(),t.tick=null,t.nodes=null,t.edges=null,t.destroyed=!0}getType(){return"fruchterman"}}function Ui(e){return Ui=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ui(e)}function F0(e,t){if(Ui(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ui(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function U0(e){var t=F0(e,"string");return Ui(t)==="symbol"?t:String(t)}function ge(e,t,r){return t=U0(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var M0=typeof Oi=="object"&&Oi&&Oi.Object===Object&&Oi,oh=M0,P0=oh,k0=typeof self=="object"&&self&&self.Object===Object&&self,B0=P0||k0||Function("return this")(),j0=B0,$0=j0,H0=$0.Symbol,sh=H0,Bc=sh;Bc&&Bc.toStringTag;var jc=sh;jc&&jc.toStringTag;var ds={exports:{}};(function(e,t){var r=oh,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,o=i&&r.process,s=function(){try{var f=a&&a.require&&a.require("util").types;return f||o&&o.binding&&o.binding("util")}catch{}}();e.exports=s})(ds,ds.exports);var $c=ds.exports;$c&&$c.isTypedArray;var uh={exports:{}},fh={exports:{}};(function(e){function t(r){return e.exports=t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(fh);(function(e){var t=fh.exports.default;function r(){e.exports=r=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var n={},a=Object.prototype,i=a.hasOwnProperty,o=Object.defineProperty||function(we,he,Ee){we[he]=Ee.value},s=typeof Symbol=="function"?Symbol:{},f=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",d=s.toStringTag||"@@toStringTag";function h(we,he,Ee){return Object.defineProperty(we,he,{value:Ee,enumerable:!0,configurable:!0,writable:!0}),we[he]}try{h({},"")}catch{h=function(Ee,Fe,Me){return Ee[Fe]=Me}}function y(we,he,Ee,Fe){var Me=he&&he.prototype instanceof k?he:k,Pe=Object.create(Me.prototype),st=new Rt(Fe||[]);return o(Pe,"_invoke",{value:Ge(we,Ee,st)}),Pe}function C(we,he,Ee){try{return{type:"normal",arg:we.call(he,Ee)}}catch(Fe){return{type:"throw",arg:Fe}}}n.wrap=y;var L={};function k(){}function U(){}function B(){}var q={};h(q,f,function(){return this});var se=Object.getPrototypeOf,fe=se&&se(se(Pt([])));fe&&fe!==a&&i.call(fe,f)&&(q=fe);var de=B.prototype=k.prototype=Object.create(q);function Ze(we){["next","throw","return"].forEach(function(he){h(we,he,function(Ee){return this._invoke(he,Ee)})})}function Oe(we,he){function Ee(Me,Pe,st,ht){var Lt=C(we[Me],we,Pe);if(Lt.type!=="throw"){var Qt=Lt.arg,gr=Qt.value;return gr&&t(gr)=="object"&&i.call(gr,"__await")?he.resolve(gr.__await).then(function(Dr){Ee("next",Dr,st,ht)},function(Dr){Ee("throw",Dr,st,ht)}):he.resolve(gr).then(function(Dr){Qt.value=Dr,st(Qt)},function(Dr){return Ee("throw",Dr,st,ht)})}ht(Lt.arg)}var Fe;o(this,"_invoke",{value:function(Pe,st){function ht(){return new he(function(Lt,Qt){Ee(Pe,st,Lt,Qt)})}return Fe=Fe?Fe.then(ht,ht):ht()}})}function Ge(we,he,Ee){var Fe="suspendedStart";return function(Me,Pe){if(Fe==="executing")throw new Error("Generator is already running");if(Fe==="completed"){if(Me==="throw")throw Pe;return vt()}for(Ee.method=Me,Ee.arg=Pe;;){var st=Ee.delegate;if(st){var ht=K(st,Ee);if(ht){if(ht===L)continue;return ht}}if(Ee.method==="next")Ee.sent=Ee._sent=Ee.arg;else if(Ee.method==="throw"){if(Fe==="suspendedStart")throw Fe="completed",Ee.arg;Ee.dispatchException(Ee.arg)}else Ee.method==="return"&&Ee.abrupt("return",Ee.arg);Fe="executing";var Lt=C(we,he,Ee);if(Lt.type==="normal"){if(Fe=Ee.done?"completed":"suspendedYield",Lt.arg===L)continue;return{value:Lt.arg,done:Ee.done}}Lt.type==="throw"&&(Fe="completed",Ee.method="throw",Ee.arg=Lt.arg)}}}function K(we,he){var Ee=he.method,Fe=we.iterator[Ee];if(Fe===void 0)return he.delegate=null,Ee==="throw"&&we.iterator.return&&(he.method="return",he.arg=void 0,K(we,he),he.method==="throw")||Ee!=="return"&&(he.method="throw",he.arg=new TypeError("The iterator does not provide a '"+Ee+"' method")),L;var Me=C(Fe,we.iterator,he.arg);if(Me.type==="throw")return he.method="throw",he.arg=Me.arg,he.delegate=null,L;var Pe=Me.arg;return Pe?Pe.done?(he[we.resultName]=Pe.value,he.next=we.nextLoc,he.method!=="return"&&(he.method="next",he.arg=void 0),he.delegate=null,L):Pe:(he.method="throw",he.arg=new TypeError("iterator result is not an object"),he.delegate=null,L)}function Mt(we){var he={tryLoc:we[0]};1 in we&&(he.catchLoc=we[1]),2 in we&&(he.finallyLoc=we[2],he.afterLoc=we[3]),this.tryEntries.push(he)}function Dt(we){var he=we.completion||{};he.type="normal",delete he.arg,we.completion=he}function Rt(we){this.tryEntries=[{tryLoc:"root"}],we.forEach(Mt,this),this.reset(!0)}function Pt(we){if(we){var he=we[f];if(he)return he.call(we);if(typeof we.next=="function")return we;if(!isNaN(we.length)){var Ee=-1,Fe=function Me(){for(;++Ee<we.length;)if(i.call(we,Ee))return Me.value=we[Ee],Me.done=!1,Me;return Me.value=void 0,Me.done=!0,Me};return Fe.next=Fe}}return{next:vt}}function vt(){return{value:void 0,done:!0}}return U.prototype=B,o(de,"constructor",{value:B,configurable:!0}),o(B,"constructor",{value:U,configurable:!0}),U.displayName=h(B,d,"GeneratorFunction"),n.isGeneratorFunction=function(we){var he=typeof we=="function"&&we.constructor;return!!he&&(he===U||(he.displayName||he.name)==="GeneratorFunction")},n.mark=function(we){return Object.setPrototypeOf?Object.setPrototypeOf(we,B):(we.__proto__=B,h(we,d,"GeneratorFunction")),we.prototype=Object.create(de),we},n.awrap=function(we){return{__await:we}},Ze(Oe.prototype),h(Oe.prototype,c,function(){return this}),n.AsyncIterator=Oe,n.async=function(we,he,Ee,Fe,Me){Me===void 0&&(Me=Promise);var Pe=new Oe(y(we,he,Ee,Fe),Me);return n.isGeneratorFunction(he)?Pe:Pe.next().then(function(st){return st.done?st.value:Pe.next()})},Ze(de),h(de,d,"Generator"),h(de,f,function(){return this}),h(de,"toString",function(){return"[object Generator]"}),n.keys=function(we){var he=Object(we),Ee=[];for(var Fe in he)Ee.push(Fe);return Ee.reverse(),function Me(){for(;Ee.length;){var Pe=Ee.pop();if(Pe in he)return Me.value=Pe,Me.done=!1,Me}return Me.done=!0,Me}},n.values=Pt,Rt.prototype={constructor:Rt,reset:function(he){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Dt),!he)for(var Ee in this)Ee.charAt(0)==="t"&&i.call(this,Ee)&&!isNaN(+Ee.slice(1))&&(this[Ee]=void 0)},stop:function(){this.done=!0;var he=this.tryEntries[0].completion;if(he.type==="throw")throw he.arg;return this.rval},dispatchException:function(he){if(this.done)throw he;var Ee=this;function Fe(Qt,gr){return st.type="throw",st.arg=he,Ee.next=Qt,gr&&(Ee.method="next",Ee.arg=void 0),!!gr}for(var Me=this.tryEntries.length-1;Me>=0;--Me){var Pe=this.tryEntries[Me],st=Pe.completion;if(Pe.tryLoc==="root")return Fe("end");if(Pe.tryLoc<=this.prev){var ht=i.call(Pe,"catchLoc"),Lt=i.call(Pe,"finallyLoc");if(ht&&Lt){if(this.prev<Pe.catchLoc)return Fe(Pe.catchLoc,!0);if(this.prev<Pe.finallyLoc)return Fe(Pe.finallyLoc)}else if(ht){if(this.prev<Pe.catchLoc)return Fe(Pe.catchLoc,!0)}else{if(!Lt)throw new Error("try statement without catch or finally");if(this.prev<Pe.finallyLoc)return Fe(Pe.finallyLoc)}}}},abrupt:function(he,Ee){for(var Fe=this.tryEntries.length-1;Fe>=0;--Fe){var Me=this.tryEntries[Fe];if(Me.tryLoc<=this.prev&&i.call(Me,"finallyLoc")&&this.prev<Me.finallyLoc){var Pe=Me;break}}Pe&&(he==="break"||he==="continue")&&Pe.tryLoc<=Ee&&Ee<=Pe.finallyLoc&&(Pe=null);var st=Pe?Pe.completion:{};return st.type=he,st.arg=Ee,Pe?(this.method="next",this.next=Pe.finallyLoc,L):this.complete(st)},complete:function(he,Ee){if(he.type==="throw")throw he.arg;return he.type==="break"||he.type==="continue"?this.next=he.arg:he.type==="return"?(this.rval=this.arg=he.arg,this.method="return",this.next="end"):he.type==="normal"&&Ee&&(this.next=Ee),L},finish:function(he){for(var Ee=this.tryEntries.length-1;Ee>=0;--Ee){var Fe=this.tryEntries[Ee];if(Fe.finallyLoc===he)return this.complete(Fe.completion,Fe.afterLoc),Dt(Fe),L}},catch:function(he){for(var Ee=this.tryEntries.length-1;Ee>=0;--Ee){var Fe=this.tryEntries[Ee];if(Fe.tryLoc===he){var Me=Fe.completion;if(Me.type==="throw"){var Pe=Me.arg;Dt(Fe)}return Pe}}throw new Error("illegal catch attempt")},delegateYield:function(he,Ee,Fe){return this.delegate={iterator:Pt(he),resultName:Ee,nextLoc:Fe},this.method==="next"&&(this.arg=void 0),L}},n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(uh);var Zo=uh.exports();try{regeneratorRuntime=Zo}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=Zo:Function("r","regeneratorRuntime = r")(Zo)}var _e;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.COPY_SRC=1]="COPY_SRC",e[e.COPY_DST=2]="COPY_DST",e[e.SAMPLED=4]="SAMPLED",e[e.STORAGE=8]="STORAGE",e[e.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(_e||(_e={}));typeof navigator<"u"&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent);var Hc;(function(e){e.Void="Void",e.Boolean="Boolean",e.Float="Float",e.Uint32="Uint32",e.Int32="Int32",e.Vector="Vector",e.Vector2Float="vec2<f32>",e.Vector3Float="vec3<f32>",e.Vector4Float="vec4<f32>",e.Vector2Boolean="vec2<bool>",e.Vector3Boolean="vec3<bool>",e.Vector4Boolean="vec4<bool>",e.Vector2Uint="vec2<u32>",e.Vector3Uint="vec3<u32>",e.Vector4Uint="vec4<u32>",e.Vector2Int="vec2<i32>",e.Vector3Int="vec3<i32>",e.Vector4Int="vec4<i32>",e.Matrix="Matrix",e.Matrix3x3Float="mat3x3<f32>",e.Matrix4x4Float="mat4x4<i32>",e.Struct="Struct",e.FloatArray="Float[]",e.Vector4FloatArray="vec4<f32>[]"})(Hc||(Hc={}));var Vc;(function(e){e.Program="Program",e.Identifier="Identifier",e.VariableDeclaration="VariableDeclaration",e.BlockStatement="BlockStatement",e.ReturnStatement="ReturnStatement",e.FunctionDeclaration="FunctionDeclaration",e.VariableDeclarator="VariableDeclarator",e.AssignmentExpression="AssignmentExpression",e.LogicalExpression="LogicalExpression",e.BinaryExpression="BinaryExpression",e.ArrayExpression="ArrayExpression",e.UnaryExpression="UnaryExpression",e.UpdateExpression="UpdateExpression",e.FunctionExpression="FunctionExpression",e.MemberExpression="MemberExpression",e.ConditionalExpression="ConditionalExpression",e.ExpressionStatement="ExpressionStatement",e.CallExpression="CallExpression",e.NumThreadStatement="NumThreadStatement",e.StorageStatement="StorageStatement",e.DoWhileStatement="DoWhileStatement",e.WhileStatement="WhileStatement",e.ForStatement="ForStatement",e.BreakStatement="BreakStatement",e.ContinueStatement="ContinueStatement",e.IfStatement="IfStatement",e.ImportedFunctionStatement="ImportedFunctionStatement"})(Vc||(Vc={}));var Xc;(function(e){e.Input="Input",e.Output="Output",e.Uniform="Uniform",e.Workgroup="Workgroup",e.UniformConstant="UniformConstant",e.Image="Image",e.StorageBuffer="StorageBuffer",e.Private="Private",e.Function="Function"})(Xc||(Xc={}));var Wc;(function(e){e.GLSL100="GLSL100",e.GLSL450="GLSL450",e.WGSL="WGSL"})(Wc||(Wc={}));var V0={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Oi,function(){var r=function(u){return u instanceof Uint8Array||u instanceof Uint16Array||u instanceof Uint32Array||u instanceof Int8Array||u instanceof Int16Array||u instanceof Int32Array||u instanceof Float32Array||u instanceof Float64Array||u instanceof Uint8ClampedArray},n=function(u,p){for(var g=Object.keys(p),M=0;M<g.length;++M)u[g[M]]=p[g[M]];return u},a=`
`;function i(u){return typeof atob<"u"?atob(u):"base64:"+u}function o(u){var p=new Error("(regl) "+u);throw console.error(p),p}function s(u,p){u||o(p)}function f(u){return u?": "+u:""}function c(u,p,g){u in p||o("unknown parameter ("+u+")"+f(g)+". possible values: "+Object.keys(p).join())}function d(u,p){r(u)||o("invalid parameter type"+f(p)+". must be a typed array")}function h(u,p){switch(p){case"number":return typeof u=="number";case"object":return typeof u=="object";case"string":return typeof u=="string";case"boolean":return typeof u=="boolean";case"function":return typeof u=="function";case"undefined":return typeof u>"u";case"symbol":return typeof u=="symbol"}}function y(u,p,g){h(u,p)||o("invalid parameter type"+f(g)+". expected "+p+", got "+typeof u)}function C(u,p){u>=0&&(u|0)===u||o("invalid parameter type, ("+u+")"+f(p)+". must be a nonnegative integer")}function L(u,p,g){p.indexOf(u)<0&&o("invalid value"+f(g)+". must be one of: "+p)}var k=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function U(u){Object.keys(u).forEach(function(p){k.indexOf(p)<0&&o('invalid regl constructor argument "'+p+'". must be one of '+k)})}function B(u,p){for(u=u+"";u.length<p;)u=" "+u;return u}function q(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function se(u,p){this.number=u,this.line=p,this.errors=[]}function fe(u,p,g){this.file=u,this.line=p,this.message=g}function de(){var u=new Error,p=(u.stack||u).toString(),g=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(p);if(g)return g[1];var M=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(p);return M?M[1]:"unknown"}function Ze(){var u=new Error,p=(u.stack||u).toString(),g=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(p);if(g)return g[1];var M=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(p);return M?M[1]:"unknown"}function Oe(u,p){var g=u.split(`
`),M=1,X=0,F={unknown:new q,0:new q};F.unknown.name=F[0].name=p||de(),F.unknown.lines.push(new se(0,""));for(var j=0;j<g.length;++j){var J=g[j],te=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(J);if(te)switch(te[1]){case"line":var ae=/(\d+)(\s+\d+)?/.exec(te[2]);ae&&(M=ae[1]|0,ae[2]&&(X=ae[2]|0,X in F||(F[X]=new q)));break;case"define":var re=/SHADER_NAME(_B64)?\s+(.*)$/.exec(te[2]);re&&(F[X].name=re[1]?i(re[2]):re[2]);break}F[X].lines.push(new se(M++,J))}return Object.keys(F).forEach(function(ue){var ve=F[ue];ve.lines.forEach(function(ee){ve.index[ee.number]=ee})}),F}function Ge(u){var p=[];return u.split(`
`).forEach(function(g){if(!(g.length<5)){var M=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(g);M?p.push(new fe(M[1]|0,M[2]|0,M[3].trim())):g.length>0&&p.push(new fe("unknown",0,g))}}),p}function K(u,p){p.forEach(function(g){var M=u[g.file];if(M){var X=M.index[g.line];if(X){X.errors.push(g),M.hasErrors=!0;return}}u.unknown.hasErrors=!0,u.unknown.lines[0].errors.push(g)})}function Mt(u,p,g,M,X){if(!u.getShaderParameter(p,u.COMPILE_STATUS)){var F=u.getShaderInfoLog(p),j=M===u.FRAGMENT_SHADER?"fragment":"vertex";Ee(g,"string",j+" shader source must be a string",X);var J=Oe(g,X),te=Ge(F);K(J,te),Object.keys(J).forEach(function(ae){var re=J[ae];if(!re.hasErrors)return;var ue=[""],ve=[""];function ee(ce,O){ue.push(ce),ve.push(O||"")}ee("file number "+ae+": "+re.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),re.lines.forEach(function(ce){if(ce.errors.length>0){ee(B(ce.number,4)+"|  ","background-color:yellow; font-weight:bold"),ee(ce.line+a,"color:red; background-color:yellow; font-weight:bold");var O=0;ce.errors.forEach(function($){var ie=$.message,me=/^\s*'(.*)'\s*:\s*(.*)$/.exec(ie);if(me){var Y=me[1];switch(ie=me[2],Y){case"assign":Y="=";break}O=Math.max(ce.line.indexOf(Y,O),0)}else O=0;ee(B("| ",6)),ee(B("^^^",O+3)+a,"font-weight:bold"),ee(B("| ",6)),ee(ie+a,"font-weight:bold")}),ee(B("| ",6)+a)}else ee(B(ce.number,4)+"|  "),ee(ce.line+a,"color:red")}),typeof document<"u"&&!window.chrome?(ve[0]=ue.join("%c"),console.log.apply(console,ve)):console.log(ue.join(""))}),s.raise("Error compiling "+j+" shader, "+J[0].name)}}function Dt(u,p,g,M,X){if(!u.getProgramParameter(p,u.LINK_STATUS)){var F=u.getProgramInfoLog(p),j=Oe(g,X),J=Oe(M,X),te='Error linking program with vertex shader, "'+J[0].name+'", and fragment shader "'+j[0].name+'"';typeof document<"u"?console.log("%c"+te+a+"%c"+F,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(te+a+F),s.raise(te)}}function Rt(u){u._commandRef=de()}function Pt(u,p,g,M){Rt(u);function X(te){return te?M.id(te):0}u._fragId=X(u.static.frag),u._vertId=X(u.static.vert);function F(te,ae){Object.keys(ae).forEach(function(re){te[M.id(re)]=!0})}var j=u._uniformSet={};F(j,p.static),F(j,p.dynamic);var J=u._attributeSet={};F(J,g.static),F(J,g.dynamic),u._hasCount="count"in u.static||"count"in u.dynamic||"elements"in u.static||"elements"in u.dynamic}function vt(u,p){var g=Ze();o(u+" in command "+(p||de())+(g==="unknown"?"":" called from "+g))}function we(u,p,g){u||vt(p,g||de())}function he(u,p,g,M){u in p||vt("unknown parameter ("+u+")"+f(g)+". possible values: "+Object.keys(p).join(),M||de())}function Ee(u,p,g,M){h(u,p)||vt("invalid parameter type"+f(g)+". expected "+p+", got "+typeof u,M||de())}function Fe(u){u()}function Me(u,p,g){u.texture?L(u.texture._texture.internalformat,p,"unsupported texture format for attachment"):L(u.renderbuffer._renderbuffer.format,g,"unsupported renderbuffer format for attachment")}var Pe=33071,st=9728,ht=9984,Lt=9985,Qt=9986,gr=9987,Dr=5120,Bh=5121,jh=5122,$h=5123,Hh=5124,Vh=5125,Xs=5126,Ws=32819,zs=32820,Ys=33635,Ks=34042,Xh=36193,nr={};nr[Dr]=nr[Bh]=1,nr[jh]=nr[$h]=nr[Xh]=nr[Ys]=nr[Ws]=nr[zs]=2,nr[Hh]=nr[Vh]=nr[Xs]=nr[Ks]=4;function qs(u,p){return u===zs||u===Ws||u===Ys?2:u===Ks?4:nr[u]*p}function ji(u){return!(u&u-1)&&!!u}function Wh(u,p,g){var M,X=p.width,F=p.height,j=p.channels;s(X>0&&X<=g.maxTextureSize&&F>0&&F<=g.maxTextureSize,"invalid texture shape"),(u.wrapS!==Pe||u.wrapT!==Pe)&&s(ji(X)&&ji(F),"incompatible wrap mode for texture, both width and height must be power of 2"),p.mipmask===1?X!==1&&F!==1&&s(u.minFilter!==ht&&u.minFilter!==Qt&&u.minFilter!==Lt&&u.minFilter!==gr,"min filter requires mipmap"):(s(ji(X)&&ji(F),"texture must be a square power of 2 to support mipmapping"),s(p.mipmask===(X<<1)-1,"missing or incomplete mipmap data")),p.type===Xs&&(g.extensions.indexOf("oes_texture_float_linear")<0&&s(u.minFilter===st&&u.magFilter===st,"filter not supported, must enable oes_texture_float_linear"),s(!u.genMipmaps,"mipmap generation not supported with float textures"));var J=p.images;for(M=0;M<16;++M)if(J[M]){var te=X>>M,ae=F>>M;s(p.mipmask&1<<M,"missing mipmap data");var re=J[M];if(s(re.width===te&&re.height===ae,"invalid shape for mip images"),s(re.format===p.format&&re.internalformat===p.internalformat&&re.type===p.type,"incompatible type for mip image"),!re.compressed)if(re.data){var ue=Math.ceil(qs(re.type,j)*te/re.unpackAlignment)*re.unpackAlignment;s(re.data.byteLength===ue*ae,"invalid data for image, buffer size is inconsistent with image format")}else re.element||re.copy}else u.genMipmaps||s((p.mipmask&1<<M)===0,"extra mipmap data");p.compressed&&s(!u.genMipmaps,"mipmap generation for compressed images not supported")}function zh(u,p,g,M){var X=u.width,F=u.height,j=u.channels;s(X>0&&X<=M.maxTextureSize&&F>0&&F<=M.maxTextureSize,"invalid texture shape"),s(X===F,"cube map must be square"),s(p.wrapS===Pe&&p.wrapT===Pe,"wrap mode not supported by cube map");for(var J=0;J<g.length;++J){var te=g[J];s(te.width===X&&te.height===F,"inconsistent cube map face shape"),p.genMipmaps&&(s(!te.compressed,"can not generate mipmap for compressed textures"),s(te.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var ae=te.images,re=0;re<16;++re){var ue=ae[re];if(ue){var ve=X>>re,ee=F>>re;s(te.mipmask&1<<re,"missing mipmap data"),s(ue.width===ve&&ue.height===ee,"invalid shape for mip images"),s(ue.format===u.format&&ue.internalformat===u.internalformat&&ue.type===u.type,"incompatible type for mip image"),ue.compressed||(ue.data?s(ue.data.byteLength===ve*ee*Math.max(qs(ue.type,j),ue.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):ue.element||ue.copy)}}}}var _=n(s,{optional:Fe,raise:o,commandRaise:vt,command:we,parameter:c,commandParameter:he,constructor:U,type:y,commandType:Ee,isTypedArray:d,nni:C,oneOf:L,shaderError:Mt,linkError:Dt,callSite:Ze,saveCommandRef:Rt,saveDrawInfo:Pt,framebufferFormat:Me,guessCommand:de,texture2D:Wh,textureCube:zh}),Yh=0,Kh=0,qh=5,Qh=6;function rn(u,p){this.id=Yh++,this.type=u,this.data=p}function Qs(u){return u.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function ai(u){if(u.length===0)return[];var p=u.charAt(0),g=u.charAt(u.length-1);if(u.length>1&&p===g&&(p==='"'||p==="'"))return['"'+Qs(u.substr(1,u.length-2))+'"'];var M=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(u);if(M)return ai(u.substr(0,M.index)).concat(ai(M[1])).concat(ai(u.substr(M.index+M[0].length)));var X=u.split(".");if(X.length===1)return['"'+Qs(u)+'"'];for(var F=[],j=0;j<X.length;++j)F=F.concat(ai(X[j]));return F}function Zs(u){return"["+ai(u).join("][")+"]"}function Zh(u,p){return new rn(u,Zs(p+""))}function Jh(u){return typeof u=="function"&&!u._reglType||u instanceof rn}function Js(u,p){if(typeof u=="function")return new rn(Kh,u);if(typeof u=="number"||typeof u=="boolean")return new rn(qh,u);if(Array.isArray(u))return new rn(Qh,u.map((g,M)=>Js(g,p+"["+M+"]")));if(u instanceof rn)return u;_(!1,"invalid option type in uniform "+p)}var ir={DynamicVariable:rn,define:Zh,isDynamic:Jh,unbox:Js,accessor:Zs},Ya={next:typeof requestAnimationFrame=="function"?function(u){return requestAnimationFrame(u)}:function(u){return setTimeout(u,16)},cancel:typeof cancelAnimationFrame=="function"?function(u){return cancelAnimationFrame(u)}:clearTimeout},eu=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function el(){var u={"":0},p=[""];return{id:function(g){var M=u[g];return M||(M=u[g]=p.length,p.push(g),M)},str:function(g){return p[g]}}}function tl(u,p,g){var M=document.createElement("canvas");n(M.style,{border:0,margin:0,padding:0,top:0,left:0}),u.appendChild(M),u===document.body&&(M.style.position="absolute",n(u.style,{margin:0,padding:0}));function X(){var J=window.innerWidth,te=window.innerHeight;if(u!==document.body){var ae=u.getBoundingClientRect();J=ae.right-ae.left,te=ae.bottom-ae.top}M.width=g*J,M.height=g*te,n(M.style,{width:J+"px",height:te+"px"})}var F;u!==document.body&&typeof ResizeObserver=="function"?(F=new ResizeObserver(function(){setTimeout(X)}),F.observe(u)):window.addEventListener("resize",X,!1);function j(){F?F.disconnect():window.removeEventListener("resize",X),u.removeChild(M)}return X(),{canvas:M,onDestroy:j}}function rl(u,p){function g(M){try{return u.getContext(M,p)}catch{return null}}return g("webgl")||g("experimental-webgl")||g("webgl-experimental")}function nl(u){return typeof u.nodeName=="string"&&typeof u.appendChild=="function"&&typeof u.getBoundingClientRect=="function"}function il(u){return typeof u.drawArrays=="function"||typeof u.drawElements=="function"}function tu(u){return typeof u=="string"?u.split():(_(Array.isArray(u),"invalid extension array"),u)}function ru(u){return typeof u=="string"?(_(typeof document<"u","not supported outside of DOM"),document.querySelector(u)):u}function al(u){var p=u||{},g,M,X,F,j={},J=[],te=[],ae=typeof window>"u"?1:window.devicePixelRatio,re=!1,ue=function(ce){ce&&_.raise(ce)},ve=function(){};if(typeof p=="string"?(_(typeof document<"u","selector queries only supported in DOM enviroments"),g=document.querySelector(p),_(g,"invalid query string for element")):typeof p=="object"?nl(p)?g=p:il(p)?(F=p,X=F.canvas):(_.constructor(p),"gl"in p?F=p.gl:"canvas"in p?X=ru(p.canvas):"container"in p&&(M=ru(p.container)),"attributes"in p&&(j=p.attributes,_.type(j,"object","invalid context attributes")),"extensions"in p&&(J=tu(p.extensions)),"optionalExtensions"in p&&(te=tu(p.optionalExtensions)),"onDone"in p&&(_.type(p.onDone,"function","invalid or missing onDone callback"),ue=p.onDone),"profile"in p&&(re=!!p.profile),"pixelRatio"in p&&(ae=+p.pixelRatio,_(ae>0,"invalid pixel ratio"))):_.raise("invalid arguments to regl"),g&&(g.nodeName.toLowerCase()==="canvas"?X=g:M=g),!F){if(!X){_(typeof document<"u","must manually specify webgl context outside of DOM environments");var ee=tl(M||document.body,ue,ae);if(!ee)return null;X=ee.canvas,ve=ee.onDestroy}j.premultipliedAlpha===void 0&&(j.premultipliedAlpha=!0),F=rl(X,j)}return F?{gl:F,canvas:X,container:M,extensions:J,optionalExtensions:te,pixelRatio:ae,profile:re,onDone:ue,onDestroy:ve}:(ve(),ue("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function ol(u,p){var g={};function M(j){_.type(j,"string","extension name must be string");var J=j.toLowerCase(),te;try{te=g[J]=u.getExtension(J)}catch{}return!!te}for(var X=0;X<p.extensions.length;++X){var F=p.extensions[X];if(!M(F))return p.onDestroy(),p.onDone('"'+F+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return p.optionalExtensions.forEach(M),{extensions:g,restore:function(){Object.keys(g).forEach(function(j){if(g[j]&&!M(j))throw new Error("(regl): error restoring extension "+j)})}}}function Zt(u,p){for(var g=Array(u),M=0;M<u;++M)g[M]=p(M);return g}var sl=5120,ul=5121,fl=5122,cl=5123,dl=5124,hl=5125,ll=5126;function pl(u){for(var p=16;p<=1<<28;p*=16)if(u<=p)return p;return 0}function nu(u){var p,g;return p=(u>65535)<<4,u>>>=p,g=(u>255)<<3,u>>>=g,p|=g,g=(u>15)<<2,u>>>=g,p|=g,g=(u>3)<<1,u>>>=g,p|=g,p|u>>1}function iu(){var u=Zt(8,function(){return[]});function p(F){var j=pl(F),J=u[nu(j)>>2];return J.length>0?J.pop():new ArrayBuffer(j)}function g(F){u[nu(F.byteLength)>>2].push(F)}function M(F,j){var J=null;switch(F){case sl:J=new Int8Array(p(j),0,j);break;case ul:J=new Uint8Array(p(j),0,j);break;case fl:J=new Int16Array(p(2*j),0,j);break;case cl:J=new Uint16Array(p(2*j),0,j);break;case dl:J=new Int32Array(p(4*j),0,j);break;case hl:J=new Uint32Array(p(4*j),0,j);break;case ll:J=new Float32Array(p(4*j),0,j);break;default:return null}return J.length!==j?J.subarray(0,j):J}function X(F){g(F.buffer)}return{alloc:p,free:g,allocType:M,freeType:X}}var bt=iu();bt.zero=iu();var vl=3408,yl=3410,ml=3411,El=3412,_l=3413,bl=3414,gl=3415,Al=33901,Tl=33902,wl=3379,Sl=3386,Rl=34921,Ll=36347,xl=36348,Nl=35661,Ol=35660,Il=34930,Cl=36349,Dl=34076,Gl=34024,Fl=7936,Ul=7937,Ml=7938,Pl=35724,kl=34047,Bl=36063,jl=34852,$i=3553,au=34067,$l=34069,Hl=33984,oi=6408,Ka=5126,ou=5121,qa=36160,Vl=36053,Xl=36064,Wl=16384,zl=function(u,p){var g=1;p.ext_texture_filter_anisotropic&&(g=u.getParameter(kl));var M=1,X=1;p.webgl_draw_buffers&&(M=u.getParameter(jl),X=u.getParameter(Bl));var F=!!p.oes_texture_float;if(F){var j=u.createTexture();u.bindTexture($i,j),u.texImage2D($i,0,oi,1,1,0,oi,Ka,null);var J=u.createFramebuffer();if(u.bindFramebuffer(qa,J),u.framebufferTexture2D(qa,Xl,$i,j,0),u.bindTexture($i,null),u.checkFramebufferStatus(qa)!==Vl)F=!1;else{u.viewport(0,0,1,1),u.clearColor(1,0,0,1),u.clear(Wl);var te=bt.allocType(Ka,4);u.readPixels(0,0,1,1,oi,Ka,te),u.getError()?F=!1:(u.deleteFramebuffer(J),u.deleteTexture(j),F=te[0]===1),bt.freeType(te)}}var ae=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),re=!0;if(!ae){var ue=u.createTexture(),ve=bt.allocType(ou,36);u.activeTexture(Hl),u.bindTexture(au,ue),u.texImage2D($l,0,oi,3,3,0,oi,ou,ve),bt.freeType(ve),u.bindTexture(au,null),u.deleteTexture(ue),re=!u.getError()}return{colorBits:[u.getParameter(yl),u.getParameter(ml),u.getParameter(El),u.getParameter(_l)],depthBits:u.getParameter(bl),stencilBits:u.getParameter(gl),subpixelBits:u.getParameter(vl),extensions:Object.keys(p).filter(function(ee){return!!p[ee]}),maxAnisotropic:g,maxDrawbuffers:M,maxColorAttachments:X,pointSizeDims:u.getParameter(Al),lineWidthDims:u.getParameter(Tl),maxViewportDims:u.getParameter(Sl),maxCombinedTextureUnits:u.getParameter(Nl),maxCubeMapSize:u.getParameter(Dl),maxRenderbufferSize:u.getParameter(Gl),maxTextureUnits:u.getParameter(Il),maxTextureSize:u.getParameter(wl),maxAttributes:u.getParameter(Rl),maxVertexUniforms:u.getParameter(Ll),maxVertexTextureUnits:u.getParameter(Ol),maxVaryingVectors:u.getParameter(xl),maxFragmentUniforms:u.getParameter(Cl),glsl:u.getParameter(Pl),renderer:u.getParameter(Ul),vendor:u.getParameter(Fl),version:u.getParameter(Ml),readFloat:F,npotTextureCube:re}};function pr(u){return!!u&&typeof u=="object"&&Array.isArray(u.shape)&&Array.isArray(u.stride)&&typeof u.offset=="number"&&u.shape.length===u.stride.length&&(Array.isArray(u.data)||r(u.data))}var ar=function(u){return Object.keys(u).map(function(p){return u[p]})},Hi={shape:Ql,flatten:ql};function Yl(u,p,g){for(var M=0;M<p;++M)g[M]=u[M]}function Kl(u,p,g,M){for(var X=0,F=0;F<p;++F)for(var j=u[F],J=0;J<g;++J)M[X++]=j[J]}function su(u,p,g,M,X,F){for(var j=F,J=0;J<p;++J)for(var te=u[J],ae=0;ae<g;++ae)for(var re=te[ae],ue=0;ue<M;++ue)X[j++]=re[ue]}function uu(u,p,g,M,X){for(var F=1,j=g+1;j<p.length;++j)F*=p[j];var J=p[g];if(p.length-g===4){var te=p[g+1],ae=p[g+2],re=p[g+3];for(j=0;j<J;++j)su(u[j],te,ae,re,M,X),X+=F}else for(j=0;j<J;++j)uu(u[j],p,g+1,M,X),X+=F}function ql(u,p,g,M){var X=1;if(p.length)for(var F=0;F<p.length;++F)X*=p[F];else X=0;var j=M||bt.allocType(g,X);switch(p.length){case 0:break;case 1:Yl(u,p[0],j);break;case 2:Kl(u,p[0],p[1],j);break;case 3:su(u,p[0],p[1],p[2],j,0);break;default:uu(u,p,0,j,0)}return j}function Ql(u){for(var p=[],g=u;g.length;g=g[0])p.push(g.length);return p}var Qa={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Zl=5120,Jl=5122,ep=5124,tp=5121,rp=5123,np=5125,ip=5126,ap=5126,nn={int8:Zl,int16:Jl,int32:ep,uint8:tp,uint16:rp,uint32:np,float:ip,float32:ap},op=35048,sp=35040,Vi={dynamic:op,stream:sp,static:35044},Za=Hi.flatten,fu=Hi.shape,cu=35044,up=35040,Ja=5121,eo=5126,Xr=[];Xr[5120]=1,Xr[5122]=2,Xr[5124]=4,Xr[5121]=1,Xr[5123]=2,Xr[5125]=4,Xr[5126]=4;function Xi(u){return Qa[Object.prototype.toString.call(u)]|0}function du(u,p){for(var g=0;g<p.length;++g)u[g]=p[g]}function hu(u,p,g,M,X,F,j){for(var J=0,te=0;te<g;++te)for(var ae=0;ae<M;++ae)u[J++]=p[X*te+F*ae+j]}function fp(u,p,g,M){var X=0,F={};function j(O){this.id=X++,this.buffer=u.createBuffer(),this.type=O,this.usage=cu,this.byteLength=0,this.dimension=1,this.dtype=Ja,this.persistentData=null,g.profile&&(this.stats={size:0})}j.prototype.bind=function(){u.bindBuffer(this.type,this.buffer)},j.prototype.destroy=function(){ve(this)};var J=[];function te(O,$){var ie=J.pop();return ie||(ie=new j(O)),ie.bind(),ue(ie,$,up,0,1,!1),ie}function ae(O){J.push(O)}function re(O,$,ie){O.byteLength=$.byteLength,u.bufferData(O.type,$,ie)}function ue(O,$,ie,me,Y,be){var Z;if(O.usage=ie,Array.isArray($)){if(O.dtype=me||eo,$.length>0){var le;if(Array.isArray($[0])){Z=fu($);for(var Q=1,pe=1;pe<Z.length;++pe)Q*=Z[pe];O.dimension=Q,le=Za($,Z,O.dtype),re(O,le,ie),be?O.persistentData=le:bt.freeType(le)}else if(typeof $[0]=="number"){O.dimension=Y;var Ie=bt.allocType(O.dtype,$.length);du(Ie,$),re(O,Ie,ie),be?O.persistentData=Ie:bt.freeType(Ie)}else r($[0])?(O.dimension=$[0].length,O.dtype=me||Xi($[0])||eo,le=Za($,[$.length,$[0].length],O.dtype),re(O,le,ie),be?O.persistentData=le:bt.freeType(le)):_.raise("invalid buffer data")}}else if(r($))O.dtype=me||Xi($),O.dimension=Y,re(O,$,ie),be&&(O.persistentData=new Uint8Array(new Uint8Array($.buffer)));else if(pr($)){Z=$.shape;var ke=$.stride,ye=$.offset,oe=0,z=0,Ue=0,He=0;Z.length===1?(oe=Z[0],z=1,Ue=ke[0],He=0):Z.length===2?(oe=Z[0],z=Z[1],Ue=ke[0],He=ke[1]):_.raise("invalid shape"),O.dtype=me||Xi($.data)||eo,O.dimension=z;var Se=bt.allocType(O.dtype,oe*z);hu(Se,$.data,oe,z,Ue,He,ye),re(O,Se,ie),be?O.persistentData=Se:bt.freeType(Se)}else $ instanceof ArrayBuffer?(O.dtype=Ja,O.dimension=Y,re(O,$,ie),be&&(O.persistentData=new Uint8Array(new Uint8Array($)))):_.raise("invalid buffer data")}function ve(O){p.bufferCount--,M(O);var $=O.buffer;_($,"buffer must not be deleted already"),u.deleteBuffer($),O.buffer=null,delete F[O.id]}function ee(O,$,ie,me){p.bufferCount++;var Y=new j($);F[Y.id]=Y;function be(Q){var pe=cu,Ie=null,ke=0,ye=0,oe=1;return Array.isArray(Q)||r(Q)||pr(Q)||Q instanceof ArrayBuffer?Ie=Q:typeof Q=="number"?ke=Q|0:Q&&(_.type(Q,"object","buffer arguments must be an object, a number or an array"),"data"in Q&&(_(Ie===null||Array.isArray(Ie)||r(Ie)||pr(Ie),"invalid data for buffer"),Ie=Q.data),"usage"in Q&&(_.parameter(Q.usage,Vi,"invalid buffer usage"),pe=Vi[Q.usage]),"type"in Q&&(_.parameter(Q.type,nn,"invalid buffer type"),ye=nn[Q.type]),"dimension"in Q&&(_.type(Q.dimension,"number","invalid dimension"),oe=Q.dimension|0),"length"in Q&&(_.nni(ke,"buffer length must be a nonnegative integer"),ke=Q.length|0)),Y.bind(),Ie?ue(Y,Ie,pe,ye,oe,me):(ke&&u.bufferData(Y.type,ke,pe),Y.dtype=ye||Ja,Y.usage=pe,Y.dimension=oe,Y.byteLength=ke),g.profile&&(Y.stats.size=Y.byteLength*Xr[Y.dtype]),be}function Z(Q,pe){_(pe+Q.byteLength<=Y.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Q.byteLength+" starting from offset "+pe+" to a buffer of size "+Y.byteLength),u.bufferSubData(Y.type,pe,Q)}function le(Q,pe){var Ie=(pe||0)|0,ke;if(Y.bind(),r(Q)||Q instanceof ArrayBuffer)Z(Q,Ie);else if(Array.isArray(Q)){if(Q.length>0)if(typeof Q[0]=="number"){var ye=bt.allocType(Y.dtype,Q.length);du(ye,Q),Z(ye,Ie),bt.freeType(ye)}else if(Array.isArray(Q[0])||r(Q[0])){ke=fu(Q);var oe=Za(Q,ke,Y.dtype);Z(oe,Ie),bt.freeType(oe)}else _.raise("invalid buffer data")}else if(pr(Q)){ke=Q.shape;var z=Q.stride,Ue=0,He=0,Se=0,ze=0;ke.length===1?(Ue=ke[0],He=1,Se=z[0],ze=0):ke.length===2?(Ue=ke[0],He=ke[1],Se=z[0],ze=z[1]):_.raise("invalid shape");var Be=Array.isArray(Q.data)?Y.dtype:Xi(Q.data),We=bt.allocType(Be,Ue*He);hu(We,Q.data,Ue,He,Se,ze,Q.offset),Z(We,Ie),bt.freeType(We)}else _.raise("invalid data for buffer subdata");return be}return ie||be(O),be._reglType="buffer",be._buffer=Y,be.subdata=le,g.profile&&(be.stats=Y.stats),be.destroy=function(){ve(Y)},be}function ce(){ar(F).forEach(function(O){O.buffer=u.createBuffer(),u.bindBuffer(O.type,O.buffer),u.bufferData(O.type,O.persistentData||O.byteLength,O.usage)})}return g.profile&&(p.getTotalBufferSize=function(){var O=0;return Object.keys(F).forEach(function($){O+=F[$].stats.size}),O}),{create:ee,createStream:te,destroyStream:ae,clear:function(){ar(F).forEach(ve),J.forEach(ve)},getBuffer:function(O){return O&&O._buffer instanceof j?O._buffer:null},restore:ce,_initBuffer:ue}}var cp=0,dp=0,hp=1,lp=1,pp=4,vp=4,Sn={points:cp,point:dp,lines:hp,line:lp,triangles:pp,triangle:vp,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},yp=0,mp=1,si=4,Ep=5120,Rn=5121,lu=5122,Ln=5123,pu=5124,an=5125,to=34963,_p=35040,bp=35044;function gp(u,p,g,M){var X={},F=0,j={uint8:Rn,uint16:Ln};p.oes_element_index_uint&&(j.uint32=an);function J(ce){this.id=F++,X[this.id]=this,this.buffer=ce,this.primType=si,this.vertCount=0,this.type=0}J.prototype.bind=function(){this.buffer.bind()};var te=[];function ae(ce){var O=te.pop();return O||(O=new J(g.create(null,to,!0,!1)._buffer)),ue(O,ce,_p,-1,-1,0,0),O}function re(ce){te.push(ce)}function ue(ce,O,$,ie,me,Y,be){ce.buffer.bind();var Z;if(O){var le=be;!be&&(!r(O)||pr(O)&&!r(O.data))&&(le=p.oes_element_index_uint?an:Ln),g._initBuffer(ce.buffer,O,$,le,3)}else u.bufferData(to,Y,$),ce.buffer.dtype=Z||Rn,ce.buffer.usage=$,ce.buffer.dimension=3,ce.buffer.byteLength=Y;if(Z=be,!be){switch(ce.buffer.dtype){case Rn:case Ep:Z=Rn;break;case Ln:case lu:Z=Ln;break;case an:case pu:Z=an;break;default:_.raise("unsupported type for element array")}ce.buffer.dtype=Z}ce.type=Z,_(Z!==an||!!p.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Q=me;Q<0&&(Q=ce.buffer.byteLength,Z===Ln?Q>>=1:Z===an&&(Q>>=2)),ce.vertCount=Q;var pe=ie;if(ie<0){pe=si;var Ie=ce.buffer.dimension;Ie===1&&(pe=yp),Ie===2&&(pe=mp),Ie===3&&(pe=si)}ce.primType=pe}function ve(ce){M.elementsCount--,_(ce.buffer!==null,"must not double destroy elements"),delete X[ce.id],ce.buffer.destroy(),ce.buffer=null}function ee(ce,O){var $=g.create(null,to,!0),ie=new J($._buffer);M.elementsCount++;function me(Y){if(!Y)$(),ie.primType=si,ie.vertCount=0,ie.type=Rn;else if(typeof Y=="number")$(Y),ie.primType=si,ie.vertCount=Y|0,ie.type=Rn;else{var be=null,Z=bp,le=-1,Q=-1,pe=0,Ie=0;Array.isArray(Y)||r(Y)||pr(Y)?be=Y:(_.type(Y,"object","invalid arguments for elements"),"data"in Y&&(be=Y.data,_(Array.isArray(be)||r(be)||pr(be),"invalid data for element buffer")),"usage"in Y&&(_.parameter(Y.usage,Vi,"invalid element buffer usage"),Z=Vi[Y.usage]),"primitive"in Y&&(_.parameter(Y.primitive,Sn,"invalid element buffer primitive"),le=Sn[Y.primitive]),"count"in Y&&(_(typeof Y.count=="number"&&Y.count>=0,"invalid vertex count for elements"),Q=Y.count|0),"type"in Y&&(_.parameter(Y.type,j,"invalid buffer type"),Ie=j[Y.type]),"length"in Y?pe=Y.length|0:(pe=Q,Ie===Ln||Ie===lu?pe*=2:(Ie===an||Ie===pu)&&(pe*=4))),ue(ie,be,Z,le,Q,pe,Ie)}return me}return me(ce),me._reglType="elements",me._elements=ie,me.subdata=function(Y,be){return $.subdata(Y,be),me},me.destroy=function(){ve(ie)},me}return{create:ee,createStream:ae,destroyStream:re,getElements:function(ce){return typeof ce=="function"&&ce._elements instanceof J?ce._elements:null},clear:function(){ar(X).forEach(ve)}}}var vu=new Float32Array(1),Ap=new Uint32Array(vu.buffer),Tp=5123;function yu(u){for(var p=bt.allocType(Tp,u.length),g=0;g<u.length;++g)if(isNaN(u[g]))p[g]=65535;else if(u[g]===1/0)p[g]=31744;else if(u[g]===-1/0)p[g]=64512;else{vu[0]=u[g];var M=Ap[0],X=M>>>31<<15,F=(M<<1>>>24)-127,j=M>>13&(1<<10)-1;if(F<-24)p[g]=X;else if(F<-14){var J=-14-F;p[g]=X+(j+(1<<10)>>J)}else F>15?p[g]=X+31744:p[g]=X+(F+15<<10)+j}return p}function yt(u){return Array.isArray(u)||r(u)}var mu=function(u){return!(u&u-1)&&!!u},wp=34467,Ar=3553,ro=34067,Wi=34069,on=6408,no=6406,zi=6407,ui=6409,Yi=6410,Eu=32854,io=32855,_u=36194,Sp=32819,Rp=32820,Lp=33635,xp=34042,ao=6402,Ki=34041,oo=35904,so=35906,xn=36193,uo=33776,fo=33777,co=33778,ho=33779,bu=35986,gu=35987,Au=34798,Tu=35840,wu=35841,Su=35842,Ru=35843,Lu=36196,Nn=5121,lo=5123,po=5125,fi=5126,Np=10242,Op=10243,Ip=10497,vo=33071,Cp=33648,Dp=10240,Gp=10241,yo=9728,Fp=9729,mo=9984,xu=9985,Nu=9986,Eo=9987,Up=33170,qi=4352,Mp=4353,Pp=4354,kp=34046,Bp=3317,jp=37440,$p=37441,Hp=37443,Ou=37444,ci=33984,Vp=[mo,Nu,xu,Eo],Qi=[0,ui,Yi,zi,on],or={};or[ui]=or[no]=or[ao]=1,or[Ki]=or[Yi]=2,or[zi]=or[oo]=3,or[on]=or[so]=4;function On(u){return"[object "+u+"]"}var Iu=On("HTMLCanvasElement"),Cu=On("OffscreenCanvas"),Du=On("CanvasRenderingContext2D"),Gu=On("ImageBitmap"),Fu=On("HTMLImageElement"),Uu=On("HTMLVideoElement"),Xp=Object.keys(Qa).concat([Iu,Cu,Du,Gu,Fu,Uu]),In=[];In[Nn]=1,In[fi]=4,In[xn]=2,In[lo]=2,In[po]=4;var kt=[];kt[Eu]=2,kt[io]=2,kt[_u]=2,kt[Ki]=4,kt[uo]=.5,kt[fo]=.5,kt[co]=1,kt[ho]=1,kt[bu]=.5,kt[gu]=1,kt[Au]=1,kt[Tu]=.5,kt[wu]=.25,kt[Su]=.5,kt[Ru]=.25,kt[Lu]=.5;function Mu(u){return Array.isArray(u)&&(u.length===0||typeof u[0]=="number")}function Pu(u){if(!Array.isArray(u))return!1;var p=u.length;return!(p===0||!yt(u[0]))}function sn(u){return Object.prototype.toString.call(u)}function ku(u){return sn(u)===Iu}function Bu(u){return sn(u)===Cu}function Wp(u){return sn(u)===Du}function zp(u){return sn(u)===Gu}function Yp(u){return sn(u)===Fu}function Kp(u){return sn(u)===Uu}function _o(u){if(!u)return!1;var p=sn(u);return Xp.indexOf(p)>=0?!0:Mu(u)||Pu(u)||pr(u)}function ju(u){return Qa[Object.prototype.toString.call(u)]|0}function qp(u,p){var g=p.length;switch(u.type){case Nn:case lo:case po:case fi:var M=bt.allocType(u.type,g);M.set(p),u.data=M;break;case xn:u.data=yu(p);break;default:_.raise("unsupported texture type, must specify a typed array")}}function $u(u,p){return bt.allocType(u.type===xn?fi:u.type,p)}function Hu(u,p){u.type===xn?(u.data=yu(p),bt.freeType(p)):u.data=p}function Qp(u,p,g,M,X,F){for(var j=u.width,J=u.height,te=u.channels,ae=j*J*te,re=$u(u,ae),ue=0,ve=0;ve<J;++ve)for(var ee=0;ee<j;++ee)for(var ce=0;ce<te;++ce)re[ue++]=p[g*ee+M*ve+X*ce+F];Hu(u,re)}function Zi(u,p,g,M,X,F){var j;if(typeof kt[u]<"u"?j=kt[u]:j=or[u]*In[p],F&&(j*=6),X){for(var J=0,te=g;te>=1;)J+=j*te*te,te/=2;return J}else return j*g*M}function Zp(u,p,g,M,X,F,j){var J={"don't care":qi,"dont care":qi,nice:Pp,fast:Mp},te={repeat:Ip,clamp:vo,mirror:Cp},ae={nearest:yo,linear:Fp},re=n({mipmap:Eo,"nearest mipmap nearest":mo,"linear mipmap nearest":xu,"nearest mipmap linear":Nu,"linear mipmap linear":Eo},ae),ue={none:0,browser:Ou},ve={uint8:Nn,rgba4:Sp,rgb565:Lp,"rgb5 a1":Rp},ee={alpha:no,luminance:ui,"luminance alpha":Yi,rgb:zi,rgba:on,rgba4:Eu,"rgb5 a1":io,rgb565:_u},ce={};p.ext_srgb&&(ee.srgb=oo,ee.srgba=so),p.oes_texture_float&&(ve.float32=ve.float=fi),p.oes_texture_half_float&&(ve.float16=ve["half float"]=xn),p.webgl_depth_texture&&(n(ee,{depth:ao,"depth stencil":Ki}),n(ve,{uint16:lo,uint32:po,"depth stencil":xp})),p.webgl_compressed_texture_s3tc&&n(ce,{"rgb s3tc dxt1":uo,"rgba s3tc dxt1":fo,"rgba s3tc dxt3":co,"rgba s3tc dxt5":ho}),p.webgl_compressed_texture_atc&&n(ce,{"rgb atc":bu,"rgba atc explicit alpha":gu,"rgba atc interpolated alpha":Au}),p.webgl_compressed_texture_pvrtc&&n(ce,{"rgb pvrtc 4bppv1":Tu,"rgb pvrtc 2bppv1":wu,"rgba pvrtc 4bppv1":Su,"rgba pvrtc 2bppv1":Ru}),p.webgl_compressed_texture_etc1&&(ce["rgb etc1"]=Lu);var O=Array.prototype.slice.call(u.getParameter(wp));Object.keys(ce).forEach(function(b){var P=ce[b];O.indexOf(P)>=0&&(ee[b]=P)});var $=Object.keys(ee);g.textureFormats=$;var ie=[];Object.keys(ee).forEach(function(b){var P=ee[b];ie[P]=b});var me=[];Object.keys(ve).forEach(function(b){var P=ve[b];me[P]=b});var Y=[];Object.keys(ae).forEach(function(b){var P=ae[b];Y[P]=b});var be=[];Object.keys(re).forEach(function(b){var P=re[b];be[P]=b});var Z=[];Object.keys(te).forEach(function(b){var P=te[b];Z[P]=b});var le=$.reduce(function(b,P){var G=ee[P];return G===ui||G===no||G===ui||G===Yi||G===ao||G===Ki||p.ext_srgb&&(G===oo||G===so)?b[G]=G:G===io||P.indexOf("rgba")>=0?b[G]=on:b[G]=zi,b},{});function Q(){this.internalformat=on,this.format=on,this.type=Nn,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Ou,this.width=0,this.height=0,this.channels=0}function pe(b,P){b.internalformat=P.internalformat,b.format=P.format,b.type=P.type,b.compressed=P.compressed,b.premultiplyAlpha=P.premultiplyAlpha,b.flipY=P.flipY,b.unpackAlignment=P.unpackAlignment,b.colorSpace=P.colorSpace,b.width=P.width,b.height=P.height,b.channels=P.channels}function Ie(b,P){if(!(typeof P!="object"||!P)){if("premultiplyAlpha"in P&&(_.type(P.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),b.premultiplyAlpha=P.premultiplyAlpha),"flipY"in P&&(_.type(P.flipY,"boolean","invalid texture flip"),b.flipY=P.flipY),"alignment"in P&&(_.oneOf(P.alignment,[1,2,4,8],"invalid texture unpack alignment"),b.unpackAlignment=P.alignment),"colorSpace"in P&&(_.parameter(P.colorSpace,ue,"invalid colorSpace"),b.colorSpace=ue[P.colorSpace]),"type"in P){var G=P.type;_(p.oes_texture_float||!(G==="float"||G==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),_(p.oes_texture_half_float||!(G==="half float"||G==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),_(p.webgl_depth_texture||!(G==="uint16"||G==="uint32"||G==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),_.parameter(G,ve,"invalid texture type"),b.type=ve[G]}var Ae=b.width,Ye=b.height,m=b.channels,l=!1;"shape"in P?(_(Array.isArray(P.shape)&&P.shape.length>=2,"shape must be an array"),Ae=P.shape[0],Ye=P.shape[1],P.shape.length===3&&(m=P.shape[2],_(m>0&&m<=4,"invalid number of channels"),l=!0),_(Ae>=0&&Ae<=g.maxTextureSize,"invalid width"),_(Ye>=0&&Ye<=g.maxTextureSize,"invalid height")):("radius"in P&&(Ae=Ye=P.radius,_(Ae>=0&&Ae<=g.maxTextureSize,"invalid radius")),"width"in P&&(Ae=P.width,_(Ae>=0&&Ae<=g.maxTextureSize,"invalid width")),"height"in P&&(Ye=P.height,_(Ye>=0&&Ye<=g.maxTextureSize,"invalid height")),"channels"in P&&(m=P.channels,_(m>0&&m<=4,"invalid number of channels"),l=!0)),b.width=Ae|0,b.height=Ye|0,b.channels=m|0;var T=!1;if("format"in P){var N=P.format;_(p.webgl_depth_texture||!(N==="depth"||N==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),_.parameter(N,ee,"invalid texture format");var I=b.internalformat=ee[N];b.format=le[I],N in ve&&("type"in P||(b.type=ve[N])),N in ce&&(b.compressed=!0),T=!0}!l&&T?b.channels=or[b.format]:l&&!T?b.channels!==Qi[b.format]&&(b.format=b.internalformat=Qi[b.channels]):T&&l&&_(b.channels===or[b.format],"number of channels inconsistent with specified format")}}function ke(b){u.pixelStorei(jp,b.flipY),u.pixelStorei($p,b.premultiplyAlpha),u.pixelStorei(Hp,b.colorSpace),u.pixelStorei(Bp,b.unpackAlignment)}function ye(){Q.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function oe(b,P){var G=null;if(_o(P)?G=P:P&&(_.type(P,"object","invalid pixel data type"),Ie(b,P),"x"in P&&(b.xOffset=P.x|0),"y"in P&&(b.yOffset=P.y|0),_o(P.data)&&(G=P.data)),_(!b.compressed||G instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),P.copy){_(!G,"can not specify copy and data field for the same texture");var Ae=X.viewportWidth,Ye=X.viewportHeight;b.width=b.width||Ae-b.xOffset,b.height=b.height||Ye-b.yOffset,b.needsCopy=!0,_(b.xOffset>=0&&b.xOffset<Ae&&b.yOffset>=0&&b.yOffset<Ye&&b.width>0&&b.width<=Ae&&b.height>0&&b.height<=Ye,"copy texture read out of bounds")}else if(!G)b.width=b.width||1,b.height=b.height||1,b.channels=b.channels||4;else if(r(G))b.channels=b.channels||4,b.data=G,!("type"in P)&&b.type===Nn&&(b.type=ju(G));else if(Mu(G))b.channels=b.channels||4,qp(b,G),b.alignment=1,b.needsFree=!0;else if(pr(G)){var m=G.data;!Array.isArray(m)&&b.type===Nn&&(b.type=ju(m));var l=G.shape,T=G.stride,N,I,S,w,R,E;l.length===3?(S=l[2],E=T[2]):(_(l.length===2,"invalid ndarray pixel data, must be 2 or 3D"),S=1,E=1),N=l[0],I=l[1],w=T[0],R=T[1],b.alignment=1,b.width=N,b.height=I,b.channels=S,b.format=b.internalformat=Qi[S],b.needsFree=!0,Qp(b,m,w,R,E,G.offset)}else if(ku(G)||Bu(G)||Wp(G))ku(G)||Bu(G)?b.element=G:b.element=G.canvas,b.width=b.element.width,b.height=b.element.height,b.channels=4;else if(zp(G))b.element=G,b.width=G.width,b.height=G.height,b.channels=4;else if(Yp(G))b.element=G,b.width=G.naturalWidth,b.height=G.naturalHeight,b.channels=4;else if(Kp(G))b.element=G,b.width=G.videoWidth,b.height=G.videoHeight,b.channels=4;else if(Pu(G)){var A=b.width||G[0].length,v=b.height||G.length,x=b.channels;yt(G[0][0])?x=x||G[0][0].length:x=x||1;for(var D=Hi.shape(G),V=1,W=0;W<D.length;++W)V*=D[W];var H=$u(b,V);Hi.flatten(G,D,"",H),Hu(b,H),b.alignment=1,b.width=A,b.height=v,b.channels=x,b.format=b.internalformat=Qi[x],b.needsFree=!0}b.type===fi?_(g.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):b.type===xn&&_(g.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function z(b,P,G){var Ae=b.element,Ye=b.data,m=b.internalformat,l=b.format,T=b.type,N=b.width,I=b.height;ke(b),Ae?u.texImage2D(P,G,l,l,T,Ae):b.compressed?u.compressedTexImage2D(P,G,m,N,I,0,Ye):b.needsCopy?(M(),u.copyTexImage2D(P,G,l,b.xOffset,b.yOffset,N,I,0)):u.texImage2D(P,G,l,N,I,0,l,T,Ye||null)}function Ue(b,P,G,Ae,Ye){var m=b.element,l=b.data,T=b.internalformat,N=b.format,I=b.type,S=b.width,w=b.height;ke(b),m?u.texSubImage2D(P,Ye,G,Ae,N,I,m):b.compressed?u.compressedTexSubImage2D(P,Ye,G,Ae,T,S,w,l):b.needsCopy?(M(),u.copyTexSubImage2D(P,Ye,G,Ae,b.xOffset,b.yOffset,S,w)):u.texSubImage2D(P,Ye,G,Ae,S,w,N,I,l)}var He=[];function Se(){return He.pop()||new ye}function ze(b){b.needsFree&&bt.freeType(b.data),ye.call(b),He.push(b)}function Be(){Q.call(this),this.genMipmaps=!1,this.mipmapHint=qi,this.mipmask=0,this.images=Array(16)}function We(b,P,G){var Ae=b.images[0]=Se();b.mipmask=1,Ae.width=b.width=P,Ae.height=b.height=G,Ae.channels=b.channels=4}function Je(b,P){var G=null;if(_o(P))G=b.images[0]=Se(),pe(G,b),oe(G,P),b.mipmask=1;else if(Ie(b,P),Array.isArray(P.mipmap))for(var Ae=P.mipmap,Ye=0;Ye<Ae.length;++Ye)G=b.images[Ye]=Se(),pe(G,b),G.width>>=Ye,G.height>>=Ye,oe(G,Ae[Ye]),b.mipmask|=1<<Ye;else G=b.images[0]=Se(),pe(G,b),oe(G,P),b.mipmask=1;pe(b,b.images[0]),b.compressed&&(b.internalformat===uo||b.internalformat===fo||b.internalformat===co||b.internalformat===ho)&&_(b.width%4===0&&b.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function At(b,P){for(var G=b.images,Ae=0;Ae<G.length;++Ae){if(!G[Ae])return;z(G[Ae],P,Ae)}}var It=[];function qe(){var b=It.pop()||new Be;Q.call(b),b.mipmask=0;for(var P=0;P<16;++P)b.images[P]=null;return b}function xt(b){for(var P=b.images,G=0;G<P.length;++G)P[G]&&ze(P[G]),P[G]=null;It.push(b)}function ft(){this.minFilter=yo,this.magFilter=yo,this.wrapS=vo,this.wrapT=vo,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=qi}function Tt(b,P){if("min"in P){var G=P.min;_.parameter(G,re),b.minFilter=re[G],Vp.indexOf(b.minFilter)>=0&&!("faces"in P)&&(b.genMipmaps=!0)}if("mag"in P){var Ae=P.mag;_.parameter(Ae,ae),b.magFilter=ae[Ae]}var Ye=b.wrapS,m=b.wrapT;if("wrap"in P){var l=P.wrap;typeof l=="string"?(_.parameter(l,te),Ye=m=te[l]):Array.isArray(l)&&(_.parameter(l[0],te),_.parameter(l[1],te),Ye=te[l[0]],m=te[l[1]])}else{if("wrapS"in P){var T=P.wrapS;_.parameter(T,te),Ye=te[T]}if("wrapT"in P){var N=P.wrapT;_.parameter(N,te),m=te[N]}}if(b.wrapS=Ye,b.wrapT=m,"anisotropic"in P){var I=P.anisotropic;_(typeof I=="number"&&I>=1&&I<=g.maxAnisotropic,"aniso samples must be between 1 and "),b.anisotropic=P.anisotropic}if("mipmap"in P){var S=!1;switch(typeof P.mipmap){case"string":_.parameter(P.mipmap,J,"invalid mipmap hint"),b.mipmapHint=J[P.mipmap],b.genMipmaps=!0,S=!0;break;case"boolean":S=b.genMipmaps=P.mipmap;break;case"object":_(Array.isArray(P.mipmap),"invalid mipmap type"),b.genMipmaps=!1,S=!0;break;default:_.raise("invalid mipmap type")}S&&!("min"in P)&&(b.minFilter=mo)}}function Nt(b,P){u.texParameteri(P,Gp,b.minFilter),u.texParameteri(P,Dp,b.magFilter),u.texParameteri(P,Np,b.wrapS),u.texParameteri(P,Op,b.wrapT),p.ext_texture_filter_anisotropic&&u.texParameteri(P,kp,b.anisotropic),b.genMipmaps&&(u.hint(Up,b.mipmapHint),u.generateMipmap(P))}var Ot=0,Gt={},Bt=g.maxTextureUnits,mt=Array(Bt).map(function(){return null});function Ve(b){Q.call(this),this.mipmask=0,this.internalformat=on,this.id=Ot++,this.refCount=1,this.target=b,this.texture=u.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new ft,j.profile&&(this.stats={size:0})}function jt(b){u.activeTexture(ci),u.bindTexture(b.target,b.texture)}function rt(){var b=mt[0];b?u.bindTexture(b.target,b.texture):u.bindTexture(Ar,null)}function Ce(b){var P=b.texture;_(P,"must not double destroy texture");var G=b.unit,Ae=b.target;G>=0&&(u.activeTexture(ci+G),u.bindTexture(Ae,null),mt[G]=null),u.deleteTexture(P),b.texture=null,b.params=null,b.pixels=null,b.refCount=0,delete Gt[b.id],F.textureCount--}n(Ve.prototype,{bind:function(){var b=this;b.bindCount+=1;var P=b.unit;if(P<0){for(var G=0;G<Bt;++G){var Ae=mt[G];if(Ae){if(Ae.bindCount>0)continue;Ae.unit=-1}mt[G]=b,P=G;break}P>=Bt&&_.raise("insufficient number of texture units"),j.profile&&F.maxTextureUnits<P+1&&(F.maxTextureUnits=P+1),b.unit=P,u.activeTexture(ci+P),u.bindTexture(b.target,b.texture)}return P},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Ce(this)}});function Ke(b,P){var G=new Ve(Ar);Gt[G.id]=G,F.textureCount++;function Ae(l,T){var N=G.texInfo;ft.call(N);var I=qe();return typeof l=="number"?typeof T=="number"?We(I,l|0,T|0):We(I,l|0,l|0):l?(_.type(l,"object","invalid arguments to regl.texture"),Tt(N,l),Je(I,l)):We(I,1,1),N.genMipmaps&&(I.mipmask=(I.width<<1)-1),G.mipmask=I.mipmask,pe(G,I),_.texture2D(N,I,g),G.internalformat=I.internalformat,Ae.width=I.width,Ae.height=I.height,jt(G),At(I,Ar),Nt(N,Ar),rt(),xt(I),j.profile&&(G.stats.size=Zi(G.internalformat,G.type,I.width,I.height,N.genMipmaps,!1)),Ae.format=ie[G.internalformat],Ae.type=me[G.type],Ae.mag=Y[N.magFilter],Ae.min=be[N.minFilter],Ae.wrapS=Z[N.wrapS],Ae.wrapT=Z[N.wrapT],Ae}function Ye(l,T,N,I){_(!!l,"must specify image data");var S=T|0,w=N|0,R=I|0,E=Se();return pe(E,G),E.width=0,E.height=0,oe(E,l),E.width=E.width||(G.width>>R)-S,E.height=E.height||(G.height>>R)-w,_(G.type===E.type&&G.format===E.format&&G.internalformat===E.internalformat,"incompatible format for texture.subimage"),_(S>=0&&w>=0&&S+E.width<=G.width&&w+E.height<=G.height,"texture.subimage write out of bounds"),_(G.mipmask&1<<R,"missing mipmap data"),_(E.data||E.element||E.needsCopy,"missing image data"),jt(G),Ue(E,Ar,S,w,R),rt(),ze(E),Ae}function m(l,T){var N=l|0,I=T|0||N;if(N===G.width&&I===G.height)return Ae;Ae.width=G.width=N,Ae.height=G.height=I,jt(G);for(var S=0;G.mipmask>>S;++S){var w=N>>S,R=I>>S;if(!w||!R)break;u.texImage2D(Ar,S,G.format,w,R,0,G.format,G.type,null)}return rt(),j.profile&&(G.stats.size=Zi(G.internalformat,G.type,N,I,!1,!1)),Ae}return Ae(b,P),Ae.subimage=Ye,Ae.resize=m,Ae._reglType="texture2d",Ae._texture=G,j.profile&&(Ae.stats=G.stats),Ae.destroy=function(){G.decRef()},Ae}function Qe(b,P,G,Ae,Ye,m){var l=new Ve(ro);Gt[l.id]=l,F.cubeCount++;var T=new Array(6);function N(w,R,E,A,v,x){var D,V=l.texInfo;for(ft.call(V),D=0;D<6;++D)T[D]=qe();if(typeof w=="number"||!w){var W=w|0||1;for(D=0;D<6;++D)We(T[D],W,W)}else if(typeof w=="object")if(R)Je(T[0],w),Je(T[1],R),Je(T[2],E),Je(T[3],A),Je(T[4],v),Je(T[5],x);else if(Tt(V,w),Ie(l,w),"faces"in w){var H=w.faces;for(_(Array.isArray(H)&&H.length===6,"cube faces must be a length 6 array"),D=0;D<6;++D)_(typeof H[D]=="object"&&!!H[D],"invalid input for cube map face"),pe(T[D],l),Je(T[D],H[D])}else for(D=0;D<6;++D)Je(T[D],w);else _.raise("invalid arguments to cube map");for(pe(l,T[0]),g.npotTextureCube||_(mu(l.width)&&mu(l.height),"your browser does not support non power or two texture dimensions"),V.genMipmaps?l.mipmask=(T[0].width<<1)-1:l.mipmask=T[0].mipmask,_.textureCube(l,V,T,g),l.internalformat=T[0].internalformat,N.width=T[0].width,N.height=T[0].height,jt(l),D=0;D<6;++D)At(T[D],Wi+D);for(Nt(V,ro),rt(),j.profile&&(l.stats.size=Zi(l.internalformat,l.type,N.width,N.height,V.genMipmaps,!0)),N.format=ie[l.internalformat],N.type=me[l.type],N.mag=Y[V.magFilter],N.min=be[V.minFilter],N.wrapS=Z[V.wrapS],N.wrapT=Z[V.wrapT],D=0;D<6;++D)xt(T[D]);return N}function I(w,R,E,A,v){_(!!R,"must specify image data"),_(typeof w=="number"&&w===(w|0)&&w>=0&&w<6,"invalid face");var x=E|0,D=A|0,V=v|0,W=Se();return pe(W,l),W.width=0,W.height=0,oe(W,R),W.width=W.width||(l.width>>V)-x,W.height=W.height||(l.height>>V)-D,_(l.type===W.type&&l.format===W.format&&l.internalformat===W.internalformat,"incompatible format for texture.subimage"),_(x>=0&&D>=0&&x+W.width<=l.width&&D+W.height<=l.height,"texture.subimage write out of bounds"),_(l.mipmask&1<<V,"missing mipmap data"),_(W.data||W.element||W.needsCopy,"missing image data"),jt(l),Ue(W,Wi+w,x,D,V),rt(),ze(W),N}function S(w){var R=w|0;if(R!==l.width){N.width=l.width=R,N.height=l.height=R,jt(l);for(var E=0;E<6;++E)for(var A=0;l.mipmask>>A;++A)u.texImage2D(Wi+E,A,l.format,R>>A,R>>A,0,l.format,l.type,null);return rt(),j.profile&&(l.stats.size=Zi(l.internalformat,l.type,N.width,N.height,!1,!0)),N}}return N(b,P,G,Ae,Ye,m),N.subimage=I,N.resize=S,N._reglType="textureCube",N._texture=l,j.profile&&(N.stats=l.stats),N.destroy=function(){l.decRef()},N}function Et(){for(var b=0;b<Bt;++b)u.activeTexture(ci+b),u.bindTexture(Ar,null),mt[b]=null;ar(Gt).forEach(Ce),F.cubeCount=0,F.textureCount=0}j.profile&&(F.getTotalTextureSize=function(){var b=0;return Object.keys(Gt).forEach(function(P){b+=Gt[P].stats.size}),b});function wr(){for(var b=0;b<Bt;++b){var P=mt[b];P&&(P.bindCount=0,P.unit=-1,mt[b]=null)}ar(Gt).forEach(function(G){G.texture=u.createTexture(),u.bindTexture(G.target,G.texture);for(var Ae=0;Ae<32;++Ae)if((G.mipmask&1<<Ae)!==0)if(G.target===Ar)u.texImage2D(Ar,Ae,G.internalformat,G.width>>Ae,G.height>>Ae,0,G.internalformat,G.type,null);else for(var Ye=0;Ye<6;++Ye)u.texImage2D(Wi+Ye,Ae,G.internalformat,G.width>>Ae,G.height>>Ae,0,G.internalformat,G.type,null);Nt(G.texInfo,G.target)})}function pn(){for(var b=0;b<Bt;++b){var P=mt[b];P&&(P.bindCount=0,P.unit=-1,mt[b]=null),u.activeTexture(ci+b),u.bindTexture(Ar,null),u.bindTexture(ro,null)}}return{create2D:Ke,createCube:Qe,clear:Et,getTexture:function(b){return null},restore:wr,refresh:pn}}var Wr=36161,Ji=32854,Vu=32855,Xu=36194,Wu=33189,zu=36168,Yu=34041,Ku=35907,qu=34836,Qu=34842,Zu=34843,vr=[];vr[Ji]=2,vr[Vu]=2,vr[Xu]=2,vr[Wu]=2,vr[zu]=1,vr[Yu]=4,vr[Ku]=4,vr[qu]=16,vr[Qu]=8,vr[Zu]=6;function Ju(u,p,g){return vr[u]*p*g}var Jp=function(u,p,g,M,X){var F={rgba4:Ji,rgb565:Xu,"rgb5 a1":Vu,depth:Wu,stencil:zu,"depth stencil":Yu};p.ext_srgb&&(F.srgba=Ku),p.ext_color_buffer_half_float&&(F.rgba16f=Qu,F.rgb16f=Zu),p.webgl_color_buffer_float&&(F.rgba32f=qu);var j=[];Object.keys(F).forEach(function(ee){var ce=F[ee];j[ce]=ee});var J=0,te={};function ae(ee){this.id=J++,this.refCount=1,this.renderbuffer=ee,this.format=Ji,this.width=0,this.height=0,X.profile&&(this.stats={size:0})}ae.prototype.decRef=function(){--this.refCount<=0&&re(this)};function re(ee){var ce=ee.renderbuffer;_(ce,"must not double destroy renderbuffer"),u.bindRenderbuffer(Wr,null),u.deleteRenderbuffer(ce),ee.renderbuffer=null,ee.refCount=0,delete te[ee.id],M.renderbufferCount--}function ue(ee,ce){var O=new ae(u.createRenderbuffer());te[O.id]=O,M.renderbufferCount++;function $(me,Y){var be=0,Z=0,le=Ji;if(typeof me=="object"&&me){var Q=me;if("shape"in Q){var pe=Q.shape;_(Array.isArray(pe)&&pe.length>=2,"invalid renderbuffer shape"),be=pe[0]|0,Z=pe[1]|0}else"radius"in Q&&(be=Z=Q.radius|0),"width"in Q&&(be=Q.width|0),"height"in Q&&(Z=Q.height|0);"format"in Q&&(_.parameter(Q.format,F,"invalid renderbuffer format"),le=F[Q.format])}else typeof me=="number"?(be=me|0,typeof Y=="number"?Z=Y|0:Z=be):me?_.raise("invalid arguments to renderbuffer constructor"):be=Z=1;if(_(be>0&&Z>0&&be<=g.maxRenderbufferSize&&Z<=g.maxRenderbufferSize,"invalid renderbuffer size"),!(be===O.width&&Z===O.height&&le===O.format))return $.width=O.width=be,$.height=O.height=Z,O.format=le,u.bindRenderbuffer(Wr,O.renderbuffer),u.renderbufferStorage(Wr,le,be,Z),_(u.getError()===0,"invalid render buffer format"),X.profile&&(O.stats.size=Ju(O.format,O.width,O.height)),$.format=j[O.format],$}function ie(me,Y){var be=me|0,Z=Y|0||be;return be===O.width&&Z===O.height||(_(be>0&&Z>0&&be<=g.maxRenderbufferSize&&Z<=g.maxRenderbufferSize,"invalid renderbuffer size"),$.width=O.width=be,$.height=O.height=Z,u.bindRenderbuffer(Wr,O.renderbuffer),u.renderbufferStorage(Wr,O.format,be,Z),_(u.getError()===0,"invalid render buffer format"),X.profile&&(O.stats.size=Ju(O.format,O.width,O.height))),$}return $(ee,ce),$.resize=ie,$._reglType="renderbuffer",$._renderbuffer=O,X.profile&&($.stats=O.stats),$.destroy=function(){O.decRef()},$}X.profile&&(M.getTotalRenderbufferSize=function(){var ee=0;return Object.keys(te).forEach(function(ce){ee+=te[ce].stats.size}),ee});function ve(){ar(te).forEach(function(ee){ee.renderbuffer=u.createRenderbuffer(),u.bindRenderbuffer(Wr,ee.renderbuffer),u.renderbufferStorage(Wr,ee.format,ee.width,ee.height)}),u.bindRenderbuffer(Wr,null)}return{create:ue,clear:function(){ar(te).forEach(re)},restore:ve}},Gr=36160,bo=36161,un=3553,ea=34069,ef=36064,tf=36096,rf=36128,nf=33306,af=36053,ev=36054,tv=36055,rv=36057,nv=36061,iv=36193,av=5121,ov=5126,of=6407,sf=6408,sv=6402,uv=[of,sf],go=[];go[sf]=4,go[of]=3;var ta=[];ta[av]=1,ta[ov]=4,ta[iv]=2;var fv=32854,cv=32855,dv=36194,hv=33189,lv=36168,uf=34041,pv=35907,vv=34836,yv=34842,mv=34843,Ev=[fv,cv,dv,pv,yv,mv,vv],Cn={};Cn[af]="complete",Cn[ev]="incomplete attachment",Cn[rv]="incomplete dimensions",Cn[tv]="incomplete, missing attachment",Cn[nv]="unsupported";function _v(u,p,g,M,X,F){var j={cur:null,next:null,dirty:!1,setFBO:null},J=["rgba"],te=["rgba4","rgb565","rgb5 a1"];p.ext_srgb&&te.push("srgba"),p.ext_color_buffer_half_float&&te.push("rgba16f","rgb16f"),p.webgl_color_buffer_float&&te.push("rgba32f");var ae=["uint8"];p.oes_texture_half_float&&ae.push("half float","float16"),p.oes_texture_float&&ae.push("float","float32");function re(ye,oe,z){this.target=ye,this.texture=oe,this.renderbuffer=z;var Ue=0,He=0;oe?(Ue=oe.width,He=oe.height):z&&(Ue=z.width,He=z.height),this.width=Ue,this.height=He}function ue(ye){ye&&(ye.texture&&ye.texture._texture.decRef(),ye.renderbuffer&&ye.renderbuffer._renderbuffer.decRef())}function ve(ye,oe,z){if(!!ye)if(ye.texture){var Ue=ye.texture._texture,He=Math.max(1,Ue.width),Se=Math.max(1,Ue.height);_(He===oe&&Se===z,"inconsistent width/height for supplied texture"),Ue.refCount+=1}else{var ze=ye.renderbuffer._renderbuffer;_(ze.width===oe&&ze.height===z,"inconsistent width/height for renderbuffer"),ze.refCount+=1}}function ee(ye,oe){oe&&(oe.texture?u.framebufferTexture2D(Gr,ye,oe.target,oe.texture._texture.texture,0):u.framebufferRenderbuffer(Gr,ye,bo,oe.renderbuffer._renderbuffer.renderbuffer))}function ce(ye){var oe=un,z=null,Ue=null,He=ye;typeof ye=="object"&&(He=ye.data,"target"in ye&&(oe=ye.target|0)),_.type(He,"function","invalid attachment data");var Se=He._reglType;return Se==="texture2d"?(z=He,_(oe===un)):Se==="textureCube"?(z=He,_(oe>=ea&&oe<ea+6,"invalid cube map target")):Se==="renderbuffer"?(Ue=He,oe=bo):_.raise("invalid regl object for attachment"),new re(oe,z,Ue)}function O(ye,oe,z,Ue,He){if(z){var Se=M.create2D({width:ye,height:oe,format:Ue,type:He});return Se._texture.refCount=0,new re(un,Se,null)}else{var ze=X.create({width:ye,height:oe,format:Ue});return ze._renderbuffer.refCount=0,new re(bo,null,ze)}}function $(ye){return ye&&(ye.texture||ye.renderbuffer)}function ie(ye,oe,z){ye&&(ye.texture?ye.texture.resize(oe,z):ye.renderbuffer&&ye.renderbuffer.resize(oe,z),ye.width=oe,ye.height=z)}var me=0,Y={};function be(){this.id=me++,Y[this.id]=this,this.framebuffer=u.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Z(ye){ye.colorAttachments.forEach(ue),ue(ye.depthAttachment),ue(ye.stencilAttachment),ue(ye.depthStencilAttachment)}function le(ye){var oe=ye.framebuffer;_(oe,"must not double destroy framebuffer"),u.deleteFramebuffer(oe),ye.framebuffer=null,F.framebufferCount--,delete Y[ye.id]}function Q(ye){var oe;u.bindFramebuffer(Gr,ye.framebuffer);var z=ye.colorAttachments;for(oe=0;oe<z.length;++oe)ee(ef+oe,z[oe]);for(oe=z.length;oe<g.maxColorAttachments;++oe)u.framebufferTexture2D(Gr,ef+oe,un,null,0);u.framebufferTexture2D(Gr,nf,un,null,0),u.framebufferTexture2D(Gr,tf,un,null,0),u.framebufferTexture2D(Gr,rf,un,null,0),ee(tf,ye.depthAttachment),ee(rf,ye.stencilAttachment),ee(nf,ye.depthStencilAttachment);var Ue=u.checkFramebufferStatus(Gr);!u.isContextLost()&&Ue!==af&&_.raise("framebuffer configuration not supported, status = "+Cn[Ue]),u.bindFramebuffer(Gr,j.next?j.next.framebuffer:null),j.cur=j.next,u.getError()}function pe(ye,oe){var z=new be;F.framebufferCount++;function Ue(Se,ze){var Be;_(j.next!==z,"can not update framebuffer which is currently in use");var We=0,Je=0,At=!0,It=!0,qe=null,xt=!0,ft="rgba",Tt="uint8",Nt=1,Ot=null,Gt=null,Bt=null,mt=!1;if(typeof Se=="number")We=Se|0,Je=ze|0||We;else if(!Se)We=Je=1;else{_.type(Se,"object","invalid arguments for framebuffer");var Ve=Se;if("shape"in Ve){var jt=Ve.shape;_(Array.isArray(jt)&&jt.length>=2,"invalid shape for framebuffer"),We=jt[0],Je=jt[1]}else"radius"in Ve&&(We=Je=Ve.radius),"width"in Ve&&(We=Ve.width),"height"in Ve&&(Je=Ve.height);("color"in Ve||"colors"in Ve)&&(qe=Ve.color||Ve.colors,Array.isArray(qe)&&_(qe.length===1||p.webgl_draw_buffers,"multiple render targets not supported")),qe||("colorCount"in Ve&&(Nt=Ve.colorCount|0,_(Nt>0,"invalid color buffer count")),"colorTexture"in Ve&&(xt=!!Ve.colorTexture,ft="rgba4"),"colorType"in Ve&&(Tt=Ve.colorType,xt?(_(p.oes_texture_float||!(Tt==="float"||Tt==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),_(p.oes_texture_half_float||!(Tt==="half float"||Tt==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Tt==="half float"||Tt==="float16"?(_(p.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),ft="rgba16f"):(Tt==="float"||Tt==="float32")&&(_(p.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),ft="rgba32f"),_.oneOf(Tt,ae,"invalid color type")),"colorFormat"in Ve&&(ft=Ve.colorFormat,J.indexOf(ft)>=0?xt=!0:te.indexOf(ft)>=0?xt=!1:xt?_.oneOf(Ve.colorFormat,J,"invalid color format for texture"):_.oneOf(Ve.colorFormat,te,"invalid color format for renderbuffer"))),("depthTexture"in Ve||"depthStencilTexture"in Ve)&&(mt=!!(Ve.depthTexture||Ve.depthStencilTexture),_(!mt||p.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Ve&&(typeof Ve.depth=="boolean"?At=Ve.depth:(Ot=Ve.depth,It=!1)),"stencil"in Ve&&(typeof Ve.stencil=="boolean"?It=Ve.stencil:(Gt=Ve.stencil,At=!1)),"depthStencil"in Ve&&(typeof Ve.depthStencil=="boolean"?At=It=Ve.depthStencil:(Bt=Ve.depthStencil,At=!1,It=!1))}var rt=null,Ce=null,Ke=null,Qe=null;if(Array.isArray(qe))rt=qe.map(ce);else if(qe)rt=[ce(qe)];else for(rt=new Array(Nt),Be=0;Be<Nt;++Be)rt[Be]=O(We,Je,xt,ft,Tt);_(p.webgl_draw_buffers||rt.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),_(rt.length<=g.maxColorAttachments,"too many color attachments, not supported"),We=We||rt[0].width,Je=Je||rt[0].height,Ot?Ce=ce(Ot):At&&!It&&(Ce=O(We,Je,mt,"depth","uint32")),Gt?Ke=ce(Gt):It&&!At&&(Ke=O(We,Je,!1,"stencil","uint8")),Bt?Qe=ce(Bt):!Ot&&!Gt&&It&&At&&(Qe=O(We,Je,mt,"depth stencil","depth stencil")),_(!!Ot+!!Gt+!!Bt<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Et=null;for(Be=0;Be<rt.length;++Be)if(ve(rt[Be],We,Je),_(!rt[Be]||rt[Be].texture&&uv.indexOf(rt[Be].texture._texture.format)>=0||rt[Be].renderbuffer&&Ev.indexOf(rt[Be].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Be+" is invalid"),rt[Be]&&rt[Be].texture){var wr=go[rt[Be].texture._texture.format]*ta[rt[Be].texture._texture.type];Et===null?Et=wr:_(Et===wr,"all color attachments much have the same number of bits per pixel.")}return ve(Ce,We,Je),_(!Ce||Ce.texture&&Ce.texture._texture.format===sv||Ce.renderbuffer&&Ce.renderbuffer._renderbuffer.format===hv,"invalid depth attachment for framebuffer object"),ve(Ke,We,Je),_(!Ke||Ke.renderbuffer&&Ke.renderbuffer._renderbuffer.format===lv,"invalid stencil attachment for framebuffer object"),ve(Qe,We,Je),_(!Qe||Qe.texture&&Qe.texture._texture.format===uf||Qe.renderbuffer&&Qe.renderbuffer._renderbuffer.format===uf,"invalid depth-stencil attachment for framebuffer object"),Z(z),z.width=We,z.height=Je,z.colorAttachments=rt,z.depthAttachment=Ce,z.stencilAttachment=Ke,z.depthStencilAttachment=Qe,Ue.color=rt.map($),Ue.depth=$(Ce),Ue.stencil=$(Ke),Ue.depthStencil=$(Qe),Ue.width=z.width,Ue.height=z.height,Q(z),Ue}function He(Se,ze){_(j.next!==z,"can not resize a framebuffer which is currently in use");var Be=Math.max(Se|0,1),We=Math.max(ze|0||Be,1);if(Be===z.width&&We===z.height)return Ue;for(var Je=z.colorAttachments,At=0;At<Je.length;++At)ie(Je[At],Be,We);return ie(z.depthAttachment,Be,We),ie(z.stencilAttachment,Be,We),ie(z.depthStencilAttachment,Be,We),z.width=Ue.width=Be,z.height=Ue.height=We,Q(z),Ue}return Ue(ye,oe),n(Ue,{resize:He,_reglType:"framebuffer",_framebuffer:z,destroy:function(){le(z),Z(z)},use:function(Se){j.setFBO({framebuffer:Ue},Se)}})}function Ie(ye){var oe=Array(6);function z(He){var Se;_(oe.indexOf(j.next)<0,"can not update framebuffer which is currently in use");var ze={color:null},Be=0,We=null,Je="rgba",At="uint8",It=1;if(typeof He=="number")Be=He|0;else if(!He)Be=1;else{_.type(He,"object","invalid arguments for framebuffer");var qe=He;if("shape"in qe){var xt=qe.shape;_(Array.isArray(xt)&&xt.length>=2,"invalid shape for framebuffer"),_(xt[0]===xt[1],"cube framebuffer must be square"),Be=xt[0]}else"radius"in qe&&(Be=qe.radius|0),"width"in qe?(Be=qe.width|0,"height"in qe&&_(qe.height===Be,"must be square")):"height"in qe&&(Be=qe.height|0);("color"in qe||"colors"in qe)&&(We=qe.color||qe.colors,Array.isArray(We)&&_(We.length===1||p.webgl_draw_buffers,"multiple render targets not supported")),We||("colorCount"in qe&&(It=qe.colorCount|0,_(It>0,"invalid color buffer count")),"colorType"in qe&&(_.oneOf(qe.colorType,ae,"invalid color type"),At=qe.colorType),"colorFormat"in qe&&(Je=qe.colorFormat,_.oneOf(qe.colorFormat,J,"invalid color format for texture"))),"depth"in qe&&(ze.depth=qe.depth),"stencil"in qe&&(ze.stencil=qe.stencil),"depthStencil"in qe&&(ze.depthStencil=qe.depthStencil)}var ft;if(We)if(Array.isArray(We))for(ft=[],Se=0;Se<We.length;++Se)ft[Se]=We[Se];else ft=[We];else{ft=Array(It);var Tt={radius:Be,format:Je,type:At};for(Se=0;Se<It;++Se)ft[Se]=M.createCube(Tt)}for(ze.color=Array(ft.length),Se=0;Se<ft.length;++Se){var Nt=ft[Se];_(typeof Nt=="function"&&Nt._reglType==="textureCube","invalid cube map"),Be=Be||Nt.width,_(Nt.width===Be&&Nt.height===Be,"invalid cube map shape"),ze.color[Se]={target:ea,data:ft[Se]}}for(Se=0;Se<6;++Se){for(var Ot=0;Ot<ft.length;++Ot)ze.color[Ot].target=ea+Se;Se>0&&(ze.depth=oe[0].depth,ze.stencil=oe[0].stencil,ze.depthStencil=oe[0].depthStencil),oe[Se]?oe[Se](ze):oe[Se]=pe(ze)}return n(z,{width:Be,height:Be,color:ft})}function Ue(He){var Se,ze=He|0;if(_(ze>0&&ze<=g.maxCubeMapSize,"invalid radius for cube fbo"),ze===z.width)return z;var Be=z.color;for(Se=0;Se<Be.length;++Se)Be[Se].resize(ze);for(Se=0;Se<6;++Se)oe[Se].resize(ze);return z.width=z.height=ze,z}return z(ye),n(z,{faces:oe,resize:Ue,_reglType:"framebufferCube",destroy:function(){oe.forEach(function(He){He.destroy()})}})}function ke(){j.cur=null,j.next=null,j.dirty=!0,ar(Y).forEach(function(ye){ye.framebuffer=u.createFramebuffer(),Q(ye)})}return n(j,{getFramebuffer:function(ye){if(typeof ye=="function"&&ye._reglType==="framebuffer"){var oe=ye._framebuffer;if(oe instanceof be)return oe}return null},create:pe,createCube:Ie,clear:function(){ar(Y).forEach(le)},restore:ke})}var bv=5126,ff=34962;function Ao(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=bv,this.offset=0,this.stride=0,this.divisor=0}function gv(u,p,g,M,X){for(var F=g.maxAttributes,j=new Array(F),J=0;J<F;++J)j[J]=new Ao;var te=0,ae={},re={Record:Ao,scope:{},state:j,currentVAO:null,targetVAO:null,restore:ve()?Y:function(){},createVAO:be,getVAO:ce,destroyBuffer:ue,setVAO:ve()?O:$,clear:ve()?ie:function(){}};function ue(Z){for(var le=0;le<j.length;++le){var Q=j[le];Q.buffer===Z&&(u.disableVertexAttribArray(le),Q.buffer=null)}}function ve(){return p.oes_vertex_array_object}function ee(){return p.angle_instanced_arrays}function ce(Z){return typeof Z=="function"&&Z._vao?Z._vao:null}function O(Z){if(Z!==re.currentVAO){var le=ve();Z?le.bindVertexArrayOES(Z.vao):le.bindVertexArrayOES(null),re.currentVAO=Z}}function $(Z){if(Z!==re.currentVAO){if(Z)Z.bindAttrs();else for(var le=ee(),Q=0;Q<j.length;++Q){var pe=j[Q];pe.buffer?(u.enableVertexAttribArray(Q),u.vertexAttribPointer(Q,pe.size,pe.type,pe.normalized,pe.stride,pe.offfset),le&&pe.divisor&&le.vertexAttribDivisorANGLE(Q,pe.divisor)):(u.disableVertexAttribArray(Q),u.vertexAttrib4f(Q,pe.x,pe.y,pe.z,pe.w))}re.currentVAO=Z}}function ie(){ar(ae).forEach(function(Z){Z.destroy()})}function me(){this.id=++te,this.attributes=[];var Z=ve();Z?this.vao=Z.createVertexArrayOES():this.vao=null,ae[this.id]=this,this.buffers=[]}me.prototype.bindAttrs=function(){for(var Z=ee(),le=this.attributes,Q=0;Q<le.length;++Q){var pe=le[Q];pe.buffer?(u.enableVertexAttribArray(Q),u.bindBuffer(ff,pe.buffer.buffer),u.vertexAttribPointer(Q,pe.size,pe.type,pe.normalized,pe.stride,pe.offset),Z&&pe.divisor&&Z.vertexAttribDivisorANGLE(Q,pe.divisor)):(u.disableVertexAttribArray(Q),u.vertexAttrib4f(Q,pe.x,pe.y,pe.z,pe.w))}for(var Ie=le.length;Ie<F;++Ie)u.disableVertexAttribArray(Ie)},me.prototype.refresh=function(){var Z=ve();Z&&(Z.bindVertexArrayOES(this.vao),this.bindAttrs(),re.currentVAO=this)},me.prototype.destroy=function(){if(this.vao){var Z=ve();this===re.currentVAO&&(re.currentVAO=null,Z.bindVertexArrayOES(null)),Z.deleteVertexArrayOES(this.vao),this.vao=null}ae[this.id]&&(delete ae[this.id],M.vaoCount-=1)};function Y(){var Z=ve();Z&&ar(ae).forEach(function(le){le.refresh()})}function be(Z){var le=new me;M.vaoCount+=1;function Q(pe){_(Array.isArray(pe),"arguments to vertex array constructor must be an array"),_(pe.length<F,"too many attributes"),_(pe.length>0,"must specify at least one attribute");var Ie={},ke=le.attributes;ke.length=pe.length;for(var ye=0;ye<pe.length;++ye){var oe=pe[ye],z=ke[ye]=new Ao,Ue=oe.data||oe;if(Array.isArray(Ue)||r(Ue)||pr(Ue)){var He;le.buffers[ye]&&(He=le.buffers[ye],r(Ue)&&He._buffer.byteLength>=Ue.byteLength?He.subdata(Ue):(He.destroy(),le.buffers[ye]=null)),le.buffers[ye]||(He=le.buffers[ye]=X.create(oe,ff,!1,!0)),z.buffer=X.getBuffer(He),z.size=z.buffer.dimension|0,z.normalized=!1,z.type=z.buffer.dtype,z.offset=0,z.stride=0,z.divisor=0,z.state=1,Ie[ye]=1}else X.getBuffer(oe)?(z.buffer=X.getBuffer(oe),z.size=z.buffer.dimension|0,z.normalized=!1,z.type=z.buffer.dtype,z.offset=0,z.stride=0,z.divisor=0,z.state=1):X.getBuffer(oe.buffer)?(z.buffer=X.getBuffer(oe.buffer),z.size=(+oe.size||z.buffer.dimension)|0,z.normalized=!!oe.normalized||!1,"type"in oe?(_.parameter(oe.type,nn,"invalid buffer type"),z.type=nn[oe.type]):z.type=z.buffer.dtype,z.offset=(oe.offset||0)|0,z.stride=(oe.stride||0)|0,z.divisor=(oe.divisor||0)|0,z.state=1,_(z.size>=1&&z.size<=4,"size must be between 1 and 4"),_(z.offset>=0,"invalid offset"),_(z.stride>=0&&z.stride<=255,"stride must be between 0 and 255"),_(z.divisor>=0,"divisor must be positive"),_(!z.divisor||!!p.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in oe?(_(ye>0,"first attribute must not be a constant"),z.x=+oe.x||0,z.y=+oe.y||0,z.z=+oe.z||0,z.w=+oe.w||0,z.state=2):_(!1,"invalid attribute spec for location "+ye)}for(var Se=0;Se<le.buffers.length;++Se)!Ie[Se]&&le.buffers[Se]&&(le.buffers[Se].destroy(),le.buffers[Se]=null);return le.refresh(),Q}return Q.destroy=function(){for(var pe=0;pe<le.buffers.length;++pe)le.buffers[pe]&&le.buffers[pe].destroy();le.buffers.length=0,le.destroy()},Q._vao=le,Q._reglType="vao",Q(Z)}return re}var cf=35632,Av=35633,Tv=35718,wv=35721;function Sv(u,p,g,M){var X={},F={};function j(O,$,ie,me){this.name=O,this.id=$,this.location=ie,this.info=me}function J(O,$){for(var ie=0;ie<O.length;++ie)if(O[ie].id===$.id){O[ie].location=$.location;return}O.push($)}function te(O,$,ie){var me=O===cf?X:F,Y=me[$];if(!Y){var be=p.str($);Y=u.createShader(O),u.shaderSource(Y,be),u.compileShader(Y),_.shaderError(u,Y,be,O,ie),me[$]=Y}return Y}var ae={},re=[],ue=0;function ve(O,$){this.id=ue++,this.fragId=O,this.vertId=$,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,M.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function ee(O,$,ie){var me,Y,be=te(cf,O.fragId),Z=te(Av,O.vertId),le=O.program=u.createProgram();if(u.attachShader(le,be),u.attachShader(le,Z),ie)for(me=0;me<ie.length;++me){var Q=ie[me];u.bindAttribLocation(le,Q[0],Q[1])}u.linkProgram(le),_.linkError(u,le,p.str(O.fragId),p.str(O.vertId),$);var pe=u.getProgramParameter(le,Tv);M.profile&&(O.stats.uniformsCount=pe);var Ie=O.uniforms;for(me=0;me<pe;++me)if(Y=u.getActiveUniform(le,me),Y)if(Y.size>1)for(var ke=0;ke<Y.size;++ke){var ye=Y.name.replace("[0]","["+ke+"]");J(Ie,new j(ye,p.id(ye),u.getUniformLocation(le,ye),Y))}else J(Ie,new j(Y.name,p.id(Y.name),u.getUniformLocation(le,Y.name),Y));var oe=u.getProgramParameter(le,wv);M.profile&&(O.stats.attributesCount=oe);var z=O.attributes;for(me=0;me<oe;++me)Y=u.getActiveAttrib(le,me),Y&&J(z,new j(Y.name,p.id(Y.name),u.getAttribLocation(le,Y.name),Y))}M.profile&&(g.getMaxUniformsCount=function(){var O=0;return re.forEach(function($){$.stats.uniformsCount>O&&(O=$.stats.uniformsCount)}),O},g.getMaxAttributesCount=function(){var O=0;return re.forEach(function($){$.stats.attributesCount>O&&(O=$.stats.attributesCount)}),O});function ce(){X={},F={};for(var O=0;O<re.length;++O)ee(re[O],null,re[O].attributes.map(function($){return[$.location,$.name]}))}return{clear:function(){var O=u.deleteShader.bind(u);ar(X).forEach(O),X={},ar(F).forEach(O),F={},re.forEach(function($){u.deleteProgram($.program)}),re.length=0,ae={},g.shaderCount=0},program:function(O,$,ie,me){_.command(O>=0,"missing vertex shader",ie),_.command($>=0,"missing fragment shader",ie);var Y=ae[$];Y||(Y=ae[$]={});var be=Y[O];if(be&&(be.refCount++,!me))return be;var Z=new ve($,O);return g.shaderCount++,ee(Z,ie,me),be||(Y[O]=Z),re.push(Z),n(Z,{destroy:function(){if(Z.refCount--,Z.refCount<=0){u.deleteProgram(Z.program);var le=re.indexOf(Z);re.splice(le,1),g.shaderCount--}Y[Z.vertId].refCount<=0&&(u.deleteShader(F[Z.vertId]),delete F[Z.vertId],delete ae[Z.fragId][Z.vertId]),Object.keys(ae[Z.fragId]).length||(u.deleteShader(X[Z.fragId]),delete X[Z.fragId],delete ae[Z.fragId])}})},restore:ce,shader:te,frag:-1,vert:-1}}var Rv=6408,di=5121,Lv=3333,ra=5126;function xv(u,p,g,M,X,F,j){function J(re){var ue;p.next===null?(_(X.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),ue=di):(_(p.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),ue=p.next.colorAttachments[0].texture._texture.type,F.oes_texture_float?(_(ue===di||ue===ra,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),ue===ra&&_(j.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):_(ue===di,"Reading from a framebuffer is only allowed for the type 'uint8'"));var ve=0,ee=0,ce=M.framebufferWidth,O=M.framebufferHeight,$=null;r(re)?$=re:re&&(_.type(re,"object","invalid arguments to regl.read()"),ve=re.x|0,ee=re.y|0,_(ve>=0&&ve<M.framebufferWidth,"invalid x offset for regl.read"),_(ee>=0&&ee<M.framebufferHeight,"invalid y offset for regl.read"),ce=(re.width||M.framebufferWidth-ve)|0,O=(re.height||M.framebufferHeight-ee)|0,$=re.data||null),$&&(ue===di?_($ instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):ue===ra&&_($ instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),_(ce>0&&ce+ve<=M.framebufferWidth,"invalid width for read pixels"),_(O>0&&O+ee<=M.framebufferHeight,"invalid height for read pixels"),g();var ie=ce*O*4;return $||(ue===di?$=new Uint8Array(ie):ue===ra&&($=$||new Float32Array(ie))),_.isTypedArray($,"data buffer for regl.read() must be a typedarray"),_($.byteLength>=ie,"data buffer for regl.read() too small"),u.pixelStorei(Lv,4),u.readPixels(ve,ee,ce,O,Rv,ue,$),$}function te(re){var ue;return p.setFBO({framebuffer:re.framebuffer},function(){ue=J(re)}),ue}function ae(re){return!re||!("framebuffer"in re)?J(re):te(re)}return ae}function Dn(u){return Array.prototype.slice.call(u)}function Gn(u){return Dn(u).join("")}function Nv(){var u=0,p=[],g=[];function M(ue){for(var ve=0;ve<g.length;++ve)if(g[ve]===ue)return p[ve];var ee="g"+u++;return p.push(ee),g.push(ue),ee}function X(){var ue=[];function ve(){ue.push.apply(ue,Dn(arguments))}var ee=[];function ce(){var O="v"+u++;return ee.push(O),arguments.length>0&&(ue.push(O,"="),ue.push.apply(ue,Dn(arguments)),ue.push(";")),O}return n(ve,{def:ce,toString:function(){return Gn([ee.length>0?"var "+ee.join(",")+";":"",Gn(ue)])}})}function F(){var ue=X(),ve=X(),ee=ue.toString,ce=ve.toString;function O($,ie){ve($,ie,"=",ue.def($,ie),";")}return n(function(){ue.apply(ue,Dn(arguments))},{def:ue.def,entry:ue,exit:ve,save:O,set:function($,ie,me){O($,ie),ue($,ie,"=",me,";")},toString:function(){return ee()+ce()}})}function j(){var ue=Gn(arguments),ve=F(),ee=F(),ce=ve.toString,O=ee.toString;return n(ve,{then:function(){return ve.apply(ve,Dn(arguments)),this},else:function(){return ee.apply(ee,Dn(arguments)),this},toString:function(){var $=O();return $&&($="else{"+$+"}"),Gn(["if(",ue,"){",ce(),"}",$])}})}var J=X(),te={};function ae(ue,ve){var ee=[];function ce(){var Y="a"+ee.length;return ee.push(Y),Y}ve=ve||0;for(var O=0;O<ve;++O)ce();var $=F(),ie=$.toString,me=te[ue]=n($,{arg:ce,toString:function(){return Gn(["function(",ee.join(),"){",ie(),"}"])}});return me}function re(){var ue=['"use strict";',J,"return {"];Object.keys(te).forEach(function(ce){ue.push('"',ce,'":',te[ce].toString(),",")}),ue.push("}");var ve=Gn(ue).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),ee=Function.apply(null,p.concat(ve));return ee.apply(null,g)}return{global:J,link:M,block:X,proc:ae,scope:F,cond:j,compile:re}}var Fn="xyzw".split(""),df=5121,Un=1,To=2,wo=0,So=1,Ro=2,Lo=3,na=4,hf=5,lf=6,pf="dither",vf="blend.enable",yf="blend.color",xo="blend.equation",No="blend.func",mf="depth.enable",Ef="depth.func",_f="depth.range",bf="depth.mask",Oo="colorMask",gf="cull.enable",Af="cull.face",Io="frontFace",Co="lineWidth",Tf="polygonOffset.enable",Do="polygonOffset.offset",wf="sample.alpha",Sf="sample.enable",Go="sample.coverage",Rf="stencil.enable",Lf="stencil.mask",Fo="stencil.func",Uo="stencil.opFront",hi="stencil.opBack",xf="scissor.enable",ia="scissor.box",Fr="viewport",li="profile",fn="framebuffer",pi="vert",vi="frag",cn="elements",dn="primitive",hn="count",aa="offset",oa="instances",yi="vao",Mo="Width",Po="Height",Mn=fn+Mo,Pn=fn+Po,Ov=Fr+Mo,Iv=Fr+Po,Nf="drawingBuffer",Of=Nf+Mo,If=Nf+Po,Cv=[No,xo,Fo,Uo,hi,Go,Fr,ia,Do],kn=34962,Dv=34963,Gv=35632,Fv=35633,Cf=3553,Uv=34067,Mv=2884,Pv=3042,kv=3024,Bv=2960,jv=2929,$v=3089,Hv=32823,Vv=32926,Xv=32928,ko=5126,sa=35664,ua=35665,fa=35666,Bo=5124,ca=35667,da=35668,ha=35669,jo=35670,la=35671,pa=35672,va=35673,mi=35674,Ei=35675,_i=35676,bi=35678,gi=35680,Df=4,Ai=1028,ln=1029,Gf=2304,$o=2305,Wv=32775,zv=32776,Yv=519,zr=7680,Ff=0,Uf=1,Mf=32774,Kv=513,Pf=36160,qv=36064,Tr={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},kf=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Bn={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Yr={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Bf={frag:Gv,vert:Fv},Ho={cw:Gf,ccw:$o};function ya(u){return Array.isArray(u)||r(u)||pr(u)}function jf(u){return u.sort(function(p,g){return p===Fr?-1:g===Fr?1:p<g?-1:1})}function Wt(u,p,g,M){this.thisDep=u,this.contextDep=p,this.propDep=g,this.append=M}function Kr(u){return u&&!(u.thisDep||u.contextDep||u.propDep)}function gt(u){return new Wt(!1,!1,!1,u)}function Jt(u,p){var g=u.type;if(g===wo){var M=u.data.length;return new Wt(!0,M>=1,M>=2,p)}else if(g===na){var X=u.data;return new Wt(X.thisDep,X.contextDep,X.propDep,p)}else{if(g===hf)return new Wt(!1,!1,!1,p);if(g===lf){for(var F=!1,j=!1,J=!1,te=0;te<u.data.length;++te){var ae=u.data[te];if(ae.type===So)J=!0;else if(ae.type===Ro)j=!0;else if(ae.type===Lo)F=!0;else if(ae.type===wo){F=!0;var re=ae.data;re>=1&&(j=!0),re>=2&&(J=!0)}else ae.type===na&&(F=F||ae.data.thisDep,j=j||ae.data.contextDep,J=J||ae.data.propDep)}return new Wt(F,j,J,p)}else return new Wt(g===Lo,g===Ro,g===So,p)}}var $f=new Wt(!1,!1,!1,function(){});function Qv(u,p,g,M,X,F,j,J,te,ae,re,ue,ve,ee,ce){var O=ae.Record,$={add:32774,subtract:32778,"reverse subtract":32779};g.ext_blend_minmax&&($.min=Wv,$.max=zv);var ie=g.angle_instanced_arrays,me=g.webgl_draw_buffers,Y={dirty:!0,profile:ce.profile},be={},Z=[],le={},Q={};function pe(m){return m.replace(".","_")}function Ie(m,l,T){var N=pe(m);Z.push(m),be[N]=Y[N]=!!T,le[N]=l}function ke(m,l,T){var N=pe(m);Z.push(m),Array.isArray(T)?(Y[N]=T.slice(),be[N]=T.slice()):Y[N]=be[N]=T,Q[N]=l}Ie(pf,kv),Ie(vf,Pv),ke(yf,"blendColor",[0,0,0,0]),ke(xo,"blendEquationSeparate",[Mf,Mf]),ke(No,"blendFuncSeparate",[Uf,Ff,Uf,Ff]),Ie(mf,jv,!0),ke(Ef,"depthFunc",Kv),ke(_f,"depthRange",[0,1]),ke(bf,"depthMask",!0),ke(Oo,Oo,[!0,!0,!0,!0]),Ie(gf,Mv),ke(Af,"cullFace",ln),ke(Io,Io,$o),ke(Co,Co,1),Ie(Tf,Hv),ke(Do,"polygonOffset",[0,0]),Ie(wf,Vv),Ie(Sf,Xv),ke(Go,"sampleCoverage",[1,!1]),Ie(Rf,Bv),ke(Lf,"stencilMask",-1),ke(Fo,"stencilFunc",[Yv,0,-1]),ke(Uo,"stencilOpSeparate",[Ai,zr,zr,zr]),ke(hi,"stencilOpSeparate",[ln,zr,zr,zr]),Ie(xf,$v),ke(ia,"scissor",[0,0,u.drawingBufferWidth,u.drawingBufferHeight]),ke(Fr,Fr,[0,0,u.drawingBufferWidth,u.drawingBufferHeight]);var ye={gl:u,context:ve,strings:p,next:be,current:Y,draw:ue,elements:F,buffer:X,shader:re,attributes:ae.state,vao:ae,uniforms:te,framebuffer:J,extensions:g,timer:ee,isBufferArgs:ya},oe={primTypes:Sn,compareFuncs:Bn,blendFuncs:Tr,blendEquations:$,stencilOps:Yr,glTypes:nn,orientationType:Ho};_.optional(function(){ye.isArrayLike=yt}),me&&(oe.backBuffer=[ln],oe.drawBuffer=Zt(M.maxDrawbuffers,function(m){return m===0?[0]:Zt(m,function(l){return qv+l})}));var z=0;function Ue(){var m=Nv(),l=m.link,T=m.global;m.id=z++,m.batchId="0";var N=l(ye),I=m.shared={props:"a0"};Object.keys(ye).forEach(function(A){I[A]=T.def(N,".",A)}),_.optional(function(){m.CHECK=l(_),m.commandStr=_.guessCommand(),m.command=l(m.commandStr),m.assert=function(A,v,x){A("if(!(",v,"))",this.CHECK,".commandRaise(",l(x),",",this.command,");")},oe.invalidBlendCombinations=kf});var S=m.next={},w=m.current={};Object.keys(Q).forEach(function(A){Array.isArray(Y[A])&&(S[A]=T.def(I.next,".",A),w[A]=T.def(I.current,".",A))});var R=m.constants={};Object.keys(oe).forEach(function(A){R[A]=T.def(JSON.stringify(oe[A]))}),m.invoke=function(A,v){switch(v.type){case wo:var x=["this",I.context,I.props,m.batchId];return A.def(l(v.data),".call(",x.slice(0,Math.max(v.data.length+1,4)),")");case So:return A.def(I.props,v.data);case Ro:return A.def(I.context,v.data);case Lo:return A.def("this",v.data);case na:return v.data.append(m,A),v.data.ref;case hf:return v.data.toString();case lf:return v.data.map(function(D){return m.invoke(A,D)})}},m.attribCache={};var E={};return m.scopeAttrib=function(A){var v=p.id(A);if(v in E)return E[v];var x=ae.scope[v];x||(x=ae.scope[v]=new O);var D=E[v]=l(x);return D},m}function He(m){var l=m.static,T=m.dynamic,N;if(li in l){var I=!!l[li];N=gt(function(w,R){return I}),N.enable=I}else if(li in T){var S=T[li];N=Jt(S,function(w,R){return w.invoke(R,S)})}return N}function Se(m,l){var T=m.static,N=m.dynamic;if(fn in T){var I=T[fn];return I?(I=J.getFramebuffer(I),_.command(I,"invalid framebuffer object"),gt(function(w,R){var E=w.link(I),A=w.shared;R.set(A.framebuffer,".next",E);var v=A.context;return R.set(v,"."+Mn,E+".width"),R.set(v,"."+Pn,E+".height"),E})):gt(function(w,R){var E=w.shared;R.set(E.framebuffer,".next","null");var A=E.context;return R.set(A,"."+Mn,A+"."+Of),R.set(A,"."+Pn,A+"."+If),"null"})}else if(fn in N){var S=N[fn];return Jt(S,function(w,R){var E=w.invoke(R,S),A=w.shared,v=A.framebuffer,x=R.def(v,".getFramebuffer(",E,")");_.optional(function(){w.assert(R,"!"+E+"||"+x,"invalid framebuffer object")}),R.set(v,".next",x);var D=A.context;return R.set(D,"."+Mn,x+"?"+x+".width:"+D+"."+Of),R.set(D,"."+Pn,x+"?"+x+".height:"+D+"."+If),x})}else return null}function ze(m,l,T){var N=m.static,I=m.dynamic;function S(E){if(E in N){var A=N[E];_.commandType(A,"object","invalid "+E,T.commandStr);var v=!0,x=A.x|0,D=A.y|0,V,W;return"width"in A?(V=A.width|0,_.command(V>=0,"invalid "+E,T.commandStr)):v=!1,"height"in A?(W=A.height|0,_.command(W>=0,"invalid "+E,T.commandStr)):v=!1,new Wt(!v&&l&&l.thisDep,!v&&l&&l.contextDep,!v&&l&&l.propDep,function(xe,Xe){var Re=xe.shared.context,De=V;"width"in A||(De=Xe.def(Re,".",Mn,"-",x));var je=W;return"height"in A||(je=Xe.def(Re,".",Pn,"-",D)),[x,D,De,je]})}else if(E in I){var H=I[E],ne=Jt(H,function(xe,Xe){var Re=xe.invoke(Xe,H);_.optional(function(){xe.assert(Xe,Re+"&&typeof "+Re+'==="object"',"invalid "+E)});var De=xe.shared.context,je=Xe.def(Re,".x|0"),et=Xe.def(Re,".y|0"),pt=Xe.def('"width" in ',Re,"?",Re,".width|0:","(",De,".",Mn,"-",je,")"),zt=Xe.def('"height" in ',Re,"?",Re,".height|0:","(",De,".",Pn,"-",et,")");return _.optional(function(){xe.assert(Xe,pt+">=0&&"+zt+">=0","invalid "+E)}),[je,et,pt,zt]});return l&&(ne.thisDep=ne.thisDep||l.thisDep,ne.contextDep=ne.contextDep||l.contextDep,ne.propDep=ne.propDep||l.propDep),ne}else return l?new Wt(l.thisDep,l.contextDep,l.propDep,function(xe,Xe){var Re=xe.shared.context;return[0,0,Xe.def(Re,".",Mn),Xe.def(Re,".",Pn)]}):null}var w=S(Fr);if(w){var R=w;w=new Wt(w.thisDep,w.contextDep,w.propDep,function(E,A){var v=R.append(E,A),x=E.shared.context;return A.set(x,"."+Ov,v[2]),A.set(x,"."+Iv,v[3]),v})}return{viewport:w,scissor_box:S(ia)}}function Be(m,l){var T=m.static,N=typeof T[vi]=="string"&&typeof T[pi]=="string";if(N){if(Object.keys(l.dynamic).length>0)return null;var I=l.static,S=Object.keys(I);if(S.length>0&&typeof I[S[0]]=="number"){for(var w=[],R=0;R<S.length;++R)_(typeof I[S[R]]=="number","must specify all vertex attribute locations when using vaos"),w.push([I[S[R]]|0,S[R]]);return w}}return null}function We(m,l,T){var N=m.static,I=m.dynamic;function S(v){if(v in N){var x=p.id(N[v]);_.optional(function(){re.shader(Bf[v],x,_.guessCommand())});var D=gt(function(){return x});return D.id=x,D}else if(v in I){var V=I[v];return Jt(V,function(W,H){var ne=W.invoke(H,V),xe=H.def(W.shared.strings,".id(",ne,")");return _.optional(function(){H(W.shared.shader,".shader(",Bf[v],",",xe,",",W.command,");")}),xe})}return null}var w=S(vi),R=S(pi),E=null,A;return Kr(w)&&Kr(R)?(E=re.program(R.id,w.id,null,T),A=gt(function(v,x){return v.link(E)})):A=new Wt(w&&w.thisDep||R&&R.thisDep,w&&w.contextDep||R&&R.contextDep,w&&w.propDep||R&&R.propDep,function(v,x){var D=v.shared.shader,V;w?V=w.append(v,x):V=x.def(D,".",vi);var W;R?W=R.append(v,x):W=x.def(D,".",pi);var H=D+".program("+W+","+V;return _.optional(function(){H+=","+v.command}),x.def(H+")")}),{frag:w,vert:R,progVar:A,program:E}}function Je(m,l){var T=m.static,N=m.dynamic;function I(){if(cn in T){var v=T[cn];ya(v)?v=F.getElements(F.create(v,!0)):v&&(v=F.getElements(v),_.command(v,"invalid elements",l.commandStr));var x=gt(function(V,W){if(v){var H=V.link(v);return V.ELEMENTS=H,H}return V.ELEMENTS=null,null});return x.value=v,x}else if(cn in N){var D=N[cn];return Jt(D,function(V,W){var H=V.shared,ne=H.isBufferArgs,xe=H.elements,Xe=V.invoke(W,D),Re=W.def("null"),De=W.def(ne,"(",Xe,")"),je=V.cond(De).then(Re,"=",xe,".createStream(",Xe,");").else(Re,"=",xe,".getElements(",Xe,");");return _.optional(function(){V.assert(je.else,"!"+Xe+"||"+Re,"invalid elements")}),W.entry(je),W.exit(V.cond(De).then(xe,".destroyStream(",Re,");")),V.ELEMENTS=Re,Re})}return null}var S=I();function w(){if(dn in T){var v=T[dn];return _.commandParameter(v,Sn,"invalid primitve",l.commandStr),gt(function(D,V){return Sn[v]})}else if(dn in N){var x=N[dn];return Jt(x,function(D,V){var W=D.constants.primTypes,H=D.invoke(V,x);return _.optional(function(){D.assert(V,H+" in "+W,"invalid primitive, must be one of "+Object.keys(Sn))}),V.def(W,"[",H,"]")})}else if(S)return Kr(S)?S.value?gt(function(D,V){return V.def(D.ELEMENTS,".primType")}):gt(function(){return Df}):new Wt(S.thisDep,S.contextDep,S.propDep,function(D,V){var W=D.ELEMENTS;return V.def(W,"?",W,".primType:",Df)});return null}function R(v,x){if(v in T){var D=T[v]|0;return _.command(!x||D>=0,"invalid "+v,l.commandStr),gt(function(W,H){return x&&(W.OFFSET=D),D})}else if(v in N){var V=N[v];return Jt(V,function(W,H){var ne=W.invoke(H,V);return x&&(W.OFFSET=ne,_.optional(function(){W.assert(H,ne+">=0","invalid "+v)})),ne})}else if(x&&S)return gt(function(W,H){return W.OFFSET="0",0});return null}var E=R(aa,!0);function A(){if(hn in T){var v=T[hn]|0;return _.command(typeof v=="number"&&v>=0,"invalid vertex count",l.commandStr),gt(function(){return v})}else if(hn in N){var x=N[hn];return Jt(x,function(W,H){var ne=W.invoke(H,x);return _.optional(function(){W.assert(H,"typeof "+ne+'==="number"&&'+ne+">=0&&"+ne+"===("+ne+"|0)","invalid vertex count")}),ne})}else if(S)if(Kr(S)){if(S)return E?new Wt(E.thisDep,E.contextDep,E.propDep,function(W,H){var ne=H.def(W.ELEMENTS,".vertCount-",W.OFFSET);return _.optional(function(){W.assert(H,ne+">=0","invalid vertex offset/element buffer too small")}),ne}):gt(function(W,H){return H.def(W.ELEMENTS,".vertCount")});var D=gt(function(){return-1});return _.optional(function(){D.MISSING=!0}),D}else{var V=new Wt(S.thisDep||E.thisDep,S.contextDep||E.contextDep,S.propDep||E.propDep,function(W,H){var ne=W.ELEMENTS;return W.OFFSET?H.def(ne,"?",ne,".vertCount-",W.OFFSET,":-1"):H.def(ne,"?",ne,".vertCount:-1")});return _.optional(function(){V.DYNAMIC=!0}),V}return null}return{elements:S,primitive:w(),count:A(),instances:R(oa,!1),offset:E}}function At(m,l){var T=m.static,N=m.dynamic,I={};return Z.forEach(function(S){var w=pe(S);function R(E,A){if(S in T){var v=E(T[S]);I[w]=gt(function(){return v})}else if(S in N){var x=N[S];I[w]=Jt(x,function(D,V){return A(D,V,D.invoke(V,x))})}}switch(S){case gf:case vf:case pf:case Rf:case mf:case xf:case Tf:case wf:case Sf:case bf:return R(function(E){return _.commandType(E,"boolean",S,l.commandStr),E},function(E,A,v){return _.optional(function(){E.assert(A,"typeof "+v+'==="boolean"',"invalid flag "+S,E.commandStr)}),v});case Ef:return R(function(E){return _.commandParameter(E,Bn,"invalid "+S,l.commandStr),Bn[E]},function(E,A,v){var x=E.constants.compareFuncs;return _.optional(function(){E.assert(A,v+" in "+x,"invalid "+S+", must be one of "+Object.keys(Bn))}),A.def(x,"[",v,"]")});case _f:return R(function(E){return _.command(yt(E)&&E.length===2&&typeof E[0]=="number"&&typeof E[1]=="number"&&E[0]<=E[1],"depth range is 2d array",l.commandStr),E},function(E,A,v){_.optional(function(){E.assert(A,E.shared.isArrayLike+"("+v+")&&"+v+".length===2&&typeof "+v+'[0]==="number"&&typeof '+v+'[1]==="number"&&'+v+"[0]<="+v+"[1]","depth range must be a 2d array")});var x=A.def("+",v,"[0]"),D=A.def("+",v,"[1]");return[x,D]});case No:return R(function(E){_.commandType(E,"object","blend.func",l.commandStr);var A="srcRGB"in E?E.srcRGB:E.src,v="srcAlpha"in E?E.srcAlpha:E.src,x="dstRGB"in E?E.dstRGB:E.dst,D="dstAlpha"in E?E.dstAlpha:E.dst;return _.commandParameter(A,Tr,w+".srcRGB",l.commandStr),_.commandParameter(v,Tr,w+".srcAlpha",l.commandStr),_.commandParameter(x,Tr,w+".dstRGB",l.commandStr),_.commandParameter(D,Tr,w+".dstAlpha",l.commandStr),_.command(kf.indexOf(A+", "+x)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+A+", "+x+")",l.commandStr),[Tr[A],Tr[x],Tr[v],Tr[D]]},function(E,A,v){var x=E.constants.blendFuncs;_.optional(function(){E.assert(A,v+"&&typeof "+v+'==="object"',"invalid blend func, must be an object")});function D(Re,De){var je=A.def('"',Re,De,'" in ',v,"?",v,".",Re,De,":",v,".",Re);return _.optional(function(){E.assert(A,je+" in "+x,"invalid "+S+"."+Re+De+", must be one of "+Object.keys(Tr))}),je}var V=D("src","RGB"),W=D("dst","RGB");_.optional(function(){var Re=E.constants.invalidBlendCombinations;E.assert(A,Re+".indexOf("+V+'+", "+'+W+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var H=A.def(x,"[",V,"]"),ne=A.def(x,"[",D("src","Alpha"),"]"),xe=A.def(x,"[",W,"]"),Xe=A.def(x,"[",D("dst","Alpha"),"]");return[H,xe,ne,Xe]});case xo:return R(function(E){if(typeof E=="string")return _.commandParameter(E,$,"invalid "+S,l.commandStr),[$[E],$[E]];if(typeof E=="object")return _.commandParameter(E.rgb,$,S+".rgb",l.commandStr),_.commandParameter(E.alpha,$,S+".alpha",l.commandStr),[$[E.rgb],$[E.alpha]];_.commandRaise("invalid blend.equation",l.commandStr)},function(E,A,v){var x=E.constants.blendEquations,D=A.def(),V=A.def(),W=E.cond("typeof ",v,'==="string"');return _.optional(function(){function H(ne,xe,Xe){E.assert(ne,Xe+" in "+x,"invalid "+xe+", must be one of "+Object.keys($))}H(W.then,S,v),E.assert(W.else,v+"&&typeof "+v+'==="object"',"invalid "+S),H(W.else,S+".rgb",v+".rgb"),H(W.else,S+".alpha",v+".alpha")}),W.then(D,"=",V,"=",x,"[",v,"];"),W.else(D,"=",x,"[",v,".rgb];",V,"=",x,"[",v,".alpha];"),A(W),[D,V]});case yf:return R(function(E){return _.command(yt(E)&&E.length===4,"blend.color must be a 4d array",l.commandStr),Zt(4,function(A){return+E[A]})},function(E,A,v){return _.optional(function(){E.assert(A,E.shared.isArrayLike+"("+v+")&&"+v+".length===4","blend.color must be a 4d array")}),Zt(4,function(x){return A.def("+",v,"[",x,"]")})});case Lf:return R(function(E){return _.commandType(E,"number",w,l.commandStr),E|0},function(E,A,v){return _.optional(function(){E.assert(A,"typeof "+v+'==="number"',"invalid stencil.mask")}),A.def(v,"|0")});case Fo:return R(function(E){_.commandType(E,"object",w,l.commandStr);var A=E.cmp||"keep",v=E.ref||0,x="mask"in E?E.mask:-1;return _.commandParameter(A,Bn,S+".cmp",l.commandStr),_.commandType(v,"number",S+".ref",l.commandStr),_.commandType(x,"number",S+".mask",l.commandStr),[Bn[A],v,x]},function(E,A,v){var x=E.constants.compareFuncs;_.optional(function(){function H(){E.assert(A,Array.prototype.join.call(arguments,""),"invalid stencil.func")}H(v+"&&typeof ",v,'==="object"'),H('!("cmp" in ',v,")||(",v,".cmp in ",x,")")});var D=A.def('"cmp" in ',v,"?",x,"[",v,".cmp]",":",zr),V=A.def(v,".ref|0"),W=A.def('"mask" in ',v,"?",v,".mask|0:-1");return[D,V,W]});case Uo:case hi:return R(function(E){_.commandType(E,"object",w,l.commandStr);var A=E.fail||"keep",v=E.zfail||"keep",x=E.zpass||"keep";return _.commandParameter(A,Yr,S+".fail",l.commandStr),_.commandParameter(v,Yr,S+".zfail",l.commandStr),_.commandParameter(x,Yr,S+".zpass",l.commandStr),[S===hi?ln:Ai,Yr[A],Yr[v],Yr[x]]},function(E,A,v){var x=E.constants.stencilOps;_.optional(function(){E.assert(A,v+"&&typeof "+v+'==="object"',"invalid "+S)});function D(V){return _.optional(function(){E.assert(A,'!("'+V+'" in '+v+")||("+v+"."+V+" in "+x+")","invalid "+S+"."+V+", must be one of "+Object.keys(Yr))}),A.def('"',V,'" in ',v,"?",x,"[",v,".",V,"]:",zr)}return[S===hi?ln:Ai,D("fail"),D("zfail"),D("zpass")]});case Do:return R(function(E){_.commandType(E,"object",w,l.commandStr);var A=E.factor|0,v=E.units|0;return _.commandType(A,"number",w+".factor",l.commandStr),_.commandType(v,"number",w+".units",l.commandStr),[A,v]},function(E,A,v){_.optional(function(){E.assert(A,v+"&&typeof "+v+'==="object"',"invalid "+S)});var x=A.def(v,".factor|0"),D=A.def(v,".units|0");return[x,D]});case Af:return R(function(E){var A=0;return E==="front"?A=Ai:E==="back"&&(A=ln),_.command(!!A,w,l.commandStr),A},function(E,A,v){return _.optional(function(){E.assert(A,v+'==="front"||'+v+'==="back"',"invalid cull.face")}),A.def(v,'==="front"?',Ai,":",ln)});case Co:return R(function(E){return _.command(typeof E=="number"&&E>=M.lineWidthDims[0]&&E<=M.lineWidthDims[1],"invalid line width, must be a positive number between "+M.lineWidthDims[0]+" and "+M.lineWidthDims[1],l.commandStr),E},function(E,A,v){return _.optional(function(){E.assert(A,"typeof "+v+'==="number"&&'+v+">="+M.lineWidthDims[0]+"&&"+v+"<="+M.lineWidthDims[1],"invalid line width")}),v});case Io:return R(function(E){return _.commandParameter(E,Ho,w,l.commandStr),Ho[E]},function(E,A,v){return _.optional(function(){E.assert(A,v+'==="cw"||'+v+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),A.def(v+'==="cw"?'+Gf+":"+$o)});case Oo:return R(function(E){return _.command(yt(E)&&E.length===4,"color.mask must be length 4 array",l.commandStr),E.map(function(A){return!!A})},function(E,A,v){return _.optional(function(){E.assert(A,E.shared.isArrayLike+"("+v+")&&"+v+".length===4","invalid color.mask")}),Zt(4,function(x){return"!!"+v+"["+x+"]"})});case Go:return R(function(E){_.command(typeof E=="object"&&E,w,l.commandStr);var A="value"in E?E.value:1,v=!!E.invert;return _.command(typeof A=="number"&&A>=0&&A<=1,"sample.coverage.value must be a number between 0 and 1",l.commandStr),[A,v]},function(E,A,v){_.optional(function(){E.assert(A,v+"&&typeof "+v+'==="object"',"invalid sample.coverage")});var x=A.def('"value" in ',v,"?+",v,".value:1"),D=A.def("!!",v,".invert");return[x,D]})}}),I}function It(m,l){var T=m.static,N=m.dynamic,I={};return Object.keys(T).forEach(function(S){var w=T[S],R;if(typeof w=="number"||typeof w=="boolean")R=gt(function(){return w});else if(typeof w=="function"){var E=w._reglType;E==="texture2d"||E==="textureCube"?R=gt(function(A){return A.link(w)}):E==="framebuffer"||E==="framebufferCube"?(_.command(w.color.length>0,'missing color attachment for framebuffer sent to uniform "'+S+'"',l.commandStr),R=gt(function(A){return A.link(w.color[0])})):_.commandRaise('invalid data for uniform "'+S+'"',l.commandStr)}else yt(w)?R=gt(function(A){var v=A.global.def("[",Zt(w.length,function(x){return _.command(typeof w[x]=="number"||typeof w[x]=="boolean","invalid uniform "+S,A.commandStr),w[x]}),"]");return v}):_.commandRaise('invalid or missing data for uniform "'+S+'"',l.commandStr);R.value=w,I[S]=R}),Object.keys(N).forEach(function(S){var w=N[S];I[S]=Jt(w,function(R,E){return R.invoke(E,w)})}),I}function qe(m,l){var T=m.static,N=m.dynamic,I={};return Object.keys(T).forEach(function(S){var w=T[S],R=p.id(S),E=new O;if(ya(w))E.state=Un,E.buffer=X.getBuffer(X.create(w,kn,!1,!0)),E.type=0;else{var A=X.getBuffer(w);if(A)E.state=Un,E.buffer=A,E.type=0;else if(_.command(typeof w=="object"&&w,"invalid data for attribute "+S,l.commandStr),"constant"in w){var v=w.constant;E.buffer="null",E.state=To,typeof v=="number"?E.x=v:(_.command(yt(v)&&v.length>0&&v.length<=4,"invalid constant for attribute "+S,l.commandStr),Fn.forEach(function(xe,Xe){Xe<v.length&&(E[xe]=v[Xe])}))}else{ya(w.buffer)?A=X.getBuffer(X.create(w.buffer,kn,!1,!0)):A=X.getBuffer(w.buffer),_.command(!!A,'missing buffer for attribute "'+S+'"',l.commandStr);var x=w.offset|0;_.command(x>=0,'invalid offset for attribute "'+S+'"',l.commandStr);var D=w.stride|0;_.command(D>=0&&D<256,'invalid stride for attribute "'+S+'", must be integer betweeen [0, 255]',l.commandStr);var V=w.size|0;_.command(!("size"in w)||V>0&&V<=4,'invalid size for attribute "'+S+'", must be 1,2,3,4',l.commandStr);var W=!!w.normalized,H=0;"type"in w&&(_.commandParameter(w.type,nn,"invalid type for attribute "+S,l.commandStr),H=nn[w.type]);var ne=w.divisor|0;"divisor"in w&&(_.command(ne===0||ie,'cannot specify divisor for attribute "'+S+'", instancing not supported',l.commandStr),_.command(ne>=0,'invalid divisor for attribute "'+S+'"',l.commandStr)),_.optional(function(){var xe=l.commandStr,Xe=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(w).forEach(function(Re){_.command(Xe.indexOf(Re)>=0,'unknown parameter "'+Re+'" for attribute pointer "'+S+'" (valid parameters are '+Xe+")",xe)})}),E.buffer=A,E.state=Un,E.size=V,E.normalized=W,E.type=H||A.dtype,E.offset=x,E.stride=D,E.divisor=ne}}I[S]=gt(function(xe,Xe){var Re=xe.attribCache;if(R in Re)return Re[R];var De={isStream:!1};return Object.keys(E).forEach(function(je){De[je]=E[je]}),E.buffer&&(De.buffer=xe.link(E.buffer),De.type=De.type||De.buffer+".dtype"),Re[R]=De,De})}),Object.keys(N).forEach(function(S){var w=N[S];function R(E,A){var v=E.invoke(A,w),x=E.shared,D=E.constants,V=x.isBufferArgs,W=x.buffer;_.optional(function(){E.assert(A,v+"&&(typeof "+v+'==="object"||typeof '+v+'==="function")&&('+V+"("+v+")||"+W+".getBuffer("+v+")||"+W+".getBuffer("+v+".buffer)||"+V+"("+v+'.buffer)||("constant" in '+v+"&&(typeof "+v+'.constant==="number"||'+x.isArrayLike+"("+v+".constant))))",'invalid dynamic attribute "'+S+'"')});var H={isStream:A.def(!1)},ne=new O;ne.state=Un,Object.keys(ne).forEach(function(De){H[De]=A.def(""+ne[De])});var xe=H.buffer,Xe=H.type;A("if(",V,"(",v,")){",H.isStream,"=true;",xe,"=",W,".createStream(",kn,",",v,");",Xe,"=",xe,".dtype;","}else{",xe,"=",W,".getBuffer(",v,");","if(",xe,"){",Xe,"=",xe,".dtype;",'}else if("constant" in ',v,"){",H.state,"=",To,";","if(typeof "+v+'.constant === "number"){',H[Fn[0]],"=",v,".constant;",Fn.slice(1).map(function(De){return H[De]}).join("="),"=0;","}else{",Fn.map(function(De,je){return H[De]+"="+v+".constant.length>"+je+"?"+v+".constant["+je+"]:0;"}).join(""),"}}else{","if(",V,"(",v,".buffer)){",xe,"=",W,".createStream(",kn,",",v,".buffer);","}else{",xe,"=",W,".getBuffer(",v,".buffer);","}",Xe,'="type" in ',v,"?",D.glTypes,"[",v,".type]:",xe,".dtype;",H.normalized,"=!!",v,".normalized;");function Re(De){A(H[De],"=",v,".",De,"|0;")}return Re("size"),Re("offset"),Re("stride"),Re("divisor"),A("}}"),A.exit("if(",H.isStream,"){",W,".destroyStream(",xe,");","}"),H}I[S]=Jt(w,R)}),I}function xt(m,l){var T=m.static,N=m.dynamic;if(yi in T){var I=T[yi];return I!==null&&ae.getVAO(I)===null&&(I=ae.createVAO(I)),gt(function(w){return w.link(ae.getVAO(I))})}else if(yi in N){var S=N[yi];return Jt(S,function(w,R){var E=w.invoke(R,S);return R.def(w.shared.vao+".getVAO("+E+")")})}return null}function ft(m){var l=m.static,T=m.dynamic,N={};return Object.keys(l).forEach(function(I){var S=l[I];N[I]=gt(function(w,R){return typeof S=="number"||typeof S=="boolean"?""+S:w.link(S)})}),Object.keys(T).forEach(function(I){var S=T[I];N[I]=Jt(S,function(w,R){return w.invoke(R,S)})}),N}function Tt(m,l,T,N,I){var S=m.static,w=m.dynamic;_.optional(function(){var Re=[fn,pi,vi,cn,dn,aa,hn,oa,li,yi].concat(Z);function De(je){Object.keys(je).forEach(function(et){_.command(Re.indexOf(et)>=0,'unknown parameter "'+et+'"',I.commandStr)})}De(S),De(w)});var R=Be(m,l),E=Se(m),A=ze(m,E,I),v=Je(m,I),x=At(m,I),D=We(m,I,R);function V(Re){var De=A[Re];De&&(x[Re]=De)}V(Fr),V(pe(ia));var W=Object.keys(x).length>0,H={framebuffer:E,draw:v,shader:D,state:x,dirty:W,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(H.profile=He(m),H.uniforms=It(T,I),H.drawVAO=H.scopeVAO=xt(m),!H.drawVAO&&D.program&&!R&&g.angle_instanced_arrays){var ne=!0,xe=D.program.attributes.map(function(Re){var De=l.static[Re];return ne=ne&&!!De,De});if(ne&&xe.length>0){var Xe=ae.getVAO(ae.createVAO(xe));H.drawVAO=new Wt(null,null,null,function(Re,De){return Re.link(Xe)}),H.useVAO=!0}}return R?H.useVAO=!0:H.attributes=qe(l,I),H.context=ft(N),H}function Nt(m,l,T){var N=m.shared,I=N.context,S=m.scope();Object.keys(T).forEach(function(w){l.save(I,"."+w);var R=T[w],E=R.append(m,l);Array.isArray(E)?S(I,".",w,"=[",E.join(),"];"):S(I,".",w,"=",E,";")}),l(S)}function Ot(m,l,T,N){var I=m.shared,S=I.gl,w=I.framebuffer,R;me&&(R=l.def(I.extensions,".webgl_draw_buffers"));var E=m.constants,A=E.drawBuffer,v=E.backBuffer,x;T?x=T.append(m,l):x=l.def(w,".next"),N||l("if(",x,"!==",w,".cur){"),l("if(",x,"){",S,".bindFramebuffer(",Pf,",",x,".framebuffer);"),me&&l(R,".drawBuffersWEBGL(",A,"[",x,".colorAttachments.length]);"),l("}else{",S,".bindFramebuffer(",Pf,",null);"),me&&l(R,".drawBuffersWEBGL(",v,");"),l("}",w,".cur=",x,";"),N||l("}")}function Gt(m,l,T){var N=m.shared,I=N.gl,S=m.current,w=m.next,R=N.current,E=N.next,A=m.cond(R,".dirty");Z.forEach(function(v){var x=pe(v);if(!(x in T.state)){var D,V;if(x in w){D=w[x],V=S[x];var W=Zt(Y[x].length,function(ne){return A.def(D,"[",ne,"]")});A(m.cond(W.map(function(ne,xe){return ne+"!=="+V+"["+xe+"]"}).join("||")).then(I,".",Q[x],"(",W,");",W.map(function(ne,xe){return V+"["+xe+"]="+ne}).join(";"),";"))}else{D=A.def(E,".",x);var H=m.cond(D,"!==",R,".",x);A(H),x in le?H(m.cond(D).then(I,".enable(",le[x],");").else(I,".disable(",le[x],");"),R,".",x,"=",D,";"):H(I,".",Q[x],"(",D,");",R,".",x,"=",D,";")}}}),Object.keys(T.state).length===0&&A(R,".dirty=false;"),l(A)}function Bt(m,l,T,N){var I=m.shared,S=m.current,w=I.current,R=I.gl;jf(Object.keys(T)).forEach(function(E){var A=T[E];if(!(N&&!N(A))){var v=A.append(m,l);if(le[E]){var x=le[E];Kr(A)?v?l(R,".enable(",x,");"):l(R,".disable(",x,");"):l(m.cond(v).then(R,".enable(",x,");").else(R,".disable(",x,");")),l(w,".",E,"=",v,";")}else if(yt(v)){var D=S[E];l(R,".",Q[E],"(",v,");",v.map(function(V,W){return D+"["+W+"]="+V}).join(";"),";")}else l(R,".",Q[E],"(",v,");",w,".",E,"=",v,";")}})}function mt(m,l){ie&&(m.instancing=l.def(m.shared.extensions,".angle_instanced_arrays"))}function Ve(m,l,T,N,I){var S=m.shared,w=m.stats,R=S.current,E=S.timer,A=T.profile;function v(){return typeof performance>"u"?"Date.now()":"performance.now()"}var x,D;function V(Re){x=l.def(),Re(x,"=",v(),";"),typeof I=="string"?Re(w,".count+=",I,";"):Re(w,".count++;"),ee&&(N?(D=l.def(),Re(D,"=",E,".getNumPendingQueries();")):Re(E,".beginQuery(",w,");"))}function W(Re){Re(w,".cpuTime+=",v(),"-",x,";"),ee&&(N?Re(E,".pushScopeStats(",D,",",E,".getNumPendingQueries(),",w,");"):Re(E,".endQuery();"))}function H(Re){var De=l.def(R,".profile");l(R,".profile=",Re,";"),l.exit(R,".profile=",De,";")}var ne;if(A){if(Kr(A)){A.enable?(V(l),W(l.exit),H("true")):H("false");return}ne=A.append(m,l),H(ne)}else ne=l.def(R,".profile");var xe=m.block();V(xe),l("if(",ne,"){",xe,"}");var Xe=m.block();W(Xe),l.exit("if(",ne,"){",Xe,"}")}function jt(m,l,T,N,I){var S=m.shared;function w(E){switch(E){case sa:case ca:case la:return 2;case ua:case da:case pa:return 3;case fa:case ha:case va:return 4;default:return 1}}function R(E,A,v){var x=S.gl,D=l.def(E,".location"),V=l.def(S.attributes,"[",D,"]"),W=v.state,H=v.buffer,ne=[v.x,v.y,v.z,v.w],xe=["buffer","normalized","offset","stride"];function Xe(){l("if(!",V,".buffer){",x,".enableVertexAttribArray(",D,");}");var De=v.type,je;if(v.size?je=l.def(v.size,"||",A):je=A,l("if(",V,".type!==",De,"||",V,".size!==",je,"||",xe.map(function(pt){return V+"."+pt+"!=="+v[pt]}).join("||"),"){",x,".bindBuffer(",kn,",",H,".buffer);",x,".vertexAttribPointer(",[D,je,De,v.normalized,v.stride,v.offset],");",V,".type=",De,";",V,".size=",je,";",xe.map(function(pt){return V+"."+pt+"="+v[pt]+";"}).join(""),"}"),ie){var et=v.divisor;l("if(",V,".divisor!==",et,"){",m.instancing,".vertexAttribDivisorANGLE(",[D,et],");",V,".divisor=",et,";}")}}function Re(){l("if(",V,".buffer){",x,".disableVertexAttribArray(",D,");",V,".buffer=null;","}if(",Fn.map(function(De,je){return V+"."+De+"!=="+ne[je]}).join("||"),"){",x,".vertexAttrib4f(",D,",",ne,");",Fn.map(function(De,je){return V+"."+De+"="+ne[je]+";"}).join(""),"}")}W===Un?Xe():W===To?Re():(l("if(",W,"===",Un,"){"),Xe(),l("}else{"),Re(),l("}"))}N.forEach(function(E){var A=E.name,v=T.attributes[A],x;if(v){if(!I(v))return;x=v.append(m,l)}else{if(!I($f))return;var D=m.scopeAttrib(A);_.optional(function(){m.assert(l,D+".state","missing attribute "+A)}),x={},Object.keys(new O).forEach(function(V){x[V]=l.def(D,".",V)})}R(m.link(E),w(E.info.type),x)})}function rt(m,l,T,N,I){for(var S=m.shared,w=S.gl,R,E=0;E<N.length;++E){var A=N[E],v=A.name,x=A.info.type,D=T.uniforms[v],V=m.link(A),W=V+".location",H;if(D){if(!I(D))continue;if(Kr(D)){var ne=D.value;if(_.command(ne!==null&&typeof ne<"u",'missing uniform "'+v+'"',m.commandStr),x===bi||x===gi){_.command(typeof ne=="function"&&(x===bi&&(ne._reglType==="texture2d"||ne._reglType==="framebuffer")||x===gi&&(ne._reglType==="textureCube"||ne._reglType==="framebufferCube")),"invalid texture for uniform "+v,m.commandStr);var xe=m.link(ne._texture||ne.color[0]._texture);l(w,".uniform1i(",W,",",xe+".bind());"),l.exit(xe,".unbind();")}else if(x===mi||x===Ei||x===_i){_.optional(function(){_.command(yt(ne),"invalid matrix for uniform "+v,m.commandStr),_.command(x===mi&&ne.length===4||x===Ei&&ne.length===9||x===_i&&ne.length===16,"invalid length for matrix uniform "+v,m.commandStr)});var Xe=m.global.def("new Float32Array(["+Array.prototype.slice.call(ne)+"])"),Re=2;x===Ei?Re=3:x===_i&&(Re=4),l(w,".uniformMatrix",Re,"fv(",W,",false,",Xe,");")}else{switch(x){case ko:_.commandType(ne,"number","uniform "+v,m.commandStr),R="1f";break;case sa:_.command(yt(ne)&&ne.length===2,"uniform "+v,m.commandStr),R="2f";break;case ua:_.command(yt(ne)&&ne.length===3,"uniform "+v,m.commandStr),R="3f";break;case fa:_.command(yt(ne)&&ne.length===4,"uniform "+v,m.commandStr),R="4f";break;case jo:_.commandType(ne,"boolean","uniform "+v,m.commandStr),R="1i";break;case Bo:_.commandType(ne,"number","uniform "+v,m.commandStr),R="1i";break;case la:_.command(yt(ne)&&ne.length===2,"uniform "+v,m.commandStr),R="2i";break;case ca:_.command(yt(ne)&&ne.length===2,"uniform "+v,m.commandStr),R="2i";break;case pa:_.command(yt(ne)&&ne.length===3,"uniform "+v,m.commandStr),R="3i";break;case da:_.command(yt(ne)&&ne.length===3,"uniform "+v,m.commandStr),R="3i";break;case va:_.command(yt(ne)&&ne.length===4,"uniform "+v,m.commandStr),R="4i";break;case ha:_.command(yt(ne)&&ne.length===4,"uniform "+v,m.commandStr),R="4i";break}l(w,".uniform",R,"(",W,",",yt(ne)?Array.prototype.slice.call(ne):ne,");")}continue}else H=D.append(m,l)}else{if(!I($f))continue;H=l.def(S.uniforms,"[",p.id(v),"]")}x===bi?(_(!Array.isArray(H),"must specify a scalar prop for textures"),l("if(",H,"&&",H,'._reglType==="framebuffer"){',H,"=",H,".color[0];","}")):x===gi&&(_(!Array.isArray(H),"must specify a scalar prop for cube maps"),l("if(",H,"&&",H,'._reglType==="framebufferCube"){',H,"=",H,".color[0];","}")),_.optional(function(){function zt(yr,Kf){m.assert(l,yr,'bad data or missing for uniform "'+v+'".  '+Kf)}function Vo(yr){_(!Array.isArray(H),"must not specify an array type for uniform"),zt("typeof "+H+'==="'+yr+'"',"invalid type, expected "+yr)}function sr(yr,Kf){Array.isArray(H)?_(H.length===yr,"must have length "+yr):zt(S.isArrayLike+"("+H+")&&"+H+".length==="+yr,"invalid vector, should have length "+yr,m.commandStr)}function Yf(yr){_(!Array.isArray(H),"must not specify a value type"),zt("typeof "+H+'==="function"&&'+H+'._reglType==="texture'+(yr===Cf?"2d":"Cube")+'"',"invalid texture type",m.commandStr)}switch(x){case Bo:Vo("number");break;case ca:sr(2);break;case da:sr(3);break;case ha:sr(4);break;case ko:Vo("number");break;case sa:sr(2);break;case ua:sr(3);break;case fa:sr(4);break;case jo:Vo("boolean");break;case la:sr(2);break;case pa:sr(3);break;case va:sr(4);break;case mi:sr(4);break;case Ei:sr(9);break;case _i:sr(16);break;case bi:Yf(Cf);break;case gi:Yf(Uv);break}});var De=1;switch(x){case bi:case gi:var je=l.def(H,"._texture");l(w,".uniform1i(",W,",",je,".bind());"),l.exit(je,".unbind();");continue;case Bo:case jo:R="1i";break;case ca:case la:R="2i",De=2;break;case da:case pa:R="3i",De=3;break;case ha:case va:R="4i",De=4;break;case ko:R="1f";break;case sa:R="2f",De=2;break;case ua:R="3f",De=3;break;case fa:R="4f",De=4;break;case mi:R="Matrix2fv";break;case Ei:R="Matrix3fv";break;case _i:R="Matrix4fv";break}if(l(w,".uniform",R,"(",W,","),R.charAt(0)==="M"){var et=Math.pow(x-mi+2,2),pt=m.global.def("new Float32Array(",et,")");Array.isArray(H)?l("false,(",Zt(et,function(zt){return pt+"["+zt+"]="+H[zt]}),",",pt,")"):l("false,(Array.isArray(",H,")||",H," instanceof Float32Array)?",H,":(",Zt(et,function(zt){return pt+"["+zt+"]="+H+"["+zt+"]"}),",",pt,")")}else De>1?l(Zt(De,function(zt){return Array.isArray(H)?H[zt]:H+"["+zt+"]"})):(_(!Array.isArray(H),"uniform value must not be an array"),l(H));l(");")}}function Ce(m,l,T,N){var I=m.shared,S=I.gl,w=I.draw,R=N.draw;function E(){var je=R.elements,et,pt=l;return je?((je.contextDep&&N.contextDynamic||je.propDep)&&(pt=T),et=je.append(m,pt)):et=pt.def(w,".",cn),et&&pt("if("+et+")"+S+".bindBuffer("+Dv+","+et+".buffer.buffer);"),et}function A(){var je=R.count,et,pt=l;return je?((je.contextDep&&N.contextDynamic||je.propDep)&&(pt=T),et=je.append(m,pt),_.optional(function(){je.MISSING&&m.assert(l,"false","missing vertex count"),je.DYNAMIC&&m.assert(pt,et+">=0","missing vertex count")})):(et=pt.def(w,".",hn),_.optional(function(){m.assert(pt,et+">=0","missing vertex count")})),et}var v=E();function x(je){var et=R[je];return et?et.contextDep&&N.contextDynamic||et.propDep?et.append(m,T):et.append(m,l):l.def(w,".",je)}var D=x(dn),V=x(aa),W=A();if(typeof W=="number"){if(W===0)return}else T("if(",W,"){"),T.exit("}");var H,ne;ie&&(H=x(oa),ne=m.instancing);var xe=v+".type",Xe=R.elements&&Kr(R.elements);function Re(){function je(){T(ne,".drawElementsInstancedANGLE(",[D,W,xe,V+"<<(("+xe+"-"+df+")>>1)",H],");")}function et(){T(ne,".drawArraysInstancedANGLE(",[D,V,W,H],");")}v?Xe?je():(T("if(",v,"){"),je(),T("}else{"),et(),T("}")):et()}function De(){function je(){T(S+".drawElements("+[D,W,xe,V+"<<(("+xe+"-"+df+")>>1)"]+");")}function et(){T(S+".drawArrays("+[D,V,W]+");")}v?Xe?je():(T("if(",v,"){"),je(),T("}else{"),et(),T("}")):et()}ie&&(typeof H!="number"||H>=0)?typeof H=="string"?(T("if(",H,">0){"),Re(),T("}else if(",H,"<0){"),De(),T("}")):Re():De()}function Ke(m,l,T,N,I){var S=Ue(),w=S.proc("body",I);return _.optional(function(){S.commandStr=l.commandStr,S.command=S.link(l.commandStr)}),ie&&(S.instancing=w.def(S.shared.extensions,".angle_instanced_arrays")),m(S,w,T,N),S.compile().body}function Qe(m,l,T,N){mt(m,l),T.useVAO?T.drawVAO?l(m.shared.vao,".setVAO(",T.drawVAO.append(m,l),");"):l(m.shared.vao,".setVAO(",m.shared.vao,".targetVAO);"):(l(m.shared.vao,".setVAO(null);"),jt(m,l,T,N.attributes,function(){return!0})),rt(m,l,T,N.uniforms,function(){return!0}),Ce(m,l,l,T)}function Et(m,l){var T=m.proc("draw",1);mt(m,T),Nt(m,T,l.context),Ot(m,T,l.framebuffer),Gt(m,T,l),Bt(m,T,l.state),Ve(m,T,l,!1,!0);var N=l.shader.progVar.append(m,T);if(T(m.shared.gl,".useProgram(",N,".program);"),l.shader.program)Qe(m,T,l,l.shader.program);else{T(m.shared.vao,".setVAO(null);");var I=m.global.def("{}"),S=T.def(N,".id"),w=T.def(I,"[",S,"]");T(m.cond(w).then(w,".call(this,a0);").else(w,"=",I,"[",S,"]=",m.link(function(R){return Ke(Qe,m,l,R,1)}),"(",N,");",w,".call(this,a0);"))}Object.keys(l.state).length>0&&T(m.shared.current,".dirty=true;")}function wr(m,l,T,N){m.batchId="a1",mt(m,l);function I(){return!0}jt(m,l,T,N.attributes,I),rt(m,l,T,N.uniforms,I),Ce(m,l,l,T)}function pn(m,l,T,N){mt(m,l);var I=T.contextDep,S=l.def(),w="a0",R="a1",E=l.def();m.shared.props=E,m.batchId=S;var A=m.scope(),v=m.scope();l(A.entry,"for(",S,"=0;",S,"<",R,";++",S,"){",E,"=",w,"[",S,"];",v,"}",A.exit);function x(xe){return xe.contextDep&&I||xe.propDep}function D(xe){return!x(xe)}if(T.needsContext&&Nt(m,v,T.context),T.needsFramebuffer&&Ot(m,v,T.framebuffer),Bt(m,v,T.state,x),T.profile&&x(T.profile)&&Ve(m,v,T,!1,!0),N)T.useVAO?T.drawVAO?x(T.drawVAO)?v(m.shared.vao,".setVAO(",T.drawVAO.append(m,v),");"):A(m.shared.vao,".setVAO(",T.drawVAO.append(m,A),");"):A(m.shared.vao,".setVAO(",m.shared.vao,".targetVAO);"):(A(m.shared.vao,".setVAO(null);"),jt(m,A,T,N.attributes,D),jt(m,v,T,N.attributes,x)),rt(m,A,T,N.uniforms,D),rt(m,v,T,N.uniforms,x),Ce(m,A,v,T);else{var V=m.global.def("{}"),W=T.shader.progVar.append(m,v),H=v.def(W,".id"),ne=v.def(V,"[",H,"]");v(m.shared.gl,".useProgram(",W,".program);","if(!",ne,"){",ne,"=",V,"[",H,"]=",m.link(function(xe){return Ke(wr,m,T,xe,2)}),"(",W,");}",ne,".call(this,a0[",S,"],",S,");")}}function b(m,l){var T=m.proc("batch",2);m.batchId="0",mt(m,T);var N=!1,I=!0;Object.keys(l.context).forEach(function(V){N=N||l.context[V].propDep}),N||(Nt(m,T,l.context),I=!1);var S=l.framebuffer,w=!1;S?(S.propDep?N=w=!0:S.contextDep&&N&&(w=!0),w||Ot(m,T,S)):Ot(m,T,null),l.state.viewport&&l.state.viewport.propDep&&(N=!0);function R(V){return V.contextDep&&N||V.propDep}Gt(m,T,l),Bt(m,T,l.state,function(V){return!R(V)}),(!l.profile||!R(l.profile))&&Ve(m,T,l,!1,"a1"),l.contextDep=N,l.needsContext=I,l.needsFramebuffer=w;var E=l.shader.progVar;if(E.contextDep&&N||E.propDep)pn(m,T,l,null);else{var A=E.append(m,T);if(T(m.shared.gl,".useProgram(",A,".program);"),l.shader.program)pn(m,T,l,l.shader.program);else{T(m.shared.vao,".setVAO(null);");var v=m.global.def("{}"),x=T.def(A,".id"),D=T.def(v,"[",x,"]");T(m.cond(D).then(D,".call(this,a0,a1);").else(D,"=",v,"[",x,"]=",m.link(function(V){return Ke(pn,m,l,V,2)}),"(",A,");",D,".call(this,a0,a1);"))}}Object.keys(l.state).length>0&&T(m.shared.current,".dirty=true;")}function P(m,l){var T=m.proc("scope",3);m.batchId="a2";var N=m.shared,I=N.current;Nt(m,T,l.context),l.framebuffer&&l.framebuffer.append(m,T),jf(Object.keys(l.state)).forEach(function(w){var R=l.state[w],E=R.append(m,T);yt(E)?E.forEach(function(A,v){T.set(m.next[w],"["+v+"]",A)}):T.set(N.next,"."+w,E)}),Ve(m,T,l,!0,!0),[cn,aa,hn,oa,dn].forEach(function(w){var R=l.draw[w];!R||T.set(N.draw,"."+w,""+R.append(m,T))}),Object.keys(l.uniforms).forEach(function(w){var R=l.uniforms[w].append(m,T);Array.isArray(R)&&(R="["+R.join()+"]"),T.set(N.uniforms,"["+p.id(w)+"]",R)}),Object.keys(l.attributes).forEach(function(w){var R=l.attributes[w].append(m,T),E=m.scopeAttrib(w);Object.keys(new O).forEach(function(A){T.set(E,"."+A,R[A])})}),l.scopeVAO&&T.set(N.vao,".targetVAO",l.scopeVAO.append(m,T));function S(w){var R=l.shader[w];R&&T.set(N.shader,"."+w,R.append(m,T))}S(pi),S(vi),Object.keys(l.state).length>0&&(T(I,".dirty=true;"),T.exit(I,".dirty=true;")),T("a1(",m.shared.context,",a0,",m.batchId,");")}function G(m){if(!(typeof m!="object"||yt(m))){for(var l=Object.keys(m),T=0;T<l.length;++T)if(ir.isDynamic(m[l[T]]))return!0;return!1}}function Ae(m,l,T){var N=l.static[T];if(!N||!G(N))return;var I=m.global,S=Object.keys(N),w=!1,R=!1,E=!1,A=m.global.def("{}");S.forEach(function(x){var D=N[x];if(ir.isDynamic(D)){typeof D=="function"&&(D=N[x]=ir.unbox(D));var V=Jt(D,null);w=w||V.thisDep,E=E||V.propDep,R=R||V.contextDep}else{switch(I(A,".",x,"="),typeof D){case"number":I(D);break;case"string":I('"',D,'"');break;case"object":Array.isArray(D)&&I("[",D.join(),"]");break;default:I(m.link(D));break}I(";")}});function v(x,D){S.forEach(function(V){var W=N[V];if(!!ir.isDynamic(W)){var H=x.invoke(D,W);D(A,".",V,"=",H,";")}})}l.dynamic[T]=new ir.DynamicVariable(na,{thisDep:w,contextDep:R,propDep:E,ref:A,append:v}),delete l.static[T]}function Ye(m,l,T,N,I){var S=Ue();S.stats=S.link(I),Object.keys(l.static).forEach(function(R){Ae(S,l,R)}),Cv.forEach(function(R){Ae(S,m,R)});var w=Tt(m,l,T,N,S);return Et(S,w),P(S,w),b(S,w),n(S.compile(),{destroy:function(){w.shader.program.destroy()}})}return{next:be,current:Y,procs:function(){var m=Ue(),l=m.proc("poll"),T=m.proc("refresh"),N=m.block();l(N),T(N);var I=m.shared,S=I.gl,w=I.next,R=I.current;N(R,".dirty=false;"),Ot(m,l),Ot(m,T,null,!0);var E;ie&&(E=m.link(ie)),g.oes_vertex_array_object&&T(m.link(g.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var A=0;A<M.maxAttributes;++A){var v=T.def(I.attributes,"[",A,"]"),x=m.cond(v,".buffer");x.then(S,".enableVertexAttribArray(",A,");",S,".bindBuffer(",kn,",",v,".buffer.buffer);",S,".vertexAttribPointer(",A,",",v,".size,",v,".type,",v,".normalized,",v,".stride,",v,".offset);").else(S,".disableVertexAttribArray(",A,");",S,".vertexAttrib4f(",A,",",v,".x,",v,".y,",v,".z,",v,".w);",v,".buffer=null;"),T(x),ie&&T(E,".vertexAttribDivisorANGLE(",A,",",v,".divisor);")}return T(m.shared.vao,".currentVAO=null;",m.shared.vao,".setVAO(",m.shared.vao,".targetVAO);"),Object.keys(le).forEach(function(D){var V=le[D],W=N.def(w,".",D),H=m.block();H("if(",W,"){",S,".enable(",V,")}else{",S,".disable(",V,")}",R,".",D,"=",W,";"),T(H),l("if(",W,"!==",R,".",D,"){",H,"}")}),Object.keys(Q).forEach(function(D){var V=Q[D],W=Y[D],H,ne,xe=m.block();if(xe(S,".",V,"("),yt(W)){var Xe=W.length;H=m.global.def(w,".",D),ne=m.global.def(R,".",D),xe(Zt(Xe,function(Re){return H+"["+Re+"]"}),");",Zt(Xe,function(Re){return ne+"["+Re+"]="+H+"["+Re+"];"}).join("")),l("if(",Zt(Xe,function(Re){return H+"["+Re+"]!=="+ne+"["+Re+"]"}).join("||"),"){",xe,"}")}else H=N.def(w,".",D),ne=N.def(R,".",D),xe(H,");",R,".",D,"=",H,";"),l("if(",H,"!==",ne,"){",xe,"}");T(xe)}),m.compile()}(),compile:Ye}}function Zv(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Jv=34918,ey=34919,Hf=35007,ty=function(u,p){if(!p.ext_disjoint_timer_query)return null;var g=[];function M(){return g.pop()||p.ext_disjoint_timer_query.createQueryEXT()}function X(ie){g.push(ie)}var F=[];function j(ie){var me=M();p.ext_disjoint_timer_query.beginQueryEXT(Hf,me),F.push(me),ee(F.length-1,F.length,ie)}function J(){p.ext_disjoint_timer_query.endQueryEXT(Hf)}function te(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var ae=[];function re(){return ae.pop()||new te}function ue(ie){ae.push(ie)}var ve=[];function ee(ie,me,Y){var be=re();be.startQueryIndex=ie,be.endQueryIndex=me,be.sum=0,be.stats=Y,ve.push(be)}var ce=[],O=[];function $(){var ie,me,Y=F.length;if(Y!==0){O.length=Math.max(O.length,Y+1),ce.length=Math.max(ce.length,Y+1),ce[0]=0,O[0]=0;var be=0;for(ie=0,me=0;me<F.length;++me){var Z=F[me];p.ext_disjoint_timer_query.getQueryObjectEXT(Z,ey)?(be+=p.ext_disjoint_timer_query.getQueryObjectEXT(Z,Jv),X(Z)):F[ie++]=Z,ce[me+1]=be,O[me+1]=ie}for(F.length=ie,ie=0,me=0;me<ve.length;++me){var le=ve[me],Q=le.startQueryIndex,pe=le.endQueryIndex;le.sum+=ce[pe]-ce[Q];var Ie=O[Q],ke=O[pe];ke===Ie?(le.stats.gpuTime+=le.sum/1e6,ue(le)):(le.startQueryIndex=Ie,le.endQueryIndex=ke,ve[ie++]=le)}ve.length=ie}}return{beginQuery:j,endQuery:J,pushScopeStats:ee,update:$,getNumPendingQueries:function(){return F.length},clear:function(){g.push.apply(g,F);for(var ie=0;ie<g.length;ie++)p.ext_disjoint_timer_query.deleteQueryEXT(g[ie]);F.length=0,g.length=0},restore:function(){F.length=0,g.length=0}}},ry=16384,ny=256,iy=1024,ay=34962,Vf="webglcontextlost",Xf="webglcontextrestored",Wf=1,oy=2,sy=3;function zf(u,p){for(var g=0;g<u.length;++g)if(u[g]===p)return g;return-1}function uy(u){var p=al(u);if(!p)return null;var g=p.gl,M=g.getContextAttributes(),X=g.isContextLost(),F=ol(g,p);if(!F)return null;var j=el(),J=Zv(),te=F.extensions,ae=ty(g,te),re=eu(),ue=g.drawingBufferWidth,ve=g.drawingBufferHeight,ee={tick:0,time:0,viewportWidth:ue,viewportHeight:ve,framebufferWidth:ue,framebufferHeight:ve,drawingBufferWidth:ue,drawingBufferHeight:ve,pixelRatio:p.pixelRatio},ce={},O={elements:null,primitive:4,count:-1,offset:0,instances:-1},$=zl(g,te),ie=fp(g,J,p,Y),me=gv(g,te,$,J,ie);function Y(Ce){return me.destroyBuffer(Ce)}var be=gp(g,te,ie,J),Z=Sv(g,j,J,p),le=Zp(g,te,$,function(){Ie.procs.poll()},ee,J,p),Q=Jp(g,te,$,J,p),pe=_v(g,te,$,le,Q,J),Ie=Qv(g,j,te,$,ie,be,le,pe,ce,me,Z,O,ee,ae,p),ke=xv(g,pe,Ie.procs.poll,ee,M,te,$),ye=Ie.next,oe=g.canvas,z=[],Ue=[],He=[],Se=[p.onDestroy],ze=null;function Be(){if(z.length===0){ae&&ae.update(),ze=null;return}ze=Ya.next(Be),Bt();for(var Ce=z.length-1;Ce>=0;--Ce){var Ke=z[Ce];Ke&&Ke(ee,null,0)}g.flush(),ae&&ae.update()}function We(){!ze&&z.length>0&&(ze=Ya.next(Be))}function Je(){ze&&(Ya.cancel(Be),ze=null)}function At(Ce){Ce.preventDefault(),X=!0,Je(),Ue.forEach(function(Ke){Ke()})}function It(Ce){g.getError(),X=!1,F.restore(),Z.restore(),ie.restore(),le.restore(),Q.restore(),pe.restore(),me.restore(),ae&&ae.restore(),Ie.procs.refresh(),We(),He.forEach(function(Ke){Ke()})}oe&&(oe.addEventListener(Vf,At,!1),oe.addEventListener(Xf,It,!1));function qe(){z.length=0,Je(),oe&&(oe.removeEventListener(Vf,At),oe.removeEventListener(Xf,It)),Z.clear(),pe.clear(),Q.clear(),le.clear(),be.clear(),ie.clear(),me.clear(),ae&&ae.clear(),Se.forEach(function(Ce){Ce()})}function xt(Ce){_(!!Ce,"invalid args to regl({...})"),_.type(Ce,"object","invalid args to regl({...})");function Ke(I){var S=n({},I);delete S.uniforms,delete S.attributes,delete S.context,delete S.vao,"stencil"in S&&S.stencil.op&&(S.stencil.opBack=S.stencil.opFront=S.stencil.op,delete S.stencil.op);function w(R){if(R in S){var E=S[R];delete S[R],Object.keys(E).forEach(function(A){S[R+"."+A]=E[A]})}}return w("blend"),w("depth"),w("cull"),w("stencil"),w("polygonOffset"),w("scissor"),w("sample"),"vao"in I&&(S.vao=I.vao),S}function Qe(I,S){var w={},R={};return Object.keys(I).forEach(function(E){var A=I[E];if(ir.isDynamic(A)){R[E]=ir.unbox(A,E);return}else if(S&&Array.isArray(A)){for(var v=0;v<A.length;++v)if(ir.isDynamic(A[v])){R[E]=ir.unbox(A,E);return}}w[E]=A}),{dynamic:R,static:w}}var Et=Qe(Ce.context||{},!0),wr=Qe(Ce.uniforms||{},!0),pn=Qe(Ce.attributes||{},!1),b=Qe(Ke(Ce),!1),P={gpuTime:0,cpuTime:0,count:0},G=Ie.compile(b,pn,wr,Et,P),Ae=G.draw,Ye=G.batch,m=G.scope,l=[];function T(I){for(;l.length<I;)l.push(null);return l}function N(I,S){var w;if(X&&_.raise("context lost"),typeof I=="function")return m.call(this,null,I,0);if(typeof S=="function")if(typeof I=="number")for(w=0;w<I;++w)m.call(this,null,S,w);else if(Array.isArray(I))for(w=0;w<I.length;++w)m.call(this,I[w],S,w);else return m.call(this,I,S,0);else if(typeof I=="number"){if(I>0)return Ye.call(this,T(I|0),I|0)}else if(Array.isArray(I)){if(I.length)return Ye.call(this,I,I.length)}else return Ae.call(this,I)}return n(N,{stats:P,destroy:function(){G.destroy()}})}var ft=pe.setFBO=xt({framebuffer:ir.define.call(null,Wf,"framebuffer")});function Tt(Ce,Ke){var Qe=0;Ie.procs.poll();var Et=Ke.color;Et&&(g.clearColor(+Et[0]||0,+Et[1]||0,+Et[2]||0,+Et[3]||0),Qe|=ry),"depth"in Ke&&(g.clearDepth(+Ke.depth),Qe|=ny),"stencil"in Ke&&(g.clearStencil(Ke.stencil|0),Qe|=iy),_(!!Qe,"called regl.clear with no buffer specified"),g.clear(Qe)}function Nt(Ce){if(_(typeof Ce=="object"&&Ce,"regl.clear() takes an object as input"),"framebuffer"in Ce)if(Ce.framebuffer&&Ce.framebuffer_reglType==="framebufferCube")for(var Ke=0;Ke<6;++Ke)ft(n({framebuffer:Ce.framebuffer.faces[Ke]},Ce),Tt);else ft(Ce,Tt);else Tt(null,Ce)}function Ot(Ce){_.type(Ce,"function","regl.frame() callback must be a function"),z.push(Ce);function Ke(){var Qe=zf(z,Ce);_(Qe>=0,"cannot cancel a frame twice");function Et(){var wr=zf(z,Et);z[wr]=z[z.length-1],z.length-=1,z.length<=0&&Je()}z[Qe]=Et}return We(),{cancel:Ke}}function Gt(){var Ce=ye.viewport,Ke=ye.scissor_box;Ce[0]=Ce[1]=Ke[0]=Ke[1]=0,ee.viewportWidth=ee.framebufferWidth=ee.drawingBufferWidth=Ce[2]=Ke[2]=g.drawingBufferWidth,ee.viewportHeight=ee.framebufferHeight=ee.drawingBufferHeight=Ce[3]=Ke[3]=g.drawingBufferHeight}function Bt(){ee.tick+=1,ee.time=Ve(),Gt(),Ie.procs.poll()}function mt(){le.refresh(),Gt(),Ie.procs.refresh(),ae&&ae.update()}function Ve(){return(eu()-re)/1e3}mt();function jt(Ce,Ke){_.type(Ke,"function","listener callback must be a function");var Qe;switch(Ce){case"frame":return Ot(Ke);case"lost":Qe=Ue;break;case"restore":Qe=He;break;case"destroy":Qe=Se;break;default:_.raise("invalid event, must be one of frame,lost,restore,destroy")}return Qe.push(Ke),{cancel:function(){for(var Et=0;Et<Qe.length;++Et)if(Qe[Et]===Ke){Qe[Et]=Qe[Qe.length-1],Qe.pop();return}}}}var rt=n(xt,{clear:Nt,prop:ir.define.bind(null,Wf),context:ir.define.bind(null,oy),this:ir.define.bind(null,sy),draw:xt({}),buffer:function(Ce){return ie.create(Ce,ay,!1,!1)},elements:function(Ce){return be.create(Ce,!1)},texture:le.create2D,cube:le.createCube,renderbuffer:Q.create,framebuffer:pe.create,framebufferCube:pe.createCube,vao:me.createVAO,attributes:M,frame:Ot,on:jt,limits:$,hasExtension:function(Ce){return $.extensions.indexOf(Ce.toLowerCase())>=0},read:ke,destroy:qe,_gl:g,_refresh:mt,poll:function(){Bt(),ae&&ae.update()},now:Ve,stats:J});return p.onDone(null,rt),rt}return uy})})(V0);var Pr,Si,kr,fr,Ri,Qr,Li,_a,Lr,yn,Ht,xr,Nr,ba;Pr={},ge(Pr,_e.POINTS,"points"),ge(Pr,_e.LINES,"lines"),ge(Pr,_e.LINE_LOOP,"line loop"),ge(Pr,_e.LINE_STRIP,"line strip"),ge(Pr,_e.TRIANGLES,"triangles"),ge(Pr,_e.TRIANGLE_FAN,"triangle fan"),ge(Pr,_e.TRIANGLE_STRIP,"triangle strip");Si={},ge(Si,_e.STATIC_DRAW,"static"),ge(Si,_e.DYNAMIC_DRAW,"dynamic"),ge(Si,_e.STREAM_DRAW,"stream");kr={},ge(kr,_e.BYTE,"int8"),ge(kr,_e.UNSIGNED_INT,"int16"),ge(kr,_e.INT,"int32"),ge(kr,_e.UNSIGNED_BYTE,"uint8"),ge(kr,_e.UNSIGNED_SHORT,"uint16"),ge(kr,_e.UNSIGNED_INT,"uint32"),ge(kr,_e.FLOAT,"float");fr={},ge(fr,_e.ALPHA,"alpha"),ge(fr,_e.LUMINANCE,"luminance"),ge(fr,_e.LUMINANCE_ALPHA,"luminance alpha"),ge(fr,_e.RGB,"rgb"),ge(fr,_e.RGBA,"rgba"),ge(fr,_e.RGBA4,"rgba4"),ge(fr,_e.RGB5_A1,"rgb5 a1"),ge(fr,_e.RGB565,"rgb565"),ge(fr,_e.DEPTH_COMPONENT,"depth"),ge(fr,_e.DEPTH_STENCIL,"depth stencil");Ri={},ge(Ri,_e.DONT_CARE,"dont care"),ge(Ri,_e.NICEST,"nice"),ge(Ri,_e.FASTEST,"fast");Qr={},ge(Qr,_e.NEAREST,"nearest"),ge(Qr,_e.LINEAR,"linear"),ge(Qr,_e.LINEAR_MIPMAP_LINEAR,"mipmap"),ge(Qr,_e.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),ge(Qr,_e.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),ge(Qr,_e.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest");Li={},ge(Li,_e.REPEAT,"repeat"),ge(Li,_e.CLAMP_TO_EDGE,"clamp"),ge(Li,_e.MIRRORED_REPEAT,"mirror");_a={},ge(_a,_e.NONE,"none"),ge(_a,_e.BROWSER_DEFAULT_WEBGL,"browser");Lr={},ge(Lr,_e.NEVER,"never"),ge(Lr,_e.ALWAYS,"always"),ge(Lr,_e.LESS,"less"),ge(Lr,_e.LEQUAL,"lequal"),ge(Lr,_e.GREATER,"greater"),ge(Lr,_e.GEQUAL,"gequal"),ge(Lr,_e.EQUAL,"equal"),ge(Lr,_e.NOTEQUAL,"notequal");yn={},ge(yn,_e.FUNC_ADD,"add"),ge(yn,_e.MIN_EXT,"min"),ge(yn,_e.MAX_EXT,"max"),ge(yn,_e.FUNC_SUBTRACT,"subtract"),ge(yn,_e.FUNC_REVERSE_SUBTRACT,"reverse subtract");Ht={},ge(Ht,_e.ZERO,"zero"),ge(Ht,_e.ONE,"one"),ge(Ht,_e.SRC_COLOR,"src color"),ge(Ht,_e.ONE_MINUS_SRC_COLOR,"one minus src color"),ge(Ht,_e.SRC_ALPHA,"src alpha"),ge(Ht,_e.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),ge(Ht,_e.DST_COLOR,"dst color"),ge(Ht,_e.ONE_MINUS_DST_COLOR,"one minus dst color"),ge(Ht,_e.DST_ALPHA,"dst alpha"),ge(Ht,_e.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),ge(Ht,_e.CONSTANT_COLOR,"constant color"),ge(Ht,_e.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),ge(Ht,_e.CONSTANT_ALPHA,"constant alpha"),ge(Ht,_e.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),ge(Ht,_e.SRC_ALPHA_SATURATE,"src alpha saturate");xr={},ge(xr,_e.NEVER,"never"),ge(xr,_e.ALWAYS,"always"),ge(xr,_e.LESS,"less"),ge(xr,_e.LEQUAL,"lequal"),ge(xr,_e.GREATER,"greater"),ge(xr,_e.GEQUAL,"gequal"),ge(xr,_e.EQUAL,"equal"),ge(xr,_e.NOTEQUAL,"notequal");Nr={},ge(Nr,_e.ZERO,"zero"),ge(Nr,_e.KEEP,"keep"),ge(Nr,_e.REPLACE,"replace"),ge(Nr,_e.INVERT,"invert"),ge(Nr,_e.INCR,"increment"),ge(Nr,_e.DECR,"decrement"),ge(Nr,_e.INCR_WRAP,"increment wrap"),ge(Nr,_e.DECR_WRAP,"decrement wrap");ba={},ge(ba,_e.FRONT,"front"),ge(ba,_e.BACK,"back");var X0=Function.prototype,W0=X0.toString;W0.call(Object);globalThis&&globalThis.__awaiter;globalThis&&globalThis.__awaiter;class Ds{constructor(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}distanceTo(t){const r=this.rx-t.rx,n=this.ry-t.ry;return Math.hypot(r,n)}setPos(t,r){this.rx=t,this.ry=r}resetForce(){this.fx=0,this.fy=0}addForce(t){const r=t.rx-this.rx,n=t.ry-this.ry;let a=Math.hypot(r,n);a=a<1e-4?1e-4:a;const i=this.g*(this.degree+1)*(t.degree+1)/a;this.fx+=i*r/a,this.fy+=i*n/a}in(t){return t.contains(this.rx,this.ry)}add(t){const r=this.mass+t.mass,n=(this.rx*this.mass+t.rx*t.mass)/r,a=(this.ry*this.mass+t.ry*t.mass)/r,i=this.degree+t.degree,o={rx:n,ry:a,mass:r,degree:i};return new Ds(o)}}class Wn{constructor(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}getLength(){return this.length}contains(t,r){const n=this.length/2;return t<=this.xmid+n&&t>=this.xmid-n&&r<=this.ymid+n&&r>=this.ymid-n}NW(){const t=this.xmid-this.length/4,r=this.ymid+this.length/4,n=this.length/2,a={xmid:t,ymid:r,length:n};return new Wn(a)}NE(){const t=this.xmid+this.length/4,r=this.ymid+this.length/4,n=this.length/2,a={xmid:t,ymid:r,length:n};return new Wn(a)}SW(){const t=this.xmid-this.length/4,r=this.ymid-this.length/4,n=this.length/2,a={xmid:t,ymid:r,length:n};return new Wn(a)}SE(){const t=this.xmid+this.length/4,r=this.ymid-this.length/4,n=this.length/2,a={xmid:t,ymid:r,length:n};return new Wn(a)}}class zn{constructor(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,t!=null&&(this.quad=t)}insert(t){if(this.body==null){this.body=t;return}this._isExternal()?(this.quad&&(this.NW=new zn(this.quad.NW()),this.NE=new zn(this.quad.NE()),this.SW=new zn(this.quad.SW()),this.SE=new zn(this.quad.SE())),this._putBody(this.body),this._putBody(t),this.body=this.body.add(t)):(this.body=this.body.add(t),this._putBody(t))}_putBody(t){!this.quad||(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))}_isExternal(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null}updateForce(t){if(!(this.body==null||t===this.body))if(this._isExternal())t.addForce(this.body);else{const r=this.quad?this.quad.getLength():0,n=this.body.distanceTo(t);r/n<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t))}}}class z0 extends ps{constructor(t){super(),this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.kr=5,this.kg=1,this.mode="normal",this.preventOverlap=!1,this.dissuadeHubs=!1,this.barnesHut=void 0,this.maxIteration=0,this.ks=.1,this.ksmax=10,this.tao=.1,this.onLayoutEnd=()=>{},this.prune=void 0,this.updateCfg(t)}getDefaultCfg(){return{}}execute(){const t=this,{nodes:r,onLayoutEnd:n,prune:a}=t;let i=t.maxIteration;!t.width&&typeof window<"u"&&(t.width=window.innerWidth),!t.height&&typeof window<"u"&&(t.height=window.innerHeight);const o=[],s=r.length;for(let f=0;f<s;f+=1){const c=r[f];let d=10,h=10;nt(c.size)&&(d=c.size,h=c.size),rs(c.size)?(isNaN(c.size[0])||(d=c.size[0]),isNaN(c.size[1])||(h=c.size[1])):vs(c.size)&&(d=c.size.width,h=c.size.height),t.getWidth&&!isNaN(t.getWidth(c))&&(h=t.getWidth(c)),t.getHeight&&!isNaN(t.getHeight(c))&&(d=t.getHeight(c));const y=Math.max(d,h);o.push(y)}t.barnesHut===void 0&&s>250&&(t.barnesHut=!0),t.prune===void 0&&s>100&&(t.prune=!0),this.maxIteration===0&&!t.prune?(i=250,s<=200&&s>100?i=1e3:s>200&&(i=1200),this.maxIteration=i):this.maxIteration===0&&a&&(i=100,s<=200&&s>100?i=500:s>200&&(i=950),this.maxIteration=i),t.kr||(t.kr=50,s>100&&s<=500?t.kr=20:s>500&&(t.kr=1)),t.kg||(t.kg=20,s>100&&s<=500?t.kg=10:s>500&&(t.kg=1)),this.nodes=t.updateNodesByForces(o),n()}updateNodesByForces(t){const r=this,{edges:n,maxIteration:a}=r;let i=r.nodes;const o=n.filter(L=>{const k=Or(L,"source"),U=Or(L,"target");return k!==U}),s=i.length,f=o.length,c=[],d={},h={},y=[];for(let L=0;L<s;L+=1)d[i[L].id]=L,c[L]=0,(i[L].x===void 0||isNaN(i[L].x))&&(i[L].x=Math.random()*1e3),(i[L].y===void 0||isNaN(i[L].y))&&(i[L].y=Math.random()*1e3),y.push({x:i[L].x,y:i[L].y});for(let L=0;L<f;L+=1){let k,U,B=0,q=0;for(let se=0;se<s;se+=1){const fe=Or(o[L],"source"),de=Or(o[L],"target");i[se].id===fe?(k=i[se],B=se):i[se].id===de&&(U=i[se],q=se),h[L]={sourceIdx:B,targetIdx:q}}k&&(c[d[k.id]]+=1),U&&(c[d[U.id]]+=1)}let C=a;if(i=this.iterate(C,d,h,f,c,t),r.prune){for(let L=0;L<f;L+=1)c[h[L].sourceIdx]<=1?(i[h[L].sourceIdx].x=i[h[L].targetIdx].x,i[h[L].sourceIdx].y=i[h[L].targetIdx].y):c[h[L].targetIdx]<=1&&(i[h[L].targetIdx].x=i[h[L].sourceIdx].x,i[h[L].targetIdx].y=i[h[L].sourceIdx].y);r.prune=!1,r.barnesHut=!1,C=100,i=this.iterate(C,d,h,f,c,t)}return i}iterate(t,r,n,a,i,o){const s=this;let{nodes:f}=s;const{kr:c,preventOverlap:d}=s,{barnesHut:h}=s,y=f.length;let C=0;const L=100;let k=t;const U=50;let B=[];const q=[],se=[];for(let fe=0;fe<y;fe+=1)if(B[2*fe]=0,B[2*fe+1]=0,h){const de={id:fe,rx:f[fe].x,ry:f[fe].y,mass:1,g:c,degree:i[fe]};se[fe]=new Ds(de)}for(;k>0;){for(let de=0;de<y;de+=1)q[2*de]=B[2*de],q[2*de+1]=B[2*de+1],B[2*de]=0,B[2*de+1]=0;B=this.getAttrForces(k,U,a,r,n,i,o,B),h&&(d&&k>U||!d)?B=this.getOptRepGraForces(B,se,i):B=this.getRepGraForces(k,U,B,L,o,i);const fe=this.updatePos(B,q,C,i);f=fe.nodes,C=fe.sg,k--,s.tick&&s.tick()}return f}getAttrForces(t,r,n,a,i,o,s,f){const c=this,{nodes:d,preventOverlap:h,dissuadeHubs:y,mode:C,prune:L}=c;for(let k=0;k<n;k+=1){const U=d[i[k].sourceIdx],B=i[k].sourceIdx,q=d[i[k].targetIdx],se=i[k].targetIdx;if(L&&(o[B]<=1||o[se]<=1))continue;const fe=[q.x-U.x,q.y-U.y];let de=Math.hypot(fe[0],fe[1]);de=de<1e-4?1e-4:de,fe[0]=fe[0]/de,fe[1]=fe[1]/de,h&&t<r&&(de=de-s[B]-s[se]);let Ze=de,Oe=Ze;C==="linlog"&&(Ze=Math.log(1+de),Oe=Ze),y&&(Ze=de/o[B],Oe=de/o[se]),h&&t<r&&de<=0?(Ze=0,Oe=0):h&&t<r&&de>0&&(Ze=de,Oe=de),f[2*a[U.id]]+=Ze*fe[0],f[2*a[q.id]]-=Oe*fe[0],f[2*a[U.id]+1]+=Ze*fe[1],f[2*a[q.id]+1]-=Oe*fe[1]}return f}getRepGraForces(t,r,n,a,i,o){const s=this,{nodes:f,preventOverlap:c,kr:d,kg:h,center:y,prune:C}=s,L=f.length;for(let k=0;k<L;k+=1){for(let se=k+1;se<L;se+=1){if(C&&(o[k]<=1||o[se]<=1))continue;const fe=[f[se].x-f[k].x,f[se].y-f[k].y];let de=Math.hypot(fe[0],fe[1]);de=de<1e-4?1e-4:de,fe[0]=fe[0]/de,fe[1]=fe[1]/de,c&&t<r&&(de=de-i[k]-i[se]);let Ze=d*(o[k]+1)*(o[se]+1)/de;c&&t<r&&de<0?Ze=a*(o[k]+1)*(o[se]+1):c&&t<r&&de===0?Ze=0:c&&t<r&&de>0&&(Ze=d*(o[k]+1)*(o[se]+1)/de),n[2*k]-=Ze*fe[0],n[2*se]+=Ze*fe[0],n[2*k+1]-=Ze*fe[1],n[2*se+1]+=Ze*fe[1]}const U=[f[k].x-y[0],f[k].y-y[1]],B=Math.hypot(U[0],U[1]);U[0]=U[0]/B,U[1]=U[1]/B;const q=h*(o[k]+1);n[2*k]-=q*U[0],n[2*k+1]-=q*U[1]}return n}getOptRepGraForces(t,r,n){const a=this,{nodes:i,kg:o,center:s,prune:f}=a,c=i.length;let d=9e10,h=-9e10,y=9e10,C=-9e10;for(let q=0;q<c;q+=1)f&&n[q]<=1||(r[q].setPos(i[q].x,i[q].y),i[q].x>=h&&(h=i[q].x),i[q].x<=d&&(d=i[q].x),i[q].y>=C&&(C=i[q].y),i[q].y<=y&&(y=i[q].y));const L=Math.max(h-d,C-y),k={xmid:(h+d)/2,ymid:(C+y)/2,length:L,massCenter:s,mass:c},U=new Wn(k),B=new zn(U);for(let q=0;q<c;q+=1)f&&n[q]<=1||r[q].in(U)&&B.insert(r[q]);for(let q=0;q<c;q+=1){if(f&&n[q]<=1)continue;r[q].resetForce(),B.updateForce(r[q]),t[2*q]-=r[q].fx,t[2*q+1]-=r[q].fy;const se=[i[q].x-s[0],i[q].y-s[1]];let fe=Math.hypot(se[0],se[1]);fe=fe<1e-4?1e-4:fe,se[0]=se[0]/fe,se[1]=se[1]/fe;const de=o*(n[q]+1);t[2*q]-=de*se[0],t[2*q+1]-=de*se[1]}return t}updatePos(t,r,n,a){const i=this,{nodes:o,ks:s,tao:f,prune:c,ksmax:d}=i,h=o.length,y=[],C=[];let L=0,k=0;for(let B=0;B<h;B+=1){if(c&&a[B]<=1)continue;const q=[t[2*B]-r[2*B],t[2*B+1]-r[2*B+1]],se=Math.hypot(q[0],q[1]),fe=[t[2*B]+r[2*B],t[2*B+1]+r[2*B+1]],de=Math.hypot(fe[0],fe[1]);y[B]=se,C[B]=de/2,L+=(a[B]+1)*y[B],k+=(a[B]+1)*C[B]}const U=n;n=f*k/L,U!==0&&(n=n>1.5*U?1.5*U:n);for(let B=0;B<h;B+=1){if(c&&a[B]<=1||nt(o[B].fx)&&nt(o[B].fy))continue;let q=s*n/(1+n*Math.sqrt(y[B])),se=Math.hypot(t[2*B],t[2*B+1]);se=se<1e-4?1e-4:se;const fe=d/se;q=q>fe?fe:q;const de=q*t[2*B],Ze=q*t[2*B+1];o[B].x+=de,o[B].y+=Ze}return{nodes:o,sg:n}}}function Y0(e,t){const r=[],n=[];return Object.keys(t).forEach(a=>{r.push(t[a].x,t[a].y)}),e.edges().forEach(a=>{const i=e.source(a),o=e.target(a);n.push(t[i].x,t[i].y,t[o].x,t[o].y)}),{nodes:r,edges:n}}function Gs(e){const t=[],r=[],n={};return e.nodes.forEach(({id:a,x:i,y:o})=>{n[a]={x:i,y:o},t.push(i,o)}),e.edges.forEach(({source:a,target:i})=>{const o=n[a].x,s=n[a].y,f=n[i].x,c=n[i].y;r.push(o,s,f,c)}),{nodes:t,edges:r}}function ch(e,t){const r=[];return t.forEach(([n,a])=>{r.push(e[n*2],e[n*2+1],e[a*2],e[a*2+1])}),{nodes:e,edges:r}}const Fs=100,Us=1,Ms=1;async function K0(e){const t=Ty(e,{settings:{barnesHutOptimize:!1,strongGravityMode:!1,gravity:Us,scalingRatio:Ms,slowDown:1},iterations:Fs,getEdgeWeight:"weight"});return Y0(e,t)}async function q0(e){return new z0({type:"forceAtlas2",kr:Ms,kg:Us,ks:.1,maxIteration:Fs}).layout(e),Gs(e)}async function zc({nodes:e,edges:t,masses:r,weights:n},a){const{positions:i}=await a({name:0,nodes:e.length,edges:t,positions:e,masses:r,weights:n,iterations:Fs,ka:1,kg:Us,kr:Ms,speed:.1,prevent_overlapping:!1,node_radius:10,kr_prime:10,strong_gravity:!1,lin_log:!1,dissuade_hubs:!1,edge_strength:1,link_distance:1,node_strength:1,coulomb_dis_scale:.005,factor:1,interval:.02,damping:.9});return ch(i,t)}const dh=100;async function Q0(e){return new Ky({type:"gForce",factor:1,gravity:10,linkDistance:200,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,preventOverlap:!0,maxIteration:dh}).layout(e),Gs(e)}async function Yc({nodes:e,edges:t,masses:r,weights:n},a){const{positions:i}=await a({name:1,nodes:e.length,edges:t,positions:e,masses:r,weights:n,iterations:dh,ka:1,kg:1,kr:1,speed:.1,prevent_overlapping:!1,node_radius:10,kr_prime:10,strong_gravity:!1,lin_log:!1,dissuade_hubs:!1,edge_strength:.1,link_distance:1,node_strength:1,coulomb_dis_scale:.005,factor:1,interval:.02,damping:.9});return ch(i,t)}const Z0=1e3;async function J0(e){return new G0({type:"fruchterman",center:[200,200],gravity:1,maxIteration:Z0}).layout(e),Gs(e)}var Ps={exports:{}},Jn=typeof Reflect=="object"?Reflect:null,Kc=Jn&&typeof Jn.apply=="function"?Jn.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},wa;Jn&&typeof Jn.ownKeys=="function"?wa=Jn.ownKeys:Object.getOwnPropertySymbols?wa=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:wa=function(t){return Object.getOwnPropertyNames(t)};function eb(e){console&&console.warn&&console.warn(e)}var hh=Number.isNaN||function(t){return t!==t};function ct(){ct.init.call(this)}Ps.exports=ct;Ps.exports.once=ib;ct.EventEmitter=ct;ct.prototype._events=void 0;ct.prototype._eventsCount=0;ct.prototype._maxListeners=void 0;var qc=10;function Wa(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(ct,"defaultMaxListeners",{enumerable:!0,get:function(){return qc},set:function(e){if(typeof e!="number"||e<0||hh(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");qc=e}});ct.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};ct.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||hh(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function lh(e){return e._maxListeners===void 0?ct.defaultMaxListeners:e._maxListeners}ct.prototype.getMaxListeners=function(){return lh(this)};ct.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var a=t==="error",i=this._events;if(i!==void 0)a=a&&i.error===void 0;else if(!a)return!1;if(a){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var f=i[t];if(f===void 0)return!1;if(typeof f=="function")Kc(f,this,r);else for(var c=f.length,d=Eh(f,c),n=0;n<c;++n)Kc(d[n],this,r);return!0};function ph(e,t,r,n){var a,i,o;if(Wa(r),i=e._events,i===void 0?(i=e._events=Object.create(null),e._eventsCount=0):(i.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),o=i[t]),o===void 0)o=i[t]=r,++e._eventsCount;else if(typeof o=="function"?o=i[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),a=lh(e),a>0&&o.length>a&&!o.warned){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=o.length,eb(s)}return e}ct.prototype.addListener=function(t,r){return ph(this,t,r,!1)};ct.prototype.on=ct.prototype.addListener;ct.prototype.prependListener=function(t,r){return ph(this,t,r,!0)};function tb(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function vh(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},a=tb.bind(n);return a.listener=r,n.wrapFn=a,a}ct.prototype.once=function(t,r){return Wa(r),this.on(t,vh(this,t,r)),this};ct.prototype.prependOnceListener=function(t,r){return Wa(r),this.prependListener(t,vh(this,t,r)),this};ct.prototype.removeListener=function(t,r){var n,a,i,o,s;if(Wa(r),a=this._events,a===void 0)return this;if(n=a[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete a[t],a.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){s=n[o].listener,i=o;break}if(i<0)return this;i===0?n.shift():rb(n,i),n.length===1&&(a[t]=n[0]),a.removeListener!==void 0&&this.emit("removeListener",t,s||r)}return this};ct.prototype.off=ct.prototype.removeListener;ct.prototype.removeAllListeners=function(t){var r,n,a;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var i=Object.keys(n),o;for(a=0;a<i.length;++a)o=i[a],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(a=r.length-1;a>=0;a--)this.removeListener(t,r[a]);return this};function yh(e,t,r){var n=e._events;if(n===void 0)return[];var a=n[t];return a===void 0?[]:typeof a=="function"?r?[a.listener||a]:[a]:r?nb(a):Eh(a,a.length)}ct.prototype.listeners=function(t){return yh(this,t,!0)};ct.prototype.rawListeners=function(t){return yh(this,t,!1)};ct.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):mh.call(e,t)};ct.prototype.listenerCount=mh;function mh(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}ct.prototype.eventNames=function(){return this._eventsCount>0?wa(this._events):[]};function Eh(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function rb(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function nb(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function ib(e,t){return new Promise(function(r,n){function a(o){e.removeListener(t,i),n(o)}function i(){typeof e.removeListener=="function"&&e.removeListener("error",a),r([].slice.call(arguments))}_h(e,t,i,{once:!0}),t!=="error"&&ab(e,a,{once:!0})})}function ab(e,t,r){typeof e.on=="function"&&_h(e,"error",t,r)}function _h(e,t,r,n){if(typeof e.on=="function")n.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function a(i){n.once&&e.removeEventListener(t,a),r(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}function Ir(e){if(typeof e!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=e}typeof Symbol<"u"&&(Ir.prototype[Symbol.iterator]=function(){return this});Ir.of=function(){var e=arguments,t=e.length,r=0;return new Ir(function(){return r>=t?{done:!0}:{done:!1,value:e[r++]}})};Ir.empty=function(){var e=new Ir(function(){return{done:!0}});return e};Ir.fromSequence=function(e){var t=0,r=e.length;return new Ir(function(){return t>=r?{done:!0}:{done:!1,value:e[t++]}})};Ir.is=function(e){return e instanceof Ir?!0:typeof e=="object"&&e!==null&&typeof e.next=="function"};var rr=Ir,ks={};ks.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u";ks.SYMBOL_SUPPORT=typeof Symbol<"u";var ob=rr,bh=ks,sb=bh.ARRAY_BUFFER_SUPPORT,ub=bh.SYMBOL_SUPPORT;function fb(e){return typeof e=="string"||Array.isArray(e)||sb&&ArrayBuffer.isView(e)?ob.fromSequence(e):typeof e!="object"||e===null?null:ub&&typeof e[Symbol.iterator]=="function"?e[Symbol.iterator]():typeof e.next=="function"?e:null}var gh=function(t){var r=fb(t);if(!r)throw new Error("obliterator: target is not iterable nor a valid iterator.");return r},cb=gh,Ah=function(t,r){for(var n=arguments.length>1?r:1/0,a=n!==1/0?new Array(n):[],i,o=0,s=cb(t);;){if(o===n)return a;if(i=s.next(),i.done)return o!==r&&(a.length=o),a;a[o++]=i.value}},db=rr,hb=gh,Br=function(){var t=arguments,r=null,n=-1;return new db(function(){var i=null;do{if(r===null){if(n++,n>=t.length)return{done:!0};r=hb(t[n])}if(i=r.next(),i.done===!0){r=null;continue}break}while(!0);return i})};function lb(){const e=arguments[0];for(let t=1,r=arguments.length;t<r;t++)if(!!arguments[t])for(const n in arguments[t])e[n]=arguments[t][n];return e}let Ut=lb;typeof Object.assign=="function"&&(Ut=Object.assign);function hr(e,t,r,n){const a=e._nodes.get(t);let i=null;return a&&(n==="mixed"?i=a.out&&a.out[r]||a.undirected&&a.undirected[r]:n==="directed"?i=a.out&&a.out[r]:i=a.undirected&&a.undirected[r]),i}function Vt(e){return typeof e=="object"&&e!==null&&e.constructor===Object}function Th(e){let t;for(t in e)return!1;return!0}function cr(e,t,r){Object.defineProperty(e,t,{enumerable:!1,configurable:!1,writable:!0,value:r})}function Er(e,t,r){const n={enumerable:!0,configurable:!0};typeof r=="function"?n.get=r:(n.value=r,n.writable=!1),Object.defineProperty(e,t,n)}function Qc(e){return!(!Vt(e)||e.attributes&&!Array.isArray(e.attributes))}function pb(){let e=Math.floor(Math.random()*256)&255;return()=>e++}class Bs extends Error{constructor(t){super(),this.name="GraphError",this.message=t}}class Ne extends Bs{constructor(t){super(t),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ne.prototype.constructor)}}class Te extends Bs{constructor(t){super(t),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Te.prototype.constructor)}}class $e extends Bs{constructor(t){super(t),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,$e.prototype.constructor)}}function wh(e,t){this.key=e,this.attributes=t,this.clear()}wh.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function Sh(e,t){this.key=e,this.attributes=t,this.clear()}Sh.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function Rh(e,t){this.key=e,this.attributes=t,this.clear()}Rh.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function ni(e,t,r,n,a){this.key=t,this.attributes=a,this.undirected=e,this.source=r,this.target=n}ni.prototype.attach=function(){let e="out",t="in";this.undirected&&(e=t="undirected");const r=this.source.key,n=this.target.key;this.source[e][n]=this,!(this.undirected&&r===n)&&(this.target[t][r]=this)};ni.prototype.attachMulti=function(){let e="out",t="in";const r=this.source.key,n=this.target.key;this.undirected&&(e=t="undirected");const a=this.source[e],i=a[n];if(typeof i>"u"){a[n]=this,this.undirected&&r===n||(this.target[t][r]=this);return}i.previous=this,this.next=i,a[n]=this,this.target[t][r]=this};ni.prototype.detach=function(){const e=this.source.key,t=this.target.key;let r="out",n="in";this.undirected&&(r=n="undirected"),delete this.source[r][t],delete this.target[n][e]};ni.prototype.detachMulti=function(){const e=this.source.key,t=this.target.key;let r="out",n="in";this.undirected&&(r=n="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[r][t],delete this.target[n][e]):(this.next.previous=void 0,this.source[r][t]=this.next,this.target[n][e]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const Lh=0,xh=1,vb=2,Nh=3;function Hr(e,t,r,n,a,i,o){let s,f,c,d;if(n=""+n,r===Lh){if(s=e._nodes.get(n),!s)throw new Te(`Graph.${t}: could not find the "${n}" node in the graph.`);c=a,d=i}else if(r===Nh){if(a=""+a,f=e._edges.get(a),!f)throw new Te(`Graph.${t}: could not find the "${a}" edge in the graph.`);const h=f.source.key,y=f.target.key;if(n===h)s=f.target;else if(n===y)s=f.source;else throw new Te(`Graph.${t}: the "${n}" node is not attached to the "${a}" edge (${h}, ${y}).`);c=i,d=o}else{if(f=e._edges.get(n),!f)throw new Te(`Graph.${t}: could not find the "${n}" edge in the graph.`);r===xh?s=f.source:s=f.target,c=a,d=i}return[s,c,d]}function yb(e,t,r){e.prototype[t]=function(n,a,i){const[o,s]=Hr(this,t,r,n,a,i);return o.attributes[s]}}function mb(e,t,r){e.prototype[t]=function(n,a){const[i]=Hr(this,t,r,n,a);return i.attributes}}function Eb(e,t,r){e.prototype[t]=function(n,a,i){const[o,s]=Hr(this,t,r,n,a,i);return o.attributes.hasOwnProperty(s)}}function _b(e,t,r){e.prototype[t]=function(n,a,i,o){const[s,f,c]=Hr(this,t,r,n,a,i,o);return s.attributes[f]=c,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:f}),this}}function bb(e,t,r){e.prototype[t]=function(n,a,i,o){const[s,f,c]=Hr(this,t,r,n,a,i,o);if(typeof c!="function")throw new Ne(`Graph.${t}: updater should be a function.`);const d=s.attributes,h=c(d[f]);return d[f]=h,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:f}),this}}function gb(e,t,r){e.prototype[t]=function(n,a,i){const[o,s]=Hr(this,t,r,n,a,i);return delete o.attributes[s],this.emit("nodeAttributesUpdated",{key:o.key,type:"remove",attributes:o.attributes,name:s}),this}}function Ab(e,t,r){e.prototype[t]=function(n,a,i){const[o,s]=Hr(this,t,r,n,a,i);if(!Vt(s))throw new Ne(`Graph.${t}: provided attributes are not a plain object.`);return o.attributes=s,this.emit("nodeAttributesUpdated",{key:o.key,type:"replace",attributes:o.attributes}),this}}function Tb(e,t,r){e.prototype[t]=function(n,a,i){const[o,s]=Hr(this,t,r,n,a,i);if(!Vt(s))throw new Ne(`Graph.${t}: provided attributes are not a plain object.`);return Ut(o.attributes,s),this.emit("nodeAttributesUpdated",{key:o.key,type:"merge",attributes:o.attributes,data:s}),this}}function wb(e,t,r){e.prototype[t]=function(n,a,i){const[o,s]=Hr(this,t,r,n,a,i);if(typeof s!="function")throw new Ne(`Graph.${t}: provided updater is not a function.`);return o.attributes=s(o.attributes),this.emit("nodeAttributesUpdated",{key:o.key,type:"update",attributes:o.attributes}),this}}const Sb=[{name:e=>`get${e}Attribute`,attacher:yb},{name:e=>`get${e}Attributes`,attacher:mb},{name:e=>`has${e}Attribute`,attacher:Eb},{name:e=>`set${e}Attribute`,attacher:_b},{name:e=>`update${e}Attribute`,attacher:bb},{name:e=>`remove${e}Attribute`,attacher:gb},{name:e=>`replace${e}Attributes`,attacher:Ab},{name:e=>`merge${e}Attributes`,attacher:Tb},{name:e=>`update${e}Attributes`,attacher:wb}];function Rb(e){Sb.forEach(function({name:t,attacher:r}){r(e,t("Node"),Lh),r(e,t("Source"),xh),r(e,t("Target"),vb),r(e,t("Opposite"),Nh)})}function Lb(e,t,r){e.prototype[t]=function(n,a){let i;if(this.type!=="mixed"&&r!=="mixed"&&r!==this.type)throw new $e(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new $e(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+n,s=""+a;if(a=arguments[2],i=hr(this,o,s,r),!i)throw new Te(`Graph.${t}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(r!=="mixed")throw new $e(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,i=this._edges.get(n),!i)throw new Te(`Graph.${t}: could not find the "${n}" edge in the graph.`)}return i.attributes[a]}}function xb(e,t,r){e.prototype[t]=function(n){let a;if(this.type!=="mixed"&&r!=="mixed"&&r!==this.type)throw new $e(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new $e(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const i=""+n,o=""+arguments[1];if(a=hr(this,i,o,r),!a)throw new Te(`Graph.${t}: could not find an edge for the given path ("${i}" - "${o}").`)}else{if(r!=="mixed")throw new $e(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new Te(`Graph.${t}: could not find the "${n}" edge in the graph.`)}return a.attributes}}function Nb(e,t,r){e.prototype[t]=function(n,a){let i;if(this.type!=="mixed"&&r!=="mixed"&&r!==this.type)throw new $e(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new $e(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+n,s=""+a;if(a=arguments[2],i=hr(this,o,s,r),!i)throw new Te(`Graph.${t}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(r!=="mixed")throw new $e(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,i=this._edges.get(n),!i)throw new Te(`Graph.${t}: could not find the "${n}" edge in the graph.`)}return i.attributes.hasOwnProperty(a)}}function Ob(e,t,r){e.prototype[t]=function(n,a,i){let o;if(this.type!=="mixed"&&r!=="mixed"&&r!==this.type)throw new $e(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new $e(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+n,f=""+a;if(a=arguments[2],i=arguments[3],o=hr(this,s,f,r),!o)throw new Te(`Graph.${t}: could not find an edge for the given path ("${s}" - "${f}").`)}else{if(r!=="mixed")throw new $e(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,o=this._edges.get(n),!o)throw new Te(`Graph.${t}: could not find the "${n}" edge in the graph.`)}return o.attributes[a]=i,this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:a}),this}}function Ib(e,t,r){e.prototype[t]=function(n,a,i){let o;if(this.type!=="mixed"&&r!=="mixed"&&r!==this.type)throw new $e(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new $e(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+n,f=""+a;if(a=arguments[2],i=arguments[3],o=hr(this,s,f,r),!o)throw new Te(`Graph.${t}: could not find an edge for the given path ("${s}" - "${f}").`)}else{if(r!=="mixed")throw new $e(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,o=this._edges.get(n),!o)throw new Te(`Graph.${t}: could not find the "${n}" edge in the graph.`)}if(typeof i!="function")throw new Ne(`Graph.${t}: updater should be a function.`);return o.attributes[a]=i(o.attributes[a]),this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:a}),this}}function Cb(e,t,r){e.prototype[t]=function(n,a){let i;if(this.type!=="mixed"&&r!=="mixed"&&r!==this.type)throw new $e(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new $e(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+n,s=""+a;if(a=arguments[2],i=hr(this,o,s,r),!i)throw new Te(`Graph.${t}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(r!=="mixed")throw new $e(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,i=this._edges.get(n),!i)throw new Te(`Graph.${t}: could not find the "${n}" edge in the graph.`)}return delete i.attributes[a],this.emit("edgeAttributesUpdated",{key:i.key,type:"remove",attributes:i.attributes,name:a}),this}}function Db(e,t,r){e.prototype[t]=function(n,a){let i;if(this.type!=="mixed"&&r!=="mixed"&&r!==this.type)throw new $e(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new $e(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+n,s=""+a;if(a=arguments[2],i=hr(this,o,s,r),!i)throw new Te(`Graph.${t}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(r!=="mixed")throw new $e(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,i=this._edges.get(n),!i)throw new Te(`Graph.${t}: could not find the "${n}" edge in the graph.`)}if(!Vt(a))throw new Ne(`Graph.${t}: provided attributes are not a plain object.`);return i.attributes=a,this.emit("edgeAttributesUpdated",{key:i.key,type:"replace",attributes:i.attributes}),this}}function Gb(e,t,r){e.prototype[t]=function(n,a){let i;if(this.type!=="mixed"&&r!=="mixed"&&r!==this.type)throw new $e(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new $e(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+n,s=""+a;if(a=arguments[2],i=hr(this,o,s,r),!i)throw new Te(`Graph.${t}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(r!=="mixed")throw new $e(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,i=this._edges.get(n),!i)throw new Te(`Graph.${t}: could not find the "${n}" edge in the graph.`)}if(!Vt(a))throw new Ne(`Graph.${t}: provided attributes are not a plain object.`);return Ut(i.attributes,a),this.emit("edgeAttributesUpdated",{key:i.key,type:"merge",attributes:i.attributes,data:a}),this}}function Fb(e,t,r){e.prototype[t]=function(n,a){let i;if(this.type!=="mixed"&&r!=="mixed"&&r!==this.type)throw new $e(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new $e(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+n,s=""+a;if(a=arguments[2],i=hr(this,o,s,r),!i)throw new Te(`Graph.${t}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(r!=="mixed")throw new $e(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,i=this._edges.get(n),!i)throw new Te(`Graph.${t}: could not find the "${n}" edge in the graph.`)}if(typeof a!="function")throw new Ne(`Graph.${t}: provided updater is not a function.`);return i.attributes=a(i.attributes),this.emit("edgeAttributesUpdated",{key:i.key,type:"update",attributes:i.attributes}),this}}const Ub=[{name:e=>`get${e}Attribute`,attacher:Lb},{name:e=>`get${e}Attributes`,attacher:xb},{name:e=>`has${e}Attribute`,attacher:Nb},{name:e=>`set${e}Attribute`,attacher:Ob},{name:e=>`update${e}Attribute`,attacher:Ib},{name:e=>`remove${e}Attribute`,attacher:Cb},{name:e=>`replace${e}Attributes`,attacher:Db},{name:e=>`merge${e}Attributes`,attacher:Gb},{name:e=>`update${e}Attributes`,attacher:Fb}];function Mb(e){Ub.forEach(function({name:t,attacher:r}){r(e,t("Edge"),"mixed"),r(e,t("DirectedEdge"),"directed"),r(e,t("UndirectedEdge"),"undirected")})}const Pb=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function kb(e,t,r,n){let a=!1;for(const i in t){if(i===n)continue;const o=t[i];if(a=r(o.key,o.attributes,o.source.key,o.target.key,o.source.attributes,o.target.attributes,o.undirected),e&&a)return o.key}}function Bb(e,t,r,n){let a,i,o,s=!1;for(const f in t)if(f!==n){a=t[f];do{if(i=a.source,o=a.target,s=r(a.key,a.attributes,i.key,o.key,i.attributes,o.attributes,a.undirected),e&&s)return a.key;a=a.next}while(a!==void 0)}}function Jo(e,t){const r=Object.keys(e),n=r.length;let a,i=0;return new rr(function(){do if(a)a=a.next;else{if(i>=n)return{done:!0};const s=r[i++];if(s===t){a=void 0;continue}a=e[s]}while(!a);return{done:!1,value:{edge:a.key,attributes:a.attributes,source:a.source.key,target:a.target.key,sourceAttributes:a.source.attributes,targetAttributes:a.target.attributes,undirected:a.undirected}}})}function jb(e,t,r,n){const a=t[r];if(!a)return;const i=a.source,o=a.target;if(n(a.key,a.attributes,i.key,o.key,i.attributes,o.attributes,a.undirected)&&e)return a.key}function $b(e,t,r,n){let a=t[r];if(!a)return;let i=!1;do{if(i=n(a.key,a.attributes,a.source.key,a.target.key,a.source.attributes,a.target.attributes,a.undirected),e&&i)return a.key;a=a.next}while(a!==void 0)}function es(e,t){let r=e[t];return r.next!==void 0?new rr(function(){if(!r)return{done:!0};const n={edge:r.key,attributes:r.attributes,source:r.source.key,target:r.target.key,sourceAttributes:r.source.attributes,targetAttributes:r.target.attributes,undirected:r.undirected};return r=r.next,{done:!1,value:n}}):rr.of({edge:r.key,attributes:r.attributes,source:r.source.key,target:r.target.key,sourceAttributes:r.source.attributes,targetAttributes:r.target.attributes,undirected:r.undirected})}function Hb(e,t){if(e.size===0)return[];if(t==="mixed"||t===e.type)return typeof Array.from=="function"?Array.from(e._edges.keys()):Ah(e._edges.keys(),e._edges.size);const r=t==="undirected"?e.undirectedSize:e.directedSize,n=new Array(r),a=t==="undirected",i=e._edges.values();let o=0,s,f;for(;s=i.next(),s.done!==!0;)f=s.value,f.undirected===a&&(n[o++]=f.key);return n}function Oh(e,t,r,n){if(t.size===0)return;const a=r!=="mixed"&&r!==t.type,i=r==="undirected";let o,s,f=!1;const c=t._edges.values();for(;o=c.next(),o.done!==!0;){if(s=o.value,a&&s.undirected!==i)continue;const{key:d,attributes:h,source:y,target:C}=s;if(f=n(d,h,y.key,C.key,y.attributes,C.attributes,s.undirected),e&&f)return d}}function Vb(e,t){if(e.size===0)return rr.empty();const r=t!=="mixed"&&t!==e.type,n=t==="undirected",a=e._edges.values();return new rr(function(){let o,s;for(;;){if(o=a.next(),o.done)return o;if(s=o.value,!(r&&s.undirected!==n))break}return{value:{edge:s.key,attributes:s.attributes,source:s.source.key,target:s.target.key,sourceAttributes:s.source.attributes,targetAttributes:s.target.attributes,undirected:s.undirected},done:!1}})}function js(e,t,r,n,a,i){const o=t?Bb:kb;let s;if(r!=="undirected"&&(n!=="out"&&(s=o(e,a.in,i),e&&s)||n!=="in"&&(s=o(e,a.out,i,n?void 0:a.key),e&&s))||r!=="directed"&&(s=o(e,a.undirected,i),e&&s))return s}function Xb(e,t,r,n){const a=[];return js(!1,e,t,r,n,function(i){a.push(i)}),a}function Wb(e,t,r){let n=rr.empty();return e!=="undirected"&&(t!=="out"&&typeof r.in<"u"&&(n=Br(n,Jo(r.in))),t!=="in"&&typeof r.out<"u"&&(n=Br(n,Jo(r.out,t?void 0:r.key)))),e!=="directed"&&typeof r.undirected<"u"&&(n=Br(n,Jo(r.undirected))),n}function $s(e,t,r,n,a,i,o){const s=r?$b:jb;let f;if(t!=="undirected"&&(typeof a.in<"u"&&n!=="out"&&(f=s(e,a.in,i,o),e&&f)||typeof a.out<"u"&&n!=="in"&&(n||a.key!==i)&&(f=s(e,a.out,i,o),e&&f))||t!=="directed"&&typeof a.undirected<"u"&&(f=s(e,a.undirected,i,o),e&&f))return f}function zb(e,t,r,n,a){const i=[];return $s(!1,e,t,r,n,a,function(o){i.push(o)}),i}function Yb(e,t,r,n){let a=rr.empty();return e!=="undirected"&&(typeof r.in<"u"&&t!=="out"&&n in r.in&&(a=Br(a,es(r.in,n))),typeof r.out<"u"&&t!=="in"&&n in r.out&&(t||r.key!==n)&&(a=Br(a,es(r.out,n)))),e!=="directed"&&typeof r.undirected<"u"&&n in r.undirected&&(a=Br(a,es(r.undirected,n))),a}function Kb(e,t){const{name:r,type:n,direction:a}=t;e.prototype[r]=function(i,o){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return[];if(!arguments.length)return Hb(this,n);if(arguments.length===1){i=""+i;const s=this._nodes.get(i);if(typeof s>"u")throw new Te(`Graph.${r}: could not find the "${i}" node in the graph.`);return Xb(this.multi,n==="mixed"?this.type:n,a,s)}if(arguments.length===2){i=""+i,o=""+o;const s=this._nodes.get(i);if(!s)throw new Te(`Graph.${r}:  could not find the "${i}" source node in the graph.`);if(!this._nodes.has(o))throw new Te(`Graph.${r}:  could not find the "${o}" target node in the graph.`);return zb(n,this.multi,a,s,o)}throw new Ne(`Graph.${r}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function qb(e,t){const{name:r,type:n,direction:a}=t,i="forEach"+r[0].toUpperCase()+r.slice(1,-1);e.prototype[i]=function(c,d,h){if(!(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)){if(arguments.length===1)return h=c,Oh(!1,this,n,h);if(arguments.length===2){c=""+c,h=d;const y=this._nodes.get(c);if(typeof y>"u")throw new Te(`Graph.${i}: could not find the "${c}" node in the graph.`);return js(!1,this.multi,n==="mixed"?this.type:n,a,y,h)}if(arguments.length===3){c=""+c,d=""+d;const y=this._nodes.get(c);if(!y)throw new Te(`Graph.${i}:  could not find the "${c}" source node in the graph.`);if(!this._nodes.has(d))throw new Te(`Graph.${i}:  could not find the "${d}" target node in the graph.`);return $s(!1,n,this.multi,a,y,d,h)}throw new Ne(`Graph.${i}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const o="map"+r[0].toUpperCase()+r.slice(1);e.prototype[o]=function(){const c=Array.prototype.slice.call(arguments),d=c.pop();let h;if(c.length===0){let y=0;n!=="directed"&&(y+=this.undirectedSize),n!=="undirected"&&(y+=this.directedSize),h=new Array(y);let C=0;c.push((L,k,U,B,q,se,fe)=>{h[C++]=d(L,k,U,B,q,se,fe)})}else h=[],c.push((y,C,L,k,U,B,q)=>{h.push(d(y,C,L,k,U,B,q))});return this[i].apply(this,c),h};const s="filter"+r[0].toUpperCase()+r.slice(1);e.prototype[s]=function(){const c=Array.prototype.slice.call(arguments),d=c.pop(),h=[];return c.push((y,C,L,k,U,B,q)=>{d(y,C,L,k,U,B,q)&&h.push(y)}),this[i].apply(this,c),h};const f="reduce"+r[0].toUpperCase()+r.slice(1);e.prototype[f]=function(){let c=Array.prototype.slice.call(arguments);if(c.length<2||c.length>4)throw new Ne(`Graph.${f}: invalid number of arguments (expecting 2, 3 or 4 and got ${c.length}).`);if(typeof c[c.length-1]=="function"&&typeof c[c.length-2]!="function")throw new Ne(`Graph.${f}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let d,h;c.length===2?(d=c[0],h=c[1],c=[]):c.length===3?(d=c[1],h=c[2],c=[c[0]]):c.length===4&&(d=c[2],h=c[3],c=[c[0],c[1]]);let y=h;return c.push((C,L,k,U,B,q,se)=>{y=d(y,C,L,k,U,B,q,se)}),this[i].apply(this,c),y}}function Qb(e,t){const{name:r,type:n,direction:a}=t,i="find"+r[0].toUpperCase()+r.slice(1,-1);e.prototype[i]=function(f,c,d){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return!1;if(arguments.length===1)return d=f,Oh(!0,this,n,d);if(arguments.length===2){f=""+f,d=c;const h=this._nodes.get(f);if(typeof h>"u")throw new Te(`Graph.${i}: could not find the "${f}" node in the graph.`);return js(!0,this.multi,n==="mixed"?this.type:n,a,h,d)}if(arguments.length===3){f=""+f,c=""+c;const h=this._nodes.get(f);if(!h)throw new Te(`Graph.${i}:  could not find the "${f}" source node in the graph.`);if(!this._nodes.has(c))throw new Te(`Graph.${i}:  could not find the "${c}" target node in the graph.`);return $s(!0,n,this.multi,a,h,c,d)}throw new Ne(`Graph.${i}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const o="some"+r[0].toUpperCase()+r.slice(1,-1);e.prototype[o]=function(){const f=Array.prototype.slice.call(arguments),c=f.pop();return f.push((h,y,C,L,k,U,B)=>c(h,y,C,L,k,U,B)),!!this[i].apply(this,f)};const s="every"+r[0].toUpperCase()+r.slice(1,-1);e.prototype[s]=function(){const f=Array.prototype.slice.call(arguments),c=f.pop();return f.push((h,y,C,L,k,U,B)=>!c(h,y,C,L,k,U,B)),!this[i].apply(this,f)}}function Zb(e,t){const{name:r,type:n,direction:a}=t,i=r.slice(0,-1)+"Entries";e.prototype[i]=function(o,s){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return rr.empty();if(!arguments.length)return Vb(this,n);if(arguments.length===1){o=""+o;const f=this._nodes.get(o);if(!f)throw new Te(`Graph.${i}: could not find the "${o}" node in the graph.`);return Wb(n,a,f)}if(arguments.length===2){o=""+o,s=""+s;const f=this._nodes.get(o);if(!f)throw new Te(`Graph.${i}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(s))throw new Te(`Graph.${i}:  could not find the "${s}" target node in the graph.`);return Yb(n,a,f,s)}throw new Ne(`Graph.${i}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Jb(e){Pb.forEach(t=>{Kb(e,t),qb(e,t),Qb(e,t),Zb(e,t)})}const eg=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function za(){this.A=null,this.B=null}za.prototype.wrap=function(e){this.A===null?this.A=e:this.B===null&&(this.B=e)};za.prototype.has=function(e){return this.A!==null&&e in this.A||this.B!==null&&e in this.B};function xi(e,t,r,n,a){for(const i in n){const o=n[i],s=o.source,f=o.target,c=s===r?f:s;if(t&&t.has(c.key))continue;const d=a(c.key,c.attributes);if(e&&d)return c.key}}function Hs(e,t,r,n,a){if(t!=="mixed"){if(t==="undirected")return xi(e,null,n,n.undirected,a);if(typeof r=="string")return xi(e,null,n,n[r],a)}const i=new za;let o;if(t!=="undirected"){if(r!=="out"){if(o=xi(e,null,n,n.in,a),e&&o)return o;i.wrap(n.in)}if(r!=="in"){if(o=xi(e,i,n,n.out,a),e&&o)return o;i.wrap(n.out)}}if(t!=="directed"&&(o=xi(e,i,n,n.undirected,a),e&&o))return o}function tg(e,t,r){if(e!=="mixed"){if(e==="undirected")return Object.keys(r.undirected);if(typeof t=="string")return Object.keys(r[t])}const n=[];return Hs(!1,e,t,r,function(a){n.push(a)}),n}function Ni(e,t,r){const n=Object.keys(r),a=n.length;let i=0;return new rr(function(){let s=null;do{if(i>=a)return e&&e.wrap(r),{done:!0};const f=r[n[i++]],c=f.source,d=f.target;if(s=c===t?d:c,e&&e.has(s.key)){s=null;continue}}while(s===null);return{done:!1,value:{neighbor:s.key,attributes:s.attributes}}})}function rg(e,t,r){if(e!=="mixed"){if(e==="undirected")return Ni(null,r,r.undirected);if(typeof t=="string")return Ni(null,r,r[t])}let n=rr.empty();const a=new za;return e!=="undirected"&&(t!=="out"&&(n=Br(n,Ni(a,r,r.in))),t!=="in"&&(n=Br(n,Ni(a,r,r.out)))),e!=="directed"&&(n=Br(n,Ni(a,r,r.undirected))),n}function ng(e,t){const{name:r,type:n,direction:a}=t;e.prototype[r]=function(i){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return[];i=""+i;const o=this._nodes.get(i);if(typeof o>"u")throw new Te(`Graph.${r}: could not find the "${i}" node in the graph.`);return tg(n==="mixed"?this.type:n,a,o)}}function ig(e,t){const{name:r,type:n,direction:a}=t,i="forEach"+r[0].toUpperCase()+r.slice(1,-1);e.prototype[i]=function(c,d){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return;c=""+c;const h=this._nodes.get(c);if(typeof h>"u")throw new Te(`Graph.${i}: could not find the "${c}" node in the graph.`);Hs(!1,n==="mixed"?this.type:n,a,h,d)};const o="map"+r[0].toUpperCase()+r.slice(1);e.prototype[o]=function(c,d){const h=[];return this[i](c,(y,C)=>{h.push(d(y,C))}),h};const s="filter"+r[0].toUpperCase()+r.slice(1);e.prototype[s]=function(c,d){const h=[];return this[i](c,(y,C)=>{d(y,C)&&h.push(y)}),h};const f="reduce"+r[0].toUpperCase()+r.slice(1);e.prototype[f]=function(c,d,h){if(arguments.length<3)throw new Ne(`Graph.${f}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let y=h;return this[i](c,(C,L)=>{y=d(y,C,L)}),y}}function ag(e,t){const{name:r,type:n,direction:a}=t,i=r[0].toUpperCase()+r.slice(1,-1),o="find"+i;e.prototype[o]=function(c,d){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return;c=""+c;const h=this._nodes.get(c);if(typeof h>"u")throw new Te(`Graph.${o}: could not find the "${c}" node in the graph.`);return Hs(!0,n==="mixed"?this.type:n,a,h,d)};const s="some"+i;e.prototype[s]=function(c,d){return!!this[o](c,d)};const f="every"+i;e.prototype[f]=function(c,d){return!this[o](c,(y,C)=>!d(y,C))}}function og(e,t){const{name:r,type:n,direction:a}=t,i=r.slice(0,-1)+"Entries";e.prototype[i]=function(o){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return rr.empty();o=""+o;const s=this._nodes.get(o);if(typeof s>"u")throw new Te(`Graph.${i}: could not find the "${o}" node in the graph.`);return rg(n==="mixed"?this.type:n,a,s)}}function sg(e){eg.forEach(t=>{ng(e,t),ig(e,t),ag(e,t),og(e,t)})}function ga(e,t,r,n,a){const i=n._nodes.values(),o=n.type;let s,f,c,d,h,y,C;for(;s=i.next(),s.done!==!0;){let L=!1;if(f=s.value,o!=="undirected"){d=f.out;for(c in d){h=d[c];do{if(y=h.target,L=!0,C=a(f.key,y.key,f.attributes,y.attributes,h.key,h.attributes,h.undirected),e&&C)return h;h=h.next}while(h)}}if(o!=="directed"){d=f.undirected;for(c in d)if(!(t&&f.key>c)){h=d[c];do{if(y=h.target,y.key!==c&&(y=h.source),L=!0,C=a(f.key,y.key,f.attributes,y.attributes,h.key,h.attributes,h.undirected),e&&C)return h;h=h.next}while(h)}}if(r&&!L&&(C=a(f.key,null,f.attributes,null,null,null,null),e&&C))return null}}function ug(e,t){const r={key:e};return Th(t.attributes)||(r.attributes=Ut({},t.attributes)),r}function fg(e,t,r){const n={key:t,source:r.source.key,target:r.target.key};return Th(r.attributes)||(n.attributes=Ut({},r.attributes)),e==="mixed"&&r.undirected&&(n.undirected=!0),n}function cg(e){if(!Vt(e))throw new Ne('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in e))throw new Ne("Graph.import: serialized node is missing its key.");if("attributes"in e&&(!Vt(e.attributes)||e.attributes===null))throw new Ne("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function dg(e){if(!Vt(e))throw new Ne('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in e))throw new Ne("Graph.import: serialized edge is missing its source.");if(!("target"in e))throw new Ne("Graph.import: serialized edge is missing its target.");if("attributes"in e&&(!Vt(e.attributes)||e.attributes===null))throw new Ne("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in e&&typeof e.undirected!="boolean")throw new Ne("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const hg=pb(),lg=new Set(["directed","undirected","mixed"]),Zc=new Set(["domain","_events","_eventsCount","_maxListeners"]),pg=[{name:e=>`${e}Edge`,generateKey:!0},{name:e=>`${e}DirectedEdge`,generateKey:!0,type:"directed"},{name:e=>`${e}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:e=>`${e}EdgeWithKey`},{name:e=>`${e}DirectedEdgeWithKey`,type:"directed"},{name:e=>`${e}UndirectedEdgeWithKey`,type:"undirected"}],vg={allowSelfLoops:!0,multi:!1,type:"mixed"};function yg(e,t,r){if(r&&!Vt(r))throw new Ne(`Graph.addNode: invalid attributes. Expecting an object but got "${r}"`);if(t=""+t,r=r||{},e._nodes.has(t))throw new $e(`Graph.addNode: the "${t}" node already exist in the graph.`);const n=new e.NodeDataClass(t,r);return e._nodes.set(t,n),e.emit("nodeAdded",{key:t,attributes:r}),n}function Jc(e,t,r){const n=new e.NodeDataClass(t,r);return e._nodes.set(t,n),e.emit("nodeAdded",{key:t,attributes:r}),n}function Ih(e,t,r,n,a,i,o,s){if(!n&&e.type==="undirected")throw new $e(`Graph.${t}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(n&&e.type==="directed")throw new $e(`Graph.${t}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(s&&!Vt(s))throw new Ne(`Graph.${t}: invalid attributes. Expecting an object but got "${s}"`);if(i=""+i,o=""+o,s=s||{},!e.allowSelfLoops&&i===o)throw new $e(`Graph.${t}: source & target are the same ("${i}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const f=e._nodes.get(i),c=e._nodes.get(o);if(!f)throw new Te(`Graph.${t}: source node "${i}" not found.`);if(!c)throw new Te(`Graph.${t}: target node "${o}" not found.`);const d={key:null,undirected:n,source:i,target:o,attributes:s};if(r)a=e._edgeKeyGenerator();else if(a=""+a,e._edges.has(a))throw new $e(`Graph.${t}: the "${a}" edge already exists in the graph.`);if(!e.multi&&(n?typeof f.undirected[o]<"u":typeof f.out[o]<"u"))throw new $e(`Graph.${t}: an edge linking "${i}" to "${o}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const h=new ni(n,a,f,c,s);e._edges.set(a,h);const y=i===o;return n?(f.undirectedDegree++,c.undirectedDegree++,y&&(f.undirectedLoops++,e._undirectedSelfLoopCount++)):(f.outDegree++,c.inDegree++,y&&(f.directedLoops++,e._directedSelfLoopCount++)),e.multi?h.attachMulti():h.attach(),n?e._undirectedSize++:e._directedSize++,d.key=a,e.emit("edgeAdded",d),a}function mg(e,t,r,n,a,i,o,s,f){if(!n&&e.type==="undirected")throw new $e(`Graph.${t}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(n&&e.type==="directed")throw new $e(`Graph.${t}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(s){if(f){if(typeof s!="function")throw new Ne(`Graph.${t}: invalid updater function. Expecting a function but got "${s}"`)}else if(!Vt(s))throw new Ne(`Graph.${t}: invalid attributes. Expecting an object but got "${s}"`)}i=""+i,o=""+o;let c;if(f&&(c=s,s=void 0),!e.allowSelfLoops&&i===o)throw new $e(`Graph.${t}: source & target are the same ("${i}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let d=e._nodes.get(i),h=e._nodes.get(o),y,C;if(!r&&(y=e._edges.get(a),y)){if((y.source.key!==i||y.target.key!==o)&&(!n||y.source.key!==o||y.target.key!==i))throw new $e(`Graph.${t}: inconsistency detected when attempting to merge the "${a}" edge with "${i}" source & "${o}" target vs. ("${y.source.key}", "${y.target.key}").`);C=y}if(!C&&!e.multi&&d&&(C=n?d.undirected[o]:d.out[o]),C){const q=[C.key,!1,!1,!1];if(f?!c:!s)return q;if(f){const se=C.attributes;C.attributes=c(se),e.emit("edgeAttributesUpdated",{type:"replace",key:C.key,attributes:C.attributes})}else Ut(C.attributes,s),e.emit("edgeAttributesUpdated",{type:"merge",key:C.key,attributes:C.attributes,data:s});return q}s=s||{},f&&c&&(s=c(s));const L={key:null,undirected:n,source:i,target:o,attributes:s};if(r)a=e._edgeKeyGenerator();else if(a=""+a,e._edges.has(a))throw new $e(`Graph.${t}: the "${a}" edge already exists in the graph.`);let k=!1,U=!1;d||(d=Jc(e,i,{}),k=!0,i===o&&(h=d,U=!0)),h||(h=Jc(e,o,{}),U=!0),y=new ni(n,a,d,h,s),e._edges.set(a,y);const B=i===o;return n?(d.undirectedDegree++,h.undirectedDegree++,B&&(d.undirectedLoops++,e._undirectedSelfLoopCount++)):(d.outDegree++,h.inDegree++,B&&(d.directedLoops++,e._directedSelfLoopCount++)),e.multi?y.attachMulti():y.attach(),n?e._undirectedSize++:e._directedSize++,L.key=a,e.emit("edgeAdded",L),[a,!0,k,U]}function jn(e,t){e._edges.delete(t.key);const{source:r,target:n,attributes:a}=t,i=t.undirected,o=r===n;i?(r.undirectedDegree--,n.undirectedDegree--,o&&(r.undirectedLoops--,e._undirectedSelfLoopCount--)):(r.outDegree--,n.inDegree--,o&&(r.directedLoops--,e._directedSelfLoopCount--)),e.multi?t.detachMulti():t.detach(),i?e._undirectedSize--:e._directedSize--,e.emit("edgeDropped",{key:t.key,attributes:a,source:r.key,target:n.key,undirected:i})}class ut extends Ps.exports.EventEmitter{constructor(t){if(super(),t=Ut({},vg,t),typeof t.multi!="boolean")throw new Ne(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${t.multi}".`);if(!lg.has(t.type))throw new Ne(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${t.type}".`);if(typeof t.allowSelfLoops!="boolean")throw new Ne(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${t.allowSelfLoops}".`);const r=t.type==="mixed"?wh:t.type==="directed"?Sh:Rh;cr(this,"NodeDataClass",r);const n="geid_"+hg()+"_";let a=0;const i=()=>{let o;do o=n+a++;while(this._edges.has(o));return o};cr(this,"_attributes",{}),cr(this,"_nodes",new Map),cr(this,"_edges",new Map),cr(this,"_directedSize",0),cr(this,"_undirectedSize",0),cr(this,"_directedSelfLoopCount",0),cr(this,"_undirectedSelfLoopCount",0),cr(this,"_edgeKeyGenerator",i),cr(this,"_options",t),Zc.forEach(o=>cr(this,o,this[o])),Er(this,"order",()=>this._nodes.size),Er(this,"size",()=>this._edges.size),Er(this,"directedSize",()=>this._directedSize),Er(this,"undirectedSize",()=>this._undirectedSize),Er(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),Er(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),Er(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),Er(this,"multi",this._options.multi),Er(this,"type",this._options.type),Er(this,"allowSelfLoops",this._options.allowSelfLoops),Er(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(t){return this._nodes.has(""+t)}hasDirectedEdge(t,r){if(this.type==="undirected")return!1;if(arguments.length===1){const n=""+t,a=this._edges.get(n);return!!a&&!a.undirected}else if(arguments.length===2){t=""+t,r=""+r;const n=this._nodes.get(t);return n?n.out.hasOwnProperty(r):!1}throw new Ne(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(t,r){if(this.type==="directed")return!1;if(arguments.length===1){const n=""+t,a=this._edges.get(n);return!!a&&a.undirected}else if(arguments.length===2){t=""+t,r=""+r;const n=this._nodes.get(t);return n?n.undirected.hasOwnProperty(r):!1}throw new Ne(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(t,r){if(arguments.length===1){const n=""+t;return this._edges.has(n)}else if(arguments.length===2){t=""+t,r=""+r;const n=this._nodes.get(t);return n?typeof n.out<"u"&&n.out.hasOwnProperty(r)||typeof n.undirected<"u"&&n.undirected.hasOwnProperty(r):!1}throw new Ne(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(t,r){if(this.type==="undirected")return;if(t=""+t,r=""+r,this.multi)throw new $e("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const n=this._nodes.get(t);if(!n)throw new Te(`Graph.directedEdge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(r))throw new Te(`Graph.directedEdge: could not find the "${r}" target node in the graph.`);const a=n.out&&n.out[r]||void 0;if(a)return a.key}undirectedEdge(t,r){if(this.type==="directed")return;if(t=""+t,r=""+r,this.multi)throw new $e("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const n=this._nodes.get(t);if(!n)throw new Te(`Graph.undirectedEdge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(r))throw new Te(`Graph.undirectedEdge: could not find the "${r}" target node in the graph.`);const a=n.undirected&&n.undirected[r]||void 0;if(a)return a.key}edge(t,r){if(this.multi)throw new $e("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");t=""+t,r=""+r;const n=this._nodes.get(t);if(!n)throw new Te(`Graph.edge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(r))throw new Te(`Graph.edge: could not find the "${r}" target node in the graph.`);const a=n.out&&n.out[r]||n.undirected&&n.undirected[r]||void 0;if(a)return a.key}areDirectedNeighbors(t,r){t=""+t,r=""+r;const n=this._nodes.get(t);if(!n)throw new Te(`Graph.areDirectedNeighbors: could not find the "${t}" node in the graph.`);return this.type==="undirected"?!1:r in n.in||r in n.out}areOutNeighbors(t,r){t=""+t,r=""+r;const n=this._nodes.get(t);if(!n)throw new Te(`Graph.areOutNeighbors: could not find the "${t}" node in the graph.`);return this.type==="undirected"?!1:r in n.out}areInNeighbors(t,r){t=""+t,r=""+r;const n=this._nodes.get(t);if(!n)throw new Te(`Graph.areInNeighbors: could not find the "${t}" node in the graph.`);return this.type==="undirected"?!1:r in n.in}areUndirectedNeighbors(t,r){t=""+t,r=""+r;const n=this._nodes.get(t);if(!n)throw new Te(`Graph.areUndirectedNeighbors: could not find the "${t}" node in the graph.`);return this.type==="directed"?!1:r in n.undirected}areNeighbors(t,r){t=""+t,r=""+r;const n=this._nodes.get(t);if(!n)throw new Te(`Graph.areNeighbors: could not find the "${t}" node in the graph.`);return this.type!=="undirected"&&(r in n.in||r in n.out)||this.type!=="directed"&&r in n.undirected}areInboundNeighbors(t,r){t=""+t,r=""+r;const n=this._nodes.get(t);if(!n)throw new Te(`Graph.areInboundNeighbors: could not find the "${t}" node in the graph.`);return this.type!=="undirected"&&r in n.in||this.type!=="directed"&&r in n.undirected}areOutboundNeighbors(t,r){t=""+t,r=""+r;const n=this._nodes.get(t);if(!n)throw new Te(`Graph.areOutboundNeighbors: could not find the "${t}" node in the graph.`);return this.type!=="undirected"&&r in n.out||this.type!=="directed"&&r in n.undirected}inDegree(t){t=""+t;const r=this._nodes.get(t);if(!r)throw new Te(`Graph.inDegree: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:r.inDegree}outDegree(t){t=""+t;const r=this._nodes.get(t);if(!r)throw new Te(`Graph.outDegree: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:r.outDegree}directedDegree(t){t=""+t;const r=this._nodes.get(t);if(!r)throw new Te(`Graph.directedDegree: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:r.inDegree+r.outDegree}undirectedDegree(t){t=""+t;const r=this._nodes.get(t);if(!r)throw new Te(`Graph.undirectedDegree: could not find the "${t}" node in the graph.`);return this.type==="directed"?0:r.undirectedDegree}inboundDegree(t){t=""+t;const r=this._nodes.get(t);if(!r)throw new Te(`Graph.inboundDegree: could not find the "${t}" node in the graph.`);let n=0;return this.type!=="directed"&&(n+=r.undirectedDegree),this.type!=="undirected"&&(n+=r.inDegree),n}outboundDegree(t){t=""+t;const r=this._nodes.get(t);if(!r)throw new Te(`Graph.outboundDegree: could not find the "${t}" node in the graph.`);let n=0;return this.type!=="directed"&&(n+=r.undirectedDegree),this.type!=="undirected"&&(n+=r.outDegree),n}degree(t){t=""+t;const r=this._nodes.get(t);if(!r)throw new Te(`Graph.degree: could not find the "${t}" node in the graph.`);let n=0;return this.type!=="directed"&&(n+=r.undirectedDegree),this.type!=="undirected"&&(n+=r.inDegree+r.outDegree),n}inDegreeWithoutSelfLoops(t){t=""+t;const r=this._nodes.get(t);if(!r)throw new Te(`Graph.inDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:r.inDegree-r.directedLoops}outDegreeWithoutSelfLoops(t){t=""+t;const r=this._nodes.get(t);if(!r)throw new Te(`Graph.outDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:r.outDegree-r.directedLoops}directedDegreeWithoutSelfLoops(t){t=""+t;const r=this._nodes.get(t);if(!r)throw new Te(`Graph.directedDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:r.inDegree+r.outDegree-r.directedLoops*2}undirectedDegreeWithoutSelfLoops(t){t=""+t;const r=this._nodes.get(t);if(!r)throw new Te(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="directed"?0:r.undirectedDegree-r.undirectedLoops*2}inboundDegreeWithoutSelfLoops(t){t=""+t;const r=this._nodes.get(t);if(!r)throw new Te(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);let n=0,a=0;return this.type!=="directed"&&(n+=r.undirectedDegree,a+=r.undirectedLoops*2),this.type!=="undirected"&&(n+=r.inDegree,a+=r.directedLoops),n-a}outboundDegreeWithoutSelfLoops(t){t=""+t;const r=this._nodes.get(t);if(!r)throw new Te(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);let n=0,a=0;return this.type!=="directed"&&(n+=r.undirectedDegree,a+=r.undirectedLoops*2),this.type!=="undirected"&&(n+=r.outDegree,a+=r.directedLoops),n-a}degreeWithoutSelfLoops(t){t=""+t;const r=this._nodes.get(t);if(!r)throw new Te(`Graph.degreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);let n=0,a=0;return this.type!=="directed"&&(n+=r.undirectedDegree,a+=r.undirectedLoops*2),this.type!=="undirected"&&(n+=r.inDegree+r.outDegree,a+=r.directedLoops*2),n-a}source(t){t=""+t;const r=this._edges.get(t);if(!r)throw new Te(`Graph.source: could not find the "${t}" edge in the graph.`);return r.source.key}target(t){t=""+t;const r=this._edges.get(t);if(!r)throw new Te(`Graph.target: could not find the "${t}" edge in the graph.`);return r.target.key}extremities(t){t=""+t;const r=this._edges.get(t);if(!r)throw new Te(`Graph.extremities: could not find the "${t}" edge in the graph.`);return[r.source.key,r.target.key]}opposite(t,r){t=""+t,r=""+r;const n=this._edges.get(r);if(!n)throw new Te(`Graph.opposite: could not find the "${r}" edge in the graph.`);const a=n.source.key,i=n.target.key;if(t===a)return i;if(t===i)return a;throw new Te(`Graph.opposite: the "${t}" node is not attached to the "${r}" edge (${a}, ${i}).`)}hasExtremity(t,r){t=""+t,r=""+r;const n=this._edges.get(t);if(!n)throw new Te(`Graph.hasExtremity: could not find the "${t}" edge in the graph.`);return n.source.key===r||n.target.key===r}isUndirected(t){t=""+t;const r=this._edges.get(t);if(!r)throw new Te(`Graph.isUndirected: could not find the "${t}" edge in the graph.`);return r.undirected}isDirected(t){t=""+t;const r=this._edges.get(t);if(!r)throw new Te(`Graph.isDirected: could not find the "${t}" edge in the graph.`);return!r.undirected}isSelfLoop(t){t=""+t;const r=this._edges.get(t);if(!r)throw new Te(`Graph.isSelfLoop: could not find the "${t}" edge in the graph.`);return r.source===r.target}addNode(t,r){return yg(this,t,r).key}mergeNode(t,r){if(r&&!Vt(r))throw new Ne(`Graph.mergeNode: invalid attributes. Expecting an object but got "${r}"`);t=""+t,r=r||{};let n=this._nodes.get(t);return n?(r&&(Ut(n.attributes,r),this.emit("nodeAttributesUpdated",{type:"merge",key:t,attributes:n.attributes,data:r})),[t,!1]):(n=new this.NodeDataClass(t,r),this._nodes.set(t,n),this.emit("nodeAdded",{key:t,attributes:r}),[t,!0])}updateNode(t,r){if(r&&typeof r!="function")throw new Ne(`Graph.updateNode: invalid updater function. Expecting a function but got "${r}"`);t=""+t;let n=this._nodes.get(t);if(n){if(r){const i=n.attributes;n.attributes=r(i),this.emit("nodeAttributesUpdated",{type:"replace",key:t,attributes:n.attributes})}return[t,!1]}const a=r?r({}):{};return n=new this.NodeDataClass(t,a),this._nodes.set(t,n),this.emit("nodeAdded",{key:t,attributes:a}),[t,!0]}dropNode(t){t=""+t;const r=this._nodes.get(t);if(!r)throw new Te(`Graph.dropNode: could not find the "${t}" node in the graph.`);let n;if(this.type!=="undirected"){for(const a in r.out){n=r.out[a];do jn(this,n),n=n.next;while(n)}for(const a in r.in){n=r.in[a];do jn(this,n),n=n.next;while(n)}}if(this.type!=="directed")for(const a in r.undirected){n=r.undirected[a];do jn(this,n),n=n.next;while(n)}this._nodes.delete(t),this.emit("nodeDropped",{key:t,attributes:r.attributes})}dropEdge(t){let r;if(arguments.length>1){const n=""+arguments[0],a=""+arguments[1];if(r=hr(this,n,a,this.type),!r)throw new Te(`Graph.dropEdge: could not find the "${n}" -> "${a}" edge in the graph.`)}else if(t=""+t,r=this._edges.get(t),!r)throw new Te(`Graph.dropEdge: could not find the "${t}" edge in the graph.`);return jn(this,r),this}dropDirectedEdge(t,r){if(arguments.length<2)throw new $e("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new $e("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");t=""+t,r=""+r;const n=hr(this,t,r,"directed");if(!n)throw new Te(`Graph.dropDirectedEdge: could not find a "${t}" -> "${r}" edge in the graph.`);return jn(this,n),this}dropUndirectedEdge(t,r){if(arguments.length<2)throw new $e("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new $e("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const n=hr(this,t,r,"undirected");if(!n)throw new Te(`Graph.dropUndirectedEdge: could not find a "${t}" -> "${r}" edge in the graph.`);return jn(this,n),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const t=this._nodes.values();let r;for(;r=t.next(),r.done!==!0;)r.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(t){return this._attributes[t]}getAttributes(){return this._attributes}hasAttribute(t){return this._attributes.hasOwnProperty(t)}setAttribute(t,r){return this._attributes[t]=r,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:t}),this}updateAttribute(t,r){if(typeof r!="function")throw new Ne("Graph.updateAttribute: updater should be a function.");const n=this._attributes[t];return this._attributes[t]=r(n),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:t}),this}removeAttribute(t){return delete this._attributes[t],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:t}),this}replaceAttributes(t){if(!Vt(t))throw new Ne("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=t,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(t){if(!Vt(t))throw new Ne("Graph.mergeAttributes: provided attributes are not a plain object.");return Ut(this._attributes,t),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:t}),this}updateAttributes(t){if(typeof t!="function")throw new Ne("Graph.updateAttributes: provided updater is not a function.");return this._attributes=t(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(t,r){if(typeof t!="function")throw new Ne("Graph.updateEachNodeAttributes: expecting an updater function.");if(r&&!Qc(r))throw new Ne("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const n=this._nodes.values();let a,i;for(;a=n.next(),a.done!==!0;)i=a.value,i.attributes=t(i.key,i.attributes);this.emit("eachNodeAttributesUpdated",{hints:r||null})}updateEachEdgeAttributes(t,r){if(typeof t!="function")throw new Ne("Graph.updateEachEdgeAttributes: expecting an updater function.");if(r&&!Qc(r))throw new Ne("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const n=this._edges.values();let a,i,o,s;for(;a=n.next(),a.done!==!0;)i=a.value,o=i.source,s=i.target,i.attributes=t(i.key,i.attributes,o.key,s.key,o.attributes,s.attributes,i.undirected);this.emit("eachEdgeAttributesUpdated",{hints:r||null})}forEachAdjacencyEntry(t){if(typeof t!="function")throw new Ne("Graph.forEachAdjacencyEntry: expecting a callback.");ga(!1,!1,!1,this,t)}forEachAdjacencyEntryWithOrphans(t){if(typeof t!="function")throw new Ne("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");ga(!1,!1,!0,this,t)}forEachAssymetricAdjacencyEntry(t){if(typeof t!="function")throw new Ne("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");ga(!1,!0,!1,this,t)}forEachAssymetricAdjacencyEntryWithOrphans(t){if(typeof t!="function")throw new Ne("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");ga(!1,!0,!0,this,t)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):Ah(this._nodes.keys(),this._nodes.size)}forEachNode(t){if(typeof t!="function")throw new Ne("Graph.forEachNode: expecting a callback.");const r=this._nodes.values();let n,a;for(;n=r.next(),n.done!==!0;)a=n.value,t(a.key,a.attributes)}findNode(t){if(typeof t!="function")throw new Ne("Graph.findNode: expecting a callback.");const r=this._nodes.values();let n,a;for(;n=r.next(),n.done!==!0;)if(a=n.value,t(a.key,a.attributes))return a.key}mapNodes(t){if(typeof t!="function")throw new Ne("Graph.mapNode: expecting a callback.");const r=this._nodes.values();let n,a;const i=new Array(this.order);let o=0;for(;n=r.next(),n.done!==!0;)a=n.value,i[o++]=t(a.key,a.attributes);return i}someNode(t){if(typeof t!="function")throw new Ne("Graph.someNode: expecting a callback.");const r=this._nodes.values();let n,a;for(;n=r.next(),n.done!==!0;)if(a=n.value,t(a.key,a.attributes))return!0;return!1}everyNode(t){if(typeof t!="function")throw new Ne("Graph.everyNode: expecting a callback.");const r=this._nodes.values();let n,a;for(;n=r.next(),n.done!==!0;)if(a=n.value,!t(a.key,a.attributes))return!1;return!0}filterNodes(t){if(typeof t!="function")throw new Ne("Graph.filterNodes: expecting a callback.");const r=this._nodes.values();let n,a;const i=[];for(;n=r.next(),n.done!==!0;)a=n.value,t(a.key,a.attributes)&&i.push(a.key);return i}reduceNodes(t,r){if(typeof t!="function")throw new Ne("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new Ne("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let n=r;const a=this._nodes.values();let i,o;for(;i=a.next(),i.done!==!0;)o=i.value,n=t(n,o.key,o.attributes);return n}nodeEntries(){const t=this._nodes.values();return new rr(()=>{const r=t.next();if(r.done)return r;const n=r.value;return{value:{node:n.key,attributes:n.attributes},done:!1}})}export(){const t=new Array(this._nodes.size);let r=0;this._nodes.forEach((a,i)=>{t[r++]=ug(i,a)});const n=new Array(this._edges.size);return r=0,this._edges.forEach((a,i)=>{n[r++]=fg(this.type,i,a)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:t,edges:n}}import(t,r=!1){if(t instanceof ut)return t.forEachNode((f,c)=>{r?this.mergeNode(f,c):this.addNode(f,c)}),t.forEachEdge((f,c,d,h,y,C,L)=>{r?L?this.mergeUndirectedEdgeWithKey(f,d,h,c):this.mergeDirectedEdgeWithKey(f,d,h,c):L?this.addUndirectedEdgeWithKey(f,d,h,c):this.addDirectedEdgeWithKey(f,d,h,c)}),this;if(!Vt(t))throw new Ne("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(t.attributes){if(!Vt(t.attributes))throw new Ne("Graph.import: invalid attributes. Expecting a plain object.");r?this.mergeAttributes(t.attributes):this.replaceAttributes(t.attributes)}let n,a,i,o,s;if(t.nodes){if(i=t.nodes,!Array.isArray(i))throw new Ne("Graph.import: invalid nodes. Expecting an array.");for(n=0,a=i.length;n<a;n++){o=i[n],cg(o);const{key:f,attributes:c}=o;r?this.mergeNode(f,c):this.addNode(f,c)}}if(t.edges){let f=!1;if(this.type==="undirected"&&(f=!0),i=t.edges,!Array.isArray(i))throw new Ne("Graph.import: invalid edges. Expecting an array.");for(n=0,a=i.length;n<a;n++){s=i[n],dg(s);const{source:c,target:d,attributes:h,undirected:y=f}=s;let C;"key"in s?(C=r?y?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:y?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,C.call(this,s.key,c,d,h)):(C=r?y?this.mergeUndirectedEdge:this.mergeDirectedEdge:y?this.addUndirectedEdge:this.addDirectedEdge,C.call(this,c,d,h))}}return this}nullCopy(t){const r=new ut(Ut({},this._options,t));return r.replaceAttributes(Ut({},this.getAttributes())),r}emptyCopy(t){const r=this.nullCopy(t);return this._nodes.forEach((n,a)=>{const i=Ut({},n.attributes);n=new r.NodeDataClass(a,i),r._nodes.set(a,n)}),r}copy(t){if(t=t||{},typeof t.type=="string"&&t.type!==this.type&&t.type!=="mixed")throw new $e(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${t.type}" because this would mean losing information about the current graph.`);if(typeof t.multi=="boolean"&&t.multi!==this.multi&&t.multi!==!0)throw new $e("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof t.allowSelfLoops=="boolean"&&t.allowSelfLoops!==this.allowSelfLoops&&t.allowSelfLoops!==!0)throw new $e("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const r=this.emptyCopy(t),n=this._edges.values();let a,i;for(;a=n.next(),a.done!==!0;)i=a.value,Ih(r,"copy",!1,i.undirected,i.key,i.source.key,i.target.key,Ut({},i.attributes));return r}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const t={};this._nodes.forEach((i,o)=>{t[o]=i.attributes});const r={},n={};this._edges.forEach((i,o)=>{const s=i.undirected?"--":"->";let f="",c=i.source.key,d=i.target.key,h;i.undirected&&c>d&&(h=c,c=d,d=h);const y=`(${c})${s}(${d})`;o.startsWith("geid_")?this.multi&&(typeof n[y]>"u"?n[y]=0:n[y]++,f+=`${n[y]}. `):f+=`[${o}]: `,f+=y,r[f]=i.attributes});const a={};for(const i in this)this.hasOwnProperty(i)&&!Zc.has(i)&&typeof this[i]!="function"&&typeof i!="symbol"&&(a[i]=this[i]);return a.attributes=this._attributes,a.nodes=t,a.edges=r,cr(a,"constructor",this.constructor),a}}typeof Symbol<"u"&&(ut.prototype[Symbol.for("nodejs.util.inspect.custom")]=ut.prototype.inspect);pg.forEach(e=>{["add","merge","update"].forEach(t=>{const r=e.name(t),n=t==="add"?Ih:mg;e.generateKey?ut.prototype[r]=function(a,i,o){return n(this,r,!0,(e.type||this.type)==="undirected",null,a,i,o,t==="update")}:ut.prototype[r]=function(a,i,o,s){return n(this,r,!1,(e.type||this.type)==="undirected",a,i,o,s,t==="update")}})});Rb(ut);Mb(ut);Jb(ut);sg(ut);class Ch extends ut{constructor(t){const r=Ut({type:"directed"},t);if("multi"in r&&r.multi!==!1)throw new Ne("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(r.type!=="directed")throw new Ne('DirectedGraph.from: inconsistent "'+r.type+'" type in given options!');super(r)}}class Dh extends ut{constructor(t){const r=Ut({type:"undirected"},t);if("multi"in r&&r.multi!==!1)throw new Ne("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(r.type!=="undirected")throw new Ne('UndirectedGraph.from: inconsistent "'+r.type+'" type in given options!');super(r)}}class Gh extends ut{constructor(t){const r=Ut({multi:!0},t);if("multi"in r&&r.multi!==!0)throw new Ne("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(r)}}class Fh extends ut{constructor(t){const r=Ut({type:"directed",multi:!0},t);if("multi"in r&&r.multi!==!0)throw new Ne("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(r.type!=="directed")throw new Ne('MultiDirectedGraph.from: inconsistent "'+r.type+'" type in given options!');super(r)}}class Uh extends ut{constructor(t){const r=Ut({type:"undirected",multi:!0},t);if("multi"in r&&r.multi!==!0)throw new Ne("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(r.type!=="undirected")throw new Ne('MultiUndirectedGraph.from: inconsistent "'+r.type+'" type in given options!');super(r)}}function ii(e){e.from=function(t,r){const n=Ut({},t.options,r),a=new e(n);return a.import(t),a}}ii(ut);ii(Ch);ii(Dh);ii(Gh);ii(Fh);ii(Uh);ut.Graph=ut;ut.DirectedGraph=Ch;ut.UndirectedGraph=Dh;ut.MultiGraph=Gh;ut.MultiDirectedGraph=Fh;ut.MultiUndirectedGraph=Uh;ut.InvalidArgumentsGraphError=Ne;ut.NotFoundGraphError=Te;ut.UsageGraphError=$e;var Mh=function(t){return t!==null&&typeof t=="function"&&typeof t.prototype=="object"&&typeof t.prototype.addUndirectedEdgeWithKey=="function"&&typeof t.prototype.dropNode=="function"},Eg=Mh,_g=function(e,t){if(!Eg(e))throw new Error("graphology-generators/random/clusters: invalid Graph constructor.");t=t||{};var r="clusterDensity"in t?t.clusterDensity:.5,n=t.rng||Math.random,a=t.order,i=t.size,o=t.clusters;if(typeof r!="number"||r>1||r<0)throw new Error("graphology-generators/random/clusters: `clusterDensity` option should be a number between 0 and 1.");if(typeof n!="function")throw new Error("graphology-generators/random/clusters: `rng` option should be a function.");if(typeof a!="number"||a<=0)throw new Error("graphology-generators/random/clusters: `order` option should be a positive number.");if(typeof i!="number"||i<=0)throw new Error("graphology-generators/random/clusters: `size` option should be a positive number.");if(typeof o!="number"||o<=0)throw new Error("graphology-generators/random/clusters: `clusters` option should be a positive number.");var s=new e;if(!a)return s;var f=new Array(o),c,d,h;for(h=0;h<o;h++)f[h]=[];for(h=0;h<a;h++)c=n()*o|0,s.addNode(h,{cluster:c}),f[c].push(h);if(!i)return s;var y,C,L;for(h=0;h<i;h++){if(n()<1-r){y=n()*a|0;do C=n()*a|0;while(y===C)}else{if(c=n()*o|0,d=f[c],L=d.length,!L||L<2)continue;y=d[n()*L|0];do C=d[n()*L|0];while(y===C)}s.multi?s.addEdge(y,C):s.mergeEdge(y,C)}return s},Vr={},bg=hs,gg=function(t){if(!bg(t))throw new Error("graphology-metrics/simple-size: the given graph is not a valid graphology instance.");if(!t.multi)return t.size;var r=0,n=0;function a(){r++}function i(){n++}return t.forEachNode(function(o){t.type!=="directed"&&t.forEachUndirectedNeighbor(o,a),t.type!=="undirected"&&t.forEachOutNeighbor(o,i)}),r/2+n},Ag=hs,Tg=gg;function wg(e,t){return 2*t/(e*(e-1))}function Sg(e,t){return t/(e*(e-1))}function Rg(e,t){var r=e*(e-1);return t/(r+r/2)}function tn(e,t,r){var n,a;if(arguments.length>3){if(n=r,a=arguments[3],typeof n!="number"||n<0)throw new Error("graphology-metrics/density: given order is not a valid number.");if(typeof a!="number"||a<0)throw new Error("graphology-metrics/density: given size is not a valid number.")}else{if(!Ag(r))throw new Error("graphology-metrics/density: given graph is not a valid graphology instance.");n=r.order,a=r.size,r.multi&&t===!1&&(a=Tg(r))}if(n<2)return 0;e===null&&(e=r.type),t===null&&(t=r.multi);var i;return e==="undirected"?i=wg:e==="directed"?i=Sg:i=Rg,i(n,a)}Vr.abstractDensity=tn;Vr.density=tn.bind(null,null,null);Vr.directedDensity=tn.bind(null,"directed",!1);Vr.undirectedDensity=tn.bind(null,"undirected",!1);Vr.mixedDensity=tn.bind(null,"mixed",!1);Vr.multiDirectedDensity=tn.bind(null,"directed",!0);Vr.multiUndirectedDensity=tn.bind(null,"undirected",!0);Vr.multiMixedDensity=tn.bind(null,"mixed",!0);var Ph=Mh,kh=Vr.abstractDensity;function Lg(e,t){if(!Ph(e))throw new Error("graphology-generators/random/erdos-renyi: invalid Graph constructor.");var r=t.order,n=t.probability,a=t.rng||Math.random,i=new e;if(typeof t.approximateSize=="number"&&(n=kh(i.type,!1,r,t.approximateSize)),typeof r!="number"||r<=0)throw new Error("graphology-generators/random/erdos-renyi: invalid `order`. Should be a positive number.");if(typeof n!="number"||n<0||n>1)throw new Error("graphology-generators/random/erdos-renyi: invalid `probability`. Should be a number between 0 and 1. Or maybe you gave an `approximateSize` exceeding the graph's density.");if(typeof a!="function")throw new Error("graphology-generators/random/erdos-renyi: invalid `rng`. Should be a function.");var o,s;for(o=0;o<r;o++)i.addNode(o);if(n<=0)return i;for(o=0;o<r;o++)for(s=o+1;s<r;s++)i.type!=="directed"&&a()<n&&i.addUndirectedEdge(o,s),i.type!=="undirected"&&(a()<n&&i.addDirectedEdge(o,s),a()<n&&i.addDirectedEdge(s,o));return i}function xg(e,t){if(!Ph(e))throw new Error("graphology-generators/random/erdos-renyi: invalid Graph constructor.");var r=t.order,n=t.probability,a=t.rng||Math.random,i=new e;if(typeof t.approximateSize=="number"&&(n=kh(i.type,!1,r,t.approximateSize)),typeof r!="number"||r<=0)throw new Error("graphology-generators/random/erdos-renyi: invalid `order`. Should be a positive number.");if(typeof n!="number"||n<0||n>1)throw new Error("graphology-generators/random/erdos-renyi: invalid `probability`. Should be a number between 0 and 1. Or maybe you gave an `approximateSize` exceeding the graph's density.");if(typeof a!="function")throw new Error("graphology-generators/random/erdos-renyi: invalid `rng`. Should be a function.");for(var o=0;o<r;o++)i.addNode(o);if(n<=0)return i;var s=-1,f=Math.log(1-n),c,d;if(i.type!=="undirected")for(d=0;d<r;){for(c=Math.log(1-a()),s+=1+(c/f|0),d===s&&s++;d<r&&r<=s;)s-=r,d++,d===s&&s++;d<r&&i.addDirectedEdge(d,s)}if(s=-1,i.type!=="directed")for(d=1;d<r;){for(c=Math.log(1-a()),s+=1+(c/f|0);s>=d&&d<r;)s-=d,d++;d<r&&i.addUndirectedEdge(d,s)}return i}Lg.sparse=xg;var Ng=_g,Ft=(e=>(e.GRAPHOLOGY="graphology",e.ANTV_LAYOUT="@antv/layout",e.ANTV_LAYOUT_WASM_SINGLETHREAD="@antv/layout-wasm - singlethread",e.ANTV_LAYOUT_WASM_MULTITHREADS="@antv/layout-wasm - multithreads",e))(Ft||{});const Og=async()=>{const e={},t=()=>{const d=Ng(ut,{order:1e3,size:2e3,clusters:5});d.edges().forEach(function(y,C){d.setEdgeAttribute(y,"weight",1)}),d.nodes().forEach(function(y){d.setNodeAttribute(y,"x",Math.random()),d.setNodeAttribute(y,"y",Math.random())});const h=ed(d);return{desc:"Creates a graph with the desired number of nodes & edges and having a given number of clusters. Generated by Graphology Generators.",[Ft.GRAPHOLOGY]:d,[Ft.ANTV_LAYOUT]:Ig(d),[Ft.ANTV_LAYOUT_WASM_SINGLETHREAD]:h,[Ft.ANTV_LAYOUT_WASM_MULTITHREADS]:h}},r=(f,c)=>async()=>{const h=await(await fetch(f)).json();h.nodes.forEach(L=>{L.x===void 0&&(L.x=Math.random()),L.y===void 0&&(L.y=Math.random())}),h.edges.forEach(L=>{L.weight===void 0||L.weight===null?L.weight=1:L.weight=Number(L.weight)});const y=Cg(h),C=ed(y);return{desc:c,[Ft.GRAPHOLOGY]:y,[Ft.ANTV_LAYOUT]:h,[Ft.ANTV_LAYOUT_WASM_SINGLETHREAD]:C,[Ft.ANTV_LAYOUT_WASM_MULTITHREADS]:C}},[n,a,i,o,s]=await Promise.all([t(),r("https://gw.alipayobjects.com/os/antvdemo/assets/data/relations.json",'A small dataset of "relations" between people.')(),r("https://gw.alipayobjects.com/os/basement_prod/da5a1b47-37d6-44d7-8d10-f3e046dabf82.json","Netscience with 1589 nodes & 2742 edges.")(),r("https://gw.alipayobjects.com/os/basement_prod/0b9730ff-0850-46ff-84d0-1d4afecd43e6.json","Eva with 8322 nodes & 5421 edges.")(),r("https://gw.alipayobjects.com/os/basement_prod/7bacd7d1-4119-4ac1-8be3-4c4b9bcbc25f.json","A dataset for regions on earth.")()]);return e["random-clusters"]=n,e.relations=a,e.netscience=i,e.eva=o,e.regions=s,e},Ig=e=>({nodes:e.nodes().map(t=>({id:t,x:e.getNodeAttribute(t,"x"),y:e.getNodeAttribute(t,"y")})),edges:e.edges().map(t=>({source:e.source(t),target:e.target(t),weight:e.getEdgeAttribute(t,"weight")}))}),Cg=({nodes:e,edges:t})=>{const r=new ut;return e.forEach(({id:n,x:a,y:i})=>{r.hasNode(n)||r.addNode(n,{x:a,y:i})}),t.forEach(({source:n,target:a,weight:i})=>{r.addEdge(n,a,{weight:i})}),r},ed=e=>{const t=[],r=[],n=[],a=[],i={};return e.nodes().forEach((o,s)=>{i[o]=s,t.push(e.getNodeAttribute(o,"x"),e.getNodeAttribute(o,"y")),r.push(1)}),e.edges().forEach(o=>{const s=e.getEdgeAttribute(o,"weight"),f=i[e.source(o)],c=i[e.target(o)];f!==void 0&&c!==void 0&&(n.push([c,f]),a.push(s),r[f]+=s,r[c]+=s)}),{nodes:t,masses:r,edges:n,weights:a}},Vs=[{name:Ft.GRAPHOLOGY},{name:Ft.ANTV_LAYOUT},{name:Ft.ANTV_LAYOUT_WASM_SINGLETHREAD},{name:Ft.ANTV_LAYOUT_WASM_MULTITHREADS}],td=document.getElementById("mask"),ts=document.getElementById("dataset"),Dg=document.getElementById("dataset-desc"),Gg=document.getElementById("layout"),Fg=document.getElementById("run"),Yn=Vs.map(({name:e})=>document.getElementById(e).getContext("2d")),rd=Vs.map((e,t)=>Yn[t].canvas.parentElement.querySelector("span")),Ug=Vs.map(({name:e},t)=>{const r=document.getElementById(e+"_checkbox");return r.onchange=()=>{Yn[t].canvas.parentElement.style.display=r.checked?"block":"none"},r}),Mg=async()=>{const e=await window.layoutWASM.initThreads(!1),t=await window.layoutWASM.initThreads(!0);return[e.force,t.force]},Pg=async(e,t,r,n,a)=>{const i=performance.now(),{nodes:o,edges:s}=await r(n,a);t.innerHTML=`${(performance.now()-i).toFixed(2)}ms`,fy(e,o,s)};(async()=>{console.time("Load datasets");const e=await Og();ts.onchange=()=>{Dg.innerHTML=e[ts.value].desc},console.timeEnd("Load datasets"),console.time("Init WASM threads");const[t,r]=await Mg();console.timeEnd("Init WASM threads");const n=[{name:Ft.GRAPHOLOGY,methods:{forceatlas2:K0}},{name:Ft.ANTV_LAYOUT,methods:{forceatlas2:q0,force2:Q0,fruchterman:J0}},{name:Ft.ANTV_LAYOUT_WASM_SINGLETHREAD,methods:{forceatlas2:zc,force2:Yc}},{name:Ft.ANTV_LAYOUT_WASM_MULTITHREADS,methods:{forceatlas2:zc,force2:Yc}}];Fg.onclick=async()=>{td.style.display="flex";const a=e[ts.value],i=Gg.value;await Promise.all(n.map(async({name:o,methods:s},f)=>{s[i]&&Ug[f].checked?await Pg(Yn[f],rd[f],s[i],o===Ft.ANTV_LAYOUT?JSON.parse(JSON.stringify(a[o])):a[o],o===Ft.ANTV_LAYOUT_WASM_MULTITHREADS?r:t):(Yn[f].clearRect(0,0,Yn[f].canvas.width,Yn[f].canvas.height),rd[f].innerHTML="not implemented.")})),td.style.display="none"}})();
