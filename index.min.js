!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.layoutWASM=e():t.layoutWASM=e()}(self,(function(){return(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{ForceAtlas2Layout:()=>C,ForceLayout:()=>q,FruchtermanLayout:()=>T,initThreads:()=>b,supportsThreads:()=>N});var r=function(){return r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function n(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function o(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}Object.create,Object.create;const i=()=>(async t=>{try{return"undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(t)}catch(t){return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])),a=Symbol("Comlink.proxy"),s=Symbol("Comlink.endpoint"),u=Symbol("Comlink.releaseProxy"),h=Symbol("Comlink.thrown"),d=t=>"object"==typeof t&&null!==t||"function"==typeof t,l=new Map([["proxy",{canHandle:t=>d(t)&&t[a],serialize(t){const{port1:e,port2:r}=new MessageChannel;return c(t,e),[r,[r]]},deserialize:t=>(t.start(),g(t))}],["throw",{canHandle:t=>d(t)&&h in t,serialize({value:t}){let e;return e=t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[e,[]]},deserialize(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}}]]);function c(t,e=self){e.addEventListener("message",(function r(n){if(!n||!n.data)return;const{id:o,type:i,path:s}=Object.assign({path:[]},n.data),u=(n.data.argumentList||[]).map(x);let d;try{const e=s.slice(0,-1).reduce(((t,e)=>t[e]),t),r=s.reduce(((t,e)=>t[e]),t);switch(i){case"GET":d=r;break;case"SET":e[s.slice(-1)[0]]=x(n.data.value),d=!0;break;case"APPLY":d=r.apply(e,u);break;case"CONSTRUCT":d=function(t){return Object.assign(t,{[a]:!0})}(new r(...u));break;case"ENDPOINT":{const{port1:e,port2:r}=new MessageChannel;c(t,r),d=function(t,e){return m.set(t,e),t}(e,[e])}break;case"RELEASE":d=void 0;break;default:return}}catch(t){d={value:t,[h]:0}}Promise.resolve(d).catch((t=>({value:t,[h]:0}))).then((t=>{const[n,a]=w(t);e.postMessage(Object.assign(Object.assign({},n),{id:o}),a),"RELEASE"===i&&(e.removeEventListener("message",r),f(e))}))})),e.start&&e.start()}function f(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function g(t,e){return v(t,[],e)}function p(t){if(t)throw new Error("Proxy has been released and is not useable")}function v(t,e=[],r=function(){}){let n=!1;const o=new Proxy(r,{get(r,i){if(p(n),i===u)return()=>E(t,{type:"RELEASE",path:e.map((t=>t.toString()))}).then((()=>{f(t),n=!0}));if("then"===i){if(0===e.length)return{then:()=>o};const r=E(t,{type:"GET",path:e.map((t=>t.toString()))}).then(x);return r.then.bind(r)}return v(t,[...e,i])},set(r,o,i){p(n);const[a,s]=w(i);return E(t,{type:"SET",path:[...e,o].map((t=>t.toString())),value:a},s).then(x)},apply(r,o,i){p(n);const a=e[e.length-1];if(a===s)return E(t,{type:"ENDPOINT"}).then(x);if("bind"===a)return v(t,e.slice(0,-1));const[u,h]=y(i);return E(t,{type:"APPLY",path:e.map((t=>t.toString())),argumentList:u},h).then(x)},construct(r,o){p(n);const[i,a]=y(o);return E(t,{type:"CONSTRUCT",path:e.map((t=>t.toString())),argumentList:i},a).then(x)}});return o}function y(t){const e=t.map(w);return[e.map((t=>t[0])),(r=e.map((t=>t[1])),Array.prototype.concat.apply([],r))];var r}const m=new WeakMap;function w(t){for(const[e,r]of l)if(r.canHandle(t)){const[n,o]=r.serialize(t);return[{type:"HANDLER",name:e,value:n},o]}return[{type:"RAW",value:t},m.get(t)||[]]}function x(t){switch(t.type){case"HANDLER":return l.get(t.name).deserialize(t.value);case"RAW":return t.value}}function E(t,e,r){return new Promise((n=>{const o=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");t.addEventListener("message",(function e(r){r.data&&r.data.id&&r.data.id===o&&(t.removeEventListener("message",e),n(r.data))})),t.start&&t.start(),t.postMessage(Object.assign({id:o},e),r)}))}function N(){return n(this,void 0,void 0,(function(){return o(this,(function(t){return[2,i()]}))}))}function b(t){return void 0===t&&(t=!0),n(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,g(new Worker(new URL("./wasm-worker.js",void 0),{type:"module"}))(t)];case 1:return[2,e.sent()]}}))}))}var M={913:t=>{var e=Object.prototype.hasOwnProperty,r="~";function n(){}function o(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function i(t,e,n,i,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new o(n,i||t,a),u=r?r+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],s]:t._events[u].push(s):(t._events[u]=s,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var t,n,o=[];if(0===this._eventsCount)return o;for(n in t=this._events)e.call(t,n)&&o.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},s.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,a=new Array(i);o<i;o++)a[o]=n[o].fn;return a},s.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},s.prototype.emit=function(t,e,n,o,i,a){var s=r?r+t:t;if(!this._events[s])return!1;var u,h,d=this._events[s],l=arguments.length;if(d.fn){switch(d.once&&this.removeListener(t,d.fn,void 0,!0),l){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,e),!0;case 3:return d.fn.call(d.context,e,n),!0;case 4:return d.fn.call(d.context,e,n,o),!0;case 5:return d.fn.call(d.context,e,n,o,i),!0;case 6:return d.fn.call(d.context,e,n,o,i,a),!0}for(h=1,u=new Array(l-1);h<l;h++)u[h-1]=arguments[h];d.fn.apply(d.context,u)}else{var c,f=d.length;for(h=0;h<f;h++)switch(d[h].once&&this.removeListener(t,d[h].fn,void 0,!0),l){case 1:d[h].fn.call(d[h].context);break;case 2:d[h].fn.call(d[h].context,e);break;case 3:d[h].fn.call(d[h].context,e,n);break;case 4:d[h].fn.call(d[h].context,e,n,o);break;default:if(!u)for(c=1,u=new Array(l-1);c<l;c++)u[c-1]=arguments[c];d[h].fn.apply(d[h].context,u)}}return!0},s.prototype.on=function(t,e,r){return i(this,t,e,r,!1)},s.prototype.once=function(t,e,r){return i(this,t,e,r,!0)},s.prototype.removeListener=function(t,e,n,o){var i=r?r+t:t;if(!this._events[i])return this;if(!e)return a(this,i),this;var s=this._events[i];if(s.fn)s.fn!==e||o&&!s.once||n&&s.context!==n||a(this,i);else{for(var u=0,h=[],d=s.length;u<d;u++)(s[u].fn!==e||o&&!s[u].once||n&&s[u].context!==n)&&h.push(s[u]);h.length?this._events[i]=1===h.length?h[0]:h:a(this,i)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&a(this,e)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,t.exports=s},370:(t,e,r)=>{var n=r(331),o=["stopLayout","calculateLayout"];t.exports=function(){var t=new Worker(URL.createObjectURL(new Blob(['var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{calculateLayout:()=>jn,stopLayout:()=>Ln});var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function o(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function i(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function a(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function u(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}Object.create,Object.create;const h=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[],i=this._events["*"]||[],a=function(n){for(var o=n.length,i=0;i<o;i++)if(n[i]){var a=n[i],s=a.callback;a.once&&(n.splice(i,1),0===n.length&&delete e._events[t],o--,i--),s.apply(e,r)}};a(o),a(i)},t.prototype.off=function(t,e){if(t)if(e){for(var r=this._events[t]||[],n=r.length,o=0;o<n;o++)r[o].callback===e&&(r.splice(o,1),n--,o--);0===r.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function d(t,e,r,n){for(;t.length;){const o=t.shift();if(r(o))return!0;e.add(o.id),n(o.id).forEach((r=>{e.has(r.id)||(e.add(r.id),t.push(r))}))}return!1}function l(t,e,r,n){if(r(t))return!0;e.add(t.id);for(const o of n(t.id))if(!e.has(o.id)&&l(o,e,r,n))return!0;return!1}class c extends h{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const r=e.find((e=>e.type===t.type&&e.id===t.id&&e.propertyName===t.propertyName));r?r.newValue=t.newValue:e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const r=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),r=this.bothEdgesMap.get(t);r?.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((e=>{e.childrenMap.get(t)?.forEach((t=>{e.parentMap.delete(t.id)})),e.parentMap.delete(t),e.childrenMap.delete(t)})),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){const n=this.getNode(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateNodeDataProperty(t,e,r)}))}))}updateNodeData(...t){const e=t[0],r=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:o})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),o.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),o=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),o.delete(e),i.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.source,o=e;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:o})}))}updateEdgeTarget(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.target,o=e;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:o})}))}updateEdgeDataProperty(t,e,r){const n=this.getEdge(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}updateEdgeData(...t){const e=t[0],r=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:o})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateEdgeDataProperty(t,e,r)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const r=[],n=Array.isArray(t)?t:[t];for(;n.length;){const t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach((t=>{t.children?.forEach((r=>{this.setParent(r.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const r=this.treeIndices.get(e).childrenMap.get(t);return Array.from(r||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const r=[];let n,o=this.getNode(t);for(;n=this.getParent(o.id,e);)r.push(n),o=n;return r}setParent(t,e,r){this.checkTreeExistence(r);const n=this.treeIndices.get(r),o=this.getNode(t),i=n.parentMap.get(t),a=this.getNode(e);n.parentMap.set(t,a),i&&n.childrenMap.get(i.id)?.delete(o);let s=n.childrenMap.get(a.id);s||(s=new Set,n.childrenMap.set(a.id,s)),s.add(o),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:i?.id,newParentId:a.id})}))}dfsTree(t,e,r){return l(this.getNode(t),new Set,e,(t=>this.getChildren(t,r)))}bfsTree(t,e,r){return d([this.getNode(t)],new Set,e,(t=>this.getChildren(t,r)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return d([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return l(this.getNode(t),new Set,e,n)}clone(){const t=this.getAllNodes().map((t=>({...t,data:{...t.data}}))),e=this.getAllEdges().map((t=>({...t,data:{...t.data}}))),r=new c({nodes:t,edges:e});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},n)=>{const o=new Map;t.forEach(((t,e)=>{o.set(e,r.getNode(t.id))}));const i=new Map;e.forEach(((t,e)=>{i.set(e,new Set(Array.from(t).map((t=>r.getNode(t.id)))))})),r.treeIndices.set(n,{parentMap:o,childrenMap:i})})),r}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var f=/-(\\w)/g,g=(function(t){return t.replace(f,(function(t,e){return e?e.toUpperCase():""}))},Object.create(null),Array.isArray),p=function(t){for(var e=[],r=t.length,n=0;n<r;n+=1){e[n]=[];for(var o=0;o<r;o+=1)n===o?e[n][o]=0:0!==t[n][o]&&t[n][o]?e[n][o]=t[n][o]:e[n][o]=1/0}for(var i=0;i<r;i+=1)for(n=0;n<r;n+=1)for(o=0;o<r;o+=1)e[n][o]>e[n][i]+e[i][o]&&(e[n][o]=e[n][i]+e[i][o]);return e},v=function(t,e){var r=t.nodes,n=t.edges,o=[],i={};if(!r)throw new Error("invalid nodes data!");return r&&r.forEach((function(t,e){i[t.id]=e,o.push([])})),null==n||n.forEach((function(t){var r=t.source,n=t.target,a=i[r],s=i[n];void 0!==a&&void 0!==s&&(o[a][s]=1,e||(o[s][a]=1))})),o},y=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},m={}.toString;const w=function(t,e){return m.call(t)==="[object "+e+"]"},x=function(t){return w(t,"Number")};var E=function(t){if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var e=[];return t.forEach((function(t){e.push(t)})),e.map((function(t){return E(t)}))}if("object"==typeof t){var r={};return Object.keys(t).forEach((function(e){r[e]=E(t[e])})),r}return t},N=function(t,e){var r=E(t);return r.data=r.data||{},e&&(x(r.data.x)||(r.data.x=Math.random()*e[0]),x(r.data.y)||(r.data.y=Math.random()*e[1])),r};const b=function(t){return"function"==typeof t},M=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function S(t,e){return b(e)?e:x(e)?function(){return e}:function(){return t}}function k(t,e,r){return void 0===r&&(r=!0),e||0===e?b(e)?e:x(e)?function(){return e}:g(e)?function(){if(r){var n=Math.max.apply(Math,u([],s(e)));return isNaN(n)?t:n}return e}:M(e)?function(){if(r){var n=Math.max(e.width,e.height);return isNaN(n)?t:n}return[e.width,e.height]}:function(){return t}:function(e){var r=(e.data||{}).size;return r?g(r)?r[0]>r[1]?r[0]:r[1]:M(r)?r.width>r.height?r.width:r.height:r:t}}var A=function(t,e){var r;return r=x(e)?function(){return e}:b(e)?e:function(){return 0},t?g(t)?function(e){return(t[0]>t[1]?t[0]:t[1])+r(e)}:function(e){return t+r(e)}:function(t){var e,n;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return Math.max(t.data.bboxSize[0],t.data.bboxSize[1])+r(t);if(null===(n=t.data)||void 0===n?void 0:n.size){if(g(t.data.size))return Math.max(t.data.size[0],t.data.size[1])+r(t);var o=t.data.size;return M(o)?(o.width>o.height?o.width:o.height)+r(t):o+r(t)}return 10+r(t)}},_=function(t,e,r){var o=t.getAllNodes(),i=t.getAllEdges();return(null==o?void 0:o.length)?1===o.length?(e&&t.mergeNodeData(o[0].id,{x:r[0],y:r[1]}),{nodes:[n(n({},o[0]),{data:n(n({},o[0].data),{x:r[0],y:r[1]})})],edges:i}):void 0:{nodes:[],edges:i}},z={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},R=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="circular",this.options=n(n({},z),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericCircularLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericCircularLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericCircularLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,u,h,d,l,c,f,g,p,v,y,m,w,x,E,b,M,A,z,R,O,P,T,C,q,L,j,F,V,B,G,W,$,U;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,u=o.height,h=o.center,d=o.divisions,l=o.startAngle,c=void 0===l?0:l,f=o.endAngle,g=void 0===f?2*Math.PI:f,p=o.angleRatio,v=o.ordering,y=o.clockwise,m=o.nodeSpacing,w=o.nodeSize,x=e.getAllNodes(),E=e.getAllEdges(),b=s(D(i,u,h),3),M=b[0],A=b[1],z=b[2],!(R=null==x?void 0:x.length)||1===R)return[2,_(e,t,z)];for(O=(g-c)/R,P=o.radius,T=o.startRadius,C=o.endRadius,m?(q=S(10,m),L=k(10,w),j=-1/0,x.forEach((function(t){var e=L(t);j<e&&(j=e)})),F=0,x.forEach((function(t,e){F+=0===e?j||10:(q(t)||0)+(j||10)})),P=F/(2*Math.PI)):P||T||C?!T&&C?T=C:T&&!C&&(C=T):P=Math.min(A,M)/2,V=O*p,B=[],B="topology"===v?I(e,x):"topology-directed"===v?I(e,x,!0):"degree"===v?function(t,e){var r=[];return e.forEach((function(t,e){r.push(N(t))})),r.sort((function(e,r){return t.getDegree(e.id,"both")-t.getDegree(r.id,"both")})),r}(e,x):x.map((function(t){return N(t)})),G=Math.ceil(R/d),W=0;W<R;++W)($=P)||null===T||null===C||($=T+W*(C-T)/(R-1)),$||($=10+100*W/(R-1)),U=c+W%G*V+2*Math.PI/d*Math.floor(W/G),y||(U=g-W%G*V-2*Math.PI/d*Math.floor(W/G)),B[W].data.x=z[0]+Math.cos(U)*$,B[W].data.y=z[1]+Math.sin(U)*$;return t&&B.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:B,edges:E}]}))}))},t}(),I=function(t,e,r){void 0===r&&(r=!1);var n=[N(e[0])],o={},i=e.length;o[e[0].id]=!0;var a=0;return e.forEach((function(s,u){if(0!==u)if(u!==i-1&&t.getDegree(s.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(n[a].id,s.id)||o[s.id]){for(var h=r?t.getSuccessors(n[a].id):t.getNeighbors(n[a].id),d=!1,l=0;l<h.length;l++){var c=h[l];if(t.getDegree(c.id)===t.getDegree(s.id)&&!o[c.id]){n.push(N(c)),o[c.id]=!0,d=!0;break}}for(var f=0;!d&&(o[e[f].id]||(n.push(N(e[f])),o[e[f].id]=!0,d=!0),++f!==i););}else n.push(N(s)),o[s.id]=!0,a++})),n},D=function(t,e,r){var n=t,o=e,i=r;return n||"undefined"==typeof window||(n=window.innerWidth),o||"undefined"==typeof window||(o=window.innerHeight),i||(i=[n/2,o/2]),[n,o,i]};const O=function(t){return w(t,"String")};var P={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},T=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="concentric",this.options=n(n({},P),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericConcentricLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericConcentricLayout(!0,t,e),[2]}))}))},t.prototype.genericConcentricLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,p,v,y,m,w,E,S,k,A,z,R,I,D,P,T,C,q,L,j,F,V,B,G,W,$,U,H,K,Y;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,h=o.sortBy,d=o.maxLevelDiff,l=o.sweep,c=o.clockwise,f=o.equidistant,p=o.preventOverlap,v=o.startAngle,y=void 0===v?1.5*Math.PI:v,m=o.nodeSize,w=o.nodeSpacing,E=e.getAllNodes(),S=e.getAllEdges(),k=s||"undefined"==typeof window?s:window.innerWidth,A=u||"undefined"==typeof window?u:window.innerHeight,z=i||[k/2,A/2],!(null==E?void 0:E.length)||1===E.length)return[2,_(e,t,z)];if(R=[],D=0,I=g(m)?Math.max(m[0],m[1]):m,g(w)?D=Math.max(w[0],w[1]):x(w)&&(D=w),E.forEach((function(t){var e=N(t);R.push(e);var r=I,n=e.data;g(n.size)?r=Math.max(n.size[0],n.size[1]):x(n.size)?r=n.size:M(n.size)&&(r=Math.max(n.size.width,n.size.height)),I=Math.max(I,r),b(w)&&(D=Math.max(w(t),D))})),P={},R.forEach((function(t,e){P[t.id]=e})),O(T=h)&&void 0!==R[0].data[T]||(T="degree"),"degree"===T?R.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):R.sort((function(t,e){return e.data[T]-t.data[T]})),C=R[0],q=(d||("degree"===T?e.getDegree(C.id,"both"):C.data[T]))/4,j=(L=[{nodes:[]}])[0],R.forEach((function(t){if(j.nodes.length>0){var r="degree"===T?Math.abs(e.getDegree(j.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(j.nodes[0].data[T]-t.data[T]);q&&r>=q&&(j={nodes:[]},L.push(j))}j.nodes.push(t)})),F=I+D,p||(V=L.length>0&&L[0].nodes.length>1,B=Math.min(k,A)/2-F,G=B/(L.length+(V?1:0)),F=Math.min(F,G)),W=0,L.forEach((function(t){var e=void 0===l?2*Math.PI-2*Math.PI/t.nodes.length:l;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&p){var r=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),o=Math.sqrt(F*F/(r*r+n*n));W=Math.max(o,W)}t.r=W,W+=F})),f){for($=0,U=0,H=0;H<L.length;H++)K=L[H],Y=(K.r||0)-U,$=Math.max($,Y);U=0,L.forEach((function(t,e){0===e&&(U=t.r||0),t.r=U,U+=$}))}return L.forEach((function(t){var e=t.dTheta||0,r=t.r||0;t.nodes.forEach((function(t,n){var o=y+(c?1:-1)*e*n;t.data.x=z[0]+r*Math.cos(o),t.data.y=z[1]+r*Math.sin(o)}))})),t&&R.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:R,edges:S}]}))}))},t}();function C(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i,a,s,u,h,d,l,c,f=t._root,g={data:n},p=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!f)return t._root=g,t;for(;f.length;)if((h=e>=(i=(p+y)/2))?p=i:y=i,(d=r>=(a=(v+m)/2))?v=a:m=a,o=f,!(f=f[l=d<<1|h]))return o[l]=g,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&r===u)return g.next=f,o?o[l]=g:t._root=g,t;do{o=o?o[l]=new Array(4):t._root=new Array(4),(h=e>=(i=(p+y)/2))?p=i:y=i,(d=r>=(a=(v+m)/2))?v=a:m=a}while((l=d<<1|h)==(c=(u>=a)<<1|s>=i));return o[c]=f,o[l]=g,t}function q(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function L(t){return t[0]}function j(t){return t[1]}function F(t,e,r){var n=new V(null==e?L:e,null==r?j:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function V(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function B(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var G=F.prototype=V.prototype;function W(t){return function(){return t}}function $(t){return 1e-6*(t()-.5)}G.copy=function(){var t,e,r=new V(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=B(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var o=0;o<4;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(4)}):n.target[o]=B(e));return r},G.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return C(this.cover(e,r),e,r,t)},G.addAll=function(t){var e,r,n,o,i=t.length,a=new Array(i),s=new Array(i),u=1/0,h=1/0,d=-1/0,l=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(a[r]=n,s[r]=o,n<u&&(u=n),n>d&&(d=n),o<h&&(h=o),o>l&&(l=o));if(u>d||h>l)return this;for(this.cover(u,h).cover(d,l),r=0;r<i;++r)C(this,a[r],s[r],t[r]);return this},G.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var a,s,u=o-r||1,h=this._root;r>t||t>=o||n>e||e>=i;)switch(s=(e<n)<<1|t<r,(a=new Array(4))[s]=h,h=a,u*=2,s){case 0:o=r+u,i=n+u;break;case 1:r=o-u,i=n+u;break;case 2:o=r+u,n=i-u;break;case 3:r=o-u,n=i-u}this._root&&this._root.length&&(this._root=h)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this},G.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},G.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},G.find=function(t,e,r){var n,o,i,a,s,u,h,d=this._x0,l=this._y0,c=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new q(p,d,l,c,f)),null==r?r=1/0:(d=t-r,l=e-r,c=t+r,f=e+r,r*=r);u=g.pop();)if(!(!(p=u.node)||(o=u.x0)>c||(i=u.y0)>f||(a=u.x1)<d||(s=u.y1)<l))if(p.length){var v=(o+a)/2,y=(i+s)/2;g.push(new q(p[3],v,y,a,s),new q(p[2],o,y,v,s),new q(p[1],v,i,a,y),new q(p[0],o,i,v,y)),(h=(e>=y)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-h],g[g.length-1-h]=u)}else{var m=t-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),x=m*m+w*w;if(x<r){var E=Math.sqrt(r=x);d=t-E,l=e-E,c=t+E,f=e+E,n=p.data}}return n},G.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,r,n,o,i,a,s,u,h,d,l,c,f=this._root,g=this._x0,p=this._y0,v=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((h=i>=(s=(g+v)/2))?g=s:v=s,(d=a>=(u=(p+y)/2))?p=u:y=u,e=f,!(f=f[l=d<<1|h]))return this;if(!f.length)break;(e[l+1&3]||e[l+2&3]||e[l+3&3])&&(r=e,c=l)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(o=f.next)&&delete f.next,n?(o?n.next=o:delete n.next,this):e?(o?e[l]=o:delete e[l],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[c]=f:this._root=f),this):(this._root=o,this)},G.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},G.root=function(){return this._root},G.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},G.visit=function(t){var e,r,n,o,i,a,s=[],u=this._root;for(u&&s.push(new q(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,n=e.x0,o=e.y0,i=e.x1,a=e.y1)&&u.length){var h=(n+i)/2,d=(o+a)/2;(r=u[3])&&s.push(new q(r,h,d,i,a)),(r=u[2])&&s.push(new q(r,n,d,h,a)),(r=u[1])&&s.push(new q(r,h,o,i,d)),(r=u[0])&&s.push(new q(r,n,o,h,d))}return this},G.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new q(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.x1,h=e.y1,d=(a+u)/2,l=(s+h)/2;(i=o[0])&&r.push(new q(i,a,s,d,l)),(i=o[1])&&r.push(new q(i,d,s,u,l)),(i=o[2])&&r.push(new q(i,a,l,d,h)),(i=o[3])&&r.push(new q(i,d,l,u,h))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},G.x=function(t){return arguments.length?(this._x=t,this):this._x},G.y=function(t){return arguments.length?(this._y=t,this):this._y};var U={value:()=>{}};function H(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new K(n)}function K(t){this._=t}function Y(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function J(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=U,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}K.prototype=H.prototype={constructor:K,on:function(t,e){var r,n,o=this._,i=(n=o,(t+"").trim().split(/^|\\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)o[r]=J(o[r],t.name,e);else if(null==e)for(r in o)o[r]=J(o[r],t.name,null);return this}for(;++a<s;)if((r=(t=i[a]).type)&&(r=Y(o[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new K(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};const X=H;var Q,Z,tt=0,et=0,rt=0,nt=1e3,ot=0,it=0,at=0,st="object"==typeof performance&&performance.now?performance:Date,ut="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ht(){return it||(ut(dt),it=st.now()+at)}function dt(){it=0}function lt(){this._call=this._time=this._next=null}function ct(t,e,r){var n=new lt;return n.restart(t,e,r),n}function ft(){it=(ot=st.now())+at,tt=et=0;try{!function(){ht(),++tt;for(var t,e=Q;e;)(t=it-e._time)>=0&&e._call.call(void 0,t),e=e._next;--tt}()}finally{tt=0,function(){for(var t,e,r=Q,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:Q=e);Z=t,pt(n)}(),it=0}}function gt(){var t=st.now(),e=t-ot;e>nt&&(at-=e,ot=t)}function pt(t){tt||(et&&(et=clearTimeout(et)),t-it>24?(t<1/0&&(et=setTimeout(ft,t-st.now()-at)),rt&&(rt=clearInterval(rt))):(rt||(ot=st.now(),rt=setInterval(gt,nt)),tt=1,ut(ft)))}lt.prototype=ct.prototype={constructor:lt,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?ht():+r)+(null==e?0:+e),this._next||Z===this||(Z?Z._next=this:Q=this,Z=this),this._call=t,this._time=r,pt()},stop:function(){this._call&&(this._call=null,this._time=1/0,pt())}};const vt=1664525,yt=1013904223,mt=4294967296;function wt(t){return t.x}function xt(t){return t.y}var Et=10,Nt=Math.PI*(3-Math.sqrt(5));function bt(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,a=.6,s=new Map,u=ct(l),h=X("tick","end"),d=function(){let t=1;return()=>(t=(vt*t+yt)%mt)/mt}();function l(){c(),h.call("tick",e),r<n&&(u.stop(),h.call("end",e))}function c(n){var u,h,d=t.length;void 0===n&&(n=1);for(var l=0;l<n;++l)for(r+=(i-r)*o,s.forEach((function(t){t(r)})),u=0;u<d;++u)null==(h=t[u]).fx?h.x+=h.vx*=a:(h.x=h.fx,h.vx=0),null==h.fy?h.y+=h.vy*=a:(h.y=h.fy,h.vy=0);return e}function f(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var o=Et*Math.sqrt(.5+r),i=r*Nt;e.x=o*Math.cos(i),e.y=o*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,d),e}return null==t&&(t=[]),f(),e={tick:c,restart:function(){return u.restart(l),e},stop:function(){return u.stop(),e},nodes:function(r){return arguments.length?(t=r,f(),s.forEach(g),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(d=t,s.forEach(g),e):d},force:function(t,r){return arguments.length>1?(null==r?s.delete(t):s.set(t,g(r)),e):s.get(t)},find:function(e,r,n){var o,i,a,s,u,h=0,d=t.length;for(null==n?n=1/0:n*=n,h=0;h<d;++h)(a=(o=e-(s=t[h]).x)*o+(i=r-s.y)*i)<n&&(u=s,n=a);return u},on:function(t,r){return arguments.length>1?(h.on(t,r),e):h.on(t)}}}function Mt(){var t,e,r,n,o,i=W(-30),a=1,s=1/0,u=.81;function h(r){var o,i=t.length,a=F(t,wt,xt).visitAfter(l);for(n=r,o=0;o<i;++o)e=t[o],a.visit(c)}function d(){if(t){var e,r,n=t.length;for(o=new Array(n),e=0;e<n;++e)r=t[e],o[r.index]=+i(r,e,t)}}function l(t){var e,r,n,i,a,s=0,u=0;if(t.length){for(n=i=a=0;a<4;++a)(e=t[a])&&(r=Math.abs(e.value))&&(s+=e.value,u+=r,n+=r*e.x,i+=r*e.y);t.x=n/u,t.y=i/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=o[e.data.index]}while(e=e.next)}t.value=s}function c(t,i,h,d){if(!t.value)return!0;var l=t.x-e.x,c=t.y-e.y,f=d-i,g=l*l+c*c;if(f*f/u<g)return g<s&&(0===l&&(g+=(l=$(r))*l),0===c&&(g+=(c=$(r))*c),g<a&&(g=Math.sqrt(a*g)),e.vx+=l*t.value*n/g,e.vy+=c*t.value*n/g),!0;if(!(t.length||g>=s)){(t.data!==e||t.next)&&(0===l&&(g+=(l=$(r))*l),0===c&&(g+=(c=$(r))*c),g<a&&(g=Math.sqrt(a*g)));do{t.data!==e&&(f=o[t.data.index]*n/g,e.vx+=l*f,e.vy+=c*f)}while(t=t.next)}}return h.initialize=function(e,n){t=e,r=n,d()},h.strength=function(t){return arguments.length?(i="function"==typeof t?t:W(+t),d(),h):i},h.distanceMin=function(t){return arguments.length?(a=t*t,h):Math.sqrt(a)},h.distanceMax=function(t){return arguments.length?(s=t*t,h):Math.sqrt(s)},h.theta=function(t){return arguments.length?(u=t*t,h):Math.sqrt(u)},h}function St(t){return t.index}function kt(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function At(t){var e,r,n,o,i,a,s=St,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},h=W(30),d=1;function l(n){for(var o=0,s=t.length;o<d;++o)for(var u,h,l,c,f,g,p,v=0;v<s;++v)h=(u=t[v]).source,c=(l=u.target).x+l.vx-h.x-h.vx||$(a),f=l.y+l.vy-h.y-h.vy||$(a),c*=g=((g=Math.sqrt(c*c+f*f))-r[v])/g*n*e[v],f*=g,l.vx-=c*(p=i[v]),l.vy-=f*p,h.vx+=c*(p=1-p),h.vy+=f*p}function c(){if(n){var a,u,h=n.length,d=t.length,l=new Map(n.map(((t,e)=>[s(t,e,n),t])));for(a=0,o=new Array(h);a<d;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=kt(l,u.source)),"object"!=typeof u.target&&(u.target=kt(l,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(a=0,i=new Array(d);a<d;++a)u=t[a],i[a]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);e=new Array(d),f(),r=new Array(d),g()}}function f(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+u(t[r],r,t)}function g(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+h(t[e],e,t)}return null==t&&(t=[]),l.initialize=function(t,e){n=t,a=e,c()},l.links=function(e){return arguments.length?(t=e,c(),l):t},l.id=function(t){return arguments.length?(s=t,l):s},l.iterations=function(t){return arguments.length?(d=+t,l):d},l.strength=function(t){return arguments.length?(u="function"==typeof t?t:W(+t),f(),l):u},l.distance=function(t){return arguments.length?(h="function"==typeof t?t:W(+t),g(),l):h},l}function _t(t){return t.x+t.vx}function zt(t){return t.y+t.vy}function Rt(t){var e,r,n,o=1,i=1;function a(){for(var t,a,u,h,d,l,c,f=e.length,g=0;g<i;++g)for(a=F(e,_t,zt).visitAfter(s),t=0;t<f;++t)u=e[t],l=r[u.index],c=l*l,h=u.x+u.vx,d=u.y+u.vy,a.visit(p);function p(t,e,r,i,a){var s=t.data,f=t.r,g=l+f;if(!s)return e>h+g||i<h-g||r>d+g||a<d-g;if(s.index>u.index){var p=h-s.x-s.vx,v=d-s.y-s.vy,y=p*p+v*v;y<g*g&&(0===p&&(y+=(p=$(n))*p),0===v&&(y+=(v=$(n))*v),y=(g-(y=Math.sqrt(y)))/y*o,u.vx+=(p*=y)*(g=(f*=f)/(c+f)),u.vy+=(v*=y)*g,s.vx-=p*(g=1-g),s.vy-=v*g)}}}function s(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var n,o,i=e.length;for(r=new Array(i),n=0;n<i;++n)o=e[n],r[o.index]=+t(o,n,e)}}return"function"!=typeof t&&(t=W(null==t?1:+t)),a.initialize=function(t,r){e=t,n=r,u()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(o=+t,a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:W(+e),u(),a):t},a}function It(t){var e,r,n,o=W(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=W(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:W(+t),a(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:W(+e),a(),i):t},i}function Dt(t){var e,r,n,o=W(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=W(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:W(+t),a(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:W(+e),a(),i):t},i}function Ot(){function t(t){return function(){return t}}var e,r=function(t){return t.cluster},n=t(1),o=t(-1),i=t(100),a=t(.1),u=[0,0],h=[],d={},l=[],c=100,f=100,g={none:{x:0,y:0}},p=[],v="force",y=!0,m=.1;function w(t){if(!y)return w;e.tick(),E();for(var n=0,o=h.length,i=void 0,a=t*m;n<o;++n)(i=h[n]).vx+=(g[r(i)].x-i.x)*a,i.vy+=(g[r(i)].y-i.y)*a}function x(){h&&function(){if(h&&h.length){if(void 0===r(h[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy(\'clusterAttr\') before calling .links()");var t,u,g,v,y,m=(t=[],u=[],g={},{},y=[],v=function(t){var e={};return t.forEach((function(t){var n=r(t);e[n]||(e[n]={count:0,sumforceNodeSize:0})})),t.forEach((function(t){var o=r(t),i=n(t),a=e[o];a.count=a.count+1,a.sumforceNodeSize=a.sumforceNodeSize+Math.PI*(i*i)*1.3,e[o]=a})),e}(h),y=function(t){var e={},n=[];return t.forEach((function(t){var n,o,i,a,s,u=(o=(n=t).source,i=n.target,(a=r(d[o]))<=(s=r(d[i]))?a+"~"+s:s+"~"+a),h=0;void 0!==e[u]&&(h=e[u]),h+=1,e[u]=h})),Object.entries(e).forEach((function(t){var e=s(t,2),r=e[0],o=e[1],i=r.split("~")[0],a=r.split("~")[1];void 0!==i&&void 0!==a&&n.push({source:i,target:a,count:o})})),n}(l),Object.keys(v).forEach((function(e,r){var n=v[e];t.push({id:e,size:n.count,r:Math.sqrt(n.sumforceNodeSize/Math.PI)}),g[e]=r})),y.forEach((function(t){var e=t.source,r=t.target,n=g[e],o=g[r];void 0!==n&&void 0!==o&&u.push({source:n,target:o,count:t.count})})),{nodes:t,links:u});e=bt(m.nodes).force("x",It(c).strength(.1)).force("y",Dt(f).strength(.1)).force("collide",Rt((function(t){return t.r})).iterations(4)).force("charge",Mt().strength(o)).force("links",At(m.nodes.length?m.links:[]).distance(i).strength(a)),p=e.nodes(),E()}}()}function E(){return g={none:{x:0,y:0}},p.forEach((function(t){g[t.id]={x:t.x-u[0],y:t.y-u[1]}})),g}return w.initialize=function(t){h=t,x()},w.template=function(t){return arguments.length?(v=t,x(),w):v},w.groupBy=function(t){return arguments.length?"string"==typeof t?(r=function(e){return e[t]},w):(r=t,w):r},w.enableGrouping=function(t){return arguments.length?(y=t,w):y},w.strength=function(t){return arguments.length?(m=t,w):m},w.centerX=function(t){return arguments.length?(c=t,w):c},w.centerY=function(t){return arguments.length?(f=t,w):f},w.nodes=function(t){return arguments.length?(function(t){d={},t.forEach((function(t){d[t.id]=t}))}(t||[]),h=t||[],w):h},w.links=function(t){return arguments.length?(l=t||[],x(),w):l},w.forceNodeSize=function(e){return arguments.length?(n="function"==typeof e?e:t(+e),x(),w):n},w.nodeSize=w.forceNodeSize,w.forceCharge=function(e){return arguments.length?(o="function"==typeof e?e:t(+e),x(),w):o},w.forceLinkDistance=function(e){return arguments.length?(i="function"==typeof e?e:t(+e),x(),w):i},w.forceLinkStrength=function(e){return arguments.length?(a="function"==typeof e?e:t(+e),x(),w):a},w.offset=function(t){return arguments.length?(u=t,w):u},w.getFocis=E,w}var Pt={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},Tt=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="d3force",this.options=n(n({},Pt),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){var t;null===(t=this.forceSimulation)||void 0===t||t.stop()},t.prototype.tick=function(t){var e=this;void 0===t&&(t=1),this.forceSimulation.tick(t);var r={nodes:Ct(this.lastLayoutNodes),edges:qt(this.lastLayoutEdges)};return this.lastAssign&&r.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,g,p,v,y,m,w,x,E,b,M,S,k,A,_,z,R,I,D=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=i.map((function(t){var e,r;return n(n({},N(t)),{x:null===(e=t.data)||void 0===e?void 0:e.x,y:null===(r=t.data)||void 0===r?void 0:r.y})})),h=s.map((function(t){return N(t)})),this.lastLayoutNodes=u,this.lastLayoutEdges=h,this.lastAssign=t,this.lastGraph=e,d=o.alphaMin,l=o.alphaDecay,c=o.alpha,f=o.nodeStrength,g=o.edgeStrength,p=o.linkDistance,v=o.clustering,y=o.clusterFociStrength,m=o.clusterEdgeDistance,w=o.clusterEdgeStrength,x=o.clusterNodeStrength,E=o.clusterNodeSize,b=o.collideStrength,M=void 0===b?1:b,S=o.center,k=void 0===S?[0,0]:S,A=o.preventOverlap,_=o.nodeSize,z=o.nodeSpacing,R=o.onTick,I=o.forceSimulation,[2,new Promise((function(r){if(I){v&&((i=Ot()).nodes(u),i.links(h)),I.nodes(u),h&&(s=At().id((function(t){return t.id})).links(h),g&&s.strength(g),p&&s.distance(p),I.force("link",s)),A&&D.overlapProcess(I,{nodeSize:_,nodeSpacing:z,collideStrength:M}),I.alpha(c).restart();var n=Ct(u),o=qt(h);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:o})}else try{var i,a=Mt();if(f&&a.strength(f),I=bt().nodes(u),v&&((i=Ot()).centerX(k[0]).centerY(k[1]).template("force").strength(y),h&&i.links(h),u&&i.nodes(u),i.forceLinkDistance(m).forceLinkStrength(w).forceCharge(x).forceNodeSize(E),I.force("group",i)),I.force("center",function(t,e){var r,n=1;function o(){var o,i,a=r.length,s=0,u=0;for(o=0;o<a;++o)s+=(i=r[o]).x,u+=i.y;for(s=(s/a-t)*n,u=(u/a-e)*n,o=0;o<a;++o)(i=r[o]).x-=s,i.y-=u}return null==t&&(t=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(n=+t,o):n},o}(k[0],k[1])).force("charge",a).alpha(c).alphaDecay(l).alphaMin(d),A&&D.overlapProcess(I,{nodeSize:_,nodeSpacing:z,collideStrength:M}),h){var s=At().id((function(t){return t.id})).links(h);g&&s.strength(g),p&&s.distance(p),I.force("link",s)}I.on("tick",(function(){var r=Ct(u);null==R||R({nodes:r,edges:qt(h)}),t&&r.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}))})).on("end",(function(){var n=Ct(u);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:qt(h)})}))}catch(t){console.warn(t)}D.forceSimulation=I}))]}))}))},t.prototype.overlapProcess=function(t,e){var r,n,o=e.nodeSize,i=e.nodeSpacing,a=e.collideStrength;if(n=x(i)?function(){return i}:b(i)?i:function(){return 0},o)if(b(o))r=function(t){return o(t)+n(t)};else if(g(o)){var s=(o[0]>o[1]?o[0]:o[1])/2;r=function(t){return s+n(t)}}else if(x(o)){var u=o/2;r=function(t){return u+n(t)}}else r=function(){return 10};else r=function(t){return t.size?g(t.size)?(t.size[0]>t.size[1]?t.size[0]:t.size[1])/2+n(t):M(t.size)?(t.size.width>t.size.height?t.size.width:t.size.height)/2+n(t):t.size/2+n(t):10+n(t)};t.force("collisionForce",Rt(r).strength(a))},t}(),Ct=function(t){return t.map((function(t){var e=t.x,r=t.y,i=o(t,["x","y"]);return n(n({},i),{data:n(n({},i.data),{x:e,y:r})})}))},qt=function(t){return t.map((function(t){var e=t.source,r=t.target,i=o(t,["source","target"]);return n(n({},i),{source:e.id,target:r.id})}))};var Lt=function(t,e){if("next"!==t&&"prev"!==t)return e},jt=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(function(){function t(){var t={};t.prev=t,t.next=t.prev,this.shortcut=t}return t.prototype.dequeue=function(){var t=this.shortcut,e=t.prev;if(e&&e!==t)return jt(e),e},t.prototype.enqueue=function(t){var e=this.shortcut;t.prev&&t.next&&jt(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e},t.prototype.toString=function(){for(var t=[],e=this.shortcut,r=e.prev;r!==e;)t.push(JSON.stringify(r,Lt)),r=null==r?void 0:r.prev;return"["+t.join(", ")+"]"},t}()),Vt=function(){return 1},Bt=function(t,e,r,o,i){var a,s,u=[];return t.hasNode(o.v)&&(null===(a=t.getRelatedEdges(o.v,"in"))||void 0===a||a.forEach((function(o){var a=o.data.weight,s=t.getNode(o.source);i&&u.push({v:o.source,w:o.target,in:0,out:0}),void 0===s.data.out&&(s.data.out=0),s.data.out-=a,Gt(e,r,n({v:s.id},s.data))})),null===(s=t.getRelatedEdges(o.v,"out"))||void 0===s||s.forEach((function(o){var i=o.data.weight,a=o.target,s=t.getNode(a);void 0===s.data.in&&(s.data.in=0),s.data.in-=i,Gt(e,r,n({v:s.id},s.data))})),t.removeNode(o.v)),i?u:void 0},Gt=function(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},Wt=function(t,e){var r="greedy"===e?function(t,e){var r;if(t.getAllNodes().length<=1)return[];var o=function(t,e){var r=new c,o=0,i=0;t.getAllNodes().forEach((function(t){r.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((function(t){var a=r.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target})),s=(null==e?void 0:e(t))||1;a?r.updateEdgeData(null==a?void 0:a.id,n(n({},a.data),{weight:a.data.weight+s})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:s}}),i=Math.max(i,r.getNode(t.source).data.out+=s),o=Math.max(o,r.getNode(t.target).data.in+=s)}));for(var a=[],s=i+o+3,u=0;u<s;u++)a.push(new Ft);var h=o+1;return r.getAllNodes().forEach((function(t){Gt(a,h,n({v:t.id},r.getNode(t.id).data))})),{buckets:a,zeroIdx:h,graph:r}}(t,function(t){return t.data.weight||1}||Vt);return null===(r=function(t,e,r){for(var n,o=[],i=e[e.length-1],a=e[0];t.getAllNodes().length;){for(;n=a.dequeue();)Bt(t,e,r,n);for(;n=i.dequeue();)Bt(t,e,r,n);if(t.getAllNodes().length)for(var s=e.length-2;s>0;--s)if(n=e[s].dequeue()){o=o.concat(Bt(t,e,r,n,!0));break}}return o}(o.graph,o.buckets,o.zeroIdx).map((function(e){return t.getRelatedEdges(e.v,"out").filter((function(t){return t.target===e.w}))})))||void 0===r?void 0:r.flat()}(t):$t(t);null==r||r.forEach((function(e){var r=e.data;t.removeEdge(e.id),r.forwardName=e.data.name,r.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:n({},r)})}))},$t=function(t){var e=[],r={},n={},o=function(i){n[i]||(n[i]=!0,r[i]=!0,t.getRelatedEdges(i,"out").forEach((function(t){r[t.target]?e.push(t):o(t.target)})),delete r[i])};return t.getAllNodes().forEach((function(t){return o(t.id)})),e},Ut=function(t,e,r,n){var o;do{o=""+n+Math.random()}while(t.hasNode(o));return r.dummy=e,t.addNode({id:o,data:r}),o},Ht=function(t){var e=new c;return t.getAllNodes().forEach((function(r){t.getChildren(r.id).length||e.addNode(n({},r))})),t.getAllEdges().forEach((function(t){e.addEdge(t)})),e},Kt=function(t,e){var r,n,o=Number(t.x),i=Number(t.y),a=Number(e.x)-o,s=Number(e.y)-i,u=Number(t.width)/2,h=Number(t.height)/2;return a||s?(Math.abs(s)*u>Math.abs(a)*h?(s<0&&(h=-h),r=h*a/s,n=h):(a<0&&(u=-u),r=u,n=u*s/a),{x:o+r,y:i+n}):{x:0,y:0}},Yt=function(t){for(var e=[],r=Xt(t)+1,n=0;n<r;n++)e.push([]);for(t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)})),n=0;n<r;n++)e[n]=e[n].sort((function(e,r){return n=t.getNode(e).data.order,o=t.getNode(r).data.order,Number(n)-Number(o);var n,o}));return e},Jt=function(t,e,r,n){var o={width:0,height:0};return x(r)&&x(n)&&(o.rank=r,o.order=n),Ut(t,"border",o,e)},Xt=function(t){var e;return t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)})),e||(e=0),e},Qt=function(t,e){return t.reduce((function(t,r){return e(t)>e(r)?r:t}))},Zt=function(t,e,r,n,o,i){n.includes(e.id)||(n.push(e.id),r||i.push(e.id),o(e.id).forEach((function(e){return Zt(t,e,r,n,o,i)})),r&&i.push(e.id))},te=function(t,e,r,n){var o=Array.isArray(e)?e:[e],i=function(e){return n?t.getSuccessors(e):t.getNeighbors(e)},a=[],s=[];return o.forEach((function(e){if(!t.hasNode(e.id))throw new Error("Graph does not have node: "+e);Zt(t,e,"post"===r,s,i,a)})),a},ee="edge-label",re=function(t){var e={},r=function(n){var o,i,a=t.getNode(n);return a?e[n]?a.data.rank:(e[n]=!0,null===(o=t.getRelatedEdges(n,"out"))||void 0===o||o.forEach((function(t){var e=r(t.target)-t.data.minlen;e&&(void 0===i||e<i)&&(i=e)})),i||(i=0),a.data.rank=i,i):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){return r(t.id)}))},ne=function(t,e){return t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen},oe=function(t,e){var r=function(n){e.getRelatedEdges(n,"both").forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ie=function(t,e){var r=function(n){var o;null===(o=e.getRelatedEdges(n,"both"))||void 0===o||o.forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||void 0===e.getNode(a).data.layer&&ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ae=function(t,e){return Qt(e.getAllEdges(),(function(r){return t.hasNode(r.source)!==t.hasNode(r.target)?ne(e,r):1/0}))},se=function(t,e,r){t.getAllNodes().forEach((function(t){var n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r}))},ue=function(t,e){var r=te(t,t.getAllNodes(),"post",!1);(r=r.slice(0,(null==r?void 0:r.length)-1)).forEach((function(r){he(t,e,r)}))},he=function(t,e,r){var n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find((function(t){return t.target===n||t.source===n})).data.cutvalue=de(t,e,r)},de=function(t,e,r){var n=t.getNode(r).data.parent,o=!0,i=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),a=0;return i||(o=!1,i=e.getRelatedEdges(n,"out").find((function(t){return t.target===r}))),a=i.data.weight,e.getRelatedEdges(r,"both").forEach((function(e){var i=e.source===r,s=i?e.target:e.source;if(s!==n){var u=i===o,h=e.data.weight;if(a+=u?h:-h,ye(t,r,s)){var d=t.getRelatedEdges(r,"both").find((function(t){return t.source===s||t.target===s})).data.cutvalue;a+=u?-d:d}}})),a},le=function(t,e){void 0===e&&(e=t.getAllNodes()[0].id),ce(t,{},1,e)},ce=function(t,e,r,n,o){var i,a=r,s=r,u=t.getNode(n);return e[n]=!0,null===(i=t.getNeighbors(n))||void 0===i||i.forEach((function(r){e[r.id]||(s=ce(t,e,s,r.id,n))})),u.data.low=a,u.data.lim=s++,o?u.data.parent=o:delete u.data.parent,s},fe=function(t){return t.getAllEdges().find((function(t){return t.data.cutvalue<0}))},ge=function(t,e,r){var n=r.source,o=r.target;e.getRelatedEdges(n,"out").find((function(t){return t.target===o}))||(n=r.target,o=r.source);var i=t.getNode(n),a=t.getNode(o),s=i,u=!1;i.data.lim>a.data.lim&&(s=a,u=!0);var h=e.getAllEdges().filter((function(e){return u===me(t.getNode(e.source),s)&&u!==me(t.getNode(e.target),s)}));return Qt(h,(function(t){return ne(e,t)}))},pe=function(t,e,r,n){var o=t.getRelatedEdges(r.source,"both").find((function(t){return t.source===r.target||t.target===r.target}));o&&t.removeEdge(o.id),t.addEdge({id:"e"+Math.random(),source:n.source,target:n.target,data:{}}),le(t),ue(t,e),ve(t,e)},ve=function(t,e){var r=t.getAllNodes().find((function(t){return!t.data.parent})),n=te(t,r,"pre",!1);(n=n.slice(1)).forEach((function(r){var n=t.getNode(r).data.parent,o=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),i=!1;!o&&e.hasNode(n)&&(o=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),i=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(i?null==o?void 0:o.data.minlen:-(null==o?void 0:o.data.minlen))}))},ye=function(t,e,r){return t.getRelatedEdges(e,"both").find((function(t){return t.source===r||t.target===r}))},me=function(t,e){return e.data.low<=t.data.lim&&t.data.lim<=e.data.lim},we=re,xe=function(t){!function(t){var e=function(t){var e=new c;return t.getAllNodes().forEach((function(t){e.addNode(n({},t))})),t.getAllEdges().forEach((function(t){var r=e.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target}));r?e.updateEdgeData(null==r?void 0:r.id,n(n({},r.data),{weight:r.data.weight+t.data.weight||0,minlen:Math.max(r.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e}(t);re(e);var r,o,i=function(t){var e,r,n=new c({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);oe(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r);return n}(e);for(le(i),ue(i,e);r=fe(i);)o=ge(i,e,r),pe(i,e,r,o)}(t)},Ee=function(t,e,r,n,o,i,a){var s=t.getChildren(a);if(null==s?void 0:s.length){var u=Jt(t,"_bt"),h=Jt(t,"_bb"),d=t.getNode(a);t.setParent(u,a),d.data.borderTop=u,t.setParent(h,a),d.data.borderBottom=h,null==s||s.forEach((function(s){Ee(t,e,r,n,o,i,s.id);var d=s.data.borderTop?s.data.borderTop:s.id,l=s.data.borderBottom?s.data.borderBottom:s.id,c=s.data.borderTop?n:2*n,f=d!==l?1:o-i[a]+1;t.addEdge({id:"e"+Math.random(),source:u,target:d,data:{minlen:f,weight:c,nestingEdge:!0}}),t.addEdge({id:"e"+Math.random(),source:l,target:h,data:{minlen:f,weight:c,nestingEdge:!0}})})),t.getParent(a)||t.addEdge({id:"e"+Math.random(),source:e,target:u,data:{weight:0,minlen:o+i[a]}})}else a!==e&&t.addEdge({id:"e"+Math.random(),source:e,target:a,data:{weight:0,minlen:r}})},Ne=function(t,e,r,n,o,i){var a={rank:i,borderType:e,width:0,height:0},s=o.data[e][i-1],u=Ut(t,"border",a,r);o.data[e][i]=u,t.setParent(u,n),s&&t.addEdge({id:"e"+Math.random(),source:s,target:u,data:{weight:1}})},be=function(t){t.getAllNodes().forEach((function(t){Me(t)})),t.getAllEdges().forEach((function(t){Me(t)}))},Me=function(t){var e=t.data.width;t.data.width=t.data.height,t.data.height=e},Se=function(t){(null==t?void 0:t.y)&&(t.y=-t.y)},ke=function(t){var e=t.x;t.x=t.y,t.y=e},Ae=function(t){for(var e={},r=t.getAllNodes(),n=r.map((function(t){var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),o=Math.max.apply(Math,u([],s(n))),i=[],a=0;a<o+1;a++)i.push([]);var h=r.sort((function(e,r){return t.getNode(e.id).data.rank-t.getNode(r.id).data.rank})),d=h.filter((function(e){return void 0!==t.getNode(e.id).data.fixorder})).sort((function(e,r){return t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder}));return null==d||d.forEach((function(r){isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0})),null==h||h.forEach((function(r){return t.dfsTree(r.id,(function(t){if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)}))})),i},_e=function(t,e,r){for(var n=function(t,e){return null==t?void 0:t.reduce((function(t,r,n){return t[r]=e[n],t}),{})}(r,r.map((function(t,e){return e}))),o=e.map((function(e){var r=t.getRelatedEdges(e,"out").map((function(t){return{pos:n[t.target]||0,weight:t.data.weight}}));return null==r?void 0:r.sort((function(t,e){return t.pos-e.pos}))})),i=o.flat().filter((function(t){return void 0!==t})),a=1;a<r.length;)a<<=1;var s=2*a-1;a-=1;var u=Array(s).fill(0,0,s),h=0;return null==i||i.forEach((function(t){if(t){var e=t.pos+a;u[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=u[e+1]),u[e=e-1>>1]+=t.weight;h+=t.weight*r}})),h},ze=function(t,e){for(var r=0,n=1;n<(null==e?void 0:e.length);n+=1)r+=_e(t,e[n-1],e[n]);return r},Re=function(t,e){var r,n=0,o=0;t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/o,t.weight=o,t.i=Math.min(e.i,t.i),e.merged=!0};const Ie=function(t,e){var r,n,o,i={};return null==t||t.forEach((function(t,e){i[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};var r=i[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)})),null===(r=e.getAllEdges())||void 0===r||r.forEach((function(t){var e=i[t.source],r=i[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(i[t.target]))})),function(t){for(var e,r,n=[],o=function(){var o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach((function(t){return(e=o,function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&Re(e,t)})(t);var e})),null===(r=o.out)||void 0===r||r.forEach((function(e){return(r=o,function(e){e.in.push(r),0==--e.indegree&&t.push(e)})(e);var r}))};null==t?void 0:t.length;)o();var i=n.filter((function(t){return!t.merged})),a=["vs","i","barycenter","weight"];return i.map((function(t){var e={};return null==a||a.forEach((function(r){void 0!==t[r]&&(e[r]=t[r])})),e}))}(null===(o=(n=Object.values(i)).filter)||void 0===o?void 0:o.call(n,(function(t){return!t.indegree})))};var De=function(t,e,r){for(var n,o=r;e.length&&(n=e[e.length-1]).i<=o;)e.pop(),null==t||t.push(n.vs),o++;return o},Oe=function(t,e,r,n,o,i){var a,s,u,h,d=t.getChildren(e).map((function(t){return t.id})),l=t.getNode(e),c=l?l.data.borderLeft:void 0,f=l?l.data.borderRight:void 0,g={};c&&(d=null==d?void 0:d.filter((function(t){return t!==c&&t!==f})));var p=function(t,e){return e.map((function(e){var r=t.getRelatedEdges(e,"in");if(!(null==r?void 0:r.length))return{v:e};var n={sum:0,weight:0};return null==r||r.forEach((function(e){var r=t.getNode(e.source);n.sum+=e.data.weight*r.data.order,n.weight+=e.data.weight})),{v:e,barycenter:n.sum/n.weight,weight:n.weight}}))}(t,d||[]);null==p||p.forEach((function(e){var o;if(null===(o=t.getChildren(e.v))||void 0===o?void 0:o.length){var a=Oe(t,e.v,r,n,i);g[e.v]=a,a.hasOwnProperty("barycenter")&&Te(e,a)}}));var v=Ie(p,r);Pe(v,g),null===(a=v.filter((function(t){return t.vs.length>0})))||void 0===a||a.forEach((function(e){var r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)}));var y=function(t,e,r,n){var o=function(t,e){var r={lhs:[],rhs:[]};return null==t||t.forEach((function(t){var e,o;o=(e=t).hasOwnProperty("fixorder")&&!isNaN(e.fixorder),(n?!o&&e.hasOwnProperty("barycenter"):o||e.hasOwnProperty("barycenter"))?r.lhs.push(t):r.rhs.push(t)})),r}(t),i=o.lhs,a=o.rhs.sort((function(t,e){return-t.i- -e.i})),s=[],u=0,h=0,d=0;null==i||i.sort(function(t,e){return function(r,n){if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i}}(!!e,!!r)),d=De(s,a,d),null==i||i.forEach((function(t){var e;d+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),u+=t.barycenter*t.weight,h+=t.weight,d=De(s,a,d)}));var l={vs:s.flat()};return h&&(l.barycenter=u/h,l.weight=h),l}(v,n,o,i);if(c&&(y.vs=[c,y.vs,f].flat(),null===(s=t.getPredecessors(c))||void 0===s?void 0:s.length)){var m=t.getNode((null===(u=t.getPredecessors(c))||void 0===u?void 0:u[0].id)||""),w=t.getNode((null===(h=t.getPredecessors(f))||void 0===h?void 0:h[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+w.data.order)/(y.weight+2),y.weight+=2}return y},Pe=function(t,e){null==t||t.forEach((function(t){var r,n=null===(r=t.vs)||void 0===r?void 0:r.map((function(t){return e[t]?e[t].vs:t}));t.vs=n.flat()}))},Te=function(t,e){void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},Ce=function(t){if("object"!=typeof t||null===t)return t;var e,r;if(r=t,Array.isArray?Array.isArray(r):w(r,"Array")){e=[];for(var n=0,o=t.length;n<o;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=Ce(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=Ce(t[i]):e[i]=t[i];return e};const qe=Ce;var Le=function(t,e,r){return e.map((function(e){return function(t,e,r){var o=function(t){for(var e;t.hasNode(e="_root"+Math.random()););return e}(t),i=new c({tree:[{id:o,children:[],data:{}}]});return t.getAllNodes().forEach((function(a){var s=t.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(n({},a)),(null==s?void 0:s.id)&&!i.hasNode(null==s?void 0:s.id)&&i.addNode(n({},s)),i.setParent(a.id,(null==s?void 0:s.id)||o),t.getRelatedEdges(a.id,r).forEach((function(e){var r=e.source===a.id?e.target:e.source;i.hasNode(r)||i.addNode(n({},t.getNode(r)));var o=i.getRelatedEdges(r,"out").find((function(t){return t.target===a.id})),s=void 0!==o?o.data.weight:0;o?i.updateEdgeData(o.id,n(n({},o.data),{weight:e.data.weight+s})):i.addEdge({id:e.id,source:r,target:a.id,data:{weight:e.data.weight+s}})})),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,n(n({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))})),i}(t,e,r)}))},je=function(t,e,r,n){var o=new c;null==t||t.forEach((function(t){for(var i,a=t.getRoots()[0].id,s=Oe(t,a,o,e,r,n),u=0;u<(null===(i=s.vs)||void 0===i?void 0:i.length);u++){var h=t.getNode(s.vs[u]);h&&(h.data.order=u)}!function(t,e,r){var n,o={};null==r||r.forEach((function(r){for(var i,a,s=t.getParent(r);s;){if((i=t.getParent(s.id))?(a=o[i.id],o[i.id]=s.id):(a=n,n=s.id),a&&a!==s.id)return e.addNodes([{id:a,data:{}},{id:s.id,data:{}}]),void e.addEdge({id:"e"+a+"-"+s.id,source:a,target:s.id,data:{}});s=i}}))}(t,o,s.vs)}))},Fe=function(t,e){null==e||e.forEach((function(e){null==e||e.forEach((function(e,r){t.getNode(e).data.order=r}))}))},Ve=function(t,e){var r={};function n(e,n,o,i,a){for(var s,u,h,d=n;d<o;d++)h=e[d],(null===(s=t.getNode(h))||void 0===s?void 0:s.data.dummy)&&(null===(u=t.getPredecessors(h))||void 0===u||u.forEach((function(e){var n=t.getNode(e.id);n.data.dummy&&(n.data.order<i||n.data.order>a)&&Ge(r,e.id,h)})))}function o(t,e){var r=function(t){return JSON.stringify(t.slice(1))}(t);e.get(r)||(n.apply(void 0,u([],s(t))),e.set(r,!0))}return(null==e?void 0:e.length)&&e.reduce((function(e,r){var n,i=-1,a=0,s=new Map;return null==r||r.forEach((function(u,h){var d;if("border"===(null===(d=t.getNode(u))||void 0===d?void 0:d.data.dummy)){var l=t.getPredecessors(u)||[];l.length&&(n=t.getNode(l[0].id).data.order,o([r,a,h,i,n],s),a=h,i=n)}o([r,a,r.length,n,e.length],s)})),r})),r},Be=function(t,e){var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find((function(e){return t.getNode(e.id).data.dummy}))},Ge=function(t,e,r){var n=e,o=r;if(n>o){var i=n;n=o,o=i}var a=t[n];a||(t[n]=a={}),a[o]=!0},We=function(t,e,r){var n=e;return n>r&&(n=r),!!t[n]},$e=function(t,e,r,o,i,a){var s=new c,u=Ue(o,i,a);return null==e||e.forEach((function(e){var o;null==e||e.forEach((function(e){var i=r[e];if(s.hasNode(i)||s.addNode({id:i,data:{}}),o){var a=r[o],h=s.getRelatedEdges(a,"out").find((function(t){return t.target===i}));h?s.updateEdgeData(h.id,n(n({},h.data),{weight:Math.max(u(t,e,o),h.data.weight||0)})):s.addEdge({id:"e"+Math.random(),source:a,target:i,data:{weight:Math.max(u(t,e,o),0)}})}o=e}))})),s};var Ue=function(t,e,r){return function(n,o,i){var a=n.getNode(o),s=n.getNode(i),u=0,h=0;if(u+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":h=-a.data.width/2;break;case"r":h=a.data.width/2}if(h&&(u+=r?h:-h),h=0,u+=(a.data.dummy?e:t)/2,u+=(s.data.dummy?e:t)/2,u+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":h=s.data.width/2;break;case"r":h=-s.data.width/2}return h&&(u+=r?h:-h),h=0,u}},He=function(t,e){return t.getNode(e).data.width||0},Ke=function(t,e){var r,n=Ht(t);!function(t,e){var r=(e||{}).ranksep,n=void 0===r?0:r,o=Yt(t),i=0;null==o||o.forEach((function(e){var r=e.map((function(e){return t.getNode(e).data.height})),o=Math.max.apply(Math,u(u([],s(r)),[0]));null==e||e.forEach((function(e){t.getNode(e).data.y=i+o/2})),i+=o+n}))}(n,e);var o=function(t,e){var r=e||{},n=r.align,o=r.nodesep,i=void 0===o?0:o,a=r.edgesep,h=void 0===a?0:a,d=Yt(t),l=Object.assign(function(t,e){var r={};return(null==e?void 0:e.length)&&e.reduce((function(e,n){var o=0,i=0,a=e.length,s=null==n?void 0:n[(null==n?void 0:n.length)-1];return null==n||n.forEach((function(e,u){var h,d=Be(t,e),l=d?t.getNode(d.id).data.order:a;(d||e===s)&&(null===(h=n.slice(i,u+1))||void 0===h||h.forEach((function(e){var n;null===(n=t.getPredecessors(e))||void 0===n||n.forEach((function(n){var i,a=t.getNode(n.id),s=a.data.order;!(s<o||l<s)||a.data.dummy&&(null===(i=t.getNode(e))||void 0===i?void 0:i.data.dummy)||Ge(r,n.id,e)}))})),i=u+1,o=l)})),n})),r}(t,d),Ve(t,d)),c={},f=[];["u","d"].forEach((function(e){f="u"===e?d:Object.values(d).reverse(),["l","r"].forEach((function(r){"r"===r&&(f=f.map((function(t){return Object.values(t).reverse()})));var n=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),o=function(t,e,r,n){var o={},i={},a={};return null==e||e.forEach((function(t){null==t||t.forEach((function(t,e){o[t]=t,i[t]=t,a[t]=e}))})),null==e||e.forEach((function(t){var e=-1;null==t||t.forEach((function(t){var s=n(t).map((function(t){return t.id}));if(s.length){s=s.sort((function(t,e){return a[t]-a[e]}));for(var u=(s.length-1)/2,h=Math.floor(u),d=Math.ceil(u);h<=d;++h){var l=s[h];i[t]===t&&e<a[l]&&!We(r,t,l)&&(i[l]=t,i[t]=o[t]=o[l],e=a[l])}}}))})),{root:o,align:i}}(0,f,l,n),a=function(t,e,r,n,o,i,a){var s,u={},h=$e(t,e,r,o,i,a),d=a?"borderLeft":"borderRight",l=function(t,e){for(var r=h.getAllNodes(),n=r.pop(),o={};n;)o[n.id]?t(n.id):(o[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return l((function(t){u[t]=(h.getRelatedEdges(t,"in")||[]).reduce((function(t,e){return Math.max(t,(u[e.source]||0)+e.data.weight)}),0)}),h.getPredecessors.bind(h)),l((function(e){var r=(h.getRelatedEdges(e,"out")||[]).reduce((function(t,e){return Math.min(t,(u[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==d&&(u[e]=Math.max(u[e],r))}),h.getSuccessors.bind(h)),null===(s=Object.values(n))||void 0===s||s.forEach((function(t){u[t]=u[r[t]]})),u}(t,f,o.root,o.align,i,h,"r"===r);"r"===r&&Object.keys(a).forEach((function(t){return a[t]=-a[t]})),c[e+r]=a}))}));var g=function(t,e){return Qt(Object.values(e),(function(e){var r,n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach((function(r){var i=e[r],a=He(t,r)/2;n=Math.max(i+a,n),o=Math.min(i-a,o)})),n-o}))}(t,c);return g&&function(t,e){var r=Object.values(e),n=Math.min.apply(Math,u([],s(r))),o=Math.max.apply(Math,u([],s(r)));["u","d"].forEach((function(r){["l","r"].forEach((function(i){var a,h=r+i,d=t[h];if(d!==e){var l=Object.values(d);(a="l"===i?n-Math.min.apply(Math,u([],s(l))):o-Math.max.apply(Math,u([],s(l))))&&(t[h]={},Object.keys(d).forEach((function(e){t[h][e]=d[e]+a})))}}))}))}(c,g),function(t,e){var r={};return Object.keys(t.ul).forEach((function(n){if(e)r[n]=t[e.toLowerCase()][n];else{var o=Object.values(t).map((function(t){return t[n]}));r[n]=(o[0]+o[1])/2}})),r}(c,n)}(n,e);null===(r=Object.keys(o))||void 0===r||r.forEach((function(t){n.getNode(t).data.x=o[t]}))},Ye=function(t,e){var r=e.acyclicer,o=e.ranker,i=e.rankdir,a=void 0===i?"tb":i,h=e.nodeOrder,d=e.keepNodeOrder,l=e.align,f=e.nodesep,g=void 0===f?50:f,p=e.edgesep,v=void 0===p?20:p,y=e.ranksep,m=void 0===y?50:y;hr(t),Wt(t,r);var w=function(t){var e=Ut(t,"root",{},"_root"),r=function(t){var e={},r=function(n,o){var i=t.getChildren(n);null==i||i.forEach((function(t){return r(t.id,o+1)})),e[n]=o};return t.getRoots().forEach((function(t){return r(t.id,1)})),e}(t),n=Math.max.apply(Math,u([],s(Object.values(r))));Math.abs(n)===1/0&&(n=1);var o=n-1,i=2*o+1;t.getAllEdges().forEach((function(t){t.data.minlen*=i}));var a=function(t){var e=0;return t.getAllEdges().forEach((function(t){e+=t.data.weight})),e}(t)+1;return t.getRoots().forEach((function(n){Ee(t,e,i,a,o,r,n.id)})),{nestingRoot:e,nodeRankFactor:i}}(t),x=w.nestingRoot,E=w.nodeRankFactor;!function(t,e){switch(e){case"network-simplex":xe(t);break;case"tight-tree":default:!function(t){!function(t){var e,r={},n=function(o){var i,a,s=t.getNode(o);return s?r[o]?s.data.rank:(r[o]=!0,null===(i=t.getRelatedEdges(o,"out"))||void 0===i||i.forEach((function(t){var e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),(void 0===e||a<e)&&(e=a),s.data.rank=a,a):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){t&&n(t.id)})),void 0===e&&(e=0);var o={},i=function(e,r){var n,a=t.getNode(e),s=isNaN(a.data.layer)?r:a.data.layer;(void 0===a.data.rank||a.data.rank<s)&&(a.data.rank=s),o[e]||(o[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach((function(t){i(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((function(t){var r=t.data;r&&(isNaN(r.layer)?r.rank-=e:i(t.id,r.layer))}))}(t),function(t){var e,r,n=new c({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);ie(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r)}(t)}(t);break;case"longest-path":we(t)}}(Ht(t),o),er(t),function(t,e){void 0===e&&(e=0);var r=t.getAllNodes(),n=r.filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),o=Math.min.apply(Math,u([],s(n))),i=[];r.forEach((function(t){var e=(t.data.rank||0)-o;i[e]||(i[e]=[]),i[e].push(t.id)}));for(var a=0,h=0;h<i.length;h++){var d=i[h];void 0===d?h%e!=0&&(a-=1):a&&(null==d||d.forEach((function(e){var r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=a)})))}}(t,E),function(t,e){e&&t.removeNode(e),t.getAllEdges().forEach((function(e){e.data.nestingEdge&&t.removeEdge(e.id)}))}(t,x),function(t){var e=t.getAllNodes().filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),r=Math.min.apply(Math,u([],s(e)));t.getAllNodes().forEach((function(t){t.data.hasOwnProperty("rank")&&r!==1/0&&(t.data.rank-=r)}))}(t),rr(t),nr(t);var N=[];!function(t,e){t.getAllEdges().forEach((function(r){return function(t,e,r){var n=e.source,o=t.getNode(n).data.rank,i=e.target,a=t.getNode(i).data.rank,s=e.data.labelRank;if(a!==o+1){var u,h,d;for(t.removeEdge(e.id),d=0,++o;o<a;++d,++o)e.data.points=[],u=Ut(t,"edge",h={originalEdge:e,width:0,height:0,rank:o},"_d"),o===s&&(h.width=e.data.width,h.height=e.data.height,h.dummy=ee,h.labelpos=e.data.labelpos),t.addEdge({id:"e"+Math.random(),source:n,target:u,data:{weight:e.data.weight}}),0===d&&r.push(u),n=u;t.addEdge({id:"e"+Math.random(),source:n,target:i,data:{weight:e.data.weight}})}}(t,r,e)}))}(t,N),function(t,e){var r=function(t){var e={},r=0,n=function(o){var i=r;t.getChildren(o).forEach((function(t){return n(t.id)})),e[o]={low:i,lim:r++}};return t.getRoots().forEach((function(t){return n(t.id)})),e}(t);e.forEach((function(e){var n,o,i=e,a=t.getNode(i),s=a.data.originalEdge;if(s)for(var u=function(t,e,r,n){var o,i,a,s,u=[],h=[],d=Math.min(e[r].low,e[n].low),l=Math.max(e[r].lim,e[n].lim);a=r;do{a=null===(o=t.getParent(a))||void 0===o?void 0:o.id,u.push(a)}while(a&&(e[a].low>d||l>e[a].lim));for(s=a,a=n;a&&a!==s;)h.push(a),a=null===(i=t.getParent(a))||void 0===i?void 0:i.id;return{lca:s,path:u.concat(h.reverse())}}(t,r,s.source,s.target),h=u.path,d=u.lca,l=0,c=h[l],f=!0;i!==s.target;){if(a=t.getNode(i),f){for(;c!==d&&(null===(n=t.getNode(c))||void 0===n?void 0:n.data.maxRank)<a.data.rank;)c=h[++l];c===d&&(f=!1)}if(!f){for(;l<h.length-1&&(null===(o=t.getNode(h[l+1]))||void 0===o?void 0:o.data.minRank)<=a.data.rank;)l++;c=h[l]}t.hasNode(c)&&t.setParent(i,c),i=t.getSuccessors(i)[0].id}}))}(t,N),function(t){var e=function(r){var n=t.getChildren(r),o=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach((function(t){return e(t.id)})),o.data.hasOwnProperty("minRank")){o.data.borderLeft=[],o.data.borderRight=[];for(var i=o.data.minRank,a=o.data.maxRank+1;i<a;i+=1)Ne(t,"borderLeft","_bl",r,o,i),Ne(t,"borderRight","_br",r,o,i)}};t.getRoots().forEach((function(t){return e(t.id)}))}(t),d&&function(t,e){for(var r=t.getAllNodes().filter((function(e){var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)})).map((function(t){return t.data.rank})),n=Math.max.apply(Math,u([],s(r))),o=[],i=0;i<n+1;i++)o[i]=[];null==e||e.forEach((function(e){var r=t.getNode(e);r&&!r.data.dummy&&(isNaN(r.data.rank)||(r.data.fixorder=o[r.data.rank].length,o[r.data.rank].push(e)))}))}(t,h),function(t,e){for(var r=Xt(t),n=[],o=[],i=1;i<r+1;i++)n.push(i);for(i=r-1;i>-1;i--)o.push(i);var a=Le(t,n,"in"),s=Le(t,o,"out"),u=Ae(t);Fe(t,u);for(var h,d=Number.POSITIVE_INFINITY,l=(i=0,0);l<4;++i,++l)je(i%2?a:s,i%4>=2,!1,e),u=Yt(t),(c=ze(t,u))<d&&(l=0,h=qe(u),d=c);for(u=Ae(t),Fe(t,u),i=0,l=0;l<4;++i,++l){var c;je(i%2?a:s,i%4>=2,!0,e),u=Yt(t),(c=ze(t,u))<d&&(l=0,h=qe(u),d=c)}Fe(t,h)}(t,d),dr(t),function(t,e){var r=e.toLowerCase();"lr"!==r&&"rl"!==r||be(t)}(t,a),Ke(t,{align:l,nodesep:g,edgesep:v,ranksep:m}),lr(t),ur(t),function(t,e){e.forEach((function(e){var r,n=t.getNode(e),o=n.data.originalEdge;o&&t.addEdge(o);for(var i=e;n.data.dummy;)r=t.getSuccessors(i)[0],t.removeNode(i),o.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===ee&&(o.data.x=n.data.x,o.data.y=n.data.y,o.data.width=n.data.width,o.data.height=n.data.height),i=r.id,n=t.getNode(i)}))}(t,N),ar(t),function(t,e){var r=e.toLowerCase();"bt"!==r&&"rl"!==r||function(t){t.getAllNodes().forEach((function(t){Se(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return Se(t)})),t.data.hasOwnProperty("y")&&Se(t.data)}))}(t),"lr"!==r&&"rl"!==r||(function(t){t.getAllNodes().forEach((function(t){ke(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return ke(t)})),t.data.hasOwnProperty("x")&&ke(t.data)}))}(t),be(t))}(t,a);var b=or(t),M=b.width,S=b.height;return ir(t),sr(t),function(t){t.getAllEdges().forEach((function(e){var r=e.data;if(r.reversed){t.removeEdge(e.id);var o=r.forwardName;delete r.reversed,delete r.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:n(n({},r),{forwardName:o})})}}))}(t),{width:M,height:S}},Je=["width","height","layer","fixorder"],Xe={width:0,height:0},Qe=["minlen","weight","width","height","labeloffset"],Ze={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},tr=["labelpos"],er=function(t){t.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var r=t.getNode(e.source),n={e,rank:(t.getNode(e.target).data.rank-r.data.rank)/2+r.data.rank};Ut(t,"edge-proxy",n,"_ep")}}))},rr=function(t){var e=0;return t.getAllNodes().forEach((function(r){var n,o;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(o=t.getNode(r.data.borderBottom))||void 0===o?void 0:o.data.rank,e=Math.max(e,r.data.maxRank||-1/0))})),e},nr=function(t){t.getAllNodes().forEach((function(e){"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},or=function(t,e){var r,n,o=0,i=0,a=e||{},s=a.marginx,u=void 0===s?0:s,h=a.marginy,d=void 0===h?0:h,l=function(t){if(t.data){var e=t.data.x,a=t.data.y,s=t.data.width,u=t.data.height;isNaN(e)||isNaN(s)||(void 0===r&&(r=e-s/2),r=Math.min(r,e-s/2),o=Math.max(o,e+s/2)),isNaN(a)||isNaN(u)||(void 0===n&&(n=a-u/2),n=Math.min(n,a-u/2),i=Math.max(i,a+u/2))}};return t.getAllNodes().forEach((function(t){l(t)})),t.getAllEdges().forEach((function(t){(null==t?void 0:t.data.hasOwnProperty("x"))&&l(t)})),r-=u,n-=d,t.getAllNodes().forEach((function(t){t.data.x-=r,t.data.y-=n})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){t.x-=r,t.y-=n})),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)})),{width:o-r+u,height:i-n+d}},ir=function(t){t.getAllEdges().forEach((function(e){var r,n,o=t.getNode(e.source),i=t.getNode(e.target);e.data.points?(r=e.data.points[0],n=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:i.data.x,y:i.data.y},n={x:o.data.x,y:o.data.y}),e.data.points.unshift(Kt(o.data,r)),e.data.points.push(Kt(i.data,n))}))},ar=function(t){t.getAllEdges().forEach((function(t){if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},sr=function(t){t.getAllEdges().forEach((function(t){var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},ur=function(t){t.getAllNodes().forEach((function(e){var r,n,o;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){var i=t.getNode(e.id),a=t.getNode(i.data.borderTop),s=t.getNode(i.data.borderBottom),u=t.getNode(i.data.borderLeft[(null===(n=i.data.borderLeft)||void 0===n?void 0:n.length)-1]),h=t.getNode(i.data.borderRight[(null===(o=i.data.borderRight)||void 0===o?void 0:o.length)-1]);i.data.width=Math.abs((null==h?void 0:h.data.x)-(null==u?void 0:u.data.x))||10,i.data.height=Math.abs((null==s?void 0:s.data.y)-(null==a?void 0:a.data.y))||10,i.data.x=((null==u?void 0:u.data.x)||0)+i.data.width/2,i.data.y=((null==a?void 0:a.data.y)||0)+i.data.height/2}})),t.getAllNodes().forEach((function(e){"border"===e.data.dummy&&t.removeNode(e.id)}))},hr=function(t){t.getAllEdges().forEach((function(e){if(e.source===e.target){var r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}}))},dr=function(t){var e=Yt(t);null==e||e.forEach((function(e){var r=0;null==e||e.forEach((function(e,n){var o,i=t.getNode(e);i.data.order=n+r,null===(o=i.data.selfEdges)||void 0===o||o.forEach((function(e){Ut(t,"selfedge",{width:e.data.width,height:e.data.height,rank:i.data.rank,order:n+ ++r,e},"_se")})),delete i.data.selfEdges}))}))},lr=function(t){t.getAllNodes().forEach((function(e){var r=t.getNode(e.id);if("selfedge"===r.data.dummy){var n=t.getNode(r.data.e.source),o=n.data.x+n.data.width/2,i=n.data.y,a=r.data.x-o,s=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}}))},cr=function(t,e){var r={};return null==e||e.forEach((function(e){void 0!==t[e]&&(r[e]=+t[e])})),r},fr=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(r){e[r.toLowerCase()]=t[r]})),e},gr={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="dagre",this.layoutNode=function(t){return t.data.layout},this.options=n(n({},gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericDagreLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericDagreLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericDagreLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,E,b,M,k,_,z,R,I,D,O,P,T,C,q,L,j,F,V,B,G=this;return a(this,(function(a){return o=n(n({},this.options),r),i=o.nodeSize,s=o.align,u=o.rankdir,h=void 0===u?"TB":u,d=o.ranksep,l=o.nodesep,f=o.ranksepFunc,g=o.nodesepFunc,p=o.edgeLabelSpace,v=o.nodeOrder,y=o.begin,m=o.controlPoints,w=o.radial,E=new c({tree:[]}),b=S(d||50,f),M=S(l||50,g),k=M,_=b,"LR"!==h&&"RL"!==h||(k=b,_=M),z=A(i,void 0),R=e.getAllNodes(),I=e.getAllEdges(),R.filter((function(t){return t.data.layout})).forEach((function(t){var e=z(t),r=_(t),n=e+2*k(t),o=e+2*r,i=t.data.layer;x(i)?E.addNode({id:t.id,data:{width:n,height:o,layer:i}}):E.addNode({id:t.id,data:{width:n,height:o}})})),I.forEach((function(t){G.layoutNode(E.getNode(t.source))&&G.layoutNode(E.getNode(t.target))&&E.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),function(t,e){var r,o,i=e.edgeLabelSpace,a=e.keepNodeOrder,s=e.prevGraph,u=e.rankdir,h=e.ranksep;!a&&s&&(o=s,(r=t).getAllNodes().forEach((function(t){var e=r.getNode(t.id),n=o.getNode(t.id);void 0!==n?(e.data.fixorder=n.data._order,delete n.data._order):delete e.data.fixorder})));var d=function(t){var e=new c({tree:[]});return t.getAllNodes().forEach((function(r){var o=fr(t.getNode(r.id).data),i=n(n({},Xe),o),a=cr(i,Je);e.hasNode(r.id)||e.addNode({id:r.id,data:n({},a)});var s=t.getParent(r.id);null==s||(e.hasNode(s.id)||e.addNode(n({},s)),e.setParent(r.id,s.id))})),t.getAllEdges().forEach((function(r){var n=fr(t.getEdge(r.id).data),o={};null==tr||tr.forEach((function(t){void 0!==n[t]&&(o[t]=n[t])})),e.addEdge({id:r.id,source:r.source,target:r.target,data:Object.assign({},Ze,cr(n,Qe),o)})})),e}(t);i&&(e.ranksep=function(t,e){var r=e.ranksep,n=void 0===r?0:r,o=e.rankdir;return t.getAllNodes().forEach((function(t){isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((function(t){var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===o||"BT"===o?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2}(d,{rankdir:u,ranksep:h}));try{Ye(d,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph\'s structure:\\n",t);throw t}!function(t,e){t.getAllNodes().forEach((function(r){var n,o=t.getNode(r.id);if(o){var i=e.getNode(r.id);o.data.x=i.data.x,o.data.y=i.data.y,o.data._order=i.data.order,o.data._rank=i.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(o.data.width=i.data.width,o.data.height=i.data.height)}})),t.getAllEdges().forEach((function(r){var n=t.getEdge(r.id),o=e.getEdge(r.id);n.data.points=o?o.data.points:[],o&&o.data.hasOwnProperty("x")&&(n.data.x=o.data.x,n.data.y=o.data.y)}))}(t,d)}(E,{prevGraph:null,edgeLabelSpace:p,keepNodeOrder:!!v,nodeOrder:v||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:h,nodesep:l,align:s}),D=[0,0],y&&(O=1/0,P=1/0,E.getAllNodes().forEach((function(t){O>t.data.x&&(O=t.data.x),P>t.data.y&&(P=t.data.y)})),E.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){O>t.x&&(O=t.x),P>t.y&&(P=t.y)}))})),D[0]=y[0]-O,D[1]=y[1]-P),T="LR"===h||"RL"===h,w||(C=new Set,q="BT"===h||"RL"===h?function(t,e){return e-t}:function(t,e){return t-e},E.getAllNodes().forEach((function(t){t.data.x=t.data.x+D[0],t.data.y=t.data.y+D[1],C.add(T?t.data.x:t.data.y)})),L=Array.from(C).sort(q),j=T?function(t,e){return t.x!==e.x}:function(t,e){return t.y!==e.y},F=T?function(t,e,r){var n=Math.max(e.y,r.y),o=Math.min(e.y,r.y);return t.filter((function(t){return t.y<=n&&t.y>=o}))}:function(t,e,r){var n=Math.max(e.x,r.x),o=Math.min(e.x,r.x);return t.filter((function(t){return t.x<=n&&t.x>=o}))},E.getAllEdges().forEach((function(t,e){var r;p&&m&&"loop"!==t.data.type&&(t.data.controlPoints=vr(null===(r=t.data.points)||void 0===r?void 0:r.map((function(t){var e=t.x,r=t.y;return{x:e+D[0],y:r+D[1]}})),E.getNode(t.source),E.getNode(t.target),L,T,j,F))}))),V=[],V=E.getAllNodes().map((function(t){return N(t)})),B=E.getAllEdges(),t&&(V.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),B.forEach((function(t){e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),[2,{nodes:V,edges:B}]}))}))},t}(),vr=function(t,e,r,n,o,i,a){var s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){var u=e.data,h=u.x,d=u.y,l=r.data,c=l.x,f=l.y;if(o&&(h=e.data.y,d=e.data.x,c=r.data.y,f=r.data.x),f!==d&&h!==c){var g=n.indexOf(d),p=n[g+1];if(p){var v=s[0],y=o?{x:(d+p)/2,y:(null==v?void 0:v.y)||c}:{x:(null==v?void 0:v.x)||c,y:(d+p)/2};v&&!i(v,y)||s.unshift(y)}var m=n.indexOf(f),w=Math.abs(m-g);if(1===w)(s=a(s,e.data,r.data)).length||s.push(o?{x:(d+f)/2,y:h}:{x:h,y:(d+f)/2});else if(w>1){var x=n[m-1];if(x){var E=s[s.length-1],N=o?{x:(f+x)/2,y:(null==E?void 0:E.y)||c}:{x:(null==E?void 0:E.x)||h,y:(f+x)/2};E&&!i(E,N)||s.push(N)}}}}return s};function yr(t,e,r,n,o){if(isNaN(e)||isNaN(r)||isNaN(n))return t;var i,a,s,u,h,d,l,c,f,g,p,v,y=t._root,m={data:o},w=t._x0,x=t._y0,E=t._z0,N=t._x1,b=t._y1,M=t._z1;if(!y)return t._root=m,t;for(;y.length;)if((c=e>=(a=(w+N)/2))?w=a:N=a,(f=r>=(s=(x+b)/2))?x=s:b=s,(g=n>=(u=(E+M)/2))?E=u:M=u,i=y,!(y=y[p=g<<2|f<<1|c]))return i[p]=m,t;if(h=+t._x.call(null,y.data),d=+t._y.call(null,y.data),l=+t._z.call(null,y.data),e===h&&r===d&&n===l)return m.next=y,i?i[p]=m:t._root=m,t;do{i=i?i[p]=new Array(8):t._root=new Array(8),(c=e>=(a=(w+N)/2))?w=a:N=a,(f=r>=(s=(x+b)/2))?x=s:b=s,(g=n>=(u=(E+M)/2))?E=u:M=u}while((p=g<<2|f<<1|c)==(v=(l>=u)<<2|(d>=s)<<1|h>=a));return i[v]=y,i[p]=m,t}function mr(t,e,r,n,o,i,a){this.node=t,this.x0=e,this.y0=r,this.z0=n,this.x1=o,this.y1=i,this.z1=a}function wr(t){return t[0]}function xr(t){return t[1]}function Er(t){return t[2]}function Nr(t,e,r,n){var o=new br(null==e?wr:e,null==r?xr:r,null==n?Er:n,NaN,NaN,NaN,NaN,NaN,NaN);return null==t?o:o.addAll(t)}function br(t,e,r,n,o,i,a,s,u){this._x=t,this._y=e,this._z=r,this._x0=n,this._y0=o,this._z0=i,this._x1=a,this._y1=s,this._z1=u,this._root=void 0}function Mr(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var Sr=Nr.prototype=br.prototype;function kr(t){var e=0,r=0,n=0,o=0,i=t.length;if(i){for(var a=0;a<i;a++)(s=t[a])&&s.weight&&(e+=s.weight,r+=s.x*s.weight,n+=s.y*s.weight,o+=s.z*s.weight);t.x=r/e,t.y=n/e,t.z=o/e,t.weight=e}else{var s=t;t.x=s.data.x,t.y=s.data.y,t.z=s.data.z,t.weight=s.data.weight}}Sr.copy=function(){var t,e,r=new br(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),n=this._root;if(!n)return r;if(!n.length)return r._root=Mr(n),r;for(t=[{source:n,target:r._root=new Array(8)}];n=t.pop();)for(var o=0;o<8;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(8)}):n.target[o]=Mr(e));return r},Sr.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t),n=+this._z.call(null,t);return yr(this.cover(e,r,n),e,r,n,t)},Sr.addAll=function(t){Array.isArray(t)||(t=Array.from(t));const e=t.length,r=new Float64Array(e),n=new Float64Array(e),o=new Float64Array(e);let i=1/0,a=1/0,s=1/0,u=-1/0,h=-1/0,d=-1/0;for(let l,c,f,g,p=0;p<e;++p)isNaN(c=+this._x.call(null,l=t[p]))||isNaN(f=+this._y.call(null,l))||isNaN(g=+this._z.call(null,l))||(r[p]=c,n[p]=f,o[p]=g,c<i&&(i=c),c>u&&(u=c),f<a&&(a=f),f>h&&(h=f),g<s&&(s=g),g>d&&(d=g));if(i>u||a>h||s>d)return this;this.cover(i,a,s).cover(u,h,d);for(let i=0;i<e;++i)yr(this,r[i],n[i],o[i],t[i]);return this},Sr.cover=function(t,e,r){if(isNaN(t=+t)||isNaN(e=+e)||isNaN(r=+r))return this;var n=this._x0,o=this._y0,i=this._z0,a=this._x1,s=this._y1,u=this._z1;if(isNaN(n))a=(n=Math.floor(t))+1,s=(o=Math.floor(e))+1,u=(i=Math.floor(r))+1;else{for(var h,d,l=a-n||1,c=this._root;n>t||t>=a||o>e||e>=s||i>r||r>=u;)switch(d=(r<i)<<2|(e<o)<<1|t<n,(h=new Array(8))[d]=c,c=h,l*=2,d){case 0:a=n+l,s=o+l,u=i+l;break;case 1:n=a-l,s=o+l,u=i+l;break;case 2:a=n+l,o=s-l,u=i+l;break;case 3:n=a-l,o=s-l,u=i+l;break;case 4:a=n+l,s=o+l,i=u-l;break;case 5:n=a-l,s=o+l,i=u-l;break;case 6:a=n+l,o=s-l,i=u-l;break;case 7:n=a-l,o=s-l,i=u-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=o,this._z0=i,this._x1=a,this._y1=s,this._z1=u,this},Sr.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Sr.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},Sr.find=function(t,e,r,n){var o,i,a,s,u,h,d,l,c,f=this._x0,g=this._y0,p=this._z0,v=this._x1,y=this._y1,m=this._z1,w=[],x=this._root;for(x&&w.push(new mr(x,f,g,p,v,y,m)),null==n?n=1/0:(f=t-n,g=e-n,p=r-n,v=t+n,y=e+n,m=r+n,n*=n);l=w.pop();)if(!(!(x=l.node)||(i=l.x0)>v||(a=l.y0)>y||(s=l.z0)>m||(u=l.x1)<f||(h=l.y1)<g||(d=l.z1)<p))if(x.length){var E=(i+u)/2,N=(a+h)/2,b=(s+d)/2;w.push(new mr(x[7],E,N,b,u,h,d),new mr(x[6],i,N,b,E,h,d),new mr(x[5],E,a,b,u,N,d),new mr(x[4],i,a,b,E,N,d),new mr(x[3],E,N,s,u,h,b),new mr(x[2],i,N,s,E,h,b),new mr(x[1],E,a,s,u,N,b),new mr(x[0],i,a,s,E,N,b)),(c=(r>=b)<<2|(e>=N)<<1|t>=E)&&(l=w[w.length-1],w[w.length-1]=w[w.length-1-c],w[w.length-1-c]=l)}else{var M=t-+this._x.call(null,x.data),S=e-+this._y.call(null,x.data),k=r-+this._z.call(null,x.data),A=M*M+S*S+k*k;if(A<n){var _=Math.sqrt(n=A);f=t-_,g=e-_,p=r-_,v=t+_,y=e+_,m=r+_,o=x.data}}return o},Sr.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t))||isNaN(s=+this._z.call(null,t)))return this;var e,r,n,o,i,a,s,u,h,d,l,c,f,g,p,v=this._root,y=this._x0,m=this._y0,w=this._z0,x=this._x1,E=this._y1,N=this._z1;if(!v)return this;if(v.length)for(;;){if((l=i>=(u=(y+x)/2))?y=u:x=u,(c=a>=(h=(m+E)/2))?m=h:E=h,(f=s>=(d=(w+N)/2))?w=d:N=d,e=v,!(v=v[g=f<<2|c<<1|l]))return this;if(!v.length)break;(e[g+1&7]||e[g+2&7]||e[g+3&7]||e[g+4&7]||e[g+5&7]||e[g+6&7]||e[g+7&7])&&(r=e,p=g)}for(;v.data!==t;)if(n=v,!(v=v.next))return this;return(o=v.next)&&delete v.next,n?(o?n.next=o:delete n.next,this):e?(o?e[g]=o:delete e[g],(v=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&v===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!v.length&&(r?r[p]=v:this._root=v),this):(this._root=o,this)},Sr.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},Sr.root=function(){return this._root},Sr.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Sr.visit=function(t){var e,r,n,o,i,a,s,u,h=[],d=this._root;for(d&&h.push(new mr(d,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=h.pop();)if(!t(d=e.node,n=e.x0,o=e.y0,i=e.z0,a=e.x1,s=e.y1,u=e.z1)&&d.length){var l=(n+a)/2,c=(o+s)/2,f=(i+u)/2;(r=d[7])&&h.push(new mr(r,l,c,f,a,s,u)),(r=d[6])&&h.push(new mr(r,n,c,f,l,s,u)),(r=d[5])&&h.push(new mr(r,l,o,f,a,c,u)),(r=d[4])&&h.push(new mr(r,n,o,f,l,c,u)),(r=d[3])&&h.push(new mr(r,l,c,i,a,s,f)),(r=d[2])&&h.push(new mr(r,n,c,i,l,s,f)),(r=d[1])&&h.push(new mr(r,l,o,i,a,c,f)),(r=d[0])&&h.push(new mr(r,n,o,i,l,c,f))}return this},Sr.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new mr(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.z0,h=e.x1,d=e.y1,l=e.z1,c=(a+h)/2,f=(s+d)/2,g=(u+l)/2;(i=o[0])&&r.push(new mr(i,a,s,u,c,f,g)),(i=o[1])&&r.push(new mr(i,c,s,u,h,f,g)),(i=o[2])&&r.push(new mr(i,a,f,u,c,d,g)),(i=o[3])&&r.push(new mr(i,c,f,u,h,d,g)),(i=o[4])&&r.push(new mr(i,a,s,g,c,f,l)),(i=o[5])&&r.push(new mr(i,c,s,g,h,f,l)),(i=o[6])&&r.push(new mr(i,a,f,g,c,d,l)),(i=o[7])&&r.push(new mr(i,c,f,g,h,d,l))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.z0,e.x1,e.y1,e.z1);return this},Sr.x=function(t){return arguments.length?(this._x=t,this):this._x},Sr.y=function(t){return arguments.length?(this._y=t,this):this._y},Sr.z=function(t){return arguments.length?(this._z=t,this):this._z};var Ar=function(t,e,r,n,o,i,a){var s=[r,n,o][a-1],u=i.x-t.x||.1,h=i.y-t.y||.1,d=i.z-t.z||.1,l=s-e,c=u*u+h*h+d*d,f=Math.sqrt(c)*c;if(l*l*.81<c){var g=t.weight/f;return i.vx+=u*g,i.vy+=h*g,i.vz+=d*g,!0}if(t.length)return!1;t.data!==i&&(g=t.data.weight/f,i.vx+=u*g,i.vy+=h*g,i.vz+=d*g)},_r={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},zr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=n(n({},_r),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===e.options.dimensions?t.data.z:void 0})})),n},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,E,N,b,M,S,k,A=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=this.formatOptions(o,e),h=u.dimensions,d=u.width,l=u.height,f=u.nodeSize,g=u.getMass,p=u.nodeStrength,v=u.edgeStrength,y=u.linkDistance,m=i.map((function(t,e){return n(n({},t),{data:n(n({},t.data),{x:x(t.data.x)?t.data.x:Math.random()*d,y:x(t.data.y)?t.data.y:Math.random()*l,z:x(t.data.z)?t.data.z:Math.random()*Math.sqrt(d*l),size:f(t)||30,mass:g(t),nodeStrength:p(t)})})})),w=s.map((function(t){return n(n({},t),{data:n(n({},t.data),{edgeStrength:v(t),linkDistance:y(t,e.getNode(t.source),e.getNode(t.target))})})})),(null==i?void 0:i.length)?(E={},i.forEach((function(t,e){E[t.id]={x:0,y:0,z:0}})),N=new c({nodes:m,edges:w}),this.formatCentripetal(u,N),b=u.maxIteration,M=u.minMovement,S=u.onTick,this.lastLayoutNodes=m,this.lastLayoutEdges=w,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=N,this.lastOptions=u,this.lastVelMap=E,"undefined"==typeof window?[2]:(k=0,[2,new Promise((function(r){A.timeInterval=window.setInterval((function(){i&&A.running||r({nodes:Pr(e,m),edges:s}),A.runOneStep(N,e,k,E,u),A.updatePosition(e,N,E,u),t&&m.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===h?t.data.z:void 0})})),null==S||S({nodes:Pr(e,m),edges:s}),(++k>=b||A.judgingDistance<M)&&(window.clearInterval(A.timeInterval),r({nodes:Pr(e,m),edges:s}))}),0),A.running=!0}))])):(this.lastResult={nodes:[],edges:s},[2,{nodes:[],edges:s}])}))}))},t.prototype.formatOptions=function(t,e){var r=t,n=t.width,o=t.height,i=t.getMass;if(r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=o||"undefined"==typeof window?o:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),i||(r.getMass=function(t){var r=1;x(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);var n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),t.preventOverlap){var a=S(0,t.nodeSpacing);t.nodeSize?g(t.nodeSize)?r.nodeSize=function(e){var r=t.nodeSize;return Math.max(r[0],r[1])+a(e)}:r.nodeSize=function(e){return t.nodeSize+a(e)}:r.nodeSize=function(t){var e=((null==t?void 0:t.data)||{}).size;return e?g(e)?Math.max(e[0],e[1])+a(t):M(e)?Math.max(e.width,e.height)+a(t):e+a(t):10+a(t)}}return r.linkDistance=t.linkDistance?S(1,t.linkDistance):function(t){return 1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target))},r.nodeStrength=S(1,t.nodeStrength),r.edgeStrength=S(1,t.edgeStrength),t},t.prototype.formatCentripetal=function(t,e){var r,n=t.centripetalOptions,o=t.center,i=t.clusterNodeStrength,a=t.leafCluster,s=t.clustering,u=t.nodeClusterBy,h=e.getAllNodes(),d=n||{leaf:2,single:2,others:1,center:function(t){return{x:o[0],y:o[1]}}};"function"!=typeof i&&(t.clusterNodeStrength=function(t){return i});var l=[];if(a&&u&&(r=Rr(e,u),l=Array.from(new Set(null==h?void 0:h.map((function(t){return t.data[u]}))))||[],t.centripetalOptions=Object.assign(d,{single:100,leaf:function(e){var n=r[e.id]||{},o=n.siblingLeaves,i=n.sameTypeLeaves;return(null==i?void 0:i.length)===(null==o?void 0:o.length)||1===(null==l?void 0:l.length)?1:t.clusterNodeStrength(e)},others:1,center:function(t){var n,o=e.getDegree(t.id,"both");if(!o)return{x:100,y:100};if(1===o){var i=(r[t.id]||{}).sameTypeLeaves,a=void 0===i?[]:i;1===a.length?n=void 0:a.length>1&&(n=Or(a))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y}}})),s&&u){r||(r=Rr(e,u)),l||(l=Array.from(new Set(h.map((function(t){return t.data[u]}))))),l=l.filter((function(t){return void 0!==t}));var c={};l.forEach((function(t){var r=h.filter((function(e){return e.data[u]===t})).map((function(t){return e.getNode(t.id)}));c[t]=Or(r)})),t.centripetalOptions=Object.assign(d,{single:function(e){return t.clusterNodeStrength(e)},leaf:function(e){return t.clusterNodeStrength(e)},others:function(e){return t.clusterNodeStrength(e)},center:function(t){var e=c[t.data[u]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y}}})}var f=t.centripetalOptions||{},g=f.leaf,p=f.single,v=f.others;g&&"function"!=typeof g&&(t.centripetalOptions.leaf=function(){return g}),p&&"function"!=typeof p&&(t.centripetalOptions.single=function(){return p}),v&&"function"!=typeof v&&(t.centripetalOptions.others=function(){return v})},t.prototype.runOneStep=function(t,e,r,n,o){var i={},a=t.getAllNodes(),s=t.getAllEdges();if(null==a?void 0:a.length){var u=o.monitor;this.calRepulsive(t,i,o),s&&this.calAttractive(t,i,o),this.calGravity(t,e,i,o),this.updateVelocity(t,i,n,o),u&&u({energy:this.calTotalEnergy(i,a),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}},t.prototype.calTotalEnergy=function(t,e){var r=this;if(!(null==e?void 0:e.length))return 0;var n=0;return e.forEach((function(e,o){var i=t[e.id].x,a=t[e.id].y,s=3===r.options.dimensions?t[e.id].z:0,u=i*i+a*a+s*s,h=e.data.mass;n+=(void 0===h?1:h)*u*.5})),n},t.prototype.calRepulsive=function(t,e,r){var n=r.dimensions,o=r.factor,i=r.coulombDisScale;!function(t,e,r,n,o){var i=e/r,a=t.getAllNodes(),s=a.map((function(t,e){var r=t.data,n=r.nodeStrength;return{x:r.x,y:r.y,z:r.z,size:r.size,index:e,vx:0,vy:0,vz:0,weight:i*n}})),u=(2===o?F(s,(function(t){return t.x}),(function(t){return t.y})):Nr(s,(function(t){return t.x}),(function(t){return t.y}),(function(t){return t.z}))).visitAfter(kr);s.forEach((function(t){!function(t,e,r){e.visit((function(e,n,o,i,a){return Ar(e,n,o,i,a,t,r)}))}(t,u,o)})),s.map((function(t,e){var r=a[e],o=r.id,i=r.data.mass,s=void 0===i?1:i;n[o]={x:t.vx/s,y:t.vy/s,z:t.vz/s}}))}(t,o,i*i,e,n)},t.prototype.calAttractive=function(t,e,r){var n=r.dimensions;t.getAllEdges().forEach((function(r,o){var i=r.source,a=r.target,s=t.getNode(i),u=t.getNode(a);if(s&&u){var h=u.data.x-s.data.x,d=u.data.y-s.data.y,l=3===n?u.data.z-s.data.z:0;h||d||(h=.01*Math.random(),d=.01*Math.random(),3!==n||l||(l=.01*Math.random()));var c=Math.sqrt(h*h+d*d+l*l),f=h/c,g=d/c,p=l/c,v=r.data||{},y=v.linkDistance,m=void 0===y?200:y,w=v.edgeStrength,x=(m-c)*(void 0===w?200:w),E=1/(s.data.mass||1),N=1/(u.data.mass||1),b=f*x,M=g*x,S=p*x;e[i].x-=b*E,e[i].y-=M*E,e[i].z-=S*E,e[a].x+=b*N,e[a].y+=M*N,e[a].z+=S*N}}))},t.prototype.calGravity=function(t,e,r,n){var o=n.getCenter,i=t.getAllNodes(),a=e.getAllNodes(),u=e.getAllEdges(),h=n.width,d=n.height,l=n.center,c=n.gravity,f=n.centripetalOptions;i&&i.forEach((function(n){var i=n.id,g=n.data,p=g.mass,v=g.x,y=g.y,m=g.z,w=e.getNode(i),E=0,N=0,b=0,M=c,S=t.getDegree(i,"in"),k=t.getDegree(i,"out"),A=t.getDegree(i,"both"),_=null==o?void 0:o(w,A);if(_){var z=s(_,3);E=v-z[0],N=y-z[1],M=z[2]}else E=v-l[0],N=y-l[1],b=m-l[2];if(M&&(r[i].x-=M*E/p,r[i].y-=M*N/p,r[i].z-=M*b/p),f){var R=f.leaf,I=f.single,D=f.others,O=f.center,P=(null==O?void 0:O(w,a,u,h,d))||{x:0,y:0,z:0,centerStrength:0},T=P.x,C=P.y,q=P.z,L=P.centerStrength;if(!x(T)||!x(C))return;var j=(v-T)/p,F=(y-C)/p,V=(m-q)/p;if(L&&(r[i].x-=L*j,r[i].y-=L*F,r[i].z-=L*V),0===A){var B=I(w);if(!B)return;return r[i].x-=B*j,r[i].y-=B*F,void(r[i].z-=B*V)}if(0===S||0===k){var G=R(w,a,u);if(!G)return;return r[i].x-=G*j,r[i].y-=G*F,void(r[i].z-=G*V)}var W=D(w);if(!W)return;r[i].x-=W*j,r[i].y-=W*F,r[i].z-=W*V}}))},t.prototype.updateVelocity=function(t,e,r,n){var o=n.damping,i=n.maxSpeed,a=n.interval,s=n.dimensions,u=t.getAllNodes();(null==u?void 0:u.length)&&u.forEach((function(t){var n=t.id,u=(r[n].x+e[n].x*a)*o||.01,h=(r[n].y+e[n].y*a)*o||.01,d=3===s?(r[n].z+e[n].z*a)*o||.01:0,l=Math.sqrt(u*u+h*h+d*d);if(l>i){var c=i/l;u*=c,h*=c,d*=c}r[n]={x:u,y:h,z:d}}))},t.prototype.updatePosition=function(t,e,r,n){var o=this,i=n.distanceThresholdMode,a=n.interval,s=n.dimensions,u=e.getAllNodes();if(null==u?void 0:u.length){var h=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),u.forEach((function(n){var u=n.id,d=t.getNode(u);if(x(d.data.fx)&&x(d.data.fy))e.mergeNodeData(u,{x:d.data.fx,y:d.data.fy,z:3===s?d.data.fz:void 0});else{var l=r[u].x*a,c=r[u].y*a,f=3===s?r[u].z*a:0;e.mergeNodeData(u,{x:n.data.x+l,y:n.data.y+c,z:n.data.z+f});var g=Math.sqrt(l*l+c*c+f*f);switch(i){case"max":o.judgingDistance<g&&(o.judgingDistance=g);break;case"min":o.judgingDistance>g&&(o.judgingDistance=g);break;default:h+=g}}})),i&&"mean"!==i||(this.judgingDistance=h/u.length)}else this.judgingDistance=0},t}(),Rr=function(t,e){var r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};var n={};return r.forEach((function(r,o){1===t.getDegree(r.id,"both")&&(n[r.id]=Ir(t,"leaf",r,e))})),n},Ir=function(t,e,r,n){var o=t.getDegree(r.id,"in"),i=t.getDegree(r.id,"out"),a=r,s=[];return 0===o?(a=t.getSuccessors(r.id)[0],s=t.getNeighbors(a.id)):0===i&&(a=t.getPredecessors(r.id)[0],s=t.getNeighbors(a.id)),s=s.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")})),{coreNode:a,siblingLeaves:s,sameTypeLeaves:Dr(t,e,n,r,s)}},Dr=function(t,e,r,n,o){var i=n.data[r]||"",a=(null==o?void 0:o.filter((function(t){return t.data[r]===i})))||[];return"leaf"===e&&(a=a.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")}))),a},Or=function(t){var e={x:0,y:0};t.forEach((function(t){var r=t.data,n=r.x,o=r.y;e.x+=n||0,e.y+=o||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},Pr=function(t,e){return e.map((function(e){var r=e.id,o=e.data,i=t.getNode(r);return n(n({},i),{data:n(n({},i.data),{x:o.x,y:o.y,z:o.z})})}))},Tr=function(){function t(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}return t.prototype.distanceTo=function(t){var e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)},t.prototype.setPos=function(t,e){this.rx=t,this.ry=e},t.prototype.resetForce=function(){this.fx=0,this.fy=0},t.prototype.addForce=function(t){var e=t.rx-this.rx,r=t.ry-this.ry,n=Math.hypot(e,r);n=n<1e-4?1e-4:n;var o=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=o*e/n,this.fy+=o*r/n},t.prototype.in=function(t){return t.contains(this.rx,this.ry)},t.prototype.add=function(e){var r=this.mass+e.mass;return new t({rx:(this.rx*this.mass+e.rx*e.mass)/r,ry:(this.ry*this.mass+e.ry*e.mass)/r,mass:r,degree:this.degree+e.degree})},t}();const Cr=Tr;const qr=function(){function t(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}return t.prototype.getLength=function(){return this.length},t.prototype.contains=function(t,e){var r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r},t.prototype.NW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.NE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.SW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t.prototype.SE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t}(),Lr=function(){function t(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}return t.prototype.insert=function(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e},t.prototype._putBody=function(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))},t.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},t.prototype.updateForce=function(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))},t}();var jr={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Fr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2",this.options=n(n({},jr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,x,E,b,M,S,k,A,z;return a(this,(function(a){if(o=e.getAllEdges(),i=e.getAllNodes(),s=this.formatOptions(r,i.length),u=s.width,h=s.height,d=s.prune,l=s.maxIteration,f=s.nodeSize,g=s.center,!(null==i?void 0:i.length)||1===i.length)return[2,_(e,t,g)];if(p=i.map((function(t){return N(t,[u,h])})),v=o.filter((function(t){return t.source!==t.target})),y=new c({nodes:p,edges:v}),m=this.getSizes(y,e,f),this.run(y,e,l,m,t,s),d){for(w=0;w<v.length;w+=1)x=v[w],E=x.source,b=x.target,M=y.getDegree(E),S=y.getDegree(E),M<=1?(k=y.getNode(b),y.mergeNodeData(E,{x:k.data.x,y:k.data.y})):S<=1&&(A=y.getNode(E),y.mergeNodeData(b,{x:A.data.x,y:A.data.y}));z=n(n({},s),{prune:!1,barnesHut:!1}),this.run(y,e,100,m,t,z)}return[2,{nodes:p,edges:o}]}))}))},t.prototype.getSizes=function(t,e,r){for(var n=t.getAllNodes(),o={},i=0;i<n.length;i+=1){var a=n[i],h=a.id,d=a.data;if(o[h]=10,x(d.size))o[h]=d.size;else if(g(d.size))isNaN(d.size[0])||(o[h]=Math.max(d.size[0])),isNaN(d.size[1])||(o[h]=Math.max(d.size[1]));else if(M(d.size))o[h]=Math.max(d.size.width,d.size.height);else if(b(r)){var l=r(e.getNode(h));g(l)?o[h]=Math.max.apply(Math,u([],s(l))):o[h]=l}else g(r)?o[h]=Math.max.apply(Math,u([],s(r))):x(r)&&(o[h]=r)}return o},t.prototype.formatOptions=function(t,e){void 0===t&&(t={});var r=n(n({},this.options),t),o=r.center,i=r.width,a=r.height,s=r.barnesHut,u=r.prune,h=r.maxIteration,d=r.kr,l=r.kg;return r.width=i||"undefined"==typeof window?i:window.innerWidth,r.height=a||"undefined"==typeof window?a:window.innerHeight,r.center=o||[r.width/2,r.height/2],void 0===s&&e>250&&(r.barnesHut=!0),void 0===u&&e>100&&(r.prune=!0),0!==h||u?0===h&&u&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)):(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)),d||(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),l||(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r},t.prototype.run=function(t,e,r,n,o,i){for(var a=i.kr,s=i.barnesHut,u=i.onTick,h=t.getAllNodes(),d=0,l=r,c={},f={},g={},p=0;p<h.length;p+=1){var v=h[p],y=v.data,m=v.id;if(c[m]=[0,0],s){var w={id:p,rx:y.x,ry:y.y,mass:1,g:a,degree:t.getDegree(m)};g[m]=new Cr(w)}}for(;l>0;)d=this.oneStep(t,{iter:l,preventOverlapIters:50,krPrime:100,sg:d,forces:c,preForces:f,bodies:g,sizes:n},i),l--,null==u||u({nodes:h,edges:e.getAllEdges()});return t},t.prototype.oneStep=function(t,e,r){for(var n=e.iter,o=e.preventOverlapIters,i=e.krPrime,a=e.sg,h=e.preForces,d=e.bodies,l=e.sizes,c=e.forces,f=r.preventOverlap,g=r.barnesHut,p=t.getAllNodes(),v=0;v<p.length;v+=1){var y=p[v].id;h[y]=u([],s(c[y])),c[y]=[0,0]}return c=this.getAttrForces(t,n,o,l,c,r),c=g&&(f&&n>o||!f)?this.getOptRepGraForces(t,c,d,r):this.getRepGraForces(t,n,o,c,i,l,r),this.updatePos(t,c,h,a,r)},t.prototype.getAttrForces=function(t,e,r,n,o,i){for(var a=i.preventOverlap,s=i.dissuadeHubs,u=i.mode,h=i.prune,d=t.getAllEdges(),l=0;l<d.length;l+=1){var c=d[l],f=c.source,g=c.target,p=t.getNode(f),v=t.getNode(g),y=t.getDegree(f),m=t.getDegree(g);if(!h||!(y<=1||m<=1)){var w=[v.data.x-p.data.x,v.data.y-p.data.y],x=Math.hypot(w[0],w[1]);x=x<1e-4?1e-4:x,w[0]=w[0]/x,w[1]=w[1]/x,a&&e<r&&(x=x-n[f]-n[g]);var E=x,N=E;"linlog"===u&&(N=E=Math.log(1+x)),s&&(E=x/y,N=x/m),a&&e<r&&x<=0?(E=0,N=0):a&&e<r&&x>0&&(E=x,N=x),o[f][0]+=E*w[0],o[g][0]-=N*w[0],o[f][1]+=E*w[1],o[g][1]-=N*w[1]}}return o},t.prototype.getOptRepGraForces=function(t,e,r,n){for(var o=n.kg,i=n.center,a=n.prune,s=t.getAllNodes(),u=s.length,h=9e10,d=-9e10,l=9e10,c=-9e10,f=0;f<u;f+=1){var g=s[f],p=g.id,v=g.data;a&&t.getDegree(p)<=1||(r[p].setPos(v.x,v.y),v.x>=d&&(d=v.x),v.x<=h&&(h=v.x),v.y>=c&&(c=v.y),v.y<=l&&(l=v.y))}var y=Math.max(d-h,c-l),m=new qr({xmid:(d+h)/2,ymid:(c+l)/2,length:y,massCenter:i,mass:u}),w=new Lr(m);for(f=0;f<u;f+=1)p=s[f].id,a&&t.getDegree(p)<=1||r[p].in(m)&&w.insert(r[p]);for(f=0;f<u;f+=1){var x=s[f],E=(p=x.id,v=x.data,t.getDegree(p));if(!(a&&E<=1)){r[p].resetForce(),w.updateForce(r[p]),e[p][0]-=r[p].fx,e[p][1]-=r[p].fy;var N=[v.x-i[0],v.y-i[1]],b=Math.hypot(N[0],N[1]);b=b<1e-4?1e-4:b,N[0]=N[0]/b,N[1]=N[1]/b;var M=o*(E+1);e[p][0]-=M*N[0],e[p][1]-=M*N[1]}}return e},t.prototype.getRepGraForces=function(t,e,r,n,o,i,a){for(var s=a.preventOverlap,u=a.kr,h=a.kg,d=a.center,l=a.prune,c=t.getAllNodes(),f=c.length,g=0;g<f;g+=1){for(var p=c[g],v=t.getDegree(p.id),y=g+1;y<f;y+=1){var m=c[y],w=t.getDegree(m.id);if(!l||!(v<=1||w<=1)){var x=[m.data.x-p.data.x,m.data.y-p.data.y],E=Math.hypot(x[0],x[1]);E=E<1e-4?1e-4:E,x[0]=x[0]/E,x[1]=x[1]/E,s&&e<r&&(E=E-i[p.id]-i[m.id]);var N=u*(v+1)*(w+1)/E;s&&e<r&&E<0?N=o*(v+1)*(w+1):s&&e<r&&0===E?N=0:s&&e<r&&E>0&&(N=u*(v+1)*(w+1)/E),n[p.id][0]-=N*x[0],n[m.id][0]+=N*x[0],n[p.id][1]-=N*x[1],n[m.id][1]+=N*x[1]}}var b=[p.data.x-d[0],p.data.y-d[1]],M=Math.hypot(b[0],b[1]);b[0]=b[0]/M,b[1]=b[1]/M;var S=h*(v+1);n[p.id][0]-=S*b[0],n[p.id][1]-=S*b[1]}return n},t.prototype.updatePos=function(t,e,r,n,o){for(var i=o.ks,a=o.tao,s=o.prune,u=o.ksmax,h=t.getAllNodes(),d=h.length,l=[],c=[],f=0,g=0,p=n,v=0;v<d;v+=1){var y=h[v].id,m=t.getDegree(y);if(!(s&&m<=1)){var w=[e[y][0]-r[y][0],e[y][1]-r[y][1]],E=Math.hypot(w[0],w[1]),N=[e[y][0]+r[y][0],e[y][1]+r[y][1]],b=Math.hypot(N[0],N[1]);l[v]=E,c[v]=b/2,f+=(m+1)*l[v],g+=(m+1)*c[v]}}var M=p;for(p=a*g/f,0!==M&&(p=p>1.5*M?1.5*M:p),v=0;v<d;v+=1){var S=h[v],k=(y=S.id,S.data);if(m=t.getDegree(y),!(s&&m<=1||x(k.fx)&&x(k.fy))){var A=i*p/(1+p*Math.sqrt(l[v])),_=Math.hypot(e[y][0],e[y][1]),z=u/(_=_<1e-4?1e-4:_),R=(A=A>z?z:A)*e[y][0],I=A*e[y][1];t.mergeNodeData(y,{x:k.x+R,y:k.y+I})}}return p},t}(),Vr={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Br=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=n(n({},Vr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===e.options.dimensions?t.data.z:void 0})})),n},t.prototype.genericFruchtermanLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,x,E,b=this;return a(this,(function(a){return this.running?[2]:(o=this.formatOptions(r),i=o.dimensions,s=o.width,u=o.height,h=o.center,d=o.clustering,l=o.nodeClusterBy,f=o.maxIteration,g=o.onTick,p=e.getAllNodes(),v=e.getAllEdges(),(null==p?void 0:p.length)?1===p.length?(t&&e.mergeNodeData(p[0].id,{x:h[0],y:h[1],z:3===i?h[2]:void 0}),y={nodes:[n(n({},p[0]),{data:n(n({},p[0].data),{x:h[0],y:h[1],z:3===i?h[2]:void 0})})],edges:v},this.lastResult=y,[2,y]):(m=p.map((function(t){return N(t,[s,u])})),w=new c({nodes:m,edges:v}),x={},d&&m.forEach((function(t){var e=t.data[l];x[e]||(x[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=m,this.lastLayoutEdges=v,this.lastAssign=t,this.lastGraph=w,this.lastOptions=o,this.lastClusterMap=x,"undefined"==typeof window?[2]:(E=0,[2,new Promise((function(r){b.timeInterval=window.setInterval((function(){b.running?(b.runOneStep(w,x,o),t&&m.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y,z:3===i?n.z:void 0})})),null==g||g({nodes:m,edges:v}),++E>=f&&(window.clearInterval(b.timeInterval),r({nodes:m,edges:v}))):r({nodes:m,edges:v})}),0),b.running=!0}))])):(y={nodes:[],edges:v},this.lastResult=y,[2,y]))}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=n(n({},this.options),t),r=e.clustering,o=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=r&&!!o,e},t.prototype.runOneStep=function(t,e,r){var n=r.dimensions,o=r.height,i=r.width,a=r.gravity,s=r.center,u=r.speed,h=r.clustering,d=r.nodeClusterBy,l=r.clusterGravity,c=o*i,f=Math.sqrt(c)/10,g=t.getAllNodes(),p=c/(g.length+1),v=Math.sqrt(p),y={};if(this.applyCalculate(t,y,v,p),h){for(var m in e)e[m].cx=0,e[m].cy=0,e[m].count=0;for(var m in g.forEach((function(t){var r=t.data,n=e[r[d]];x(r.x)&&(n.cx+=r.x),x(r.y)&&(n.cy+=r.y),n.count++})),e)e[m].cx/=e[m].count,e[m].cy/=e[m].count;var w=l||a;g.forEach((function(t,r){var n=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=e[o[d]],a=Math.sqrt((o.x-i.cx)*(o.x-i.cx)+(o.y-i.cy)*(o.y-i.cy)),s=v*w;y[n].x-=s*(o.x-i.cx)/a,y[n].y-=s*(o.y-i.cy)/a}}))}g.forEach((function(t,e){var r=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=.01*v*a;y[r].x-=i*(o.x-s[0]),y[r].y-=i*(o.y-s[1]),3===n&&(y[r].z-=i*(o.z-s[2]))}})),g.forEach((function(e,r){var o=e.id,i=e.data;if(x(i.fx)&&x(i.fy))return i.x=i.fx,i.y=i.fy,void(3===n&&(i.z=i.fz));if(x(i.x)&&x(i.y)){var a=Math.sqrt(y[o].x*y[o].x+y[o].y*y[o].y+(3===n?y[o].z*y[o].z:0));if(a>0){var s=Math.min(f*(u/800),a);t.mergeNodeData(o,{x:i.x+y[o].x/a*s,y:i.y+y[o].y/a*s,z:3===n?i.z+y[o].z/a*s:void 0})}}}))},t.prototype.applyCalculate=function(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)},t.prototype.calRepulsive=function(t,e,r){var n=this,o=t.getAllNodes();o.forEach((function(t,i){var a=t.data,s=t.id;e[s]={x:0,y:0,z:0},o.forEach((function(t,o){var u=t.data,h=t.id;if(!(i<=o)&&x(a.x)&&x(u.x)&&x(a.y)&&x(u.y)){var d=a.x-u.x,l=a.y-u.y,c=3===n.options.dimensions?a.z-u.z:0,f=d*d+l*l+c*c;0===f&&(f=1,d=.01,l=.01,c=.01);var g=r/f,p=d*g,v=l*g,y=c*g;e[s].x+=p,e[s].y+=v,e[h].x-=p,e[h].y-=v,3===n.options.dimensions&&(e[s].z+=y,e[h].z-=y)}}))}))},t.prototype.calAttractive=function(t,e,r){var n=this;t.getAllEdges().forEach((function(o){var i=o.source,a=o.target;if(i&&a&&i!==a){var s=t.getNode(i).data,u=t.getNode(a).data;if(x(u.x)&&x(s.x)&&x(u.y)&&x(s.y)){var h=u.x-s.x,d=u.y-s.y,l=3===n.options.dimensions?u.z-s.z:0,c=Math.sqrt(h*h+d*d+l*l)/r,f=h*c,g=d*c,p=l*c;e[i].x+=f,e[i].y+=g,e[a].x-=f,e[a].y-=g,3===n.options.dimensions&&(e[i].z+=p,e[a].z-=p)}}}))},t}(),Gr={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},Wr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="grid",this.options=n(n({},Gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericGridLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericGridLayout(!0,t,e),[2]}))}))},t.prototype.genericGridLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,p,v,y,m,w,E,b,M,A,z,R,I,D,P,T,C,q,L,j,F,V,B,G,W,$,U,H,K;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.begin,s=void 0===i?[0,0]:i,u=o.condense,h=o.preventOverlapPadding,d=o.preventOverlap,l=o.rows,c=o.cols,f=o.nodeSpacing,p=o.nodeSize,v=o.width,y=o.height,m=o.position,w=o.sortBy,E=e.getAllNodes(),b=e.getAllEdges(),!(M=null==E?void 0:E.length)||1===M)return[2,_(e,t,s)];if(A=E.map((function(t){return N(t)})),"id"===w||O(w)&&void 0!==A[0].data[w]||(w="degree"),"degree"===w?A.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):"id"===w?A.sort((function(t,e){return x(e.id)&&x(t.id)?e.id-t.id:(""+t.id).localeCompare(""+e.id)})):A.sort((function(t,e){return e.data[w]-t.data[w]})),z=v||"undefined"==typeof window?v:window.innerWidth,R=y||"undefined"==typeof window?y:window.innerHeight,I=M,D={rows:l,cols:c},null!=l&&null!=c?(D.rows=l,D.cols=c):null!=l&&null==c?(D.rows=l,D.cols=Math.ceil(I/D.rows)):null==l&&null!=c?(D.cols=c,D.rows=Math.ceil(I/D.cols)):(P=Math.sqrt(I*R/z),D.rows=Math.round(P),D.cols=Math.round(z/R*P)),D.rows=Math.max(D.rows,1),D.cols=Math.max(D.cols,1),D.cols*D.rows>I)T=$r(D),C=Ur(D),(T-1)*C>=I?$r(D,T-1):(C-1)*T>=I&&Ur(D,C-1);else for(;D.cols*D.rows<I;)T=$r(D),((C=Ur(D))+1)*T>=I?Ur(D,C+1):$r(D,T+1);for(q=u?0:z/D.cols,L=u?0:R/D.rows,(d||f)&&(j=S(10,f),F=k(30,p,!1),A.forEach((function(t){t.data.x&&t.data.y||(t.data.x=0,t.data.y=0);var r,n,o=e.getNode(t.id),i=F(o)||30;g(i)?(r=i[0],n=i[1]):(r=i,n=i);var a=void 0!==j?j(t):h,s=r+a,u=n+a;q=Math.max(q,s),L=Math.max(L,u)}))),V={},B={row:0,col:0},G={},W=0;W<A.length;W++){if($=A[W],U=void 0,m&&(U=m(e.getNode($.id))),U&&(void 0!==U.row||void 0!==U.col)){if(void 0===(H={row:U.row,col:U.col}).col)for(H.col=0;Hr(V,H);)H.col++;else if(void 0===H.row)for(H.row=0;Hr(V,H);)H.row++;G[$.id]=H,Kr(V,H)}Jr($,s,q,L,G,D,B,V)}return K={nodes:A,edges:b},t&&A.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,K]}))}))},t}(),$r=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.min(n,o):Math.min(n,o)===t.rows?t.rows=e:t.cols=e,r},Ur=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.max(n,o):Math.max(n,o)===t.rows?t.rows=e:t.cols=e,r},Hr=function(t,e){return t["c-"+e.row+"-"+e.col]||!1},Kr=function(t,e){return t["c-"+e.row+"-"+e.col]=!0},Yr=function(t,e){var r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},Jr=function(t,e,r,n,o,i,a,s){var u,h,d=o[t.id];if(d)u=d.col*r+r/2+e[0],h=d.row*n+n/2+e[1];else{for(;Hr(s,a);)Yr(i,a);u=a.col*r+r/2+e[0],h=a.row*n+n/2+e[1],Kr(s,a),Yr(i,a)}t.data.x=u,t.data.y=h};const Xr=Object.prototype.toString;function Qr(t){const e=Xr.call(t);return e.endsWith("Array]")&&!e.includes("Big")}function Zr(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!Qr(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]<a&&(a=t[s]);return a}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]>a&&(a=t[s]);return a}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,a=void 0===i?r.autoMinMax?n:0:i,s=r.max,u=void 0===s?r.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var h=(u-a)/(o-n),d=0;d<t.length;d++)e[d]=(t[d]-n)*h+a;return e}const tn=" ".repeat(2),en=" ".repeat(4);function rn(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=e;return`${t.constructor.name} {\\n${tn}[\\n${en}${function(t,e,r,n,o){const{rows:i,columns:a}=t,s=Math.min(i,e),u=Math.min(a,r),h=[];if("auto"===o){o=!1;t:for(let e=0;e<s;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let e=0;e<s;e++){let r=[];for(let i=0;i<u;i++)r.push(nn(t.get(e,i),n,o));h.push(`${r.join(" ")}`)}return u!==a&&(h[h.length-1]+=` ... ${a-r} more columns`),s!==i&&h.push(`... ${i-e} more rows`),h.join(`\\n${en}`)}(t,r,n,o,i)}\\n${tn}]\\n${tn}rows: ${t.rows}\\n${tn}columns: ${t.columns}\\n}`}function nn(t,e,r){return(t>=0&&r?` ${on(t,e-1)}`:on(t,e)).padEnd(e)}function on(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function an(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function sn(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function un(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function hn(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function dn(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(cn("startRow",e),cn("endRow",r),cn("startColumn",n),cn("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function ln(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function cn(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function fn(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class gn{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new vn(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new vn(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new vn(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new vn(t,e)}static ones(t,e){return new vn(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new vn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)o.set(r,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let a=o-n,s=new vn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(i()*a);s.set(r,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let t=0;t<n;t++)o.set(t,t,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let e=0;e<o;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new vn(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return gn.isMatrix(t)?t:new vn(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let a=o;a<e;a++){let e=t.get(r,a)-i*t.get(n,a);t.set(r,a,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new vn(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){an(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return vn.rowVector(this.getRow(t))}setRow(t,e){an(this,t),e=un(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){an(this,t),an(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){sn(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return vn.columnVector(this.getColumn(t))}setColumn(t,e){sn(this,t),e=hn(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){sn(this,t),sn(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){an(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){sn(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){fn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){fn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(an(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){an(this,t),fn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(an(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){an(this,t),fn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(sn(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){sn(this,t),fn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(sn(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){sn(this,t),fn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){gn.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=vn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new vn(e,n),i=new Float64Array(r);for(let a=0;a<n;a++){for(let e=0;e<r;e++)i[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,a,e)}}return o}strassen2x2(t){t=vn.checkMatrix(t);let e=new vn(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),h=t.get(1,1),d=(r+u)*(n+h),l=(a+u)*n,c=r*(i-h),f=u*(s-n),g=(r+o)*h,p=d+f-g+(o-u)*(s+h),v=c+g,y=l+f,m=d-l+c+(a-r)*(n+i);return e.set(0,0,p),e.set(0,1,v),e.set(1,0,y),e.set(1,1,m),e}strassen3x3(t){t=vn.checkMatrix(t);let e=new vn(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),h=this.get(2,1),d=this.get(2,2),l=t.get(0,0),c=t.get(0,1),f=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),y=t.get(2,0),m=t.get(2,1),w=t.get(2,2),x=(r-i)*(-c+p),E=(-r+i+a)*(l-c+p),N=(i+a)*(-l+c),b=r*l,M=(-r+u+h)*(l-f+v),S=(-r+u)*(f-v),k=(u+h)*(-l+f),A=(-o+h+d)*(p+y-m),_=(o-d)*(p-m),z=o*y,R=(h+d)*(-y+m),I=(-o+a+s)*(v+y-w),D=(o-s)*(v-w),O=(a+s)*(-y+w),P=b+z+n*g,T=(r+n+o-i-a-h-d)*p+E+N+b+A+z+R,C=b+M+k+(r+n+o-a-s-u-h)*v+z+I+O,q=x+a*(-l+c+g-p-v-y+w)+E+b+z+I+D,L=x+E+N+b+s*m,j=z+I+D+O+i*f,F=b+M+S+h*(-l+f+g-p-v-y+m)+A+_+z,V=A+_+z+R+u*c,B=b+M+S+k+d*w;return e.set(0,0,P),e.set(0,1,T),e.set(0,2,C),e.set(1,0,q),e.set(1,1,L),e.set(1,2,j),e.set(2,0,F),e.set(2,1,V),e.set(2,2,B),e}mmulStrassen(t){t=vn.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function a(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=gn.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${r} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let s=Math.max(r,o),u=Math.max(n,i);return e=a(e,s,u),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=a(e,n+1,o+1),r=a(r,n+1,o+1)):n%2==1?(e=a(e,n+1,o),r=a(r,n+1,o)):o%2==1&&(e=a(e,n,o+1),r=a(r,n,o+1));let i=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,s-1),h=r.subMatrix(0,i-1,0,s-1),d=e.subMatrix(0,i-1,s,e.columns-1),l=r.subMatrix(0,i-1,s,r.columns-1),c=e.subMatrix(i,e.rows-1,0,s-1),f=r.subMatrix(i,r.rows-1,0,s-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),p=r.subMatrix(i,r.rows-1,s,r.columns-1),v=t(gn.add(u,g),gn.add(h,p),i,s),y=t(gn.add(c,g),h,i,s),m=t(u,gn.sub(l,p),i,s),w=t(g,gn.sub(f,h),i,s),x=t(gn.add(u,d),p,i,s),E=t(gn.sub(c,u),gn.add(h,l),i,s),N=t(gn.sub(d,g),gn.add(f,p),i,s),b=gn.add(v,w);b.sub(x),b.add(N);let M=gn.add(m,x),S=gn.add(y,w),k=gn.sub(v,y);k.add(m),k.add(E);let A=gn.zeros(2*b.rows,2*b.columns);return A=A.setSubMatrix(b,0,0),A=A.setSubMatrix(M,b.rows,0),A=A.setSubMatrix(S,0,b.columns),A=A.setSubMatrix(k,b.rows,b.columns),A.subMatrix(0,n-1,0,o-1)}(e,t=a(t,s,u),s,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new vn(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&Zr(o,{min:e,max:r,output:o}),n.setRow(t,o)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new vn(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&Zr(o,{min:e,max:r,output:o}),n.setColumn(t,o)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=vn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new vn(e*n,r*o);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<o;s++)i.set(n*a+r,o*e+s,this.get(a,e)*t.get(r,s));return i}kroneckerSum(t){if(t=vn.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(vn.eye(r,r)),o=vn.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new vn(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=pn){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=pn){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){dn(this,t,e,r,n);let o=new vn(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new vn(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new vn(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=vn.checkMatrix(t)).isEmpty())return this;dn(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){!function(t,e){if(!Qr(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!Qr(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new vn(t.length,e.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<e.length;t++){let i=e[t];r.set(n,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new vn(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=ln(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=ln(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=ln(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=ln(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Qr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<n;a++){let n=0,s=0,u=0;for(let e=0;e<o;e++)u=t.get(a,e)-r[a],n+=u,s+=u*u;e?i.push((s-n*n/o)/(o-1)):i.push((s-n*n/o)/o)}return i}(this,r,n);case"column":if(!Qr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<o;a++){let o=0,s=0,u=0;for(let e=0;e<n;e++)u=t.get(e,a)-r[a],o+=u,s+=u*u;e?i.push((s-o*o/n)/(n-1)):i.push((s-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let a=0,s=0,u=0;for(let e=0;e<n;e++)for(let n=0;n<o;n++)u=t.get(e,n)-r,a+=u,s+=u*u;return e?(s-a*a/i)/(i-1):(s-a*a/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Qr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!Qr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!Qr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!Qr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return rn(this,t)}}function pn(t,e){return t-e}gn.prototype.klass="Matrix","undefined"!=typeof Symbol&&(gn.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return rn(this)}),gn.random=gn.rand,gn.randomInt=gn.randInt,gn.diagonal=gn.diag,gn.prototype.diagonal=gn.prototype.diag,gn.identity=gn.eye,gn.prototype.negate=gn.prototype.neg,gn.prototype.tensorProduct=gn.prototype.kroneckerProduct;class vn extends gn{constructor(t,e){if(super(),vn.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Qr(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!r[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return an(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),an(this,t,!0),e=Float64Array.from(un(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){sn(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),sn(this,t,!0),e=hn(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(gn,vn);class yn extends gn{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function mn(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class wn{constructor(t,e={}){if((t=yn.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=e;let s,u=Boolean(o),h=Boolean(i),d=!1;if(r<n)if(a){s=t.transpose(),r=s.rows,n=s.columns,d=!0;let e=u;u=h,h=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let l=Math.min(r,n),c=Math.min(r+1,n),f=new Float64Array(c),g=new vn(r,l),p=new vn(n,n),v=new Float64Array(n),y=new Float64Array(r),m=new Float64Array(c);for(let t=0;t<c;t++)m[t]=t;let w=Math.min(r-1,n),x=Math.max(0,Math.min(n-2,r)),E=Math.max(w,x);for(let t=0;t<E;t++){if(t<w){f[t]=0;for(let e=t;e<r;e++)f[t]=mn(f[t],s.get(e,t));if(0!==f[t]){s.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<r;e++)s.set(e,t,s.get(e,t)/f[t]);s.set(t,t,s.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<n;e++){if(t<w&&0!==f[t]){let n=0;for(let o=t;o<r;o++)n+=s.get(o,t)*s.get(o,e);n=-n/s.get(t,t);for(let o=t;o<r;o++)s.set(o,e,s.get(o,e)+n*s.get(o,t))}v[e]=s.get(t,e)}if(u&&t<w)for(let e=t;e<r;e++)g.set(e,t,s.get(e,t));if(t<x){v[t]=0;for(let e=t+1;e<n;e++)v[t]=mn(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<n;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<r&&0!==v[t]){for(let e=t+1;e<r;e++)y[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)y[e]+=v[r]*s.get(e,r);for(let e=t+1;e<n;e++){let n=-v[e]/v[t+1];for(let o=t+1;o<r;o++)s.set(o,e,s.get(o,e)+n*y[o])}}if(h)for(let e=t+1;e<n;e++)p.set(e,t,v[e])}}let N=Math.min(n,r+1);if(w<n&&(f[w]=s.get(w,w)),r<N&&(f[N-1]=0),x+1<N&&(v[x]=s.get(x,N-1)),v[N-1]=0,u){for(let t=w;t<l;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<l;e++){let n=0;for(let o=t;o<r;o++)n+=g.get(o,t)*g.get(o,e);n=-n/g.get(t,t);for(let o=t;o<r;o++)g.set(o,e,g.get(o,e)+n*g.get(o,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(h)for(let t=n-1;t>=0;t--){if(t<x&&0!==v[t])for(let e=t+1;e<n;e++){let r=0;for(let o=t+1;o<n;o++)r+=p.get(o,t)*p.get(o,e);r=-r/p.get(t+1,t);for(let o=t+1;o<n;o++)p.set(o,e,p.get(o,e)+r*p.get(o,t))}for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}let b=N-1,M=0,S=Number.EPSILON;for(;N>0;){let t,e;for(t=N-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===N-2)e=4;else{let r;for(r=N-1;r>=t&&r!==t;r--){let e=(r!==N?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(f[r])<=S*e){f[r]=0;break}}r===t?e=3:r===N-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[N-2];v[N-2]=0;for(let r=N-2;r>=t;r--){let o=mn(f[r],e),i=f[r]/o,a=e/o;if(f[r]=o,r!==t&&(e=-a*v[r-1],v[r-1]=i*v[r-1]),h)for(let t=0;t<n;t++)o=i*p.get(t,r)+a*p.get(t,N-1),p.set(t,N-1,-a*p.get(t,r)+i*p.get(t,N-1)),p.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<N;n++){let o=mn(f[n],e),i=f[n]/o,a=e/o;if(f[n]=o,e=-a*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g.get(e,n)+a*g.get(e,t-1),g.set(e,t-1,-a*g.get(e,n)+i*g.get(e,t-1)),g.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(f[N-1]),Math.abs(f[N-2]),Math.abs(v[N-2]),Math.abs(f[t]),Math.abs(v[t])),o=f[N-1]/e,i=f[N-2]/e,a=v[N-2]/e,s=f[t]/e,d=v[t]/e,l=((i+o)*(i-o)+a*a)/2,c=o*a*(o*a);let y=0;0===l&&0===c||(y=l<0?0-Math.sqrt(l*l+c):Math.sqrt(l*l+c),y=c/(l+y));let m=(s+o)*(s-o)+y,w=s*d;for(let e=t;e<N-1;e++){let o=mn(m,w);0===o&&(o=Number.MIN_VALUE);let i=m/o,a=w/o;if(e!==t&&(v[e-1]=o),m=i*f[e]+a*v[e],v[e]=i*v[e]-a*f[e],w=a*f[e+1],f[e+1]=i*f[e+1],h)for(let t=0;t<n;t++)o=i*p.get(t,e)+a*p.get(t,e+1),p.set(t,e+1,-a*p.get(t,e)+i*p.get(t,e+1)),p.set(t,e,o);if(o=mn(m,w),0===o&&(o=Number.MIN_VALUE),i=m/o,a=w/o,f[e]=o,m=i*v[e]+a*f[e+1],f[e+1]=-a*v[e]+i*f[e+1],w=a*v[e+1],v[e+1]=i*v[e+1],u&&e<r-1)for(let t=0;t<r;t++)o=i*g.get(t,e)+a*g.get(t,e+1),g.set(t,e+1,-a*g.get(t,e)+i*g.get(t,e+1)),g.set(t,e,o)}v[N-2]=m,M+=1;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,h))for(let e=0;e<=b;e++)p.set(e,t,-p.get(e,t));for(;t<b&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,h&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}M=0,N--}}if(d){let t=p;p=g,g=t}this.m=r,this.n=n,this.s=f,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,o=vn.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?o.set(t,t,0):o.set(t,t,1/this.s[t]);let i=this.U,a=this.rightSingularVectors,s=a.mmul(o),u=a.rows,h=i.rows,d=vn.zeros(u,h);for(let t=0;t<u;t++)for(let e=0;e<h;e++){let r=0;for(let o=0;o<n;o++)r+=s.get(t,o)*i.get(e,o);d.set(t,e,r)}return d.mmul(e)}solveForDiagonal(t){return this.solve(vn.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new vn(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,a=i.rows,s=i.columns,u=new vn(r,a);for(let t=0;t<r;t++)for(let e=0;e<a;e++){let r=0;for(let n=0;n<s;n++)r+=o.get(t,n)*i.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return vn.diag(this.s)}}var xn,En={center:[0,0],linkDistance:50},Nn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="mds",this.options=n(n({},En),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericMDSLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericMDSLayout(!0,t,e),[2]}))}))},t.prototype.genericMDSLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,g,y;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=void 0===i?[0,0]:i,u=o.linkDistance,h=void 0===u?50:u,d=e.getAllNodes(),l=e.getAllEdges(),(null==d?void 0:d.length)&&1!==d.length?(c=v({nodes:d,edges:l},!1),f=p(c),bn(f),m=h,w=[],f.forEach((function(t){var e=[];t.forEach((function(t){e.push(t*m)})),w.push(e)})),g=Mn(w),y=[],g.forEach((function(t,e){var r=N(d[e]);r.data.x=t[0]+s[0],r.data.y=t[1]+s[1],y.push(r)})),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:y,edges:l}]):[2,_(e,t,s)];var m,w}))}))},t}(),bn=function(t){var e=-999999;t.forEach((function(t){t.forEach((function(t){t!==1/0&&e<t&&(e=t)}))})),t.forEach((function(r,n){r.forEach((function(r,o){r===1/0&&(t[n][o]=e)}))}))},Mn=function(t){var e=vn.mul(vn.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),o=e.mean();e.add(o).subRowVector(r).subColumnVector(n);var i=new wn(e),a=vn.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((function(t){return vn.mul([t],[a]).toJSON()[0].splice(0,2)}))},Sn={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},kn=function(t,e,r,n,o,i){e.forEach((function(a,s){r[s]={x:0,y:0},e.forEach((function(e,u){if(s!==u&&o[s]===o[u]){var h=a.x-e.x,d=a.y-e.y,l=Math.sqrt(h*h+d*d);if(0===l){l=1;var c=s>u?1:-1;h=.01*c,d=.01*c}if(l<i(t[s])/2+i(t[u])/2){var f=n*n/l;r[s].x+=h/l*f,r[s].y+=d/l*f}}}))}))},An=function(t,e,r,n,o,i,a,s){var u=i||a/10;return n&&e.forEach((function(e,r){var n=t[r].x-t[o].x,i=t[r].y-t[o].y,a=Math.sqrt(n*n+i*i),s=i/a,u=-n/a,h=Math.sqrt(e.x*e.x+e.y*e.y),d=Math.acos((s*e.x+u*e.y)/h);d>Math.PI/2&&(d-=Math.PI/2,s*=-1,u*=-1);var l=Math.cos(d)*h;e.x=s*l,e.y=u*l})),t.forEach((function(i,a){if(a!==o){var h=Math.sqrt(e[a].x*e[a].x+e[a].y*e[a].y);if(h>0&&a!==o){var d=Math.min(u*(r/800),h);if(i.x+=e[a].x/h*d,i.y+=e[a].y/h*d,n){var l=i.x-t[o].x,c=i.y-t[o].y,f=Math.sqrt(l*l+c*c);l=l/f*s[a],c=c/f*s[a],i.x=t[o].x+l,i.y=t[o].y+c}}}})),t},_n={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},zn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="radial",this.options=n(n({},_n),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRadialLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRadialLayout(!0,t,e),[2]}))}))},t.prototype.genericRadialLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,h,d,l,c,f,g,y,m,w,x,E,b,M,S,k,z,R,I,D,P,T,C,q,L,j,F,V,B,G,W,$,U,H,K,Y,J,X,Q,Z,tt,et;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,h=o.height,d=o.center,l=o.focusNode,c=o.unitRadius,f=o.nodeSize,g=o.nodeSpacing,y=o.strictRadial,m=o.preventOverlap,w=o.maxPreventOverlapIteration,x=o.sortBy,E=o.linkDistance,b=void 0===E?50:E,M=o.sortStrength,S=void 0===M?10:M,k=o.maxIteration,z=void 0===k?1e3:k,R=e.getAllNodes(),I=e.getAllEdges(),D=i||"undefined"==typeof window?i:window.innerWidth,P=h||"undefined"==typeof window?h:window.innerHeight,T=d||[D/2,P/2],!(null==R?void 0:R.length)||1===R.length)return[2,_(e,t,T)];if(C=R[0],O(l)){for(q=0;q<R.length;q++)if(R[q].id===l){C=R[q];break}}else C=l||R[0];return L=Dn(R,C.id),j=v({nodes:R,edges:I},!1),F=p(j),V=Pn(F,L),On(F,L,V+1),B=F[L],G=D-T[0]>T[0]?T[0]:D-T[0],W=P-T[1]>T[1]?T[1]:P-T[1],0===G&&(G=D/2),0===W&&(W=P/2),$=Math.min(G,W),U=Math.max.apply(Math,u([],s(B))),H=[],K=c||$/U,B.forEach((function(t,e){H[e]=t*K})),Y=Rn(R,F,b,H,K,x,S),J=In(Y),X=function(t,e,r){try{var n=vn.mul(vn.pow(e,2),-.5),o=n.mean("row"),i=n.mean("column"),a=n.mean();n.add(a).subRowVector(o).subColumnVector(i);var s=new wn(n),u=vn.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((function(e){return vn.mul([e],[u]).toJSON()[0].splice(0,t)}))}catch(t){for(var h=[],d=0;d<e.length;d++){var l=Math.random()*r,c=Math.random()*r;h.push([l,c])}return h}}(b,Y,b),Q=X.map((function(t){var e=s(t,2),r=e[0],n=e[1];return{x:(isNaN(r)?Math.random()*b:r)-X[L][0],y:(isNaN(n)?Math.random()*b:n)-X[L][1]}})),this.run(z,Q,J,Y,H,L),m&&(Z=A(f,g),tt={nodes:R,nodeSizeFunc:Z,positions:Q,radii:H,height:P,width:D,strictRadial:Boolean(y),focusIdx:L,iterations:w||200,k:Q.length/4.5},Q=function(t,e){for(var r=n(n({},Sn),e),o=r.positions,i=r.iterations,a=r.width,s=r.k,u=r.speed,h=void 0===u?100:u,d=r.strictRadial,l=r.focusIdx,c=r.radii,f=void 0===c?[]:c,g=r.nodeSizeFunc,p=t.getAllNodes(),v=[],y=a/10,m=0;m<i;m++)o.forEach((function(t,e){v[e]={x:0,y:0}})),kn(p,o,v,s,f,g),An(o,v,h,d,l,y,a,f);return o}(e,tt)),et=[],Q.forEach((function(t,e){var r=N(R[e]);r.data.x=t.x+T[0],r.data.y=t.y+T[1],et.push(r)})),t&&et.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:et,edges:I}]}))}))},t.prototype.run=function(t,e,r,n,o,i){for(var a=0;a<=t;a++){var s=a/t;this.oneIteration(s,e,o,n,r,i)}},t.prototype.oneIteration=function(t,e,r,n,o,i){var a=1-t;e.forEach((function(s,u){var h=y(s,{x:0,y:0}),d=0===h?0:1/h;if(u!==i){var l=0,c=0,f=0;e.forEach((function(t,e){if(u!==e){var r=y(s,t),i=0===r?0:1/r,a=n[e][u];f+=o[u][e],l+=o[u][e]*(t.x+a*(s.x-t.x)*i),c+=o[u][e]*(t.y+a*(s.y-t.y)*i)}}));var g=0===r[u]?0:1/r[u];f*=a,f+=t*g*g,l*=a,l+=t*g*s.x*d,s.x=l/f,c*=a,c+=t*g*s.y*d,s.y=c/f}}))},t}(),Rn=function(t,e,r,n,o,i,a){if(!t)return[];var s=[];if(e){var u={};e.forEach((function(e,h){var d=[];e.forEach((function(e,s){var l,c;if(h===s)d.push(0);else if(n[h]===n[s])if("data"===i)d.push(e*(Math.abs(h-s)*a)/(n[h]/o));else if(i){var f=void 0,g=void 0;if(u[t[h].id])f=u[t[h].id];else{var p=("id"===i?t[h].id:null===(l=t[h].data)||void 0===l?void 0:l[i])||0;f=O(p)?p.charCodeAt(0):p,u[t[h].id]=f}u[t[s].id]?g=u[t[s].id]:(p=("id"===i?t[s].id:null===(c=t[s].data)||void 0===c?void 0:c[i])||0,g=O(p)?p.charCodeAt(0):p,u[t[s].id]=g),d.push(e*(Math.abs(f-g)*a)/(n[h]/o))}else d.push(e*r/(n[h]/o));else{var v=(r+o)/2;d.push(e*v)}})),s.push(d)}))}return s},In=function(t){for(var e=t.length,r=t[0].length,n=[],o=0;o<e;o++){for(var i=[],a=0;a<r;a++)0!==t[o][a]?i.push(1/(t[o][a]*t[o][a])):i.push(0);n.push(i)}return n},Dn=function(t,e){var r=-1;return t.forEach((function(t,n){t.id===e&&(r=n)})),Math.max(r,0)},On=function(t,e,r){for(var n=t.length,o=0;o<n;o++)if(t[e][o]===1/0){t[e][o]=r,t[o][e]=r;for(var i=0;i<n;i++)t[o][i]!==1/0&&t[e][i]===1/0&&(t[e][i]=r+t[o][i],t[i][e]=r+t[o][i])}for(o=0;o<n;o++)if(o!==e)for(i=0;i<n;i++)if(t[o][i]===1/0){var a=Math.abs(t[e][o]-t[e][i]);a=0===a?1:a,t[o][i]=a}},Pn=function(t,e){for(var r=0,n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r},Tn={center:[0,0],width:300,height:300},Cn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="random",this.options=n(n({},Tn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRandomLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRandomLayout(!0,t,e),[2]}))}))},t.prototype.genericRandomLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,h=e.getAllNodes(),d=s||"undefined"==typeof window?s:window.innerWidth,l=u||"undefined"==typeof window?u:window.innerHeight,c=i||[d/2,l/2],f=[],h&&h.forEach((function(t){f.push({id:t.id,data:{x:.9*(Math.random()-.5)*d+c[0],y:.9*(Math.random()-.5)*l+c[1]}})})),t&&f.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:f,edges:e.getAllEdges()}]}))}))},t}(),qn={circular:R,concentric:T,mds:Nn,random:Cn,grid:Wr,radial:zn,force:zr,d3force:Tt,fruchterman:Br,forceAtlas2:Fr,dagre:pr};function Ln(){var t;(null===(t=xn)||void 0===t?void 0:t.stop)&&xn.stop()}function jn(t,e){return i(this,void 0,void 0,(function(){var r,n,o,i,s,u,h,d,l;return a(this,(function(a){switch(a.label){case 0:if(r=t.layout,n=r.id,o=r.options,i=r.iterations,s=t.nodes,u=t.edges,h=new c({nodes:s,edges:u}),!(d=qn[n]))throw new Error("Unknown layout id: "+n);return[4,(xn=new d(o)).execute(h)];case 1:return l=a.sent(),!!(f=xn).tick&&!!f.stop&&(xn.stop(),l=xn.tick(i)),[2,[l,e]]}var f}))}))}addEventListener("message",(function(t){var r,n=t.data,o=n.type,i=n.method,a=n.id,s=n.params;"RPC"===o&&i&&((r=e[i])?Promise.resolve().then((function(){return r.apply(e,s)})):Promise.reject("No such method")).then((function(t){postMessage({type:"RPC",id:a,result:t})})).catch((function(t){var e={message:t};t.stack&&(e.message=t.message,e.stack=t.stack,e.name=t.name),postMessage({type:"RPC",id:a,error:e})}))})),postMessage({type:"RPC",method:"ready"});\n//# sourceMappingURL=5e37927bd3e57252658c.worker.js.map'])),{name:"[fullhash].worker.js"});return URL.revokeObjectURL(URL.createObjectURL(new Blob(['var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{calculateLayout:()=>jn,stopLayout:()=>Ln});var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function o(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function i(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function a(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function u(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}Object.create,Object.create;const h=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[],i=this._events["*"]||[],a=function(n){for(var o=n.length,i=0;i<o;i++)if(n[i]){var a=n[i],s=a.callback;a.once&&(n.splice(i,1),0===n.length&&delete e._events[t],o--,i--),s.apply(e,r)}};a(o),a(i)},t.prototype.off=function(t,e){if(t)if(e){for(var r=this._events[t]||[],n=r.length,o=0;o<n;o++)r[o].callback===e&&(r.splice(o,1),n--,o--);0===r.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function d(t,e,r,n){for(;t.length;){const o=t.shift();if(r(o))return!0;e.add(o.id),n(o.id).forEach((r=>{e.has(r.id)||(e.add(r.id),t.push(r))}))}return!1}function l(t,e,r,n){if(r(t))return!0;e.add(t.id);for(const o of n(t.id))if(!e.has(o.id)&&l(o,e,r,n))return!0;return!1}class c extends h{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const r=e.find((e=>e.type===t.type&&e.id===t.id&&e.propertyName===t.propertyName));r?r.newValue=t.newValue:e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const r=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),r=this.bothEdgesMap.get(t);r?.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((e=>{e.childrenMap.get(t)?.forEach((t=>{e.parentMap.delete(t.id)})),e.parentMap.delete(t),e.childrenMap.delete(t)})),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){const n=this.getNode(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateNodeDataProperty(t,e,r)}))}))}updateNodeData(...t){const e=t[0],r=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:o})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),o.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),o=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),o.delete(e),i.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.source,o=e;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:o})}))}updateEdgeTarget(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.target,o=e;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:o})}))}updateEdgeDataProperty(t,e,r){const n=this.getEdge(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}updateEdgeData(...t){const e=t[0],r=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:o})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateEdgeDataProperty(t,e,r)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const r=[],n=Array.isArray(t)?t:[t];for(;n.length;){const t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach((t=>{t.children?.forEach((r=>{this.setParent(r.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const r=this.treeIndices.get(e).childrenMap.get(t);return Array.from(r||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const r=[];let n,o=this.getNode(t);for(;n=this.getParent(o.id,e);)r.push(n),o=n;return r}setParent(t,e,r){this.checkTreeExistence(r);const n=this.treeIndices.get(r),o=this.getNode(t),i=n.parentMap.get(t),a=this.getNode(e);n.parentMap.set(t,a),i&&n.childrenMap.get(i.id)?.delete(o);let s=n.childrenMap.get(a.id);s||(s=new Set,n.childrenMap.set(a.id,s)),s.add(o),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:i?.id,newParentId:a.id})}))}dfsTree(t,e,r){return l(this.getNode(t),new Set,e,(t=>this.getChildren(t,r)))}bfsTree(t,e,r){return d([this.getNode(t)],new Set,e,(t=>this.getChildren(t,r)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return d([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return l(this.getNode(t),new Set,e,n)}clone(){const t=this.getAllNodes().map((t=>({...t,data:{...t.data}}))),e=this.getAllEdges().map((t=>({...t,data:{...t.data}}))),r=new c({nodes:t,edges:e});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},n)=>{const o=new Map;t.forEach(((t,e)=>{o.set(e,r.getNode(t.id))}));const i=new Map;e.forEach(((t,e)=>{i.set(e,new Set(Array.from(t).map((t=>r.getNode(t.id)))))})),r.treeIndices.set(n,{parentMap:o,childrenMap:i})})),r}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var f=/-(\\w)/g,g=(function(t){return t.replace(f,(function(t,e){return e?e.toUpperCase():""}))},Object.create(null),Array.isArray),p=function(t){for(var e=[],r=t.length,n=0;n<r;n+=1){e[n]=[];for(var o=0;o<r;o+=1)n===o?e[n][o]=0:0!==t[n][o]&&t[n][o]?e[n][o]=t[n][o]:e[n][o]=1/0}for(var i=0;i<r;i+=1)for(n=0;n<r;n+=1)for(o=0;o<r;o+=1)e[n][o]>e[n][i]+e[i][o]&&(e[n][o]=e[n][i]+e[i][o]);return e},v=function(t,e){var r=t.nodes,n=t.edges,o=[],i={};if(!r)throw new Error("invalid nodes data!");return r&&r.forEach((function(t,e){i[t.id]=e,o.push([])})),null==n||n.forEach((function(t){var r=t.source,n=t.target,a=i[r],s=i[n];void 0!==a&&void 0!==s&&(o[a][s]=1,e||(o[s][a]=1))})),o},y=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},m={}.toString;const w=function(t,e){return m.call(t)==="[object "+e+"]"},x=function(t){return w(t,"Number")};var E=function(t){if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var e=[];return t.forEach((function(t){e.push(t)})),e.map((function(t){return E(t)}))}if("object"==typeof t){var r={};return Object.keys(t).forEach((function(e){r[e]=E(t[e])})),r}return t},N=function(t,e){var r=E(t);return r.data=r.data||{},e&&(x(r.data.x)||(r.data.x=Math.random()*e[0]),x(r.data.y)||(r.data.y=Math.random()*e[1])),r};const b=function(t){return"function"==typeof t},M=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function S(t,e){return b(e)?e:x(e)?function(){return e}:function(){return t}}function k(t,e,r){return void 0===r&&(r=!0),e||0===e?b(e)?e:x(e)?function(){return e}:g(e)?function(){if(r){var n=Math.max.apply(Math,u([],s(e)));return isNaN(n)?t:n}return e}:M(e)?function(){if(r){var n=Math.max(e.width,e.height);return isNaN(n)?t:n}return[e.width,e.height]}:function(){return t}:function(e){var r=(e.data||{}).size;return r?g(r)?r[0]>r[1]?r[0]:r[1]:M(r)?r.width>r.height?r.width:r.height:r:t}}var A=function(t,e){var r;return r=x(e)?function(){return e}:b(e)?e:function(){return 0},t?g(t)?function(e){return(t[0]>t[1]?t[0]:t[1])+r(e)}:function(e){return t+r(e)}:function(t){var e,n;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return Math.max(t.data.bboxSize[0],t.data.bboxSize[1])+r(t);if(null===(n=t.data)||void 0===n?void 0:n.size){if(g(t.data.size))return Math.max(t.data.size[0],t.data.size[1])+r(t);var o=t.data.size;return M(o)?(o.width>o.height?o.width:o.height)+r(t):o+r(t)}return 10+r(t)}},_=function(t,e,r){var o=t.getAllNodes(),i=t.getAllEdges();return(null==o?void 0:o.length)?1===o.length?(e&&t.mergeNodeData(o[0].id,{x:r[0],y:r[1]}),{nodes:[n(n({},o[0]),{data:n(n({},o[0].data),{x:r[0],y:r[1]})})],edges:i}):void 0:{nodes:[],edges:i}},z={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},R=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="circular",this.options=n(n({},z),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericCircularLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericCircularLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericCircularLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,u,h,d,l,c,f,g,p,v,y,m,w,x,E,b,M,A,z,R,O,P,T,C,q,L,j,F,V,B,G,W,$,U;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,u=o.height,h=o.center,d=o.divisions,l=o.startAngle,c=void 0===l?0:l,f=o.endAngle,g=void 0===f?2*Math.PI:f,p=o.angleRatio,v=o.ordering,y=o.clockwise,m=o.nodeSpacing,w=o.nodeSize,x=e.getAllNodes(),E=e.getAllEdges(),b=s(D(i,u,h),3),M=b[0],A=b[1],z=b[2],!(R=null==x?void 0:x.length)||1===R)return[2,_(e,t,z)];for(O=(g-c)/R,P=o.radius,T=o.startRadius,C=o.endRadius,m?(q=S(10,m),L=k(10,w),j=-1/0,x.forEach((function(t){var e=L(t);j<e&&(j=e)})),F=0,x.forEach((function(t,e){F+=0===e?j||10:(q(t)||0)+(j||10)})),P=F/(2*Math.PI)):P||T||C?!T&&C?T=C:T&&!C&&(C=T):P=Math.min(A,M)/2,V=O*p,B=[],B="topology"===v?I(e,x):"topology-directed"===v?I(e,x,!0):"degree"===v?function(t,e){var r=[];return e.forEach((function(t,e){r.push(N(t))})),r.sort((function(e,r){return t.getDegree(e.id,"both")-t.getDegree(r.id,"both")})),r}(e,x):x.map((function(t){return N(t)})),G=Math.ceil(R/d),W=0;W<R;++W)($=P)||null===T||null===C||($=T+W*(C-T)/(R-1)),$||($=10+100*W/(R-1)),U=c+W%G*V+2*Math.PI/d*Math.floor(W/G),y||(U=g-W%G*V-2*Math.PI/d*Math.floor(W/G)),B[W].data.x=z[0]+Math.cos(U)*$,B[W].data.y=z[1]+Math.sin(U)*$;return t&&B.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:B,edges:E}]}))}))},t}(),I=function(t,e,r){void 0===r&&(r=!1);var n=[N(e[0])],o={},i=e.length;o[e[0].id]=!0;var a=0;return e.forEach((function(s,u){if(0!==u)if(u!==i-1&&t.getDegree(s.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(n[a].id,s.id)||o[s.id]){for(var h=r?t.getSuccessors(n[a].id):t.getNeighbors(n[a].id),d=!1,l=0;l<h.length;l++){var c=h[l];if(t.getDegree(c.id)===t.getDegree(s.id)&&!o[c.id]){n.push(N(c)),o[c.id]=!0,d=!0;break}}for(var f=0;!d&&(o[e[f].id]||(n.push(N(e[f])),o[e[f].id]=!0,d=!0),++f!==i););}else n.push(N(s)),o[s.id]=!0,a++})),n},D=function(t,e,r){var n=t,o=e,i=r;return n||"undefined"==typeof window||(n=window.innerWidth),o||"undefined"==typeof window||(o=window.innerHeight),i||(i=[n/2,o/2]),[n,o,i]};const O=function(t){return w(t,"String")};var P={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},T=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="concentric",this.options=n(n({},P),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericConcentricLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericConcentricLayout(!0,t,e),[2]}))}))},t.prototype.genericConcentricLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,p,v,y,m,w,E,S,k,A,z,R,I,D,P,T,C,q,L,j,F,V,B,G,W,$,U,H,K,Y;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,h=o.sortBy,d=o.maxLevelDiff,l=o.sweep,c=o.clockwise,f=o.equidistant,p=o.preventOverlap,v=o.startAngle,y=void 0===v?1.5*Math.PI:v,m=o.nodeSize,w=o.nodeSpacing,E=e.getAllNodes(),S=e.getAllEdges(),k=s||"undefined"==typeof window?s:window.innerWidth,A=u||"undefined"==typeof window?u:window.innerHeight,z=i||[k/2,A/2],!(null==E?void 0:E.length)||1===E.length)return[2,_(e,t,z)];if(R=[],D=0,I=g(m)?Math.max(m[0],m[1]):m,g(w)?D=Math.max(w[0],w[1]):x(w)&&(D=w),E.forEach((function(t){var e=N(t);R.push(e);var r=I,n=e.data;g(n.size)?r=Math.max(n.size[0],n.size[1]):x(n.size)?r=n.size:M(n.size)&&(r=Math.max(n.size.width,n.size.height)),I=Math.max(I,r),b(w)&&(D=Math.max(w(t),D))})),P={},R.forEach((function(t,e){P[t.id]=e})),O(T=h)&&void 0!==R[0].data[T]||(T="degree"),"degree"===T?R.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):R.sort((function(t,e){return e.data[T]-t.data[T]})),C=R[0],q=(d||("degree"===T?e.getDegree(C.id,"both"):C.data[T]))/4,j=(L=[{nodes:[]}])[0],R.forEach((function(t){if(j.nodes.length>0){var r="degree"===T?Math.abs(e.getDegree(j.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(j.nodes[0].data[T]-t.data[T]);q&&r>=q&&(j={nodes:[]},L.push(j))}j.nodes.push(t)})),F=I+D,p||(V=L.length>0&&L[0].nodes.length>1,B=Math.min(k,A)/2-F,G=B/(L.length+(V?1:0)),F=Math.min(F,G)),W=0,L.forEach((function(t){var e=void 0===l?2*Math.PI-2*Math.PI/t.nodes.length:l;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&p){var r=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),o=Math.sqrt(F*F/(r*r+n*n));W=Math.max(o,W)}t.r=W,W+=F})),f){for($=0,U=0,H=0;H<L.length;H++)K=L[H],Y=(K.r||0)-U,$=Math.max($,Y);U=0,L.forEach((function(t,e){0===e&&(U=t.r||0),t.r=U,U+=$}))}return L.forEach((function(t){var e=t.dTheta||0,r=t.r||0;t.nodes.forEach((function(t,n){var o=y+(c?1:-1)*e*n;t.data.x=z[0]+r*Math.cos(o),t.data.y=z[1]+r*Math.sin(o)}))})),t&&R.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:R,edges:S}]}))}))},t}();function C(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i,a,s,u,h,d,l,c,f=t._root,g={data:n},p=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!f)return t._root=g,t;for(;f.length;)if((h=e>=(i=(p+y)/2))?p=i:y=i,(d=r>=(a=(v+m)/2))?v=a:m=a,o=f,!(f=f[l=d<<1|h]))return o[l]=g,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&r===u)return g.next=f,o?o[l]=g:t._root=g,t;do{o=o?o[l]=new Array(4):t._root=new Array(4),(h=e>=(i=(p+y)/2))?p=i:y=i,(d=r>=(a=(v+m)/2))?v=a:m=a}while((l=d<<1|h)==(c=(u>=a)<<1|s>=i));return o[c]=f,o[l]=g,t}function q(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function L(t){return t[0]}function j(t){return t[1]}function F(t,e,r){var n=new V(null==e?L:e,null==r?j:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function V(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function B(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var G=F.prototype=V.prototype;function W(t){return function(){return t}}function $(t){return 1e-6*(t()-.5)}G.copy=function(){var t,e,r=new V(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=B(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var o=0;o<4;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(4)}):n.target[o]=B(e));return r},G.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return C(this.cover(e,r),e,r,t)},G.addAll=function(t){var e,r,n,o,i=t.length,a=new Array(i),s=new Array(i),u=1/0,h=1/0,d=-1/0,l=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(a[r]=n,s[r]=o,n<u&&(u=n),n>d&&(d=n),o<h&&(h=o),o>l&&(l=o));if(u>d||h>l)return this;for(this.cover(u,h).cover(d,l),r=0;r<i;++r)C(this,a[r],s[r],t[r]);return this},G.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var a,s,u=o-r||1,h=this._root;r>t||t>=o||n>e||e>=i;)switch(s=(e<n)<<1|t<r,(a=new Array(4))[s]=h,h=a,u*=2,s){case 0:o=r+u,i=n+u;break;case 1:r=o-u,i=n+u;break;case 2:o=r+u,n=i-u;break;case 3:r=o-u,n=i-u}this._root&&this._root.length&&(this._root=h)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this},G.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},G.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},G.find=function(t,e,r){var n,o,i,a,s,u,h,d=this._x0,l=this._y0,c=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new q(p,d,l,c,f)),null==r?r=1/0:(d=t-r,l=e-r,c=t+r,f=e+r,r*=r);u=g.pop();)if(!(!(p=u.node)||(o=u.x0)>c||(i=u.y0)>f||(a=u.x1)<d||(s=u.y1)<l))if(p.length){var v=(o+a)/2,y=(i+s)/2;g.push(new q(p[3],v,y,a,s),new q(p[2],o,y,v,s),new q(p[1],v,i,a,y),new q(p[0],o,i,v,y)),(h=(e>=y)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-h],g[g.length-1-h]=u)}else{var m=t-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),x=m*m+w*w;if(x<r){var E=Math.sqrt(r=x);d=t-E,l=e-E,c=t+E,f=e+E,n=p.data}}return n},G.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,r,n,o,i,a,s,u,h,d,l,c,f=this._root,g=this._x0,p=this._y0,v=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((h=i>=(s=(g+v)/2))?g=s:v=s,(d=a>=(u=(p+y)/2))?p=u:y=u,e=f,!(f=f[l=d<<1|h]))return this;if(!f.length)break;(e[l+1&3]||e[l+2&3]||e[l+3&3])&&(r=e,c=l)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(o=f.next)&&delete f.next,n?(o?n.next=o:delete n.next,this):e?(o?e[l]=o:delete e[l],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[c]=f:this._root=f),this):(this._root=o,this)},G.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},G.root=function(){return this._root},G.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},G.visit=function(t){var e,r,n,o,i,a,s=[],u=this._root;for(u&&s.push(new q(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,n=e.x0,o=e.y0,i=e.x1,a=e.y1)&&u.length){var h=(n+i)/2,d=(o+a)/2;(r=u[3])&&s.push(new q(r,h,d,i,a)),(r=u[2])&&s.push(new q(r,n,d,h,a)),(r=u[1])&&s.push(new q(r,h,o,i,d)),(r=u[0])&&s.push(new q(r,n,o,h,d))}return this},G.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new q(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.x1,h=e.y1,d=(a+u)/2,l=(s+h)/2;(i=o[0])&&r.push(new q(i,a,s,d,l)),(i=o[1])&&r.push(new q(i,d,s,u,l)),(i=o[2])&&r.push(new q(i,a,l,d,h)),(i=o[3])&&r.push(new q(i,d,l,u,h))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},G.x=function(t){return arguments.length?(this._x=t,this):this._x},G.y=function(t){return arguments.length?(this._y=t,this):this._y};var U={value:()=>{}};function H(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new K(n)}function K(t){this._=t}function Y(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function J(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=U,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}K.prototype=H.prototype={constructor:K,on:function(t,e){var r,n,o=this._,i=(n=o,(t+"").trim().split(/^|\\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)o[r]=J(o[r],t.name,e);else if(null==e)for(r in o)o[r]=J(o[r],t.name,null);return this}for(;++a<s;)if((r=(t=i[a]).type)&&(r=Y(o[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new K(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};const X=H;var Q,Z,tt=0,et=0,rt=0,nt=1e3,ot=0,it=0,at=0,st="object"==typeof performance&&performance.now?performance:Date,ut="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ht(){return it||(ut(dt),it=st.now()+at)}function dt(){it=0}function lt(){this._call=this._time=this._next=null}function ct(t,e,r){var n=new lt;return n.restart(t,e,r),n}function ft(){it=(ot=st.now())+at,tt=et=0;try{!function(){ht(),++tt;for(var t,e=Q;e;)(t=it-e._time)>=0&&e._call.call(void 0,t),e=e._next;--tt}()}finally{tt=0,function(){for(var t,e,r=Q,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:Q=e);Z=t,pt(n)}(),it=0}}function gt(){var t=st.now(),e=t-ot;e>nt&&(at-=e,ot=t)}function pt(t){tt||(et&&(et=clearTimeout(et)),t-it>24?(t<1/0&&(et=setTimeout(ft,t-st.now()-at)),rt&&(rt=clearInterval(rt))):(rt||(ot=st.now(),rt=setInterval(gt,nt)),tt=1,ut(ft)))}lt.prototype=ct.prototype={constructor:lt,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?ht():+r)+(null==e?0:+e),this._next||Z===this||(Z?Z._next=this:Q=this,Z=this),this._call=t,this._time=r,pt()},stop:function(){this._call&&(this._call=null,this._time=1/0,pt())}};const vt=1664525,yt=1013904223,mt=4294967296;function wt(t){return t.x}function xt(t){return t.y}var Et=10,Nt=Math.PI*(3-Math.sqrt(5));function bt(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,a=.6,s=new Map,u=ct(l),h=X("tick","end"),d=function(){let t=1;return()=>(t=(vt*t+yt)%mt)/mt}();function l(){c(),h.call("tick",e),r<n&&(u.stop(),h.call("end",e))}function c(n){var u,h,d=t.length;void 0===n&&(n=1);for(var l=0;l<n;++l)for(r+=(i-r)*o,s.forEach((function(t){t(r)})),u=0;u<d;++u)null==(h=t[u]).fx?h.x+=h.vx*=a:(h.x=h.fx,h.vx=0),null==h.fy?h.y+=h.vy*=a:(h.y=h.fy,h.vy=0);return e}function f(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var o=Et*Math.sqrt(.5+r),i=r*Nt;e.x=o*Math.cos(i),e.y=o*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,d),e}return null==t&&(t=[]),f(),e={tick:c,restart:function(){return u.restart(l),e},stop:function(){return u.stop(),e},nodes:function(r){return arguments.length?(t=r,f(),s.forEach(g),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(d=t,s.forEach(g),e):d},force:function(t,r){return arguments.length>1?(null==r?s.delete(t):s.set(t,g(r)),e):s.get(t)},find:function(e,r,n){var o,i,a,s,u,h=0,d=t.length;for(null==n?n=1/0:n*=n,h=0;h<d;++h)(a=(o=e-(s=t[h]).x)*o+(i=r-s.y)*i)<n&&(u=s,n=a);return u},on:function(t,r){return arguments.length>1?(h.on(t,r),e):h.on(t)}}}function Mt(){var t,e,r,n,o,i=W(-30),a=1,s=1/0,u=.81;function h(r){var o,i=t.length,a=F(t,wt,xt).visitAfter(l);for(n=r,o=0;o<i;++o)e=t[o],a.visit(c)}function d(){if(t){var e,r,n=t.length;for(o=new Array(n),e=0;e<n;++e)r=t[e],o[r.index]=+i(r,e,t)}}function l(t){var e,r,n,i,a,s=0,u=0;if(t.length){for(n=i=a=0;a<4;++a)(e=t[a])&&(r=Math.abs(e.value))&&(s+=e.value,u+=r,n+=r*e.x,i+=r*e.y);t.x=n/u,t.y=i/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=o[e.data.index]}while(e=e.next)}t.value=s}function c(t,i,h,d){if(!t.value)return!0;var l=t.x-e.x,c=t.y-e.y,f=d-i,g=l*l+c*c;if(f*f/u<g)return g<s&&(0===l&&(g+=(l=$(r))*l),0===c&&(g+=(c=$(r))*c),g<a&&(g=Math.sqrt(a*g)),e.vx+=l*t.value*n/g,e.vy+=c*t.value*n/g),!0;if(!(t.length||g>=s)){(t.data!==e||t.next)&&(0===l&&(g+=(l=$(r))*l),0===c&&(g+=(c=$(r))*c),g<a&&(g=Math.sqrt(a*g)));do{t.data!==e&&(f=o[t.data.index]*n/g,e.vx+=l*f,e.vy+=c*f)}while(t=t.next)}}return h.initialize=function(e,n){t=e,r=n,d()},h.strength=function(t){return arguments.length?(i="function"==typeof t?t:W(+t),d(),h):i},h.distanceMin=function(t){return arguments.length?(a=t*t,h):Math.sqrt(a)},h.distanceMax=function(t){return arguments.length?(s=t*t,h):Math.sqrt(s)},h.theta=function(t){return arguments.length?(u=t*t,h):Math.sqrt(u)},h}function St(t){return t.index}function kt(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function At(t){var e,r,n,o,i,a,s=St,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},h=W(30),d=1;function l(n){for(var o=0,s=t.length;o<d;++o)for(var u,h,l,c,f,g,p,v=0;v<s;++v)h=(u=t[v]).source,c=(l=u.target).x+l.vx-h.x-h.vx||$(a),f=l.y+l.vy-h.y-h.vy||$(a),c*=g=((g=Math.sqrt(c*c+f*f))-r[v])/g*n*e[v],f*=g,l.vx-=c*(p=i[v]),l.vy-=f*p,h.vx+=c*(p=1-p),h.vy+=f*p}function c(){if(n){var a,u,h=n.length,d=t.length,l=new Map(n.map(((t,e)=>[s(t,e,n),t])));for(a=0,o=new Array(h);a<d;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=kt(l,u.source)),"object"!=typeof u.target&&(u.target=kt(l,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(a=0,i=new Array(d);a<d;++a)u=t[a],i[a]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);e=new Array(d),f(),r=new Array(d),g()}}function f(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+u(t[r],r,t)}function g(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+h(t[e],e,t)}return null==t&&(t=[]),l.initialize=function(t,e){n=t,a=e,c()},l.links=function(e){return arguments.length?(t=e,c(),l):t},l.id=function(t){return arguments.length?(s=t,l):s},l.iterations=function(t){return arguments.length?(d=+t,l):d},l.strength=function(t){return arguments.length?(u="function"==typeof t?t:W(+t),f(),l):u},l.distance=function(t){return arguments.length?(h="function"==typeof t?t:W(+t),g(),l):h},l}function _t(t){return t.x+t.vx}function zt(t){return t.y+t.vy}function Rt(t){var e,r,n,o=1,i=1;function a(){for(var t,a,u,h,d,l,c,f=e.length,g=0;g<i;++g)for(a=F(e,_t,zt).visitAfter(s),t=0;t<f;++t)u=e[t],l=r[u.index],c=l*l,h=u.x+u.vx,d=u.y+u.vy,a.visit(p);function p(t,e,r,i,a){var s=t.data,f=t.r,g=l+f;if(!s)return e>h+g||i<h-g||r>d+g||a<d-g;if(s.index>u.index){var p=h-s.x-s.vx,v=d-s.y-s.vy,y=p*p+v*v;y<g*g&&(0===p&&(y+=(p=$(n))*p),0===v&&(y+=(v=$(n))*v),y=(g-(y=Math.sqrt(y)))/y*o,u.vx+=(p*=y)*(g=(f*=f)/(c+f)),u.vy+=(v*=y)*g,s.vx-=p*(g=1-g),s.vy-=v*g)}}}function s(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var n,o,i=e.length;for(r=new Array(i),n=0;n<i;++n)o=e[n],r[o.index]=+t(o,n,e)}}return"function"!=typeof t&&(t=W(null==t?1:+t)),a.initialize=function(t,r){e=t,n=r,u()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(o=+t,a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:W(+e),u(),a):t},a}function It(t){var e,r,n,o=W(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=W(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:W(+t),a(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:W(+e),a(),i):t},i}function Dt(t){var e,r,n,o=W(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=W(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:W(+t),a(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:W(+e),a(),i):t},i}function Ot(){function t(t){return function(){return t}}var e,r=function(t){return t.cluster},n=t(1),o=t(-1),i=t(100),a=t(.1),u=[0,0],h=[],d={},l=[],c=100,f=100,g={none:{x:0,y:0}},p=[],v="force",y=!0,m=.1;function w(t){if(!y)return w;e.tick(),E();for(var n=0,o=h.length,i=void 0,a=t*m;n<o;++n)(i=h[n]).vx+=(g[r(i)].x-i.x)*a,i.vy+=(g[r(i)].y-i.y)*a}function x(){h&&function(){if(h&&h.length){if(void 0===r(h[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy(\'clusterAttr\') before calling .links()");var t,u,g,v,y,m=(t=[],u=[],g={},{},y=[],v=function(t){var e={};return t.forEach((function(t){var n=r(t);e[n]||(e[n]={count:0,sumforceNodeSize:0})})),t.forEach((function(t){var o=r(t),i=n(t),a=e[o];a.count=a.count+1,a.sumforceNodeSize=a.sumforceNodeSize+Math.PI*(i*i)*1.3,e[o]=a})),e}(h),y=function(t){var e={},n=[];return t.forEach((function(t){var n,o,i,a,s,u=(o=(n=t).source,i=n.target,(a=r(d[o]))<=(s=r(d[i]))?a+"~"+s:s+"~"+a),h=0;void 0!==e[u]&&(h=e[u]),h+=1,e[u]=h})),Object.entries(e).forEach((function(t){var e=s(t,2),r=e[0],o=e[1],i=r.split("~")[0],a=r.split("~")[1];void 0!==i&&void 0!==a&&n.push({source:i,target:a,count:o})})),n}(l),Object.keys(v).forEach((function(e,r){var n=v[e];t.push({id:e,size:n.count,r:Math.sqrt(n.sumforceNodeSize/Math.PI)}),g[e]=r})),y.forEach((function(t){var e=t.source,r=t.target,n=g[e],o=g[r];void 0!==n&&void 0!==o&&u.push({source:n,target:o,count:t.count})})),{nodes:t,links:u});e=bt(m.nodes).force("x",It(c).strength(.1)).force("y",Dt(f).strength(.1)).force("collide",Rt((function(t){return t.r})).iterations(4)).force("charge",Mt().strength(o)).force("links",At(m.nodes.length?m.links:[]).distance(i).strength(a)),p=e.nodes(),E()}}()}function E(){return g={none:{x:0,y:0}},p.forEach((function(t){g[t.id]={x:t.x-u[0],y:t.y-u[1]}})),g}return w.initialize=function(t){h=t,x()},w.template=function(t){return arguments.length?(v=t,x(),w):v},w.groupBy=function(t){return arguments.length?"string"==typeof t?(r=function(e){return e[t]},w):(r=t,w):r},w.enableGrouping=function(t){return arguments.length?(y=t,w):y},w.strength=function(t){return arguments.length?(m=t,w):m},w.centerX=function(t){return arguments.length?(c=t,w):c},w.centerY=function(t){return arguments.length?(f=t,w):f},w.nodes=function(t){return arguments.length?(function(t){d={},t.forEach((function(t){d[t.id]=t}))}(t||[]),h=t||[],w):h},w.links=function(t){return arguments.length?(l=t||[],x(),w):l},w.forceNodeSize=function(e){return arguments.length?(n="function"==typeof e?e:t(+e),x(),w):n},w.nodeSize=w.forceNodeSize,w.forceCharge=function(e){return arguments.length?(o="function"==typeof e?e:t(+e),x(),w):o},w.forceLinkDistance=function(e){return arguments.length?(i="function"==typeof e?e:t(+e),x(),w):i},w.forceLinkStrength=function(e){return arguments.length?(a="function"==typeof e?e:t(+e),x(),w):a},w.offset=function(t){return arguments.length?(u=t,w):u},w.getFocis=E,w}var Pt={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},Tt=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="d3force",this.options=n(n({},Pt),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){var t;null===(t=this.forceSimulation)||void 0===t||t.stop()},t.prototype.tick=function(t){var e=this;void 0===t&&(t=1),this.forceSimulation.tick(t);var r={nodes:Ct(this.lastLayoutNodes),edges:qt(this.lastLayoutEdges)};return this.lastAssign&&r.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,g,p,v,y,m,w,x,E,b,M,S,k,A,_,z,R,I,D=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=i.map((function(t){var e,r;return n(n({},N(t)),{x:null===(e=t.data)||void 0===e?void 0:e.x,y:null===(r=t.data)||void 0===r?void 0:r.y})})),h=s.map((function(t){return N(t)})),this.lastLayoutNodes=u,this.lastLayoutEdges=h,this.lastAssign=t,this.lastGraph=e,d=o.alphaMin,l=o.alphaDecay,c=o.alpha,f=o.nodeStrength,g=o.edgeStrength,p=o.linkDistance,v=o.clustering,y=o.clusterFociStrength,m=o.clusterEdgeDistance,w=o.clusterEdgeStrength,x=o.clusterNodeStrength,E=o.clusterNodeSize,b=o.collideStrength,M=void 0===b?1:b,S=o.center,k=void 0===S?[0,0]:S,A=o.preventOverlap,_=o.nodeSize,z=o.nodeSpacing,R=o.onTick,I=o.forceSimulation,[2,new Promise((function(r){if(I){v&&((i=Ot()).nodes(u),i.links(h)),I.nodes(u),h&&(s=At().id((function(t){return t.id})).links(h),g&&s.strength(g),p&&s.distance(p),I.force("link",s)),A&&D.overlapProcess(I,{nodeSize:_,nodeSpacing:z,collideStrength:M}),I.alpha(c).restart();var n=Ct(u),o=qt(h);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:o})}else try{var i,a=Mt();if(f&&a.strength(f),I=bt().nodes(u),v&&((i=Ot()).centerX(k[0]).centerY(k[1]).template("force").strength(y),h&&i.links(h),u&&i.nodes(u),i.forceLinkDistance(m).forceLinkStrength(w).forceCharge(x).forceNodeSize(E),I.force("group",i)),I.force("center",function(t,e){var r,n=1;function o(){var o,i,a=r.length,s=0,u=0;for(o=0;o<a;++o)s+=(i=r[o]).x,u+=i.y;for(s=(s/a-t)*n,u=(u/a-e)*n,o=0;o<a;++o)(i=r[o]).x-=s,i.y-=u}return null==t&&(t=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(n=+t,o):n},o}(k[0],k[1])).force("charge",a).alpha(c).alphaDecay(l).alphaMin(d),A&&D.overlapProcess(I,{nodeSize:_,nodeSpacing:z,collideStrength:M}),h){var s=At().id((function(t){return t.id})).links(h);g&&s.strength(g),p&&s.distance(p),I.force("link",s)}I.on("tick",(function(){var r=Ct(u);null==R||R({nodes:r,edges:qt(h)}),t&&r.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}))})).on("end",(function(){var n=Ct(u);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:qt(h)})}))}catch(t){console.warn(t)}D.forceSimulation=I}))]}))}))},t.prototype.overlapProcess=function(t,e){var r,n,o=e.nodeSize,i=e.nodeSpacing,a=e.collideStrength;if(n=x(i)?function(){return i}:b(i)?i:function(){return 0},o)if(b(o))r=function(t){return o(t)+n(t)};else if(g(o)){var s=(o[0]>o[1]?o[0]:o[1])/2;r=function(t){return s+n(t)}}else if(x(o)){var u=o/2;r=function(t){return u+n(t)}}else r=function(){return 10};else r=function(t){return t.size?g(t.size)?(t.size[0]>t.size[1]?t.size[0]:t.size[1])/2+n(t):M(t.size)?(t.size.width>t.size.height?t.size.width:t.size.height)/2+n(t):t.size/2+n(t):10+n(t)};t.force("collisionForce",Rt(r).strength(a))},t}(),Ct=function(t){return t.map((function(t){var e=t.x,r=t.y,i=o(t,["x","y"]);return n(n({},i),{data:n(n({},i.data),{x:e,y:r})})}))},qt=function(t){return t.map((function(t){var e=t.source,r=t.target,i=o(t,["source","target"]);return n(n({},i),{source:e.id,target:r.id})}))};var Lt=function(t,e){if("next"!==t&&"prev"!==t)return e},jt=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(function(){function t(){var t={};t.prev=t,t.next=t.prev,this.shortcut=t}return t.prototype.dequeue=function(){var t=this.shortcut,e=t.prev;if(e&&e!==t)return jt(e),e},t.prototype.enqueue=function(t){var e=this.shortcut;t.prev&&t.next&&jt(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e},t.prototype.toString=function(){for(var t=[],e=this.shortcut,r=e.prev;r!==e;)t.push(JSON.stringify(r,Lt)),r=null==r?void 0:r.prev;return"["+t.join(", ")+"]"},t}()),Vt=function(){return 1},Bt=function(t,e,r,o,i){var a,s,u=[];return t.hasNode(o.v)&&(null===(a=t.getRelatedEdges(o.v,"in"))||void 0===a||a.forEach((function(o){var a=o.data.weight,s=t.getNode(o.source);i&&u.push({v:o.source,w:o.target,in:0,out:0}),void 0===s.data.out&&(s.data.out=0),s.data.out-=a,Gt(e,r,n({v:s.id},s.data))})),null===(s=t.getRelatedEdges(o.v,"out"))||void 0===s||s.forEach((function(o){var i=o.data.weight,a=o.target,s=t.getNode(a);void 0===s.data.in&&(s.data.in=0),s.data.in-=i,Gt(e,r,n({v:s.id},s.data))})),t.removeNode(o.v)),i?u:void 0},Gt=function(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},Wt=function(t,e){var r="greedy"===e?function(t,e){var r;if(t.getAllNodes().length<=1)return[];var o=function(t,e){var r=new c,o=0,i=0;t.getAllNodes().forEach((function(t){r.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((function(t){var a=r.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target})),s=(null==e?void 0:e(t))||1;a?r.updateEdgeData(null==a?void 0:a.id,n(n({},a.data),{weight:a.data.weight+s})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:s}}),i=Math.max(i,r.getNode(t.source).data.out+=s),o=Math.max(o,r.getNode(t.target).data.in+=s)}));for(var a=[],s=i+o+3,u=0;u<s;u++)a.push(new Ft);var h=o+1;return r.getAllNodes().forEach((function(t){Gt(a,h,n({v:t.id},r.getNode(t.id).data))})),{buckets:a,zeroIdx:h,graph:r}}(t,function(t){return t.data.weight||1}||Vt);return null===(r=function(t,e,r){for(var n,o=[],i=e[e.length-1],a=e[0];t.getAllNodes().length;){for(;n=a.dequeue();)Bt(t,e,r,n);for(;n=i.dequeue();)Bt(t,e,r,n);if(t.getAllNodes().length)for(var s=e.length-2;s>0;--s)if(n=e[s].dequeue()){o=o.concat(Bt(t,e,r,n,!0));break}}return o}(o.graph,o.buckets,o.zeroIdx).map((function(e){return t.getRelatedEdges(e.v,"out").filter((function(t){return t.target===e.w}))})))||void 0===r?void 0:r.flat()}(t):$t(t);null==r||r.forEach((function(e){var r=e.data;t.removeEdge(e.id),r.forwardName=e.data.name,r.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:n({},r)})}))},$t=function(t){var e=[],r={},n={},o=function(i){n[i]||(n[i]=!0,r[i]=!0,t.getRelatedEdges(i,"out").forEach((function(t){r[t.target]?e.push(t):o(t.target)})),delete r[i])};return t.getAllNodes().forEach((function(t){return o(t.id)})),e},Ut=function(t,e,r,n){var o;do{o=""+n+Math.random()}while(t.hasNode(o));return r.dummy=e,t.addNode({id:o,data:r}),o},Ht=function(t){var e=new c;return t.getAllNodes().forEach((function(r){t.getChildren(r.id).length||e.addNode(n({},r))})),t.getAllEdges().forEach((function(t){e.addEdge(t)})),e},Kt=function(t,e){var r,n,o=Number(t.x),i=Number(t.y),a=Number(e.x)-o,s=Number(e.y)-i,u=Number(t.width)/2,h=Number(t.height)/2;return a||s?(Math.abs(s)*u>Math.abs(a)*h?(s<0&&(h=-h),r=h*a/s,n=h):(a<0&&(u=-u),r=u,n=u*s/a),{x:o+r,y:i+n}):{x:0,y:0}},Yt=function(t){for(var e=[],r=Xt(t)+1,n=0;n<r;n++)e.push([]);for(t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)})),n=0;n<r;n++)e[n]=e[n].sort((function(e,r){return n=t.getNode(e).data.order,o=t.getNode(r).data.order,Number(n)-Number(o);var n,o}));return e},Jt=function(t,e,r,n){var o={width:0,height:0};return x(r)&&x(n)&&(o.rank=r,o.order=n),Ut(t,"border",o,e)},Xt=function(t){var e;return t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)})),e||(e=0),e},Qt=function(t,e){return t.reduce((function(t,r){return e(t)>e(r)?r:t}))},Zt=function(t,e,r,n,o,i){n.includes(e.id)||(n.push(e.id),r||i.push(e.id),o(e.id).forEach((function(e){return Zt(t,e,r,n,o,i)})),r&&i.push(e.id))},te=function(t,e,r,n){var o=Array.isArray(e)?e:[e],i=function(e){return n?t.getSuccessors(e):t.getNeighbors(e)},a=[],s=[];return o.forEach((function(e){if(!t.hasNode(e.id))throw new Error("Graph does not have node: "+e);Zt(t,e,"post"===r,s,i,a)})),a},ee="edge-label",re=function(t){var e={},r=function(n){var o,i,a=t.getNode(n);return a?e[n]?a.data.rank:(e[n]=!0,null===(o=t.getRelatedEdges(n,"out"))||void 0===o||o.forEach((function(t){var e=r(t.target)-t.data.minlen;e&&(void 0===i||e<i)&&(i=e)})),i||(i=0),a.data.rank=i,i):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){return r(t.id)}))},ne=function(t,e){return t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen},oe=function(t,e){var r=function(n){e.getRelatedEdges(n,"both").forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ie=function(t,e){var r=function(n){var o;null===(o=e.getRelatedEdges(n,"both"))||void 0===o||o.forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||void 0===e.getNode(a).data.layer&&ne(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},ae=function(t,e){return Qt(e.getAllEdges(),(function(r){return t.hasNode(r.source)!==t.hasNode(r.target)?ne(e,r):1/0}))},se=function(t,e,r){t.getAllNodes().forEach((function(t){var n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r}))},ue=function(t,e){var r=te(t,t.getAllNodes(),"post",!1);(r=r.slice(0,(null==r?void 0:r.length)-1)).forEach((function(r){he(t,e,r)}))},he=function(t,e,r){var n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find((function(t){return t.target===n||t.source===n})).data.cutvalue=de(t,e,r)},de=function(t,e,r){var n=t.getNode(r).data.parent,o=!0,i=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),a=0;return i||(o=!1,i=e.getRelatedEdges(n,"out").find((function(t){return t.target===r}))),a=i.data.weight,e.getRelatedEdges(r,"both").forEach((function(e){var i=e.source===r,s=i?e.target:e.source;if(s!==n){var u=i===o,h=e.data.weight;if(a+=u?h:-h,ye(t,r,s)){var d=t.getRelatedEdges(r,"both").find((function(t){return t.source===s||t.target===s})).data.cutvalue;a+=u?-d:d}}})),a},le=function(t,e){void 0===e&&(e=t.getAllNodes()[0].id),ce(t,{},1,e)},ce=function(t,e,r,n,o){var i,a=r,s=r,u=t.getNode(n);return e[n]=!0,null===(i=t.getNeighbors(n))||void 0===i||i.forEach((function(r){e[r.id]||(s=ce(t,e,s,r.id,n))})),u.data.low=a,u.data.lim=s++,o?u.data.parent=o:delete u.data.parent,s},fe=function(t){return t.getAllEdges().find((function(t){return t.data.cutvalue<0}))},ge=function(t,e,r){var n=r.source,o=r.target;e.getRelatedEdges(n,"out").find((function(t){return t.target===o}))||(n=r.target,o=r.source);var i=t.getNode(n),a=t.getNode(o),s=i,u=!1;i.data.lim>a.data.lim&&(s=a,u=!0);var h=e.getAllEdges().filter((function(e){return u===me(t.getNode(e.source),s)&&u!==me(t.getNode(e.target),s)}));return Qt(h,(function(t){return ne(e,t)}))},pe=function(t,e,r,n){var o=t.getRelatedEdges(r.source,"both").find((function(t){return t.source===r.target||t.target===r.target}));o&&t.removeEdge(o.id),t.addEdge({id:"e"+Math.random(),source:n.source,target:n.target,data:{}}),le(t),ue(t,e),ve(t,e)},ve=function(t,e){var r=t.getAllNodes().find((function(t){return!t.data.parent})),n=te(t,r,"pre",!1);(n=n.slice(1)).forEach((function(r){var n=t.getNode(r).data.parent,o=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),i=!1;!o&&e.hasNode(n)&&(o=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),i=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(i?null==o?void 0:o.data.minlen:-(null==o?void 0:o.data.minlen))}))},ye=function(t,e,r){return t.getRelatedEdges(e,"both").find((function(t){return t.source===r||t.target===r}))},me=function(t,e){return e.data.low<=t.data.lim&&t.data.lim<=e.data.lim},we=re,xe=function(t){!function(t){var e=function(t){var e=new c;return t.getAllNodes().forEach((function(t){e.addNode(n({},t))})),t.getAllEdges().forEach((function(t){var r=e.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target}));r?e.updateEdgeData(null==r?void 0:r.id,n(n({},r.data),{weight:r.data.weight+t.data.weight||0,minlen:Math.max(r.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e}(t);re(e);var r,o,i=function(t){var e,r,n=new c({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);oe(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r);return n}(e);for(le(i),ue(i,e);r=fe(i);)o=ge(i,e,r),pe(i,e,r,o)}(t)},Ee=function(t,e,r,n,o,i,a){var s=t.getChildren(a);if(null==s?void 0:s.length){var u=Jt(t,"_bt"),h=Jt(t,"_bb"),d=t.getNode(a);t.setParent(u,a),d.data.borderTop=u,t.setParent(h,a),d.data.borderBottom=h,null==s||s.forEach((function(s){Ee(t,e,r,n,o,i,s.id);var d=s.data.borderTop?s.data.borderTop:s.id,l=s.data.borderBottom?s.data.borderBottom:s.id,c=s.data.borderTop?n:2*n,f=d!==l?1:o-i[a]+1;t.addEdge({id:"e"+Math.random(),source:u,target:d,data:{minlen:f,weight:c,nestingEdge:!0}}),t.addEdge({id:"e"+Math.random(),source:l,target:h,data:{minlen:f,weight:c,nestingEdge:!0}})})),t.getParent(a)||t.addEdge({id:"e"+Math.random(),source:e,target:u,data:{weight:0,minlen:o+i[a]}})}else a!==e&&t.addEdge({id:"e"+Math.random(),source:e,target:a,data:{weight:0,minlen:r}})},Ne=function(t,e,r,n,o,i){var a={rank:i,borderType:e,width:0,height:0},s=o.data[e][i-1],u=Ut(t,"border",a,r);o.data[e][i]=u,t.setParent(u,n),s&&t.addEdge({id:"e"+Math.random(),source:s,target:u,data:{weight:1}})},be=function(t){t.getAllNodes().forEach((function(t){Me(t)})),t.getAllEdges().forEach((function(t){Me(t)}))},Me=function(t){var e=t.data.width;t.data.width=t.data.height,t.data.height=e},Se=function(t){(null==t?void 0:t.y)&&(t.y=-t.y)},ke=function(t){var e=t.x;t.x=t.y,t.y=e},Ae=function(t){for(var e={},r=t.getAllNodes(),n=r.map((function(t){var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),o=Math.max.apply(Math,u([],s(n))),i=[],a=0;a<o+1;a++)i.push([]);var h=r.sort((function(e,r){return t.getNode(e.id).data.rank-t.getNode(r.id).data.rank})),d=h.filter((function(e){return void 0!==t.getNode(e.id).data.fixorder})).sort((function(e,r){return t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder}));return null==d||d.forEach((function(r){isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0})),null==h||h.forEach((function(r){return t.dfsTree(r.id,(function(t){if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)}))})),i},_e=function(t,e,r){for(var n=function(t,e){return null==t?void 0:t.reduce((function(t,r,n){return t[r]=e[n],t}),{})}(r,r.map((function(t,e){return e}))),o=e.map((function(e){var r=t.getRelatedEdges(e,"out").map((function(t){return{pos:n[t.target]||0,weight:t.data.weight}}));return null==r?void 0:r.sort((function(t,e){return t.pos-e.pos}))})),i=o.flat().filter((function(t){return void 0!==t})),a=1;a<r.length;)a<<=1;var s=2*a-1;a-=1;var u=Array(s).fill(0,0,s),h=0;return null==i||i.forEach((function(t){if(t){var e=t.pos+a;u[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=u[e+1]),u[e=e-1>>1]+=t.weight;h+=t.weight*r}})),h},ze=function(t,e){for(var r=0,n=1;n<(null==e?void 0:e.length);n+=1)r+=_e(t,e[n-1],e[n]);return r},Re=function(t,e){var r,n=0,o=0;t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/o,t.weight=o,t.i=Math.min(e.i,t.i),e.merged=!0};const Ie=function(t,e){var r,n,o,i={};return null==t||t.forEach((function(t,e){i[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};var r=i[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)})),null===(r=e.getAllEdges())||void 0===r||r.forEach((function(t){var e=i[t.source],r=i[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(i[t.target]))})),function(t){for(var e,r,n=[],o=function(){var o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach((function(t){return(e=o,function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&Re(e,t)})(t);var e})),null===(r=o.out)||void 0===r||r.forEach((function(e){return(r=o,function(e){e.in.push(r),0==--e.indegree&&t.push(e)})(e);var r}))};null==t?void 0:t.length;)o();var i=n.filter((function(t){return!t.merged})),a=["vs","i","barycenter","weight"];return i.map((function(t){var e={};return null==a||a.forEach((function(r){void 0!==t[r]&&(e[r]=t[r])})),e}))}(null===(o=(n=Object.values(i)).filter)||void 0===o?void 0:o.call(n,(function(t){return!t.indegree})))};var De=function(t,e,r){for(var n,o=r;e.length&&(n=e[e.length-1]).i<=o;)e.pop(),null==t||t.push(n.vs),o++;return o},Oe=function(t,e,r,n,o,i){var a,s,u,h,d=t.getChildren(e).map((function(t){return t.id})),l=t.getNode(e),c=l?l.data.borderLeft:void 0,f=l?l.data.borderRight:void 0,g={};c&&(d=null==d?void 0:d.filter((function(t){return t!==c&&t!==f})));var p=function(t,e){return e.map((function(e){var r=t.getRelatedEdges(e,"in");if(!(null==r?void 0:r.length))return{v:e};var n={sum:0,weight:0};return null==r||r.forEach((function(e){var r=t.getNode(e.source);n.sum+=e.data.weight*r.data.order,n.weight+=e.data.weight})),{v:e,barycenter:n.sum/n.weight,weight:n.weight}}))}(t,d||[]);null==p||p.forEach((function(e){var o;if(null===(o=t.getChildren(e.v))||void 0===o?void 0:o.length){var a=Oe(t,e.v,r,n,i);g[e.v]=a,a.hasOwnProperty("barycenter")&&Te(e,a)}}));var v=Ie(p,r);Pe(v,g),null===(a=v.filter((function(t){return t.vs.length>0})))||void 0===a||a.forEach((function(e){var r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)}));var y=function(t,e,r,n){var o=function(t,e){var r={lhs:[],rhs:[]};return null==t||t.forEach((function(t){var e,o;o=(e=t).hasOwnProperty("fixorder")&&!isNaN(e.fixorder),(n?!o&&e.hasOwnProperty("barycenter"):o||e.hasOwnProperty("barycenter"))?r.lhs.push(t):r.rhs.push(t)})),r}(t),i=o.lhs,a=o.rhs.sort((function(t,e){return-t.i- -e.i})),s=[],u=0,h=0,d=0;null==i||i.sort(function(t,e){return function(r,n){if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i}}(!!e,!!r)),d=De(s,a,d),null==i||i.forEach((function(t){var e;d+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),u+=t.barycenter*t.weight,h+=t.weight,d=De(s,a,d)}));var l={vs:s.flat()};return h&&(l.barycenter=u/h,l.weight=h),l}(v,n,o,i);if(c&&(y.vs=[c,y.vs,f].flat(),null===(s=t.getPredecessors(c))||void 0===s?void 0:s.length)){var m=t.getNode((null===(u=t.getPredecessors(c))||void 0===u?void 0:u[0].id)||""),w=t.getNode((null===(h=t.getPredecessors(f))||void 0===h?void 0:h[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+w.data.order)/(y.weight+2),y.weight+=2}return y},Pe=function(t,e){null==t||t.forEach((function(t){var r,n=null===(r=t.vs)||void 0===r?void 0:r.map((function(t){return e[t]?e[t].vs:t}));t.vs=n.flat()}))},Te=function(t,e){void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},Ce=function(t){if("object"!=typeof t||null===t)return t;var e,r;if(r=t,Array.isArray?Array.isArray(r):w(r,"Array")){e=[];for(var n=0,o=t.length;n<o;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=Ce(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=Ce(t[i]):e[i]=t[i];return e};const qe=Ce;var Le=function(t,e,r){return e.map((function(e){return function(t,e,r){var o=function(t){for(var e;t.hasNode(e="_root"+Math.random()););return e}(t),i=new c({tree:[{id:o,children:[],data:{}}]});return t.getAllNodes().forEach((function(a){var s=t.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(n({},a)),(null==s?void 0:s.id)&&!i.hasNode(null==s?void 0:s.id)&&i.addNode(n({},s)),i.setParent(a.id,(null==s?void 0:s.id)||o),t.getRelatedEdges(a.id,r).forEach((function(e){var r=e.source===a.id?e.target:e.source;i.hasNode(r)||i.addNode(n({},t.getNode(r)));var o=i.getRelatedEdges(r,"out").find((function(t){return t.target===a.id})),s=void 0!==o?o.data.weight:0;o?i.updateEdgeData(o.id,n(n({},o.data),{weight:e.data.weight+s})):i.addEdge({id:e.id,source:r,target:a.id,data:{weight:e.data.weight+s}})})),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,n(n({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))})),i}(t,e,r)}))},je=function(t,e,r,n){var o=new c;null==t||t.forEach((function(t){for(var i,a=t.getRoots()[0].id,s=Oe(t,a,o,e,r,n),u=0;u<(null===(i=s.vs)||void 0===i?void 0:i.length);u++){var h=t.getNode(s.vs[u]);h&&(h.data.order=u)}!function(t,e,r){var n,o={};null==r||r.forEach((function(r){for(var i,a,s=t.getParent(r);s;){if((i=t.getParent(s.id))?(a=o[i.id],o[i.id]=s.id):(a=n,n=s.id),a&&a!==s.id)return e.addNodes([{id:a,data:{}},{id:s.id,data:{}}]),void e.addEdge({id:"e"+a+"-"+s.id,source:a,target:s.id,data:{}});s=i}}))}(t,o,s.vs)}))},Fe=function(t,e){null==e||e.forEach((function(e){null==e||e.forEach((function(e,r){t.getNode(e).data.order=r}))}))},Ve=function(t,e){var r={};function n(e,n,o,i,a){for(var s,u,h,d=n;d<o;d++)h=e[d],(null===(s=t.getNode(h))||void 0===s?void 0:s.data.dummy)&&(null===(u=t.getPredecessors(h))||void 0===u||u.forEach((function(e){var n=t.getNode(e.id);n.data.dummy&&(n.data.order<i||n.data.order>a)&&Ge(r,e.id,h)})))}function o(t,e){var r=function(t){return JSON.stringify(t.slice(1))}(t);e.get(r)||(n.apply(void 0,u([],s(t))),e.set(r,!0))}return(null==e?void 0:e.length)&&e.reduce((function(e,r){var n,i=-1,a=0,s=new Map;return null==r||r.forEach((function(u,h){var d;if("border"===(null===(d=t.getNode(u))||void 0===d?void 0:d.data.dummy)){var l=t.getPredecessors(u)||[];l.length&&(n=t.getNode(l[0].id).data.order,o([r,a,h,i,n],s),a=h,i=n)}o([r,a,r.length,n,e.length],s)})),r})),r},Be=function(t,e){var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find((function(e){return t.getNode(e.id).data.dummy}))},Ge=function(t,e,r){var n=e,o=r;if(n>o){var i=n;n=o,o=i}var a=t[n];a||(t[n]=a={}),a[o]=!0},We=function(t,e,r){var n=e;return n>r&&(n=r),!!t[n]},$e=function(t,e,r,o,i,a){var s=new c,u=Ue(o,i,a);return null==e||e.forEach((function(e){var o;null==e||e.forEach((function(e){var i=r[e];if(s.hasNode(i)||s.addNode({id:i,data:{}}),o){var a=r[o],h=s.getRelatedEdges(a,"out").find((function(t){return t.target===i}));h?s.updateEdgeData(h.id,n(n({},h.data),{weight:Math.max(u(t,e,o),h.data.weight||0)})):s.addEdge({id:"e"+Math.random(),source:a,target:i,data:{weight:Math.max(u(t,e,o),0)}})}o=e}))})),s};var Ue=function(t,e,r){return function(n,o,i){var a=n.getNode(o),s=n.getNode(i),u=0,h=0;if(u+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":h=-a.data.width/2;break;case"r":h=a.data.width/2}if(h&&(u+=r?h:-h),h=0,u+=(a.data.dummy?e:t)/2,u+=(s.data.dummy?e:t)/2,u+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":h=s.data.width/2;break;case"r":h=-s.data.width/2}return h&&(u+=r?h:-h),h=0,u}},He=function(t,e){return t.getNode(e).data.width||0},Ke=function(t,e){var r,n=Ht(t);!function(t,e){var r=(e||{}).ranksep,n=void 0===r?0:r,o=Yt(t),i=0;null==o||o.forEach((function(e){var r=e.map((function(e){return t.getNode(e).data.height})),o=Math.max.apply(Math,u(u([],s(r)),[0]));null==e||e.forEach((function(e){t.getNode(e).data.y=i+o/2})),i+=o+n}))}(n,e);var o=function(t,e){var r=e||{},n=r.align,o=r.nodesep,i=void 0===o?0:o,a=r.edgesep,h=void 0===a?0:a,d=Yt(t),l=Object.assign(function(t,e){var r={};return(null==e?void 0:e.length)&&e.reduce((function(e,n){var o=0,i=0,a=e.length,s=null==n?void 0:n[(null==n?void 0:n.length)-1];return null==n||n.forEach((function(e,u){var h,d=Be(t,e),l=d?t.getNode(d.id).data.order:a;(d||e===s)&&(null===(h=n.slice(i,u+1))||void 0===h||h.forEach((function(e){var n;null===(n=t.getPredecessors(e))||void 0===n||n.forEach((function(n){var i,a=t.getNode(n.id),s=a.data.order;!(s<o||l<s)||a.data.dummy&&(null===(i=t.getNode(e))||void 0===i?void 0:i.data.dummy)||Ge(r,n.id,e)}))})),i=u+1,o=l)})),n})),r}(t,d),Ve(t,d)),c={},f=[];["u","d"].forEach((function(e){f="u"===e?d:Object.values(d).reverse(),["l","r"].forEach((function(r){"r"===r&&(f=f.map((function(t){return Object.values(t).reverse()})));var n=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),o=function(t,e,r,n){var o={},i={},a={};return null==e||e.forEach((function(t){null==t||t.forEach((function(t,e){o[t]=t,i[t]=t,a[t]=e}))})),null==e||e.forEach((function(t){var e=-1;null==t||t.forEach((function(t){var s=n(t).map((function(t){return t.id}));if(s.length){s=s.sort((function(t,e){return a[t]-a[e]}));for(var u=(s.length-1)/2,h=Math.floor(u),d=Math.ceil(u);h<=d;++h){var l=s[h];i[t]===t&&e<a[l]&&!We(r,t,l)&&(i[l]=t,i[t]=o[t]=o[l],e=a[l])}}}))})),{root:o,align:i}}(0,f,l,n),a=function(t,e,r,n,o,i,a){var s,u={},h=$e(t,e,r,o,i,a),d=a?"borderLeft":"borderRight",l=function(t,e){for(var r=h.getAllNodes(),n=r.pop(),o={};n;)o[n.id]?t(n.id):(o[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return l((function(t){u[t]=(h.getRelatedEdges(t,"in")||[]).reduce((function(t,e){return Math.max(t,(u[e.source]||0)+e.data.weight)}),0)}),h.getPredecessors.bind(h)),l((function(e){var r=(h.getRelatedEdges(e,"out")||[]).reduce((function(t,e){return Math.min(t,(u[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==d&&(u[e]=Math.max(u[e],r))}),h.getSuccessors.bind(h)),null===(s=Object.values(n))||void 0===s||s.forEach((function(t){u[t]=u[r[t]]})),u}(t,f,o.root,o.align,i,h,"r"===r);"r"===r&&Object.keys(a).forEach((function(t){return a[t]=-a[t]})),c[e+r]=a}))}));var g=function(t,e){return Qt(Object.values(e),(function(e){var r,n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach((function(r){var i=e[r],a=He(t,r)/2;n=Math.max(i+a,n),o=Math.min(i-a,o)})),n-o}))}(t,c);return g&&function(t,e){var r=Object.values(e),n=Math.min.apply(Math,u([],s(r))),o=Math.max.apply(Math,u([],s(r)));["u","d"].forEach((function(r){["l","r"].forEach((function(i){var a,h=r+i,d=t[h];if(d!==e){var l=Object.values(d);(a="l"===i?n-Math.min.apply(Math,u([],s(l))):o-Math.max.apply(Math,u([],s(l))))&&(t[h]={},Object.keys(d).forEach((function(e){t[h][e]=d[e]+a})))}}))}))}(c,g),function(t,e){var r={};return Object.keys(t.ul).forEach((function(n){if(e)r[n]=t[e.toLowerCase()][n];else{var o=Object.values(t).map((function(t){return t[n]}));r[n]=(o[0]+o[1])/2}})),r}(c,n)}(n,e);null===(r=Object.keys(o))||void 0===r||r.forEach((function(t){n.getNode(t).data.x=o[t]}))},Ye=function(t,e){var r=e.acyclicer,o=e.ranker,i=e.rankdir,a=void 0===i?"tb":i,h=e.nodeOrder,d=e.keepNodeOrder,l=e.align,f=e.nodesep,g=void 0===f?50:f,p=e.edgesep,v=void 0===p?20:p,y=e.ranksep,m=void 0===y?50:y;hr(t),Wt(t,r);var w=function(t){var e=Ut(t,"root",{},"_root"),r=function(t){var e={},r=function(n,o){var i=t.getChildren(n);null==i||i.forEach((function(t){return r(t.id,o+1)})),e[n]=o};return t.getRoots().forEach((function(t){return r(t.id,1)})),e}(t),n=Math.max.apply(Math,u([],s(Object.values(r))));Math.abs(n)===1/0&&(n=1);var o=n-1,i=2*o+1;t.getAllEdges().forEach((function(t){t.data.minlen*=i}));var a=function(t){var e=0;return t.getAllEdges().forEach((function(t){e+=t.data.weight})),e}(t)+1;return t.getRoots().forEach((function(n){Ee(t,e,i,a,o,r,n.id)})),{nestingRoot:e,nodeRankFactor:i}}(t),x=w.nestingRoot,E=w.nodeRankFactor;!function(t,e){switch(e){case"network-simplex":xe(t);break;case"tight-tree":default:!function(t){!function(t){var e,r={},n=function(o){var i,a,s=t.getNode(o);return s?r[o]?s.data.rank:(r[o]=!0,null===(i=t.getRelatedEdges(o,"out"))||void 0===i||i.forEach((function(t){var e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),(void 0===e||a<e)&&(e=a),s.data.rank=a,a):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){t&&n(t.id)})),void 0===e&&(e=0);var o={},i=function(e,r){var n,a=t.getNode(e),s=isNaN(a.data.layer)?r:a.data.layer;(void 0===a.data.rank||a.data.rank<s)&&(a.data.rank=s),o[e]||(o[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach((function(t){i(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((function(t){var r=t.data;r&&(isNaN(r.layer)?r.rank-=e:i(t.id,r.layer))}))}(t),function(t){var e,r,n=new c({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);ie(n,t)<i;)e=ae(n,t),r=n.hasNode(e.source)?ne(t,e):-ne(t,e),se(n,t,r)}(t)}(t);break;case"longest-path":we(t)}}(Ht(t),o),er(t),function(t,e){void 0===e&&(e=0);var r=t.getAllNodes(),n=r.filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),o=Math.min.apply(Math,u([],s(n))),i=[];r.forEach((function(t){var e=(t.data.rank||0)-o;i[e]||(i[e]=[]),i[e].push(t.id)}));for(var a=0,h=0;h<i.length;h++){var d=i[h];void 0===d?h%e!=0&&(a-=1):a&&(null==d||d.forEach((function(e){var r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=a)})))}}(t,E),function(t,e){e&&t.removeNode(e),t.getAllEdges().forEach((function(e){e.data.nestingEdge&&t.removeEdge(e.id)}))}(t,x),function(t){var e=t.getAllNodes().filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),r=Math.min.apply(Math,u([],s(e)));t.getAllNodes().forEach((function(t){t.data.hasOwnProperty("rank")&&r!==1/0&&(t.data.rank-=r)}))}(t),rr(t),nr(t);var N=[];!function(t,e){t.getAllEdges().forEach((function(r){return function(t,e,r){var n=e.source,o=t.getNode(n).data.rank,i=e.target,a=t.getNode(i).data.rank,s=e.data.labelRank;if(a!==o+1){var u,h,d;for(t.removeEdge(e.id),d=0,++o;o<a;++d,++o)e.data.points=[],u=Ut(t,"edge",h={originalEdge:e,width:0,height:0,rank:o},"_d"),o===s&&(h.width=e.data.width,h.height=e.data.height,h.dummy=ee,h.labelpos=e.data.labelpos),t.addEdge({id:"e"+Math.random(),source:n,target:u,data:{weight:e.data.weight}}),0===d&&r.push(u),n=u;t.addEdge({id:"e"+Math.random(),source:n,target:i,data:{weight:e.data.weight}})}}(t,r,e)}))}(t,N),function(t,e){var r=function(t){var e={},r=0,n=function(o){var i=r;t.getChildren(o).forEach((function(t){return n(t.id)})),e[o]={low:i,lim:r++}};return t.getRoots().forEach((function(t){return n(t.id)})),e}(t);e.forEach((function(e){var n,o,i=e,a=t.getNode(i),s=a.data.originalEdge;if(s)for(var u=function(t,e,r,n){var o,i,a,s,u=[],h=[],d=Math.min(e[r].low,e[n].low),l=Math.max(e[r].lim,e[n].lim);a=r;do{a=null===(o=t.getParent(a))||void 0===o?void 0:o.id,u.push(a)}while(a&&(e[a].low>d||l>e[a].lim));for(s=a,a=n;a&&a!==s;)h.push(a),a=null===(i=t.getParent(a))||void 0===i?void 0:i.id;return{lca:s,path:u.concat(h.reverse())}}(t,r,s.source,s.target),h=u.path,d=u.lca,l=0,c=h[l],f=!0;i!==s.target;){if(a=t.getNode(i),f){for(;c!==d&&(null===(n=t.getNode(c))||void 0===n?void 0:n.data.maxRank)<a.data.rank;)c=h[++l];c===d&&(f=!1)}if(!f){for(;l<h.length-1&&(null===(o=t.getNode(h[l+1]))||void 0===o?void 0:o.data.minRank)<=a.data.rank;)l++;c=h[l]}t.hasNode(c)&&t.setParent(i,c),i=t.getSuccessors(i)[0].id}}))}(t,N),function(t){var e=function(r){var n=t.getChildren(r),o=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach((function(t){return e(t.id)})),o.data.hasOwnProperty("minRank")){o.data.borderLeft=[],o.data.borderRight=[];for(var i=o.data.minRank,a=o.data.maxRank+1;i<a;i+=1)Ne(t,"borderLeft","_bl",r,o,i),Ne(t,"borderRight","_br",r,o,i)}};t.getRoots().forEach((function(t){return e(t.id)}))}(t),d&&function(t,e){for(var r=t.getAllNodes().filter((function(e){var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)})).map((function(t){return t.data.rank})),n=Math.max.apply(Math,u([],s(r))),o=[],i=0;i<n+1;i++)o[i]=[];null==e||e.forEach((function(e){var r=t.getNode(e);r&&!r.data.dummy&&(isNaN(r.data.rank)||(r.data.fixorder=o[r.data.rank].length,o[r.data.rank].push(e)))}))}(t,h),function(t,e){for(var r=Xt(t),n=[],o=[],i=1;i<r+1;i++)n.push(i);for(i=r-1;i>-1;i--)o.push(i);var a=Le(t,n,"in"),s=Le(t,o,"out"),u=Ae(t);Fe(t,u);for(var h,d=Number.POSITIVE_INFINITY,l=(i=0,0);l<4;++i,++l)je(i%2?a:s,i%4>=2,!1,e),u=Yt(t),(c=ze(t,u))<d&&(l=0,h=qe(u),d=c);for(u=Ae(t),Fe(t,u),i=0,l=0;l<4;++i,++l){var c;je(i%2?a:s,i%4>=2,!0,e),u=Yt(t),(c=ze(t,u))<d&&(l=0,h=qe(u),d=c)}Fe(t,h)}(t,d),dr(t),function(t,e){var r=e.toLowerCase();"lr"!==r&&"rl"!==r||be(t)}(t,a),Ke(t,{align:l,nodesep:g,edgesep:v,ranksep:m}),lr(t),ur(t),function(t,e){e.forEach((function(e){var r,n=t.getNode(e),o=n.data.originalEdge;o&&t.addEdge(o);for(var i=e;n.data.dummy;)r=t.getSuccessors(i)[0],t.removeNode(i),o.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===ee&&(o.data.x=n.data.x,o.data.y=n.data.y,o.data.width=n.data.width,o.data.height=n.data.height),i=r.id,n=t.getNode(i)}))}(t,N),ar(t),function(t,e){var r=e.toLowerCase();"bt"!==r&&"rl"!==r||function(t){t.getAllNodes().forEach((function(t){Se(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return Se(t)})),t.data.hasOwnProperty("y")&&Se(t.data)}))}(t),"lr"!==r&&"rl"!==r||(function(t){t.getAllNodes().forEach((function(t){ke(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return ke(t)})),t.data.hasOwnProperty("x")&&ke(t.data)}))}(t),be(t))}(t,a);var b=or(t),M=b.width,S=b.height;return ir(t),sr(t),function(t){t.getAllEdges().forEach((function(e){var r=e.data;if(r.reversed){t.removeEdge(e.id);var o=r.forwardName;delete r.reversed,delete r.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:n(n({},r),{forwardName:o})})}}))}(t),{width:M,height:S}},Je=["width","height","layer","fixorder"],Xe={width:0,height:0},Qe=["minlen","weight","width","height","labeloffset"],Ze={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},tr=["labelpos"],er=function(t){t.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var r=t.getNode(e.source),n={e,rank:(t.getNode(e.target).data.rank-r.data.rank)/2+r.data.rank};Ut(t,"edge-proxy",n,"_ep")}}))},rr=function(t){var e=0;return t.getAllNodes().forEach((function(r){var n,o;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(o=t.getNode(r.data.borderBottom))||void 0===o?void 0:o.data.rank,e=Math.max(e,r.data.maxRank||-1/0))})),e},nr=function(t){t.getAllNodes().forEach((function(e){"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},or=function(t,e){var r,n,o=0,i=0,a=e||{},s=a.marginx,u=void 0===s?0:s,h=a.marginy,d=void 0===h?0:h,l=function(t){if(t.data){var e=t.data.x,a=t.data.y,s=t.data.width,u=t.data.height;isNaN(e)||isNaN(s)||(void 0===r&&(r=e-s/2),r=Math.min(r,e-s/2),o=Math.max(o,e+s/2)),isNaN(a)||isNaN(u)||(void 0===n&&(n=a-u/2),n=Math.min(n,a-u/2),i=Math.max(i,a+u/2))}};return t.getAllNodes().forEach((function(t){l(t)})),t.getAllEdges().forEach((function(t){(null==t?void 0:t.data.hasOwnProperty("x"))&&l(t)})),r-=u,n-=d,t.getAllNodes().forEach((function(t){t.data.x-=r,t.data.y-=n})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){t.x-=r,t.y-=n})),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)})),{width:o-r+u,height:i-n+d}},ir=function(t){t.getAllEdges().forEach((function(e){var r,n,o=t.getNode(e.source),i=t.getNode(e.target);e.data.points?(r=e.data.points[0],n=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:i.data.x,y:i.data.y},n={x:o.data.x,y:o.data.y}),e.data.points.unshift(Kt(o.data,r)),e.data.points.push(Kt(i.data,n))}))},ar=function(t){t.getAllEdges().forEach((function(t){if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},sr=function(t){t.getAllEdges().forEach((function(t){var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},ur=function(t){t.getAllNodes().forEach((function(e){var r,n,o;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){var i=t.getNode(e.id),a=t.getNode(i.data.borderTop),s=t.getNode(i.data.borderBottom),u=t.getNode(i.data.borderLeft[(null===(n=i.data.borderLeft)||void 0===n?void 0:n.length)-1]),h=t.getNode(i.data.borderRight[(null===(o=i.data.borderRight)||void 0===o?void 0:o.length)-1]);i.data.width=Math.abs((null==h?void 0:h.data.x)-(null==u?void 0:u.data.x))||10,i.data.height=Math.abs((null==s?void 0:s.data.y)-(null==a?void 0:a.data.y))||10,i.data.x=((null==u?void 0:u.data.x)||0)+i.data.width/2,i.data.y=((null==a?void 0:a.data.y)||0)+i.data.height/2}})),t.getAllNodes().forEach((function(e){"border"===e.data.dummy&&t.removeNode(e.id)}))},hr=function(t){t.getAllEdges().forEach((function(e){if(e.source===e.target){var r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}}))},dr=function(t){var e=Yt(t);null==e||e.forEach((function(e){var r=0;null==e||e.forEach((function(e,n){var o,i=t.getNode(e);i.data.order=n+r,null===(o=i.data.selfEdges)||void 0===o||o.forEach((function(e){Ut(t,"selfedge",{width:e.data.width,height:e.data.height,rank:i.data.rank,order:n+ ++r,e},"_se")})),delete i.data.selfEdges}))}))},lr=function(t){t.getAllNodes().forEach((function(e){var r=t.getNode(e.id);if("selfedge"===r.data.dummy){var n=t.getNode(r.data.e.source),o=n.data.x+n.data.width/2,i=n.data.y,a=r.data.x-o,s=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}}))},cr=function(t,e){var r={};return null==e||e.forEach((function(e){void 0!==t[e]&&(r[e]=+t[e])})),r},fr=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(r){e[r.toLowerCase()]=t[r]})),e},gr={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="dagre",this.layoutNode=function(t){return t.data.layout},this.options=n(n({},gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericDagreLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.genericDagreLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericDagreLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,E,b,M,k,_,z,R,I,D,O,P,T,C,q,L,j,F,V,B,G=this;return a(this,(function(a){return o=n(n({},this.options),r),i=o.nodeSize,s=o.align,u=o.rankdir,h=void 0===u?"TB":u,d=o.ranksep,l=o.nodesep,f=o.ranksepFunc,g=o.nodesepFunc,p=o.edgeLabelSpace,v=o.nodeOrder,y=o.begin,m=o.controlPoints,w=o.radial,E=new c({tree:[]}),b=S(d||50,f),M=S(l||50,g),k=M,_=b,"LR"!==h&&"RL"!==h||(k=b,_=M),z=A(i,void 0),R=e.getAllNodes(),I=e.getAllEdges(),R.filter((function(t){return t.data.layout})).forEach((function(t){var e=z(t),r=_(t),n=e+2*k(t),o=e+2*r,i=t.data.layer;x(i)?E.addNode({id:t.id,data:{width:n,height:o,layer:i}}):E.addNode({id:t.id,data:{width:n,height:o}})})),I.forEach((function(t){G.layoutNode(E.getNode(t.source))&&G.layoutNode(E.getNode(t.target))&&E.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),function(t,e){var r,o,i=e.edgeLabelSpace,a=e.keepNodeOrder,s=e.prevGraph,u=e.rankdir,h=e.ranksep;!a&&s&&(o=s,(r=t).getAllNodes().forEach((function(t){var e=r.getNode(t.id),n=o.getNode(t.id);void 0!==n?(e.data.fixorder=n.data._order,delete n.data._order):delete e.data.fixorder})));var d=function(t){var e=new c({tree:[]});return t.getAllNodes().forEach((function(r){var o=fr(t.getNode(r.id).data),i=n(n({},Xe),o),a=cr(i,Je);e.hasNode(r.id)||e.addNode({id:r.id,data:n({},a)});var s=t.getParent(r.id);null==s||(e.hasNode(s.id)||e.addNode(n({},s)),e.setParent(r.id,s.id))})),t.getAllEdges().forEach((function(r){var n=fr(t.getEdge(r.id).data),o={};null==tr||tr.forEach((function(t){void 0!==n[t]&&(o[t]=n[t])})),e.addEdge({id:r.id,source:r.source,target:r.target,data:Object.assign({},Ze,cr(n,Qe),o)})})),e}(t);i&&(e.ranksep=function(t,e){var r=e.ranksep,n=void 0===r?0:r,o=e.rankdir;return t.getAllNodes().forEach((function(t){isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((function(t){var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===o||"BT"===o?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2}(d,{rankdir:u,ranksep:h}));try{Ye(d,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph\'s structure:\\n",t);throw t}!function(t,e){t.getAllNodes().forEach((function(r){var n,o=t.getNode(r.id);if(o){var i=e.getNode(r.id);o.data.x=i.data.x,o.data.y=i.data.y,o.data._order=i.data.order,o.data._rank=i.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(o.data.width=i.data.width,o.data.height=i.data.height)}})),t.getAllEdges().forEach((function(r){var n=t.getEdge(r.id),o=e.getEdge(r.id);n.data.points=o?o.data.points:[],o&&o.data.hasOwnProperty("x")&&(n.data.x=o.data.x,n.data.y=o.data.y)}))}(t,d)}(E,{prevGraph:null,edgeLabelSpace:p,keepNodeOrder:!!v,nodeOrder:v||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:h,nodesep:l,align:s}),D=[0,0],y&&(O=1/0,P=1/0,E.getAllNodes().forEach((function(t){O>t.data.x&&(O=t.data.x),P>t.data.y&&(P=t.data.y)})),E.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){O>t.x&&(O=t.x),P>t.y&&(P=t.y)}))})),D[0]=y[0]-O,D[1]=y[1]-P),T="LR"===h||"RL"===h,w||(C=new Set,q="BT"===h||"RL"===h?function(t,e){return e-t}:function(t,e){return t-e},E.getAllNodes().forEach((function(t){t.data.x=t.data.x+D[0],t.data.y=t.data.y+D[1],C.add(T?t.data.x:t.data.y)})),L=Array.from(C).sort(q),j=T?function(t,e){return t.x!==e.x}:function(t,e){return t.y!==e.y},F=T?function(t,e,r){var n=Math.max(e.y,r.y),o=Math.min(e.y,r.y);return t.filter((function(t){return t.y<=n&&t.y>=o}))}:function(t,e,r){var n=Math.max(e.x,r.x),o=Math.min(e.x,r.x);return t.filter((function(t){return t.x<=n&&t.x>=o}))},E.getAllEdges().forEach((function(t,e){var r;p&&m&&"loop"!==t.data.type&&(t.data.controlPoints=vr(null===(r=t.data.points)||void 0===r?void 0:r.map((function(t){var e=t.x,r=t.y;return{x:e+D[0],y:r+D[1]}})),E.getNode(t.source),E.getNode(t.target),L,T,j,F))}))),V=[],V=E.getAllNodes().map((function(t){return N(t)})),B=E.getAllEdges(),t&&(V.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),B.forEach((function(t){e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),[2,{nodes:V,edges:B}]}))}))},t}(),vr=function(t,e,r,n,o,i,a){var s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){var u=e.data,h=u.x,d=u.y,l=r.data,c=l.x,f=l.y;if(o&&(h=e.data.y,d=e.data.x,c=r.data.y,f=r.data.x),f!==d&&h!==c){var g=n.indexOf(d),p=n[g+1];if(p){var v=s[0],y=o?{x:(d+p)/2,y:(null==v?void 0:v.y)||c}:{x:(null==v?void 0:v.x)||c,y:(d+p)/2};v&&!i(v,y)||s.unshift(y)}var m=n.indexOf(f),w=Math.abs(m-g);if(1===w)(s=a(s,e.data,r.data)).length||s.push(o?{x:(d+f)/2,y:h}:{x:h,y:(d+f)/2});else if(w>1){var x=n[m-1];if(x){var E=s[s.length-1],N=o?{x:(f+x)/2,y:(null==E?void 0:E.y)||c}:{x:(null==E?void 0:E.x)||h,y:(f+x)/2};E&&!i(E,N)||s.push(N)}}}}return s};function yr(t,e,r,n,o){if(isNaN(e)||isNaN(r)||isNaN(n))return t;var i,a,s,u,h,d,l,c,f,g,p,v,y=t._root,m={data:o},w=t._x0,x=t._y0,E=t._z0,N=t._x1,b=t._y1,M=t._z1;if(!y)return t._root=m,t;for(;y.length;)if((c=e>=(a=(w+N)/2))?w=a:N=a,(f=r>=(s=(x+b)/2))?x=s:b=s,(g=n>=(u=(E+M)/2))?E=u:M=u,i=y,!(y=y[p=g<<2|f<<1|c]))return i[p]=m,t;if(h=+t._x.call(null,y.data),d=+t._y.call(null,y.data),l=+t._z.call(null,y.data),e===h&&r===d&&n===l)return m.next=y,i?i[p]=m:t._root=m,t;do{i=i?i[p]=new Array(8):t._root=new Array(8),(c=e>=(a=(w+N)/2))?w=a:N=a,(f=r>=(s=(x+b)/2))?x=s:b=s,(g=n>=(u=(E+M)/2))?E=u:M=u}while((p=g<<2|f<<1|c)==(v=(l>=u)<<2|(d>=s)<<1|h>=a));return i[v]=y,i[p]=m,t}function mr(t,e,r,n,o,i,a){this.node=t,this.x0=e,this.y0=r,this.z0=n,this.x1=o,this.y1=i,this.z1=a}function wr(t){return t[0]}function xr(t){return t[1]}function Er(t){return t[2]}function Nr(t,e,r,n){var o=new br(null==e?wr:e,null==r?xr:r,null==n?Er:n,NaN,NaN,NaN,NaN,NaN,NaN);return null==t?o:o.addAll(t)}function br(t,e,r,n,o,i,a,s,u){this._x=t,this._y=e,this._z=r,this._x0=n,this._y0=o,this._z0=i,this._x1=a,this._y1=s,this._z1=u,this._root=void 0}function Mr(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var Sr=Nr.prototype=br.prototype;function kr(t){var e=0,r=0,n=0,o=0,i=t.length;if(i){for(var a=0;a<i;a++)(s=t[a])&&s.weight&&(e+=s.weight,r+=s.x*s.weight,n+=s.y*s.weight,o+=s.z*s.weight);t.x=r/e,t.y=n/e,t.z=o/e,t.weight=e}else{var s=t;t.x=s.data.x,t.y=s.data.y,t.z=s.data.z,t.weight=s.data.weight}}Sr.copy=function(){var t,e,r=new br(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),n=this._root;if(!n)return r;if(!n.length)return r._root=Mr(n),r;for(t=[{source:n,target:r._root=new Array(8)}];n=t.pop();)for(var o=0;o<8;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(8)}):n.target[o]=Mr(e));return r},Sr.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t),n=+this._z.call(null,t);return yr(this.cover(e,r,n),e,r,n,t)},Sr.addAll=function(t){Array.isArray(t)||(t=Array.from(t));const e=t.length,r=new Float64Array(e),n=new Float64Array(e),o=new Float64Array(e);let i=1/0,a=1/0,s=1/0,u=-1/0,h=-1/0,d=-1/0;for(let l,c,f,g,p=0;p<e;++p)isNaN(c=+this._x.call(null,l=t[p]))||isNaN(f=+this._y.call(null,l))||isNaN(g=+this._z.call(null,l))||(r[p]=c,n[p]=f,o[p]=g,c<i&&(i=c),c>u&&(u=c),f<a&&(a=f),f>h&&(h=f),g<s&&(s=g),g>d&&(d=g));if(i>u||a>h||s>d)return this;this.cover(i,a,s).cover(u,h,d);for(let i=0;i<e;++i)yr(this,r[i],n[i],o[i],t[i]);return this},Sr.cover=function(t,e,r){if(isNaN(t=+t)||isNaN(e=+e)||isNaN(r=+r))return this;var n=this._x0,o=this._y0,i=this._z0,a=this._x1,s=this._y1,u=this._z1;if(isNaN(n))a=(n=Math.floor(t))+1,s=(o=Math.floor(e))+1,u=(i=Math.floor(r))+1;else{for(var h,d,l=a-n||1,c=this._root;n>t||t>=a||o>e||e>=s||i>r||r>=u;)switch(d=(r<i)<<2|(e<o)<<1|t<n,(h=new Array(8))[d]=c,c=h,l*=2,d){case 0:a=n+l,s=o+l,u=i+l;break;case 1:n=a-l,s=o+l,u=i+l;break;case 2:a=n+l,o=s-l,u=i+l;break;case 3:n=a-l,o=s-l,u=i+l;break;case 4:a=n+l,s=o+l,i=u-l;break;case 5:n=a-l,s=o+l,i=u-l;break;case 6:a=n+l,o=s-l,i=u-l;break;case 7:n=a-l,o=s-l,i=u-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=o,this._z0=i,this._x1=a,this._y1=s,this._z1=u,this},Sr.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Sr.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},Sr.find=function(t,e,r,n){var o,i,a,s,u,h,d,l,c,f=this._x0,g=this._y0,p=this._z0,v=this._x1,y=this._y1,m=this._z1,w=[],x=this._root;for(x&&w.push(new mr(x,f,g,p,v,y,m)),null==n?n=1/0:(f=t-n,g=e-n,p=r-n,v=t+n,y=e+n,m=r+n,n*=n);l=w.pop();)if(!(!(x=l.node)||(i=l.x0)>v||(a=l.y0)>y||(s=l.z0)>m||(u=l.x1)<f||(h=l.y1)<g||(d=l.z1)<p))if(x.length){var E=(i+u)/2,N=(a+h)/2,b=(s+d)/2;w.push(new mr(x[7],E,N,b,u,h,d),new mr(x[6],i,N,b,E,h,d),new mr(x[5],E,a,b,u,N,d),new mr(x[4],i,a,b,E,N,d),new mr(x[3],E,N,s,u,h,b),new mr(x[2],i,N,s,E,h,b),new mr(x[1],E,a,s,u,N,b),new mr(x[0],i,a,s,E,N,b)),(c=(r>=b)<<2|(e>=N)<<1|t>=E)&&(l=w[w.length-1],w[w.length-1]=w[w.length-1-c],w[w.length-1-c]=l)}else{var M=t-+this._x.call(null,x.data),S=e-+this._y.call(null,x.data),k=r-+this._z.call(null,x.data),A=M*M+S*S+k*k;if(A<n){var _=Math.sqrt(n=A);f=t-_,g=e-_,p=r-_,v=t+_,y=e+_,m=r+_,o=x.data}}return o},Sr.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t))||isNaN(s=+this._z.call(null,t)))return this;var e,r,n,o,i,a,s,u,h,d,l,c,f,g,p,v=this._root,y=this._x0,m=this._y0,w=this._z0,x=this._x1,E=this._y1,N=this._z1;if(!v)return this;if(v.length)for(;;){if((l=i>=(u=(y+x)/2))?y=u:x=u,(c=a>=(h=(m+E)/2))?m=h:E=h,(f=s>=(d=(w+N)/2))?w=d:N=d,e=v,!(v=v[g=f<<2|c<<1|l]))return this;if(!v.length)break;(e[g+1&7]||e[g+2&7]||e[g+3&7]||e[g+4&7]||e[g+5&7]||e[g+6&7]||e[g+7&7])&&(r=e,p=g)}for(;v.data!==t;)if(n=v,!(v=v.next))return this;return(o=v.next)&&delete v.next,n?(o?n.next=o:delete n.next,this):e?(o?e[g]=o:delete e[g],(v=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&v===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!v.length&&(r?r[p]=v:this._root=v),this):(this._root=o,this)},Sr.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},Sr.root=function(){return this._root},Sr.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Sr.visit=function(t){var e,r,n,o,i,a,s,u,h=[],d=this._root;for(d&&h.push(new mr(d,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=h.pop();)if(!t(d=e.node,n=e.x0,o=e.y0,i=e.z0,a=e.x1,s=e.y1,u=e.z1)&&d.length){var l=(n+a)/2,c=(o+s)/2,f=(i+u)/2;(r=d[7])&&h.push(new mr(r,l,c,f,a,s,u)),(r=d[6])&&h.push(new mr(r,n,c,f,l,s,u)),(r=d[5])&&h.push(new mr(r,l,o,f,a,c,u)),(r=d[4])&&h.push(new mr(r,n,o,f,l,c,u)),(r=d[3])&&h.push(new mr(r,l,c,i,a,s,f)),(r=d[2])&&h.push(new mr(r,n,c,i,l,s,f)),(r=d[1])&&h.push(new mr(r,l,o,i,a,c,f)),(r=d[0])&&h.push(new mr(r,n,o,i,l,c,f))}return this},Sr.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new mr(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.z0,h=e.x1,d=e.y1,l=e.z1,c=(a+h)/2,f=(s+d)/2,g=(u+l)/2;(i=o[0])&&r.push(new mr(i,a,s,u,c,f,g)),(i=o[1])&&r.push(new mr(i,c,s,u,h,f,g)),(i=o[2])&&r.push(new mr(i,a,f,u,c,d,g)),(i=o[3])&&r.push(new mr(i,c,f,u,h,d,g)),(i=o[4])&&r.push(new mr(i,a,s,g,c,f,l)),(i=o[5])&&r.push(new mr(i,c,s,g,h,f,l)),(i=o[6])&&r.push(new mr(i,a,f,g,c,d,l)),(i=o[7])&&r.push(new mr(i,c,f,g,h,d,l))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.z0,e.x1,e.y1,e.z1);return this},Sr.x=function(t){return arguments.length?(this._x=t,this):this._x},Sr.y=function(t){return arguments.length?(this._y=t,this):this._y},Sr.z=function(t){return arguments.length?(this._z=t,this):this._z};var Ar=function(t,e,r,n,o,i,a){var s=[r,n,o][a-1],u=i.x-t.x||.1,h=i.y-t.y||.1,d=i.z-t.z||.1,l=s-e,c=u*u+h*h+d*d,f=Math.sqrt(c)*c;if(l*l*.81<c){var g=t.weight/f;return i.vx+=u*g,i.vy+=h*g,i.vz+=d*g,!0}if(t.length)return!1;t.data!==i&&(g=t.data.weight/f,i.vx+=u*g,i.vy+=h*g,i.vz+=d*g)},_r={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},zr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=n(n({},_r),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===e.options.dimensions?t.data.z:void 0})})),n},t.prototype.genericForceLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,E,N,b,M,S,k,A=this;return a(this,(function(a){return o=n(n({},this.options),r),i=e.getAllNodes(),s=e.getAllEdges(),u=this.formatOptions(o,e),h=u.dimensions,d=u.width,l=u.height,f=u.nodeSize,g=u.getMass,p=u.nodeStrength,v=u.edgeStrength,y=u.linkDistance,m=i.map((function(t,e){return n(n({},t),{data:n(n({},t.data),{x:x(t.data.x)?t.data.x:Math.random()*d,y:x(t.data.y)?t.data.y:Math.random()*l,z:x(t.data.z)?t.data.z:Math.random()*Math.sqrt(d*l),size:f(t)||30,mass:g(t),nodeStrength:p(t)})})})),w=s.map((function(t){return n(n({},t),{data:n(n({},t.data),{edgeStrength:v(t),linkDistance:y(t,e.getNode(t.source),e.getNode(t.target))})})})),(null==i?void 0:i.length)?(E={},i.forEach((function(t,e){E[t.id]={x:0,y:0,z:0}})),N=new c({nodes:m,edges:w}),this.formatCentripetal(u,N),b=u.maxIteration,M=u.minMovement,S=u.onTick,this.lastLayoutNodes=m,this.lastLayoutEdges=w,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=N,this.lastOptions=u,this.lastVelMap=E,"undefined"==typeof window?[2]:(k=0,[2,new Promise((function(r){A.timeInterval=window.setInterval((function(){i&&A.running||r({nodes:Pr(e,m),edges:s}),A.runOneStep(N,e,k,E,u),A.updatePosition(e,N,E,u),t&&m.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===h?t.data.z:void 0})})),null==S||S({nodes:Pr(e,m),edges:s}),(++k>=b||A.judgingDistance<M)&&(window.clearInterval(A.timeInterval),r({nodes:Pr(e,m),edges:s}))}),0),A.running=!0}))])):(this.lastResult={nodes:[],edges:s},[2,{nodes:[],edges:s}])}))}))},t.prototype.formatOptions=function(t,e){var r=t,n=t.width,o=t.height,i=t.getMass;if(r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=o||"undefined"==typeof window?o:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),i||(r.getMass=function(t){var r=1;x(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);var n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),t.preventOverlap){var a=S(0,t.nodeSpacing);t.nodeSize?g(t.nodeSize)?r.nodeSize=function(e){var r=t.nodeSize;return Math.max(r[0],r[1])+a(e)}:r.nodeSize=function(e){return t.nodeSize+a(e)}:r.nodeSize=function(t){var e=((null==t?void 0:t.data)||{}).size;return e?g(e)?Math.max(e[0],e[1])+a(t):M(e)?Math.max(e.width,e.height)+a(t):e+a(t):10+a(t)}}return r.linkDistance=t.linkDistance?S(1,t.linkDistance):function(t){return 1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target))},r.nodeStrength=S(1,t.nodeStrength),r.edgeStrength=S(1,t.edgeStrength),t},t.prototype.formatCentripetal=function(t,e){var r,n=t.centripetalOptions,o=t.center,i=t.clusterNodeStrength,a=t.leafCluster,s=t.clustering,u=t.nodeClusterBy,h=e.getAllNodes(),d=n||{leaf:2,single:2,others:1,center:function(t){return{x:o[0],y:o[1]}}};"function"!=typeof i&&(t.clusterNodeStrength=function(t){return i});var l=[];if(a&&u&&(r=Rr(e,u),l=Array.from(new Set(null==h?void 0:h.map((function(t){return t.data[u]}))))||[],t.centripetalOptions=Object.assign(d,{single:100,leaf:function(e){var n=r[e.id]||{},o=n.siblingLeaves,i=n.sameTypeLeaves;return(null==i?void 0:i.length)===(null==o?void 0:o.length)||1===(null==l?void 0:l.length)?1:t.clusterNodeStrength(e)},others:1,center:function(t){var n,o=e.getDegree(t.id,"both");if(!o)return{x:100,y:100};if(1===o){var i=(r[t.id]||{}).sameTypeLeaves,a=void 0===i?[]:i;1===a.length?n=void 0:a.length>1&&(n=Or(a))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y}}})),s&&u){r||(r=Rr(e,u)),l||(l=Array.from(new Set(h.map((function(t){return t.data[u]}))))),l=l.filter((function(t){return void 0!==t}));var c={};l.forEach((function(t){var r=h.filter((function(e){return e.data[u]===t})).map((function(t){return e.getNode(t.id)}));c[t]=Or(r)})),t.centripetalOptions=Object.assign(d,{single:function(e){return t.clusterNodeStrength(e)},leaf:function(e){return t.clusterNodeStrength(e)},others:function(e){return t.clusterNodeStrength(e)},center:function(t){var e=c[t.data[u]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y}}})}var f=t.centripetalOptions||{},g=f.leaf,p=f.single,v=f.others;g&&"function"!=typeof g&&(t.centripetalOptions.leaf=function(){return g}),p&&"function"!=typeof p&&(t.centripetalOptions.single=function(){return p}),v&&"function"!=typeof v&&(t.centripetalOptions.others=function(){return v})},t.prototype.runOneStep=function(t,e,r,n,o){var i={},a=t.getAllNodes(),s=t.getAllEdges();if(null==a?void 0:a.length){var u=o.monitor;this.calRepulsive(t,i,o),s&&this.calAttractive(t,i,o),this.calGravity(t,e,i,o),this.updateVelocity(t,i,n,o),u&&u({energy:this.calTotalEnergy(i,a),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}},t.prototype.calTotalEnergy=function(t,e){var r=this;if(!(null==e?void 0:e.length))return 0;var n=0;return e.forEach((function(e,o){var i=t[e.id].x,a=t[e.id].y,s=3===r.options.dimensions?t[e.id].z:0,u=i*i+a*a+s*s,h=e.data.mass;n+=(void 0===h?1:h)*u*.5})),n},t.prototype.calRepulsive=function(t,e,r){var n=r.dimensions,o=r.factor,i=r.coulombDisScale;!function(t,e,r,n,o){var i=e/r,a=t.getAllNodes(),s=a.map((function(t,e){var r=t.data,n=r.nodeStrength;return{x:r.x,y:r.y,z:r.z,size:r.size,index:e,vx:0,vy:0,vz:0,weight:i*n}})),u=(2===o?F(s,(function(t){return t.x}),(function(t){return t.y})):Nr(s,(function(t){return t.x}),(function(t){return t.y}),(function(t){return t.z}))).visitAfter(kr);s.forEach((function(t){!function(t,e,r){e.visit((function(e,n,o,i,a){return Ar(e,n,o,i,a,t,r)}))}(t,u,o)})),s.map((function(t,e){var r=a[e],o=r.id,i=r.data.mass,s=void 0===i?1:i;n[o]={x:t.vx/s,y:t.vy/s,z:t.vz/s}}))}(t,o,i*i,e,n)},t.prototype.calAttractive=function(t,e,r){var n=r.dimensions;t.getAllEdges().forEach((function(r,o){var i=r.source,a=r.target,s=t.getNode(i),u=t.getNode(a);if(s&&u){var h=u.data.x-s.data.x,d=u.data.y-s.data.y,l=3===n?u.data.z-s.data.z:0;h||d||(h=.01*Math.random(),d=.01*Math.random(),3!==n||l||(l=.01*Math.random()));var c=Math.sqrt(h*h+d*d+l*l),f=h/c,g=d/c,p=l/c,v=r.data||{},y=v.linkDistance,m=void 0===y?200:y,w=v.edgeStrength,x=(m-c)*(void 0===w?200:w),E=1/(s.data.mass||1),N=1/(u.data.mass||1),b=f*x,M=g*x,S=p*x;e[i].x-=b*E,e[i].y-=M*E,e[i].z-=S*E,e[a].x+=b*N,e[a].y+=M*N,e[a].z+=S*N}}))},t.prototype.calGravity=function(t,e,r,n){var o=n.getCenter,i=t.getAllNodes(),a=e.getAllNodes(),u=e.getAllEdges(),h=n.width,d=n.height,l=n.center,c=n.gravity,f=n.centripetalOptions;i&&i.forEach((function(n){var i=n.id,g=n.data,p=g.mass,v=g.x,y=g.y,m=g.z,w=e.getNode(i),E=0,N=0,b=0,M=c,S=t.getDegree(i,"in"),k=t.getDegree(i,"out"),A=t.getDegree(i,"both"),_=null==o?void 0:o(w,A);if(_){var z=s(_,3);E=v-z[0],N=y-z[1],M=z[2]}else E=v-l[0],N=y-l[1],b=m-l[2];if(M&&(r[i].x-=M*E/p,r[i].y-=M*N/p,r[i].z-=M*b/p),f){var R=f.leaf,I=f.single,D=f.others,O=f.center,P=(null==O?void 0:O(w,a,u,h,d))||{x:0,y:0,z:0,centerStrength:0},T=P.x,C=P.y,q=P.z,L=P.centerStrength;if(!x(T)||!x(C))return;var j=(v-T)/p,F=(y-C)/p,V=(m-q)/p;if(L&&(r[i].x-=L*j,r[i].y-=L*F,r[i].z-=L*V),0===A){var B=I(w);if(!B)return;return r[i].x-=B*j,r[i].y-=B*F,void(r[i].z-=B*V)}if(0===S||0===k){var G=R(w,a,u);if(!G)return;return r[i].x-=G*j,r[i].y-=G*F,void(r[i].z-=G*V)}var W=D(w);if(!W)return;r[i].x-=W*j,r[i].y-=W*F,r[i].z-=W*V}}))},t.prototype.updateVelocity=function(t,e,r,n){var o=n.damping,i=n.maxSpeed,a=n.interval,s=n.dimensions,u=t.getAllNodes();(null==u?void 0:u.length)&&u.forEach((function(t){var n=t.id,u=(r[n].x+e[n].x*a)*o||.01,h=(r[n].y+e[n].y*a)*o||.01,d=3===s?(r[n].z+e[n].z*a)*o||.01:0,l=Math.sqrt(u*u+h*h+d*d);if(l>i){var c=i/l;u*=c,h*=c,d*=c}r[n]={x:u,y:h,z:d}}))},t.prototype.updatePosition=function(t,e,r,n){var o=this,i=n.distanceThresholdMode,a=n.interval,s=n.dimensions,u=e.getAllNodes();if(null==u?void 0:u.length){var h=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),u.forEach((function(n){var u=n.id,d=t.getNode(u);if(x(d.data.fx)&&x(d.data.fy))e.mergeNodeData(u,{x:d.data.fx,y:d.data.fy,z:3===s?d.data.fz:void 0});else{var l=r[u].x*a,c=r[u].y*a,f=3===s?r[u].z*a:0;e.mergeNodeData(u,{x:n.data.x+l,y:n.data.y+c,z:n.data.z+f});var g=Math.sqrt(l*l+c*c+f*f);switch(i){case"max":o.judgingDistance<g&&(o.judgingDistance=g);break;case"min":o.judgingDistance>g&&(o.judgingDistance=g);break;default:h+=g}}})),i&&"mean"!==i||(this.judgingDistance=h/u.length)}else this.judgingDistance=0},t}(),Rr=function(t,e){var r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};var n={};return r.forEach((function(r,o){1===t.getDegree(r.id,"both")&&(n[r.id]=Ir(t,"leaf",r,e))})),n},Ir=function(t,e,r,n){var o=t.getDegree(r.id,"in"),i=t.getDegree(r.id,"out"),a=r,s=[];return 0===o?(a=t.getSuccessors(r.id)[0],s=t.getNeighbors(a.id)):0===i&&(a=t.getPredecessors(r.id)[0],s=t.getNeighbors(a.id)),s=s.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")})),{coreNode:a,siblingLeaves:s,sameTypeLeaves:Dr(t,e,n,r,s)}},Dr=function(t,e,r,n,o){var i=n.data[r]||"",a=(null==o?void 0:o.filter((function(t){return t.data[r]===i})))||[];return"leaf"===e&&(a=a.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")}))),a},Or=function(t){var e={x:0,y:0};t.forEach((function(t){var r=t.data,n=r.x,o=r.y;e.x+=n||0,e.y+=o||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},Pr=function(t,e){return e.map((function(e){var r=e.id,o=e.data,i=t.getNode(r);return n(n({},i),{data:n(n({},i.data),{x:o.x,y:o.y,z:o.z})})}))},Tr=function(){function t(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}return t.prototype.distanceTo=function(t){var e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)},t.prototype.setPos=function(t,e){this.rx=t,this.ry=e},t.prototype.resetForce=function(){this.fx=0,this.fy=0},t.prototype.addForce=function(t){var e=t.rx-this.rx,r=t.ry-this.ry,n=Math.hypot(e,r);n=n<1e-4?1e-4:n;var o=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=o*e/n,this.fy+=o*r/n},t.prototype.in=function(t){return t.contains(this.rx,this.ry)},t.prototype.add=function(e){var r=this.mass+e.mass;return new t({rx:(this.rx*this.mass+e.rx*e.mass)/r,ry:(this.ry*this.mass+e.ry*e.mass)/r,mass:r,degree:this.degree+e.degree})},t}();const Cr=Tr;const qr=function(){function t(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}return t.prototype.getLength=function(){return this.length},t.prototype.contains=function(t,e){var r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r},t.prototype.NW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.NE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.SW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t.prototype.SE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t}(),Lr=function(){function t(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}return t.prototype.insert=function(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e},t.prototype._putBody=function(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))},t.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},t.prototype.updateForce=function(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))},t}();var jr={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Fr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2",this.options=n(n({},jr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,x,E,b,M,S,k,A,z;return a(this,(function(a){if(o=e.getAllEdges(),i=e.getAllNodes(),s=this.formatOptions(r,i.length),u=s.width,h=s.height,d=s.prune,l=s.maxIteration,f=s.nodeSize,g=s.center,!(null==i?void 0:i.length)||1===i.length)return[2,_(e,t,g)];if(p=i.map((function(t){return N(t,[u,h])})),v=o.filter((function(t){return t.source!==t.target})),y=new c({nodes:p,edges:v}),m=this.getSizes(y,e,f),this.run(y,e,l,m,t,s),d){for(w=0;w<v.length;w+=1)x=v[w],E=x.source,b=x.target,M=y.getDegree(E),S=y.getDegree(E),M<=1?(k=y.getNode(b),y.mergeNodeData(E,{x:k.data.x,y:k.data.y})):S<=1&&(A=y.getNode(E),y.mergeNodeData(b,{x:A.data.x,y:A.data.y}));z=n(n({},s),{prune:!1,barnesHut:!1}),this.run(y,e,100,m,t,z)}return[2,{nodes:p,edges:o}]}))}))},t.prototype.getSizes=function(t,e,r){for(var n=t.getAllNodes(),o={},i=0;i<n.length;i+=1){var a=n[i],h=a.id,d=a.data;if(o[h]=10,x(d.size))o[h]=d.size;else if(g(d.size))isNaN(d.size[0])||(o[h]=Math.max(d.size[0])),isNaN(d.size[1])||(o[h]=Math.max(d.size[1]));else if(M(d.size))o[h]=Math.max(d.size.width,d.size.height);else if(b(r)){var l=r(e.getNode(h));g(l)?o[h]=Math.max.apply(Math,u([],s(l))):o[h]=l}else g(r)?o[h]=Math.max.apply(Math,u([],s(r))):x(r)&&(o[h]=r)}return o},t.prototype.formatOptions=function(t,e){void 0===t&&(t={});var r=n(n({},this.options),t),o=r.center,i=r.width,a=r.height,s=r.barnesHut,u=r.prune,h=r.maxIteration,d=r.kr,l=r.kg;return r.width=i||"undefined"==typeof window?i:window.innerWidth,r.height=a||"undefined"==typeof window?a:window.innerHeight,r.center=o||[r.width/2,r.height/2],void 0===s&&e>250&&(r.barnesHut=!0),void 0===u&&e>100&&(r.prune=!0),0!==h||u?0===h&&u&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)):(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)),d||(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),l||(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r},t.prototype.run=function(t,e,r,n,o,i){for(var a=i.kr,s=i.barnesHut,u=i.onTick,h=t.getAllNodes(),d=0,l=r,c={},f={},g={},p=0;p<h.length;p+=1){var v=h[p],y=v.data,m=v.id;if(c[m]=[0,0],s){var w={id:p,rx:y.x,ry:y.y,mass:1,g:a,degree:t.getDegree(m)};g[m]=new Cr(w)}}for(;l>0;)d=this.oneStep(t,{iter:l,preventOverlapIters:50,krPrime:100,sg:d,forces:c,preForces:f,bodies:g,sizes:n},i),l--,null==u||u({nodes:h,edges:e.getAllEdges()});return t},t.prototype.oneStep=function(t,e,r){for(var n=e.iter,o=e.preventOverlapIters,i=e.krPrime,a=e.sg,h=e.preForces,d=e.bodies,l=e.sizes,c=e.forces,f=r.preventOverlap,g=r.barnesHut,p=t.getAllNodes(),v=0;v<p.length;v+=1){var y=p[v].id;h[y]=u([],s(c[y])),c[y]=[0,0]}return c=this.getAttrForces(t,n,o,l,c,r),c=g&&(f&&n>o||!f)?this.getOptRepGraForces(t,c,d,r):this.getRepGraForces(t,n,o,c,i,l,r),this.updatePos(t,c,h,a,r)},t.prototype.getAttrForces=function(t,e,r,n,o,i){for(var a=i.preventOverlap,s=i.dissuadeHubs,u=i.mode,h=i.prune,d=t.getAllEdges(),l=0;l<d.length;l+=1){var c=d[l],f=c.source,g=c.target,p=t.getNode(f),v=t.getNode(g),y=t.getDegree(f),m=t.getDegree(g);if(!h||!(y<=1||m<=1)){var w=[v.data.x-p.data.x,v.data.y-p.data.y],x=Math.hypot(w[0],w[1]);x=x<1e-4?1e-4:x,w[0]=w[0]/x,w[1]=w[1]/x,a&&e<r&&(x=x-n[f]-n[g]);var E=x,N=E;"linlog"===u&&(N=E=Math.log(1+x)),s&&(E=x/y,N=x/m),a&&e<r&&x<=0?(E=0,N=0):a&&e<r&&x>0&&(E=x,N=x),o[f][0]+=E*w[0],o[g][0]-=N*w[0],o[f][1]+=E*w[1],o[g][1]-=N*w[1]}}return o},t.prototype.getOptRepGraForces=function(t,e,r,n){for(var o=n.kg,i=n.center,a=n.prune,s=t.getAllNodes(),u=s.length,h=9e10,d=-9e10,l=9e10,c=-9e10,f=0;f<u;f+=1){var g=s[f],p=g.id,v=g.data;a&&t.getDegree(p)<=1||(r[p].setPos(v.x,v.y),v.x>=d&&(d=v.x),v.x<=h&&(h=v.x),v.y>=c&&(c=v.y),v.y<=l&&(l=v.y))}var y=Math.max(d-h,c-l),m=new qr({xmid:(d+h)/2,ymid:(c+l)/2,length:y,massCenter:i,mass:u}),w=new Lr(m);for(f=0;f<u;f+=1)p=s[f].id,a&&t.getDegree(p)<=1||r[p].in(m)&&w.insert(r[p]);for(f=0;f<u;f+=1){var x=s[f],E=(p=x.id,v=x.data,t.getDegree(p));if(!(a&&E<=1)){r[p].resetForce(),w.updateForce(r[p]),e[p][0]-=r[p].fx,e[p][1]-=r[p].fy;var N=[v.x-i[0],v.y-i[1]],b=Math.hypot(N[0],N[1]);b=b<1e-4?1e-4:b,N[0]=N[0]/b,N[1]=N[1]/b;var M=o*(E+1);e[p][0]-=M*N[0],e[p][1]-=M*N[1]}}return e},t.prototype.getRepGraForces=function(t,e,r,n,o,i,a){for(var s=a.preventOverlap,u=a.kr,h=a.kg,d=a.center,l=a.prune,c=t.getAllNodes(),f=c.length,g=0;g<f;g+=1){for(var p=c[g],v=t.getDegree(p.id),y=g+1;y<f;y+=1){var m=c[y],w=t.getDegree(m.id);if(!l||!(v<=1||w<=1)){var x=[m.data.x-p.data.x,m.data.y-p.data.y],E=Math.hypot(x[0],x[1]);E=E<1e-4?1e-4:E,x[0]=x[0]/E,x[1]=x[1]/E,s&&e<r&&(E=E-i[p.id]-i[m.id]);var N=u*(v+1)*(w+1)/E;s&&e<r&&E<0?N=o*(v+1)*(w+1):s&&e<r&&0===E?N=0:s&&e<r&&E>0&&(N=u*(v+1)*(w+1)/E),n[p.id][0]-=N*x[0],n[m.id][0]+=N*x[0],n[p.id][1]-=N*x[1],n[m.id][1]+=N*x[1]}}var b=[p.data.x-d[0],p.data.y-d[1]],M=Math.hypot(b[0],b[1]);b[0]=b[0]/M,b[1]=b[1]/M;var S=h*(v+1);n[p.id][0]-=S*b[0],n[p.id][1]-=S*b[1]}return n},t.prototype.updatePos=function(t,e,r,n,o){for(var i=o.ks,a=o.tao,s=o.prune,u=o.ksmax,h=t.getAllNodes(),d=h.length,l=[],c=[],f=0,g=0,p=n,v=0;v<d;v+=1){var y=h[v].id,m=t.getDegree(y);if(!(s&&m<=1)){var w=[e[y][0]-r[y][0],e[y][1]-r[y][1]],E=Math.hypot(w[0],w[1]),N=[e[y][0]+r[y][0],e[y][1]+r[y][1]],b=Math.hypot(N[0],N[1]);l[v]=E,c[v]=b/2,f+=(m+1)*l[v],g+=(m+1)*c[v]}}var M=p;for(p=a*g/f,0!==M&&(p=p>1.5*M?1.5*M:p),v=0;v<d;v+=1){var S=h[v],k=(y=S.id,S.data);if(m=t.getDegree(y),!(s&&m<=1||x(k.fx)&&x(k.fy))){var A=i*p/(1+p*Math.sqrt(l[v])),_=Math.hypot(e[y][0],e[y][1]),z=u/(_=_<1e-4?1e-4:_),R=(A=A>z?z:A)*e[y][0],I=A*e[y][1];t.mergeNodeData(y,{x:k.x+R,y:k.y+I})}}return p},t}(),Vr={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Br=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=n(n({},Vr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===e.options.dimensions?t.data.z:void 0})})),n},t.prototype.genericFruchtermanLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,f,g,p,v,y,m,w,x,E,b=this;return a(this,(function(a){return this.running?[2]:(o=this.formatOptions(r),i=o.dimensions,s=o.width,u=o.height,h=o.center,d=o.clustering,l=o.nodeClusterBy,f=o.maxIteration,g=o.onTick,p=e.getAllNodes(),v=e.getAllEdges(),(null==p?void 0:p.length)?1===p.length?(t&&e.mergeNodeData(p[0].id,{x:h[0],y:h[1],z:3===i?h[2]:void 0}),y={nodes:[n(n({},p[0]),{data:n(n({},p[0].data),{x:h[0],y:h[1],z:3===i?h[2]:void 0})})],edges:v},this.lastResult=y,[2,y]):(m=p.map((function(t){return N(t,[s,u])})),w=new c({nodes:m,edges:v}),x={},d&&m.forEach((function(t){var e=t.data[l];x[e]||(x[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=m,this.lastLayoutEdges=v,this.lastAssign=t,this.lastGraph=w,this.lastOptions=o,this.lastClusterMap=x,"undefined"==typeof window?[2]:(E=0,[2,new Promise((function(r){b.timeInterval=window.setInterval((function(){b.running?(b.runOneStep(w,x,o),t&&m.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y,z:3===i?n.z:void 0})})),null==g||g({nodes:m,edges:v}),++E>=f&&(window.clearInterval(b.timeInterval),r({nodes:m,edges:v}))):r({nodes:m,edges:v})}),0),b.running=!0}))])):(y={nodes:[],edges:v},this.lastResult=y,[2,y]))}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=n(n({},this.options),t),r=e.clustering,o=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=r&&!!o,e},t.prototype.runOneStep=function(t,e,r){var n=r.dimensions,o=r.height,i=r.width,a=r.gravity,s=r.center,u=r.speed,h=r.clustering,d=r.nodeClusterBy,l=r.clusterGravity,c=o*i,f=Math.sqrt(c)/10,g=t.getAllNodes(),p=c/(g.length+1),v=Math.sqrt(p),y={};if(this.applyCalculate(t,y,v,p),h){for(var m in e)e[m].cx=0,e[m].cy=0,e[m].count=0;for(var m in g.forEach((function(t){var r=t.data,n=e[r[d]];x(r.x)&&(n.cx+=r.x),x(r.y)&&(n.cy+=r.y),n.count++})),e)e[m].cx/=e[m].count,e[m].cy/=e[m].count;var w=l||a;g.forEach((function(t,r){var n=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=e[o[d]],a=Math.sqrt((o.x-i.cx)*(o.x-i.cx)+(o.y-i.cy)*(o.y-i.cy)),s=v*w;y[n].x-=s*(o.x-i.cx)/a,y[n].y-=s*(o.y-i.cy)/a}}))}g.forEach((function(t,e){var r=t.id,o=t.data;if(x(o.x)&&x(o.y)){var i=.01*v*a;y[r].x-=i*(o.x-s[0]),y[r].y-=i*(o.y-s[1]),3===n&&(y[r].z-=i*(o.z-s[2]))}})),g.forEach((function(e,r){var o=e.id,i=e.data;if(x(i.fx)&&x(i.fy))return i.x=i.fx,i.y=i.fy,void(3===n&&(i.z=i.fz));if(x(i.x)&&x(i.y)){var a=Math.sqrt(y[o].x*y[o].x+y[o].y*y[o].y+(3===n?y[o].z*y[o].z:0));if(a>0){var s=Math.min(f*(u/800),a);t.mergeNodeData(o,{x:i.x+y[o].x/a*s,y:i.y+y[o].y/a*s,z:3===n?i.z+y[o].z/a*s:void 0})}}}))},t.prototype.applyCalculate=function(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)},t.prototype.calRepulsive=function(t,e,r){var n=this,o=t.getAllNodes();o.forEach((function(t,i){var a=t.data,s=t.id;e[s]={x:0,y:0,z:0},o.forEach((function(t,o){var u=t.data,h=t.id;if(!(i<=o)&&x(a.x)&&x(u.x)&&x(a.y)&&x(u.y)){var d=a.x-u.x,l=a.y-u.y,c=3===n.options.dimensions?a.z-u.z:0,f=d*d+l*l+c*c;0===f&&(f=1,d=.01,l=.01,c=.01);var g=r/f,p=d*g,v=l*g,y=c*g;e[s].x+=p,e[s].y+=v,e[h].x-=p,e[h].y-=v,3===n.options.dimensions&&(e[s].z+=y,e[h].z-=y)}}))}))},t.prototype.calAttractive=function(t,e,r){var n=this;t.getAllEdges().forEach((function(o){var i=o.source,a=o.target;if(i&&a&&i!==a){var s=t.getNode(i).data,u=t.getNode(a).data;if(x(u.x)&&x(s.x)&&x(u.y)&&x(s.y)){var h=u.x-s.x,d=u.y-s.y,l=3===n.options.dimensions?u.z-s.z:0,c=Math.sqrt(h*h+d*d+l*l)/r,f=h*c,g=d*c,p=l*c;e[i].x+=f,e[i].y+=g,e[a].x-=f,e[a].y-=g,3===n.options.dimensions&&(e[i].z+=p,e[a].z-=p)}}}))},t}(),Gr={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},Wr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="grid",this.options=n(n({},Gr),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericGridLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericGridLayout(!0,t,e),[2]}))}))},t.prototype.genericGridLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,p,v,y,m,w,E,b,M,A,z,R,I,D,P,T,C,q,L,j,F,V,B,G,W,$,U,H,K;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.begin,s=void 0===i?[0,0]:i,u=o.condense,h=o.preventOverlapPadding,d=o.preventOverlap,l=o.rows,c=o.cols,f=o.nodeSpacing,p=o.nodeSize,v=o.width,y=o.height,m=o.position,w=o.sortBy,E=e.getAllNodes(),b=e.getAllEdges(),!(M=null==E?void 0:E.length)||1===M)return[2,_(e,t,s)];if(A=E.map((function(t){return N(t)})),"id"===w||O(w)&&void 0!==A[0].data[w]||(w="degree"),"degree"===w?A.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):"id"===w?A.sort((function(t,e){return x(e.id)&&x(t.id)?e.id-t.id:(""+t.id).localeCompare(""+e.id)})):A.sort((function(t,e){return e.data[w]-t.data[w]})),z=v||"undefined"==typeof window?v:window.innerWidth,R=y||"undefined"==typeof window?y:window.innerHeight,I=M,D={rows:l,cols:c},null!=l&&null!=c?(D.rows=l,D.cols=c):null!=l&&null==c?(D.rows=l,D.cols=Math.ceil(I/D.rows)):null==l&&null!=c?(D.cols=c,D.rows=Math.ceil(I/D.cols)):(P=Math.sqrt(I*R/z),D.rows=Math.round(P),D.cols=Math.round(z/R*P)),D.rows=Math.max(D.rows,1),D.cols=Math.max(D.cols,1),D.cols*D.rows>I)T=$r(D),C=Ur(D),(T-1)*C>=I?$r(D,T-1):(C-1)*T>=I&&Ur(D,C-1);else for(;D.cols*D.rows<I;)T=$r(D),((C=Ur(D))+1)*T>=I?Ur(D,C+1):$r(D,T+1);for(q=u?0:z/D.cols,L=u?0:R/D.rows,(d||f)&&(j=S(10,f),F=k(30,p,!1),A.forEach((function(t){t.data.x&&t.data.y||(t.data.x=0,t.data.y=0);var r,n,o=e.getNode(t.id),i=F(o)||30;g(i)?(r=i[0],n=i[1]):(r=i,n=i);var a=void 0!==j?j(t):h,s=r+a,u=n+a;q=Math.max(q,s),L=Math.max(L,u)}))),V={},B={row:0,col:0},G={},W=0;W<A.length;W++){if($=A[W],U=void 0,m&&(U=m(e.getNode($.id))),U&&(void 0!==U.row||void 0!==U.col)){if(void 0===(H={row:U.row,col:U.col}).col)for(H.col=0;Hr(V,H);)H.col++;else if(void 0===H.row)for(H.row=0;Hr(V,H);)H.row++;G[$.id]=H,Kr(V,H)}Jr($,s,q,L,G,D,B,V)}return K={nodes:A,edges:b},t&&A.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,K]}))}))},t}(),$r=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.min(n,o):Math.min(n,o)===t.rows?t.rows=e:t.cols=e,r},Ur=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.max(n,o):Math.max(n,o)===t.rows?t.rows=e:t.cols=e,r},Hr=function(t,e){return t["c-"+e.row+"-"+e.col]||!1},Kr=function(t,e){return t["c-"+e.row+"-"+e.col]=!0},Yr=function(t,e){var r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},Jr=function(t,e,r,n,o,i,a,s){var u,h,d=o[t.id];if(d)u=d.col*r+r/2+e[0],h=d.row*n+n/2+e[1];else{for(;Hr(s,a);)Yr(i,a);u=a.col*r+r/2+e[0],h=a.row*n+n/2+e[1],Kr(s,a),Yr(i,a)}t.data.x=u,t.data.y=h};const Xr=Object.prototype.toString;function Qr(t){const e=Xr.call(t);return e.endsWith("Array]")&&!e.includes("Big")}function Zr(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!Qr(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]<a&&(a=t[s]);return a}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Qr(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]>a&&(a=t[s]);return a}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,a=void 0===i?r.autoMinMax?n:0:i,s=r.max,u=void 0===s?r.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var h=(u-a)/(o-n),d=0;d<t.length;d++)e[d]=(t[d]-n)*h+a;return e}const tn=" ".repeat(2),en=" ".repeat(4);function rn(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=e;return`${t.constructor.name} {\\n${tn}[\\n${en}${function(t,e,r,n,o){const{rows:i,columns:a}=t,s=Math.min(i,e),u=Math.min(a,r),h=[];if("auto"===o){o=!1;t:for(let e=0;e<s;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let e=0;e<s;e++){let r=[];for(let i=0;i<u;i++)r.push(nn(t.get(e,i),n,o));h.push(`${r.join(" ")}`)}return u!==a&&(h[h.length-1]+=` ... ${a-r} more columns`),s!==i&&h.push(`... ${i-e} more rows`),h.join(`\\n${en}`)}(t,r,n,o,i)}\\n${tn}]\\n${tn}rows: ${t.rows}\\n${tn}columns: ${t.columns}\\n}`}function nn(t,e,r){return(t>=0&&r?` ${on(t,e-1)}`:on(t,e)).padEnd(e)}function on(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function an(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function sn(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function un(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function hn(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function dn(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(cn("startRow",e),cn("endRow",r),cn("startColumn",n),cn("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function ln(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function cn(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function fn(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class gn{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new vn(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new vn(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new vn(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new vn(t,e)}static ones(t,e){return new vn(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new vn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)o.set(r,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let a=o-n,s=new vn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(i()*a);s.set(r,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let t=0;t<n;t++)o.set(t,t,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let e=0;e<o;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new vn(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return gn.isMatrix(t)?t:new vn(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let a=o;a<e;a++){let e=t.get(r,a)-i*t.get(n,a);t.set(r,a,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new vn(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){an(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return vn.rowVector(this.getRow(t))}setRow(t,e){an(this,t),e=un(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){an(this,t),an(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){sn(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return vn.columnVector(this.getColumn(t))}setColumn(t,e){sn(this,t),e=hn(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){sn(this,t),sn(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=un(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=hn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){an(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){sn(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){fn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){fn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(an(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){an(this,t),fn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(an(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){an(this,t),fn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(sn(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){sn(this,t),fn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(sn(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){sn(this,t),fn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){gn.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=vn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new vn(e,n),i=new Float64Array(r);for(let a=0;a<n;a++){for(let e=0;e<r;e++)i[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,a,e)}}return o}strassen2x2(t){t=vn.checkMatrix(t);let e=new vn(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),h=t.get(1,1),d=(r+u)*(n+h),l=(a+u)*n,c=r*(i-h),f=u*(s-n),g=(r+o)*h,p=d+f-g+(o-u)*(s+h),v=c+g,y=l+f,m=d-l+c+(a-r)*(n+i);return e.set(0,0,p),e.set(0,1,v),e.set(1,0,y),e.set(1,1,m),e}strassen3x3(t){t=vn.checkMatrix(t);let e=new vn(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),h=this.get(2,1),d=this.get(2,2),l=t.get(0,0),c=t.get(0,1),f=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),y=t.get(2,0),m=t.get(2,1),w=t.get(2,2),x=(r-i)*(-c+p),E=(-r+i+a)*(l-c+p),N=(i+a)*(-l+c),b=r*l,M=(-r+u+h)*(l-f+v),S=(-r+u)*(f-v),k=(u+h)*(-l+f),A=(-o+h+d)*(p+y-m),_=(o-d)*(p-m),z=o*y,R=(h+d)*(-y+m),I=(-o+a+s)*(v+y-w),D=(o-s)*(v-w),O=(a+s)*(-y+w),P=b+z+n*g,T=(r+n+o-i-a-h-d)*p+E+N+b+A+z+R,C=b+M+k+(r+n+o-a-s-u-h)*v+z+I+O,q=x+a*(-l+c+g-p-v-y+w)+E+b+z+I+D,L=x+E+N+b+s*m,j=z+I+D+O+i*f,F=b+M+S+h*(-l+f+g-p-v-y+m)+A+_+z,V=A+_+z+R+u*c,B=b+M+S+k+d*w;return e.set(0,0,P),e.set(0,1,T),e.set(0,2,C),e.set(1,0,q),e.set(1,1,L),e.set(1,2,j),e.set(2,0,F),e.set(2,1,V),e.set(2,2,B),e}mmulStrassen(t){t=vn.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function a(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=gn.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${r} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let s=Math.max(r,o),u=Math.max(n,i);return e=a(e,s,u),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=a(e,n+1,o+1),r=a(r,n+1,o+1)):n%2==1?(e=a(e,n+1,o),r=a(r,n+1,o)):o%2==1&&(e=a(e,n,o+1),r=a(r,n,o+1));let i=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,s-1),h=r.subMatrix(0,i-1,0,s-1),d=e.subMatrix(0,i-1,s,e.columns-1),l=r.subMatrix(0,i-1,s,r.columns-1),c=e.subMatrix(i,e.rows-1,0,s-1),f=r.subMatrix(i,r.rows-1,0,s-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),p=r.subMatrix(i,r.rows-1,s,r.columns-1),v=t(gn.add(u,g),gn.add(h,p),i,s),y=t(gn.add(c,g),h,i,s),m=t(u,gn.sub(l,p),i,s),w=t(g,gn.sub(f,h),i,s),x=t(gn.add(u,d),p,i,s),E=t(gn.sub(c,u),gn.add(h,l),i,s),N=t(gn.sub(d,g),gn.add(f,p),i,s),b=gn.add(v,w);b.sub(x),b.add(N);let M=gn.add(m,x),S=gn.add(y,w),k=gn.sub(v,y);k.add(m),k.add(E);let A=gn.zeros(2*b.rows,2*b.columns);return A=A.setSubMatrix(b,0,0),A=A.setSubMatrix(M,b.rows,0),A=A.setSubMatrix(S,0,b.columns),A=A.setSubMatrix(k,b.rows,b.columns),A.subMatrix(0,n-1,0,o-1)}(e,t=a(t,s,u),s,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new vn(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&Zr(o,{min:e,max:r,output:o}),n.setRow(t,o)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new vn(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&Zr(o,{min:e,max:r,output:o}),n.setColumn(t,o)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=vn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new vn(e*n,r*o);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<o;s++)i.set(n*a+r,o*e+s,this.get(a,e)*t.get(r,s));return i}kroneckerSum(t){if(t=vn.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(vn.eye(r,r)),o=vn.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new vn(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=pn){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=pn){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){dn(this,t,e,r,n);let o=new vn(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new vn(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new vn(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=vn.checkMatrix(t)).isEmpty())return this;dn(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){!function(t,e){if(!Qr(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!Qr(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new vn(t.length,e.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<e.length;t++){let i=e[t];r.set(n,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new vn(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=ln(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=ln(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=ln(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=ln(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Qr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<n;a++){let n=0,s=0,u=0;for(let e=0;e<o;e++)u=t.get(a,e)-r[a],n+=u,s+=u*u;e?i.push((s-n*n/o)/(o-1)):i.push((s-n*n/o)/o)}return i}(this,r,n);case"column":if(!Qr(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<o;a++){let o=0,s=0,u=0;for(let e=0;e<n;e++)u=t.get(e,a)-r[a],o+=u,s+=u*u;e?i.push((s-o*o/n)/(n-1)):i.push((s-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let a=0,s=0,u=0;for(let e=0;e<n;e++)for(let n=0;n<o;n++)u=t.get(e,n)-r,a+=u,s+=u*u;return e?(s-a*a/i)/(i-1):(s-a*a/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Qr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!Qr(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!Qr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!Qr(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return rn(this,t)}}function pn(t,e){return t-e}gn.prototype.klass="Matrix","undefined"!=typeof Symbol&&(gn.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return rn(this)}),gn.random=gn.rand,gn.randomInt=gn.randInt,gn.diagonal=gn.diag,gn.prototype.diagonal=gn.prototype.diag,gn.identity=gn.eye,gn.prototype.negate=gn.prototype.neg,gn.prototype.tensorProduct=gn.prototype.kroneckerProduct;class vn extends gn{constructor(t,e){if(super(),vn.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Qr(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!r[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return an(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),an(this,t,!0),e=Float64Array.from(un(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){sn(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),sn(this,t,!0),e=hn(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(gn,vn);class yn extends gn{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function mn(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class wn{constructor(t,e={}){if((t=yn.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=e;let s,u=Boolean(o),h=Boolean(i),d=!1;if(r<n)if(a){s=t.transpose(),r=s.rows,n=s.columns,d=!0;let e=u;u=h,h=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let l=Math.min(r,n),c=Math.min(r+1,n),f=new Float64Array(c),g=new vn(r,l),p=new vn(n,n),v=new Float64Array(n),y=new Float64Array(r),m=new Float64Array(c);for(let t=0;t<c;t++)m[t]=t;let w=Math.min(r-1,n),x=Math.max(0,Math.min(n-2,r)),E=Math.max(w,x);for(let t=0;t<E;t++){if(t<w){f[t]=0;for(let e=t;e<r;e++)f[t]=mn(f[t],s.get(e,t));if(0!==f[t]){s.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<r;e++)s.set(e,t,s.get(e,t)/f[t]);s.set(t,t,s.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<n;e++){if(t<w&&0!==f[t]){let n=0;for(let o=t;o<r;o++)n+=s.get(o,t)*s.get(o,e);n=-n/s.get(t,t);for(let o=t;o<r;o++)s.set(o,e,s.get(o,e)+n*s.get(o,t))}v[e]=s.get(t,e)}if(u&&t<w)for(let e=t;e<r;e++)g.set(e,t,s.get(e,t));if(t<x){v[t]=0;for(let e=t+1;e<n;e++)v[t]=mn(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<n;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<r&&0!==v[t]){for(let e=t+1;e<r;e++)y[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)y[e]+=v[r]*s.get(e,r);for(let e=t+1;e<n;e++){let n=-v[e]/v[t+1];for(let o=t+1;o<r;o++)s.set(o,e,s.get(o,e)+n*y[o])}}if(h)for(let e=t+1;e<n;e++)p.set(e,t,v[e])}}let N=Math.min(n,r+1);if(w<n&&(f[w]=s.get(w,w)),r<N&&(f[N-1]=0),x+1<N&&(v[x]=s.get(x,N-1)),v[N-1]=0,u){for(let t=w;t<l;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<l;e++){let n=0;for(let o=t;o<r;o++)n+=g.get(o,t)*g.get(o,e);n=-n/g.get(t,t);for(let o=t;o<r;o++)g.set(o,e,g.get(o,e)+n*g.get(o,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(h)for(let t=n-1;t>=0;t--){if(t<x&&0!==v[t])for(let e=t+1;e<n;e++){let r=0;for(let o=t+1;o<n;o++)r+=p.get(o,t)*p.get(o,e);r=-r/p.get(t+1,t);for(let o=t+1;o<n;o++)p.set(o,e,p.get(o,e)+r*p.get(o,t))}for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}let b=N-1,M=0,S=Number.EPSILON;for(;N>0;){let t,e;for(t=N-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===N-2)e=4;else{let r;for(r=N-1;r>=t&&r!==t;r--){let e=(r!==N?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(f[r])<=S*e){f[r]=0;break}}r===t?e=3:r===N-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[N-2];v[N-2]=0;for(let r=N-2;r>=t;r--){let o=mn(f[r],e),i=f[r]/o,a=e/o;if(f[r]=o,r!==t&&(e=-a*v[r-1],v[r-1]=i*v[r-1]),h)for(let t=0;t<n;t++)o=i*p.get(t,r)+a*p.get(t,N-1),p.set(t,N-1,-a*p.get(t,r)+i*p.get(t,N-1)),p.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<N;n++){let o=mn(f[n],e),i=f[n]/o,a=e/o;if(f[n]=o,e=-a*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g.get(e,n)+a*g.get(e,t-1),g.set(e,t-1,-a*g.get(e,n)+i*g.get(e,t-1)),g.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(f[N-1]),Math.abs(f[N-2]),Math.abs(v[N-2]),Math.abs(f[t]),Math.abs(v[t])),o=f[N-1]/e,i=f[N-2]/e,a=v[N-2]/e,s=f[t]/e,d=v[t]/e,l=((i+o)*(i-o)+a*a)/2,c=o*a*(o*a);let y=0;0===l&&0===c||(y=l<0?0-Math.sqrt(l*l+c):Math.sqrt(l*l+c),y=c/(l+y));let m=(s+o)*(s-o)+y,w=s*d;for(let e=t;e<N-1;e++){let o=mn(m,w);0===o&&(o=Number.MIN_VALUE);let i=m/o,a=w/o;if(e!==t&&(v[e-1]=o),m=i*f[e]+a*v[e],v[e]=i*v[e]-a*f[e],w=a*f[e+1],f[e+1]=i*f[e+1],h)for(let t=0;t<n;t++)o=i*p.get(t,e)+a*p.get(t,e+1),p.set(t,e+1,-a*p.get(t,e)+i*p.get(t,e+1)),p.set(t,e,o);if(o=mn(m,w),0===o&&(o=Number.MIN_VALUE),i=m/o,a=w/o,f[e]=o,m=i*v[e]+a*f[e+1],f[e+1]=-a*v[e]+i*f[e+1],w=a*v[e+1],v[e+1]=i*v[e+1],u&&e<r-1)for(let t=0;t<r;t++)o=i*g.get(t,e)+a*g.get(t,e+1),g.set(t,e+1,-a*g.get(t,e)+i*g.get(t,e+1)),g.set(t,e,o)}v[N-2]=m,M+=1;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,h))for(let e=0;e<=b;e++)p.set(e,t,-p.get(e,t));for(;t<b&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,h&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}M=0,N--}}if(d){let t=p;p=g,g=t}this.m=r,this.n=n,this.s=f,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,o=vn.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?o.set(t,t,0):o.set(t,t,1/this.s[t]);let i=this.U,a=this.rightSingularVectors,s=a.mmul(o),u=a.rows,h=i.rows,d=vn.zeros(u,h);for(let t=0;t<u;t++)for(let e=0;e<h;e++){let r=0;for(let o=0;o<n;o++)r+=s.get(t,o)*i.get(e,o);d.set(t,e,r)}return d.mmul(e)}solveForDiagonal(t){return this.solve(vn.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new vn(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,a=i.rows,s=i.columns,u=new vn(r,a);for(let t=0;t<r;t++)for(let e=0;e<a;e++){let r=0;for(let n=0;n<s;n++)r+=o.get(t,n)*i.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return vn.diag(this.s)}}var xn,En={center:[0,0],linkDistance:50},Nn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="mds",this.options=n(n({},En),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericMDSLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericMDSLayout(!0,t,e),[2]}))}))},t.prototype.genericMDSLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f,g,y;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=void 0===i?[0,0]:i,u=o.linkDistance,h=void 0===u?50:u,d=e.getAllNodes(),l=e.getAllEdges(),(null==d?void 0:d.length)&&1!==d.length?(c=v({nodes:d,edges:l},!1),f=p(c),bn(f),m=h,w=[],f.forEach((function(t){var e=[];t.forEach((function(t){e.push(t*m)})),w.push(e)})),g=Mn(w),y=[],g.forEach((function(t,e){var r=N(d[e]);r.data.x=t[0]+s[0],r.data.y=t[1]+s[1],y.push(r)})),t&&y.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:y,edges:l}]):[2,_(e,t,s)];var m,w}))}))},t}(),bn=function(t){var e=-999999;t.forEach((function(t){t.forEach((function(t){t!==1/0&&e<t&&(e=t)}))})),t.forEach((function(r,n){r.forEach((function(r,o){r===1/0&&(t[n][o]=e)}))}))},Mn=function(t){var e=vn.mul(vn.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),o=e.mean();e.add(o).subRowVector(r).subColumnVector(n);var i=new wn(e),a=vn.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((function(t){return vn.mul([t],[a]).toJSON()[0].splice(0,2)}))},Sn={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},kn=function(t,e,r,n,o,i){e.forEach((function(a,s){r[s]={x:0,y:0},e.forEach((function(e,u){if(s!==u&&o[s]===o[u]){var h=a.x-e.x,d=a.y-e.y,l=Math.sqrt(h*h+d*d);if(0===l){l=1;var c=s>u?1:-1;h=.01*c,d=.01*c}if(l<i(t[s])/2+i(t[u])/2){var f=n*n/l;r[s].x+=h/l*f,r[s].y+=d/l*f}}}))}))},An=function(t,e,r,n,o,i,a,s){var u=i||a/10;return n&&e.forEach((function(e,r){var n=t[r].x-t[o].x,i=t[r].y-t[o].y,a=Math.sqrt(n*n+i*i),s=i/a,u=-n/a,h=Math.sqrt(e.x*e.x+e.y*e.y),d=Math.acos((s*e.x+u*e.y)/h);d>Math.PI/2&&(d-=Math.PI/2,s*=-1,u*=-1);var l=Math.cos(d)*h;e.x=s*l,e.y=u*l})),t.forEach((function(i,a){if(a!==o){var h=Math.sqrt(e[a].x*e[a].x+e[a].y*e[a].y);if(h>0&&a!==o){var d=Math.min(u*(r/800),h);if(i.x+=e[a].x/h*d,i.y+=e[a].y/h*d,n){var l=i.x-t[o].x,c=i.y-t[o].y,f=Math.sqrt(l*l+c*c);l=l/f*s[a],c=c/f*s[a],i.x=t[o].x+l,i.y=t[o].y+c}}}})),t},_n={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},zn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="radial",this.options=n(n({},_n),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRadialLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRadialLayout(!0,t,e),[2]}))}))},t.prototype.genericRadialLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,h,d,l,c,f,g,y,m,w,x,E,b,M,S,k,z,R,I,D,P,T,C,q,L,j,F,V,B,G,W,$,U,H,K,Y,J,X,Q,Z,tt,et;return a(this,(function(a){if(o=n(n({},this.options),r),i=o.width,h=o.height,d=o.center,l=o.focusNode,c=o.unitRadius,f=o.nodeSize,g=o.nodeSpacing,y=o.strictRadial,m=o.preventOverlap,w=o.maxPreventOverlapIteration,x=o.sortBy,E=o.linkDistance,b=void 0===E?50:E,M=o.sortStrength,S=void 0===M?10:M,k=o.maxIteration,z=void 0===k?1e3:k,R=e.getAllNodes(),I=e.getAllEdges(),D=i||"undefined"==typeof window?i:window.innerWidth,P=h||"undefined"==typeof window?h:window.innerHeight,T=d||[D/2,P/2],!(null==R?void 0:R.length)||1===R.length)return[2,_(e,t,T)];if(C=R[0],O(l)){for(q=0;q<R.length;q++)if(R[q].id===l){C=R[q];break}}else C=l||R[0];return L=Dn(R,C.id),j=v({nodes:R,edges:I},!1),F=p(j),V=Pn(F,L),On(F,L,V+1),B=F[L],G=D-T[0]>T[0]?T[0]:D-T[0],W=P-T[1]>T[1]?T[1]:P-T[1],0===G&&(G=D/2),0===W&&(W=P/2),$=Math.min(G,W),U=Math.max.apply(Math,u([],s(B))),H=[],K=c||$/U,B.forEach((function(t,e){H[e]=t*K})),Y=Rn(R,F,b,H,K,x,S),J=In(Y),X=function(t,e,r){try{var n=vn.mul(vn.pow(e,2),-.5),o=n.mean("row"),i=n.mean("column"),a=n.mean();n.add(a).subRowVector(o).subColumnVector(i);var s=new wn(n),u=vn.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((function(e){return vn.mul([e],[u]).toJSON()[0].splice(0,t)}))}catch(t){for(var h=[],d=0;d<e.length;d++){var l=Math.random()*r,c=Math.random()*r;h.push([l,c])}return h}}(b,Y,b),Q=X.map((function(t){var e=s(t,2),r=e[0],n=e[1];return{x:(isNaN(r)?Math.random()*b:r)-X[L][0],y:(isNaN(n)?Math.random()*b:n)-X[L][1]}})),this.run(z,Q,J,Y,H,L),m&&(Z=A(f,g),tt={nodes:R,nodeSizeFunc:Z,positions:Q,radii:H,height:P,width:D,strictRadial:Boolean(y),focusIdx:L,iterations:w||200,k:Q.length/4.5},Q=function(t,e){for(var r=n(n({},Sn),e),o=r.positions,i=r.iterations,a=r.width,s=r.k,u=r.speed,h=void 0===u?100:u,d=r.strictRadial,l=r.focusIdx,c=r.radii,f=void 0===c?[]:c,g=r.nodeSizeFunc,p=t.getAllNodes(),v=[],y=a/10,m=0;m<i;m++)o.forEach((function(t,e){v[e]={x:0,y:0}})),kn(p,o,v,s,f,g),An(o,v,h,d,l,y,a,f);return o}(e,tt)),et=[],Q.forEach((function(t,e){var r=N(R[e]);r.data.x=t.x+T[0],r.data.y=t.y+T[1],et.push(r)})),t&&et.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:et,edges:I}]}))}))},t.prototype.run=function(t,e,r,n,o,i){for(var a=0;a<=t;a++){var s=a/t;this.oneIteration(s,e,o,n,r,i)}},t.prototype.oneIteration=function(t,e,r,n,o,i){var a=1-t;e.forEach((function(s,u){var h=y(s,{x:0,y:0}),d=0===h?0:1/h;if(u!==i){var l=0,c=0,f=0;e.forEach((function(t,e){if(u!==e){var r=y(s,t),i=0===r?0:1/r,a=n[e][u];f+=o[u][e],l+=o[u][e]*(t.x+a*(s.x-t.x)*i),c+=o[u][e]*(t.y+a*(s.y-t.y)*i)}}));var g=0===r[u]?0:1/r[u];f*=a,f+=t*g*g,l*=a,l+=t*g*s.x*d,s.x=l/f,c*=a,c+=t*g*s.y*d,s.y=c/f}}))},t}(),Rn=function(t,e,r,n,o,i,a){if(!t)return[];var s=[];if(e){var u={};e.forEach((function(e,h){var d=[];e.forEach((function(e,s){var l,c;if(h===s)d.push(0);else if(n[h]===n[s])if("data"===i)d.push(e*(Math.abs(h-s)*a)/(n[h]/o));else if(i){var f=void 0,g=void 0;if(u[t[h].id])f=u[t[h].id];else{var p=("id"===i?t[h].id:null===(l=t[h].data)||void 0===l?void 0:l[i])||0;f=O(p)?p.charCodeAt(0):p,u[t[h].id]=f}u[t[s].id]?g=u[t[s].id]:(p=("id"===i?t[s].id:null===(c=t[s].data)||void 0===c?void 0:c[i])||0,g=O(p)?p.charCodeAt(0):p,u[t[s].id]=g),d.push(e*(Math.abs(f-g)*a)/(n[h]/o))}else d.push(e*r/(n[h]/o));else{var v=(r+o)/2;d.push(e*v)}})),s.push(d)}))}return s},In=function(t){for(var e=t.length,r=t[0].length,n=[],o=0;o<e;o++){for(var i=[],a=0;a<r;a++)0!==t[o][a]?i.push(1/(t[o][a]*t[o][a])):i.push(0);n.push(i)}return n},Dn=function(t,e){var r=-1;return t.forEach((function(t,n){t.id===e&&(r=n)})),Math.max(r,0)},On=function(t,e,r){for(var n=t.length,o=0;o<n;o++)if(t[e][o]===1/0){t[e][o]=r,t[o][e]=r;for(var i=0;i<n;i++)t[o][i]!==1/0&&t[e][i]===1/0&&(t[e][i]=r+t[o][i],t[i][e]=r+t[o][i])}for(o=0;o<n;o++)if(o!==e)for(i=0;i<n;i++)if(t[o][i]===1/0){var a=Math.abs(t[e][o]-t[e][i]);a=0===a?1:a,t[o][i]=a}},Pn=function(t,e){for(var r=0,n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r},Tn={center:[0,0],width:300,height:300},Cn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="random",this.options=n(n({},Tn),t)}return t.prototype.execute=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.genericRandomLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(r){return this.genericRandomLayout(!0,t,e),[2]}))}))},t.prototype.genericRandomLayout=function(t,e,r){return i(this,void 0,void 0,(function(){var o,i,s,u,h,d,l,c,f;return a(this,(function(a){return o=n(n({},this.options),r),i=o.center,s=o.width,u=o.height,h=e.getAllNodes(),d=s||"undefined"==typeof window?s:window.innerWidth,l=u||"undefined"==typeof window?u:window.innerHeight,c=i||[d/2,l/2],f=[],h&&h.forEach((function(t){f.push({id:t.id,data:{x:.9*(Math.random()-.5)*d+c[0],y:.9*(Math.random()-.5)*l+c[1]}})})),t&&f.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:f,edges:e.getAllEdges()}]}))}))},t}(),qn={circular:R,concentric:T,mds:Nn,random:Cn,grid:Wr,radial:zn,force:zr,d3force:Tt,fruchterman:Br,forceAtlas2:Fr,dagre:pr};function Ln(){var t;(null===(t=xn)||void 0===t?void 0:t.stop)&&xn.stop()}function jn(t,e){return i(this,void 0,void 0,(function(){var r,n,o,i,s,u,h,d,l;return a(this,(function(a){switch(a.label){case 0:if(r=t.layout,n=r.id,o=r.options,i=r.iterations,s=t.nodes,u=t.edges,h=new c({nodes:s,edges:u}),!(d=qn[n]))throw new Error("Unknown layout id: "+n);return[4,(xn=new d(o)).execute(h)];case 1:return l=a.sent(),!!(f=xn).tick&&!!f.stop&&(xn.stop(),l=xn.tick(i)),[2,[l,e]]}var f}))}))}addEventListener("message",(function(t){var r,n=t.data,o=n.type,i=n.method,a=n.id,s=n.params;"RPC"===o&&i&&((r=e[i])?Promise.resolve().then((function(){return r.apply(e,s)})):Promise.reject("No such method")).then((function(t){postMessage({type:"RPC",id:a,result:t})})).catch((function(t){var e={message:t};t.stack&&(e.message=t.message,e.stack=t.stack,e.name=t.name),postMessage({type:"RPC",id:a,error:e})}))})),postMessage({type:"RPC",method:"ready"});\n//# sourceMappingURL=5e37927bd3e57252658c.worker.js.map']))),n(t,o),t}},331:t=>{t.exports=function(t,e){var r=0,n={};t.addEventListener("message",(function(e){var r=e.data;if("RPC"===r.type)if(r.id){var o=n[r.id];o&&(delete n[r.id],r.error?o[1](Object.assign(Error(r.error.message),r.error)):o[0](r.result))}else{var i=document.createEvent("Event");i.initEvent(r.method,!1,!1),i.data=r.params,t.dispatchEvent(i)}})),e.forEach((function(e){t[e]=function(){var o=arguments;return new Promise((function(i,a){var s=++r;n[s]=[i,a],t.postMessage({type:"RPC",id:s,method:e,params:[].slice.call(o)})}))}}))}}},S={};function k(t){var e=S[t];if(void 0!==e)return e.exports;var r=S[t]={exports:{}};return M[t](r,r.exports,k),r.exports}k.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return k.d(e,{a:e}),e},k.d=(t,e)=>{for(var r in e)k.o(e,r)&&!k.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},k.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var A={};(()=>{k.d(A,{SB:()=>j,W1:()=>K,jA:()=>Ht,Vq:()=>Nr,E9:()=>Ur,y7:()=>Pr,O2:()=>Yr,Me:()=>Qr,AI:()=>An,D4:()=>Tn,_5:()=>Vn,y9:()=>U,_A:()=>l,d9:()=>R,ul:()=>D,qs:()=>y,gl:()=>C,jE:()=>T,tO:()=>P,zJ:()=>m,h$:()=>b,BI:()=>_,$y:()=>z,H0:()=>N,kJ:()=>c,hY:()=>Bn,qR:()=>Gn,i_:()=>Wn,nu:()=>w,He:()=>f,A3:()=>E});var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};function e(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function n(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function o(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function i(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function a(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function s(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}Object.create,Object.create;var u,h,d=/-(\w)/g,l=(u=function(t){return t.replace(d,(function(t,e){return e?e.toUpperCase():""}))},h=Object.create(null),function(t){return h[t]||(h[t]=u(t))}),c=Array.isArray,f=function(t){var e=parseFloat(t);return isNaN(e)?t:e},g={}.toString;const p=function(t,e){return g.call(t)==="[object "+e+"]"},v=function(t){return p(t,"Number")};var y=function(t){for(var e=[],r=t.length,n=0;n<r;n+=1){e[n]=[];for(var o=0;o<r;o+=1)n===o?e[n][o]=0:0!==t[n][o]&&t[n][o]?e[n][o]=t[n][o]:e[n][o]=1/0}for(var i=0;i<r;i+=1)for(n=0;n<r;n+=1)for(o=0;o<r;o+=1)e[n][o]>e[n][i]+e[i][o]&&(e[n][o]=e[n][i]+e[i][o]);return e},m=function(t,e){var r=t.nodes,n=t.edges,o=[],i={};if(!r)throw new Error("invalid nodes data!");return r&&r.forEach((function(t,e){i[t.id]=e,o.push([])})),null==n||n.forEach((function(t){var r=t.source,n=t.target,a=i[r],s=i[n];void 0!==a&&void 0!==s&&(o[a][s]=1,e||(o[s][a]=1))})),o},w=function(t,e){var r=[];return t.forEach((function(t){var n=[];t.forEach((function(t){n.push(t*e)})),r.push(n)})),r},x=function(t,e){if(t&&t.children)for(var r=t.children.length-1;r>=0;r--)if(!x(t.children[r],e))return;return!!e(t)},E=function(t,e){"function"==typeof e&&x(t,e)},N=function(t){var e=1/0,r=1/0,n=-1/0,o=-1/0;return t.forEach((function(t){var i=t.data.size;c(i)?1===i.length&&(i=[i[0],i[0]]):v(i)?i=[i,i]:(void 0===i||isNaN(i))&&(i=[30,30]);var a=[i[0]/2,i[1]/2],s=t.data.x-a[0],u=t.data.x+a[0],h=t.data.y-a[1],d=t.data.y+a[1];e>s&&(e=s),r>h&&(r=h),n<u&&(n=u),o<d&&(o=d)})),{minX:e,minY:r,maxX:n,maxY:o}},b=function(t){var e={x:0,y:0};t.forEach((function(t){e.x+=t.data.x||0,e.y+=t.data.y||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},M=function(t,e,r){var n,o;return"source"===t?(null===(n=null==r?void 0:r.find((function(t){return t.target===e.id})))||void 0===n?void 0:n.source)||{}:(null===(o=null==r?void 0:r.find((function(t){return t.source===e.id})))||void 0===o?void 0:o.target)||{}},S=function(t,e,r){var n=[];switch(t){case"source":n=null==r?void 0:r.filter((function(t){return t.source===e.id})).map((function(t){return t.target}));break;case"target":n=null==r?void 0:r.filter((function(t){return t.target===e.id})).map((function(t){return t.source}));break;case"both":n=null==r?void 0:r.filter((function(t){return t.source===e.id})).map((function(t){return t.target})).concat(null==r?void 0:r.filter((function(t){return t.target===e.id})).map((function(t){return t.source})))}var o=new Set(n);return Array.from(o)},_=function(t,e,r,n,o,i){var a=o[e.id],s=a.in,u=a.out,h=e,d=[];0===s?(h=M("source",e,r),d=S("both",h,r).map((function(t){return i[t]}))):0===u&&(h=M("target",e,r),d=S("both",h,r).map((function(t){return i[t]}))),d=d.filter((function(t){return o[t.id]&&(0===o[t.id].in||0===o[t.id].out)}));var l=function(t,e,r,n,o){var i=r[e]||"",a=(null==n?void 0:n.filter((function(t){return t[e]===i})))||[];return"leaf"===t&&(a=a.filter((function(t){var e,r;return 0===(null===(e=o[t.id])||void 0===e?void 0:e.in)||0===(null===(r=o[t.id])||void 0===r?void 0:r.out)}))),a}(t,n,e,d,o);return{coreNode:h,relativeLeafNodes:d,sameTypeLeafNodes:l}},z=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},R=function(t){if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var e=[];return t.forEach((function(t){e.push(t)})),e.map((function(t){return R(t)}))}if("object"==typeof t){var r={};return Object.keys(t).forEach((function(e){r[e]=R(t[e])})),r}return t},D=function(t,e){var r=R(t);return r.data=r.data||{},e&&(v(r.data.x)||(r.data.x=Math.random()*e[0]),v(r.data.y)||(r.data.y=Math.random()*e[1])),r};const I=function(t){return"function"==typeof t},O=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function T(t,e){return I(e)?e:v(e)?function(){return e}:function(){return t}}function P(t,e,r){return void 0===r&&(r=!0),e||0===e?I(e)?e:v(e)?function(){return e}:c(e)?function(){if(r){var n=Math.max.apply(Math,s([],a(e)));return isNaN(n)?t:n}return e}:O(e)?function(){if(r){var n=Math.max(e.width,e.height);return isNaN(n)?t:n}return[e.width,e.height]}:function(){return t}:function(e){var r=(e.data||{}).size;return r?c(r)?r[0]>r[1]?r[0]:r[1]:O(r)?r.width>r.height?r.width:r.height:r:t}}var C=function(t,e){var r;return r=v(e)?function(){return e}:I(e)?e:function(){return 0},t?c(t)?function(e){return(t[0]>t[1]?t[0]:t[1])+r(e)}:function(e){return t+r(e)}:function(t){var e,n;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return Math.max(t.data.bboxSize[0],t.data.bboxSize[1])+r(t);if(null===(n=t.data)||void 0===n?void 0:n.size){if(c(t.data.size))return Math.max(t.data.size[0],t.data.size[1])+r(t);var o=t.data.size;return O(o)?(o.width>o.height?o.width:o.height)+r(t):o+r(t)}return 10+r(t)}},L=function(t,e,n){var o=t.getAllNodes(),i=t.getAllEdges();return(null==o?void 0:o.length)?1===o.length?(e&&t.mergeNodeData(o[0].id,{x:n[0],y:n[1]}),{nodes:[r(r({},o[0]),{data:r(r({},o[0].data),{x:n[0],y:n[1]})})],edges:i}):void 0:{nodes:[],edges:i}},q={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},j=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="circular",this.options=r(r({},q),t)}return t.prototype.execute=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.genericCircularLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return[4,this.genericCircularLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericCircularLayout=function(t,e,n){return o(this,void 0,void 0,(function(){var o,s,u,h,d,l,c,f,g,p,v,y,m,w,x,E,N,b,M,S,k,A,_,z,R,I,O,C,q,j,W,G,B,$,U;return i(this,(function(i){if(o=r(r({},this.options),n),s=o.width,u=o.height,h=o.center,d=o.divisions,l=o.startAngle,c=void 0===l?0:l,f=o.endAngle,g=void 0===f?2*Math.PI:f,p=o.angleRatio,v=o.ordering,y=o.clockwise,m=o.nodeSpacing,w=o.nodeSize,x=e.getAllNodes(),E=e.getAllEdges(),N=a(V(s,u,h),3),b=N[0],M=N[1],S=N[2],!(k=null==x?void 0:x.length)||1===k)return[2,L(e,t,S)];for(A=(g-c)/k,_=o.radius,z=o.startRadius,R=o.endRadius,m?(I=T(10,m),O=P(10,w),C=-1/0,x.forEach((function(t){var e=O(t);C<e&&(C=e)})),q=0,x.forEach((function(t,e){q+=0===e?C||10:(I(t)||0)+(C||10)})),_=q/(2*Math.PI)):_||z||R?!z&&R?z=R:z&&!R&&(R=z):_=Math.min(M,b)/2,j=A*p,W=[],W="topology"===v?F(e,x):"topology-directed"===v?F(e,x,!0):"degree"===v?function(t,e){var r=[];return e.forEach((function(t,e){r.push(D(t))})),r.sort((function(e,r){return t.getDegree(e.id,"both")-t.getDegree(r.id,"both")})),r}(e,x):x.map((function(t){return D(t)})),G=Math.ceil(k/d),B=0;B<k;++B)($=_)||null===z||null===R||($=z+B*(R-z)/(k-1)),$||($=10+100*B/(k-1)),U=c+B%G*j+2*Math.PI/d*Math.floor(B/G),y||(U=g-B%G*j-2*Math.PI/d*Math.floor(B/G)),W[B].data.x=S[0]+Math.cos(U)*$,W[B].data.y=S[1]+Math.sin(U)*$;return t&&W.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:W,edges:E}]}))}))},t}(),F=function(t,e,r){void 0===r&&(r=!1);var n=[D(e[0])],o={},i=e.length;o[e[0].id]=!0;var a=0;return e.forEach((function(s,u){if(0!==u)if(u!==i-1&&t.getDegree(s.id,"both")===t.getDegree(e[u+1].id,"both")&&!t.areNeighbors(n[a].id,s.id)||o[s.id]){for(var h=r?t.getSuccessors(n[a].id):t.getNeighbors(n[a].id),d=!1,l=0;l<h.length;l++){var c=h[l];if(t.getDegree(c.id)===t.getDegree(s.id)&&!o[c.id]){n.push(D(c)),o[c.id]=!0,d=!0;break}}for(var f=0;!d&&(o[e[f].id]||(n.push(D(e[f])),o[e[f].id]=!0,d=!0),++f!==i););}else n.push(D(s)),o[s.id]=!0,a++})),n},V=function(t,e,r){var n=t,o=e,i=r;return n||"undefined"==typeof window||(n=window.innerWidth),o||"undefined"==typeof window||(o=window.innerHeight),i||(i=[n/2,o/2]),[n,o,i]},W=k(913),G=k.n(W),B=k(370),$=k.n(B),U=function(t){function r(e,r,n){var o=t.call(this)||this;return o.graph=e,o.layout=r,o.options=n,o.spawnWorker(),o}return e(r,t),r.prototype.spawnWorker=function(){this.worker&&this.worker.terminate(),this.worker=$()(),this.running&&(this.running=!1,this.execute())},r.prototype.execute=function(){var t;return o(this,void 0,void 0,(function(){var e,r,o,s;return i(this,(function(i){switch(i.label){case 0:return this.running?[2,this]:(this.running=!0,(e=this.layout.options).onTick,r=n(e,["onTick"]),o={layout:{id:this.layout.id,options:r,iterations:null===(t=this.options)||void 0===t?void 0:t.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},s=new Float32Array([0]),[4,this.worker.calculateLayout(o,[s])]);case 1:return[2,a.apply(void 0,[i.sent(),1])[0]]}}))}))},r.prototype.stop=function(){return this.running=!1,this.worker.stopLayout(),this},r.prototype.kill=function(){this.worker&&this.worker.terminate()},r.prototype.isRunning=function(){return this.running},r}(G());const H=function(t){return p(t,"String")};var Y={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},K=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="concentric",this.options=r(r({},Y),t)}return t.prototype.execute=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.genericConcentricLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return this.genericConcentricLayout(!0,t,e),[2]}))}))},t.prototype.genericConcentricLayout=function(t,e,n){return o(this,void 0,void 0,(function(){var o,a,s,u,h,d,l,f,g,p,y,m,w,x,E,N,b,M,S,k,A,_,z,R,T,P,C,q,j,F,V,W,G,B,$,U,Y,K;return i(this,(function(i){if(o=r(r({},this.options),n),a=o.center,s=o.width,u=o.height,h=o.sortBy,d=o.maxLevelDiff,l=o.sweep,f=o.clockwise,g=o.equidistant,p=o.preventOverlap,y=o.startAngle,m=void 0===y?1.5*Math.PI:y,w=o.nodeSize,x=o.nodeSpacing,E=e.getAllNodes(),N=e.getAllEdges(),b=s||"undefined"==typeof window?s:window.innerWidth,M=u||"undefined"==typeof window?u:window.innerHeight,S=a||[b/2,M/2],!(null==E?void 0:E.length)||1===E.length)return[2,L(e,t,S)];if(k=[],_=0,A=c(w)?Math.max(w[0],w[1]):w,c(x)?_=Math.max(x[0],x[1]):v(x)&&(_=x),E.forEach((function(t){var e=D(t);k.push(e);var r=A,n=e.data;c(n.size)?r=Math.max(n.size[0],n.size[1]):v(n.size)?r=n.size:O(n.size)&&(r=Math.max(n.size.width,n.size.height)),A=Math.max(A,r),I(x)&&(_=Math.max(x(t),_))})),z={},k.forEach((function(t,e){z[t.id]=e})),H(R=h)&&void 0!==k[0].data[R]||(R="degree"),"degree"===R?k.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):k.sort((function(t,e){return e.data[R]-t.data[R]})),T=k[0],P=(d||("degree"===R?e.getDegree(T.id,"both"):T.data[R]))/4,q=(C=[{nodes:[]}])[0],k.forEach((function(t){if(q.nodes.length>0){var r="degree"===R?Math.abs(e.getDegree(q.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(q.nodes[0].data[R]-t.data[R]);P&&r>=P&&(q={nodes:[]},C.push(q))}q.nodes.push(t)})),j=A+_,p||(F=C.length>0&&C[0].nodes.length>1,V=Math.min(b,M)/2-j,W=V/(C.length+(F?1:0)),j=Math.min(j,W)),G=0,C.forEach((function(t){var e=void 0===l?2*Math.PI-2*Math.PI/t.nodes.length:l;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&p){var r=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),o=Math.sqrt(j*j/(r*r+n*n));G=Math.max(o,G)}t.r=G,G+=j})),g){for(B=0,$=0,U=0;U<C.length;U++)Y=C[U],K=(Y.r||0)-$,B=Math.max(B,K);$=0,C.forEach((function(t,e){0===e&&($=t.r||0),t.r=$,$+=B}))}return C.forEach((function(t){var e=t.dTheta||0,r=t.r||0;t.nodes.forEach((function(t,n){var o=m+(f?1:-1)*e*n;t.data.x=S[0]+r*Math.cos(o),t.data.y=S[1]+r*Math.sin(o)}))})),t&&k.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:k,edges:N}]}))}))},t}();function Q(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i,a,s,u,h,d,l,c,f=t._root,g={data:n},p=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!f)return t._root=g,t;for(;f.length;)if((h=e>=(i=(p+y)/2))?p=i:y=i,(d=r>=(a=(v+m)/2))?v=a:m=a,o=f,!(f=f[l=d<<1|h]))return o[l]=g,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&r===u)return g.next=f,o?o[l]=g:t._root=g,t;do{o=o?o[l]=new Array(4):t._root=new Array(4),(h=e>=(i=(p+y)/2))?p=i:y=i,(d=r>=(a=(v+m)/2))?v=a:m=a}while((l=d<<1|h)==(c=(u>=a)<<1|s>=i));return o[c]=f,o[l]=g,t}function J(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function X(t){return t[0]}function Z(t){return t[1]}function tt(t,e,r){var n=new et(null==e?X:e,null==r?Z:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function et(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function rt(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var nt=tt.prototype=et.prototype;function ot(t){return function(){return t}}function it(t){return 1e-6*(t()-.5)}nt.copy=function(){var t,e,r=new et(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=rt(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var o=0;o<4;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(4)}):n.target[o]=rt(e));return r},nt.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return Q(this.cover(e,r),e,r,t)},nt.addAll=function(t){var e,r,n,o,i=t.length,a=new Array(i),s=new Array(i),u=1/0,h=1/0,d=-1/0,l=-1/0;for(r=0;r<i;++r)isNaN(n=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(a[r]=n,s[r]=o,n<u&&(u=n),n>d&&(d=n),o<h&&(h=o),o>l&&(l=o));if(u>d||h>l)return this;for(this.cover(u,h).cover(d,l),r=0;r<i;++r)Q(this,a[r],s[r],t[r]);return this},nt.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var a,s,u=o-r||1,h=this._root;r>t||t>=o||n>e||e>=i;)switch(s=(e<n)<<1|t<r,(a=new Array(4))[s]=h,h=a,u*=2,s){case 0:o=r+u,i=n+u;break;case 1:r=o-u,i=n+u;break;case 2:o=r+u,n=i-u;break;case 3:r=o-u,n=i-u}this._root&&this._root.length&&(this._root=h)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this},nt.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},nt.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},nt.find=function(t,e,r){var n,o,i,a,s,u,h,d=this._x0,l=this._y0,c=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new J(p,d,l,c,f)),null==r?r=1/0:(d=t-r,l=e-r,c=t+r,f=e+r,r*=r);u=g.pop();)if(!(!(p=u.node)||(o=u.x0)>c||(i=u.y0)>f||(a=u.x1)<d||(s=u.y1)<l))if(p.length){var v=(o+a)/2,y=(i+s)/2;g.push(new J(p[3],v,y,a,s),new J(p[2],o,y,v,s),new J(p[1],v,i,a,y),new J(p[0],o,i,v,y)),(h=(e>=y)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-h],g[g.length-1-h]=u)}else{var m=t-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),x=m*m+w*w;if(x<r){var E=Math.sqrt(r=x);d=t-E,l=e-E,c=t+E,f=e+E,n=p.data}}return n},nt.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,r,n,o,i,a,s,u,h,d,l,c,f=this._root,g=this._x0,p=this._y0,v=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((h=i>=(s=(g+v)/2))?g=s:v=s,(d=a>=(u=(p+y)/2))?p=u:y=u,e=f,!(f=f[l=d<<1|h]))return this;if(!f.length)break;(e[l+1&3]||e[l+2&3]||e[l+3&3])&&(r=e,c=l)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(o=f.next)&&delete f.next,n?(o?n.next=o:delete n.next,this):e?(o?e[l]=o:delete e[l],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[c]=f:this._root=f),this):(this._root=o,this)},nt.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},nt.root=function(){return this._root},nt.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},nt.visit=function(t){var e,r,n,o,i,a,s=[],u=this._root;for(u&&s.push(new J(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,n=e.x0,o=e.y0,i=e.x1,a=e.y1)&&u.length){var h=(n+i)/2,d=(o+a)/2;(r=u[3])&&s.push(new J(r,h,d,i,a)),(r=u[2])&&s.push(new J(r,n,d,h,a)),(r=u[1])&&s.push(new J(r,h,o,i,d)),(r=u[0])&&s.push(new J(r,n,o,h,d))}return this},nt.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new J(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.x1,h=e.y1,d=(a+u)/2,l=(s+h)/2;(i=o[0])&&r.push(new J(i,a,s,d,l)),(i=o[1])&&r.push(new J(i,d,s,u,l)),(i=o[2])&&r.push(new J(i,a,l,d,h)),(i=o[3])&&r.push(new J(i,d,l,u,h))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},nt.x=function(t){return arguments.length?(this._x=t,this):this._x},nt.y=function(t){return arguments.length?(this._y=t,this):this._y};var at={value:()=>{}};function st(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new ut(n)}function ut(t){this._=t}function ht(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function dt(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=at,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}ut.prototype=st.prototype={constructor:ut,on:function(t,e){var r,n,o=this._,i=(n=o,(t+"").trim().split(/^|\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)o[r]=dt(o[r],t.name,e);else if(null==e)for(r in o)o[r]=dt(o[r],t.name,null);return this}for(;++a<s;)if((r=(t=i[a]).type)&&(r=ht(o[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new ut(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};const lt=st;var ct,ft,gt=0,pt=0,vt=0,yt=1e3,mt=0,wt=0,xt=0,Et="object"==typeof performance&&performance.now?performance:Date,Nt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function bt(){return wt||(Nt(Mt),wt=Et.now()+xt)}function Mt(){wt=0}function St(){this._call=this._time=this._next=null}function kt(t,e,r){var n=new St;return n.restart(t,e,r),n}function At(){wt=(mt=Et.now())+xt,gt=pt=0;try{!function(){bt(),++gt;for(var t,e=ct;e;)(t=wt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--gt}()}finally{gt=0,function(){for(var t,e,r=ct,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:ct=e);ft=t,zt(n)}(),wt=0}}function _t(){var t=Et.now(),e=t-mt;e>yt&&(xt-=e,mt=t)}function zt(t){gt||(pt&&(pt=clearTimeout(pt)),t-wt>24?(t<1/0&&(pt=setTimeout(At,t-Et.now()-xt)),vt&&(vt=clearInterval(vt))):(vt||(mt=Et.now(),vt=setInterval(_t,yt)),gt=1,Nt(At)))}St.prototype=kt.prototype={constructor:St,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?bt():+r)+(null==e?0:+e),this._next||ft===this||(ft?ft._next=this:ct=this,ft=this),this._call=t,this._time=r,zt()},stop:function(){this._call&&(this._call=null,this._time=1/0,zt())}};const Rt=1664525,Dt=1013904223,It=4294967296;function Ot(t){return t.x}function Tt(t){return t.y}var Pt=10,Ct=Math.PI*(3-Math.sqrt(5));function Lt(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,a=.6,s=new Map,u=kt(l),h=lt("tick","end"),d=function(){let t=1;return()=>(t=(Rt*t+Dt)%It)/It}();function l(){c(),h.call("tick",e),r<n&&(u.stop(),h.call("end",e))}function c(n){var u,h,d=t.length;void 0===n&&(n=1);for(var l=0;l<n;++l)for(r+=(i-r)*o,s.forEach((function(t){t(r)})),u=0;u<d;++u)null==(h=t[u]).fx?h.x+=h.vx*=a:(h.x=h.fx,h.vx=0),null==h.fy?h.y+=h.vy*=a:(h.y=h.fy,h.vy=0);return e}function f(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var o=Pt*Math.sqrt(.5+r),i=r*Ct;e.x=o*Math.cos(i),e.y=o*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,d),e}return null==t&&(t=[]),f(),e={tick:c,restart:function(){return u.restart(l),e},stop:function(){return u.stop(),e},nodes:function(r){return arguments.length?(t=r,f(),s.forEach(g),e):t},alpha:function(t){return arguments.length?(r=+t,e):r},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(o=+t,e):+o},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(d=t,s.forEach(g),e):d},force:function(t,r){return arguments.length>1?(null==r?s.delete(t):s.set(t,g(r)),e):s.get(t)},find:function(e,r,n){var o,i,a,s,u,h=0,d=t.length;for(null==n?n=1/0:n*=n,h=0;h<d;++h)(a=(o=e-(s=t[h]).x)*o+(i=r-s.y)*i)<n&&(u=s,n=a);return u},on:function(t,r){return arguments.length>1?(h.on(t,r),e):h.on(t)}}}function qt(){var t,e,r,n,o,i=ot(-30),a=1,s=1/0,u=.81;function h(r){var o,i=t.length,a=tt(t,Ot,Tt).visitAfter(l);for(n=r,o=0;o<i;++o)e=t[o],a.visit(c)}function d(){if(t){var e,r,n=t.length;for(o=new Array(n),e=0;e<n;++e)r=t[e],o[r.index]=+i(r,e,t)}}function l(t){var e,r,n,i,a,s=0,u=0;if(t.length){for(n=i=a=0;a<4;++a)(e=t[a])&&(r=Math.abs(e.value))&&(s+=e.value,u+=r,n+=r*e.x,i+=r*e.y);t.x=n/u,t.y=i/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=o[e.data.index]}while(e=e.next)}t.value=s}function c(t,i,h,d){if(!t.value)return!0;var l=t.x-e.x,c=t.y-e.y,f=d-i,g=l*l+c*c;if(f*f/u<g)return g<s&&(0===l&&(g+=(l=it(r))*l),0===c&&(g+=(c=it(r))*c),g<a&&(g=Math.sqrt(a*g)),e.vx+=l*t.value*n/g,e.vy+=c*t.value*n/g),!0;if(!(t.length||g>=s)){(t.data!==e||t.next)&&(0===l&&(g+=(l=it(r))*l),0===c&&(g+=(c=it(r))*c),g<a&&(g=Math.sqrt(a*g)));do{t.data!==e&&(f=o[t.data.index]*n/g,e.vx+=l*f,e.vy+=c*f)}while(t=t.next)}}return h.initialize=function(e,n){t=e,r=n,d()},h.strength=function(t){return arguments.length?(i="function"==typeof t?t:ot(+t),d(),h):i},h.distanceMin=function(t){return arguments.length?(a=t*t,h):Math.sqrt(a)},h.distanceMax=function(t){return arguments.length?(s=t*t,h):Math.sqrt(s)},h.theta=function(t){return arguments.length?(u=t*t,h):Math.sqrt(u)},h}function jt(t){return t.index}function Ft(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function Vt(t){var e,r,n,o,i,a,s=jt,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},h=ot(30),d=1;function l(n){for(var o=0,s=t.length;o<d;++o)for(var u,h,l,c,f,g,p,v=0;v<s;++v)h=(u=t[v]).source,c=(l=u.target).x+l.vx-h.x-h.vx||it(a),f=l.y+l.vy-h.y-h.vy||it(a),c*=g=((g=Math.sqrt(c*c+f*f))-r[v])/g*n*e[v],f*=g,l.vx-=c*(p=i[v]),l.vy-=f*p,h.vx+=c*(p=1-p),h.vy+=f*p}function c(){if(n){var a,u,h=n.length,d=t.length,l=new Map(n.map(((t,e)=>[s(t,e,n),t])));for(a=0,o=new Array(h);a<d;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=Ft(l,u.source)),"object"!=typeof u.target&&(u.target=Ft(l,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(a=0,i=new Array(d);a<d;++a)u=t[a],i[a]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);e=new Array(d),f(),r=new Array(d),g()}}function f(){if(n)for(var r=0,o=t.length;r<o;++r)e[r]=+u(t[r],r,t)}function g(){if(n)for(var e=0,o=t.length;e<o;++e)r[e]=+h(t[e],e,t)}return null==t&&(t=[]),l.initialize=function(t,e){n=t,a=e,c()},l.links=function(e){return arguments.length?(t=e,c(),l):t},l.id=function(t){return arguments.length?(s=t,l):s},l.iterations=function(t){return arguments.length?(d=+t,l):d},l.strength=function(t){return arguments.length?(u="function"==typeof t?t:ot(+t),f(),l):u},l.distance=function(t){return arguments.length?(h="function"==typeof t?t:ot(+t),g(),l):h},l}function Wt(t){return t.x+t.vx}function Gt(t){return t.y+t.vy}function Bt(t){var e,r,n,o=1,i=1;function a(){for(var t,a,u,h,d,l,c,f=e.length,g=0;g<i;++g)for(a=tt(e,Wt,Gt).visitAfter(s),t=0;t<f;++t)u=e[t],l=r[u.index],c=l*l,h=u.x+u.vx,d=u.y+u.vy,a.visit(p);function p(t,e,r,i,a){var s=t.data,f=t.r,g=l+f;if(!s)return e>h+g||i<h-g||r>d+g||a<d-g;if(s.index>u.index){var p=h-s.x-s.vx,v=d-s.y-s.vy,y=p*p+v*v;y<g*g&&(0===p&&(y+=(p=it(n))*p),0===v&&(y+=(v=it(n))*v),y=(g-(y=Math.sqrt(y)))/y*o,u.vx+=(p*=y)*(g=(f*=f)/(c+f)),u.vy+=(v*=y)*g,s.vx-=p*(g=1-g),s.vy-=v*g)}}}function s(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var n,o,i=e.length;for(r=new Array(i),n=0;n<i;++n)o=e[n],r[o.index]=+t(o,n,e)}}return"function"!=typeof t&&(t=ot(null==t?1:+t)),a.initialize=function(t,r){e=t,n=r,u()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(o=+t,a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:ot(+e),u(),a):t},a}function $t(){function t(t){return function(){return t}}var e,r=function(t){return t.cluster},n=t(1),o=t(-1),i=t(100),s=t(.1),u=[0,0],h=[],d={},l=[],c=100,f=100,g={none:{x:0,y:0}},p=[],v="force",y=!0,m=.1;function w(t){if(!y)return w;e.tick(),E();for(var n=0,o=h.length,i=void 0,a=t*m;n<o;++n)(i=h[n]).vx+=(g[r(i)].x-i.x)*a,i.vy+=(g[r(i)].y-i.y)*a}function x(){h&&function(){if(h&&h.length){if(void 0===r(h[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy('clusterAttr') before calling .links()");var t,u,g,v,y,m=(t=[],u=[],g={},y=[],v=function(t){var e={};return t.forEach((function(t){var n=r(t);e[n]||(e[n]={count:0,sumforceNodeSize:0})})),t.forEach((function(t){var o=r(t),i=n(t),a=e[o];a.count=a.count+1,a.sumforceNodeSize=a.sumforceNodeSize+Math.PI*(i*i)*1.3,e[o]=a})),e}(h),y=function(t){var e={},n=[];return t.forEach((function(t){var n,o,i,a,s,u=(o=(n=t).source,i=n.target,(a=r(d[o]))<=(s=r(d[i]))?a+"~"+s:s+"~"+a),h=0;void 0!==e[u]&&(h=e[u]),h+=1,e[u]=h})),Object.entries(e).forEach((function(t){var e=a(t,2),r=e[0],o=e[1],i=r.split("~")[0],s=r.split("~")[1];void 0!==i&&void 0!==s&&n.push({source:i,target:s,count:o})})),n}(l),Object.keys(v).forEach((function(e,r){var n=v[e];t.push({id:e,size:n.count,r:Math.sqrt(n.sumforceNodeSize/Math.PI)}),g[e]=r})),y.forEach((function(t){var e=t.source,r=t.target,n=g[e],o=g[r];void 0!==n&&void 0!==o&&u.push({source:n,target:o,count:t.count})})),{nodes:t,links:u});e=Lt(m.nodes).force("x",function(t){var e,r,n,o=ot(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vx+=(n[i]-o.x)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=ot(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:ot(+t),a(),i):o},i.x=function(e){return arguments.length?(t="function"==typeof e?e:ot(+e),a(),i):t},i}(c).strength(.1)).force("y",function(t){var e,r,n,o=ot(.1);function i(t){for(var o,i=0,a=e.length;i<a;++i)(o=e[i]).vy+=(n[i]-o.y)*r[i]*t}function a(){if(e){var i,a=e.length;for(r=new Array(a),n=new Array(a),i=0;i<a;++i)r[i]=isNaN(n[i]=+t(e[i],i,e))?0:+o(e[i],i,e)}}return"function"!=typeof t&&(t=ot(null==t?0:+t)),i.initialize=function(t){e=t,a()},i.strength=function(t){return arguments.length?(o="function"==typeof t?t:ot(+t),a(),i):o},i.y=function(e){return arguments.length?(t="function"==typeof e?e:ot(+e),a(),i):t},i}(f).strength(.1)).force("collide",Bt((function(t){return t.r})).iterations(4)).force("charge",qt().strength(o)).force("links",Vt(m.nodes.length?m.links:[]).distance(i).strength(s)),p=e.nodes(),E()}}()}function E(){return g={none:{x:0,y:0}},p.forEach((function(t){g[t.id]={x:t.x-u[0],y:t.y-u[1]}})),g}return w.initialize=function(t){h=t,x()},w.template=function(t){return arguments.length?(v=t,x(),w):v},w.groupBy=function(t){return arguments.length?"string"==typeof t?(r=function(e){return e[t]},w):(r=t,w):r},w.enableGrouping=function(t){return arguments.length?(y=t,w):y},w.strength=function(t){return arguments.length?(m=t,w):m},w.centerX=function(t){return arguments.length?(c=t,w):c},w.centerY=function(t){return arguments.length?(f=t,w):f},w.nodes=function(t){return arguments.length?(function(t){d={},t.forEach((function(t){d[t.id]=t}))}(t||[]),h=t||[],w):h},w.links=function(t){return arguments.length?(l=t||[],x(),w):l},w.forceNodeSize=function(e){return arguments.length?(n="function"==typeof e?e:t(+e),x(),w):n},w.nodeSize=w.forceNodeSize,w.forceCharge=function(e){return arguments.length?(o="function"==typeof e?e:t(+e),x(),w):o},w.forceLinkDistance=function(e){return arguments.length?(i="function"==typeof e?e:t(+e),x(),w):i},w.forceLinkStrength=function(e){return arguments.length?(s="function"==typeof e?e:t(+e),x(),w):s},w.offset=function(t){return arguments.length?(u=t,w):u},w.getFocis=E,w}var Ut={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},Ht=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="d3force",this.options=r(r({},Ut),t)}return t.prototype.execute=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){var t;null===(t=this.forceSimulation)||void 0===t||t.stop()},t.prototype.tick=function(t){var e=this;void 0===t&&(t=1),this.forceSimulation.tick(t);var r={nodes:Yt(this.lastLayoutNodes),edges:Kt(this.lastLayoutEdges)};return this.lastAssign&&r.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r},t.prototype.genericForceLayout=function(t,e,n){return o(this,void 0,void 0,(function(){var o,a,s,u,h,d,l,c,f,g,p,v,y,m,w,x,E,N,b,M,S,k,A,_,z,R,I=this;return i(this,(function(i){return o=r(r({},this.options),n),a=e.getAllNodes(),s=e.getAllEdges(),u=a.map((function(t){var e,n;return r(r({},D(t)),{x:null===(e=t.data)||void 0===e?void 0:e.x,y:null===(n=t.data)||void 0===n?void 0:n.y})})),h=s.map((function(t){return D(t)})),this.lastLayoutNodes=u,this.lastLayoutEdges=h,this.lastAssign=t,this.lastGraph=e,d=o.alphaMin,l=o.alphaDecay,c=o.alpha,f=o.nodeStrength,g=o.edgeStrength,p=o.linkDistance,v=o.clustering,y=o.clusterFociStrength,m=o.clusterEdgeDistance,w=o.clusterEdgeStrength,x=o.clusterNodeStrength,E=o.clusterNodeSize,N=o.collideStrength,b=void 0===N?1:N,M=o.center,S=void 0===M?[0,0]:M,k=o.preventOverlap,A=o.nodeSize,_=o.nodeSpacing,z=o.onTick,R=o.forceSimulation,[2,new Promise((function(r){if(R){v&&((i=$t()).nodes(u),i.links(h)),R.nodes(u),h&&(s=Vt().id((function(t){return t.id})).links(h),g&&s.strength(g),p&&s.distance(p),R.force("link",s)),k&&I.overlapProcess(R,{nodeSize:A,nodeSpacing:_,collideStrength:b}),R.alpha(c).restart();var n=Yt(u),o=Kt(h);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:o})}else try{var i,a=qt();if(f&&a.strength(f),R=Lt().nodes(u),v&&((i=$t()).centerX(S[0]).centerY(S[1]).template("force").strength(y),h&&i.links(h),u&&i.nodes(u),i.forceLinkDistance(m).forceLinkStrength(w).forceCharge(x).forceNodeSize(E),R.force("group",i)),R.force("center",function(t,e){var r,n=1;function o(){var o,i,a=r.length,s=0,u=0;for(o=0;o<a;++o)s+=(i=r[o]).x,u+=i.y;for(s=(s/a-t)*n,u=(u/a-e)*n,o=0;o<a;++o)(i=r[o]).x-=s,i.y-=u}return null==t&&(t=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(n=+t,o):n},o}(S[0],S[1])).force("charge",a).alpha(c).alphaDecay(l).alphaMin(d),k&&I.overlapProcess(R,{nodeSize:A,nodeSpacing:_,collideStrength:b}),h){var s=Vt().id((function(t){return t.id})).links(h);g&&s.strength(g),p&&s.distance(p),R.force("link",s)}R.on("tick",(function(){var r=Yt(u);null==z||z({nodes:r,edges:Kt(h)}),t&&r.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}))})).on("end",(function(){var n=Yt(u);t&&n.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),r({nodes:n,edges:Kt(h)})}))}catch(t){console.warn(t)}I.forceSimulation=R}))]}))}))},t.prototype.overlapProcess=function(t,e){var r,n,o=e.nodeSize,i=e.nodeSpacing,a=e.collideStrength;if(n=v(i)?function(){return i}:I(i)?i:function(){return 0},o)if(I(o))r=function(t){return o(t)+n(t)};else if(c(o)){var s=(o[0]>o[1]?o[0]:o[1])/2;r=function(t){return s+n(t)}}else if(v(o)){var u=o/2;r=function(t){return u+n(t)}}else r=function(){return 10};else r=function(t){return t.size?c(t.size)?(t.size[0]>t.size[1]?t.size[0]:t.size[1])/2+n(t):O(t.size)?(t.size.width>t.size.height?t.size.width:t.size.height)/2+n(t):t.size/2+n(t):10+n(t)};t.force("collisionForce",Bt(r).strength(a))},t}(),Yt=function(t){return t.map((function(t){var e=t.x,o=t.y,i=n(t,["x","y"]);return r(r({},i),{data:r(r({},i.data),{x:e,y:o})})}))},Kt=function(t){return t.map((function(t){var e=t.source,o=t.target,i=n(t,["source","target"]);return r(r({},i),{source:e.id,target:o.id})}))};const Qt=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[],i=this._events["*"]||[],a=function(n){for(var o=n.length,i=0;i<o;i++)if(n[i]){var a=n[i],s=a.callback;a.once&&(n.splice(i,1),0===n.length&&delete e._events[t],o--,i--),s.apply(e,r)}};a(o),a(i)},t.prototype.off=function(t,e){if(t)if(e){for(var r=this._events[t]||[],n=r.length,o=0;o<n;o++)r[o].callback===e&&(r.splice(o,1),n--,o--);0===r.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function Jt(t,e,r,n){for(;t.length;){const o=t.shift();if(r(o))return!0;e.add(o.id),n(o.id).forEach((r=>{e.has(r.id)||(e.add(r.id),t.push(r))}))}return!1}function Xt(t,e,r,n){if(r(t))return!0;e.add(t.id);for(const o of n(t.id))if(!e.has(o.id)&&Xt(o,e,r,n))return!0;return!1}class Zt extends Qt{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const r=e.find((e=>e.type===t.type&&e.id===t.id&&e.propertyName===t.propertyName));r?r.newValue=t.newValue:e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const r=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),r=this.bothEdgesMap.get(t);r?.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((e=>{e.childrenMap.get(t)?.forEach((t=>{e.parentMap.delete(t.id)})),e.parentMap.delete(t),e.childrenMap.delete(t)})),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){const n=this.getNode(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateNodeDataProperty(t,e,r)}))}))}updateNodeData(...t){const e=t[0],r=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:o})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),o.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),o=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),o.delete(e),i.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.source,o=e;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:o})}))}updateEdgeTarget(t,e){const r=this.getEdge(t);this.checkNodeExistence(e);const n=r.target,o=e;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(o).add(r),this.bothEdgesMap.get(o).add(r),r.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:o})}))}updateEdgeDataProperty(t,e,r){const n=this.getEdge(t);this.batch((()=>{const o=n.data[e],i=r;n.data[e]=i,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:o,newValue:i})}))}updateEdgeData(...t){const e=t[0],r=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let n;if("function"==typeof t[1]){const e=t[1];n=e(r.data)}else"object"==typeof t[1]&&(n=t[1]);this.batch((()=>{const t=r.data,o=n;r.data=n,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:o})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,r])=>{this.updateEdgeDataProperty(t,e,r)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const r=[],n=Array.isArray(t)?t:[t];for(;n.length;){const t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach((t=>{t.children?.forEach((r=>{this.setParent(r.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const r=this.treeIndices.get(e).childrenMap.get(t);return Array.from(r||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const r=[];let n,o=this.getNode(t);for(;n=this.getParent(o.id,e);)r.push(n),o=n;return r}setParent(t,e,r){this.checkTreeExistence(r);const n=this.treeIndices.get(r),o=this.getNode(t),i=n.parentMap.get(t),a=this.getNode(e);n.parentMap.set(t,a),i&&n.childrenMap.get(i.id)?.delete(o);let s=n.childrenMap.get(a.id);s||(s=new Set,n.childrenMap.set(a.id,s)),s.add(o),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:i?.id,newParentId:a.id})}))}dfsTree(t,e,r){return Xt(this.getNode(t),new Set,e,(t=>this.getChildren(t,r)))}bfsTree(t,e,r){return Jt([this.getNode(t)],new Set,e,(t=>this.getChildren(t,r)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return Jt([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){const n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return Xt(this.getNode(t),new Set,e,n)}clone(){const t=this.getAllNodes().map((t=>({...t,data:{...t.data}}))),e=this.getAllEdges().map((t=>({...t,data:{...t.data}}))),r=new Zt({nodes:t,edges:e});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},n)=>{const o=new Map;t.forEach(((t,e)=>{o.set(e,r.getNode(t.id))}));const i=new Map;e.forEach(((t,e)=>{i.set(e,new Set(Array.from(t).map((t=>r.getNode(t.id)))))})),r.treeIndices.set(n,{parentMap:o,childrenMap:i})})),r}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var te=function(t,e){if("next"!==t&&"prev"!==t)return e},ee=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},re=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r}(function(){function t(){var t={};t.prev=t,t.next=t.prev,this.shortcut=t}return t.prototype.dequeue=function(){var t=this.shortcut,e=t.prev;if(e&&e!==t)return ee(e),e},t.prototype.enqueue=function(t){var e=this.shortcut;t.prev&&t.next&&ee(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e},t.prototype.toString=function(){for(var t=[],e=this.shortcut,r=e.prev;r!==e;)t.push(JSON.stringify(r,te)),r=null==r?void 0:r.prev;return"["+t.join(", ")+"]"},t}()),ne=function(){return 1},oe=function(t,e,n,o,i){var a,s,u=[];return t.hasNode(o.v)&&(null===(a=t.getRelatedEdges(o.v,"in"))||void 0===a||a.forEach((function(o){var a=o.data.weight,s=t.getNode(o.source);i&&u.push({v:o.source,w:o.target,in:0,out:0}),void 0===s.data.out&&(s.data.out=0),s.data.out-=a,ie(e,n,r({v:s.id},s.data))})),null===(s=t.getRelatedEdges(o.v,"out"))||void 0===s||s.forEach((function(o){var i=o.data.weight,a=o.target,s=t.getNode(a);void 0===s.data.in&&(s.data.in=0),s.data.in-=i,ie(e,n,r({v:s.id},s.data))})),t.removeNode(o.v)),i?u:void 0},ie=function(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},ae=function(t,e,r,n){var o;do{o=""+n+Math.random()}while(t.hasNode(o));return r.dummy=e,t.addNode({id:o,data:r}),o},se=function(t){var e=new Zt;return t.getAllNodes().forEach((function(n){t.getChildren(n.id).length||e.addNode(r({},n))})),t.getAllEdges().forEach((function(t){e.addEdge(t)})),e},ue=function(t,e){var r,n,o=Number(t.x),i=Number(t.y),a=Number(e.x)-o,s=Number(e.y)-i,u=Number(t.width)/2,h=Number(t.height)/2;return a||s?(Math.abs(s)*u>Math.abs(a)*h?(s<0&&(h=-h),r=h*a/s,n=h):(a<0&&(u=-u),r=u,n=u*s/a),{x:o+r,y:i+n}):{x:0,y:0}},he=function(t){for(var e=[],r=le(t)+1,n=0;n<r;n++)e.push([]);for(t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)})),n=0;n<r;n++)e[n]=e[n].sort((function(e,r){return n=t.getNode(e).data.order,o=t.getNode(r).data.order,Number(n)-Number(o);var n,o}));return e},de=function(t,e,r,n){var o={width:0,height:0};return v(r)&&v(n)&&(o.rank=r,o.order=n),ae(t,"border",o,e)},le=function(t){var e;return t.getAllNodes().forEach((function(t){var r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)})),e||(e=0),e},ce=function(t,e){return t.reduce((function(t,r){return e(t)>e(r)?r:t}))},fe=function(t,e,r,n,o,i){n.includes(e.id)||(n.push(e.id),r||i.push(e.id),o(e.id).forEach((function(e){return fe(t,e,r,n,o,i)})),r&&i.push(e.id))},ge=function(t,e,r,n){var o=Array.isArray(e)?e:[e],i=function(e){return n?t.getSuccessors(e):t.getNeighbors(e)},a=[],s=[];return o.forEach((function(e){if(!t.hasNode(e.id))throw new Error("Graph does not have node: "+e);fe(t,e,"post"===r,s,i,a)})),a},pe="edge-label",ve=function(t){var e={},r=function(n){var o,i,a=t.getNode(n);return a?e[n]?a.data.rank:(e[n]=!0,null===(o=t.getRelatedEdges(n,"out"))||void 0===o||o.forEach((function(t){var e=r(t.target)-t.data.minlen;e&&(void 0===i||e<i)&&(i=e)})),i||(i=0),a.data.rank=i,i):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){return r(t.id)}))},ye=function(t,e){return t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen},me=function(t,e){var r=function(n){e.getRelatedEdges(n,"both").forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||ye(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},we=function(t,e){var r=function(n){var o;null===(o=e.getRelatedEdges(n,"both"))||void 0===o||o.forEach((function(o){var i=o.source,a=n===i?o.target:i;t.hasNode(a)||void 0===e.getNode(a).data.layer&&ye(e,o)||(t.addNode({id:a,data:{}}),t.addEdge({id:o.id,source:n,target:a,data:{}}),r(a))}))};return t.getAllNodes().forEach((function(t){return r(t.id)})),t.getAllNodes().length},xe=function(t,e){return ce(e.getAllEdges(),(function(r){return t.hasNode(r.source)!==t.hasNode(r.target)?ye(e,r):1/0}))},Ee=function(t,e,r){t.getAllNodes().forEach((function(t){var n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r}))},Ne=function(t,e){var r=ge(t,t.getAllNodes(),"post",!1);(r=r.slice(0,(null==r?void 0:r.length)-1)).forEach((function(r){be(t,e,r)}))},be=function(t,e,r){var n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find((function(t){return t.target===n||t.source===n})).data.cutvalue=Me(t,e,r)},Me=function(t,e,r){var n=t.getNode(r).data.parent,o=!0,i=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),a=0;return i||(o=!1,i=e.getRelatedEdges(n,"out").find((function(t){return t.target===r}))),a=i.data.weight,e.getRelatedEdges(r,"both").forEach((function(e){var i=e.source===r,s=i?e.target:e.source;if(s!==n){var u=i===o,h=e.data.weight;if(a+=u?h:-h,De(t,r,s)){var d=t.getRelatedEdges(r,"both").find((function(t){return t.source===s||t.target===s})).data.cutvalue;a+=u?-d:d}}})),a},Se=function(t,e){void 0===e&&(e=t.getAllNodes()[0].id),ke(t,{},1,e)},ke=function(t,e,r,n,o){var i,a=r,s=r,u=t.getNode(n);return e[n]=!0,null===(i=t.getNeighbors(n))||void 0===i||i.forEach((function(r){e[r.id]||(s=ke(t,e,s,r.id,n))})),u.data.low=a,u.data.lim=s++,o?u.data.parent=o:delete u.data.parent,s},Ae=function(t){return t.getAllEdges().find((function(t){return t.data.cutvalue<0}))},_e=function(t,e,r){var n=r.source,o=r.target;e.getRelatedEdges(n,"out").find((function(t){return t.target===o}))||(n=r.target,o=r.source);var i=t.getNode(n),a=t.getNode(o),s=i,u=!1;i.data.lim>a.data.lim&&(s=a,u=!0);var h=e.getAllEdges().filter((function(e){return u===Ie(t.getNode(e.source),s)&&u!==Ie(t.getNode(e.target),s)}));return ce(h,(function(t){return ye(e,t)}))},ze=function(t,e,r,n){var o=t.getRelatedEdges(r.source,"both").find((function(t){return t.source===r.target||t.target===r.target}));o&&t.removeEdge(o.id),t.addEdge({id:"e"+Math.random(),source:n.source,target:n.target,data:{}}),Se(t),Ne(t,e),Re(t,e)},Re=function(t,e){var r=t.getAllNodes().find((function(t){return!t.data.parent})),n=ge(t,r,"pre",!1);(n=n.slice(1)).forEach((function(r){var n=t.getNode(r).data.parent,o=e.getRelatedEdges(r,"out").find((function(t){return t.target===n})),i=!1;!o&&e.hasNode(n)&&(o=e.getRelatedEdges(n,"out").find((function(t){return t.target===r})),i=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(i?null==o?void 0:o.data.minlen:-(null==o?void 0:o.data.minlen))}))},De=function(t,e,r){return t.getRelatedEdges(e,"both").find((function(t){return t.source===r||t.target===r}))},Ie=function(t,e){return e.data.low<=t.data.lim&&t.data.lim<=e.data.lim},Oe=ve,Te=function(t,e,r,n,o,i,a){var s=t.getChildren(a);if(null==s?void 0:s.length){var u=de(t,"_bt"),h=de(t,"_bb"),d=t.getNode(a);t.setParent(u,a),d.data.borderTop=u,t.setParent(h,a),d.data.borderBottom=h,null==s||s.forEach((function(s){Te(t,e,r,n,o,i,s.id);var d=s.data.borderTop?s.data.borderTop:s.id,l=s.data.borderBottom?s.data.borderBottom:s.id,c=s.data.borderTop?n:2*n,f=d!==l?1:o-i[a]+1;t.addEdge({id:"e"+Math.random(),source:u,target:d,data:{minlen:f,weight:c,nestingEdge:!0}}),t.addEdge({id:"e"+Math.random(),source:l,target:h,data:{minlen:f,weight:c,nestingEdge:!0}})})),t.getParent(a)||t.addEdge({id:"e"+Math.random(),source:e,target:u,data:{weight:0,minlen:o+i[a]}})}else a!==e&&t.addEdge({id:"e"+Math.random(),source:e,target:a,data:{weight:0,minlen:r}})},Pe=function(t,e,r,n,o,i){var a={rank:i,borderType:e,width:0,height:0},s=o.data[e][i-1],u=ae(t,"border",a,r);o.data[e][i]=u,t.setParent(u,n),s&&t.addEdge({id:"e"+Math.random(),source:s,target:u,data:{weight:1}})},Ce=function(t){t.getAllNodes().forEach((function(t){Le(t)})),t.getAllEdges().forEach((function(t){Le(t)}))},Le=function(t){var e=t.data.width;t.data.width=t.data.height,t.data.height=e},qe=function(t){(null==t?void 0:t.y)&&(t.y=-t.y)},je=function(t){var e=t.x;t.x=t.y,t.y=e},Fe=function(t){for(var e={},r=t.getAllNodes(),n=r.map((function(t){var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),o=Math.max.apply(Math,s([],a(n))),i=[],u=0;u<o+1;u++)i.push([]);var h=r.sort((function(e,r){return t.getNode(e.id).data.rank-t.getNode(r.id).data.rank})),d=h.filter((function(e){return void 0!==t.getNode(e.id).data.fixorder})).sort((function(e,r){return t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder}));return null==d||d.forEach((function(r){isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0})),null==h||h.forEach((function(r){return t.dfsTree(r.id,(function(t){if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)}))})),i},Ve=function(t,e,r){for(var n=function(t,e){return null==t?void 0:t.reduce((function(t,r,n){return t[r]=e[n],t}),{})}(r,r.map((function(t,e){return e}))),o=e.map((function(e){var r=t.getRelatedEdges(e,"out").map((function(t){return{pos:n[t.target]||0,weight:t.data.weight}}));return null==r?void 0:r.sort((function(t,e){return t.pos-e.pos}))})),i=o.flat().filter((function(t){return void 0!==t})),a=1;a<r.length;)a<<=1;var s=2*a-1;a-=1;var u=Array(s).fill(0,0,s),h=0;return null==i||i.forEach((function(t){if(t){var e=t.pos+a;u[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=u[e+1]),u[e=e-1>>1]+=t.weight;h+=t.weight*r}})),h},We=function(t,e){for(var r=0,n=1;n<(null==e?void 0:e.length);n+=1)r+=Ve(t,e[n-1],e[n]);return r};var Ge=function(t,e,r){for(var n,o=r;e.length&&(n=e[e.length-1]).i<=o;)e.pop(),null==t||t.push(n.vs),o++;return o},Be=function(t,e,r,n,o,i){var a,s,u,h,d=t.getChildren(e).map((function(t){return t.id})),l=t.getNode(e),c=l?l.data.borderLeft:void 0,f=l?l.data.borderRight:void 0,g={};c&&(d=null==d?void 0:d.filter((function(t){return t!==c&&t!==f})));var p=function(t,e){return e.map((function(e){var r=t.getRelatedEdges(e,"in");if(!(null==r?void 0:r.length))return{v:e};var n={sum:0,weight:0};return null==r||r.forEach((function(e){var r=t.getNode(e.source);n.sum+=e.data.weight*r.data.order,n.weight+=e.data.weight})),{v:e,barycenter:n.sum/n.weight,weight:n.weight}}))}(t,d||[]);null==p||p.forEach((function(e){var o;if(null===(o=t.getChildren(e.v))||void 0===o?void 0:o.length){var a=Be(t,e.v,r,n,i);g[e.v]=a,a.hasOwnProperty("barycenter")&&Ue(e,a)}}));var v=function(t,e){var r,n,o,i={};return null==t||t.forEach((function(t,e){i[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};var r=i[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)})),null===(r=e.getAllEdges())||void 0===r||r.forEach((function(t){var e=i[t.source],r=i[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(i[t.target]))})),function(t){for(var e,r,n=[],o=function(){var o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach((function(t){return(e=o,function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&function(t,e){var r,n=0,o=0;t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/o,t.weight=o,t.i=Math.min(e.i,t.i),e.merged=!0}(e,t)})(t);var e})),null===(r=o.out)||void 0===r||r.forEach((function(e){return(r=o,function(e){e.in.push(r),0==--e.indegree&&t.push(e)})(e);var r}))};null==t?void 0:t.length;)o();var i=n.filter((function(t){return!t.merged})),a=["vs","i","barycenter","weight"];return i.map((function(t){var e={};return null==a||a.forEach((function(r){void 0!==t[r]&&(e[r]=t[r])})),e}))}(null===(o=(n=Object.values(i)).filter)||void 0===o?void 0:o.call(n,(function(t){return!t.indegree})))}(p,r);$e(v,g),null===(a=v.filter((function(t){return t.vs.length>0})))||void 0===a||a.forEach((function(e){var r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)}));var y=function(t,e,r,n){var o=function(t,e){var r={lhs:[],rhs:[]};return null==t||t.forEach((function(t){var e,o;o=(e=t).hasOwnProperty("fixorder")&&!isNaN(e.fixorder),(n?!o&&e.hasOwnProperty("barycenter"):o||e.hasOwnProperty("barycenter"))?r.lhs.push(t):r.rhs.push(t)})),r}(t),i=o.lhs,a=o.rhs.sort((function(t,e){return-t.i- -e.i})),s=[],u=0,h=0,d=0;null==i||i.sort(function(t,e){return function(r,n){if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i}}(!!e,!!r)),d=Ge(s,a,d),null==i||i.forEach((function(t){var e;d+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),u+=t.barycenter*t.weight,h+=t.weight,d=Ge(s,a,d)}));var l={vs:s.flat()};return h&&(l.barycenter=u/h,l.weight=h),l}(v,n,o,i);if(c&&(y.vs=[c,y.vs,f].flat(),null===(s=t.getPredecessors(c))||void 0===s?void 0:s.length)){var m=t.getNode((null===(u=t.getPredecessors(c))||void 0===u?void 0:u[0].id)||""),w=t.getNode((null===(h=t.getPredecessors(f))||void 0===h?void 0:h[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+w.data.order)/(y.weight+2),y.weight+=2}return y},$e=function(t,e){null==t||t.forEach((function(t){var r,n=null===(r=t.vs)||void 0===r?void 0:r.map((function(t){return e[t]?e[t].vs:t}));t.vs=n.flat()}))},Ue=function(t,e){void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},He=function(t){if("object"!=typeof t||null===t)return t;var e,r;if(r=t,Array.isArray?Array.isArray(r):p(r,"Array")){e=[];for(var n=0,o=t.length;n<o;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=He(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=He(t[i]):e[i]=t[i];return e};const Ye=He;var Ke=function(t,e,n){return e.map((function(e){return function(t,e,n){var o=function(t){for(var e;t.hasNode(e="_root"+Math.random()););return e}(t),i=new Zt({tree:[{id:o,children:[],data:{}}]});return t.getAllNodes().forEach((function(a){var s=t.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(r({},a)),(null==s?void 0:s.id)&&!i.hasNode(null==s?void 0:s.id)&&i.addNode(r({},s)),i.setParent(a.id,(null==s?void 0:s.id)||o),t.getRelatedEdges(a.id,n).forEach((function(e){var n=e.source===a.id?e.target:e.source;i.hasNode(n)||i.addNode(r({},t.getNode(n)));var o=i.getRelatedEdges(n,"out").find((function(t){return t.target===a.id})),s=void 0!==o?o.data.weight:0;o?i.updateEdgeData(o.id,r(r({},o.data),{weight:e.data.weight+s})):i.addEdge({id:e.id,source:n,target:a.id,data:{weight:e.data.weight+s}})})),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,r(r({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))})),i}(t,e,n)}))},Qe=function(t,e,r,n){var o=new Zt;null==t||t.forEach((function(t){for(var i,a=t.getRoots()[0].id,s=Be(t,a,o,e,r,n),u=0;u<(null===(i=s.vs)||void 0===i?void 0:i.length);u++){var h=t.getNode(s.vs[u]);h&&(h.data.order=u)}!function(t,e,r){var n,o={};null==r||r.forEach((function(r){for(var i,a,s=t.getParent(r);s;){if((i=t.getParent(s.id))?(a=o[i.id],o[i.id]=s.id):(a=n,n=s.id),a&&a!==s.id)return e.addNodes([{id:a,data:{}},{id:s.id,data:{}}]),void e.addEdge({id:"e"+a+"-"+s.id,source:a,target:s.id,data:{}});s=i}}))}(t,o,s.vs)}))},Je=function(t,e){null==e||e.forEach((function(e){null==e||e.forEach((function(e,r){t.getNode(e).data.order=r}))}))},Xe=function(t,e,r){var n=e,o=r;if(n>o){var i=n;n=o,o=i}var a=t[n];a||(t[n]=a={}),a[o]=!0},Ze=function(t,e,r){var n=e;return n>r&&(n=r),!!t[n]},tr=function(t,e,n,o,i,a){var s=new Zt,u=er(o,i,a);return null==e||e.forEach((function(e){var o;null==e||e.forEach((function(e){var i=n[e];if(s.hasNode(i)||s.addNode({id:i,data:{}}),o){var a=n[o],h=s.getRelatedEdges(a,"out").find((function(t){return t.target===i}));h?s.updateEdgeData(h.id,r(r({},h.data),{weight:Math.max(u(t,e,o),h.data.weight||0)})):s.addEdge({id:"e"+Math.random(),source:a,target:i,data:{weight:Math.max(u(t,e,o),0)}})}o=e}))})),s},er=function(t,e,r){return function(n,o,i){var a=n.getNode(o),s=n.getNode(i),u=0,h=0;if(u+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":h=-a.data.width/2;break;case"r":h=a.data.width/2}if(h&&(u+=r?h:-h),h=0,u+=(a.data.dummy?e:t)/2,u+=(s.data.dummy?e:t)/2,u+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":h=s.data.width/2;break;case"r":h=-s.data.width/2}return h&&(u+=r?h:-h),h=0,u}},rr=function(t,e){var n=e.acyclicer,o=e.ranker,i=e.rankdir,u=void 0===i?"tb":i,h=e.nodeOrder,d=e.keepNodeOrder,l=e.align,c=e.nodesep,f=void 0===c?50:c,g=e.edgesep,p=void 0===g?20:g,v=e.ranksep,y=void 0===v?50:v;vr(t),function(t,e){var n="greedy"===e?function(t,e){var n;if(t.getAllNodes().length<=1)return[];var o=function(t,e){var n=new Zt,o=0,i=0;t.getAllNodes().forEach((function(t){n.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((function(t){var a=n.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target})),s=(null==e?void 0:e(t))||1;a?n.updateEdgeData(null==a?void 0:a.id,r(r({},a.data),{weight:a.data.weight+s})):n.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:s}}),i=Math.max(i,n.getNode(t.source).data.out+=s),o=Math.max(o,n.getNode(t.target).data.in+=s)}));for(var a=[],s=i+o+3,u=0;u<s;u++)a.push(new re);var h=o+1;return n.getAllNodes().forEach((function(t){ie(a,h,r({v:t.id},n.getNode(t.id).data))})),{buckets:a,zeroIdx:h,graph:n}}(t,function(t){return t.data.weight||1}||ne);return null===(n=function(t,e,r){for(var n,o=[],i=e[e.length-1],a=e[0];t.getAllNodes().length;){for(;n=a.dequeue();)oe(t,e,r,n);for(;n=i.dequeue();)oe(t,e,r,n);if(t.getAllNodes().length)for(var s=e.length-2;s>0;--s)if(n=e[s].dequeue()){o=o.concat(oe(t,e,r,n,!0));break}}return o}(o.graph,o.buckets,o.zeroIdx).map((function(e){return t.getRelatedEdges(e.v,"out").filter((function(t){return t.target===e.w}))})))||void 0===n?void 0:n.flat()}(t):function(t){var e=[],r={},n={},o=function(i){n[i]||(n[i]=!0,r[i]=!0,t.getRelatedEdges(i,"out").forEach((function(t){r[t.target]?e.push(t):o(t.target)})),delete r[i])};return t.getAllNodes().forEach((function(t){return o(t.id)})),e}(t);null==n||n.forEach((function(e){var n=e.data;t.removeEdge(e.id),n.forwardName=e.data.name,n.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:r({},n)})}))}(t,n);var m=function(t){var e=ae(t,"root",{},"_root"),r=function(t){var e={},r=function(n,o){var i=t.getChildren(n);null==i||i.forEach((function(t){return r(t.id,o+1)})),e[n]=o};return t.getRoots().forEach((function(t){return r(t.id,1)})),e}(t),n=Math.max.apply(Math,s([],a(Object.values(r))));Math.abs(n)===1/0&&(n=1);var o=n-1,i=2*o+1;t.getAllEdges().forEach((function(t){t.data.minlen*=i}));var u=function(t){var e=0;return t.getAllEdges().forEach((function(t){e+=t.data.weight})),e}(t)+1;return t.getRoots().forEach((function(n){Te(t,e,i,u,o,r,n.id)})),{nestingRoot:e,nodeRankFactor:i}}(t),w=m.nestingRoot,x=m.nodeRankFactor;!function(t,e){switch(e){case"network-simplex":!function(t){!function(t){var e=function(t){var e=new Zt;return t.getAllNodes().forEach((function(t){e.addNode(r({},t))})),t.getAllEdges().forEach((function(t){var n=e.getRelatedEdges(t.source,"out").find((function(e){return e.target===t.target}));n?e.updateEdgeData(null==n?void 0:n.id,r(r({},n.data),{weight:n.data.weight+t.data.weight||0,minlen:Math.max(n.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e}(t);ve(e);var n,o,i=function(t){var e,r,n=new Zt({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);me(n,t)<i;)e=xe(n,t),r=n.hasNode(e.source)?ye(t,e):-ye(t,e),Ee(n,t,r);return n}(e);for(Se(i),Ne(i,e);n=Ae(i);)o=_e(i,e,n),ze(i,e,n,o)}(t)}(t);break;case"tight-tree":default:!function(t){!function(t){var e,r={},n=function(o){var i,a,s=t.getNode(o);return s?r[o]?s.data.rank:(r[o]=!0,null===(i=t.getRelatedEdges(o,"out"))||void 0===i||i.forEach((function(t){var e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),(void 0===e||a<e)&&(e=a),s.data.rank=a,a):0};t.getAllNodes().filter((function(e){return 0===t.getRelatedEdges(e.id,"in").length})).forEach((function(t){t&&n(t.id)})),void 0===e&&(e=0);var o={},i=function(e,r){var n,a=t.getNode(e),s=isNaN(a.data.layer)?r:a.data.layer;(void 0===a.data.rank||a.data.rank<s)&&(a.data.rank=s),o[e]||(o[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach((function(t){i(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((function(t){var r=t.data;r&&(isNaN(r.layer)?r.rank-=e:i(t.id,r.layer))}))}(t),function(t){var e,r,n=new Zt({tree:[]}),o=t.getAllNodes()[0],i=t.getAllNodes().length;for(n.addNode(o);we(n,t)<i;)e=xe(n,t),r=n.hasNode(e.source)?ye(t,e):-ye(t,e),Ee(n,t,r)}(t)}(t);break;case"longest-path":Oe(t)}}(se(t),o),ur(t),function(t,e){void 0===e&&(e=0);var r=t.getAllNodes(),n=r.filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),o=Math.min.apply(Math,s([],a(n))),i=[];r.forEach((function(t){var e=(t.data.rank||0)-o;i[e]||(i[e]=[]),i[e].push(t.id)}));for(var u=0,h=0;h<i.length;h++){var d=i[h];void 0===d?h%e!=0&&(u-=1):u&&(null==d||d.forEach((function(e){var r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=u)})))}}(t,x),function(t,e){e&&t.removeNode(e),t.getAllEdges().forEach((function(e){e.data.nestingEdge&&t.removeEdge(e.id)}))}(t,w),function(t){var e=t.getAllNodes().filter((function(t){return void 0!==t.data.rank})).map((function(t){return t.data.rank})),r=Math.min.apply(Math,s([],a(e)));t.getAllNodes().forEach((function(t){t.data.hasOwnProperty("rank")&&r!==1/0&&(t.data.rank-=r)}))}(t),hr(t),dr(t);var E=[];!function(t,e){t.getAllEdges().forEach((function(r){return function(t,e,r){var n=e.source,o=t.getNode(n).data.rank,i=e.target,a=t.getNode(i).data.rank,s=e.data.labelRank;if(a!==o+1){var u,h,d;for(t.removeEdge(e.id),d=0,++o;o<a;++d,++o)e.data.points=[],u=ae(t,"edge",h={originalEdge:e,width:0,height:0,rank:o},"_d"),o===s&&(h.width=e.data.width,h.height=e.data.height,h.dummy=pe,h.labelpos=e.data.labelpos),t.addEdge({id:"e"+Math.random(),source:n,target:u,data:{weight:e.data.weight}}),0===d&&r.push(u),n=u;t.addEdge({id:"e"+Math.random(),source:n,target:i,data:{weight:e.data.weight}})}}(t,r,e)}))}(t,E),function(t,e){var r=function(t){var e={},r=0,n=function(o){var i=r;t.getChildren(o).forEach((function(t){return n(t.id)})),e[o]={low:i,lim:r++}};return t.getRoots().forEach((function(t){return n(t.id)})),e}(t);e.forEach((function(e){var n,o,i=e,a=t.getNode(i),s=a.data.originalEdge;if(s)for(var u=function(t,e,r,n){var o,i,a,s,u=[],h=[],d=Math.min(e[r].low,e[n].low),l=Math.max(e[r].lim,e[n].lim);a=r;do{a=null===(o=t.getParent(a))||void 0===o?void 0:o.id,u.push(a)}while(a&&(e[a].low>d||l>e[a].lim));for(s=a,a=n;a&&a!==s;)h.push(a),a=null===(i=t.getParent(a))||void 0===i?void 0:i.id;return{lca:s,path:u.concat(h.reverse())}}(t,r,s.source,s.target),h=u.path,d=u.lca,l=0,c=h[l],f=!0;i!==s.target;){if(a=t.getNode(i),f){for(;c!==d&&(null===(n=t.getNode(c))||void 0===n?void 0:n.data.maxRank)<a.data.rank;)c=h[++l];c===d&&(f=!1)}if(!f){for(;l<h.length-1&&(null===(o=t.getNode(h[l+1]))||void 0===o?void 0:o.data.minRank)<=a.data.rank;)l++;c=h[l]}t.hasNode(c)&&t.setParent(i,c),i=t.getSuccessors(i)[0].id}}))}(t,E),function(t){var e=function(r){var n=t.getChildren(r),o=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach((function(t){return e(t.id)})),o.data.hasOwnProperty("minRank")){o.data.borderLeft=[],o.data.borderRight=[];for(var i=o.data.minRank,a=o.data.maxRank+1;i<a;i+=1)Pe(t,"borderLeft","_bl",r,o,i),Pe(t,"borderRight","_br",r,o,i)}};t.getRoots().forEach((function(t){return e(t.id)}))}(t),d&&function(t,e){for(var r=t.getAllNodes().filter((function(e){var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)})).map((function(t){return t.data.rank})),n=Math.max.apply(Math,s([],a(r))),o=[],i=0;i<n+1;i++)o[i]=[];null==e||e.forEach((function(e){var r=t.getNode(e);r&&!r.data.dummy&&(isNaN(r.data.rank)||(r.data.fixorder=o[r.data.rank].length,o[r.data.rank].push(e)))}))}(t,h),function(t,e){for(var r=le(t),n=[],o=[],i=1;i<r+1;i++)n.push(i);for(i=r-1;i>-1;i--)o.push(i);var a=Ke(t,n,"in"),s=Ke(t,o,"out"),u=Fe(t);Je(t,u);for(var h,d=Number.POSITIVE_INFINITY,l=(i=0,0);l<4;++i,++l)Qe(i%2?a:s,i%4>=2,!1,e),u=he(t),(c=We(t,u))<d&&(l=0,h=Ye(u),d=c);for(u=Fe(t),Je(t,u),i=0,l=0;l<4;++i,++l){var c;Qe(i%2?a:s,i%4>=2,!0,e),u=he(t),(c=We(t,u))<d&&(l=0,h=Ye(u),d=c)}Je(t,h)}(t,d),yr(t),function(t,e){var r=e.toLowerCase();"lr"!==r&&"rl"!==r||Ce(t)}(t,u),function(t,e){var r,n=se(t);!function(t,e){var r=(e||{}).ranksep,n=void 0===r?0:r,o=he(t),i=0;null==o||o.forEach((function(e){var r=e.map((function(e){return t.getNode(e).data.height})),o=Math.max.apply(Math,s(s([],a(r)),[0]));null==e||e.forEach((function(e){t.getNode(e).data.y=i+o/2})),i+=o+n}))}(n,e);var o=function(t,e){var r=e||{},n=r.align,o=r.nodesep,i=void 0===o?0:o,u=r.edgesep,h=void 0===u?0:u,d=he(t),l=Object.assign(function(t,e){var r={};return(null==e?void 0:e.length)&&e.reduce((function(e,n){var o=0,i=0,a=e.length,s=null==n?void 0:n[(null==n?void 0:n.length)-1];return null==n||n.forEach((function(e,u){var h,d=function(t,e){var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find((function(e){return t.getNode(e.id).data.dummy}))}(t,e),l=d?t.getNode(d.id).data.order:a;(d||e===s)&&(null===(h=n.slice(i,u+1))||void 0===h||h.forEach((function(e){var n;null===(n=t.getPredecessors(e))||void 0===n||n.forEach((function(n){var i,a=t.getNode(n.id),s=a.data.order;!(s<o||l<s)||a.data.dummy&&(null===(i=t.getNode(e))||void 0===i?void 0:i.data.dummy)||Xe(r,n.id,e)}))})),i=u+1,o=l)})),n})),r}(t,d),function(t,e){var r={};function n(e,n,o,i,a){for(var s,u,h,d=n;d<o;d++)h=e[d],(null===(s=t.getNode(h))||void 0===s?void 0:s.data.dummy)&&(null===(u=t.getPredecessors(h))||void 0===u||u.forEach((function(e){var n=t.getNode(e.id);n.data.dummy&&(n.data.order<i||n.data.order>a)&&Xe(r,e.id,h)})))}function o(t,e){var r=function(t){return JSON.stringify(t.slice(1))}(t);e.get(r)||(n.apply(void 0,s([],a(t))),e.set(r,!0))}return(null==e?void 0:e.length)&&e.reduce((function(e,r){var n,i=-1,a=0,s=new Map;return null==r||r.forEach((function(u,h){var d;if("border"===(null===(d=t.getNode(u))||void 0===d?void 0:d.data.dummy)){var l=t.getPredecessors(u)||[];l.length&&(n=t.getNode(l[0].id).data.order,o([r,a,h,i,n],s),a=h,i=n)}o([r,a,r.length,n,e.length],s)})),r})),r}(t,d)),c={},f=[];["u","d"].forEach((function(e){f="u"===e?d:Object.values(d).reverse(),["l","r"].forEach((function(r){"r"===r&&(f=f.map((function(t){return Object.values(t).reverse()})));var n=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),o=function(t,e,r,n){var o={},i={},a={};return null==e||e.forEach((function(t){null==t||t.forEach((function(t,e){o[t]=t,i[t]=t,a[t]=e}))})),null==e||e.forEach((function(t){var e=-1;null==t||t.forEach((function(t){var s=n(t).map((function(t){return t.id}));if(s.length){s=s.sort((function(t,e){return a[t]-a[e]}));for(var u=(s.length-1)/2,h=Math.floor(u),d=Math.ceil(u);h<=d;++h){var l=s[h];i[t]===t&&e<a[l]&&!Ze(r,t,l)&&(i[l]=t,i[t]=o[t]=o[l],e=a[l])}}}))})),{root:o,align:i}}(0,f,l,n),a=function(t,e,r,n,o,i,a){var s,u={},h=tr(t,e,r,o,i,a),d=a?"borderLeft":"borderRight",l=function(t,e){for(var r=h.getAllNodes(),n=r.pop(),o={};n;)o[n.id]?t(n.id):(o[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return l((function(t){u[t]=(h.getRelatedEdges(t,"in")||[]).reduce((function(t,e){return Math.max(t,(u[e.source]||0)+e.data.weight)}),0)}),h.getPredecessors.bind(h)),l((function(e){var r=(h.getRelatedEdges(e,"out")||[]).reduce((function(t,e){return Math.min(t,(u[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==d&&(u[e]=Math.max(u[e],r))}),h.getSuccessors.bind(h)),null===(s=Object.values(n))||void 0===s||s.forEach((function(t){u[t]=u[r[t]]})),u}(t,f,o.root,o.align,i,h,"r"===r);"r"===r&&Object.keys(a).forEach((function(t){return a[t]=-a[t]})),c[e+r]=a}))}));var g=function(t,e){return ce(Object.values(e),(function(e){var r,n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach((function(r){var i=e[r],a=function(t,e){return t.getNode(e).data.width||0}(t,r)/2;n=Math.max(i+a,n),o=Math.min(i-a,o)})),n-o}))}(t,c);return g&&function(t,e){var r=Object.values(e),n=Math.min.apply(Math,s([],a(r))),o=Math.max.apply(Math,s([],a(r)));["u","d"].forEach((function(r){["l","r"].forEach((function(i){var u,h=r+i,d=t[h];if(d!==e){var l=Object.values(d);(u="l"===i?n-Math.min.apply(Math,s([],a(l))):o-Math.max.apply(Math,s([],a(l))))&&(t[h]={},Object.keys(d).forEach((function(e){t[h][e]=d[e]+u})))}}))}))}(c,g),function(t,e){var r={};return Object.keys(t.ul).forEach((function(n){if(e)r[n]=t[e.toLowerCase()][n];else{var o=Object.values(t).map((function(t){return t[n]}));r[n]=(o[0]+o[1])/2}})),r}(c,n)}(n,e);null===(r=Object.keys(o))||void 0===r||r.forEach((function(t){n.getNode(t).data.x=o[t]}))}(t,{align:l,nodesep:f,edgesep:p,ranksep:y}),mr(t),pr(t),function(t,e){e.forEach((function(e){var r,n=t.getNode(e),o=n.data.originalEdge;o&&t.addEdge(o);for(var i=e;n.data.dummy;)r=t.getSuccessors(i)[0],t.removeNode(i),o.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===pe&&(o.data.x=n.data.x,o.data.y=n.data.y,o.data.width=n.data.width,o.data.height=n.data.height),i=r.id,n=t.getNode(i)}))}(t,E),fr(t),function(t,e){var r=e.toLowerCase();"bt"!==r&&"rl"!==r||function(t){t.getAllNodes().forEach((function(t){qe(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return qe(t)})),t.data.hasOwnProperty("y")&&qe(t.data)}))}(t),"lr"!==r&&"rl"!==r||(function(t){t.getAllNodes().forEach((function(t){je(t.data)})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){return je(t)})),t.data.hasOwnProperty("x")&&je(t.data)}))}(t),Ce(t))}(t,u);var N=lr(t),b=N.width,M=N.height;return cr(t),gr(t),function(t){t.getAllEdges().forEach((function(e){var n=e.data;if(n.reversed){t.removeEdge(e.id);var o=n.forwardName;delete n.reversed,delete n.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:r(r({},n),{forwardName:o})})}}))}(t),{width:b,height:M}},nr=["width","height","layer","fixorder"],or={width:0,height:0},ir=["minlen","weight","width","height","labeloffset"],ar={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},sr=["labelpos"],ur=function(t){t.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var r=t.getNode(e.source),n={e,rank:(t.getNode(e.target).data.rank-r.data.rank)/2+r.data.rank};ae(t,"edge-proxy",n,"_ep")}}))},hr=function(t){var e=0;return t.getAllNodes().forEach((function(r){var n,o;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(o=t.getNode(r.data.borderBottom))||void 0===o?void 0:o.data.rank,e=Math.max(e,r.data.maxRank||-1/0))})),e},dr=function(t){t.getAllNodes().forEach((function(e){"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},lr=function(t,e){var r,n,o=0,i=0,a=e||{},s=a.marginx,u=void 0===s?0:s,h=a.marginy,d=void 0===h?0:h,l=function(t){if(t.data){var e=t.data.x,a=t.data.y,s=t.data.width,u=t.data.height;isNaN(e)||isNaN(s)||(void 0===r&&(r=e-s/2),r=Math.min(r,e-s/2),o=Math.max(o,e+s/2)),isNaN(a)||isNaN(u)||(void 0===n&&(n=a-u/2),n=Math.min(n,a-u/2),i=Math.max(i,a+u/2))}};return t.getAllNodes().forEach((function(t){l(t)})),t.getAllEdges().forEach((function(t){(null==t?void 0:t.data.hasOwnProperty("x"))&&l(t)})),r-=u,n-=d,t.getAllNodes().forEach((function(t){t.data.x-=r,t.data.y-=n})),t.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){t.x-=r,t.y-=n})),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)})),{width:o-r+u,height:i-n+d}},cr=function(t){t.getAllEdges().forEach((function(e){var r,n,o=t.getNode(e.source),i=t.getNode(e.target);e.data.points?(r=e.data.points[0],n=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:i.data.x,y:i.data.y},n={x:o.data.x,y:o.data.y}),e.data.points.unshift(ue(o.data,r)),e.data.points.push(ue(i.data,n))}))},fr=function(t){t.getAllEdges().forEach((function(t){if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},gr=function(t){t.getAllEdges().forEach((function(t){var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},pr=function(t){t.getAllNodes().forEach((function(e){var r,n,o;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){var i=t.getNode(e.id),a=t.getNode(i.data.borderTop),s=t.getNode(i.data.borderBottom),u=t.getNode(i.data.borderLeft[(null===(n=i.data.borderLeft)||void 0===n?void 0:n.length)-1]),h=t.getNode(i.data.borderRight[(null===(o=i.data.borderRight)||void 0===o?void 0:o.length)-1]);i.data.width=Math.abs((null==h?void 0:h.data.x)-(null==u?void 0:u.data.x))||10,i.data.height=Math.abs((null==s?void 0:s.data.y)-(null==a?void 0:a.data.y))||10,i.data.x=((null==u?void 0:u.data.x)||0)+i.data.width/2,i.data.y=((null==a?void 0:a.data.y)||0)+i.data.height/2}})),t.getAllNodes().forEach((function(e){"border"===e.data.dummy&&t.removeNode(e.id)}))},vr=function(t){t.getAllEdges().forEach((function(e){if(e.source===e.target){var r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}}))},yr=function(t){var e=he(t);null==e||e.forEach((function(e){var r=0;null==e||e.forEach((function(e,n){var o,i=t.getNode(e);i.data.order=n+r,null===(o=i.data.selfEdges)||void 0===o||o.forEach((function(e){ae(t,"selfedge",{width:e.data.width,height:e.data.height,rank:i.data.rank,order:n+ ++r,e},"_se")})),delete i.data.selfEdges}))}))},mr=function(t){t.getAllNodes().forEach((function(e){var r=t.getNode(e.id);if("selfedge"===r.data.dummy){var n=t.getNode(r.data.e.source),o=n.data.x+n.data.width/2,i=n.data.y,a=r.data.x-o,s=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}}))},wr=function(t,e){var r={};return null==e||e.forEach((function(e){void 0!==t[e]&&(r[e]=+t[e])})),r},xr=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(r){e[r.toLowerCase()]=t[r]})),e},Er={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,controlPoints:!1,radial:!1,focusNode:null},Nr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="dagre",this.layoutNode=function(t){return t.data.layout},this.options=r(r({},Er),t)}return t.prototype.execute=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.genericDagreLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return[4,this.genericDagreLayout(!0,t,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.genericDagreLayout=function(t,e,n){return o(this,void 0,void 0,(function(){var o,a,s,u,h,d,l,c,f,g,p,y,m,w,x,E,N,b,M,S,k,A,_,z,R,I,O,P,L,q,j,F,V,W=this;return i(this,(function(i){return o=r(r({},this.options),n),a=o.nodeSize,s=o.align,u=o.rankdir,h=void 0===u?"TB":u,d=o.ranksep,l=o.nodesep,c=o.ranksepFunc,f=o.nodesepFunc,g=o.edgeLabelSpace,p=o.nodeOrder,y=o.begin,m=o.controlPoints,w=o.radial,x=new Zt({tree:[]}),E=T(d||50,c),N=T(l||50,f),b=N,M=E,"LR"!==h&&"RL"!==h||(b=E,M=N),S=C(a,void 0),k=e.getAllNodes(),A=e.getAllEdges(),k.filter((function(t){return t.data.layout})).forEach((function(t){var e=S(t),r=M(t),n=e+2*b(t),o=e+2*r,i=t.data.layer;v(i)?x.addNode({id:t.id,data:{width:n,height:o,layer:i}}):x.addNode({id:t.id,data:{width:n,height:o}})})),A.forEach((function(t){W.layoutNode(x.getNode(t.source))&&W.layoutNode(x.getNode(t.target))&&x.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),function(t,e){var n,o,i=e.edgeLabelSpace,a=e.keepNodeOrder,s=e.prevGraph,u=e.rankdir,h=e.ranksep;!a&&s&&(o=s,(n=t).getAllNodes().forEach((function(t){var e=n.getNode(t.id),r=o.getNode(t.id);void 0!==r?(e.data.fixorder=r.data._order,delete r.data._order):delete e.data.fixorder})));var d=function(t){var e=new Zt({tree:[]});return t.getAllNodes().forEach((function(n){var o=xr(t.getNode(n.id).data),i=r(r({},or),o),a=wr(i,nr);e.hasNode(n.id)||e.addNode({id:n.id,data:r({},a)});var s=t.getParent(n.id);null==s||(e.hasNode(s.id)||e.addNode(r({},s)),e.setParent(n.id,s.id))})),t.getAllEdges().forEach((function(r){var n=xr(t.getEdge(r.id).data),o={};null==sr||sr.forEach((function(t){void 0!==n[t]&&(o[t]=n[t])})),e.addEdge({id:r.id,source:r.source,target:r.target,data:Object.assign({},ar,wr(n,ir),o)})})),e}(t);i&&(e.ranksep=function(t,e){var r=e.ranksep,n=void 0===r?0:r,o=e.rankdir;return t.getAllNodes().forEach((function(t){isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((function(t){var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===o||"BT"===o?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2}(d,{rankdir:u,ranksep:h}));try{rr(d,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:\n",t);throw t}!function(t,e){t.getAllNodes().forEach((function(r){var n,o=t.getNode(r.id);if(o){var i=e.getNode(r.id);o.data.x=i.data.x,o.data.y=i.data.y,o.data._order=i.data.order,o.data._rank=i.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(o.data.width=i.data.width,o.data.height=i.data.height)}})),t.getAllEdges().forEach((function(r){var n=t.getEdge(r.id),o=e.getEdge(r.id);n.data.points=o?o.data.points:[],o&&o.data.hasOwnProperty("x")&&(n.data.x=o.data.x,n.data.y=o.data.y)}))}(t,d)}(x,{prevGraph:null,edgeLabelSpace:g,keepNodeOrder:!!p,nodeOrder:p||[],acyclicer:"greedy",ranker:"network-simplex",rankdir:h,nodesep:l,align:s}),_=[0,0],y&&(z=1/0,R=1/0,x.getAllNodes().forEach((function(t){z>t.data.x&&(z=t.data.x),R>t.data.y&&(R=t.data.y)})),x.getAllEdges().forEach((function(t){var e;null===(e=t.data.points)||void 0===e||e.forEach((function(t){z>t.x&&(z=t.x),R>t.y&&(R=t.y)}))})),_[0]=y[0]-z,_[1]=y[1]-R),I="LR"===h||"RL"===h,w||(O=new Set,P="BT"===h||"RL"===h?function(t,e){return e-t}:function(t,e){return t-e},x.getAllNodes().forEach((function(t){t.data.x=t.data.x+_[0],t.data.y=t.data.y+_[1],O.add(I?t.data.x:t.data.y)})),L=Array.from(O).sort(P),q=I?function(t,e){return t.x!==e.x}:function(t,e){return t.y!==e.y},j=I?function(t,e,r){var n=Math.max(e.y,r.y),o=Math.min(e.y,r.y);return t.filter((function(t){return t.y<=n&&t.y>=o}))}:function(t,e,r){var n=Math.max(e.x,r.x),o=Math.min(e.x,r.x);return t.filter((function(t){return t.x<=n&&t.x>=o}))},x.getAllEdges().forEach((function(t,e){var r;g&&m&&"loop"!==t.data.type&&(t.data.controlPoints=br(null===(r=t.data.points)||void 0===r?void 0:r.map((function(t){var e=t.x,r=t.y;return{x:e+_[0],y:r+_[1]}})),x.getNode(t.source),x.getNode(t.target),L,I,q,j))}))),F=[],F=x.getAllNodes().map((function(t){return D(t)})),V=x.getAllEdges(),t&&(F.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),V.forEach((function(t){e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}))),[2,{nodes:F,edges:V}]}))}))},t}(),br=function(t,e,r,n,o,i,a){var s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){var u=e.data,h=u.x,d=u.y,l=r.data,c=l.x,f=l.y;if(o&&(h=e.data.y,d=e.data.x,c=r.data.y,f=r.data.x),f!==d&&h!==c){var g=n.indexOf(d),p=n[g+1];if(p){var v=s[0],y=o?{x:(d+p)/2,y:(null==v?void 0:v.y)||c}:{x:(null==v?void 0:v.x)||c,y:(d+p)/2};v&&!i(v,y)||s.unshift(y)}var m=n.indexOf(f),w=Math.abs(m-g);if(1===w)(s=a(s,e.data,r.data)).length||s.push(o?{x:(d+f)/2,y:h}:{x:h,y:(d+f)/2});else if(w>1){var x=n[m-1];if(x){var E=s[s.length-1],N=o?{x:(f+x)/2,y:(null==E?void 0:E.y)||c}:{x:(null==E?void 0:E.x)||h,y:(f+x)/2};E&&!i(E,N)||s.push(N)}}}}return s};function Mr(t,e,r,n,o){if(isNaN(e)||isNaN(r)||isNaN(n))return t;var i,a,s,u,h,d,l,c,f,g,p,v,y=t._root,m={data:o},w=t._x0,x=t._y0,E=t._z0,N=t._x1,b=t._y1,M=t._z1;if(!y)return t._root=m,t;for(;y.length;)if((c=e>=(a=(w+N)/2))?w=a:N=a,(f=r>=(s=(x+b)/2))?x=s:b=s,(g=n>=(u=(E+M)/2))?E=u:M=u,i=y,!(y=y[p=g<<2|f<<1|c]))return i[p]=m,t;if(h=+t._x.call(null,y.data),d=+t._y.call(null,y.data),l=+t._z.call(null,y.data),e===h&&r===d&&n===l)return m.next=y,i?i[p]=m:t._root=m,t;do{i=i?i[p]=new Array(8):t._root=new Array(8),(c=e>=(a=(w+N)/2))?w=a:N=a,(f=r>=(s=(x+b)/2))?x=s:b=s,(g=n>=(u=(E+M)/2))?E=u:M=u}while((p=g<<2|f<<1|c)==(v=(l>=u)<<2|(d>=s)<<1|h>=a));return i[v]=y,i[p]=m,t}function Sr(t,e,r,n,o,i,a){this.node=t,this.x0=e,this.y0=r,this.z0=n,this.x1=o,this.y1=i,this.z1=a}function kr(t){return t[0]}function Ar(t){return t[1]}function _r(t){return t[2]}function zr(t,e,r,n){var o=new Rr(null==e?kr:e,null==r?Ar:r,null==n?_r:n,NaN,NaN,NaN,NaN,NaN,NaN);return null==t?o:o.addAll(t)}function Rr(t,e,r,n,o,i,a,s,u){this._x=t,this._y=e,this._z=r,this._x0=n,this._y0=o,this._z0=i,this._x1=a,this._y1=s,this._z1=u,this._root=void 0}function Dr(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var Ir=zr.prototype=Rr.prototype;function Or(t){var e=0,r=0,n=0,o=0,i=t.length;if(i){for(var a=0;a<i;a++)(s=t[a])&&s.weight&&(e+=s.weight,r+=s.x*s.weight,n+=s.y*s.weight,o+=s.z*s.weight);t.x=r/e,t.y=n/e,t.z=o/e,t.weight=e}else{var s=t;t.x=s.data.x,t.y=s.data.y,t.z=s.data.z,t.weight=s.data.weight}}Ir.copy=function(){var t,e,r=new Rr(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),n=this._root;if(!n)return r;if(!n.length)return r._root=Dr(n),r;for(t=[{source:n,target:r._root=new Array(8)}];n=t.pop();)for(var o=0;o<8;++o)(e=n.source[o])&&(e.length?t.push({source:e,target:n.target[o]=new Array(8)}):n.target[o]=Dr(e));return r},Ir.add=function(t){const e=+this._x.call(null,t),r=+this._y.call(null,t),n=+this._z.call(null,t);return Mr(this.cover(e,r,n),e,r,n,t)},Ir.addAll=function(t){Array.isArray(t)||(t=Array.from(t));const e=t.length,r=new Float64Array(e),n=new Float64Array(e),o=new Float64Array(e);let i=1/0,a=1/0,s=1/0,u=-1/0,h=-1/0,d=-1/0;for(let l,c,f,g,p=0;p<e;++p)isNaN(c=+this._x.call(null,l=t[p]))||isNaN(f=+this._y.call(null,l))||isNaN(g=+this._z.call(null,l))||(r[p]=c,n[p]=f,o[p]=g,c<i&&(i=c),c>u&&(u=c),f<a&&(a=f),f>h&&(h=f),g<s&&(s=g),g>d&&(d=g));if(i>u||a>h||s>d)return this;this.cover(i,a,s).cover(u,h,d);for(let i=0;i<e;++i)Mr(this,r[i],n[i],o[i],t[i]);return this},Ir.cover=function(t,e,r){if(isNaN(t=+t)||isNaN(e=+e)||isNaN(r=+r))return this;var n=this._x0,o=this._y0,i=this._z0,a=this._x1,s=this._y1,u=this._z1;if(isNaN(n))a=(n=Math.floor(t))+1,s=(o=Math.floor(e))+1,u=(i=Math.floor(r))+1;else{for(var h,d,l=a-n||1,c=this._root;n>t||t>=a||o>e||e>=s||i>r||r>=u;)switch(d=(r<i)<<2|(e<o)<<1|t<n,(h=new Array(8))[d]=c,c=h,l*=2,d){case 0:a=n+l,s=o+l,u=i+l;break;case 1:n=a-l,s=o+l,u=i+l;break;case 2:a=n+l,o=s-l,u=i+l;break;case 3:n=a-l,o=s-l,u=i+l;break;case 4:a=n+l,s=o+l,i=u-l;break;case 5:n=a-l,s=o+l,i=u-l;break;case 6:a=n+l,o=s-l,i=u-l;break;case 7:n=a-l,o=s-l,i=u-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=o,this._z0=i,this._x1=a,this._y1=s,this._z1=u,this},Ir.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Ir.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},Ir.find=function(t,e,r,n){var o,i,a,s,u,h,d,l,c,f=this._x0,g=this._y0,p=this._z0,v=this._x1,y=this._y1,m=this._z1,w=[],x=this._root;for(x&&w.push(new Sr(x,f,g,p,v,y,m)),null==n?n=1/0:(f=t-n,g=e-n,p=r-n,v=t+n,y=e+n,m=r+n,n*=n);l=w.pop();)if(!(!(x=l.node)||(i=l.x0)>v||(a=l.y0)>y||(s=l.z0)>m||(u=l.x1)<f||(h=l.y1)<g||(d=l.z1)<p))if(x.length){var E=(i+u)/2,N=(a+h)/2,b=(s+d)/2;w.push(new Sr(x[7],E,N,b,u,h,d),new Sr(x[6],i,N,b,E,h,d),new Sr(x[5],E,a,b,u,N,d),new Sr(x[4],i,a,b,E,N,d),new Sr(x[3],E,N,s,u,h,b),new Sr(x[2],i,N,s,E,h,b),new Sr(x[1],E,a,s,u,N,b),new Sr(x[0],i,a,s,E,N,b)),(c=(r>=b)<<2|(e>=N)<<1|t>=E)&&(l=w[w.length-1],w[w.length-1]=w[w.length-1-c],w[w.length-1-c]=l)}else{var M=t-+this._x.call(null,x.data),S=e-+this._y.call(null,x.data),k=r-+this._z.call(null,x.data),A=M*M+S*S+k*k;if(A<n){var _=Math.sqrt(n=A);f=t-_,g=e-_,p=r-_,v=t+_,y=e+_,m=r+_,o=x.data}}return o},Ir.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t))||isNaN(s=+this._z.call(null,t)))return this;var e,r,n,o,i,a,s,u,h,d,l,c,f,g,p,v=this._root,y=this._x0,m=this._y0,w=this._z0,x=this._x1,E=this._y1,N=this._z1;if(!v)return this;if(v.length)for(;;){if((l=i>=(u=(y+x)/2))?y=u:x=u,(c=a>=(h=(m+E)/2))?m=h:E=h,(f=s>=(d=(w+N)/2))?w=d:N=d,e=v,!(v=v[g=f<<2|c<<1|l]))return this;if(!v.length)break;(e[g+1&7]||e[g+2&7]||e[g+3&7]||e[g+4&7]||e[g+5&7]||e[g+6&7]||e[g+7&7])&&(r=e,p=g)}for(;v.data!==t;)if(n=v,!(v=v.next))return this;return(o=v.next)&&delete v.next,n?(o?n.next=o:delete n.next,this):e?(o?e[g]=o:delete e[g],(v=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&v===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!v.length&&(r?r[p]=v:this._root=v),this):(this._root=o,this)},Ir.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},Ir.root=function(){return this._root},Ir.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Ir.visit=function(t){var e,r,n,o,i,a,s,u,h=[],d=this._root;for(d&&h.push(new Sr(d,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=h.pop();)if(!t(d=e.node,n=e.x0,o=e.y0,i=e.z0,a=e.x1,s=e.y1,u=e.z1)&&d.length){var l=(n+a)/2,c=(o+s)/2,f=(i+u)/2;(r=d[7])&&h.push(new Sr(r,l,c,f,a,s,u)),(r=d[6])&&h.push(new Sr(r,n,c,f,l,s,u)),(r=d[5])&&h.push(new Sr(r,l,o,f,a,c,u)),(r=d[4])&&h.push(new Sr(r,n,o,f,l,c,u)),(r=d[3])&&h.push(new Sr(r,l,c,i,a,s,f)),(r=d[2])&&h.push(new Sr(r,n,c,i,l,s,f)),(r=d[1])&&h.push(new Sr(r,l,o,i,a,c,f)),(r=d[0])&&h.push(new Sr(r,n,o,i,l,c,f))}return this},Ir.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new Sr(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=r.pop();){var o=e.node;if(o.length){var i,a=e.x0,s=e.y0,u=e.z0,h=e.x1,d=e.y1,l=e.z1,c=(a+h)/2,f=(s+d)/2,g=(u+l)/2;(i=o[0])&&r.push(new Sr(i,a,s,u,c,f,g)),(i=o[1])&&r.push(new Sr(i,c,s,u,h,f,g)),(i=o[2])&&r.push(new Sr(i,a,f,u,c,d,g)),(i=o[3])&&r.push(new Sr(i,c,f,u,h,d,g)),(i=o[4])&&r.push(new Sr(i,a,s,g,c,f,l)),(i=o[5])&&r.push(new Sr(i,c,s,g,h,f,l)),(i=o[6])&&r.push(new Sr(i,a,f,g,c,d,l)),(i=o[7])&&r.push(new Sr(i,c,f,g,h,d,l))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.z0,e.x1,e.y1,e.z1);return this},Ir.x=function(t){return arguments.length?(this._x=t,this):this._x},Ir.y=function(t){return arguments.length?(this._y=t,this):this._y},Ir.z=function(t){return arguments.length?(this._z=t,this):this._z};var Tr={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},Pr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=r(r({},Tr),t)}return t.prototype.execute=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===e.options.dimensions?t.data.z:void 0})})),n},t.prototype.genericForceLayout=function(t,e,n){return o(this,void 0,void 0,(function(){var o,a,s,u,h,d,l,c,f,g,p,y,m,w,x,E,N,b,M,S,k=this;return i(this,(function(i){return o=r(r({},this.options),n),a=e.getAllNodes(),s=e.getAllEdges(),u=this.formatOptions(o,e),h=u.dimensions,d=u.width,l=u.height,c=u.nodeSize,f=u.getMass,g=u.nodeStrength,p=u.edgeStrength,y=u.linkDistance,m=a.map((function(t,e){return r(r({},t),{data:r(r({},t.data),{x:v(t.data.x)?t.data.x:Math.random()*d,y:v(t.data.y)?t.data.y:Math.random()*l,z:v(t.data.z)?t.data.z:Math.random()*Math.sqrt(d*l),size:c(t)||30,mass:f(t),nodeStrength:g(t)})})})),w=s.map((function(t){return r(r({},t),{data:r(r({},t.data),{edgeStrength:p(t),linkDistance:y(t,e.getNode(t.source),e.getNode(t.target))})})})),(null==a?void 0:a.length)?(x={},a.forEach((function(t,e){x[t.id]={x:0,y:0,z:0}})),E=new Zt({nodes:m,edges:w}),this.formatCentripetal(u,E),N=u.maxIteration,b=u.minMovement,M=u.onTick,this.lastLayoutNodes=m,this.lastLayoutEdges=w,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=E,this.lastOptions=u,this.lastVelMap=x,"undefined"==typeof window?[2]:(S=0,[2,new Promise((function(r){k.timeInterval=window.setInterval((function(){a&&k.running||r({nodes:Fr(e,m),edges:s}),k.runOneStep(E,e,S,x,u),k.updatePosition(e,E,x,u),t&&m.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===h?t.data.z:void 0})})),null==M||M({nodes:Fr(e,m),edges:s}),(++S>=N||k.judgingDistance<b)&&(window.clearInterval(k.timeInterval),r({nodes:Fr(e,m),edges:s}))}),0),k.running=!0}))])):(this.lastResult={nodes:[],edges:s},[2,{nodes:[],edges:s}])}))}))},t.prototype.formatOptions=function(t,e){var r=t,n=t.width,o=t.height,i=t.getMass;if(r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=o||"undefined"==typeof window?o:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),i||(r.getMass=function(t){var r=1;v(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);var n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),t.preventOverlap){var a=T(0,t.nodeSpacing);t.nodeSize?c(t.nodeSize)?r.nodeSize=function(e){var r=t.nodeSize;return Math.max(r[0],r[1])+a(e)}:r.nodeSize=function(e){return t.nodeSize+a(e)}:r.nodeSize=function(t){var e=((null==t?void 0:t.data)||{}).size;return e?c(e)?Math.max(e[0],e[1])+a(t):O(e)?Math.max(e.width,e.height)+a(t):e+a(t):10+a(t)}}return r.linkDistance=t.linkDistance?T(1,t.linkDistance):function(t){return 1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target))},r.nodeStrength=T(1,t.nodeStrength),r.edgeStrength=T(1,t.edgeStrength),t},t.prototype.formatCentripetal=function(t,e){var r,n=t.centripetalOptions,o=t.center,i=t.clusterNodeStrength,a=t.leafCluster,s=t.clustering,u=t.nodeClusterBy,h=e.getAllNodes(),d=n||{leaf:2,single:2,others:1,center:function(t){return{x:o[0],y:o[1]}}};"function"!=typeof i&&(t.clusterNodeStrength=function(t){return i});var l=[];if(a&&u&&(r=Cr(e,u),l=Array.from(new Set(null==h?void 0:h.map((function(t){return t.data[u]}))))||[],t.centripetalOptions=Object.assign(d,{single:100,leaf:function(e){var n=r[e.id]||{},o=n.siblingLeaves,i=n.sameTypeLeaves;return(null==i?void 0:i.length)===(null==o?void 0:o.length)||1===(null==l?void 0:l.length)?1:t.clusterNodeStrength(e)},others:1,center:function(t){var n,o=e.getDegree(t.id,"both");if(!o)return{x:100,y:100};if(1===o){var i=(r[t.id]||{}).sameTypeLeaves,a=void 0===i?[]:i;1===a.length?n=void 0:a.length>1&&(n=jr(a))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y}}})),s&&u){r||(r=Cr(e,u)),l||(l=Array.from(new Set(h.map((function(t){return t.data[u]}))))),l=l.filter((function(t){return void 0!==t}));var c={};l.forEach((function(t){var r=h.filter((function(e){return e.data[u]===t})).map((function(t){return e.getNode(t.id)}));c[t]=jr(r)})),t.centripetalOptions=Object.assign(d,{single:function(e){return t.clusterNodeStrength(e)},leaf:function(e){return t.clusterNodeStrength(e)},others:function(e){return t.clusterNodeStrength(e)},center:function(t){var e=c[t.data[u]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y}}})}var f=t.centripetalOptions||{},g=f.leaf,p=f.single,v=f.others;g&&"function"!=typeof g&&(t.centripetalOptions.leaf=function(){return g}),p&&"function"!=typeof p&&(t.centripetalOptions.single=function(){return p}),v&&"function"!=typeof v&&(t.centripetalOptions.others=function(){return v})},t.prototype.runOneStep=function(t,e,r,n,o){var i={},a=t.getAllNodes(),s=t.getAllEdges();if(null==a?void 0:a.length){var u=o.monitor;this.calRepulsive(t,i,o),s&&this.calAttractive(t,i,o),this.calGravity(t,e,i,o),this.updateVelocity(t,i,n,o),u&&u({energy:this.calTotalEnergy(i,a),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}},t.prototype.calTotalEnergy=function(t,e){var r=this;if(!(null==e?void 0:e.length))return 0;var n=0;return e.forEach((function(e,o){var i=t[e.id].x,a=t[e.id].y,s=3===r.options.dimensions?t[e.id].z:0,u=i*i+a*a+s*s,h=e.data.mass;n+=(void 0===h?1:h)*u*.5})),n},t.prototype.calRepulsive=function(t,e,r){var n=r.dimensions,o=r.factor,i=r.coulombDisScale;!function(t,e,r,n,o){var i=e/r,a=t.getAllNodes(),s=a.map((function(t,e){var r=t.data,n=r.nodeStrength;return{x:r.x,y:r.y,z:r.z,size:r.size,index:e,vx:0,vy:0,vz:0,weight:i*n}})),u=(2===o?tt(s,(function(t){return t.x}),(function(t){return t.y})):zr(s,(function(t){return t.x}),(function(t){return t.y}),(function(t){return t.z}))).visitAfter(Or);s.forEach((function(t){!function(t,e,r){e.visit((function(e,n,o,i,a){return function(t,e,r,n,o,i,a){var s=[r,n,o][a-1],u=i.x-t.x||.1,h=i.y-t.y||.1,d=i.z-t.z||.1,l=s-e,c=u*u+h*h+d*d,f=Math.sqrt(c)*c;if(l*l*.81<c){var g=t.weight/f;return i.vx+=u*g,i.vy+=h*g,i.vz+=d*g,!0}if(t.length)return!1;t.data!==i&&(g=t.data.weight/f,i.vx+=u*g,i.vy+=h*g,i.vz+=d*g)}(e,n,o,i,a,t,r)}))}(t,u,o)})),s.map((function(t,e){var r=a[e],o=r.id,i=r.data.mass,s=void 0===i?1:i;n[o]={x:t.vx/s,y:t.vy/s,z:t.vz/s}}))}(t,o,i*i,e,n)},t.prototype.calAttractive=function(t,e,r){var n=r.dimensions;t.getAllEdges().forEach((function(r,o){var i=r.source,a=r.target,s=t.getNode(i),u=t.getNode(a);if(s&&u){var h=u.data.x-s.data.x,d=u.data.y-s.data.y,l=3===n?u.data.z-s.data.z:0;h||d||(h=.01*Math.random(),d=.01*Math.random(),3!==n||l||(l=.01*Math.random()));var c=Math.sqrt(h*h+d*d+l*l),f=h/c,g=d/c,p=l/c,v=r.data||{},y=v.linkDistance,m=void 0===y?200:y,w=v.edgeStrength,x=(m-c)*(void 0===w?200:w),E=1/(s.data.mass||1),N=1/(u.data.mass||1),b=f*x,M=g*x,S=p*x;e[i].x-=b*E,e[i].y-=M*E,e[i].z-=S*E,e[a].x+=b*N,e[a].y+=M*N,e[a].z+=S*N}}))},t.prototype.calGravity=function(t,e,r,n){var o=n.getCenter,i=t.getAllNodes(),s=e.getAllNodes(),u=e.getAllEdges(),h=n.width,d=n.height,l=n.center,c=n.gravity,f=n.centripetalOptions;i&&i.forEach((function(n){var i=n.id,g=n.data,p=g.mass,y=g.x,m=g.y,w=g.z,x=e.getNode(i),E=0,N=0,b=0,M=c,S=t.getDegree(i,"in"),k=t.getDegree(i,"out"),A=t.getDegree(i,"both"),_=null==o?void 0:o(x,A);if(_){var z=a(_,3);E=y-z[0],N=m-z[1],M=z[2]}else E=y-l[0],N=m-l[1],b=w-l[2];if(M&&(r[i].x-=M*E/p,r[i].y-=M*N/p,r[i].z-=M*b/p),f){var R=f.leaf,D=f.single,I=f.others,O=f.center,T=(null==O?void 0:O(x,s,u,h,d))||{x:0,y:0,z:0,centerStrength:0},P=T.x,C=T.y,L=T.z,q=T.centerStrength;if(!v(P)||!v(C))return;var j=(y-P)/p,F=(m-C)/p,V=(w-L)/p;if(q&&(r[i].x-=q*j,r[i].y-=q*F,r[i].z-=q*V),0===A){var W=D(x);if(!W)return;return r[i].x-=W*j,r[i].y-=W*F,void(r[i].z-=W*V)}if(0===S||0===k){var G=R(x,s,u);if(!G)return;return r[i].x-=G*j,r[i].y-=G*F,void(r[i].z-=G*V)}var B=I(x);if(!B)return;r[i].x-=B*j,r[i].y-=B*F,r[i].z-=B*V}}))},t.prototype.updateVelocity=function(t,e,r,n){var o=n.damping,i=n.maxSpeed,a=n.interval,s=n.dimensions,u=t.getAllNodes();(null==u?void 0:u.length)&&u.forEach((function(t){var n=t.id,u=(r[n].x+e[n].x*a)*o||.01,h=(r[n].y+e[n].y*a)*o||.01,d=3===s?(r[n].z+e[n].z*a)*o||.01:0,l=Math.sqrt(u*u+h*h+d*d);if(l>i){var c=i/l;u*=c,h*=c,d*=c}r[n]={x:u,y:h,z:d}}))},t.prototype.updatePosition=function(t,e,r,n){var o=this,i=n.distanceThresholdMode,a=n.interval,s=n.dimensions,u=e.getAllNodes();if(null==u?void 0:u.length){var h=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),u.forEach((function(n){var u=n.id,d=t.getNode(u);if(v(d.data.fx)&&v(d.data.fy))e.mergeNodeData(u,{x:d.data.fx,y:d.data.fy,z:3===s?d.data.fz:void 0});else{var l=r[u].x*a,c=r[u].y*a,f=3===s?r[u].z*a:0;e.mergeNodeData(u,{x:n.data.x+l,y:n.data.y+c,z:n.data.z+f});var g=Math.sqrt(l*l+c*c+f*f);switch(i){case"max":o.judgingDistance<g&&(o.judgingDistance=g);break;case"min":o.judgingDistance>g&&(o.judgingDistance=g);break;default:h+=g}}})),i&&"mean"!==i||(this.judgingDistance=h/u.length)}else this.judgingDistance=0},t}(),Cr=function(t,e){var r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};var n={};return r.forEach((function(r,o){1===t.getDegree(r.id,"both")&&(n[r.id]=Lr(t,"leaf",r,e))})),n},Lr=function(t,e,r,n){var o=t.getDegree(r.id,"in"),i=t.getDegree(r.id,"out"),a=r,s=[];return 0===o?(a=t.getSuccessors(r.id)[0],s=t.getNeighbors(a.id)):0===i&&(a=t.getPredecessors(r.id)[0],s=t.getNeighbors(a.id)),s=s.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")})),{coreNode:a,siblingLeaves:s,sameTypeLeaves:qr(t,e,n,r,s)}},qr=function(t,e,r,n,o){var i=n.data[r]||"",a=(null==o?void 0:o.filter((function(t){return t.data[r]===i})))||[];return"leaf"===e&&(a=a.filter((function(e){return 0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")}))),a},jr=function(t){var e={x:0,y:0};t.forEach((function(t){var r=t.data,n=r.x,o=r.y;e.x+=n||0,e.y+=o||0}));var r=t.length||1;return{x:e.x/r,y:e.y/r}},Fr=function(t,e){return e.map((function(e){var n=e.id,o=e.data,i=t.getNode(n);return r(r({},i),{data:r(r({},i.data),{x:o.x,y:o.y,z:o.z})})}))},Vr=function(){function t(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}return t.prototype.distanceTo=function(t){var e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)},t.prototype.setPos=function(t,e){this.rx=t,this.ry=e},t.prototype.resetForce=function(){this.fx=0,this.fy=0},t.prototype.addForce=function(t){var e=t.rx-this.rx,r=t.ry-this.ry,n=Math.hypot(e,r);n=n<1e-4?1e-4:n;var o=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=o*e/n,this.fy+=o*r/n},t.prototype.in=function(t){return t.contains(this.rx,this.ry)},t.prototype.add=function(e){var r=this.mass+e.mass;return new t({rx:(this.rx*this.mass+e.rx*e.mass)/r,ry:(this.ry*this.mass+e.ry*e.mass)/r,mass:r,degree:this.degree+e.degree})},t}();const Wr=Vr,Gr=function(){function t(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}return t.prototype.getLength=function(){return this.length},t.prototype.contains=function(t,e){var r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r},t.prototype.NW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.NE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},t.prototype.SW=function(){return new t({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t.prototype.SE=function(){return new t({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},t}(),Br=function(){function t(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}return t.prototype.insert=function(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e},t.prototype._putBody=function(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))},t.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},t.prototype.updateForce=function(t){null!=this.body&&t!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))},t}();var $r={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},Ur=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2",this.options=r(r({},$r),t)}return t.prototype.execute=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,n){return o(this,void 0,void 0,(function(){var o,a,s,u,h,d,l,c,f,g,p,v,y,m,w,x,E,N,b,M,S,k;return i(this,(function(i){if(o=e.getAllEdges(),a=e.getAllNodes(),s=this.formatOptions(n,a.length),u=s.width,h=s.height,d=s.prune,l=s.maxIteration,c=s.nodeSize,f=s.center,!(null==a?void 0:a.length)||1===a.length)return[2,L(e,t,f)];if(g=a.map((function(t){return D(t,[u,h])})),p=o.filter((function(t){return t.source!==t.target})),v=new Zt({nodes:g,edges:p}),y=this.getSizes(v,e,c),this.run(v,e,l,y,t,s),d){for(m=0;m<p.length;m+=1)w=p[m],x=w.source,E=w.target,N=v.getDegree(x),b=v.getDegree(x),N<=1?(M=v.getNode(E),v.mergeNodeData(x,{x:M.data.x,y:M.data.y})):b<=1&&(S=v.getNode(x),v.mergeNodeData(E,{x:S.data.x,y:S.data.y}));k=r(r({},s),{prune:!1,barnesHut:!1}),this.run(v,e,100,y,t,k)}return[2,{nodes:g,edges:o}]}))}))},t.prototype.getSizes=function(t,e,r){for(var n=t.getAllNodes(),o={},i=0;i<n.length;i+=1){var u=n[i],h=u.id,d=u.data;if(o[h]=10,v(d.size))o[h]=d.size;else if(c(d.size))isNaN(d.size[0])||(o[h]=Math.max(d.size[0])),isNaN(d.size[1])||(o[h]=Math.max(d.size[1]));else if(O(d.size))o[h]=Math.max(d.size.width,d.size.height);else if(I(r)){var l=r(e.getNode(h));c(l)?o[h]=Math.max.apply(Math,s([],a(l))):o[h]=l}else c(r)?o[h]=Math.max.apply(Math,s([],a(r))):v(r)&&(o[h]=r)}return o},t.prototype.formatOptions=function(t,e){void 0===t&&(t={});var n=r(r({},this.options),t),o=n.center,i=n.width,a=n.height,s=n.barnesHut,u=n.prune,h=n.maxIteration,d=n.kr,l=n.kg;return n.width=i||"undefined"==typeof window?i:window.innerWidth,n.height=a||"undefined"==typeof window?a:window.innerHeight,n.center=o||[n.width/2,n.height/2],void 0===s&&e>250&&(n.barnesHut=!0),void 0===u&&e>100&&(n.prune=!0),0!==h||u?0===h&&u&&(n.maxIteration=100,e<=200&&e>100?n.maxIteration=500:e>200&&(n.maxIteration=950)):(n.maxIteration=250,e<=200&&e>100?n.maxIteration=1e3:e>200&&(n.maxIteration=1200)),d||(n.kr=50,e>100&&e<=500?n.kr=20:e>500&&(n.kr=1)),l||(n.kg=20,e>100&&e<=500?n.kg=10:e>500&&(n.kg=1)),n},t.prototype.run=function(t,e,r,n,o,i){for(var a=i.kr,s=i.barnesHut,u=i.onTick,h=t.getAllNodes(),d=0,l=r,c={},f={},g={},p=0;p<h.length;p+=1){var v=h[p],y=v.data,m=v.id;if(c[m]=[0,0],s){var w={id:p,rx:y.x,ry:y.y,mass:1,g:a,degree:t.getDegree(m)};g[m]=new Wr(w)}}for(;l>0;)d=this.oneStep(t,{iter:l,preventOverlapIters:50,krPrime:100,sg:d,forces:c,preForces:f,bodies:g,sizes:n},i),l--,null==u||u({nodes:h,edges:e.getAllEdges()});return t},t.prototype.oneStep=function(t,e,r){for(var n=e.iter,o=e.preventOverlapIters,i=e.krPrime,u=e.sg,h=e.preForces,d=e.bodies,l=e.sizes,c=e.forces,f=r.preventOverlap,g=r.barnesHut,p=t.getAllNodes(),v=0;v<p.length;v+=1){var y=p[v].id;h[y]=s([],a(c[y])),c[y]=[0,0]}return c=this.getAttrForces(t,n,o,l,c,r),c=g&&(f&&n>o||!f)?this.getOptRepGraForces(t,c,d,r):this.getRepGraForces(t,n,o,c,i,l,r),this.updatePos(t,c,h,u,r)},t.prototype.getAttrForces=function(t,e,r,n,o,i){for(var a=i.preventOverlap,s=i.dissuadeHubs,u=i.mode,h=i.prune,d=t.getAllEdges(),l=0;l<d.length;l+=1){var c=d[l],f=c.source,g=c.target,p=t.getNode(f),v=t.getNode(g),y=t.getDegree(f),m=t.getDegree(g);if(!h||!(y<=1||m<=1)){var w=[v.data.x-p.data.x,v.data.y-p.data.y],x=Math.hypot(w[0],w[1]);x=x<1e-4?1e-4:x,w[0]=w[0]/x,w[1]=w[1]/x,a&&e<r&&(x=x-n[f]-n[g]);var E=x,N=E;"linlog"===u&&(N=E=Math.log(1+x)),s&&(E=x/y,N=x/m),a&&e<r&&x<=0?(E=0,N=0):a&&e<r&&x>0&&(E=x,N=x),o[f][0]+=E*w[0],o[g][0]-=N*w[0],o[f][1]+=E*w[1],o[g][1]-=N*w[1]}}return o},t.prototype.getOptRepGraForces=function(t,e,r,n){for(var o=n.kg,i=n.center,a=n.prune,s=t.getAllNodes(),u=s.length,h=9e10,d=-9e10,l=9e10,c=-9e10,f=0;f<u;f+=1){var g=s[f],p=g.id,v=g.data;a&&t.getDegree(p)<=1||(r[p].setPos(v.x,v.y),v.x>=d&&(d=v.x),v.x<=h&&(h=v.x),v.y>=c&&(c=v.y),v.y<=l&&(l=v.y))}var y=Math.max(d-h,c-l),m=new Gr({xmid:(d+h)/2,ymid:(c+l)/2,length:y,massCenter:i,mass:u}),w=new Br(m);for(f=0;f<u;f+=1)p=s[f].id,a&&t.getDegree(p)<=1||r[p].in(m)&&w.insert(r[p]);for(f=0;f<u;f+=1){var x=s[f],E=(p=x.id,v=x.data,t.getDegree(p));if(!(a&&E<=1)){r[p].resetForce(),w.updateForce(r[p]),e[p][0]-=r[p].fx,e[p][1]-=r[p].fy;var N=[v.x-i[0],v.y-i[1]],b=Math.hypot(N[0],N[1]);b=b<1e-4?1e-4:b,N[0]=N[0]/b,N[1]=N[1]/b;var M=o*(E+1);e[p][0]-=M*N[0],e[p][1]-=M*N[1]}}return e},t.prototype.getRepGraForces=function(t,e,r,n,o,i,a){for(var s=a.preventOverlap,u=a.kr,h=a.kg,d=a.center,l=a.prune,c=t.getAllNodes(),f=c.length,g=0;g<f;g+=1){for(var p=c[g],v=t.getDegree(p.id),y=g+1;y<f;y+=1){var m=c[y],w=t.getDegree(m.id);if(!l||!(v<=1||w<=1)){var x=[m.data.x-p.data.x,m.data.y-p.data.y],E=Math.hypot(x[0],x[1]);E=E<1e-4?1e-4:E,x[0]=x[0]/E,x[1]=x[1]/E,s&&e<r&&(E=E-i[p.id]-i[m.id]);var N=u*(v+1)*(w+1)/E;s&&e<r&&E<0?N=o*(v+1)*(w+1):s&&e<r&&0===E?N=0:s&&e<r&&E>0&&(N=u*(v+1)*(w+1)/E),n[p.id][0]-=N*x[0],n[m.id][0]+=N*x[0],n[p.id][1]-=N*x[1],n[m.id][1]+=N*x[1]}}var b=[p.data.x-d[0],p.data.y-d[1]],M=Math.hypot(b[0],b[1]);b[0]=b[0]/M,b[1]=b[1]/M;var S=h*(v+1);n[p.id][0]-=S*b[0],n[p.id][1]-=S*b[1]}return n},t.prototype.updatePos=function(t,e,r,n,o){for(var i=o.ks,a=o.tao,s=o.prune,u=o.ksmax,h=t.getAllNodes(),d=h.length,l=[],c=[],f=0,g=0,p=n,y=0;y<d;y+=1){var m=h[y].id,w=t.getDegree(m);if(!(s&&w<=1)){var x=[e[m][0]-r[m][0],e[m][1]-r[m][1]],E=Math.hypot(x[0],x[1]),N=[e[m][0]+r[m][0],e[m][1]+r[m][1]],b=Math.hypot(N[0],N[1]);l[y]=E,c[y]=b/2,f+=(w+1)*l[y],g+=(w+1)*c[y]}}var M=p;for(p=a*g/f,0!==M&&(p=p>1.5*M?1.5*M:p),y=0;y<d;y+=1){var S=h[y],k=(m=S.id,S.data);if(w=t.getDegree(m),!(s&&w<=1||v(k.fx)&&v(k.fy))){var A=i*p/(1+p*Math.sqrt(l[y])),_=Math.hypot(e[m][0],e[m][1]),z=u/(_=_<1e-4?1e-4:_),R=(A=A>z?z:A)*e[m][0],D=A*e[m][1];t.mergeNodeData(m,{x:k.x+R,y:k.y+D})}}return p},t}(),Hr={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Yr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=r(r({},Hr),t)}return t.prototype.execute=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},t.prototype.tick=function(t){var e=this;if(void 0===t&&(t=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var n={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&n.nodes.forEach((function(t){return e.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===e.options.dimensions?t.data.z:void 0})})),n},t.prototype.genericFruchtermanLayout=function(t,e,n){return o(this,void 0,void 0,(function(){var o,a,s,u,h,d,l,c,f,g,p,v,y,m,w,x,E=this;return i(this,(function(i){return this.running?[2]:(o=this.formatOptions(n),a=o.dimensions,s=o.width,u=o.height,h=o.center,d=o.clustering,l=o.nodeClusterBy,c=o.maxIteration,f=o.onTick,g=e.getAllNodes(),p=e.getAllEdges(),(null==g?void 0:g.length)?1===g.length?(t&&e.mergeNodeData(g[0].id,{x:h[0],y:h[1],z:3===a?h[2]:void 0}),v={nodes:[r(r({},g[0]),{data:r(r({},g[0].data),{x:h[0],y:h[1],z:3===a?h[2]:void 0})})],edges:p},this.lastResult=v,[2,v]):(y=g.map((function(t){return D(t,[s,u])})),m=new Zt({nodes:y,edges:p}),w={},d&&y.forEach((function(t){var e=t.data[l];w[e]||(w[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=y,this.lastLayoutEdges=p,this.lastAssign=t,this.lastGraph=m,this.lastOptions=o,this.lastClusterMap=w,"undefined"==typeof window?[2]:(x=0,[2,new Promise((function(r){E.timeInterval=window.setInterval((function(){E.running?(E.runOneStep(m,w,o),t&&y.forEach((function(t){var r=t.id,n=t.data;return e.mergeNodeData(r,{x:n.x,y:n.y,z:3===a?n.z:void 0})})),null==f||f({nodes:y,edges:p}),++x>=c&&(window.clearInterval(E.timeInterval),r({nodes:y,edges:p}))):r({nodes:y,edges:p})}),0),E.running=!0}))])):(v={nodes:[],edges:p},this.lastResult=v,[2,v]))}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=r(r({},this.options),t),n=e.clustering,o=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=n&&!!o,e},t.prototype.runOneStep=function(t,e,r){var n=r.dimensions,o=r.height,i=r.width,a=r.gravity,s=r.center,u=r.speed,h=r.clustering,d=r.nodeClusterBy,l=r.clusterGravity,c=o*i,f=Math.sqrt(c)/10,g=t.getAllNodes(),p=c/(g.length+1),y=Math.sqrt(p),m={};if(this.applyCalculate(t,m,y,p),h){for(var w in e)e[w].cx=0,e[w].cy=0,e[w].count=0;for(var w in g.forEach((function(t){var r=t.data,n=e[r[d]];v(r.x)&&(n.cx+=r.x),v(r.y)&&(n.cy+=r.y),n.count++})),e)e[w].cx/=e[w].count,e[w].cy/=e[w].count;var x=l||a;g.forEach((function(t,r){var n=t.id,o=t.data;if(v(o.x)&&v(o.y)){var i=e[o[d]],a=Math.sqrt((o.x-i.cx)*(o.x-i.cx)+(o.y-i.cy)*(o.y-i.cy)),s=y*x;m[n].x-=s*(o.x-i.cx)/a,m[n].y-=s*(o.y-i.cy)/a}}))}g.forEach((function(t,e){var r=t.id,o=t.data;if(v(o.x)&&v(o.y)){var i=.01*y*a;m[r].x-=i*(o.x-s[0]),m[r].y-=i*(o.y-s[1]),3===n&&(m[r].z-=i*(o.z-s[2]))}})),g.forEach((function(e,r){var o=e.id,i=e.data;if(v(i.fx)&&v(i.fy))return i.x=i.fx,i.y=i.fy,void(3===n&&(i.z=i.fz));if(v(i.x)&&v(i.y)){var a=Math.sqrt(m[o].x*m[o].x+m[o].y*m[o].y+(3===n?m[o].z*m[o].z:0));if(a>0){var s=Math.min(f*(u/800),a);t.mergeNodeData(o,{x:i.x+m[o].x/a*s,y:i.y+m[o].y/a*s,z:3===n?i.z+m[o].z/a*s:void 0})}}}))},t.prototype.applyCalculate=function(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)},t.prototype.calRepulsive=function(t,e,r){var n=this,o=t.getAllNodes();o.forEach((function(t,i){var a=t.data,s=t.id;e[s]={x:0,y:0,z:0},o.forEach((function(t,o){var u=t.data,h=t.id;if(!(i<=o)&&v(a.x)&&v(u.x)&&v(a.y)&&v(u.y)){var d=a.x-u.x,l=a.y-u.y,c=3===n.options.dimensions?a.z-u.z:0,f=d*d+l*l+c*c;0===f&&(f=1,d=.01,l=.01,c=.01);var g=r/f,p=d*g,y=l*g,m=c*g;e[s].x+=p,e[s].y+=y,e[h].x-=p,e[h].y-=y,3===n.options.dimensions&&(e[s].z+=m,e[h].z-=m)}}))}))},t.prototype.calAttractive=function(t,e,r){var n=this;t.getAllEdges().forEach((function(o){var i=o.source,a=o.target;if(i&&a&&i!==a){var s=t.getNode(i).data,u=t.getNode(a).data;if(v(u.x)&&v(s.x)&&v(u.y)&&v(s.y)){var h=u.x-s.x,d=u.y-s.y,l=3===n.options.dimensions?u.z-s.z:0,c=Math.sqrt(h*h+d*d+l*l)/r,f=h*c,g=d*c,p=l*c;e[i].x+=f,e[i].y+=g,e[a].x-=f,e[a].y-=g,3===n.options.dimensions&&(e[i].z+=p,e[a].z-=p)}}}))},t}(),Kr={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},Qr=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="grid",this.options=r(r({},Kr),t)}return t.prototype.execute=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.genericGridLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return this.genericGridLayout(!0,t,e),[2]}))}))},t.prototype.genericGridLayout=function(t,e,n){return o(this,void 0,void 0,(function(){var o,a,s,u,h,d,l,f,g,p,y,m,w,x,E,N,b,M,S,k,A,_,z,R,I,O,C,q,j,F,V,W,G,B,$,U,Y;return i(this,(function(i){if(o=r(r({},this.options),n),a=o.begin,s=void 0===a?[0,0]:a,u=o.condense,h=o.preventOverlapPadding,d=o.preventOverlap,l=o.rows,f=o.cols,g=o.nodeSpacing,p=o.nodeSize,y=o.width,m=o.height,w=o.position,x=o.sortBy,E=e.getAllNodes(),N=e.getAllEdges(),!(b=null==E?void 0:E.length)||1===b)return[2,L(e,t,s)];if(M=E.map((function(t){return D(t)})),"id"===x||H(x)&&void 0!==M[0].data[x]||(x="degree"),"degree"===x?M.sort((function(t,r){return e.getDegree(r.id,"both")-e.getDegree(t.id,"both")})):"id"===x?M.sort((function(t,e){return v(e.id)&&v(t.id)?e.id-t.id:(""+t.id).localeCompare(""+e.id)})):M.sort((function(t,e){return e.data[x]-t.data[x]})),S=y||"undefined"==typeof window?y:window.innerWidth,k=m||"undefined"==typeof window?m:window.innerHeight,A=b,_={rows:l,cols:f},null!=l&&null!=f?(_.rows=l,_.cols=f):null!=l&&null==f?(_.rows=l,_.cols=Math.ceil(A/_.rows)):null==l&&null!=f?(_.cols=f,_.rows=Math.ceil(A/_.cols)):(z=Math.sqrt(A*k/S),_.rows=Math.round(z),_.cols=Math.round(S/k*z)),_.rows=Math.max(_.rows,1),_.cols=Math.max(_.cols,1),_.cols*_.rows>A)R=Jr(_),I=Xr(_),(R-1)*I>=A?Jr(_,R-1):(I-1)*R>=A&&Xr(_,I-1);else for(;_.cols*_.rows<A;)R=Jr(_),((I=Xr(_))+1)*R>=A?Xr(_,I+1):Jr(_,R+1);for(O=u?0:S/_.cols,C=u?0:k/_.rows,(d||g)&&(q=T(10,g),j=P(30,p,!1),M.forEach((function(t){t.data.x&&t.data.y||(t.data.x=0,t.data.y=0);var r,n,o=e.getNode(t.id),i=j(o)||30;c(i)?(r=i[0],n=i[1]):(r=i,n=i);var a=void 0!==q?q(t):h,s=r+a,u=n+a;O=Math.max(O,s),C=Math.max(C,u)}))),F={},V={row:0,col:0},W={},G=0;G<M.length;G++){if(B=M[G],$=void 0,w&&($=w(e.getNode(B.id))),$&&(void 0!==$.row||void 0!==$.col)){if(void 0===(U={row:$.row,col:$.col}).col)for(U.col=0;Zr(F,U);)U.col++;else if(void 0===U.row)for(U.row=0;Zr(F,U);)U.row++;W[B.id]=U,tn(F,U)}rn(B,s,O,C,W,_,V,F)}return Y={nodes:M,edges:N},t&&M.forEach((function(t){e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,Y]}))}))},t}(),Jr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.min(n,o):Math.min(n,o)===t.rows?t.rows=e:t.cols=e,r},Xr=function(t,e){var r,n=t.rows||5,o=t.cols||5;return null==e?r=Math.max(n,o):Math.max(n,o)===t.rows?t.rows=e:t.cols=e,r},Zr=function(t,e){return t["c-"+e.row+"-"+e.col]||!1},tn=function(t,e){return t["c-"+e.row+"-"+e.col]=!0},en=function(t,e){var r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},rn=function(t,e,r,n,o,i,a,s){var u,h,d=o[t.id];if(d)u=d.col*r+r/2+e[0],h=d.row*n+n/2+e[1];else{for(;Zr(s,a);)en(i,a);u=a.col*r+r/2+e[0],h=a.row*n+n/2+e[1],tn(s,a),en(i,a)}t.data.x=u,t.data.y=h};const nn=Object.prototype.toString;function on(t){const e=nn.call(t);return e.endsWith("Array]")&&!e.includes("Big")}function an(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!on(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!on(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!on(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]<a&&(a=t[s]);return a}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!on(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<i;s++)t[s]>a&&(a=t[s]);return a}(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,a=void 0===i?r.autoMinMax?n:0:i,s=r.max,u=void 0===s?r.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var h=(u-a)/(o-n),d=0;d<t.length;d++)e[d]=(t[d]-n)*h+a;return e}const sn=" ".repeat(2),un=" ".repeat(4);function hn(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8,padMinus:i="auto"}=e;return`${t.constructor.name} {\n${sn}[\n${un}${function(t,e,r,n,o){const{rows:i,columns:a}=t,s=Math.min(i,e),u=Math.min(a,r),h=[];if("auto"===o){o=!1;t:for(let e=0;e<s;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let e=0;e<s;e++){let r=[];for(let i=0;i<u;i++)r.push(dn(t.get(e,i),n,o));h.push(`${r.join(" ")}`)}return u!==a&&(h[h.length-1]+=` ... ${a-r} more columns`),s!==i&&h.push(`... ${i-e} more rows`),h.join(`\n${un}`)}(t,r,n,o,i)}\n${sn}]\n${sn}rows: ${t.rows}\n${sn}columns: ${t.columns}\n}`}function dn(t,e,r){return(t>=0&&r?` ${ln(t,e-1)}`:ln(t,e)).padEnd(e)}function ln(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function cn(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function fn(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function gn(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function pn(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function vn(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(mn("startRow",e),mn("endRow",r),mn("startColumn",n),mn("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function yn(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function mn(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function wn(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class xn{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new Nn(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new Nn(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new Nn(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new Nn(t,e)}static ones(t,e){return new Nn(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new Nn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)o.set(r,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let a=o-n,s=new Nn(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(i()*a);s.set(r,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let t=0;t<n;t++)o.set(t,t,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let e=0;e<o;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new Nn(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return xn.isMatrix(t)?t:new Nn(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let a=o;a<e;a++){let e=t.get(r,a)-i*t.get(n,a);t.set(r,a,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new Nn(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){cn(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return Nn.rowVector(this.getRow(t))}setRow(t,e){cn(this,t),e=gn(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){cn(this,t),cn(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){fn(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return Nn.columnVector(this.getColumn(t))}setColumn(t,e){fn(this,t),e=pn(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){fn(this,t),fn(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=gn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=gn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=gn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=gn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=pn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=pn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=pn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=pn(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){cn(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){fn(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){wn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){wn(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(cn(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){cn(this,t),wn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(cn(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){cn(this,t),wn(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(fn(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){fn(this,t),wn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(fn(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){fn(this,t),wn(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){xn.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=Nn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new Nn(e,n),i=new Float64Array(r);for(let a=0;a<n;a++){for(let e=0;e<r;e++)i[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,a,e)}}return o}strassen2x2(t){t=Nn.checkMatrix(t);let e=new Nn(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),h=t.get(1,1),d=(r+u)*(n+h),l=(a+u)*n,c=r*(i-h),f=u*(s-n),g=(r+o)*h,p=d+f-g+(o-u)*(s+h),v=c+g,y=l+f,m=d-l+c+(a-r)*(n+i);return e.set(0,0,p),e.set(0,1,v),e.set(1,0,y),e.set(1,1,m),e}strassen3x3(t){t=Nn.checkMatrix(t);let e=new Nn(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),h=this.get(2,1),d=this.get(2,2),l=t.get(0,0),c=t.get(0,1),f=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),y=t.get(2,0),m=t.get(2,1),w=t.get(2,2),x=(r-i)*(-c+p),E=(-r+i+a)*(l-c+p),N=(i+a)*(-l+c),b=r*l,M=(-r+u+h)*(l-f+v),S=(-r+u)*(f-v),k=(u+h)*(-l+f),A=(-o+h+d)*(p+y-m),_=(o-d)*(p-m),z=o*y,R=(h+d)*(-y+m),D=(-o+a+s)*(v+y-w),I=(o-s)*(v-w),O=(a+s)*(-y+w),T=b+z+n*g,P=(r+n+o-i-a-h-d)*p+E+N+b+A+z+R,C=b+M+k+(r+n+o-a-s-u-h)*v+z+D+O,L=x+a*(-l+c+g-p-v-y+w)+E+b+z+D+I,q=x+E+N+b+s*m,j=z+D+I+O+i*f,F=b+M+S+h*(-l+f+g-p-v-y+m)+A+_+z,V=A+_+z+R+u*c,W=b+M+S+k+d*w;return e.set(0,0,T),e.set(0,1,P),e.set(0,2,C),e.set(1,0,L),e.set(1,1,q),e.set(1,2,j),e.set(2,0,F),e.set(2,1,V),e.set(2,2,W),e}mmulStrassen(t){t=Nn.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function a(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=xn.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${r} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let s=Math.max(r,o),u=Math.max(n,i);return e=a(e,s,u),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=a(e,n+1,o+1),r=a(r,n+1,o+1)):n%2==1?(e=a(e,n+1,o),r=a(r,n+1,o)):o%2==1&&(e=a(e,n,o+1),r=a(r,n,o+1));let i=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,s-1),h=r.subMatrix(0,i-1,0,s-1),d=e.subMatrix(0,i-1,s,e.columns-1),l=r.subMatrix(0,i-1,s,r.columns-1),c=e.subMatrix(i,e.rows-1,0,s-1),f=r.subMatrix(i,r.rows-1,0,s-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),p=r.subMatrix(i,r.rows-1,s,r.columns-1),v=t(xn.add(u,g),xn.add(h,p),i,s),y=t(xn.add(c,g),h,i,s),m=t(u,xn.sub(l,p),i,s),w=t(g,xn.sub(f,h),i,s),x=t(xn.add(u,d),p,i,s),E=t(xn.sub(c,u),xn.add(h,l),i,s),N=t(xn.sub(d,g),xn.add(f,p),i,s),b=xn.add(v,w);b.sub(x),b.add(N);let M=xn.add(m,x),S=xn.add(y,w),k=xn.sub(v,y);k.add(m),k.add(E);let A=xn.zeros(2*b.rows,2*b.columns);return A=A.setSubMatrix(b,0,0),A=A.setSubMatrix(M,b.rows,0),A=A.setSubMatrix(S,0,b.columns),A=A.setSubMatrix(k,b.rows,b.columns),A.subMatrix(0,n-1,0,o-1)}(e,t=a(t,s,u),s,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new Nn(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&an(o,{min:e,max:r,output:o}),n.setRow(t,o)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new Nn(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&an(o,{min:e,max:r,output:o}),n.setColumn(t,o)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=Nn.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new Nn(e*n,r*o);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<o;s++)i.set(n*a+r,o*e+s,this.get(a,e)*t.get(r,s));return i}kroneckerSum(t){if(t=Nn.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(Nn.eye(r,r)),o=Nn.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new Nn(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=En){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=En){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){vn(this,t,e,r,n);let o=new Nn(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new Nn(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new Nn(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=Nn.checkMatrix(t)).isEmpty())return this;vn(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){!function(t,e){if(!on(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!on(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new Nn(t.length,e.length);for(let n=0;n<t.length;n++){let o=t[n];for(let t=0;t<e.length;t++){let i=e[t];r.set(n,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new Nn(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=yn(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=yn(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=yn(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=yn(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!on(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<n;a++){let n=0,s=0,u=0;for(let e=0;e<o;e++)u=t.get(a,e)-r[a],n+=u,s+=u*u;e?i.push((s-n*n/o)/(o-1)):i.push((s-n*n/o)/o)}return i}(this,r,n);case"column":if(!on(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let a=0;a<o;a++){let o=0,s=0,u=0;for(let e=0;e<n;e++)u=t.get(e,a)-r[a],o+=u,s+=u*u;e?i.push((s-o*o/n)/(n-1)):i.push((s-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let a=0,s=0,u=0;for(let e=0;e<n;e++)for(let n=0;n<o;n++)u=t.get(e,n)-r,a+=u,s+=u*u;return e?(s-a*a/i)/(i-1):(s-a*a/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!on(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!on(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!on(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!on(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return hn(this,t)}}function En(t,e){return t-e}xn.prototype.klass="Matrix","undefined"!=typeof Symbol&&(xn.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return hn(this)}),xn.random=xn.rand,xn.randomInt=xn.randInt,xn.diagonal=xn.diag,xn.prototype.diagonal=xn.prototype.diag,xn.identity=xn.eye,xn.prototype.negate=xn.prototype.neg,xn.prototype.tensorProduct=xn.prototype.kroneckerProduct;class Nn extends xn{constructor(t,e){if(super(),Nn.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!on(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!r[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return cn(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),cn(this,t,!0),e=Float64Array.from(gn(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){fn(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),fn(this,t,!0),e=pn(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(xn,Nn);class bn extends xn{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function Mn(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class Sn{constructor(t,e={}){if((t=bn.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=e;let s,u=Boolean(o),h=Boolean(i),d=!1;if(r<n)if(a){s=t.transpose(),r=s.rows,n=s.columns,d=!0;let e=u;u=h,h=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let l=Math.min(r,n),c=Math.min(r+1,n),f=new Float64Array(c),g=new Nn(r,l),p=new Nn(n,n),v=new Float64Array(n),y=new Float64Array(r),m=new Float64Array(c);for(let t=0;t<c;t++)m[t]=t;let w=Math.min(r-1,n),x=Math.max(0,Math.min(n-2,r)),E=Math.max(w,x);for(let t=0;t<E;t++){if(t<w){f[t]=0;for(let e=t;e<r;e++)f[t]=Mn(f[t],s.get(e,t));if(0!==f[t]){s.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<r;e++)s.set(e,t,s.get(e,t)/f[t]);s.set(t,t,s.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<n;e++){if(t<w&&0!==f[t]){let n=0;for(let o=t;o<r;o++)n+=s.get(o,t)*s.get(o,e);n=-n/s.get(t,t);for(let o=t;o<r;o++)s.set(o,e,s.get(o,e)+n*s.get(o,t))}v[e]=s.get(t,e)}if(u&&t<w)for(let e=t;e<r;e++)g.set(e,t,s.get(e,t));if(t<x){v[t]=0;for(let e=t+1;e<n;e++)v[t]=Mn(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<n;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<r&&0!==v[t]){for(let e=t+1;e<r;e++)y[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)y[e]+=v[r]*s.get(e,r);for(let e=t+1;e<n;e++){let n=-v[e]/v[t+1];for(let o=t+1;o<r;o++)s.set(o,e,s.get(o,e)+n*y[o])}}if(h)for(let e=t+1;e<n;e++)p.set(e,t,v[e])}}let N=Math.min(n,r+1);if(w<n&&(f[w]=s.get(w,w)),r<N&&(f[N-1]=0),x+1<N&&(v[x]=s.get(x,N-1)),v[N-1]=0,u){for(let t=w;t<l;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<l;e++){let n=0;for(let o=t;o<r;o++)n+=g.get(o,t)*g.get(o,e);n=-n/g.get(t,t);for(let o=t;o<r;o++)g.set(o,e,g.get(o,e)+n*g.get(o,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(h)for(let t=n-1;t>=0;t--){if(t<x&&0!==v[t])for(let e=t+1;e<n;e++){let r=0;for(let o=t+1;o<n;o++)r+=p.get(o,t)*p.get(o,e);r=-r/p.get(t+1,t);for(let o=t+1;o<n;o++)p.set(o,e,p.get(o,e)+r*p.get(o,t))}for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}let b=N-1,M=0,S=Number.EPSILON;for(;N>0;){let t,e;for(t=N-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===N-2)e=4;else{let r;for(r=N-1;r>=t&&r!==t;r--){let e=(r!==N?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(f[r])<=S*e){f[r]=0;break}}r===t?e=3:r===N-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[N-2];v[N-2]=0;for(let r=N-2;r>=t;r--){let o=Mn(f[r],e),i=f[r]/o,a=e/o;if(f[r]=o,r!==t&&(e=-a*v[r-1],v[r-1]=i*v[r-1]),h)for(let t=0;t<n;t++)o=i*p.get(t,r)+a*p.get(t,N-1),p.set(t,N-1,-a*p.get(t,r)+i*p.get(t,N-1)),p.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<N;n++){let o=Mn(f[n],e),i=f[n]/o,a=e/o;if(f[n]=o,e=-a*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g.get(e,n)+a*g.get(e,t-1),g.set(e,t-1,-a*g.get(e,n)+i*g.get(e,t-1)),g.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(f[N-1]),Math.abs(f[N-2]),Math.abs(v[N-2]),Math.abs(f[t]),Math.abs(v[t])),o=f[N-1]/e,i=f[N-2]/e,a=v[N-2]/e,s=f[t]/e,d=v[t]/e,l=((i+o)*(i-o)+a*a)/2,c=o*a*(o*a);let y=0;0===l&&0===c||(y=l<0?0-Math.sqrt(l*l+c):Math.sqrt(l*l+c),y=c/(l+y));let m=(s+o)*(s-o)+y,w=s*d;for(let e=t;e<N-1;e++){let o=Mn(m,w);0===o&&(o=Number.MIN_VALUE);let i=m/o,a=w/o;if(e!==t&&(v[e-1]=o),m=i*f[e]+a*v[e],v[e]=i*v[e]-a*f[e],w=a*f[e+1],f[e+1]=i*f[e+1],h)for(let t=0;t<n;t++)o=i*p.get(t,e)+a*p.get(t,e+1),p.set(t,e+1,-a*p.get(t,e)+i*p.get(t,e+1)),p.set(t,e,o);if(o=Mn(m,w),0===o&&(o=Number.MIN_VALUE),i=m/o,a=w/o,f[e]=o,m=i*v[e]+a*f[e+1],f[e+1]=-a*v[e]+i*f[e+1],w=a*v[e+1],v[e+1]=i*v[e+1],u&&e<r-1)for(let t=0;t<r;t++)o=i*g.get(t,e)+a*g.get(t,e+1),g.set(t,e+1,-a*g.get(t,e)+i*g.get(t,e+1)),g.set(t,e,o)}v[N-2]=m,M+=1;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,h))for(let e=0;e<=b;e++)p.set(e,t,-p.get(e,t));for(;t<b&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,h&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}M=0,N--}}if(d){let t=p;p=g,g=t}this.m=r,this.n=n,this.s=f,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,n=this.s.length,o=Nn.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?o.set(t,t,0):o.set(t,t,1/this.s[t]);let i=this.U,a=this.rightSingularVectors,s=a.mmul(o),u=a.rows,h=i.rows,d=Nn.zeros(u,h);for(let t=0;t<u;t++)for(let e=0;e<h;e++){let r=0;for(let o=0;o<n;o++)r+=s.get(t,o)*i.get(e,o);d.set(t,e,r)}return d.mmul(e)}solveForDiagonal(t){return this.solve(Nn.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new Nn(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,a=i.rows,s=i.columns,u=new Nn(r,a);for(let t=0;t<r;t++)for(let e=0;e<a;e++){let r=0;for(let n=0;n<s;n++)r+=o.get(t,n)*i.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return Nn.diag(this.s)}}var kn={center:[0,0],linkDistance:50},An=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="mds",this.options=r(r({},kn),t)}return t.prototype.execute=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.genericMDSLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return this.genericMDSLayout(!0,t,e),[2]}))}))},t.prototype.genericMDSLayout=function(t,e,n){return o(this,void 0,void 0,(function(){var o,a,s,u,h,d,l,c,f,g,p,v;return i(this,(function(i){return o=r(r({},this.options),n),a=o.center,s=void 0===a?[0,0]:a,u=o.linkDistance,h=void 0===u?50:u,d=e.getAllNodes(),l=e.getAllEdges(),(null==d?void 0:d.length)&&1!==d.length?(c=m({nodes:d,edges:l},!1),f=y(c),_n(f),g=w(f,h),p=zn(g),v=[],p.forEach((function(t,e){var r=D(d[e]);r.data.x=t[0]+s[0],r.data.y=t[1]+s[1],v.push(r)})),t&&v.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:v,edges:l}]):[2,L(e,t,s)]}))}))},t}(),_n=function(t){var e=-999999;t.forEach((function(t){t.forEach((function(t){t!==1/0&&e<t&&(e=t)}))})),t.forEach((function(r,n){r.forEach((function(r,o){r===1/0&&(t[n][o]=e)}))}))},zn=function(t){var e=Nn.mul(Nn.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),o=e.mean();e.add(o).subRowVector(r).subColumnVector(n);var i=new Sn(e),a=Nn.sqrt(i.diagonalMatrix).diagonal();return i.leftSingularVectors.toJSON().map((function(t){return Nn.mul([t],[a]).toJSON()[0].splice(0,2)}))},Rn={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},Dn=function(t,e,r,n,o,i){e.forEach((function(a,s){r[s]={x:0,y:0},e.forEach((function(e,u){if(s!==u&&o[s]===o[u]){var h=a.x-e.x,d=a.y-e.y,l=Math.sqrt(h*h+d*d);if(0===l){l=1;var c=s>u?1:-1;h=.01*c,d=.01*c}if(l<i(t[s])/2+i(t[u])/2){var f=n*n/l;r[s].x+=h/l*f,r[s].y+=d/l*f}}}))}))},In=function(t,e,r,n,o,i,a,s){var u=i||a/10;return n&&e.forEach((function(e,r){var n=t[r].x-t[o].x,i=t[r].y-t[o].y,a=Math.sqrt(n*n+i*i),s=i/a,u=-n/a,h=Math.sqrt(e.x*e.x+e.y*e.y),d=Math.acos((s*e.x+u*e.y)/h);d>Math.PI/2&&(d-=Math.PI/2,s*=-1,u*=-1);var l=Math.cos(d)*h;e.x=s*l,e.y=u*l})),t.forEach((function(i,a){if(a!==o){var h=Math.sqrt(e[a].x*e[a].x+e[a].y*e[a].y);if(h>0&&a!==o){var d=Math.min(u*(r/800),h);if(i.x+=e[a].x/h*d,i.y+=e[a].y/h*d,n){var l=i.x-t[o].x,c=i.y-t[o].y,f=Math.sqrt(l*l+c*c);l=l/f*s[a],c=c/f*s[a],i.x=t[o].x+l,i.y=t[o].y+c}}}})),t},On={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},Tn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="radial",this.options=r(r({},On),t)}return t.prototype.execute=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.genericRadialLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return this.genericRadialLayout(!0,t,e),[2]}))}))},t.prototype.genericRadialLayout=function(t,e,n){return o(this,void 0,void 0,(function(){var o,u,h,d,l,c,f,g,p,v,w,x,E,N,b,M,S,k,A,_,z,R,I,O,T,P,q,j,F,V,W,G,B,$,U,Y,K,Q,J,X,Z,tt,et;return i(this,(function(i){if(o=r(r({},this.options),n),u=o.width,h=o.height,d=o.center,l=o.focusNode,c=o.unitRadius,f=o.nodeSize,g=o.nodeSpacing,p=o.strictRadial,v=o.preventOverlap,w=o.maxPreventOverlapIteration,x=o.sortBy,E=o.linkDistance,N=void 0===E?50:E,b=o.sortStrength,M=void 0===b?10:b,S=o.maxIteration,k=void 0===S?1e3:S,A=e.getAllNodes(),_=e.getAllEdges(),z=u||"undefined"==typeof window?u:window.innerWidth,R=h||"undefined"==typeof window?h:window.innerHeight,I=d||[z/2,R/2],!(null==A?void 0:A.length)||1===A.length)return[2,L(e,t,I)];if(O=A[0],H(l)){for(T=0;T<A.length;T++)if(A[T].id===l){O=A[T];break}}else O=l||A[0];return P=Ln(A,O.id),q=m({nodes:A,edges:_},!1),j=y(q),F=jn(j,P),qn(j,P,F+1),V=j[P],W=z-I[0]>I[0]?I[0]:z-I[0],G=R-I[1]>I[1]?I[1]:R-I[1],0===W&&(W=z/2),0===G&&(G=R/2),B=Math.min(W,G),$=Math.max.apply(Math,s([],a(V))),U=[],Y=c||B/$,V.forEach((function(t,e){U[e]=t*Y})),K=Pn(A,j,N,U,Y,x,M),Q=Cn(K),J=function(t,e,r){try{var n=Nn.mul(Nn.pow(e,2),-.5),o=n.mean("row"),i=n.mean("column"),a=n.mean();n.add(a).subRowVector(o).subColumnVector(i);var s=new Sn(n),u=Nn.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((function(e){return Nn.mul([e],[u]).toJSON()[0].splice(0,t)}))}catch(t){for(var h=[],d=0;d<e.length;d++){var l=Math.random()*r,c=Math.random()*r;h.push([l,c])}return h}}(N,K,N),X=J.map((function(t){var e=a(t,2),r=e[0],n=e[1];return{x:(isNaN(r)?Math.random()*N:r)-J[P][0],y:(isNaN(n)?Math.random()*N:n)-J[P][1]}})),this.run(k,X,Q,K,U,P),v&&(Z=C(f,g),tt={nodes:A,nodeSizeFunc:Z,positions:X,radii:U,height:R,width:z,strictRadial:Boolean(p),focusIdx:P,iterations:w||200,k:X.length/4.5},X=function(t,e){for(var n=r(r({},Rn),e),o=n.positions,i=n.iterations,a=n.width,s=n.k,u=n.speed,h=void 0===u?100:u,d=n.strictRadial,l=n.focusIdx,c=n.radii,f=void 0===c?[]:c,g=n.nodeSizeFunc,p=t.getAllNodes(),v=[],y=a/10,m=0;m<i;m++)o.forEach((function(t,e){v[e]={x:0,y:0}})),Dn(p,o,v,s,f,g),In(o,v,h,d,l,y,a,f);return o}(e,tt)),et=[],X.forEach((function(t,e){var r=D(A[e]);r.data.x=t.x+I[0],r.data.y=t.y+I[1],et.push(r)})),t&&et.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:et,edges:_}]}))}))},t.prototype.run=function(t,e,r,n,o,i){for(var a=0;a<=t;a++){var s=a/t;this.oneIteration(s,e,o,n,r,i)}},t.prototype.oneIteration=function(t,e,r,n,o,i){var a=1-t;e.forEach((function(s,u){var h=z(s,{x:0,y:0}),d=0===h?0:1/h;if(u!==i){var l=0,c=0,f=0;e.forEach((function(t,e){if(u!==e){var r=z(s,t),i=0===r?0:1/r,a=n[e][u];f+=o[u][e],l+=o[u][e]*(t.x+a*(s.x-t.x)*i),c+=o[u][e]*(t.y+a*(s.y-t.y)*i)}}));var g=0===r[u]?0:1/r[u];f*=a,f+=t*g*g,l*=a,l+=t*g*s.x*d,s.x=l/f,c*=a,c+=t*g*s.y*d,s.y=c/f}}))},t}(),Pn=function(t,e,r,n,o,i,a){if(!t)return[];var s=[];if(e){var u={};e.forEach((function(e,h){var d=[];e.forEach((function(e,s){var l,c;if(h===s)d.push(0);else if(n[h]===n[s])if("data"===i)d.push(e*(Math.abs(h-s)*a)/(n[h]/o));else if(i){var f=void 0,g=void 0;if(u[t[h].id])f=u[t[h].id];else{var p=("id"===i?t[h].id:null===(l=t[h].data)||void 0===l?void 0:l[i])||0;f=H(p)?p.charCodeAt(0):p,u[t[h].id]=f}u[t[s].id]?g=u[t[s].id]:(p=("id"===i?t[s].id:null===(c=t[s].data)||void 0===c?void 0:c[i])||0,g=H(p)?p.charCodeAt(0):p,u[t[s].id]=g),d.push(e*(Math.abs(f-g)*a)/(n[h]/o))}else d.push(e*r/(n[h]/o));else{var v=(r+o)/2;d.push(e*v)}})),s.push(d)}))}return s},Cn=function(t){for(var e=t.length,r=t[0].length,n=[],o=0;o<e;o++){for(var i=[],a=0;a<r;a++)0!==t[o][a]?i.push(1/(t[o][a]*t[o][a])):i.push(0);n.push(i)}return n},Ln=function(t,e){var r=-1;return t.forEach((function(t,n){t.id===e&&(r=n)})),Math.max(r,0)},qn=function(t,e,r){for(var n=t.length,o=0;o<n;o++)if(t[e][o]===1/0){t[e][o]=r,t[o][e]=r;for(var i=0;i<n;i++)t[o][i]!==1/0&&t[e][i]===1/0&&(t[e][i]=r+t[o][i],t[i][e]=r+t[o][i])}for(o=0;o<n;o++)if(o!==e)for(i=0;i<n;i++)if(t[o][i]===1/0){var a=Math.abs(t[e][o]-t[e][i]);a=0===a?1:a,t[o][i]=a}},jn=function(t,e){for(var r=0,n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r},Fn={center:[0,0],width:300,height:300},Vn=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="random",this.options=r(r({},Fn),t)}return t.prototype.execute=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.genericRandomLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return o(this,void 0,void 0,(function(){return i(this,(function(r){return this.genericRandomLayout(!0,t,e),[2]}))}))},t.prototype.genericRandomLayout=function(t,e,n){return o(this,void 0,void 0,(function(){var o,a,s,u,h,d,l,c,f;return i(this,(function(i){return o=r(r({},this.options),n),a=o.center,s=o.width,u=o.height,h=e.getAllNodes(),d=s||"undefined"==typeof window?s:window.innerWidth,l=u||"undefined"==typeof window?u:window.innerHeight,c=a||[d/2,l/2],f=[],h&&h.forEach((function(t){f.push({id:t.id,data:{x:.9*(Math.random()-.5)*d+c[0],y:.9*(Math.random()-.5)*l+c[1]}})})),t&&f.forEach((function(t){return e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),[2,{nodes:f,edges:e.getAllEdges()}]}))}))},t}(),Wn={circular:j,concentric:K,mds:An,random:Vn,grid:Qr,radial:Tn,force:Pr,d3force:Ht,fruchterman:Yr,forceAtlas2:Ur,dagre:Nr};function Gn(t,e){Wn[t]=e}function Bn(t){return!!t.tick&&!!t.stop}})();var _=A.ul,z={}.toString;const R=function(t){return function(t,e){return z.call(t)==="[object "+e+"]"}(t,"Number")};var D=function(t,e,r){var n=[],o=[],i=[],a=[],s={};return t.forEach((function(t,e){s[t.id]=e,n.push(t.data.x,t.data.y),3===r&&n.push(t.data.z),o.push(t.data.mass||1)})),e.forEach((function(t){var e=t.data.weight||1,r=s[t.source],n=s[t.target];void 0!==r&&void 0!==n&&(i.push([n,r]),a.push(e),o[r]+=e,o[n]+=e)})),{nodes:n,masses:o,edges:i,weights:a}};function I(t){return{mean:0,min:1,max:2}[t]}var O={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster",maxDistance:1/0},T=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="fruchtermanWASM",this.options=r(r({},O),t)}return t.prototype.execute=function(t,e){return n(this,void 0,void 0,(function(){return o(this,(function(r){return[2,this.genericFruchtermanLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return n(this,void 0,void 0,(function(){return o(this,(function(r){return this.genericFruchtermanLayout(!0,t,e),[2]}))}))},t.prototype.genericFruchtermanLayout=function(t,e,i){return n(this,void 0,void 0,(function(){var n,a,s,u,h,d,l,c,f,g,p,v,y,m,w,x,E;return o(this,(function(o){switch(o.label){case 0:return n=this.formatOptions(i),a=n.threads,s=n.dimensions,u=n.width,h=n.height,d=n.center,l=n.maxIteration,c=n.minMovement,f=n.distanceThresholdMode,g=n.gravity,p=n.speed,v=n.maxDistance,y=e.getAllNodes(),m=e.getAllEdges(),(null==y?void 0:y.length)?1===y.length?(t&&e.mergeNodeData(y[0].id,{x:d[0],y:d[1],z:3===s?d[2]:void 0}),[2,{nodes:[r(r({},y[0]),{data:r(r({},y[0].data),{x:d[0],y:d[1],z:3===s?d[2]:void 0})})],edges:m}]):((w=y.map((function(t){return _(t,[u,h])}))).forEach((function(t,e){R(t.data.x)||(t.data.x=Math.random()*u),R(t.data.y)||(t.data.y=Math.random()*h),3===s&&(R(t.data.z)||(t.data.z=Math.random()*Math.sqrt(u*h)))})),x=D(w,m,s),[4,a.fruchterman({dimensions:s,nodes:x.nodes,edges:x.edges,masses:x.masses,weights:x.weights,iterations:l,min_movement:c,distance_threshold_mode:I(f),center:d,height:h,width:u,kg:g,speed:p,max_distance:v})]):[2,{nodes:[],edges:m}];case 1:return E=o.sent().nodes,w.forEach((function(t,e){t.data.x=E[s*e],t.data.y=E[s*e+1],3===s&&(t.data.z=E[s*e+2])})),t&&w.forEach((function(t){var r=t.id,n=t.data,o={x:n.x,y:n.y};3===s&&(o.z=n.z),e.mergeNodeData(r,o)})),[2,{nodes:w,edges:m}]}}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=r(r({},this.options),t),n=e.clustering,o=e.nodeClusterBy,i=e.center,a=e.width,s=e.height;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=s||"undefined"==typeof window?s:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=n&&!!o,e},t}(),P={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1,maxDistance:1/0},C=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceAtlas2WASM",this.options=r(r({},P),t)}return t.prototype.execute=function(t,e){return n(this,void 0,void 0,(function(){return o(this,(function(r){return[2,this.genericForceAtlas2Layout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return n(this,void 0,void 0,(function(){return o(this,(function(r){return this.genericForceAtlas2Layout(!0,t,e),[2]}))}))},t.prototype.genericForceAtlas2Layout=function(t,e,i){return n(this,void 0,void 0,(function(){var n,a,s,u,h,d,l,c,f,g,p,v,y,m,w,x,E,N,b,M;return o(this,(function(o){switch(o.label){case 0:return n=this.formatOptions(i),a=n.threads,s=n.dimensions,u=n.width,h=n.height,d=n.center,l=n.maxIteration,c=n.minMovement,f=n.distanceThresholdMode,n.tao,g=n.kr,p=n.kg,v=n.ks,y=n.dissuadeHubs,m=n.mode,w=n.maxDistance,x=e.getAllNodes(),E=e.getAllEdges(),(null==x?void 0:x.length)?1===x.length?(t&&e.mergeNodeData(x[0].id,{x:d[0],y:d[1],z:3===s?d[2]:void 0}),[2,{nodes:[r(r({},x[0]),{data:r(r({},x[0].data),{x:d[0],y:d[1],z:3===s?d[2]:void 0})})],edges:E}]):((N=x.map((function(t){return _(t,[u,h])}))).forEach((function(t,e){R(t.data.x)||(t.data.x=Math.random()*u),R(t.data.y)||(t.data.y=Math.random()*h),3===s&&(R(t.data.z)||(t.data.z=Math.random()*Math.sqrt(u*h)))})),b=D(N,E,s),[4,a.forceatlas2({dimensions:s,nodes:b.nodes,edges:b.edges,masses:b.masses,weights:b.weights,iterations:l,min_movement:c,distance_threshold_mode:I(f),center:d,ka:1,kg:p,kr:g,speed:v,prevent_overlapping:!1,node_radius:10,kr_prime:10,strong_gravity:!1,lin_log:"linlog"===m,dissuade_hubs:y,max_distance:w})]):[2,{nodes:[],edges:E}];case 1:return M=o.sent().nodes,N.forEach((function(t,e){t.data.x=M[s*e],t.data.y=M[s*e+1],3===s&&(t.data.z=M[s*e+2])})),t&&N.forEach((function(t){var r=t.id,n=t.data,o={x:n.x,y:n.y};3===s&&(o.z=n.z),e.mergeNodeData(r,o)})),[2,{nodes:N,edges:E}]}}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=r(r({},this.options),t),n=e.center,o=e.width,i=e.height;return e.barnesHut,e.prune,e.maxIteration,e.kr,e.kg,e.width=o||"undefined"==typeof window?o:window.innerWidth,e.height=i||"undefined"==typeof window?i:window.innerHeight,e.center=n||[e.width/2,e.height/2],e},t}(),L={maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean",maxDistance:1/0},q=function(){function t(t){void 0===t&&(t={}),this.options=t,this.id="forceWASM",this.options=r(r({},L),t)}return t.prototype.execute=function(t,e){return n(this,void 0,void 0,(function(){return o(this,(function(r){return[2,this.genericForceLayout(!1,t,e)]}))}))},t.prototype.assign=function(t,e){return n(this,void 0,void 0,(function(){return o(this,(function(r){return this.genericForceLayout(!0,t,e),[2]}))}))},t.prototype.genericForceLayout=function(t,e,i){return n(this,void 0,void 0,(function(){var n,a,s,u,h,d,l,c,f,g,p,v,y,m,w,x,E,N,b,M,S,k,A,z;return o(this,(function(o){switch(o.label){case 0:return n=this.formatOptions(i),a=n.threads,s=n.dimensions,u=n.width,h=n.height,d=n.center,l=n.maxIteration,c=n.minMovement,f=n.distanceThresholdMode,g=n.gravity,p=n.factor,v=n.interval,y=n.damping,m=n.maxSpeed,w=n.edgeStrength,x=n.linkDistance,E=n.nodeStrength,N=n.coulombDisScale,b=n.maxDistance,M=e.getAllNodes(),S=e.getAllEdges(),(null==M?void 0:M.length)?1===M.length?(t&&e.mergeNodeData(M[0].id,{x:d[0],y:d[1],z:3===s?d[2]:void 0}),[2,{nodes:[r(r({},M[0]),{data:r(r({},M[0].data),{x:d[0],y:d[1],z:3===s?d[2]:void 0})})],edges:S}]):((k=M.map((function(t){return _(t,[u,h])}))).forEach((function(t){R(t.data.x)||(t.data.x=Math.random()*u),R(t.data.y)||(t.data.y=Math.random()*h),3===s&&(R(t.data.z)||(t.data.z=Math.random()*Math.sqrt(u*h)))})),A=D(k,S,s),[4,a.force2({dimensions:s,nodes:A.nodes,edges:A.edges,masses:A.masses,weights:A.weights,iterations:l,min_movement:c,distance_threshold_mode:I(f),center:d,edge_strength:w,link_distance:x,node_strength:E,coulomb_dis_scale:N,kg:g,factor:p,interval:v,damping:y,max_speed:m,max_distance:b})]):[2,{nodes:[],edges:S}];case 1:return z=o.sent().nodes,k.forEach((function(t,e){t.data.x=z[s*e],t.data.y=z[s*e+1],3===s&&(t.data.z=z[s*e+2])})),t&&k.forEach((function(t){var r=t.id,n=t.data,o={x:n.x,y:n.y};3===s&&(o.z=n.z),e.mergeNodeData(r,o)})),[2,{nodes:k,edges:S}]}}))}))},t.prototype.formatOptions=function(t){void 0===t&&(t={});var e=r(r({},this.options),t),n=e.center,o=e.width,i=e.height;return e.width=o||"undefined"==typeof window?o:window.innerWidth,e.height=i||"undefined"==typeof window?i:window.innerHeight,e.center=n||[e.width/2,e.height/2],e},t}();return e})()}));