/*! For license information please see main.js.LICENSE.txt */
(()=>{var e={164:(e,t,n)=>{var r=n(0);e.exports=function(e,t){if(!r(e))throw new Error("graphology-generators/random/clusters: invalid Graph constructor.");var n="clusterDensity"in(t=t||{})?t.clusterDensity:.5,i=t.rng||Math.random,o=t.order,a=t.size,s=t.clusters;if("number"!=typeof n||n>1||n<0)throw new Error("graphology-generators/random/clusters: `clusterDensity` option should be a number between 0 and 1.");if("function"!=typeof i)throw new Error("graphology-generators/random/clusters: `rng` option should be a function.");if("number"!=typeof o||o<=0)throw new Error("graphology-generators/random/clusters: `order` option should be a positive number.");if("number"!=typeof a||a<=0)throw new Error("graphology-generators/random/clusters: `size` option should be a positive number.");if("number"!=typeof s||s<=0)throw new Error("graphology-generators/random/clusters: `clusters` option should be a positive number.");var u=new e;if(!o)return u;var c,d,f,l,h,p,g=new Array(s);for(f=0;f<s;f++)g[f]=[];for(f=0;f<o;f++)c=i()*s|0,u.addNode(f,{cluster:c}),g[c].push(f);if(!a)return u;for(f=0;f<a;f++){if(i()<1-n){l=i()*o|0;do{h=i()*o|0}while(l===h)}else{if(!(p=(d=g[c=i()*s|0]).length)||p<2)continue;l=d[i()*p|0];do{h=d[i()*p|0]}while(l===h)}u.multi?u.addEdge(l,h):u.mergeEdge(l,h)}return u}},248:(e,t,n)=>{var r=n(0),i=n(682).QZ;function o(e,t){if(!r(e))throw new Error("graphology-generators/random/erdos-renyi: invalid Graph constructor.");var n,o,a=t.order,s=t.probability,u=t.rng||Math.random,c=new e;if("number"==typeof t.approximateSize&&(s=i(c.type,!1,a,t.approximateSize)),"number"!=typeof a||a<=0)throw new Error("graphology-generators/random/erdos-renyi: invalid `order`. Should be a positive number.");if("number"!=typeof s||s<0||s>1)throw new Error("graphology-generators/random/erdos-renyi: invalid `probability`. Should be a number between 0 and 1. Or maybe you gave an `approximateSize` exceeding the graph's density.");if("function"!=typeof u)throw new Error("graphology-generators/random/erdos-renyi: invalid `rng`. Should be a function.");for(n=0;n<a;n++)c.addNode(n);if(s<=0)return c;for(n=0;n<a;n++)for(o=n+1;o<a;o++)"directed"!==c.type&&u()<s&&c.addUndirectedEdge(n,o),"undirected"!==c.type&&(u()<s&&c.addDirectedEdge(n,o),u()<s&&c.addDirectedEdge(o,n));return c}o.sparse=function(e,t){if(!r(e))throw new Error("graphology-generators/random/erdos-renyi: invalid Graph constructor.");var n=t.order,o=t.probability,a=t.rng||Math.random,s=new e;if("number"==typeof t.approximateSize&&(o=i(s.type,!1,n,t.approximateSize)),"number"!=typeof n||n<=0)throw new Error("graphology-generators/random/erdos-renyi: invalid `order`. Should be a positive number.");if("number"!=typeof o||o<0||o>1)throw new Error("graphology-generators/random/erdos-renyi: invalid `probability`. Should be a number between 0 and 1. Or maybe you gave an `approximateSize` exceeding the graph's density.");if("function"!=typeof a)throw new Error("graphology-generators/random/erdos-renyi: invalid `rng`. Should be a function.");for(var u=0;u<n;u++)s.addNode(u);if(o<=0)return s;var c,d=-1,f=Math.log(1-o);if("undirected"!==s.type)for(c=0;c<n;){for(c===(d+=1+(Math.log(1-a())/f|0))&&d++;c<n&&n<=d;)++c==(d-=n)&&d++;c<n&&s.addDirectedEdge(c,d)}if(d=-1,"directed"!==s.type)for(c=1;c<n;){for(d+=1+(Math.log(1-a())/f|0);d>=c&&c<n;)d-=c,c++;c<n&&s.addUndirectedEdge(c,d)}return s},e.exports=o},490:(e,t,n)=>{var r=n(0);e.exports=function(e,t){if(!r(e))throw new Error("graphology-generators/random/girvan-newman: invalid Graph constructor.");var n=t.zOut,i=t.rng||Math.random;if("number"!=typeof n)throw new Error("graphology-generators/random/girvan-newman: invalid `zOut`. Should be a number.");if("function"!=typeof i)throw new Error("graphology-generators/random/girvan-newman: invalid `rng`. Should be a function.");var o,a,s,u=n/96,c=(16-96*u)/31,d=new e;for(a=0;a<128;a++)d.addNode(a);for(a=0;a<128;a++)for(s=a+1;s<128;s++)o=i(),a%4==s%4?o<c&&d.addEdge(a,s):o<u&&d.addEdge(a,s);return d}},154:(e,t,n)=>{t.clusters=n(164),n(248),n(490)},750:e=>{e.exports={linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:1,scalingRatio:1,strongGravityMode:!1,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5}},564:(e,t)=>{t.assign=function(e){e=e||{};var t,n,r,i=Array.prototype.slice.call(arguments).slice(1);for(t=0,r=i.length;t<r;t++)if(i[t])for(n in i[t])e[n]=i[t][n];return e},t.validateSettings=function(e){return"linLogMode"in e&&"boolean"!=typeof e.linLogMode?{message:"the `linLogMode` setting should be a boolean."}:"outboundAttractionDistribution"in e&&"boolean"!=typeof e.outboundAttractionDistribution?{message:"the `outboundAttractionDistribution` setting should be a boolean."}:"adjustSizes"in e&&"boolean"!=typeof e.adjustSizes?{message:"the `adjustSizes` setting should be a boolean."}:"edgeWeightInfluence"in e&&"number"!=typeof e.edgeWeightInfluence?{message:"the `edgeWeightInfluence` setting should be a number."}:!("scalingRatio"in e)||"number"==typeof e.scalingRatio&&e.scalingRatio>=0?"strongGravityMode"in e&&"boolean"!=typeof e.strongGravityMode?{message:"the `strongGravityMode` setting should be a boolean."}:!("gravity"in e)||"number"==typeof e.gravity&&e.gravity>=0?"slowDown"in e&&!("number"==typeof e.slowDown||e.slowDown>=0)?{message:"the `slowDown` setting should be a number >= 0."}:"barnesHutOptimize"in e&&"boolean"!=typeof e.barnesHutOptimize?{message:"the `barnesHutOptimize` setting should be a boolean."}:!("barnesHutTheta"in e)||"number"==typeof e.barnesHutTheta&&e.barnesHutTheta>=0?null:{message:"the `barnesHutTheta` setting should be a number >= 0."}:{message:"the `gravity` setting should be a number >= 0."}:{message:"the `scalingRatio` setting should be a number >= 0."}},t.graphToByteArrays=function(e,t){var n,r=e.order,i=e.size,o={},a=new Float32Array(10*r),s=new Float32Array(3*i);return n=0,e.forEachNode((function(e,t){o[e]=n,a[n]=t.x,a[n+1]=t.y,a[n+2]=0,a[n+3]=0,a[n+4]=0,a[n+5]=0,a[n+6]=1,a[n+7]=1,a[n+8]=t.size||1,a[n+9]=t.fixed?1:0,n+=10})),n=0,e.forEachEdge((function(e,r,i,u,c,d,f){var l=o[i],h=o[u];a[l+6]+=1,a[h+6]+=1,s[n]=l,s[n+1]=h,s[n+2]=t(e,r,i,u,c,d,f),n+=3})),{nodes:a,edges:s}},t.assignLayoutChanges=function(e,t,n){var r=0;e.updateEachNodeAttributes((function(e,i){return i.x=t[r],i.y=t[r+1],r+=10,n?n(e,i):i}))},t.readGraphPositions=function(e,t){var n=0;e.forEachNode((function(e,r){t[n]=r.x,t[n+1]=r.y,n+=10}))},t.collectLayoutChanges=function(e,t,n){for(var r=e.nodes(),i={},o=0,a=0,s=t.length;o<s;o+=10){if(n){var u=Object.assign({},e.getNodeAttributes(r[a]));u.x=t[o],u.y=t[o+1],u=n(r[a],u),i[r[a]]={x:u.x,y:u.y}}else i[r[a]]={x:t[o],y:t[o+1]};a++}return i},t.createWorker=function(e){var t=window.URL||window.webkitURL,n=e.toString(),r=t.createObjectURL(new Blob(["("+n+").call(this);"],{type:"text/javascript"})),i=new Worker(r);return t.revokeObjectURL(r),i}},524:(e,t,n)=>{var r=n(724),i=n(302).Q6,o=n(618),a=n(564),s=n(750);function u(e,t,n){if(!r(t))throw new Error("graphology-layout-forceatlas2: the given graph is not a valid graphology instance.");"number"==typeof n&&(n={iterations:n});var u=n.iterations;if("number"!=typeof u)throw new Error("graphology-layout-forceatlas2: invalid number of iterations.");if(u<=0)throw new Error("graphology-layout-forceatlas2: you should provide a positive number of iterations.");var c=i(n.getEdgeWeight).fromEntry,d="function"==typeof n.outputReducer?n.outputReducer:null,f=a.assign({},s,n.settings),l=a.validateSettings(f);if(l)throw new Error("graphology-layout-forceatlas2: "+l.message);var h,p=a.graphToByteArrays(t,c);for(h=0;h<u;h++)o(f,p.nodes,p.edges);if(!e)return a.collectLayoutChanges(t,p.nodes);a.assignLayoutChanges(t,p.nodes,d)}var c=u.bind(null,!1);c.assign=u.bind(null,!0),c.inferSettings=function(e){var t="number"==typeof e?e:e.order;return{barnesHutOptimize:t>2e3,strongGravityMode:!0,gravity:.05,scalingRatio:10,slowDown:1+Math.log(t)}},e.exports=c},618:e=>{var t=10;e.exports=function(e,n,r){var i,o,a,s,u,c,d,f,l,h,p,g,m,y,v,b,E,_,w,x,A,T,S,N=n.length,D=r.length,I=e.adjustSizes,R=e.barnesHutTheta*e.barnesHutTheta,k=[];for(a=0;a<N;a+=t)n[a+4]=n[a+2],n[a+5]=n[a+3],n[a+2]=0,n[a+3]=0;if(e.outboundAttractionDistribution){for(p=0,a=0;a<N;a+=t)p+=n[a+6];p/=N/t}if(e.barnesHutOptimize){var O,C,L,G=1/0,M=-1/0,U=1/0,P=-1/0;for(a=0;a<N;a+=t)G=Math.min(G,n[a+0]),M=Math.max(M,n[a+0]),U=Math.min(U,n[a+1]),P=Math.max(P,n[a+1]);var z=M-G,F=P-U;for(z>F?P=(U-=(z-F)/2)+z:M=(G-=(F-z)/2)+F,k[0]=-1,k[1]=(G+M)/2,k[2]=(U+P)/2,k[3]=Math.max(M-G,P-U),k[4]=-1,k[5]=-1,k[6]=0,k[7]=0,k[8]=0,i=1,a=0;a<N;a+=t)for(o=0,L=3;;){if(!(k[o+5]>=0)){if(k[o+0]<0){k[o+0]=a;break}if(k[o+5]=9*i,f=k[o+3]/2,k[(l=k[o+5])+0]=-1,k[l+1]=k[o+1]-f,k[l+2]=k[o+2]-f,k[l+3]=f,k[l+4]=l+9,k[l+5]=-1,k[l+6]=0,k[l+7]=0,k[l+8]=0,k[(l+=9)+0]=-1,k[l+1]=k[o+1]-f,k[l+2]=k[o+2]+f,k[l+3]=f,k[l+4]=l+9,k[l+5]=-1,k[l+6]=0,k[l+7]=0,k[l+8]=0,k[(l+=9)+0]=-1,k[l+1]=k[o+1]+f,k[l+2]=k[o+2]-f,k[l+3]=f,k[l+4]=l+9,k[l+5]=-1,k[l+6]=0,k[l+7]=0,k[l+8]=0,k[(l+=9)+0]=-1,k[l+1]=k[o+1]+f,k[l+2]=k[o+2]+f,k[l+3]=f,k[l+4]=k[o+4],k[l+5]=-1,k[l+6]=0,k[l+7]=0,k[l+8]=0,i+=4,O=n[k[o+0]+0]<k[o+1]?n[k[o+0]+1]<k[o+2]?k[o+5]:k[o+5]+9:n[k[o+0]+1]<k[o+2]?k[o+5]+18:k[o+5]+27,k[o+6]=n[k[o+0]+6],k[o+7]=n[k[o+0]+0],k[o+8]=n[k[o+0]+1],k[O+0]=k[o+0],k[o+0]=-1,O===(C=n[a+0]<k[o+1]?n[a+1]<k[o+2]?k[o+5]:k[o+5]+9:n[a+1]<k[o+2]?k[o+5]+18:k[o+5]+27)){if(L--){o=O;continue}L=3;break}k[C+0]=a;break}O=n[a+0]<k[o+1]?n[a+1]<k[o+2]?k[o+5]:k[o+5]+9:n[a+1]<k[o+2]?k[o+5]+18:k[o+5]+27,k[o+7]=(k[o+7]*k[o+6]+n[a+0]*n[a+6])/(k[o+6]+n[a+6]),k[o+8]=(k[o+8]*k[o+6]+n[a+1]*n[a+6])/(k[o+6]+n[a+6]),k[o+6]+=n[a+6],o=O}}if(e.barnesHutOptimize){for(g=e.scalingRatio,a=0;a<N;a+=t)for(o=0;;)if(k[o+5]>=0){if(b=Math.pow(n[a+0]-k[o+7],2)+Math.pow(n[a+1]-k[o+8],2),4*(h=k[o+3])*h/b<R){if(m=n[a+0]-k[o+7],y=n[a+1]-k[o+8],!0===I?b>0?(E=g*n[a+6]*k[o+6]/b,n[a+2]+=m*E,n[a+3]+=y*E):b<0&&(E=-g*n[a+6]*k[o+6]/Math.sqrt(b),n[a+2]+=m*E,n[a+3]+=y*E):b>0&&(E=g*n[a+6]*k[o+6]/b,n[a+2]+=m*E,n[a+3]+=y*E),(o=k[o+4])<0)break;continue}o=k[o+5]}else if((c=k[o+0])>=0&&c!==a&&(b=(m=n[a+0]-n[c+0])*m+(y=n[a+1]-n[c+1])*y,!0===I?b>0?(E=g*n[a+6]*n[c+6]/b,n[a+2]+=m*E,n[a+3]+=y*E):b<0&&(E=-g*n[a+6]*n[c+6]/Math.sqrt(b),n[a+2]+=m*E,n[a+3]+=y*E):b>0&&(E=g*n[a+6]*n[c+6]/b,n[a+2]+=m*E,n[a+3]+=y*E)),(o=k[o+4])<0)break}else for(g=e.scalingRatio,s=0;s<N;s+=t)for(u=0;u<s;u+=t)m=n[s+0]-n[u+0],y=n[s+1]-n[u+1],!0===I?(b=Math.sqrt(m*m+y*y)-n[s+8]-n[u+8])>0?(E=g*n[s+6]*n[u+6]/b/b,n[s+2]+=m*E,n[s+3]+=y*E,n[u+2]+=m*E,n[u+3]+=y*E):b<0&&(E=100*g*n[s+6]*n[u+6],n[s+2]+=m*E,n[s+3]+=y*E,n[u+2]-=m*E,n[u+3]-=y*E):(b=Math.sqrt(m*m+y*y))>0&&(E=g*n[s+6]*n[u+6]/b/b,n[s+2]+=m*E,n[s+3]+=y*E,n[u+2]-=m*E,n[u+3]-=y*E);for(l=e.gravity/e.scalingRatio,g=e.scalingRatio,a=0;a<N;a+=t)E=0,m=n[a+0],y=n[a+1],b=Math.sqrt(Math.pow(m,2)+Math.pow(y,2)),e.strongGravityMode?b>0&&(E=g*n[a+6]*l):b>0&&(E=g*n[a+6]*l/b),n[a+2]-=m*E,n[a+3]-=y*E;for(g=1*(e.outboundAttractionDistribution?p:1),d=0;d<D;d+=3)s=r[d+0],u=r[d+1],f=r[d+2],v=Math.pow(f,e.edgeWeightInfluence),m=n[s+0]-n[u+0],y=n[s+1]-n[u+1],!0===I?(b=Math.sqrt(m*m+y*y)-n[s+8]-n[u+8],e.linLogMode?e.outboundAttractionDistribution?b>0&&(E=-g*v*Math.log(1+b)/b/n[s+6]):b>0&&(E=-g*v*Math.log(1+b)/b):e.outboundAttractionDistribution?b>0&&(E=-g*v/n[s+6]):b>0&&(E=-g*v)):(b=Math.sqrt(Math.pow(m,2)+Math.pow(y,2)),e.linLogMode?e.outboundAttractionDistribution?b>0&&(E=-g*v*Math.log(1+b)/b/n[s+6]):b>0&&(E=-g*v*Math.log(1+b)/b):e.outboundAttractionDistribution?(b=1,E=-g*v/n[s+6]):(b=1,E=-g*v)),b>0&&(n[s+2]+=m*E,n[s+3]+=y*E,n[u+2]-=m*E,n[u+3]-=y*E);if(!0===I)for(a=0;a<N;a+=t)1!==n[a+9]&&((_=Math.sqrt(Math.pow(n[a+2],2)+Math.pow(n[a+3],2)))>10&&(n[a+2]=10*n[a+2]/_,n[a+3]=10*n[a+3]/_),w=n[a+6]*Math.sqrt((n[a+4]-n[a+2])*(n[a+4]-n[a+2])+(n[a+5]-n[a+3])*(n[a+5]-n[a+3])),x=Math.sqrt((n[a+4]+n[a+2])*(n[a+4]+n[a+2])+(n[a+5]+n[a+3])*(n[a+5]+n[a+3]))/2,A=.1*Math.log(1+x)/(1+Math.sqrt(w)),T=n[a+0]+n[a+2]*(A/e.slowDown),n[a+0]=T,S=n[a+1]+n[a+3]*(A/e.slowDown),n[a+1]=S);else for(a=0;a<N;a+=t)1!==n[a+9]&&(w=n[a+6]*Math.sqrt((n[a+4]-n[a+2])*(n[a+4]-n[a+2])+(n[a+5]-n[a+3])*(n[a+5]-n[a+3])),x=Math.sqrt((n[a+4]+n[a+2])*(n[a+4]+n[a+2])+(n[a+5]+n[a+3])*(n[a+5]+n[a+3]))/2,A=n[a+7]*Math.log(1+x)/(1+Math.sqrt(w)),n[a+7]=Math.min(1,Math.sqrt(A*(Math.pow(n[a+2],2)+Math.pow(n[a+3],2))/(1+Math.sqrt(w)))),T=n[a+0]+n[a+2]*(A/e.slowDown),n[a+0]=T,S=n[a+1]+n[a+3]*(A/e.slowDown),n[a+1]=S);return{}}},682:(e,t,n)=>{var r=n(724),i=n(573);function o(e,t){return 2*t/(e*(e-1))}function a(e,t){return t/(e*(e-1))}function s(e,t){var n=e*(e-1);return t/(n+n/2)}function u(e,t,n){var u,c;if(arguments.length>3){if(c=arguments[3],"number"!=typeof(u=n)||u<0)throw new Error("graphology-metrics/density: given order is not a valid number.");if("number"!=typeof c||c<0)throw new Error("graphology-metrics/density: given size is not a valid number.")}else{if(!r(n))throw new Error("graphology-metrics/density: given graph is not a valid graphology instance.");u=n.order,c=n.size,n.multi&&!1===t&&(c=i(n))}return u<2?0:(null===e&&(e=n.type),null===t&&(t=n.multi),("undirected"===e?o:"directed"===e?a:s)(u,c))}t.QZ=u,u.bind(null,null,null),u.bind(null,"directed",!1),u.bind(null,"undirected",!1),u.bind(null,"mixed",!1),u.bind(null,"directed",!0),u.bind(null,"undirected",!0),u.bind(null,"mixed",!0)},573:(e,t,n)=>{var r=n(724);e.exports=function(e){if(!r(e))throw new Error("graphology-metrics/simple-size: the given graph is not a valid graphology instance.");if(!e.multi)return e.size;var t=0,n=0;function i(){t++}function o(){n++}return e.forEachNode((function(t){"directed"!==e.type&&e.forEachUndirectedNeighbor(t,i),"undirected"!==e.type&&e.forEachOutNeighbor(t,o)})),t/2+n}},302:(e,t)=>{function n(e){return"number"!=typeof e||isNaN(e)?1:e}t.Q6=function(e){return function(e,t){var n={},r=function(e){return void 0===e?t:e};"function"==typeof t&&(r=t);var i=function(t){return r(t[e])},o=function(){return r(void 0)};return"string"==typeof e?(n.fromAttributes=i,n.fromGraph=function(e,t){return i(e.getEdgeAttributes(t))},n.fromEntry=function(e,t){return i(t)},n.fromPartialEntry=n.fromEntry,n.fromMinimalEntry=n.fromEntry):"function"==typeof e?(n.fromAttributes=function(){throw new Error("graphology-utils/getters/createEdgeValueGetter: irrelevant usage.")},n.fromGraph=function(t,n){var i=t.extremities(n);return r(e(n,t.getEdgeAttributes(n),i[0],i[1],t.getNodeAttributes(i[0]),t.getNodeAttributes(i[1]),t.isUndirected(n)))},n.fromEntry=function(t,n,i,o,a,s,u){return r(e(t,n,i,o,a,s,u))},n.fromPartialEntry=function(t,n,i,o){return r(e(t,n,i,o))},n.fromMinimalEntry=function(t,n){return r(e(t,n))}):(n.fromAttributes=o,n.fromGraph=o,n.fromEntry=o,n.fromMinimalEntry=o),n}(e,n)}},0:e=>{e.exports=function(e){return null!==e&&"function"==typeof e&&"object"==typeof e.prototype&&"function"==typeof e.prototype.addUndirectedEdgeWithKey&&"function"==typeof e.prototype.dropNode}},724:e=>{e.exports=function(e){return null!==e&&"object"==typeof e&&"function"==typeof e.addUndirectedEdgeWithKey&&"function"==typeof e.dropNode&&"boolean"==typeof e.multi}},227:function(e){e.exports=function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}function n(e){return n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}function i(e,t,n){return i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct.bind():function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&r(o,n.prototype),o},i.apply(null,arguments)}function o(e){var t="function"==typeof Map?new Map:void 0;return o=function(e){if(null===e||(o=e,-1===Function.toString.call(o).indexOf("[native code]")))return e;var o;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,a)}function a(){return i(e,arguments,n(this).constructor)}return a.prototype=Object.create(e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),r(a,e)},o(e)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var s=function(){for(var e=arguments[0],t=1,n=arguments.length;t<n;t++)if(arguments[t])for(var r in arguments[t])e[r]=arguments[t][r];return e};function u(e,t,n,r){var i=e._nodes.get(t),o=null;return i?o="mixed"===r?i.out&&i.out[n]||i.undirected&&i.undirected[n]:"directed"===r?i.out&&i.out[n]:i.undirected&&i.undirected[n]:o}function c(t){return"object"===e(t)&&null!==t&&t.constructor===Object}function d(e){var t;for(t in e)return!1;return!0}function f(e,t,n){Object.defineProperty(e,t,{enumerable:!1,configurable:!1,writable:!0,value:n})}function l(e,t,n){var r={enumerable:!0,configurable:!0};"function"==typeof n?r.get=n:(r.value=n,r.writable=!1),Object.defineProperty(e,t,r)}function h(e){return!(!c(e)||e.attributes&&!Array.isArray(e.attributes))}"function"==typeof Object.assign&&(s=Object.assign);var p,g={exports:{}},m="object"==typeof Reflect?Reflect:null,y=m&&"function"==typeof m.apply?m.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};p=m&&"function"==typeof m.ownKeys?m.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var v=Number.isNaN||function(e){return e!=e};function b(){b.init.call(this)}g.exports=b,g.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}I(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&I(e,"error",t,{once:!0})}(e,i)}))},b.EventEmitter=b,b.prototype._events=void 0,b.prototype._eventsCount=0,b.prototype._maxListeners=void 0;var E=10;function _(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function w(e){return void 0===e._maxListeners?b.defaultMaxListeners:e._maxListeners}function x(e,t,n,r){var i,o,a,s;if(_(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=w(e))>0&&a.length>i&&!a.warned){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,s=u,console&&console.warn&&console.warn(s)}return e}function A(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function T(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=A.bind(r);return i.listener=n,r.wrapFn=i,i}function S(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):D(i,i.length)}function N(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function D(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function I(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}function R(e){if("function"!=typeof e)throw new Error("obliterator/iterator: expecting a function!");this.next=e}Object.defineProperty(b,"defaultMaxListeners",{enumerable:!0,get:function(){return E},set:function(e){if("number"!=typeof e||e<0||v(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");E=e}}),b.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},b.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||v(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},b.prototype.getMaxListeners=function(){return w(this)},b.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var s=i[e];if(void 0===s)return!1;if("function"==typeof s)y(s,this,t);else{var u=s.length,c=D(s,u);for(n=0;n<u;++n)y(c[n],this,t)}return!0},b.prototype.addListener=function(e,t){return x(this,e,t,!1)},b.prototype.on=b.prototype.addListener,b.prototype.prependListener=function(e,t){return x(this,e,t,!0)},b.prototype.once=function(e,t){return _(t),this.on(e,T(this,e,t)),this},b.prototype.prependOnceListener=function(e,t){return _(t),this.prependListener(e,T(this,e,t)),this},b.prototype.removeListener=function(e,t){var n,r,i,o,a;if(_(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},b.prototype.off=b.prototype.removeListener,b.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},b.prototype.listeners=function(e){return S(this,e,!0)},b.prototype.rawListeners=function(e){return S(this,e,!1)},b.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):N.call(e,t)},b.prototype.listenerCount=N,b.prototype.eventNames=function(){return this._eventsCount>0?p(this._events):[]},"undefined"!=typeof Symbol&&(R.prototype[Symbol.iterator]=function(){return this}),R.of=function(){var e=arguments,t=e.length,n=0;return new R((function(){return n>=t?{done:!0}:{done:!1,value:e[n++]}}))},R.empty=function(){return new R((function(){return{done:!0}}))},R.fromSequence=function(e){var t=0,n=e.length;return new R((function(){return t>=n?{done:!0}:{done:!1,value:e[t++]}}))},R.is=function(e){return e instanceof R||"object"==typeof e&&null!==e&&"function"==typeof e.next};var k=R,O={};O.ARRAY_BUFFER_SUPPORT="undefined"!=typeof ArrayBuffer,O.SYMBOL_SUPPORT="undefined"!=typeof Symbol;var C=k,L=O,G=L.ARRAY_BUFFER_SUPPORT,M=L.SYMBOL_SUPPORT,U=function(e){var t=function(e){return"string"==typeof e||Array.isArray(e)||G&&ArrayBuffer.isView(e)?C.fromSequence(e):"object"!=typeof e||null===e?null:M&&"function"==typeof e[Symbol.iterator]?e[Symbol.iterator]():"function"==typeof e.next?e:null}(e);if(!t)throw new Error("obliterator: target is not iterable nor a valid iterator.");return t},P=U,z=function(e,t){for(var n,r=arguments.length>1?t:1/0,i=r!==1/0?new Array(r):[],o=0,a=P(e);;){if(o===r)return i;if((n=a.next()).done)return o!==t&&(i.length=o),i;i[o++]=n.value}},F=function(e){function n(t){var n;return(n=e.call(this)||this).name="GraphError",n.message=t,n}return t(n,e),n}(o(Error)),B=function(e){function n(t){var r;return(r=e.call(this,t)||this).name="InvalidArgumentsGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(a(r),n.prototype.constructor),r}return t(n,e),n}(F),j=function(e){function n(t){var r;return(r=e.call(this,t)||this).name="NotFoundGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(a(r),n.prototype.constructor),r}return t(n,e),n}(F),V=function(e){function n(t){var r;return(r=e.call(this,t)||this).name="UsageGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(a(r),n.prototype.constructor),r}return t(n,e),n}(F);function W(e,t){this.key=e,this.attributes=t,this.clear()}function H(e,t){this.key=e,this.attributes=t,this.clear()}function X(e,t){this.key=e,this.attributes=t,this.clear()}function Y(e,t,n,r,i){this.key=t,this.attributes=i,this.undirected=e,this.source=n,this.target=r}function K(e,t,n,r,i,o,a){var s,u,c,d;if(r=""+r,0===n){if(!(s=e._nodes.get(r)))throw new j("Graph.".concat(t,': could not find the "').concat(r,'" node in the graph.'));c=i,d=o}else if(3===n){if(i=""+i,!(u=e._edges.get(i)))throw new j("Graph.".concat(t,': could not find the "').concat(i,'" edge in the graph.'));var f=u.source.key,l=u.target.key;if(r===f)s=u.target;else{if(r!==l)throw new j("Graph.".concat(t,': the "').concat(r,'" node is not attached to the "').concat(i,'" edge (').concat(f,", ").concat(l,")."));s=u.source}c=o,d=a}else{if(!(u=e._edges.get(r)))throw new j("Graph.".concat(t,': could not find the "').concat(r,'" edge in the graph.'));s=1===n?u.source:u.target,c=i,d=o}return[s,c,d]}W.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}},H.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}},X.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}},Y.prototype.attach=function(){var e="out",t="in";this.undirected&&(e=t="undirected");var n=this.source.key,r=this.target.key;this.source[e][r]=this,this.undirected&&n===r||(this.target[t][n]=this)},Y.prototype.attachMulti=function(){var e="out",t="in",n=this.source.key,r=this.target.key;this.undirected&&(e=t="undirected");var i=this.source[e],o=i[r];if(void 0===o)return i[r]=this,void(this.undirected&&n===r||(this.target[t][n]=this));o.previous=this,this.next=o,i[r]=this,this.target[t][n]=this},Y.prototype.detach=function(){var e=this.source.key,t=this.target.key,n="out",r="in";this.undirected&&(n=r="undirected"),delete this.source[n][t],delete this.target[r][e]},Y.prototype.detachMulti=function(){var e=this.source.key,t=this.target.key,n="out",r="in";this.undirected&&(n=r="undirected"),void 0===this.previous?void 0===this.next?(delete this.source[n][t],delete this.target[r][e]):(this.next.previous=void 0,this.source[n][t]=this.next,this.target[r][e]=this.next):(this.previous.next=this.next,void 0!==this.next&&(this.next.previous=this.previous))};var q=[{name:function(e){return"get".concat(e,"Attribute")},attacher:function(e,t,n){e.prototype[t]=function(e,r,i){var o=K(this,t,n,e,r,i),a=o[0],s=o[1];return a.attributes[s]}}},{name:function(e){return"get".concat(e,"Attributes")},attacher:function(e,t,n){e.prototype[t]=function(e,r){return K(this,t,n,e,r)[0].attributes}}},{name:function(e){return"has".concat(e,"Attribute")},attacher:function(e,t,n){e.prototype[t]=function(e,r,i){var o=K(this,t,n,e,r,i),a=o[0],s=o[1];return a.attributes.hasOwnProperty(s)}}},{name:function(e){return"set".concat(e,"Attribute")},attacher:function(e,t,n){e.prototype[t]=function(e,r,i,o){var a=K(this,t,n,e,r,i,o),s=a[0],u=a[1],c=a[2];return s.attributes[u]=c,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:u}),this}}},{name:function(e){return"update".concat(e,"Attribute")},attacher:function(e,t,n){e.prototype[t]=function(e,r,i,o){var a=K(this,t,n,e,r,i,o),s=a[0],u=a[1],c=a[2];if("function"!=typeof c)throw new B("Graph.".concat(t,": updater should be a function."));var d=s.attributes,f=c(d[u]);return d[u]=f,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:u}),this}}},{name:function(e){return"remove".concat(e,"Attribute")},attacher:function(e,t,n){e.prototype[t]=function(e,r,i){var o=K(this,t,n,e,r,i),a=o[0],s=o[1];return delete a.attributes[s],this.emit("nodeAttributesUpdated",{key:a.key,type:"remove",attributes:a.attributes,name:s}),this}}},{name:function(e){return"replace".concat(e,"Attributes")},attacher:function(e,t,n){e.prototype[t]=function(e,r,i){var o=K(this,t,n,e,r,i),a=o[0],s=o[1];if(!c(s))throw new B("Graph.".concat(t,": provided attributes are not a plain object."));return a.attributes=s,this.emit("nodeAttributesUpdated",{key:a.key,type:"replace",attributes:a.attributes}),this}}},{name:function(e){return"merge".concat(e,"Attributes")},attacher:function(e,t,n){e.prototype[t]=function(e,r,i){var o=K(this,t,n,e,r,i),a=o[0],u=o[1];if(!c(u))throw new B("Graph.".concat(t,": provided attributes are not a plain object."));return s(a.attributes,u),this.emit("nodeAttributesUpdated",{key:a.key,type:"merge",attributes:a.attributes,data:u}),this}}},{name:function(e){return"update".concat(e,"Attributes")},attacher:function(e,t,n){e.prototype[t]=function(e,r,i){var o=K(this,t,n,e,r,i),a=o[0],s=o[1];if("function"!=typeof s)throw new B("Graph.".concat(t,": provided updater is not a function."));return a.attributes=s(a.attributes),this.emit("nodeAttributesUpdated",{key:a.key,type:"update",attributes:a.attributes}),this}}}],Z=[{name:function(e){return"get".concat(e,"Attribute")},attacher:function(e,t,n){e.prototype[t]=function(e,r){var i;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new V("Graph.".concat(t,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new V("Graph.".concat(t,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var o=""+e,a=""+r;if(r=arguments[2],!(i=u(this,o,a,n)))throw new j("Graph.".concat(t,': could not find an edge for the given path ("').concat(o,'" - "').concat(a,'").'))}else{if("mixed"!==n)throw new V("Graph.".concat(t,": calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type."));if(e=""+e,!(i=this._edges.get(e)))throw new j("Graph.".concat(t,': could not find the "').concat(e,'" edge in the graph.'))}return i.attributes[r]}}},{name:function(e){return"get".concat(e,"Attributes")},attacher:function(e,t,n){e.prototype[t]=function(e){var r;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new V("Graph.".concat(t,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>1){if(this.multi)throw new V("Graph.".concat(t,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var i=""+e,o=""+arguments[1];if(!(r=u(this,i,o,n)))throw new j("Graph.".concat(t,': could not find an edge for the given path ("').concat(i,'" - "').concat(o,'").'))}else{if("mixed"!==n)throw new V("Graph.".concat(t,": calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type."));if(e=""+e,!(r=this._edges.get(e)))throw new j("Graph.".concat(t,': could not find the "').concat(e,'" edge in the graph.'))}return r.attributes}}},{name:function(e){return"has".concat(e,"Attribute")},attacher:function(e,t,n){e.prototype[t]=function(e,r){var i;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new V("Graph.".concat(t,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new V("Graph.".concat(t,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var o=""+e,a=""+r;if(r=arguments[2],!(i=u(this,o,a,n)))throw new j("Graph.".concat(t,': could not find an edge for the given path ("').concat(o,'" - "').concat(a,'").'))}else{if("mixed"!==n)throw new V("Graph.".concat(t,": calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type."));if(e=""+e,!(i=this._edges.get(e)))throw new j("Graph.".concat(t,': could not find the "').concat(e,'" edge in the graph.'))}return i.attributes.hasOwnProperty(r)}}},{name:function(e){return"set".concat(e,"Attribute")},attacher:function(e,t,n){e.prototype[t]=function(e,r,i){var o;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new V("Graph.".concat(t,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new V("Graph.".concat(t,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var a=""+e,s=""+r;if(r=arguments[2],i=arguments[3],!(o=u(this,a,s,n)))throw new j("Graph.".concat(t,': could not find an edge for the given path ("').concat(a,'" - "').concat(s,'").'))}else{if("mixed"!==n)throw new V("Graph.".concat(t,": calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type."));if(e=""+e,!(o=this._edges.get(e)))throw new j("Graph.".concat(t,': could not find the "').concat(e,'" edge in the graph.'))}return o.attributes[r]=i,this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:r}),this}}},{name:function(e){return"update".concat(e,"Attribute")},attacher:function(e,t,n){e.prototype[t]=function(e,r,i){var o;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new V("Graph.".concat(t,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new V("Graph.".concat(t,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var a=""+e,s=""+r;if(r=arguments[2],i=arguments[3],!(o=u(this,a,s,n)))throw new j("Graph.".concat(t,': could not find an edge for the given path ("').concat(a,'" - "').concat(s,'").'))}else{if("mixed"!==n)throw new V("Graph.".concat(t,": calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type."));if(e=""+e,!(o=this._edges.get(e)))throw new j("Graph.".concat(t,': could not find the "').concat(e,'" edge in the graph.'))}if("function"!=typeof i)throw new B("Graph.".concat(t,": updater should be a function."));return o.attributes[r]=i(o.attributes[r]),this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:r}),this}}},{name:function(e){return"remove".concat(e,"Attribute")},attacher:function(e,t,n){e.prototype[t]=function(e,r){var i;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new V("Graph.".concat(t,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new V("Graph.".concat(t,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var o=""+e,a=""+r;if(r=arguments[2],!(i=u(this,o,a,n)))throw new j("Graph.".concat(t,': could not find an edge for the given path ("').concat(o,'" - "').concat(a,'").'))}else{if("mixed"!==n)throw new V("Graph.".concat(t,": calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type."));if(e=""+e,!(i=this._edges.get(e)))throw new j("Graph.".concat(t,': could not find the "').concat(e,'" edge in the graph.'))}return delete i.attributes[r],this.emit("edgeAttributesUpdated",{key:i.key,type:"remove",attributes:i.attributes,name:r}),this}}},{name:function(e){return"replace".concat(e,"Attributes")},attacher:function(e,t,n){e.prototype[t]=function(e,r){var i;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new V("Graph.".concat(t,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new V("Graph.".concat(t,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var o=""+e,a=""+r;if(r=arguments[2],!(i=u(this,o,a,n)))throw new j("Graph.".concat(t,': could not find an edge for the given path ("').concat(o,'" - "').concat(a,'").'))}else{if("mixed"!==n)throw new V("Graph.".concat(t,": calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type."));if(e=""+e,!(i=this._edges.get(e)))throw new j("Graph.".concat(t,': could not find the "').concat(e,'" edge in the graph.'))}if(!c(r))throw new B("Graph.".concat(t,": provided attributes are not a plain object."));return i.attributes=r,this.emit("edgeAttributesUpdated",{key:i.key,type:"replace",attributes:i.attributes}),this}}},{name:function(e){return"merge".concat(e,"Attributes")},attacher:function(e,t,n){e.prototype[t]=function(e,r){var i;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new V("Graph.".concat(t,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new V("Graph.".concat(t,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var o=""+e,a=""+r;if(r=arguments[2],!(i=u(this,o,a,n)))throw new j("Graph.".concat(t,': could not find an edge for the given path ("').concat(o,'" - "').concat(a,'").'))}else{if("mixed"!==n)throw new V("Graph.".concat(t,": calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type."));if(e=""+e,!(i=this._edges.get(e)))throw new j("Graph.".concat(t,': could not find the "').concat(e,'" edge in the graph.'))}if(!c(r))throw new B("Graph.".concat(t,": provided attributes are not a plain object."));return s(i.attributes,r),this.emit("edgeAttributesUpdated",{key:i.key,type:"merge",attributes:i.attributes,data:r}),this}}},{name:function(e){return"update".concat(e,"Attributes")},attacher:function(e,t,n){e.prototype[t]=function(e,r){var i;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new V("Graph.".concat(t,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new V("Graph.".concat(t,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var o=""+e,a=""+r;if(r=arguments[2],!(i=u(this,o,a,n)))throw new j("Graph.".concat(t,': could not find an edge for the given path ("').concat(o,'" - "').concat(a,'").'))}else{if("mixed"!==n)throw new V("Graph.".concat(t,": calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type."));if(e=""+e,!(i=this._edges.get(e)))throw new j("Graph.".concat(t,': could not find the "').concat(e,'" edge in the graph.'))}if("function"!=typeof r)throw new B("Graph.".concat(t,": provided updater is not a function."));return i.attributes=r(i.attributes),this.emit("edgeAttributesUpdated",{key:i.key,type:"update",attributes:i.attributes}),this}}}],Q=k,J=U,$=function(){var e=arguments,t=null,n=-1;return new Q((function(){for(var r=null;;){if(null===t){if(++n>=e.length)return{done:!0};t=J(e[n])}if(!0!==(r=t.next()).done)break;t=null}return r}))},ee=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function te(e,t,n,r){var i=!1;for(var o in t)if(o!==r){var a=t[o];if(i=n(a.key,a.attributes,a.source.key,a.target.key,a.source.attributes,a.target.attributes,a.undirected),e&&i)return a.key}}function ne(e,t,n,r){var i,o,a,s=!1;for(var u in t)if(u!==r){i=t[u];do{if(o=i.source,a=i.target,s=n(i.key,i.attributes,o.key,a.key,o.attributes,a.attributes,i.undirected),e&&s)return i.key;i=i.next}while(void 0!==i)}}function re(e,t){var n,r=Object.keys(e),i=r.length,o=0;return new k((function(){do{if(n)n=n.next;else{if(o>=i)return{done:!0};var a=r[o++];if(a===t){n=void 0;continue}n=e[a]}}while(!n);return{done:!1,value:{edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected}}}))}function ie(e,t,n,r){var i=t[n];if(i){var o=i.source,a=i.target;return r(i.key,i.attributes,o.key,a.key,o.attributes,a.attributes,i.undirected)&&e?i.key:void 0}}function oe(e,t,n,r){var i=t[n];if(i){var o=!1;do{if(o=r(i.key,i.attributes,i.source.key,i.target.key,i.source.attributes,i.target.attributes,i.undirected),e&&o)return i.key;i=i.next}while(void 0!==i)}}function ae(e,t){var n=e[t];return void 0!==n.next?new k((function(){if(!n)return{done:!0};var e={edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected};return n=n.next,{done:!1,value:e}})):k.of({edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected})}function se(e,t,n,r){if(0!==t.size)for(var i,o,a="mixed"!==n&&n!==t.type,s="undirected"===n,u=!1,c=t._edges.values();!0!==(i=c.next()).done;)if(o=i.value,!a||o.undirected===s){var d=o,f=d.key,l=d.attributes,h=d.source,p=d.target;if(u=r(f,l,h.key,p.key,h.attributes,p.attributes,o.undirected),e&&u)return f}}function ue(e,t,n,r,i,o){var a,s=t?ne:te;if("undirected"!==n){if("out"!==r&&(a=s(e,i.in,o),e&&a))return a;if("in"!==r&&(a=s(e,i.out,o,r?void 0:i.key),e&&a))return a}if("directed"!==n&&(a=s(e,i.undirected,o),e&&a))return a}function ce(e,t,n,r,i,o,a){var s,u=n?oe:ie;if("undirected"!==t){if(void 0!==i.in&&"out"!==r&&(s=u(e,i.in,o,a),e&&s))return s;if(void 0!==i.out&&"in"!==r&&(r||i.key!==o)&&(s=u(e,i.out,o,a),e&&s))return s}if("directed"!==t&&void 0!==i.undirected&&(s=u(e,i.undirected,o,a),e&&s))return s}var de=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function fe(){this.A=null,this.B=null}function le(e,t,n,r,i){for(var o in r){var a=r[o],s=a.source,u=a.target,c=s===n?u:s;if(!t||!t.has(c.key)){var d=i(c.key,c.attributes);if(e&&d)return c.key}}}function he(e,t,n,r,i){if("mixed"!==t){if("undirected"===t)return le(e,null,r,r.undirected,i);if("string"==typeof n)return le(e,null,r,r[n],i)}var o,a=new fe;if("undirected"!==t){if("out"!==n){if(o=le(e,null,r,r.in,i),e&&o)return o;a.wrap(r.in)}if("in"!==n){if(o=le(e,a,r,r.out,i),e&&o)return o;a.wrap(r.out)}}if("directed"!==t&&(o=le(e,a,r,r.undirected,i),e&&o))return o}function pe(e,t,n){var r=Object.keys(n),i=r.length,o=0;return new k((function(){var a=null;do{if(o>=i)return e&&e.wrap(n),{done:!0};var s=n[r[o++]],u=s.source,c=s.target;a=u===t?c:u,e&&e.has(a.key)&&(a=null)}while(null===a);return{done:!1,value:{neighbor:a.key,attributes:a.attributes}}}))}function ge(e,t,n,r,i){for(var o,a,s,u,c,d,f,l=r._nodes.values(),h=r.type;!0!==(o=l.next()).done;){var p=!1;if(a=o.value,"undirected"!==h)for(s in u=a.out){c=u[s];do{if(d=c.target,p=!0,f=i(a.key,d.key,a.attributes,d.attributes,c.key,c.attributes,c.undirected),e&&f)return c;c=c.next}while(c)}if("directed"!==h)for(s in u=a.undirected)if(!(t&&a.key>s)){c=u[s];do{if((d=c.target).key!==s&&(d=c.source),p=!0,f=i(a.key,d.key,a.attributes,d.attributes,c.key,c.attributes,c.undirected),e&&f)return c;c=c.next}while(c)}if(n&&!p&&(f=i(a.key,null,a.attributes,null,null,null,null),e&&f))return null}}function me(e){if(!c(e))throw new B('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in e))throw new B("Graph.import: serialized node is missing its key.");if("attributes"in e&&(!c(e.attributes)||null===e.attributes))throw new B("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function ye(e){if(!c(e))throw new B('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in e))throw new B("Graph.import: serialized edge is missing its source.");if(!("target"in e))throw new B("Graph.import: serialized edge is missing its target.");if("attributes"in e&&(!c(e.attributes)||null===e.attributes))throw new B("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in e&&"boolean"!=typeof e.undirected)throw new B("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}fe.prototype.wrap=function(e){null===this.A?this.A=e:null===this.B&&(this.B=e)},fe.prototype.has=function(e){return null!==this.A&&e in this.A||null!==this.B&&e in this.B};var ve,be=(ve=255&Math.floor(256*Math.random()),function(){return ve++}),Ee=new Set(["directed","undirected","mixed"]),_e=new Set(["domain","_events","_eventsCount","_maxListeners"]),we={allowSelfLoops:!0,multi:!1,type:"mixed"};function xe(e,t,n){var r=new e.NodeDataClass(t,n);return e._nodes.set(t,r),e.emit("nodeAdded",{key:t,attributes:n}),r}function Ae(e,t,n,r,i,o,a,s){if(!r&&"undirected"===e.type)throw new V("Graph.".concat(t,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(r&&"directed"===e.type)throw new V("Graph.".concat(t,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(s&&!c(s))throw new B("Graph.".concat(t,': invalid attributes. Expecting an object but got "').concat(s,'"'));if(o=""+o,a=""+a,s=s||{},!e.allowSelfLoops&&o===a)throw new V("Graph.".concat(t,': source & target are the same ("').concat(o,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var u=e._nodes.get(o),d=e._nodes.get(a);if(!u)throw new j("Graph.".concat(t,': source node "').concat(o,'" not found.'));if(!d)throw new j("Graph.".concat(t,': target node "').concat(a,'" not found.'));var f={key:null,undirected:r,source:o,target:a,attributes:s};if(n)i=e._edgeKeyGenerator();else if(i=""+i,e._edges.has(i))throw new V("Graph.".concat(t,': the "').concat(i,'" edge already exists in the graph.'));if(!e.multi&&(r?void 0!==u.undirected[a]:void 0!==u.out[a]))throw new V("Graph.".concat(t,': an edge linking "').concat(o,'" to "').concat(a,"\" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option."));var l=new Y(r,i,u,d,s);e._edges.set(i,l);var h=o===a;return r?(u.undirectedDegree++,d.undirectedDegree++,h&&(u.undirectedLoops++,e._undirectedSelfLoopCount++)):(u.outDegree++,d.inDegree++,h&&(u.directedLoops++,e._directedSelfLoopCount++)),e.multi?l.attachMulti():l.attach(),r?e._undirectedSize++:e._directedSize++,f.key=i,e.emit("edgeAdded",f),i}function Te(e,t,n,r,i,o,a,u,d){if(!r&&"undirected"===e.type)throw new V("Graph.".concat(t,": you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead."));if(r&&"directed"===e.type)throw new V("Graph.".concat(t,": you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead."));if(u)if(d){if("function"!=typeof u)throw new B("Graph.".concat(t,': invalid updater function. Expecting a function but got "').concat(u,'"'))}else if(!c(u))throw new B("Graph.".concat(t,': invalid attributes. Expecting an object but got "').concat(u,'"'));var f;if(o=""+o,a=""+a,d&&(f=u,u=void 0),!e.allowSelfLoops&&o===a)throw new V("Graph.".concat(t,': source & target are the same ("').concat(o,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var l,h,p=e._nodes.get(o),g=e._nodes.get(a);if(!n&&(l=e._edges.get(i))){if(!(l.source.key===o&&l.target.key===a||r&&l.source.key===a&&l.target.key===o))throw new V("Graph.".concat(t,': inconsistency detected when attempting to merge the "').concat(i,'" edge with "').concat(o,'" source & "').concat(a,'" target vs. ("').concat(l.source.key,'", "').concat(l.target.key,'").'));h=l}if(h||e.multi||!p||(h=r?p.undirected[a]:p.out[a]),h){var m=[h.key,!1,!1,!1];if(d?!f:!u)return m;if(d){var y=h.attributes;h.attributes=f(y),e.emit("edgeAttributesUpdated",{type:"replace",key:h.key,attributes:h.attributes})}else s(h.attributes,u),e.emit("edgeAttributesUpdated",{type:"merge",key:h.key,attributes:h.attributes,data:u});return m}u=u||{},d&&f&&(u=f(u));var v={key:null,undirected:r,source:o,target:a,attributes:u};if(n)i=e._edgeKeyGenerator();else if(i=""+i,e._edges.has(i))throw new V("Graph.".concat(t,': the "').concat(i,'" edge already exists in the graph.'));var b=!1,E=!1;p||(p=xe(e,o,{}),b=!0,o===a&&(g=p,E=!0)),g||(g=xe(e,a,{}),E=!0),l=new Y(r,i,p,g,u),e._edges.set(i,l);var _=o===a;return r?(p.undirectedDegree++,g.undirectedDegree++,_&&(p.undirectedLoops++,e._undirectedSelfLoopCount++)):(p.outDegree++,g.inDegree++,_&&(p.directedLoops++,e._directedSelfLoopCount++)),e.multi?l.attachMulti():l.attach(),r?e._undirectedSize++:e._directedSize++,v.key=i,e.emit("edgeAdded",v),[i,!0,b,E]}function Se(e,t){e._edges.delete(t.key);var n=t.source,r=t.target,i=t.attributes,o=t.undirected,a=n===r;o?(n.undirectedDegree--,r.undirectedDegree--,a&&(n.undirectedLoops--,e._undirectedSelfLoopCount--)):(n.outDegree--,r.inDegree--,a&&(n.directedLoops--,e._directedSelfLoopCount--)),e.multi?t.detachMulti():t.detach(),o?e._undirectedSize--:e._directedSize--,e.emit("edgeDropped",{key:t.key,attributes:i,source:n.key,target:r.key,undirected:o})}var Ne=function(n){function r(e){var t;if(t=n.call(this)||this,"boolean"!=typeof(e=s({},we,e)).multi)throw new B("Graph.constructor: invalid 'multi' option. Expecting a boolean but got \"".concat(e.multi,'".'));if(!Ee.has(e.type))throw new B('Graph.constructor: invalid \'type\' option. Should be one of "mixed", "directed" or "undirected" but got "'.concat(e.type,'".'));if("boolean"!=typeof e.allowSelfLoops)throw new B("Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got \"".concat(e.allowSelfLoops,'".'));var r="mixed"===e.type?W:"directed"===e.type?H:X;f(a(t),"NodeDataClass",r);var i="geid_"+be()+"_",o=0;return f(a(t),"_attributes",{}),f(a(t),"_nodes",new Map),f(a(t),"_edges",new Map),f(a(t),"_directedSize",0),f(a(t),"_undirectedSize",0),f(a(t),"_directedSelfLoopCount",0),f(a(t),"_undirectedSelfLoopCount",0),f(a(t),"_edgeKeyGenerator",(function(){var e;do{e=i+o++}while(t._edges.has(e));return e})),f(a(t),"_options",e),_e.forEach((function(e){return f(a(t),e,t[e])})),l(a(t),"order",(function(){return t._nodes.size})),l(a(t),"size",(function(){return t._edges.size})),l(a(t),"directedSize",(function(){return t._directedSize})),l(a(t),"undirectedSize",(function(){return t._undirectedSize})),l(a(t),"selfLoopCount",(function(){return t._directedSelfLoopCount+t._undirectedSelfLoopCount})),l(a(t),"directedSelfLoopCount",(function(){return t._directedSelfLoopCount})),l(a(t),"undirectedSelfLoopCount",(function(){return t._undirectedSelfLoopCount})),l(a(t),"multi",t._options.multi),l(a(t),"type",t._options.type),l(a(t),"allowSelfLoops",t._options.allowSelfLoops),l(a(t),"implementation",(function(){return"graphology"})),t}t(r,n);var i=r.prototype;return i._resetInstanceCounters=function(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0},i.hasNode=function(e){return this._nodes.has(""+e)},i.hasDirectedEdge=function(e,t){if("undirected"===this.type)return!1;if(1===arguments.length){var n=""+e,r=this._edges.get(n);return!!r&&!r.undirected}if(2===arguments.length){e=""+e,t=""+t;var i=this._nodes.get(e);return!!i&&i.out.hasOwnProperty(t)}throw new B("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},i.hasUndirectedEdge=function(e,t){if("directed"===this.type)return!1;if(1===arguments.length){var n=""+e,r=this._edges.get(n);return!!r&&r.undirected}if(2===arguments.length){e=""+e,t=""+t;var i=this._nodes.get(e);return!!i&&i.undirected.hasOwnProperty(t)}throw new B("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},i.hasEdge=function(e,t){if(1===arguments.length){var n=""+e;return this._edges.has(n)}if(2===arguments.length){e=""+e,t=""+t;var r=this._nodes.get(e);return!!r&&(void 0!==r.out&&r.out.hasOwnProperty(t)||void 0!==r.undirected&&r.undirected.hasOwnProperty(t))}throw new B("Graph.hasEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},i.directedEdge=function(e,t){if("undirected"!==this.type){if(e=""+e,t=""+t,this.multi)throw new V("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");var n=this._nodes.get(e);if(!n)throw new j('Graph.directedEdge: could not find the "'.concat(e,'" source node in the graph.'));if(!this._nodes.has(t))throw new j('Graph.directedEdge: could not find the "'.concat(t,'" target node in the graph.'));var r=n.out&&n.out[t]||void 0;return r?r.key:void 0}},i.undirectedEdge=function(e,t){if("directed"!==this.type){if(e=""+e,t=""+t,this.multi)throw new V("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");var n=this._nodes.get(e);if(!n)throw new j('Graph.undirectedEdge: could not find the "'.concat(e,'" source node in the graph.'));if(!this._nodes.has(t))throw new j('Graph.undirectedEdge: could not find the "'.concat(t,'" target node in the graph.'));var r=n.undirected&&n.undirected[t]||void 0;return r?r.key:void 0}},i.edge=function(e,t){if(this.multi)throw new V("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");e=""+e,t=""+t;var n=this._nodes.get(e);if(!n)throw new j('Graph.edge: could not find the "'.concat(e,'" source node in the graph.'));if(!this._nodes.has(t))throw new j('Graph.edge: could not find the "'.concat(t,'" target node in the graph.'));var r=n.out&&n.out[t]||n.undirected&&n.undirected[t]||void 0;if(r)return r.key},i.areDirectedNeighbors=function(e,t){e=""+e,t=""+t;var n=this._nodes.get(e);if(!n)throw new j('Graph.areDirectedNeighbors: could not find the "'.concat(e,'" node in the graph.'));return"undirected"!==this.type&&(t in n.in||t in n.out)},i.areOutNeighbors=function(e,t){e=""+e,t=""+t;var n=this._nodes.get(e);if(!n)throw new j('Graph.areOutNeighbors: could not find the "'.concat(e,'" node in the graph.'));return"undirected"!==this.type&&t in n.out},i.areInNeighbors=function(e,t){e=""+e,t=""+t;var n=this._nodes.get(e);if(!n)throw new j('Graph.areInNeighbors: could not find the "'.concat(e,'" node in the graph.'));return"undirected"!==this.type&&t in n.in},i.areUndirectedNeighbors=function(e,t){e=""+e,t=""+t;var n=this._nodes.get(e);if(!n)throw new j('Graph.areUndirectedNeighbors: could not find the "'.concat(e,'" node in the graph.'));return"directed"!==this.type&&t in n.undirected},i.areNeighbors=function(e,t){e=""+e,t=""+t;var n=this._nodes.get(e);if(!n)throw new j('Graph.areNeighbors: could not find the "'.concat(e,'" node in the graph.'));return"undirected"!==this.type&&(t in n.in||t in n.out)||"directed"!==this.type&&t in n.undirected},i.areInboundNeighbors=function(e,t){e=""+e,t=""+t;var n=this._nodes.get(e);if(!n)throw new j('Graph.areInboundNeighbors: could not find the "'.concat(e,'" node in the graph.'));return"undirected"!==this.type&&t in n.in||"directed"!==this.type&&t in n.undirected},i.areOutboundNeighbors=function(e,t){e=""+e,t=""+t;var n=this._nodes.get(e);if(!n)throw new j('Graph.areOutboundNeighbors: could not find the "'.concat(e,'" node in the graph.'));return"undirected"!==this.type&&t in n.out||"directed"!==this.type&&t in n.undirected},i.inDegree=function(e){e=""+e;var t=this._nodes.get(e);if(!t)throw new j('Graph.inDegree: could not find the "'.concat(e,'" node in the graph.'));return"undirected"===this.type?0:t.inDegree},i.outDegree=function(e){e=""+e;var t=this._nodes.get(e);if(!t)throw new j('Graph.outDegree: could not find the "'.concat(e,'" node in the graph.'));return"undirected"===this.type?0:t.outDegree},i.directedDegree=function(e){e=""+e;var t=this._nodes.get(e);if(!t)throw new j('Graph.directedDegree: could not find the "'.concat(e,'" node in the graph.'));return"undirected"===this.type?0:t.inDegree+t.outDegree},i.undirectedDegree=function(e){e=""+e;var t=this._nodes.get(e);if(!t)throw new j('Graph.undirectedDegree: could not find the "'.concat(e,'" node in the graph.'));return"directed"===this.type?0:t.undirectedDegree},i.inboundDegree=function(e){e=""+e;var t=this._nodes.get(e);if(!t)throw new j('Graph.inboundDegree: could not find the "'.concat(e,'" node in the graph.'));var n=0;return"directed"!==this.type&&(n+=t.undirectedDegree),"undirected"!==this.type&&(n+=t.inDegree),n},i.outboundDegree=function(e){e=""+e;var t=this._nodes.get(e);if(!t)throw new j('Graph.outboundDegree: could not find the "'.concat(e,'" node in the graph.'));var n=0;return"directed"!==this.type&&(n+=t.undirectedDegree),"undirected"!==this.type&&(n+=t.outDegree),n},i.degree=function(e){e=""+e;var t=this._nodes.get(e);if(!t)throw new j('Graph.degree: could not find the "'.concat(e,'" node in the graph.'));var n=0;return"directed"!==this.type&&(n+=t.undirectedDegree),"undirected"!==this.type&&(n+=t.inDegree+t.outDegree),n},i.inDegreeWithoutSelfLoops=function(e){e=""+e;var t=this._nodes.get(e);if(!t)throw new j('Graph.inDegreeWithoutSelfLoops: could not find the "'.concat(e,'" node in the graph.'));return"undirected"===this.type?0:t.inDegree-t.directedLoops},i.outDegreeWithoutSelfLoops=function(e){e=""+e;var t=this._nodes.get(e);if(!t)throw new j('Graph.outDegreeWithoutSelfLoops: could not find the "'.concat(e,'" node in the graph.'));return"undirected"===this.type?0:t.outDegree-t.directedLoops},i.directedDegreeWithoutSelfLoops=function(e){e=""+e;var t=this._nodes.get(e);if(!t)throw new j('Graph.directedDegreeWithoutSelfLoops: could not find the "'.concat(e,'" node in the graph.'));return"undirected"===this.type?0:t.inDegree+t.outDegree-2*t.directedLoops},i.undirectedDegreeWithoutSelfLoops=function(e){e=""+e;var t=this._nodes.get(e);if(!t)throw new j('Graph.undirectedDegreeWithoutSelfLoops: could not find the "'.concat(e,'" node in the graph.'));return"directed"===this.type?0:t.undirectedDegree-2*t.undirectedLoops},i.inboundDegreeWithoutSelfLoops=function(e){e=""+e;var t=this._nodes.get(e);if(!t)throw new j('Graph.inboundDegreeWithoutSelfLoops: could not find the "'.concat(e,'" node in the graph.'));var n=0,r=0;return"directed"!==this.type&&(n+=t.undirectedDegree,r+=2*t.undirectedLoops),"undirected"!==this.type&&(n+=t.inDegree,r+=t.directedLoops),n-r},i.outboundDegreeWithoutSelfLoops=function(e){e=""+e;var t=this._nodes.get(e);if(!t)throw new j('Graph.outboundDegreeWithoutSelfLoops: could not find the "'.concat(e,'" node in the graph.'));var n=0,r=0;return"directed"!==this.type&&(n+=t.undirectedDegree,r+=2*t.undirectedLoops),"undirected"!==this.type&&(n+=t.outDegree,r+=t.directedLoops),n-r},i.degreeWithoutSelfLoops=function(e){e=""+e;var t=this._nodes.get(e);if(!t)throw new j('Graph.degreeWithoutSelfLoops: could not find the "'.concat(e,'" node in the graph.'));var n=0,r=0;return"directed"!==this.type&&(n+=t.undirectedDegree,r+=2*t.undirectedLoops),"undirected"!==this.type&&(n+=t.inDegree+t.outDegree,r+=2*t.directedLoops),n-r},i.source=function(e){e=""+e;var t=this._edges.get(e);if(!t)throw new j('Graph.source: could not find the "'.concat(e,'" edge in the graph.'));return t.source.key},i.target=function(e){e=""+e;var t=this._edges.get(e);if(!t)throw new j('Graph.target: could not find the "'.concat(e,'" edge in the graph.'));return t.target.key},i.extremities=function(e){e=""+e;var t=this._edges.get(e);if(!t)throw new j('Graph.extremities: could not find the "'.concat(e,'" edge in the graph.'));return[t.source.key,t.target.key]},i.opposite=function(e,t){e=""+e,t=""+t;var n=this._edges.get(t);if(!n)throw new j('Graph.opposite: could not find the "'.concat(t,'" edge in the graph.'));var r=n.source.key,i=n.target.key;if(e===r)return i;if(e===i)return r;throw new j('Graph.opposite: the "'.concat(e,'" node is not attached to the "').concat(t,'" edge (').concat(r,", ").concat(i,")."))},i.hasExtremity=function(e,t){e=""+e,t=""+t;var n=this._edges.get(e);if(!n)throw new j('Graph.hasExtremity: could not find the "'.concat(e,'" edge in the graph.'));return n.source.key===t||n.target.key===t},i.isUndirected=function(e){e=""+e;var t=this._edges.get(e);if(!t)throw new j('Graph.isUndirected: could not find the "'.concat(e,'" edge in the graph.'));return t.undirected},i.isDirected=function(e){e=""+e;var t=this._edges.get(e);if(!t)throw new j('Graph.isDirected: could not find the "'.concat(e,'" edge in the graph.'));return!t.undirected},i.isSelfLoop=function(e){e=""+e;var t=this._edges.get(e);if(!t)throw new j('Graph.isSelfLoop: could not find the "'.concat(e,'" edge in the graph.'));return t.source===t.target},i.addNode=function(e,t){var n=function(e,t,n){if(n&&!c(n))throw new B('Graph.addNode: invalid attributes. Expecting an object but got "'.concat(n,'"'));if(t=""+t,n=n||{},e._nodes.has(t))throw new V('Graph.addNode: the "'.concat(t,'" node already exist in the graph.'));var r=new e.NodeDataClass(t,n);return e._nodes.set(t,r),e.emit("nodeAdded",{key:t,attributes:n}),r}(this,e,t);return n.key},i.mergeNode=function(e,t){if(t&&!c(t))throw new B('Graph.mergeNode: invalid attributes. Expecting an object but got "'.concat(t,'"'));e=""+e,t=t||{};var n=this._nodes.get(e);return n?(t&&(s(n.attributes,t),this.emit("nodeAttributesUpdated",{type:"merge",key:e,attributes:n.attributes,data:t})),[e,!1]):(n=new this.NodeDataClass(e,t),this._nodes.set(e,n),this.emit("nodeAdded",{key:e,attributes:t}),[e,!0])},i.updateNode=function(e,t){if(t&&"function"!=typeof t)throw new B('Graph.updateNode: invalid updater function. Expecting a function but got "'.concat(t,'"'));e=""+e;var n=this._nodes.get(e);if(n){if(t){var r=n.attributes;n.attributes=t(r),this.emit("nodeAttributesUpdated",{type:"replace",key:e,attributes:n.attributes})}return[e,!1]}var i=t?t({}):{};return n=new this.NodeDataClass(e,i),this._nodes.set(e,n),this.emit("nodeAdded",{key:e,attributes:i}),[e,!0]},i.dropNode=function(e){e=""+e;var t,n=this._nodes.get(e);if(!n)throw new j('Graph.dropNode: could not find the "'.concat(e,'" node in the graph.'));if("undirected"!==this.type){for(var r in n.out){t=n.out[r];do{Se(this,t),t=t.next}while(t)}for(var i in n.in){t=n.in[i];do{Se(this,t),t=t.next}while(t)}}if("directed"!==this.type)for(var o in n.undirected){t=n.undirected[o];do{Se(this,t),t=t.next}while(t)}this._nodes.delete(e),this.emit("nodeDropped",{key:e,attributes:n.attributes})},i.dropEdge=function(e){var t;if(arguments.length>1){var n=""+arguments[0],r=""+arguments[1];if(!(t=u(this,n,r,this.type)))throw new j('Graph.dropEdge: could not find the "'.concat(n,'" -> "').concat(r,'" edge in the graph.'))}else if(e=""+e,!(t=this._edges.get(e)))throw new j('Graph.dropEdge: could not find the "'.concat(e,'" edge in the graph.'));return Se(this,t),this},i.dropDirectedEdge=function(e,t){if(arguments.length<2)throw new V("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new V("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");var n=u(this,e=""+e,t=""+t,"directed");if(!n)throw new j('Graph.dropDirectedEdge: could not find a "'.concat(e,'" -> "').concat(t,'" edge in the graph.'));return Se(this,n),this},i.dropUndirectedEdge=function(e,t){if(arguments.length<2)throw new V("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new V("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");var n=u(this,e,t,"undirected");if(!n)throw new j('Graph.dropUndirectedEdge: could not find a "'.concat(e,'" -> "').concat(t,'" edge in the graph.'));return Se(this,n),this},i.clear=function(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")},i.clearEdges=function(){for(var e,t=this._nodes.values();!0!==(e=t.next()).done;)e.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")},i.getAttribute=function(e){return this._attributes[e]},i.getAttributes=function(){return this._attributes},i.hasAttribute=function(e){return this._attributes.hasOwnProperty(e)},i.setAttribute=function(e,t){return this._attributes[e]=t,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this},i.updateAttribute=function(e,t){if("function"!=typeof t)throw new B("Graph.updateAttribute: updater should be a function.");var n=this._attributes[e];return this._attributes[e]=t(n),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this},i.removeAttribute=function(e){return delete this._attributes[e],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:e}),this},i.replaceAttributes=function(e){if(!c(e))throw new B("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=e,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this},i.mergeAttributes=function(e){if(!c(e))throw new B("Graph.mergeAttributes: provided attributes are not a plain object.");return s(this._attributes,e),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:e}),this},i.updateAttributes=function(e){if("function"!=typeof e)throw new B("Graph.updateAttributes: provided updater is not a function.");return this._attributes=e(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this},i.updateEachNodeAttributes=function(e,t){if("function"!=typeof e)throw new B("Graph.updateEachNodeAttributes: expecting an updater function.");if(t&&!h(t))throw new B("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var n,r,i=this._nodes.values();!0!==(n=i.next()).done;)(r=n.value).attributes=e(r.key,r.attributes);this.emit("eachNodeAttributesUpdated",{hints:t||null})},i.updateEachEdgeAttributes=function(e,t){if("function"!=typeof e)throw new B("Graph.updateEachEdgeAttributes: expecting an updater function.");if(t&&!h(t))throw new B("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var n,r,i,o,a=this._edges.values();!0!==(n=a.next()).done;)i=(r=n.value).source,o=r.target,r.attributes=e(r.key,r.attributes,i.key,o.key,i.attributes,o.attributes,r.undirected);this.emit("eachEdgeAttributesUpdated",{hints:t||null})},i.forEachAdjacencyEntry=function(e){if("function"!=typeof e)throw new B("Graph.forEachAdjacencyEntry: expecting a callback.");ge(!1,!1,!1,this,e)},i.forEachAdjacencyEntryWithOrphans=function(e){if("function"!=typeof e)throw new B("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");ge(!1,!1,!0,this,e)},i.forEachAssymetricAdjacencyEntry=function(e){if("function"!=typeof e)throw new B("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");ge(!1,!0,!1,this,e)},i.forEachAssymetricAdjacencyEntryWithOrphans=function(e){if("function"!=typeof e)throw new B("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");ge(!1,!0,!0,this,e)},i.nodes=function(){return"function"==typeof Array.from?Array.from(this._nodes.keys()):z(this._nodes.keys(),this._nodes.size)},i.forEachNode=function(e){if("function"!=typeof e)throw new B("Graph.forEachNode: expecting a callback.");for(var t,n,r=this._nodes.values();!0!==(t=r.next()).done;)e((n=t.value).key,n.attributes)},i.findNode=function(e){if("function"!=typeof e)throw new B("Graph.findNode: expecting a callback.");for(var t,n,r=this._nodes.values();!0!==(t=r.next()).done;)if(e((n=t.value).key,n.attributes))return n.key},i.mapNodes=function(e){if("function"!=typeof e)throw new B("Graph.mapNode: expecting a callback.");for(var t,n,r=this._nodes.values(),i=new Array(this.order),o=0;!0!==(t=r.next()).done;)n=t.value,i[o++]=e(n.key,n.attributes);return i},i.someNode=function(e){if("function"!=typeof e)throw new B("Graph.someNode: expecting a callback.");for(var t,n,r=this._nodes.values();!0!==(t=r.next()).done;)if(e((n=t.value).key,n.attributes))return!0;return!1},i.everyNode=function(e){if("function"!=typeof e)throw new B("Graph.everyNode: expecting a callback.");for(var t,n,r=this._nodes.values();!0!==(t=r.next()).done;)if(!e((n=t.value).key,n.attributes))return!1;return!0},i.filterNodes=function(e){if("function"!=typeof e)throw new B("Graph.filterNodes: expecting a callback.");for(var t,n,r=this._nodes.values(),i=[];!0!==(t=r.next()).done;)e((n=t.value).key,n.attributes)&&i.push(n.key);return i},i.reduceNodes=function(e,t){if("function"!=typeof e)throw new B("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new B("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");for(var n,r,i=t,o=this._nodes.values();!0!==(n=o.next()).done;)i=e(i,(r=n.value).key,r.attributes);return i},i.nodeEntries=function(){var e=this._nodes.values();return new k((function(){var t=e.next();if(t.done)return t;var n=t.value;return{value:{node:n.key,attributes:n.attributes},done:!1}}))},i.export=function(){var e=this,t=new Array(this._nodes.size),n=0;this._nodes.forEach((function(e,r){t[n++]=function(e,t){var n={key:e};return d(t.attributes)||(n.attributes=s({},t.attributes)),n}(r,e)}));var r=new Array(this._edges.size);return n=0,this._edges.forEach((function(t,i){r[n++]=function(e,t,n){var r={key:t,source:n.source.key,target:n.target.key};return d(n.attributes)||(r.attributes=s({},n.attributes)),"mixed"===e&&n.undirected&&(r.undirected=!0),r}(e.type,i,t)})),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:t,edges:r}},i.import=function(e){var t,n,i,o,a,s=this,u=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e instanceof r)return e.forEachNode((function(e,t){u?s.mergeNode(e,t):s.addNode(e,t)})),e.forEachEdge((function(e,t,n,r,i,o,a){u?a?s.mergeUndirectedEdgeWithKey(e,n,r,t):s.mergeDirectedEdgeWithKey(e,n,r,t):a?s.addUndirectedEdgeWithKey(e,n,r,t):s.addDirectedEdgeWithKey(e,n,r,t)})),this;if(!c(e))throw new B("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(e.attributes){if(!c(e.attributes))throw new B("Graph.import: invalid attributes. Expecting a plain object.");u?this.mergeAttributes(e.attributes):this.replaceAttributes(e.attributes)}if(e.nodes){if(i=e.nodes,!Array.isArray(i))throw new B("Graph.import: invalid nodes. Expecting an array.");for(t=0,n=i.length;t<n;t++){me(o=i[t]);var d=o,f=d.key,l=d.attributes;u?this.mergeNode(f,l):this.addNode(f,l)}}if(e.edges){var h=!1;if("undirected"===this.type&&(h=!0),i=e.edges,!Array.isArray(i))throw new B("Graph.import: invalid edges. Expecting an array.");for(t=0,n=i.length;t<n;t++){ye(a=i[t]);var p=a,g=p.source,m=p.target,y=p.attributes,v=p.undirected,b=void 0===v?h:v;"key"in a?(u?b?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:b?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey).call(this,a.key,g,m,y):(u?b?this.mergeUndirectedEdge:this.mergeDirectedEdge:b?this.addUndirectedEdge:this.addDirectedEdge).call(this,g,m,y)}}return this},i.nullCopy=function(e){var t=new r(s({},this._options,e));return t.replaceAttributes(s({},this.getAttributes())),t},i.emptyCopy=function(e){var t=this.nullCopy(e);return this._nodes.forEach((function(e,n){var r=s({},e.attributes);e=new t.NodeDataClass(n,r),t._nodes.set(n,e)})),t},i.copy=function(e){if("string"==typeof(e=e||{}).type&&e.type!==this.type&&"mixed"!==e.type)throw new V('Graph.copy: cannot create an incompatible copy from "'.concat(this.type,'" type to "').concat(e.type,'" because this would mean losing information about the current graph.'));if("boolean"==typeof e.multi&&e.multi!==this.multi&&!0!==e.multi)throw new V("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if("boolean"==typeof e.allowSelfLoops&&e.allowSelfLoops!==this.allowSelfLoops&&!0!==e.allowSelfLoops)throw new V("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");for(var t,n,r=this.emptyCopy(e),i=this._edges.values();!0!==(t=i.next()).done;)Ae(r,"copy",!1,(n=t.value).undirected,n.key,n.source.key,n.target.key,s({},n.attributes));return r},i.toJSON=function(){return this.export()},i.toString=function(){return"[object Graph]"},i.inspect=function(){var t=this,n={};this._nodes.forEach((function(e,t){n[t]=e.attributes}));var r={},i={};this._edges.forEach((function(e,n){var o,a=e.undirected?"--":"->",s="",u=e.source.key,c=e.target.key;e.undirected&&u>c&&(o=u,u=c,c=o);var d="(".concat(u,")").concat(a,"(").concat(c,")");n.startsWith("geid_")?t.multi&&(void 0===i[d]?i[d]=0:i[d]++,s+="".concat(i[d],". ")):s+="[".concat(n,"]: "),r[s+=d]=e.attributes}));var o={};for(var a in this)this.hasOwnProperty(a)&&!_e.has(a)&&"function"!=typeof this[a]&&"symbol"!==e(a)&&(o[a]=this[a]);return o.attributes=this._attributes,o.nodes=n,o.edges=r,f(o,"constructor",this.constructor),o},r}(g.exports.EventEmitter);"undefined"!=typeof Symbol&&(Ne.prototype[Symbol.for("nodejs.util.inspect.custom")]=Ne.prototype.inspect),[{name:function(e){return"".concat(e,"Edge")},generateKey:!0},{name:function(e){return"".concat(e,"DirectedEdge")},generateKey:!0,type:"directed"},{name:function(e){return"".concat(e,"UndirectedEdge")},generateKey:!0,type:"undirected"},{name:function(e){return"".concat(e,"EdgeWithKey")}},{name:function(e){return"".concat(e,"DirectedEdgeWithKey")},type:"directed"},{name:function(e){return"".concat(e,"UndirectedEdgeWithKey")},type:"undirected"}].forEach((function(e){["add","merge","update"].forEach((function(t){var n=e.name(t),r="add"===t?Ae:Te;e.generateKey?Ne.prototype[n]=function(i,o,a){return r(this,n,!0,"undirected"===(e.type||this.type),null,i,o,a,"update"===t)}:Ne.prototype[n]=function(i,o,a,s){return r(this,n,!1,"undirected"===(e.type||this.type),i,o,a,s,"update"===t)}}))})),function(e){q.forEach((function(t){var n=t.name,r=t.attacher;r(e,n("Node"),0),r(e,n("Source"),1),r(e,n("Target"),2),r(e,n("Opposite"),3)}))}(Ne),function(e){Z.forEach((function(t){var n=t.name,r=t.attacher;r(e,n("Edge"),"mixed"),r(e,n("DirectedEdge"),"directed"),r(e,n("UndirectedEdge"),"undirected")}))}(Ne),function(e){ee.forEach((function(t){!function(e,t){var n=t.name,r=t.type,i=t.direction;e.prototype[n]=function(e,t){if("mixed"!==r&&"mixed"!==this.type&&r!==this.type)return[];if(!arguments.length)return function(e,t){if(0===e.size)return[];if("mixed"===t||t===e.type)return"function"==typeof Array.from?Array.from(e._edges.keys()):z(e._edges.keys(),e._edges.size);for(var n,r,i="undirected"===t?e.undirectedSize:e.directedSize,o=new Array(i),a="undirected"===t,s=e._edges.values(),u=0;!0!==(n=s.next()).done;)(r=n.value).undirected===a&&(o[u++]=r.key);return o}(this,r);if(1===arguments.length){e=""+e;var o=this._nodes.get(e);if(void 0===o)throw new j("Graph.".concat(n,': could not find the "').concat(e,'" node in the graph.'));return function(e,t,n,r){var i=[];return ue(!1,e,t,n,r,(function(e){i.push(e)})),i}(this.multi,"mixed"===r?this.type:r,i,o)}if(2===arguments.length){e=""+e,t=""+t;var a=this._nodes.get(e);if(!a)throw new j("Graph.".concat(n,':  could not find the "').concat(e,'" source node in the graph.'));if(!this._nodes.has(t))throw new j("Graph.".concat(n,':  could not find the "').concat(t,'" target node in the graph.'));return function(e,t,n,r,i){var o=[];return ce(!1,e,t,n,r,i,(function(e){o.push(e)})),o}(r,this.multi,i,a,t)}throw new B("Graph.".concat(n,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))}}(e,t),function(e,t){var n=t.name,r=t.type,i=t.direction,o="forEach"+n[0].toUpperCase()+n.slice(1,-1);e.prototype[o]=function(e,t,n){if("mixed"===r||"mixed"===this.type||r===this.type){if(1===arguments.length)return se(!1,this,r,n=e);if(2===arguments.length){e=""+e,n=t;var a=this._nodes.get(e);if(void 0===a)throw new j("Graph.".concat(o,': could not find the "').concat(e,'" node in the graph.'));return ue(!1,this.multi,"mixed"===r?this.type:r,i,a,n)}if(3===arguments.length){e=""+e,t=""+t;var s=this._nodes.get(e);if(!s)throw new j("Graph.".concat(o,':  could not find the "').concat(e,'" source node in the graph.'));if(!this._nodes.has(t))throw new j("Graph.".concat(o,':  could not find the "').concat(t,'" target node in the graph.'));return ce(!1,r,this.multi,i,s,t,n)}throw new B("Graph.".concat(o,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}};var a="map"+n[0].toUpperCase()+n.slice(1);e.prototype[a]=function(){var e,t=Array.prototype.slice.call(arguments),n=t.pop();if(0===t.length){var i=0;"directed"!==r&&(i+=this.undirectedSize),"undirected"!==r&&(i+=this.directedSize),e=new Array(i);var a=0;t.push((function(t,r,i,o,s,u,c){e[a++]=n(t,r,i,o,s,u,c)}))}else e=[],t.push((function(t,r,i,o,a,s,u){e.push(n(t,r,i,o,a,s,u))}));return this[o].apply(this,t),e};var s="filter"+n[0].toUpperCase()+n.slice(1);e.prototype[s]=function(){var e=Array.prototype.slice.call(arguments),t=e.pop(),n=[];return e.push((function(e,r,i,o,a,s,u){t(e,r,i,o,a,s,u)&&n.push(e)})),this[o].apply(this,e),n};var u="reduce"+n[0].toUpperCase()+n.slice(1);e.prototype[u]=function(){var e,t,n=Array.prototype.slice.call(arguments);if(n.length<2||n.length>4)throw new B("Graph.".concat(u,": invalid number of arguments (expecting 2, 3 or 4 and got ").concat(n.length,")."));if("function"==typeof n[n.length-1]&&"function"!=typeof n[n.length-2])throw new B("Graph.".concat(u,": missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array."));2===n.length?(e=n[0],t=n[1],n=[]):3===n.length?(e=n[1],t=n[2],n=[n[0]]):4===n.length&&(e=n[2],t=n[3],n=[n[0],n[1]]);var r=t;return n.push((function(t,n,i,o,a,s,u){r=e(r,t,n,i,o,a,s,u)})),this[o].apply(this,n),r}}(e,t),function(e,t){var n=t.name,r=t.type,i=t.direction,o="find"+n[0].toUpperCase()+n.slice(1,-1);e.prototype[o]=function(e,t,n){if("mixed"!==r&&"mixed"!==this.type&&r!==this.type)return!1;if(1===arguments.length)return se(!0,this,r,n=e);if(2===arguments.length){e=""+e,n=t;var a=this._nodes.get(e);if(void 0===a)throw new j("Graph.".concat(o,': could not find the "').concat(e,'" node in the graph.'));return ue(!0,this.multi,"mixed"===r?this.type:r,i,a,n)}if(3===arguments.length){e=""+e,t=""+t;var s=this._nodes.get(e);if(!s)throw new j("Graph.".concat(o,':  could not find the "').concat(e,'" source node in the graph.'));if(!this._nodes.has(t))throw new j("Graph.".concat(o,':  could not find the "').concat(t,'" target node in the graph.'));return ce(!0,r,this.multi,i,s,t,n)}throw new B("Graph.".concat(o,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))};var a="some"+n[0].toUpperCase()+n.slice(1,-1);e.prototype[a]=function(){var e=Array.prototype.slice.call(arguments),t=e.pop();return e.push((function(e,n,r,i,o,a,s){return t(e,n,r,i,o,a,s)})),!!this[o].apply(this,e)};var s="every"+n[0].toUpperCase()+n.slice(1,-1);e.prototype[s]=function(){var e=Array.prototype.slice.call(arguments),t=e.pop();return e.push((function(e,n,r,i,o,a,s){return!t(e,n,r,i,o,a,s)})),!this[o].apply(this,e)}}(e,t),function(e,t){var n=t.name,r=t.type,i=t.direction,o=n.slice(0,-1)+"Entries";e.prototype[o]=function(e,t){if("mixed"!==r&&"mixed"!==this.type&&r!==this.type)return k.empty();if(!arguments.length)return function(e,t){if(0===e.size)return k.empty();var n="mixed"!==t&&t!==e.type,r="undirected"===t,i=e._edges.values();return new k((function(){for(var e,t;;){if((e=i.next()).done)return e;if(t=e.value,!n||t.undirected===r)break}return{value:{edge:t.key,attributes:t.attributes,source:t.source.key,target:t.target.key,sourceAttributes:t.source.attributes,targetAttributes:t.target.attributes,undirected:t.undirected},done:!1}}))}(this,r);if(1===arguments.length){e=""+e;var n=this._nodes.get(e);if(!n)throw new j("Graph.".concat(o,': could not find the "').concat(e,'" node in the graph.'));return function(e,t,n){var r=k.empty();return"undirected"!==e&&("out"!==t&&void 0!==n.in&&(r=$(r,re(n.in))),"in"!==t&&void 0!==n.out&&(r=$(r,re(n.out,t?void 0:n.key)))),"directed"!==e&&void 0!==n.undirected&&(r=$(r,re(n.undirected))),r}(r,i,n)}if(2===arguments.length){e=""+e,t=""+t;var a=this._nodes.get(e);if(!a)throw new j("Graph.".concat(o,':  could not find the "').concat(e,'" source node in the graph.'));if(!this._nodes.has(t))throw new j("Graph.".concat(o,':  could not find the "').concat(t,'" target node in the graph.'));return function(e,t,n,r){var i=k.empty();return"undirected"!==e&&(void 0!==n.in&&"out"!==t&&r in n.in&&(i=$(i,ae(n.in,r))),void 0!==n.out&&"in"!==t&&r in n.out&&(t||n.key!==r)&&(i=$(i,ae(n.out,r)))),"directed"!==e&&void 0!==n.undirected&&r in n.undirected&&(i=$(i,ae(n.undirected,r))),i}(r,i,a,t)}throw new B("Graph.".concat(o,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))}}(e,t)}))}(Ne),function(e){de.forEach((function(t){(function(e,t){var n=t.name,r=t.type,i=t.direction;e.prototype[n]=function(e){if("mixed"!==r&&"mixed"!==this.type&&r!==this.type)return[];e=""+e;var t=this._nodes.get(e);if(void 0===t)throw new j("Graph.".concat(n,': could not find the "').concat(e,'" node in the graph.'));return function(e,t,n){if("mixed"!==e){if("undirected"===e)return Object.keys(n.undirected);if("string"==typeof t)return Object.keys(n[t])}var r=[];return he(!1,e,t,n,(function(e){r.push(e)})),r}("mixed"===r?this.type:r,i,t)}})(e,t),function(e,t){var n=t.name,r=t.type,i=t.direction,o="forEach"+n[0].toUpperCase()+n.slice(1,-1);e.prototype[o]=function(e,t){if("mixed"===r||"mixed"===this.type||r===this.type){e=""+e;var n=this._nodes.get(e);if(void 0===n)throw new j("Graph.".concat(o,': could not find the "').concat(e,'" node in the graph.'));he(!1,"mixed"===r?this.type:r,i,n,t)}};var a="map"+n[0].toUpperCase()+n.slice(1);e.prototype[a]=function(e,t){var n=[];return this[o](e,(function(e,r){n.push(t(e,r))})),n};var s="filter"+n[0].toUpperCase()+n.slice(1);e.prototype[s]=function(e,t){var n=[];return this[o](e,(function(e,r){t(e,r)&&n.push(e)})),n};var u="reduce"+n[0].toUpperCase()+n.slice(1);e.prototype[u]=function(e,t,n){if(arguments.length<3)throw new B("Graph.".concat(u,": missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array."));var r=n;return this[o](e,(function(e,n){r=t(r,e,n)})),r}}(e,t),function(e,t){var n=t.name,r=t.type,i=t.direction,o=n[0].toUpperCase()+n.slice(1,-1),a="find"+o;e.prototype[a]=function(e,t){if("mixed"===r||"mixed"===this.type||r===this.type){e=""+e;var n=this._nodes.get(e);if(void 0===n)throw new j("Graph.".concat(a,': could not find the "').concat(e,'" node in the graph.'));return he(!0,"mixed"===r?this.type:r,i,n,t)}};var s="some"+o;e.prototype[s]=function(e,t){return!!this[a](e,t)};var u="every"+o;e.prototype[u]=function(e,t){return!this[a](e,(function(e,n){return!t(e,n)}))}}(e,t),function(e,t){var n=t.name,r=t.type,i=t.direction,o=n.slice(0,-1)+"Entries";e.prototype[o]=function(e){if("mixed"!==r&&"mixed"!==this.type&&r!==this.type)return k.empty();e=""+e;var t=this._nodes.get(e);if(void 0===t)throw new j("Graph.".concat(o,': could not find the "').concat(e,'" node in the graph.'));return function(e,t,n){if("mixed"!==e){if("undirected"===e)return pe(null,n,n.undirected);if("string"==typeof t)return pe(null,n,n[t])}var r=k.empty(),i=new fe;return"undirected"!==e&&("out"!==t&&(r=$(r,pe(i,n,n.in))),"in"!==t&&(r=$(r,pe(i,n,n.out)))),"directed"!==e&&(r=$(r,pe(i,n,n.undirected))),r}("mixed"===r?this.type:r,i,t)}}(e,t)}))}(Ne);var De=function(e){function n(t){var n=s({type:"directed"},t);if("multi"in n&&!1!==n.multi)throw new B("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("directed"!==n.type)throw new B('DirectedGraph.from: inconsistent "'+n.type+'" type in given options!');return e.call(this,n)||this}return t(n,e),n}(Ne),Ie=function(e){function n(t){var n=s({type:"undirected"},t);if("multi"in n&&!1!==n.multi)throw new B("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("undirected"!==n.type)throw new B('UndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');return e.call(this,n)||this}return t(n,e),n}(Ne),Re=function(e){function n(t){var n=s({multi:!0},t);if("multi"in n&&!0!==n.multi)throw new B("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");return e.call(this,n)||this}return t(n,e),n}(Ne),ke=function(e){function n(t){var n=s({type:"directed",multi:!0},t);if("multi"in n&&!0!==n.multi)throw new B("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("directed"!==n.type)throw new B('MultiDirectedGraph.from: inconsistent "'+n.type+'" type in given options!');return e.call(this,n)||this}return t(n,e),n}(Ne),Oe=function(e){function n(t){var n=s({type:"undirected",multi:!0},t);if("multi"in n&&!0!==n.multi)throw new B("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("undirected"!==n.type)throw new B('MultiUndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');return e.call(this,n)||this}return t(n,e),n}(Ne);function Ce(e){e.from=function(t,n){var r=s({},t.options,n),i=new e(r);return i.import(t),i}}return Ce(Ne),Ce(De),Ce(Ie),Ce(Re),Ce(ke),Ce(Oe),Ne.Graph=Ne,Ne.DirectedGraph=De,Ne.UndirectedGraph=Ie,Ne.MultiGraph=Re,Ne.MultiDirectedGraph=ke,Ne.MultiUndirectedGraph=Oe,Ne.InvalidArgumentsGraphError=B,Ne.NotFoundGraphError=j,Ne.UsageGraphError=V,Ne}()},869:(e,t,n)=>{var r=n(152).Symbol;e.exports=r},756:(e,t,n)=>{var r=n(869),i=n(533),o=n(702),a=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?i(e):o(e)}},766:(e,t,n)=>{var r=n(756),i=n(156),o=n(913),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&i(e.length)&&!!a[r(e)]}},342:e=>{e.exports=function(e){return function(t){return e(t)}}},675:(e,t,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},217:(e,t,n)=>{var r=n(30)(Object.getPrototypeOf,Object);e.exports=r},533:(e,t,n)=>{var r=n(869),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var i=a.call(e);return r&&(t?e[s]=n:delete e[s]),i}},495:(e,t,n)=>{e=n.nmd(e);var r=n(675),i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,a=o&&o.exports===i&&r.process,s=function(){try{return o&&o.require&&o.require("util").types||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s},702:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},30:e=>{e.exports=function(e,t){return function(n){return e(t(n))}}},152:(e,t,n)=>{var r=n(675),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},744:e=>{var t=Array.isArray;e.exports=t},156:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},868:(e,t,n)=>{var r=n(756),i=n(913);e.exports=function(e){return"number"==typeof e||i(e)&&"[object Number]"==r(e)}},913:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},308:(e,t,n)=>{var r=n(756),i=n(217),o=n(913),a=Function.prototype,s=Object.prototype,u=a.toString,c=s.hasOwnProperty,d=u.call(Object);e.exports=function(e){if(!o(e)||"[object Object]"!=r(e))return!1;var t=i(e);if(null===t)return!0;var n=c.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&u.call(n)==d}},397:(e,t,n)=>{var r=n(766),i=n(342),o=n(495),a=o&&o.isTypedArray,s=a?i(a):r;e.exports=s},377:function(e){e.exports=function(){"use strict";var e=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},t=function(e,t){for(var n=Object.keys(t),r=0;r<n.length;++r)e[n[r]]=t[n[r]];return e},n="\n";function r(e){var t=new Error("(regl) "+e);throw console.error(t),t}function i(e,t){e||r(t)}function o(e){return e?": "+e:""}function a(e,t){switch(t){case"number":return"number"==typeof e;case"object":return"object"==typeof e;case"string":return"string"==typeof e;case"boolean":return"boolean"==typeof e;case"function":return"function"==typeof e;case"undefined":return void 0===e;case"symbol":return"symbol"==typeof e}}function s(e,t,n){t.indexOf(e)<0&&r("invalid value"+o(n)+". must be one of: "+t)}var u=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function c(e,t){for(e+="";e.length<t;)e=" "+e;return e}function d(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function f(e,t){this.number=e,this.line=t,this.errors=[]}function l(e,t,n){this.file=e,this.line=t,this.message=n}function h(){var e=new Error,t=(e.stack||e).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(t);return r?r[1]:"unknown"}function p(){var e=new Error,t=(e.stack||e).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(t);return r?r[1]:"unknown"}function g(e,t){var n,r=e.split("\n"),i=1,o=0,a={unknown:new d,0:new d};a.unknown.name=a[0].name=t||h(),a.unknown.lines.push(new f(0,""));for(var s=0;s<r.length;++s){var u=r[s],c=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(u);if(c)switch(c[1]){case"line":var l=/(\d+)(\s+\d+)?/.exec(c[2]);l&&(i=0|l[1],l[2]&&((o=0|l[2])in a||(a[o]=new d)));break;case"define":var p=/SHADER_NAME(_B64)?\s+(.*)$/.exec(c[2]);p&&(a[o].name=p[1]?(n=p[2],"undefined"!=typeof atob?atob(n):"base64:"+n):p[2])}a[o].lines.push(new f(i++,u))}return Object.keys(a).forEach((function(e){var t=a[e];t.lines.forEach((function(e){t.index[e.number]=e}))})),a}function m(e){e._commandRef=h()}function y(e,t){var n=p();r(e+" in command "+(t||h())+("unknown"===n?"":" called from "+n))}function v(e,t,n,r){a(e,t)||y("invalid parameter type"+o(n)+". expected "+t+", got "+typeof e,r||h())}var b=33071,E=32819,_=32820,w=33635,x=34042,A={};function T(e,t){return e===_||e===E||e===w?2:e===x?4:A[e]*t}function S(e){return!(e&e-1||!e)}A[5120]=A[5121]=1,A[5122]=A[5123]=A[36193]=A[w]=A[E]=A[_]=2,A[5124]=A[5125]=A[5126]=A[x]=4;var N=t(i,{optional:function(e){e()},raise:r,commandRaise:y,command:function(e,t,n){e||y(t,n||h())},parameter:function(e,t,n){e in t||r("unknown parameter ("+e+")"+o(n)+". possible values: "+Object.keys(t).join())},commandParameter:function(e,t,n,r){e in t||y("unknown parameter ("+e+")"+o(n)+". possible values: "+Object.keys(t).join(),r||h())},constructor:function(e){Object.keys(e).forEach((function(e){u.indexOf(e)<0&&r('invalid regl constructor argument "'+e+'". must be one of '+u)}))},type:function(e,t,n){a(e,t)||r("invalid parameter type"+o(n)+". expected "+t+", got "+typeof e)},commandType:v,isTypedArray:function(t,n){e(t)||r("invalid parameter type"+o(n)+". must be a typed array")},nni:function(e,t){e>=0&&(0|e)===e||r("invalid parameter type, ("+e+")"+o(t)+". must be a nonnegative integer")},oneOf:s,shaderError:function(e,t,r,o,a){if(!e.getShaderParameter(t,e.COMPILE_STATUS)){var s=e.getShaderInfoLog(t),u=o===e.FRAGMENT_SHADER?"fragment":"vertex";v(r,"string",u+" shader source must be a string",a);var d=g(r,a),f=function(e){var t=[];return e.split("\n").forEach((function(e){if(!(e.length<5)){var n=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(e);n?t.push(new l(0|n[1],0|n[2],n[3].trim())):e.length>0&&t.push(new l("unknown",0,e))}})),t}(s);(function(e,t){t.forEach((function(t){var n=e[t.file];if(n){var r=n.index[t.line];if(r)return r.errors.push(t),void(n.hasErrors=!0)}e.unknown.hasErrors=!0,e.unknown.lines[0].errors.push(t)}))})(d,f),Object.keys(d).forEach((function(e){var t=d[e];if(t.hasErrors){var r=[""],i=[""];o("file number "+e+": "+t.name+"\n","color:red;text-decoration:underline;font-weight:bold"),t.lines.forEach((function(e){if(e.errors.length>0){o(c(e.number,4)+"|  ","background-color:yellow; font-weight:bold"),o(e.line+n,"color:red; background-color:yellow; font-weight:bold");var t=0;e.errors.forEach((function(r){var i=r.message,a=/^\s*'(.*)'\s*:\s*(.*)$/.exec(i);if(a){var s=a[1];i=a[2],"assign"===s&&(s="="),t=Math.max(e.line.indexOf(s,t),0)}else t=0;o(c("| ",6)),o(c("^^^",t+3)+n,"font-weight:bold"),o(c("| ",6)),o(i+n,"font-weight:bold")})),o(c("| ",6)+n)}else o(c(e.number,4)+"|  "),o(e.line+n,"color:red")})),"undefined"==typeof document||window.chrome?console.log(r.join("")):(i[0]=r.join("%c"),console.log.apply(console,i))}function o(e,t){r.push(e),i.push(t||"")}})),i.raise("Error compiling "+u+" shader, "+d[0].name)}},linkError:function(e,t,r,o,a){if(!e.getProgramParameter(t,e.LINK_STATUS)){var s=e.getProgramInfoLog(t),u=g(r,a),c='Error linking program with vertex shader, "'+g(o,a)[0].name+'", and fragment shader "'+u[0].name+'"';"undefined"!=typeof document?console.log("%c"+c+"\n%c"+s,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(c+n+s),i.raise(c)}},callSite:p,saveCommandRef:m,saveDrawInfo:function(e,t,n,r){function i(e){return e?r.id(e):0}function o(e,t){Object.keys(t).forEach((function(t){e[r.id(t)]=!0}))}m(e),e._fragId=i(e.static.frag),e._vertId=i(e.static.vert);var a=e._uniformSet={};o(a,t.static),o(a,t.dynamic);var s=e._attributeSet={};o(s,n.static),o(s,n.dynamic),e._hasCount="count"in e.static||"count"in e.dynamic||"elements"in e.static||"elements"in e.dynamic},framebufferFormat:function(e,t,n){e.texture?s(e.texture._texture.internalformat,t,"unsupported texture format for attachment"):s(e.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")},guessCommand:h,texture2D:function(e,t,n){var r,o=t.width,a=t.height,s=t.channels;i(o>0&&o<=n.maxTextureSize&&a>0&&a<=n.maxTextureSize,"invalid texture shape"),e.wrapS===b&&e.wrapT===b||i(S(o)&&S(a),"incompatible wrap mode for texture, both width and height must be power of 2"),1===t.mipmask?1!==o&&1!==a&&i(9984!==e.minFilter&&9986!==e.minFilter&&9985!==e.minFilter&&9987!==e.minFilter,"min filter requires mipmap"):(i(S(o)&&S(a),"texture must be a square power of 2 to support mipmapping"),i(t.mipmask===(o<<1)-1,"missing or incomplete mipmap data")),5126===t.type&&(n.extensions.indexOf("oes_texture_float_linear")<0&&i(9728===e.minFilter&&9728===e.magFilter,"filter not supported, must enable oes_texture_float_linear"),i(!e.genMipmaps,"mipmap generation not supported with float textures"));var u=t.images;for(r=0;r<16;++r)if(u[r]){var c=o>>r,d=a>>r;i(t.mipmask&1<<r,"missing mipmap data");var f=u[r];if(i(f.width===c&&f.height===d,"invalid shape for mip images"),i(f.format===t.format&&f.internalformat===t.internalformat&&f.type===t.type,"incompatible type for mip image"),f.compressed);else if(f.data){var l=Math.ceil(T(f.type,s)*c/f.unpackAlignment)*f.unpackAlignment;i(f.data.byteLength===l*d,"invalid data for image, buffer size is inconsistent with image format")}else f.element||f.copy}else e.genMipmaps||i(0==(t.mipmask&1<<r),"extra mipmap data");t.compressed&&i(!e.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(e,t,n,r){var o=e.width,a=e.height,s=e.channels;i(o>0&&o<=r.maxTextureSize&&a>0&&a<=r.maxTextureSize,"invalid texture shape"),i(o===a,"cube map must be square"),i(t.wrapS===b&&t.wrapT===b,"wrap mode not supported by cube map");for(var u=0;u<n.length;++u){var c=n[u];i(c.width===o&&c.height===a,"inconsistent cube map face shape"),t.genMipmaps&&(i(!c.compressed,"can not generate mipmap for compressed textures"),i(1===c.mipmask,"can not specify mipmaps and generate mipmaps"));for(var d=c.images,f=0;f<16;++f){var l=d[f];if(l){var h=o>>f,p=a>>f;i(c.mipmask&1<<f,"missing mipmap data"),i(l.width===h&&l.height===p,"invalid shape for mip images"),i(l.format===e.format&&l.internalformat===e.internalformat&&l.type===e.type,"incompatible type for mip image"),l.compressed||(l.data?i(l.data.byteLength===h*p*Math.max(T(l.type,s),l.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):l.element||l.copy)}}}}}),D=0;function I(e,t){this.id=D++,this.type=e,this.data=t}function R(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function k(e){if(0===e.length)return[];var t=e.charAt(0),n=e.charAt(e.length-1);if(e.length>1&&t===n&&('"'===t||"'"===t))return['"'+R(e.substr(1,e.length-2))+'"'];var r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e);if(r)return k(e.substr(0,r.index)).concat(k(r[1])).concat(k(e.substr(r.index+r[0].length)));var i=e.split(".");if(1===i.length)return['"'+R(e)+'"'];for(var o=[],a=0;a<i.length;++a)o=o.concat(k(i[a]));return o}function O(e){return"["+k(e).join("][")+"]"}var C={DynamicVariable:I,define:function(e,t){return new I(e,O(t+""))},isDynamic:function(e){return"function"==typeof e&&!e._reglType||e instanceof I},unbox:function e(t,n){return"function"==typeof t?new I(0,t):"number"==typeof t||"boolean"==typeof t?new I(5,t):Array.isArray(t)?new I(6,t.map(((t,r)=>e(t,n+"["+r+"]")))):t instanceof I?t:void N(!1,"invalid option type in uniform "+n)},accessor:O},L={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},G="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function M(e){return"string"==typeof e?e.split():(N(Array.isArray(e),"invalid extension array"),e)}function U(e){return"string"==typeof e?(N("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(e)):e}function P(e){var n,r,i,o,a,s=e||{},u={},c=[],d=[],f="undefined"==typeof window?1:window.devicePixelRatio,l=!1,h=function(e){e&&N.raise(e)},p=function(){};if("string"==typeof s?(N("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),n=document.querySelector(s),N(n,"invalid query string for element")):"object"==typeof s?"string"==typeof(a=s).nodeName&&"function"==typeof a.appendChild&&"function"==typeof a.getBoundingClientRect?n=s:function(e){return"function"==typeof e.drawArrays||"function"==typeof e.drawElements}(s)?i=(o=s).canvas:(N.constructor(s),"gl"in s?o=s.gl:"canvas"in s?i=U(s.canvas):"container"in s&&(r=U(s.container)),"attributes"in s&&(u=s.attributes,N.type(u,"object","invalid context attributes")),"extensions"in s&&(c=M(s.extensions)),"optionalExtensions"in s&&(d=M(s.optionalExtensions)),"onDone"in s&&(N.type(s.onDone,"function","invalid or missing onDone callback"),h=s.onDone),"profile"in s&&(l=!!s.profile),"pixelRatio"in s&&(f=+s.pixelRatio,N(f>0,"invalid pixel ratio"))):N.raise("invalid arguments to regl"),n&&("canvas"===n.nodeName.toLowerCase()?i=n:r=n),!o){if(!i){N("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var g=function(e,n,r){var i,o=document.createElement("canvas");function a(){var n=window.innerWidth,i=window.innerHeight;if(e!==document.body){var a=e.getBoundingClientRect();n=a.right-a.left,i=a.bottom-a.top}o.width=r*n,o.height=r*i,t(o.style,{width:n+"px",height:i+"px"})}return t(o.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(o),e===document.body&&(o.style.position="absolute",t(e.style,{margin:0,padding:0})),e!==document.body&&"function"==typeof ResizeObserver?(i=new ResizeObserver((function(){setTimeout(a)}))).observe(e):window.addEventListener("resize",a,!1),a(),{canvas:o,onDestroy:function(){i?i.disconnect():window.removeEventListener("resize",a),e.removeChild(o)}}}(r||document.body,0,f);if(!g)return null;i=g.canvas,p=g.onDestroy}void 0===u.premultipliedAlpha&&(u.premultipliedAlpha=!0),o=function(e,t){function n(n){try{return e.getContext(n,t)}catch(e){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}(i,u)}return o?{gl:o,canvas:i,container:r,extensions:c,optionalExtensions:d,pixelRatio:f,profile:l,onDone:h,onDestroy:p}:(p(),h("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function z(e,t){for(var n=Array(e),r=0;r<e;++r)n[r]=t(r);return n}function F(e){var t,n;return t=(e>65535)<<4,t|=n=((e>>>=t)>255)<<3,t|=n=((e>>>=n)>15)<<2,(t|=n=((e>>>=n)>3)<<1)|(e>>>=n)>>1}function B(){var e=z(8,(function(){return[]}));function t(t){var n=function(e){for(var t=16;t<=1<<28;t*=16)if(e<=t)return t;return 0}(t),r=e[F(n)>>2];return r.length>0?r.pop():new ArrayBuffer(n)}function n(t){e[F(t.byteLength)>>2].push(t)}return{alloc:t,free:n,allocType:function(e,n){var r=null;switch(e){case 5120:r=new Int8Array(t(n),0,n);break;case 5121:r=new Uint8Array(t(n),0,n);break;case 5122:r=new Int16Array(t(2*n),0,n);break;case 5123:r=new Uint16Array(t(2*n),0,n);break;case 5124:r=new Int32Array(t(4*n),0,n);break;case 5125:r=new Uint32Array(t(4*n),0,n);break;case 5126:r=new Float32Array(t(4*n),0,n);break;default:return null}return r.length!==n?r.subarray(0,n):r},freeType:function(e){n(e.buffer)}}}var j=B();j.zero=B();var V=3553,W=6408,H=5126,X=36160;function Y(t){return!!t&&"object"==typeof t&&Array.isArray(t.shape)&&Array.isArray(t.stride)&&"number"==typeof t.offset&&t.shape.length===t.stride.length&&(Array.isArray(t.data)||e(t.data))}var K=function(e){return Object.keys(e).map((function(t){return e[t]}))},q={shape:function(e){for(var t=[],n=e;n.length;n=n[0])t.push(n.length);return t},flatten:function(e,t,n,r){var i=1;if(t.length)for(var o=0;o<t.length;++o)i*=t[o];else i=0;var a=r||j.allocType(n,i);switch(t.length){case 0:break;case 1:!function(e,t,n){for(var r=0;r<t;++r)n[r]=e[r]}(e,t[0],a);break;case 2:!function(e,t,n,r){for(var i=0,o=0;o<t;++o)for(var a=e[o],s=0;s<n;++s)r[i++]=a[s]}(e,t[0],t[1],a);break;case 3:Z(e,t[0],t[1],t[2],a,0);break;default:Q(e,t,0,a,0)}return a}};function Z(e,t,n,r,i,o){for(var a=o,s=0;s<t;++s)for(var u=e[s],c=0;c<n;++c)for(var d=u[c],f=0;f<r;++f)i[a++]=d[f]}function Q(e,t,n,r,i){for(var o=1,a=n+1;a<t.length;++a)o*=t[a];var s=t[n];if(t.length-n==4){var u=t[n+1],c=t[n+2],d=t[n+3];for(a=0;a<s;++a)Z(e[a],u,c,d,r,i),i+=o}else for(a=0;a<s;++a)Q(e[a],t,n+1,r,i),i+=o}var J={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},$={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},ee={dynamic:35048,stream:35040,static:35044},te=q.flatten,ne=q.shape,re=35044,ie=35040,oe=5121,ae=5126,se=[];function ue(e){return 0|J[Object.prototype.toString.call(e)]}function ce(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function de(e,t,n,r,i,o,a){for(var s=0,u=0;u<n;++u)for(var c=0;c<r;++c)e[s++]=t[i*u+o*c+a]}se[5120]=1,se[5122]=2,se[5124]=4,se[5121]=1,se[5123]=2,se[5125]=4,se[5126]=4;var fe={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},le=0,he=1,pe=4,ge=5120,me=5121,ye=5122,ve=5123,be=5124,Ee=5125,_e=34963,we=35040,xe=35044;var Ae=new Float32Array(1),Te=new Uint32Array(Ae.buffer),Se=5123;function Ne(e){for(var t=j.allocType(Se,e.length),n=0;n<e.length;++n)if(isNaN(e[n]))t[n]=65535;else if(e[n]===1/0)t[n]=31744;else if(e[n]===-1/0)t[n]=64512;else{Ae[0]=e[n];var r=Te[0],i=r>>>31<<15,o=(r<<1>>>24)-127,a=r>>13&1023;if(o<-24)t[n]=i;else if(o<-14){var s=-14-o;t[n]=i+(a+1024>>s)}else t[n]=o>15?i+31744:i+(o+15<<10)+a}return t}function De(t){return Array.isArray(t)||e(t)}var Ie=function(e){return!(e&e-1||!e)},Re=34467,ke=3553,Oe=34067,Ce=34069,Le=6408,Ge=6406,Me=6407,Ue=6409,Pe=6410,ze=32854,Fe=32855,Be=36194,je=32819,Ve=32820,We=33635,He=34042,Xe=6402,Ye=34041,Ke=35904,qe=35906,Ze=36193,Qe=33776,Je=33777,$e=33778,et=33779,tt=35986,nt=35987,rt=34798,it=35840,ot=35841,at=35842,st=35843,ut=36196,ct=5121,dt=5123,ft=5125,lt=5126,ht=10242,pt=10243,gt=10497,mt=33071,yt=33648,vt=10240,bt=10241,Et=9728,_t=9729,wt=9984,xt=9985,At=9986,Tt=9987,St=33170,Nt=4352,Dt=4353,It=4354,Rt=34046,kt=3317,Ot=37440,Ct=37441,Lt=37443,Gt=37444,Mt=33984,Ut=[wt,At,xt,Tt],Pt=[0,Ue,Pe,Me,Le],zt={};function Ft(e){return"[object "+e+"]"}zt[Ue]=zt[Ge]=zt[Xe]=1,zt[Ye]=zt[Pe]=2,zt[Me]=zt[Ke]=3,zt[Le]=zt[qe]=4;var Bt=Ft("HTMLCanvasElement"),jt=Ft("OffscreenCanvas"),Vt=Ft("CanvasRenderingContext2D"),Wt=Ft("ImageBitmap"),Ht=Ft("HTMLImageElement"),Xt=Ft("HTMLVideoElement"),Yt=Object.keys(J).concat([Bt,jt,Vt,Wt,Ht,Xt]),Kt=[];Kt[ct]=1,Kt[lt]=4,Kt[Ze]=2,Kt[dt]=2,Kt[ft]=4;var qt=[];function Zt(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function Qt(e){return!!Array.isArray(e)&&!(0===e.length||!De(e[0]))}function Jt(e){return Object.prototype.toString.call(e)}function $t(e){return Jt(e)===Bt}function en(e){return Jt(e)===jt}function tn(e){if(!e)return!1;var t=Jt(e);return Yt.indexOf(t)>=0||Zt(e)||Qt(e)||Y(e)}function nn(e){return 0|J[Object.prototype.toString.call(e)]}function rn(e,t){return j.allocType(e.type===Ze?lt:e.type,t)}function on(e,t){e.type===Ze?(e.data=Ne(t),j.freeType(t)):e.data=t}function an(e,t,n,r,i,o){var a;if(a=void 0!==qt[e]?qt[e]:zt[e]*Kt[t],o&&(a*=6),i){for(var s=0,u=n;u>=1;)s+=a*u*u,u/=2;return s}return a*n*r}function sn(n,r,i,o,a,s,u){var c={"don't care":Nt,"dont care":Nt,nice:It,fast:Dt},d={repeat:gt,clamp:mt,mirror:yt},f={nearest:Et,linear:_t},l=t({mipmap:Tt,"nearest mipmap nearest":wt,"linear mipmap nearest":xt,"nearest mipmap linear":At,"linear mipmap linear":Tt},f),h={none:0,browser:Gt},p={uint8:ct,rgba4:je,rgb565:We,"rgb5 a1":Ve},g={alpha:Ge,luminance:Ue,"luminance alpha":Pe,rgb:Me,rgba:Le,rgba4:ze,"rgb5 a1":Fe,rgb565:Be},m={};r.ext_srgb&&(g.srgb=Ke,g.srgba=qe),r.oes_texture_float&&(p.float32=p.float=lt),r.oes_texture_half_float&&(p.float16=p["half float"]=Ze),r.webgl_depth_texture&&(t(g,{depth:Xe,"depth stencil":Ye}),t(p,{uint16:dt,uint32:ft,"depth stencil":He})),r.webgl_compressed_texture_s3tc&&t(m,{"rgb s3tc dxt1":Qe,"rgba s3tc dxt1":Je,"rgba s3tc dxt3":$e,"rgba s3tc dxt5":et}),r.webgl_compressed_texture_atc&&t(m,{"rgb atc":tt,"rgba atc explicit alpha":nt,"rgba atc interpolated alpha":rt}),r.webgl_compressed_texture_pvrtc&&t(m,{"rgb pvrtc 4bppv1":it,"rgb pvrtc 2bppv1":ot,"rgba pvrtc 4bppv1":at,"rgba pvrtc 2bppv1":st}),r.webgl_compressed_texture_etc1&&(m["rgb etc1"]=ut);var y=Array.prototype.slice.call(n.getParameter(Re));Object.keys(m).forEach((function(e){var t=m[e];y.indexOf(t)>=0&&(g[e]=t)}));var v=Object.keys(g);i.textureFormats=v;var b=[];Object.keys(g).forEach((function(e){var t=g[e];b[t]=e}));var E=[];Object.keys(p).forEach((function(e){var t=p[e];E[t]=e}));var _=[];Object.keys(f).forEach((function(e){var t=f[e];_[t]=e}));var w=[];Object.keys(l).forEach((function(e){var t=l[e];w[t]=e}));var x=[];Object.keys(d).forEach((function(e){var t=d[e];x[t]=e}));var A=v.reduce((function(e,t){var n=g[t];return n===Ue||n===Ge||n===Ue||n===Pe||n===Xe||n===Ye||r.ext_srgb&&(n===Ke||n===qe)?e[n]=n:n===Fe||t.indexOf("rgba")>=0?e[n]=Le:e[n]=Me,e}),{});function T(){this.internalformat=Le,this.format=Le,this.type=ct,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Gt,this.width=0,this.height=0,this.channels=0}function S(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function D(e,t){if("object"==typeof t&&t){if("premultiplyAlpha"in t&&(N.type(t.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),e.premultiplyAlpha=t.premultiplyAlpha),"flipY"in t&&(N.type(t.flipY,"boolean","invalid texture flip"),e.flipY=t.flipY),"alignment"in t&&(N.oneOf(t.alignment,[1,2,4,8],"invalid texture unpack alignment"),e.unpackAlignment=t.alignment),"colorSpace"in t&&(N.parameter(t.colorSpace,h,"invalid colorSpace"),e.colorSpace=h[t.colorSpace]),"type"in t){var n=t.type;N(r.oes_texture_float||!("float"===n||"float32"===n),"you must enable the OES_texture_float extension in order to use floating point textures."),N(r.oes_texture_half_float||!("half float"===n||"float16"===n),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),N(r.webgl_depth_texture||!("uint16"===n||"uint32"===n||"depth stencil"===n),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),N.parameter(n,p,"invalid texture type"),e.type=p[n]}var o=e.width,a=e.height,s=e.channels,u=!1;"shape"in t?(N(Array.isArray(t.shape)&&t.shape.length>=2,"shape must be an array"),o=t.shape[0],a=t.shape[1],3===t.shape.length&&(s=t.shape[2],N(s>0&&s<=4,"invalid number of channels"),u=!0),N(o>=0&&o<=i.maxTextureSize,"invalid width"),N(a>=0&&a<=i.maxTextureSize,"invalid height")):("radius"in t&&(o=a=t.radius,N(o>=0&&o<=i.maxTextureSize,"invalid radius")),"width"in t&&(o=t.width,N(o>=0&&o<=i.maxTextureSize,"invalid width")),"height"in t&&(a=t.height,N(a>=0&&a<=i.maxTextureSize,"invalid height")),"channels"in t&&(s=t.channels,N(s>0&&s<=4,"invalid number of channels"),u=!0)),e.width=0|o,e.height=0|a,e.channels=0|s;var c=!1;if("format"in t){var d=t.format;N(r.webgl_depth_texture||!("depth"===d||"depth stencil"===d),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),N.parameter(d,g,"invalid texture format");var f=e.internalformat=g[d];e.format=A[f],d in p&&("type"in t||(e.type=p[d])),d in m&&(e.compressed=!0),c=!0}!u&&c?e.channels=zt[e.format]:u&&!c?e.channels!==Pt[e.format]&&(e.format=e.internalformat=Pt[e.channels]):c&&u&&N(e.channels===zt[e.format],"number of channels inconsistent with specified format")}}function I(e){n.pixelStorei(Ot,e.flipY),n.pixelStorei(Ct,e.premultiplyAlpha),n.pixelStorei(Lt,e.colorSpace),n.pixelStorei(kt,e.unpackAlignment)}function R(){T.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function k(t,n){var r=null;if(tn(n)?r=n:n&&(N.type(n,"object","invalid pixel data type"),D(t,n),"x"in n&&(t.xOffset=0|n.x),"y"in n&&(t.yOffset=0|n.y),tn(n.data)&&(r=n.data)),N(!t.compressed||r instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),n.copy){N(!r,"can not specify copy and data field for the same texture");var o=a.viewportWidth,s=a.viewportHeight;t.width=t.width||o-t.xOffset,t.height=t.height||s-t.yOffset,t.needsCopy=!0,N(t.xOffset>=0&&t.xOffset<o&&t.yOffset>=0&&t.yOffset<s&&t.width>0&&t.width<=o&&t.height>0&&t.height<=s,"copy texture read out of bounds")}else if(r){if(e(r))t.channels=t.channels||4,t.data=r,"type"in n||t.type!==ct||(t.type=nn(r));else if(Zt(r))t.channels=t.channels||4,function(e,t){var n=t.length;switch(e.type){case ct:case dt:case ft:case lt:var r=j.allocType(e.type,n);r.set(t),e.data=r;break;case Ze:e.data=Ne(t);break;default:N.raise("unsupported texture type, must specify a typed array")}}(t,r),t.alignment=1,t.needsFree=!0;else if(Y(r)){var u=r.data;Array.isArray(u)||t.type!==ct||(t.type=nn(u));var c,d,f,l,h,p,g=r.shape,m=r.stride;3===g.length?(f=g[2],p=m[2]):(N(2===g.length,"invalid ndarray pixel data, must be 2 or 3D"),f=1,p=1),c=g[0],d=g[1],l=m[0],h=m[1],t.alignment=1,t.width=c,t.height=d,t.channels=f,t.format=t.internalformat=Pt[f],t.needsFree=!0,function(e,t,n,r,i,o){for(var a=e.width,s=e.height,u=e.channels,c=rn(e,a*s*u),d=0,f=0;f<s;++f)for(var l=0;l<a;++l)for(var h=0;h<u;++h)c[d++]=t[n*l+r*f+i*h+o];on(e,c)}(t,u,l,h,p,r.offset)}else if($t(r)||en(r)||Jt(r)===Vt)$t(r)||en(r)?t.element=r:t.element=r.canvas,t.width=t.element.width,t.height=t.element.height,t.channels=4;else if(function(e){return Jt(e)===Wt}(r))t.element=r,t.width=r.width,t.height=r.height,t.channels=4;else if(function(e){return Jt(e)===Ht}(r))t.element=r,t.width=r.naturalWidth,t.height=r.naturalHeight,t.channels=4;else if(function(e){return Jt(e)===Xt}(r))t.element=r,t.width=r.videoWidth,t.height=r.videoHeight,t.channels=4;else if(Qt(r)){var y=t.width||r[0].length,v=t.height||r.length,b=t.channels;b=De(r[0][0])?b||r[0][0].length:b||1;for(var E=q.shape(r),_=1,w=0;w<E.length;++w)_*=E[w];var x=rn(t,_);q.flatten(r,E,"",x),on(t,x),t.alignment=1,t.width=y,t.height=v,t.channels=b,t.format=t.internalformat=Pt[b],t.needsFree=!0}}else t.width=t.width||1,t.height=t.height||1,t.channels=t.channels||4;t.type===lt?N(i.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):t.type===Ze&&N(i.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function O(e,t,r){var i=e.element,a=e.data,s=e.internalformat,u=e.format,c=e.type,d=e.width,f=e.height;I(e),i?n.texImage2D(t,r,u,u,c,i):e.compressed?n.compressedTexImage2D(t,r,s,d,f,0,a):e.needsCopy?(o(),n.copyTexImage2D(t,r,u,e.xOffset,e.yOffset,d,f,0)):n.texImage2D(t,r,u,d,f,0,u,c,a||null)}function C(e,t,r,i,a){var s=e.element,u=e.data,c=e.internalformat,d=e.format,f=e.type,l=e.width,h=e.height;I(e),s?n.texSubImage2D(t,a,r,i,d,f,s):e.compressed?n.compressedTexSubImage2D(t,a,r,i,c,l,h,u):e.needsCopy?(o(),n.copyTexSubImage2D(t,a,r,i,e.xOffset,e.yOffset,l,h)):n.texSubImage2D(t,a,r,i,l,h,d,f,u)}var L=[];function G(){return L.pop()||new R}function M(e){e.needsFree&&j.freeType(e.data),R.call(e),L.push(e)}function U(){T.call(this),this.genMipmaps=!1,this.mipmapHint=Nt,this.mipmask=0,this.images=Array(16)}function P(e,t,n){var r=e.images[0]=G();e.mipmask=1,r.width=e.width=t,r.height=e.height=n,r.channels=e.channels=4}function z(e,t){var n=null;if(tn(t))S(n=e.images[0]=G(),e),k(n,t),e.mipmask=1;else if(D(e,t),Array.isArray(t.mipmap))for(var r=t.mipmap,i=0;i<r.length;++i)S(n=e.images[i]=G(),e),n.width>>=i,n.height>>=i,k(n,r[i]),e.mipmask|=1<<i;else S(n=e.images[0]=G(),e),k(n,t),e.mipmask=1;S(e,e.images[0]),!e.compressed||e.internalformat!==Qe&&e.internalformat!==Je&&e.internalformat!==$e&&e.internalformat!==et||N(e.width%4==0&&e.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function F(e,t){for(var n=e.images,r=0;r<n.length;++r){if(!n[r])return;O(n[r],t,r)}}var B=[];function V(){var e=B.pop()||new U;T.call(e),e.mipmask=0;for(var t=0;t<16;++t)e.images[t]=null;return e}function W(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&M(t[n]),t[n]=null;B.push(e)}function H(){this.minFilter=Et,this.magFilter=Et,this.wrapS=mt,this.wrapT=mt,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Nt}function X(e,t){if("min"in t){var n=t.min;N.parameter(n,l),e.minFilter=l[n],Ut.indexOf(e.minFilter)>=0&&!("faces"in t)&&(e.genMipmaps=!0)}if("mag"in t){var r=t.mag;N.parameter(r,f),e.magFilter=f[r]}var o=e.wrapS,a=e.wrapT;if("wrap"in t){var s=t.wrap;"string"==typeof s?(N.parameter(s,d),o=a=d[s]):Array.isArray(s)&&(N.parameter(s[0],d),N.parameter(s[1],d),o=d[s[0]],a=d[s[1]])}else{if("wrapS"in t){var u=t.wrapS;N.parameter(u,d),o=d[u]}if("wrapT"in t){var h=t.wrapT;N.parameter(h,d),a=d[h]}}if(e.wrapS=o,e.wrapT=a,"anisotropic"in t){var p=t.anisotropic;N("number"==typeof p&&p>=1&&p<=i.maxAnisotropic,"aniso samples must be between 1 and "),e.anisotropic=t.anisotropic}if("mipmap"in t){var g=!1;switch(typeof t.mipmap){case"string":N.parameter(t.mipmap,c,"invalid mipmap hint"),e.mipmapHint=c[t.mipmap],e.genMipmaps=!0,g=!0;break;case"boolean":g=e.genMipmaps=t.mipmap;break;case"object":N(Array.isArray(t.mipmap),"invalid mipmap type"),e.genMipmaps=!1,g=!0;break;default:N.raise("invalid mipmap type")}g&&!("min"in t)&&(e.minFilter=wt)}}function Z(e,t){n.texParameteri(t,bt,e.minFilter),n.texParameteri(t,vt,e.magFilter),n.texParameteri(t,ht,e.wrapS),n.texParameteri(t,pt,e.wrapT),r.ext_texture_filter_anisotropic&&n.texParameteri(t,Rt,e.anisotropic),e.genMipmaps&&(n.hint(St,e.mipmapHint),n.generateMipmap(t))}var Q=0,J={},$=i.maxTextureUnits,ee=Array($).map((function(){return null}));function te(e){T.call(this),this.mipmask=0,this.internalformat=Le,this.id=Q++,this.refCount=1,this.target=e,this.texture=n.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new H,u.profile&&(this.stats={size:0})}function ne(e){n.activeTexture(Mt),n.bindTexture(e.target,e.texture)}function re(){var e=ee[0];e?n.bindTexture(e.target,e.texture):n.bindTexture(ke,null)}function ie(e){var t=e.texture;N(t,"must not double destroy texture");var r=e.unit,i=e.target;r>=0&&(n.activeTexture(Mt+r),n.bindTexture(i,null),ee[r]=null),n.deleteTexture(t),e.texture=null,e.params=null,e.pixels=null,e.refCount=0,delete J[e.id],s.textureCount--}return t(te.prototype,{bind:function(){var e=this;e.bindCount+=1;var t=e.unit;if(t<0){for(var r=0;r<$;++r){var i=ee[r];if(i){if(i.bindCount>0)continue;i.unit=-1}ee[r]=e,t=r;break}t>=$&&N.raise("insufficient number of texture units"),u.profile&&s.maxTextureUnits<t+1&&(s.maxTextureUnits=t+1),e.unit=t,n.activeTexture(Mt+t),n.bindTexture(e.target,e.texture)}return t},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&ie(this)}}),u.profile&&(s.getTotalTextureSize=function(){var e=0;return Object.keys(J).forEach((function(t){e+=J[t].stats.size})),e}),{create2D:function(e,t){var r=new te(ke);function o(e,t){var n=r.texInfo;H.call(n);var a=V();return"number"==typeof e?P(a,0|e,"number"==typeof t?0|t:0|e):e?(N.type(e,"object","invalid arguments to regl.texture"),X(n,e),z(a,e)):P(a,1,1),n.genMipmaps&&(a.mipmask=(a.width<<1)-1),r.mipmask=a.mipmask,S(r,a),N.texture2D(n,a,i),r.internalformat=a.internalformat,o.width=a.width,o.height=a.height,ne(r),F(a,ke),Z(n,ke),re(),W(a),u.profile&&(r.stats.size=an(r.internalformat,r.type,a.width,a.height,n.genMipmaps,!1)),o.format=b[r.internalformat],o.type=E[r.type],o.mag=_[n.magFilter],o.min=w[n.minFilter],o.wrapS=x[n.wrapS],o.wrapT=x[n.wrapT],o}return J[r.id]=r,s.textureCount++,o(e,t),o.subimage=function(e,t,n,i){N(!!e,"must specify image data");var a=0|t,s=0|n,u=0|i,c=G();return S(c,r),c.width=0,c.height=0,k(c,e),c.width=c.width||(r.width>>u)-a,c.height=c.height||(r.height>>u)-s,N(r.type===c.type&&r.format===c.format&&r.internalformat===c.internalformat,"incompatible format for texture.subimage"),N(a>=0&&s>=0&&a+c.width<=r.width&&s+c.height<=r.height,"texture.subimage write out of bounds"),N(r.mipmask&1<<u,"missing mipmap data"),N(c.data||c.element||c.needsCopy,"missing image data"),ne(r),C(c,ke,a,s,u),re(),M(c),o},o.resize=function(e,t){var i=0|e,a=0|t||i;if(i===r.width&&a===r.height)return o;o.width=r.width=i,o.height=r.height=a,ne(r);for(var s=0;r.mipmask>>s;++s){var c=i>>s,d=a>>s;if(!c||!d)break;n.texImage2D(ke,s,r.format,c,d,0,r.format,r.type,null)}return re(),u.profile&&(r.stats.size=an(r.internalformat,r.type,i,a,!1,!1)),o},o._reglType="texture2d",o._texture=r,u.profile&&(o.stats=r.stats),o.destroy=function(){r.decRef()},o},createCube:function(e,t,r,o,a,c){var d=new te(Oe);J[d.id]=d,s.cubeCount++;var f=new Array(6);function l(e,t,n,r,o,a){var s,c=d.texInfo;for(H.call(c),s=0;s<6;++s)f[s]=V();if("number"!=typeof e&&e)if("object"==typeof e)if(t)z(f[0],e),z(f[1],t),z(f[2],n),z(f[3],r),z(f[4],o),z(f[5],a);else if(X(c,e),D(d,e),"faces"in e){var h=e.faces;for(N(Array.isArray(h)&&6===h.length,"cube faces must be a length 6 array"),s=0;s<6;++s)N("object"==typeof h[s]&&!!h[s],"invalid input for cube map face"),S(f[s],d),z(f[s],h[s])}else for(s=0;s<6;++s)z(f[s],e);else N.raise("invalid arguments to cube map");else{var p=0|e||1;for(s=0;s<6;++s)P(f[s],p,p)}for(S(d,f[0]),i.npotTextureCube||N(Ie(d.width)&&Ie(d.height),"your browser does not support non power or two texture dimensions"),c.genMipmaps?d.mipmask=(f[0].width<<1)-1:d.mipmask=f[0].mipmask,N.textureCube(d,c,f,i),d.internalformat=f[0].internalformat,l.width=f[0].width,l.height=f[0].height,ne(d),s=0;s<6;++s)F(f[s],Ce+s);for(Z(c,Oe),re(),u.profile&&(d.stats.size=an(d.internalformat,d.type,l.width,l.height,c.genMipmaps,!0)),l.format=b[d.internalformat],l.type=E[d.type],l.mag=_[c.magFilter],l.min=w[c.minFilter],l.wrapS=x[c.wrapS],l.wrapT=x[c.wrapT],s=0;s<6;++s)W(f[s]);return l}return l(e,t,r,o,a,c),l.subimage=function(e,t,n,r,i){N(!!t,"must specify image data"),N("number"==typeof e&&e===(0|e)&&e>=0&&e<6,"invalid face");var o=0|n,a=0|r,s=0|i,u=G();return S(u,d),u.width=0,u.height=0,k(u,t),u.width=u.width||(d.width>>s)-o,u.height=u.height||(d.height>>s)-a,N(d.type===u.type&&d.format===u.format&&d.internalformat===u.internalformat,"incompatible format for texture.subimage"),N(o>=0&&a>=0&&o+u.width<=d.width&&a+u.height<=d.height,"texture.subimage write out of bounds"),N(d.mipmask&1<<s,"missing mipmap data"),N(u.data||u.element||u.needsCopy,"missing image data"),ne(d),C(u,Ce+e,o,a,s),re(),M(u),l},l.resize=function(e){var t=0|e;if(t!==d.width){l.width=d.width=t,l.height=d.height=t,ne(d);for(var r=0;r<6;++r)for(var i=0;d.mipmask>>i;++i)n.texImage2D(Ce+r,i,d.format,t>>i,t>>i,0,d.format,d.type,null);return re(),u.profile&&(d.stats.size=an(d.internalformat,d.type,l.width,l.height,!1,!0)),l}},l._reglType="textureCube",l._texture=d,u.profile&&(l.stats=d.stats),l.destroy=function(){d.decRef()},l},clear:function(){for(var e=0;e<$;++e)n.activeTexture(Mt+e),n.bindTexture(ke,null),ee[e]=null;K(J).forEach(ie),s.cubeCount=0,s.textureCount=0},getTexture:function(e){return null},restore:function(){for(var e=0;e<$;++e){var t=ee[e];t&&(t.bindCount=0,t.unit=-1,ee[e]=null)}K(J).forEach((function(e){e.texture=n.createTexture(),n.bindTexture(e.target,e.texture);for(var t=0;t<32;++t)if(0!=(e.mipmask&1<<t))if(e.target===ke)n.texImage2D(ke,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);else for(var r=0;r<6;++r)n.texImage2D(Ce+r,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);Z(e.texInfo,e.target)}))},refresh:function(){for(var e=0;e<$;++e){var t=ee[e];t&&(t.bindCount=0,t.unit=-1,ee[e]=null),n.activeTexture(Mt+e),n.bindTexture(ke,null),n.bindTexture(Oe,null)}}}}qt[ze]=2,qt[Fe]=2,qt[Be]=2,qt[Ye]=4,qt[Qe]=.5,qt[Je]=.5,qt[$e]=1,qt[et]=1,qt[tt]=.5,qt[nt]=1,qt[rt]=1,qt[it]=.5,qt[ot]=.25,qt[at]=.5,qt[st]=.25,qt[ut]=.5;var un=36161,cn=32854,dn=[];function fn(e,t,n){return dn[e]*t*n}dn[32854]=2,dn[32855]=2,dn[36194]=2,dn[33189]=2,dn[36168]=1,dn[34041]=4,dn[35907]=4,dn[34836]=16,dn[34842]=8,dn[34843]=6;var ln=36160,hn=36161,pn=3553,gn=34069,mn=36064,yn=36096,vn=36128,bn=33306,En=36053,_n=6402,wn=[6407,6408],xn=[];xn[6408]=4,xn[6407]=3;var An=[];An[5121]=1,An[5126]=4,An[36193]=2;var Tn=33189,Sn=36168,Nn=34041,Dn=[32854,32855,36194,35907,34842,34843,34836],In={};In[En]="complete",In[36054]="incomplete attachment",In[36057]="incomplete dimensions",In[36055]="incomplete, missing attachment",In[36061]="unsupported";var Rn=5126,kn=34962;function On(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Rn,this.offset=0,this.stride=0,this.divisor=0}var Cn=35632,Ln=35633,Gn=35718,Mn=35721;var Un=6408,Pn=5121,zn=3333,Fn=5126;function Bn(t,n,r,i,o,a,s){function u(u){var c;null===n.next?(N(o.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),c=Pn):(N(null!==n.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),c=n.next.colorAttachments[0].texture._texture.type,a.oes_texture_float?(N(c===Pn||c===Fn,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),c===Fn&&N(s.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):N(c===Pn,"Reading from a framebuffer is only allowed for the type 'uint8'"));var d=0,f=0,l=i.framebufferWidth,h=i.framebufferHeight,p=null;e(u)?p=u:u&&(N.type(u,"object","invalid arguments to regl.read()"),d=0|u.x,f=0|u.y,N(d>=0&&d<i.framebufferWidth,"invalid x offset for regl.read"),N(f>=0&&f<i.framebufferHeight,"invalid y offset for regl.read"),l=0|(u.width||i.framebufferWidth-d),h=0|(u.height||i.framebufferHeight-f),p=u.data||null),p&&(c===Pn?N(p instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):c===Fn&&N(p instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),N(l>0&&l+d<=i.framebufferWidth,"invalid width for read pixels"),N(h>0&&h+f<=i.framebufferHeight,"invalid height for read pixels"),r();var g=l*h*4;return p||(c===Pn?p=new Uint8Array(g):c===Fn&&(p=p||new Float32Array(g))),N.isTypedArray(p,"data buffer for regl.read() must be a typedarray"),N(p.byteLength>=g,"data buffer for regl.read() too small"),t.pixelStorei(zn,4),t.readPixels(d,f,l,h,Un,c,p),p}return function(e){return e&&"framebuffer"in e?function(e){var t;return n.setFBO({framebuffer:e.framebuffer},(function(){t=u(e)})),t}(e):u(e)}}function jn(e){return Array.prototype.slice.call(e)}function Vn(e){return jn(e).join("")}var Wn="xyzw".split(""),Hn=5121,Xn=1,Yn=2,Kn=0,qn=1,Zn=2,Qn=3,Jn=4,$n=5,er=6,tr="dither",nr="blend.enable",rr="blend.color",ir="blend.equation",or="blend.func",ar="depth.enable",sr="depth.func",ur="depth.range",cr="depth.mask",dr="colorMask",fr="cull.enable",lr="cull.face",hr="frontFace",pr="lineWidth",gr="polygonOffset.enable",mr="polygonOffset.offset",yr="sample.alpha",vr="sample.enable",br="sample.coverage",Er="stencil.enable",_r="stencil.mask",wr="stencil.func",xr="stencil.opFront",Ar="stencil.opBack",Tr="scissor.enable",Sr="scissor.box",Nr="viewport",Dr="profile",Ir="framebuffer",Rr="vert",kr="frag",Or="elements",Cr="primitive",Lr="count",Gr="offset",Mr="instances",Ur="vao",Pr="Width",zr="Height",Fr=Ir+Pr,Br=Ir+zr,jr=Nr+Pr,Vr=Nr+zr,Wr="drawingBuffer",Hr=Wr+Pr,Xr=Wr+zr,Yr=[or,ir,wr,xr,Ar,br,Nr,Sr,mr],Kr=34962,qr=34963,Zr=3553,Qr=34067,Jr=2884,$r=3042,ei=3024,ti=2960,ni=2929,ri=3089,ii=32823,oi=32926,ai=32928,si=5126,ui=35664,ci=35665,di=35666,fi=5124,li=35667,hi=35668,pi=35669,gi=35670,mi=35671,yi=35672,vi=35673,bi=35674,Ei=35675,_i=35676,wi=35678,xi=35680,Ai=4,Ti=1028,Si=1029,Ni=2304,Di=2305,Ii=32775,Ri=32776,ki=519,Oi=7680,Ci=0,Li=1,Gi=32774,Mi=513,Ui=36160,Pi=36064,zi={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Fi=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Bi={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},ji={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Vi={frag:35632,vert:35633},Wi={cw:Ni,ccw:Di};function Hi(t){return Array.isArray(t)||e(t)||Y(t)}function Xi(e){return e.sort((function(e,t){return e===Nr?-1:t===Nr?1:e<t?-1:1}))}function Yi(e,t,n,r){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=r}function Ki(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function qi(e){return new Yi(!1,!1,!1,e)}function Zi(e,t){var n=e.type;if(n===Kn){var r=e.data.length;return new Yi(!0,r>=1,r>=2,t)}if(n===Jn){var i=e.data;return new Yi(i.thisDep,i.contextDep,i.propDep,t)}if(n===$n)return new Yi(!1,!1,!1,t);if(n===er){for(var o=!1,a=!1,s=!1,u=0;u<e.data.length;++u){var c=e.data[u];if(c.type===qn)s=!0;else if(c.type===Zn)a=!0;else if(c.type===Qn)o=!0;else if(c.type===Kn){o=!0;var d=c.data;d>=1&&(a=!0),d>=2&&(s=!0)}else c.type===Jn&&(o=o||c.data.thisDep,a=a||c.data.contextDep,s=s||c.data.propDep)}return new Yi(o,a,s,t)}return new Yi(n===Qn,n===Zn,n===qn,t)}var Qi=new Yi(!1,!1,!1,(function(){}));function Ji(e,n,r,i,o,a,s,u,c,d,f,l,h,p,g){var m=d.Record,y={add:32774,subtract:32778,"reverse subtract":32779};r.ext_blend_minmax&&(y.min=Ii,y.max=Ri);var v=r.angle_instanced_arrays,b=r.webgl_draw_buffers,E={dirty:!0,profile:g.profile},_={},w=[],x={},A={};function T(e){return e.replace(".","_")}function S(e,t,n){var r=T(e);w.push(e),_[r]=E[r]=!!n,x[r]=t}function D(e,t,n){var r=T(e);w.push(e),Array.isArray(n)?(E[r]=n.slice(),_[r]=n.slice()):E[r]=_[r]=n,A[r]=t}S(tr,ei),S(nr,$r),D(rr,"blendColor",[0,0,0,0]),D(ir,"blendEquationSeparate",[Gi,Gi]),D(or,"blendFuncSeparate",[Li,Ci,Li,Ci]),S(ar,ni,!0),D(sr,"depthFunc",Mi),D(ur,"depthRange",[0,1]),D(cr,"depthMask",!0),D(dr,dr,[!0,!0,!0,!0]),S(fr,Jr),D(lr,"cullFace",Si),D(hr,hr,Di),D(pr,pr,1),S(gr,ii),D(mr,"polygonOffset",[0,0]),S(yr,oi),S(vr,ai),D(br,"sampleCoverage",[1,!1]),S(Er,ti),D(_r,"stencilMask",-1),D(wr,"stencilFunc",[ki,0,-1]),D(xr,"stencilOpSeparate",[Ti,Oi,Oi,Oi]),D(Ar,"stencilOpSeparate",[Si,Oi,Oi,Oi]),S(Tr,ri),D(Sr,"scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),D(Nr,Nr,[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var I={gl:e,context:h,strings:n,next:_,current:E,draw:l,elements:a,buffer:o,shader:f,attributes:d.state,vao:d,uniforms:c,framebuffer:u,extensions:r,timer:p,isBufferArgs:Hi},R={primTypes:fe,compareFuncs:Bi,blendFuncs:zi,blendEquations:y,stencilOps:ji,glTypes:$,orientationType:Wi};N.optional((function(){I.isArrayLike=De})),b&&(R.backBuffer=[Si],R.drawBuffer=z(i.maxDrawbuffers,(function(e){return 0===e?[0]:z(e,(function(e){return Pi+e}))})));var k=0;function O(){var e=function(){var e=0,n=[],r=[];function i(){var n=[],r=[];return t((function(){n.push.apply(n,jn(arguments))}),{def:function(){var t="v"+e++;return r.push(t),arguments.length>0&&(n.push(t,"="),n.push.apply(n,jn(arguments)),n.push(";")),t},toString:function(){return Vn([r.length>0?"var "+r.join(",")+";":"",Vn(n)])}})}function o(){var e=i(),n=i(),r=e.toString,o=n.toString;function a(t,r){n(t,r,"=",e.def(t,r),";")}return t((function(){e.apply(e,jn(arguments))}),{def:e.def,entry:e,exit:n,save:a,set:function(t,n,r){a(t,n),e(t,n,"=",r,";")},toString:function(){return r()+o()}})}var a=i(),s={};return{global:a,link:function(t){for(var i=0;i<r.length;++i)if(r[i]===t)return n[i];var o="g"+e++;return n.push(o),r.push(t),o},block:i,proc:function(e,n){var r=[];function i(){var e="a"+r.length;return r.push(e),e}n=n||0;for(var a=0;a<n;++a)i();var u=o(),c=u.toString;return s[e]=t(u,{arg:i,toString:function(){return Vn(["function(",r.join(),"){",c(),"}"])}})},scope:o,cond:function(){var e=Vn(arguments),n=o(),r=o(),i=n.toString,a=r.toString;return t(n,{then:function(){return n.apply(n,jn(arguments)),this},else:function(){return r.apply(r,jn(arguments)),this},toString:function(){var t=a();return t&&(t="else{"+t+"}"),Vn(["if(",e,"){",i(),"}",t])}})},compile:function(){var e=['"use strict";',a,"return {"];Object.keys(s).forEach((function(t){e.push('"',t,'":',s[t].toString(),",")})),e.push("}");var t=Vn(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,n.concat(t)).apply(null,r)}}}(),r=e.link,i=e.global;e.id=k++,e.batchId="0";var o=r(I),a=e.shared={props:"a0"};Object.keys(I).forEach((function(e){a[e]=i.def(o,".",e)})),N.optional((function(){e.CHECK=r(N),e.commandStr=N.guessCommand(),e.command=r(e.commandStr),e.assert=function(e,t,n){e("if(!(",t,"))",this.CHECK,".commandRaise(",r(n),",",this.command,");")},R.invalidBlendCombinations=Fi}));var s=e.next={},u=e.current={};Object.keys(A).forEach((function(e){Array.isArray(E[e])&&(s[e]=i.def(a.next,".",e),u[e]=i.def(a.current,".",e))}));var c=e.constants={};Object.keys(R).forEach((function(e){c[e]=i.def(JSON.stringify(R[e]))})),e.invoke=function(t,n){switch(n.type){case Kn:var i=["this",a.context,a.props,e.batchId];return t.def(r(n.data),".call(",i.slice(0,Math.max(n.data.length+1,4)),")");case qn:return t.def(a.props,n.data);case Zn:return t.def(a.context,n.data);case Qn:return t.def("this",n.data);case Jn:return n.data.append(e,t),n.data.ref;case $n:return n.data.toString();case er:return n.data.map((function(n){return e.invoke(t,n)}))}},e.attribCache={};var f={};return e.scopeAttrib=function(e){var t=n.id(e);if(t in f)return f[t];var i=d.scope[t];return i||(i=d.scope[t]=new m),f[t]=r(i)},e}function L(e,t,s,c,l){var h=e.static,p=e.dynamic;N.optional((function(){var e=[Ir,Rr,kr,Or,Cr,Gr,Lr,Mr,Dr,Ur].concat(w);function t(t){Object.keys(t).forEach((function(t){N.command(e.indexOf(t)>=0,'unknown parameter "'+t+'"',l.commandStr)}))}t(h),t(p)}));var g=function(e,t){var n=e.static;if("string"==typeof n[kr]&&"string"==typeof n[Rr]){if(Object.keys(t.dynamic).length>0)return null;var r=t.static,i=Object.keys(r);if(i.length>0&&"number"==typeof r[i[0]]){for(var o=[],a=0;a<i.length;++a)N("number"==typeof r[i[a]],"must specify all vertex attribute locations when using vaos"),o.push([0|r[i[a]],i[a]]);return o}}return null}(e,t),b=function(e,t){var n=e.static,r=e.dynamic;if(Ir in n){var i=n[Ir];return i?(i=u.getFramebuffer(i),N.command(i,"invalid framebuffer object"),qi((function(e,t){var n=e.link(i),r=e.shared;t.set(r.framebuffer,".next",n);var o=r.context;return t.set(o,"."+Fr,n+".width"),t.set(o,"."+Br,n+".height"),n}))):qi((function(e,t){var n=e.shared;t.set(n.framebuffer,".next","null");var r=n.context;return t.set(r,"."+Fr,r+"."+Hr),t.set(r,"."+Br,r+"."+Xr),"null"}))}if(Ir in r){var o=r[Ir];return Zi(o,(function(e,t){var n=e.invoke(t,o),r=e.shared,i=r.framebuffer,a=t.def(i,".getFramebuffer(",n,")");N.optional((function(){e.assert(t,"!"+n+"||"+a,"invalid framebuffer object")})),t.set(i,".next",a);var s=r.context;return t.set(s,"."+Fr,a+"?"+a+".width:"+s+"."+Hr),t.set(s,"."+Br,a+"?"+a+".height:"+s+"."+Xr),a}))}return null}(e),E=function(e,t,n){var r=e.static,i=e.dynamic;function o(e){if(e in r){var o=r[e];N.commandType(o,"object","invalid "+e,n.commandStr);var a,s,u=!0,c=0|o.x,d=0|o.y;return"width"in o?(a=0|o.width,N.command(a>=0,"invalid "+e,n.commandStr)):u=!1,"height"in o?(s=0|o.height,N.command(s>=0,"invalid "+e,n.commandStr)):u=!1,new Yi(!u&&t&&t.thisDep,!u&&t&&t.contextDep,!u&&t&&t.propDep,(function(e,t){var n=e.shared.context,r=a;"width"in o||(r=t.def(n,".",Fr,"-",c));var i=s;return"height"in o||(i=t.def(n,".",Br,"-",d)),[c,d,r,i]}))}if(e in i){var f=i[e],l=Zi(f,(function(t,n){var r=t.invoke(n,f);N.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)}));var i=t.shared.context,o=n.def(r,".x|0"),a=n.def(r,".y|0"),s=n.def('"width" in ',r,"?",r,".width|0:","(",i,".",Fr,"-",o,")"),u=n.def('"height" in ',r,"?",r,".height|0:","(",i,".",Br,"-",a,")");return N.optional((function(){t.assert(n,s+">=0&&"+u+">=0","invalid "+e)})),[o,a,s,u]}));return t&&(l.thisDep=l.thisDep||t.thisDep,l.contextDep=l.contextDep||t.contextDep,l.propDep=l.propDep||t.propDep),l}return t?new Yi(t.thisDep,t.contextDep,t.propDep,(function(e,t){var n=e.shared.context;return[0,0,t.def(n,".",Fr),t.def(n,".",Br)]})):null}var a=o(Nr);if(a){var s=a;a=new Yi(a.thisDep,a.contextDep,a.propDep,(function(e,t){var n=s.append(e,t),r=e.shared.context;return t.set(r,"."+jr,n[2]),t.set(r,"."+Vr,n[3]),n}))}return{viewport:a,scissor_box:o(Sr)}}(e,b,l),_=function(e,t){var n=e.static,r=e.dynamic,i=function(){if(Or in n){var e=n[Or];Hi(e)?e=a.getElements(a.create(e,!0)):e&&(e=a.getElements(e),N.command(e,"invalid elements",t.commandStr));var i=qi((function(t,n){if(e){var r=t.link(e);return t.ELEMENTS=r,r}return t.ELEMENTS=null,null}));return i.value=e,i}if(Or in r){var o=r[Or];return Zi(o,(function(e,t){var n=e.shared,r=n.isBufferArgs,i=n.elements,a=e.invoke(t,o),s=t.def("null"),u=t.def(r,"(",a,")"),c=e.cond(u).then(s,"=",i,".createStream(",a,");").else(s,"=",i,".getElements(",a,");");return N.optional((function(){e.assert(c.else,"!"+a+"||"+s,"invalid elements")})),t.entry(c),t.exit(e.cond(u).then(i,".destroyStream(",s,");")),e.ELEMENTS=s,s}))}return null}();function o(e,o){if(e in n){var a=0|n[e];return N.command(!o||a>=0,"invalid "+e,t.commandStr),qi((function(e,t){return o&&(e.OFFSET=a),a}))}if(e in r){var s=r[e];return Zi(s,(function(t,n){var r=t.invoke(n,s);return o&&(t.OFFSET=r,N.optional((function(){t.assert(n,r+">=0","invalid "+e)}))),r}))}return o&&i?qi((function(e,t){return e.OFFSET="0",0})):null}var s=o(Gr,!0);return{elements:i,primitive:function(){if(Cr in n){var e=n[Cr];return N.commandParameter(e,fe,"invalid primitve",t.commandStr),qi((function(t,n){return fe[e]}))}if(Cr in r){var o=r[Cr];return Zi(o,(function(e,t){var n=e.constants.primTypes,r=e.invoke(t,o);return N.optional((function(){e.assert(t,r+" in "+n,"invalid primitive, must be one of "+Object.keys(fe))})),t.def(n,"[",r,"]")}))}return i?Ki(i)?i.value?qi((function(e,t){return t.def(e.ELEMENTS,".primType")})):qi((function(){return Ai})):new Yi(i.thisDep,i.contextDep,i.propDep,(function(e,t){var n=e.ELEMENTS;return t.def(n,"?",n,".primType:",Ai)})):null}(),count:function(){if(Lr in n){var e=0|n[Lr];return N.command("number"==typeof e&&e>=0,"invalid vertex count",t.commandStr),qi((function(){return e}))}if(Lr in r){var o=r[Lr];return Zi(o,(function(e,t){var n=e.invoke(t,o);return N.optional((function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">=0&&"+n+"===("+n+"|0)","invalid vertex count")})),n}))}if(i){if(Ki(i)){if(i)return s?new Yi(s.thisDep,s.contextDep,s.propDep,(function(e,t){var n=t.def(e.ELEMENTS,".vertCount-",e.OFFSET);return N.optional((function(){e.assert(t,n+">=0","invalid vertex offset/element buffer too small")})),n})):qi((function(e,t){return t.def(e.ELEMENTS,".vertCount")}));var a=qi((function(){return-1}));return N.optional((function(){a.MISSING=!0})),a}var u=new Yi(i.thisDep||s.thisDep,i.contextDep||s.contextDep,i.propDep||s.propDep,(function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")}));return N.optional((function(){u.DYNAMIC=!0})),u}return null}(),instances:o(Mr,!1),offset:s}}(e,l),x=function(e,t){var n=e.static,r=e.dynamic,o={};return w.forEach((function(e){var a=T(e);function s(t,i){if(e in n){var s=t(n[e]);o[a]=qi((function(){return s}))}else if(e in r){var u=r[e];o[a]=Zi(u,(function(e,t){return i(e,t,e.invoke(t,u))}))}}switch(e){case fr:case nr:case tr:case Er:case ar:case Tr:case gr:case yr:case vr:case cr:return s((function(n){return N.commandType(n,"boolean",e,t.commandStr),n}),(function(t,n,r){return N.optional((function(){t.assert(n,"typeof "+r+'==="boolean"',"invalid flag "+e,t.commandStr)})),r}));case sr:return s((function(n){return N.commandParameter(n,Bi,"invalid "+e,t.commandStr),Bi[n]}),(function(t,n,r){var i=t.constants.compareFuncs;return N.optional((function(){t.assert(n,r+" in "+i,"invalid "+e+", must be one of "+Object.keys(Bi))})),n.def(i,"[",r,"]")}));case ur:return s((function(e){return N.command(De(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&e[0]<=e[1],"depth range is 2d array",t.commandStr),e}),(function(e,t,n){return N.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")})),[t.def("+",n,"[0]"),t.def("+",n,"[1]")]}));case or:return s((function(e){N.commandType(e,"object","blend.func",t.commandStr);var n="srcRGB"in e?e.srcRGB:e.src,r="srcAlpha"in e?e.srcAlpha:e.src,i="dstRGB"in e?e.dstRGB:e.dst,o="dstAlpha"in e?e.dstAlpha:e.dst;return N.commandParameter(n,zi,a+".srcRGB",t.commandStr),N.commandParameter(r,zi,a+".srcAlpha",t.commandStr),N.commandParameter(i,zi,a+".dstRGB",t.commandStr),N.commandParameter(o,zi,a+".dstAlpha",t.commandStr),N.command(-1===Fi.indexOf(n+", "+i),"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+i+")",t.commandStr),[zi[n],zi[i],zi[r],zi[o]]}),(function(t,n,r){var i=t.constants.blendFuncs;function o(o,a){var s=n.def('"',o,a,'" in ',r,"?",r,".",o,a,":",r,".",o);return N.optional((function(){t.assert(n,s+" in "+i,"invalid "+e+"."+o+a+", must be one of "+Object.keys(zi))})),s}N.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid blend func, must be an object")}));var a=o("src","RGB"),s=o("dst","RGB");N.optional((function(){var e=t.constants.invalidBlendCombinations;t.assert(n,e+".indexOf("+a+'+", "+'+s+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")}));var u=n.def(i,"[",a,"]"),c=n.def(i,"[",o("src","Alpha"),"]");return[u,n.def(i,"[",s,"]"),c,n.def(i,"[",o("dst","Alpha"),"]")]}));case ir:return s((function(n){return"string"==typeof n?(N.commandParameter(n,y,"invalid "+e,t.commandStr),[y[n],y[n]]):"object"==typeof n?(N.commandParameter(n.rgb,y,e+".rgb",t.commandStr),N.commandParameter(n.alpha,y,e+".alpha",t.commandStr),[y[n.rgb],y[n.alpha]]):void N.commandRaise("invalid blend.equation",t.commandStr)}),(function(t,n,r){var i=t.constants.blendEquations,o=n.def(),a=n.def(),s=t.cond("typeof ",r,'==="string"');return N.optional((function(){function n(e,n,r){t.assert(e,r+" in "+i,"invalid "+n+", must be one of "+Object.keys(y))}n(s.then,e,r),t.assert(s.else,r+"&&typeof "+r+'==="object"',"invalid "+e),n(s.else,e+".rgb",r+".rgb"),n(s.else,e+".alpha",r+".alpha")})),s.then(o,"=",a,"=",i,"[",r,"];"),s.else(o,"=",i,"[",r,".rgb];",a,"=",i,"[",r,".alpha];"),n(s),[o,a]}));case rr:return s((function(e){return N.command(De(e)&&4===e.length,"blend.color must be a 4d array",t.commandStr),z(4,(function(t){return+e[t]}))}),(function(e,t,n){return N.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")})),z(4,(function(e){return t.def("+",n,"[",e,"]")}))}));case _r:return s((function(e){return N.commandType(e,"number",a,t.commandStr),0|e}),(function(e,t,n){return N.optional((function(){e.assert(t,"typeof "+n+'==="number"',"invalid stencil.mask")})),t.def(n,"|0")}));case wr:return s((function(n){N.commandType(n,"object",a,t.commandStr);var r=n.cmp||"keep",i=n.ref||0,o="mask"in n?n.mask:-1;return N.commandParameter(r,Bi,e+".cmp",t.commandStr),N.commandType(i,"number",e+".ref",t.commandStr),N.commandType(o,"number",e+".mask",t.commandStr),[Bi[r],i,o]}),(function(e,t,n){var r=e.constants.compareFuncs;return N.optional((function(){function i(){e.assert(t,Array.prototype.join.call(arguments,""),"invalid stencil.func")}i(n+"&&typeof ",n,'==="object"'),i('!("cmp" in ',n,")||(",n,".cmp in ",r,")")})),[t.def('"cmp" in ',n,"?",r,"[",n,".cmp]",":",Oi),t.def(n,".ref|0"),t.def('"mask" in ',n,"?",n,".mask|0:-1")]}));case xr:case Ar:return s((function(n){N.commandType(n,"object",a,t.commandStr);var r=n.fail||"keep",i=n.zfail||"keep",o=n.zpass||"keep";return N.commandParameter(r,ji,e+".fail",t.commandStr),N.commandParameter(i,ji,e+".zfail",t.commandStr),N.commandParameter(o,ji,e+".zpass",t.commandStr),[e===Ar?Si:Ti,ji[r],ji[i],ji[o]]}),(function(t,n,r){var i=t.constants.stencilOps;function o(o){return N.optional((function(){t.assert(n,'!("'+o+'" in '+r+")||("+r+"."+o+" in "+i+")","invalid "+e+"."+o+", must be one of "+Object.keys(ji))})),n.def('"',o,'" in ',r,"?",i,"[",r,".",o,"]:",Oi)}return N.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)})),[e===Ar?Si:Ti,o("fail"),o("zfail"),o("zpass")]}));case mr:return s((function(e){N.commandType(e,"object",a,t.commandStr);var n=0|e.factor,r=0|e.units;return N.commandType(n,"number",a+".factor",t.commandStr),N.commandType(r,"number",a+".units",t.commandStr),[n,r]}),(function(t,n,r){return N.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)})),[n.def(r,".factor|0"),n.def(r,".units|0")]}));case lr:return s((function(e){var n=0;return"front"===e?n=Ti:"back"===e&&(n=Si),N.command(!!n,a,t.commandStr),n}),(function(e,t,n){return N.optional((function(){e.assert(t,n+'==="front"||'+n+'==="back"',"invalid cull.face")})),t.def(n,'==="front"?',Ti,":",Si)}));case pr:return s((function(e){return N.command("number"==typeof e&&e>=i.lineWidthDims[0]&&e<=i.lineWidthDims[1],"invalid line width, must be a positive number between "+i.lineWidthDims[0]+" and "+i.lineWidthDims[1],t.commandStr),e}),(function(e,t,n){return N.optional((function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">="+i.lineWidthDims[0]+"&&"+n+"<="+i.lineWidthDims[1],"invalid line width")})),n}));case hr:return s((function(e){return N.commandParameter(e,Wi,a,t.commandStr),Wi[e]}),(function(e,t,n){return N.optional((function(){e.assert(t,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")})),t.def(n+'==="cw"?'+Ni+":"+Di)}));case dr:return s((function(e){return N.command(De(e)&&4===e.length,"color.mask must be length 4 array",t.commandStr),e.map((function(e){return!!e}))}),(function(e,t,n){return N.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")})),z(4,(function(e){return"!!"+n+"["+e+"]"}))}));case br:return s((function(e){N.command("object"==typeof e&&e,a,t.commandStr);var n="value"in e?e.value:1,r=!!e.invert;return N.command("number"==typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",t.commandStr),[n,r]}),(function(e,t,n){return N.optional((function(){e.assert(t,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")})),[t.def('"value" in ',n,"?+",n,".value:1"),t.def("!!",n,".invert")]}))}})),o}(e,l),A=function(e,t,r){var i=e.static,o=e.dynamic;function a(e){if(e in i){var t=n.id(i[e]);N.optional((function(){f.shader(Vi[e],t,N.guessCommand())}));var r=qi((function(){return t}));return r.id=t,r}if(e in o){var a=o[e];return Zi(a,(function(t,n){var r=t.invoke(n,a),i=n.def(t.shared.strings,".id(",r,")");return N.optional((function(){n(t.shared.shader,".shader(",Vi[e],",",i,",",t.command,");")})),i}))}return null}var s,u=a(kr),c=a(Rr),d=null;return Ki(u)&&Ki(c)?(d=f.program(c.id,u.id,null,r),s=qi((function(e,t){return e.link(d)}))):s=new Yi(u&&u.thisDep||c&&c.thisDep,u&&u.contextDep||c&&c.contextDep,u&&u.propDep||c&&c.propDep,(function(e,t){var n,r=e.shared.shader;n=u?u.append(e,t):t.def(r,".",kr);var i=r+".program("+(c?c.append(e,t):t.def(r,".",Rr))+","+n;return N.optional((function(){i+=","+e.command})),t.def(i+")")})),{frag:u,vert:c,progVar:s,program:d}}(e,0,g);function S(e){var t=E[e];t&&(x[e]=t)}S(Nr),S(T(Sr));var D=Object.keys(x).length>0,I={framebuffer:b,draw:_,shader:A,state:x,dirty:D,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(I.profile=function(e){var t,n=e.static,r=e.dynamic;if(Dr in n){var i=!!n[Dr];(t=qi((function(e,t){return i}))).enable=i}else if(Dr in r){var o=r[Dr];t=Zi(o,(function(e,t){return e.invoke(t,o)}))}return t}(e),I.uniforms=function(e,t){var n=e.static,r=e.dynamic,i={};return Object.keys(n).forEach((function(e){var r,o=n[e];if("number"==typeof o||"boolean"==typeof o)r=qi((function(){return o}));else if("function"==typeof o){var a=o._reglType;"texture2d"===a||"textureCube"===a?r=qi((function(e){return e.link(o)})):"framebuffer"===a||"framebufferCube"===a?(N.command(o.color.length>0,'missing color attachment for framebuffer sent to uniform "'+e+'"',t.commandStr),r=qi((function(e){return e.link(o.color[0])}))):N.commandRaise('invalid data for uniform "'+e+'"',t.commandStr)}else De(o)?r=qi((function(t){return t.global.def("[",z(o.length,(function(n){return N.command("number"==typeof o[n]||"boolean"==typeof o[n],"invalid uniform "+e,t.commandStr),o[n]})),"]")})):N.commandRaise('invalid or missing data for uniform "'+e+'"',t.commandStr);r.value=o,i[e]=r})),Object.keys(r).forEach((function(e){var t=r[e];i[e]=Zi(t,(function(e,n){return e.invoke(n,t)}))})),i}(s,l),I.drawVAO=I.scopeVAO=function(e,t){var n=e.static,r=e.dynamic;if(Ur in n){var i=n[Ur];return null!==i&&null===d.getVAO(i)&&(i=d.createVAO(i)),qi((function(e){return e.link(d.getVAO(i))}))}if(Ur in r){var o=r[Ur];return Zi(o,(function(e,t){var n=e.invoke(t,o);return t.def(e.shared.vao+".getVAO("+n+")")}))}return null}(e),!I.drawVAO&&A.program&&!g&&r.angle_instanced_arrays){var R=!0,k=A.program.attributes.map((function(e){var n=t.static[e];return R=R&&!!n,n}));if(R&&k.length>0){var O=d.getVAO(d.createVAO(k));I.drawVAO=new Yi(null,null,null,(function(e,t){return e.link(O)})),I.useVAO=!0}}return g?I.useVAO=!0:I.attributes=function(e,t){var r=e.static,i=e.dynamic,a={};return Object.keys(r).forEach((function(e){var i=r[e],s=n.id(e),u=new m;if(Hi(i))u.state=Xn,u.buffer=o.getBuffer(o.create(i,Kr,!1,!0)),u.type=0;else{var c=o.getBuffer(i);if(c)u.state=Xn,u.buffer=c,u.type=0;else if(N.command("object"==typeof i&&i,"invalid data for attribute "+e,t.commandStr),"constant"in i){var d=i.constant;u.buffer="null",u.state=Yn,"number"==typeof d?u.x=d:(N.command(De(d)&&d.length>0&&d.length<=4,"invalid constant for attribute "+e,t.commandStr),Wn.forEach((function(e,t){t<d.length&&(u[e]=d[t])})))}else{c=Hi(i.buffer)?o.getBuffer(o.create(i.buffer,Kr,!1,!0)):o.getBuffer(i.buffer),N.command(!!c,'missing buffer for attribute "'+e+'"',t.commandStr);var f=0|i.offset;N.command(f>=0,'invalid offset for attribute "'+e+'"',t.commandStr);var l=0|i.stride;N.command(l>=0&&l<256,'invalid stride for attribute "'+e+'", must be integer betweeen [0, 255]',t.commandStr);var h=0|i.size;N.command(!("size"in i)||h>0&&h<=4,'invalid size for attribute "'+e+'", must be 1,2,3,4',t.commandStr);var p=!!i.normalized,g=0;"type"in i&&(N.commandParameter(i.type,$,"invalid type for attribute "+e,t.commandStr),g=$[i.type]);var y=0|i.divisor;"divisor"in i&&(N.command(0===y||v,'cannot specify divisor for attribute "'+e+'", instancing not supported',t.commandStr),N.command(y>=0,'invalid divisor for attribute "'+e+'"',t.commandStr)),N.optional((function(){var n=t.commandStr,r=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(i).forEach((function(t){N.command(r.indexOf(t)>=0,'unknown parameter "'+t+'" for attribute pointer "'+e+'" (valid parameters are '+r+")",n)}))})),u.buffer=c,u.state=Xn,u.size=h,u.normalized=p,u.type=g||c.dtype,u.offset=f,u.stride=l,u.divisor=y}}a[e]=qi((function(e,t){var n=e.attribCache;if(s in n)return n[s];var r={isStream:!1};return Object.keys(u).forEach((function(e){r[e]=u[e]})),u.buffer&&(r.buffer=e.link(u.buffer),r.type=r.type||r.buffer+".dtype"),n[s]=r,r}))})),Object.keys(i).forEach((function(e){var t=i[e];a[e]=Zi(t,(function(n,r){var i=n.invoke(r,t),o=n.shared,a=n.constants,s=o.isBufferArgs,u=o.buffer;N.optional((function(){n.assert(r,i+"&&(typeof "+i+'==="object"||typeof '+i+'==="function")&&('+s+"("+i+")||"+u+".getBuffer("+i+")||"+u+".getBuffer("+i+".buffer)||"+s+"("+i+'.buffer)||("constant" in '+i+"&&(typeof "+i+'.constant==="number"||'+o.isArrayLike+"("+i+".constant))))",'invalid dynamic attribute "'+e+'"')}));var c={isStream:r.def(!1)},d=new m;d.state=Xn,Object.keys(d).forEach((function(e){c[e]=r.def(""+d[e])}));var f=c.buffer,l=c.type;function h(e){r(c[e],"=",i,".",e,"|0;")}return r("if(",s,"(",i,")){",c.isStream,"=true;",f,"=",u,".createStream(",Kr,",",i,");",l,"=",f,".dtype;","}else{",f,"=",u,".getBuffer(",i,");","if(",f,"){",l,"=",f,".dtype;",'}else if("constant" in ',i,"){",c.state,"=",Yn,";","if(typeof "+i+'.constant === "number"){',c[Wn[0]],"=",i,".constant;",Wn.slice(1).map((function(e){return c[e]})).join("="),"=0;","}else{",Wn.map((function(e,t){return c[e]+"="+i+".constant.length>"+t+"?"+i+".constant["+t+"]:0;"})).join(""),"}}else{","if(",s,"(",i,".buffer)){",f,"=",u,".createStream(",Kr,",",i,".buffer);","}else{",f,"=",u,".getBuffer(",i,".buffer);","}",l,'="type" in ',i,"?",a.glTypes,"[",i,".type]:",f,".dtype;",c.normalized,"=!!",i,".normalized;"),h("size"),h("offset"),h("stride"),h("divisor"),r("}}"),r.exit("if(",c.isStream,"){",u,".destroyStream(",f,");","}"),c}))})),a}(t,l),I.context=function(e){var t=e.static,n=e.dynamic,r={};return Object.keys(t).forEach((function(e){var n=t[e];r[e]=qi((function(e,t){return"number"==typeof n||"boolean"==typeof n?""+n:e.link(n)}))})),Object.keys(n).forEach((function(e){var t=n[e];r[e]=Zi(t,(function(e,n){return e.invoke(n,t)}))})),r}(c),I}function G(e,t,n){var r=e.shared.context,i=e.scope();Object.keys(n).forEach((function(o){t.save(r,"."+o);var a=n[o].append(e,t);Array.isArray(a)?i(r,".",o,"=[",a.join(),"];"):i(r,".",o,"=",a,";")})),t(i)}function M(e,t,n,r){var i,o=e.shared,a=o.gl,s=o.framebuffer;b&&(i=t.def(o.extensions,".webgl_draw_buffers"));var u,c=e.constants,d=c.drawBuffer,f=c.backBuffer;u=n?n.append(e,t):t.def(s,".next"),r||t("if(",u,"!==",s,".cur){"),t("if(",u,"){",a,".bindFramebuffer(",Ui,",",u,".framebuffer);"),b&&t(i,".drawBuffersWEBGL(",d,"[",u,".colorAttachments.length]);"),t("}else{",a,".bindFramebuffer(",Ui,",null);"),b&&t(i,".drawBuffersWEBGL(",f,");"),t("}",s,".cur=",u,";"),r||t("}")}function U(e,t,n){var r=e.shared,i=r.gl,o=e.current,a=e.next,s=r.current,u=r.next,c=e.cond(s,".dirty");w.forEach((function(t){var r,d,f=T(t);if(!(f in n.state))if(f in a){r=a[f],d=o[f];var l=z(E[f].length,(function(e){return c.def(r,"[",e,"]")}));c(e.cond(l.map((function(e,t){return e+"!=="+d+"["+t+"]"})).join("||")).then(i,".",A[f],"(",l,");",l.map((function(e,t){return d+"["+t+"]="+e})).join(";"),";"))}else{r=c.def(u,".",f);var h=e.cond(r,"!==",s,".",f);c(h),f in x?h(e.cond(r).then(i,".enable(",x[f],");").else(i,".disable(",x[f],");"),s,".",f,"=",r,";"):h(i,".",A[f],"(",r,");",s,".",f,"=",r,";")}})),0===Object.keys(n.state).length&&c(s,".dirty=false;"),t(c)}function P(e,t,n,r){var i=e.shared,o=e.current,a=i.current,s=i.gl;Xi(Object.keys(n)).forEach((function(i){var u=n[i];if(!r||r(u)){var c=u.append(e,t);if(x[i]){var d=x[i];Ki(u)?t(s,c?".enable(":".disable(",d,");"):t(e.cond(c).then(s,".enable(",d,");").else(s,".disable(",d,");")),t(a,".",i,"=",c,";")}else if(De(c)){var f=o[i];t(s,".",A[i],"(",c,");",c.map((function(e,t){return f+"["+t+"]="+e})).join(";"),";")}else t(s,".",A[i],"(",c,");",a,".",i,"=",c,";")}}))}function F(e,t){v&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function B(e,t,n,r,i){var o,a,s,u=e.shared,c=e.stats,d=u.current,f=u.timer,l=n.profile;function h(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function g(e){e(o=t.def(),"=",h(),";"),"string"==typeof i?e(c,".count+=",i,";"):e(c,".count++;"),p&&(r?e(a=t.def(),"=",f,".getNumPendingQueries();"):e(f,".beginQuery(",c,");"))}function m(e){e(c,".cpuTime+=",h(),"-",o,";"),p&&(r?e(f,".pushScopeStats(",a,",",f,".getNumPendingQueries(),",c,");"):e(f,".endQuery();"))}function y(e){var n=t.def(d,".profile");t(d,".profile=",e,";"),t.exit(d,".profile=",n,";")}if(l){if(Ki(l))return void(l.enable?(g(t),m(t.exit),y("true")):y("false"));y(s=l.append(e,t))}else s=t.def(d,".profile");var v=e.block();g(v),t("if(",s,"){",v,"}");var b=e.block();m(b),t.exit("if(",s,"){",b,"}")}function j(e,t,n,r,i){var o=e.shared;r.forEach((function(r){var a,s=r.name,u=n.attributes[s];if(u){if(!i(u))return;a=u.append(e,t)}else{if(!i(Qi))return;var c=e.scopeAttrib(s);N.optional((function(){e.assert(t,c+".state","missing attribute "+s)})),a={},Object.keys(new m).forEach((function(e){a[e]=t.def(c,".",e)}))}!function(n,r,i){var a=o.gl,s=t.def(n,".location"),u=t.def(o.attributes,"[",s,"]"),c=i.state,d=i.buffer,f=[i.x,i.y,i.z,i.w],l=["buffer","normalized","offset","stride"];function h(){t("if(!",u,".buffer){",a,".enableVertexAttribArray(",s,");}");var n,o=i.type;if(n=i.size?t.def(i.size,"||",r):r,t("if(",u,".type!==",o,"||",u,".size!==",n,"||",l.map((function(e){return u+"."+e+"!=="+i[e]})).join("||"),"){",a,".bindBuffer(",Kr,",",d,".buffer);",a,".vertexAttribPointer(",[s,n,o,i.normalized,i.stride,i.offset],");",u,".type=",o,";",u,".size=",n,";",l.map((function(e){return u+"."+e+"="+i[e]+";"})).join(""),"}"),v){var c=i.divisor;t("if(",u,".divisor!==",c,"){",e.instancing,".vertexAttribDivisorANGLE(",[s,c],");",u,".divisor=",c,";}")}}function p(){t("if(",u,".buffer){",a,".disableVertexAttribArray(",s,");",u,".buffer=null;","}if(",Wn.map((function(e,t){return u+"."+e+"!=="+f[t]})).join("||"),"){",a,".vertexAttrib4f(",s,",",f,");",Wn.map((function(e,t){return u+"."+e+"="+f[t]+";"})).join(""),"}")}c===Xn?h():c===Yn?p():(t("if(",c,"===",Xn,"){"),h(),t("}else{"),p(),t("}"))}(e.link(r),function(e){switch(e){case ui:case li:case mi:return 2;case ci:case hi:case yi:return 3;case di:case pi:case vi:return 4;default:return 1}}(r.info.type),a)}))}function V(e,t,r,i,o){for(var a,s=e.shared,u=s.gl,c=0;c<i.length;++c){var d,f=i[c],l=f.name,h=f.info.type,p=r.uniforms[l],g=e.link(f)+".location";if(p){if(!o(p))continue;if(Ki(p)){var m=p.value;if(N.command(null!=m,'missing uniform "'+l+'"',e.commandStr),h===wi||h===xi){N.command("function"==typeof m&&(h===wi&&("texture2d"===m._reglType||"framebuffer"===m._reglType)||h===xi&&("textureCube"===m._reglType||"framebufferCube"===m._reglType)),"invalid texture for uniform "+l,e.commandStr);var y=e.link(m._texture||m.color[0]._texture);t(u,".uniform1i(",g,",",y+".bind());"),t.exit(y,".unbind();")}else if(h===bi||h===Ei||h===_i){N.optional((function(){N.command(De(m),"invalid matrix for uniform "+l,e.commandStr),N.command(h===bi&&4===m.length||h===Ei&&9===m.length||h===_i&&16===m.length,"invalid length for matrix uniform "+l,e.commandStr)}));var v=e.global.def("new Float32Array(["+Array.prototype.slice.call(m)+"])"),b=2;h===Ei?b=3:h===_i&&(b=4),t(u,".uniformMatrix",b,"fv(",g,",false,",v,");")}else{switch(h){case si:N.commandType(m,"number","uniform "+l,e.commandStr),a="1f";break;case ui:N.command(De(m)&&2===m.length,"uniform "+l,e.commandStr),a="2f";break;case ci:N.command(De(m)&&3===m.length,"uniform "+l,e.commandStr),a="3f";break;case di:N.command(De(m)&&4===m.length,"uniform "+l,e.commandStr),a="4f";break;case gi:N.commandType(m,"boolean","uniform "+l,e.commandStr),a="1i";break;case fi:N.commandType(m,"number","uniform "+l,e.commandStr),a="1i";break;case mi:case li:N.command(De(m)&&2===m.length,"uniform "+l,e.commandStr),a="2i";break;case yi:case hi:N.command(De(m)&&3===m.length,"uniform "+l,e.commandStr),a="3i";break;case vi:case pi:N.command(De(m)&&4===m.length,"uniform "+l,e.commandStr),a="4i"}t(u,".uniform",a,"(",g,",",De(m)?Array.prototype.slice.call(m):m,");")}continue}d=p.append(e,t)}else{if(!o(Qi))continue;d=t.def(s.uniforms,"[",n.id(l),"]")}h===wi?(N(!Array.isArray(d),"must specify a scalar prop for textures"),t("if(",d,"&&",d,'._reglType==="framebuffer"){',d,"=",d,".color[0];","}")):h===xi&&(N(!Array.isArray(d),"must specify a scalar prop for cube maps"),t("if(",d,"&&",d,'._reglType==="framebufferCube"){',d,"=",d,".color[0];","}")),N.optional((function(){function n(n,r){e.assert(t,n,'bad data or missing for uniform "'+l+'".  '+r)}function r(e){N(!Array.isArray(d),"must not specify an array type for uniform"),n("typeof "+d+'==="'+e+'"',"invalid type, expected "+e)}function i(t,r){Array.isArray(d)?N(d.length===t,"must have length "+t):n(s.isArrayLike+"("+d+")&&"+d+".length==="+t,"invalid vector, should have length "+t,e.commandStr)}function o(t){N(!Array.isArray(d),"must not specify a value type"),n("typeof "+d+'==="function"&&'+d+'._reglType==="texture'+(t===Zr?"2d":"Cube")+'"',"invalid texture type",e.commandStr)}switch(h){case fi:r("number");break;case li:i(2);break;case hi:i(3);break;case pi:i(4);break;case si:r("number");break;case ui:i(2);break;case ci:i(3);break;case di:i(4);break;case gi:r("boolean");break;case mi:i(2);break;case yi:i(3);break;case vi:case bi:i(4);break;case Ei:i(9);break;case _i:i(16);break;case wi:o(Zr);break;case xi:o(Qr)}}));var E=1;switch(h){case wi:case xi:var _=t.def(d,"._texture");t(u,".uniform1i(",g,",",_,".bind());"),t.exit(_,".unbind();");continue;case fi:case gi:a="1i";break;case li:case mi:a="2i",E=2;break;case hi:case yi:a="3i",E=3;break;case pi:case vi:a="4i",E=4;break;case si:a="1f";break;case ui:a="2f",E=2;break;case ci:a="3f",E=3;break;case di:a="4f",E=4;break;case bi:a="Matrix2fv";break;case Ei:a="Matrix3fv";break;case _i:a="Matrix4fv"}if(t(u,".uniform",a,"(",g,","),"M"===a.charAt(0)){var w=Math.pow(h-bi+2,2),x=e.global.def("new Float32Array(",w,")");Array.isArray(d)?t("false,(",z(w,(function(e){return x+"["+e+"]="+d[e]})),",",x,")"):t("false,(Array.isArray(",d,")||",d," instanceof Float32Array)?",d,":(",z(w,(function(e){return x+"["+e+"]="+d+"["+e+"]"})),",",x,")")}else E>1?t(z(E,(function(e){return Array.isArray(d)?d[e]:d+"["+e+"]"}))):(N(!Array.isArray(d),"uniform value must not be an array"),t(d));t(");")}}function W(e,t,n,r){var i=e.shared,o=i.gl,a=i.draw,s=r.draw;var u=function(){var i,u=s.elements,c=t;return u?((u.contextDep&&r.contextDynamic||u.propDep)&&(c=n),i=u.append(e,c)):i=c.def(a,".",Or),i&&c("if("+i+")"+o+".bindBuffer("+qr+","+i+".buffer.buffer);"),i}();function c(i){var o=s[i];return o?o.contextDep&&r.contextDynamic||o.propDep?o.append(e,n):o.append(e,t):t.def(a,".",i)}var d,f,l=c(Cr),h=c(Gr),p=function(){var i,o=s.count,u=t;return o?((o.contextDep&&r.contextDynamic||o.propDep)&&(u=n),i=o.append(e,u),N.optional((function(){o.MISSING&&e.assert(t,"false","missing vertex count"),o.DYNAMIC&&e.assert(u,i+">=0","missing vertex count")}))):(i=u.def(a,".",Lr),N.optional((function(){e.assert(u,i+">=0","missing vertex count")}))),i}();if("number"==typeof p){if(0===p)return}else n("if(",p,"){"),n.exit("}");v&&(d=c(Mr),f=e.instancing);var g=u+".type",m=s.elements&&Ki(s.elements);function y(){function e(){n(f,".drawElementsInstancedANGLE(",[l,p,g,h+"<<(("+g+"-"+Hn+")>>1)",d],");")}function t(){n(f,".drawArraysInstancedANGLE(",[l,h,p,d],");")}u?m?e():(n("if(",u,"){"),e(),n("}else{"),t(),n("}")):t()}function b(){function e(){n(o+".drawElements("+[l,p,g,h+"<<(("+g+"-"+Hn+")>>1)"]+");")}function t(){n(o+".drawArrays("+[l,h,p]+");")}u?m?e():(n("if(",u,"){"),e(),n("}else{"),t(),n("}")):t()}v&&("number"!=typeof d||d>=0)?"string"==typeof d?(n("if(",d,">0){"),y(),n("}else if(",d,"<0){"),b(),n("}")):y():b()}function H(e,t,n,r,i){var o=O(),a=o.proc("body",i);return N.optional((function(){o.commandStr=t.commandStr,o.command=o.link(t.commandStr)})),v&&(o.instancing=a.def(o.shared.extensions,".angle_instanced_arrays")),e(o,a,n,r),o.compile().body}function X(e,t,n,r){F(e,t),n.useVAO?n.drawVAO?t(e.shared.vao,".setVAO(",n.drawVAO.append(e,t),");"):t(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(t(e.shared.vao,".setVAO(null);"),j(e,t,n,r.attributes,(function(){return!0}))),V(e,t,n,r.uniforms,(function(){return!0})),W(e,t,t,n)}function Y(e,t,n,r){function i(){return!0}e.batchId="a1",F(e,t),j(e,t,n,r.attributes,i),V(e,t,n,r.uniforms,i),W(e,t,t,n)}function K(e,t,n,r){F(e,t);var i=n.contextDep,o=t.def(),a=t.def();e.shared.props=a,e.batchId=o;var s=e.scope(),u=e.scope();function c(e){return e.contextDep&&i||e.propDep}function d(e){return!c(e)}if(t(s.entry,"for(",o,"=0;",o,"<","a1",";++",o,"){",a,"=","a0","[",o,"];",u,"}",s.exit),n.needsContext&&G(e,u,n.context),n.needsFramebuffer&&M(e,u,n.framebuffer),P(e,u,n.state,c),n.profile&&c(n.profile)&&B(e,u,n,!1,!0),r)n.useVAO?n.drawVAO?c(n.drawVAO)?u(e.shared.vao,".setVAO(",n.drawVAO.append(e,u),");"):s(e.shared.vao,".setVAO(",n.drawVAO.append(e,s),");"):s(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(s(e.shared.vao,".setVAO(null);"),j(e,s,n,r.attributes,d),j(e,u,n,r.attributes,c)),V(e,s,n,r.uniforms,d),V(e,u,n,r.uniforms,c),W(e,s,u,n);else{var f=e.global.def("{}"),l=n.shader.progVar.append(e,u),h=u.def(l,".id"),p=u.def(f,"[",h,"]");u(e.shared.gl,".useProgram(",l,".program);","if(!",p,"){",p,"=",f,"[",h,"]=",e.link((function(t){return H(Y,e,n,t,2)})),"(",l,");}",p,".call(this,a0[",o,"],",o,");")}}function q(e,t,n){var r=t.static[n];if(r&&function(e){if("object"==typeof e&&!De(e)){for(var t=Object.keys(e),n=0;n<t.length;++n)if(C.isDynamic(e[t[n]]))return!0;return!1}}(r)){var i=e.global,o=Object.keys(r),a=!1,s=!1,u=!1,c=e.global.def("{}");o.forEach((function(t){var n=r[t];if(C.isDynamic(n)){"function"==typeof n&&(n=r[t]=C.unbox(n));var o=Zi(n,null);a=a||o.thisDep,u=u||o.propDep,s=s||o.contextDep}else{switch(i(c,".",t,"="),typeof n){case"number":i(n);break;case"string":i('"',n,'"');break;case"object":Array.isArray(n)&&i("[",n.join(),"]");break;default:i(e.link(n))}i(";")}})),t.dynamic[n]=new C.DynamicVariable(Jn,{thisDep:a,contextDep:s,propDep:u,ref:c,append:function(e,t){o.forEach((function(n){var i=r[n];if(C.isDynamic(i)){var o=e.invoke(t,i);t(c,".",n,"=",o,";")}}))}}),delete t.static[n]}}return{next:_,current:E,procs:function(){var e=O(),t=e.proc("poll"),n=e.proc("refresh"),o=e.block();t(o),n(o);var a,s=e.shared,u=s.gl,c=s.next,d=s.current;o(d,".dirty=false;"),M(e,t),M(e,n,null,!0),v&&(a=e.link(v)),r.oes_vertex_array_object&&n(e.link(r.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var f=0;f<i.maxAttributes;++f){var l=n.def(s.attributes,"[",f,"]"),h=e.cond(l,".buffer");h.then(u,".enableVertexAttribArray(",f,");",u,".bindBuffer(",Kr,",",l,".buffer.buffer);",u,".vertexAttribPointer(",f,",",l,".size,",l,".type,",l,".normalized,",l,".stride,",l,".offset);").else(u,".disableVertexAttribArray(",f,");",u,".vertexAttrib4f(",f,",",l,".x,",l,".y,",l,".z,",l,".w);",l,".buffer=null;"),n(h),v&&n(a,".vertexAttribDivisorANGLE(",f,",",l,".divisor);")}return n(e.shared.vao,".currentVAO=null;",e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"),Object.keys(x).forEach((function(r){var i=x[r],a=o.def(c,".",r),s=e.block();s("if(",a,"){",u,".enable(",i,")}else{",u,".disable(",i,")}",d,".",r,"=",a,";"),n(s),t("if(",a,"!==",d,".",r,"){",s,"}")})),Object.keys(A).forEach((function(r){var i,a,s=A[r],f=E[r],l=e.block();if(l(u,".",s,"("),De(f)){var h=f.length;i=e.global.def(c,".",r),a=e.global.def(d,".",r),l(z(h,(function(e){return i+"["+e+"]"})),");",z(h,(function(e){return a+"["+e+"]="+i+"["+e+"];"})).join("")),t("if(",z(h,(function(e){return i+"["+e+"]!=="+a+"["+e+"]"})).join("||"),"){",l,"}")}else i=o.def(c,".",r),a=o.def(d,".",r),l(i,");",d,".",r,"=",i,";"),t("if(",i,"!==",a,"){",l,"}");n(l)})),e.compile()}(),compile:function(e,r,i,o,a){var s=O();s.stats=s.link(a),Object.keys(r.static).forEach((function(e){q(s,r,e)})),Yr.forEach((function(t){q(s,e,t)}));var u=L(e,r,i,o,s);return function(e,t){var n=e.proc("draw",1);F(e,n),G(e,n,t.context),M(e,n,t.framebuffer),U(e,n,t),P(e,n,t.state),B(e,n,t,!1,!0);var r=t.shader.progVar.append(e,n);if(n(e.shared.gl,".useProgram(",r,".program);"),t.shader.program)X(e,n,t,t.shader.program);else{n(e.shared.vao,".setVAO(null);");var i=e.global.def("{}"),o=n.def(r,".id"),a=n.def(i,"[",o,"]");n(e.cond(a).then(a,".call(this,a0);").else(a,"=",i,"[",o,"]=",e.link((function(n){return H(X,e,t,n,1)})),"(",r,");",a,".call(this,a0);"))}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;")}(s,u),function(e,t){var r=e.proc("scope",3);e.batchId="a2";var i=e.shared,o=i.current;function a(n){var o=t.shader[n];o&&r.set(i.shader,"."+n,o.append(e,r))}G(e,r,t.context),t.framebuffer&&t.framebuffer.append(e,r),Xi(Object.keys(t.state)).forEach((function(n){var o=t.state[n].append(e,r);De(o)?o.forEach((function(t,i){r.set(e.next[n],"["+i+"]",t)})):r.set(i.next,"."+n,o)})),B(e,r,t,!0,!0),[Or,Gr,Lr,Mr,Cr].forEach((function(n){var o=t.draw[n];o&&r.set(i.draw,"."+n,""+o.append(e,r))})),Object.keys(t.uniforms).forEach((function(o){var a=t.uniforms[o].append(e,r);Array.isArray(a)&&(a="["+a.join()+"]"),r.set(i.uniforms,"["+n.id(o)+"]",a)})),Object.keys(t.attributes).forEach((function(n){var i=t.attributes[n].append(e,r),o=e.scopeAttrib(n);Object.keys(new m).forEach((function(e){r.set(o,"."+e,i[e])}))})),t.scopeVAO&&r.set(i.vao,".targetVAO",t.scopeVAO.append(e,r)),a(Rr),a(kr),Object.keys(t.state).length>0&&(r(o,".dirty=true;"),r.exit(o,".dirty=true;")),r("a1(",e.shared.context,",a0,",e.batchId,");")}(s,u),function(e,t){var n=e.proc("batch",2);e.batchId="0",F(e,n);var r=!1,i=!0;Object.keys(t.context).forEach((function(e){r=r||t.context[e].propDep})),r||(G(e,n,t.context),i=!1);var o=t.framebuffer,a=!1;function s(e){return e.contextDep&&r||e.propDep}o?(o.propDep?r=a=!0:o.contextDep&&r&&(a=!0),a||M(e,n,o)):M(e,n,null),t.state.viewport&&t.state.viewport.propDep&&(r=!0),U(e,n,t),P(e,n,t.state,(function(e){return!s(e)})),t.profile&&s(t.profile)||B(e,n,t,!1,"a1"),t.contextDep=r,t.needsContext=i,t.needsFramebuffer=a;var u=t.shader.progVar;if(u.contextDep&&r||u.propDep)K(e,n,t,null);else{var c=u.append(e,n);if(n(e.shared.gl,".useProgram(",c,".program);"),t.shader.program)K(e,n,t,t.shader.program);else{n(e.shared.vao,".setVAO(null);");var d=e.global.def("{}"),f=n.def(c,".id"),l=n.def(d,"[",f,"]");n(e.cond(l).then(l,".call(this,a0,a1);").else(l,"=",d,"[",f,"]=",e.link((function(n){return H(K,e,t,n,2)})),"(",c,");",l,".call(this,a0,a1);"))}}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;")}(s,u),t(s.compile(),{destroy:function(){u.shader.program.destroy()}})}}}var $i=function(e,t){if(!t.ext_disjoint_timer_query)return null;var n=[];function r(e){n.push(e)}var i=[];function o(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var a=[];function s(e){a.push(e)}var u=[];function c(e,t,n){var r=a.pop()||new o;r.startQueryIndex=e,r.endQueryIndex=t,r.sum=0,r.stats=n,u.push(r)}var d=[],f=[];return{beginQuery:function(e){var r=n.pop()||t.ext_disjoint_timer_query.createQueryEXT();t.ext_disjoint_timer_query.beginQueryEXT(35007,r),i.push(r),c(i.length-1,i.length,e)},endQuery:function(){t.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:c,update:function(){var e,n,o=i.length;if(0!==o){f.length=Math.max(f.length,o+1),d.length=Math.max(d.length,o+1),d[0]=0,f[0]=0;var a=0;for(e=0,n=0;n<i.length;++n){var c=i[n];t.ext_disjoint_timer_query.getQueryObjectEXT(c,34919)?(a+=t.ext_disjoint_timer_query.getQueryObjectEXT(c,34918),r(c)):i[e++]=c,d[n+1]=a,f[n+1]=e}for(i.length=e,e=0,n=0;n<u.length;++n){var l=u[n],h=l.startQueryIndex,p=l.endQueryIndex;l.sum+=d[p]-d[h];var g=f[h],m=f[p];m===g?(l.stats.gpuTime+=l.sum/1e6,s(l)):(l.startQueryIndex=g,l.endQueryIndex=m,u[e++]=l)}u.length=e}},getNumPendingQueries:function(){return i.length},clear:function(){n.push.apply(n,i);for(var e=0;e<n.length;e++)t.ext_disjoint_timer_query.deleteQueryEXT(n[e]);i.length=0,n.length=0},restore:function(){i.length=0,n.length=0}}},eo="webglcontextlost",to="webglcontextrestored";function no(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}return function(n){var r=P(n);if(!r)return null;var i=r.gl,o=i.getContextAttributes(),a=i.isContextLost(),s=function(e,t){var n={};function r(t){N.type(t,"string","extension name must be string");var r,i=t.toLowerCase();try{r=n[i]=e.getExtension(i)}catch(e){}return!!r}for(var i=0;i<t.extensions.length;++i){var o=t.extensions[i];if(!r(o))return t.onDestroy(),t.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(r),{extensions:n,restore:function(){Object.keys(n).forEach((function(e){if(n[e]&&!r(e))throw new Error("(regl): error restoring extension "+e)}))}}}(i,r);if(!s)return null;var u,c,d=(u={"":0},c=[""],{id:function(e){var t=u[e];return t||(t=u[e]=c.length,c.push(e),t)},str:function(e){return c[e]}}),f={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},l=s.extensions,h=$i(0,l),p=G(),g=i.drawingBufferWidth,m=i.drawingBufferHeight,y={tick:0,time:0,viewportWidth:g,viewportHeight:m,framebufferWidth:g,framebufferHeight:m,drawingBufferWidth:g,drawingBufferHeight:m,pixelRatio:r.pixelRatio},v=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(34047));var r=1,i=1;t.webgl_draw_buffers&&(r=e.getParameter(34852),i=e.getParameter(36063));var o=!!t.oes_texture_float;if(o){var a=e.createTexture();e.bindTexture(V,a),e.texImage2D(V,0,W,1,1,0,W,H,null);var s=e.createFramebuffer();if(e.bindFramebuffer(X,s),e.framebufferTexture2D(X,36064,V,a,0),e.bindTexture(V,null),36053!==e.checkFramebufferStatus(X))o=!1;else{e.viewport(0,0,1,1),e.clearColor(1,0,0,1),e.clear(16384);var u=j.allocType(H,4);e.readPixels(0,0,1,1,W,H,u),e.getError()?o=!1:(e.deleteFramebuffer(s),e.deleteTexture(a),o=1===u[0]),j.freeType(u)}}var c=!0;if("undefined"==typeof navigator||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var d=e.createTexture(),f=j.allocType(5121,36);e.activeTexture(33984),e.bindTexture(34067,d),e.texImage2D(34069,0,W,3,3,0,W,5121,f),j.freeType(f),e.bindTexture(34067,null),e.deleteTexture(d),c=!e.getError()}return{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(t).filter((function(e){return!!t[e]})),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938),readFloat:o,npotTextureCube:c}}(i,l),b=function(t,n,r,i){var o=0,a={};function s(e){this.id=o++,this.buffer=t.createBuffer(),this.type=e,this.usage=re,this.byteLength=0,this.dimension=1,this.dtype=oe,this.persistentData=null,r.profile&&(this.stats={size:0})}s.prototype.bind=function(){t.bindBuffer(this.type,this.buffer)},s.prototype.destroy=function(){f(this)};var u=[];function c(e,n,r){e.byteLength=n.byteLength,t.bufferData(e.type,n,r)}function d(t,n,r,i,o,a){var s,u;if(t.usage=r,Array.isArray(n)){if(t.dtype=i||ae,n.length>0)if(Array.isArray(n[0])){s=ne(n);for(var d=1,f=1;f<s.length;++f)d*=s[f];t.dimension=d,c(t,u=te(n,s,t.dtype),r),a?t.persistentData=u:j.freeType(u)}else if("number"==typeof n[0]){t.dimension=o;var l=j.allocType(t.dtype,n.length);ce(l,n),c(t,l,r),a?t.persistentData=l:j.freeType(l)}else e(n[0])?(t.dimension=n[0].length,t.dtype=i||ue(n[0])||ae,c(t,u=te(n,[n.length,n[0].length],t.dtype),r),a?t.persistentData=u:j.freeType(u)):N.raise("invalid buffer data")}else if(e(n))t.dtype=i||ue(n),t.dimension=o,c(t,n,r),a&&(t.persistentData=new Uint8Array(new Uint8Array(n.buffer)));else if(Y(n)){s=n.shape;var h=n.stride,p=n.offset,g=0,m=0,y=0,v=0;1===s.length?(g=s[0],m=1,y=h[0],v=0):2===s.length?(g=s[0],m=s[1],y=h[0],v=h[1]):N.raise("invalid shape"),t.dtype=i||ue(n.data)||ae,t.dimension=m;var b=j.allocType(t.dtype,g*m);de(b,n.data,g,m,y,v,p),c(t,b,r),a?t.persistentData=b:j.freeType(b)}else n instanceof ArrayBuffer?(t.dtype=oe,t.dimension=o,c(t,n,r),a&&(t.persistentData=new Uint8Array(new Uint8Array(n)))):N.raise("invalid buffer data")}function f(e){n.bufferCount--,i(e);var r=e.buffer;N(r,"buffer must not be deleted already"),t.deleteBuffer(r),e.buffer=null,delete a[e.id]}return r.profile&&(n.getTotalBufferSize=function(){var e=0;return Object.keys(a).forEach((function(t){e+=a[t].stats.size})),e}),{create:function(i,o,u,c){n.bufferCount++;var l=new s(o);function h(n){var i=re,o=null,a=0,s=0,u=1;return Array.isArray(n)||e(n)||Y(n)||n instanceof ArrayBuffer?o=n:"number"==typeof n?a=0|n:n&&(N.type(n,"object","buffer arguments must be an object, a number or an array"),"data"in n&&(N(null===o||Array.isArray(o)||e(o)||Y(o),"invalid data for buffer"),o=n.data),"usage"in n&&(N.parameter(n.usage,ee,"invalid buffer usage"),i=ee[n.usage]),"type"in n&&(N.parameter(n.type,$,"invalid buffer type"),s=$[n.type]),"dimension"in n&&(N.type(n.dimension,"number","invalid dimension"),u=0|n.dimension),"length"in n&&(N.nni(a,"buffer length must be a nonnegative integer"),a=0|n.length)),l.bind(),o?d(l,o,i,s,u,c):(a&&t.bufferData(l.type,a,i),l.dtype=s||oe,l.usage=i,l.dimension=u,l.byteLength=a),r.profile&&(l.stats.size=l.byteLength*se[l.dtype]),h}function p(e,n){N(n+e.byteLength<=l.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+e.byteLength+" starting from offset "+n+" to a buffer of size "+l.byteLength),t.bufferSubData(l.type,n,e)}return a[l.id]=l,u||h(i),h._reglType="buffer",h._buffer=l,h.subdata=function(t,n){var r,i=0|(n||0);if(l.bind(),e(t)||t instanceof ArrayBuffer)p(t,i);else if(Array.isArray(t)){if(t.length>0)if("number"==typeof t[0]){var o=j.allocType(l.dtype,t.length);ce(o,t),p(o,i),j.freeType(o)}else if(Array.isArray(t[0])||e(t[0])){r=ne(t);var a=te(t,r,l.dtype);p(a,i),j.freeType(a)}else N.raise("invalid buffer data")}else if(Y(t)){r=t.shape;var s=t.stride,u=0,c=0,d=0,f=0;1===r.length?(u=r[0],c=1,d=s[0],f=0):2===r.length?(u=r[0],c=r[1],d=s[0],f=s[1]):N.raise("invalid shape");var g=Array.isArray(t.data)?l.dtype:ue(t.data),m=j.allocType(g,u*c);de(m,t.data,u,c,d,f,t.offset),p(m,i),j.freeType(m)}else N.raise("invalid data for buffer subdata");return h},r.profile&&(h.stats=l.stats),h.destroy=function(){f(l)},h},createStream:function(e,t){var n=u.pop();return n||(n=new s(e)),n.bind(),d(n,t,ie,0,1,!1),n},destroyStream:function(e){u.push(e)},clear:function(){K(a).forEach(f),u.forEach(f)},getBuffer:function(e){return e&&e._buffer instanceof s?e._buffer:null},restore:function(){K(a).forEach((function(e){e.buffer=t.createBuffer(),t.bindBuffer(e.type,e.buffer),t.bufferData(e.type,e.persistentData||e.byteLength,e.usage)}))},_initBuffer:d}}(i,f,r,(function(e){return E.destroyBuffer(e)})),E=function(t,n,r,i,o){for(var a=r.maxAttributes,s=new Array(a),u=0;u<a;++u)s[u]=new On;var c=0,d={},f={Record:On,scope:{},state:s,currentVAO:null,targetVAO:null,restore:l()?function(){l()&&K(d).forEach((function(e){e.refresh()}))}:function(){},createVAO:function(t){var r=new p;function s(t){N(Array.isArray(t),"arguments to vertex array constructor must be an array"),N(t.length<a,"too many attributes"),N(t.length>0,"must specify at least one attribute");var i={},u=r.attributes;u.length=t.length;for(var c=0;c<t.length;++c){var d,f=t[c],l=u[c]=new On,h=f.data||f;Array.isArray(h)||e(h)||Y(h)?(r.buffers[c]&&(d=r.buffers[c],e(h)&&d._buffer.byteLength>=h.byteLength?d.subdata(h):(d.destroy(),r.buffers[c]=null)),r.buffers[c]||(d=r.buffers[c]=o.create(f,kn,!1,!0)),l.buffer=o.getBuffer(d),l.size=0|l.buffer.dimension,l.normalized=!1,l.type=l.buffer.dtype,l.offset=0,l.stride=0,l.divisor=0,l.state=1,i[c]=1):o.getBuffer(f)?(l.buffer=o.getBuffer(f),l.size=0|l.buffer.dimension,l.normalized=!1,l.type=l.buffer.dtype,l.offset=0,l.stride=0,l.divisor=0,l.state=1):o.getBuffer(f.buffer)?(l.buffer=o.getBuffer(f.buffer),l.size=0|(+f.size||l.buffer.dimension),l.normalized=!!f.normalized||!1,"type"in f?(N.parameter(f.type,$,"invalid buffer type"),l.type=$[f.type]):l.type=l.buffer.dtype,l.offset=0|(f.offset||0),l.stride=0|(f.stride||0),l.divisor=0|(f.divisor||0),l.state=1,N(l.size>=1&&l.size<=4,"size must be between 1 and 4"),N(l.offset>=0,"invalid offset"),N(l.stride>=0&&l.stride<=255,"stride must be between 0 and 255"),N(l.divisor>=0,"divisor must be positive"),N(!l.divisor||!!n.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in f?(N(c>0,"first attribute must not be a constant"),l.x=+f.x||0,l.y=+f.y||0,l.z=+f.z||0,l.w=+f.w||0,l.state=2):N(!1,"invalid attribute spec for location "+c)}for(var p=0;p<r.buffers.length;++p)!i[p]&&r.buffers[p]&&(r.buffers[p].destroy(),r.buffers[p]=null);return r.refresh(),s}return i.vaoCount+=1,s.destroy=function(){for(var e=0;e<r.buffers.length;++e)r.buffers[e]&&r.buffers[e].destroy();r.buffers.length=0,r.destroy()},s._vao=r,s._reglType="vao",s(t)},getVAO:function(e){return"function"==typeof e&&e._vao?e._vao:null},destroyBuffer:function(e){for(var n=0;n<s.length;++n){var r=s[n];r.buffer===e&&(t.disableVertexAttribArray(n),r.buffer=null)}},setVAO:l()?function(e){if(e!==f.currentVAO){var t=l();e?t.bindVertexArrayOES(e.vao):t.bindVertexArrayOES(null),f.currentVAO=e}}:function(e){if(e!==f.currentVAO){if(e)e.bindAttrs();else for(var n=h(),r=0;r<s.length;++r){var i=s[r];i.buffer?(t.enableVertexAttribArray(r),t.vertexAttribPointer(r,i.size,i.type,i.normalized,i.stride,i.offfset),n&&i.divisor&&n.vertexAttribDivisorANGLE(r,i.divisor)):(t.disableVertexAttribArray(r),t.vertexAttrib4f(r,i.x,i.y,i.z,i.w))}f.currentVAO=e}},clear:l()?function(){K(d).forEach((function(e){e.destroy()}))}:function(){}};function l(){return n.oes_vertex_array_object}function h(){return n.angle_instanced_arrays}function p(){this.id=++c,this.attributes=[];var e=l();this.vao=e?e.createVertexArrayOES():null,d[this.id]=this,this.buffers=[]}return p.prototype.bindAttrs=function(){for(var e=h(),n=this.attributes,r=0;r<n.length;++r){var i=n[r];i.buffer?(t.enableVertexAttribArray(r),t.bindBuffer(kn,i.buffer.buffer),t.vertexAttribPointer(r,i.size,i.type,i.normalized,i.stride,i.offset),e&&i.divisor&&e.vertexAttribDivisorANGLE(r,i.divisor)):(t.disableVertexAttribArray(r),t.vertexAttrib4f(r,i.x,i.y,i.z,i.w))}for(var o=n.length;o<a;++o)t.disableVertexAttribArray(o)},p.prototype.refresh=function(){var e=l();e&&(e.bindVertexArrayOES(this.vao),this.bindAttrs(),f.currentVAO=this)},p.prototype.destroy=function(){if(this.vao){var e=l();this===f.currentVAO&&(f.currentVAO=null,e.bindVertexArrayOES(null)),e.deleteVertexArrayOES(this.vao),this.vao=null}d[this.id]&&(delete d[this.id],i.vaoCount-=1)},f}(i,l,v,f,b),_=function(t,n,r,i){var o={},a=0,s={uint8:me,uint16:ve};function u(e){this.id=a++,o[this.id]=this,this.buffer=e,this.primType=pe,this.vertCount=0,this.type=0}n.oes_element_index_uint&&(s.uint32=Ee),u.prototype.bind=function(){this.buffer.bind()};var c=[];function d(i,o,a,s,u,c,d){var f;if(i.buffer.bind(),o){var l=d;d||e(o)&&(!Y(o)||e(o.data))||(l=n.oes_element_index_uint?Ee:ve),r._initBuffer(i.buffer,o,a,l,3)}else t.bufferData(_e,c,a),i.buffer.dtype=f||me,i.buffer.usage=a,i.buffer.dimension=3,i.buffer.byteLength=c;if(f=d,!d){switch(i.buffer.dtype){case me:case ge:f=me;break;case ve:case ye:f=ve;break;case Ee:case be:f=Ee;break;default:N.raise("unsupported type for element array")}i.buffer.dtype=f}i.type=f,N(f!==Ee||!!n.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var h=u;h<0&&(h=i.buffer.byteLength,f===ve?h>>=1:f===Ee&&(h>>=2)),i.vertCount=h;var p=s;if(s<0){p=pe;var g=i.buffer.dimension;1===g&&(p=le),2===g&&(p=he),3===g&&(p=pe)}i.primType=p}function f(e){i.elementsCount--,N(null!==e.buffer,"must not double destroy elements"),delete o[e.id],e.buffer.destroy(),e.buffer=null}return{create:function(t,n){var o=r.create(null,_e,!0),a=new u(o._buffer);function c(t){if(t)if("number"==typeof t)o(t),a.primType=pe,a.vertCount=0|t,a.type=me;else{var n=null,r=xe,i=-1,u=-1,f=0,l=0;Array.isArray(t)||e(t)||Y(t)?n=t:(N.type(t,"object","invalid arguments for elements"),"data"in t&&(n=t.data,N(Array.isArray(n)||e(n)||Y(n),"invalid data for element buffer")),"usage"in t&&(N.parameter(t.usage,ee,"invalid element buffer usage"),r=ee[t.usage]),"primitive"in t&&(N.parameter(t.primitive,fe,"invalid element buffer primitive"),i=fe[t.primitive]),"count"in t&&(N("number"==typeof t.count&&t.count>=0,"invalid vertex count for elements"),u=0|t.count),"type"in t&&(N.parameter(t.type,s,"invalid buffer type"),l=s[t.type]),"length"in t?f=0|t.length:(f=u,l===ve||l===ye?f*=2:l!==Ee&&l!==be||(f*=4))),d(a,n,r,i,u,f,l)}else o(),a.primType=pe,a.vertCount=0,a.type=me;return c}return i.elementsCount++,c(t),c._reglType="elements",c._elements=a,c.subdata=function(e,t){return o.subdata(e,t),c},c.destroy=function(){f(a)},c},createStream:function(e){var t=c.pop();return t||(t=new u(r.create(null,_e,!0,!1)._buffer)),d(t,e,we,-1,-1,0,0),t},destroyStream:function(e){c.push(e)},getElements:function(e){return"function"==typeof e&&e._elements instanceof u?e._elements:null},clear:function(){K(o).forEach(f)}}}(i,l,b,f),w=function(e,n,r,i){var o={},a={};function s(e,t,n,r){this.name=e,this.id=t,this.location=n,this.info=r}function u(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function c(t,r,i){var s=t===Cn?o:a,u=s[r];if(!u){var c=n.str(r);u=e.createShader(t),e.shaderSource(u,c),e.compileShader(u),N.shaderError(e,u,c,t,i),s[r]=u}return u}var d={},f=[],l=0;function h(e,t){this.id=l++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,i.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function p(t,r,o){var a,d,f=c(Cn,t.fragId),l=c(Ln,t.vertId),h=t.program=e.createProgram();if(e.attachShader(h,f),e.attachShader(h,l),o)for(a=0;a<o.length;++a){var p=o[a];e.bindAttribLocation(h,p[0],p[1])}e.linkProgram(h),N.linkError(e,h,n.str(t.fragId),n.str(t.vertId),r);var g=e.getProgramParameter(h,Gn);i.profile&&(t.stats.uniformsCount=g);var m=t.uniforms;for(a=0;a<g;++a)if(d=e.getActiveUniform(h,a))if(d.size>1)for(var y=0;y<d.size;++y){var v=d.name.replace("[0]","["+y+"]");u(m,new s(v,n.id(v),e.getUniformLocation(h,v),d))}else u(m,new s(d.name,n.id(d.name),e.getUniformLocation(h,d.name),d));var b=e.getProgramParameter(h,Mn);i.profile&&(t.stats.attributesCount=b);var E=t.attributes;for(a=0;a<b;++a)(d=e.getActiveAttrib(h,a))&&u(E,new s(d.name,n.id(d.name),e.getAttribLocation(h,d.name),d))}return i.profile&&(r.getMaxUniformsCount=function(){var e=0;return f.forEach((function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)})),e},r.getMaxAttributesCount=function(){var e=0;return f.forEach((function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)})),e}),{clear:function(){var t=e.deleteShader.bind(e);K(o).forEach(t),o={},K(a).forEach(t),a={},f.forEach((function(t){e.deleteProgram(t.program)})),f.length=0,d={},r.shaderCount=0},program:function(n,i,s,u){N.command(n>=0,"missing vertex shader",s),N.command(i>=0,"missing fragment shader",s);var c=d[i];c||(c=d[i]={});var l=c[n];if(l&&(l.refCount++,!u))return l;var g=new h(i,n);return r.shaderCount++,p(g,s,u),l||(c[n]=g),f.push(g),t(g,{destroy:function(){if(g.refCount--,g.refCount<=0){e.deleteProgram(g.program);var t=f.indexOf(g);f.splice(t,1),r.shaderCount--}c[g.vertId].refCount<=0&&(e.deleteShader(a[g.vertId]),delete a[g.vertId],delete d[g.fragId][g.vertId]),Object.keys(d[g.fragId]).length||(e.deleteShader(o[g.fragId]),delete o[g.fragId],delete d[g.fragId])}})},restore:function(){o={},a={};for(var e=0;e<f.length;++e)p(f[e],null,f[e].attributes.map((function(e){return[e.location,e.name]})))},shader:c,frag:-1,vert:-1}}(i,d,f,r),x=sn(i,l,v,(function(){S.procs.poll()}),y,f,r),A=function(e,t,n,r,i){var o={rgba4:cn,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};t.ext_srgb&&(o.srgba=35907),t.ext_color_buffer_half_float&&(o.rgba16f=34842,o.rgb16f=34843),t.webgl_color_buffer_float&&(o.rgba32f=34836);var a=[];Object.keys(o).forEach((function(e){var t=o[e];a[t]=e}));var s=0,u={};function c(e){this.id=s++,this.refCount=1,this.renderbuffer=e,this.format=cn,this.width=0,this.height=0,i.profile&&(this.stats={size:0})}function d(t){var n=t.renderbuffer;N(n,"must not double destroy renderbuffer"),e.bindRenderbuffer(un,null),e.deleteRenderbuffer(n),t.renderbuffer=null,t.refCount=0,delete u[t.id],r.renderbufferCount--}return c.prototype.decRef=function(){--this.refCount<=0&&d(this)},i.profile&&(r.getTotalRenderbufferSize=function(){var e=0;return Object.keys(u).forEach((function(t){e+=u[t].stats.size})),e}),{create:function(t,s){var d=new c(e.createRenderbuffer());function f(t,r){var s=0,u=0,c=cn;if("object"==typeof t&&t){var l=t;if("shape"in l){var h=l.shape;N(Array.isArray(h)&&h.length>=2,"invalid renderbuffer shape"),s=0|h[0],u=0|h[1]}else"radius"in l&&(s=u=0|l.radius),"width"in l&&(s=0|l.width),"height"in l&&(u=0|l.height);"format"in l&&(N.parameter(l.format,o,"invalid renderbuffer format"),c=o[l.format])}else"number"==typeof t?(s=0|t,u="number"==typeof r?0|r:s):t?N.raise("invalid arguments to renderbuffer constructor"):s=u=1;if(N(s>0&&u>0&&s<=n.maxRenderbufferSize&&u<=n.maxRenderbufferSize,"invalid renderbuffer size"),s!==d.width||u!==d.height||c!==d.format)return f.width=d.width=s,f.height=d.height=u,d.format=c,e.bindRenderbuffer(un,d.renderbuffer),e.renderbufferStorage(un,c,s,u),N(0===e.getError(),"invalid render buffer format"),i.profile&&(d.stats.size=fn(d.format,d.width,d.height)),f.format=a[d.format],f}return u[d.id]=d,r.renderbufferCount++,f(t,s),f.resize=function(t,r){var o=0|t,a=0|r||o;return o===d.width&&a===d.height||(N(o>0&&a>0&&o<=n.maxRenderbufferSize&&a<=n.maxRenderbufferSize,"invalid renderbuffer size"),f.width=d.width=o,f.height=d.height=a,e.bindRenderbuffer(un,d.renderbuffer),e.renderbufferStorage(un,d.format,o,a),N(0===e.getError(),"invalid render buffer format"),i.profile&&(d.stats.size=fn(d.format,d.width,d.height))),f},f._reglType="renderbuffer",f._renderbuffer=d,i.profile&&(f.stats=d.stats),f.destroy=function(){d.decRef()},f},clear:function(){K(u).forEach(d)},restore:function(){K(u).forEach((function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(un,t.renderbuffer),e.renderbufferStorage(un,t.format,t.width,t.height)})),e.bindRenderbuffer(un,null)}}}(i,l,v,f,r),T=function(e,n,r,i,o,a){var s={cur:null,next:null,dirty:!1,setFBO:null},u=["rgba"],c=["rgba4","rgb565","rgb5 a1"];n.ext_srgb&&c.push("srgba"),n.ext_color_buffer_half_float&&c.push("rgba16f","rgb16f"),n.webgl_color_buffer_float&&c.push("rgba32f");var d=["uint8"];function f(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var r=0,i=0;t?(r=t.width,i=t.height):n&&(r=n.width,i=n.height),this.width=r,this.height=i}function l(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function h(e,t,n){if(e)if(e.texture){var r=e.texture._texture,i=Math.max(1,r.width),o=Math.max(1,r.height);N(i===t&&o===n,"inconsistent width/height for supplied texture"),r.refCount+=1}else{var a=e.renderbuffer._renderbuffer;N(a.width===t&&a.height===n,"inconsistent width/height for renderbuffer"),a.refCount+=1}}function p(t,n){n&&(n.texture?e.framebufferTexture2D(ln,t,n.target,n.texture._texture.texture,0):e.framebufferRenderbuffer(ln,t,hn,n.renderbuffer._renderbuffer.renderbuffer))}function g(e){var t=pn,n=null,r=null,i=e;"object"==typeof e&&(i=e.data,"target"in e&&(t=0|e.target)),N.type(i,"function","invalid attachment data");var o=i._reglType;return"texture2d"===o?(n=i,N(t===pn)):"textureCube"===o?(n=i,N(t>=gn&&t<gn+6,"invalid cube map target")):"renderbuffer"===o?(r=i,t=hn):N.raise("invalid regl object for attachment"),new f(t,n,r)}function m(e,t,n,r,a){if(n){var s=i.create2D({width:e,height:t,format:r,type:a});return s._texture.refCount=0,new f(pn,s,null)}var u=o.create({width:e,height:t,format:r});return u._renderbuffer.refCount=0,new f(hn,null,u)}function y(e){return e&&(e.texture||e.renderbuffer)}function v(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n),e.width=t,e.height=n)}n.oes_texture_half_float&&d.push("half float","float16"),n.oes_texture_float&&d.push("float","float32");var b=0,E={};function _(){this.id=b++,E[this.id]=this,this.framebuffer=e.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function w(e){e.colorAttachments.forEach(l),l(e.depthAttachment),l(e.stencilAttachment),l(e.depthStencilAttachment)}function x(t){var n=t.framebuffer;N(n,"must not double destroy framebuffer"),e.deleteFramebuffer(n),t.framebuffer=null,a.framebufferCount--,delete E[t.id]}function A(t){var n;e.bindFramebuffer(ln,t.framebuffer);var i=t.colorAttachments;for(n=0;n<i.length;++n)p(mn+n,i[n]);for(n=i.length;n<r.maxColorAttachments;++n)e.framebufferTexture2D(ln,mn+n,pn,null,0);e.framebufferTexture2D(ln,bn,pn,null,0),e.framebufferTexture2D(ln,yn,pn,null,0),e.framebufferTexture2D(ln,vn,pn,null,0),p(yn,t.depthAttachment),p(vn,t.stencilAttachment),p(bn,t.depthStencilAttachment);var o=e.checkFramebufferStatus(ln);e.isContextLost()||o===En||N.raise("framebuffer configuration not supported, status = "+In[o]),e.bindFramebuffer(ln,s.next?s.next.framebuffer:null),s.cur=s.next,e.getError()}function T(e,i){var o=new _;function f(e,t){var i;N(s.next!==o,"can not update framebuffer which is currently in use");var a=0,l=0,p=!0,v=!0,b=null,E=!0,_="rgba",x="uint8",T=1,S=null,D=null,I=null,R=!1;if("number"==typeof e)a=0|e,l=0|t||a;else if(e){N.type(e,"object","invalid arguments for framebuffer");var k=e;if("shape"in k){var O=k.shape;N(Array.isArray(O)&&O.length>=2,"invalid shape for framebuffer"),a=O[0],l=O[1]}else"radius"in k&&(a=l=k.radius),"width"in k&&(a=k.width),"height"in k&&(l=k.height);("color"in k||"colors"in k)&&(b=k.color||k.colors,Array.isArray(b)&&N(1===b.length||n.webgl_draw_buffers,"multiple render targets not supported")),b||("colorCount"in k&&(T=0|k.colorCount,N(T>0,"invalid color buffer count")),"colorTexture"in k&&(E=!!k.colorTexture,_="rgba4"),"colorType"in k&&(x=k.colorType,E?(N(n.oes_texture_float||!("float"===x||"float32"===x),"you must enable OES_texture_float in order to use floating point framebuffer objects"),N(n.oes_texture_half_float||!("half float"===x||"float16"===x),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===x||"float16"===x?(N(n.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),_="rgba16f"):"float"!==x&&"float32"!==x||(N(n.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),_="rgba32f"),N.oneOf(x,d,"invalid color type")),"colorFormat"in k&&(_=k.colorFormat,u.indexOf(_)>=0?E=!0:c.indexOf(_)>=0?E=!1:E?N.oneOf(k.colorFormat,u,"invalid color format for texture"):N.oneOf(k.colorFormat,c,"invalid color format for renderbuffer"))),("depthTexture"in k||"depthStencilTexture"in k)&&(R=!(!k.depthTexture&&!k.depthStencilTexture),N(!R||n.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in k&&("boolean"==typeof k.depth?p=k.depth:(S=k.depth,v=!1)),"stencil"in k&&("boolean"==typeof k.stencil?v=k.stencil:(D=k.stencil,p=!1)),"depthStencil"in k&&("boolean"==typeof k.depthStencil?p=v=k.depthStencil:(I=k.depthStencil,p=!1,v=!1))}else a=l=1;var C=null,L=null,G=null,M=null;if(Array.isArray(b))C=b.map(g);else if(b)C=[g(b)];else for(C=new Array(T),i=0;i<T;++i)C[i]=m(a,l,E,_,x);N(n.webgl_draw_buffers||C.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),N(C.length<=r.maxColorAttachments,"too many color attachments, not supported"),a=a||C[0].width,l=l||C[0].height,S?L=g(S):p&&!v&&(L=m(a,l,R,"depth","uint32")),D?G=g(D):v&&!p&&(G=m(a,l,!1,"stencil","uint8")),I?M=g(I):!S&&!D&&v&&p&&(M=m(a,l,R,"depth stencil","depth stencil")),N(!!S+!!D+!!I<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var U=null;for(i=0;i<C.length;++i)if(h(C[i],a,l),N(!C[i]||C[i].texture&&wn.indexOf(C[i].texture._texture.format)>=0||C[i].renderbuffer&&Dn.indexOf(C[i].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+i+" is invalid"),C[i]&&C[i].texture){var P=xn[C[i].texture._texture.format]*An[C[i].texture._texture.type];null===U?U=P:N(U===P,"all color attachments much have the same number of bits per pixel.")}return h(L,a,l),N(!L||L.texture&&L.texture._texture.format===_n||L.renderbuffer&&L.renderbuffer._renderbuffer.format===Tn,"invalid depth attachment for framebuffer object"),h(G,a,l),N(!G||G.renderbuffer&&G.renderbuffer._renderbuffer.format===Sn,"invalid stencil attachment for framebuffer object"),h(M,a,l),N(!M||M.texture&&M.texture._texture.format===Nn||M.renderbuffer&&M.renderbuffer._renderbuffer.format===Nn,"invalid depth-stencil attachment for framebuffer object"),w(o),o.width=a,o.height=l,o.colorAttachments=C,o.depthAttachment=L,o.stencilAttachment=G,o.depthStencilAttachment=M,f.color=C.map(y),f.depth=y(L),f.stencil=y(G),f.depthStencil=y(M),f.width=o.width,f.height=o.height,A(o),f}return a.framebufferCount++,f(e,i),t(f,{resize:function(e,t){N(s.next!==o,"can not resize a framebuffer which is currently in use");var n=Math.max(0|e,1),r=Math.max(0|t||n,1);if(n===o.width&&r===o.height)return f;for(var i=o.colorAttachments,a=0;a<i.length;++a)v(i[a],n,r);return v(o.depthAttachment,n,r),v(o.stencilAttachment,n,r),v(o.depthStencilAttachment,n,r),o.width=f.width=n,o.height=f.height=r,A(o),f},_reglType:"framebuffer",_framebuffer:o,destroy:function(){x(o),w(o)},use:function(e){s.setFBO({framebuffer:f},e)}})}return t(s,{getFramebuffer:function(e){if("function"==typeof e&&"framebuffer"===e._reglType){var t=e._framebuffer;if(t instanceof _)return t}return null},create:T,createCube:function(e){var o=Array(6);function a(e){var r;N(o.indexOf(s.next)<0,"can not update framebuffer which is currently in use");var c,f={color:null},l=0,h=null,p="rgba",g="uint8",m=1;if("number"==typeof e)l=0|e;else if(e){N.type(e,"object","invalid arguments for framebuffer");var y=e;if("shape"in y){var v=y.shape;N(Array.isArray(v)&&v.length>=2,"invalid shape for framebuffer"),N(v[0]===v[1],"cube framebuffer must be square"),l=v[0]}else"radius"in y&&(l=0|y.radius),"width"in y?(l=0|y.width,"height"in y&&N(y.height===l,"must be square")):"height"in y&&(l=0|y.height);("color"in y||"colors"in y)&&(h=y.color||y.colors,Array.isArray(h)&&N(1===h.length||n.webgl_draw_buffers,"multiple render targets not supported")),h||("colorCount"in y&&(m=0|y.colorCount,N(m>0,"invalid color buffer count")),"colorType"in y&&(N.oneOf(y.colorType,d,"invalid color type"),g=y.colorType),"colorFormat"in y&&(p=y.colorFormat,N.oneOf(y.colorFormat,u,"invalid color format for texture"))),"depth"in y&&(f.depth=y.depth),"stencil"in y&&(f.stencil=y.stencil),"depthStencil"in y&&(f.depthStencil=y.depthStencil)}else l=1;if(h)if(Array.isArray(h))for(c=[],r=0;r<h.length;++r)c[r]=h[r];else c=[h];else{c=Array(m);var b={radius:l,format:p,type:g};for(r=0;r<m;++r)c[r]=i.createCube(b)}for(f.color=Array(c.length),r=0;r<c.length;++r){var E=c[r];N("function"==typeof E&&"textureCube"===E._reglType,"invalid cube map"),l=l||E.width,N(E.width===l&&E.height===l,"invalid cube map shape"),f.color[r]={target:gn,data:c[r]}}for(r=0;r<6;++r){for(var _=0;_<c.length;++_)f.color[_].target=gn+r;r>0&&(f.depth=o[0].depth,f.stencil=o[0].stencil,f.depthStencil=o[0].depthStencil),o[r]?o[r](f):o[r]=T(f)}return t(a,{width:l,height:l,color:c})}return a(e),t(a,{faces:o,resize:function(e){var t,n=0|e;if(N(n>0&&n<=r.maxCubeMapSize,"invalid radius for cube fbo"),n===a.width)return a;var i=a.color;for(t=0;t<i.length;++t)i[t].resize(n);for(t=0;t<6;++t)o[t].resize(n);return a.width=a.height=n,a},_reglType:"framebufferCube",destroy:function(){o.forEach((function(e){e.destroy()}))}})},clear:function(){K(E).forEach(x)},restore:function(){s.cur=null,s.next=null,s.dirty=!0,K(E).forEach((function(t){t.framebuffer=e.createFramebuffer(),A(t)}))}})}(i,l,v,x,A,f),S=Ji(i,d,l,v,b,_,0,T,{},E,w,{elements:null,primitive:4,count:-1,offset:0,instances:-1},y,h,r),D=Bn(i,T,S.procs.poll,y,o,l,v),I=S.next,R=i.canvas,k=[],O=[],M=[],U=[r.onDestroy],z=null;function F(){if(0===k.length)return h&&h.update(),void(z=null);z=L.next(F),De();for(var e=k.length-1;e>=0;--e){var t=k[e];t&&t(y,null,0)}i.flush(),h&&h.update()}function B(){!z&&k.length>0&&(z=L.next(F))}function q(){z&&(L.cancel(F),z=null)}function Z(e){e.preventDefault(),a=!0,q(),O.forEach((function(e){e()}))}function Q(e){i.getError(),a=!1,s.restore(),w.restore(),b.restore(),x.restore(),A.restore(),T.restore(),E.restore(),h&&h.restore(),S.procs.refresh(),B(),M.forEach((function(e){e()}))}function J(e){function n(e,t){var n={},r={};return Object.keys(e).forEach((function(i){var o=e[i];if(C.isDynamic(o))r[i]=C.unbox(o,i);else{if(t&&Array.isArray(o))for(var a=0;a<o.length;++a)if(C.isDynamic(o[a]))return void(r[i]=C.unbox(o,i));n[i]=o}})),{dynamic:r,static:n}}N(!!e,"invalid args to regl({...})"),N.type(e,"object","invalid args to regl({...})");var r=n(e.context||{},!0),i=n(e.uniforms||{},!0),o=n(e.attributes||{},!1),s=n(function(e){var n=t({},e);function r(e){if(e in n){var t=n[e];delete n[e],Object.keys(t).forEach((function(r){n[e+"."+r]=t[r]}))}}return delete n.uniforms,delete n.attributes,delete n.context,delete n.vao,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),r("blend"),r("depth"),r("cull"),r("stencil"),r("polygonOffset"),r("scissor"),r("sample"),"vao"in e&&(n.vao=e.vao),n}(e),!1),u={gpuTime:0,cpuTime:0,count:0},c=S.compile(s,o,i,r,u),d=c.draw,f=c.batch,l=c.scope,h=[];return t((function(e,t){var n;if(a&&N.raise("context lost"),"function"==typeof e)return l.call(this,null,e,0);if("function"==typeof t)if("number"==typeof e)for(n=0;n<e;++n)l.call(this,null,t,n);else{if(!Array.isArray(e))return l.call(this,e,t,0);for(n=0;n<e.length;++n)l.call(this,e[n],t,n)}else if("number"==typeof e){if(e>0)return f.call(this,function(e){for(;h.length<e;)h.push(null);return h}(0|e),0|e)}else{if(!Array.isArray(e))return d.call(this,e);if(e.length)return f.call(this,e,e.length)}}),{stats:u,destroy:function(){c.destroy()}})}R&&(R.addEventListener(eo,Z,!1),R.addEventListener(to,Q,!1));var Ae=T.setFBO=J({framebuffer:C.define.call(null,1,"framebuffer")});function Te(e,t){var n=0;S.procs.poll();var r=t.color;r&&(i.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=16384),"depth"in t&&(i.clearDepth(+t.depth),n|=256),"stencil"in t&&(i.clearStencil(0|t.stencil),n|=1024),N(!!n,"called regl.clear with no buffer specified"),i.clear(n)}function Se(e){return N.type(e,"function","regl.frame() callback must be a function"),k.push(e),B(),{cancel:function(){var t=no(k,e);N(t>=0,"cannot cancel a frame twice"),k[t]=function e(){var t=no(k,e);k[t]=k[k.length-1],k.length-=1,k.length<=0&&q()}}}}function Ne(){var e=I.viewport,t=I.scissor_box;e[0]=e[1]=t[0]=t[1]=0,y.viewportWidth=y.framebufferWidth=y.drawingBufferWidth=e[2]=t[2]=i.drawingBufferWidth,y.viewportHeight=y.framebufferHeight=y.drawingBufferHeight=e[3]=t[3]=i.drawingBufferHeight}function De(){y.tick+=1,y.time=Re(),Ne(),S.procs.poll()}function Ie(){x.refresh(),Ne(),S.procs.refresh(),h&&h.update()}function Re(){return(G()-p)/1e3}Ie();var ke=t(J,{clear:function(e){if(N("object"==typeof e&&e,"regl.clear() takes an object as input"),"framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var n=0;n<6;++n)Ae(t({framebuffer:e.framebuffer.faces[n]},e),Te);else Ae(e,Te);else Te(0,e)},prop:C.define.bind(null,1),context:C.define.bind(null,2),this:C.define.bind(null,3),draw:J({}),buffer:function(e){return b.create(e,34962,!1,!1)},elements:function(e){return _.create(e,!1)},texture:x.create2D,cube:x.createCube,renderbuffer:A.create,framebuffer:T.create,framebufferCube:T.createCube,vao:E.createVAO,attributes:o,frame:Se,on:function(e,t){var n;switch(N.type(t,"function","listener callback must be a function"),e){case"frame":return Se(t);case"lost":n=O;break;case"restore":n=M;break;case"destroy":n=U;break;default:N.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t)return n[e]=n[n.length-1],void n.pop()}}},limits:v,hasExtension:function(e){return v.extensions.indexOf(e.toLowerCase())>=0},read:D,destroy:function(){k.length=0,q(),R&&(R.removeEventListener(eo,Z),R.removeEventListener(to,Q)),w.clear(),T.clear(),A.clear(),x.clear(),_.clear(),b.clear(),E.clear(),h&&h.clear(),U.forEach((function(e){e()}))},_gl:i,_refresh:Ie,poll:function(){De(),h&&h.update()},now:Re,stats:f});return r.onDone(null,ke),ke}}()},317:(e,t,n)=>{var r=n(322).default;function i(){"use strict";e.exports=i=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,o=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",d=s.toStringTag||"@@toStringTag";function f(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var i=t&&t.prototype instanceof g?t:g,o=Object.create(i.prototype),s=new D(r||[]);return a(o,"_invoke",{value:A(e,n,s)}),o}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var p={};function g(){}function m(){}function y(){}var v={};f(v,u,(function(){return this}));var b=Object.getPrototypeOf,E=b&&b(b(I([])));E&&E!==n&&o.call(E,u)&&(v=E);var _=y.prototype=g.prototype=Object.create(v);function w(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function n(i,a,s,u){var c=h(e[i],e,a);if("throw"!==c.type){var d=c.arg,f=d.value;return f&&"object"==r(f)&&o.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):t.resolve(f).then((function(e){d.value=e,s(d)}),(function(e){return n("throw",e,s,u)}))}u(c.arg)}var i;a(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}})}function A(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=T(a,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=h(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function T(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,T(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var i=h(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,p;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function I(e){if(e){var t=e[u];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(o.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:R}}function R(){return{value:void 0,done:!0}}return m.prototype=y,a(_,"constructor",{value:y,configurable:!0}),a(y,"constructor",{value:m,configurable:!0}),m.displayName=f(y,d,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,f(e,d,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},w(x.prototype),f(x.prototype,c,(function(){return this})),t.AsyncIterator=x,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new x(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(_),f(_,d,"Generator"),f(_,u,(function(){return this})),f(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=I,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(N),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),N(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;N(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:I(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},t}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},322:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},166:(e,t,n)=>{var r=n(317)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.u=e=>e+".main.js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/layout",n.b=document.baseURI||self.location.href,(()=>{"use strict";var e=n(524),t=n.n(e),r=function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};function i(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function o(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function a(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function s(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}Object.create,Object.create;var u={}.toString;const c=function(e){return function(e,t){return u.call(e)==="[object "+t+"]"}(e,"Number")},d=function(e){var t=typeof e;return null!==e&&"object"===t||"function"===t},f=function(e){return"function"==typeof e},l=function(){function e(){this._events={}}return e.prototype.on=function(e,t,n){return this._events[e]||(this._events[e]=[]),this._events[e].push({callback:t,once:!!n}),this},e.prototype.once=function(e,t){return this.on(e,t,!0)},e.prototype.emit=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this._events[e]||[],o=this._events["*"]||[],a=function(r){for(var i=r.length,o=0;o<i;o++)if(r[o]){var a=r[o],s=a.callback;a.once&&(r.splice(o,1),0===r.length&&delete t._events[e],i--,o--),s.apply(t,n)}};a(i),a(o)},e.prototype.off=function(e,t){if(e)if(t){for(var n=this._events[e]||[],r=n.length,i=0;i<r;i++)n[i].callback===t&&(n.splice(i,1),r--,i--);0===n.length&&delete this._events[e]}else delete this._events[e];else this._events={};return this},e.prototype.getEvents=function(){return this._events},e}();function h(e,t,n,r){for(;e.length;){const i=e.shift();if(n(i))return!0;t.add(i.id),r(i.id).forEach((n=>{t.has(n.id)||(t.add(n.id),e.push(n))}))}return!1}function p(e,t,n,r){if(n(e))return!0;t.add(e.id);for(const i of r(e.id))if(!t.has(i.id)&&p(i,t,n,r))return!0;return!1}class g extends l{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(e){super(),e&&(e.nodes&&this.addNodes(e.nodes),e.edges&&this.addEdges(e.edges),e.tree&&this.addTree(e.tree),e.onChanged&&(this.onChanged=e.onChanged))}batch=e=>{this.batchCount+=1,e(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const e=this.changes;this.changes=[];const t={graph:this,changes:e};this.emit("changed",t),this.onChanged(t)}reduceChanges(e){let t=[];return e.forEach((e=>{switch(e.type){case"NodeRemoved":{let n=!1;t=t.filter((t=>{if("NodeAdded"===t.type){const r=t.value.id===e.value.id;return r&&(n=!0),!r}return"NodeDataUpdated"===t.type?t.id!==e.value.id:"TreeStructureChanged"!==t.type||t.nodeId!==e.value.id})),n||t.push(e);break}case"EdgeRemoved":{let n=!1;t=t.filter((t=>{if("EdgeAdded"===t.type){const r=t.value.id===e.value.id;return r&&(n=!0),!r}return"EdgeDataUpdated"!==t.type&&"EdgeUpdated"!==t.type||t.id!==e.value.id})),n||t.push(e);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const n=t.find((t=>t.type===e.type&&t.id===e.id&&t.propertyName===e.propertyName));n?n.newValue=e.newValue:t.push(e);break}case"TreeStructureDetached":t=t.filter((t=>"TreeStructureAttached"===t.type?t.treeKey!==e.treeKey:"TreeStructureChanged"!==t.type||t.treeKey!==e.treeKey)),t.push(e);break;case"TreeStructureChanged":{const n=t.find((t=>"TreeStructureChanged"===t.type&&t.treeKey===e.treeKey&&t.nodeId===e.nodeId));n?n.newParentId=e.newParentId:t.push(e);break}default:t.push(e)}})),t}checkNodeExistence(e){this.getNode(e)}hasNode(e){return this.nodeMap.has(e)}areNeighbors(e,t){return this.getNeighbors(t).some((t=>t.id===e))}getNode(e){const t=this.nodeMap.get(e);if(!t)throw new Error("Node not found for id: "+e);return t}getRelatedEdges(e,t){if(this.checkNodeExistence(e),"in"===t){const t=this.inEdgesMap.get(e);return Array.from(t)}if("out"===t){const t=this.outEdgesMap.get(e);return Array.from(t)}{const t=this.bothEdgesMap.get(e);return Array.from(t)}}getDegree(e,t){return this.getRelatedEdges(e,t).length}getSuccessors(e){const t=this.getRelatedEdges(e,"out").map((e=>this.getNode(e.target)));return Array.from(new Set(t))}getPredecessors(e){const t=this.getRelatedEdges(e,"in").map((e=>this.getNode(e.source)));return Array.from(new Set(t))}getNeighbors(e){const t=this.getPredecessors(e),n=this.getSuccessors(e);return Array.from(new Set([...t,...n]))}doAddNode(e){if(this.hasNode(e.id))throw new Error("Node already exists: "+e.id);this.nodeMap.set(e.id,e),this.inEdgesMap.set(e.id,new Set),this.outEdgesMap.set(e.id,new Set),this.bothEdgesMap.set(e.id,new Set),this.treeIndices.forEach((t=>{t.childrenMap.set(e.id,new Set)})),this.changes.push({type:"NodeAdded",value:e})}addNodes(e){this.batch((()=>{for(const t of e)this.doAddNode(t)}))}addNode(e){this.addNodes([e])}doRemoveNode(e){const t=this.getNode(e),n=this.bothEdgesMap.get(e);n?.forEach((e=>this.doRemoveEdge(e.id))),this.nodeMap.delete(e),this.treeIndices.forEach((t=>{t.childrenMap.get(e)?.forEach((e=>{t.parentMap.delete(e.id)})),t.parentMap.delete(e),t.childrenMap.delete(e)})),this.changes.push({type:"NodeRemoved",value:t})}removeNodes(e){this.batch((()=>{e.forEach((e=>this.doRemoveNode(e)))}))}removeNode(e){this.removeNodes([e])}updateNodeDataProperty(e,t,n){const r=this.getNode(e);this.batch((()=>{const i=r.data[t],o=n;r.data[t]=o,this.changes.push({type:"NodeDataUpdated",id:e,propertyName:t,oldValue:i,newValue:o})}))}mergeNodeData(e,t){this.batch((()=>{Object.entries(t).forEach((([t,n])=>{this.updateNodeDataProperty(e,t,n)}))}))}updateNodeData(...e){const t=e[0],n=this.getNode(t);if("string"==typeof e[1])return void this.updateNodeDataProperty(t,e[1],e[2]);let r;if("function"==typeof e[1]){const t=e[1];r=t(n.data)}else"object"==typeof e[1]&&(r=e[1]);this.batch((()=>{const e=n.data,i=r;n.data=r,this.changes.push({type:"NodeDataUpdated",id:t,oldValue:e,newValue:i})}))}checkEdgeExistence(e){if(!this.hasEdge(e))throw new Error("Edge not found for id: "+e)}hasEdge(e){return this.edgeMap.has(e)}getEdge(e){return this.checkEdgeExistence(e),this.edgeMap.get(e)}getEdgeDetail(e){const t=this.getEdge(e);return{edge:t,source:this.getNode(t.source),target:this.getNode(t.target)}}doAddEdge(e){if(this.hasEdge(e.id))throw new Error("Edge already exists: "+e.id);this.checkNodeExistence(e.source),this.checkNodeExistence(e.target),this.edgeMap.set(e.id,e);const t=this.inEdgesMap.get(e.target),n=this.outEdgesMap.get(e.source),r=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);t.add(e),n.add(e),r.add(e),i.add(e),this.changes.push({type:"EdgeAdded",value:e})}addEdges(e){this.batch((()=>{for(const t of e)this.doAddEdge(t)}))}addEdge(e){this.addEdges([e])}doRemoveEdge(e){const t=this.getEdge(e),n=this.outEdgesMap.get(t.source),r=this.inEdgesMap.get(t.target),i=this.bothEdgesMap.get(t.source),o=this.bothEdgesMap.get(t.target);n.delete(t),r.delete(t),i.delete(t),o.delete(t),this.edgeMap.delete(e),this.changes.push({type:"EdgeRemoved",value:t})}removeEdges(e){this.batch((()=>{e.forEach((e=>this.doRemoveEdge(e)))}))}removeEdge(e){this.removeEdges([e])}updateEdgeSource(e,t){const n=this.getEdge(e);this.checkNodeExistence(t);const r=n.source,i=t;this.outEdgesMap.get(r).delete(n),this.bothEdgesMap.get(r).delete(n),this.outEdgesMap.get(i).add(n),this.bothEdgesMap.get(i).add(n),n.source=t,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:e,propertyName:"source",oldValue:r,newValue:i})}))}updateEdgeTarget(e,t){const n=this.getEdge(e);this.checkNodeExistence(t);const r=n.target,i=t;this.inEdgesMap.get(r).delete(n),this.bothEdgesMap.get(r).delete(n),this.inEdgesMap.get(i).add(n),this.bothEdgesMap.get(i).add(n),n.target=t,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:e,propertyName:"target",oldValue:r,newValue:i})}))}updateEdgeDataProperty(e,t,n){const r=this.getEdge(e);this.batch((()=>{const i=r.data[t],o=n;r.data[t]=o,this.changes.push({type:"EdgeDataUpdated",id:e,propertyName:t,oldValue:i,newValue:o})}))}updateEdgeData(...e){const t=e[0],n=this.getEdge(t);if("string"==typeof e[1])return void this.updateEdgeDataProperty(t,e[1],e[2]);let r;if("function"==typeof e[1]){const t=e[1];r=t(n.data)}else"object"==typeof e[1]&&(r=e[1]);this.batch((()=>{const e=n.data,i=r;n.data=r,this.changes.push({type:"EdgeDataUpdated",id:t,oldValue:e,newValue:i})}))}mergeEdgeData(e,t){this.batch((()=>{Object.entries(t).forEach((([t,n])=>{this.updateEdgeDataProperty(e,t,n)}))}))}checkTreeExistence(e){if(!this.hasTreeStructure(e))throw new Error("Tree structure not found for treeKey: "+e)}hasTreeStructure(e){return this.treeIndices.has(e)}attachTreeStructure(e){this.treeIndices.has(e)||(this.treeIndices.set(e,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:e})})))}detachTreeStructure(e){this.checkTreeExistence(e),this.treeIndices.delete(e),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:e})}))}addTree(e,t){this.batch((()=>{this.attachTreeStructure(t);const n=[],r=Array.isArray(e)?e:[e];for(;r.length;){const e=r.shift();n.push(e),e.children&&r.push(...e.children)}this.addNodes(n),n.forEach((e=>{e.children?.forEach((n=>{this.setParent(n.id,e.id,t)}))}))}))}getRoots(e){return this.checkTreeExistence(e),this.getAllNodes().filter((t=>!this.getParent(t.id,e)))}getChildren(e,t){this.checkNodeExistence(e),this.checkTreeExistence(t);const n=this.treeIndices.get(t).childrenMap.get(e);return Array.from(n||[])}getParent(e,t){return this.checkNodeExistence(e),this.checkTreeExistence(t),this.treeIndices.get(t).parentMap.get(e)||null}getAncestors(e,t){const n=[];let r,i=this.getNode(e);for(;r=this.getParent(i.id,t);)n.push(r),i=r;return n}setParent(e,t,n){this.checkTreeExistence(n);const r=this.treeIndices.get(n),i=this.getNode(e),o=r.parentMap.get(e),a=this.getNode(t);r.parentMap.set(e,a),o&&r.childrenMap.get(o.id)?.delete(i);let s=r.childrenMap.get(a.id);s||(s=new Set,r.childrenMap.set(a.id,s)),s.add(i),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:n,nodeId:e,oldParentId:o?.id,newParentId:a.id})}))}dfsTree(e,t,n){return p(this.getNode(e),new Set,t,(e=>this.getChildren(e,n)))}bfsTree(e,t,n){return h([this.getNode(e)],new Set,t,(e=>this.getChildren(e,n)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(e,t,n="out"){const r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];return h([this.getNode(e)],new Set,t,r)}dfs(e,t,n="out"){const r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];return p(this.getNode(e),new Set,t,r)}clone(){const e=this.getAllNodes().map((e=>({...e,data:{...e.data}}))),t=this.getAllEdges().map((e=>({...e,data:{...e.data}}))),n=new g({nodes:e,edges:t});return this.treeIndices.forEach((({parentMap:e,childrenMap:t},r)=>{const i=new Map;e.forEach(((e,t)=>{i.set(t,n.getNode(e.id))}));const o=new Map;t.forEach(((e,t)=>{o.set(t,new Set(Array.from(e).map((e=>n.getNode(e.id)))))})),n.treeIndices.set(r,{parentMap:i,childrenMap:o})})),n}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}}var m=function(e){if(null===e)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof Array){var t=[];return e.forEach((function(e){t.push(e)})),t.map((function(e){return m(e)}))}if("object"==typeof e){var n={};return Object.keys(e).forEach((function(t){n[t]=m(e[t])})),n}return e},y=function(e,t){var n=m(e);return n.data=n.data||{},t&&(c(n.data.x)||(n.data.x=Math.random()*t[0]),c(n.data.y)||(n.data.y=Math.random()*t[1])),n},v=Array.isArray,b=function(e,t,n){var i=e.getAllNodes(),o=e.getAllEdges();return(null==i?void 0:i.length)?1===i.length?(t&&e.mergeNodeData(i[0].id,{x:n[0],y:n[1]}),{nodes:[r(r({},i[0]),{data:r(r({},i[0].data),{x:n[0],y:n[1]})})],edges:o}):void 0:{nodes:[],edges:o}},E=function(){function e(e){this.id=e.id||0,this.rx=e.rx,this.ry=e.ry,this.fx=0,this.fy=0,this.mass=e.mass,this.degree=e.degree,this.g=e.g||0}return e.prototype.distanceTo=function(e){var t=this.rx-e.rx,n=this.ry-e.ry;return Math.hypot(t,n)},e.prototype.setPos=function(e,t){this.rx=e,this.ry=t},e.prototype.resetForce=function(){this.fx=0,this.fy=0},e.prototype.addForce=function(e){var t=e.rx-this.rx,n=e.ry-this.ry,r=Math.hypot(t,n);r=r<1e-4?1e-4:r;var i=this.g*(this.degree+1)*(e.degree+1)/r;this.fx+=i*t/r,this.fy+=i*n/r},e.prototype.in=function(e){return e.contains(this.rx,this.ry)},e.prototype.add=function(t){var n=this.mass+t.mass;return new e({rx:(this.rx*this.mass+t.rx*t.mass)/n,ry:(this.ry*this.mass+t.ry*t.mass)/n,mass:n,degree:this.degree+t.degree})},e}();const _=E;const w=function(){function e(e){this.xmid=e.xmid,this.ymid=e.ymid,this.length=e.length,this.massCenter=e.massCenter||[0,0],this.mass=e.mass||1}return e.prototype.getLength=function(){return this.length},e.prototype.contains=function(e,t){var n=this.length/2;return e<=this.xmid+n&&e>=this.xmid-n&&t<=this.ymid+n&&t>=this.ymid-n},e.prototype.NW=function(){return new e({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},e.prototype.NE=function(){return new e({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},e.prototype.SW=function(){return new e({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},e.prototype.SE=function(){return new e({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},e}(),x=function(){function e(e){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=e&&(this.quad=e)}return e.prototype.insert=function(t){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new e(this.quad.NW()),this.NE=new e(this.quad.NE()),this.SW=new e(this.quad.SW()),this.SE=new e(this.quad.SE())),this._putBody(this.body),this._putBody(t),this.body=this.body.add(t)):(this.body=this.body.add(t),this._putBody(t)):this.body=t},e.prototype._putBody=function(e){this.quad&&(e.in(this.quad.NW())&&this.NW?this.NW.insert(e):e.in(this.quad.NE())&&this.NE?this.NE.insert(e):e.in(this.quad.SW())&&this.SW?this.SW.insert(e):e.in(this.quad.SE())&&this.SE&&this.SE.insert(e))},e.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},e.prototype.updateForce=function(e){null!=this.body&&e!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(e)<this.theta?e.addForce(this.body):(this.NW&&this.NW.updateForce(e),this.NE&&this.NE.updateForce(e),this.SW&&this.SW.updateForce(e),this.SE&&this.SE.updateForce(e)))},e}();var A={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},T=function(){function e(e){void 0===e&&(e={}),this.options=e,this.id="forceAtlas2",this.options=r(r({},A),e)}return e.prototype.execute=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){return[2,this.genericForceAtlas2Layout(!1,e,t)]}))}))},e.prototype.assign=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){return this.genericForceAtlas2Layout(!0,e,t),[2]}))}))},e.prototype.genericForceAtlas2Layout=function(e,t,n){return i(this,void 0,void 0,(function(){var i,a,s,u,c,d,f,l,h,p,m,v,E,_,w,x,A,T,S,N,D,I;return o(this,(function(o){if(i=t.getAllEdges(),a=t.getAllNodes(),s=this.formatOptions(n,a.length),u=s.width,c=s.height,d=s.prune,f=s.maxIteration,l=s.nodeSize,h=s.center,!(null==a?void 0:a.length)||1===a.length)return[2,b(t,e,h)];if(p=a.map((function(e){return y(e,[u,c])})),m=i.filter((function(e){return e.source!==e.target})),v=new g({nodes:p,edges:m}),E=this.getSizes(v,t,l),this.run(v,t,f,E,e,s),d){for(_=0;_<m.length;_+=1)w=m[_],x=w.source,A=w.target,T=v.getDegree(x),S=v.getDegree(x),T<=1?(N=v.getNode(A),v.mergeNodeData(x,{x:N.data.x,y:N.data.y})):S<=1&&(D=v.getNode(x),v.mergeNodeData(A,{x:D.data.x,y:D.data.y}));I=r(r({},s),{prune:!1,barnesHut:!1}),this.run(v,t,100,E,e,I)}return[2,{nodes:p,edges:i}]}))}))},e.prototype.getSizes=function(e,t,n){for(var r=e.getAllNodes(),i={},o=0;o<r.length;o+=1){var u=r[o],l=u.id,h=u.data;if(i[l]=10,c(h.size))i[l]=h.size;else if(v(h.size))isNaN(h.size[0])||(i[l]=Math.max(h.size[0])),isNaN(h.size[1])||(i[l]=Math.max(h.size[1]));else if(d(h.size))i[l]=Math.max(h.size.width,h.size.height);else if(f(n)){var p=n(t.getNode(l));v(p)?i[l]=Math.max.apply(Math,s([],a(p))):i[l]=p}else v(n)?i[l]=Math.max.apply(Math,s([],a(n))):c(n)&&(i[l]=n)}return i},e.prototype.formatOptions=function(e,t){void 0===e&&(e={});var n=r(r({},this.options),e),i=n.center,o=n.width,a=n.height,s=n.barnesHut,u=n.prune,c=n.maxIteration,d=n.kr,f=n.kg;return n.width=o||"undefined"==typeof window?o:window.innerWidth,n.height=a||"undefined"==typeof window?a:window.innerHeight,n.center=i||[n.width/2,n.height/2],void 0===s&&t>250&&(n.barnesHut=!0),void 0===u&&t>100&&(n.prune=!0),0!==c||u?0===c&&u&&(n.maxIteration=100,t<=200&&t>100?n.maxIteration=500:t>200&&(n.maxIteration=950)):(n.maxIteration=250,t<=200&&t>100?n.maxIteration=1e3:t>200&&(n.maxIteration=1200)),d||(n.kr=50,t>100&&t<=500?n.kr=20:t>500&&(n.kr=1)),f||(n.kg=20,t>100&&t<=500?n.kg=10:t>500&&(n.kg=1)),n},e.prototype.run=function(e,t,n,r,i,o){for(var a=o.kr,s=o.barnesHut,u=o.onTick,c=e.getAllNodes(),d=0,f=n,l={},h={},p={},g=0;g<c.length;g+=1){var m=c[g],y=m.data,v=m.id;if(l[v]=[0,0],s){var b={id:g,rx:y.x,ry:y.y,mass:1,g:a,degree:e.getDegree(v)};p[v]=new _(b)}}for(;f>0;)d=this.oneStep(e,{iter:f,preventOverlapIters:50,krPrime:100,sg:d,forces:l,preForces:h,bodies:p,sizes:r},o),f--,null==u||u({nodes:c,edges:t.getAllEdges()});return e},e.prototype.oneStep=function(e,t,n){for(var r=t.iter,i=t.preventOverlapIters,o=t.krPrime,u=t.sg,c=t.preForces,d=t.bodies,f=t.sizes,l=t.forces,h=n.preventOverlap,p=n.barnesHut,g=e.getAllNodes(),m=0;m<g.length;m+=1){var y=g[m].id;c[y]=s([],a(l[y])),l[y]=[0,0]}return l=this.getAttrForces(e,r,i,f,l,n),l=p&&(h&&r>i||!h)?this.getOptRepGraForces(e,l,d,n):this.getRepGraForces(e,r,i,l,o,f,n),this.updatePos(e,l,c,u,n)},e.prototype.getAttrForces=function(e,t,n,r,i,o){for(var a=o.preventOverlap,s=o.dissuadeHubs,u=o.mode,c=o.prune,d=e.getAllEdges(),f=0;f<d.length;f+=1){var l=d[f],h=l.source,p=l.target,g=e.getNode(h),m=e.getNode(p),y=e.getDegree(h),v=e.getDegree(p);if(!c||!(y<=1||v<=1)){var b=[m.data.x-g.data.x,m.data.y-g.data.y],E=Math.hypot(b[0],b[1]);E=E<1e-4?1e-4:E,b[0]=b[0]/E,b[1]=b[1]/E,a&&t<n&&(E=E-r[h]-r[p]);var _=E,w=_;"linlog"===u&&(w=_=Math.log(1+E)),s&&(_=E/y,w=E/v),a&&t<n&&E<=0?(_=0,w=0):a&&t<n&&E>0&&(_=E,w=E),i[h][0]+=_*b[0],i[p][0]-=w*b[0],i[h][1]+=_*b[1],i[p][1]-=w*b[1]}}return i},e.prototype.getOptRepGraForces=function(e,t,n,r){for(var i=r.kg,o=r.center,a=r.prune,s=e.getAllNodes(),u=s.length,c=9e10,d=-9e10,f=9e10,l=-9e10,h=0;h<u;h+=1){var p=s[h],g=p.id,m=p.data;a&&e.getDegree(g)<=1||(n[g].setPos(m.x,m.y),m.x>=d&&(d=m.x),m.x<=c&&(c=m.x),m.y>=l&&(l=m.y),m.y<=f&&(f=m.y))}var y=Math.max(d-c,l-f),v=new w({xmid:(d+c)/2,ymid:(l+f)/2,length:y,massCenter:o,mass:u}),b=new x(v);for(h=0;h<u;h+=1)g=s[h].id,a&&e.getDegree(g)<=1||n[g].in(v)&&b.insert(n[g]);for(h=0;h<u;h+=1){var E=s[h],_=(g=E.id,m=E.data,e.getDegree(g));if(!(a&&_<=1)){n[g].resetForce(),b.updateForce(n[g]),t[g][0]-=n[g].fx,t[g][1]-=n[g].fy;var A=[m.x-o[0],m.y-o[1]],T=Math.hypot(A[0],A[1]);T=T<1e-4?1e-4:T,A[0]=A[0]/T,A[1]=A[1]/T;var S=i*(_+1);t[g][0]-=S*A[0],t[g][1]-=S*A[1]}}return t},e.prototype.getRepGraForces=function(e,t,n,r,i,o,a){for(var s=a.preventOverlap,u=a.kr,c=a.kg,d=a.center,f=a.prune,l=e.getAllNodes(),h=l.length,p=0;p<h;p+=1){for(var g=l[p],m=e.getDegree(g.id),y=p+1;y<h;y+=1){var v=l[y],b=e.getDegree(v.id);if(!f||!(m<=1||b<=1)){var E=[v.data.x-g.data.x,v.data.y-g.data.y],_=Math.hypot(E[0],E[1]);_=_<1e-4?1e-4:_,E[0]=E[0]/_,E[1]=E[1]/_,s&&t<n&&(_=_-o[g.id]-o[v.id]);var w=u*(m+1)*(b+1)/_;s&&t<n&&_<0?w=i*(m+1)*(b+1):s&&t<n&&0===_?w=0:s&&t<n&&_>0&&(w=u*(m+1)*(b+1)/_),r[g.id][0]-=w*E[0],r[v.id][0]+=w*E[0],r[g.id][1]-=w*E[1],r[v.id][1]+=w*E[1]}}var x=[g.data.x-d[0],g.data.y-d[1]],A=Math.hypot(x[0],x[1]);x[0]=x[0]/A,x[1]=x[1]/A;var T=c*(m+1);r[g.id][0]-=T*x[0],r[g.id][1]-=T*x[1]}return r},e.prototype.updatePos=function(e,t,n,r,i){for(var o=i.ks,a=i.tao,s=i.prune,u=i.ksmax,d=e.getAllNodes(),f=d.length,l=[],h=[],p=0,g=0,m=r,y=0;y<f;y+=1){var v=d[y].id,b=e.getDegree(v);if(!(s&&b<=1)){var E=[t[v][0]-n[v][0],t[v][1]-n[v][1]],_=Math.hypot(E[0],E[1]),w=[t[v][0]+n[v][0],t[v][1]+n[v][1]],x=Math.hypot(w[0],w[1]);l[y]=_,h[y]=x/2,p+=(b+1)*l[y],g+=(b+1)*h[y]}}var A=m;for(m=a*g/p,0!==A&&(m=m>1.5*A?1.5*A:m),y=0;y<f;y+=1){var T=d[y],S=(v=T.id,T.data);if(b=e.getDegree(v),!(s&&b<=1||c(S.fx)&&c(S.fy))){var N=o*m/(1+m*Math.sqrt(l[y])),D=Math.hypot(t[v][0],t[v][1]),I=u/(D=D<1e-4?1e-4:D),R=(N=N>I?I:N)*t[v][0],k=N*t[v][1];e.mergeNodeData(v,{x:S.x+R,y:S.y+k})}}return m},e}();function S(e,t,n){var r=[],i=[];return Object.keys(t).forEach((function(e){n&&n(t[e]),r.push(t[e].x,t[e].y)})),e.edges().forEach((function(n){var r=e.source(n),o=e.target(n);i.push(t[r].x,t[r].y,t[o].x,t[o].y)})),{nodes:r,edges:i}}function N(e){var t=[],n=[],r={};return e.nodes.forEach((function(e){var n=e.id,i=e.data,o=i.x,a=i.y;r[n]={x:o,y:a},t.push(o,a)})),e.edges.forEach((function(e){var t=e.source,i=e.target,o=r[t].x,a=r[t].y,s=r[i].x,u=r[i].y;n.push(o,a,s,u)})),{nodes:t,edges:n}}var D=function(e,t,n){var r=[],i=[],o=[],a=[],s={};return e.forEach((function(e,t){s[e.id]=t,r.push(e.data.x,e.data.y),3===n&&r.push(e.data.z),i.push(e.data.mass||1)})),t.forEach((function(e){var t=e.data.weight||1,n=s[e.source],r=s[e.target];void 0!==n&&void 0!==r&&(o.push([r,n]),a.push(t),i[n]+=t,i[r]+=t)})),{nodes:r,masses:i,edges:o,weights:a}};function I(e){return{mean:0,min:1,max:2}[e]}var R,k={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1,maxDistance:1/0},O=function(){function e(e){void 0===e&&(e={}),this.options=e,this.id="forceAtlas2WASM",this.options=r(r({},k),e)}return e.prototype.execute=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){return[2,this.genericForceAtlas2Layout(!1,e,t)]}))}))},e.prototype.assign=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){return this.genericForceAtlas2Layout(!0,e,t),[2]}))}))},e.prototype.genericForceAtlas2Layout=function(e,t,n){return i(this,void 0,void 0,(function(){var i,a,s,u,d,f,l,h,p,g,m,v,b,E,_,w,x,A,T,S;return o(this,(function(o){switch(o.label){case 0:return i=this.formatOptions(n),a=i.threads,s=i.dimensions,u=i.width,d=i.height,f=i.center,l=i.maxIteration,h=i.minMovement,p=i.distanceThresholdMode,i.tao,g=i.kr,m=i.kg,v=i.ks,b=i.dissuadeHubs,E=i.mode,_=i.maxDistance,w=t.getAllNodes(),x=t.getAllEdges(),(null==w?void 0:w.length)?1===w.length?(e&&t.mergeNodeData(w[0].id,{x:f[0],y:f[1],z:3===s?f[2]:void 0}),[2,{nodes:[r(r({},w[0]),{data:r(r({},w[0].data),{x:f[0],y:f[1],z:3===s?f[2]:void 0})})],edges:x}]):((A=w.map((function(e){return y(e,[u,d])}))).forEach((function(e,t){c(e.data.x)||(e.data.x=Math.random()*u),c(e.data.y)||(e.data.y=Math.random()*d),3===s&&(c(e.data.z)||(e.data.z=Math.random()*Math.sqrt(u*d)))})),T=D(A,x,s),[4,a.forceatlas2({dimensions:s,nodes:T.nodes,edges:T.edges,masses:T.masses,weights:T.weights,iterations:l,min_movement:h,distance_threshold_mode:I(p),center:f,ka:1,kg:m,kr:g,speed:v,prevent_overlapping:!1,node_radius:10,kr_prime:10,strong_gravity:!1,lin_log:"linlog"===E,dissuade_hubs:b,max_distance:_})]):[2,{nodes:[],edges:x}];case 1:return S=o.sent().nodes,A.forEach((function(e,t){e.data.x=S[s*t],e.data.y=S[s*t+1],3===s&&(e.data.z=S[s*t+2])})),e&&A.forEach((function(e){var n=e.id,r=e.data,i={x:r.x,y:r.y};3===s&&(i.z=r.z),t.mergeNodeData(n,i)})),[2,{nodes:A,edges:x}]}}))}))},e.prototype.formatOptions=function(e){void 0===e&&(e={});var t=r(r({},this.options),e),n=t.center,i=t.width,o=t.height;return t.barnesHut,t.prune,t.maxIteration,t.kr,t.kg,t.width=i||"undefined"==typeof window?i:window.innerWidth,t.height=o||"undefined"==typeof window?o:window.innerHeight,t.center=n||[t.width/2,t.height/2],t},e}();!function(e){e.GRAPHOLOGY="graphology",e.ANTV_LAYOUT="@antv/layout",e.ANTV_LAYOUT_WASM_SINGLETHREAD="@antv/layout-wasm - singlethread",e.ANTV_LAYOUT_WASM_MULTITHREADS="@antv/layout-wasm - multithreads",e.ANTV_LAYOUT_GPU="@antv/layout-gpu"}(R||(R={}));var C=800,L=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},G=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};function M(e,n){var r=n.iterations;return L(this,void 0,void 0,(function(){var n;return G(this,(function(i){return n=t()(e,{settings:{barnesHutOptimize:!1,strongGravityMode:!1,gravity:1,scalingRatio:1,slowDown:1},iterations:r||100,getEdgeWeight:"weight"}),[2,S(e,n,(function(e){e.x=e.x+400,e.y=e.y+400}))]}))}))}function U(e,t){var n=t.iterations;return L(this,void 0,void 0,(function(){return G(this,(function(t){switch(t.label){case 0:return[4,new T({dimensions:2,kr:1,kg:1,ks:.1,maxIteration:n||100,width:C,height:C,center:[400,400]}).execute(e)];case 1:return[2,N(t.sent())]}}))}))}function P(e,t,n){var r=t.iterations,i=t.min_movement,o=t.distance_threshold_mode;return L(this,void 0,void 0,(function(){return G(this,(function(t){switch(t.label){case 0:return[4,new O({threads:n,dimensions:2,maxIteration:r||100,minMovement:i,distanceThresholdMode:o,height:C,width:C,center:[400,400],kg:1,kr:1,ks:.1}).execute(e)];case 1:return[2,N(t.sent())]}}))}))}function z(e,t){return f(t)?t:c(t)?function(){return t}:function(){return e}}function F(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o,a,s,u,c,d,f,l,h=e._root,p={data:r},g=e._x0,m=e._y0,y=e._x1,v=e._y1;if(!h)return e._root=p,e;for(;h.length;)if((c=t>=(o=(g+y)/2))?g=o:y=o,(d=n>=(a=(m+v)/2))?m=a:v=a,i=h,!(h=h[f=d<<1|c]))return i[f]=p,e;if(s=+e._x.call(null,h.data),u=+e._y.call(null,h.data),t===s&&n===u)return p.next=h,i?i[f]=p:e._root=p,e;do{i=i?i[f]=new Array(4):e._root=new Array(4),(c=t>=(o=(g+y)/2))?g=o:y=o,(d=n>=(a=(m+v)/2))?m=a:v=a}while((f=d<<1|c)==(l=(u>=a)<<1|s>=o));return i[l]=h,i[f]=p,e}function B(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function j(e){return e[0]}function V(e){return e[1]}function W(e,t,n){var r=new H(null==t?j:t,null==n?V:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function H(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function X(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Y=W.prototype=H.prototype;function K(e,t,n,r,i){if(isNaN(t)||isNaN(n)||isNaN(r))return e;var o,a,s,u,c,d,f,l,h,p,g,m,y=e._root,v={data:i},b=e._x0,E=e._y0,_=e._z0,w=e._x1,x=e._y1,A=e._z1;if(!y)return e._root=v,e;for(;y.length;)if((l=t>=(a=(b+w)/2))?b=a:w=a,(h=n>=(s=(E+x)/2))?E=s:x=s,(p=r>=(u=(_+A)/2))?_=u:A=u,o=y,!(y=y[g=p<<2|h<<1|l]))return o[g]=v,e;if(c=+e._x.call(null,y.data),d=+e._y.call(null,y.data),f=+e._z.call(null,y.data),t===c&&n===d&&r===f)return v.next=y,o?o[g]=v:e._root=v,e;do{o=o?o[g]=new Array(8):e._root=new Array(8),(l=t>=(a=(b+w)/2))?b=a:w=a,(h=n>=(s=(E+x)/2))?E=s:x=s,(p=r>=(u=(_+A)/2))?_=u:A=u}while((g=p<<2|h<<1|l)==(m=(f>=u)<<2|(d>=s)<<1|c>=a));return o[m]=y,o[g]=v,e}function q(e,t,n,r,i,o,a){this.node=e,this.x0=t,this.y0=n,this.z0=r,this.x1=i,this.y1=o,this.z1=a}function Z(e){return e[0]}function Q(e){return e[1]}function J(e){return e[2]}function $(e,t,n,r){var i=new ee(null==t?Z:t,null==n?Q:n,null==r?J:r,NaN,NaN,NaN,NaN,NaN,NaN);return null==e?i:i.addAll(e)}function ee(e,t,n,r,i,o,a,s,u){this._x=e,this._y=t,this._z=n,this._x0=r,this._y0=i,this._z0=o,this._x1=a,this._y1=s,this._z1=u,this._root=void 0}function te(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}Y.copy=function(){var e,t,n=new H(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=X(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var i=0;i<4;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=new Array(4)}):r.target[i]=X(t));return n},Y.add=function(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return F(this.cover(t,n),t,n,e)},Y.addAll=function(e){var t,n,r,i,o=e.length,a=new Array(o),s=new Array(o),u=1/0,c=1/0,d=-1/0,f=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(i=+this._y.call(null,t))||(a[n]=r,s[n]=i,r<u&&(u=r),r>d&&(d=r),i<c&&(c=i),i>f&&(f=i));if(u>d||c>f)return this;for(this.cover(u,c).cover(d,f),n=0;n<o;++n)F(this,a[n],s[n],e[n]);return this},Y.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var a,s,u=i-n||1,c=this._root;n>e||e>=i||r>t||t>=o;)switch(s=(t<r)<<1|e<n,(a=new Array(4))[s]=c,c=a,u*=2,s){case 0:i=n+u,o=r+u;break;case 1:n=i-u,o=r+u;break;case 2:i=n+u,r=o-u;break;case 3:n=i-u,r=o-u}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},Y.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},Y.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Y.find=function(e,t,n){var r,i,o,a,s,u,c,d=this._x0,f=this._y0,l=this._x1,h=this._y1,p=[],g=this._root;for(g&&p.push(new B(g,d,f,l,h)),null==n?n=1/0:(d=e-n,f=t-n,l=e+n,h=t+n,n*=n);u=p.pop();)if(!(!(g=u.node)||(i=u.x0)>l||(o=u.y0)>h||(a=u.x1)<d||(s=u.y1)<f))if(g.length){var m=(i+a)/2,y=(o+s)/2;p.push(new B(g[3],m,y,a,s),new B(g[2],i,y,m,s),new B(g[1],m,o,a,y),new B(g[0],i,o,m,y)),(c=(t>=y)<<1|e>=m)&&(u=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=u)}else{var v=e-+this._x.call(null,g.data),b=t-+this._y.call(null,g.data),E=v*v+b*b;if(E<n){var _=Math.sqrt(n=E);d=e-_,f=t-_,l=e+_,h=t+_,r=g.data}}return r},Y.remove=function(e){if(isNaN(o=+this._x.call(null,e))||isNaN(a=+this._y.call(null,e)))return this;var t,n,r,i,o,a,s,u,c,d,f,l,h=this._root,p=this._x0,g=this._y0,m=this._x1,y=this._y1;if(!h)return this;if(h.length)for(;;){if((c=o>=(s=(p+m)/2))?p=s:m=s,(d=a>=(u=(g+y)/2))?g=u:y=u,t=h,!(h=h[f=d<<1|c]))return this;if(!h.length)break;(t[f+1&3]||t[f+2&3]||t[f+3&3])&&(n=t,l=f)}for(;h.data!==e;)if(r=h,!(h=h.next))return this;return(i=h.next)&&delete h.next,r?(i?r.next=i:delete r.next,this):t?(i?t[f]=i:delete t[f],(h=t[0]||t[1]||t[2]||t[3])&&h===(t[3]||t[2]||t[1]||t[0])&&!h.length&&(n?n[l]=h:this._root=h),this):(this._root=i,this)},Y.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},Y.root=function(){return this._root},Y.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},Y.visit=function(e){var t,n,r,i,o,a,s=[],u=this._root;for(u&&s.push(new B(u,this._x0,this._y0,this._x1,this._y1));t=s.pop();)if(!e(u=t.node,r=t.x0,i=t.y0,o=t.x1,a=t.y1)&&u.length){var c=(r+o)/2,d=(i+a)/2;(n=u[3])&&s.push(new B(n,c,d,o,a)),(n=u[2])&&s.push(new B(n,r,d,c,a)),(n=u[1])&&s.push(new B(n,c,i,o,d)),(n=u[0])&&s.push(new B(n,r,i,c,d))}return this},Y.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new B(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var i=t.node;if(i.length){var o,a=t.x0,s=t.y0,u=t.x1,c=t.y1,d=(a+u)/2,f=(s+c)/2;(o=i[0])&&n.push(new B(o,a,s,d,f)),(o=i[1])&&n.push(new B(o,d,s,u,f)),(o=i[2])&&n.push(new B(o,a,f,d,c)),(o=i[3])&&n.push(new B(o,d,f,u,c))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},Y.x=function(e){return arguments.length?(this._x=e,this):this._x},Y.y=function(e){return arguments.length?(this._y=e,this):this._y};var ne=$.prototype=ee.prototype;function re(e){var t=0,n=0,r=0,i=0,o=e.length;if(o){for(var a=0;a<o;a++)(s=e[a])&&s.weight&&(t+=s.weight,n+=s.x*s.weight,r+=s.y*s.weight,i+=s.z*s.weight);e.x=n/t,e.y=r/t,e.z=i/t,e.weight=t}else{var s=e;e.x=s.data.x,e.y=s.data.y,e.z=s.data.z,e.weight=s.data.weight}}ne.copy=function(){var e,t,n=new ee(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),r=this._root;if(!r)return n;if(!r.length)return n._root=te(r),n;for(e=[{source:r,target:n._root=new Array(8)}];r=e.pop();)for(var i=0;i<8;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=new Array(8)}):r.target[i]=te(t));return n},ne.add=function(e){const t=+this._x.call(null,e),n=+this._y.call(null,e),r=+this._z.call(null,e);return K(this.cover(t,n,r),t,n,r,e)},ne.addAll=function(e){Array.isArray(e)||(e=Array.from(e));const t=e.length,n=new Float64Array(t),r=new Float64Array(t),i=new Float64Array(t);let o=1/0,a=1/0,s=1/0,u=-1/0,c=-1/0,d=-1/0;for(let f,l,h,p,g=0;g<t;++g)isNaN(l=+this._x.call(null,f=e[g]))||isNaN(h=+this._y.call(null,f))||isNaN(p=+this._z.call(null,f))||(n[g]=l,r[g]=h,i[g]=p,l<o&&(o=l),l>u&&(u=l),h<a&&(a=h),h>c&&(c=h),p<s&&(s=p),p>d&&(d=p));if(o>u||a>c||s>d)return this;this.cover(o,a,s).cover(u,c,d);for(let o=0;o<t;++o)K(this,n[o],r[o],i[o],e[o]);return this},ne.cover=function(e,t,n){if(isNaN(e=+e)||isNaN(t=+t)||isNaN(n=+n))return this;var r=this._x0,i=this._y0,o=this._z0,a=this._x1,s=this._y1,u=this._z1;if(isNaN(r))a=(r=Math.floor(e))+1,s=(i=Math.floor(t))+1,u=(o=Math.floor(n))+1;else{for(var c,d,f=a-r||1,l=this._root;r>e||e>=a||i>t||t>=s||o>n||n>=u;)switch(d=(n<o)<<2|(t<i)<<1|e<r,(c=new Array(8))[d]=l,l=c,f*=2,d){case 0:a=r+f,s=i+f,u=o+f;break;case 1:r=a-f,s=i+f,u=o+f;break;case 2:a=r+f,i=s-f,u=o+f;break;case 3:r=a-f,i=s-f,u=o+f;break;case 4:a=r+f,s=i+f,o=u-f;break;case 5:r=a-f,s=i+f,o=u-f;break;case 6:a=r+f,i=s-f,o=u-f;break;case 7:r=a-f,i=s-f,o=u-f}this._root&&this._root.length&&(this._root=l)}return this._x0=r,this._y0=i,this._z0=o,this._x1=a,this._y1=s,this._z1=u,this},ne.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},ne.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1],+e[0][2]).cover(+e[1][0],+e[1][1],+e[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},ne.find=function(e,t,n,r){var i,o,a,s,u,c,d,f,l,h=this._x0,p=this._y0,g=this._z0,m=this._x1,y=this._y1,v=this._z1,b=[],E=this._root;for(E&&b.push(new q(E,h,p,g,m,y,v)),null==r?r=1/0:(h=e-r,p=t-r,g=n-r,m=e+r,y=t+r,v=n+r,r*=r);f=b.pop();)if(!(!(E=f.node)||(o=f.x0)>m||(a=f.y0)>y||(s=f.z0)>v||(u=f.x1)<h||(c=f.y1)<p||(d=f.z1)<g))if(E.length){var _=(o+u)/2,w=(a+c)/2,x=(s+d)/2;b.push(new q(E[7],_,w,x,u,c,d),new q(E[6],o,w,x,_,c,d),new q(E[5],_,a,x,u,w,d),new q(E[4],o,a,x,_,w,d),new q(E[3],_,w,s,u,c,x),new q(E[2],o,w,s,_,c,x),new q(E[1],_,a,s,u,w,x),new q(E[0],o,a,s,_,w,x)),(l=(n>=x)<<2|(t>=w)<<1|e>=_)&&(f=b[b.length-1],b[b.length-1]=b[b.length-1-l],b[b.length-1-l]=f)}else{var A=e-+this._x.call(null,E.data),T=t-+this._y.call(null,E.data),S=n-+this._z.call(null,E.data),N=A*A+T*T+S*S;if(N<r){var D=Math.sqrt(r=N);h=e-D,p=t-D,g=n-D,m=e+D,y=t+D,v=n+D,i=E.data}}return i},ne.remove=function(e){if(isNaN(o=+this._x.call(null,e))||isNaN(a=+this._y.call(null,e))||isNaN(s=+this._z.call(null,e)))return this;var t,n,r,i,o,a,s,u,c,d,f,l,h,p,g,m=this._root,y=this._x0,v=this._y0,b=this._z0,E=this._x1,_=this._y1,w=this._z1;if(!m)return this;if(m.length)for(;;){if((f=o>=(u=(y+E)/2))?y=u:E=u,(l=a>=(c=(v+_)/2))?v=c:_=c,(h=s>=(d=(b+w)/2))?b=d:w=d,t=m,!(m=m[p=h<<2|l<<1|f]))return this;if(!m.length)break;(t[p+1&7]||t[p+2&7]||t[p+3&7]||t[p+4&7]||t[p+5&7]||t[p+6&7]||t[p+7&7])&&(n=t,g=p)}for(;m.data!==e;)if(r=m,!(m=m.next))return this;return(i=m.next)&&delete m.next,r?(i?r.next=i:delete r.next,this):t?(i?t[p]=i:delete t[p],(m=t[0]||t[1]||t[2]||t[3]||t[4]||t[5]||t[6]||t[7])&&m===(t[7]||t[6]||t[5]||t[4]||t[3]||t[2]||t[1]||t[0])&&!m.length&&(n?n[g]=m:this._root=m),this):(this._root=i,this)},ne.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},ne.root=function(){return this._root},ne.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},ne.visit=function(e){var t,n,r,i,o,a,s,u,c=[],d=this._root;for(d&&c.push(new q(d,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=c.pop();)if(!e(d=t.node,r=t.x0,i=t.y0,o=t.z0,a=t.x1,s=t.y1,u=t.z1)&&d.length){var f=(r+a)/2,l=(i+s)/2,h=(o+u)/2;(n=d[7])&&c.push(new q(n,f,l,h,a,s,u)),(n=d[6])&&c.push(new q(n,r,l,h,f,s,u)),(n=d[5])&&c.push(new q(n,f,i,h,a,l,u)),(n=d[4])&&c.push(new q(n,r,i,h,f,l,u)),(n=d[3])&&c.push(new q(n,f,l,o,a,s,h)),(n=d[2])&&c.push(new q(n,r,l,o,f,s,h)),(n=d[1])&&c.push(new q(n,f,i,o,a,l,h)),(n=d[0])&&c.push(new q(n,r,i,o,f,l,h))}return this},ne.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new q(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=n.pop();){var i=t.node;if(i.length){var o,a=t.x0,s=t.y0,u=t.z0,c=t.x1,d=t.y1,f=t.z1,l=(a+c)/2,h=(s+d)/2,p=(u+f)/2;(o=i[0])&&n.push(new q(o,a,s,u,l,h,p)),(o=i[1])&&n.push(new q(o,l,s,u,c,h,p)),(o=i[2])&&n.push(new q(o,a,h,u,l,d,p)),(o=i[3])&&n.push(new q(o,l,h,u,c,d,p)),(o=i[4])&&n.push(new q(o,a,s,p,l,h,f)),(o=i[5])&&n.push(new q(o,l,s,p,c,h,f)),(o=i[6])&&n.push(new q(o,a,h,p,l,d,f)),(o=i[7])&&n.push(new q(o,l,h,p,c,d,f))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.z0,t.x1,t.y1,t.z1);return this},ne.x=function(e){return arguments.length?(this._x=e,this):this._x},ne.y=function(e){return arguments.length?(this._y=e,this):this._y},ne.z=function(e){return arguments.length?(this._z=e,this):this._z};var ie=function(e,t,n,r,i,o,a){var s=[n,r,i][a-1],u=o.x-e.x||.1,c=o.y-e.y||.1,d=o.z-e.z||.1,f=s-t,l=u*u+c*c+d*d,h=Math.sqrt(l)*l;if(f*f*.81<l){var p=e.weight/h;return o.vx+=u*p,o.vy+=c*p,o.vz+=d*p,!0}if(e.length)return!1;e.data!==o&&(p=e.data.weight/h,o.vx+=u*p,o.vy+=c*p,o.vz+=d*p)},oe={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},ae=function(){function e(e){void 0===e&&(e={}),this.options=e,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=r(r({},oe),e)}return e.prototype.execute=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){return[2,this.genericForceLayout(!1,e,t)]}))}))},e.prototype.assign=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){return this.genericForceLayout(!0,e,t),[2]}))}))},e.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},e.prototype.tick=function(e){var t=this;if(void 0===e&&(e=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var n=0;(this.judgingDistance>this.lastOptions.minMovement||n<1)&&n<e;n++)this.runOneStep(this.lastCalcGraph,this.lastGraph,n,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var r={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&r.nodes.forEach((function(e){return t.lastGraph.mergeNodeData(e.id,{x:e.data.x,y:e.data.y,z:3===t.options.dimensions?e.data.z:void 0})})),r},e.prototype.genericForceLayout=function(e,t,n){return i(this,void 0,void 0,(function(){var i,a,s,u,d,f,l,h,p,m,y,v,b,E,_,w,x,A,T,S,N=this;return o(this,(function(o){return i=r(r({},this.options),n),a=t.getAllNodes(),s=t.getAllEdges(),u=this.formatOptions(i,t),d=u.dimensions,f=u.width,l=u.height,h=u.nodeSize,p=u.getMass,m=u.nodeStrength,y=u.edgeStrength,v=u.linkDistance,b=a.map((function(e,t){return r(r({},e),{data:r(r({},e.data),{x:c(e.data.x)?e.data.x:Math.random()*f,y:c(e.data.y)?e.data.y:Math.random()*l,z:c(e.data.z)?e.data.z:Math.random()*Math.sqrt(f*l),size:h(e)||30,mass:p(e),nodeStrength:m(e)})})})),E=s.map((function(e){return r(r({},e),{data:r(r({},e.data),{edgeStrength:y(e),linkDistance:v(e,t.getNode(e.source),t.getNode(e.target))})})})),(null==a?void 0:a.length)?(_={},a.forEach((function(e,t){_[e.id]={x:0,y:0,z:0}})),w=new g({nodes:b,edges:E}),this.formatCentripetal(u,w),x=u.maxIteration,A=u.minMovement,T=u.onTick,this.lastLayoutNodes=b,this.lastLayoutEdges=E,this.lastAssign=e,this.lastGraph=t,this.lastCalcGraph=w,this.lastOptions=u,this.lastVelMap=_,"undefined"==typeof window?[2]:(S=0,[2,new Promise((function(n){N.timeInterval=window.setInterval((function(){a&&N.running||n({nodes:fe(t,b),edges:s}),N.runOneStep(w,t,S,_,u),N.updatePosition(t,w,_,u),e&&b.forEach((function(e){return t.mergeNodeData(e.id,{x:e.data.x,y:e.data.y,z:3===d?e.data.z:void 0})})),null==T||T({nodes:fe(t,b),edges:s}),(++S>=x||N.judgingDistance<A)&&(window.clearInterval(N.timeInterval),n({nodes:fe(t,b),edges:s}))}),0),N.running=!0}))])):(this.lastResult={nodes:[],edges:s},[2,{nodes:[],edges:s}])}))}))},e.prototype.formatOptions=function(e,t){var n=e,r=e.width,i=e.height,o=e.getMass;if(n.width=r||"undefined"==typeof window?r:window.innerWidth,n.height=i||"undefined"==typeof window?i:window.innerHeight,e.center||(n.center=[n.width/2,n.height/2]),o||(n.getMass=function(e){var n=1;c(null==e?void 0:e.data.mass)&&(n=null==e?void 0:e.data.mass);var r=t.getDegree(e.id,"both");return!r||r<5?n:5*r*n}),e.preventOverlap){var a=z(0,e.nodeSpacing);e.nodeSize?v(e.nodeSize)?n.nodeSize=function(t){var n=e.nodeSize;return Math.max(n[0],n[1])+a(t)}:n.nodeSize=function(t){return e.nodeSize+a(t)}:n.nodeSize=function(e){var t=((null==e?void 0:e.data)||{}).size;return t?v(t)?Math.max(t[0],t[1])+a(e):d(t)?Math.max(t.width,t.height)+a(e):t+a(e):10+a(e)}}return n.linkDistance=e.linkDistance?z(1,e.linkDistance):function(e){return 1+n.nodeSize(t.getNode(e.source))+n.nodeSize(t.getNode(e.target))},n.nodeStrength=z(1,e.nodeStrength),n.edgeStrength=z(1,e.edgeStrength),e},e.prototype.formatCentripetal=function(e,t){var n,r=e.dimensions,i=e.centripetalOptions,o=e.center,a=e.clusterNodeStrength,s=e.leafCluster,u=e.clustering,c=e.nodeClusterBy,d=t.getAllNodes(),f=i||{leaf:2,single:2,others:1,center:function(e){return{x:o[0],y:o[1],z:3===r?o[2]:void 0}}};"function"!=typeof a&&(e.clusterNodeStrength=function(e){return a});var l=[];if(s&&c&&(n=se(t,c),l=Array.from(new Set(null==d?void 0:d.map((function(e){return e.data[c]}))))||[],e.centripetalOptions=Object.assign(f,{single:100,leaf:function(t){var r=n[t.id]||{},i=r.siblingLeaves,o=r.sameTypeLeaves;return(null==o?void 0:o.length)===(null==i?void 0:i.length)||1===(null==l?void 0:l.length)?1:e.clusterNodeStrength(t)},others:1,center:function(e){var r,i=t.getDegree(e.id,"both");if(!i)return{x:100,y:100,z:0};if(1===i){var o=(n[e.id]||{}).sameTypeLeaves,a=void 0===o?[]:o;1===a.length?r=void 0:a.length>1&&(r=de(a))}else r=void 0;return{x:null==r?void 0:r.x,y:null==r?void 0:r.y,z:null==r?void 0:r.z}}})),u&&c){n||(n=se(t,c)),l||(l=Array.from(new Set(d.map((function(e){return e.data[c]}))))),l=l.filter((function(e){return void 0!==e}));var h={};l.forEach((function(e){var n=d.filter((function(t){return t.data[c]===e})).map((function(e){return t.getNode(e.id)}));h[e]=de(n)})),e.centripetalOptions=Object.assign(f,{single:function(t){return e.clusterNodeStrength(t)},leaf:function(t){return e.clusterNodeStrength(t)},others:function(t){return e.clusterNodeStrength(t)},center:function(e){var t=h[e.data[c]];return{x:null==t?void 0:t.x,y:null==t?void 0:t.y,z:null==t?void 0:t.z}}})}var p=e.centripetalOptions||{},g=p.leaf,m=p.single,y=p.others;g&&"function"!=typeof g&&(e.centripetalOptions.leaf=function(){return g}),m&&"function"!=typeof m&&(e.centripetalOptions.single=function(){return m}),y&&"function"!=typeof y&&(e.centripetalOptions.others=function(){return y})},e.prototype.runOneStep=function(e,t,n,r,i){var o={},a=e.getAllNodes(),s=e.getAllEdges();if(null==a?void 0:a.length){var u=i.monitor;this.calRepulsive(e,o,i),s&&this.calAttractive(e,o,i),this.calGravity(e,t,o,i),this.updateVelocity(e,o,r,i),u&&u({energy:this.calTotalEnergy(o,a),nodes:t.getAllNodes(),edges:t.getAllEdges(),iterations:n})}},e.prototype.calTotalEnergy=function(e,t){var n=this;if(!(null==t?void 0:t.length))return 0;var r=0;return t.forEach((function(t,i){var o=e[t.id].x,a=e[t.id].y,s=3===n.options.dimensions?e[t.id].z:0,u=o*o+a*a+s*s,c=t.data.mass;r+=(void 0===c?1:c)*u*.5})),r},e.prototype.calRepulsive=function(e,t,n){var r=n.dimensions,i=n.factor,o=n.coulombDisScale;!function(e,t,n,r,i){var o=t/n,a=e.getAllNodes(),s=a.map((function(e,t){var n=e.data,r=n.nodeStrength;return{x:n.x,y:n.y,z:n.z,size:n.size,index:t,vx:0,vy:0,vz:0,weight:o*r}})),u=(2===i?W(s,(function(e){return e.x}),(function(e){return e.y})):$(s,(function(e){return e.x}),(function(e){return e.y}),(function(e){return e.z}))).visitAfter(re);s.forEach((function(e){!function(e,t,n){t.visit((function(t,r,i,o,a){return ie(t,r,i,o,a,e,n)}))}(e,u,i)})),s.map((function(e,t){var n=a[t],i=n.id,o=n.data.mass,s=void 0===o?1:o;r[i]={x:e.vx/s,y:e.vy/s,z:e.vz/s}}))}(e,i,o*o,t,r)},e.prototype.calAttractive=function(e,t,n){var r=n.dimensions;e.getAllEdges().forEach((function(n,i){var o=n.source,a=n.target,s=e.getNode(o),u=e.getNode(a);if(s&&u){var c=u.data.x-s.data.x,d=u.data.y-s.data.y,f=3===r?u.data.z-s.data.z:0;c||d||(c=.01*Math.random(),d=.01*Math.random(),3!==r||f||(f=.01*Math.random()));var l=Math.sqrt(c*c+d*d+f*f),h=c/l,p=d/l,g=f/l,m=n.data||{},y=m.linkDistance,v=void 0===y?200:y,b=m.edgeStrength,E=(v-l)*(void 0===b?200:b),_=1/(s.data.mass||1),w=1/(u.data.mass||1),x=h*E,A=p*E,T=g*E;t[o].x-=x*_,t[o].y-=A*_,t[o].z-=T*_,t[a].x+=x*w,t[a].y+=A*w,t[a].z+=T*w}}))},e.prototype.calGravity=function(e,t,n,r){var i=r.getCenter,o=e.getAllNodes(),s=t.getAllNodes(),u=t.getAllEdges(),d=r.width,f=r.height,l=r.center,h=r.gravity,p=r.centripetalOptions;o&&o.forEach((function(r){var o=r.id,g=r.data,m=g.mass,y=g.x,v=g.y,b=g.z,E=t.getNode(o),_=0,w=0,x=0,A=h,T=e.getDegree(o,"in"),S=e.getDegree(o,"out"),N=e.getDegree(o,"both"),D=null==i?void 0:i(E,N);if(D){var I=a(D,3);_=y-I[0],w=v-I[1],A=I[2]}else _=y-l[0],w=v-l[1],x=b-l[2];if(A&&(n[o].x-=A*_/m,n[o].y-=A*w/m,n[o].z-=A*x/m),p){var R=p.leaf,k=p.single,O=p.others,C=p.center,L=(null==C?void 0:C(E,s,u,d,f))||{x:0,y:0,z:0,centerStrength:0},G=L.x,M=L.y,U=L.z,P=L.centerStrength;if(!c(G)||!c(M))return;var z=(y-G)/m,F=(v-M)/m,B=(b-U)/m;if(P&&(n[o].x-=P*z,n[o].y-=P*F,n[o].z-=P*B),0===N){var j=k(E);if(!j)return;return n[o].x-=j*z,n[o].y-=j*F,void(n[o].z-=j*B)}if(0===T||0===S){var V=R(E,s,u);if(!V)return;return n[o].x-=V*z,n[o].y-=V*F,void(n[o].z-=V*B)}var W=O(E);if(!W)return;n[o].x-=W*z,n[o].y-=W*F,n[o].z-=W*B}}))},e.prototype.updateVelocity=function(e,t,n,r){var i=r.damping,o=r.maxSpeed,a=r.interval,s=r.dimensions,u=e.getAllNodes();(null==u?void 0:u.length)&&u.forEach((function(e){var r=e.id,u=(n[r].x+t[r].x*a)*i||.01,c=(n[r].y+t[r].y*a)*i||.01,d=3===s?(n[r].z+t[r].z*a)*i||.01:0,f=Math.sqrt(u*u+c*c+d*d);if(f>o){var l=o/f;u*=l,c*=l,d*=l}n[r]={x:u,y:c,z:d}}))},e.prototype.updatePosition=function(e,t,n,r){var i=this,o=r.distanceThresholdMode,a=r.interval,s=r.dimensions,u=t.getAllNodes();if(null==u?void 0:u.length){var d=0;"max"===o?this.judgingDistance=-1/0:"min"===o&&(this.judgingDistance=1/0),u.forEach((function(r){var u=r.id,f=e.getNode(u);if(c(f.data.fx)&&c(f.data.fy))t.mergeNodeData(u,{x:f.data.fx,y:f.data.fy,z:3===s?f.data.fz:void 0});else{var l=n[u].x*a,h=n[u].y*a,p=3===s?n[u].z*a:0;t.mergeNodeData(u,{x:r.data.x+l,y:r.data.y+h,z:r.data.z+p});var g=Math.sqrt(l*l+h*h+p*p);switch(o){case"max":i.judgingDistance<g&&(i.judgingDistance=g);break;case"min":i.judgingDistance>g&&(i.judgingDistance=g);break;default:d+=g}}})),o&&"mean"!==o||(this.judgingDistance=d/u.length)}else this.judgingDistance=0},e}(),se=function(e,t){var n=e.getAllNodes();if(!(null==n?void 0:n.length))return{};var r={};return n.forEach((function(n,i){1===e.getDegree(n.id,"both")&&(r[n.id]=ue(e,"leaf",n,t))})),r},ue=function(e,t,n,r){var i=e.getDegree(n.id,"in"),o=e.getDegree(n.id,"out"),a=n,s=[];return 0===i?(a=e.getSuccessors(n.id)[0],s=e.getNeighbors(a.id)):0===o&&(a=e.getPredecessors(n.id)[0],s=e.getNeighbors(a.id)),s=s.filter((function(t){return 0===e.getDegree(t.id,"in")||0===e.getDegree(t.id,"out")})),{coreNode:a,siblingLeaves:s,sameTypeLeaves:ce(e,t,r,n,s)}},ce=function(e,t,n,r,i){var o=r.data[n]||"",a=(null==i?void 0:i.filter((function(e){return e.data[n]===o})))||[];return"leaf"===t&&(a=a.filter((function(t){return 0===e.getDegree(t.id,"in")||0===e.getDegree(t.id,"out")}))),a},de=function(e){var t={x:0,y:0};e.forEach((function(e){var n=e.data,r=n.x,i=n.y;t.x+=r||0,t.y+=i||0}));var n=e.length||1;return{x:t.x/n,y:t.y/n}},fe=function(e,t){return t.map((function(t){var n=t.id,i=t.data,o=e.getNode(n);return r(r({},o),{data:r(r({},o.data),{x:i.x,y:i.y,z:i.z})})}))},le={maxIteration:500,gravity:10,factor:1,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:500,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean",maxDistance:1/0},he=function(){function e(e){void 0===e&&(e={}),this.options=e,this.id="forceWASM",this.options=r(r({},le),e)}return e.prototype.execute=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){return[2,this.genericForceLayout(!1,e,t)]}))}))},e.prototype.assign=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){return this.genericForceLayout(!0,e,t),[2]}))}))},e.prototype.genericForceLayout=function(e,t,n){return i(this,void 0,void 0,(function(){var i,a,s,u,d,f,l,h,p,g,m,v,b,E,_,w,x,A,T,S,N,R,k,O;return o(this,(function(o){switch(o.label){case 0:return i=this.formatOptions(n),a=i.threads,s=i.dimensions,u=i.width,d=i.height,f=i.center,l=i.maxIteration,h=i.minMovement,p=i.distanceThresholdMode,g=i.gravity,m=i.factor,v=i.interval,b=i.damping,E=i.maxSpeed,_=i.edgeStrength,w=i.linkDistance,x=i.nodeStrength,A=i.coulombDisScale,T=i.maxDistance,S=t.getAllNodes(),N=t.getAllEdges(),(null==S?void 0:S.length)?1===S.length?(e&&t.mergeNodeData(S[0].id,{x:f[0],y:f[1],z:3===s?f[2]:void 0}),[2,{nodes:[r(r({},S[0]),{data:r(r({},S[0].data),{x:f[0],y:f[1],z:3===s?f[2]:void 0})})],edges:N}]):((R=S.map((function(e){return y(e,[u,d])}))).forEach((function(e){c(e.data.x)||(e.data.x=Math.random()*u),c(e.data.y)||(e.data.y=Math.random()*d),3===s&&(c(e.data.z)||(e.data.z=Math.random()*Math.sqrt(u*d)))})),k=D(R,N,s),[4,a.force2({dimensions:s,nodes:k.nodes,edges:k.edges,masses:k.masses,weights:k.weights,iterations:l,min_movement:h,distance_threshold_mode:I(p),center:f,edge_strength:_,link_distance:w,node_strength:x,coulomb_dis_scale:A,kg:g,factor:m,interval:v,damping:b,max_speed:E,max_distance:T})]):[2,{nodes:[],edges:N}];case 1:return O=o.sent().nodes,R.forEach((function(e,t){e.data.x=O[s*t],e.data.y=O[s*t+1],3===s&&(e.data.z=O[s*t+2])})),e&&R.forEach((function(e){var n=e.id,r=e.data,i={x:r.x,y:r.y};3===s&&(i.z=r.z),t.mergeNodeData(n,i)})),[2,{nodes:R,edges:N}]}}))}))},e.prototype.formatOptions=function(e){void 0===e&&(e={});var t=r(r({},this.options),e),n=t.center,i=t.width,o=t.height;return t.width=i||"undefined"==typeof window?i:window.innerWidth,t.height=o||"undefined"==typeof window?o:window.innerHeight,t.center=n||[t.width/2,t.height/2],t},e}(),pe=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},ge=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};function me(e,t){var n=t.iterations,r=t.min_movement,i=t.distance_threshold_mode;return pe(this,void 0,void 0,(function(){return ge(this,(function(t){switch(t.label){case 0:return[4,new ae({dimensions:2,factor:1,gravity:10,linkDistance:200,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:1e3,minMovement:r,interval:.02,preventOverlap:!0,distanceThresholdMode:i,maxIteration:n||100,width:C,height:C,center:[400,400]}).execute(e)];case 1:return[2,N(t.sent())]}}))}))}function ye(e,t,n){var r=t.iterations,i=t.min_movement,o=t.distance_threshold_mode;return pe(this,void 0,void 0,(function(){return ge(this,(function(t){switch(t.label){case 0:return[4,new he({threads:n,dimensions:2,maxIteration:r||100,minMovement:i,distanceThresholdMode:o,height:C,width:C,center:[400,400],factor:1,gravity:10,linkDistance:200,edgeStrength:200,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:1e3,interval:.02}).execute(e)];case 1:return[2,N(t.sent())]}}))}))}var ve={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},be=function(){function e(e){void 0===e&&(e={}),this.options=e,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=r(r({},ve),e)}return e.prototype.execute=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){return[2,this.genericFruchtermanLayout(!1,e,t)]}))}))},e.prototype.assign=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){return this.genericFruchtermanLayout(!0,e,t),[2]}))}))},e.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},e.prototype.tick=function(e){var t=this;if(void 0===e&&(e=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var n=0;n<e;n++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var r={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&r.nodes.forEach((function(e){return t.lastGraph.mergeNodeData(e.id,{x:e.data.x,y:e.data.y,z:3===t.options.dimensions?e.data.z:void 0})})),r},e.prototype.genericFruchtermanLayout=function(e,t,n){return i(this,void 0,void 0,(function(){var i,a,s,u,c,d,f,l,h,p,m,v,b,E,_,w,x=this;return o(this,(function(o){return this.running?[2]:(i=this.formatOptions(n),a=i.dimensions,s=i.width,u=i.height,c=i.center,d=i.clustering,f=i.nodeClusterBy,l=i.maxIteration,h=i.onTick,p=t.getAllNodes(),m=t.getAllEdges(),(null==p?void 0:p.length)?1===p.length?(e&&t.mergeNodeData(p[0].id,{x:c[0],y:c[1],z:3===a?c[2]:void 0}),v={nodes:[r(r({},p[0]),{data:r(r({},p[0].data),{x:c[0],y:c[1],z:3===a?c[2]:void 0})})],edges:m},this.lastResult=v,[2,v]):(b=p.map((function(e){return y(e,[s,u])})),E=new g({nodes:b,edges:m}),_={},d&&b.forEach((function(e){var t=e.data[f];_[t]||(_[t]={name:t,cx:0,cy:0,count:0})})),this.lastLayoutNodes=b,this.lastLayoutEdges=m,this.lastAssign=e,this.lastGraph=E,this.lastOptions=i,this.lastClusterMap=_,"undefined"==typeof window?[2]:(w=0,[2,new Promise((function(n){x.timeInterval=window.setInterval((function(){x.running?(x.runOneStep(E,_,i),e&&b.forEach((function(e){var n=e.id,r=e.data;return t.mergeNodeData(n,{x:r.x,y:r.y,z:3===a?r.z:void 0})})),null==h||h({nodes:b,edges:m}),++w>=l&&(window.clearInterval(x.timeInterval),n({nodes:b,edges:m}))):n({nodes:b,edges:m})}),0),x.running=!0}))])):(v={nodes:[],edges:m},this.lastResult=v,[2,v]))}))}))},e.prototype.formatOptions=function(e){void 0===e&&(e={});var t=r(r({},this.options),e),n=t.clustering,i=t.nodeClusterBy,o=t.center,a=t.width,s=t.height;return t.width=a||"undefined"==typeof window?a:window.innerWidth,t.height=s||"undefined"==typeof window?s:window.innerHeight,t.center=o||[t.width/2,t.height/2],t.clustering=n&&!!i,t},e.prototype.runOneStep=function(e,t,n){var r=n.dimensions,i=n.height,o=n.width,a=n.gravity,s=n.center,u=n.speed,d=n.clustering,f=n.nodeClusterBy,l=n.clusterGravity,h=i*o,p=Math.sqrt(h)/10,g=e.getAllNodes(),m=h/(g.length+1),y=Math.sqrt(m),v={};if(this.applyCalculate(e,v,y,m),d){for(var b in t)t[b].cx=0,t[b].cy=0,t[b].count=0;for(var b in g.forEach((function(e){var n=e.data,r=t[n[f]];c(n.x)&&(r.cx+=n.x),c(n.y)&&(r.cy+=n.y),r.count++})),t)t[b].cx/=t[b].count,t[b].cy/=t[b].count;var E=l||a;g.forEach((function(e,n){var r=e.id,i=e.data;if(c(i.x)&&c(i.y)){var o=t[i[f]],a=Math.sqrt((i.x-o.cx)*(i.x-o.cx)+(i.y-o.cy)*(i.y-o.cy)),s=y*E;v[r].x-=s*(i.x-o.cx)/a,v[r].y-=s*(i.y-o.cy)/a}}))}g.forEach((function(e,t){var n=e.id,i=e.data;if(c(i.x)&&c(i.y)){var o=.01*y*a;v[n].x-=o*(i.x-s[0]),v[n].y-=o*(i.y-s[1]),3===r&&(v[n].z-=o*(i.z-s[2]))}})),g.forEach((function(t,n){var i=t.id,o=t.data;if(c(o.fx)&&c(o.fy))return o.x=o.fx,o.y=o.fy,void(3===r&&(o.z=o.fz));if(c(o.x)&&c(o.y)){var a=Math.sqrt(v[i].x*v[i].x+v[i].y*v[i].y+(3===r?v[i].z*v[i].z:0));if(a>0){var s=Math.min(p*(u/800),a);e.mergeNodeData(i,{x:o.x+v[i].x/a*s,y:o.y+v[i].y/a*s,z:3===r?o.z+v[i].z/a*s:void 0})}}}))},e.prototype.applyCalculate=function(e,t,n,r){this.calRepulsive(e,t,r),this.calAttractive(e,t,n)},e.prototype.calRepulsive=function(e,t,n){var r=this,i=e.getAllNodes();i.forEach((function(e,o){var a=e.data,s=e.id;t[s]={x:0,y:0,z:0},i.forEach((function(e,i){var u=e.data,d=e.id;if(!(o<=i)&&c(a.x)&&c(u.x)&&c(a.y)&&c(u.y)){var f=a.x-u.x,l=a.y-u.y,h=3===r.options.dimensions?a.z-u.z:0,p=f*f+l*l+h*h;0===p&&(p=1,f=.01,l=.01,h=.01);var g=n/p,m=f*g,y=l*g,v=h*g;t[s].x+=m,t[s].y+=y,t[d].x-=m,t[d].y-=y,3===r.options.dimensions&&(t[s].z+=v,t[d].z-=v)}}))}))},e.prototype.calAttractive=function(e,t,n){var r=this;e.getAllEdges().forEach((function(i){var o=i.source,a=i.target;if(o&&a&&o!==a){var s=e.getNode(o).data,u=e.getNode(a).data;if(c(u.x)&&c(s.x)&&c(u.y)&&c(s.y)){var d=u.x-s.x,f=u.y-s.y,l=3===r.options.dimensions?u.z-s.z:0,h=Math.sqrt(d*d+f*f+l*l)/n,p=d*h,g=f*h,m=l*h;t[o].x+=p,t[o].y+=g,t[a].x-=p,t[a].y-=g,3===r.options.dimensions&&(t[o].z+=m,t[a].z-=m)}}}))},e}();function Ee(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function _e(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Ee(o,r,i,a,s,"next",e)}function s(e){Ee(o,r,i,a,s,"throw",e)}a(void 0)}))}}function we(e){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we(e)}function xe(e){var t=function(e,t){if("object"!==we(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==we(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===we(t)?t:String(t)}function Ae(e,t,n){return(t=xe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Te(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,xe(r.key),r)}}function Ne(e,t,n){return t&&Se(e.prototype,t),n&&Se(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var De,Ie=n(397),Re=n.n(Ie),ke=n(868),Oe=n.n(ke),Ce=n(744),Le=n.n(Ce),Ge=n(166),Me=n.n(Ge),Ue=1;function Pe(){return Ue++}!function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.COPY_SRC=1]="COPY_SRC",e[e.COPY_DST=2]="COPY_DST",e[e.SAMPLED=4]="SAMPLED",e[e.STORAGE=8]="STORAGE",e[e.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"}(De||(De={}));var ze,Fe,Be,je,Ve=function(){function e(){Te(this,e),this.config=void 0}return Ne(e,[{key:"get",value:function(){return this.config}},{key:"set",value:function(e){this.config=e}}]),e}();function We(){if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function He(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?He(Object(n),!0).forEach((function(t){Ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):He(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}"undefined"!=typeof navigator&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),function(e){e.Void="Void",e.Boolean="Boolean",e.Float="Float",e.Uint32="Uint32",e.Int32="Int32",e.Vector="Vector",e.Vector2Float="vec2<f32>",e.Vector3Float="vec3<f32>",e.Vector4Float="vec4<f32>",e.Vector2Boolean="vec2<bool>",e.Vector3Boolean="vec3<bool>",e.Vector4Boolean="vec4<bool>",e.Vector2Uint="vec2<u32>",e.Vector3Uint="vec3<u32>",e.Vector4Uint="vec4<u32>",e.Vector2Int="vec2<i32>",e.Vector3Int="vec3<i32>",e.Vector4Int="vec4<i32>",e.Matrix="Matrix",e.Matrix3x3Float="mat3x3<f32>",e.Matrix4x4Float="mat4x4<i32>",e.Struct="Struct",e.FloatArray="Float[]",e.Vector4FloatArray="vec4<f32>[]"}(ze||(ze={})),function(e){e.Program="Program",e.Identifier="Identifier",e.VariableDeclaration="VariableDeclaration",e.BlockStatement="BlockStatement",e.ReturnStatement="ReturnStatement",e.FunctionDeclaration="FunctionDeclaration",e.VariableDeclarator="VariableDeclarator",e.AssignmentExpression="AssignmentExpression",e.LogicalExpression="LogicalExpression",e.BinaryExpression="BinaryExpression",e.ArrayExpression="ArrayExpression",e.UnaryExpression="UnaryExpression",e.UpdateExpression="UpdateExpression",e.FunctionExpression="FunctionExpression",e.MemberExpression="MemberExpression",e.ConditionalExpression="ConditionalExpression",e.ExpressionStatement="ExpressionStatement",e.CallExpression="CallExpression",e.NumThreadStatement="NumThreadStatement",e.StorageStatement="StorageStatement",e.DoWhileStatement="DoWhileStatement",e.WhileStatement="WhileStatement",e.ForStatement="ForStatement",e.BreakStatement="BreakStatement",e.ContinueStatement="ContinueStatement",e.IfStatement="IfStatement",e.ImportedFunctionStatement="ImportedFunctionStatement"}(Fe||(Fe={})),function(e){e.Input="Input",e.Output="Output",e.Uniform="Uniform",e.Workgroup="Workgroup",e.UniformConstant="UniformConstant",e.Image="Image",e.StorageBuffer="StorageBuffer",e.Private="Private",e.Function="Function"}(Be||(Be={})),function(e){e.GLSL100="GLSL100",e.GLSL450="GLSL450",e.WGSL="WGSL"}(je||(je={}));var Ye,Ke,qe,Ze,Qe,Je,$e,et,tt,nt,rt,it,ot,at,st=function(){function e(t,n){Te(this,e),this.engine=t,this.configService=n,this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}var t,n,r;return Ne(e,[{key:"init",value:function(){var e=this.configService.get(),t=e.canvas,n=e.engineOptions;this.initPromise=this.engine.init(Xe({canvas:t||We(),antialiasing:!1},n))}},{key:"setBundle",value:function(e){this.compiledBundle=JSON.parse(JSON.stringify(e))}},{key:"setDispatch",value:function(e){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=e),this}},{key:"setMaxIteration",value:function(e){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=e),this}},{key:"setBinding",value:function(e,t){var n=this;if("string"==typeof e){var r=Oe()(t)||Re()(t)||Le()(t);if(this.compiledBundle&&this.compiledBundle.context){var i=this.compiledBundle.context.defines.find((function(t){return t.name===e}));if(i)return i.value=t,this;var o=this.compiledBundle.context.uniforms.find((function(t){return t.name===e}));o&&(r?(o.data=t,o.isReferer=!1,o.storageClass===Be.Uniform?this.model&&this.model.updateUniform(e,t):this.model&&this.model.updateBuffer(e,t)):(o.isReferer=!0,o.data=t))}}else Object.keys(e).forEach((function(t){n.setBinding(t,e[t])}));return this}},{key:"execute",value:(r=_e(Me().mark((function e(){var t,n,r=this,i=arguments;return Me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:1,!this.dirty){e.next=6;break}return this.compiledBundle.context&&(t>1?this.compiledBundle.context.maxIteration=t:this.compiledBundle.context.maxIteration++),e.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter((function(e){return e.isReferer})).forEach((function(e){var t=e.data,n=e.name;r.model.confirmInput(t.model,n)})),n=0;n<t;n++)this.model.run();return this.engine.endFrame(),e.abrupt("return",this);case 12:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getOutput",value:(n=_e(Me().mark((function e(){return Me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.model.readData());case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"compile",value:(t=_e(Me().mark((function e(){var t,n,r;return Me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initPromise;case 2:return t=Xe({},this.compiledBundle.context),n=this.engine.supportWebGPU?this.engine.useWGSL?je.WGSL:je.GLSL450:je.GLSL100,r=this.compiledBundle.shaders[n],t.defines.filter((function(e){return e.runtime})).forEach((function(e){var t="".concat("__DefineValuePlaceholder__").concat(e.name);r=r.replace(t,"".concat(e.value))})),t.shader=r,t.uniforms.forEach((function(e){if(!e.data&&e.storageClass===Be.StorageBuffer){var n=1;e.type===ze.FloatArray?n=1:e.type===ze.Vector4FloatArray&&(n=4),e.data=new Float32Array(t.output.length*n).fill(0)}})),this.compiledBundle.context=t,e.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=e.sent;case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),ut=n(377),ct=n.n(ut),dt=function(){function e(t,n){Te(this,e),this.attribute=void 0,this.buffer=void 0;var r=n.buffer,i=n.offset,o=n.stride,a=n.normalized,s=n.size,u=n.divisor;this.buffer=r,this.attribute={buffer:r.get(),offset:i||0,stride:o||0,normalized:a||!1,divisor:u||0},s&&(this.attribute.size=s)}return Ne(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(e){this.buffer.subData(e)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),ft=(Ae(Ye={},De.POINTS,"points"),Ae(Ye,De.LINES,"lines"),Ae(Ye,De.LINE_LOOP,"line loop"),Ae(Ye,De.LINE_STRIP,"line strip"),Ae(Ye,De.TRIANGLES,"triangles"),Ae(Ye,De.TRIANGLE_FAN,"triangle fan"),Ae(Ye,De.TRIANGLE_STRIP,"triangle strip"),Ye),lt=(Ae(Ke={},De.STATIC_DRAW,"static"),Ae(Ke,De.DYNAMIC_DRAW,"dynamic"),Ae(Ke,De.STREAM_DRAW,"stream"),Ke),ht=(Ae(qe={},De.BYTE,"int8"),Ae(qe,De.UNSIGNED_INT,"int16"),Ae(qe,De.INT,"int32"),Ae(qe,De.UNSIGNED_BYTE,"uint8"),Ae(qe,De.UNSIGNED_SHORT,"uint16"),Ae(qe,De.UNSIGNED_INT,"uint32"),Ae(qe,De.FLOAT,"float"),qe),pt=(Ae(Ze={},De.ALPHA,"alpha"),Ae(Ze,De.LUMINANCE,"luminance"),Ae(Ze,De.LUMINANCE_ALPHA,"luminance alpha"),Ae(Ze,De.RGB,"rgb"),Ae(Ze,De.RGBA,"rgba"),Ae(Ze,De.RGBA4,"rgba4"),Ae(Ze,De.RGB5_A1,"rgb5 a1"),Ae(Ze,De.RGB565,"rgb565"),Ae(Ze,De.DEPTH_COMPONENT,"depth"),Ae(Ze,De.DEPTH_STENCIL,"depth stencil"),Ze),gt=(Ae(Qe={},De.DONT_CARE,"dont care"),Ae(Qe,De.NICEST,"nice"),Ae(Qe,De.FASTEST,"fast"),Qe),mt=(Ae(Je={},De.NEAREST,"nearest"),Ae(Je,De.LINEAR,"linear"),Ae(Je,De.LINEAR_MIPMAP_LINEAR,"mipmap"),Ae(Je,De.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),Ae(Je,De.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),Ae(Je,De.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Je),yt=(Ae($e={},De.REPEAT,"repeat"),Ae($e,De.CLAMP_TO_EDGE,"clamp"),Ae($e,De.MIRRORED_REPEAT,"mirror"),$e),vt=(Ae(et={},De.NONE,"none"),Ae(et,De.BROWSER_DEFAULT_WEBGL,"browser"),et),bt=(Ae(tt={},De.NEVER,"never"),Ae(tt,De.ALWAYS,"always"),Ae(tt,De.LESS,"less"),Ae(tt,De.LEQUAL,"lequal"),Ae(tt,De.GREATER,"greater"),Ae(tt,De.GEQUAL,"gequal"),Ae(tt,De.EQUAL,"equal"),Ae(tt,De.NOTEQUAL,"notequal"),tt),Et=(Ae(nt={},De.FUNC_ADD,"add"),Ae(nt,De.MIN_EXT,"min"),Ae(nt,De.MAX_EXT,"max"),Ae(nt,De.FUNC_SUBTRACT,"subtract"),Ae(nt,De.FUNC_REVERSE_SUBTRACT,"reverse subtract"),nt),_t=(Ae(rt={},De.ZERO,"zero"),Ae(rt,De.ONE,"one"),Ae(rt,De.SRC_COLOR,"src color"),Ae(rt,De.ONE_MINUS_SRC_COLOR,"one minus src color"),Ae(rt,De.SRC_ALPHA,"src alpha"),Ae(rt,De.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),Ae(rt,De.DST_COLOR,"dst color"),Ae(rt,De.ONE_MINUS_DST_COLOR,"one minus dst color"),Ae(rt,De.DST_ALPHA,"dst alpha"),Ae(rt,De.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),Ae(rt,De.CONSTANT_COLOR,"constant color"),Ae(rt,De.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),Ae(rt,De.CONSTANT_ALPHA,"constant alpha"),Ae(rt,De.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),Ae(rt,De.SRC_ALPHA_SATURATE,"src alpha saturate"),rt),wt=(Ae(it={},De.NEVER,"never"),Ae(it,De.ALWAYS,"always"),Ae(it,De.LESS,"less"),Ae(it,De.LEQUAL,"lequal"),Ae(it,De.GREATER,"greater"),Ae(it,De.GEQUAL,"gequal"),Ae(it,De.EQUAL,"equal"),Ae(it,De.NOTEQUAL,"notequal"),it),xt=(Ae(ot={},De.ZERO,"zero"),Ae(ot,De.KEEP,"keep"),Ae(ot,De.REPLACE,"replace"),Ae(ot,De.INVERT,"invert"),Ae(ot,De.INCR,"increment"),Ae(ot,De.DECR,"decrement"),Ae(ot,De.INCR_WRAP,"increment wrap"),Ae(ot,De.DECR_WRAP,"decrement wrap"),ot),At=(Ae(at={},De.FRONT,"front"),Ae(at,De.BACK,"back"),at),Tt=function(){function e(t,n){Te(this,e),this.buffer=void 0;var r=n.data,i=n.usage,o=n.type;this.buffer=t.buffer({data:r,usage:lt[i||De.STATIC_DRAW],type:ht[o||De.UNSIGNED_BYTE]})}return Ne(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(e){var t=e.data,n=e.offset;this.buffer.subdata(t,n)}}]),e}();function St(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(n),!0).forEach((function(t){Ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var It=0,Rt=function(){function e(t,n){var r=this;Te(this,e),this.reGl=t,this.context=n,this.entity=Pe(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var i={};this.context.uniforms.forEach((function(e){var t=e.name,n=e.type,o=e.data,a=e.isReferer,s=e.storageClass;if(s===Be.StorageBuffer){if(a)r.textureCache[t]={data:void 0},i["".concat(t,"Size")]=function(){return o.compiledBundle.context.output.textureSize};else{r.textureCache[t]=r.calcDataTexture(t,n,o);var u=r.textureCache[t],c=u.textureWidth,d=u.isOutput;i["".concat(t,"Size")]=[c,c],d&&(r.outputTextureName=t,r.context.needPingpong&&(r.outputTextureName="".concat(t,"Output"),r.textureCache[r.outputTextureName]=r.calcDataTexture(t,n,o)))}i[t]=function(){return r.textureCache[t].texture}}else if(s===Be.Uniform){if(o&&(Array.isArray(o)||Re()(o))&&o.length>16)throw new Error("invalid data type ".concat(n));i[t]=function(){return e.data}}}));var o=this.getOuputDataTexture(),a=o.textureWidth,s=o.texelCount;i.u_OutputTextureSize=[a,a],i.u_OutputTexelCount=s,this.context.output.textureSize=[a,a];var u={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n".concat(this.context.shader),uniforms:i,vert:"attribute vec3 a_Position;\nattribute vec2 a_TexCoord;\n\nvarying vec2 v_TexCoord;\n\nvoid main() {\n  gl_Position = vec4(a_Position, 1.0);\n  v_TexCoord = a_TexCoord;\n}",primitive:"triangle strip",count:4};this.computeCommand=this.reGl(u)}var t;return Ne(e,[{key:"run",value:function(){var e=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use((function(){e.computeCommand()}))}},{key:"readData",value:(t=_e(Me().mark((function e(){var t,n,r,i,o,a,s,u,c=this;return Me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.reGl({framebuffer:this.texFBO})((function(){t=c.reGl.read()})),!t){e.next=6;break}if(n=this.getOuputDataTexture(),r=n.originalDataLength,i=n.elementsPerTexel,o=n.typedArrayConstructor,a=void 0===o?Float32Array:o,s=[],4!==i)for(u=0;u<t.length;u+=4)1===i?s.push(t[u]):2===i?s.push(t[u],t[u+1]):s.push(t[u],t[u+1],t[u+2]);else s=t;return e.abrupt("return",new a(s.slice(0,r)));case 6:return e.abrupt("return",new Float32Array);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"confirmInput",value:function(e,t){var n;this.entity===e.entity?(this.dynamicPingpong=!0,n=this):n=e,this.textureCache[t].id=n.getOuputDataTexture().id,this.textureCache[t].texture=n.getOuputDataTexture().texture}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(e,t){var n=this.context.uniforms.find((function(t){return t.name===e}));if(n){var r=this.calcDataTexture(e,n.type,t),i=r.texture,o=r.data;this.textureCache[e].data=o,this.textureCache[e].texture=i}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var e=this.context.output.name;this.textureCache[e].id=this.getOuputDataTexture().id,this.textureCache[e].texture=this.getOuputDataTexture().texture}var t=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=t}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var e=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=e}},{key:"cloneDataTexture",value:function(e){var t=e.data,n=e.textureWidth;return Dt(Dt({},e),{},{id:It++,texture:this.reGl.texture({width:n,height:n,data:t,type:"float"})})}},{key:"calcDataTexture",value:function(e,t,n){var r=1;t===ze.Vector4FloatArray&&(r=4);for(var i=[],o=0;o<n.length;o+=r)1===r?i.push(n[o],0,0,0):2===r?i.push(n[o],n[o+1],0,0):3===r?i.push(n[o],n[o+1],n[o+2],0):4===r&&i.push(n[o],n[o+1],n[o+2],n[o+3]);var a,s=n.length,u=Math.ceil(s/r),c=Math.ceil(Math.sqrt(u)),d=c*c;u<d&&i.push.apply(i,function(e){if(Array.isArray(e))return St(e)}(a=new Array(4*(d-u)).fill(0))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(a)||function(e,t){if(e){if("string"==typeof e)return St(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?St(e,t):void 0}}(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var f=this.reGl.texture({width:c,height:c,data:i,type:"float"});return{id:It++,data:i,originalDataLength:s,typedArrayConstructor:Re()(n)?n.constructor:void 0,textureWidth:c,texture:f,texelCount:u,elementsPerTexel:r,isOutput:e===this.context.output.name}}}]),e}(),kt=function(){function e(t,n){Te(this,e),this.elements=void 0;var r=n.data,i=n.usage,o=n.type,a=n.count;this.elements=t.elements({data:r,usage:lt[i||De.STATIC_DRAW],type:ht[o||De.UNSIGNED_BYTE],count:a})}return Ne(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(e){var t=e.data;this.elements.subdata(t)}},{key:"destroy",value:function(){this.elements.destroy()}}]),e}(),Ot=function(){function e(t,n){Te(this,e),this.framebuffer=void 0;var r=n.width,i=n.height,o=n.color,a=n.colors,s=(n.depth,n.stencil,{width:r,height:i});Array.isArray(a)&&(s.colors=a.map((function(e){return e.get()}))),o&&"boolean"!=typeof o&&(s.color=o.get()),this.framebuffer=t.framebuffer(s)}return Ne(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(e){var t=e.width,n=e.height;this.framebuffer.resize(t,n)}}]),e}(),Ct=n(308),Lt=n.n(Ct);function Gt(e){var t={};return Object.keys(e).forEach((function(n){Mt(n,e[n],t,"")})),t}function Mt(e,t,n,r){null===t||"number"==typeof t||"boolean"==typeof t||Array.isArray(t)&&"number"==typeof t[0]||Re()(t)||""===t||void 0!==t.resize?n["".concat(r&&r+".").concat(e)]=t:(Lt()(t)&&Object.keys(t).forEach((function(i){Mt(i,t[i],n,"".concat(r&&r+".").concat(e))})),Array.isArray(t)&&t.forEach((function(t,i){Object.keys(t).forEach((function(o){Mt(o,t[o],n,"".concat(r&&r+".").concat(e,"[").concat(i,"]"))}))})))}function Ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ut(Object(n),!0).forEach((function(t){Ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var zt=function(){function e(t,n){Te(this,e),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=t;var r=n.vs,i=n.fs,o=n.defines,a=n.attributes,s=n.uniforms,u=n.primitive,c=n.count,d=n.elements,f=n.depth,l=n.blend,h=n.stencil,p=n.cull,g=n.instances,m=n.scissor,y=n.viewport,v={};s&&(this.uniforms=Gt(s),Object.keys(s).forEach((function(e){v[e]=t.prop(e)})));var b={};Object.keys(a).forEach((function(e){b[e]=a[e].get()}));var E=o&&this.generateDefines(o)||"",_={attributes:b,frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n".concat(E,"\n").concat(i),uniforms:v,vert:"\n".concat(E,"\n").concat(r),primitive:ft[void 0===u?De.TRIANGLES:u]};g&&(_.instances=g),c&&(_.count=c),d&&(_.elements=d.get()),m&&(_.scissor=m),y&&(_.viewport=y),this.initDepthDrawParams({depth:f},_),this.initBlendDrawParams({blend:l},_),this.initStencilDrawParams({stencil:h},_),this.initCullDrawParams({cull:p},_),this.drawCommand=t(_)}return Ne(e,[{key:"addUniforms",value:function(e){this.uniforms=Pt(Pt({},this.uniforms),Gt(e))}},{key:"draw",value:function(e){var t=Pt(Pt({},this.uniforms),Gt(e.uniforms||{})),n={};Object.keys(t).forEach((function(e){var r=we(t[e]);"boolean"===r||"number"===r||Array.isArray(t[e])||t[e].BYTES_PER_ELEMENT?n[e]=t[e]:"string"===r||(n[e]=t[e].get())})),this.drawCommand(n)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(e,t){var n=e.depth;n&&(t.depth={enable:void 0===n.enable||!!n.enable,mask:void 0===n.mask||!!n.mask,func:bt[n.func||De.LESS],range:n.range||[0,1]})}},{key:"initBlendDrawParams",value:function(e,t){var n=e.blend;if(n){var r=n.enable,i=n.func,o=n.equation,a=n.color,s=void 0===a?[0,0,0,0]:a;t.blend={enable:!!r,func:{srcRGB:_t[i&&i.srcRGB||De.SRC_ALPHA],srcAlpha:_t[i&&i.srcAlpha||De.SRC_ALPHA],dstRGB:_t[i&&i.dstRGB||De.ONE_MINUS_SRC_ALPHA],dstAlpha:_t[i&&i.dstAlpha||De.ONE_MINUS_SRC_ALPHA]},equation:{rgb:Et[o&&o.rgb||De.FUNC_ADD],alpha:Et[o&&o.alpha||De.FUNC_ADD]},color:s}}}},{key:"initStencilDrawParams",value:function(e,t){var n=e.stencil;if(n){var r=n.enable,i=n.mask,o=void 0===i?-1:i,a=n.func,s=void 0===a?{cmp:De.ALWAYS,ref:0,mask:-1}:a,u=n.opFront,c=void 0===u?{fail:De.KEEP,zfail:De.KEEP,zpass:De.KEEP}:u,d=n.opBack,f=void 0===d?{fail:De.KEEP,zfail:De.KEEP,zpass:De.KEEP}:d;t.stencil={enable:!!r,mask:o,func:Pt(Pt({},s),{},{cmp:wt[s.cmp]}),opFront:{fail:xt[c.fail],zfail:xt[c.zfail],zpass:xt[c.zpass]},opBack:{fail:xt[f.fail],zfail:xt[f.zfail],zpass:xt[f.zpass]}}}}},{key:"initCullDrawParams",value:function(e,t){var n=e.cull;if(n){var r=n.enable,i=n.face,o=void 0===i?De.BACK:i;t.cull={enable:!!r,face:At[o]}}}},{key:"generateDefines",value:function(e){return Object.keys(e).map((function(t){return"#define ".concat(t," ").concat(Number(e[t]))})).join("\n")}}]),e}(),Ft=function(){function e(t,n){Te(this,e),this.texture=void 0,this.width=void 0,this.height=void 0;var r=n.data,i=n.type,o=void 0===i?De.UNSIGNED_BYTE:i,a=n.width,s=n.height,u=n.flipY,c=void 0!==u&&u,d=n.format,f=void 0===d?De.RGBA:d,l=n.mipmap,h=void 0!==l&&l,p=n.wrapS,g=void 0===p?De.CLAMP_TO_EDGE:p,m=n.wrapT,y=void 0===m?De.CLAMP_TO_EDGE:m,v=n.aniso,b=void 0===v?0:v,E=n.alignment,_=void 0===E?1:E,w=n.premultiplyAlpha,x=void 0!==w&&w,A=n.mag,T=void 0===A?De.NEAREST:A,S=n.min,N=void 0===S?De.NEAREST:S,D=n.colorSpace,I=void 0===D?De.BROWSER_DEFAULT_WEBGL:D;this.width=a,this.height=s;var R={width:a,height:s,type:ht[o],format:pt[f],wrapS:yt[g],wrapT:yt[y],mag:mt[T],min:mt[N],alignment:_,flipY:c,colorSpace:vt[I],premultiplyAlpha:x,aniso:b};r&&(R.data=r),"number"==typeof h?R.mipmap=gt[h]:"boolean"==typeof h&&(R.mipmap=h),this.texture=t.texture(R)}return Ne(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(e){var t=e.width,n=e.height;this.texture.resize(t,n),this.width=t,this.height=n}},{key:"destroy",value:function(){this.texture.destroy()}}]),e}(),Bt=function(){function e(){var t=this;Te(this,e),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=function(){var e=_e(Me().mark((function e(n){return Me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.uniforms){e.next=3;break}return e.next=3,Promise.all(Object.keys(n.uniforms).map(function(){var e=_e(Me().mark((function e(t){var r;return Me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.uniforms[t]||void 0===n.uniforms[t].load){e.next=5;break}return e.next=3,n.uniforms[t].load();case 3:r=e.sent,n.uniforms[t]=r;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:return e.abrupt("return",new zt(t.gl,n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.createAttribute=function(e){return new dt(t.gl,e)},this.createBuffer=function(e){return new Tt(t.gl,e)},this.createElements=function(e){return new kt(t.gl,e)},this.createTexture2D=function(e){return new Ft(t.gl,e)},this.createFramebuffer=function(e){return new Ot(t.gl,e)},this.useFramebuffer=function(e,n){t.gl({framebuffer:e?e.get():null})(n)},this.createComputeModel=function(){var e=_e(Me().mark((function e(n){return Me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Rt(t.gl,n));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.clear=function(e){var n=e.color,r=e.depth,i=e.stencil,o=e.framebuffer,a=void 0===o?null:o,s={color:n,depth:r,stencil:i};s.framebuffer=null===a?a:a.get(),t.gl.clear(s)},this.setScissor=function(e){t.gl&&t.gl._gl&&(e.enable&&e.box?(t.gl._gl.enable(De.SCISSOR_TEST),t.gl._gl.scissor(e.box.x,e.box.y,e.box.width,e.box.height)):t.gl._gl.disable(De.SCISSOR_TEST),t.gl._refresh())},this.viewport=function(e){var n=e.x,r=e.y,i=e.width,o=e.height;t.gl&&t.gl._gl&&(t.gl._gl.viewport(n,r,i,o),t.gl._refresh())},this.readPixels=function(e){var n=e.framebuffer,r={x:e.x,y:e.y,width:e.width,height:e.height};return n&&(r.framebuffer=n.get()),t.gl.read(r)},this.getCanvas=function(){return t.$canvas},this.getGLContext=function(){return t.gl._gl},this.destroy=function(){t.gl&&(t.gl.destroy(),t.inited=!1)}}var t;return Ne(e,[{key:"init",value:(t=_e(Me().mark((function e(t){return Me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.inited){e.next=2;break}return e.abrupt("return");case 2:return this.$canvas=t.canvas,e.next=5,new Promise((function(e,n){ct()({canvas:t.canvas,attributes:{alpha:!0,antialias:t.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(t,r){!t&&r||n(t),e(r)}})}));case 5:this.gl=e.sent,this.inited=!0;case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),e}(),jt=function(){function e(){Te(this,e),this.engine=void 0,this.configService=new Ve}return Ne(e,[{key:"setConfig",value:function(e){this.configService.set(e)}},{key:"setEngine",value:function(e){this.engine=e}},{key:"createEntity",value:function(){return Pe()}},{key:"createKernel",value:function(e){var t=new st(this.engine,this.configService);return"string"==typeof e?t.setBundle(JSON.parse(e)):t.setBundle(e),t.init(),t}},{key:"destroy",value:function(){this.engine.destroy()}}],[{key:"create",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=new e;return n.setConfig(t),n.setEngine(new Bt),n}}]),e}(),Vt={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Wt=function(){function e(e){void 0===e&&(e={}),this.options=e,this.id="fruchtermanGPU",this.options=r(r({},Vt),e)}return e.prototype.execute=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){return[2,this.genericFruchtermanLayout(!1,e,t)]}))}))},e.prototype.assign=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){return this.genericFruchtermanLayout(!0,e,t),[2]}))}))},e.prototype.genericFruchtermanLayout=function(e,t,n){return i(this,void 0,void 0,(function(){var i,a,s,u,d,f,l,h,p,g,m,v,b,E,_,w,x,A,T,S,N,D,I,R,k,O,C,L,G,M;return o(this,(function(o){switch(o.label){case 0:if(i=this.formatOptions(n),a=i.width,s=i.height,u=i.center,d=i.clustering,f=i.clusterGravity,l=i.nodeClusterBy,h=i.maxIteration,p=i.gravity,g=i.speed,m=t.getAllNodes(),v=t.getAllEdges(),!(null==m?void 0:m.length))return[2,{nodes:[],edges:v}];if(1===m.length)return e&&t.mergeNodeData(m[0].id,{x:u[0],y:u[1]}),[2,{nodes:[r(r({},m[0]),{data:r(r({},m[0].data),{x:u[0],y:u[1]})})],edges:v}];for(b=m.map((function(e){return y(e,[a,s])})),E=s*a,_=Math.sqrt(E)/10,w=E/(b.length+1),x=Math.sqrt(w),P=[],z=(U=[l]).length,F={},b.forEach((function(e){U.forEach((function(t,n){if(void 0===F[e[t]]&&(F[e[t]]=Object.keys(F).length),P.push(F[e[t]]),n===z-1)for(;P.length%4!=0;)P.push(0)}))})),A={array:new Float32Array(P),count:Object.keys(F).length},T=A.array,S=A.count,b.forEach((function(e,t){var n=0,r=0;c(e.data.fx)&&c(e.data.fy)&&(n=e.data.fx||.001,r=e.data.fy||.001),T[4*t+1]=n,T[4*t+2]=r})),N=b.length,D=function(e,t){var n=[],r=[],i={},o=0;for(o=0;o<e.length;o++){var a=e[o];i[a.id]=o,n.push(a.data.x),n.push(a.data.y),n.push(0),n.push(0),r.push([])}for(o=0;o<t.length;o++){var s=t[o],u=s.source,c=s.target;isNaN(i[u])||isNaN(i[c])||(r[i[u]].push(i[c]),r[i[c]].push(i[u]))}var d=0;for(o=0;o<e.length;o++){var f=n.length,l=r[o],h=l.length;n[4*o+2]=f,n[4*o+3]=h,d=Math.max(d,h);for(var p=0;p<h;++p){var g=l[p];n.push(+g)}}for(;n.length%4!=0;)n.push(0);return{maxEdgePerVetex:d,array:new Float32Array(n)}}(b,v),I=D.maxEdgePerVetex,R=D.array,k=jt.create({engineOptions:{supportCompute:!0}}),O=[],G=0;G<S;G++)O.push(0,0,0,0);C=k.createKernel('{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([N,1,1]).setBinding({u_Data:R,u_K:x,u_K2:w,u_Gravity:p,u_ClusterGravity:f||p||1,u_Speed:g,u_MaxDisplace:_,u_Clustering:d?1:0,u_Center:u,u_AttributeArray:T,u_ClusterCenters:O,MAX_EDGE_PER_VERTEX:I,VERTEX_COUNT:N}),d&&(L=k.createKernel('{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([S,1,1]).setBinding({u_Data:R,u_NodeAttributes:T,u_ClusterCenters:O,VERTEX_COUNT:N,CLUSTER_COUNT:S})),G=0,o.label=1;case 1:return G<h?[4,C.execute()]:[3,6];case 2:return o.sent(),d?(L.setBinding({u_Data:C}),[4,L.execute()]):[3,4];case 3:o.sent(),C.setBinding({u_ClusterCenters:L}),o.label=4;case 4:C.setBinding({u_MaxDisplace:_*=.99}),o.label=5;case 5:return G++,[3,1];case 6:return[4,C.getOutput()];case 7:return M=o.sent(),b.forEach((function(e,t){e.data.x=M[4*t],e.data.y=M[4*t+1]})),e&&b.forEach((function(e){var n=e.id,r=e.data;return t.mergeNodeData(n,{x:r.x,y:r.y})})),[2,{nodes:b,edges:v}]}var U,P,z,F}))}))},e.prototype.formatOptions=function(e){void 0===e&&(e={});var t=r(r({},this.options),e),n=t.clustering,i=t.nodeClusterBy,o=t.center,a=t.width,s=t.height;return t.width=a||"undefined"==typeof window?a:window.innerWidth,t.height=s||"undefined"==typeof window?s:window.innerHeight,t.center=o||[t.width/2,t.height/2],t.clustering=n&&!!i,t},e}(),Ht=function(){return Ht=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ht.apply(this,arguments)},Xt=function(){return Xt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Xt.apply(this,arguments)};function Yt(e,t,n){var r=function(e){return{iterations:(null==e?void 0:e.iterations)||10,edgeWeightInfluence:(null==e?void 0:e.edgeWeightInfluence)||1,C:(null==e?void 0:e.C)||1,speed:(null==e?void 0:e.speed)||1,gravity:(null==e?void 0:e.gravity)||10,skipUpdates:(null==e?void 0:e.skipUpdates)||0,width:(null==e?void 0:e.width)||1,height:(null==e?void 0:e.height)||1}}(n||{}),i=function(e,t){void 0===t&&(t="weight");var n=e.nodes(),r=e.edges();return[e.edges().reduce((function(r,i,o){var a=3*o;return r[a+0]=n.indexOf(e.source(i)),r[a+1]=n.indexOf(e.target(i)),r[a+2]=e.getEdgeAttribute(i,t)||1,r}),new Float32Array(3*r.length)),n.length,function(e){return n.reduce((function(t,n,r){var i,o=2*r;return Ht(Ht({},t),((i={})[n]={x:e[o+0],y:e[o+1]},i))}),{})}]}(t,null==n?void 0:n.weightAttribute),o=i[0],a=i[1],s=i[2],u=function(e,t,n,r){for(var i=function(e){return Math.sqrt(e.reduce((function(e,t){return e+t*t}),0))},o=n.width,a=n.height,s=o*a,u=n.C*Math.sqrt(s/(e+1)),c=function(e){return e*e/u},d=function(e){return u*u/e},f=new Float32Array(2*e).map((function(e,t){return t%2==0?(Math.random()*o-o/2)/2:(Math.random()*a-a/2)/2})),l=o/10,h=function(e){return e/(n.iterations+1)},p=0;p<n.iterations;p++){for(var g=[],m=0;m<e;m++){var y=[f[0+(R=2*m)],f[R+1]];g[m]=[0,0];for(var v=0;v<e;v++){var b=2*m,E=[f[b+0],f[b+1]];if(m!==v&&(0!==(k=i(O=[y[0]-E[0],y[1]-E[1]]))||k>1e3*u)){var _=d(k);g[m][0]+=O[0]/k*_,g[m][1]+=O[1]/k*_}}}for(var w=0;w<t.length/3;w++){var x=3*w,A=t[x+0],T=2*A,S=t[x+1],N=2*S,D=t[x+2];if(0!==(k=i(O=[f[T+0]-f[N+0],f[T+1]-f[N+1]]))||k>1e3*u){_=c(k);var I=Math.pow(D,n.edgeWeightInfluence);g[A][0]-=O[0]/k*_*I,g[A][1]-=O[1]/k*_*I,g[S][0]+=O[0]/k*_*I,g[S][1]+=O[1]/k*_*I}}for(m=0;m<e;m++){y=[f[0+(R=2*m)],f[R+1]];var R,k,O=g[m],C=i(y),L=.01*u*n.gravity*C;if(O[0]-=L*y[0]/C,O[1]-=L*y[1]/C,O[0]*=n.speed,O[1]*=n.speed,0!==(k=i(O))){var G=Math.min(k,l*n.speed),M=y[0]+O[0]/k*G,U=y[1]+O[1]/k*G;f[R+0]=Math.min(o/2,Math.max(-o/2,M)),f[R+1]=Math.min(a/2,Math.max(-a/2,U))}}l=h(l),p!==n.iterations-1&&p%n.skipUpdates+1!=0||null==r||r(f,p)}return f}(a,o,r,e?function(e){t.updateEachNodeAttributes((function(t,n){return Xt(Xt({},n),s(e)[t])}),{attributes:["x","y"]})}:void 0);if(!e)return s(u)}var Kt=function(e,t){return Yt(!1,e,t)};Kt.assign=function(e,t){return Yt(!0,e,t)};var qt={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster",maxDistance:1/0},Zt=function(){function e(e){void 0===e&&(e={}),this.options=e,this.id="fruchtermanWASM",this.options=r(r({},qt),e)}return e.prototype.execute=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){return[2,this.genericFruchtermanLayout(!1,e,t)]}))}))},e.prototype.assign=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(n){return this.genericFruchtermanLayout(!0,e,t),[2]}))}))},e.prototype.genericFruchtermanLayout=function(e,t,n){return i(this,void 0,void 0,(function(){var i,a,s,u,d,f,l,h,p,g,m,v,b,E,_,w,x;return o(this,(function(o){switch(o.label){case 0:return i=this.formatOptions(n),a=i.threads,s=i.dimensions,u=i.width,d=i.height,f=i.center,l=i.maxIteration,h=i.minMovement,p=i.distanceThresholdMode,g=i.gravity,m=i.speed,v=i.maxDistance,b=t.getAllNodes(),E=t.getAllEdges(),(null==b?void 0:b.length)?1===b.length?(e&&t.mergeNodeData(b[0].id,{x:f[0],y:f[1],z:3===s?f[2]:void 0}),[2,{nodes:[r(r({},b[0]),{data:r(r({},b[0].data),{x:f[0],y:f[1],z:3===s?f[2]:void 0})})],edges:E}]):((_=b.map((function(e){return y(e,[u,d])}))).forEach((function(e,t){c(e.data.x)||(e.data.x=Math.random()*u),c(e.data.y)||(e.data.y=Math.random()*d),3===s&&(c(e.data.z)||(e.data.z=Math.random()*Math.sqrt(u*d)))})),w=D(_,E,s),[4,a.fruchterman({dimensions:s,nodes:w.nodes,edges:w.edges,masses:w.masses,weights:w.weights,iterations:l,min_movement:h,distance_threshold_mode:I(p),center:f,height:d,width:u,kg:g,speed:m,max_distance:v})]):[2,{nodes:[],edges:E}];case 1:return x=o.sent().nodes,_.forEach((function(e,t){e.data.x=x[s*t],e.data.y=x[s*t+1],3===s&&(e.data.z=x[s*t+2])})),e&&_.forEach((function(e){var n=e.id,r=e.data,i={x:r.x,y:r.y};3===s&&(i.z=r.z),t.mergeNodeData(n,i)})),[2,{nodes:_,edges:E}]}}))}))},e.prototype.formatOptions=function(e){void 0===e&&(e={});var t=r(r({},this.options),e),n=t.clustering,i=t.nodeClusterBy,o=t.center,a=t.width,s=t.height;return t.width=a||"undefined"==typeof window?a:window.innerWidth,t.height=s||"undefined"==typeof window?s:window.innerHeight,t.center=o||[t.width/2,t.height/2],t.clustering=n&&!!i,t},e}(),Qt=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},Jt=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},$t=5e3;function en(e,t){var n=t.iterations;return Qt(this,void 0,void 0,(function(){var t;return Jt(this,(function(r){return t=Kt(e,{height:C,width:C,iterations:n||$t,speed:5,gravity:1,C:1,edgeWeightInfluence:0}),[2,S(e,t,(function(e){e.x=e.x+400,e.y=e.y+400}))]}))}))}function tn(e,t){var n=t.iterations;return t.min_movement,t.distance_threshold_mode,Qt(this,void 0,void 0,(function(){return Jt(this,(function(t){switch(t.label){case 0:return[4,new be({dimensions:2,height:C,width:C,center:[400,400],gravity:1,speed:5,maxIteration:n||$t}).execute(e)];case 1:return[2,N(t.sent())]}}))}))}function nn(e,t){var n=t.iterations;return t.min_movement,t.distance_threshold_mode,Qt(this,void 0,void 0,(function(){return Jt(this,(function(t){switch(t.label){case 0:return[4,new Wt({dimensions:2,height:C,width:C,center:[400,400],gravity:1,speed:5,maxIteration:n||$t}).execute(e)];case 1:return[2,N(t.sent())]}}))}))}function rn(e,t,n){var r=t.iterations,i=t.min_movement,o=t.distance_threshold_mode;return Qt(this,void 0,void 0,(function(){return Jt(this,(function(t){switch(t.label){case 0:return[4,new Zt({threads:n,dimensions:2,maxIteration:r||$t,minMovement:i,distanceThresholdMode:o,height:C,width:C,center:[400,400],gravity:1,speed:5}).execute(e)];case 1:return[2,N(t.sent())]}}))}))}var on=n(227),an=n.n(on),sn=n(154),un=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},cn=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};const dn=Symbol("Comlink.proxy"),fn=Symbol("Comlink.endpoint"),ln=Symbol("Comlink.releaseProxy"),hn=Symbol("Comlink.finalizer"),pn=Symbol("Comlink.thrown"),gn=e=>"object"==typeof e&&null!==e||"function"==typeof e,mn=new Map([["proxy",{canHandle:e=>gn(e)&&e[dn],serialize(e){const{port1:t,port2:n}=new MessageChannel;return yn(e,t),[n,[n]]},deserialize:e=>(e.start(),bn(e))}],["throw",{canHandle:e=>gn(e)&&pn in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function yn(e,t=globalThis,n=["*"]){t.addEventListener("message",(function r(i){if(!i||!i.data)return;if(!function(e,t){for(const n of e){if(t===n||"*"===n)return!0;if(n instanceof RegExp&&n.test(t))return!0}return!1}(n,i.origin))return void console.warn(`Invalid origin '${i.origin}' for comlink proxy`);const{id:o,type:a,path:s}=Object.assign({path:[]},i.data),u=(i.data.argumentList||[]).map(Dn);let c;try{const t=s.slice(0,-1).reduce(((e,t)=>e[t]),e),n=s.reduce(((e,t)=>e[t]),e);switch(a){case"GET":c=n;break;case"SET":t[s.slice(-1)[0]]=Dn(i.data.value),c=!0;break;case"APPLY":c=n.apply(t,u);break;case"CONSTRUCT":c=function(e){return Object.assign(e,{[dn]:!0})}(new n(...u));break;case"ENDPOINT":{const{port1:t,port2:n}=new MessageChannel;yn(e,n),c=function(e,t){return Sn.set(e,t),e}(t,[t])}break;case"RELEASE":c=void 0;break;default:return}}catch(e){c={value:e,[pn]:0}}Promise.resolve(c).catch((e=>({value:e,[pn]:0}))).then((n=>{const[i,s]=Nn(n);t.postMessage(Object.assign(Object.assign({},i),{id:o}),s),"RELEASE"===a&&(t.removeEventListener("message",r),vn(t),hn in e&&"function"==typeof e[hn]&&e[hn]())})).catch((e=>{const[n,r]=Nn({value:new TypeError("Unserializable return value"),[pn]:0});t.postMessage(Object.assign(Object.assign({},n),{id:o}),r)}))})),t.start&&t.start()}function vn(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function bn(e,t){return An(e,[],t)}function En(e){if(e)throw new Error("Proxy has been released and is not useable")}function _n(e){return In(e,{type:"RELEASE"}).then((()=>{vn(e)}))}const wn=new WeakMap,xn="FinalizationRegistry"in globalThis&&new FinalizationRegistry((e=>{const t=(wn.get(e)||0)-1;wn.set(e,t),0===t&&_n(e)}));function An(e,t=[],n=function(){}){let r=!1;const i=new Proxy(n,{get(n,o){if(En(r),o===ln)return()=>{!function(e){xn&&xn.unregister(e)}(i),_n(e),r=!0};if("then"===o){if(0===t.length)return{then:()=>i};const n=In(e,{type:"GET",path:t.map((e=>e.toString()))}).then(Dn);return n.then.bind(n)}return An(e,[...t,o])},set(n,i,o){En(r);const[a,s]=Nn(o);return In(e,{type:"SET",path:[...t,i].map((e=>e.toString())),value:a},s).then(Dn)},apply(n,i,o){En(r);const a=t[t.length-1];if(a===fn)return In(e,{type:"ENDPOINT"}).then(Dn);if("bind"===a)return An(e,t.slice(0,-1));const[s,u]=Tn(o);return In(e,{type:"APPLY",path:t.map((e=>e.toString())),argumentList:s},u).then(Dn)},construct(n,i){En(r);const[o,a]=Tn(i);return In(e,{type:"CONSTRUCT",path:t.map((e=>e.toString())),argumentList:o},a).then(Dn)}});return function(e,t){const n=(wn.get(t)||0)+1;wn.set(t,n),xn&&xn.register(e,t,e)}(i,e),i}function Tn(e){const t=e.map(Nn);return[t.map((e=>e[0])),(n=t.map((e=>e[1])),Array.prototype.concat.apply([],n))];var n}const Sn=new WeakMap;function Nn(e){for(const[t,n]of mn)if(n.canHandle(e)){const[r,i]=n.serialize(e);return[{type:"HANDLER",name:t,value:r},i]}return[{type:"RAW",value:e},Sn.get(e)||[]]}function Dn(e){switch(e.type){case"HANDLER":return mn.get(e.name).deserialize(e.value);case"RAW":return e.value}}function In(e,t,n){return new Promise((r=>{const i=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.addEventListener("message",(function t(n){n.data&&n.data.id&&n.data.id===i&&(e.removeEventListener("message",t),r(n.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:i},t),n)}))}function Rn(e){return void 0===e&&(e=!0),i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,bn(new Worker(new URL(n.p+n.u(469),n.b),{type:void 0}))(e)];case 1:return[2,t.sent()]}}))}))}var kn=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},On=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},Cn=[{name:R.GRAPHOLOGY},{name:R.ANTV_LAYOUT},{name:R.ANTV_LAYOUT_WASM_SINGLETHREAD},{name:R.ANTV_LAYOUT_WASM_MULTITHREADS},{name:R.ANTV_LAYOUT_GPU}],Ln=document.getElementById("mask"),Gn=document.getElementById("iterations"),Mn=document.getElementById("min_movement"),Un=document.getElementById("distance_threshold_mode"),Pn=document.getElementById("dataset"),zn=document.getElementById("dataset-desc"),Fn=document.getElementById("layout"),Bn=document.getElementById("run"),jn=Cn.map((function(e){var t=e.name;return document.getElementById(t).getContext("2d")})),Vn=Cn.map((function(e,t){return jn[t].canvas.parentElement.querySelector("span")})),Wn=Cn.map((function(e,t){var n=e.name,r=document.getElementById(n+"_checkbox");return r.onchange=function(){jn[t].canvas.parentElement.style.display=r.checked?"block":"none"},r})),Hn=document.getElementById("scaling");kn(void 0,void 0,void 0,(function(){var e,t,n,r,i;return On(this,(function(o){switch(o.label){case 0:return Bn.innerHTML="Loading...",Bn.disabled=!0,console.time("Load datasets"),[4,(void 0===a&&(a=2),un(void 0,void 0,void 0,(function(){var e,t,n,r,i,o,s,u,c;return cn(this,(function(d){switch(d.label){case 0:return e={},t=function(){var e,t=(0,sn.clusters)(an(),{order:1e3,size:2e3,clusters:5});t.edges().forEach((function(e,n){t.setEdgeAttribute(e,"weight",1)})),t.nodes().forEach((function(e){t.setNodeAttribute(e,"x",Math.random()*C),t.setNodeAttribute(e,"y",Math.random()*C),3===a&&t.setNodeAttribute(e,"z",Math.random()*C)}));var n=function(e){return new g({nodes:e.nodes().map((function(t){return{id:t,data:{x:e.getNodeAttribute(t,"x"),y:e.getNodeAttribute(t,"y"),z:e.getNodeAttribute(t,"z")}}})),edges:e.edges().map((function(t){return{id:t,source:e.source(t),target:e.target(t),data:{weight:e.getEdgeAttribute(t,"weight")}}}))})}(t);return(e={desc:"Creates a graph with the desired number of nodes & edges and having a given number of clusters. Generated by Graphology Generators."})[R.GRAPHOLOGY]=t,e[R.ANTV_LAYOUT]=n,e[R.ANTV_LAYOUT_GPU]=n,e[R.ANTV_LAYOUT_WASM_SINGLETHREAD]=n,e[R.ANTV_LAYOUT_WASM_MULTITHREADS]=n,e},n=function(e,t){return function(){return un(void 0,void 0,void 0,(function(){var n,r,i,o,a,s,u;return cn(this,(function(c){switch(c.label){case 0:return[4,fetch(e)];case 1:return[4,c.sent().json()];case 2:return n=c.sent(),r=[],i=[],o=new Set,n.nodes.forEach((function(e,t){o.has(e.id)||(o.add(e.id),e.x=void 0,e.y=void 0,e.z=void 0,r.push({id:e.id,data:{x:e.x,y:e.y,z:e.z}}))})),n.edges.forEach((function(e,t){void 0===e.id&&(e.id="e".concat(t)),void 0===e.weight||null===e.weight?e.weight=1:e.weight=Number(e.weight),i.push({id:e.id,source:e.source,target:e.target,data:{weight:e.weight}})})),a=new g({nodes:r,edges:i}),d=a,f=new(an()),d.getAllNodes().forEach((function(e){var t=e.id,n=e.data,r=n.x,i=n.y,o=n.z;f.hasNode(t)||f.addNode(t,{x:r,y:i,z:o})})),d.getAllEdges().forEach((function(e){var t=e.source,n=e.target,r=e.data.weight;f.addEdge(t,n,{weight:r})})),s=f,[2,(u={desc:t},u[R.GRAPHOLOGY]=s,u[R.ANTV_LAYOUT]=a,u[R.ANTV_LAYOUT_GPU]=a,u[R.ANTV_LAYOUT_WASM_SINGLETHREAD]=a,u[R.ANTV_LAYOUT_WASM_MULTITHREADS]=a,u)]}var d,f}))}))}},[4,Promise.all([t(),n("https://gw.alipayobjects.com/os/antvdemo/assets/data/relations.json",'A small dataset of "relations" between people.')(),n("https://gw.alipayobjects.com/os/basement_prod/da5a1b47-37d6-44d7-8d10-f3e046dabf82.json","Netscience with 1589 nodes & 2742 edges.")(),n("https://gw.alipayobjects.com/os/basement_prod/0b9730ff-0850-46ff-84d0-1d4afecd43e6.json","Eva with 8322 nodes & 5421 edges.")(),n("https://gw.alipayobjects.com/os/basement_prod/7bacd7d1-4119-4ac1-8be3-4c4b9bcbc25f.json","A dataset for regions on earth.")()])];case 1:return r=d.sent(),i=r[0],o=r[1],s=r[2],u=r[3],c=r[4],e["random-clusters"]=i,e.relations=o,e.netscience=s,e.eva=u,e.regions=c,[2,e]}}))})))];case 1:return e=o.sent(),Pn.onchange=function(){zn.innerHTML=e[Pn.value].desc},console.timeEnd("Load datasets"),console.time("Init WASM threads"),[4,kn(void 0,void 0,void 0,(function(){var e,t;return On(this,(function(n){switch(n.label){case 0:return[4,Rn(!1)];case 1:return e=n.sent(),[4,Rn(!0)];case 2:return t=n.sent(),[2,[e,t]]}}))}))];case 2:return t=o.sent(),n=t[0],r=t[1],console.timeEnd("Init WASM threads"),Bn.innerHTML="Run layouts",Bn.disabled=!1,i=[{name:R.GRAPHOLOGY,methods:{forceatlas2:M,fruchterman:en}},{name:R.ANTV_LAYOUT,methods:{forceatlas2:U,force2:me,fruchterman:tn}},{name:R.ANTV_LAYOUT_WASM_SINGLETHREAD,methods:{forceatlas2:P,force2:ye,fruchterman:rn}},{name:R.ANTV_LAYOUT_WASM_MULTITHREADS,methods:{forceatlas2:P,force2:ye,fruchterman:rn}},{name:R.ANTV_LAYOUT_GPU,methods:{fruchterman:nn}}],Bn.onclick=function(){return kn(void 0,void 0,void 0,(function(){var t,o;return On(this,(function(a){switch(a.label){case 0:return Ln.style.display="flex",t=e[Pn.value],o=Fn.value,[4,Promise.all(i.map((function(e,i){var a=e.name,s=e.methods;return kn(void 0,void 0,void 0,(function(){return On(this,(function(e){switch(e.label){case 0:return s[o]&&Wn[i].checked?[4,(u=jn[i],c=Vn[i],d=s[o],f=t[a],l={iterations:parseInt(Gn.value),min_movement:parseFloat(Mn.value),distance_threshold_mode:Un.value},h=a===R.ANTV_LAYOUT_WASM_MULTITHREADS?r:n,p=Number(Hn.value),kn(void 0,void 0,void 0,(function(){var e,t,n,r;return On(this,(function(i){switch(i.label){case 0:return e=performance.now(),[4,d(f,l,h)];case 1:return t=i.sent(),n=t.nodes,r=t.edges,c.innerHTML="".concat((performance.now()-e).toFixed(2),"ms"),function(e,t,n,r){e.resetTransform(),e.clearRect(0,0,e.canvas.width,e.canvas.height);var i=new DOMMatrix;e.setTransform(i.translate(e.canvas.width/2,e.canvas.height/2,0).scale(r,r).translate(-e.canvas.width/2,-e.canvas.height/2,0));for(var o=0;o<n.length;o+=4)e.moveTo(n[o],n[o+1]),e.lineTo(n[o+2],n[o+3]),e.strokeStyle="grey",e.lineWidth=1,e.stroke();for(o=0;o<t.length;o+=2)e.beginPath(),e.arc(t[o],t[o+1],5,0,2*Math.PI,!1),e.fillStyle="red",e.fill(),e.stroke()}(u,n,r,p),[2]}}))})))]:[3,2];case 1:return e.sent(),[3,3];case 2:jn[i].clearRect(0,0,jn[i].canvas.width,jn[i].canvas.height),Vn[i].innerHTML="not implemented.",e.label=3;case 3:return[2]}var u,c,d,f,l,h,p}))}))})))];case 1:return a.sent(),Ln.style.display="none",[2]}}))}))},[2]}var a}))}))})()})();